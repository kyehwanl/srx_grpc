cscope 15 /opt/project/gobgp_test/gowork/src/srx_grpc/qsrx -q 0000026545 0003988995
	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_advertise.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"mem‹y.h
"

25 
	~"¥efix.h
"

26 
	~"hash.h
"

27 
	~"thªad.h
"

29 
	~"bgpd/bgpd.h
"

30 
	~"bgpd/bgp_èbÀ.h
"

31 
	~"bgpd/bgp_rouã.h
"

32 
	~"bgpd/bgp_advîti£.h
"

33 
	~"bgpd/bgp_©å.h
"

34 
	~"bgpd/bgp_a•©h.h
"

35 
	~"bgpd/bgp_∑ckë.h
"

36 
	~"bgpd/bgp_fsm.h
"

37 
	~"bgpd/bgp_m∂sv≤.h
"

42 
bgp_advîti£_©å
 *

43 
	$bØ_√w
 ()

45  (
bgp_advîti£_©å
 *)

46 
	`XCALLOC
 (
MTYPE_BGP_ADVERTISE_ATTR
,  (
bgp_advîti£_©å
));

47 
	}
}

50 
	$bØ_‰ì
 (
bgp_advîti£_©å
 *
bØ
)

52 
	`XFREE
 (
MTYPE_BGP_ADVERTISE_ATTR
, 
bØ
);

53 
	}
}

56 
	$bØ_hash_Æloc
 (*
p
)

58 
bgp_advîti£_©å
 * 
ªf
 = (bgp_advîti£_©å *Ë
p
;

59 
bgp_advîti£_©å
 *
bØ
;

61 
bØ
 = 
	`bØ_√w
 ();

62 
bØ
->
©å
 = 
ªf
->attr;

63  
bØ
;

64 
	}
}

67 
	$bØ_hash_key
 (*
p
)

69 
bgp_advîti£_©å
 * 
bØ
 = (bgp_advîti£_©å *Ë
p
;

71  
	`©åhash_key_make
 (
bØ
->
©å
);

72 
	}
}

75 
	$bØ_hash_cmp
 (c⁄° *
p1
, c⁄° *
p2
)

77 c⁄° 
bgp_advîti£_©å
 * 
bØ1
 = 
p1
;

78 c⁄° 
bgp_advîti£_©å
 * 
bØ2
 = 
p2
;

80  
	`©åhash_cmp
 (
bØ1
->
©å
, 
bØ2
->attr);

81 
	}
}

86 
bgp_advîti£
 *

87 
	$bgp_advîti£_√w
 ()

89  (
bgp_advîti£
 *)

90 
	`XCALLOC
 (
MTYPE_BGP_ADVERTISE
,  (
bgp_advîti£
));

91 
	}
}

94 
	$bgp_advîti£_‰ì
 (
bgp_advîti£
 *
adv
)

96 i‡(
adv
->
böfo
)

97 
	`bgp_öfo_u∆ock
 (
adv
->
böfo
);

98 
	`XFREE
 (
MTYPE_BGP_ADVERTISE
, 
adv
);

99 
	}
}

102 
	$bgp_advîti£_add
 (
bgp_advîti£_©å
 *
bØ
,

103 
bgp_advîti£
 *
adv
)

105 
adv
->
√xt
 = 
bØ
->adv;

106 i‡(
bØ
->
adv
)

107 
bØ
->
adv
->
¥ev
 =ádv;

108 
bØ
->
adv
 =ádv;

109 
	}
}

112 
	$bgp_advîti£_dñëe
 (
bgp_advîti£_©å
 *
bØ
,

113 
bgp_advîti£
 *
adv
)

115 i‡(
adv
->
√xt
)

116 
adv
->
√xt
->
¥ev
 =ádv->prev;

117 i‡(
adv
->
¥ev
)

118 
adv
->
¥ev
->
√xt
 =ádv->next;

120 
bØ
->
adv
 =ádv->
√xt
;

121 
	}
}

123 
bgp_advîti£_©å
 *

124 
	$bgp_advîti£_öã∫
 (
hash
 *hash, 
©å
 *attr)

126 
bgp_advîti£_©å
 
ªf
;

127 
bgp_advîti£_©å
 *
bØ
;

129 
ªf
.
©å
 = 
	`bgp_©å_öã∫
 (attr);

130 
bØ
 = (
bgp_advîti£_©å
 *Ë
	`hash_gë
 (
hash
, &
ªf
, 
bØ_hash_Æloc
);

131 
bØ
->
ªf˙t
++;

133  
bØ
;

134 
	}
}

137 
	$bgp_advîti£_unöã∫
 (
hash
 *hash, 
bgp_advîti£_©å
 *
bØ
)

139 i‡(
bØ
->
ªf˙t
)

140 
bØ
->
ªf˙t
--;

142 i‡(
bØ
->
ªf˙t
 && bØ->
©å
)

143 
	`bgp_©å_unöã∫
 (&
bØ
->
©å
);

146 i‡(
bØ
->
©å
)

148 
	`hash_ªÀa£
 (
hash
, 
bØ
);

149 
	`bgp_©å_unöã∫
 (&
bØ
->
©å
);

151 
	`bØ_‰ì
 (
bØ
);

153 
	}
}

157 
	$bgp_adj_out_‰ì
 (
bgp_adj_out
 *
adj
)

159 
	`≥î_u∆ock
 (
adj
->
≥î
);

160 
	`XFREE
 (
MTYPE_BGP_ADJ_OUT
, 
adj
);

161 
	}
}

164 
	$bgp_adj_out_lookup
 (
≥î
 *≥î, 
¥efix
 *
p
,

165 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
bgp_node
 *
∫
)

167 
bgp_adj_out
 *
adj
;

169 
adj
 = 
∫
->
adj_out
;ádj;ádj =ádj->
√xt
)

170 i‡(
adj
->
≥î
 ==Öeer)

173 i‡(! 
adj
)

176  (
adj
->
adv


177 ? (
adj
->
adv
->
bØ
 ? 1 : 0)

178 : (
adj
->
©å
 ? 1 : 0));

179 
	}
}

181 
bgp_advîti£
 *

182 
	$bgp_advîti£_˛ón
 (
≥î
 *≥î, 
bgp_adj_out
 *
adj
,

183 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

185 
bgp_advîti£
 *
adv
;

186 
bgp_advîti£_©å
 *
bØ
;

187 
bgp_advîti£
 *
√xt
;

189 
adv
 = 
adj
->adv;

190 
bØ
 = 
adv
->baa;

191 
√xt
 = 
NULL
;

193 i‡(
bØ
)

196 
	`bgp_advîti£_dñëe
 (
bØ
, 
adv
);

199 
√xt
 = 
bØ
->
adv
;

202 
	`bgp_advîti£_unöã∫
 (
≥î
->
hash
[
afi
][
ßfi
], 
bØ
);

206 
	`FIFO_DEL
 (
adv
);

209 
	`bgp_advîti£_‰ì
 (
adj
->
adv
);

210 
adj
->
adv
 = 
NULL
;

212  
√xt
;

213 
	}
}

216 
	$bgp_adj_out_£t
 (
bgp_node
 *
∫
, 
≥î
 *≥î, 
¥efix
 *
p
,

217 
©å
 *©å, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

218 
bgp_öfo
 *
böfo
)

220 
bgp_adj_out
 *
adj
 = 
NULL
;

221 
bgp_advîti£
 *
adv
;

223 i‡(
DISABLE_BGP_ANNOUNCE
)

227 i‡(
∫
)

229 
adj
 = 
∫
->
adj_out
;ádj;ádj =ádj->
√xt
)

230 i‡(
adj
->
≥î
 ==Öeer)

234 i‡(! 
adj
)

236 
adj
 = 
	`XCALLOC
 (
MTYPE_BGP_ADJ_OUT
,  (
bgp_adj_out
));

237 
adj
->
≥î
 = 
	`≥î_lock
 (peer);

239 i‡(
∫
)

241 
	`BGP_ADJ_OUT_ADD
 (
∫
, 
adj
);

242 
	`bgp_lock_node
 (
∫
);

246 i‡(
adj
->
adv
)

247 
	`bgp_advîti£_˛ón
 (
≥î
, 
adj
, 
afi
, 
ßfi
);

249 
adj
->
adv
 = 
	`bgp_advîti£_√w
 ();

251 
adv
 = 
adj
->adv;

252 
adv
->
∫
 =Ñn;

254 
	`as£π
 (
adv
->
böfo
 =
NULL
);

255 
adv
->
böfo
 = 
	`bgp_öfo_lock
 (binfo);

257 i‡(
©å
)

258 
adv
->
bØ
 = 
	`bgp_advîti£_öã∫
 (
≥î
->
hash
[
afi
][
ßfi
], 
©å
);

260 
adv
->
bØ
 = 
	`bØ_√w
 ();

261 
adv
->
adj
 =ádj;

264 
	`bgp_advîti£_add
 (
adv
->
bØ
,ádv);

266 
	`FIFO_ADD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
upd©e
, &
adv
->
fifo
);

267 
	}
}

270 
	$bgp_adj_out_un£t
 (
bgp_node
 *
∫
, 
≥î
 *≥î, 
¥efix
 *
p
,

271 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

273 
bgp_adj_out
 *
adj
;

274 
bgp_advîti£
 *
adv
;

276 i‡(
DISABLE_BGP_ANNOUNCE
)

280 
adj
 = 
∫
->
adj_out
;ádj;ádj =ádj->
√xt
)

281 i‡(
adj
->
≥î
 ==Öeer)

284 i‡(! 
adj
)

288 i‡(
adj
->
adv
)

289 
	`bgp_advîti£_˛ón
 (
≥î
, 
adj
, 
afi
, 
ßfi
);

291 i‡(
adj
->
©å
)

294 
adj
->
adv
 = 
	`bgp_advîti£_√w
 ();

295 
adv
 = 
adj
->adv;

296 
adv
->
∫
 =Ñn;

297 
adv
->
adj
 =ádj;

300 
	`FIFO_ADD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
wôhdøw
, &
adv
->
fifo
);

303 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

308 
	`BGP_ADJ_OUT_DEL
 (
∫
, 
adj
);

311 
	`bgp_adj_out_‰ì
 (
adj
);

313 
	`bgp_u∆ock_node
 (
∫
);

315 
	}
}

318 
	$bgp_adj_out_ªmove
 (
bgp_node
 *
∫
, 
bgp_adj_out
 *
adj
,

319 
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

321 i‡(
adj
->
©å
)

322 
	`bgp_©å_unöã∫
 (&
adj
->
©å
);

324 i‡(
adj
->
adv
)

325 
	`bgp_advîti£_˛ón
 (
≥î
, 
adj
, 
afi
, 
ßfi
);

327 
	`BGP_ADJ_OUT_DEL
 (
∫
, 
adj
);

328 
	`bgp_adj_out_‰ì
 (
adj
);

329 
	}
}

332 
	$bgp_adj_ö_£t
 (
bgp_node
 *
∫
, 
≥î
 *≥î, 
©å
 *attr)

334 
bgp_adj_ö
 *
adj
;

336 
adj
 = 
∫
->
adj_ö
;ádj;ádj =ádj->
√xt
)

338 i‡(
adj
->
≥î
 ==Öeer)

340 i‡(
adj
->
©å
 !=áttr)

342 
	`bgp_©å_unöã∫
 (&
adj
->
©å
);

343 
adj
->
©å
 = 
	`bgp_©å_öã∫
 (attr);

348 
adj
 = 
	`XCALLOC
 (
MTYPE_BGP_ADJ_IN
,  (
bgp_adj_ö
));

349 
adj
->
≥î
 = 
	`≥î_lock
 (peer);

350 
adj
->
©å
 = 
	`bgp_©å_öã∫
 (attr);

351 
	`BGP_ADJ_IN_ADD
 (
∫
, 
adj
);

352 
	`bgp_lock_node
 (
∫
);

353 
	}
}

356 
	$bgp_adj_ö_ªmove
 (
bgp_node
 *
∫
, 
bgp_adj_ö
 *
bai
)

358 
	`bgp_©å_unöã∫
 (&
bai
->
©å
);

359 
	`BGP_ADJ_IN_DEL
 (
∫
, 
bai
);

360 
	`≥î_u∆ock
 (
bai
->
≥î
);

361 
	`XFREE
 (
MTYPE_BGP_ADJ_IN
, 
bai
);

362 
	}
}

365 
	$bgp_adj_ö_un£t
 (
bgp_node
 *
∫
, 
≥î
 *peer)

367 
bgp_adj_ö
 *
adj
;

369 
adj
 = 
∫
->
adj_ö
;ádj;ádj =ádj->
√xt
)

370 i‡(
adj
->
≥î
 ==Öeer)

373 i‡(! 
adj
)

376 
	`bgp_adj_ö_ªmove
 (
∫
, 
adj
);

377 
	`bgp_u∆ock_node
 (
∫
);

378 
	}
}

381 
	$bgp_sync_öô
 (
≥î
 *peer)

383 
afi_t
 
afi
;

384 
ßfi_t
 
ßfi
;

385 
bgp_synchr⁄ize
 *
sync
;

387 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

388 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

390 
sync
 = 
	`XCALLOC
 (
MTYPE_BGP_SYNCHRONISE
,

391  (
bgp_synchr⁄ize
));

392 
	`FIFO_INIT
 (&
sync
->
upd©e
);

393 
	`FIFO_INIT
 (&
sync
->
wôhdøw
);

394 
	`FIFO_INIT
 (&
sync
->
wôhdøw_low
);

395 
≥î
->
sync
[
afi
][
ßfi
] = sync;

396 
≥î
->
hash
[
afi
][
ßfi
] = 
	`hash_¸óã
 (
bØ_hash_key
, 
bØ_hash_cmp
);

398 
	}
}

401 
	$bgp_sync_dñëe
 (
≥î
 *peer)

403 
afi_t
 
afi
;

404 
ßfi_t
 
ßfi
;

406 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

407 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

409 i‡(
≥î
->
sync
[
afi
][
ßfi
])

410 
	`XFREE
 (
MTYPE_BGP_SYNCHRONISE
, 
≥î
->
sync
[
afi
][
ßfi
]);

411 
≥î
->
sync
[
afi
][
ßfi
] = 
NULL
;

413 i‡(
≥î
->
hash
[
afi
][
ßfi
])

414 
	`hash_‰ì
 (
≥î
->
hash
[
afi
][
ßfi
]);

415 
≥î
->
hash
[
afi
][
ßfi
] = 
NULL
;

417 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_advertise.h

21 #i‚de‡
_QUAGGA_BGP_ADVERTISE_H


22 
	#_QUAGGA_BGP_ADVERTISE_H


	)

25 
	sbgp_advîti£_fifo


27 
bgp_advîti£
 *
	m√xt
;

28 
bgp_advîti£
 *
	m¥ev
;

32 
	sbgp_advîti£_©å


35 
bgp_advîti£
 *
	madv
;

38 
	mªf˙t
;

41 
©å
 *
	m©å
;

44 
	sbgp_advîti£


47 
bgp_advîti£_fifo
 
	mfifo
;

50 
bgp_advîti£
 *
	m√xt
;

51 
bgp_advîti£
 *
	m¥ev
;

54 
bgp_node
 *
	m∫
;

57 
bgp_adj_out
 *
	madj
;

60 
bgp_advîti£_©å
 *
	mbØ
;

63 
bgp_öfo
 *
	mböfo
;

67 
	sbgp_adj_out


70 
bgp_adj_out
 *
	m√xt
;

71 
bgp_adj_out
 *
	m¥ev
;

74 
≥î
 *
	m≥î
;

77 
©å
 *
	m©å
;

80 
bgp_advîti£
 *
	madv
;

84 
	sbgp_adj_ö


87 
bgp_adj_ö
 *
	m√xt
;

88 
bgp_adj_ö
 *
	m¥ev
;

91 
≥î
 *
	m≥î
;

94 
©å
 *
	m©å
;

98 
	sbgp_synchr⁄ize


100 
bgp_advîti£_fifo
 
	mupd©e
;

101 
bgp_advîti£_fifo
 
	mwôhdøw
;

102 
bgp_advîti£_fifo
 
	mwôhdøw_low
;

106 
	#BGP_INFO_ADD
(
N
,
A
,
TYPE
) \

108 (
A
)->
¥ev
 = 
NULL
; \

109 (
A
)->
√xt
 = (
N
)->
TYPE
; \

110 i‡((
N
)->
TYPE
) \

111 (
N
)->
TYPE
->
¥ev
 = (
A
); \

112 (
N
)->
TYPE
 = (
A
); \

113 } 0)

	)

115 
	#BGP_INFO_DEL
(
N
,
A
,
TYPE
) \

117 i‡((
A
)->
√xt
) \

118 (
A
)->
√xt
->
¥ev
 = (A)->prev; \

119 i‡((
A
)->
¥ev
) \

120 (
A
)->
¥ev
->
√xt
 = (A)->next; \

122 (
N
)->
TYPE
 = (
A
)->
√xt
; \

123 } 0)

	)

125 
	#BGP_ADJ_IN_ADD
(
N
,
A
Ë
	`BGP_INFO_ADD
(N,A,
adj_ö
)

	)

126 
	#BGP_ADJ_IN_DEL
(
N
,
A
Ë
	`BGP_INFO_DEL
(N,A,
adj_ö
)

	)

127 
	#BGP_ADJ_OUT_ADD
(
N
,
A
Ë
	`BGP_INFO_ADD
(N,A,
adj_out
)

	)

128 
	#BGP_ADJ_OUT_DEL
(
N
,
A
Ë
	`BGP_INFO_DEL
(N,A,
adj_out
)

	)

131 
bgp_adj_out_£t
 (
bgp_node
 *, 
≥î
 *, 
¥efix
 *,

132 
©å
 *, 
afi_t
, 
ßfi_t
, 
bgp_öfo
 *);

133 
bgp_adj_out_un£t
 (
bgp_node
 *, 
≥î
 *, 
¥efix
 *,

134 
afi_t
, 
ßfi_t
);

135 
bgp_adj_out_ªmove
 (
bgp_node
 *, 
bgp_adj_out
 *,

136 
≥î
 *, 
afi_t
, 
ßfi_t
);

137 
bgp_adj_out_lookup
 (
≥î
 *, 
¥efix
 *, 
afi_t
, 
ßfi_t
,

138 
bgp_node
 *);

140 
bgp_adj_ö_£t
 (
bgp_node
 *, 
≥î
 *, 
©å
 *);

141 
bgp_adj_ö_un£t
 (
bgp_node
 *, 
≥î
 *);

142 
bgp_adj_ö_ªmove
 (
bgp_node
 *, 
bgp_adj_ö
 *);

144 
bgp_advîti£
 *

145 
bgp_advîti£_˛ón
 (
≥î
 *, 
bgp_adj_out
 *, 
afi_t
, 
ßfi_t
);

147 
bgp_sync_öô
 (
≥î
 *);

148 
bgp_sync_dñëe
 (
≥î
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_aspath.c

22 
	~<zebø.h
>

24 
	~"hash.h
"

25 
	~"mem‹y.h
"

26 
	~"ve˘‹.h
"

27 
	~"vty.h
"

28 
	~"°r.h
"

29 
	~"log.h
"

30 
	~"°ªam.h
"

31 
	~"jhash.h
"

33 
	~"bgpd/bgpd.h
"

34 
	~"bgpd/bgp_a•©h.h
"

35 
	~"bgpd/bgp_debug.h
"

36 
	~"bgpd/bgp_©å.h
"

38 #ifde‡
USE_SRX


39 
	~"§x/§x_defs.h
"

43 
	#AS_HEADER_SIZE
 2

	)

46 
	#AS_VALUE_SIZE
  (
as_t
)

	)

48 
	#AS16_VALUE_SIZE
  (
as16_t
)

	)

51 
	#AS_SEGMENT_MAX
 255

	)

64 
	#ASSEGMENT_DATA_SIZE
(
N
,
S
) \

65 ((
N
Ë* ( (
S
Ë? 
AS_VALUE_SIZE
 : 
AS16_VALUE_SIZE
Ë)

	)

68 
	#ASSEGMENT_SIZE
(
N
,
S
Ë(
AS_HEADER_SIZE
 + 
	`ASSEGMENT_DATA_SIZE
 (N,S))

	)

71 
	#ASSEGMENT_LEN
(
X
,
S
Ë
	`ASSEGMENT_SIZE
((X)->
Àngth
,S)

	)

75 
	#ASSEGMENT_TYPES_PACKABLE
(
X
,
Y
) \

76 –((
X
)->
ty≥
 =(
Y
)->type) \

77 && ((
X
)->
ty≥
 =
AS_SEQUENCE
))

	)

79 
	#ASSEGMENTS_PACKABLE
(
X
,
Y
) \

80 –
	`ASSEGMENT_TYPES_PACKABLE
–(
X
), (
Y
)) \

81 && ( ((
X
)->
Àngth
 + (
Y
)->ÀngthË<
AS_SEGMENT_MAX
 ) )

	)

86 
	sas£gmít_hódî


88 
u_ch¨
 
	mty≥
;

89 
u_ch¨
 
	mÀngth
;

93 
hash
 *
	gashash
;

96 
°ªam
 *
	g¢mp_°ªam
;

99 
as_t
 *

100 
	$as£gmít_d©a_√w
 (
num
)

102  (
	`XMALLOC
 (
MTYPE_AS_SEG_DATA
, 
	`ASSEGMENT_DATA_SIZE
 (
num
, 1)));

103 
	}
}

110 
as£gmít
 *

111 
	$as£gmít_√w
 (
u_ch¨
 
ty≥
, 
u_sh‹t
 
Àngth
)

113 
as£gmít
 *
√w
;

115 
√w
 = 
	`XCALLOC
 (
MTYPE_AS_SEG
,  (
as£gmít
));

117 i‡(
Àngth
)

118 
√w
->
as
 = 
	`as£gmít_d©a_√w
 (
Àngth
);

120 
√w
->
Àngth
 =Üength;

121 
√w
->
ty≥
 =Åype;

123  
√w
;

124 
	}
}

127 
	$as£gmít_‰ì
 (
as£gmít
 *
£g
)

129 i‡(!
£g
)

132 i‡(
£g
->
as
)

133 
	`XFREE
 (
MTYPE_AS_SEG_DATA
, 
£g
->
as
);

134 
	`mem£t
 (
£g
, 0x„, (
as£gmít
));

135 
	`XFREE
 (
MTYPE_AS_SEG
, 
£g
);

138 
	}
}

142 
	$as£gmít_‰ì_Æl
 (
as£gmít
 *
£g
)

144 
as£gmít
 *
¥ev
;

146 
£g
)

148 
¥ev
 = 
£g
;

149 
£g
 = seg->
√xt
;

150 
	`as£gmít_‰ì
 (
¥ev
);

152 
	}
}

155 
as£gmít
 *

156 
	$as£gmít_dup
 (
as£gmít
 *
£g
)

158 
as£gmít
 *
√w
;

160 
√w
 = 
	`as£gmít_√w
 (
£g
->
ty≥
, seg->
Àngth
);

161 
	`mem˝y
 (
√w
->
as
, 
£g
->as, 
	`ASSEGMENT_DATA_SIZE
 (√w->
Àngth
, 1) );

163  
√w
;

164 
	}
}

167 
as£gmít
 *

168 
	$as£gmít_dup_Æl
 (
as£gmít
 *
£g
)

170 
as£gmít
 *
√w
 = 
NULL
;

171 
as£gmít
 *
hód
 = 
NULL
;

173 
£g
)

175 i‡(
hód
)

177 
√w
->
√xt
 = 
	`as£gmít_dup
 (
£g
);

178 
√w
 =Çew->
√xt
;

181 
hód
 = 
√w
 = 
	`as£gmít_dup
 (
£g
);

183 
£g
 = seg->
√xt
;

185  
hód
;

186 
	}
}

189 
as£gmít
 *

190 
	$as£gmít_¥ïíd_a¢s
 (
as£gmít
 *
£g
, 
as_t
 
a¢um
, 
num
)

192 
as_t
 *
√was
;

193 
i
;

195 i‡(!
num
)

196  
£g
;

198 i‡(
num
 >
AS_SEGMENT_MAX
)

199  
£g
;

201 
√was
 = 
	`as£gmít_d©a_√w
 (
£g
->
Àngth
 + 
num
);

203 
i
 = 0; i < 
num
; i++)

204 
√was
[
i
] = 
a¢um
;

206 
	`mem˝y
 (
√was
 + 
num
, 
£g
->
as
, 
	`ASSEGMENT_DATA_SIZE
 (£g->
Àngth
, 1));

207 
	`XFREE
 (
MTYPE_AS_SEG_DATA
, 
£g
->
as
);

208 
£g
->
as
 = 
√was
;

209 
£g
->
Àngth
 +
num
;

211  
£g
;

212 
	}
}

215 
as£gmít
 *

216 
	$as£gmít_≠≥nd_a¢s
 (
as£gmít
 *
£g
, 
as_t
 *
a¢os
, 
num
)

218 
as_t
 *
√was
;

220 
√was
 = 
	`XREALLOC
 (
MTYPE_AS_SEG_DATA
, 
£g
->
as
,

221 
	`ASSEGMENT_DATA_SIZE
 (
£g
->
Àngth
 + 
num
, 1));

223 i‡(
√was
)

225 
£g
->
as
 = 
√was
;

226 
	`mem˝y
 (
£g
->
as
 + seg->
Àngth
, 
a¢os
, 
	`ASSEGMENT_DATA_SIZE
(
num
, 1));

227 
£g
->
Àngth
 +
num
;

228  
£g
;

231 
	`as£gmít_‰ì_Æl
 (
£g
);

232  
NULL
;

233 
	}
}

236 
	$öt_cmp
 (c⁄° *
p1
, c⁄° *
p2
)

238 c⁄° 
as_t
 *
as1
 = 
p1
;

239 c⁄° 
as_t
 *
as2
 = 
p2
;

241  (*
as1
 =*
as2
)

242 ? 0 : ( (*
as1
 > *
as2
) ? 1 : -1);

243 
	}
}

251 
as£gmít
 *

252 
	$as£gmít_n‹mÆi£
 (
as£gmít
 *
hód
)

254 
as£gmít
 *
£g
 = 
hód
, *
pö
;

255 
as£gmít
 *
tmp
;

257 i‡(!
hód
)

258  
hód
;

260 
£g
)

262 
pö
 = 
£g
;

268 i‡(
£g
->
ty≥
 =
AS_SET
 || seg->ty≥ =
AS_CONFED_SET
)

270 
èû
 = 0;

271 
i
;

273 
	`qs‹t
 (
£g
->
as
, seg->
Àngth
, (
as_t
), 
öt_cmp
);

276 
i
=1; i < 
£g
->
Àngth
; i++)

278 i‡(
£g
->
as
[
èû
] =£g->as[
i
])

281 
èû
++;

282 i‡(
èû
 < 
i
)

283 
£g
->
as
[
èû
] = seg->as[
i
];

286 i‡(
£g
->
Àngth
)

287 
£g
->
Àngth
 = 
èû
 + 1;

295 
pö
->
√xt
 && 
	`ASSEGMENT_TYPES_PACKABLE
(pin,Öin->next))

297 
tmp
 = 
pö
->
√xt
;

298 
£g
 = 
pö
->
√xt
;

301 
pö
 = 
	`as£gmít_≠≥nd_a¢s
 (pö, 
£g
->
as
, seg->
Àngth
);

304 
pö
->
√xt
 = 
£g
->next;

307 
	`as£gmít_‰ì
 (
tmp
);

311 
£g
 = 
pö
->
√xt
;

313  
hód
;

314 
	}
}

316 
a•©h
 *

317 
	$a•©h_√w
 ()

319  
	`XCALLOC
 (
MTYPE_AS_PATH
,  (
a•©h
));

320 
	}
}

324 
	$a•©h_‰ì
 (
a•©h
 *aspath)

326 i‡(!
a•©h
)

328 i‡(
a•©h
->
£gmíts
)

329 
	`as£gmít_‰ì_Æl
 (
a•©h
->
£gmíts
);

330 i‡(
a•©h
->
°r
)

331 
	`XFREE
 (
MTYPE_AS_STR
, 
a•©h
->
°r
);

332 
	`XFREE
 (
MTYPE_AS_PATH
, 
a•©h
);

333 
	}
}

337 
	$a•©h_unöã∫
 (
a•©h
 **aspath)

339 
a•©h
 *
ªt
;

340 
a•©h
 *
a•
 = *aspath;

342 i‡(
a•
->
ªf˙t
)

343 
a•
->
ªf˙t
--;

345 i‡(
a•
->
ªf˙t
 == 0)

348 
ªt
 = 
	`hash_ªÀa£
 (
ashash
, 
a•
);

349 
	`as£π
 (
ªt
 !
NULL
);

350 
	`a•©h_‰ì
 (
a•
);

351 *
a•©h
 = 
NULL
;

353 
	}
}

356 
	#AS_SEG_START
 0

	)

357 
	#AS_SEG_END
 1

	)

359 
	$a•©h_dñimôî_ch¨
 (
u_ch¨
 
ty≥
, u_ch¨ 
which
)

361 
i
;

364 
ty≥
;

365 
°¨t
;

366 
íd
;

367 } 
a•©h_dñim_ch¨
 [] =

369 { 
AS_SET
, '{', '}' },

370 { 
AS_CONFED_SET
, '[', ']' },

371 { 
AS_CONFED_SEQUENCE
, '(', ')' },

375 
i
 = 0; 
a•©h_dñim_ch¨
[i].
ty≥
 != 0; i++)

377 i‡(
a•©h_dñim_ch¨
[
i
].
ty≥
 ==Åype)

379 i‡(
which
 =
AS_SEG_START
)

380  
a•©h_dñim_ch¨
[
i
].
°¨t
;

381 i‡(
which
 =
AS_SEG_END
)

382  
a•©h_dñim_ch¨
[
i
].
íd
;

386 
	}
}

390 
	$as£gmít_cou¡_a¢s
 (
as£gmít
 *
£g
, 
‰om
)

392 
cou¡
 = 0;

393 
£g
)

395 i‡(!
‰om
)

396 
cou¡
 +
£g
->
Àngth
;

399 
cou¡
 +(
£g
->
Àngth
 - 
‰om
);

400 
‰om
 = 0;

402 
£g
 = seg->
√xt
;

404  
cou¡
;

405 
	}
}

408 
	$a•©h_cou¡_c⁄„ds
 (
a•©h
 *aspath)

410 
cou¡
 = 0;

411 
as£gmít
 *
£g
 = 
a•©h
->
£gmíts
;

413 
£g
)

415 i‡(
£g
->
ty≥
 =
AS_CONFED_SEQUENCE
)

416 
cou¡
 +
£g
->
Àngth
;

417 i‡(
£g
->
ty≥
 =
AS_CONFED_SET
)

418 
cou¡
++;

420 
£g
 = seg->
√xt
;

422  
cou¡
;

423 
	}
}

426 
	$a•©h_cou¡_h›s
 (
a•©h
 *aspath)

428 
cou¡
 = 0;

429 
as£gmít
 *
£g
 = 
a•©h
->
£gmíts
;

431 
£g
)

433 i‡(
£g
->
ty≥
 =
AS_SEQUENCE
)

434 
cou¡
 +
£g
->
Àngth
;

435 i‡(
£g
->
ty≥
 =
AS_SET
)

436 
cou¡
++;

438 
£g
 = seg->
√xt
;

440  
cou¡
;

441 
	}
}

450 
	$a•©h_size
 (
a•©h
 *aspath)

452 
size
 = 0;

453 
as£gmít
 *
£g
 = 
a•©h
->
£gmíts
;

455 
£g
)

457 
size
 +
	`ASSEGMENT_SIZE
(
£g
->
Àngth
, 1);

458 
£g
 = seg->
√xt
;

460  
size
;

461 
	}
}

464 
as_t


465 
	$a•©h_highe°
 (
a•©h
 *aspath)

467 
as£gmít
 *
£g
 = 
a•©h
->
£gmíts
;

468 
as_t
 
highe°
 = 0;

469 
i
;

471 
£g
)

473 
i
 = 0; i < 
£g
->
Àngth
; i++)

474 i‡(
£g
->
as
[
i
] > 
highe°


475 && (
£g
->
as
[
i
] < 
BGP_PRIVATE_AS_MIN


476 || 
£g
->
as
[
i
] > 
BGP_PRIVATE_AS_MAX
))

477 
highe°
 = 
£g
->
as
[
i
];

478 
£g
 = seg->
√xt
;

480  
highe°
;

481 
	}
}

485 
	$a•©h_has_as4
 (
a•©h
 *aspath)

487 
as£gmít
 *
£g
 = 
a•©h
->
£gmíts
;

488 
i
;

490 
£g
)

492 
i
 = 0; i < 
£g
->
Àngth
; i++)

493 i‡(
£g
->
as
[
i
] > 
BGP_AS_MAX
)

495 
£g
 = seg->
√xt
;

498 
	}
}

502 
	$a•©h_make_°r_cou¡
 (
a•©h
 *
as
)

504 
as£gmít
 *
£g
;

505 
°r_size
;

506 
Àn
 = 0;

507 *
°r_buf
;

510 i‡(!
as
->
£gmíts
)

512 
as
->
°r
 = 
	`XMALLOC
 (
MTYPE_AS_STR
, 1);

513 
as
->
°r
[0] = '\0';

514 
as
->
°r_Àn
 = 0;

518 
£g
 = 
as
->
£gmíts
;

529 
	#ASN_STR_LEN
 (10 + 1)

	)

530 
°r_size
 = 
	`MAX
 (
	`as£gmít_cou¡_a¢s
 (
£g
, 0Ë* 
ASN_STR_LEN
 + 2 + 1,

531 
ASPATH_STR_DEFAULT_LEN
);

532 
°r_buf
 = 
	`XMALLOC
 (
MTYPE_AS_STR
, 
°r_size
);

534 
£g
)

536 
i
;

537 
£≥øt‹
;

540 
£g
->
ty≥
)

542 
AS_SET
:

543 
AS_CONFED_SET
:

544 
£≥øt‹
 = ',';

546 
AS_SEQUENCE
:

547 
AS_CONFED_SEQUENCE
:

548 
£≥øt‹
 = ' ';

551 
	`XFREE
 (
MTYPE_AS_STR
, 
°r_buf
);

552 
as
->
°r
 = 
NULL
;

553 
as
->
°r_Àn
 = 0;

566 
	#SEGMENT_STR_LEN
(
X
Ë(((X)->
Àngth
 * 
ASN_STR_LEN
Ë+ 2 + 1 + 1)

	)

567 i‡–(
Àn
 + 
	`SEGMENT_STR_LEN
(
£g
)Ë> 
°r_size
)

569 
°r_size
 = 
Àn
 + 
	`SEGMENT_STR_LEN
(
£g
);

570 
°r_buf
 = 
	`XREALLOC
 (
MTYPE_AS_STR
, så_buf, 
°r_size
);

572 #unde‡
ASN_STR_LEN


573 #unde‡
SEGMENT_STR_LEN


575 i‡(
£g
->
ty≥
 !
AS_SEQUENCE
)

576 
Àn
 +
	`¢¥ötf
 (
°r_buf
 +Üí, 
°r_size
 -Üen,

578 
	`a•©h_dñimôî_ch¨
 (
£g
->
ty≥
, 
AS_SEG_START
));

581 
i
 = 0; i < 
£g
->
Àngth
; i++)

583 
Àn
 +
	`¢¥ötf
 (
°r_buf
 +Üí, 
°r_size
 -Üí, "%u", 
£g
->
as
[
i
]);

585 i‡(
i
 < (
£g
->
Àngth
 - 1))

586 
Àn
 +
	`¢¥ötf
 (
°r_buf
 +Üí, 
°r_size
 -Üí, "%c", 
£≥øt‹
);

589 i‡(
£g
->
ty≥
 !
AS_SEQUENCE
)

590 
Àn
 +
	`¢¥ötf
 (
°r_buf
 +Üí, 
°r_size
 -Üen, "%c",

591 
	`a•©h_dñimôî_ch¨
 (
£g
->
ty≥
, 
AS_SEG_END
));

592 i‡(
£g
->
√xt
)

593 
Àn
 +
	`¢¥ötf
 (
°r_buf
 +Üí, 
°r_size
 -Üen, " ");

595 
£g
 = seg->
√xt
;

598 
	`as£π
 (
Àn
 < 
°r_size
);

600 
°r_buf
[
Àn
] = '\0';

601 
as
->
°r
 = 
°r_buf
;

602 
as
->
°r_Àn
 = 
Àn
;

605 
	}
}

608 
	$a•©h_°r_upd©e
 (
a•©h
 *
as
)

610 i‡(
as
->
°r
)

611 
	`XFREE
 (
MTYPE_AS_STR
, 
as
->
°r
);

612 
	`a•©h_make_°r_cou¡
 (
as
);

613 
	}
}

616 
a•©h
 *

617 
	$a•©h_öã∫
 (
a•©h
 *aspath)

619 
a•©h
 *
föd
;

623 
	`as£π
 (
a•©h
->
ªf˙t
 == 0);

624 
	`as£π
 (
a•©h
->
°r
);

627 
föd
 = 
	`hash_gë
 (
ashash
, 
a•©h
, 
hash_Æloc_öã∫
);

628 i‡(
föd
 !
a•©h
)

629 
	`a•©h_‰ì
 (
a•©h
);

631 
föd
->
ªf˙t
++;

633  
föd
;

634 
	}
}

638 
a•©h
 *

639 
	$a•©h_dup
 (
a•©h
 *aspath)

641 
buÊí
 = 
a•©h
->
°r_Àn
 + 1;

642 
a•©h
 *
√w
;

644 
√w
 = 
	`XCALLOC
 (
MTYPE_AS_PATH
,  (
a•©h
));

646 i‡(
a•©h
->
£gmíts
)

647 
√w
->
£gmíts
 = 
	`as£gmít_dup_Æl
 (
a•©h
->segments);

649 i‡(!
a•©h
->
°r
)

650  
√w
;

652 
√w
->
°r
 = 
	`XMALLOC
 (
MTYPE_AS_STR
, 
buÊí
);

653 
√w
->
°r_Àn
 = 
a•©h
->str_len;

656 i‡(
a•©h
->
°r_Àn
 > 0)

657 
	`mem˝y
 (
√w
->
°r
, 
a•©h
->°r, 
buÊí
);

659 
√w
->
°r
[0] = '\0';

661  
√w
;

662 
	}
}

665 
	$a•©h_hash_Æloc
 (*
¨g
)

667 c⁄° 
a•©h
 *a•©h = 
¨g
;

668 
a•©h
 *
√w
;

671 
	`as£π
 (
a•©h
->
°r
);

672 i‡(! 
a•©h
->
°r
)

673  
NULL
;

676 
√w
 = 
	`XMALLOC
 (
MTYPE_AS_PATH
,  (
a•©h
));

679 
√w
->
ªf˙t
 = 0;

680 
√w
->
£gmíts
 = 
a•©h
->segments;

681 
√w
->
°r
 = 
a•©h
->str;

682 
√w
->
°r_Àn
 = 
a•©h
->str_len;

684  
√w
;

685 
	}
}

689 
	$as£gmíts_∑r£
 (
°ªam
 *
s
, 
size_t
 
Àngth
,

690 
as£gmít
 **
ªsu…
, 
u£32bô
)

692 
as£gmít_hódî
 
£gh
;

693 
as£gmít
 *
£g
, *
¥ev
 = 
NULL
, *
hód
 = NULL;

694 
size_t
 
byãs
 = 0;

697 i‡(
Àngth
 == 0)

700 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4_SEGMENT
))

701 
	`zlog_debug
 ("[AS4SEG] Parseáspath segment: gotÅotal byteÜength %lu",

702 (Ë
Àngth
);

704 i‡((
	`STREAM_READABLE
(
s
Ë< 
Àngth
)

705 || (
	`STREAM_READABLE
(
s
Ë< 
AS_HEADER_SIZE
)

706 || (
Àngth
 % 
AS16_VALUE_SIZE
 ))

709 
byãs
 < 
Àngth
)

711 
i
;

712 
size_t
 
£g_size
;

714 i‡((
Àngth
 - 
byãs
Ë<
AS_HEADER_SIZE
)

716 i‡(
hód
)

717 
	`as£gmít_‰ì_Æl
 (
hód
);

722 
£gh
.
ty≥
 = 
	`°ªam_gëc
 (
s
);

723 
£gh
.
Àngth
 = 
	`°ªam_gëc
 (
s
);

725 
£g_size
 = 
	`ASSEGMENT_SIZE
(
£gh
.
Àngth
, 
u£32bô
);

727 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4_SEGMENT
))

728 
	`zlog_debug
 ("[AS4SEG] Parseáspath segment: gotÅype %d,Üength %d",

729 
£gh
.
ty≥
, segh.
Àngth
);

732 i‡–((
byãs
 + 
£g_size
Ë> 
Àngth
)

734 || (
£gh
.
Àngth
 == 0)

739 || (( 
£gh
.
Àngth
 > 1)

740 && (0x10 + 
£gh
.
Àngth
 > 0x10 + 
AS_SEGMENT_MAX
)))

742 i‡(
hód
)

743 
	`as£gmít_‰ì_Æl
 (
hód
);

747 
£gh
.
ty≥
)

749 
AS_SEQUENCE
:

750 
AS_SET
:

751 
AS_CONFED_SEQUENCE
:

752 
AS_CONFED_SET
:

755 i‡(
hód
)

756 
	`as£gmít_‰ì_Æl
 (
hód
);

761 
£g
 = 
	`as£gmít_√w
 (
£gh
.
ty≥
, segh.
Àngth
);

763 i‡(
hód
)

764 
¥ev
->
√xt
 = 
£g
;

766 
hód
 = 
¥ev
 = 
£g
;

768 
i
 = 0; i < 
£gh
.
Àngth
; i++)

769 
£g
->
as
[
i
] = (
u£32bô
Ë? 
	`°ªam_gël
 (
s
Ë: 
	`°ªam_gëw
 (s);

771 
byãs
 +
£g_size
;

773 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4_SEGMENT
))

774 
	`zlog_debug
 ("[AS4SEG] Parseáspath segment: BytesÇow: %lu",

775 (Ë
byãs
);

777 
¥ev
 = 
£g
;

780 *
ªsu…
 = 
	`as£gmít_n‹mÆi£
 (
hód
);

782 
	}
}

790 
a•©h
 *

791 
	$a•©h_∑r£
 (
°ªam
 *
s
, 
size_t
 
Àngth
, 
u£32bô
)

793 
a•©h
 
as
;

794 
a•©h
 *
föd
;

802 i‡(
Àngth
 % 
AS16_VALUE_SIZE
 )

803  
NULL
;

804 #ifde‡
USE_SRX


805 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4_SEGMENT
))

807 
size_t
 
i
 = 
	`°ªam_gë_gëp
 (
s
);

808 
	`zlog_debug
 ("[AS4SEG]áspath_parse: dump streamÜength:%d - getp:%d ",\

809 ()
Àngth
, 
	`°ªam_gëc_‰om
(
s
, 
i
) );

810 
size_t
 
tŸ
 = 
Àngth
 + 
i
, 
öc
=0;

811 ; 
i
 < 
tŸ
; i++)

813 i‡(++
öc
 % 16 == 0)

815 
	`¥ötf
("\n");

817 
	`¥ötf
("%02x ", 
s
->
d©a
[
i
]);

819 
	`¥ötf
(" - from[%s]\n", 
__FUNCTION__
);

823 
	`mem£t
 (&
as
, 0,  (
a•©h
));

824 i‡(
	`as£gmíts_∑r£
 (
s
, 
Àngth
, &
as
.
£gmíts
, 
u£32bô
) < 0)

825  
NULL
;

828 
föd
 = 
	`hash_gë
 (
ashash
, &
as
, 
a•©h_hash_Æloc
);

831 
	`as£π
 (
föd
);

834 i‡(
föd
->
ªf˙t
)

836 
	`as£gmít_‰ì_Æl
 (
as
.
£gmíts
);

838 
	`XFREE
 (
MTYPE_AS_STR
, 
as
.
°r
);

841 
föd
->
ªf˙t
++;

843  
föd
;

844 
	}
}

847 
	$as£gmít_d©a_put
 (
°ªam
 *
s
, 
as_t
 *
as
, 
num
, 
u£32bô
)

849 
i
;

850 
	`as£π
 (
num
 <
AS_SEGMENT_MAX
);

852 
i
 = 0; i < 
num
; i++)

853 i‡–
u£32bô
 )

854 
	`°ªam_pué
 (
s
, 
as
[
i
]);

857 i‡–
as
[
i
] <
BGP_AS_MAX
 )

858 
	`°ªam_putw
(
s
, 
as
[
i
]);

860 
	`°ªam_putw
(
s
, 
BGP_AS_TRANS
);

862 
	}
}

864 
size_t


865 
	$as£gmít_hódî_put
 (
°ªam
 *
s
, 
u_ch¨
 
ty≥
, 
Àngth
)

867 
size_t
 
À≈
;

868 
	`as£π
 (
Àngth
 <
AS_SEGMENT_MAX
);

869 
	`°ªam_putc
 (
s
, 
ty≥
);

870 
À≈
 = 
	`°ªam_gë_ídp
 (
s
);

871 
	`°ªam_putc
 (
s
, 
Àngth
);

872  
À≈
;

873 
	}
}

876 
size_t


877 
	$a•©h_put
 (
°ªam
 *
s
, 
a•©h
 *
as
, 
u£32bô
 )

879 
as£gmít
 *
£g
 = 
as
->
£gmíts
;

880 
size_t
 
byãs
 = 0;

882 i‡(!
£g
 || seg->
Àngth
 == 0)

885 i‡(
£g
)

895 
£g
 && (
	`ASSEGMENT_LEN
(£g, 
u£32bô
Ë<
	`STREAM_WRITEABLE
(
s
)))

897 
as£gmít
 *
√xt
 = 
£g
->next;

898 
wrôãn
 = 0;

899 
a¢s_∑cked
 = 0;

900 
size_t
 
À≈
;

903  (
£g
->
Àngth
 - 
wrôãn
Ë> 
AS_SEGMENT_MAX
)

905 
	`as£gmít_hódî_put
 (
s
, 
£g
->
ty≥
, 
AS_SEGMENT_MAX
);

906 
	`as£gmít_d©a_put
 (
s
, 
£g
->
as
, 
AS_SEGMENT_MAX
, 
u£32bô
);

907 
wrôãn
 +
AS_SEGMENT_MAX
;

908 
byãs
 +
	`ASSEGMENT_SIZE
 (
wrôãn
, 
u£32bô
);

912 
À≈
 = 
	`as£gmít_hódî_put
 (
s
, 
£g
->
ty≥
, seg->
Àngth
 - 
wrôãn
);

913 
	`as£gmít_d©a_put
 (
s
, (
£g
->
as
 + 
wrôãn
), seg->
Àngth
 - written,

914 
u£32bô
);

920 
√xt
 && 
	`ASSEGMENTS_PACKABLE
 (
£g
,Çext))

932 
	`as£gmít_d©a_put
 (
s
, 
√xt
->
as
,Çext->
Àngth
, 
u£32bô
);

935 
	`°ªam_putc_©
 (
s
, 
À≈
, 
£g
->
Àngth
 - 
wrôãn
 + 
√xt
->length);

936 
a¢s_∑cked
 +
√xt
->
Àngth
;

938 
√xt
 =Çext->next;

941 
byãs
 +
	`ASSEGMENT_SIZE
 (
£g
->
Àngth
 - 
wrôãn
 + 
a¢s_∑cked
,

942 
u£32bô
);

943 
£g
 = 
√xt
;

946  
byãs
;

947 
	}
}

953 
u_ch¨
 *

954 
	$a•©h_¢mp_∑th£g
 (
a•©h
 *
as
, 
size_t
 *
v¨Àn
)

956 
	#SNMP_PATHSEG_MAX
 1024

	)

958 i‡(!
¢mp_°ªam
)

959 
¢mp_°ªam
 = 
	`°ªam_√w
 (
SNMP_PATHSEG_MAX
);

961 
	`°ªam_ª£t
 (
¢mp_°ªam
);

963 i‡(!
as
)

965 *
v¨Àn
 = 0;

966  
NULL
;

968 
	`a•©h_put
 (
¢mp_°ªam
, 
as
, 0);

970 *
v¨Àn
 = 
	`°ªam_gë_ídp
 (
¢mp_°ªam
);

971  
	`°ªam_≤t
(
¢mp_°ªam
);

972 
	}
}

974 
	#mö
(
A
,
B
Ë((AË< (BË? (AË: (B))

	)

976 
as£gmít
 *

977 
	$a•©h_aggªg©e_as_£t_add
 (
a•©h
 *a•©h, 
as£gmít
 *
as£t
,

978 
as_t
 
as
)

980 
i
;

983 i‡(
as£t
 =
NULL
)

985 
as£t
 = 
	`as£gmít_√w
 (
AS_SET
, 1);

986 i‡(! 
a•©h
->
£gmíts
)

987 
a•©h
->
£gmíts
 = 
as£t
;

990 
as£gmít
 *
£g
 = 
a•©h
->
£gmíts
;

991 
£g
->
√xt
)

992 
£g
 = seg->
√xt
;

993 
£g
->
√xt
 = 
as£t
;

995 
as£t
->
ty≥
 = 
AS_SET
;

996 
as£t
->
Àngth
 = 1;

997 
as£t
->
as
[0] =ás;

1002 
i
 = 0; i < 
as£t
->
Àngth
; i++)

1003 i‡(
as£t
->
as
[
i
] ==ás)

1004  
as£t
;

1006 
as£t
->
Àngth
++;

1007 
as£t
->
as
 = 
	`XREALLOC
 (
MTYPE_AS_SEG_DATA
,ásset->as,

1008 
as£t
->
Àngth
 * 
AS_VALUE_SIZE
);

1009 
as£t
->
as
[as£t->
Àngth
 - 1] =ás;

1013  
as£t
;

1014 
	}
}

1017 
a•©h
 *

1018 
	$a•©h_aggªg©e
 (
a•©h
 *
as1
, a•©h *
as2
)

1020 
i
;

1021 
möÀn
;

1022 
m©ch
;

1023 
‰om
;

1024 
as£gmít
 *
£g1
 = 
as1
->
£gmíts
;

1025 
as£gmít
 *
£g2
 = 
as2
->
£gmíts
;

1026 
a•©h
 *a•©h = 
NULL
;

1027 
as£gmít
 *
as£t
;

1028 
as£gmít
 *
¥ev£g
 = 
NULL
;

1030 
m©ch
 = 0;

1031 
möÀn
 = 0;

1032 
a•©h
 = 
NULL
;

1033 
as£t
 = 
NULL
;

1036 
£g1
 && 
£g2
)

1039 i‡(
£g1
->
ty≥
 !
£g2
->type)

1043 
möÀn
 = 
	`mö
 (
£g1
->
Àngth
, 
£g2
->length);

1045 
m©ch
 = 0; m©ch < 
möÀn
; match++)

1046 i‡(
£g1
->
as
[
m©ch
] !
£g2
->as[match])

1049 i‡(
m©ch
)

1051 
as£gmít
 *
£g
 = 
	`as£gmít_√w
 (
£g1
->
ty≥
, 0);

1053 
£g
 = 
	`as£gmít_≠≥nd_a¢s
 (£g, 
£g1
->
as
, 
m©ch
);

1055 i‡(! 
a•©h
)

1057 
a•©h
 = 
	`a•©h_√w
 ();

1058 
a•©h
->
£gmíts
 = 
£g
;

1061 
¥ev£g
->
√xt
 = 
£g
;

1063 
¥ev£g
 = 
£g
;

1066 i‡(
m©ch
 !
möÀn
 || m©ch !
£g1
->
Àngth


1067 || 
£g1
->
Àngth
 !
£g2
->length)

1070 
£g1
 = seg1->
√xt
;

1071 
£g2
 = seg2->
√xt
;

1074 i‡(! 
a•©h
)

1075 
a•©h
 = 
	`a•©h_√w
();

1078 
‰om
 = 
m©ch
;

1079 
£g1
)

1081 
i
 = 
‰om
; i < 
£g1
->
Àngth
; i++)

1082 
as£t
 = 
	`a•©h_aggªg©e_as_£t_add
 (
a•©h
,ás£t, 
£g1
->
as
[
i
]);

1084 
‰om
 = 0;

1085 
£g1
 = seg1->
√xt
;

1088 
‰om
 = 
m©ch
;

1089 
£g2
)

1091 
i
 = 
‰om
; i < 
£g2
->
Àngth
; i++)

1092 
as£t
 = 
	`a•©h_aggªg©e_as_£t_add
 (
a•©h
,ás£t, 
£g2
->
as
[
i
]);

1094 
‰om
 = 0;

1095 
£g2
 = seg2->
√xt
;

1098 
	`as£gmít_n‹mÆi£
 (
a•©h
->
£gmíts
);

1099 
	`a•©h_°r_upd©e
 (
a•©h
);

1100  
a•©h
;

1101 
	}
}

1107 
	$a•©h_fú°as_check
 (
a•©h
 *a•©h, 
as_t
 
a¢o
)

1109 i‡–(
a•©h
 =
NULL
Ë|| (a•©h->
£gmíts
 == NULL) )

1112 i‡(
a•©h
->
£gmíts


1113 && (
a•©h
->
£gmíts
->
ty≥
 =
AS_SEQUENCE
)

1114 && (
a•©h
->
£gmíts
->
as
[0] =
a¢o
 ))

1118 
	}
}

1122 
	$a•©h_lo›_check
 (
a•©h
 *a•©h, 
as_t
 
a¢o
)

1124 
as£gmít
 *
£g
;

1125 
cou¡
 = 0;

1127 i‡–(
a•©h
 =
NULL
Ë|| (a•©h->
£gmíts
 == NULL) )

1130 
£g
 = 
a•©h
->
£gmíts
;

1132 
£g
)

1134 
i
;

1136 
i
 = 0; i < 
£g
->
Àngth
; i++)

1137 i‡(
£g
->
as
[
i
] =
a¢o
)

1138 
cou¡
++;

1140 
£g
 = seg->
√xt
;

1142  
cou¡
;

1143 
	}
}

1147 
	$a•©h_¥iv©e_as_check
 (
a•©h
 *aspath)

1149 
as£gmít
 *
£g
;

1151 i‡–!(
a•©h
 &&á•©h->
£gmíts
) )

1154 
£g
 = 
a•©h
->
£gmíts
;

1156 
£g
)

1158 
i
;

1160 
i
 = 0; i < 
£g
->
Àngth
; i++)

1162 i‡–(
£g
->
as
[
i
] < 
BGP_PRIVATE_AS_MIN
)

1163 || (
£g
->
as
[
i
] > 
BGP_PRIVATE_AS_MAX
) )

1166 
£g
 = seg->
√xt
;

1169 
	}
}

1173 
	$a•©h_c⁄„d_check
 (
a•©h
 *aspath)

1175 
as£gmít
 *
£g
;

1177 i‡–!(
a•©h
 &&á•©h->
£gmíts
) )

1180 
£g
 = 
a•©h
->
£gmíts
;

1182 
£g
)

1184 i‡(
£g
->
ty≥
 =
AS_CONFED_SET
 || seg->ty≥ =
AS_CONFED_SEQUENCE
)

1186 
£g
 = seg->
√xt
;

1189 
	}
}

1194 
	$a•©h_À·_c⁄„d_check
 (
a•©h
 *aspath)

1197 i‡–!(
a•©h
 &&á•©h->
£gmíts
) )

1200 i‡–(
a•©h
->
£gmíts
->
ty≥
 =
AS_CONFED_SEQUENCE
)

1201 || (
a•©h
->
£gmíts
->
ty≥
 =
AS_CONFED_SET
) )

1205 
	}
}

1208 
a•©h
 *

1209 
	$a•©h_mîge
 (
a•©h
 *
as1
, a•©h *
as2
)

1211 
as£gmít
 *
œ°
, *
√w
;

1213 i‡(! 
as1
 || ! 
as2
)

1214  
NULL
;

1216 
œ°
 = 
√w
 = 
	`as£gmít_dup_Æl
 (
as1
->
£gmíts
);

1219 
œ°
 &&Üa°->
√xt
)

1220 
œ°
 =Üa°->
√xt
;

1222 
œ°
->
√xt
 = 
as2
->
£gmíts
;

1223 
as2
->
£gmíts
 = 
√w
;

1224 
	`a•©h_°r_upd©e
 (
as2
);

1225  
as2
;

1226 
	}
}

1229 
a•©h
 *

1230 
	$a•©h_¥ïíd
 (
a•©h
 *
as1
, a•©h *
as2
)

1232 
as£gmít
 *
£g1
;

1233 
as£gmít
 *
£g2
;

1235 i‡(! 
as1
 || ! 
as2
)

1236  
NULL
;

1238 
£g1
 = 
as1
->
£gmíts
;

1239 
£g2
 = 
as2
->
£gmíts
;

1242 i‡(
£g2
 =
NULL
)

1244 
as2
->
£gmíts
 = 
	`as£gmít_dup_Æl
 (
as1
->segments);

1245 
	`a•©h_°r_upd©e
 (
as2
);

1246  
as2
;

1250 i‡(
£g1
 =
NULL
)

1251  
as2
;

1254 
£g1
 && seg1->
√xt
)

1255 
£g1
 = seg1->
√xt
;

1258 i‡(
£g1
->
ty≥
 =
AS_SEQUENCE
 && 
£g2
->ty≥ =
AS_CONFED_SEQUENCE
)

1259 
as2
 = 
	`a•©h_dñëe_c⁄„d_£q
 (as2);

1262 i‡(
£g1
->
ty≥
 !
£g2
->type)

1263  
	`a•©h_mîge
 (
as1
, 
as2
);

1265 i‡(
£g1
->
ty≥
 =
AS_SEQUENCE
)

1277 
£g1
 = 
as2
->
£gmíts
 = 
	`as£gmít_dup_Æl
 (
as1
->segments);

1280 
£g1
 && seg1->
√xt
)

1281 
£g1
 = seg1->
√xt
;

1284 
£g1
 = 
	`as£gmít_≠≥nd_a¢s
 (£g1, 
£g2
->
as
, seg2->
Àngth
);

1289 
£g1
->
√xt
 = 
£g2
->next;

1292 
	`as£gmít_‰ì
 (
£g2
);

1297 
	`a•©h_°r_upd©e
 (
as2
);

1298  
as2
;

1303  
	`a•©h_mîge
 (
as1
, 
as2
);

1308 
	}
}

1316 
a•©h
 *

1317 
	$a•©h_fûãr_ex˛ude
 (
a•©h
 * 
sour˚
, a•©h * 
ex˛ude_li°
)

1319 
as£gmít
 * 
§c£g
, * 
ex˛£g
, * 
œ°£g
;

1320 
a•©h
 * 
√w∑th
;

1322 
√w∑th
 = 
	`a•©h_√w
();

1323 
œ°£g
 = 
NULL
;

1325 
§c£g
 = 
sour˚
->
£gmíts
; src£g; src£g = src£g->
√xt
)

1327 
i
, 
y
, 
√wÀn
 = 0, 
d⁄e
 = 0, 
skù_as
;

1328 
as£gmít
 * 
√w£g
;

1334 
i
 = 0; i < 
§c£g
->
Àngth
; i++)

1336 
skù_as
 = 0;

1337 
ex˛£g
 = 
ex˛ude_li°
->
£gmíts
;Éx˛£g && !
skù_as
;Éx˛£g =Éx˛£g->
√xt
)

1338 
y
 = 0; y < 
ex˛£g
->
Àngth
; y++)

1339 i‡(
§c£g
->
as
[
i
] =
ex˛£g
->as[
y
])

1341 
skù_as
 = 1;

1345 i‡(!
skù_as
)

1346 
√wÀn
++;

1349 i‡(!
√wÀn
)

1353 
√w£g
 = 
	`as£gmít_√w
 (
§c£g
->
ty≥
, 
√wÀn
);

1354 
i
 = 0; i < 
§c£g
->
Àngth
; i++)

1356 
skù_as
 = 0;

1357 
ex˛£g
 = 
ex˛ude_li°
->
£gmíts
;Éx˛£g && !
skù_as
;Éx˛£g =Éx˛£g->
√xt
)

1358 
y
 = 0; y < 
ex˛£g
->
Àngth
; y++)

1359 i‡(
§c£g
->
as
[
i
] =
ex˛£g
->as[
y
])

1361 
skù_as
 = 1;

1364 i‡(
skù_as
)

1366 
√w£g
->
as
[
d⁄e
++] = 
§c£g
->as[
i
];

1370 i‡(!
œ°£g
)

1371 
√w∑th
->
£gmíts
 = 
√w£g
;

1373 
œ°£g
->
√xt
 = 
√w£g
;

1374 
œ°£g
 = 
√w£g
;

1376 
	`a•©h_°r_upd©e
 (
√w∑th
);

1381 
	`a•©h_‰ì
 (
sour˚
);

1382  
√w∑th
;

1383 
	}
}

1386 
a•©h
 *

1387 
	$a•©h_add_⁄e_as
 (
a•©h
 *a•©h, 
as_t
 
a¢o
, 
u_ch¨
 
ty≥
)

1389 
as£gmít
 *as£gmíà
a•©h
->
£gmíts
;

1392 i‡(
as£gmít
 =
NULL
 ||ás£gmít->
Àngth
 == 0)

1394 
a•©h
->
£gmíts
 = 
	`as£gmít_√w
 (
ty≥
, 1);

1395 
a•©h
->
£gmíts
->
as
[0] = 
a¢o
;

1397 i‡(
as£gmít
)

1398 
	`as£gmít_‰ì
 (
as£gmít
);

1400  
a•©h
;

1403 i‡(
as£gmít
->
ty≥
 ==Åype)

1404 
a•©h
->
£gmíts
 = 
	`as£gmít_¥ïíd_a¢s
 (a•©h->£gmíts, 
a¢o
, 1);

1410 
as£gmít
 *
√w£gmít
;

1412 
√w£gmít
 = 
	`as£gmít_√w
 (
ty≥
, 1);

1413 
√w£gmít
->
as
[0] = 
a¢o
;

1415 
√w£gmít
->
√xt
 = 
as£gmít
;

1416 
a•©h
->
£gmíts
 = 
√w£gmít
;

1419  
a•©h
;

1420 
	}
}

1423 
a•©h
 *

1424 
	$a•©h_add_£q
 (
a•©h
 *a•©h, 
as_t
 
a¢o
)

1426  
	`a•©h_add_⁄e_as
 (
a•©h
, 
a¢o
, 
AS_SEQUENCE
);

1427 
	}
}

1432 
	$a•©h_cmp_À·
 (c⁄° 
a•©h
 *
a•©h1
, c⁄° a•©h *
a•©h2
)

1434 c⁄° 
as£gmít
 *
£g1
;

1435 c⁄° 
as£gmít
 *
£g2
;

1437 i‡(!(
a•©h1
 && 
a•©h2
))

1440 
£g1
 = 
a•©h1
->
£gmíts
;

1441 
£g2
 = 
a•©h2
->
£gmíts
;

1444 
£g1
 && ((£g1->
ty≥
 =
AS_CONFED_SEQUENCE
)

1445 || (
£g1
->
ty≥
 =
AS_CONFED_SET
)))

1446 
£g1
 = seg1->
√xt
;

1448 
£g2
 && ((£g2->
ty≥
 =
AS_CONFED_SEQUENCE
)

1449 || (
£g2
->
ty≥
 =
AS_CONFED_SET
)))

1450 
£g2
 = seg2->
√xt
;

1453 i‡(!(
£g1
 && 
£g2


1454 && (
£g1
->
ty≥
 =
AS_SEQUENCE
Ë&& (
£g2
->type == AS_SEQUENCE)))

1457 i‡(
£g1
->
as
[0] =
£g2
->as[0])

1461 
	}
}

1469 
a•©h
 *

1470 
	$a•©h_ªc⁄cûe_as4
 ( 
a•©h
 *a•©h, a•©h *
as4∑th
)

1472 
as£gmít
 *
£g
, *
√w£g
, *
¥ev£g
 = 
NULL
;

1473 
a•©h
 *
√w∑th
 = 
NULL
, *
mîged∑th
;

1474 
h›s
, 
˝a¢s
 = 0;

1476 i‡(!
a•©h
)

1477  
NULL
;

1479 
£g
 = 
a•©h
->
£gmíts
;

1482 
h›s
 = (
	`a•©h_cou¡_h›s
 (
a•©h
Ë+ 
	`a•©h_cou¡_c⁄„ds
 (aspath))

1483 - 
	`a•©h_cou¡_h›s
 (
as4∑th
);

1485 i‡(
h›s
 < 0)

1487 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4
))

1488 
	`zlog_w¨n
 ("[AS4] Fewer hops in AS_PATHÅhan NEW_AS_PATH");

1493 
h›s
 = 
	`a•©h_cou¡_h›s
 (
a•©h
);

1496 i‡(!
h›s
)

1497  
	`a•©h_dup
 (
as4∑th
);

1499 i‡–
	`BGP_DEBUG
(
as4
, 
AS4
))

1500 
	`zlog_debug
("[AS4] got AS_PATH %sánd AS4_PATH %s synthesizingÇow",

1501 
a•©h
->
°r
, 
as4∑th
->str);

1503 
£g
 && 
h›s
 > 0)

1505 
£g
->
ty≥
)

1507 
AS_SET
:

1508 
AS_CONFED_SET
:

1509 
h›s
--;

1510 
˝a¢s
 = 
£g
->
Àngth
;

1512 
AS_CONFED_SEQUENCE
:

1520 i‡(
h›s
 < 
£g
->
Àngth
)

1522 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4
))

1523 
	`zlog_debug
 ("[AS4] AS4PATHmangle: AS_CONFED_SEQUENCE falls"

1525 
h›s
 = 
£g
->
Àngth
;

1527 
AS_SEQUENCE
:

1528 
˝a¢s
 = 
	`MIN
(
£g
->
Àngth
, 
h›s
);

1529 
h›s
 -
£g
->
Àngth
;

1532 
	`as£π
 (
˝a¢s
 <
£g
->
Àngth
);

1534 
√w£g
 = 
	`as£gmít_√w
 (
£g
->
ty≥
, 0);

1535 
√w£g
 = 
	`as£gmít_≠≥nd_a¢s
 (√w£g, 
£g
->
as
, 
˝a¢s
);

1537 i‡(!
√w∑th
)

1539 
√w∑th
 = 
	`a•©h_√w
 ();

1540 
√w∑th
->
£gmíts
 = 
√w£g
;

1543 
¥ev£g
->
√xt
 = 
√w£g
;

1545 
¥ev£g
 = 
√w£g
;

1546 
£g
 = seg->
√xt
;

1553 
mîged∑th
 = 
	`a•©h_mîge
 (
√w∑th
, 
	`a•©h_dup
(
as4∑th
));

1554 
	`a•©h_‰ì
 (
√w∑th
);

1555 
mîged∑th
->
£gmíts
 = 
	`as£gmít_n‹mÆi£
 (mergedpath->segments);

1556 
	`a•©h_°r_upd©e
 (
mîged∑th
);

1558 i‡–
	`BGP_DEBUG
(
as4
, 
AS4
))

1559 
	`zlog_debug
 ("[AS4]Ñesult of synthesizing is %s",

1560 
mîged∑th
->
°r
);

1562  
mîged∑th
;

1563 
	}
}

1569 
	$a•©h_cmp_À·_c⁄„d
 (c⁄° 
a•©h
 *
a•©h1
, c⁄° a•©h *
a•©h2
)

1571 i‡(! (
a•©h1
 && 
a•©h2
) )

1574 i‡–!(
a•©h1
->
£gmíts
 && 
a•©h2
->segments) )

1577 i‡–(
a•©h1
->
£gmíts
->
ty≥
 !
AS_CONFED_SEQUENCE
)

1578 || (
a•©h2
->
£gmíts
->
ty≥
 !
AS_CONFED_SEQUENCE
) )

1581 i‡(
a•©h1
->
£gmíts
->
as
[0] =
a•©h2
->segments->as[0])

1585 
	}
}

1589 
a•©h
 *

1590 
	$a•©h_dñëe_c⁄„d_£q
 (
a•©h
 *aspath)

1592 
as£gmít
 *
£g
;

1594 i‡(!(
a•©h
 &&á•©h->
£gmíts
))

1595  
a•©h
;

1597 
£g
 = 
a•©h
->
£gmíts
;

1602 i‡(
a•©h
->
£gmíts
->
ty≥
 !
AS_CONFED_SEQUENCE
)

1603  
a•©h
;

1609 
£g
 &&

1610 (
£g
->
ty≥
 =
AS_CONFED_SEQUENCE
 || seg->ty≥ =
AS_CONFED_SET
))

1612 
a•©h
->
£gmíts
 = 
£g
->
√xt
;

1613 
	`as£gmít_‰ì
 (
£g
);

1614 
£g
 = 
a•©h
->
£gmíts
;

1616 
	`a•©h_°r_upd©e
 (
a•©h
);

1617  
a•©h
;

1618 
	}
}

1622 
a•©h
*

1623 
	$a•©h_add_c⁄„d_£q
 (
a•©h
 *a•©h, 
as_t
 
a¢o
)

1625  
	`a•©h_add_⁄e_as
 (
a•©h
, 
a¢o
, 
AS_CONFED_SEQUENCE
);

1626 
	}
}

1630 
	$a•©h_as_add
 (
a•©h
 *
as
, 
as_t
 
a¢o
)

1632 
as£gmít
 *
£g
 = 
as
->
£gmíts
;

1634 i‡(!
£g
)

1638 
£g
->
√xt
)

1639 
£g
 = seg->
√xt
;

1641 
	`as£gmít_≠≥nd_a¢s
 (
£g
, &
a¢o
, 1);

1642 
	}
}

1646 
	$a•©h_£gmít_add
 (
a•©h
 *
as
, 
ty≥
)

1648 
as£gmít
 *
£g
 = 
as
->
£gmíts
;

1649 
as£gmít
 *
√w
 = 
	`as£gmít_√w
 (
ty≥
, 0);

1651 i‡(
£g
)

1653 
£g
->
√xt
)

1654 
£g
 = seg->
√xt
;

1655 
£g
->
√xt
 = 
√w
;

1658 
as
->
£gmíts
 = 
√w
;

1659 
	}
}

1661 
a•©h
 *

1662 
	$a•©h_em±y
 ()

1664  
	`a•©h_∑r£
 (
NULL
, 0, 1);

1665 
	}
}

1667 
a•©h
 *

1668 
	$a•©h_em±y_gë
 ()

1670 
a•©h
 *aspath;

1672 
a•©h
 = 
	`a•©h_√w
 ();

1673 
	`a•©h_make_°r_cou¡
 (
a•©h
);

1674  
a•©h
;

1675 
	}
}

1678 
	$a•©h_cou¡
 ()

1680  
ashash
->
cou¡
;

1681 
	}
}

1693 
	eas_tokí


1695 
	mas_tokí_asvÆ
,

1696 
	mas_tokí_£t_°¨t
,

1697 
	mas_tokí_£t_íd
,

1698 
	mas_tokí_c⁄„d_£q_°¨t
,

1699 
	mas_tokí_c⁄„d_£q_íd
,

1700 
	mas_tokí_c⁄„d_£t_°¨t
,

1701 
	mas_tokí_c⁄„d_£t_íd
,

1702 
	mas_tokí_unknown


1707 
	$a•©h_gëtokí
 (c⁄° *
buf
, 
as_tokí
 *
tokí
, 
u_l⁄g
 *
a¢o
)

1709 c⁄° *
p
 = 
buf
;

1712 
	`is•a˚
 ((Ë*
p
) || *p == ',')

1713 
p
++;

1717 *
p
)

1720  
NULL
;

1722 *
tokí
 = 
as_tokí_£t_°¨t
;

1723 
p
++;

1724  
p
;

1726 *
tokí
 = 
as_tokí_£t_íd
;

1727 
p
++;

1728  
p
;

1730 *
tokí
 = 
as_tokí_c⁄„d_£q_°¨t
;

1731 
p
++;

1732  
p
;

1734 *
tokí
 = 
as_tokí_c⁄„d_£q_íd
;

1735 
p
++;

1736  
p
;

1738 *
tokí
 = 
as_tokí_c⁄„d_£t_°¨t
;

1739 
p
++;

1740  
p
;

1742 *
tokí
 = 
as_tokí_c⁄„d_£t_íd
;

1743 
p
++;

1744  
p
;

1748 i‡(
	`isdigô
 ((Ë*
p
))

1750 
as_t
 
asvÆ
;

1752 *
tokí
 = 
as_tokí_asvÆ
;

1753 
asvÆ
 = (*
p
 - '0');

1754 
p
++;

1756 
	`isdigô
 ((Ë*
p
))

1758 
asvÆ
 *= 10;

1759 
asvÆ
 +(*
p
 - '0');

1760 
p
++;

1762 *
a¢o
 = 
asvÆ
;

1763  
p
;

1767 *
tokí
 = 
as_tokí_unknown
;

1768  
p
++;

1769 
	}
}

1771 
a•©h
 *

1772 
	$a•©h_°r2a•©h
 (c⁄° *
°r
)

1774 
as_tokí
 
tokí
 = 
as_tokí_unknown
;

1775 
u_sh‹t
 
as_ty≥
;

1776 
u_l⁄g
 
a¢o
 = 0;

1777 
a•©h
 *aspath;

1778 
√edty≥
;

1780 
a•©h
 = 
	`a•©h_√w
 ();

1783 
as_ty≥
 = 
AS_SEQUENCE
;

1784 
√edty≥
 = 1;

1786 (
°r
 = 
	`a•©h_gëtokí
 (°r, &
tokí
, &
a¢o
)Ë!
NULL
)

1788 
tokí
)

1790 
as_tokí_asvÆ
:

1791 i‡(
√edty≥
)

1793 
	`a•©h_£gmít_add
 (
a•©h
, 
as_ty≥
);

1794 
√edty≥
 = 0;

1796 
	`a•©h_as_add
 (
a•©h
, 
a¢o
);

1798 
as_tokí_£t_°¨t
:

1799 
as_ty≥
 = 
AS_SET
;

1800 
	`a•©h_£gmít_add
 (
a•©h
, 
as_ty≥
);

1801 
√edty≥
 = 0;

1803 
as_tokí_£t_íd
:

1804 
as_ty≥
 = 
AS_SEQUENCE
;

1805 
√edty≥
 = 1;

1807 
as_tokí_c⁄„d_£q_°¨t
:

1808 
as_ty≥
 = 
AS_CONFED_SEQUENCE
;

1809 
	`a•©h_£gmít_add
 (
a•©h
, 
as_ty≥
);

1810 
√edty≥
 = 0;

1812 
as_tokí_c⁄„d_£q_íd
:

1813 
as_ty≥
 = 
AS_SEQUENCE
;

1814 
√edty≥
 = 1;

1816 
as_tokí_c⁄„d_£t_°¨t
:

1817 
as_ty≥
 = 
AS_CONFED_SET
;

1818 
	`a•©h_£gmít_add
 (
a•©h
, 
as_ty≥
);

1819 
√edty≥
 = 0;

1821 
as_tokí_c⁄„d_£t_íd
:

1822 
as_ty≥
 = 
AS_SEQUENCE
;

1823 
√edty≥
 = 1;

1825 
as_tokí_unknown
:

1827 
	`a•©h_‰ì
 (
a•©h
);

1828  
NULL
;

1832 
	`a•©h_make_°r_cou¡
 (
a•©h
);

1834  
a•©h
;

1835 
	}
}

1839 
	$a•©h_key_make
 (*
p
)

1841 
a•©h
 *a•©h = (a•©h *Ë
p
;

1842 
key
 = 0;

1844 i‡(!
a•©h
->
°r
)

1845 
	`a•©h_°r_upd©e
 (
a•©h
);

1847 
key
 = 
	`jhash
 (
a•©h
->
°r
,á•©h->
°r_Àn
, 2334325);

1849  
key
;

1850 
	}
}

1852 #ifde‡
USE_SRX


1863 
as_t
 
	$a•©h_‹igö_as
 (
a•©h
 *
≠
)

1865 
as£gmít
* 
c£g
;

1866 
as_t
 
ﬂs
 = 0;

1868 i‡(
≠
 =
NULL
)

1875 
c£g
 = 
≠
->
£gmíts
; c£g; c£g = c£g->
√xt
)

1877 i‡(
c£g
->
ty≥
 =
AS_SEQUENCE
)

1879 
ﬂs
 = 
c£g
->
as
[c£g->
Àngth
 - 1];

1881 i‡(
c£g
->
ty≥
 =
AS_SET
)

1885 
ﬂs
 = 
UNKNOWN_ASN
;

1890  
ﬂs
;

1891 
	}
}

1896 
	$a•©h_cmp
 (c⁄° *
¨g1
, c⁄° *
¨g2
)

1898 c⁄° 
as£gmít
 *
£g1
 = ((c⁄° 
a•©h
 *)
¨g1
)->
£gmíts
;

1899 c⁄° 
as£gmít
 *
£g2
 = ((c⁄° 
a•©h
 *)
¨g2
)->
£gmíts
;

1901 
£g1
 || 
£g2
)

1903 
i
;

1904 i‡((!
£g1
 && 
£g2
) || (seg1 && !seg2))

1906 i‡(
£g1
->
ty≥
 !
£g2
->type)

1908 i‡(
£g1
->
Àngth
 !
£g2
->length)

1910 
i
 = 0; i < 
£g1
->
Àngth
; i++)

1911 i‡(
£g1
->
as
[
i
] !
£g2
->as[i])

1913 
£g1
 = seg1->
√xt
;

1914 
£g2
 = seg2->
√xt
;

1917 
	}
}

1921 
	$a•©h_öô
 ()

1923 
ashash
 = 
	`hash_¸óã_size
 (32767, 
a•©h_key_make
, 
a•©h_cmp
);

1924 
	}
}

1927 
	$a•©h_föish
 ()

1929 
	`hash_‰ì
 (
ashash
);

1930 
ashash
 = 
NULL
;

1932 i‡(
¢mp_°ªam
)

1933 
	`°ªam_‰ì
 (
¢mp_°ªam
);

1934 
	}
}

1938 
	$a•©h_¥öt
 (
a•©h
 *
as
)

1940  (
as
 ?ás->
°r
 : 
NULL
);

1941 
	}
}

1948 
	$a•©h_¥öt_vty
 (
vty
 *vty, c⁄° *
f‹m©
, 
a•©h
 *
as
, c⁄° * 
suffix
)

1950 
	`as£π
 (
f‹m©
);

1951 
	`vty_out
 (
vty
, 
f‹m©
, 
as
->
°r
);

1952 i‡(
as
->
°r_Àn
 && 
	`°æí
 (
suffix
))

1953 
	`vty_out
 (
vty
, "%s", 
suffix
);

1954 
	}
}

1957 
	$a•©h_show_Æl_ôî©‹
 (
hash_backë
 *
backë
, 
vty
 *vty)

1959 
a•©h
 *
as
;

1961 
as
 = (
a•©h
 *Ë
backë
->
d©a
;

1963 
	`vty_out
 (
vty
, "[%p:%u] (%ldË", 
backë
, backë->
key
, 
as
->
ªf˙t
);

1964 
	`vty_out
 (
vty
, "%s%s", 
as
->
°r
, 
VTY_NEWLINE
);

1965 
	}
}

1970 
	$a•©h_¥öt_Æl_vty
 (
vty
 *vty)

1972 
	`hash_ôî©e
 (
ashash
,

1973 ((*Ë(
hash_backë
 *, *))

1974 
a•©h_show_Æl_ôî©‹
,

1975 
vty
);

1976 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_aspath.h

21 #i‚de‡
_QUAGGA_BGP_ASPATH_H


22 
	#_QUAGGA_BGP_ASPATH_H


	)

25 
	#AS_SET
 1

	)

26 
	#AS_SEQUENCE
 2

	)

27 
	#AS_CONFED_SEQUENCE
 3

	)

28 
	#AS_CONFED_SET
 4

	)

31 
	#BGP_PRIVATE_AS_MIN
 64512U

	)

32 
	#BGP_PRIVATE_AS_MAX
 65535U

	)

35 
	#BGP_AS_MAX
 65535U

	)

36 
	#BGP_AS4_MAX
 4294967295U

	)

38 
	#BGP_AS_TRANS
 23456U

	)

41 
	sas£gmít


43 
as£gmít
 *
	m√xt
;

44 
as_t
 *
	mas
;

45 
u_sh‹t
 
	mÀngth
;

46 
u_ch¨
 
	mty≥
;

50 
	sa•©h


53 
	mªf˙t
;

56 
as£gmít
 *
	m£gmíts
;

60 *
	m°r
;

61 
	m°r_Àn
;

64 
	#ASPATH_STR_DEFAULT_LEN
 32

	)

67 
a•©h_öô
 ();

68 
a•©h_föish
 ();

69 
a•©h
 *
a•©h_∑r£
 (
°ªam
 *, 
size_t
, );

70 
a•©h
 *
a•©h_dup
 (aspath *);

71 
a•©h
 *
a•©h_aggªg©e
 (aspath *, aspath *);

72 
a•©h
 *
a•©h_¥ïíd
 (aspath *, aspath *);

73 
a•©h
 *
a•©h_fûãr_ex˛ude
 (aspath *, aspath *);

74 
a•©h
 *
a•©h_add_£q
 (a•©h *, 
as_t
);

75 
a•©h
 *
a•©h_add_c⁄„d_£q
 (a•©h *, 
as_t
);

76 
a•©h_cmp
 (const *, const *);

77 
a•©h_cmp_À·
 (c⁄° 
a•©h
 *, const aspath *);

78 
a•©h_cmp_À·_c⁄„d
 (c⁄° 
a•©h
 *, const aspath *);

79 
a•©h
 *
a•©h_dñëe_c⁄„d_£q
 (aspath *);

80 
a•©h
 *
a•©h_em±y
 ();

81 
a•©h
 *
a•©h_em±y_gë
 ();

82 
a•©h
 *
a•©h_°r2a•©h
 (const *);

83 
a•©h_‰ì
 (
a•©h
 *);

84 
a•©h
 *
a•©h_öã∫
 (aspath *);

85 
a•©h_unöã∫
 (
a•©h
 **);

86 c⁄° *
a•©h_¥öt
 (
a•©h
 *);

87 
a•©h_¥öt_vty
 (
vty
 *, c⁄° *, 
a•©h
 *, const *);

88 
a•©h_¥öt_Æl_vty
 (
vty
 *);

89 
a•©h_key_make
 (*);

90 
a•©h_lo›_check
 (
a•©h
 *, 
as_t
);

91 
a•©h_¥iv©e_as_check
 (
a•©h
 *);

92 
a•©h_fú°as_check
 (
a•©h
 *, 
as_t
);

93 
a•©h_c⁄„d_check
 (
a•©h
 *);

94 
a•©h_À·_c⁄„d_check
 (
a•©h
 *);

95 
a•©h_cou¡
 ();

96 
a•©h_cou¡_h›s
 (
a•©h
 *);

97 
a•©h_cou¡_c⁄„ds
 (
a•©h
 *);

98 
a•©h_size
 (
a•©h
 *);

99 
as_t
 
a•©h_highe°
 (
a•©h
 *);

100 
size_t
 
a•©h_put
 (
°ªam
 *, 
a•©h
 *, );

102 
a•©h
 *
a•©h_ªc⁄cûe_as4
 (aspath *, aspath *);

103 
a•©h_has_as4
 (
a•©h
 *);

106 
u_ch¨
 *
a•©h_¢mp_∑th£g
 (
a•©h
 *, 
size_t
 *);

108 #ifde‡
USE_SRX


109 
as_t
 
a•©h_‹igö_as
 (
a•©h
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_attr.c

21 
	~<zebø.h
>

23 
	~"lökli°.h
"

24 
	~"¥efix.h
"

25 
	~"mem‹y.h
"

26 
	~"ve˘‹.h
"

27 
	~"vty.h
"

28 
	~"°ªam.h
"

29 
	~"log.h
"

30 
	~"hash.h
"

31 
	~"jhash.h
"

33 
	~"bgpd/bgpd.h
"

34 
	~"bgpd/bgp_©å.h
"

35 
	~"bgpd/bgp_rouã.h
"

36 
	~"bgpd/bgp_a•©h.h
"

37 
	~"bgpd/bgp_communôy.h
"

38 
	~"bgpd/bgp_debug.h
"

39 
	~"bgpd/bgp_∑ckë.h
"

40 
	~"bgpd/bgp_ecommunôy.h
"

42 
	~"bgpd/bgp_vÆid©e.h
"

43 
	~<§x/§x¸y±ﬂpi.h
>

47 c⁄° 
mesßge
 
	g©å_°r
 [] =

49 { 
BGP_ATTR_ORIGIN
, "ORIGIN" },

50 { 
BGP_ATTR_AS_PATH
, "AS_PATH" },

51 { 
BGP_ATTR_NEXT_HOP
, "NEXT_HOP" },

52 { 
BGP_ATTR_MULTI_EXIT_DISC
, "MULTI_EXIT_DISC" },

53 { 
BGP_ATTR_LOCAL_PREF
, "LOCAL_PREF" },

54 { 
BGP_ATTR_ATOMIC_AGGREGATE
, "ATOMIC_AGGREGATE" },

55 { 
BGP_ATTR_AGGREGATOR
, "AGGREGATOR" },

56 { 
BGP_ATTR_COMMUNITIES
, "COMMUNITY" },

57 { 
BGP_ATTR_ORIGINATOR_ID
, "ORIGINATOR_ID" },

58 { 
BGP_ATTR_CLUSTER_LIST
, "CLUSTER_LIST" },

59 #ifde‡
USE_SRX


60 { 
BGP_ATTR_BGPSEC
, "BGPSEC"},

62 { 
BGP_ATTR_DPA
, "DPA" },

64 { 
BGP_ATTR_ADVERTISER
, "ADVERTISER"} ,

65 { 
BGP_ATTR_RCID_PATH
, "RCID_PATH" },

66 { 
BGP_ATTR_MP_REACH_NLRI
, "MP_REACH_NLRI" },

67 { 
BGP_ATTR_MP_UNREACH_NLRI
, "MP_UNREACH_NLRI" },

68 { 
BGP_ATTR_EXT_COMMUNITIES
, "EXT_COMMUNITIES" },

69 { 
BGP_ATTR_AS4_PATH
, "AS4_PATH" },

70 { 
BGP_ATTR_AS4_AGGREGATOR
, "AS4_AGGREGATOR" },

71 { 
BGP_ATTR_AS_PATHLIMIT
, "AS_PATHLIMIT" },

73 c⁄° 
	g©å_°r_max
 = 
¨øy_size
(
©å_°r
);

75 c⁄° 
mesßge
 
	g©å_Êag_°r
[] =

77 { 
BGP_ATTR_FLAG_OPTIONAL
, "Optional" },

78 { 
BGP_ATTR_FLAG_TRANS
, "Transitive" },

79 { 
BGP_ATTR_FLAG_PARTIAL
, "Partial" },

81 { 
BGP_ATTR_FLAG_EXTLEN
, "Extended Length" },

83 c⁄° 
size_t
 
	g©å_Êag_°r_max
 = 
¨øy_size
(
©å_Êag_°r
);

85 
hash
 *
	g˛u°î_hash
;

88 
	$˛u°î_hash_Æloc
 (*
p
)

90 
˛u°î_li°
 * 
vÆ
 = (˛u°î_li° *Ë
p
;

91 
˛u°î_li°
 *
˛u°î
;

93 
˛u°î
 = 
	`XMALLOC
 (
MTYPE_CLUSTER
,  (
˛u°î_li°
));

94 
˛u°î
->
Àngth
 = 
vÆ
->length;

96 i‡(
˛u°î
->
Àngth
)

98 
˛u°î
->
li°
 = 
	`XMALLOC
 (
MTYPE_CLUSTER_VAL
, 
vÆ
->
Àngth
);

99 
	`mem˝y
 (
˛u°î
->
li°
, 
vÆ
->li°, vÆ->
Àngth
);

102 
˛u°î
->
li°
 = 
NULL
;

104 
˛u°î
->
ªf˙t
 = 0;

106  
˛u°î
;

107 
	}
}

110 
˛u°î_li°
 *

111 
	$˛u°î_∑r£
 (
ö_addr
 * 
≤t
, 
Àngth
)

113 
˛u°î_li°
 
tmp
;

114 
˛u°î_li°
 *
˛u°î
;

116 
tmp
.
Àngth
 =Üength;

117 
tmp
.
li°
 = 
≤t
;

119 
˛u°î
 = 
	`hash_gë
 (
˛u°î_hash
, &
tmp
, 
˛u°î_hash_Æloc
);

120 
˛u°î
->
ªf˙t
++;

121  
˛u°î
;

122 
	}
}

125 
	$˛u°î_lo›_check
 (
˛u°î_li°
 *
˛u°î
, 
ö_addr
 
‹igö©‹
)

127 
i
;

129 
i
 = 0; i < 
˛u°î
->
Àngth
 / 4; i++)

130 i‡(
˛u°î
->
li°
[
i
].
s_addr
 =
‹igö©‹
.s_addr)

133 
	}
}

136 
	$˛u°î_hash_key_make
 (*
p
)

138 c⁄° 
˛u°î_li°
 *
˛u°î
 = 
p
;

140  
	`jhash
(
˛u°î
->
li°
, clu°î->
Àngth
, 0);

141 
	}
}

144 
	$˛u°î_hash_cmp
 (c⁄° *
p1
, c⁄° *
p2
)

146 c⁄° 
˛u°î_li°
 * 
˛u°î1
 = 
p1
;

147 c⁄° 
˛u°î_li°
 * 
˛u°î2
 = 
p2
;

149  (
˛u°î1
->
Àngth
 =
˛u°î2
->length &&

150 
	`memcmp
 (
˛u°î1
->
li°
, 
˛u°î2
->li°, clu°î1->
Àngth
) == 0);

151 
	}
}

154 
	$˛u°î_‰ì
 (
˛u°î_li°
 *
˛u°î
)

156 i‡(
˛u°î
->
li°
)

157 
	`XFREE
 (
MTYPE_CLUSTER_VAL
, 
˛u°î
->
li°
);

158 
	`XFREE
 (
MTYPE_CLUSTER
, 
˛u°î
);

159 
	}
}

162 
˛u°î_li°
 *

163 
	$˛u°î_dup
 (
˛u°î_li°
 *
˛u°î
)

165 
˛u°î_li°
 *
√w
;

167 
√w
 = 
	`XCALLOC
 (
MTYPE_CLUSTER
,  (
˛u°î_li°
));

168 
√w
->
Àngth
 = 
˛u°î
->length;

170 i‡(
˛u°î
->
Àngth
)

172 
√w
->
li°
 = 
	`XMALLOC
 (
MTYPE_CLUSTER_VAL
, 
˛u°î
->
Àngth
);

173 
	`mem˝y
 (
√w
->
li°
, 
˛u°î
->li°, clu°î->
Àngth
);

176 
√w
->
li°
 = 
NULL
;

178  
√w
;

179 
	}
}

182 
˛u°î_li°
 *

183 
	$˛u°î_öã∫
 (
˛u°î_li°
 *
˛u°î
)

185 
˛u°î_li°
 *
föd
;

187 
föd
 = 
	`hash_gë
 (
˛u°î_hash
, 
˛u°î
, 
˛u°î_hash_Æloc
);

188 
föd
->
ªf˙t
++;

190  
föd
;

191 
	}
}

194 
	$˛u°î_unöã∫
 (
˛u°î_li°
 *
˛u°î
)

196 i‡(
˛u°î
->
ªf˙t
)

197 
˛u°î
->
ªf˙t
--;

199 i‡(
˛u°î
->
ªf˙t
 == 0)

201 
	`hash_ªÀa£
 (
˛u°î_hash
, 
˛u°î
);

202 
	`˛u°î_‰ì
 (
˛u°î
);

204 
	}
}

207 
	$˛u°î_öô
 ()

209 
˛u°î_hash
 = 
	`hash_¸óã
 (
˛u°î_hash_key_make
, 
˛u°î_hash_cmp
);

210 
	}
}

213 
	$˛u°î_föish
 ()

215 
	`hash_‰ì
 (
˛u°î_hash
);

216 
˛u°î_hash
 = 
NULL
;

217 
	}
}

220 
hash
 *
	gå™sô_hash
;

223 
	$å™sô_‰ì
 (
å™sô
 *transit)

225 i‡(
å™sô
->
vÆ
)

226 
	`XFREE
 (
MTYPE_TRANSIT_VAL
, 
å™sô
->
vÆ
);

227 
	`XFREE
 (
MTYPE_TRANSIT
, 
å™sô
);

228 
	}
}

232 
	$å™sô_hash_Æloc
 (*
p
)

235  
p
;

236 
	}
}

238 
å™sô
 *

239 
	$å™sô_öã∫
 (
å™sô
 *transit)

241 
å™sô
 *
föd
;

243 
föd
 = 
	`hash_gë
 (
å™sô_hash
, 
å™sô
, 
å™sô_hash_Æloc
);

244 i‡(
föd
 !
å™sô
)

245 
	`å™sô_‰ì
 (
å™sô
);

246 
föd
->
ªf˙t
++;

248  
föd
;

249 
	}
}

252 
	$å™sô_unöã∫
 (
å™sô
 *transit)

254 i‡(
å™sô
->
ªf˙t
)

255 
å™sô
->
ªf˙t
--;

257 i‡(
å™sô
->
ªf˙t
 == 0)

259 
	`hash_ªÀa£
 (
å™sô_hash
, 
å™sô
);

260 
	`å™sô_‰ì
 (
å™sô
);

262 
	}
}

265 
	$å™sô_hash_key_make
 (*
p
)

267 c⁄° 
å™sô
 *Åønsô = 
p
;

269  
	`jhash
(
å™sô
->
vÆ
,Åønsô->
Àngth
, 0);

270 
	}
}

273 
	$å™sô_hash_cmp
 (c⁄° *
p1
, c⁄° *
p2
)

275 c⁄° 
å™sô
 * 
å™sô1
 = 
p1
;

276 c⁄° 
å™sô
 * 
å™sô2
 = 
p2
;

278  (
å™sô1
->
Àngth
 =
å™sô2
->length &&

279 
	`memcmp
 (
å™sô1
->
vÆ
, 
å™sô2
->vÆ,Åønsô1->
Àngth
) == 0);

280 
	}
}

283 
	$å™sô_öô
 ()

285 
å™sô_hash
 = 
	`hash_¸óã
 (
å™sô_hash_key_make
, 
å™sô_hash_cmp
);

286 
	}
}

289 
	$å™sô_föish
 ()

291 
	`hash_‰ì
 (
å™sô_hash
);

292 
å™sô_hash
 = 
NULL
;

293 
	}
}

296 
hash
 *
	g©åhash
;

298 
©å_exåa
 *

299 
	$bgp_©å_exåa_√w
 ()

301  
	`XCALLOC
 (
MTYPE_ATTR_EXTRA
,  (
©å_exåa
));

302 
	}
}

305 
	$bgp_©å_exåa_‰ì
 (
©å
 *attr)

307 i‡(
©å
->
exåa
)

309 
	`XFREE
 (
MTYPE_ATTR_EXTRA
, 
©å
->
exåa
);

310 
©å
->
exåa
 = 
NULL
;

312 
	}
}

314 
©å_exåa
 *

315 
	$bgp_©å_exåa_gë
 (
©å
 *attr)

317 i‡(!
©å
->
exåa
)

318 
©å
->
exåa
 = 
	`bgp_©å_exåa_√w
();

319  
©å
->
exåa
;

320 
	}
}

327 
	$bgp_©å_dup
 (
©å
 *
√w
, ©å *
‹ig
)

329 
©å_exåa
 *
exåa
 = 
√w
->extra;

331 *
√w
 = *
‹ig
;

342 i‡(
exåa
)

344 
√w
->
exåa
 =Éxtra;

345 
	`mem£t
(
√w
->
exåa
, 0, (
©å_exåa
));

346 i‡(
‹ig
->
exåa
)

347 *
√w
->
exåa
 = *
‹ig
->extra;

349 i‡(
‹ig
->
exåa
)

351 
√w
->
exåa
 = 
	`bgp_©å_exåa_√w
();

352 *
√w
->
exåa
 = *
‹ig
->extra;

354 
	}
}

357 
	$©å_cou¡
 ()

359  
©åhash
->
cou¡
;

360 
	}
}

363 
	$©å_unknown_cou¡
 ()

365  
å™sô_hash
->
cou¡
;

366 
	}
}

369 
	$©åhash_key_make
 (*
p
)

371 c⁄° 
©å
 *©å = (©å *Ë
p
;

372 c⁄° 
©å_exåa
 *
exåa
 = 
©å
->extra;

373 
uöt32_t
 
key
 = 0;

374 
	#MIX
(
vÆ
Ë
key
 = 
	`jhash_1w‹d
(vÆ, key)

	)

376 
	`MIX
(
©å
->
‹igö
);

377 
	`MIX
(
©å
->
√xth›
.
s_addr
);

378 
	`MIX
(
©å
->
med
);

379 
	`MIX
(
©å
->
loˇl_¥ef
);

381 
key
 +
©å
->
‹igö
;

382 
key
 +
©å
->
√xth›
.
s_addr
;

383 
key
 +
©å
->
med
;

384 
key
 +
©å
->
loˇl_¥ef
;

386 i‡(
exåa
)

388 
	`MIX
(
exåa
->
aggªg©‹_as
);

389 
	`MIX
(
exåa
->
aggªg©‹_addr
.
s_addr
);

390 
	`MIX
(
exåa
->
weight
);

391 
	`MIX
(
exåa
->
mp_√xth›_globÆ_ö
.
s_addr
);

394 i‡(
©å
->
a•©h
)

395 
	`MIX
(
	`a•©h_key_make
 (
©å
->
a•©h
));

396 i‡(
©å
->
communôy
)

397 
	`MIX
(
	`communôy_hash_make
 (
©å
->
communôy
));

399 i‡(
exåa
)

401 i‡(
exåa
->
ecommunôy
)

402 
	`MIX
(
	`ecommunôy_hash_make
 (
exåa
->
ecommunôy
));

403 i‡(
exåa
->
˛u°î
)

404 
	`MIX
(
	`˛u°î_hash_key_make
 (
exåa
->
˛u°î
));

405 i‡(
exåa
->
å™sô
)

406 
	`MIX
(
	`å™sô_hash_key_make
 (
exåa
->
å™sô
));

408 #ifde‡
HAVE_IPV6


409 
	`MIX
(
exåa
->
mp_√xth›_Àn
);

410 
key
 = 
	`jhash
(
exåa
->
mp_√xth›_globÆ
.
s6_addr
, 16, key);

411 
key
 = 
	`jhash
(
exåa
->
mp_√xth›_loˇl
.
s6_addr
, 16, key);

415 #ifde‡
USE_SRX


416 
	`MIX
(
©å
->
bgp£cP©hAâr
);

419  
key
;

420 
	}
}

423 
	$©åhash_cmp
 (c⁄° *
p1
, c⁄° *
p2
)

425 c⁄° 
©å
 * 
©å1
 = 
p1
;

426 c⁄° 
©å
 * 
©å2
 = 
p2
;

428 i‡(
©å1
->
Êag
 =
©å2
->flag

429 && 
©å1
->
‹igö
 =
©å2
->origin

430 && 
©å1
->
√xth›
.
s_addr
 =
©å2
->nexthop.s_addr

431 && 
©å1
->
a•©h
 =
©å2
->aspath

432 && 
©å1
->
communôy
 =
©å2
->community

433 && 
©å1
->
med
 =
©å2
->med

434 #ifde‡
USE_SRX


435 && (
	`bgp£c_∑th_©å_cmp
 (
©å1
->
bgp£cP©hAâr
, 
©å2
->bgpsecPathAttr))

437 && 
©å1
->
loˇl_¥ef
 =
©å2
->local_pref)

439 c⁄° 
©å_exåa
 *
´1
 = 
©å1
->
exåa
;

440 c⁄° 
©å_exåa
 *
´2
 = 
©å2
->
exåa
;

442 i‡(
´1
 && 
´2


443 && 
´1
->
aggªg©‹_as
 =
´2
->aggregator_as

444 && 
´1
->
aggªg©‹_addr
.
s_addr
 =
´2
->aggregator_addr.s_addr

445 && 
´1
->
weight
 =
´2
->weight

446 #ifde‡
HAVE_IPV6


447 && 
´1
->
mp_√xth›_Àn
 =
´2
->mp_nexthop_len

448 && 
	`IPV6_ADDR_SAME
 (&
´1
->
mp_√xth›_globÆ
, &
´2
->mp_nexthop_global)

449 && 
	`IPV6_ADDR_SAME
 (&
´1
->
mp_√xth›_loˇl
, &
´2
->mp_nexthop_local)

451 && 
	`IPV4_ADDR_SAME
 (&
´1
->
mp_√xth›_globÆ_ö
, &
´2
->mp_nexthop_global_in)

452 && 
´1
->
ecommunôy
 =
´2
->ecommunity

453 && 
´1
->
˛u°î
 =
´2
->cluster

454 && 
´1
->
å™sô
 =
´2
->transit)

456 i‡(
´1
 || 
´2
)

463 
	}
}

466 
	$©åhash_öô
 ()

468 
©åhash
 = 
	`hash_¸óã
 (
©åhash_key_make
, 
©åhash_cmp
);

469 
	}
}

472 
	$©åhash_föish
 ()

474 
	`hash_‰ì
 (
©åhash
);

475 
©åhash
 = 
NULL
;

476 
	}
}

479 
	$©å_show_Æl_ôî©‹
 (
hash_backë
 *
backë
, 
vty
 *vty)

481 
©å
 *©å = 
backë
->
d©a
;

483 
	`vty_out
 (
vty
, "©å[%ld]Çexth› %s%s", 
©å
->
ªf˙t
,

484 
	`öë_¡ﬂ
 (
©å
->
√xth›
), 
VTY_NEWLINE
);

485 
	}
}

488 
	$©å_show_Æl
 (
vty
 *vty)

490 
	`hash_ôî©e
 (
©åhash
,

491 ((*)(
hash_backë
 *, *))

492 
©å_show_Æl_ôî©‹
,

493 
vty
);

494 
	}
}

497 
	$bgp_©å_hash_Æloc
 (*
p
)

499 
©å
 * 
vÆ
 = (©å *Ë
p
;

500 
©å
 *attr;

502 
©å
 = 
	`XMALLOC
 (
MTYPE_ATTR
,  (attr));

503 *
©å
 = *
vÆ
;

504 i‡(
vÆ
->
exåa
)

506 
©å
->
exåa
 = 
	`bgp_©å_exåa_√w
 ();

507 *
©å
->
exåa
 = *
vÆ
->extra;

509 
©å
->
ªf˙t
 = 0;

510  
©å
;

511 
	}
}

514 
©å
 *

515 
	$bgp_©å_öã∫
 (
©å
 *attr)

517 
©å
 *
föd
;

520 i‡(
©å
->
a•©h
)

522 i‡(! 
©å
->
a•©h
->
ªf˙t
)

523 
©å
->
a•©h
 = 
	`a•©h_öã∫
 (attr->aspath);

525 
©å
->
a•©h
->
ªf˙t
++;

527 i‡(
©å
->
communôy
)

529 i‡(! 
©å
->
communôy
->
ªf˙t
)

530 
©å
->
communôy
 = 
	`communôy_öã∫
 (attr->community);

532 
©å
->
communôy
->
ªf˙t
++;

534 i‡(
©å
->
exåa
)

536 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

538 i‡(
©åe
->
ecommunôy
)

540 i‡(! 
©åe
->
ecommunôy
->
ªf˙t
)

541 
©åe
->
ecommunôy
 = 
	`ecommunôy_öã∫
 (attre->ecommunity);

543 
©åe
->
ecommunôy
->
ªf˙t
++;

546 i‡(
©åe
->
˛u°î
)

548 i‡(! 
©åe
->
˛u°î
->
ªf˙t
)

549 
©åe
->
˛u°î
 = 
	`˛u°î_öã∫
 (attre->cluster);

551 
©åe
->
˛u°î
->
ªf˙t
++;

553 i‡(
©åe
->
å™sô
)

555 i‡(! 
©åe
->
å™sô
->
ªf˙t
)

556 
©åe
->
å™sô
 = 
	`å™sô_öã∫
 (attre->transit);

558 
©åe
->
å™sô
->
ªf˙t
++;

562 
föd
 = (
©å
 *Ë
	`hash_gë
 (
©åhash
,áâr, 
bgp_©å_hash_Æloc
);

563 
föd
->
ªf˙t
++;

565  
föd
;

566 
	}
}

570 
©å
 *

571 
	$bgp_©å_deÁu…_£t
 (
©å
 *©å, 
u_ch¨
 
‹igö
)

573 
	`mem£t
 (
©å
, 0,  (attr));

574 
	`bgp_©å_exåa_gë
 (
©å
);

576 
©å
->
‹igö
 = origin;

577 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGIN
);

578 
©å
->
a•©h
 = 
	`a•©h_em±y
 ();

579 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS_PATH
);

580 
©å
->
exåa
->
weight
 = 
BGP_ATTR_DEFAULT_WEIGHT
;

581 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
);

582 #ifde‡
HAVE_IPV6


583 
©å
->
exåa
->
mp_√xth›_Àn
 = 
IPV6_MAX_BYTELEN
;

586  
©å
;

587 
	}
}

591 
©å
 *

592 
	$bgp_©å_deÁu…_öã∫
 (
u_ch¨
 
‹igö
)

594 
©å
áttr;

595 
©å
 *
√w
;

597 
	`bgp_©å_deÁu…_£t
(&
©å
, 
‹igö
);

599 
√w
 = 
	`bgp_©å_öã∫
 (&
©å
);

600 
	`bgp_©å_exåa_‰ì
 (&
©å
);

602 
	`a•©h_unöã∫
 (&
√w
->
a•©h
);

603  
√w
;

604 
	}
}

606 
©å
 *

607 
	$bgp_©å_aggªg©e_öã∫
 (
bgp
 *bgp, 
u_ch¨
 
‹igö
,

608 
a•©h
 *aspath,

609 
communôy
 *communôy, 
as_£t
)

611 
©å
áttr;

612 
©å
 *
√w
;

613 
©å_exåa
 
©åe
;

615 
	`mem£t
 (&
©å
, 0,  (attr));

616 
	`mem£t
 (&
©åe
, 0,  (
©å_exåa
));

617 
©å
.
exåa
 = &
©åe
;

620 
©å
.
‹igö
 = origin;

621 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGIN
);

624 i‡(
a•©h
)

625 
©å
.
a•©h
 = 
	`a•©h_öã∫
 (aspath);

627 
©å
.
a•©h
 = 
	`a•©h_em±y
 ();

628 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS_PATH
);

631 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
);

633 i‡(
communôy
)

635 
©å
.
communôy
 = community;

636 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
);

639 
©åe
.
weight
 = 
BGP_ATTR_DEFAULT_WEIGHT
;

640 #ifde‡
HAVE_IPV6


641 
©åe
.
mp_√xth›_Àn
 = 
IPV6_MAX_BYTELEN
;

643 i‡(! 
as_£t
)

644 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
);

645 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
);

646 i‡(
	`CHECK_FLAG
 (
bgp
->
c⁄fig
, 
BGP_CONFIG_CONFEDERATION
))

647 
©åe
.
aggªg©‹_as
 = 
bgp
->
c⁄„d_id
;

649 
©åe
.
aggªg©‹_as
 = 
bgp
->
as
;

650 
©åe
.
aggªg©‹_addr
 = 
bgp
->
rouãr_id
;

652 
√w
 = 
	`bgp_©å_öã∫
 (&
©å
);

654 
	`a•©h_unöã∫
 (&
√w
->
a•©h
);

655  
√w
;

656 
	}
}

660 
	$bgp_©å_unöã∫_sub
 (
©å
 *attr)

663 i‡(
©å
->
a•©h
)

664 
	`a•©h_unöã∫
 (&
©å
->
a•©h
);

665 
	`UNSET_FLAG
(
©å
->
Êag
, 
BGP_ATTR_AS_PATH
);

667 i‡(
©å
->
communôy
)

668 
	`communôy_unöã∫
 (&
©å
->
communôy
);

669 
	`UNSET_FLAG
(
©å
->
Êag
, 
BGP_ATTR_COMMUNITIES
);

671 i‡(
©å
->
exåa
)

673 i‡(
©å
->
exåa
->
ecommunôy
)

674 
	`ecommunôy_unöã∫
 (&
©å
->
exåa
->
ecommunôy
);

675 
	`UNSET_FLAG
(
©å
->
Êag
, 
BGP_ATTR_EXT_COMMUNITIES
);

677 i‡(
©å
->
exåa
->
˛u°î
)

678 
	`˛u°î_unöã∫
 (
©å
->
exåa
->
˛u°î
);

679 
	`UNSET_FLAG
(
©å
->
Êag
, 
BGP_ATTR_CLUSTER_LIST
);

681 i‡(
©å
->
exåa
->
å™sô
)

682 
	`å™sô_unöã∫
 (
©å
->
exåa
->
å™sô
);

685 
	}
}

689 
	$bgp_©å_unöã∫
 (
©å
 **
∑âr
)

691 
©å
 *©å = *
∑âr
;

692 
©å
 *
ªt
;

693 
©å
 
tmp
;

694 
©å_exåa
 
tmp_exåa
;

697 
©å
->
ªf˙t
--;

699 
tmp
 = *
©å
;

701 i‡(
©å
->
exåa
)

703 
tmp
.
exåa
 = &
tmp_exåa
;

704 
	`mem˝y
 (
tmp
.
exåa
, 
©å
->exåa,  (
©å_exåa
));

708 i‡(
©å
->
ªf˙t
 == 0)

710 
ªt
 = 
	`hash_ªÀa£
 (
©åhash
, 
©å
);

711 
	`as£π
 (
ªt
 !
NULL
);

712 
	`bgp_©å_exåa_‰ì
 (
©å
);

713 
	`XFREE
 (
MTYPE_ATTR
, 
©å
);

714 *
∑âr
 = 
NULL
;

717 
	`bgp_©å_unöã∫_sub
 (&
tmp
);

718 
	}
}

721 
	$bgp_©å_Êush
 (
©å
 *attr)

723 i‡(
©å
->
a•©h
 && !áâr->a•©h->
ªf˙t
)

724 
	`a•©h_‰ì
 (
©å
->
a•©h
);

725 i‡(
©å
->
communôy
 && !áâr->communôy->
ªf˙t
)

726 
	`communôy_‰ì
 (
©å
->
communôy
);

727 i‡(
©å
->
exåa
)

729 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

731 i‡(
©åe
->
ecommunôy
 && !áâª->ecommunôy->
ªf˙t
)

732 
	`ecommunôy_‰ì
 (&
©åe
->
ecommunôy
);

733 i‡(
©åe
->
˛u°î
 && !áâª->˛u°î->
ªf˙t
)

734 
	`˛u°î_‰ì
 (
©åe
->
˛u°î
);

735 i‡(
©åe
->
å™sô
 && !áâª->å™sô->
ªf˙t
)

736 
	`å™sô_‰ì
 (
©åe
->
å™sô
);

738 
	}
}

745 
bgp_©å_∑r£_ªt_t


746 
	$bgp_©å_mÆf‹med
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
, 
u_ch¨
 
subcode
,

747 
bgp_size_t
 
Àngth
)

749 
≥î
 *c⁄°Öì∏
¨gs
->peer;

750 c⁄° 
u_öt8_t
 
Êags
 = 
¨gs
->flags;

755 
u_ch¨
 *
nŸify_d©≠
 = (
Àngth
 > 0 ? 
¨gs
->
°¨ç
 : 
NULL
);

758 i‡(
≥î
->
s‹t
 !
BGP_PEER_EBGP
)

760 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
, 
subcode
,

761 
nŸify_d©≠
, 
Àngth
);

762  
BGP_ATTR_PARSE_ERROR
;

769 
	`°ªam_£t_gëp
 (
	`BGP_INPUT
 (
≥î
),

770 (
¨gs
->
°¨ç
 - 
	`STREAM_DATA
 (
	`BGP_INPUT
 (
≥î
)))

771 + 
¨gs
->
tŸÆ
);

773 
¨gs
->
ty≥
) {

779 
BGP_ATTR_AS4_AGGREGATOR
:

780 
BGP_ATTR_AGGREGATOR
:

781 
BGP_ATTR_ATOMIC_AGGREGATE
:

782  
BGP_ATTR_PARSE_PROCEED
;

787 
BGP_ATTR_ORIGIN
:

788 
BGP_ATTR_AS_PATH
:

789 
BGP_ATTR_NEXT_HOP
:

790 
BGP_ATTR_MULTI_EXIT_DISC
:

791 
BGP_ATTR_LOCAL_PREF
:

792 
BGP_ATTR_COMMUNITIES
:

793 
BGP_ATTR_ORIGINATOR_ID
:

794 
BGP_ATTR_CLUSTER_LIST
:

795 
BGP_ATTR_MP_REACH_NLRI
:

796 
BGP_ATTR_MP_UNREACH_NLRI
:

797 
BGP_ATTR_EXT_COMMUNITIES
:

798 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
, 
subcode
,

799 
nŸify_d©≠
, 
Àngth
);

800  
BGP_ATTR_PARSE_ERROR
;

807 i‡(
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_TRANS
)

808 && 
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_OPTIONAL
)

809 && 
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_PARTIAL
))

810  
BGP_ATTR_PARSE_WITHDRAW
;

813  
BGP_ATTR_PARSE_ERROR
;

814 
	}
}

822 
	$bgp_©å_Êags_dügno£
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

823 
u_öt8_t
 
desúed_Êags


826 
u_ch¨
 
£í
 = 0, 
i
;

827 
u_ch¨
 
ªÆ_Êags
 = 
¨gs
->
Êags
;

828 c⁄° 
u_öt8_t
 
©å_code
 = 
¨gs
->
ty≥
;

830 
desúed_Êags
 &~
BGP_ATTR_FLAG_EXTLEN
;

831 
ªÆ_Êags
 &~
BGP_ATTR_FLAG_EXTLEN
;

832 
i
 = 0; i <= 2; i++)

835 
	`CHECK_FLAG
 (
desúed_Êags
, 
©å_Êag_°r
[
i
].
key
) !=

836 
	`CHECK_FLAG
 (
ªÆ_Êags
, 
©å_Êag_°r
[
i
].
key
)

839 
	`zlog
 (
¨gs
->
≥î
->
log
, 
LOG_ERR
, "%sáttribute must%s be flaggedás \"%s\"",

840 
	`LOOKUP
 (
©å_°r
, 
©å_code
),

841 
	`CHECK_FLAG
 (
desúed_Êags
, 
©å_Êag_°r
[
i
].
key
) ? "" : "Çot",

842 
©å_Êag_°r
[
i
].
°r
);

843 
£í
 = 1;

845 i‡(!
£í
)

847 
	`zlog
 (
¨gs
->
≥î
->
log
, 
LOG_DEBUG
,

850 
__func__
, 
	`LOOKUP
 (
©å_°r
, 
©å_code
),

851 
ªÆ_Êags
, 
desúed_Êags
);

853 
	}
}

858 c⁄° 
u_öt8_t
 
	g©å_Êags_vÆues
 [] = {

859 [
BGP_ATTR_ORIGIN
] = 
BGP_ATTR_FLAG_TRANS
,

860 [
BGP_ATTR_AS_PATH
] = 
BGP_ATTR_FLAG_TRANS
,

861 [
BGP_ATTR_NEXT_HOP
] = 
BGP_ATTR_FLAG_TRANS
,

862 [
BGP_ATTR_MULTI_EXIT_DISC
] = 
BGP_ATTR_FLAG_OPTIONAL
,

863 [
BGP_ATTR_LOCAL_PREF
] = 
BGP_ATTR_FLAG_TRANS
,

864 [
BGP_ATTR_ATOMIC_AGGREGATE
] = 
BGP_ATTR_FLAG_TRANS
,

865 [
BGP_ATTR_AGGREGATOR
] = 
BGP_ATTR_FLAG_TRANS
 | 
BGP_ATTR_FLAG_OPTIONAL
,

866 [
BGP_ATTR_COMMUNITIES
] = 
BGP_ATTR_FLAG_TRANS
 | 
BGP_ATTR_FLAG_OPTIONAL
,

867 [
BGP_ATTR_ORIGINATOR_ID
] = 
BGP_ATTR_FLAG_OPTIONAL
,

868 [
BGP_ATTR_CLUSTER_LIST
] = 
BGP_ATTR_FLAG_OPTIONAL
,

869 [
BGP_ATTR_MP_REACH_NLRI
] = 
BGP_ATTR_FLAG_OPTIONAL
,

870 [
BGP_ATTR_MP_UNREACH_NLRI
] = 
BGP_ATTR_FLAG_OPTIONAL
,

871 [
BGP_ATTR_EXT_COMMUNITIES
] = 
BGP_ATTR_FLAG_OPTIONAL
 | 
BGP_ATTR_FLAG_TRANS
,

872 [
BGP_ATTR_AS4_PATH
] = 
BGP_ATTR_FLAG_OPTIONAL
 | 
BGP_ATTR_FLAG_TRANS
,

873 [
BGP_ATTR_AS4_AGGREGATOR
] = 
BGP_ATTR_FLAG_OPTIONAL
 | 
BGP_ATTR_FLAG_TRANS
,

875 c⁄° 
size_t
 
	g©å_Êags_vÆues_max
 =

876  (
©å_Êags_vÆues
) /  (attr_flags_values[0]);

879 
	$bgp_©å_Êag_övÆid
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

881 
u_öt8_t
 
mask
 = 
BGP_ATTR_FLAG_EXTLEN
;

882 c⁄° 
u_öt8_t
 
Êags
 = 
¨gs
->flags;

883 c⁄° 
u_öt8_t
 
©å_code
 = 
¨gs
->
ty≥
;

884 
≥î
 *c⁄°Öì∏
¨gs
->peer;

887 i‡(
©å_code
 > 
©å_Êags_vÆues_max
)

889 i‡(
©å_Êags_vÆues
[
©å_code
] == 0)

895 i‡(!
	`CHECK_FLAG
 (
BGP_ATTR_FLAG_OPTIONAL
, 
Êags
)

896 && !
	`CHECK_FLAG
 (
BGP_ATTR_FLAG_TRANS
, 
Êags
))

898 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

900 
	`LOOKUP
 (
©å_°r
, 
©å_code
), 
Êags
);

907 i‡(
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_PARTIAL
))

909 i‡(!
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_OPTIONAL
))

911 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

914 
	`LOOKUP
 (
©å_°r
, 
©å_code
), 
Êags
);

917 i‡(
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_OPTIONAL
)

918 && !
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_TRANS
))

920 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

923 
	`LOOKUP
 (
©å_°r
, 
©å_code
), 
Êags
);

931 i‡(
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_OPTIONAL
)

932 && 
	`CHECK_FLAG
 (
Êags
, 
BGP_ATTR_FLAG_TRANS
))

933 
	`SET_FLAG
 (
mask
, 
BGP_ATTR_FLAG_PARTIAL
);

935 i‡((
Êags
 & ~
mask
)

936 =
©å_Êags_vÆues
[
©å_code
])

939 
	`bgp_©å_Êags_dügno£
 (
¨gs
, 
©å_Êags_vÆues
[
©å_code
]);

941 
	}
}

944 
bgp_©å_∑r£_ªt_t


945 
	$bgp_©å_‹igö
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

947 
≥î
 *c⁄°Öì∏
¨gs
->peer;

948 
©å
 *c⁄°áâ∏
¨gs
->attr;

949 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

956 i‡(
Àngth
 != 1)

958 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "OrigináttributeÜength isÇot one %d",

959 
Àngth
);

960  
	`bgp_©å_mÆf‹med
 (
¨gs
,

961 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

962 
¨gs
->
tŸÆ
);

966 
©å
->
‹igö
 = 
	`°ªam_gëc
 (
	`BGP_INPUT
 (
≥î
));

971 i‡((
©å
->
‹igö
 !
BGP_ORIGIN_IGP
)

972 && (
©å
->
‹igö
 !
BGP_ORIGIN_EGP
)

973 && (
©å
->
‹igö
 !
BGP_ORIGIN_INCOMPLETE
))

975 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "Origináttribute value is invalid %d",

976 
©å
->
‹igö
);

977  
	`bgp_©å_mÆf‹med
 (
¨gs
,

978 
BGP_NOTIFY_UPDATE_INVAL_ORIGIN
,

979 
¨gs
->
tŸÆ
);

983 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGIN
);

986 
	}
}

991 
	$bgp_©å_a•©h
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

993 
©å
 *c⁄°áâ∏
¨gs
->attr;

994 
≥î
 *c⁄°Öì∏
¨gs
->peer;

995 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1001 
©å
->
a•©h
 = 
	`a•©h_∑r£
 (
≥î
->
ibuf
, 
Àngth
,

1002 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
));

1005 i‡(! 
©å
->
a•©h
)

1007 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

1009 
≥î
->
ho°
, 
Àngth
);

1010  
	`bgp_©å_mÆf‹med
 (
¨gs
, 
BGP_NOTIFY_UPDATE_MAL_AS_PATH
, 0);

1014 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS_PATH
);

1016  
BGP_ATTR_PARSE_PROCEED
;

1017 
	}
}

1019 
bgp_©å_∑r£_ªt_t


1020 
	$bgp_©å_a•©h_check
 (
≥î
 *c⁄°Öìr, 
©å
 *constáttr)

1029 
bgp
 *bg∞
≥î
->bgp;

1030 
a•©h
 *aspath;

1033 i‡((
≥î
->
s‹t
 =
BGP_PEER_CONFED
 && ! 
	`a•©h_À·_c⁄„d_check
 (
©å
->
a•©h
)) ||

1034 (
≥î
->
s‹t
 =
BGP_PEER_EBGP
 && 
	`a•©h_c⁄„d_check
 (
©å
->
a•©h
)))

1036 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "MÆf‹med ASÖ©h from %s",Öìr->
ho°
);

1037 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

1038 
BGP_NOTIFY_UPDATE_MAL_AS_PATH
);

1039  
BGP_ATTR_PARSE_ERROR
;

1043 i‡(
bgp
 !
NULL
 && 
	`bgp_Êag_check
 (bgp, 
BGP_FLAG_ENFORCE_FIRST_AS
))

1045 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP


1046 && ! 
	`a•©h_fú°as_check
 (
©å
->
a•©h
, 
≥î
->
as
))

1048 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

1049 "%†öc‹ª˘ fú° AS (mu° bê%u)", 
≥î
->
ho°
,Öìr->
as
);

1050 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

1051 
BGP_NOTIFY_UPDATE_MAL_AS_PATH
);

1052  
BGP_ATTR_PARSE_ERROR
;

1057 i‡(
≥î
->
ch™ge_loˇl_as
 &&

1058 ! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
))

1060 
a•©h
 = 
	`a•©h_dup
 (
©å
->aspath);

1061 
a•©h
 = 
	`a•©h_add_£q
 (a•©h, 
≥î
->
ch™ge_loˇl_as
);

1062 
	`a•©h_unöã∫
 (&
©å
->
a•©h
);

1063 
©å
->
a•©h
 = 
	`a•©h_öã∫
 (aspath);

1066  
BGP_ATTR_PARSE_PROCEED
;

1067 
	}
}

1072 
	$bgp_©å_as4_∑th
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
, 
a•©h
 **
as4_∑th
)

1074 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1075 
©å
 *c⁄°áâ∏
¨gs
->attr;

1076 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1078 *
as4_∑th
 = 
	`a•©h_∑r£
 (
≥î
->
ibuf
, 
Àngth
, 1);

1081 i‡(!*
as4_∑th
)

1083 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

1085 
≥î
->
ho°
, 
Àngth
);

1086  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1087 
BGP_NOTIFY_UPDATE_MAL_AS_PATH
,

1092 i‡(
as4_∑th
)

1093 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS4_PATH
);

1095  
BGP_ATTR_PARSE_PROCEED
;

1096 
	}
}

1099 
bgp_©å_∑r£_ªt_t


1100 
	$bgp_©å_√xth›
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1102 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1103 
©å
 *c⁄°áâ∏
¨gs
->attr;

1104 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1106 
ö_addr_t
 
√xth›_h
, 
√xth›_n
;

1109 i‡(
Àngth
 != 4)

1111 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "NexthopáttributeÜength isn't four [%d]",

1112 
Àngth
);

1114  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1115 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1116 
¨gs
->
tŸÆ
);

1124 
√xth›_n
 = 
	`°ªam_gë_ùv4
 (
≥î
->
ibuf
);

1125 
√xth›_h
 = 
	`¡ohl
 (
√xth›_n
);

1126 i‡(
	`IPV4_NET0
 (
√xth›_h
Ë|| 
	`IPV4_NET127
 (√xth›_hË|| 
	`IPV4_CLASS_DE
 (nexthop_h))

1128 
buf
[
INET_ADDRSTRLEN
];

1129 
	`öë_¡›
 (
AF_INET
, &
√xth›_h
, 
buf
, 
INET_ADDRSTRLEN
);

1130 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "M¨tü¿√xth› %s", 
buf
);

1131  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1132 
BGP_NOTIFY_UPDATE_INVAL_NEXT_HOP
,

1133 
¨gs
->
tŸÆ
);

1136 
©å
->
√xth›
.
s_addr
 = 
√xth›_n
;

1137 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
);

1139  
BGP_ATTR_PARSE_PROCEED
;

1140 
	}
}

1143 
bgp_©å_∑r£_ªt_t


1144 
	$bgp_©å_med
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1146 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1147 
©å
 *c⁄°áâ∏
¨gs
->attr;

1148 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1151 i‡(
Àngth
 != 4)

1153 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

1154 "MEDáâribuãÜígth i¢'àfou∏[%d]", 
Àngth
);

1156  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1157 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1158 
¨gs
->
tŸÆ
);

1161 
©å
->
med
 = 
	`°ªam_gël
 (
≥î
->
ibuf
);

1163 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
);

1165  
BGP_ATTR_PARSE_PROCEED
;

1166 
	}
}

1169 
bgp_©å_∑r£_ªt_t


1170 
	$bgp_©å_loˇl_¥ef
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1172 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1173 
©å
 *c⁄°áâ∏
¨gs
->attr;

1174 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1177 i‡(
Àngth
 != 4)

1179 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "LOCAL_PREFáttributeÜength isn't 4 [%u]",

1180 
Àngth
);

1181  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1182 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1183 
¨gs
->
tŸÆ
);

1189 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP
)

1191 
	`°ªam_f‹w¨d_gëp
 (
≥î
->
ibuf
, 
Àngth
);

1192  
BGP_ATTR_PARSE_PROCEED
;

1195 
©å
->
loˇl_¥ef
 = 
	`°ªam_gël
 (
≥î
->
ibuf
);

1198 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
);

1200  
BGP_ATTR_PARSE_PROCEED
;

1201 
	}
}

1205 
	$bgp_©å_©omic
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1207 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1208 
©å
 *c⁄°áâ∏
¨gs
->attr;

1209 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1212 i‡(
Àngth
 != 0)

1214 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "ATOMIC_AGGREGATEáttributeÜength isn't 0 [%u]",

1215 
Àngth
);

1216  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1217 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1218 
¨gs
->
tŸÆ
);

1222 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
);

1224  
BGP_ATTR_PARSE_PROCEED
;

1225 
	}
}

1229 
	$bgp_©å_aggªg©‹
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1231 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1232 
©å
 *c⁄°áâ∏
¨gs
->attr;

1233 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1235 
w™ãdÀn
 = 6;

1236 
©å_exåa
 *
©åe
 = 
	`bgp_©å_exåa_gë
 (
©å
);

1239 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
))

1240 
w™ãdÀn
 = 8;

1242 i‡(
Àngth
 !
w™ãdÀn
)

1244 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "AGGREGATORáttributeÜength isn't %u [%u]",

1245 
w™ãdÀn
, 
Àngth
);

1246  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1247 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1248 
¨gs
->
tŸÆ
);

1251 i‡–
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
 ) )

1252 
©åe
->
aggªg©‹_as
 = 
	`°ªam_gël
 (
≥î
->
ibuf
);

1254 
©åe
->
aggªg©‹_as
 = 
	`°ªam_gëw
 (
≥î
->
ibuf
);

1255 
©åe
->
aggªg©‹_addr
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
≥î
->
ibuf
);

1258 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
);

1260  
BGP_ATTR_PARSE_PROCEED
;

1261 
	}
}

1264 
bgp_©å_∑r£_ªt_t


1265 
	$bgp_©å_as4_aggªg©‹
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

1266 
as_t
 *
as4_aggªg©‹_as
,

1267 
ö_addr
 *
as4_aggªg©‹_addr
)

1269 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1270 
©å
 *c⁄°áâ∏
¨gs
->attr;

1271 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1273 i‡(
Àngth
 != 8)

1275 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "New AggregatorÜength isÇot 8 [%d]",

1276 
Àngth
);

1277  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1278 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1282 *
as4_aggªg©‹_as
 = 
	`°ªam_gël
 (
≥î
->
ibuf
);

1283 
as4_aggªg©‹_addr
->
s_addr
 = 
	`°ªam_gë_ùv4
 (
≥î
->
ibuf
);

1285 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS4_AGGREGATOR
);

1287  
BGP_ATTR_PARSE_PROCEED
;

1288 
	}
}

1292 
bgp_©å_∑r£_ªt_t


1293 
	$bgp_©å_munge_as4_©ås
 (
≥î
 *constÖeer,

1294 
©å
 *constáttr,

1295 
a•©h
 *
as4_∑th
, 
as_t
 
as4_aggªg©‹
,

1296 
ö_addr
 *
as4_aggªg©‹_addr
)

1298 
ign‹e_as4_∑th
 = 0;

1299 
a•©h
 *
√w∑th
;

1300 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

1302 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
))

1309 i‡(
	`BGP_DEBUG
(
as4
, 
AS4
))

1311 i‡(
©å
->
Êag
 & (
	`ATTR_FLAG_BIT
(
BGP_ATTR_AS4_PATH
)))

1312 
	`zlog_debug
 ("[AS4] %s %s AS4_PATH",

1313 
≥î
->
ho°
, "AS4 capableÖeer, yet it sent");

1315 i‡(
©å
->
Êag
 & (
	`ATTR_FLAG_BIT
(
BGP_ATTR_AS4_AGGREGATOR
)))

1316 
	`zlog_debug
 ("[AS4] %s %s AS4_AGGREGATOR",

1317 
≥î
->
ho°
, "AS4 capableÖeer, yet it sent");

1320  
BGP_ATTR_PARSE_PROCEED
;

1326 i‡(
©å
->
Êag
 & (
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS4_AGGREGATOR
) ) )

1328 i‡(
©å
->
Êag
 & (
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
) ) )

1330 
	`as£π
 (
©åe
);

1344 i‡(
©åe
->
aggªg©‹_as
 !
BGP_AS_TRANS
)

1347 i‡–
	`BGP_DEBUG
(
as4
, 
AS4
))

1348 
	`zlog_debug
 ("[AS4] %s BGPÇot AS4 capableÖeer"

1351 " AS4_AGGREGATORánd AS4_PATH", 
≥î
->
ho°
);

1352 
ign‹e_as4_∑th
 = 1;

1357 
©åe
->
aggªg©‹_as
 = 
as4_aggªg©‹
;

1358 
©åe
->
aggªg©‹_addr
.
s_addr
 = 
as4_aggªg©‹_addr
->s_addr;

1368 i‡–
	`BGP_DEBUG
(
as4
, 
AS4
))

1369 
	`zlog_debug
 ("[AS4] %s BGPÇot AS4 capableÖeer send"

1371 " iàa†i‡AGGREGATOR wôh AS_TRANS had bì¿thîe", 
≥î
->
ho°
);

1372 (
©åe
 = 
	`bgp_©å_exåa_gë
 (
©å
))->
aggªg©‹_as
 = 
as4_aggªg©‹
;

1374 
©å
->
Êag
 |(
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
));

1379 i‡(!
ign‹e_as4_∑th
 && (
©å
->
Êag
 & (
	`ATTR_FLAG_BIT
–
BGP_ATTR_AS4_PATH
))))

1381 i‡(!
©å
->
a•©h
)

1382  
BGP_ATTR_PARSE_PROCEED
;

1384 
√w∑th
 = 
	`a•©h_ªc⁄cûe_as4
 (
©å
->
a•©h
, 
as4_∑th
);

1385 
	`a•©h_unöã∫
 (&
©å
->
a•©h
);

1386 
©å
->
a•©h
 = 
	`a•©h_öã∫
 (
√w∑th
);

1388  
BGP_ATTR_PARSE_PROCEED
;

1389 
	}
}

1392 
bgp_©å_∑r£_ªt_t


1393 
	$bgp_©å_communôy
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1395 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1396 
©å
 *c⁄°áâ∏
¨gs
->attr;

1397 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1399 i‡(
Àngth
 == 0)

1401 
©å
->
communôy
 = 
NULL
;

1402  
BGP_ATTR_PARSE_PROCEED
;

1405 
©å
->
communôy
 =

1406 
	`communôy_∑r£
 ((
u_öt32_t
 *)
	`°ªam_≤t
 (
≥î
->
ibuf
), 
Àngth
);

1409 
	`°ªam_f‹w¨d_gëp
 (
≥î
->
ibuf
, 
Àngth
);

1411 i‡(!
©å
->
communôy
)

1412  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1413 
BGP_NOTIFY_UPDATE_OPT_ATTR_ERR
,

1414 
¨gs
->
tŸÆ
);

1416 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
);

1418  
BGP_ATTR_PARSE_PROCEED
;

1419 
	}
}

1422 
bgp_©å_∑r£_ªt_t


1423 
	$bgp_©å_‹igö©‹_id
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1425 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1426 
©å
 *c⁄°áâ∏
¨gs
->attr;

1427 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1430 i‡(
Àngth
 != 4)

1432 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "Bad origö©‹ IDÜígth %d", 
Àngth
);

1434  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1435 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1436 
¨gs
->
tŸÆ
);

1439 (
	`bgp_©å_exåa_gë
 (
©å
))->
‹igö©‹_id
.
s_addr


1440 
	`°ªam_gë_ùv4
 (
≥î
->
ibuf
);

1442 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGINATOR_ID
);

1444  
BGP_ATTR_PARSE_PROCEED
;

1445 
	}
}

1448 
bgp_©å_∑r£_ªt_t


1449 
	$bgp_©å_˛u°î_li°
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1451 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1452 
©å
 *c⁄°áâ∏
¨gs
->attr;

1453 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1456 i‡(
Àngth
 % 4)

1458 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
, "Bad clu°îÜi°Üígth %d", 
Àngth
);

1460  
	`bgp_©å_mÆf‹med
 (
¨gs
, 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
,

1461 
¨gs
->
tŸÆ
);

1464 (
	`bgp_©å_exåa_gë
 (
©å
))->
˛u°î


1465 
	`˛u°î_∑r£
 ((
ö_addr
 *)
	`°ªam_≤t
 (
≥î
->
ibuf
), 
Àngth
);

1468 
	`°ªam_f‹w¨d_gëp
 (
≥î
->
ibuf
, 
Àngth
);

1470 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_CLUSTER_LIST
);

1472  
BGP_ATTR_PARSE_PROCEED
;

1473 
	}
}

1477 
	$bgp_mp_ªach_∑r£
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

1478 
bgp_∆ri
 *
mp_upd©e
)

1480 
afi_t
 
afi
;

1481 
ßfi_t
 
ßfi
;

1482 
bgp_size_t
 
∆ri_Àn
;

1483 
size_t
 
°¨t
;

1484 
ªt
;

1485 
°ªam
 *
s
;

1486 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1487 
©å
 *c⁄°áâ∏
¨gs
->attr;

1488 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1489 
©å_exåa
 *
©åe
 = 
	`bgp_©å_exåa_gë
(
©å
);

1492 
s
 = 
	`BGP_INPUT
(
≥î
);

1493 
°¨t
 = 
	`°ªam_gë_gëp
(
s
);

1496 
	#BGP_MP_REACH_MIN_SIZE
 5

	)

1497 
	#LEN_LEFT
 (
Àngth
 - (
	`°ªam_gë_gëp
(
s
Ë- 
°¨t
))

	)

1498 i‡((
Àngth
 > 
	`STREAM_READABLE
(
s
)Ë|| (Àngth < 
BGP_MP_REACH_MIN_SIZE
))

1500 
	`zlog_öfo
 ("%s: %s sent invalidÜength, %lu",

1501 
__func__
, 
≥î
->
ho°
, ()
Àngth
);

1502  
BGP_ATTR_PARSE_ERROR
;

1506 
afi
 = 
	`°ªam_gëw
 (
s
);

1507 
ßfi
 = 
	`°ªam_gëc
 (
s
);

1510 
©åe
->
mp_√xth›_Àn
 = 
	`°ªam_gëc
 (
s
);

1512 i‡(
LEN_LEFT
 < 
©åe
->
mp_√xth›_Àn
)

1514 
	`zlog_öfo
 ("%s: %s, MPÇexthopÜength, %u, goesÖastÉnd ofáttribute",

1515 
__func__
, 
≥î
->
ho°
, 
©åe
->
mp_√xth›_Àn
);

1516  
BGP_ATTR_PARSE_ERROR
;

1520 
©åe
->
mp_√xth›_Àn
)

1523 
	`°ªam_gë
 (&
©åe
->
mp_√xth›_globÆ_ö
, 
s
, 4);

1525 i‡(
©å
->
√xth›
.
s_addr
 == 0)

1526 
	`mem˝y
(&
©å
->
√xth›
.
s_addr
, &
©åe
->
mp_√xth›_globÆ_ö
, 4);

1529 
	`°ªam_gël
 (
s
);

1530 
	`°ªam_gël
 (
s
);

1531 
	`°ªam_gë
 (&
©åe
->
mp_√xth›_globÆ_ö
, 
s
, 4);

1533 #ifde‡
HAVE_IPV6


1535 
	`°ªam_gë
 (&
©åe
->
mp_√xth›_globÆ
, 
s
, 16);

1538 
	`°ªam_gë
 (&
©åe
->
mp_√xth›_globÆ
, 
s
, 16);

1539 
	`°ªam_gë
 (&
©åe
->
mp_√xth›_loˇl
, 
s
, 16);

1540 i‡(! 
	`IN6_IS_ADDR_LINKLOCAL
 (&
©åe
->
mp_√xth›_loˇl
))

1542 
buf1
[
INET6_ADDRSTRLEN
];

1543 
buf2
[
INET6_ADDRSTRLEN
];

1545 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

1546 
	`zlog_debug
 ("%†gŸÅwÿ√xth› %†%†buà£c⁄d o√ i†nŸáÜök-loˇ»√xth›", 
≥î
->
ho°
,

1547 
	`öë_¡›
 (
AF_INET6
, &
©åe
->
mp_√xth›_globÆ
,

1548 
buf1
, 
INET6_ADDRSTRLEN
),

1549 
	`öë_¡›
 (
AF_INET6
, &
©åe
->
mp_√xth›_loˇl
,

1550 
buf2
, 
INET6_ADDRSTRLEN
));

1552 
©åe
->
mp_√xth›_Àn
 = 16;

1557 
	`zlog_öfo
 ("%s: (%s) Wrong multiprotocolÇext hopÜength: %d",

1558 
__func__
, 
≥î
->
ho°
, 
©åe
->
mp_√xth›_Àn
);

1559  
BGP_ATTR_PARSE_ERROR
;

1562 i‡(!
LEN_LEFT
)

1564 
	`zlog_öfo
 ("%s: (%s) FailedÅoÑead SNPAánd NLRI(s)",

1565 
__func__
, 
≥î
->
ho°
);

1566  
BGP_ATTR_PARSE_ERROR
;

1570 
u_ch¨
 
vÆ
;

1571 i‡((
vÆ
 = 
	`°ªam_gëc
 (
s
)))

1572 
	`zlog_w¨n
 ("%s sentÇon-zero value, %u, for defunct SNPA-length field",

1573 
≥î
->
ho°
, 
vÆ
);

1577 
∆ri_Àn
 = 
LEN_LEFT
;

1578 i‡((!
∆ri_Àn
Ë|| (∆ri_À¿> 
	`STREAM_READABLE
(
s
)))

1580 
	`zlog_öfo
 ("%s: (%s) FailedÅoÑead NLRI",

1581 
__func__
, 
≥î
->
ho°
);

1582  
BGP_ATTR_PARSE_ERROR
;

1585 i‡(
ßfi
 !
SAFI_MPLS_LABELED_VPN
)

1587 
ªt
 = 
	`bgp_∆ri_ßnôy_check
 (
≥î
, 
afi
, 
	`°ªam_≤t
 (
s
), 
∆ri_Àn
);

1588 i‡(
ªt
 < 0)

1590 
	`zlog_öfo
 ("%s: (%s) NLRI doesn'tÖass sanity check",

1591 
__func__
, 
≥î
->
ho°
);

1592  
BGP_ATTR_PARSE_ERROR
;

1596 
mp_upd©e
->
afi
 =áfi;

1597 
mp_upd©e
->
ßfi
 = safi;

1598 
mp_upd©e
->
∆ri
 = 
	`°ªam_≤t
 (
s
);

1599 
mp_upd©e
->
Àngth
 = 
∆ri_Àn
;

1601 
	`°ªam_f‹w¨d_gëp
 (
s
, 
∆ri_Àn
);

1603  
BGP_ATTR_PARSE_PROCEED
;

1604 #unde‡
LEN_LEFT


1605 
	}
}

1609 
	$bgp_mp_uƒóch_∑r£
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

1610 
bgp_∆ri
 *
mp_wôhdøw
)

1612 
°ªam
 *
s
;

1613 
afi_t
 
afi
;

1614 
ßfi_t
 
ßfi
;

1615 
u_öt16_t
 
wôhdøw_Àn
;

1616 
ªt
;

1617 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1618 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1620 
s
 = 
≥î
->
ibuf
;

1622 
	#BGP_MP_UNREACH_MIN_SIZE
 3

	)

1623 i‡((
Àngth
 > 
	`STREAM_READABLE
(
s
)Ë|| (Àngth < 
BGP_MP_UNREACH_MIN_SIZE
))

1624  
BGP_ATTR_PARSE_ERROR
;

1626 
afi
 = 
	`°ªam_gëw
 (
s
);

1627 
ßfi
 = 
	`°ªam_gëc
 (
s
);

1629 
wôhdøw_Àn
 = 
Àngth
 - 
BGP_MP_UNREACH_MIN_SIZE
;

1631 i‡(
ßfi
 !
SAFI_MPLS_LABELED_VPN
)

1633 
ªt
 = 
	`bgp_∆ri_ßnôy_check
 (
≥î
, 
afi
, 
	`°ªam_≤t
 (
s
), 
wôhdøw_Àn
);

1634 i‡(
ªt
 < 0)

1635  
BGP_ATTR_PARSE_ERROR
;

1638 
mp_wôhdøw
->
afi
 =áfi;

1639 
mp_wôhdøw
->
ßfi
 = safi;

1640 
mp_wôhdøw
->
∆ri
 = 
	`°ªam_≤t
 (
s
);

1641 
mp_wôhdøw
->
Àngth
 = 
wôhdøw_Àn
;

1643 
	`°ªam_f‹w¨d_gëp
 (
s
, 
wôhdøw_Àn
);

1645  
BGP_ATTR_PARSE_PROCEED
;

1646 
	}
}

1649 
bgp_©å_∑r£_ªt_t


1650 
	$bgp_©å_ext_communôõs
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1652 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1653 
©å
 *c⁄°áâ∏
¨gs
->attr;

1654 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1656 i‡(
Àngth
 == 0)

1658 i‡(
©å
->
exåa
)

1659 
©å
->
exåa
->
ecommunôy
 = 
NULL
;

1661  
BGP_ATTR_PARSE_PROCEED
;

1664 (
	`bgp_©å_exåa_gë
 (
©å
))->
ecommunôy
 =

1665 
	`ecommunôy_∑r£
 ((
u_öt8_t
 *)
	`°ªam_≤t
 (
≥î
->
ibuf
), 
Àngth
);

1667 
	`°ªam_f‹w¨d_gëp
 (
≥î
->
ibuf
, 
Àngth
);

1669 i‡(!
©å
->
exåa
->
ecommunôy
)

1670  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1671 
BGP_NOTIFY_UPDATE_OPT_ATTR_ERR
,

1672 
¨gs
->
tŸÆ
);

1674 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
);

1676  
BGP_ATTR_PARSE_PROCEED
;

1677 
	}
}

1680 
bgp_©å_∑r£_ªt_t


1681 
	$bgp_©å_unknown
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1683 
bgp_size_t
 
tŸÆ
 = 
¨gs
->total;

1684 
å™sô
 *transit;

1685 
©å_exåa
 *
©åe
;

1686 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1687 
©å
 *c⁄°áâ∏
¨gs
->attr;

1688 
u_ch¨
 *c⁄° 
°¨ç
 = 
¨gs
->startp;

1689 c⁄° 
u_ch¨
 
ty≥
 = 
¨gs
->type;

1690 c⁄° 
u_ch¨
 
Êag
 = 
¨gs
->
Êags
;

1691 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1694 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1695 
	`zlog_debug
 ("%s Unknownáttribute isÑeceived (type %d,Üength %d)",

1696 
≥î
->
ho°
, 
ty≥
, 
Àngth
);

1698 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

1699 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

1700 "Unknow¿©åibuãÅy≥ %dÜígth %d i†ª˚ived", 
ty≥
, 
Àngth
);

1703 
	`°ªam_f‹w¨d_gëp
 (
≥î
->
ibuf
, 
Àngth
);

1709 i‡(!
	`CHECK_FLAG
 (
Êag
, 
BGP_ATTR_FLAG_OPTIONAL
))

1711  
	`bgp_©å_mÆf‹med
 (
¨gs
,

1712 
BGP_NOTIFY_UPDATE_UNREC_ATTR
,

1713 
¨gs
->
tŸÆ
);

1718 i‡(! 
	`CHECK_FLAG
 (
Êag
, 
BGP_ATTR_FLAG_TRANS
))

1719  
BGP_ATTR_PARSE_PROCEED
;

1725 
	`SET_FLAG
 (*
°¨ç
, 
BGP_ATTR_FLAG_PARTIAL
);

1728 i‡(! ((
©åe
 = 
	`bgp_©å_exåa_gë
(
©å
))->
å™sô
) )

1729 
©åe
->
å™sô
 = 
	`XCALLOC
 (
MTYPE_TRANSIT
,  (transit));

1731 
å™sô
 = 
©åe
->transit;

1733 i‡(
å™sô
->
vÆ
)

1734 
å™sô
->
vÆ
 = 
	`XREALLOC
 (
MTYPE_TRANSIT_VAL
,Åransit->val,

1735 
å™sô
->
Àngth
 + 
tŸÆ
);

1737 
å™sô
->
vÆ
 = 
	`XMALLOC
 (
MTYPE_TRANSIT_VAL
, 
tŸÆ
);

1739 
	`mem˝y
 (
å™sô
->
vÆ
 +Åønsô->
Àngth
, 
°¨ç
, 
tŸÆ
);

1740 
å™sô
->
Àngth
 +
tŸÆ
;

1742  
BGP_ATTR_PARSE_PROCEED
;

1743 
	}
}

1745 #ifde‡
USE_SRX


1756 
a•©h
 * 
	$§x_c⁄vît_to_a•©h
(
©å
*áâr, 
≥î
*Öeer)

1769 
a•©h
* 
ªtVÆ
 = 
NULL
;

1771 
P©hSegmít
 *
ps
 = 
©å
->
bgp£cP©hAâr
->
∑thSegmíts
;

1772 
P©hSegmít
 *
tmpPs
 = 
ps
;

1773 
size_t
 
p˙tTŸ
 = 0, 
p˙t
=0;

1776 
tmpPs
)

1778 
p˙tTŸ
 +
tmpPs
->
pCou¡
;

1779 
tmpPs
 =ÅmpPs->
√xt
;

1783 
size_t
 
°ªamLí
 = 
	`MAX
–((
©å
->
bgp£cP©hAâr
->
£cuªP©hLí
 -2) /6)*4 +2, \

1784 
p˙tTŸ
 *4 +2);

1785 
°ªam
 *
tmpSåóm
 = 
	`°ªam_√w
(
°ªamLí
);

1786 
u_sh‹t
 
ôî
 = (
°ªamLí
 -2) /4;

1788 
	`°ªam_putc
(
tmpSåóm
, 
BGP_ATTR_AS_PATH
);

1789 
	`°ªam_putc
(
tmpSåóm
, 
ôî
);

1791 
ps
 && 
ôî
--)

1793 
p˙t
 = 
ps
->
pCou¡
;

1794 
p˙t
--)

1796 
	`°ªam_pué
(
tmpSåóm
, 
ps
->
as
);

1798 
ps
 =Ös->
√xt
;

1801 i‡(
	`BGP_DEBUG
(
as4
, 
AS4_SEGMENT
))

1803 
	`zlog_debug
("[AS4SEG] dumpÅhe maden stream foráspathÖarse ");

1804 
i
;

1805 
i
=0; i< 
°ªamLí
; i++)

1807 
	`¥ötf
("%02x ", 
tmpSåóm
->
d©a
[
i
]);

1808 if–(
i
+1Ë%16==0Ë
	`¥ötf
("\n");

1810 
	`¥ötf
(" -- from [%s] \n", 
__FUNCTION__
);

1814 
ªtVÆ
 = 
	`a•©h_∑r£
 (
tmpSåóm
, 
°ªamLí
,

1815 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
));

1817 
	`°ªam_‰ì
(
tmpSåóm
);

1819  
ªtVÆ
;

1820 
	}
}

1828 
SCA_Pªfix
* 
	$bgp£c_¸óã_vÆd©a_∆ri
(
bgp_∆ri
* 
mp_upd©e
)

1830 
SCA_Pªfix
* 
sˇPªfix
 = 
NULL
;

1831 i‡(
mp_upd©e
 && mp_upd©e->
∆ri
)

1833 
sˇPªfix
 = 
	`mÆloc
((
SCA_Pªfix
));

1834 
	`mem£t
(
sˇPªfix
, 0, (
SCA_Pªfix
));

1836 
sˇPªfix
->
afi
 = 
	`ht⁄s
(
mp_upd©e
->afi);

1837 
sˇPªfix
->
ßfi
 = 
mp_upd©e
->safi;

1839 
sˇPªfix
->
Àngth
 = (
u_öt8_t
)*
mp_upd©e
->
∆ri
;

1840 i‡(
sˇPªfix
->
Àngth
 > 0)

1842 
u_öt8_t
* 
±r
 = (u_öt8_t*)
mp_upd©e
->
∆ri
;

1843 
±r
++;

1844 
	`mem˝y
(
sˇPªfix
->
addr
.
ù
, 
±r
, (
mp_upd©e
->
Àngth
-1));

1848  
sˇPªfix
;

1849 
	}
}

1863 
bgp_©å_∑r£_ªt_t
 
	$bgp_©å_bgp£c
(
bgp_©å_∑r£r_¨gs
 *
¨gs
)

1868 
≥î
 *c⁄°Öì∏
¨gs
->peer;

1869 
©å
 *c⁄°áâ∏
¨gs
->attr;

1870 c⁄° 
bgp_size_t
 
Àngth
 = 
¨gs
->length;

1874 i‡(
©å
->
a•©h
)

1877 
	`zlog_îr
( "[BGPSEC] Path Update MUST NOT contain AS_PATH!!");

1878  
BGP_ATTR_PARSE_WITHDRAW
;

1881 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

1883 
	`zlog_debug
("[BGPSEC] startp:%pÜength:%dÅotal:%d", \

1884 
¨gs
->
°¨ç
,árgs->
Àngth
,árgs->
tŸÆ
);

1889 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
 =
NULL
)

1891 
©å
->
bgp£c_vÆid©i⁄D©a
 = 
	`mÆloc
((
SCA_BGPSecVÆid©i⁄D©a
));

1892 
	`mem£t
(
©å
->
bgp£c_vÆid©i⁄D©a
, 0, (
SCA_BGPSecVÆid©i⁄D©a
));

1896 
	`¥ötf
("ERROR: Why isÅhisÇotÇull - canÅhis happen??\n");

1897 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
bgp£c_∑th_©å
 !
NULL
)

1899 
	`‰ì
(
©å
->
bgp£c_vÆid©i⁄D©a
->
bgp£c_∑th_©å
);

1901 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
 !
NULL
)

1903 
	`‰ì
(
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
);

1905 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
 !
NULL
)

1907 
idx
;

1908 
idx
 = 0; idx < 2; idx++)

1910 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
idx
] !
NULL
)

1912 
	`‰ìSCA_HashMesßge
(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
idx
]);

1913 
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
idx
] = 
NULL
;

1923 
SCA_BGPSecVÆid©i⁄D©a
* 
vÆd©a
 = 
©å
->
bgp£c_vÆid©i⁄D©a
;

1924 
u_öt8_t
* 
±r
 = 
NULL
;

1925 
	`mem£t
(
vÆd©a
, 0, (
SCA_BGPSecVÆid©i⁄D©a
));

1926 
vÆd©a
->
myAS
 = 
	`ht⁄l
(
≥î
->
loˇl_as
);

1927 
vÆd©a
->
°©us
 = 
API_STATUS_OK
;

1930 
vÆd©a
->
bgp£c_∑th_©å
 = 
	`mÆloc
(
¨gs
->
tŸÆ
);

1931 
	`mem£t
(
vÆd©a
->
bgp£c_∑th_©å
, 0,
¨gs
->
tŸÆ
);

1932 
SCA_BGP_P©hAâribuã
* 
bsPa
 = (SCA_BGP_P©hAâribuã*)
vÆd©a
->
bgp£c_∑th_©å
;

1933 
bsPa
->
Êags
 = 
¨gs
->flags;

1934 
bsPa
->
ty≥_code
 = 
¨gs
->
ty≥
;

1935 i‡((
¨gs
->
Êags
 & 
SCA_BGP_UPD_A_FLAGS_EXT_LENGTH
) > 0)

1937 
SCA_BGPSEC_ExtP©hAâribuã
* 
bsEPa
 = (SCA_BGPSEC_ExtP©hAâribuã*)
bsPa
;

1938 
bsEPa
->
©åLígth
 = 
	`ht⁄s
(
¨gs
->
Àngth
);

1940 
±r
 = 
vÆd©a
->
bgp£c_∑th_©å
 + 4;

1944 
SCA_BGPSEC_N‹mP©hAâribuã
* 
bsNPa
 = (SCA_BGPSEC_N‹mP©hAâribuã*)
bsPa
;

1945 
bsNPa
->
©åLígth
 = 
¨gs
->
Àngth
;

1947 
±r
 = 
vÆd©a
->
bgp£c_∑th_©å
 + 3;

1949 
	`°ªam_gë
(
±r
, 
≥î
->
ibuf
, 
Àngth
);

1952 
°ªam
* 
°r
 = 
	`°ªam_√w
(
Àngth
);

1953 
	`°ªam_put
(
°r
, 
±r
, 
Àngth
);

1955 
±r
 = 
NULL
;

1957 
©å
->
bgp£cP©hAâr
 = 
	`bgp£c_∑r£
◊âr, 
≥î
, 
°r
, 
Àngth
);

1959 i‡(
©å
->
bgp£cP©hAâr
 =
NULL
)

1962 
	`zlog_îr
( "BGPSEC Path Update MUST NOT contain AS_PATH!!");

1963 if(
vÆd©a
->
∆ri
)

1965 
	`mem£t
 (
vÆd©a
->
∆ri
, 0, (
SCA_Pªfix
));

1966 
	`‰ì
(
vÆd©a
->
∆ri
);

1968 
	`mem£t
 (
vÆd©a
->
bgp£c_∑th_©å
, 0 , 
¨gs
->
tŸÆ
);

1969 
	`‰ì
(
vÆd©a
->
bgp£c_∑th_©å
);

1970 
	`mem£t
 (
vÆd©a
, 0, (
SCA_BGPSecVÆid©i⁄D©a
));

1971 
vÆd©a
 = 
NULL
;

1972 
©å
->
bgp£cP©hAâr
 = 
NULL
;

1974  
BGP_ATTR_PARSE_WITHDRAW
;

1978 
©å
->
a•©h
 = 
	`§x_c⁄vît_to_a•©h
◊âr, 
≥î
);

1980 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS_PATH
);

1983 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_BGPSEC
);

1985  
BGP_ATTR_PARSE_PROCEED
;

1986 
	}
}

1992 
bgp_©å_∑r£_ªt_t


1993 
	$bgp_©å_∑r£
 (
≥î
 *≥î, 
©å
 *©å, 
bgp_size_t
 
size
,

1994 
bgp_∆ri
 *
mp_upd©e
, bgp_∆rò*
mp_wôhdøw
)

1996 
ªt
;

1997 
u_ch¨
 
Êag
 = 0;

1998 
u_ch¨
 
ty≥
 = 0;

1999 
bgp_size_t
 
Àngth
;

2000 
u_ch¨
 *
°¨ç
, *
ídp
;

2001 
u_ch¨
 *
©å_ídp
;

2002 
u_ch¨
 
£í
[
BGP_ATTR_BITMAP_SIZE
];

2005 
a•©h
 *
as4_∑th
 = 
NULL
;

2006 
as_t
 
as4_aggªg©‹
 = 0;

2007 
ö_addr
 
as4_aggªg©‹_addr
 = { 0 };

2010 
	`mem£t
 (
£í
, 0, 
BGP_ATTR_BITMAP_SIZE
);

2013 
ídp
 = 
	`BGP_INPUT_PNT
 (
≥î
Ë+ 
size
;

2016 
	`BGP_INPUT_PNT
 (
≥î
Ë< 
ídp
)

2019 i‡(
ídp
 - 
	`BGP_INPUT_PNT
 (
≥î
Ë< 
BGP_ATTR_MIN_LEN
)

2022 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2024 
≥î
->
ho°
,

2025 (Ë(
ídp
 - 
	`STREAM_PNT
 (
	`BGP_INPUT
 (
≥î
))));

2027 
	`bgp_nŸify_£nd
 (
≥î
,

2028 
BGP_NOTIFY_UPDATE_ERR
,

2029 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
);

2030  
BGP_ATTR_PARSE_ERROR
;

2034 
°¨ç
 = 
	`BGP_INPUT_PNT
 (
≥î
);

2038 
Êag
 = 0xF0 & 
	`°ªam_gëc
 (
	`BGP_INPUT
 (
≥î
));

2039 
ty≥
 = 
	`°ªam_gëc
 (
	`BGP_INPUT
 (
≥î
));

2042 i‡(
	`CHECK_FLAG
 (
Êag
, 
BGP_ATTR_FLAG_EXTLEN
)

2043 && ((
ídp
 - 
°¨ç
Ë< (
BGP_ATTR_MIN_LEN
 + 1)))

2045 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2047 
≥î
->
ho°
,

2048 (Ë(
ídp
 - 
	`STREAM_PNT
 (
	`BGP_INPUT
 (
≥î
))));

2050 
	`bgp_nŸify_£nd
 (
≥î
,

2051 
BGP_NOTIFY_UPDATE_ERR
,

2052 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
);

2053  
BGP_ATTR_PARSE_ERROR
;

2057 i‡(
	`CHECK_FLAG
 (
Êag
, 
BGP_ATTR_FLAG_EXTLEN
))

2058 
Àngth
 = 
	`°ªam_gëw
 (
	`BGP_INPUT
 (
≥î
));

2060 
Àngth
 = 
	`°ªam_gëc
 (
	`BGP_INPUT
 (
≥î
));

2066 i‡(
	`CHECK_BITMAP
 (
£í
, 
ty≥
))

2068 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2070 
≥î
->
ho°
, 
ty≥
);

2072 
	`bgp_nŸify_£nd
 (
≥î
,

2073 
BGP_NOTIFY_UPDATE_ERR
,

2074 
BGP_NOTIFY_UPDATE_MAL_ATTR
);

2075  
BGP_ATTR_PARSE_ERROR
;

2081 
	`SET_BITMAP
 (
£í
, 
ty≥
);

2084 
©å_ídp
 = 
	`BGP_INPUT_PNT
 (
≥î
Ë+ 
Àngth
;

2086 i‡(
©å_ídp
 > 
ídp
)

2088 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2089 "%s: BGPÅy≥ %dÜígth %d i†toÿœrge,áâribuãÅŸÆÜígth i†%d.áâr_íd∞i†%p.Énd∞i†%p", 
≥î
->
ho°
, 
ty≥
, 
Àngth
, 
size
, 
©å_ídp
, 
ídp
);

2090 
	`bgp_nŸify_£nd
 (
≥î
,

2091 
BGP_NOTIFY_UPDATE_ERR
,

2092 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
);

2093  
BGP_ATTR_PARSE_ERROR
;

2096 
bgp_©å_∑r£r_¨gs
 
©å_¨gs
 = {

2097 .
≥î
 =Öeer,

2098 .
Àngth
 =Üength,

2099 .
©å
 =áttr,

2100 .
ty≥
 =Åype,

2101 .
Êags
 = 
Êag
,

2102 .
°¨ç
 = startp,

2103 .
tŸÆ
 = 
©å_ídp
 - 
°¨ç
,

2111 i‡(
	`bgp_©å_Êag_övÆid
 (&
©å_¨gs
))

2113 
bgp_©å_∑r£_ªt_t
 
ªt
;

2114 
ªt
 = 
	`bgp_©å_mÆf‹med
 (&
©å_¨gs
,

2115 
BGP_NOTIFY_UPDATE_ATTR_FLAG_ERR
,

2116 
©å_¨gs
.
tŸÆ
);

2117 i‡(
ªt
 =
BGP_ATTR_PARSE_PROCEED
)

2119  
ªt
;

2123 
ty≥
)

2125 
BGP_ATTR_ORIGIN
:

2126 
ªt
 = 
	`bgp_©å_‹igö
 (&
©å_¨gs
);

2128 
BGP_ATTR_AS_PATH
:

2129 
ªt
 = 
	`bgp_©å_a•©h
 (&
©å_¨gs
);

2131 
BGP_ATTR_AS4_PATH
:

2132 
ªt
 = 
	`bgp_©å_as4_∑th
 (&
©å_¨gs
, &
as4_∑th
);

2134 
BGP_ATTR_NEXT_HOP
:

2135 
ªt
 = 
	`bgp_©å_√xth›
 (&
©å_¨gs
);

2137 
BGP_ATTR_MULTI_EXIT_DISC
:

2138 
ªt
 = 
	`bgp_©å_med
 (&
©å_¨gs
);

2140 
BGP_ATTR_LOCAL_PREF
:

2141 
ªt
 = 
	`bgp_©å_loˇl_¥ef
 (&
©å_¨gs
);

2143 
BGP_ATTR_ATOMIC_AGGREGATE
:

2144 
ªt
 = 
	`bgp_©å_©omic
 (&
©å_¨gs
);

2146 
BGP_ATTR_AGGREGATOR
:

2147 
ªt
 = 
	`bgp_©å_aggªg©‹
 (&
©å_¨gs
);

2149 
BGP_ATTR_AS4_AGGREGATOR
:

2150 
ªt
 = 
	`bgp_©å_as4_aggªg©‹
 (&
©å_¨gs
,

2151 &
as4_aggªg©‹
,

2152 &
as4_aggªg©‹_addr
);

2154 
BGP_ATTR_COMMUNITIES
:

2155 
ªt
 = 
	`bgp_©å_communôy
 (&
©å_¨gs
);

2157 
BGP_ATTR_ORIGINATOR_ID
:

2158 
ªt
 = 
	`bgp_©å_‹igö©‹_id
 (&
©å_¨gs
);

2160 
BGP_ATTR_CLUSTER_LIST
:

2161 
ªt
 = 
	`bgp_©å_˛u°î_li°
 (&
©å_¨gs
);

2163 
BGP_ATTR_MP_REACH_NLRI
:

2164 
ªt
 = 
	`bgp_mp_ªach_∑r£
 (&
©å_¨gs
, 
mp_upd©e
);

2166 
BGP_ATTR_MP_UNREACH_NLRI
:

2167 
ªt
 = 
	`bgp_mp_uƒóch_∑r£
 (&
©å_¨gs
, 
mp_wôhdøw
);

2169 
BGP_ATTR_EXT_COMMUNITIES
:

2170 
ªt
 = 
	`bgp_©å_ext_communôõs
 (&
©å_¨gs
);

2172 #ifde‡
USE_SRX


2173 
BGP_ATTR_BGPSEC
:

2174 
ªt
 = 
	`bgp_©å_bgp£c
(&
©å_¨gs
);

2175 i‡(
ªt
 =
BGP_ATTR_PARSE_ERROR
)

2181 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
, "BGPSEC Update Malformed!!");

2186 
ªt
 = 
	`bgp_©å_unknown
 (&
©å_¨gs
);

2190 #ifde‡
USE_SRX


2194 i‡(
	`BGP_INPUT_PNT
 (
≥î
Ë>
ídp
)

2201 i‡(
©å_¨gs
.
©å
->
bgp£c_vÆid©i⁄D©a
 !
NULL
)

2204 
SCA_Pªfix
* 
∆ri
 = 
	`bgp£c_¸óã_vÆd©a_∆ri
(
mp_upd©e
);

2205 i‡(
∆ri
 =
NULL
)

2207 
	`zlog_îr
("[BGPSEC] BGPSEC_PATH doesÇot seemÅo haveÖrefixes stored.");

2208 
	`bgp_nŸify_£nd
 (
≥î
,

2209 
BGP_NOTIFY_UPDATE_ERR
,

2210 
BGP_NOTIFY_UPDATE_ATTR_FLAG_ERR
);

2211 
ªt
 = 
BGP_ATTR_PARSE_ERROR
;

2215 
©å_¨gs
.
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
 =Çlri;

2222 i‡(
ªt
 =
BGP_ATTR_PARSE_ERROR
)

2224 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2226 
≥î
->
ho°
,

2227 
	`LOOKUP
 (
©å_°r
, 
ty≥
));

2228 
	`bgp_nŸify_£nd
 (
≥î
,

2229 
BGP_NOTIFY_UPDATE_ERR
,

2230 
BGP_NOTIFY_UPDATE_MAL_ATTR
);

2231 i‡(
as4_∑th
)

2232 
	`a•©h_unöã∫
 (&
as4_∑th
);

2233  
ªt
;

2235 i‡(
ªt
 =
BGP_ATTR_PARSE_WITHDRAW
)

2238 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2240 
≥î
->
ho°
,

2241 
	`LOOKUP
 (
©å_°r
, 
ty≥
));

2242 i‡(
as4_∑th
)

2243 
	`a•©h_unöã∫
 (&
as4_∑th
);

2244  
ªt
;

2248 i‡(
	`BGP_INPUT_PNT
 (
≥î
Ë!
©å_ídp
)

2250 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2252 
≥î
->
ho°
, 
	`LOOKUP
 (
©å_°r
, 
ty≥
));

2253 
	`bgp_nŸify_£nd
 (
≥î
,

2254 
BGP_NOTIFY_UPDATE_ERR
,

2255 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
);

2256 i‡(
as4_∑th
)

2257 
	`a•©h_unöã∫
 (&
as4_∑th
);

2258  
BGP_ATTR_PARSE_ERROR
;

2263 i‡(
	`BGP_INPUT_PNT
 (
≥î
Ë!
ídp
)

2265 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2267 
≥î
->
ho°
, 
	`LOOKUP
 (
©å_°r
, 
ty≥
));

2268 
	`bgp_nŸify_£nd
 (
≥î
,

2269 
BGP_NOTIFY_UPDATE_ERR
,

2270 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
);

2271 i‡(
as4_∑th
)

2272 
	`a•©h_unöã∫
 (&
as4_∑th
);

2273  
BGP_ATTR_PARSE_ERROR
;

2287 i‡(
	`bgp_©å_munge_as4_©ås
 (
≥î
, 
©å
, 
as4_∑th
,

2288 
as4_aggªg©‹
, &
as4_aggªg©‹_addr
))

2290 i‡(
as4_∑th
)

2291 
	`a•©h_unöã∫
 (&
as4_∑th
);

2292  
BGP_ATTR_PARSE_ERROR
;

2300 i‡(
as4_∑th
)

2302 
	`a•©h_unöã∫
 (&
as4_∑th
);

2318 i‡(
©å
->
Êag
 & (
	`ATTR_FLAG_BIT
(
BGP_ATTR_AS_PATH
)))

2320 
ªt
 = 
	`bgp_©å_a•©h_check
 (
≥î
, 
©å
);

2321 i‡(
ªt
 !
BGP_ATTR_PARSE_PROCEED
)

2322  
ªt
;

2326 i‡(
©å
->
exåa
 &&áâr->exåa->
å™sô
)

2327 
©å
->
exåa
->
å™sô
 = 
	`å™sô_öã∫
 (attr->extra->transit);

2329  
BGP_ATTR_PARSE_PROCEED
;

2330 
	}
}

2334 
	$bgp_©å_check
 (
≥î
 *≥î, 
©å
 *attr)

2336 
u_ch¨
 
ty≥
 = 0;

2338 i‡(! 
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGIN
)))

2339 
ty≥
 = 
BGP_ATTR_ORIGIN
;

2341 i‡(! 
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS_PATH
)))

2342 
ty≥
 = 
BGP_ATTR_AS_PATH
;

2344 i‡(! 
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
)))

2345 
ty≥
 = 
BGP_ATTR_NEXT_HOP
;

2347 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP


2348 && ! 
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
)))

2349 
ty≥
 = 
BGP_ATTR_LOCAL_PREF
;

2351 i‡(
ty≥
)

2353 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

2355 
≥î
->
ho°
, 
ty≥
);

2356 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

2357 
BGP_NOTIFY_UPDATE_ERR
,

2358 
BGP_NOTIFY_UPDATE_MISS_ATTR
,

2359 &
ty≥
, 1);

2360  
BGP_ATTR_PARSE_ERROR
;

2362  
BGP_ATTR_PARSE_PROCEED
;

2363 
	}
}

2365 
°ªam_put_¥efix
 (
°ªam
 *, 
¥efix
 *);

2368 #ifde‡
USE_SRX


2375 
bgp_size_t


2376 
	$bgp_∑ckë_©åibuã
 (
bgp
 *bgp, 
≥î
 *peer,

2377 
°ªam
 *
s
, 
©å
 *©å, 
¥efix
 *
p
,

2378 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
≥î
 *
‰om
,

2379 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
, 
boﬁ
* 
u£AS∑th
)

2383 *
u£AS∑th
 = 
Ál£
;

2386 
bgp_size_t


2387 
	$bgp_∑ckë_©åibuã
 (
bgp
 *bgp, 
≥î
 *peer,

2388 
°ªam
 *
s
, 
©å
 *©å, 
¥efix
 *
p
,

2389 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
≥î
 *
‰om
,

2390 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
)

2394 
size_t
 
˝
;

2395 
size_t
 
a•©h_sizï
;

2396 
a•©h
 *aspath;

2397 
£nd_as4_∑th
 = 0;

2398 
£nd_as4_aggªg©‹
 = 0;

2399 
u£32bô
 = (
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
)) ? 1 : 0;

2401 i‡(! 
bgp
)

2402 
bgp
 = 
	`bgp_gë_deÁu…
 ();

2405 
˝
 = 
	`°ªam_gë_ídp
 (
s
);

2408 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

2409 
	`°ªam_putc
 (
s
, 
BGP_ATTR_ORIGIN
);

2410 
	`°ªam_putc
 (
s
, 1);

2411 
	`°ªam_putc
 (
s
, 
©å
->
‹igö
);

2416 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP


2417 && (! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_AS_PATH_UNCHANGED
)

2418 || 
©å
->
a•©h
->
£gmíts
 =
NULL
)

2419 && (! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
)))

2421 
a•©h
 = 
	`a•©h_dup
 (
©å
->aspath);

2423 i‡(
	`CHECK_FLAG
(
bgp
->
c⁄fig
, 
BGP_CONFIG_CONFEDERATION
))

2427 
a•©h
 = 
	`a•©h_dñëe_c⁄„d_£q
 (aspath);

2428 
a•©h
 = 
	`a•©h_add_£q
 (a•©h, 
bgp
->
c⁄„d_id
);

2432 i‡(
≥î
->
ch™ge_loˇl_as
) {

2435 if–! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
) ) {

2436 
a•©h
 = 
	`a•©h_add_£q
 (a•©h, 
≥î
->
loˇl_as
);

2438 
a•©h
 = 
	`a•©h_add_£q
 (a•©h, 
≥î
->
ch™ge_loˇl_as
);

2440 
a•©h
 = 
	`a•©h_add_£q
 (a•©h, 
≥î
->
loˇl_as
);

2444 i‡(
≥î
->
s‹t
 =
BGP_PEER_CONFED
)

2447 
a•©h
 = 
	`a•©h_dup
 (
©å
->aspath);

2448 
a•©h
 = 
	`a•©h_add_c⁄„d_£q
 (a•©h, 
≥î
->
loˇl_as
);

2451 
a•©h
 = 
©å
->aspath;

2453 #ifde‡
USE_SRX


2454 i‡(!*
u£AS∑th
)

2459 *
u£AS∑th
 = (
a•©h
->
°r_Àn
 > 0Ë&& (
©å
->
bgp£cP©hAâr
 =
NULL
);

2467 i‡(!*
u£AS∑th


2468 && ( ( !
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
)

2469 || !
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_BGPSEC_ADV
)

2471 || ( 
‰om
 && from->
as
 && from->a†!
≥î
->as

2472 && ( !
	`CHECK_FLAG
 (
‰om
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
)

2473 || !
	`CHECK_FLAG
 (
‰om
->
ˇp
, 
PEER_CAP_BGPSEC_ADV_SEND
)

2477 || (
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
))

2478 || (
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
))

2483 *
u£AS∑th
 = 
åue
;

2486 
u_öt8_t
 
pCou¡
 = 0;

2487 
u_öt8_t
 
Êags
 = 0;

2488 
SCA_Sig«tuª
* 
sig«tuª
 = 
NULL
;

2490 i‡(!(*
u£AS∑th
))

2497 i‡((
≥î
->
s‹t
 =
BGP_PEER_EBGP
Ë|| (≥î->s‹à=
BGP_PEER_CONFED
))

2500 
Êags
 = 
≥î
->
s‹t
 =
BGP_PEER_CONFED
 ? 0x80 : 0;

2501 
pCou¡
 = (
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_MIGRATE
))

2503 : 
≥î
->
s‹t
 =
BGP_PEER_CONFED
 ? 0 : 1;

2504 
sig«tuª
 = 
	`signBGPSecP©hAâr
(
bgp
, 
≥î
, 
p
, 
©å
, 
pCou¡
, 
Êags
);

2508 *
u£AS∑th
 = 
sig«tuª
 =
NULL
;

2510 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
 ||Öìr->s‹à=
BGP_PEER_INTERNAL
)

2513 *
u£AS∑th
 = 
©å
->
bgp£cP©hAâr
 =
NULL
;

2517 i‡(*
u£AS∑th
)

2529 #i‚de‡
USE_SRX


2530 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_EXTLEN
);

2531 
	`°ªam_putc
 (
s
, 
BGP_ATTR_AS_PATH
);

2532 
a•©h_sizï
 = 
	`°ªam_gë_ídp
 (
s
);

2533 
	`°ªam_putw
 (
s
, 0);

2534 
	`°ªam_putw_©
 (
s
, 
a•©h_sizï
, 
	`a•©h_put
 (s, 
a•©h
, 
u£32bô
));

2540 i‡(!
u£32bô
 && 
	`a•©h_has_as4
 (
a•©h
))

2541 
£nd_as4_∑th
 = 1;

2544 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
Ë&& 
afi
 =
AFI_IP
)

2546 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

2547 
	`°ªam_putc
 (
s
, 
BGP_ATTR_NEXT_HOP
);

2548 
	`°ªam_putc
 (
s
, 4);

2549 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

2551 i‡(
©å
->
√xth›
.
s_addr
 == 0)

2552 
	`°ªam_put_ùv4
 (
s
, 
≥î
->
√xth›
.
v4
.
s_addr
);

2554 
	`°ªam_put_ùv4
 (
s
, 
©å
->
√xth›
.
s_addr
);

2557 
	`°ªam_put_ùv4
 (
s
, 
©å
->
√xth›
.
s_addr
);

2559 #ifde‡
USE_SRX


2564 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
))

2566 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

2567 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MULTI_EXIT_DISC
);

2568 
	`°ªam_putc
 (
s
, 4);

2569 
	`°ªam_pué
 (
s
, 
©å
->
med
);

2573 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
 ||

2574 
≥î
->
s‹t
 =
BGP_PEER_CONFED
)

2576 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

2577 
	`°ªam_putc
 (
s
, 
BGP_ATTR_LOCAL_PREF
);

2578 
	`°ªam_putc
 (
s
, 4);

2579 
	`°ªam_pué
 (
s
, 
©å
->
loˇl_¥ef
);

2583 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
))

2585 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

2586 
	`°ªam_putc
 (
s
, 
BGP_ATTR_ATOMIC_AGGREGATE
);

2587 
	`°ªam_putc
 (
s
, 0);

2590 #ifde‡
USE_SRX


2596 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
))

2598 
	`as£π
 (
©å
->
exåa
);

2601 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
);

2602 
	`°ªam_putc
 (
s
, 
BGP_ATTR_AGGREGATOR
);

2604 i‡(
u£32bô
)

2607 
	`°ªam_putc
 (
s
, 8);

2608 
	`°ªam_pué
 (
s
, 
©å
->
exåa
->
aggªg©‹_as
);

2613 
	`°ªam_putc
 (
s
, 6);

2616 i‡–
©å
->
exåa
->
aggªg©‹_as
 > 65535 )

2618 
	`°ªam_putw
 (
s
, 
BGP_AS_TRANS
);

2624 
£nd_as4_aggªg©‹
 = 1;

2627 
	`°ªam_putw
 (
s
, (
u_öt16_t
Ë
©å
->
exåa
->
aggªg©‹_as
);

2629 
	`°ªam_put_ùv4
 (
s
, 
©å
->
exåa
->
aggªg©‹_addr
.
s_addr
);

2633 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_COMMUNITY
)

2634 && (
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
)))

2636 i‡(
©å
->
communôy
->
size
 * 4 > 255)

2638 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_EXTLEN
);

2639 
	`°ªam_putc
 (
s
, 
BGP_ATTR_COMMUNITIES
);

2640 
	`°ªam_putw
 (
s
, 
©å
->
communôy
->
size
 * 4);

2644 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
);

2645 
	`°ªam_putc
 (
s
, 
BGP_ATTR_COMMUNITIES
);

2646 
	`°ªam_putc
 (
s
, 
©å
->
communôy
->
size
 * 4);

2648 
	`°ªam_put
 (
s
, 
©å
->
communôy
->
vÆ
,áâr->communôy->
size
 * 4);

2652 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP


2653 && 
‰om


2654 && 
‰om
->
s‹t
 =
BGP_PEER_IBGP
)

2657 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

2658 
	`°ªam_putc
 (
s
, 
BGP_ATTR_ORIGINATOR_ID
);

2659 
	`°ªam_putc
 (
s
, 4);

2661 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_ORIGINATOR_ID
))

2662 
	`°ªam_put_ö_addr
 (
s
, &
©å
->
exåa
->
‹igö©‹_id
);

2664 
	`°ªam_put_ö_addr
 (
s
, &
‰om
->
ªmŸe_id
);

2667 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

2668 
	`°ªam_putc
 (
s
, 
BGP_ATTR_CLUSTER_LIST
);

2670 i‡(
©å
->
exåa
 &&áâr->exåa->
˛u°î
)

2672 
	`°ªam_putc
 (
s
, 
©å
->
exåa
->
˛u°î
->
Àngth
 + 4);

2674 i‡(
bgp
->
c⁄fig
 & 
BGP_CONFIG_CLUSTER_ID
)

2675 
	`°ªam_put_ö_addr
 (
s
, &
bgp
->
˛u°î_id
);

2677 
	`°ªam_put_ö_addr
 (
s
, &
bgp
->
rouãr_id
);

2678 
	`°ªam_put
 (
s
, 
©å
->
exåa
->
˛u°î
->
li°
,

2679 
©å
->
exåa
->
˛u°î
->
Àngth
);

2683 
	`°ªam_putc
 (
s
, 4);

2685 i‡(
bgp
->
c⁄fig
 & 
BGP_CONFIG_CLUSTER_ID
)

2686 
	`°ªam_put_ö_addr
 (
s
, &
bgp
->
˛u°î_id
);

2688 
	`°ªam_put_ö_addr
 (
s
, &
bgp
->
rouãr_id
);

2692 #ifde‡
USE_SRX


2695 i‡(!(*
u£AS∑th
))

2700 i‡–
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_MPE_IPV4
)

2701 && (
≥î
->
s‹t
 !
BGP_PEER_IBGP
Ë&& (
ßfi
 =
SAFI_UNICAST
))

2705 
©åSize
 = 13 + ((
p
->
¥efixÀn
 + 7) / 8);

2710 i‡(
p
->
Ámûy
 =
AF_INET
)

2712 
	`as£π
 (
©å
->
exåa
);

2714 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

2715 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MP_REACH_NLRI
);

2718 
	`°ªam_putc
 (
s
, (
©åSize
 - 3));

2720 
	`°ªam_putw
 (
s
, 
AFI_IP
);

2721 
	`°ªam_putc
 (
s
, 
ßfi
);

2723 
	`°ªam_putc
 (
s
, 4);

2724 
	`°ªam_put
 (
s
, &
©å
->
√xth›
, 4);

2727 
	`°ªam_putc
 (
s
, 0);

2730 
	`°ªam_put_¥efix
 (
s
, 
p
);

2736 #ifde‡
HAVE_IPV6


2738 i‡(
p
->
Ámûy
 =
AF_INET6
)

2740 
sizï
;

2741 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

2743 
	`as£π
 (
©å
->
exåa
);

2745 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

2746 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MP_REACH_NLRI
);

2747 
sizï
 = 
	`°ªam_gë_ídp
 (
s
);

2748 
	`°ªam_putc
 (
s
, 0);

2749 
	`°ªam_putw
 (
s
, 
AFI_IP6
);

2750 
	`°ªam_putc
 (
s
, 
ßfi
);

2752 
	`°ªam_putc
 (
s
, 
©åe
->
mp_√xth›_Àn
);

2754 i‡(
©åe
->
mp_√xth›_Àn
 == 16)

2755 
	`°ªam_put
 (
s
, &
©åe
->
mp_√xth›_globÆ
, 16);

2756 i‡(
©åe
->
mp_√xth›_Àn
 == 32)

2758 
	`°ªam_put
 (
s
, &
©åe
->
mp_√xth›_globÆ
, 16);

2759 
	`°ªam_put
 (
s
, &
©åe
->
mp_√xth›_loˇl
, 16);

2763 
	`°ªam_putc
 (
s
, 0);

2766 
	`°ªam_put_¥efix
 (
s
, 
p
);

2769 
	`°ªam_putc_©
 (
s
, 
sizï
, (
	`°ªam_gë_ídp
 (s) - sizep) - 1);

2773 i‡(
p
->
Ámûy
 =
AF_INET
 && 
ßfi
 =
SAFI_MULTICAST
)

2775 
sizï
;

2777 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

2778 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MP_REACH_NLRI
);

2779 
sizï
 = 
	`°ªam_gë_ídp
 (
s
);

2780 
	`°ªam_putc
 (
s
, 0);

2781 
	`°ªam_putw
 (
s
, 
AFI_IP
);

2782 
	`°ªam_putc
 (
s
, 
SAFI_MULTICAST
);

2784 
	`°ªam_putc
 (
s
, 4);

2785 
	`°ªam_put_ùv4
 (
s
, 
©å
->
√xth›
.
s_addr
);

2788 
	`°ªam_putc
 (
s
, 0);

2791 
	`°ªam_put_¥efix
 (
s
, 
p
);

2794 
	`°ªam_putc_©
 (
s
, 
sizï
, (
	`°ªam_gë_ídp
 (s) - sizep) - 1);

2797 i‡(
p
->
Ámûy
 =
AF_INET
 && 
ßfi
 =
SAFI_MPLS_VPN
)

2799 
sizï
;

2801 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

2802 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MP_REACH_NLRI
);

2803 
sizï
 = 
	`°ªam_gë_ídp
 (
s
);

2804 
	`°ªam_putc
 (
s
, 0);

2805 
	`°ªam_putw
 (
s
, 
AFI_IP
);

2806 
	`°ªam_putc
 (
s
, 
SAFI_MPLS_LABELED_VPN
);

2808 
	`°ªam_putc
 (
s
, 12);

2809 
	`°ªam_pué
 (
s
, 0);

2810 
	`°ªam_pué
 (
s
, 0);

2811 
	`°ªam_put
 (
s
, &
©å
->
exåa
->
mp_√xth›_globÆ_ö
, 4);

2814 
	`°ªam_putc
 (
s
, 0);

2817 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
 + 88);

2818 
	`°ªam_put
 (
s
, 
èg
, 3);

2819 
	`°ªam_put
 (
s
, 
¥d
->
vÆ
, 8);

2820 
	`°ªam_put
 (
s
, &
p
->
u
.
¥efix
, 
	`PSIZE
 (p->
¥efixÀn
));

2823 
	`°ªam_putc_©
 (
s
, 
sizï
, (
	`°ªam_gë_ídp
 (s) - sizep) - 1);

2827 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_EXT_COMMUNITY
)

2828 && (
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
)))

2830 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

2832 
	`as£π
 (
©åe
);

2834 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP


2835 || 
≥î
->
s‹t
 =
BGP_PEER_CONFED
)

2837 i‡(
©åe
->
ecommunôy
->
size
 * 8 > 255)

2839 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_EXTLEN
);

2840 
	`°ªam_putc
 (
s
, 
BGP_ATTR_EXT_COMMUNITIES
);

2841 
	`°ªam_putw
 (
s
, 
©åe
->
ecommunôy
->
size
 * 8);

2845 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
);

2846 
	`°ªam_putc
 (
s
, 
BGP_ATTR_EXT_COMMUNITIES
);

2847 
	`°ªam_putc
 (
s
, 
©åe
->
ecommunôy
->
size
 * 8);

2849 
	`°ªam_put
 (
s
, 
©åe
->
ecommunôy
->
vÆ
,áâª->ecommunôy->
size
 * 8);

2853 
u_öt8_t
 *
≤t
;

2854 
tbô
;

2855 
ecom_å_size
 = 0;

2856 
i
;

2858 
i
 = 0; i < 
©åe
->
ecommunôy
->
size
; i++)

2860 
≤t
 = 
©åe
->
ecommunôy
->
vÆ
 + (
i
 * 8);

2861 
tbô
 = *
≤t
;

2863 #ifde‡
USE_SRX


2864 i‡((!
	`CHECK_FLAG
 (
≥î
->
bgp
->
§x_ecommunôy_Êags
,

2865 
SRX_BGP_FLAG_ECOMMUNITY_EBGP
))

2866 && (
	`CHECK_FLAG
 (
tbô
, 
ECOMMUNITY_FLAG_NON_TRANSITIVE
)))

2871 i‡(
	`CHECK_FLAG
 (
tbô
, 
ECOMMUNITY_FLAG_NON_TRANSITIVE
))

2875 
ecom_å_size
++;

2878 i‡(
ecom_å_size
)

2880 i‡(
ecom_å_size
 * 8 > 255)

2882 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_EXTLEN
);

2883 
	`°ªam_putc
 (
s
, 
BGP_ATTR_EXT_COMMUNITIES
);

2884 
	`°ªam_putw
 (
s
, 
ecom_å_size
 * 8);

2888 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
);

2889 
	`°ªam_putc
 (
s
, 
BGP_ATTR_EXT_COMMUNITIES
);

2890 
	`°ªam_putc
 (
s
, 
ecom_å_size
 * 8);

2893 
i
 = 0; i < 
©åe
->
ecommunôy
->
size
; i++)

2895 
≤t
 = 
©åe
->
ecommunôy
->
vÆ
 + (
i
 * 8);

2896 
tbô
 = *
≤t
;

2897 #ifde‡
USE_SRX


2899 i‡(!
	`CHECK_FLAG
 (
≥î
->
bgp
->
§x_ecommunôy_Êags
,

2900 
SRX_BGP_FLAG_ECOMMUNITY_EBGP
)

2901 && (
	`CHECK_FLAG
 (
tbô
, 
ECOMMUNITY_FLAG_NON_TRANSITIVE
)))

2906 i‡(
	`CHECK_FLAG
 (
tbô
, 
ECOMMUNITY_FLAG_NON_TRANSITIVE
))

2909 
	`°ªam_put
 (
s
, 
≤t
, 8);

2915 #ifde‡
USE_SRX


2918 i‡–
£nd_as4_∑th
 )

2932 
a•©h
 = 
	`a•©h_dñëe_c⁄„d_£q
 (aspath);

2934 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_EXTLEN
);

2935 
	`°ªam_putc
 (
s
, 
BGP_ATTR_AS4_PATH
);

2936 
a•©h_sizï
 = 
	`°ªam_gë_ídp
 (
s
);

2937 
	`°ªam_putw
 (
s
, 0);

2938 
	`°ªam_putw_©
 (
s
, 
a•©h_sizï
, 
	`a•©h_put
 (s, 
a•©h
, 1));

2941 #ifde‡
USE_SRX


2942 
a•©h
* 
a•©h_bgp£c
 = 
NULL
;

2943 
a•©h_bgp£c
 = 
	`a•©h_dup
(
a•©h
);

2945 i‡(
a•©h
 !
©å
->aspath)

2946 
	`a•©h_‰ì
 (
a•©h
);

2948 i‡–
£nd_as4_aggªg©‹
 )

2950 
	`as£π
 (
©å
->
exåa
);

2956 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
);

2957 
	`°ªam_putc
 (
s
, 
BGP_ATTR_AS4_AGGREGATOR
);

2958 
	`°ªam_putc
 (
s
, 8);

2959 
	`°ªam_pué
 (
s
, 
©å
->
exåa
->
aggªg©‹_as
);

2960 
	`°ªam_put_ùv4
 (
s
, 
©å
->
exåa
->
aggªg©‹_addr
.
s_addr
);

2963 #ifde‡
USE_SRX


2964 i‡(!(*
u£AS∑th
))

2974 
SCA_BGPSecVÆid©i⁄D©a
* 
vÆD©a
 = 
©å
->
bgp£c_vÆid©i⁄D©a
;

2975 
boﬁ
 
°‹ed
 = 
Ál£
;

2976 i‡(
vÆD©a
 !
NULL
)

2979 i‡((
vÆD©a
->
bgp£c_∑th_©å
 !
NULL
Ë&& (
≥î
->
s‹t
 =
BGP_PEER_IBGP
))

2982 
SCA_BGP_P©hAâribuã
* 
∑
 =

2983 (
SCA_BGP_P©hAâribuã
*)
vÆD©a
->
bgp£c_∑th_©å
;

2984 
u_öt16_t
 
Àn
 = 0;

2985 i‡(
∑
->
Êags
 & 
SCA_BGP_UPD_A_FLAGS_EXT_LENGTH
> 0)

2987 
Àn
 = 
	`¡ohs
(((
SCA_BGPSEC_ExtP©hAâribuã
*)
∑
)->
©åLígth
);

2991 
Àn
 = ((
SCA_BGPSEC_N‹mP©hAâribuã
*)
∑
)->
©åLígth
;

2994 
	`°ªam_wrôe
(
s
, 
vÆD©a
->
bgp£c_∑th_©å
, 
Àn
);

2995 
°‹ed
 = 
åue
;

2999 i‡(!
°‹ed
)

3002 
SCA_Sig«tuª
* 
sig«tuªs
[1] = {
sig«tuª
};

3003 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_EXTLEN
);

3004 
	`°ªam_putc
 (
s
, 
BGP_ATTR_BGPSEC
);

3005 
a•©h_sizï
 = 
	`°ªam_gë_ídp
 (
s
);

3007 
	`°ªam_putw
 (
s
, 0);

3008 
©åLí
 = 
	`c⁄°ru˘BGPSecP©hAâribuã
(
bgp
, 
≥î
, 
a•©h_bgp£c
,

3009 
p
, 
s
, 
©å
, 
Êags
, 
pCou¡
,

3010 
sig«tuªs
, 1);

3011 
	`°ªam_putw_©
 (
s
, 
a•©h_sizï
, 
©åLí
);

3018 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_EXTLEN
);

3019 
	`°ªam_putc
 (
s
, 
BGP_ATTR_AS_PATH
);

3020 
a•©h_sizï
 = 
	`°ªam_gë_ídp
 (
s
);

3021 
	`°ªam_putw
 (
s
, 0);

3022 #ifde‡
USE_SRX


3023 
	`°ªam_putw_©
 (
s
, 
a•©h_sizï
, 
	`a•©h_put
 (s, 
a•©h_bgp£c
, 
u£32bô
));

3025 
	`°ªam_putw_©
 (
s
, 
a•©h_sizï
, 
	`a•©h_put
 (s, 
a•©h
, 
u£32bô
));

3028 #ifde‡
USE_SRX


3032 i‡(
a•©h_bgp£c
)

3034 
	`a•©h_‰ì
 (
a•©h_bgp£c
);

3036 i‡(
sig«tuª
 !
NULL
)

3038 i‡(
bgp
->
§xCAPI
->
	`‰ìSig«tuª
(
sig«tuª
Ë=
API_FAILURE
)

3040 
	`‰ì
(
sig«tuª
->
sigBuff
);

3041 
sig«tuª
->
sigBuff
 = 
NULL
;

3042 
	`‰ì
(
sig«tuª
);

3044 
sig«tuª
 = 
NULL
;

3050 i‡(
©å
->
exåa
 &&áâr->exåa->
å™sô
)

3051 
	`°ªam_put
 (
s
, 
©å
->
exåa
->
å™sô
->
vÆ
,áâr->exåa->å™sô->
Àngth
);

3054  
	`°ªam_gë_ídp
 (
s
Ë- 
˝
;

3055 
	}
}

3057 
bgp_size_t


3058 
	$bgp_∑ckë_wôhdøw
 (
≥î
 *≥î, 
°ªam
 *
s
, 
¥efix
 *
p
,

3059 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
¥efix_rd
 *
¥d
,

3060 
u_ch¨
 *
èg
)

3062 
˝
;

3063 
©åÀn_≤t
;

3064 
bgp_size_t
 
size
;

3066 
˝
 = 
	`°ªam_gë_ídp
 (
s
);

3068 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

3069 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MP_UNREACH_NLRI
);

3071 
©åÀn_≤t
 = 
	`°ªam_gë_ídp
 (
s
);

3072 
	`°ªam_putc
 (
s
, 0);

3074 
	`°ªam_putw
 (
s
, 
	`Ámûy2afi
 (
p
->
Ámûy
));

3076 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

3079 
	`°ªam_putc
 (
s
, 
SAFI_MPLS_LABELED_VPN
);

3082 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
 + 88);

3083 
	`°ªam_put
 (
s
, 
èg
, 3);

3084 
	`°ªam_put
 (
s
, 
¥d
->
vÆ
, 8);

3085 
	`°ªam_put
 (
s
, &
p
->
u
.
¥efix
, 
	`PSIZE
 (p->
¥efixÀn
));

3090 
	`°ªam_putc
 (
s
, 
ßfi
);

3093 
	`°ªam_put_¥efix
 (
s
, 
p
);

3097 
size
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
©åÀn_≤t
 - 1;

3098 
	`°ªam_putc_©
 (
s
, 
©åÀn_≤t
, 
size
);

3100  
	`°ªam_gë_ídp
 (
s
Ë- 
˝
;

3101 
	}
}

3105 
	$bgp_©å_öô
 ()

3107 
	`a•©h_öô
 ();

3108 
	`©åhash_öô
 ();

3109 
	`communôy_öô
 ();

3110 
	`ecommunôy_öô
 ();

3111 
	`˛u°î_öô
 ();

3112 
	`å™sô_öô
 ();

3113 #ifde‡
USE_SRX


3114 
	`bgp£c_∑th_©å_öô
();

3116 
	}
}

3119 
	$bgp_©å_föish
 ()

3121 
	`a•©h_föish
 ();

3122 
	`©åhash_föish
 ();

3123 
	`communôy_föish
 ();

3124 
	`ecommunôy_föish
 ();

3125 
	`˛u°î_föish
 ();

3126 
	`å™sô_föish
 ();

3127 #ifde‡
USE_SRX


3128 
	`bgp£c_∑th_©å_föish
 ();

3130 
	}
}

3134 
	$bgp_dump_rouãs_©å
 (
°ªam
 *
s
, 
©å
 *attr,

3135 
¥efix
 *prefix)

3137 
˝
;

3138 
Àn
;

3139 
size_t
 
a•©h_À≈
;

3140 
a•©h
 *aspath;

3143 
˝
 = 
	`°ªam_gë_ídp
 (
s
);

3146 
	`°ªam_putw
 (
s
, 0);

3149 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

3150 
	`°ªam_putc
 (
s
, 
BGP_ATTR_ORIGIN
);

3151 
	`°ªam_putc
 (
s
, 1);

3152 
	`°ªam_putc
 (
s
, 
©å
->
‹igö
);

3154 
a•©h
 = 
©å
->aspath;

3156 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_EXTLEN
);

3157 
	`°ªam_putc
 (
s
, 
BGP_ATTR_AS_PATH
);

3158 
a•©h_À≈
 = 
	`°ªam_gë_ídp
 (
s
);

3159 
	`°ªam_putw
 (
s
, 0);

3161 
	`°ªam_putw_©
 (
s
, 
a•©h_À≈
, 
	`a•©h_put
 (s, 
a•©h
, 1));

3165 if(
¥efix
 !
NULL


3166 #ifde‡
HAVE_IPV6


3167 && 
¥efix
->
Ámûy
 !
AF_INET6


3171 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

3172 
	`°ªam_putc
 (
s
, 
BGP_ATTR_NEXT_HOP
);

3173 
	`°ªam_putc
 (
s
, 4);

3174 
	`°ªam_put_ùv4
 (
s
, 
©å
->
√xth›
.
s_addr
);

3178 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
))

3180 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

3181 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MULTI_EXIT_DISC
);

3182 
	`°ªam_putc
 (
s
, 4);

3183 
	`°ªam_pué
 (
s
, 
©å
->
med
);

3187 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
))

3189 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

3190 
	`°ªam_putc
 (
s
, 
BGP_ATTR_LOCAL_PREF
);

3191 
	`°ªam_putc
 (
s
, 4);

3192 
	`°ªam_pué
 (
s
, 
©å
->
loˇl_¥ef
);

3196 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
))

3198 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_TRANS
);

3199 
	`°ªam_putc
 (
s
, 
BGP_ATTR_ATOMIC_AGGREGATE
);

3200 
	`°ªam_putc
 (
s
, 0);

3204 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
))

3206 
	`as£π
 (
©å
->
exåa
);

3207 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
);

3208 
	`°ªam_putc
 (
s
, 
BGP_ATTR_AGGREGATOR
);

3209 
	`°ªam_putc
 (
s
, 8);

3210 
	`°ªam_pué
 (
s
, 
©å
->
exåa
->
aggªg©‹_as
);

3211 
	`°ªam_put_ùv4
 (
s
, 
©å
->
exåa
->
aggªg©‹_addr
.
s_addr
);

3215 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
))

3217 i‡(
©å
->
communôy
->
size
 * 4 > 255)

3219 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
|
BGP_ATTR_FLAG_EXTLEN
);

3220 
	`°ªam_putc
 (
s
, 
BGP_ATTR_COMMUNITIES
);

3221 
	`°ªam_putw
 (
s
, 
©å
->
communôy
->
size
 * 4);

3225 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
|
BGP_ATTR_FLAG_TRANS
);

3226 
	`°ªam_putc
 (
s
, 
BGP_ATTR_COMMUNITIES
);

3227 
	`°ªam_putc
 (
s
, 
©å
->
communôy
->
size
 * 4);

3229 
	`°ªam_put
 (
s
, 
©å
->
communôy
->
vÆ
,áâr->communôy->
size
 * 4);

3232 #ifde‡
HAVE_IPV6


3234 i‡(
¥efix
 !
NULL
 &&Öªfix->
Ámûy
 =
AF_INET6
 && 
©å
->
exåa
 &&

3235 (
©å
->
exåa
->
mp_√xth›_Àn
 == 16 ||áttr->extra->mp_nexthop_len == 32) )

3237 
sizï
;

3238 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

3240 
	`°ªam_putc
(
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

3241 
	`°ªam_putc
(
s
, 
BGP_ATTR_MP_REACH_NLRI
);

3242 
sizï
 = 
	`°ªam_gë_ídp
 (
s
);

3245 
	`°ªam_putc
 (
s
, 0);

3246 
	`°ªam_putw
(
s
, 
AFI_IP6
);

3247 
	`°ªam_putc
(
s
, 
SAFI_UNICAST
);

3250 
	`°ªam_putc
(
s
, 
©åe
->
mp_√xth›_Àn
);

3251 
	`°ªam_put
(
s
, &
©åe
->
mp_√xth›_globÆ
, 16);

3252 i‡(
©åe
->
mp_√xth›_Àn
 == 32)

3253 
	`°ªam_put
(
s
, &
©åe
->
mp_√xth›_loˇl
, 16);

3256 
	`°ªam_putc
(
s
, 0);

3259 
	`°ªam_put_¥efix
(
s
, 
¥efix
);

3262 
	`°ªam_putc_©
 (
s
, 
sizï
, (
	`°ªam_gë_ídp
 (s) - sizep) - 1);

3267 
Àn
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
˝
 - 2;

3268 
	`°ªam_putw_©
 (
s
, 
˝
, 
Àn
);

3269 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_attr.h

21 #i‚de‡
_QUAGGA_BGP_ATTR_H


22 
	#_QUAGGA_BGP_ATTR_H


	)

24 #ifde‡
USE_SRX


25 
	~<§x/§x¸y±ﬂpi.h
>

29 
	#BITMAP_NBBY
 8

	)

31 
	#SET_BITMAP
(
MAP
, 
NUM
) \

32 
	`SET_FLAG
 (
MAP
[(
NUM
Ë/ 
BITMAP_NBBY
], 1 << ((NUMË% BITMAP_NBBY))

	)

34 
	#CHECK_BITMAP
(
MAP
, 
NUM
) \

35 
	`CHECK_FLAG
 (
MAP
[(
NUM
Ë/ 
BITMAP_NBBY
], 1 << ((NUMË% BITMAP_NBBY))

	)

37 
	#BGP_MED_MAX
 
UINT32_MAX


	)

41 
	#BGP_ATTR_TYPE_RANGE
 256

	)

42 
	#BGP_ATTR_BITMAP_SIZE
 (
BGP_ATTR_TYPE_RANGE
 / 
BITMAP_NBBY
)

	)

45 
	#BGP_ATTR_FLAG_OPTIONAL
 0x80

	)

46 
	#BGP_ATTR_FLAG_TRANS
 0x40

	)

47 
	#BGP_ATTR_FLAG_PARTIAL
 0x20

	)

48 
	#BGP_ATTR_FLAG_EXTLEN
 0x10

	)

51 
	#BGP_ATTR_MIN_LEN
 3

	)

52 
	#BGP_ATTR_DEFAULT_WEIGHT
 32768

	)

58 
	s©å_exåa


61 #ifde‡
HAVE_IPV6


62 
ö6_addr
 
	mmp_√xth›_globÆ
;

63 
ö6_addr
 
	mmp_√xth›_loˇl
;

67 
ecommunôy
 *
	mecommunôy
;

70 
˛u°î_li°
 *
	m˛u°î
;

73 
å™sô
 *
	må™sô
;

75 
ö_addr
 
	mmp_√xth›_globÆ_ö
;

76 
ö_addr
 
	mmp_√xth›_loˇl_ö
;

79 
ö_addr
 
	maggªg©‹_addr
;

82 
ö_addr
 
	m‹igö©‹_id
;

85 
u_öt32_t
 
	mweight
;

88 
as_t
 
	maggªg©‹_as
;

91 
u_ch¨
 
	mmp_√xth›_Àn
;

96 
	s©å


99 
a•©h
 *
	ma•©h
;

102 
communôy
 *
	mcommunôy
;

105 
©å_exåa
 *
	mexåa
;

108 
	mªf˙t
;

111 
u_öt32_t
 
	mÊag
;

114 
ö_addr
 
	m√xth›
;

115 
u_öt32_t
 
	mmed
;

116 
u_öt32_t
 
	mloˇl_¥ef
;

119 
u_ch¨
 
	m‹igö
;

121 #ifde‡
USE_SRX


122 
Bgp£cP©hAâr
 *
	mbgp£cP©hAâr
;

124 
SCA_BGPSecVÆid©i⁄D©a
* 
	mbgp£c_vÆid©i⁄D©a
;

129 
	s˛u°î_li°


131 
	mªf˙t
;

132 
	mÀngth
;

133 
ö_addr
 *
	mli°
;

137 
	så™sô


139 
	mªf˙t
;

140 
	mÀngth
;

141 
u_ch¨
 *
	mvÆ
;

144 
	#ATTR_FLAG_BIT
(
X
Ë(1 << ((XË- 1))

	)

147 
	mBGP_ATTR_PARSE_PROCEED
 = 0,

148 
	mBGP_ATTR_PARSE_ERROR
 = -1,

149 
	mBGP_ATTR_PARSE_WITHDRAW
 = -2,

150 } 
	tbgp_©å_∑r£_ªt_t
;

153 
bgp_©å_öô
 ();

154 
bgp_©å_föish
 ();

155 
bgp_©å_∑r£_ªt_t
 
bgp_©å_∑r£
 (
≥î
 *, 
©å
 *,

156 
bgp_size_t
, 
bgp_∆ri
 *,

157 
bgp_∆ri
 *);

158 
bgp_©å_check
 (
≥î
 *, 
©å
 *);

159 
©å_exåa
 *
bgp_©å_exåa_gë
 (
©å
 *);

160 
bgp_©å_exåa_‰ì
 (
©å
 *);

161 
bgp_©å_dup
 (
©å
 *, attr *);

162 
©å
 *
bgp_©å_öã∫
 (attr *attr);

163 
bgp_©å_unöã∫_sub
 (
©å
 *);

164 
bgp_©å_unöã∫
 (
©å
 **);

165 
bgp_©å_Êush
 (
©å
 *);

166 
©å
 *
bgp_©å_deÁu…_£t
 (©å *©å, 
u_ch¨
);

167 
©å
 *
bgp_©å_deÁu…_öã∫
 (
u_ch¨
);

168 
©å
 *
bgp_©å_aggªg©e_öã∫
 (
bgp
 *, 
u_ch¨
,

169 
a•©h
 *,

170 
communôy
 *, 
as_£t
);

171 #ifde‡
USE_SRX


174 
bgp_size_t
 
bgp_∑ckë_©åibuã
 (
bgp
 *bgp, 
≥î
 *,

175 
°ªam
 *, 
©å
 *,

176 
¥efix
 *, 
afi_t
, 
ßfi_t
,

177 
≥î
 *, 
¥efix_rd
 *, 
u_ch¨
 *,

178 
boﬁ
* 
fSëA•©h
);

180 
bgp_size_t
 
bgp_∑ckë_©åibuã
 (
bgp
 *bgp, 
≥î
 *,

181 
°ªam
 *, 
©å
 *,

182 
¥efix
 *, 
afi_t
, 
ßfi_t
,

183 
≥î
 *, 
¥efix_rd
 *, 
u_ch¨
 *);

185 
bgp_size_t
 
bgp_∑ckë_wôhdøw
 (
≥î
 *≥î, 
°ªam
 *
s
,

186 
¥efix
 *
p
, 
afi_t
, 
ßfi_t
,

187 
¥efix_rd
 *, 
u_ch¨
 *);

188 
bgp_dump_rouãs_©å
 (
°ªam
 *, 
©å
 *,

189 
¥efix
 *);

190 
©åhash_cmp
 (const *, const *);

191 
©åhash_key_make
 (*);

192 
©å_show_Æl
 (
vty
 *);

193 
©å_cou¡
 ();

194 
©å_unknown_cou¡
 ();

197 
˛u°î_lo›_check
 (
˛u°î_li°
 *, 
ö_addr
);

198 
˛u°î_unöã∫
 (
˛u°î_li°
 *);

201 
å™sô_unöã∫
 (
å™sô
 *);

204 
	sbgp_©å_∑r£r_¨gs
 {

205 
≥î
 *
	m≥î
;

206 
bgp_size_t
 
	mÀngth
;

207 
bgp_size_t
 
	mtŸÆ
;

208 
©å
 *
	m©å
;

209 
u_öt8_t
 
	mty≥
;

210 
u_öt8_t
 
	mÊags
;

211 
u_ch¨
 *
	m°¨ç
;

213 
bgp_mp_ªach_∑r£
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

214 
bgp_∆ri
 *);

215 
bgp_mp_uƒóch_∑r£
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

216 
bgp_∆ri
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_clist.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"¥efix.h
"

25 
	~"mem‹y.h
"

27 
	~"bgpd/bgpd.h
"

28 
	~"bgpd/bgp_communôy.h
"

29 
	~"bgpd/bgp_ecommunôy.h
"

30 
	~"bgpd/bgp_a•©h.h
"

31 
	~"bgpd/bgp_ªgex.h
"

32 
	~"bgpd/bgp_˛i°.h
"

36 
communôy_li°_ma°î
 *

37 
	$communôy_li°_ma°î_lookup
 (
communôy_li°_h™dÀr
 *
ch
, 
ma°î
)

39 i‡(
ch
)

40 
ma°î
)

42 
COMMUNITY_LIST_MASTER
:

43  &
ch
->
communôy_li°
;

44 
EXTCOMMUNITY_LIST_MASTER
:

45  &
ch
->
extcommunôy_li°
;

47  
NULL
;

48 
	}
}

51 
communôy_íåy
 *

52 
	$communôy_íåy_√w
 ()

54  
	`XCALLOC
 (
MTYPE_COMMUNITY_LIST_ENTRY
,  (
communôy_íåy
));

55 
	}
}

59 
	$communôy_íåy_‰ì
 (
communôy_íåy
 *
íåy
)

61 
íåy
->
°yÀ
)

63 
COMMUNITY_LIST_STANDARD
:

64 i‡(
íåy
->
u
.
com
)

65 
	`communôy_‰ì
 (
íåy
->
u
.
com
);

67 
EXTCOMMUNITY_LIST_STANDARD
:

70 i‡(
íåy
->
c⁄fig
)

71 
	`XFREE
 (
MTYPE_ECOMMUNITY_STR
, 
íåy
->
c⁄fig
);

72 i‡(
íåy
->
u
.
ecom
)

73 
	`ecommunôy_‰ì
 (&
íåy
->
u
.
ecom
);

75 
COMMUNITY_LIST_EXPANDED
:

76 
EXTCOMMUNITY_LIST_EXPANDED
:

77 i‡(
íåy
->
c⁄fig
)

78 
	`XFREE
 (
MTYPE_COMMUNITY_LIST_CONFIG
, 
íåy
->
c⁄fig
);

79 i‡(
íåy
->
ªg
)

80 
	`bgp_ªgex_‰ì
 (
íåy
->
ªg
);

84 
	`XFREE
 (
MTYPE_COMMUNITY_LIST_ENTRY
, 
íåy
);

85 
	}
}

88 
communôy_li°
 *

89 
	$communôy_li°_√w
 ()

91  
	`XCALLOC
 (
MTYPE_COMMUNITY_LIST
,  (
communôy_li°
));

92 
	}
}

96 
	$communôy_li°_‰ì
 (
communôy_li°
 *
li°
)

98 i‡(
li°
->
«me
)

99 
	`XFREE
 (
MTYPE_COMMUNITY_LIST_NAME
, 
li°
->
«me
);

100 
	`XFREE
 (
MTYPE_COMMUNITY_LIST
, 
li°
);

101 
	}
}

103 
communôy_li°
 *

104 
	$communôy_li°_ö£π
 (
communôy_li°_h™dÀr
 *
ch
,

105 c⁄° *
«me
, 
ma°î
)

107 
size_t
 
i
;

108 
numbî
;

109 
communôy_li°
 *
√w
;

110 
communôy_li°
 *
poöt
;

111 
communôy_li°_li°
 *
li°
;

112 
communôy_li°_ma°î
 *
cm
;

115 
cm
 = 
	`communôy_li°_ma°î_lookup
 (
ch
, 
ma°î
);

116 i‡(!
cm
)

117  
NULL
;

120 
√w
 = 
	`communôy_li°_√w
 ();

121 
√w
->
«me
 = 
	`XSTRDUP
 (
MTYPE_COMMUNITY_LIST_NAME
,Çame);

125 
numbî
 = 0, 
i
 = 0; i < 
	`°æí
 (
«me
); i++)

127 i‡(
	`isdigô
 ((Ë
«me
[
i
]))

128 
numbî
 = (numbî * 10Ë+ (
«me
[
i
] - '0');

134 i‡(
i
 =
	`°æí
 (
«me
))

136 
√w
->
s‹t
 = 
COMMUNITY_LIST_NUMBER
;

139 
li°
 = &
cm
->
num
;

141 
poöt
 = 
li°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

142 i‡(
	`©ﬁ
 (
poöt
->
«me
Ë>
numbî
)

147 
√w
->
s‹t
 = 
COMMUNITY_LIST_STRING
;

150 
li°
 = &
cm
->
°r
;

153 
poöt
 = 
li°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

154 i‡(
	`°rcmp
 (
poöt
->
«me
,Çame) >= 0)

159 
√w
->
∑ª¡
 = 
li°
;

162 i‡(
li°
->
hód
 =
NULL
)

164 
li°
->
hód
 =Üi°->
èû
 = 
√w
;

165  
√w
;

169 i‡(
poöt
 =
NULL
)

171 
√w
->
¥ev
 = 
li°
->
èû
;

172 
li°
->
èû
->
√xt
 = 
√w
;

173 
li°
->
èû
 = 
√w
;

174  
√w
;

178 i‡(
poöt
 =
li°
->
hód
)

180 
√w
->
√xt
 = 
li°
->
hód
;

181 
li°
->
hód
->
¥ev
 = 
√w
;

182 
li°
->
hód
 = 
√w
;

183  
√w
;

187 
√w
->
√xt
 = 
poöt
;

188 
√w
->
¥ev
 = 
poöt
->prev;

190 i‡(
poöt
->
¥ev
)

191 
poöt
->
¥ev
->
√xt
 = 
√w
;

192 
poöt
->
¥ev
 = 
√w
;

194  
√w
;

195 
	}
}

197 
communôy_li°
 *

198 
	$communôy_li°_lookup
 (
communôy_li°_h™dÀr
 *
ch
,

199 c⁄° *
«me
, 
ma°î
)

201 
communôy_li°
 *
li°
;

202 
communôy_li°_ma°î
 *
cm
;

204 i‡(!
«me
)

205  
NULL
;

207 
cm
 = 
	`communôy_li°_ma°î_lookup
 (
ch
, 
ma°î
);

208 i‡(!
cm
)

209  
NULL
;

211 
li°
 = 
cm
->
num
.
hód
;Üi°;Üi° =Üi°->
√xt
)

212 i‡(
	`°rcmp
 (
li°
->
«me
,Çame) == 0)

213  
li°
;

214 
li°
 = 
cm
->
°r
.
hód
;Üi°;Üi° =Üi°->
√xt
)

215 i‡(
	`°rcmp
 (
li°
->
«me
,Çame) == 0)

216  
li°
;

218  
NULL
;

219 
	}
}

221 
communôy_li°
 *

222 
	$communôy_li°_gë
 (
communôy_li°_h™dÀr
 *
ch
,

223 c⁄° *
«me
, 
ma°î
)

225 
communôy_li°
 *
li°
;

227 
li°
 = 
	`communôy_li°_lookup
 (
ch
, 
«me
, 
ma°î
);

228 i‡(!
li°
)

229 
li°
 = 
	`communôy_li°_ö£π
 (
ch
, 
«me
, 
ma°î
);

230  
li°
;

231 
	}
}

234 
	$communôy_li°_dñëe
 (
communôy_li°
 *
li°
)

236 
communôy_li°_li°
 *
˛i°
;

237 
communôy_íåy
 *
íåy
, *
√xt
;

239 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry = 
√xt
)

241 
√xt
 = 
íåy
->next;

242 
	`communôy_íåy_‰ì
 (
íåy
);

245 
˛i°
 = 
li°
->
∑ª¡
;

247 i‡(
li°
->
√xt
)

248 
li°
->
√xt
->
¥ev
 =Üist->prev;

250 
˛i°
->
èû
 = 
li°
->
¥ev
;

252 i‡(
li°
->
¥ev
)

253 
li°
->
¥ev
->
√xt
 =Üist->next;

255 
˛i°
->
hód
 = 
li°
->
√xt
;

257 
	`communôy_li°_‰ì
 (
li°
);

258 
	}
}

261 
	$communôy_li°_em±y_p
 (
communôy_li°
 *
li°
)

263  (
li°
->
hód
 =
NULL
 &&Üi°->
èû
 == NULL) ? 1 : 0;

264 
	}
}

268 
	$communôy_li°_íåy_add
 (
communôy_li°
 *
li°
,

269 
communôy_íåy
 *
íåy
)

271 
íåy
->
√xt
 = 
NULL
;

272 
íåy
->
¥ev
 = 
li°
->
èû
;

274 i‡(
li°
->
èû
)

275 
li°
->
èû
->
√xt
 = 
íåy
;

277 
li°
->
hód
 = 
íåy
;

278 
li°
->
èû
 = 
íåy
;

279 
	}
}

283 
	$communôy_li°_íåy_dñëe
 (
communôy_li°
 *
li°
,

284 
communôy_íåy
 *
íåy
, 
°yÀ
)

286 i‡(
íåy
->
√xt
)

287 
íåy
->
√xt
->
¥ev
 =Éntry->prev;

289 
li°
->
èû
 = 
íåy
->
¥ev
;

291 i‡(
íåy
->
¥ev
)

292 
íåy
->
¥ev
->
√xt
 =Éntry->next;

294 
li°
->
hód
 = 
íåy
->
√xt
;

296 
	`communôy_íåy_‰ì
 (
íåy
);

298 i‡(
	`communôy_li°_em±y_p
 (
li°
))

299 
	`communôy_li°_dñëe
 (
li°
);

300 
	}
}

303 
communôy_íåy
 *

304 
	$communôy_li°_íåy_lookup
 (
communôy_li°
 *
li°
, c⁄° *
¨g
,

305 
dúe˘
)

307 
communôy_íåy
 *
íåy
;

309 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

311 
íåy
->
°yÀ
)

313 
COMMUNITY_LIST_STANDARD
:

314 i‡(
	`communôy_cmp
 (
íåy
->
u
.
com
, 
¨g
))

315  
íåy
;

317 
EXTCOMMUNITY_LIST_STANDARD
:

318 i‡(
	`ecommunôy_cmp
 (
íåy
->
u
.
ecom
, 
¨g
))

319  
íåy
;

321 
COMMUNITY_LIST_EXPANDED
:

322 
EXTCOMMUNITY_LIST_EXPANDED
:

323 i‡(
	`°rcmp
 (
íåy
->
c⁄fig
, 
¨g
) == 0)

324  
íåy
;

330  
NULL
;

331 
	}
}

336 
	$communôy_ªgexp_m©ch
 (
communôy
 *
com
, 
ªgex_t
 * 
ªg
)

338 c⁄° *
°r
;

342 i‡(
com
 =
NULL
 || com->
size
 == 0)

343 
°r
 = "";

345 
°r
 = 
	`communôy_°r
 (
com
);

348 i‡(
	`ªgexec
 (
ªg
, 
°r
, 0, 
NULL
, 0) == 0)

353 
	}
}

356 
	$ecommunôy_ªgexp_m©ch
 (
ecommunôy
 *
ecom
, 
ªgex_t
 * 
ªg
)

358 c⁄° *
°r
;

362 i‡(
ecom
 =
NULL
 ||Écom->
size
 == 0)

363 
°r
 = "";

365 
°r
 = 
	`ecommunôy_°r
 (
ecom
);

368 i‡(
	`ªgexec
 (
ªg
, 
°r
, 0, 
NULL
, 0) == 0)

373 
	}
}

377 
communôy
 *

378 
	$communôy_ªgexp_dñëe
 (
communôy
 *
com
, 
ªgex_t
 * 
ªg
)

380 
i
;

381 
u_öt32_t
 
comvÆ
;

383 
c
[12];

384 c⁄° *
°r
;

386 i‡(!
com
)

387  
NULL
;

389 
i
 = 0;

390 
i
 < 
com
->
size
)

392 
	`mem˝y
 (&
comvÆ
, 
	`com_¡hvÆ
 (
com
, 
i
),  (
u_öt32_t
));

393 
comvÆ
 = 
	`¡ohl
 (comval);

395 
comvÆ
)

397 
COMMUNITY_INTERNET
:

398 
°r
 = "internet";

400 
COMMUNITY_NO_EXPORT
:

401 
°r
 = "no-export";

403 
COMMUNITY_NO_ADVERTISE
:

404 
°r
 = "no-advertise";

406 
COMMUNITY_LOCAL_AS
:

407 
°r
 = "local-AS";

410 
	`•rötf
 (
c
, "%d:%d", (
comvÆ
 >> 16) & 0xFFFF, comval & 0xFFFF);

411 
°r
 = 
c
;

415 i‡(
	`ªgexec
 (
ªg
, 
°r
, 0, 
NULL
, 0) == 0)

416 
	`communôy_dñ_vÆ
 (
com
, 
	`com_¡hvÆ
 (com, 
i
));

418 
i
++;

420  
com
;

421 
	}
}

426 
	$communôy_li°_m©ch
 (
communôy
 *
com
, 
communôy_li°
 *
li°
)

428 
communôy_íåy
 *
íåy
;

430 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

432 i‡(
íåy
->
™y
)

433  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

435 i‡(
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD
)

437 i‡(
	`communôy_ö˛ude
 (
íåy
->
u
.
com
, 
COMMUNITY_INTERNET
))

438  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

440 i‡(
	`communôy_m©ch
 (
com
, 
íåy
->
u
.com))

441  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

443 i‡(
íåy
->
°yÀ
 =
COMMUNITY_LIST_EXPANDED
)

445 i‡(
	`communôy_ªgexp_m©ch
 (
com
, 
íåy
->
ªg
))

446  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

450 
	}
}

453 
	$ecommunôy_li°_m©ch
 (
ecommunôy
 *
ecom
, 
communôy_li°
 *
li°
)

455 
communôy_íåy
 *
íåy
;

457 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

459 i‡(
íåy
->
™y
)

460  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

462 i‡(
íåy
->
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD
)

464 i‡(
	`ecommunôy_m©ch
 (
ecom
, 
íåy
->
u
.ecom))

465  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

467 i‡(
íåy
->
°yÀ
 =
EXTCOMMUNITY_LIST_EXPANDED
)

469 i‡(
	`ecommunôy_ªgexp_m©ch
 (
ecom
, 
íåy
->
ªg
))

470  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

474 
	}
}

479 
	$communôy_li°_exa˘_m©ch
 (
communôy
 *
com
,

480 
communôy_li°
 *
li°
)

482 
communôy_íåy
 *
íåy
;

484 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

486 i‡(
íåy
->
™y
)

487  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

489 i‡(
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD
)

491 i‡(
	`communôy_ö˛ude
 (
íåy
->
u
.
com
, 
COMMUNITY_INTERNET
))

492  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

494 i‡(
	`communôy_cmp
 (
com
, 
íåy
->
u
.com))

495  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

497 i‡(
íåy
->
°yÀ
 =
COMMUNITY_LIST_EXPANDED
)

499 i‡(
	`communôy_ªgexp_m©ch
 (
com
, 
íåy
->
ªg
))

500  
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
 ? 1 : 0;

504 
	}
}

507 
communôy
 *

508 
	$communôy_li°_m©ch_dñëe
 (
communôy
 *
com
,

509 
communôy_li°
 *
li°
)

511 
communôy_íåy
 *
íåy
;

513 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

515 i‡(
íåy
->
™y
)

517 i‡(
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
)

524 
com
->
size
 = 0;

526  
com
;

529 i‡((
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD
)

530 && (
	`communôy_ö˛ude
 (
íåy
->
u
.
com
, 
COMMUNITY_INTERNET
)

531 || 
	`communôy_m©ch
 (
com
, 
íåy
->
u
.com) ))

533 i‡(
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
)

534 
	`communôy_dñëe
 (
com
, 
íåy
->
u
.com);

538 i‡((
íåy
->
°yÀ
 =
COMMUNITY_LIST_EXPANDED
)

539 && 
	`communôy_ªgexp_m©ch
 (
com
, 
íåy
->
ªg
))

541 i‡(
íåy
->
dúe˘
 =
COMMUNITY_PERMIT
)

542 
	`communôy_ªgexp_dñëe
 (
com
, 
íåy
->
ªg
);

547  
com
;

548 
	}
}

553 
	$communôy_li°_dup_check
 (
communôy_li°
 *
li°
,

554 
communôy_íåy
 *
√w
)

556 
communôy_íåy
 *
íåy
;

558 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

560 i‡(
íåy
->
°yÀ
 !
√w
->style)

563 i‡(
íåy
->
dúe˘
 !
√w
->direct)

566 i‡(
íåy
->
™y
 !
√w
->any)

569 i‡(
íåy
->
™y
)

572 
íåy
->
°yÀ
)

574 
COMMUNITY_LIST_STANDARD
:

575 i‡(
	`communôy_cmp
 (
íåy
->
u
.
com
, 
√w
->u.com))

578 
EXTCOMMUNITY_LIST_STANDARD
:

579 i‡(
	`ecommunôy_cmp
 (
íåy
->
u
.
ecom
, 
√w
->u.ecom))

582 
COMMUNITY_LIST_EXPANDED
:

583 
EXTCOMMUNITY_LIST_EXPANDED
:

584 i‡(
	`°rcmp
 (
íåy
->
c⁄fig
, 
√w
->config) == 0)

592 
	}
}

596 
	$communôy_li°_£t
 (
communôy_li°_h™dÀr
 *
ch
,

597 c⁄° *
«me
, c⁄° *
°r
, 
dúe˘
, 
°yÀ
)

599 
communôy_íåy
 *
íåy
 = 
NULL
;

600 
communôy_li°
 *
li°
;

601 
communôy
 *
com
 = 
NULL
;

602 
ªgex_t
 *
ªgex
 = 
NULL
;

605 
li°
 = 
	`communôy_li°_gë
 (
ch
, 
«me
, 
COMMUNITY_LIST_MASTER
);

610 i‡(!
	`communôy_li°_em±y_p
 (
li°
))

612 
communôy_íåy
 *
fú°
;

614 
fú°
 = 
li°
->
hód
;

616 i‡(
°yÀ
 !
fú°
->style)

618  (
fú°
->
°yÀ
 =
COMMUNITY_LIST_STANDARD


619 ? 
COMMUNITY_LIST_ERR_STANDARD_CONFLICT


620 : 
COMMUNITY_LIST_ERR_EXPANDED_CONFLICT
);

624 i‡(
°r
)

626 i‡(
°yÀ
 =
COMMUNITY_LIST_STANDARD
)

627 
com
 = 
	`communôy_°r2com
 (
°r
);

629 
ªgex
 = 
	`bgp_ªgcomp
 (
°r
);

631 i‡(! 
com
 && ! 
ªgex
)

632  
COMMUNITY_LIST_ERR_MALFORMED_VAL
;

635 
íåy
 = 
	`communôy_íåy_√w
 ();

636 
íåy
->
dúe˘
 = direct;

637 
íåy
->
°yÀ
 = style;

638 
íåy
->
™y
 = (
°r
 ? 0 : 1);

639 
íåy
->
u
.
com
 = com;

640 
íåy
->
ªg
 = 
ªgex
;

641 
íåy
->
c⁄fig
 = (
ªgex
 ? 
	`XSTRDUP
 (
MTYPE_COMMUNITY_LIST_CONFIG
, 
°r
Ë: 
NULL
);

644 i‡(
	`communôy_li°_dup_check
 (
li°
, 
íåy
))

645 
	`communôy_íåy_‰ì
 (
íåy
);

647 
	`communôy_li°_íåy_add
 (
li°
, 
íåy
);

650 
	}
}

655 
	$communôy_li°_un£t
 (
communôy_li°_h™dÀr
 *
ch
,

656 c⁄° *
«me
, c⁄° *
°r
,

657 
dúe˘
, 
°yÀ
)

659 
communôy_íåy
 *
íåy
 = 
NULL
;

660 
communôy_li°
 *
li°
;

661 
communôy
 *
com
 = 
NULL
;

662 
ªgex_t
 *
ªgex
 = 
NULL
;

665 
li°
 = 
	`communôy_li°_lookup
 (
ch
, 
«me
, 
COMMUNITY_LIST_MASTER
);

666 i‡(
li°
 =
NULL
)

667  
COMMUNITY_LIST_ERR_CANT_FIND_LIST
;

670 i‡(!
°r
)

672 
	`communôy_li°_dñëe
 (
li°
);

676 i‡(
°yÀ
 =
COMMUNITY_LIST_STANDARD
)

677 
com
 = 
	`communôy_°r2com
 (
°r
);

679 
ªgex
 = 
	`bgp_ªgcomp
 (
°r
);

681 i‡(! 
com
 && ! 
ªgex
)

682  
COMMUNITY_LIST_ERR_MALFORMED_VAL
;

684 i‡(
com
)

685 
íåy
 = 
	`communôy_li°_íåy_lookup
 (
li°
, 
com
, 
dúe˘
);

687 
íåy
 = 
	`communôy_li°_íåy_lookup
 (
li°
, 
°r
, 
dúe˘
);

689 i‡(
com
)

690 
	`communôy_‰ì
 (
com
);

691 i‡(
ªgex
)

692 
	`bgp_ªgex_‰ì
 (
ªgex
);

694 i‡(!
íåy
)

695  
COMMUNITY_LIST_ERR_CANT_FIND_LIST
;

697 
	`communôy_li°_íåy_dñëe
 (
li°
, 
íåy
, 
°yÀ
);

700 
	}
}

704 
	$extcommunôy_li°_£t
 (
communôy_li°_h™dÀr
 *
ch
,

705 c⁄° *
«me
, c⁄° *
°r
,

706 
dúe˘
, 
°yÀ
)

708 
communôy_íåy
 *
íåy
 = 
NULL
;

709 
communôy_li°
 *
li°
;

710 
ecommunôy
 *
ecom
 = 
NULL
;

711 
ªgex_t
 *
ªgex
 = 
NULL
;

713 
íåy
 = 
NULL
;

716 
li°
 = 
	`communôy_li°_gë
 (
ch
, 
«me
, 
EXTCOMMUNITY_LIST_MASTER
);

721 i‡(!
	`communôy_li°_em±y_p
 (
li°
))

723 
communôy_íåy
 *
fú°
;

725 
fú°
 = 
li°
->
hód
;

727 i‡(
°yÀ
 !
fú°
->style)

729  (
fú°
->
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD


730 ? 
COMMUNITY_LIST_ERR_STANDARD_CONFLICT


731 : 
COMMUNITY_LIST_ERR_EXPANDED_CONFLICT
);

735 i‡(
°r
)

737 i‡(
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD
)

738 
ecom
 = 
	`ecommunôy_°r2com
 (
°r
, 0, 1);

740 
ªgex
 = 
	`bgp_ªgcomp
 (
°r
);

742 i‡(! 
ecom
 && ! 
ªgex
)

743  
COMMUNITY_LIST_ERR_MALFORMED_VAL
;

746 i‡(
ecom
)

747 
ecom
->
°r
 = 
	`ecommunôy_ecom2°r
 (ecom, 
ECOMMUNITY_FORMAT_DISPLAY
);

749 
íåy
 = 
	`communôy_íåy_√w
 ();

750 
íåy
->
dúe˘
 = direct;

751 
íåy
->
°yÀ
 = style;

752 
íåy
->
™y
 = (
°r
 ? 0 : 1);

753 i‡(
ecom
)

754 
íåy
->
c⁄fig
 = 
	`ecommunôy_ecom2°r
 (
ecom
, 
ECOMMUNITY_FORMAT_COMMUNITY_LIST
);

755 i‡(
ªgex
)

756 
íåy
->
c⁄fig
 = 
	`XSTRDUP
 (
MTYPE_COMMUNITY_LIST_CONFIG
, 
°r
);

758 
íåy
->
c⁄fig
 = 
NULL
;

759 
íåy
->
u
.
ecom
 =Écom;

760 
íåy
->
ªg
 = 
ªgex
;

763 i‡(
	`communôy_li°_dup_check
 (
li°
, 
íåy
))

764 
	`communôy_íåy_‰ì
 (
íåy
);

766 
	`communôy_li°_íåy_add
 (
li°
, 
íåy
);

769 
	}
}

774 
	$extcommunôy_li°_un£t
 (
communôy_li°_h™dÀr
 *
ch
,

775 c⁄° *
«me
, c⁄° *
°r
,

776 
dúe˘
, 
°yÀ
)

778 
communôy_íåy
 *
íåy
 = 
NULL
;

779 
communôy_li°
 *
li°
;

780 
ecommunôy
 *
ecom
 = 
NULL
;

781 
ªgex_t
 *
ªgex
 = 
NULL
;

784 
li°
 = 
	`communôy_li°_lookup
 (
ch
, 
«me
, 
EXTCOMMUNITY_LIST_MASTER
);

785 i‡(
li°
 =
NULL
)

786  
COMMUNITY_LIST_ERR_CANT_FIND_LIST
;

789 i‡(!
°r
)

791 
	`communôy_li°_dñëe
 (
li°
);

795 i‡(
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD
)

796 
ecom
 = 
	`ecommunôy_°r2com
 (
°r
, 0, 1);

798 
ªgex
 = 
	`bgp_ªgcomp
 (
°r
);

800 i‡(! 
ecom
 && ! 
ªgex
)

801  
COMMUNITY_LIST_ERR_MALFORMED_VAL
;

803 i‡(
ecom
)

804 
íåy
 = 
	`communôy_li°_íåy_lookup
 (
li°
, 
ecom
, 
dúe˘
);

806 
íåy
 = 
	`communôy_li°_íåy_lookup
 (
li°
, 
°r
, 
dúe˘
);

808 i‡(
ecom
)

809 
	`ecommunôy_‰ì
 (&
ecom
);

810 i‡(
ªgex
)

811 
	`bgp_ªgex_‰ì
 (
ªgex
);

813 i‡(!
íåy
)

814  
COMMUNITY_LIST_ERR_CANT_FIND_LIST
;

816 
	`communôy_li°_íåy_dñëe
 (
li°
, 
íåy
, 
°yÀ
);

819 
	}
}

822 
communôy_li°_h™dÀr
 *

823 
	$communôy_li°_öô
 ()

825 
communôy_li°_h™dÀr
 *
ch
;

826 
ch
 = 
	`XCALLOC
 (
MTYPE_COMMUNITY_LIST_HANDLER
,

827  (
communôy_li°_h™dÀr
));

828  
ch
;

829 
	}
}

833 
	$communôy_li°_ãrmö©e
 (
communôy_li°_h™dÀr
 *
ch
)

835 
communôy_li°_ma°î
 *
cm
;

836 
communôy_li°
 *
li°
;

838 
cm
 = &
ch
->
communôy_li°
;

839 (
li°
 = 
cm
->
num
.
hód
Ë!
NULL
)

840 
	`communôy_li°_dñëe
 (
li°
);

841 (
li°
 = 
cm
->
°r
.
hód
Ë!
NULL
)

842 
	`communôy_li°_dñëe
 (
li°
);

844 
cm
 = &
ch
->
extcommunôy_li°
;

845 (
li°
 = 
cm
->
num
.
hód
Ë!
NULL
)

846 
	`communôy_li°_dñëe
 (
li°
);

847 (
li°
 = 
cm
->
°r
.
hód
Ë!
NULL
)

848 
	`communôy_li°_dñëe
 (
li°
);

850 
	`XFREE
 (
MTYPE_COMMUNITY_LIST_HANDLER
, 
ch
);

851 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_clist.h

21 #i‚de‡
_QUAGGA_BGP_CLIST_H


22 
	#_QUAGGA_BGP_CLIST_H


	)

25 
	#COMMUNITY_LIST_MASTER
 0

	)

26 
	#EXTCOMMUNITY_LIST_MASTER
 1

	)

29 
	#COMMUNITY_DENY
 0

	)

30 
	#COMMUNITY_PERMIT
 1

	)

33 
	#COMMUNITY_LIST_STRING
 0

	)

34 
	#COMMUNITY_LIST_NUMBER
 1

	)

37 
	#COMMUNITY_LIST_STANDARD
 0

	)

38 
	#COMMUNITY_LIST_EXPANDED
 1

	)

39 
	#EXTCOMMUNITY_LIST_STANDARD
 2

	)

40 
	#EXTCOMMUNITY_LIST_EXPANDED
 3

	)

43 
	scommunôy_li°


46 *
	m«me
;

49 
	ms‹t
;

52 
communôy_li°_li°
 *
	m∑ª¡
;

55 
communôy_li°
 *
	m√xt
;

56 
communôy_li°
 *
	m¥ev
;

59 
communôy_íåy
 *
	mhód
;

60 
communôy_íåy
 *
	mèû
;

64 
	scommunôy_íåy


66 
communôy_íåy
 *
	m√xt
;

67 
communôy_íåy
 *
	m¥ev
;

70 
u_ch¨
 
	mdúe˘
;

73 
u_ch¨
 
	m°yÀ
;

76 
u_ch¨
 
	m™y
;

81 
communôy
 *
	mcom
;

82 
ecommunôy
 *
	mecom
;

83 } 
	mu
;

86 *
	mc⁄fig
;

89 
ªgex_t
 *
	mªg
;

93 
	scommunôy_li°_li°


95 
communôy_li°
 *
	mhód
;

96 
communôy_li°
 *
	mèû
;

100 
	scommunôy_li°_ma°î


102 
communôy_li°_li°
 
	mnum
;

103 
communôy_li°_li°
 
	m°r
;

108 
	scommunôy_li°_h™dÀr


111 
communôy_li°_ma°î
 
	mcommunôy_li°
;

114 
communôy_li°_ma°î
 
	mextcommunôy_li°
;

118 
	#COMMUNITY_LIST_ERR_CANT_FIND_LIST
 -1

	)

119 
	#COMMUNITY_LIST_ERR_MALFORMED_VAL
 -2

	)

120 
	#COMMUNITY_LIST_ERR_STANDARD_CONFLICT
 -3

	)

121 
	#COMMUNITY_LIST_ERR_EXPANDED_CONFLICT
 -4

	)

124 
communôy_li°_h™dÀr
 *
bgp_˛i°
;

127 
communôy_li°_h™dÀr
 *
communôy_li°_öô
 ();

128 
communôy_li°_ãrmö©e
 (
communôy_li°_h™dÀr
 *);

130 
communôy_li°_£t
 (
communôy_li°_h™dÀr
 *
ch
,

131 c⁄° *
«me
, c⁄° *
°r
, 
dúe˘
,

132 
°yÀ
);

133 
communôy_li°_un£t
 (
communôy_li°_h™dÀr
 *
ch
,

134 c⁄° *
«me
, c⁄° *
°r
,

135 
dúe˘
, 
°yÀ
);

136 
extcommunôy_li°_£t
 (
communôy_li°_h™dÀr
 *
ch
,

137 c⁄° *
«me
, c⁄° *
°r
,

138 
dúe˘
, 
°yÀ
);

139 
extcommunôy_li°_un£t
 (
communôy_li°_h™dÀr
 *
ch
,

140 c⁄° *
«me
, c⁄° *
°r
,

141 
dúe˘
, 
°yÀ
);

143 
communôy_li°_ma°î
 *

144 
communôy_li°_ma°î_lookup
 (
communôy_li°_h™dÀr
 *, );

146 
communôy_li°
 *

147 
communôy_li°_lookup
 (
communôy_li°_h™dÀr
 *, const *, );

149 
communôy_li°_m©ch
 (
communôy
 *, 
communôy_li°
 *);

150 
ecommunôy_li°_m©ch
 (
ecommunôy
 *, 
communôy_li°
 *);

151 
communôy_li°_exa˘_m©ch
 (
communôy
 *,

152 
communôy_li°
 *);

153 
communôy
 *

154 
communôy_li°_m©ch_dñëe
 (
communôy
 *, 
communôy_li°
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_community.c

21 
	~<zebø.h
>

23 
	~"hash.h
"

24 
	~"mem‹y.h
"

26 
	~"bgpd/bgp_communôy.h
"

29 
hash
 *
	gcomhash
;

32 
communôy
 *

33 
	$communôy_√w
 ()

35  (
communôy
 *Ë
	`XCALLOC
 (
MTYPE_COMMUNITY
,

36  (
communôy
));

37 
	}
}

41 
	$communôy_‰ì
 (
communôy
 *
com
)

43 i‡(
com
->
vÆ
)

44 
	`XFREE
 (
MTYPE_COMMUNITY_VAL
, 
com
->
vÆ
);

45 i‡(
com
->
°r
)

46 
	`XFREE
 (
MTYPE_COMMUNITY_STR
, 
com
->
°r
);

47 
	`XFREE
 (
MTYPE_COMMUNITY
, 
com
);

48 
	}
}

52 
	$communôy_add_vÆ
 (
communôy
 *
com
, 
u_öt32_t
 
vÆ
)

54 
com
->
size
++;

55 i‡(
com
->
vÆ
)

56 
com
->
vÆ
 = 
	`XREALLOC
 (
MTYPE_COMMUNITY_VAL
, com->vÆ, 
	`com_Àngth
 (com));

58 
com
->
vÆ
 = 
	`XMALLOC
 (
MTYPE_COMMUNITY_VAL
, 
	`com_Àngth
 (com));

60 
vÆ
 = 
	`ht⁄l
 (val);

61 
	`mem˝y
 (
	`com_œ°vÆ
 (
com
), &
vÆ
,  (
u_öt32_t
));

62 
	}
}

66 
	$communôy_dñ_vÆ
 (
communôy
 *
com
, 
u_öt32_t
 *
vÆ
)

68 
i
 = 0;

69 
c
 = 0;

71 i‡(! 
com
->
vÆ
)

74 
i
 < 
com
->
size
)

76 i‡(
	`memcmp
 (
com
->
vÆ
 + 
i
, vÆ,  (
u_öt32_t
)) == 0)

78 
c
 = 
com
->
size
 -
i
 -1;

80 i‡(
c
 > 0)

81 
	`mem˝y
 (
com
->
vÆ
 + 
i
, com->vÆ + (ò+ 1), 
c
 *  (*val));

83 
com
->
size
--;

85 i‡(
com
->
size
 > 0)

86 
com
->
vÆ
 = 
	`XREALLOC
 (
MTYPE_COMMUNITY_VAL
, com->val,

87 
	`com_Àngth
 (
com
));

90 
	`XFREE
 (
MTYPE_COMMUNITY_VAL
, 
com
->
vÆ
);

91 
com
->
vÆ
 = 
NULL
;

95 
i
++;

97 
	}
}

100 
communôy
 *

101 
	$communôy_dñëe
 (
communôy
 *
com1
, communôy *
com2
)

103 
i
 = 0;

105 
i
 < 
com2
->
size
)

107 
	`communôy_dñ_vÆ
 (
com1
, 
com2
->
vÆ
 + 
i
);

108 
i
++;

111  
com1
;

112 
	}
}

116 
	$communôy_com∑ª
 (c⁄° *
a1
, c⁄° *
a2
)

118 
u_öt32_t
 
v1
;

119 
u_öt32_t
 
v2
;

121 
	`mem˝y
 (&
v1
, 
a1
,  (
u_öt32_t
));

122 
	`mem˝y
 (&
v2
, 
a2
,  (
u_öt32_t
));

123 
v1
 = 
	`¡ohl
 (v1);

124 
v2
 = 
	`¡ohl
 (v2);

126 i‡(
v1
 < 
v2
)

128 i‡(
v1
 > 
v2
)

131 
	}
}

134 
	$communôy_ö˛ude
 (
communôy
 *
com
, 
u_öt32_t
 
vÆ
)

136 
i
;

138 
vÆ
 = 
	`ht⁄l
 (val);

140 
i
 = 0; i < 
com
->
size
; i++)

141 i‡(
	`memcmp
 (&
vÆ
, 
	`com_¡hvÆ
 (
com
, 
i
),  (
u_öt32_t
)) == 0)

145 
	}
}

147 
u_öt32_t


148 
	$communôy_vÆ_gë
 (
communôy
 *
com
, 
i
)

150 
u_ch¨
 *
p
;

151 
u_öt32_t
 
vÆ
;

153 
p
 = (
u_ch¨
 *Ë
com
->
vÆ
;

154 
p
 +(
i
 * 4);

156 
	`mem˝y
 (&
vÆ
, 
p
,  (
u_öt32_t
));

158  
	`¡ohl
 (
vÆ
);

159 
	}
}

162 
communôy
 *

163 
	$communôy_uniq_s‹t
 (
communôy
 *
com
)

165 
i
;

166 
communôy
 *
√w
;

167 
u_öt32_t
 
vÆ
;

169 i‡(! 
com
)

170  
NULL
;

172 
√w
 = 
	`communôy_√w
 ();;

174 
i
 = 0; i < 
com
->
size
; i++)

176 
vÆ
 = 
	`communôy_vÆ_gë
 (
com
, 
i
);

178 i‡(! 
	`communôy_ö˛ude
 (
√w
, 
vÆ
))

179 
	`communôy_add_vÆ
 (
√w
, 
vÆ
);

182 
	`qs‹t
 (
√w
->
vÆ
,Çew->
size
,  (
u_öt32_t
), 
communôy_com∑ª
);

184  
√w
;

185 
	}
}

198 
	$communôy_com2°r
 (
communôy
 *
com
)

200 
i
;

201 *
°r
;

202 *
≤t
;

203 
Àn
;

204 
fú°
;

205 
u_öt32_t
 
comvÆ
;

206 
u_öt16_t
 
as
;

207 
u_öt16_t
 
vÆ
;

209 i‡(!
com
)

210  
NULL
;

213 i‡(
com
->
size
 == 0)

215 
°r
 = 
	`XMALLOC
 (
MTYPE_COMMUNITY_STR
, 1);

216 
°r
[0] = '\0';

217  
°r
;

222 
Àn
 = 0;

224 
i
 = 0; i < 
com
->
size
; i++)

226 
	`mem˝y
 (&
comvÆ
, 
	`com_¡hvÆ
 (
com
, 
i
),  (
u_öt32_t
));

227 
comvÆ
 = 
	`¡ohl
 (comval);

229 
comvÆ
)

231 
COMMUNITY_INTERNET
:

232 
Àn
 +
	`°æí
 (" internet");

234 
COMMUNITY_NO_EXPORT
:

235 
Àn
 +
	`°æí
 ("Ço-export");

237 
COMMUNITY_NO_ADVERTISE
:

238 
Àn
 +
	`°æí
 ("Ço-advertise");

240 
COMMUNITY_LOCAL_AS
:

241 
Àn
 +
	`°æí
 ("Üocal-AS");

244 
Àn
 +
	`°æí
 (" 65536:65535");

250 
°r
 = 
≤t
 = 
	`XMALLOC
 (
MTYPE_COMMUNITY_STR
, 
Àn
);

251 
fú°
 = 1;

254 
i
 = 0; i < 
com
->
size
; i++)

256 
	`mem˝y
 (&
comvÆ
, 
	`com_¡hvÆ
 (
com
, 
i
),  (
u_öt32_t
));

257 
comvÆ
 = 
	`¡ohl
 (comval);

259 i‡(
fú°
)

260 
fú°
 = 0;

262 *
≤t
++ = ' ';

264 
comvÆ
)

266 
COMMUNITY_INTERNET
:

267 
	`°r˝y
 (
≤t
, "internet");

268 
≤t
 +
	`°æí
 ("internet");

270 
COMMUNITY_NO_EXPORT
:

271 
	`°r˝y
 (
≤t
, "no-export");

272 
≤t
 +
	`°æí
 ("no-export");

274 
COMMUNITY_NO_ADVERTISE
:

275 
	`°r˝y
 (
≤t
, "no-advertise");

276 
≤t
 +
	`°æí
 ("no-advertise");

278 
COMMUNITY_LOCAL_AS
:

279 
	`°r˝y
 (
≤t
, "local-AS");

280 
≤t
 +
	`°æí
 ("local-AS");

283 
as
 = (
comvÆ
 >> 16) & 0xFFFF;

284 
vÆ
 = 
comvÆ
 & 0xFFFF;

285 
	`•rötf
 (
≤t
, "%u:%d", 
as
, 
vÆ
);

286 
≤t
 +
	`°æí
 (pnt);

290 *
≤t
 = '\0';

292  
°r
;

293 
	}
}

296 
communôy
 *

297 
	$communôy_öã∫
 (
communôy
 *
com
)

299 
communôy
 *
föd
;

302 
	`as£π
 (
com
->
ªf˙t
 == 0);

305 
föd
 = (
communôy
 *Ë
	`hash_gë
 (
comhash
, 
com
, 
hash_Æloc_öã∫
);

309 i‡(
föd
 !
com
)

310 
	`communôy_‰ì
 (
com
);

313 
föd
->
ªf˙t
++;

316 i‡(! 
föd
->
°r
)

317 
föd
->
°r
 = 
	`communôy_com2°r
 (find);

319  
föd
;

320 
	}
}

324 
	$communôy_unöã∫
 (
communôy
 **
com
)

326 
communôy
 *
ªt
;

328 i‡((*
com
)->
ªf˙t
)

329 (*
com
)->
ªf˙t
--;

332 i‡((*
com
)->
ªf˙t
 == 0)

335 
ªt
 = (
communôy
 *Ë
	`hash_ªÀa£
 (
comhash
, *
com
);

336 
	`as£π
 (
ªt
 !
NULL
);

338 
	`communôy_‰ì
 (*
com
);

339 *
com
 = 
NULL
;

341 
	}
}

344 
communôy
 *

345 
	$communôy_∑r£
 (
u_öt32_t
 *
≤t
, 
u_sh‹t
 
Àngth
)

347 
communôy
 
tmp
;

348 
communôy
 *
√w
;

351 i‡(
Àngth
 % 4)

352  
NULL
;

355 
tmp
.
size
 = 
Àngth
 / 4;

356 
tmp
.
vÆ
 = 
≤t
;

358 
√w
 = 
	`communôy_uniq_s‹t
 (&
tmp
);

360  
	`communôy_öã∫
 (
√w
);

361 
	}
}

363 
communôy
 *

364 
	$communôy_dup
 (
communôy
 *
com
)

366 
communôy
 *
√w
;

368 
√w
 = 
	`XCALLOC
 (
MTYPE_COMMUNITY
,  (
communôy
));

369 
√w
->
size
 = 
com
->size;

370 i‡(
√w
->
size
)

372 
√w
->
vÆ
 = 
	`XMALLOC
 (
MTYPE_COMMUNITY_VAL
, 
com
->
size
 * 4);

373 
	`mem˝y
 (
√w
->
vÆ
, 
com
->vÆ, com->
size
 * 4);

376 
√w
->
vÆ
 = 
NULL
;

377  
√w
;

378 
	}
}

382 
	$communôy_°r
 (
communôy
 *
com
)

384 i‡(!
com
)

385  
NULL
;

387 i‡(! 
com
->
°r
)

388 
com
->
°r
 = 
	`communôy_com2°r
 (com);

389  
com
->
°r
;

390 
	}
}

395 
	$communôy_hash_make
 (
communôy
 *
com
)

397 *
≤t
 = (*)
com
->
vÆ
;

398 
size
 = 
com
->size * 4;

399 
key
 = 0;

400 
c
;

402 
c
 = 0; c < 
size
; c += 4)

404 
key
 +
≤t
[
c
];

405 
key
 +
≤t
[
c
 + 1];

406 
key
 +
≤t
[
c
 + 2];

407 
key
 +
≤t
[
c
 + 3];

410  
key
;

411 
	}
}

414 
	$communôy_m©ch
 (c⁄° 
communôy
 *
com1
, c⁄° communôy *
com2
)

416 
i
 = 0;

417 
j
 = 0;

419 i‡(
com1
 =
NULL
 && 
com2
 == NULL)

422 i‡(
com1
 =
NULL
 || 
com2
 == NULL)

425 i‡(
com1
->
size
 < 
com2
->size)

429 
i
 < 
com1
->
size
 && 
j
 < 
com2
->size)

431 i‡(
	`memcmp
 (
com1
->
vÆ
 + 
i
, 
com2
->vÆ + 
j
,  (
u_öt32_t
)) == 0)

432 
j
++;

433 
i
++;

436 i‡(
j
 =
com2
->
size
)

440 
	}
}

445 
	$communôy_cmp
 (c⁄° 
communôy
 *
com1
, c⁄° communôy *
com2
)

447 i‡(
com1
 =
NULL
 && 
com2
 == NULL)

449 i‡(
com1
 =
NULL
 || 
com2
 == NULL)

452 i‡(
com1
->
size
 =
com2
->size)

453 i‡(
	`memcmp
 (
com1
->
vÆ
, 
com2
->vÆ, com1->
size
 * 4) == 0)

456 
	}
}

459 
communôy
 *

460 
	$communôy_mîge
 (
communôy
 *
com1
, communôy *
com2
)

462 i‡(
com1
->
vÆ
)

463 
com1
->
vÆ
 = 
	`XREALLOC
 (
MTYPE_COMMUNITY_VAL
, com1->val,

464 (
com1
->
size
 + 
com2
->size) * 4);

466 
com1
->
vÆ
 = 
	`XMALLOC
 (
MTYPE_COMMUNITY_VAL
, (com1->
size
 + 
com2
->size) * 4);

468 
	`mem˝y
 (
com1
->
vÆ
 + com1->
size
, 
com2
->val, com2->size * 4);

469 
com1
->
size
 +
com2
->size;

471  
com1
;

472 
	}
}

475 
	ecommunôy_tokí


477 
	mcommunôy_tokí_vÆ
,

478 
	mcommunôy_tokí_no_exp‹t
,

479 
	mcommunôy_tokí_no_advîti£
,

480 
	mcommunôy_tokí_loˇl_as
,

481 
	mcommunôy_tokí_unknown


486 
	$communôy_gëtokí
 (c⁄° *
buf
, 
communôy_tokí
 *
tokí
,

487 
u_öt32_t
 *
vÆ
)

489 c⁄° *
p
 = 
buf
;

492 
	`is•a˚
 ((Ë*
p
))

493 
p
++;

496 i‡(*
p
 == '\0')

497  
NULL
;

500 i‡(
	`ißÕha
 ((Ë*
p
))

502 i‡(
	`°∫cmp
 (
p
, "öã∫ë", 
	`°æí
 ("internet")) == 0)

504 *
vÆ
 = 
COMMUNITY_INTERNET
;

505 *
tokí
 = 
communôy_tokí_no_exp‹t
;

506 
p
 +
	`°æí
 ("internet");

507  
p
;

509 i‡(
	`°∫cmp
 (
p
, "no-exp‹t", 
	`°æí
 ("no-export")) == 0)

511 *
vÆ
 = 
COMMUNITY_NO_EXPORT
;

512 *
tokí
 = 
communôy_tokí_no_exp‹t
;

513 
p
 +
	`°æí
 ("no-export");

514  
p
;

516 i‡(
	`°∫cmp
 (
p
, "no-advîti£", 
	`°æí
 ("no-advertise")) == 0)

518 *
vÆ
 = 
COMMUNITY_NO_ADVERTISE
;

519 *
tokí
 = 
communôy_tokí_no_advîti£
;

520 
p
 +
	`°æí
 ("no-advertise");

521  
p
;

523 i‡(
	`°∫cmp
 (
p
, "loˇl-AS", 
	`°æí
 ("local-AS")) == 0)

525 *
vÆ
 = 
COMMUNITY_LOCAL_AS
;

526 *
tokí
 = 
communôy_tokí_loˇl_as
;

527 
p
 +
	`°æí
 ("local-AS");

528  
p
;

532 *
tokí
 = 
communôy_tokí_unknown
;

533  
NULL
;

537 i‡(
	`isdigô
 ((Ë*
p
))

539 
£∑øt‹
 = 0;

540 
digô
 = 0;

541 
u_öt32_t
 
communôy_low
 = 0;

542 
u_öt32_t
 
communôy_high
 = 0;

544 
	`isdigô
 ((Ë*
p
) || *p == ':')

546 i‡(*
p
 == ':')

548 i‡(
£∑øt‹
)

550 *
tokí
 = 
communôy_tokí_unknown
;

551  
NULL
;

555 
£∑øt‹
 = 1;

556 
digô
 = 0;

557 
communôy_high
 = 
communôy_low
 << 16;

558 
communôy_low
 = 0;

563 
digô
 = 1;

564 
communôy_low
 *= 10;

565 
communôy_low
 +(*
p
 - '0');

567 
p
++;

569 i‡(! 
digô
)

571 *
tokí
 = 
communôy_tokí_unknown
;

572  
NULL
;

574 *
vÆ
 = 
communôy_high
 + 
communôy_low
;

575 *
tokí
 = 
communôy_tokí_vÆ
;

576  
p
;

578 *
tokí
 = 
communôy_tokí_unknown
;

579  
NULL
;

580 
	}
}

583 
communôy
 *

584 
	$communôy_°r2com
 (c⁄° *
°r
)

586 
communôy
 *
com
 = 
NULL
;

587 
communôy
 *
com_s‹t
 = 
NULL
;

588 
u_öt32_t
 
vÆ
 = 0;

589 
communôy_tokí
 
tokí
 = 
communôy_tokí_unknown
;

593 
°r
 = 
	`communôy_gëtokí
 (°r, &
tokí
, &
vÆ
);

595 
tokí
)

597 
communôy_tokí_vÆ
:

598 
communôy_tokí_no_exp‹t
:

599 
communôy_tokí_no_advîti£
:

600 
communôy_tokí_loˇl_as
:

601 i‡(
com
 =
NULL
)

602 
com
 = 
	`communôy_√w
();

603 
	`communôy_add_vÆ
 (
com
, 
vÆ
);

605 
communôy_tokí_unknown
:

607 i‡(
com
)

608 
	`communôy_‰ì
 (
com
);

609  
NULL
;

611 } 
°r
);

613 i‡(! 
com
)

614  
NULL
;

616 
com_s‹t
 = 
	`communôy_uniq_s‹t
 (
com
);

617 
	`communôy_‰ì
 (
com
);

619  
com_s‹t
;

620 
	}
}

624 
	$communôy_cou¡
 ()

626  
comhash
->
cou¡
;

627 
	}
}

630 
hash
 *

631 
	$communôy_hash
 ()

633  
comhash
;

634 
	}
}

638 
	$communôy_öô
 ()

640 
comhash
 = 
	`hash_¸óã
 (((*Ë(*))
communôy_hash_make
,

641 ((*Ë(c⁄° *, c⁄° *))
communôy_cmp
);

642 
	}
}

645 
	$communôy_föish
 ()

647 
	`hash_‰ì
 (
comhash
);

648 
comhash
 = 
NULL
;

649 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_community.h

21 #i‚de‡
_QUAGGA_BGP_COMMUNITY_H


22 
	#_QUAGGA_BGP_COMMUNITY_H


	)

25 
	scommunôy


28 
	mªf˙t
;

31 
	msize
;

34 
u_öt32_t
 *
	mvÆ
;

38 *
	m°r
;

42 
	#COMMUNITY_INTERNET
 0x0

	)

43 
	#COMMUNITY_NO_EXPORT
 0xFFFFFF01

	)

44 
	#COMMUNITY_NO_ADVERTISE
 0xFFFFFF02

	)

45 
	#COMMUNITY_NO_EXPORT_SUBCONFED
 0xFFFFFF03

	)

46 
	#COMMUNITY_LOCAL_AS
 0xFFFFFF03

	)

49 
	#com_Àngth
(
X
Ë((X)->
size
 * 4)

	)

50 
	#com_œ°vÆ
(
X
Ë((X)->
vÆ
 + (X)->
size
 - 1)

	)

51 
	#com_¡hvÆ
(
X
,
n
Ë((X)->
vÆ
 + (n))

	)

54 
communôy_öô
 ();

55 
communôy_föish
 ();

56 
communôy_‰ì
 (
communôy
 *);

57 
communôy
 *
communôy_uniq_s‹t
 (community *);

58 
communôy
 *
communôy_∑r£
 (
u_öt32_t
 *, 
u_sh‹t
);

59 
communôy
 *
communôy_öã∫
 (community *);

60 
communôy_unöã∫
 (
communôy
 **);

61 *
communôy_°r
 (
communôy
 *);

62 
communôy_hash_make
 (
communôy
 *);

63 
communôy
 *
communôy_°r2com
 (const *);

64 
communôy_m©ch
 (c⁄° 
communôy
 *, const community *);

65 
communôy_cmp
 (c⁄° 
communôy
 *, const community *);

66 
communôy
 *
communôy_mîge
 (community *, community *);

67 
communôy
 *
communôy_dñëe
 (community *, community *);

68 
communôy
 *
communôy_dup
 (community *);

69 
communôy_ö˛ude
 (
communôy
 *, 
u_öt32_t
);

70 
communôy_dñ_vÆ
 (
communôy
 *, 
u_öt32_t
 *);

71 
communôy_cou¡
 ();

72 
hash
 *
communôy_hash
 ();

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_damp.c

21 
	~<zebø.h
>

22 
	~<m©h.h
>

24 
	~"¥efix.h
"

25 
	~"mem‹y.h
"

26 
	~"comm™d.h
"

27 
	~"log.h
"

28 
	~"thªad.h
"

30 
	~"bgpd/bgpd.h
"

31 
	~"bgpd/bgp_damp.h
"

32 
	~"bgpd/bgp_èbÀ.h
"

33 
	~"bgpd/bgp_rouã.h
"

34 
	~"bgpd/bgp_©å.h
"

35 
	~"bgpd/bgp_advîti£.h
"

38 
bgp_damp_c⁄fig
 
	gbgp_damp_cfg
;

39 
bgp_damp_c⁄fig
 *
	gdamp
 = &
bgp_damp_cfg
;

43 
	#BGP_DAMP_LIST_ADD
(
N
,
A
Ë
	`BGP_INFO_ADD
(N,A,
no_ªu£_li°
)

	)

44 
	#BGP_DAMP_LIST_DEL
(
N
,
A
Ë
	`BGP_INFO_DEL
(N,A,
no_ªu£_li°
)

	)

48 
	$bgp_ªu£_ödex
 (
≥«…y
)

50 
i
;

51 
ödex
;

53 
i
 = ()(((Ë
≥«…y
 / 
damp
->
ªu£_limô
 - 1.0Ë* damp->
sˇÀ_Á˘‹
);

55 i‡–
i
 >
damp
->
ªu£_ödex_size
 )

56 
i
 = 
damp
->
ªu£_ödex_size
 - 1;

58 
ödex
 = 
damp
->
ªu£_ödex
[
i
] - damp->reuse_index[0];

60  (
damp
->
ªu£_off£t
 + 
ödex
Ë% damp->
ªu£_li°_size
;

61 
	}
}

65 
	$bgp_ªu£_li°_add
 (
bgp_damp_öfo
 *
bdi
)

67 
ödex
;

69 
ödex
 = 
bdi
->ödex = 
	`bgp_ªu£_ödex
 (bdi->
≥«…y
);

71 
bdi
->
¥ev
 = 
NULL
;

72 
bdi
->
√xt
 = 
damp
->
ªu£_li°
[
ödex
];

73 i‡(
damp
->
ªu£_li°
[
ödex
])

74 
damp
->
ªu£_li°
[
ödex
]->
¥ev
 = 
bdi
;

75 
damp
->
ªu£_li°
[
ödex
] = 
bdi
;

76 
	}
}

80 
	$bgp_ªu£_li°_dñëe
 (
bgp_damp_öfo
 *
bdi
)

82 i‡(
bdi
->
√xt
)

83 
bdi
->
√xt
->
¥ev
 = bdi->prev;

84 i‡(
bdi
->
¥ev
)

85 
bdi
->
¥ev
->
√xt
 = bdi->next;

87 
damp
->
ªu£_li°
[
bdi
->
ödex
] = bdi->
√xt
;

88 
	}
}

92 
	$bgp_damp_deˇy
 (
time_t
 
tdiff
, 
≥«…y
)

94 
i
;

96 
i
 = (Ë((Ë
tdiff
 / 
DELTA_T
);

98 i‡(
i
 == 0)

99  
≥«…y
;

101 i‡(
i
 >
damp
->
deˇy_¨øy_size
)

104  (Ë(
≥«…y
 * 
damp
->
deˇy_¨øy
[
i
]);

105 
	}
}

110 
	$bgp_ªu£_timî
 (
thªad
 *
t
)

112 
bgp_damp_öfo
 *
bdi
;

113 
bgp_damp_öfo
 *
√xt
;

114 
time_t
 
t_now
, 
t_diff
;

116 
damp
->
t_ªu£
 = 
NULL
;

117 
damp
->
t_ªu£
 =

118 
	`thªad_add_timî
 (
ma°î
, 
bgp_ªu£_timî
, 
NULL
, 
DELTA_REUSE
);

120 
t_now
 = 
	`bgp_˛ock
 ();

124 
bdi
 = 
damp
->
ªu£_li°
[damp->
ªu£_off£t
];

125 
damp
->
ªu£_li°
[damp->
ªu£_off£t
] = 
NULL
;

129 
damp
->
ªu£_off£t
 = (damp->ªu£_off£à+ 1Ë% damp->
ªu£_li°_size
;

132 ; 
bdi
; bdò
√xt
)

134 
bgp
 *bg∞
bdi
->
böfo
->
≥î
->bgp;

136 
√xt
 = 
bdi
->next;

139 
t_diff
 = 
t_now
 - 
bdi
->
t_upd©ed
;

142 
bdi
->
≥«…y
 = 
	`bgp_damp_deˇy
 (
t_diff
, bdi->penalty);

145 
bdi
->
t_upd©ed
 = 
t_now
;

148 i‡(
bdi
->
≥«…y
 < 
damp
->
ªu£_limô
)

151 
	`bgp_öfo_un£t_Êag
 (
bdi
->
∫
, bdi->
böfo
, 
BGP_INFO_DAMPED
);

152 
bdi
->
suµªss_time
 = 0;

154 i‡(
bdi
->
œ°ªc‹d
 =
BGP_RECORD_UPDATE
)

156 
	`bgp_öfo_un£t_Êag
 (
bdi
->
∫
, bdi->
böfo
, 
BGP_INFO_HISTORY
);

157 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, &
bdi
->
∫
->
p
, bdi->
böfo
,

158 
bdi
->
afi
, bdi->
ßfi
);

159 
	`bgp_¥o˚ss
 (
bgp
, 
bdi
->
∫
, bdi->
afi
, bdi->
ßfi
);

162 i‡(
bdi
->
≥«…y
 <
damp
->
ªu£_limô
 / 2.0)

163 
	`bgp_damp_öfo_‰ì
 (
bdi
, 1);

165 
	`BGP_DAMP_LIST_ADD
 (
damp
, 
bdi
);

169 
	`bgp_ªu£_li°_add
 (
bdi
);

173 
	}
}

177 
	$bgp_damp_wôhdøw
 (
bgp_öfo
 *
böfo
, 
bgp_node
 *
∫
,

178 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
©å_ch™ge
)

180 
time_t
 
t_now
;

181 
bgp_damp_öfo
 *
bdi
 = 
NULL
;

182 
œ°_≥«…y
 = 0;

184 
t_now
 = 
	`bgp_˛ock
 ();

187 i‡(
böfo
->
exåa
)

188 
bdi
 = 
böfo
->
exåa
->
damp_öfo
;

190 i‡(
bdi
 =
NULL
)

199 
bdi
 = 
	`XCALLOC
 (
MTYPE_BGP_DAMP_INFO
,  (
bgp_damp_öfo
));

200 
bdi
->
böfo
 = binfo;

201 
bdi
->
∫
 =Ñn;

202 
bdi
->
≥«…y
 = (
©å_ch™ge
 ? 
DEFAULT_PENALTY
 / 2 : DEFAULT_PENALTY);

203 
bdi
->
Ê≠
 = 1;

204 
bdi
->
°¨t_time
 = 
t_now
;

205 
bdi
->
suµªss_time
 = 0;

206 
bdi
->
ödex
 = -1;

207 
bdi
->
afi
 =áfi;

208 
bdi
->
ßfi
 = safi;

209 (
	`bgp_öfo_exåa_gë
 (
böfo
))->
damp_öfo
 = 
bdi
;

210 
	`BGP_DAMP_LIST_ADD
 (
damp
, 
bdi
);

214 
œ°_≥«…y
 = 
bdi
->
≥«…y
;

217 
bdi
->
≥«…y
 =

218 (
	`bgp_damp_deˇy
 (
t_now
 - 
bdi
->
t_upd©ed
, bdi->
≥«…y
)

219 + (
©å_ch™ge
 ? 
DEFAULT_PENALTY
 / 2 : DEFAULT_PENALTY));

221 i‡(
bdi
->
≥«…y
 > 
damp
->
˚ûög
)

222 
bdi
->
≥«…y
 = 
damp
->
˚ûög
;

224 
bdi
->
Ê≠
++;

227 
	`as£π
 ((
∫
 =
bdi
->∫Ë&& (
böfo
 == bdi->binfo));

229 
bdi
->
œ°ªc‹d
 = 
BGP_RECORD_WITHDRAW
;

230 
bdi
->
t_upd©ed
 = 
t_now
;

233 
	`bgp_öfo_£t_Êag
 (
∫
, 
böfo
, 
BGP_INFO_HISTORY
);

236 i‡(
	`CHECK_FLAG
 (
bdi
->
böfo
->
Êags
, 
BGP_INFO_DAMPED
))

239 i‡(
bdi
->
≥«…y
 !
œ°_≥«…y
)

241 
	`bgp_ªu£_li°_dñëe
 (
bdi
);

242 
	`bgp_ªu£_li°_add
 (
bdi
);

244  
BGP_DAMP_SUPPRESSED
;

249 i‡(
bdi
->
≥«…y
 >
damp
->
suµªss_vÆue
)

251 
	`bgp_öfo_£t_Êag
 (
∫
, 
böfo
, 
BGP_INFO_DAMPED
);

252 
bdi
->
suµªss_time
 = 
t_now
;

253 
	`BGP_DAMP_LIST_DEL
 (
damp
, 
bdi
);

254 
	`bgp_ªu£_li°_add
 (
bdi
);

257  
BGP_DAMP_USED
;

258 
	}
}

261 
	$bgp_damp_upd©e
 (
bgp_öfo
 *
böfo
, 
bgp_node
 *
∫
,

262 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

264 
time_t
 
t_now
;

265 
bgp_damp_öfo
 *
bdi
;

266 
°©us
;

268 i‡(!
böfo
->
exåa
 || !((
bdi
 = böfo->exåa->
damp_öfo
)))

269  
BGP_DAMP_USED
;

271 
t_now
 = 
	`bgp_˛ock
 ();

272 
	`bgp_öfo_un£t_Êag
 (
∫
, 
böfo
, 
BGP_INFO_HISTORY
);

274 
bdi
->
œ°ªc‹d
 = 
BGP_RECORD_UPDATE
;

275 
bdi
->
≥«…y
 = 
	`bgp_damp_deˇy
 (
t_now
 - bdi->
t_upd©ed
, bdi->penalty);

277 i‡(! 
	`CHECK_FLAG
 (
bdi
->
böfo
->
Êags
, 
BGP_INFO_DAMPED
)

278 && (
bdi
->
≥«…y
 < 
damp
->
suµªss_vÆue
))

279 
°©us
 = 
BGP_DAMP_USED
;

280 i‡(
	`CHECK_FLAG
 (
bdi
->
böfo
->
Êags
, 
BGP_INFO_DAMPED
)

281 && (
bdi
->
≥«…y
 < 
damp
->
ªu£_limô
) )

283 
	`bgp_öfo_un£t_Êag
 (
∫
, 
böfo
, 
BGP_INFO_DAMPED
);

284 
	`bgp_ªu£_li°_dñëe
 (
bdi
);

285 
	`BGP_DAMP_LIST_ADD
 (
damp
, 
bdi
);

286 
bdi
->
suµªss_time
 = 0;

287 
°©us
 = 
BGP_DAMP_USED
;

290 
°©us
 = 
BGP_DAMP_SUPPRESSED
;

292 i‡(
bdi
->
≥«…y
 > 
damp
->
ªu£_limô
 / 2.0)

293 
bdi
->
t_upd©ed
 = 
t_now
;

295 
	`bgp_damp_öfo_‰ì
 (
bdi
, 0);

297  
°©us
;

298 
	}
}

302 
	$bgp_damp_sˇn
 (
bgp_öfo
 *
böfo
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

304 
time_t
 
t_now
, 
t_diff
;

305 
bgp_damp_öfo
 *
bdi
;

307 
	`as£π
 (
böfo
->
exåa
 && böfo->exåa->
damp_öfo
);

309 
t_now
 = 
	`bgp_˛ock
 ();

310 
bdi
 = 
böfo
->
exåa
->
damp_öfo
;

312 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_DAMPED
))

314 
t_diff
 = 
t_now
 - 
bdi
->
suµªss_time
;

316 i‡(
t_diff
 >
damp
->
max_suµªss_time
)

318 
	`bgp_öfo_un£t_Êag
 (
bdi
->
∫
, 
böfo
, 
BGP_INFO_DAMPED
);

319 
	`bgp_ªu£_li°_dñëe
 (
bdi
);

320 
	`BGP_DAMP_LIST_ADD
 (
damp
, 
bdi
);

321 
bdi
->
≥«…y
 = 
damp
->
ªu£_limô
;

322 
bdi
->
suµªss_time
 = 0;

323 
bdi
->
t_upd©ed
 = 
t_now
;

326 i‡(
bdi
->
œ°ªc‹d
 =
BGP_RECORD_UPDATE
)

334 
t_diff
 = 
t_now
 - 
bdi
->
t_upd©ed
;

335 
bdi
->
≥«…y
 = 
	`bgp_damp_deˇy
 (
t_diff
, bdi->penalty);

337 i‡(
bdi
->
≥«…y
 <
damp
->
ªu£_limô
 / 2.0)

340 
	`bgp_damp_öfo_‰ì
 (
bdi
, 1);

344 
bdi
->
t_upd©ed
 = 
t_now
;

347 
	}
}

350 
	$bgp_damp_öfo_‰ì
 (
bgp_damp_öfo
 *
bdi
, 
wôhdøw
)

352 
bgp_öfo
 *
böfo
;

354 i‡(! 
bdi
)

357 
böfo
 = 
bdi
->binfo;

358 
böfo
->
exåa
->
damp_öfo
 = 
NULL
;

360 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_DAMPED
))

361 
	`bgp_ªu£_li°_dñëe
 (
bdi
);

363 
	`BGP_DAMP_LIST_DEL
 (
damp
, 
bdi
);

365 
	`bgp_öfo_un£t_Êag
 (
bdi
->
∫
, 
böfo
, 
BGP_INFO_HISTORY
|
BGP_INFO_DAMPED
);

367 i‡(
bdi
->
œ°ªc‹d
 =
BGP_RECORD_WITHDRAW
 && 
wôhdøw
)

368 
	`bgp_öfo_dñëe
 (
bdi
->
∫
, 
böfo
);

370 
	`XFREE
 (
MTYPE_BGP_DAMP_INFO
, 
bdi
);

371 
	}
}

374 
	$bgp_damp_∑ømëî_£t
 (
hli„
, 
ªu£
, 
sup
, 
maxsup
)

376 
ªu£_max_øtio
;

377 
i
;

378 
j
;

380 
damp
->
suµªss_vÆue
 = 
sup
;

381 
damp
->
hÆf_li„
 = 
hli„
;

382 
damp
->
ªu£_limô
 = 
ªu£
;

383 
damp
->
max_suµªss_time
 = 
maxsup
;

386 
damp
->
ªu£_ödex_size
 = 
REUSE_ARRAY_SIZE
;

388 
damp
->
˚ûög
 = ()(damp->
ªu£_limô
 * (
	`pow
(2, ()damp->
max_suµªss_time
/damp->
hÆf_li„
)));

391 
damp
->
deˇy_¨øy_size
 = 
	`˚û
 ((Ëdamp->
max_suµªss_time
 / 
DELTA_T
);

392 
damp
->
deˇy_¨øy
 = 
	`XMALLOC
 (
MTYPE_BGP_DAMP_ARRAY
,

393 (Ë* (
damp
->
deˇy_¨øy_size
));

394 
damp
->
deˇy_¨øy
[0] = 1.0;

395 
damp
->
deˇy_¨øy
[1] = 
	`exp
 ((1.0/(()damp->
hÆf_li„
/
DELTA_T
)Ë* 
	`log
(0.5));

398 
i
 = 2; i < 
damp
->
deˇy_¨øy_size
; i++)

399 
damp
->
deˇy_¨øy
[
i
] = damp->decay_array[i-1] * damp->decay_array[1];

402 
i
 = 
	`˚û
 (()
damp
->
max_suµªss_time
 / 
DELTA_REUSE
) + 1;

403 i‡(
i
 > 
REUSE_LIST_SIZE
 || i == 0)

404 
i
 = 
REUSE_LIST_SIZE
;

405 
damp
->
ªu£_li°_size
 = 
i
;

407 
damp
->
ªu£_li°
 = 
	`XCALLOC
 (
MTYPE_BGP_DAMP_ARRAY
,

408 
damp
->
ªu£_li°_size


409 *  (
bgp_ªu£_node
 *));

412 
damp
->
ªu£_ödex
 = 
	`XCALLOC
 (
MTYPE_BGP_DAMP_ARRAY
,

413 (Ë* 
damp
->
ªu£_ödex_size
);

415 
ªu£_max_øtio
 = ()
damp
->
˚ûög
/damp->
ªu£_limô
;

416 
j
 = (
	`exp
(()
damp
->
max_suµªss_time
/damp->
hÆf_li„
Ë* 
	`log10
(2.0));

417 i‡–
ªu£_max_øtio
 > 
j
 && j != 0 )

418 
ªu£_max_øtio
 = 
j
;

420 
damp
->
sˇÀ_Á˘‹
 = ()damp->
ªu£_ödex_size
/(
ªu£_max_øtio
 - 1);

422 
i
 = 0; i < 
damp
->
ªu£_ödex_size
; i++)

424 
damp
->
ªu£_ödex
[
i
] =

425 ()((()
damp
->
hÆf_li„
 / 
DELTA_REUSE
)

426 * 
	`log10
 (1.0 / (
damp
->
ªu£_limô
 * ( 1.0 + (()
i
/damp->
sˇÀ_Á˘‹
)))) /Üog10(0.5));

428 
	}
}

431 
	$bgp_damp_íabÀ
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
time_t
 
hÆf
,

432 
ªu£
, 
suµªss
, 
time_t
 
max
)

434 i‡(
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
))

436 i‡(
damp
->
hÆf_li„
 =
hÆf


437 && 
damp
->
ªu£_limô
 =
ªu£


438 && 
damp
->
suµªss_vÆue
 =
suµªss


439 && 
damp
->
max_suµªss_time
 =
max
)

441 
	`bgp_damp_dißbÀ
 (
bgp
, 
afi
, 
ßfi
);

444 
	`SET_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
);

445 
	`bgp_damp_∑ømëî_£t
 (
hÆf
, 
ªu£
, 
suµªss
, 
max
);

448 i‡(! 
damp
->
t_ªu£
)

449 
damp
->
t_ªu£
 =

450 
	`thªad_add_timî
 (
ma°î
, 
bgp_ªu£_timî
, 
NULL
, 
DELTA_REUSE
);

453 
	}
}

456 
	$bgp_damp_c⁄fig_˛ón
 (
bgp_damp_c⁄fig
 *
damp
)

459 
	`XFREE
 (
MTYPE_BGP_DAMP_ARRAY
, 
damp
->
deˇy_¨øy
);

462 
	`XFREE
 (
MTYPE_BGP_DAMP_ARRAY
, 
damp
->
ªu£_ödex
);

465 
	`XFREE
 (
MTYPE_BGP_DAMP_ARRAY
, 
damp
->
ªu£_li°
);

466 
	}
}

470 
	$bgp_damp_öfo_˛ón
 ()

472 
i
;

473 
bgp_damp_öfo
 *
bdi
, *
√xt
;

475 
damp
->
ªu£_off£t
 = 0;

477 
i
 = 0; i < 
damp
->
ªu£_li°_size
; i++)

479 i‡(! 
damp
->
ªu£_li°
[
i
])

482 
bdi
 = 
damp
->
ªu£_li°
[
i
]; bdi; bdò
√xt
)

484 
√xt
 = 
bdi
->next;

485 
	`bgp_damp_öfo_‰ì
 (
bdi
, 1);

487 
damp
->
ªu£_li°
[
i
] = 
NULL
;

490 
bdi
 = 
damp
->
no_ªu£_li°
; bdi; bdò
√xt
)

492 
√xt
 = 
bdi
->next;

493 
	`bgp_damp_öfo_‰ì
 (
bdi
, 1);

495 
damp
->
no_ªu£_li°
 = 
NULL
;

496 
	}
}

499 
	$bgp_damp_dißbÀ
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

502 i‡(! 
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
))

506 i‡(
damp
->
t_ªu£
 )

507 
	`thªad_ˇn˚l
 (
damp
->
t_ªu£
);

508 
damp
->
t_ªu£
 = 
NULL
;

511 
	`bgp_damp_öfo_˛ón
 ();

514 
	`bgp_damp_c⁄fig_˛ón
 (&
bgp_damp_cfg
);

516 
	`UNSET_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
);

518 
	}
}

521 
	$bgp_c⁄fig_wrôe_damp
 (
vty
 *vty)

523 i‡(
bgp_damp_cfg
.
hÆf_li„
 =
DEFAULT_HALF_LIFE
*60

524 && 
bgp_damp_cfg
.
ªu£_limô
 =
DEFAULT_REUSE


525 && 
bgp_damp_cfg
.
suµªss_vÆue
 =
DEFAULT_SUPPRESS


526 && 
bgp_damp_cfg
.
max_suµªss_time
 =bgp_damp_cfg.
hÆf_li„
*4)

527 
	`vty_out
 (
vty
, " bg∞dam≥nög%s", 
VTY_NEWLINE
);

528 i‡(
bgp_damp_cfg
.
hÆf_li„
 !
DEFAULT_HALF_LIFE
*60

529 && 
bgp_damp_cfg
.
ªu£_limô
 =
DEFAULT_REUSE


530 && 
bgp_damp_cfg
.
suµªss_vÆue
 =
DEFAULT_SUPPRESS


531 && 
bgp_damp_cfg
.
max_suµªss_time
 =bgp_damp_cfg.
hÆf_li„
*4)

532 
	`vty_out
 (
vty
, " bgp dampening %ld%s",

533 
bgp_damp_cfg
.
hÆf_li„
/60,

534 
VTY_NEWLINE
);

536 
	`vty_out
 (
vty
, " bgp dampening %ld %d %d %ld%s",

537 
bgp_damp_cfg
.
hÆf_li„
/60,

538 
bgp_damp_cfg
.
ªu£_limô
,

539 
bgp_damp_cfg
.
suµªss_vÆue
,

540 
bgp_damp_cfg
.
max_suµªss_time
/60,

541 
VTY_NEWLINE
);

542 
	}
}

545 
	$bgp_gë_ªu£_time
 (
≥«…y
, *
buf
, 
size_t
 
Àn
)

547 
time_t
 
ªu£_time
 = 0;

548 
tm
 *tm = 
NULL
;

550 i‡(
≥«…y
 > 
damp
->
ªu£_limô
)

552 
ªu£_time
 = (Ë(
DELTA_T
 * ((
	`log
(()
damp
->
ªu£_limô
/
≥«…y
))/÷og(damp->
deˇy_¨øy
[1]))));

554 i‡(
ªu£_time
 > 
damp
->
max_suµªss_time
)

555 
ªu£_time
 = 
damp
->
max_suµªss_time
;

557 
tm
 = 
	`gmtime
 (&
ªu£_time
);

560 
ªu£_time
 = 0;

563 
	#ONE_DAY_SECOND
 60*60*24

	)

564 
	#ONE_WEEK_SECOND
 60*60*24*7

	)

565 i‡(
ªu£_time
 == 0)

566 
	`¢¥ötf
 (
buf
, 
Àn
, "00:00:00");

567 i‡(
ªu£_time
 < 
ONE_DAY_SECOND
)

568 
	`¢¥ötf
 (
buf
, 
Àn
, "%02d:%02d:%02d",

569 
tm
->
tm_hour
,Åm->
tm_mö
,Åm->
tm_£c
);

570 i‡(
ªu£_time
 < 
ONE_WEEK_SECOND
)

571 
	`¢¥ötf
 (
buf
, 
Àn
, "%dd%02dh%02dm",

572 
tm
->
tm_yday
,Åm->
tm_hour
,Åm->
tm_mö
);

574 
	`¢¥ötf
 (
buf
, 
Àn
, "%02dw%dd%02dh",

575 
tm
->
tm_yday
/7,Åm->tm_yday - (—m->tm_yday/7Ë* 7),Åm->
tm_hour
);

577  
buf
;

578 
	}
}

581 
	$bgp_damp_öfo_vty
 (
vty
 *vty, 
bgp_öfo
 *
böfo
)

583 
bgp_damp_öfo
 *
bdi
;

584 
time_t
 
t_now
, 
t_diff
;

585 
timebuf
[
BGP_UPTIME_LEN
];

586 
≥«…y
;

588 i‡(!
böfo
->
exåa
)

592 
bdi
 = 
böfo
->
exåa
->
damp_öfo
;

596 i‡(! 
damp
 || ! 
bdi
)

600 
t_now
 = 
	`bgp_˛ock
 ();

601 
t_diff
 = 
t_now
 - 
bdi
->
t_upd©ed
;

602 
≥«…y
 = 
	`bgp_damp_deˇy
 (
t_diff
, 
bdi
->penalty);

604 
	`vty_out
 (
vty
, " Dampinfo:Öenalty %d, flapped %dÅimes in %s",

605 
≥«…y
, 
bdi
->
Ê≠
,

606 
	`≥î_u±ime
 (
bdi
->
°¨t_time
, 
timebuf
, 
BGP_UPTIME_LEN
));

608 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_DAMPED
)

609 && ! 
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_HISTORY
))

610 
	`vty_out
 (
vty
, ",Ñeuse in %s",

611 
	`bgp_gë_ªu£_time
 (
≥«…y
, 
timebuf
, 
BGP_UPTIME_LEN
));

613 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

614 
	}
}

617 
	$bgp_damp_ªu£_time_vty
 (
vty
 *vty, 
bgp_öfo
 *
böfo
,

618 *
timebuf
, 
size_t
 
Àn
)

620 
bgp_damp_öfo
 *
bdi
;

621 
time_t
 
t_now
, 
t_diff
;

622 
≥«…y
;

624 i‡(!
böfo
->
exåa
)

625  
NULL
;

628 
bdi
 = 
böfo
->
exåa
->
damp_öfo
;

632 i‡(! 
damp
 || ! 
bdi
)

633  
NULL
;

636 
t_now
 = 
	`bgp_˛ock
 ();

637 
t_diff
 = 
t_now
 - 
bdi
->
t_upd©ed
;

638 
≥«…y
 = 
	`bgp_damp_deˇy
 (
t_diff
, 
bdi
->penalty);

640  
	`bgp_gë_ªu£_time
 (
≥«…y
, 
timebuf
, 
Àn
);

641 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_damp.h

21 #i‚de‡
_QUAGGA_BGP_DAMP_H


22 
	#_QUAGGA_BGP_DAMP_H


	)

25 
	sbgp_damp_öfo


29 
bgp_damp_öfo
 *
	m√xt
;

30 
bgp_damp_öfo
 *
	m¥ev
;

33 
	m≥«…y
;

36 
	mÊ≠
;

39 
time_t
 
	m°¨t_time
;

42 
time_t
 
	mt_upd©ed
;

45 
time_t
 
	msuµªss_time
;

48 
bgp_öfo
 *
	mböfo
;

51 
bgp_node
 *
	m∫
;

54 
	mödex
;

57 
u_ch¨
 
	mœ°ªc‹d
;

58 
	#BGP_RECORD_UPDATE
 1U

	)

59 
	#BGP_RECORD_WITHDRAW
 2U

	)

61 
afi_t
 
	mafi
;

62 
ßfi_t
 
	mßfi
;

66 
	sbgp_damp_c⁄fig


69 
	msuµªss_vÆue
;

72 
	mªu£_limô
;

75 
time_t
 
	mmax_suµªss_time
;

78 
time_t
 
	mhÆf_li„
;

83 
time_t
 
	mtmax
;

84 
	mªu£_li°_size
;

85 
	mªu£_ödex_size
;

90 
	m˚ûög
;

91 
	mdeˇy_øã_≥r_tick
;

92 
	mdeˇy_¨øy_size
;

93 
	msˇÀ_Á˘‹
;

94 
	mªu£_sˇÀ_Á˘‹
;

97 *
	mdeˇy_¨øy
;

100 *
	mªu£_ödex
;

103 
bgp_damp_öfo
 **
	mªu£_li°
;

104 
	mªu£_off£t
;

107 
bgp_damp_öfo
 *
	mno_ªu£_li°
;

110 
thªad
* 
	mt_ªu£
;

113 
	#BGP_DAMP_NONE
 0

	)

114 
	#BGP_DAMP_USED
 1

	)

115 
	#BGP_DAMP_SUPPRESSED
 2

	)

118 
	#DELTA_REUSE
 10

	)

121 
	#DELTA_T
 5

	)

123 
	#DEFAULT_PENALTY
 1000

	)

125 
	#DEFAULT_HALF_LIFE
 15

	)

126 
	#DEFAULT_REUSE
 750

	)

127 
	#DEFAULT_SUPPRESS
 2000

	)

129 
	#REUSE_LIST_SIZE
 256

	)

130 
	#REUSE_ARRAY_SIZE
 1024

	)

132 
bgp_damp_íabÀ
 (
bgp
 *, 
afi_t
, 
ßfi_t
, 
time_t
, ,

133 , 
time_t
);

134 
bgp_damp_dißbÀ
 (
bgp
 *, 
afi_t
, 
ßfi_t
);

135 
bgp_damp_wôhdøw
 (
bgp_öfo
 *, 
bgp_node
 *,

136 
afi_t
, 
ßfi_t
, );

137 
bgp_damp_upd©e
 (
bgp_öfo
 *, 
bgp_node
 *, 
afi_t
, 
ßfi_t
);

138 
bgp_damp_sˇn
 (
bgp_öfo
 *, 
afi_t
, 
ßfi_t
);

139 
bgp_damp_öfo_‰ì
 (
bgp_damp_öfo
 *, );

140 
bgp_damp_öfo_˛ón
 ();

141 
bgp_damp_deˇy
 (
time_t
, );

142 
bgp_c⁄fig_wrôe_damp
 (
vty
 *);

143 
bgp_damp_öfo_vty
 (
vty
 *, 
bgp_öfo
 *);

144 c⁄° * 
bgp_damp_ªu£_time_vty
 (
vty
 *, 
bgp_öfo
 *,

145 *, 
size_t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_debug.c

21 
	~<zebø.h
>

23 
	~<lib/vîsi⁄.h
>

24 
	~"¥efix.h
"

25 
	~"lökli°.h
"

26 
	~"°ªam.h
"

27 
	~"comm™d.h
"

28 
	~"°r.h
"

29 
	~"log.h
"

30 
	~"sockuni⁄.h
"

32 
	~"bgpd/bgpd.h
"

33 
	~"bgpd/bgp_a•©h.h
"

34 
	~"bgpd/bgp_rouã.h
"

35 
	~"bgpd/bgp_©å.h
"

36 
	~"bgpd/bgp_debug.h
"

37 
	~"bgpd/bgp_communôy.h
"

39 
	gc⁄f_bgp_debug_as4
;

40 
	gc⁄f_bgp_debug_fsm
;

41 
	gc⁄f_bgp_debug_evíts
;

42 
	gc⁄f_bgp_debug_∑ckë
;

43 
	gc⁄f_bgp_debug_fûãr
;

44 
	gc⁄f_bgp_debug_kì∑live
;

45 
	gc⁄f_bgp_debug_upd©e
;

46 
	gc⁄f_bgp_debug_n‹mÆ
;

47 
	gc⁄f_bgp_debug_zebø
;

48 #ifde‡
USE_SRX


49 
	gc⁄f_bgp_debug_bgp£c
;

52 
	gãrm_bgp_debug_as4
;

53 
	gãrm_bgp_debug_fsm
;

54 
	gãrm_bgp_debug_evíts
;

55 
	gãrm_bgp_debug_∑ckë
;

56 
	gãrm_bgp_debug_fûãr
;

57 
	gãrm_bgp_debug_kì∑live
;

58 
	gãrm_bgp_debug_upd©e
;

59 
	gãrm_bgp_debug_n‹mÆ
;

60 
	gãrm_bgp_debug_zebø
;

61 #ifde‡
USE_SRX


62 
	gãrm_bgp_debug_bgp£c
;

66 c⁄° 
mesßge
 
	gbgp_°©us_msg
[] =

68 { 
IdÀ
, "Idle" },

69 { 
C⁄√˘
, "Connect" },

70 { 
A˘ive
, "Active" },

71 { 
O≥nSít
, "OpenSent" },

72 { 
O≥nC⁄fúm
, "OpenConfirm" },

73 { 
E°ablished
, "Established" },

74 { 
CÀ¨ög
, "Clearing" },

75 { 
Dñëed
, "Deleted" },

77 c⁄° 
	gbgp_°©us_msg_max
 = 
BGP_STATUS_MAX
;

80 c⁄° *
	gbgp_ty≥_°r
[] =

82 
NULL
,

92 c⁄° 
mesßge
 
	gbgp_nŸify_msg
[] =

94 { 
BGP_NOTIFY_HEADER_ERR
, "Message Header Error"},

95 { 
BGP_NOTIFY_OPEN_ERR
, "OPEN Message Error"},

96 { 
BGP_NOTIFY_UPDATE_ERR
, "UPDATE Message Error"},

97 { 
BGP_NOTIFY_HOLD_ERR
, "Hold Timer Expired"},

98 { 
BGP_NOTIFY_FSM_ERR
, "Finite State Machine Error"},

99 { 
BGP_NOTIFY_CEASE
, "Cease"},

100 { 
BGP_NOTIFY_CAPABILITY_ERR
, "CAPABILITY Message Error"},

102 c⁄° 
	gbgp_nŸify_msg_max
 = 
BGP_NOTIFY_MAX
;

104 c⁄° 
mesßge
 
	gbgp_nŸify_hód_msg
[] =

106 { 
BGP_NOTIFY_HEADER_NOT_SYNC
, "/Connection Not Synchronized"},

107 { 
BGP_NOTIFY_HEADER_BAD_MESLEN
, "/Bad Message Length"},

108 { 
BGP_NOTIFY_HEADER_BAD_MESTYPE
, "/Bad Message Type"}

110 c⁄° 
	gbgp_nŸify_hód_msg_max
 = 
BGP_NOTIFY_HEADER_MAX
;

112 c⁄° 
mesßge
 
	gbgp_nŸify_›í_msg
[] =

114 { 
BGP_NOTIFY_SUBCODE_UNSPECIFIC
, "/Unspecific"},

115 { 
BGP_NOTIFY_OPEN_UNSUP_VERSION
, "/Unsupported Version Number" },

116 { 
BGP_NOTIFY_OPEN_BAD_PEER_AS
, "/Bad Peer AS"},

117 { 
BGP_NOTIFY_OPEN_BAD_BGP_IDENT
, "/Bad BGP Identifier"},

118 { 
BGP_NOTIFY_OPEN_UNSUP_PARAM
, "/Unsupported Optional Parameter"},

119 { 
BGP_NOTIFY_OPEN_AUTH_FAILURE
, "/Authentication Failure"},

120 { 
BGP_NOTIFY_OPEN_UNACEP_HOLDTIME
, "/Unacceptable Hold Time"},

121 { 
BGP_NOTIFY_OPEN_UNSUP_CAPBL
, "/Unsupported Capability"},

123 c⁄° 
	gbgp_nŸify_›í_msg_max
 = 
BGP_NOTIFY_OPEN_MAX
;

125 c⁄° 
mesßge
 
	gbgp_nŸify_upd©e_msg
[] =

127 { 
BGP_NOTIFY_SUBCODE_UNSPECIFIC
, "/Unspecific"},

128 { 
BGP_NOTIFY_UPDATE_MAL_ATTR
, "/Malformed Attribute List"},

129 { 
BGP_NOTIFY_UPDATE_UNREC_ATTR
, "/Unrecognized Well-known Attribute"},

130 { 
BGP_NOTIFY_UPDATE_MISS_ATTR
, "/Missing Well-known Attribute"},

131 { 
BGP_NOTIFY_UPDATE_ATTR_FLAG_ERR
, "/Attribute Flags Error"},

132 { 
BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
, "/Attribute Length Error"},

133 { 
BGP_NOTIFY_UPDATE_INVAL_ORIGIN
, "/Invalid ORIGIN Attribute"},

134 { 
BGP_NOTIFY_UPDATE_AS_ROUTE_LOOP
, "/AS Routing Loop"},

135 { 
BGP_NOTIFY_UPDATE_INVAL_NEXT_HOP
, "/Invalid NEXT_HOP Attribute"},

136 { 
BGP_NOTIFY_UPDATE_OPT_ATTR_ERR
, "/Optional Attribute Error"},

137 { 
BGP_NOTIFY_UPDATE_INVAL_NETWORK
, "/Invalid Network Field"},

138 { 
BGP_NOTIFY_UPDATE_MAL_AS_PATH
, "/Malformed AS_PATH"},

140 c⁄° 
	gbgp_nŸify_upd©e_msg_max
 = 
BGP_NOTIFY_UPDATE_MAX
;

142 c⁄° 
mesßge
 
	gbgp_nŸify_˚a£_msg
[] =

144 { 
BGP_NOTIFY_SUBCODE_UNSPECIFIC
, "/Unspecific"},

145 { 
BGP_NOTIFY_CEASE_MAX_PREFIX
, "/Maximum Number of Prefixes Reached"},

146 { 
BGP_NOTIFY_CEASE_ADMIN_SHUTDOWN
, "/Administratively Shutdown"},

147 { 
BGP_NOTIFY_CEASE_PEER_UNCONFIG
, "/Peer Unconfigured"},

148 { 
BGP_NOTIFY_CEASE_ADMIN_RESET
, "/Administratively Reset"},

149 { 
BGP_NOTIFY_CEASE_CONNECT_REJECT
, "/Connection Rejected"},

150 { 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
, "/Other Configuration Change"},

151 { 
BGP_NOTIFY_CEASE_COLLISION_RESOLUTION
, "/Connection collisionÑesolution"},

152 { 
BGP_NOTIFY_CEASE_OUT_OF_RESOURCE
, "/Out of Resource"},

154 c⁄° 
	gbgp_nŸify_˚a£_msg_max
 = 
BGP_NOTIFY_CEASE_MAX
;

156 c⁄° 
mesßge
 
	gbgp_nŸify_ˇ∑bûôy_msg
[] =

158 { 
BGP_NOTIFY_SUBCODE_UNSPECIFIC
, "/Unspecific"},

159 { 
BGP_NOTIFY_CAPABILITY_INVALID_ACTION
, "/Invalid Action Value" },

160 { 
BGP_NOTIFY_CAPABILITY_INVALID_LENGTH
, "/Invalid Capability Length"},

161 { 
BGP_NOTIFY_CAPABILITY_MALFORMED_CODE
, "/Malformed Capability Value"},

163 c⁄° 
	gbgp_nŸify_ˇ∑bûôy_msg_max
 = 
BGP_NOTIFY_CAPABILITY_MAX
;

166 c⁄° *
	gbgp_‹igö_°r
[] = {"i","e","?"};

167 c⁄° *
	gbgp_‹igö_l⁄g_°r
[] = {"IGP","EGP","incomplete"};

171 
	$bgp_dump_©å
 (
≥î
 *≥î, 
©å
 *©å, *
buf
, 
size_t
 
size
)

173 i‡(! 
©å
)

176 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
)))

177 
	`¢¥ötf
 (
buf
, 
size
, "√xth› %s", 
	`öë_¡ﬂ
 (
©å
->
√xth›
));

179 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGIN
)))

180 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ", origin %s",

181 
bgp_‹igö_°r
[
©å
->
‹igö
]);

183 #ifde‡
HAVE_IPV6


184 i‡(
©å
->
exåa
)

186 
addrbuf
[
BUFSIZ
];

189 i‡(
©å
->
exåa
->
mp_√xth›_Àn
 == 16

190 || 
©å
->
exåa
->
mp_√xth›_Àn
 == 32)

191 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ", mp_nexthop %s",

192 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_globÆ
,

193 
addrbuf
, 
BUFSIZ
));

195 i‡(
©å
->
exåa
->
mp_√xth›_Àn
 == 32)

196 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), "(%s)",

197 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_loˇl
,

198 
addrbuf
, 
BUFSIZ
));

202 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
)))

203 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ",Üocalpref %u",

204 
©å
->
loˇl_¥ef
);

206 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
)))

207 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ", metric %u",

208 
©å
->
med
);

210 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
)))

211 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ", community %s",

212 
	`communôy_°r
 (
©å
->
communôy
));

214 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
)))

215 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ",átomic-aggregate");

217 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
)))

218 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ",ággregated by %u %s",

219 
©å
->
exåa
->
aggªg©‹_as
,

220 
	`öë_¡ﬂ
 (
©å
->
exåa
->
aggªg©‹_addr
));

222 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGINATOR_ID
)))

223 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ", originator %s",

224 
	`öë_¡ﬂ
 (
©å
->
exåa
->
‹igö©‹_id
));

226 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_CLUSTER_LIST
)))

228 
i
;

230 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ", clusterlist");

231 
i
 = 0; i < 
©å
->
exåa
->
˛u°î
->
Àngth
 / 4; i++)

232 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), " %s",

233 
	`öë_¡ﬂ
 (
©å
->
exåa
->
˛u°î
->
li°
[
i
]));

236 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AS_PATH
)))

237 
	`¢¥ötf
 (
buf
 + 
	`°æí
 (buf), 
size
 - strlen (buf), ",Öath %s",

238 
	`a•©h_¥öt
 (
©å
->
a•©h
));

240 i‡(
	`°æí
 (
buf
) > 1)

244 
	}
}

248 
	$bgp_nŸify_¥öt
(
≥î
 *≥î, 
bgp_nŸify
 *bgp_notify,

249 c⁄° *
dúe˘
)

251 c⁄° *
subcode_°r
;

252 c⁄° *
code_°r
;

254 
subcode_°r
 = "";

255 
code_°r
 = 
	`LOOKUP_DEF
 (
bgp_nŸify_msg
, 
bgp_nŸify
->
code
,

258 
bgp_nŸify
->
code
)

260 
BGP_NOTIFY_HEADER_ERR
:

261 
subcode_°r
 = 
	`LOOKUP_DEF
 (
bgp_nŸify_hód_msg
, 
bgp_nŸify
->
subcode
,

264 
BGP_NOTIFY_OPEN_ERR
:

265 
subcode_°r
 = 
	`LOOKUP_DEF
 (
bgp_nŸify_›í_msg
, 
bgp_nŸify
->
subcode
,

268 
BGP_NOTIFY_UPDATE_ERR
:

269 
subcode_°r
 = 
	`LOOKUP_DEF
 (
bgp_nŸify_upd©e_msg
, 
bgp_nŸify
->
subcode
,

272 
BGP_NOTIFY_HOLD_ERR
:

274 
BGP_NOTIFY_FSM_ERR
:

276 
BGP_NOTIFY_CEASE
:

277 
subcode_°r
 = 
	`LOOKUP_DEF
 (
bgp_nŸify_˚a£_msg
, 
bgp_nŸify
->
subcode
,

280 
BGP_NOTIFY_CAPABILITY_ERR
:

281 
subcode_°r
 = 
	`LOOKUP_DEF
 (
bgp_nŸify_ˇ∑bûôy_msg
, 
bgp_nŸify
->
subcode
,

286 i‡(
	`bgp_Êag_check
 (
≥î
->
bgp
, 
BGP_FLAG_LOG_NEIGHBOR_CHANGES
))

287 
	`zlog_öfo
 ("%%NOTIFICATION: %sÇeighbor %s %d/%d (%s%s) %d bytes %s",

288 
	`°rcmp
 (
dúe˘
, "received") == 0 ? "received from" : "sentÅo",

289 
≥î
->
ho°
, 
bgp_nŸify
->
code
, bgp_nŸify->
subcode
,

290 
code_°r
, 
subcode_°r
, 
bgp_nŸify
->
Àngth
,

291 
bgp_nŸify
->
d©a
 ? bgp_notify->data : "");

292 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

293 
	`∂og_debug
 (
≥î
->
log
, "%s %s NOTIFICATION %d/%d (%s%s) %d bytes %s",

294 
≥î
 ?Öìr->
ho°
 : "",

295 
dúe˘
, 
bgp_nŸify
->
code
, bgp_nŸify->
subcode
,

296 
code_°r
, 
subcode_°r
, 
bgp_nŸify
->
Àngth
,

297 
bgp_nŸify
->
d©a
 ? bgp_notify->data : "");

298 
	}
}

301 
	gbgp_debug_›ti⁄
 = 0;

304 
	$debug
 (
›ti⁄
)

306  
bgp_debug_›ti⁄
 & 
›ti⁄
;

307 
	}
}

309 
DEFUN
 (
debug_bgp_as4
,

310 
debug_bgp_as4_cmd
,

312 
DEBUG_STR


313 
BGP_STR


316 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

317 
DEBUG_ON
 (
as4
, 
AS4
);

320 
TERM_DEBUG_ON
 (
as4
, 
AS4
);

321 
vty_out
 (
vty
, "BGPás4 debuggög i†⁄%s", 
VTY_NEWLINE
);

323  
	gCMD_SUCCESS
;

326 
DEFUN
 (
no_debug_bgp_as4
,

327 
no_debug_bgp_as4_cmd
,

329 
NO_STR


330 
DEBUG_STR


331 
BGP_STR


334 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

335 
DEBUG_OFF
 (
as4
, 
AS4
);

338 
TERM_DEBUG_OFF
 (
as4
, 
AS4
);

339 
vty_out
 (
vty
, "BGPás4 debuggög i†off%s", 
VTY_NEWLINE
);

341  
	gCMD_SUCCESS
;

344 
ALIAS
 (
no_debug_bgp_as4
,

345 
undebug_bgp_as4_cmd
,

347 
UNDEBUG_STR


348 
BGP_STR


351 
DEFUN
 (
debug_bgp_as4_£gmít
,

352 
debug_bgp_as4_£gmít_cmd
,

354 
DEBUG_STR


355 
BGP_STR


359 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

360 
DEBUG_ON
 (
as4
, 
AS4_SEGMENT
);

363 
TERM_DEBUG_ON
 (
as4
, 
AS4_SEGMENT
);

364 
vty_out
 (
vty
, "BGPás4 segmíàdebuggög i†⁄%s", 
VTY_NEWLINE
);

366  
	gCMD_SUCCESS
;

369 
DEFUN
 (
no_debug_bgp_as4_£gmít
,

370 
no_debug_bgp_as4_£gmít_cmd
,

372 
NO_STR


373 
DEBUG_STR


374 
BGP_STR


378 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

379 
DEBUG_OFF
 (
as4
, 
AS4_SEGMENT
);

382 
TERM_DEBUG_OFF
 (
as4
, 
AS4_SEGMENT
);

383 
vty_out
 (
vty
, "BGPás4 segmíàdebuggög i†off%s", 
VTY_NEWLINE
);

385  
	gCMD_SUCCESS
;

388 
ALIAS
 (
no_debug_bgp_as4_£gmít
,

389 
undebug_bgp_as4_£gmít_cmd
,

391 
UNDEBUG_STR


392 
BGP_STR


396 
DEFUN
 (
debug_bgp_fsm
,

397 
debug_bgp_fsm_cmd
,

399 
DEBUG_STR


400 
BGP_STR


403 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

404 
DEBUG_ON
 (
fsm
, 
FSM
);

407 
TERM_DEBUG_ON
 (
fsm
, 
FSM
);

408 
vty_out
 (
vty
, "BGP fsm debuggög i†⁄%s", 
VTY_NEWLINE
);

410  
	gCMD_SUCCESS
;

413 
DEFUN
 (
no_debug_bgp_fsm
,

414 
no_debug_bgp_fsm_cmd
,

416 
NO_STR


417 
DEBUG_STR


418 
BGP_STR


421 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

422 
DEBUG_OFF
 (
fsm
, 
FSM
);

425 
TERM_DEBUG_OFF
 (
fsm
, 
FSM
);

426 
vty_out
 (
vty
, "BGP fsm debuggög i†off%s", 
VTY_NEWLINE
);

428  
	gCMD_SUCCESS
;

431 
ALIAS
 (
no_debug_bgp_fsm
,

432 
undebug_bgp_fsm_cmd
,

434 
UNDEBUG_STR


435 
BGP_STR


438 
DEFUN
 (
debug_bgp_evíts
,

439 
debug_bgp_evíts_cmd
,

441 
DEBUG_STR


442 
BGP_STR


445 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

446 
DEBUG_ON
 (
evíts
, 
EVENTS
);

449 
TERM_DEBUG_ON
 (
evíts
, 
EVENTS
);

450 
vty_out
 (
vty
, "BGPÉvít†debuggög i†⁄%s", 
VTY_NEWLINE
);

452  
	gCMD_SUCCESS
;

455 
DEFUN
 (
no_debug_bgp_evíts
,

456 
no_debug_bgp_evíts_cmd
,

458 
NO_STR


459 
DEBUG_STR


460 
BGP_STR


463 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

464 
DEBUG_OFF
 (
evíts
, 
EVENTS
);

467 
TERM_DEBUG_OFF
 (
evíts
, 
EVENTS
);

468 
vty_out
 (
vty
, "BGPÉvít†debuggög i†off%s", 
VTY_NEWLINE
);

470  
	gCMD_SUCCESS
;

473 
ALIAS
 (
no_debug_bgp_evíts
,

474 
undebug_bgp_evíts_cmd
,

476 
UNDEBUG_STR


477 
BGP_STR


480 
DEFUN
 (
debug_bgp_fûãr
,

481 
debug_bgp_fûãr_cmd
,

483 
DEBUG_STR


484 
BGP_STR


487 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

488 
DEBUG_ON
 (
fûãr
, 
FILTER
);

491 
TERM_DEBUG_ON
 (
fûãr
, 
FILTER
);

492 
vty_out
 (
vty
, "BGP fûãr†debuggög i†⁄%s", 
VTY_NEWLINE
);

494  
	gCMD_SUCCESS
;

497 
DEFUN
 (
no_debug_bgp_fûãr
,

498 
no_debug_bgp_fûãr_cmd
,

500 
NO_STR


501 
DEBUG_STR


502 
BGP_STR


505 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

506 
DEBUG_OFF
 (
fûãr
, 
FILTER
);

509 
TERM_DEBUG_OFF
 (
fûãr
, 
FILTER
);

510 
vty_out
 (
vty
, "BGP fûãr†debuggög i†off%s", 
VTY_NEWLINE
);

512  
	gCMD_SUCCESS
;

515 
ALIAS
 (
no_debug_bgp_fûãr
,

516 
undebug_bgp_fûãr_cmd
,

518 
UNDEBUG_STR


519 
BGP_STR


522 
DEFUN
 (
debug_bgp_kì∑live
,

523 
debug_bgp_kì∑live_cmd
,

525 
DEBUG_STR


526 
BGP_STR


529 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

530 
DEBUG_ON
 (
kì∑live
, 
KEEPALIVE
);

533 
TERM_DEBUG_ON
 (
kì∑live
, 
KEEPALIVE
);

534 
vty_out
 (
vty
, "BGP kì∑live†debuggög i†⁄%s", 
VTY_NEWLINE
);

536  
	gCMD_SUCCESS
;

539 
DEFUN
 (
no_debug_bgp_kì∑live
,

540 
no_debug_bgp_kì∑live_cmd
,

542 
NO_STR


543 
DEBUG_STR


544 
BGP_STR


547 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

548 
DEBUG_OFF
 (
kì∑live
, 
KEEPALIVE
);

551 
TERM_DEBUG_OFF
 (
kì∑live
, 
KEEPALIVE
);

552 
vty_out
 (
vty
, "BGP kì∑live†debuggög i†off%s", 
VTY_NEWLINE
);

554  
	gCMD_SUCCESS
;

557 
ALIAS
 (
no_debug_bgp_kì∑live
,

558 
undebug_bgp_kì∑live_cmd
,

560 
UNDEBUG_STR


561 
BGP_STR


564 
DEFUN
 (
debug_bgp_upd©e
,

565 
debug_bgp_upd©e_cmd
,

567 
DEBUG_STR


568 
BGP_STR


571 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

573 
DEBUG_ON
 (
upd©e
, 
UPDATE_IN
);

574 
DEBUG_ON
 (
upd©e
, 
UPDATE_OUT
);

578 
TERM_DEBUG_ON
 (
upd©e
, 
UPDATE_IN
);

579 
TERM_DEBUG_ON
 (
upd©e
, 
UPDATE_OUT
);

580 
vty_out
 (
vty
, "BGP upd©e†debuggög i†⁄%s", 
VTY_NEWLINE
);

582  
	gCMD_SUCCESS
;

585 
DEFUN
 (
debug_bgp_upd©e_dúe˘
,

586 
debug_bgp_upd©e_dúe˘_cmd
,

588 
DEBUG_STR


589 
BGP_STR


594 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

596 i‡(
°∫cmp
 ("i", 
¨gv
[0], 1) == 0)

598 
DEBUG_OFF
 (
upd©e
, 
UPDATE_OUT
);

599 
DEBUG_ON
 (
upd©e
, 
UPDATE_IN
);

603 
DEBUG_OFF
 (
upd©e
, 
UPDATE_IN
);

604 
DEBUG_ON
 (
upd©e
, 
UPDATE_OUT
);

609 i‡(
°∫cmp
 ("i", 
¨gv
[0], 1) == 0)

611 
TERM_DEBUG_OFF
 (
upd©e
, 
UPDATE_OUT
);

612 
TERM_DEBUG_ON
 (
upd©e
, 
UPDATE_IN
);

613 
vty_out
 (
vty
, "BGP upd©e†debuggög i†⁄ (öbound)%s", 
VTY_NEWLINE
);

617 
TERM_DEBUG_OFF
 (
upd©e
, 
UPDATE_IN
);

618 
TERM_DEBUG_ON
 (
upd©e
, 
UPDATE_OUT
);

619 
vty_out
 (
vty
, "BGP upd©e†debuggög i†⁄ (outbound)%s", 
VTY_NEWLINE
);

622  
	gCMD_SUCCESS
;

625 
DEFUN
 (
no_debug_bgp_upd©e
,

626 
no_debug_bgp_upd©e_cmd
,

628 
NO_STR


629 
DEBUG_STR


630 
BGP_STR


633 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

635 
DEBUG_OFF
 (
upd©e
, 
UPDATE_IN
);

636 
DEBUG_OFF
 (
upd©e
, 
UPDATE_OUT
);

640 
TERM_DEBUG_OFF
 (
upd©e
, 
UPDATE_IN
);

641 
TERM_DEBUG_OFF
 (
upd©e
, 
UPDATE_OUT
);

642 
vty_out
 (
vty
, "BGP upd©e†debuggög i†off%s", 
VTY_NEWLINE
);

644  
	gCMD_SUCCESS
;

647 
ALIAS
 (
no_debug_bgp_upd©e
,

648 
undebug_bgp_upd©e_cmd
,

650 
UNDEBUG_STR


651 
BGP_STR


654 
DEFUN
 (
debug_bgp_n‹mÆ
,

655 
debug_bgp_n‹mÆ_cmd
,

657 
DEBUG_STR


658 
BGP_STR
)

660 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

661 
DEBUG_ON
 (
n‹mÆ
, 
NORMAL
);

664 
TERM_DEBUG_ON
 (
n‹mÆ
, 
NORMAL
);

665 
vty_out
 (
vty
, "BGP debuggög i†⁄%s", 
VTY_NEWLINE
);

667  
	gCMD_SUCCESS
;

670 
DEFUN
 (
no_debug_bgp_n‹mÆ
,

671 
no_debug_bgp_n‹mÆ_cmd
,

673 
NO_STR


674 
DEBUG_STR


675 
BGP_STR
)

677 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

678 
DEBUG_OFF
 (
n‹mÆ
, 
NORMAL
);

681 
TERM_DEBUG_OFF
 (
n‹mÆ
, 
NORMAL
);

682 
vty_out
 (
vty
, "BGP debuggög i†off%s", 
VTY_NEWLINE
);

684  
	gCMD_SUCCESS
;

687 
ALIAS
 (
no_debug_bgp_n‹mÆ
,

688 
undebug_bgp_n‹mÆ_cmd
,

690 
UNDEBUG_STR


691 
BGP_STR
)

693 
DEFUN
 (
debug_bgp_zebø
,

694 
debug_bgp_zebø_cmd
,

696 
DEBUG_STR


697 
BGP_STR


700 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

701 
DEBUG_ON
 (
zebø
, 
ZEBRA
);

704 
TERM_DEBUG_ON
 (
zebø
, 
ZEBRA
);

705 
vty_out
 (
vty
, "BGP zebø debuggög i†⁄%s", 
VTY_NEWLINE
);

707  
	gCMD_SUCCESS
;

710 
DEFUN
 (
no_debug_bgp_zebø
,

711 
no_debug_bgp_zebø_cmd
,

713 
NO_STR


714 
DEBUG_STR


715 
BGP_STR


718 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

719 
DEBUG_OFF
 (
zebø
, 
ZEBRA
);

722 
TERM_DEBUG_OFF
 (
zebø
, 
ZEBRA
);

723 
vty_out
 (
vty
, "BGP zebø debuggög i†off%s", 
VTY_NEWLINE
);

725  
	gCMD_SUCCESS
;

728 
ALIAS
 (
no_debug_bgp_zebø
,

729 
undebug_bgp_zebø_cmd
,

731 
UNDEBUG_STR


732 
BGP_STR


735 
DEFUN
 (
no_debug_bgp_Æl
,

736 
no_debug_bgp_Æl_cmd
,

738 
NO_STR


739 
DEBUG_STR


741 
BGP_STR
)

743 
TERM_DEBUG_OFF
 (
n‹mÆ
, 
NORMAL
);

744 
TERM_DEBUG_OFF
 (
evíts
, 
EVENTS
);

745 
TERM_DEBUG_OFF
 (
kì∑live
, 
KEEPALIVE
);

746 
TERM_DEBUG_OFF
 (
upd©e
, 
UPDATE_IN
);

747 
TERM_DEBUG_OFF
 (
upd©e
, 
UPDATE_OUT
);

748 
TERM_DEBUG_OFF
 (
as4
, 
AS4
);

749 
TERM_DEBUG_OFF
 (
as4
, 
AS4_SEGMENT
);

750 
TERM_DEBUG_OFF
 (
fsm
, 
FSM
);

751 
TERM_DEBUG_OFF
 (
fûãr
, 
FILTER
);

752 
TERM_DEBUG_OFF
 (
zebø
, 
ZEBRA
);

753 #ifde‡
USE_SRX


754 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_DETAIL
);

755 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_IN
);

756 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_OUT
);

758 
vty_out
 (
vty
, "AŒÖossibÀ debuggög ha†bì¿tu∫ed off%s", 
VTY_NEWLINE
);

760  
	gCMD_SUCCESS
;

763 #ifde‡
USE_SRX


764 
DEFUN
 (
debug_bgp_bgp£c
,

765 
debug_bgp_bgp£c_cmd
,

767 
DEBUG_STR


768 
BGP_STR


772 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

774 
DEBUG_ON
 (
bgp£c
, 
BGPSEC_DETAIL
);

775 
DEBUG_ON
 (
bgp£c
, 
BGPSEC_IN
);

776 
DEBUG_ON
 (
bgp£c
, 
BGPSEC_OUT
);

780 
TERM_DEBUG_ON
 (
bgp£c
, 
BGPSEC_DETAIL
);

781 
TERM_DEBUG_ON
 (
bgp£c
, 
BGPSEC_IN
);

782 
TERM_DEBUG_ON
 (
bgp£c
, 
BGPSEC_OUT
);

783 
vty_out
 (
vty
, "BGP bgp£¯debuggög i†⁄%s", 
VTY_NEWLINE
);

785  
	gCMD_SUCCESS
;

788 
DEFUN
 (
debug_bgp_bgp£c_dúe˘
,

789 
debug_bgp_bgp£c_dúe˘_cmd
,

791 
DEBUG_STR


792 
BGP_STR


797 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

799 i‡(
°∫cmp
 ("i", 
¨gv
[0], 1) == 0)

801 
DEBUG_OFF
 (
bgp£c
, 
BGPSEC_OUT
);

802 
DEBUG_ON
 (
bgp£c
, 
BGPSEC_IN
);

806 
DEBUG_OFF
 (
bgp£c
, 
BGPSEC_IN
);

807 
DEBUG_ON
 (
bgp£c
, 
BGPSEC_OUT
);

812 i‡(
°∫cmp
 ("i", 
¨gv
[0], 1) == 0)

814 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_OUT
);

815 
TERM_DEBUG_ON
 (
bgp£c
, 
BGPSEC_IN
);

816 
vty_out
 (
vty
, "BGP bgp£¯ debuggög i†⁄ (öbound)%s", 
VTY_NEWLINE
);

820 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_IN
);

821 
TERM_DEBUG_ON
 (
bgp£c
, 
BGPSEC_OUT
);

822 
vty_out
 (
vty
, "BGP bgp£¯debuggög i†⁄ (outbound)%s", 
VTY_NEWLINE
);

825  
	gCMD_SUCCESS
;

828 
DEFUN
 (
debug_bgp_bgp£c_dëaû
,

829 
debug_bgp_bgp£c_dëaû_cmd
,

831 
DEBUG_STR


832 
BGP_STR


836 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

838 
DEBUG_ON
 (
bgp£c
, 
BGPSEC_DETAIL
);

842 
TERM_DEBUG_ON
 (
bgp£c
, 
BGPSEC_DETAIL
);

843 
vty_out
 (
vty
, "BGP bgp£¯dëaûed debuggög i†⁄%s", 
VTY_NEWLINE
);

845  
	gCMD_SUCCESS
;

848 
DEFUN
 (
no_debug_bgp_bgp£c_dëaû
,

849 
no_debug_bgp_bgp£c_dëaû_cmd
,

851 
NO_STR


852 
DEBUG_STR


853 
BGP_STR


856 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

858 
DEBUG_OFF
 (
bgp£c
, 
BGPSEC_DETAIL
);

862 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_DETAIL
);

863 
vty_out
 (
vty
, "BGP bgp£¯dëaûed debuggög i†off%s", 
VTY_NEWLINE
);

865  
	gCMD_SUCCESS
;

868 
DEFUN
 (
no_debug_bgp_bgp£c
,

869 
no_debug_bgp_bgp£c_cmd
,

871 
NO_STR


872 
DEBUG_STR


873 
BGP_STR


876 i‡(
	gvty
->
	gnode
 =
CONFIG_NODE
)

878 
DEBUG_OFF
 (
bgp£c
, 
BGPSEC_DETAIL
);

879 
DEBUG_OFF
 (
bgp£c
, 
BGPSEC_IN
);

880 
DEBUG_OFF
 (
bgp£c
, 
BGPSEC_OUT
);

884 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_DETAIL
);

885 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_IN
);

886 
TERM_DEBUG_OFF
 (
bgp£c
, 
BGPSEC_OUT
);

887 
vty_out
 (
vty
, "BGP bgp£¯debuggög i†off%s", 
VTY_NEWLINE
);

889  
	gCMD_SUCCESS
;

894 
ALIAS
 (
no_debug_bgp_Æl
,

895 
undebug_bgp_Æl_cmd
,

897 
UNDEBUG_STR


899 
BGP_STR
)

901 
DEFUN
 (
show_debuggög_bgp
,

902 
show_debuggög_bgp_cmd
,

904 
SHOW_STR


905 
DEBUG_STR


906 
BGP_STR
)

908 
vty_out
 (
vty
, "BGP debuggög sètus:%s", 
VTY_NEWLINE
);

910 i‡(
BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

911 
vty_out
 (
vty
, " BGP debuggög i†⁄%s", 
VTY_NEWLINE
);

912 i‡(
BGP_DEBUG
 (
evíts
, 
EVENTS
))

913 
vty_out
 (
vty
, " BGPÉvít†debuggög i†⁄%s", 
VTY_NEWLINE
);

914 i‡(
BGP_DEBUG
 (
kì∑live
, 
KEEPALIVE
))

915 
vty_out
 (
vty
, " BGP kì∑live†debuggög i†⁄%s", 
VTY_NEWLINE
);

916 i‡(
BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
Ë&& BGP_DEBUG (upd©e, 
UPDATE_OUT
))

917 
vty_out
 (
vty
, " BGP upd©e†debuggög i†⁄%s", 
VTY_NEWLINE
);

918 i‡(
BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

919 
vty_out
 (
vty
, " BGP upd©e†debuggög i†⁄ (öbound)%s", 
VTY_NEWLINE
);

920 i‡(
BGP_DEBUG
 (
upd©e
, 
UPDATE_OUT
))

921 
vty_out
 (
vty
, " BGP upd©e†debuggög i†⁄ (outbound)%s", 
VTY_NEWLINE
);

922 i‡(
BGP_DEBUG
 (
fsm
, 
FSM
))

923 
vty_out
 (
vty
, " BGP fsm debuggög i†⁄%s", 
VTY_NEWLINE
);

924 i‡(
BGP_DEBUG
 (
fûãr
, 
FILTER
))

925 
vty_out
 (
vty
, " BGP fûã∏debuggög i†⁄%s", 
VTY_NEWLINE
);

926 i‡(
BGP_DEBUG
 (
zebø
, 
ZEBRA
))

927 
vty_out
 (
vty
, " BGP zebø debuggög i†⁄%s", 
VTY_NEWLINE
);

928 i‡(
BGP_DEBUG
 (
as4
, 
AS4
))

929 
vty_out
 (
vty
, " BGPás4 debuggög i†⁄%s", 
VTY_NEWLINE
);

930 i‡(
BGP_DEBUG
 (
as4
, 
AS4_SEGMENT
))

931 
vty_out
 (
vty
, " BGPás4á•©h segmíàdebuggög i†⁄%s", 
VTY_NEWLINE
);

932 #ifde‡
USE_SRX


933 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
Ë&& (BGP_DEBUG (bgp£c, 
BGPSEC_IN
)Ë&& (BGP_DEBUG (bgp£c, 
BGPSEC_OUT
)))

935 
vty_out
 (
vty
, " BGP bgp£¯debuggög i†Æ»⁄ %s", 
VTY_NEWLINE
);

936 
	gBGPSEC_di•œy_d⁄e
;

938 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
))

939 
vty_out
 (
vty
, " BGP bgp£¯debuggög i†⁄ (öbound)%s", 
VTY_NEWLINE
);

941 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
))

942 
vty_out
 (
vty
, " BGP bgp£¯debuggög i†⁄ (outbound)%s", 
VTY_NEWLINE
);

944 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

945 
vty_out
 (
vty
, " BGP bgp£¯debuggög i†⁄ (dëaû)%s", 
VTY_NEWLINE
);

946 
	gBGPSEC_di•œy_d⁄e
:

948 
vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

949  
	gCMD_SUCCESS
;

953 
	$bgp_c⁄fig_wrôe_debug
 (
vty
 *vty)

955 
wrôe
 = 0;

957 i‡(
	`CONF_BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

959 
	`vty_out
 (
vty
, "debug bgp%s", 
VTY_NEWLINE
);

960 
wrôe
++;

963 i‡(
	`CONF_BGP_DEBUG
 (
as4
, 
AS4
))

965 
	`vty_out
 (
vty
, "debug bg∞as4%s", 
VTY_NEWLINE
);

966 
wrôe
++;

969 i‡(
	`CONF_BGP_DEBUG
 (
as4
, 
AS4_SEGMENT
))

971 
	`vty_out
 (
vty
, "debug bg∞as4 segmít%s", 
VTY_NEWLINE
);

972 
wrôe
++;

975 i‡(
	`CONF_BGP_DEBUG
 (
evíts
, 
EVENTS
))

977 
	`vty_out
 (
vty
, "debug bg∞evíts%s", 
VTY_NEWLINE
);

978 
wrôe
++;

981 i‡(
	`CONF_BGP_DEBUG
 (
kì∑live
, 
KEEPALIVE
))

983 
	`vty_out
 (
vty
, "debug bg∞kì∑lives%s", 
VTY_NEWLINE
);

984 
wrôe
++;

987 i‡(
	`CONF_BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
Ë&& CONF_BGP_DEBUG (upd©e, 
UPDATE_OUT
))

989 
	`vty_out
 (
vty
, "debug bg∞upd©es%s", 
VTY_NEWLINE
);

990 
wrôe
++;

992 i‡(
	`CONF_BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

994 
	`vty_out
 (
vty
, "debug bg∞upd©e†ö%s", 
VTY_NEWLINE
);

995 
wrôe
++;

997 i‡(
	`CONF_BGP_DEBUG
 (
upd©e
, 
UPDATE_OUT
))

999 
	`vty_out
 (
vty
, "debug bg∞upd©e†out%s", 
VTY_NEWLINE
);

1000 
wrôe
++;

1003 i‡(
	`CONF_BGP_DEBUG
 (
fsm
, 
FSM
))

1005 
	`vty_out
 (
vty
, "debug bg∞fsm%s", 
VTY_NEWLINE
);

1006 
wrôe
++;

1009 i‡(
	`CONF_BGP_DEBUG
 (
fûãr
, 
FILTER
))

1011 
	`vty_out
 (
vty
, "debug bg∞fûãrs%s", 
VTY_NEWLINE
);

1012 
wrôe
++;

1015 i‡(
	`CONF_BGP_DEBUG
 (
zebø
, 
ZEBRA
))

1017 
	`vty_out
 (
vty
, "debug bg∞zebø%s", 
VTY_NEWLINE
);

1018 
wrôe
++;

1020 #ifde‡
USE_SRX


1021 i‡(
	`CONF_BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
Ë&& CONF_BGP_DEBUG (bgp£c, 
BGPSEC_IN
)

1022 && 
	`CONF_BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
))

1024 
	`vty_out
 (
vty
, "debug bg∞bgp£c%s", 
VTY_NEWLINE
);

1025 
wrôe
++;

1027 i‡(
	`CONF_BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
))

1029 
	`vty_out
 (
vty
, "debug bg∞bgp£¯ö%s", 
VTY_NEWLINE
);

1030 
wrôe
++;

1032 i‡(
	`CONF_BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
))

1034 
	`vty_out
 (
vty
, "debug bg∞bgp£¯out%s", 
VTY_NEWLINE
);

1035 
wrôe
++;

1037 i‡(
	`CONF_BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

1039 
	`vty_out
 (
vty
, "debug bg∞bgp£¯dëaû%s", 
VTY_NEWLINE
);

1040 
wrôe
++;

1043  
wrôe
;

1044 
	}
}

1046 
cmd_node
 
	gdebug_node
 =

1048 
DEBUG_NODE
,

1054 
	$bgp_debug_öô
 ()

1056 
	`ö°Æl_node
 (&
debug_node
, 
bgp_c⁄fig_wrôe_debug
);

1058 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_debuggög_bgp_cmd
);

1060 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_as4_cmd
);

1061 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_as4_cmd
);

1062 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_as4_£gmít_cmd
);

1063 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_as4_£gmít_cmd
);

1065 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_fsm_cmd
);

1066 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_fsm_cmd
);

1067 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_evíts_cmd
);

1068 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_evíts_cmd
);

1069 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_fûãr_cmd
);

1070 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_fûãr_cmd
);

1071 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_kì∑live_cmd
);

1072 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_kì∑live_cmd
);

1073 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_upd©e_cmd
);

1074 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_upd©e_cmd
);

1075 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_upd©e_dúe˘_cmd
);

1076 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_upd©e_dúe˘_cmd
);

1077 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_n‹mÆ_cmd
);

1078 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_n‹mÆ_cmd
);

1079 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_zebø_cmd
);

1080 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_zebø_cmd
);

1082 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_as4_cmd
);

1083 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_as4_cmd
);

1084 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_as4_cmd
);

1085 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_as4_£gmít_cmd
);

1086 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_as4_£gmít_cmd
);

1087 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_as4_£gmít_cmd
);

1089 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_fsm_cmd
);

1090 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_fsm_cmd
);

1091 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_fsm_cmd
);

1092 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_evíts_cmd
);

1093 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_evíts_cmd
);

1094 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_evíts_cmd
);

1095 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_fûãr_cmd
);

1096 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_fûãr_cmd
);

1097 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_fûãr_cmd
);

1098 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_kì∑live_cmd
);

1099 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_kì∑live_cmd
);

1100 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_kì∑live_cmd
);

1101 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_upd©e_cmd
);

1102 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_upd©e_cmd
);

1103 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_upd©e_cmd
);

1104 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_n‹mÆ_cmd
);

1105 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_n‹mÆ_cmd
);

1106 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_n‹mÆ_cmd
);

1107 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_zebø_cmd
);

1108 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_zebø_cmd
);

1109 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_zebø_cmd
);

1110 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_Æl_cmd
);

1111 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
undebug_bgp_Æl_cmd
);

1112 #ifde‡
USE_SRX


1113 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_bgp£c_cmd
);

1114 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_bgp£c_cmd
);

1116 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_bgp£c_cmd
);

1117 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_bgp£c_cmd
);

1119 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_bgp£c_dúe˘_cmd
);

1120 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_bgp£c_dúe˘_cmd
);

1122 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_bgp_bgp£c_dëaû_cmd
);

1123 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_bgp_bgp£c_dëaû_cmd
);

1125 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_bgp_bgp£c_dëaû_cmd
);

1126 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_bgp_bgp£c_dëaû_cmd
);

1128 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_debug.h

21 #i‚de‡
_QUAGGA_BGP_DEBUG_H


22 
	#_QUAGGA_BGP_DEBUG_H


	)

24 
	~"bgp_©å.h
"

27 
	#DUMP_ON
 1

	)

28 
	#DUMP_SEND
 2

	)

29 
	#DUMP_RECV
 4

	)

32 
	#DUMP_WITHDRAW
 8

	)

33 
	#DUMP_NLRI
 16

	)

36 
	#DUMP_DETAIL
 32

	)

38 
dump_›í
;

39 
dump_upd©e
;

40 
dump_kì∑live
;

41 
dump_nŸify
;

43 
Debug_Evít
;

44 
Debug_Kì∑live
;

45 
Debug_Upd©e
;

46 
Debug_Radix
;

48 
	#NLRI
 1

	)

49 
	#WITHDRAW
 2

	)

50 
	#NO_OPT
 3

	)

51 
	#SEND
 4

	)

52 
	#RECV
 5

	)

53 
	#DETAIL
 6

	)

56 
bgp_debug_öô
 ();

57 
bgp_∑ckë_dump
 (
°ªam
 *);

59 
debug
 (
›ti⁄
);

61 
c⁄f_bgp_debug_as4
;

62 
c⁄f_bgp_debug_fsm
;

63 
c⁄f_bgp_debug_evíts
;

64 
c⁄f_bgp_debug_∑ckë
;

65 
c⁄f_bgp_debug_fûãr
;

66 
c⁄f_bgp_debug_kì∑live
;

67 
c⁄f_bgp_debug_upd©e
;

68 
c⁄f_bgp_debug_n‹mÆ
;

69 
c⁄f_bgp_debug_zebø
;

71 
ãrm_bgp_debug_as4
;

72 
ãrm_bgp_debug_fsm
;

73 
ãrm_bgp_debug_evíts
;

74 
ãrm_bgp_debug_∑ckë
;

75 
ãrm_bgp_debug_fûãr
;

76 
ãrm_bgp_debug_kì∑live
;

77 
ãrm_bgp_debug_upd©e
;

78 
ãrm_bgp_debug_n‹mÆ
;

79 
ãrm_bgp_debug_zebø
;

80 #ifde‡
USE_SRX


81 
ãrm_bgp_debug_bgp£c
;

84 
	#BGP_DEBUG_AS4
 0x01

	)

85 
	#BGP_DEBUG_AS4_SEGMENT
 0x02

	)

87 
	#BGP_DEBUG_FSM
 0x01

	)

88 
	#BGP_DEBUG_EVENTS
 0x01

	)

89 
	#BGP_DEBUG_PACKET
 0x01

	)

90 
	#BGP_DEBUG_FILTER
 0x01

	)

91 
	#BGP_DEBUG_KEEPALIVE
 0x01

	)

92 
	#BGP_DEBUG_UPDATE_IN
 0x01

	)

93 
	#BGP_DEBUG_UPDATE_OUT
 0x02

	)

94 
	#BGP_DEBUG_NORMAL
 0x01

	)

95 
	#BGP_DEBUG_ZEBRA
 0x01

	)

96 #ifde‡
USE_SRX


97 
	#BGP_DEBUG_BGPSEC_DETAIL
 0x01

	)

98 
	#BGP_DEBUG_BGPSEC
 0x01

99 
	#BGP_DEBUG_BGPSEC_IN
 0x02

	)

100 
	#BGP_DEBUG_BGPSEC_OUT
 0x04

	)

103 
	#BGP_DEBUG_PACKET_SEND
 0x01

	)

104 
	#BGP_DEBUG_PACKET_SEND_DETAIL
 0x02

	)

106 
	#BGP_DEBUG_PACKET_RECV
 0x01

	)

107 
	#BGP_DEBUG_PACKET_RECV_DETAIL
 0x02

	)

109 
	#CONF_DEBUG_ON
(
a
, 
b
Ë(
c⁄f_bgp_debug_
 ##á |(
BGP_DEBUG_
 ## b))

	)

110 
	#CONF_DEBUG_OFF
(
a
, 
b
Ë(
c⁄f_bgp_debug_
 ##á &~(
BGP_DEBUG_
 ## b))

	)

112 
	#TERM_DEBUG_ON
(
a
, 
b
Ë(
ãrm_bgp_debug_
 ##á |(
BGP_DEBUG_
 ## b))

	)

113 
	#TERM_DEBUG_OFF
(
a
, 
b
Ë(
ãrm_bgp_debug_
 ##á &~(
BGP_DEBUG_
 ## b))

	)

115 
	#DEBUG_ON
(
a
, 
b
) \

117 
	`CONF_DEBUG_ON
(
a
, 
b
); \

118 
	`TERM_DEBUG_ON
(
a
, 
b
); \

119 } 0)

	)

120 
	#DEBUG_OFF
(
a
, 
b
) \

122 
	`CONF_DEBUG_OFF
(
a
, 
b
); \

123 
	`TERM_DEBUG_OFF
(
a
, 
b
); \

124 } 0)

	)

126 
	#BGP_DEBUG
(
a
, 
b
Ë(
ãrm_bgp_debug_
 ##á & 
BGP_DEBUG_
 ## b)

	)

127 
	#CONF_BGP_DEBUG
(
a
, 
b
Ë(
c⁄f_bgp_debug_
 ##á & 
BGP_DEBUG_
 ## b)

	)

129 c⁄° *
bgp_ty≥_°r
[];

131 
bgp_dump_©å
 (
≥î
 *, 
©å
 *, *, 
size_t
);

132 
bgp_nŸify_¥öt
 (
≥î
 *, 
bgp_nŸify
 *, const *);

134 c⁄° 
mesßge
 
bgp_°©us_msg
[];

135 c⁄° 
bgp_°©us_msg_max
;

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_dump.c

21 
	~<zebø.h
>

23 
	~"log.h
"

24 
	~"°ªam.h
"

25 
	~"sockuni⁄.h
"

26 
	~"comm™d.h
"

27 
	~"¥efix.h
"

28 
	~"thªad.h
"

29 
	~"lökli°.h
"

30 
	~"bgpd/bgp_èbÀ.h
"

32 
	~"bgpd/bgpd.h
"

33 
	~"bgpd/bgp_rouã.h
"

34 
	~"bgpd/bgp_©å.h
"

35 
	~"bgpd/bgp_dump.h
"

37 
	ebgp_dump_ty≥


39 
	mBGP_DUMP_ALL
,

40 
	mBGP_DUMP_UPDATES
,

41 
	mBGP_DUMP_ROUTES


44 
	eMRT_MSG_TYPES
 {

45 
	mMSG_NULL
,

46 
	mMSG_START
,

47 
	mMSG_DIE
,

48 
	mMSG_I_AM_DEAD
,

49 
	mMSG_PEER_DOWN
,

50 
	mMSG_PROTOCOL_BGP
,

51 
	mMSG_PROTOCOL_RIP
,

52 
	mMSG_PROTOCOL_IDRP
,

53 
	mMSG_PROTOCOL_RIPNG
,

54 
	mMSG_PROTOCOL_BGP4PLUS
,

55 
	mMSG_PROTOCOL_BGP4PLUS_01
,

56 
	mMSG_PROTOCOL_OSPF
,

57 
	mMSG_TABLE_DUMP
,

58 
	mMSG_TABLE_DUMP_V2


61 
bgp_dump_öãrvÆ_func
 (
thªad
 *);

63 
	sbgp_dump


65 
bgp_dump_ty≥
 
	mty≥
;

67 *
	mfûíame
;

69 
FILE
 *
	mÂ
;

71 
	möãrvÆ
;

73 *
	möãrvÆ_°r
;

75 
thªad
 *
	mt_öãrvÆ
;

79 
°ªam
 *
	gbgp_dump_obuf
;

82 
bgp_dump
 
	gbgp_dump_Æl
;

85 
bgp_dump
 
	gbgp_dump_upd©es
;

88 
bgp_dump
 
	gbgp_dump_rouãs
;

91 
thªad
 *
	gt_bgp_dump_rouãs
;

94 
FILE
 *

95 
	$bgp_dump_›í_fûe
 (
bgp_dump
 *bgp_dump)

97 
ªt
;

98 
time_t
 
˛ock
;

99 
tm
 *tm;

100 
fuŒ∑th
[
MAXPATHLEN
];

101 
ªÆ∑th
[
MAXPATHLEN
];

102 
mode_t
 
ﬁdumask
;

104 
	`time
 (&
˛ock
);

105 
tm
 = 
	`loˇ…ime
 (&
˛ock
);

107 i‡(
bgp_dump
->
fûíame
[0] !
DIRECTORY_SEP
)

109 
	`•rötf
 (
fuŒ∑th
, "%s/%s", 
	`vty_gë_cwd
 (), 
bgp_dump
->
fûíame
);

110 
ªt
 = 
	`°r·ime
 (
ªÆ∑th
, 
MAXPATHLEN
, 
fuŒ∑th
, 
tm
);

113 
ªt
 = 
	`°r·ime
 (
ªÆ∑th
, 
MAXPATHLEN
, 
bgp_dump
->
fûíame
, 
tm
);

115 i‡(
ªt
 == 0)

117 
	`zlog_w¨n
 ("bgp_dump_open_file: strftimeÉrror");

118  
NULL
;

121 i‡(
bgp_dump
->
Â
)

122 
	`f˛o£
 (
bgp_dump
->
Â
);

125 
ﬁdumask
 = 
	`umask
(0777 & ~
LOGFILE_MASK
);

126 
bgp_dump
->
Â
 = 
	`f›í
 (
ªÆ∑th
, "w");

128 i‡(
bgp_dump
->
Â
 =
NULL
)

130 
	`zlog_w¨n
 ("bgp_dump_›í_fûe: %s: %s", 
ªÆ∑th
, 
	`°ªº‹
 (
î∫o
));

131 
	`umask
(
ﬁdumask
);

132  
NULL
;

134 
	`umask
(
ﬁdumask
);

136  
bgp_dump
->
Â
;

137 
	}
}

140 
	$bgp_dump_öãrvÆ_add
 (
bgp_dump
 *bgp_dump, 
öãrvÆ
)

142 
£cs_öto_day
;

143 
time_t
 
t
;

144 
tm
 *tm;

146 i‡(
öãrvÆ
 > 0)

149 i‡((
öãrvÆ
 < 86400) && ((86400 % interval) == 0))

154 (Ë
	`time
(&
t
);

155 
tm
 = 
	`loˇ…ime
(&
t
);

156 
£cs_öto_day
 = 
tm
->
tm_£c
 + 60*tm->
tm_mö
 + 60*60*tm->
tm_hour
;

157 
öãrvÆ
 = i¡îvÆ - 
£cs_öto_day
 % interval;

159 
bgp_dump
->
t_öãrvÆ
 = 
	`thªad_add_timî
 (
ma°î
, 
bgp_dump_öãrvÆ_func
,

160 
bgp_dump
, 
öãrvÆ
);

165 
bgp_dump
->
t_öãrvÆ
 = 
	`thªad_add_evít
 (
ma°î
, 
bgp_dump_öãrvÆ_func
,

166 
bgp_dump
, 0);

170 
	}
}

174 
	$bgp_dump_hódî
 (
°ªam
 *
obuf
, 
ty≥
, 
subty≥
)

176 
time_t
 
now
;

179 
	`time
 (&
now
);

182 
	`°ªam_pué
 (
obuf
, 
now
);

183 
	`°ªam_putw
 (
obuf
, 
ty≥
);

184 
	`°ªam_putw
 (
obuf
, 
subty≥
);

186 
	`°ªam_pué
 (
obuf
, 0);

187 
	}
}

190 
	$bgp_dump_£t_size
 (
°ªam
 *
s
, 
ty≥
)

192 
	`°ªam_pué_©
 (
s
, 8, 
	`°ªam_gë_ídp
 (sË- 
BGP_DUMP_HEADER_SIZE
);

193 
	}
}

196 
	$bgp_dump_rouãs_ödex_èbÀ
(
bgp
 *bgp)

198 
≥î
 *peer;

199 
li°node
 *
node
;

200 
uöt16_t
 
≥îno
 = 0;

201 
°ªam
 *
obuf
;

203 
obuf
 = 
bgp_dump_obuf
;

204 
	`°ªam_ª£t
 (
obuf
);

207 
	`bgp_dump_hódî
 (
obuf
, 
MSG_TABLE_DUMP_V2
, 
TABLE_DUMP_V2_PEER_INDEX_TABLE
);

210 
	`°ªam_put_ö_addr
 (
obuf
, &
bgp
->
rouãr_id
);

213 if(
bgp
->
«me
)

215 
	`°ªam_putw
 (
obuf
, 
	`°æí
(
bgp
->
«me
));

216 
	`°ªam_put
(
obuf
, 
bgp
->
«me
, 
	`°æí
(bgp->name));

220 
	`°ªam_putw
(
obuf
, 0);

224 
	`°ªam_putw
 (
obuf
, 
	`li°cou¡
(
bgp
->
≥î
));

227 
	`ALL_LIST_ELEMENTS_RO
 (
bgp
->
≥î
, 
node
,Öeer))

231 i‡(
	`sockuni⁄_Ámûy
(&
≥î
->
su
Ë=
AF_INET
)

233 
	`°ªam_putc
 (
obuf
, 
TABLE_DUMP_V2_PEER_INDEX_TABLE_AS4
+
TABLE_DUMP_V2_PEER_INDEX_TABLE_IP
);

235 #ifde‡
HAVE_IPV6


236 i‡(
	`sockuni⁄_Ámûy
(&
≥î
->
su
Ë=
AF_INET6
)

238 
	`°ªam_putc
 (
obuf
, 
TABLE_DUMP_V2_PEER_INDEX_TABLE_AS4
+
TABLE_DUMP_V2_PEER_INDEX_TABLE_IP6
);

243 
	`°ªam_put_ö_addr
 (
obuf
, &
≥î
->
ªmŸe_id
);

246 i‡(
	`sockuni⁄_Ámûy
(&
≥î
->
su
Ë=
AF_INET
)

248 
	`°ªam_put_ö_addr
 (
obuf
, &
≥î
->
su
.
sö
.
sö_addr
);

250 #ifde‡
HAVE_IPV6


251 i‡(
	`sockuni⁄_Ámûy
(&
≥î
->
su
Ë=
AF_INET6
)

253 
	`°ªam_wrôe
 (
obuf
, (
u_ch¨
 *)&
≥î
->
su
.
sö6
.
sö6_addr
,

254 
IPV6_MAX_BYTELEN
);

260 
	`°ªam_pué
 (
obuf
, 
≥î
->
as
);

263 
≥î
->
èbÀ_dump_ödex
 = 
≥îno
;

264 
≥îno
++;

267 
	`bgp_dump_£t_size
(
obuf
, 
MSG_TABLE_DUMP_V2
);

269 
	`fwrôe
 (
	`STREAM_DATA
 (
obuf
), 
	`°ªam_gë_ídp
 (obuf), 1, 
bgp_dump_rouãs
.
Â
);

270 
	`fÊush
 (
bgp_dump_rouãs
.
Â
);

271 
	}
}

276 
	$bgp_dump_rouãs_func
 (
afi
, 
fú°_run
, 
£q
)

278 
°ªam
 *
obuf
;

279 
bgp_öfo
 *
öfo
;

280 
bgp_node
 *
∫
;

281 
bgp
 *bgp;

282 
bgp_èbÀ
 *
èbÀ
;

284 
bgp
 = 
	`bgp_gë_deÁu…
 ();

285 i‡(!
bgp
)

286  
£q
;

288 i‡(
bgp_dump_rouãs
.
Â
 =
NULL
)

289  
£q
;

294 if(
fú°_run
)

295 
	`bgp_dump_rouãs_ödex_èbÀ
(
bgp
);

297 
obuf
 = 
bgp_dump_obuf
;

298 
	`°ªam_ª£t
(
obuf
);

301 
èbÀ
 = 
bgp
->
rib
[
afi
][
SAFI_UNICAST
];

303 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

305 if(!
∫
->
öfo
)

308 
	`°ªam_ª£t
(
obuf
);

311 i‡(
afi
 =
AFI_IP
)

313 
	`bgp_dump_hódî
 (
obuf
, 
MSG_TABLE_DUMP_V2
, 
TABLE_DUMP_V2_RIB_IPV4_UNICAST
);

315 #ifde‡
HAVE_IPV6


316 i‡(
afi
 =
AFI_IP6
)

318 
	`bgp_dump_hódî
 (
obuf
, 
MSG_TABLE_DUMP_V2
, 
TABLE_DUMP_V2_RIB_IPV6_UNICAST
);

323 
	`°ªam_pué
(
obuf
, 
£q
);

326 
	`°ªam_putc
 (
obuf
, 
∫
->
p
.
¥efixÀn
);

329 i‡(
afi
 =
AFI_IP
)

332 
	`°ªam_wrôe
(
obuf
, (
u_ch¨
 *)&
∫
->
p
.
u
.
¥efix4
, (∫->p.
¥efixÀn
+7)/8);

334 #ifde‡
HAVE_IPV6


335 i‡(
afi
 =
AFI_IP6
)

338 
	`°ªam_wrôe
 (
obuf
, (
u_ch¨
 *)&
∫
->
p
.
u
.
¥efix6
, (∫->p.
¥efixÀn
+7)/8);

343 
sizï
 = 
	`°ªam_gë_ídp
(
obuf
);

346 
uöt16_t
 
íåy_cou¡
 = 0;

349 
	`°ªam_putw
(
obuf
, 0);

351 
öfo
 = 
∫
->öfo; info; infÿöfo->
√xt
)

353 
íåy_cou¡
++;

356 
	`°ªam_putw
(
obuf
, 
öfo
->
≥î
->
èbÀ_dump_ödex
);

359 #ifde‡
HAVE_CLOCK_MONOTONIC


360 
	`°ªam_pué
 (
obuf
, 
	`time
(
NULL
Ë- (
	`bgp_˛ock
(Ë- 
öfo
->
u±ime
));

362 
	`°ªam_pué
 (
obuf
, 
öfo
->
u±ime
);

367 
	`bgp_dump_rouãs_©å
 (
obuf
, 
öfo
->
©å
, &
∫
->
p
);

371 
	`°ªam_putw_©
 (
obuf
, 
sizï
, 
íåy_cou¡
);

373 
£q
++;

375 
	`bgp_dump_£t_size
(
obuf
, 
MSG_TABLE_DUMP_V2
);

376 
	`fwrôe
 (
	`STREAM_DATA
 (
obuf
), 
	`°ªam_gë_ídp
 (obuf), 1, 
bgp_dump_rouãs
.
Â
);

380 
	`fÊush
 (
bgp_dump_rouãs
.
Â
);

382  
£q
;

383 
	}
}

386 
	$bgp_dump_öãrvÆ_func
 (
thªad
 *
t
)

388 
bgp_dump
 *bgp_dump;

389 
bgp_dump
 = 
	`THREAD_ARG
 (
t
);

390 
bgp_dump
->
t_öãrvÆ
 = 
NULL
;

393 i‡(
	`bgp_dump_›í_fûe
 (
bgp_dump
Ë!
NULL
)

396 i‡(
bgp_dump
->
ty≥
 =
BGP_DUMP_ROUTES
)

398 
£q
 = 
	`bgp_dump_rouãs_func
 (
AFI_IP
, 1, 0);

399 #ifde‡
HAVE_IPV6


400 
	`bgp_dump_rouãs_func
 (
AFI_IP6
, 0, 
£q
);

404 
	`f˛o£
(
bgp_dump
->
Â
); bgp_dump->Â = 
NULL
;

409 i‡(
bgp_dump
->
öãrvÆ
 > 0)

410 
	`bgp_dump_öãrvÆ_add
 (
bgp_dump
, bgp_dump->
öãrvÆ
);

413 
	}
}

417 
	$bgp_dump_comm⁄
 (
°ªam
 *
obuf
, 
≥î
 *≥î, 
f‹˚as4
)

419 
em±y
[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

422 i‡(
f‹˚as4
 || 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
) )

424 
	`°ªam_pué
 (
obuf
, 
≥î
->
as
);

425 
	`°ªam_pué
 (
obuf
, 
≥î
->
loˇl_as
);

429 
	`°ªam_putw
 (
obuf
, 
≥î
->
as
);

430 
	`°ªam_putw
 (
obuf
, 
≥î
->
loˇl_as
);

433 i‡(
≥î
->
su
.
ß
.
ß_Ámûy
 =
AF_INET
)

435 
	`°ªam_putw
 (
obuf
, 
≥î
->
ifödex
);

436 
	`°ªam_putw
 (
obuf
, 
AFI_IP
);

438 
	`°ªam_put
 (
obuf
, &
≥î
->
su
.
sö
.
sö_addr
, 
IPV4_MAX_BYTELEN
);

440 i‡(
≥î
->
su_loˇl
)

441 
	`°ªam_put
 (
obuf
, &
≥î
->
su_loˇl
->
sö
.
sö_addr
, 
IPV4_MAX_BYTELEN
);

443 
	`°ªam_put
 (
obuf
, 
em±y
, 
IPV4_MAX_BYTELEN
);

445 #ifde‡
HAVE_IPV6


446 i‡(
≥î
->
su
.
ß
.
ß_Ámûy
 =
AF_INET6
)

449 
	`°ªam_putw
 (
obuf
, 
≥î
->
ifödex
);

450 
	`°ªam_putw
 (
obuf
, 
AFI_IP6
);

453 
	`°ªam_put
 (
obuf
, &
≥î
->
su
.
sö6
.
sö6_addr
, 
IPV6_MAX_BYTELEN
);

455 i‡(
≥î
->
su_loˇl
)

456 
	`°ªam_put
 (
obuf
, &
≥î
->
su_loˇl
->
sö6
.
sö6_addr
, 
IPV6_MAX_BYTELEN
);

458 
	`°ªam_put
 (
obuf
, 
em±y
, 
IPV6_MAX_BYTELEN
);

461 
	}
}

465 
	$bgp_dump_°©e
 (
≥î
 *≥î, 
°©us_ﬁd
, 
°©us_√w
)

467 
°ªam
 *
obuf
;

470 i‡(
bgp_dump_Æl
.
Â
 =
NULL
)

474 
obuf
 = 
bgp_dump_obuf
;

475 
	`°ªam_ª£t
 (
obuf
);

477 
	`bgp_dump_hódî
 (
obuf
, 
MSG_PROTOCOL_BGP4MP
, 
BGP4MP_STATE_CHANGE_AS4
);

478 
	`bgp_dump_comm⁄
 (
obuf
, 
≥î
, 1);

480 
	`°ªam_putw
 (
obuf
, 
°©us_ﬁd
);

481 
	`°ªam_putw
 (
obuf
, 
°©us_√w
);

484 
	`bgp_dump_£t_size
 (
obuf
, 
MSG_PROTOCOL_BGP4MP
);

487 
	`fwrôe
 (
	`STREAM_DATA
 (
obuf
), 
	`°ªam_gë_ídp
 (obuf), 1, 
bgp_dump_Æl
.
Â
);

488 
	`fÊush
 (
bgp_dump_Æl
.
Â
);

489 
	}
}

492 
	$bgp_dump_∑ckë_func
 (
bgp_dump
 *bgp_dump, 
≥î
 *peer,

493 
°ªam
 *
∑ckë
)

495 
°ªam
 *
obuf
;

498 i‡(
bgp_dump
->
Â
 =
NULL
)

502 
obuf
 = 
bgp_dump_obuf
;

503 
	`°ªam_ª£t
 (
obuf
);

506 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
) )

508 
	`bgp_dump_hódî
 (
obuf
, 
MSG_PROTOCOL_BGP4MP
, 
BGP4MP_MESSAGE_AS4
);

512 
	`bgp_dump_hódî
 (
obuf
, 
MSG_PROTOCOL_BGP4MP
, 
BGP4MP_MESSAGE
);

514 
	`bgp_dump_comm⁄
 (
obuf
, 
≥î
, 0);

517 
	`°ªam_put
 (
obuf
, 
	`STREAM_DATA
 (
∑ckë
), 
	`°ªam_gë_ídp
 (packet));

520 
	`bgp_dump_£t_size
 (
obuf
, 
MSG_PROTOCOL_BGP4MP
);

523 
	`fwrôe
 (
	`STREAM_DATA
 (
obuf
), 
	`°ªam_gë_ídp
 (obuf), 1, 
bgp_dump
->
Â
);

524 
	`fÊush
 (
bgp_dump
->
Â
);

525 
	}
}

529 
	$bgp_dump_∑ckë
 (
≥î
 *≥î, 
ty≥
, 
°ªam
 *
∑ckë
)

532 
	`bgp_dump_∑ckë_func
 (&
bgp_dump_Æl
, 
≥î
, 
∑ckë
);

535 i‡(
ty≥
 =
BGP_MSG_UPDATE
)

536 
	`bgp_dump_∑ckë_func
 (&
bgp_dump_upd©es
, 
≥î
, 
∑ckë
);

537 
	}
}

540 
	$bgp_dump_∑r£_time
 (c⁄° *
°r
)

542 
i
;

543 
Àn
;

544 
£í_h
;

545 
£í_m
;

546 
time
;

547 
tŸÆ
;

549 
time
 = 0;

550 
tŸÆ
 = 0;

551 
£í_h
 = 0;

552 
£í_m
 = 0;

553 
Àn
 = 
	`°æí
 (
°r
);

555 
i
 = 0; i < 
Àn
; i++)

557 i‡(
	`isdigô
 ((Ë
°r
[
i
]))

559 
time
 *= 10;

560 
time
 +
°r
[
i
] - '0';

562 i‡(
°r
[
i
] == 'H' || str[i] == 'h')

564 i‡(
£í_h
)

566 i‡(
£í_m
)

568 
tŸÆ
 +
time
 * 60 *60;

569 
time
 = 0;

570 
£í_h
 = 1;

572 i‡(
°r
[
i
] == 'M' || str[i] == 'm')

574 i‡(
£í_m
)

576 
tŸÆ
 +
time
 * 60;

577 
time
 = 0;

578 
£í_h
 = 1;

583  
tŸÆ
 + 
time
;

584 
	}
}

587 
	$bgp_dump_£t
 (
vty
 *vty, 
bgp_dump
 *bgp_dump,

588 
bgp_dump_ty≥
 
ty≥
, c⁄° *
∑th
,

589 c⁄° *
öãrvÆ_°r
)

591 
öãrvÆ
;

593 i‡(
öãrvÆ_°r
)

597 
öãrvÆ
 = 
	`bgp_dump_∑r£_time
 (
öãrvÆ_°r
);

598 i‡(
öãrvÆ
 == 0)

600 
	`vty_out
 (
vty
, "MÆf‹med i¡îvÆ såög%s", 
VTY_NEWLINE
);

601  
CMD_WARNING
;

605 i‡(
öãrvÆ
 =
bgp_dump
->interval &&

606 
ty≥
 =
bgp_dump
->type &&

607 
∑th
 && 
bgp_dump
->
fûíame
 && !
	`°rcmp
 (path, bgp_dump->filename))

609  
CMD_SUCCESS
;

613 
bgp_dump
->
öãrvÆ
 = interval;

614 i‡(
bgp_dump
->
öãrvÆ_°r
)

615 
	`‰ì
 (
bgp_dump
->
öãrvÆ_°r
);

616 
bgp_dump
->
öãrvÆ_°r
 = 
	`°rdup
 (interval_str);

621 
öãrvÆ
 = 0;

625 
	`bgp_dump_öãrvÆ_add
 (
bgp_dump
, 
öãrvÆ
);

628 
bgp_dump
->
ty≥
 =Åype;

631 i‡(
bgp_dump
->
fûíame
)

632 
	`‰ì
 (
bgp_dump
->
fûíame
);

633 
bgp_dump
->
fûíame
 = 
	`°rdup
 (
∑th
);

636 
	`bgp_dump_›í_fûe
 (
bgp_dump
);

638  
CMD_SUCCESS
;

639 
	}
}

642 
	$bgp_dump_un£t
 (
vty
 *vty, 
bgp_dump
 *bgp_dump)

645 i‡(
bgp_dump
->
fûíame
)

647 
	`‰ì
 (
bgp_dump
->
fûíame
);

648 
bgp_dump
->
fûíame
 = 
NULL
;

652 i‡(
bgp_dump
->
Â
)

654 
	`f˛o£
 (
bgp_dump
->
Â
);

655 
bgp_dump
->
Â
 = 
NULL
;

659 i‡(
bgp_dump
->
t_öãrvÆ
)

661 
	`thªad_ˇn˚l
 (
bgp_dump
->
t_öãrvÆ
);

662 
bgp_dump
->
t_öãrvÆ
 = 
NULL
;

665 
bgp_dump
->
öãrvÆ
 = 0;

667 i‡(
bgp_dump
->
öãrvÆ_°r
)

669 
	`‰ì
 (
bgp_dump
->
öãrvÆ_°r
);

670 
bgp_dump
->
öãrvÆ_°r
 = 
NULL
;

674  
CMD_SUCCESS
;

675 
	}
}

677 
DEFUN
 (
dump_bgp_Æl
,

678 
dump_bgp_Æl_cmd
,

685  
bgp_dump_£t
 (
vty
, &
bgp_dump_Æl
, 
BGP_DUMP_ALL
, 
¨gv
[0], 
NULL
);

688 
DEFUN
 (
dump_bgp_Æl_öãrvÆ
,

689 
dump_bgp_Æl_öãrvÆ_cmd
,

697  
bgp_dump_£t
 (
vty
, &
bgp_dump_Æl
, 
BGP_DUMP_ALL
, 
¨gv
[0],árgv[1]);

700 
DEFUN
 (
no_dump_bgp_Æl
,

701 
no_dump_bgp_Æl_cmd
,

703 
NO_STR


708  
bgp_dump_un£t
 (
vty
, &
bgp_dump_Æl
);

711 
DEFUN
 (
dump_bgp_upd©es
,

712 
dump_bgp_upd©es_cmd
,

719  
bgp_dump_£t
 (
vty
, &
bgp_dump_upd©es
, 
BGP_DUMP_UPDATES
, 
¨gv
[0], 
NULL
);

722 
DEFUN
 (
dump_bgp_upd©es_öãrvÆ
,

723 
dump_bgp_upd©es_öãrvÆ_cmd
,

731  
bgp_dump_£t
 (
vty
, &
bgp_dump_upd©es
, 
BGP_DUMP_UPDATES
, 
¨gv
[0],árgv[1]);

734 
DEFUN
 (
no_dump_bgp_upd©es
,

735 
no_dump_bgp_upd©es_cmd
,

737 
NO_STR


742  
bgp_dump_un£t
 (
vty
, &
bgp_dump_upd©es
);

745 
DEFUN
 (
dump_bgp_rouãs
,

746 
dump_bgp_rouãs_cmd
,

753  
bgp_dump_£t
 (
vty
, &
bgp_dump_rouãs
, 
BGP_DUMP_ROUTES
, 
¨gv
[0], 
NULL
);

756 
DEFUN
 (
dump_bgp_rouãs_öãrvÆ
,

757 
dump_bgp_rouãs_öãrvÆ_cmd
,

765  
bgp_dump_£t
 (
vty
, &
bgp_dump_rouãs
, 
BGP_DUMP_ROUTES
, 
¨gv
[0],árgv[1]);

768 
DEFUN
 (
no_dump_bgp_rouãs
,

769 
no_dump_bgp_rouãs_cmd
,

771 
NO_STR


776  
bgp_dump_un£t
 (
vty
, &
bgp_dump_rouãs
);

780 
cmd_node
 
	gbgp_dump_node
 =

782 
DUMP_NODE
,

789 
	$c⁄fig_time2°r
 (
öãrvÆ
)

791 
buf
[
BUFSIZ
];

793 
buf
[0] = '\0';

795 i‡(
öãrvÆ
 / 3600)

797 
	`•rötf
 (
buf
, "%dh", 
öãrvÆ
 / 3600);

798 
öãrvÆ
 %= 3600;

800 i‡(
öãrvÆ
 / 60)

802 
	`•rötf
 (
buf
 + 
	`°æí
 (buf), "%dm", 
öãrvÆ
 /60);

803 
öãrvÆ
 %= 60;

805 i‡(
öãrvÆ
)

807 
	`•rötf
 (
buf
 + 
	`°æí
 (buf), "%d", 
öãrvÆ
);

809  
buf
;

810 
	}
}

814 
	$c⁄fig_wrôe_bgp_dump
 (
vty
 *vty)

816 i‡(
bgp_dump_Æl
.
fûíame
)

818 i‡(
bgp_dump_Æl
.
öãrvÆ_°r
)

819 
	`vty_out
 (
vty
, "dump bgpáll %s %s%s",

820 
bgp_dump_Æl
.
fûíame
, bgp_dump_Æl.
öãrvÆ_°r
,

821 
VTY_NEWLINE
);

823 
	`vty_out
 (
vty
, "dump bgpáll %s%s",

824 
bgp_dump_Æl
.
fûíame
, 
VTY_NEWLINE
);

826 i‡(
bgp_dump_upd©es
.
fûíame
)

828 i‡(
bgp_dump_upd©es
.
öãrvÆ_°r
)

829 
	`vty_out
 (
vty
, "dump bgp updates %s %s%s",

830 
bgp_dump_upd©es
.
fûíame
, bgp_dump_upd©es.
öãrvÆ_°r
,

831 
VTY_NEWLINE
);

833 
	`vty_out
 (
vty
, "dump bgp updates %s%s",

834 
bgp_dump_upd©es
.
fûíame
, 
VTY_NEWLINE
);

836 i‡(
bgp_dump_rouãs
.
fûíame
)

838 i‡(
bgp_dump_rouãs
.
öãrvÆ_°r
)

839 
	`vty_out
 (
vty
, "dump bgpÑoutes-mrt %s %s%s",

840 
bgp_dump_rouãs
.
fûíame
, bgp_dump_rouãs.
öãrvÆ_°r
,

841 
VTY_NEWLINE
);

843 
	`vty_out
 (
vty
, "dump bgpÑoutes-mrt %s%s",

844 
bgp_dump_rouãs
.
fûíame
, 
VTY_NEWLINE
);

847 
	}
}

851 
	$bgp_dump_öô
 ()

853 
	`mem£t
 (&
bgp_dump_Æl
, 0,  (
bgp_dump
));

854 
	`mem£t
 (&
bgp_dump_upd©es
, 0,  (
bgp_dump
));

855 
	`mem£t
 (&
bgp_dump_rouãs
, 0,  (
bgp_dump
));

857 
bgp_dump_obuf
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
 + 
BGP_DUMP_MSG_HEADER


858 + 
BGP_DUMP_HEADER_SIZE
);

860 
	`ö°Æl_node
 (&
bgp_dump_node
, 
c⁄fig_wrôe_bgp_dump
);

862 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
dump_bgp_Æl_cmd
);

863 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
dump_bgp_Æl_öãrvÆ_cmd
);

864 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_dump_bgp_Æl_cmd
);

865 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
dump_bgp_upd©es_cmd
);

866 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
dump_bgp_upd©es_öãrvÆ_cmd
);

867 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_dump_bgp_upd©es_cmd
);

868 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
dump_bgp_rouãs_cmd
);

869 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
dump_bgp_rouãs_öãrvÆ_cmd
);

870 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_dump_bgp_rouãs_cmd
);

871 
	}
}

874 
	$bgp_dump_föish
 ()

876 
	`°ªam_‰ì
 (
bgp_dump_obuf
);

877 
bgp_dump_obuf
 = 
NULL
;

878 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_dump.h

21 #i‚de‡
_QUAGGA_BGP_DUMP_H


22 
	#_QUAGGA_BGP_DUMP_H


	)

26 
	#MSG_PROTOCOL_BGP4MP
 16

	)

28 
	#BGP4MP_STATE_CHANGE
 0

	)

29 
	#BGP4MP_MESSAGE
 1

	)

30 
	#BGP4MP_ENTRY
 2

	)

31 
	#BGP4MP_SNAPSHOT
 3

	)

32 
	#BGP4MP_MESSAGE_AS4
 4

	)

33 
	#BGP4MP_STATE_CHANGE_AS4
 5

	)

35 
	#BGP_DUMP_HEADER_SIZE
 12

	)

36 
	#BGP_DUMP_MSG_HEADER
 40

	)

38 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE
 1

	)

39 
	#TABLE_DUMP_V2_RIB_IPV4_UNICAST
 2

	)

40 
	#TABLE_DUMP_V2_RIB_IPV4_MULTICAST
 3

	)

41 
	#TABLE_DUMP_V2_RIB_IPV6_UNICAST
 4

	)

42 
	#TABLE_DUMP_V2_RIB_IPV6_MULTICAST
 5

	)

43 
	#TABLE_DUMP_V2_RIB_GENERIC
 6

	)

45 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_IP
 0

	)

46 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_IP6
 1

	)

47 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_AS2
 0

	)

48 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_AS4
 2

	)

50 
bgp_dump_öô
 ();

51 
bgp_dump_föish
 ();

52 
bgp_dump_°©e
 (
≥î
 *, , );

53 
bgp_dump_∑ckë
 (
≥î
 *, , 
°ªam
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_ecommunity.c

21 
	~<zebø.h
>

23 
	~"hash.h
"

24 
	~"mem‹y.h
"

25 
	~"¥efix.h
"

26 
	~"comm™d.h
"

28 
	~"bgpd/bgpd.h
"

29 
	~"bgpd/bgp_ecommunôy.h
"

30 
	~"bgpd/bgp_a•©h.h
"

33 
hash
 *
	gecomhash
;

36 
ecommunôy
 *

37 
	$ecommunôy_√w
 ()

39  (
ecommunôy
 *Ë
	`XCALLOC
 (
MTYPE_ECOMMUNITY
,

40  (
ecommunôy
));

41 
	}
}

46 
	$ecommunôy_‰ì
 (
ecommunôy
 **
ecom
)

48 i‡((*
ecom
)->
vÆ
)

49 
	`XFREE
 (
MTYPE_ECOMMUNITY_VAL
, (*
ecom
)->
vÆ
);

50 i‡((*
ecom
)->
°r
)

51 
	`XFREE
 (
MTYPE_ECOMMUNITY_STR
, (*
ecom
)->
°r
);

52 
	`XFREE
 (
MTYPE_ECOMMUNITY
, *
ecom
);

53 
ecom
 = 
NULL
;

54 
	}
}

62 
	$ecommunôy_add_vÆ
 (
ecommunôy
 *
ecom
, 
ecommunôy_vÆ
 *
evÆ
)

64 
u_öt8_t
 *
p
;

65 
ªt
;

66 
c
;

69 i‡(
ecom
->
vÆ
 =
NULL
)

71 
ecom
->
size
++;

72 
ecom
->
vÆ
 = 
	`XMALLOC
 (
MTYPE_ECOMMUNITY_VAL
, 
	`ecom_Àngth
 (ecom));

73 
	`mem˝y
 (
ecom
->
vÆ
, 
evÆ
->vÆ, 
ECOMMUNITY_SIZE
);

78 
c
 = 0;

79 
p
 = 
ecom
->
vÆ
; 
c
 <Écom->
size
;Ö +
ECOMMUNITY_SIZE
, c++)

81 
ªt
 = 
	`memcmp
 (
p
, 
evÆ
->
vÆ
, 
ECOMMUNITY_SIZE
);

82 i‡(
ªt
 == 0)

84 i‡(
ªt
 > 0)

89 
ecom
->
size
++;

90 
ecom
->
vÆ
 = 
	`XREALLOC
 (
MTYPE_ECOMMUNITY_VAL
,Écom->vÆ, 
	`ecom_Àngth
 (ecom));

92 
	`memmove
 (
ecom
->
vÆ
 + (
c
 + 1Ë* 
ECOMMUNITY_SIZE
,

93 
ecom
->
vÆ
 + 
c
 * 
ECOMMUNITY_SIZE
,

94 (
ecom
->
size
 - 1 - 
c
Ë* 
ECOMMUNITY_SIZE
);

95 
	`mem˝y
 (
ecom
->
vÆ
 + 
c
 * 
ECOMMUNITY_SIZE
, 
evÆ
->val, ECOMMUNITY_SIZE);

98 
	}
}

103 
ecommunôy
 *

104 
	$ecommunôy_uniq_s‹t
 (
ecommunôy
 *
ecom
)

106 
i
;

107 
ecommunôy
 *
√w
;

108 
ecommunôy_vÆ
 *
evÆ
;

110 i‡(! 
ecom
)

111  
NULL
;

113 
√w
 = 
	`ecommunôy_√w
 ();

115 
i
 = 0; i < 
ecom
->
size
; i++)

117 
evÆ
 = (
ecommunôy_vÆ
 *Ë(
ecom
->
vÆ
 + (
i
 * 
ECOMMUNITY_SIZE
));

118 
	`ecommunôy_add_vÆ
 (
√w
, 
evÆ
);

120  
√w
;

121 
	}
}

124 
ecommunôy
 *

125 
	$ecommunôy_∑r£
 (
u_öt8_t
 *
≤t
, 
u_sh‹t
 
Àngth
)

127 
ecommunôy
 
tmp
;

128 
ecommunôy
 *
√w
;

131 i‡(
Àngth
 % 
ECOMMUNITY_SIZE
)

132  
NULL
;

136 
tmp
.
size
 = 
Àngth
 / 
ECOMMUNITY_SIZE
;

137 
tmp
.
vÆ
 = 
≤t
;

141 
√w
 = 
	`ecommunôy_uniq_s‹t
 (&
tmp
);

143  
	`ecommunôy_öã∫
 (
√w
);

144 
	}
}

147 
ecommunôy
 *

148 
	$ecommunôy_dup
 (
ecommunôy
 *
ecom
)

150 
ecommunôy
 *
√w
;

152 
√w
 = 
	`XCALLOC
 (
MTYPE_ECOMMUNITY
,  (
ecommunôy
));

153 
√w
->
size
 = 
ecom
->size;

154 i‡(
√w
->
size
)

156 
√w
->
vÆ
 = 
	`XMALLOC
 (
MTYPE_ECOMMUNITY_VAL
, 
ecom
->
size
 * 
ECOMMUNITY_SIZE
);

157 
	`mem˝y
 (
√w
->
vÆ
, 
ecom
->vÆ,Écom->
size
 * 
ECOMMUNITY_SIZE
);

160 
√w
->
vÆ
 = 
NULL
;

161  
√w
;

162 
	}
}

166 
	$ecommunôy_°r
 (
ecommunôy
 *
ecom
)

168 i‡(! 
ecom
->
°r
)

169 
ecom
->
°r
 = 
	`ecommunôy_ecom2°r
 (ecom, 
ECOMMUNITY_FORMAT_DISPLAY
);

170  
ecom
->
°r
;

171 
	}
}

174 
ecommunôy
 *

175 
	$ecommunôy_mîge
 (
ecommunôy
 *
ecom1
, ecommunôy *
ecom2
)

177 i‡(
ecom1
->
vÆ
)

178 
ecom1
->
vÆ
 = 
	`XREALLOC
 (
MTYPE_ECOMMUNITY_VAL
,Écom1->val,

179 (
ecom1
->
size
 + 
ecom2
->sizeË* 
ECOMMUNITY_SIZE
);

181 
ecom1
->
vÆ
 = 
	`XMALLOC
 (
MTYPE_ECOMMUNITY_VAL
,

182 (
ecom1
->
size
 + 
ecom2
->sizeË* 
ECOMMUNITY_SIZE
);

184 
	`mem˝y
 (
ecom1
->
vÆ
 + (ecom1->
size
 * 
ECOMMUNITY_SIZE
),

185 
ecom2
->
vÆ
,Écom2->
size
 * 
ECOMMUNITY_SIZE
);

186 
ecom1
->
size
 +
ecom2
->size;

188  
ecom1
;

189 
	}
}

192 
ecommunôy
 *

193 
	$ecommunôy_öã∫
 (
ecommunôy
 *
ecom
)

195 
ecommunôy
 *
föd
;

197 
	`as£π
 (
ecom
->
ªf˙t
 == 0);

199 
föd
 = (
ecommunôy
 *Ë
	`hash_gë
 (
ecomhash
, 
ecom
, 
hash_Æloc_öã∫
);

201 i‡(
föd
 !
ecom
)

202 
	`ecommunôy_‰ì
 (&
ecom
);

204 
föd
->
ªf˙t
++;

206 i‡(! 
föd
->
°r
)

207 
föd
->
°r
 = 
	`ecommunôy_ecom2°r
 (föd, 
ECOMMUNITY_FORMAT_DISPLAY
);

209  
föd
;

210 
	}
}

214 
	$ecommunôy_unöã∫
 (
ecommunôy
 **
ecom
)

216 
ecommunôy
 *
ªt
;

218 i‡((*
ecom
)->
ªf˙t
)

219 (*
ecom
)->
ªf˙t
--;

222 i‡((*
ecom
)->
ªf˙t
 == 0)

225 
ªt
 = (
ecommunôy
 *Ë
	`hash_ªÀa£
 (
ecomhash
, *
ecom
);

226 
	`as£π
 (
ªt
 !
NULL
);

228 
	`ecommunôy_‰ì
 (
ecom
);

230 
	}
}

234 
	$ecommunôy_hash_make
 (*
¨g
)

236 c⁄° 
ecommunôy
 *
ecom
 = 
¨g
;

237 
size
 = 
ecom
->sizê* 
ECOMMUNITY_SIZE
;

238 
u_öt8_t
 *
≤t
 = 
ecom
->
vÆ
;

239 
key
 = 0;

240 
c
;

242 
c
 = 0; c < 
size
; c +
ECOMMUNITY_SIZE
)

244 
key
 +
≤t
[
c
];

245 
key
 +
≤t
[
c
 + 1];

246 
key
 +
≤t
[
c
 + 2];

247 
key
 +
≤t
[
c
 + 3];

248 
key
 +
≤t
[
c
 + 4];

249 
key
 +
≤t
[
c
 + 5];

250 
key
 +
≤t
[
c
 + 6];

251 
key
 +
≤t
[
c
 + 7];

254  
key
;

255 
	}
}

259 
	$ecommunôy_cmp
 (c⁄° *
¨g1
, c⁄° *
¨g2
)

261 c⁄° 
ecommunôy
 *
ecom1
 = 
¨g1
;

262 c⁄° 
ecommunôy
 *
ecom2
 = 
¨g2
;

264  (
ecom1
->
size
 =
ecom2
->size

265 && 
	`memcmp
 (
ecom1
->
vÆ
, 
ecom2
->vÆ,Écom1->
size
 * 
ECOMMUNITY_SIZE
) == 0);

266 
	}
}

270 
	$ecommunôy_öô
 ()

272 
ecomhash
 = 
	`hash_¸óã
 (
ecommunôy_hash_make
, 
ecommunôy_cmp
);

273 
	}
}

276 
	$ecommunôy_föish
 ()

278 
	`hash_‰ì
 (
ecomhash
);

279 
ecomhash
 = 
NULL
;

280 
	}
}

283 
	eecommunôy_tokí


285 
	mecommunôy_tokí_π
,

286 
	mecommunôy_tokí_soo
,

287 
	mecommunôy_tokí_vÆ
,

288 
	mecommunôy_tokí_unknown


293 
	$ecommunôy_gëtokí
 (c⁄° *
°r
, 
ecommunôy_vÆ
 *
evÆ
,

294 
ecommunôy_tokí
 *
tokí
)

296 
ªt
;

297 
dŸ
 = 0;

298 
digô
 = 0;

299 
£∑øt‹
 = 0;

300 c⁄° *
p
 = 
°r
;

301 *
íd±r
;

302 
ö_addr
 
ù
;

303 
as_t
 
as
 = 0;

304 
u_öt32_t
 
vÆ
 = 0;

305 
buf
[
INET_ADDRSTRLEN
 + 1];

308 
	`is•a˚
 ((Ë*
p
))

310 
p
++;

311 
°r
++;

315 i‡(*
p
 == '\0')

316  
NULL
;

319 i‡(! 
	`isdigô
 ((Ë*
p
))

322 i‡(
	`tﬁowî
 ((Ë*
p
) == 'r')

324 
p
++;

325 i‡(
	`tﬁowî
 ((Ë*
p
) == 't')

327 
p
++;

328 *
tokí
 = 
ecommunôy_tokí_π
;

329  
p
;

331 i‡(
	`is•a˚
 ((Ë*
p
) || *p == '\0')

333 *
tokí
 = 
ecommunôy_tokí_π
;

334  
p
;

336 
îr‹
;

339 i‡(
	`tﬁowî
 ((Ë*
p
) == 's')

341 
p
++;

342 i‡(
	`tﬁowî
 ((Ë*
p
) == 'o')

344 
p
++;

345 i‡(
	`tﬁowî
 ((Ë*
p
) == 'o')

347 
p
++;

348 *
tokí
 = 
ecommunôy_tokí_soo
;

349  
p
;

351 i‡(
	`is•a˚
 ((Ë*
p
) || *p == '\0')

353 *
tokí
 = 
ecommunôy_tokí_soo
;

354  
p
;

356 
îr‹
;

358 i‡(
	`is•a˚
 ((Ë*
p
) || *p == '\0')

360 *
tokí
 = 
ecommunôy_tokí_soo
;

361  
p
;

363 
îr‹
;

365 
îr‹
;

381 
	`isdigô
 ((Ë*
p
) || *p == ':' || *p == '.')

383 i‡(*
p
 == ':')

385 i‡(
£∑øt‹
)

386 
îr‹
;

388 
£∑øt‹
 = 1;

389 
digô
 = 0;

391 i‡((
p
 - 
°r
Ë> 
INET_ADDRSTRLEN
)

392 
îr‹
;

393 
	`mem£t
 (
buf
, 0, 
INET_ADDRSTRLEN
 + 1);

394 
	`mem˝y
 (
buf
, 
°r
, 
p
 - str);

396 i‡(
dŸ
)

401 
ªt
 = 
	`öë_©⁄
 (
buf
, &
ù
);

402 i‡(
ªt
 == 0)

403 
îr‹
;

408 
as
 = 
	`°πoul
 (
buf
, &
íd±r
, 10);

409 i‡(*
íd±r
 !'\0' || 
as
 =
BGP_AS4_MAX
)

410 
îr‹
;

413 i‡(*
p
 == '.')

415 i‡(
£∑øt‹
)

416 
îr‹
;

417 
dŸ
++;

418 i‡(
dŸ
 > 4)

419 
îr‹
;

423 
digô
 = 1;

426 i‡(
£∑øt‹
)

428 
vÆ
 *= 10;

429 
vÆ
 +(*
p
 - '0');

432 
p
++;

436 i‡(!
digô
 || !
£∑øt‹
)

437 
îr‹
;

440 i‡(
dŸ
)

442 i‡(
vÆ
 > 
UINT16_MAX
)

443 
îr‹
;

445 
evÆ
->
vÆ
[0] = 
ECOMMUNITY_ENCODE_IP
;

446 
evÆ
->
vÆ
[1] = 0;

447 
	`mem˝y
 (&
evÆ
->
vÆ
[2], &
ù
,  (
ö_addr
));

448 
evÆ
->
vÆ
[6] = (val >> 8) & 0xff;

449 
evÆ
->
vÆ
[7] = val & 0xff;

451 i‡(
as
 > 
BGP_AS_MAX
)

453 i‡(
vÆ
 > 
UINT16_MAX
)

454 
îr‹
;

456 
evÆ
->
vÆ
[0] = 
ECOMMUNITY_ENCODE_AS4
;

457 
evÆ
->
vÆ
[1] = 0;

458 
evÆ
->
vÆ
[2] = (
as
 >>24) & 0xff;

459 
evÆ
->
vÆ
[3] = (
as
 >>16) & 0xff;

460 
evÆ
->
vÆ
[4] = (
as
 >>8) & 0xff;

461 
evÆ
->
vÆ
[5] = 
as
 & 0xff;

462 
evÆ
->
vÆ
[6] = (val >> 8) & 0xff;

463 
evÆ
->
vÆ
[7] = val & 0xff;

467 
evÆ
->
vÆ
[0] = 
ECOMMUNITY_ENCODE_AS
;

468 
evÆ
->
vÆ
[1] = 0;

470 
evÆ
->
vÆ
[2] = (
as
 >>8) & 0xff;

471 
evÆ
->
vÆ
[3] = 
as
 & 0xff;

472 
evÆ
->
vÆ
[4] = (val >>24) & 0xff;

473 
evÆ
->
vÆ
[5] = (val >>16) & 0xff;

474 
evÆ
->
vÆ
[6] = (val >>8) & 0xff;

475 
evÆ
->
vÆ
[7] = val & 0xff;

477 *
tokí
 = 
ecommunôy_tokí_vÆ
;

478  
p
;

480 
îr‹
:

481 *
tokí
 = 
ecommunôy_tokí_unknown
;

482  
p
;

483 
	}
}

511 
ecommunôy
 *

512 
	$ecommunôy_°r2com
 (c⁄° *
°r
, 
ty≥
, 
keyw‹d_ö˛uded
)

514 
ecommunôy
 *
ecom
 = 
NULL
;

515 
ecommunôy_tokí
 
tokí
;

516 
ecommunôy_vÆ
 
evÆ
;

517 
keyw‹d
 = 0;

519 (
°r
 = 
	`ecommunôy_gëtokí
 (°r, &
evÆ
, &
tokí
)))

521 
tokí
)

523 
ecommunôy_tokí_π
:

524 
ecommunôy_tokí_soo
:

525 i‡(! 
keyw‹d_ö˛uded
 || 
keyw‹d
)

527 i‡(
ecom
)

528 
	`ecommunôy_‰ì
 (&
ecom
);

529  
NULL
;

531 
keyw‹d
 = 1;

533 i‡(
tokí
 =
ecommunôy_tokí_π
)

535 
ty≥
 = 
ECOMMUNITY_ROUTE_TARGET
;

537 i‡(
tokí
 =
ecommunôy_tokí_soo
)

539 
ty≥
 = 
ECOMMUNITY_SITE_ORIGIN
;

542 
ecommunôy_tokí_vÆ
:

543 i‡(
keyw‹d_ö˛uded
)

545 i‡(! 
keyw‹d
)

547 i‡(
ecom
)

548 
	`ecommunôy_‰ì
 (&
ecom
);

549  
NULL
;

551 
keyw‹d
 = 0;

553 i‡(
ecom
 =
NULL
)

554 
ecom
 = 
	`ecommunôy_√w
 ();

555 
evÆ
.
vÆ
[1] = 
ty≥
;

556 
	`ecommunôy_add_vÆ
 (
ecom
, &
evÆ
);

558 
ecommunôy_tokí_unknown
:

560 i‡(
ecom
)

561 
	`ecommunôy_‰ì
 (&
ecom
);

562  
NULL
;

565  
ecom
;

566 
	}
}

568 #ifde‡
USE_SRX


577 
ecommunôy
 *

578 
	$ecommunôy_bgp£c_°r2com
(
ty≥
, 
°©e_vÆue
)

580 
ecommunôy
 *
ecom
 = 
NULL
;

581 
ecommunôy_vÆ
 
evÆ
;

583 
	`mem£t
(&
evÆ
, 0x00, (
ecommunôy_vÆ
));

584 
ecom
 = 
	`ecommunôy_√w
 ();

586 
evÆ
.
vÆ
[0] = 
ECOMMUNITY_ENCODE_BGPSEC
;

589 
evÆ
.
vÆ
[1] = 
ty≥
;

590 
evÆ
.
vÆ
[7] = 
°©e_vÆue
;

593 
	`ecommunôy_add_vÆ
 (
ecom
, &
evÆ
);

595  
ecom
;

596 
	}
}

621 
	$ecommunôy_ecom2°r
 (
ecommunôy
 *
ecom
, 
f‹m©
)

623 
i
;

624 
u_öt8_t
 *
≤t
;

625 
ícode
 = 0;

626 
ty≥
 = 0;

627 
	#ECOMMUNITY_STR_DEFAULT_LEN
 27

	)

628 
°r_size
;

629 
°r_≤t
;

630 *
°r_buf
;

631 c⁄° *
¥efix
;

632 
Àn
 = 0;

633 
fú°
 = 1;

636 
	secommunôy_as


638 
as_t
 
as
;

639 
u_öt32_t
 
vÆ
;

640 } 
ós
;

642 
	secommunôy_ù


644 
ö_addr
 
ù
;

645 
u_öt16_t
 
vÆ
;

646 } 
eù
;

648 i‡(
ecom
->
size
 == 0)

650 
°r_buf
 = 
	`XMALLOC
 (
MTYPE_ECOMMUNITY_STR
, 1);

651 
°r_buf
[0] = '\0';

652  
°r_buf
;

656 
°r_buf
 = 
	`XMALLOC
 (
MTYPE_ECOMMUNITY_STR
, 
ECOMMUNITY_STR_DEFAULT_LEN
 + 1);

657 
°r_size
 = 
ECOMMUNITY_STR_DEFAULT_LEN
 + 1;

658 
°r_≤t
 = 0;

660 
i
 = 0; i < 
ecom
->
size
; i++)

663 
°r_≤t
 + 
ECOMMUNITY_STR_DEFAULT_LEN
 >
°r_size
)

665 
°r_size
 *= 2;

666 
°r_buf
 = 
	`XREALLOC
 (
MTYPE_ECOMMUNITY_STR
, så_buf, 
°r_size
);

670 i‡(! 
fú°
)

671 
°r_buf
[
°r_≤t
++] = ' ';

673 
≤t
 = 
ecom
->
vÆ
 + (
i
 * 8);

676 
ícode
 = *
≤t
++;

677 i‡(
ícode
 !
ECOMMUNITY_ENCODE_AS
 &&Éncodê!
ECOMMUNITY_ENCODE_IP


678 && 
ícode
 !
ECOMMUNITY_ENCODE_AS4
)

680 
Àn
 = 
	`•rötf
 (
°r_buf
 + 
°r_≤t
, "?");

681 
°r_≤t
 +
Àn
;

682 
fú°
 = 0;

687 
ty≥
 = *
≤t
++;

688 i‡(
ty≥
 !
ECOMMUNITY_ROUTE_TARGET
 &&Åy≥ !
ECOMMUNITY_SITE_ORIGIN
)

690 
Àn
 = 
	`•rötf
 (
°r_buf
 + 
°r_≤t
, "?");

691 
°r_≤t
 +
Àn
;

692 
fú°
 = 0;

696 
f‹m©
)

698 
ECOMMUNITY_FORMAT_COMMUNITY_LIST
:

699 
¥efix
 = (
ty≥
 =
ECOMMUNITY_ROUTE_TARGET
 ? "rt " : "soo ");

701 
ECOMMUNITY_FORMAT_DISPLAY
:

702 
¥efix
 = (
ty≥
 =
ECOMMUNITY_ROUTE_TARGET
 ? "RT:" : "SoO:");

704 
ECOMMUNITY_FORMAT_ROUTE_MAP
:

705 
¥efix
 = "";

708 
¥efix
 = "";

713 i‡(
ícode
 =
ECOMMUNITY_ENCODE_AS4
)

715 
ós
.
as
 = (*
≤t
++ << 24);

716 
ós
.
as
 |(*
≤t
++ << 16);

717 
ós
.
as
 |(*
≤t
++ << 8);

718 
ós
.
as
 |(*
≤t
++);

720 
ós
.
vÆ
 = (*
≤t
++ << 8);

721 
ós
.
vÆ
 |(*
≤t
++);

723 
Àn
 = 
	`•rötf
–
°r_buf
 + 
°r_≤t
, "%s%u:%d", 
¥efix
,

724 
ós
.
as
,Éas.
vÆ
 );

725 
°r_≤t
 +
Àn
;

726 
fú°
 = 0;

728 i‡(
ícode
 =
ECOMMUNITY_ENCODE_AS
)

730 
ós
.
as
 = (*
≤t
++ << 8);

731 
ós
.
as
 |(*
≤t
++);

733 
ós
.
vÆ
 = (*
≤t
++ << 24);

734 
ós
.
vÆ
 |(*
≤t
++ << 16);

735 
ós
.
vÆ
 |(*
≤t
++ << 8);

736 
ós
.
vÆ
 |(*
≤t
++);

738 
Àn
 = 
	`•rötf
 (
°r_buf
 + 
°r_≤t
, "%s%u:%d", 
¥efix
,

739 
ós
.
as
,Éas.
vÆ
);

740 
°r_≤t
 +
Àn
;

741 
fú°
 = 0;

743 i‡(
ícode
 =
ECOMMUNITY_ENCODE_IP
)

745 
	`mem˝y
 (&
eù
.
ù
, 
≤t
, 4);

746 
≤t
 += 4;

747 
eù
.
vÆ
 = (*
≤t
++ << 8);

748 
eù
.
vÆ
 |(*
≤t
++);

750 
Àn
 = 
	`•rötf
 (
°r_buf
 + 
°r_≤t
, "%s%s:%d", 
¥efix
,

751 
	`öë_¡ﬂ
 (
eù
.
ù
),Éù.
vÆ
);

752 
°r_≤t
 +
Àn
;

753 
fú°
 = 0;

756  
°r_buf
;

757 
	}
}

760 
	$ecommunôy_m©ch
 (c⁄° 
ecommunôy
 *
ecom1
,

761 c⁄° 
ecommunôy
 *
ecom2
)

763 
i
 = 0;

764 
j
 = 0;

766 i‡(
ecom1
 =
NULL
 && 
ecom2
 == NULL)

769 i‡(
ecom1
 =
NULL
 || 
ecom2
 == NULL)

772 i‡(
ecom1
->
size
 < 
ecom2
->size)

776 
i
 < 
ecom1
->
size
 && 
j
 < 
ecom2
->size)

778 i‡(
	`memcmp
 (
ecom1
->
vÆ
 + 
i
, 
ecom2
->vÆ + 
j
, 
ECOMMUNITY_SIZE
) == 0)

779 
j
++;

780 
i
++;

783 i‡(
j
 =
ecom2
->
size
)

787 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_ecommunity.h

21 #i‚de‡
_QUAGGA_BGP_ECOMMUNITY_H


22 
	#_QUAGGA_BGP_ECOMMUNITY_H


	)

25 
	#ECOMMUNITY_ENCODE_AS
 0x00

	)

26 
	#ECOMMUNITY_ENCODE_IP
 0x01

	)

27 
	#ECOMMUNITY_ENCODE_AS4
 0x02

	)

28 #ifde‡
USE_SRX


29 
	#ECOMMUNITY_ENCODE_BGPSEC
 0x43

	)

30 
	#ECOMMUNITY_ENCODE_TRANSITIVE_BGPSEC
 0x03

	)

35 
	#ECOMMUNITY_ROUTE_TARGET
 0x02

	)

36 
	#ECOMMUNITY_SITE_ORIGIN
 0x03

	)

37 #ifde‡
USE_SRX


38 
	#ECOMMUNITY_BGPSEC_SUB
 0x00

	)

42 
	#ECOMMUNITY_FORMAT_ROUTE_MAP
 0

	)

43 
	#ECOMMUNITY_FORMAT_COMMUNITY_LIST
 1

	)

44 
	#ECOMMUNITY_FORMAT_DISPLAY
 2

	)

47 
	#ECOMMUNITY_SIZE
 8

	)

50 
	#ECOMMUNITY_FLAG_NON_TRANSITIVE
 0x40

	)

53 #ifde‡
USE_SRX


63 
	#ECOMMUNITY_BGPSEC_VALID
 0

	)

64 
	#ECOMMUNITY_BGPSEC_NOT_FOUND
 1

	)

65 
	#ECOMMUNITY_BGPSEC_INVALID
 2

	)

66 
	#ECOMMUNITY_BGPSEC_UNDEFINED
 3

	)

70 
	secommunôy


73 
	mªf˙t
;

76 
	msize
;

79 
u_öt8_t
 *
	mvÆ
;

82 *
	m°r
;

86 
	secommunôy_vÆ


88 
	mvÆ
[
ECOMMUNITY_SIZE
];

91 
	#ecom_Àngth
(
X
Ë((X)->
size
 * 
ECOMMUNITY_SIZE
)

	)

93 
ecommunôy_öô
 ();

94 
ecommunôy_föish
 ();

95 
ecommunôy_‰ì
 (
ecommunôy
 **);

96 
ecommunôy
 *
ecommunôy_∑r£
 (
u_öt8_t
 *, 
u_sh‹t
);

97 
ecommunôy
 *
ecommunôy_dup
 (ecommunity *);

98 
ecommunôy
 *
ecommunôy_mîge
 (ecommunity *, ecommunity *);

99 
ecommunôy
 *
ecommunôy_uniq_s‹t
 (ecommunity *);

100 
ecommunôy
 *
ecommunôy_öã∫
 (ecommunity *);

101 
ecommunôy_cmp
 (const *, const *);

102 
ecommunôy_unöã∫
 (
ecommunôy
 **);

103 
ecommunôy_hash_make
 (*);

104 
ecommunôy
 *
ecommunôy_°r2com
 (const *, , );

105 #ifde‡
USE_SRX


106 
ecommunôy
 *
ecommunôy_bgp£c_°r2com
(, );

108 *
ecommunôy_ecom2°r
 (
ecommunôy
 *, );

109 
ecommunôy_m©ch
 (c⁄° 
ecommunôy
 *, const ecommunity *);

110 *
ecommunôy_°r
 (
ecommunôy
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_filter.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"log.h
"

25 
	~"mem‹y.h
"

26 
	~"buf„r.h
"

28 
	~"bgpd/bgpd.h
"

29 
	~"bgpd/bgp_a•©h.h
"

30 
	~"bgpd/bgp_ªgex.h
"

31 
	~"bgpd/bgp_fûãr.h
"

34 
	sas_li°_li°


36 
as_li°
 *
	mhód
;

37 
as_li°
 *
	mèû
;

41 
	sas_li°_ma°î


44 
as_li°_li°
 
	mnum
;

47 
as_li°_li°
 
	m°r
;

50 (*
	madd_hook
) ();

53 (*
	mdñëe_hook
) ();

57 
	sas_fûãr


59 
as_fûãr
 *
	m√xt
;

60 
as_fûãr
 *
	m¥ev
;

62 
as_fûãr_ty≥
 
	mty≥
;

64 
ªgex_t
 *
	mªg
;

65 *
	mªg_°r
;

68 
	eas_li°_ty≥


70 
	mACCESS_TYPE_STRING
,

71 
	mACCESS_TYPE_NUMBER


75 
	sas_li°


77 *
	m«me
;

79 
as_li°_ty≥
 
	mty≥
;

81 
as_li°
 *
	m√xt
;

82 
as_li°
 *
	m¥ev
;

84 
as_fûãr
 *
	mhód
;

85 
as_fûãr
 *
	mèû
;

90 
as_li°_ma°î
 
	gas_li°_ma°î
 =

92 {
NULL
, NULL},

93 {
NULL
, NULL},

94 
NULL
,

95 
NULL


99 
as_fûãr
 *

100 
	$as_fûãr_√w
 ()

102  
	`XCALLOC
 (
MTYPE_AS_FILTER
,  (
as_fûãr
));

103 
	}
}

107 
	$as_fûãr_‰ì
 (
as_fûãr
 *
asfûãr
)

109 i‡(
asfûãr
->
ªg
)

110 
	`bgp_ªgex_‰ì
 (
asfûãr
->
ªg
);

111 i‡(
asfûãr
->
ªg_°r
)

112 
	`XFREE
 (
MTYPE_AS_FILTER_STR
, 
asfûãr
->
ªg_°r
);

113 
	`XFREE
 (
MTYPE_AS_FILTER
, 
asfûãr
);

114 
	}
}

117 
as_fûãr
 *

118 
	$as_fûãr_make
 (
ªgex_t
 *
ªg
, c⁄° *
ªg_°r
, 
as_fûãr_ty≥
 
ty≥
)

120 
as_fûãr
 *
asfûãr
;

122 
asfûãr
 = 
	`as_fûãr_√w
 ();

123 
asfûãr
->
ªg
 =Ñeg;

124 
asfûãr
->
ty≥
 =Åype;

125 
asfûãr
->
ªg_°r
 = 
	`XSTRDUP
 (
MTYPE_AS_FILTER_STR
,Ñeg_str);

127  
asfûãr
;

128 
	}
}

130 
as_fûãr
 *

131 
	$as_fûãr_lookup
 (
as_li°
 *
a¶i°
, c⁄° *
ªg_°r
,

132 
as_fûãr_ty≥
 
ty≥
)

134 
as_fûãr
 *
asfûãr
;

136 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

137 i‡(
	`°rcmp
 (
ªg_°r
, 
asfûãr
->reg_str) == 0)

138  
asfûãr
;

139  
NULL
;

140 
	}
}

143 
	$as_li°_fûãr_add
 (
as_li°
 *
a¶i°
, 
as_fûãr
 *
asfûãr
)

145 
asfûãr
->
√xt
 = 
NULL
;

146 
asfûãr
->
¥ev
 = 
a¶i°
->
èû
;

148 i‡(
a¶i°
->
èû
)

149 
a¶i°
->
èû
->
√xt
 = 
asfûãr
;

151 
a¶i°
->
hód
 = 
asfûãr
;

152 
a¶i°
->
èû
 = 
asfûãr
;

153 
	}
}

156 
as_li°
 *

157 
	$as_li°_lookup
 (c⁄° *
«me
)

159 
as_li°
 *
a¶i°
;

161 i‡(
«me
 =
NULL
)

162  
NULL
;

164 
a¶i°
 = 
as_li°_ma°î
.
num
.
hód
;á¶i°;á¶i° =á¶i°->
√xt
)

165 i‡(
	`°rcmp
 (
a¶i°
->
«me
,Çame) == 0)

166  
a¶i°
;

168 
a¶i°
 = 
as_li°_ma°î
.
°r
.
hód
;á¶i°;á¶i° =á¶i°->
√xt
)

169 i‡(
	`°rcmp
 (
a¶i°
->
«me
,Çame) == 0)

170  
a¶i°
;

172  
NULL
;

173 
	}
}

175 
as_li°
 *

176 
	$as_li°_√w
 ()

178  
	`XCALLOC
 (
MTYPE_AS_LIST
,  (
as_li°
));

179 
	}
}

182 
	$as_li°_‰ì
 (
as_li°
 *
a¶i°
)

184 i‡(
a¶i°
->
«me
)

186 
	`‰ì
 (
a¶i°
->
«me
);

187 
a¶i°
->
«me
 = 
NULL
;

189 
	`XFREE
 (
MTYPE_AS_LIST
, 
a¶i°
);

190 
	}
}

194 
as_li°
 *

195 
	$as_li°_ö£π
 (c⁄° *
«me
)

197 
size_t
 
i
;

198 
numbî
;

199 
as_li°
 *
a¶i°
;

200 
as_li°
 *
poöt
;

201 
as_li°_li°
 *
li°
;

204 
a¶i°
 = 
	`as_li°_√w
 ();

205 
a¶i°
->
«me
 = 
	`°rdup
 (name);

206 
	`as£π
 (
a¶i°
->
«me
);

210 
numbî
 = 0, 
i
 = 0; i < 
	`°æí
 (
«me
); i++)

212 i‡(
	`isdigô
 ((Ë
«me
[
i
]))

213 
numbî
 = (numbî * 10Ë+ (
«me
[
i
] - '0');

219 i‡(
i
 =
	`°æí
 (
«me
))

221 
a¶i°
->
ty≥
 = 
ACCESS_TYPE_NUMBER
;

224 
li°
 = &
as_li°_ma°î
.
num
;

226 
poöt
 = 
li°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

227 i‡(
	`©ﬁ
 (
poöt
->
«me
Ë>
numbî
)

232 
a¶i°
->
ty≥
 = 
ACCESS_TYPE_STRING
;

235 
li°
 = &
as_li°_ma°î
.
°r
;

238 
poöt
 = 
li°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

239 i‡(
	`°rcmp
 (
poöt
->
«me
,Çame) >= 0)

244 i‡(
li°
->
hód
 =
NULL
)

246 
li°
->
hód
 =Üi°->
èû
 = 
a¶i°
;

247  
a¶i°
;

251 i‡(
poöt
 =
NULL
)

253 
a¶i°
->
¥ev
 = 
li°
->
èû
;

254 
li°
->
èû
->
√xt
 = 
a¶i°
;

255 
li°
->
èû
 = 
a¶i°
;

256  
a¶i°
;

260 i‡(
poöt
 =
li°
->
hód
)

262 
a¶i°
->
√xt
 = 
li°
->
hód
;

263 
li°
->
hód
->
¥ev
 = 
a¶i°
;

264 
li°
->
hód
 = 
a¶i°
;

265  
a¶i°
;

269 
a¶i°
->
√xt
 = 
poöt
;

270 
a¶i°
->
¥ev
 = 
poöt
->prev;

272 i‡(
poöt
->
¥ev
)

273 
poöt
->
¥ev
->
√xt
 = 
a¶i°
;

274 
poöt
->
¥ev
 = 
a¶i°
;

276  
a¶i°
;

277 
	}
}

279 
as_li°
 *

280 
	$as_li°_gë
 (c⁄° *
«me
)

282 
as_li°
 *
a¶i°
;

284 
a¶i°
 = 
	`as_li°_lookup
 (
«me
);

285 i‡(
a¶i°
 =
NULL
)

287 
a¶i°
 = 
	`as_li°_ö£π
 (
«me
);

290 i‡(
as_li°_ma°î
.
add_hook
)

291 (*
as_li°_ma°î
.
add_hook
) ();

294  
a¶i°
;

295 
	}
}

298 
	$fûãr_ty≥_°r
 (
as_fûãr_ty≥
 
ty≥
)

300 
ty≥
)

302 
AS_FILTER_PERMIT
:

304 
AS_FILTER_DENY
:

309 
	}
}

312 
	$as_li°_dñëe
 (
as_li°
 *
a¶i°
)

314 
as_li°_li°
 *
li°
;

315 
as_fûãr
 *
fûãr
, *
√xt
;

317 
fûãr
 = 
a¶i°
->
hód
; fûãr; fûã∏
√xt
)

319 
√xt
 = 
fûãr
->next;

320 
	`as_fûãr_‰ì
 (
fûãr
);

323 i‡(
a¶i°
->
ty≥
 =
ACCESS_TYPE_NUMBER
)

324 
li°
 = &
as_li°_ma°î
.
num
;

326 
li°
 = &
as_li°_ma°î
.
°r
;

328 i‡(
a¶i°
->
√xt
)

329 
a¶i°
->
√xt
->
¥ev
 =áslist->prev;

331 
li°
->
èû
 = 
a¶i°
->
¥ev
;

333 i‡(
a¶i°
->
¥ev
)

334 
a¶i°
->
¥ev
->
√xt
 =áslist->next;

336 
li°
->
hód
 = 
a¶i°
->
√xt
;

338 
	`as_li°_‰ì
 (
a¶i°
);

339 
	}
}

342 
	$as_li°_em±y
 (
as_li°
 *
a¶i°
)

344 i‡(
a¶i°
->
hód
 =
NULL
 &&á¶i°->
èû
 == NULL)

348 
	}
}

351 
	$as_li°_fûãr_dñëe
 (
as_li°
 *
a¶i°
, 
as_fûãr
 *
asfûãr
)

353 i‡(
asfûãr
->
√xt
)

354 
asfûãr
->
√xt
->
¥ev
 =ásfilter->prev;

356 
a¶i°
->
èû
 = 
asfûãr
->
¥ev
;

358 i‡(
asfûãr
->
¥ev
)

359 
asfûãr
->
¥ev
->
√xt
 =ásfilter->next;

361 
a¶i°
->
hód
 = 
asfûãr
->
√xt
;

363 
	`as_fûãr_‰ì
 (
asfûãr
);

366 i‡(
	`as_li°_em±y
 (
a¶i°
))

367 
	`as_li°_dñëe
 (
a¶i°
);

370 i‡(
as_li°_ma°î
.
dñëe_hook
)

371 (*
as_li°_ma°î
.
dñëe_hook
) ();

372 
	}
}

375 
	$as_fûãr_m©ch
 (
as_fûãr
 *
asfûãr
, 
a•©h
 *aspath)

377 i‡(
	`bgp_ªgexec
 (
asfûãr
->
ªg
, 
a•©h
Ë!
REG_NOMATCH
)

380 
	}
}

383 
as_fûãr_ty≥


384 
	$as_li°_≠∂y
 (
as_li°
 *
a¶i°
, *
obje˘
)

386 
as_fûãr
 *
asfûãr
;

387 
a•©h
 *aspath;

389 
a•©h
 = (a•©h *Ë
obje˘
;

391 i‡(
a¶i°
 =
NULL
)

392  
AS_FILTER_DENY
;

394 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

396 i‡(
	`as_fûãr_m©ch
 (
asfûãr
, 
a•©h
))

397  
asfûãr
->
ty≥
;

399  
AS_FILTER_DENY
;

400 
	}
}

404 
as_li°_add_hook
 ((*
func
) ())

406 
as_li°_ma°î
.
add_hook
 = 
func
;

407 
	}
}

411 
as_li°_dñëe_hook
 ((*
func
) ())

413 
as_li°_ma°î
.
dñëe_hook
 = 
func
;

414 
	}
}

417 
	$as_li°_dup_check
 (
as_li°
 *
a¶i°
, 
as_fûãr
 *
√w
)

419 
as_fûãr
 *
asfûãr
;

421 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

423 i‡(
asfûãr
->
ty≥
 =
√w
->type

424 && 
	`°rcmp
 (
asfûãr
->
ªg_°r
, 
√w
->reg_str) == 0)

428 
	}
}

430 
DEFUN
 (
ù_as_∑th
, 
ù_as_∑th_cmd
,

432 
IP_STR


440 
as_fûãr_ty≥
 
	gty≥
;

441 
as_fûãr
 *
	gasfûãr
;

442 
as_li°
 *
	ga¶i°
;

443 
ªgex_t
 *
	gªgex
;

444 *
	gªg°r
;

447 i‡(
°∫cmp
 (
¨gv
[1], "p", 1) == 0)

448 
ty≥
 = 
AS_FILTER_PERMIT
;

449 i‡(
°∫cmp
 (
¨gv
[1], "d", 1) == 0)

450 
ty≥
 = 
AS_FILTER_DENY
;

453 
vty_out
 (
vty
, "fûã∏ty≥ mu° bê[≥rmô|díy]%s", 
VTY_NEWLINE
);

454  
	gCMD_WARNING
;

458 
	gªg°r
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 2);

460 
	gªgex
 = 
bgp_ªgcomp
 (
ªg°r
);

461 i‡(!
	gªgex
)

463 
XFREE
 (
MTYPE_TMP
, 
ªg°r
);

464 
vty_out
 (
vty
, "ˇn'àcompûêªgex∞%s%s", 
¨gv
[0],

465 
VTY_NEWLINE
);

466  
	gCMD_WARNING
;

469 
	gasfûãr
 = 
as_fûãr_make
 (
ªgex
, 
ªg°r
, 
ty≥
);

471 
XFREE
 (
MTYPE_TMP
, 
ªg°r
);

474 
	ga¶i°
 = 
as_li°_gë
 (
¨gv
[0]);

477 i‡(
as_li°_dup_check
 (
a¶i°
, 
asfûãr
))

478 
as_fûãr_‰ì
 (
asfûãr
);

480 
as_li°_fûãr_add
 (
a¶i°
, 
asfûãr
);

482  
	gCMD_SUCCESS
;

485 
DEFUN
 (
no_ù_as_∑th
,

486 
no_ù_as_∑th_cmd
,

488 
NO_STR


489 
IP_STR


497 
as_fûãr_ty≥
 
	gty≥
;

498 
as_fûãr
 *
	gasfûãr
;

499 
as_li°
 *
	ga¶i°
;

500 *
	gªg°r
;

501 
ªgex_t
 *
	gªgex
;

504 
	ga¶i°
 = 
as_li°_lookup
 (
¨gv
[0]);

505 i‡(
	ga¶i°
 =
NULL
)

507 
vty_out
 (
vty
, "ùás-∑thác˚ss-li° %†d€¢'àexi°%s", 
¨gv
[0],

508 
VTY_NEWLINE
);

509  
	gCMD_WARNING
;

513 i‡(
°∫cmp
 (
¨gv
[1], "p", 1) == 0)

514 
ty≥
 = 
AS_FILTER_PERMIT
;

515 i‡(
°∫cmp
 (
¨gv
[1], "d", 1) == 0)

516 
ty≥
 = 
AS_FILTER_DENY
;

519 
vty_out
 (
vty
, "fûã∏ty≥ mu° bê[≥rmô|díy]%s", 
VTY_NEWLINE
);

520  
	gCMD_WARNING
;

524 
	gªg°r
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 2);

526 
	gªgex
 = 
bgp_ªgcomp
 (
ªg°r
);

527 i‡(!
	gªgex
)

529 
XFREE
 (
MTYPE_TMP
, 
ªg°r
);

530 
vty_out
 (
vty
, "ˇn'àcompûêªgex∞%s%s", 
¨gv
[0],

531 
VTY_NEWLINE
);

532  
	gCMD_WARNING
;

536 
	gasfûãr
 = 
as_fûãr_lookup
 (
a¶i°
, 
ªg°r
, 
ty≥
);

538 
XFREE
 (
MTYPE_TMP
, 
ªg°r
);

539 
bgp_ªgex_‰ì
 (
ªgex
);

541 i‡(
	gasfûãr
 =
NULL
)

543 
vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

544  
	gCMD_WARNING
;

547 
as_li°_fûãr_dñëe
 (
a¶i°
, 
asfûãr
);

549  
	gCMD_SUCCESS
;

552 
DEFUN
 (
no_ù_as_∑th_Æl
,

553 
no_ù_as_∑th_Æl_cmd
,

555 
NO_STR


556 
IP_STR


561 
as_li°
 *
	ga¶i°
;

563 
	ga¶i°
 = 
as_li°_lookup
 (
¨gv
[0]);

564 i‡(
	ga¶i°
 =
NULL
)

566 
vty_out
 (
vty
, "ùás-∑thác˚ss-li° %†d€¢'àexi°%s", 
¨gv
[0],

567 
VTY_NEWLINE
);

568  
	gCMD_WARNING
;

571 
as_li°_dñëe
 (
a¶i°
);

574 i‡(
	gas_li°_ma°î
.
	gdñëe_hook
)

575 (*
	gas_li°_ma°î
.
	gdñëe_hook
) ();

577  
	gCMD_SUCCESS
;

581 
	$as_li°_show
 (
vty
 *vty, 
as_li°
 *
a¶i°
)

583 
as_fûãr
 *
asfûãr
;

585 
	`vty_out
 (
vty
, "ASÖ©hác˚s†li° %s%s", 
a¶i°
->
«me
, 
VTY_NEWLINE
);

587 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

589 
	`vty_out
 (
vty
, " %†%s%s", 
	`fûãr_ty≥_°r
 (
asfûãr
->
ty≥
),

590 
asfûãr
->
ªg_°r
, 
VTY_NEWLINE
);

592 
	}
}

595 
	$as_li°_show_Æl
 (
vty
 *vty)

597 
as_li°
 *
a¶i°
;

598 
as_fûãr
 *
asfûãr
;

600 
a¶i°
 = 
as_li°_ma°î
.
num
.
hód
;á¶i°;á¶i° =á¶i°->
√xt
)

602 
	`vty_out
 (
vty
, "ASÖ©hác˚s†li° %s%s", 
a¶i°
->
«me
, 
VTY_NEWLINE
);

604 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

606 
	`vty_out
 (
vty
, " %†%s%s", 
	`fûãr_ty≥_°r
 (
asfûãr
->
ty≥
),

607 
asfûãr
->
ªg_°r
, 
VTY_NEWLINE
);

611 
a¶i°
 = 
as_li°_ma°î
.
°r
.
hód
;á¶i°;á¶i° =á¶i°->
√xt
)

613 
	`vty_out
 (
vty
, "ASÖ©hác˚s†li° %s%s", 
a¶i°
->
«me
, 
VTY_NEWLINE
);

615 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

617 
	`vty_out
 (
vty
, " %†%s%s", 
	`fûãr_ty≥_°r
 (
asfûãr
->
ty≥
),

618 
asfûãr
->
ªg_°r
, 
VTY_NEWLINE
);

621 
	}
}

623 
DEFUN
 (
show_ù_as_∑th_ac˚ss_li°
,

624 
show_ù_as_∑th_ac˚ss_li°_cmd
,

626 
SHOW_STR


627 
IP_STR


631 
as_li°
 *
	ga¶i°
;

633 
	ga¶i°
 = 
as_li°_lookup
 (
¨gv
[0]);

634 i‡(
	ga¶i°
)

635 
as_li°_show
 (
vty
, 
a¶i°
);

637  
	gCMD_SUCCESS
;

640 
DEFUN
 (
show_ù_as_∑th_ac˚ss_li°_Æl
,

641 
show_ù_as_∑th_ac˚ss_li°_Æl_cmd
,

643 
SHOW_STR


644 
IP_STR


647 
as_li°_show_Æl
 (
vty
);

648  
	gCMD_SUCCESS
;

652 
	$c⁄fig_wrôe_as_li°
 (
vty
 *vty)

654 
as_li°
 *
a¶i°
;

655 
as_fûãr
 *
asfûãr
;

656 
wrôe
 = 0;

658 
a¶i°
 = 
as_li°_ma°î
.
num
.
hód
;á¶i°;á¶i° =á¶i°->
√xt
)

659 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

661 
	`vty_out
 (
vty
, "ipás-patháccess-list %s %s %s%s",

662 
a¶i°
->
«me
, 
	`fûãr_ty≥_°r
 (
asfûãr
->
ty≥
),

663 
asfûãr
->
ªg_°r
,

664 
VTY_NEWLINE
);

665 
wrôe
++;

668 
a¶i°
 = 
as_li°_ma°î
.
°r
.
hód
;á¶i°;á¶i° =á¶i°->
√xt
)

669 
asfûãr
 = 
a¶i°
->
hód
;ásfûãr;ásfûã∏asfûãr->
√xt
)

671 
	`vty_out
 (
vty
, "ipás-patháccess-list %s %s %s%s",

672 
a¶i°
->
«me
, 
	`fûãr_ty≥_°r
 (
asfûãr
->
ty≥
),

673 
asfûãr
->
ªg_°r
,

674 
VTY_NEWLINE
);

675 
wrôe
++;

677  
wrôe
;

678 
	}
}

680 
cmd_node
 
	gas_li°_node
 =

682 
AS_LIST_NODE
,

689 
	$bgp_fûãr_öô
 ()

691 
	`ö°Æl_node
 (&
as_li°_node
, 
c⁄fig_wrôe_as_li°
);

693 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_as_∑th_cmd
);

694 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_as_∑th_cmd
);

695 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_as_∑th_Æl_cmd
);

697 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_as_∑th_ac˚ss_li°_cmd
);

698 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_as_∑th_ac˚ss_li°_Æl_cmd
);

699 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_as_∑th_ac˚ss_li°_cmd
);

700 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_as_∑th_ac˚ss_li°_Æl_cmd
);

701 
	}
}

704 
	$bgp_fûãr_ª£t
 ()

706 
as_li°
 *
a¶i°
;

707 
as_li°
 *
√xt
;

709 
a¶i°
 = 
as_li°_ma°î
.
num
.
hód
;á¶i°;á¶i° = 
√xt
)

711 
√xt
 = 
a¶i°
->next;

712 
	`as_li°_dñëe
 (
a¶i°
);

715 
a¶i°
 = 
as_li°_ma°î
.
°r
.
hód
;á¶i°;á¶i° = 
√xt
)

717 
√xt
 = 
a¶i°
->next;

718 
	`as_li°_dñëe
 (
a¶i°
);

721 
	`as£π
 (
as_li°_ma°î
.
num
.
hód
 =
NULL
);

722 
	`as£π
 (
as_li°_ma°î
.
num
.
èû
 =
NULL
);

724 
	`as£π
 (
as_li°_ma°î
.
°r
.
hód
 =
NULL
);

725 
	`as£π
 (
as_li°_ma°î
.
°r
.
èû
 =
NULL
);

726 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_filter.h

21 #i‚de‡
_QUAGGA_BGP_FILTER_H


22 
	#_QUAGGA_BGP_FILTER_H


	)

24 
	eas_fûãr_ty≥


26 
	mAS_FILTER_DENY
,

27 
	mAS_FILTER_PERMIT


30 
bgp_fûãr_öô
 ();

31 
bgp_fûãr_ª£t
 ();

33 
as_fûãr_ty≥
 
as_li°_≠∂y
 (
as_li°
 *, *);

35 
as_li°
 *
as_li°_lookup
 (const *);

36 
as_li°_add_hook
 ((*
func
) ());

37 
	`as_li°_dñëe_hook
 ((*
func
) ());

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_fsm.c

22 
	~<zebø.h
>

24 
	~"lökli°.h
"

25 
	~"¥efix.h
"

26 
	~"vty.h
"

27 
	~"sockuni⁄.h
"

28 
	~"thªad.h
"

29 
	~"log.h
"

30 
	~"°ªam.h
"

31 
	~"mem‹y.h
"

32 
	~"∂i°.h
"

34 
	~"bgpd/bgpd.h
"

35 
	~"bgpd/bgp_©å.h
"

36 
	~"bgpd/bgp_debug.h
"

37 
	~"bgpd/bgp_fsm.h
"

38 
	~"bgpd/bgp_∑ckë.h
"

39 
	~"bgpd/bgp_√tw‹k.h
"

40 
	~"bgpd/bgp_rouã.h
"

41 
	~"bgpd/bgp_dump.h
"

42 
	~"bgpd/bgp_›í.h
"

43 #ifde‡
HAVE_SNMP


44 
	~"bgpd/bgp_¢mp.h
"

53 
bgp_evít
 (
thªad
 *);

56 
bgp_°¨t_timî
 (
thªad
 *);

57 
bgp_c⁄√˘_timî
 (
thªad
 *);

58 
bgp_hﬁdtime_timî
 (
thªad
 *);

59 
bgp_kì∑live_timî
 (
thªad
 *);

62 
bgp_°¨t
 (
≥î
 *);

66 
	$bgp_°¨t_jôãr
 (
time
)

68  ((
	`ønd
 (Ë% (
time
 + 1)) - (time / 2));

69 
	}
}

72 
	#BGP_PEER_START_SUPPRESSED
(
P
) \

73 (
	`CHECK_FLAG
 ((
P
)->
Êags
, 
PEER_FLAG_SHUTDOWN
) \

74 || 
	`CHECK_FLAG
 ((
P
)->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
))

	)

80 
	$bgp_timî_£t
 (
≥î
 *peer)

82 
jôãr
 = 0;

84 
≥î
->
°©us
)

86 
IdÀ
:

90 i‡(
	`BGP_PEER_START_SUPPRESSED
 (
≥î
Ë|| ! 
	`≥î_a˘ive
 (peer))

92 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

96 
jôãr
 = 
	`bgp_°¨t_jôãr
 (
≥î
->
v_°¨t
);

97 
	`BGP_TIMER_ON
 (
≥î
->
t_°¨t
, 
bgp_°¨t_timî
,

98 
≥î
->
v_°¨t
 + 
jôãr
);

100 
	`BGP_TIMER_OFF
 (
≥î
->
t_c⁄√˘
);

101 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

102 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

103 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

104 
	`BGP_TIMER_OFF
 (
≥î
->
t_rouãadv
);

107 
C⁄√˘
:

111 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

112 
	`BGP_TIMER_ON
 (
≥î
->
t_c⁄√˘
, 
bgp_c⁄√˘_timî
,Öìr->
v_c⁄√˘
);

113 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

114 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

115 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

116 
	`BGP_TIMER_OFF
 (
≥î
->
t_rouãadv
);

119 
A˘ive
:

122 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

124 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_PASSIVE
)

125 || 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
))

127 
	`BGP_TIMER_OFF
 (
≥î
->
t_c⁄√˘
);

131 
	`BGP_TIMER_ON
 (
≥î
->
t_c⁄√˘
, 
bgp_c⁄√˘_timî
,Öìr->
v_c⁄√˘
);

133 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

134 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

135 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

136 
	`BGP_TIMER_OFF
 (
≥î
->
t_rouãadv
);

139 
O≥nSít
:

141 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

142 
	`BGP_TIMER_OFF
 (
≥î
->
t_c⁄√˘
);

143 i‡(
≥î
->
v_hﬁdtime
 != 0)

145 
	`BGP_TIMER_ON
 (
≥î
->
t_hﬁdtime
, 
bgp_hﬁdtime_timî
,

146 
≥î
->
v_hﬁdtime
);

150 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

152 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

153 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

154 
	`BGP_TIMER_OFF
 (
≥î
->
t_rouãadv
);

157 
O≥nC⁄fúm
:

159 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

160 
	`BGP_TIMER_OFF
 (
≥î
->
t_c⁄√˘
);

164 i‡(
≥î
->
v_hﬁdtime
 == 0)

166 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

167 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

171 
	`BGP_TIMER_ON
 (
≥î
->
t_hﬁdtime
, 
bgp_hﬁdtime_timî
,

172 
≥î
->
v_hﬁdtime
);

173 
	`BGP_TIMER_ON
 (
≥î
->
t_kì∑live
, 
bgp_kì∑live_timî
,

174 
≥î
->
v_kì∑live
);

176 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

177 
	`BGP_TIMER_OFF
 (
≥î
->
t_rouãadv
);

180 
E°ablished
:

183 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

184 
	`BGP_TIMER_OFF
 (
≥î
->
t_c⁄√˘
);

188 i‡(
≥î
->
v_hﬁdtime
 == 0)

190 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

191 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

195 
	`BGP_TIMER_ON
 (
≥î
->
t_hﬁdtime
, 
bgp_hﬁdtime_timî
,

196 
≥î
->
v_hﬁdtime
);

197 
	`BGP_TIMER_ON
 (
≥î
->
t_kì∑live
, 
bgp_kì∑live_timî
,

198 
≥î
->
v_kì∑live
);

200 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

202 
Dñëed
:

203 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_ª°¨t
);

204 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_°Æe
);

205 
	`BGP_TIMER_OFF
 (
≥î
->
t_pmax_ª°¨t
);

206 
CÀ¨ög
:

207 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

208 
	`BGP_TIMER_OFF
 (
≥î
->
t_c⁄√˘
);

209 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

210 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

211 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

212 
	`BGP_TIMER_OFF
 (
≥î
->
t_rouãadv
);

214 
	}
}

219 
	$bgp_°¨t_timî
 (
thªad
 *thread)

221 
≥î
 *peer;

223 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

224 
≥î
->
t_°¨t
 = 
NULL
;

226 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

227 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

228 "%†[FSM] Timî (°¨àtimîÉxpúe).", 
≥î
->
ho°
);

230 
	`THREAD_VAL
 (
thªad
Ë
BGP_Sèπ
;

231 
	`bgp_evít
 (
thªad
);

234 
	}
}

238 
	$bgp_c⁄√˘_timî
 (
thªad
 *thread)

240 
≥î
 *peer;

242 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

243 
≥î
->
t_c⁄√˘
 = 
NULL
;

245 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

246 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%s [FSM] Timer (connectÅimerÉxpire)",

247 
≥î
->
ho°
);

249 
	`THREAD_VAL
 (
thªad
Ë
C⁄√˘Rëry_timî_expúed
;

250 
	`bgp_evít
 (
thªad
);

253 
	}
}

257 
	$bgp_hﬁdtime_timî
 (
thªad
 *thread)

259 
≥î
 *peer;

261 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

262 
≥î
->
t_hﬁdtime
 = 
NULL
;

264 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

265 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

267 
≥î
->
ho°
);

269 
	`THREAD_VAL
 (
thªad
Ë
Hﬁd_Timî_expúed
;

270 
	`bgp_evít
 (
thªad
);

273 
	}
}

277 
	$bgp_kì∑live_timî
 (
thªad
 *thread)

279 
≥î
 *peer;

281 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

282 
≥î
->
t_kì∑live
 = 
NULL
;

284 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

285 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

287 
≥î
->
ho°
);

289 
	`THREAD_VAL
 (
thªad
Ë
KìpAlive_timî_expúed
;

290 
	`bgp_evít
 (
thªad
);

293 
	}
}

296 
	$bgp_rouãadv_timî
 (
thªad
 *thread)

298 
≥î
 *peer;

300 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

301 
≥î
->
t_rouãadv
 = 
NULL
;

303 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

304 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

306 
≥î
->
ho°
);

308 
≥î
->
syn˘ime
 = 
	`bgp_˛ock
 ();

310 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

312 
	`BGP_TIMER_ON
 (
≥î
->
t_rouãadv
, 
bgp_rouãadv_timî
,

313 
≥î
->
v_rouãadv
);

316 
	}
}

319 c⁄° *
	g≥î_down_°r
[] =

347 
	$bgp_gø˚ful_ª°¨t_timî_expúe
 (
thªad
 *thread)

349 
≥î
 *peer;

350 
afi_t
 
afi
;

351 
ßfi_t
 
ßfi
;

353 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

354 
≥î
->
t_gr_ª°¨t
 = 
NULL
;

357 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

358 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_RESERVED_3
 ; safi++)

359 i‡(
≥î
->
nsf
[
afi
][
ßfi
])

360 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
afi
, 
ßfi
);

362 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
);

363 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_°Æe
);

365 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

367 
	`zlog_debug
 ("%†gø˚fu»ª°¨àtimîÉxpúed", 
≥î
->
ho°
);

368 
	`zlog_debug
 ("%†gø˚fu»ª°¨à°Æï©hÅimî st›≥d", 
≥î
->
ho°
);

371 
	`bgp_timî_£t
 (
≥î
);

374 
	}
}

377 
	$bgp_gø˚ful_°Æe_timî_expúe
 (
thªad
 *thread)

379 
≥î
 *peer;

380 
afi_t
 
afi
;

381 
ßfi_t
 
ßfi
;

383 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

384 
≥î
->
t_gr_°Æe
 = 
NULL
;

386 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

387 
	`zlog_debug
 ("%†gø˚fu»ª°¨à°Æï©hÅimîÉxpúed", 
≥î
->
ho°
);

390 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

391 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_RESERVED_3
 ; safi++)

392 i‡(
≥î
->
nsf
[
afi
][
ßfi
])

393 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
afi
, 
ßfi
);

396 
	}
}

401 
	$bgp_fsm_ch™ge_°©us
 (
≥î
 *≥î, 
°©us
)

403 
	`bgp_dump_°©e
 (
≥î
,Öìr->
°©us
, status);

408 i‡(
°©us
 >
CÀ¨ög
)

409 
	`bgp_˛ór_rouã_Æl
 (
≥î
);

412 
≥î
->
o°©us
 =Öìr->
°©us
;

413 
≥î
->
°©us
 = status;

415 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

416 
	`zlog_debug
 ("%s went from %sÅo %s",

417 
≥î
->
ho°
,

418 
	`LOOKUP
 (
bgp_°©us_msg
, 
≥î
->
o°©us
),

419 
	`LOOKUP
 (
bgp_°©us_msg
, 
≥î
->
°©us
));

420 
	}
}

424 
	$bgp_˛órög_com∂ëed
 (
≥î
 *peer)

426 
rc
 = 
	`bgp_°›
(
≥î
);

427 
	`BGP_EVENT_FLUSH
 (
≥î
);

429  
rc
;

430 
	}
}

435 
	$bgp_°›
 (
≥î
 *peer)

437 
afi_t
 
afi
;

438 
ßfi_t
 
ßfi
;

439 
‹f_«me
[
BUFSIZ
];

442 i‡(
≥î
->
°©us
 !
CÀ¨ög
)

445 
	`BGP_EVENT_FLUSH
 (
≥î
);

449 i‡(
≥î
->
°©us
 =
E°ablished
)

451 
≥î
->
dr›≥d
++;

454 i‡(
	`bgp_Êag_check
 (
≥î
->
bgp
, 
BGP_FLAG_LOG_NEIGHBOR_CHANGES
))

455 
	`zlog_öfo
 ("%%ADJCHANGE:Çeighb‹ %†Dow¿%s", 
≥î
->
ho°
,

456 
≥î_down_°r
 [(Ë
≥î
->
œ°_ª£t
]);

459 i‡(
≥î
->
t_gr_°Æe
)

461 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_°Æe
);

462 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

463 
	`zlog_debug
 ("%†gø˚fu»ª°¨à°Æï©hÅimî st›≥d", 
≥î
->
ho°
);

465 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
))

467 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

469 
	`zlog_debug
 ("%s gracefulÑestartÅimer started for %d sec",

470 
≥î
->
ho°
,Öìr->
v_gr_ª°¨t
);

471 
	`zlog_debug
 ("%s gracefulÑestart stalepathÅimer started for %d sec",

472 
≥î
->
ho°
,Öìr->
bgp
->
°Æï©h_time
);

474 
	`BGP_TIMER_ON
 (
≥î
->
t_gr_ª°¨t
, 
bgp_gø˚ful_ª°¨t_timî_expúe
,

475 
≥î
->
v_gr_ª°¨t
);

476 
	`BGP_TIMER_ON
 (
≥î
->
t_gr_°Æe
, 
bgp_gø˚ful_°Æe_timî_expúe
,

477 
≥î
->
bgp
->
°Æï©h_time
);

481 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_MODE
);

483 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

484 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_RESERVED_3
 ; safi++)

485 
≥î
->
nsf
[
afi
][
ßfi
] = 0;

489 
≥î
->
ª£âime
 =Öìr->
u±ime
 = 
	`bgp_˛ock
 ();

491 #ifde‡
HAVE_SNMP


492 
	`bgpTøpBackw¨dTønsôi⁄
 (
≥î
);

496 
≥î
->
syn˘ime
 = 0;

500 
	`BGP_READ_OFF
 (
≥î
->
t_ªad
);

501 
	`BGP_WRITE_OFF
 (
≥î
->
t_wrôe
);

504 
	`BGP_TIMER_OFF
 (
≥î
->
t_°¨t
);

505 
	`BGP_TIMER_OFF
 (
≥î
->
t_c⁄√˘
);

506 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

507 
	`BGP_TIMER_OFF
 (
≥î
->
t_kì∑live
);

508 
	`BGP_TIMER_OFF
 (
≥î
->
t_as‹ig
);

509 
	`BGP_TIMER_OFF
 (
≥î
->
t_rouãadv
);

512 
≥î
->
∑ckë_size
 = 0;

515 i‡(
≥î
->
ibuf
)

516 
	`°ªam_ª£t
 (
≥î
->
ibuf
);

517 i‡(
≥î
->
w‹k
)

518 
	`°ªam_ª£t
 (
≥î
->
w‹k
);

519 i‡(
≥î
->
obuf
)

520 
	`°ªam_fifo_˛ón
 (
≥î
->
obuf
);

523 i‡(
≥î
->
fd
 >= 0)

525 
	`˛o£
 (
≥î
->
fd
);

526 
≥î
->
fd
 = -1;

529 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

530 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

533 
≥î
->
afc_√go
[
afi
][
ßfi
] = 0;

534 
≥î
->
afc_adv
[
afi
][
ßfi
] = 0;

535 
≥î
->
afc_ªcv
[
afi
][
ßfi
] = 0;

538 
≥î
->
af_ˇp
[
afi
][
ßfi
] = 0;

541 
≥î
->
af_sÊags
[
afi
][
ßfi
] = 0;

544 
≥î
->
‹f_∂i°
[
afi
][
ßfi
] = 
NULL
;

547 
	`•rötf
 (
‹f_«me
, "%s.%d.%d", 
≥î
->
ho°
, 
afi
, 
ßfi
);

548 
	`¥efix_bgp_‹f_ªmove_Æl
 (
‹f_«me
);

552 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
))

554 
≥î
->
v_kì∑live
 =Öìr->
kì∑live
;

555 
≥î
->
v_hﬁdtime
 =Öìr->
hﬁdtime
;

559 
≥î
->
v_kì∑live
 =Öìr->
bgp
->
deÁu…_kì∑live
;

560 
≥î
->
v_hﬁdtime
 =Öìr->
bgp
->
deÁu…_hﬁdtime
;

563 
≥î
->
upd©e_time
 = 0;

569 
≥î
->
pcou¡
[
AFI_IP
][
SAFI_UNICAST
] = 0;

570 
≥î
->
pcou¡
[
AFI_IP
][
SAFI_MULTICAST
] = 0;

571 
≥î
->
pcou¡
[
AFI_IP
][
SAFI_MPLS_VPN
] = 0;

572 
≥î
->
pcou¡
[
AFI_IP6
][
SAFI_UNICAST
] = 0;

573 
≥î
->
pcou¡
[
AFI_IP6
][
SAFI_MULTICAST
] = 0;

577 
	}
}

581 
	$bgp_°›_wôh_îr‹
 (
≥î
 *peer)

584 
≥î
->
v_°¨t
 *= 2;

587 i‡(
≥î
->
v_°¨t
 >= (60 * 2))

588 
≥î
->
v_°¨t
 = (60 * 2);

590 
	`bgp_°›
 (
≥î
);

593 
	}
}

598 
	$bgp_c⁄√˘_suc˚ss
 (
≥î
 *peer)

600 i‡(
≥î
->
fd
 < 0)

602 
	`zlog_îr
 ("bgp_connect_successÖeer's fd isÇegative value %d",

603 
≥î
->
fd
);

606 
	`BGP_READ_ON
 (
≥î
->
t_ªad
, 
bgp_ªad
,Öìr->
fd
);

608 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

609 
	`bgp_gësock«me
 (
≥î
);

611 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

613 
buf1
[
SU_ADDRSTRLEN
];

615 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

616 
	`zlog_debug
 ("%†›íá˘ive,Üoˇ»addªs†%s", 
≥î
->
ho°
,

617 
	`sockuni⁄2°r
 (
≥î
->
su_loˇl
, 
buf1
, 
SU_ADDRSTRLEN
));

619 
	`zlog_debug
 ("%†∑ssivê›í", 
≥î
->
ho°
);

622 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

623 
	`bgp_›í_£nd
 (
≥î
);

626 
	}
}

630 
	$bgp_c⁄√˘_Áû
 (
≥î
 *peer)

632 
	`bgp_°›
 (
≥î
);

634 
	}
}

639 
	$bgp_°¨t
 (
≥î
 *peer)

641 
°©us
;

643 i‡(
	`BGP_PEER_START_SUPPRESSED
 (
≥î
))

645 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

646 
	`∂og_îr
 (
≥î
->
log
, "%s [FSM] TryingÅo start suppressedÖeer"

647 " -Åhi†i†√vî suµo£dÅÿh≠≥n!", 
≥î
->
ho°
);

655 i‡(
≥î
->
su_loˇl
)

657 
	`sockuni⁄_‰ì
 (
≥î
->
su_loˇl
);

658 
≥î
->
su_loˇl
 = 
NULL
;

661 i‡(
≥î
->
su_ªmŸe
)

663 
	`sockuni⁄_‰ì
 (
≥î
->
su_ªmŸe
);

664 
≥î
->
su_ªmŸe
 = 
NULL
;

668 
≥î
->
ªmŸe_id
.
s_addr
 = 0;

671 
≥î
->
ˇp
 = 0;

674 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_PASSIVE
))

676 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_c⁄√˘i⁄_›í_Áûed
);

680 
°©us
 = 
	`bgp_c⁄√˘
 (
≥î
);

682 
°©us
)

684 
c⁄√˘_îr‹
:

685 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

686 
	`∂og_debug
 (
≥î
->
log
, "%†[FSM] C⁄√˘Éº‹",Öìr->
ho°
);

687 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_c⁄√˘i⁄_›í_Áûed
);

689 
c⁄√˘_suc˚ss
:

690 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

691 
	`∂og_debug
 (
≥î
->
log
, "%s [FSM] Connect immediately success",

692 
≥î
->
ho°
);

693 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_c⁄√˘i⁄_›í
);

695 
c⁄√˘_ö_¥ogªss
:

698 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

699 
	`∂og_debug
 (
≥î
->
log
, "%s [FSM] Non blocking connect waitingÑesult",

700 
≥î
->
ho°
);

701 i‡(
≥î
->
fd
 < 0)

703 
	`zlog_îr
 ("bgp_startÖeer's fd isÇegative value %d",

704 
≥î
->
fd
);

707 
	`BGP_READ_ON
 (
≥î
->
t_ªad
, 
bgp_ªad
,Öìr->
fd
);

708 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

712 
	}
}

716 
	$bgp_ªc⁄√˘
 (
≥î
 *peer)

718 
	`bgp_°›
 (
≥î
);

719 
	`bgp_°¨t
 (
≥î
);

721 
	}
}

724 
	$bgp_fsm_›í
 (
≥î
 *peer)

727 
	`bgp_kì∑live_£nd
 (
≥î
);

730 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

733 
	}
}

737 
	$bgp_fsm_kì∑live_expúe
 (
≥î
 *peer)

739 
	`bgp_kì∑live_£nd
 (
≥î
);

741 
	}
}

746 
	$bgp_fsm_hﬁdtime_expúe
 (
≥î
 *peer)

748 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

749 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%†[FSM] HﬁdÅimîÉxpúe",Öìr->
ho°
);

752 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_HOLD_ERR
, 0);

755 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

757 
	`zlog_öfo
 ("%†[Evít] Ac˚±ög BGPÖì∏i†dñëed", 
≥î
->
ho°
);

758 
	`≥î_dñëe
 (
≥î
);

763 
	`bgp_°›
(
≥î
);

766 
	}
}

771 
	$bgp_e°ablish
 (
≥î
 *peer)

773 
bgp_nŸify
 *
nŸify
;

774 
afi_t
 
afi
;

775 
ßfi_t
 
ßfi
;

776 
nsf_af_cou¡
 = 0;

779 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_CAPABILITY_OPEN
))

780 
	`SET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_CAPABILITY_OPEN
);

783 
nŸify
 = &
≥î
->notify;

784 i‡(
nŸify
->
d©a
)

785 
	`XFREE
 (
MTYPE_TMP
, 
nŸify
->
d©a
);

786 
	`mem£t
 (
nŸify
, 0,  (
bgp_nŸify
));

789 
≥î
->
v_°¨t
 = 
BGP_INIT_START_TIMER
;

792 
≥î
->
e°ablished
++;

793 
	`bgp_fsm_ch™ge_°©us
 (
≥î
, 
E°ablished
);

796 i‡(
	`bgp_Êag_check
 (
≥î
->
bgp
, 
BGP_FLAG_LOG_NEIGHBOR_CHANGES
))

797 
	`zlog_öfo
 ("%%ADJCHANGE:Çeighb‹ %†Up", 
≥î
->
ho°
);

800 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
);

801 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

802 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_RESERVED_3
 ; safi++)

804 i‡(
≥î
->
afc_√go
[
afi
][
ßfi
]

805 && 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_RESTART_ADV
)

806 && 
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_RESTART_AF_RCV
))

808 i‡(
≥î
->
nsf
[
afi
][
ßfi
]

809 && ! 
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_RESTART_AF_PRESERVE_RCV
))

810 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
afi
, 
ßfi
);

812 
≥î
->
nsf
[
afi
][
ßfi
] = 1;

813 
nsf_af_cou¡
++;

817 i‡(
≥î
->
nsf
[
afi
][
ßfi
])

818 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
afi
, 
ßfi
);

819 
≥î
->
nsf
[
afi
][
ßfi
] = 0;

823 i‡(
nsf_af_cou¡
)

824 
	`SET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_MODE
);

827 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_MODE
);

828 i‡(
≥î
->
t_gr_°Æe
)

830 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_°Æe
);

831 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

832 
	`zlog_debug
 ("%†gø˚fu»ª°¨à°Æï©hÅimî st›≥d", 
≥î
->
ho°
);

836 i‡(
≥î
->
t_gr_ª°¨t
)

838 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_ª°¨t
);

839 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

840 
	`zlog_debug
 ("%†gø˚fu»ª°¨àtimî st›≥d", 
≥î
->
ho°
);

843 #ifde‡
HAVE_SNMP


844 
	`bgpTøpE°ablished
 (
≥î
);

848 
≥î
->
u±ime
 = 
	`bgp_˛ock
 ();

851 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

852 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

853 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_ADV
))

855 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_RCV
))

856 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
, 
ORF_TYPE_PREFIX
,

857 
REFRESH_IMMEDIATE
, 0);

858 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_OLD_RCV
))

859 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
, 
ORF_TYPE_PREFIX_OLD
,

860 
REFRESH_IMMEDIATE
, 0);

863 i‡(
≥î
->
v_kì∑live
)

864 
	`bgp_kì∑live_£nd
 (
≥î
);

867 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

868 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

869 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
))

870 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_RCV
)

871 || 
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_OLD_RCV
))

872 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_WAIT_REFRESH
);

874 
	`bgp_™noun˚_rouã_Æl
 (
≥î
);

876 
	`BGP_TIMER_ON
 (
≥î
->
t_rouãadv
, 
bgp_rouãadv_timî
, 1);

879 
	}
}

883 
	$bgp_fsm_kì∑live
 (
≥î
 *peer)

886 
≥î
->
kì∑live_ö
++;

888 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

890 
	}
}

894 
	$bgp_fsm_upd©e
 (
≥î
 *peer)

896 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

898 
	}
}

902 
	$bgp_ign‹e
 (
≥î
 *peer)

904 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
))

905 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%†[FSM] bgp_ign‹êˇŒed",Öìr->
ho°
);

907 
	}
}

911 (*
	mfunc
Ë(
	m≥î
 *);

912 
	m√xt_°©e
;

913 } 
	gFSM
 [
BGP_STATUS_MAX
 - 1][
BGP_EVENTS_MAX
 - 1] =

919 {
bgp_°¨t
, 
C⁄√˘
},

920 {
bgp_°›
, 
IdÀ
},

921 {
bgp_°›
, 
IdÀ
},

922 {
bgp_°›
, 
IdÀ
},

923 {
bgp_ign‹e
, 
IdÀ
},

924 {
bgp_°›
, 
IdÀ
},

925 {
bgp_ign‹e
, 
IdÀ
},

926 {
bgp_ign‹e
, 
IdÀ
},

927 {
bgp_ign‹e
, 
IdÀ
},

928 {
bgp_ign‹e
, 
IdÀ
},

929 {
bgp_ign‹e
, 
IdÀ
},

930 {
bgp_ign‹e
, 
IdÀ
},

931 {
bgp_ign‹e
, 
IdÀ
},

932 {
bgp_ign‹e
, 
IdÀ
},

936 {
bgp_ign‹e
, 
C⁄√˘
},

937 {
bgp_°›
, 
IdÀ
},

938 {
bgp_c⁄√˘_suc˚ss
, 
O≥nSít
},

939 {
bgp_°›
, 
IdÀ
},

940 {
bgp_c⁄√˘_Áû
, 
A˘ive
},

941 {
bgp_c⁄√˘_Áû
, 
IdÀ
},

942 {
bgp_ªc⁄√˘
, 
C⁄√˘
},

943 {
bgp_ign‹e
, 
IdÀ
},

944 {
bgp_ign‹e
, 
IdÀ
},

945 {
bgp_ign‹e
, 
IdÀ
},

946 {
bgp_ign‹e
, 
IdÀ
},

947 {
bgp_ign‹e
, 
IdÀ
},

948 {
bgp_°›
, 
IdÀ
},

949 {
bgp_ign‹e
, 
IdÀ
},

953 {
bgp_ign‹e
, 
A˘ive
},

954 {
bgp_°›
, 
IdÀ
},

955 {
bgp_c⁄√˘_suc˚ss
, 
O≥nSít
},

956 {
bgp_°›
, 
IdÀ
},

957 {
bgp_ign‹e
, 
A˘ive
},

958 {
bgp_ign‹e
, 
IdÀ
},

959 {
bgp_°¨t
, 
C⁄√˘
},

960 {
bgp_ign‹e
, 
IdÀ
},

961 {
bgp_ign‹e
, 
IdÀ
},

962 {
bgp_ign‹e
, 
IdÀ
},

963 {
bgp_ign‹e
, 
IdÀ
},

964 {
bgp_ign‹e
, 
IdÀ
},

965 {
bgp_°›_wôh_îr‹
, 
IdÀ
},

966 {
bgp_ign‹e
, 
IdÀ
},

970 {
bgp_ign‹e
, 
O≥nSít
},

971 {
bgp_°›
, 
IdÀ
},

972 {
bgp_°›
, 
A˘ive
},

973 {
bgp_°›
, 
A˘ive
},

974 {
bgp_°›
, 
A˘ive
},

975 {
bgp_°›
, 
A˘ive
},

976 {
bgp_ign‹e
, 
IdÀ
},

977 {
bgp_fsm_hﬁdtime_expúe
, 
IdÀ
},

978 {
bgp_ign‹e
, 
IdÀ
},

979 {
bgp_fsm_›í
, 
O≥nC⁄fúm
},

980 {
bgp_ign‹e
, 
IdÀ
},

981 {
bgp_ign‹e
, 
IdÀ
},

982 {
bgp_°›_wôh_îr‹
, 
IdÀ
},

983 {
bgp_ign‹e
, 
IdÀ
},

987 {
bgp_ign‹e
, 
O≥nC⁄fúm
},

988 {
bgp_°›
, 
IdÀ
},

989 {
bgp_°›
, 
IdÀ
},

990 {
bgp_°›
, 
IdÀ
},

991 {
bgp_°›
, 
IdÀ
},

992 {
bgp_°›
, 
IdÀ
},

993 {
bgp_ign‹e
, 
IdÀ
},

994 {
bgp_fsm_hﬁdtime_expúe
, 
IdÀ
},

995 {
bgp_ign‹e
, 
O≥nC⁄fúm
},

996 {
bgp_ign‹e
, 
IdÀ
},

997 {
bgp_e°ablish
, 
E°ablished
},

998 {
bgp_ign‹e
, 
IdÀ
},

999 {
bgp_°›_wôh_îr‹
, 
IdÀ
},

1000 {
bgp_ign‹e
, 
IdÀ
},

1004 {
bgp_ign‹e
, 
E°ablished
},

1005 {
bgp_°›
, 
CÀ¨ög
},

1006 {
bgp_°›
, 
CÀ¨ög
},

1007 {
bgp_°›
, 
CÀ¨ög
},

1008 {
bgp_°›
, 
CÀ¨ög
},

1009 {
bgp_°›
, 
CÀ¨ög
},

1010 {
bgp_°›
, 
CÀ¨ög
},

1011 {
bgp_fsm_hﬁdtime_expúe
, 
CÀ¨ög
},

1012 {
bgp_fsm_kì∑live_expúe
, 
E°ablished
},

1013 {
bgp_°›
, 
CÀ¨ög
},

1014 {
bgp_fsm_kì∑live
, 
E°ablished
},

1015 {
bgp_fsm_upd©e
, 
E°ablished
},

1016 {
bgp_°›_wôh_îr‹
, 
CÀ¨ög
},

1017 {
bgp_ign‹e
, 
IdÀ
},

1021 {
bgp_ign‹e
, 
CÀ¨ög
},

1022 {
bgp_°›
, 
CÀ¨ög
},

1023 {
bgp_°›
, 
CÀ¨ög
},

1024 {
bgp_°›
, 
CÀ¨ög
},

1025 {
bgp_°›
, 
CÀ¨ög
},

1026 {
bgp_°›
, 
CÀ¨ög
},

1027 {
bgp_°›
, 
CÀ¨ög
},

1028 {
bgp_°›
, 
CÀ¨ög
},

1029 {
bgp_°›
, 
CÀ¨ög
},

1030 {
bgp_°›
, 
CÀ¨ög
},

1031 {
bgp_°›
, 
CÀ¨ög
},

1032 {
bgp_°›
, 
CÀ¨ög
},

1033 {
bgp_°›
, 
CÀ¨ög
},

1034 {
bgp_˛órög_com∂ëed
, 
IdÀ
},

1038 {
bgp_ign‹e
, 
Dñëed
},

1039 {
bgp_ign‹e
, 
Dñëed
},

1040 {
bgp_ign‹e
, 
Dñëed
},

1041 {
bgp_ign‹e
, 
Dñëed
},

1042 {
bgp_ign‹e
, 
Dñëed
},

1043 {
bgp_ign‹e
, 
Dñëed
},

1044 {
bgp_ign‹e
, 
Dñëed
},

1045 {
bgp_ign‹e
, 
Dñëed
},

1046 {
bgp_ign‹e
, 
Dñëed
},

1047 {
bgp_ign‹e
, 
Dñëed
},

1048 {
bgp_ign‹e
, 
Dñëed
},

1049 {
bgp_ign‹e
, 
Dñëed
},

1050 {
bgp_ign‹e
, 
Dñëed
},

1051 {
bgp_ign‹e
, 
Dñëed
},

1055 c⁄° *
	gbgp_evít_°r
[] =

1057 
NULL
,

1076 
	$bgp_evít
 (
thªad
 *thread)

1078 
ªt
 = 0;

1079 
evít
;

1080 
√xt
;

1081 
≥î
 *peer;

1083 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

1084 
evít
 = 
	`THREAD_VAL
 (
thªad
);

1087 
√xt
 = 
FSM
 [
≥î
->
°©us
 -1][
evít
 - 1].
√xt_°©e
;

1089 i‡(
	`BGP_DEBUG
 (
fsm
, 
FSM
Ë&& 
≥î
->
°©us
 !
√xt
)

1090 
	`∂og_debug
 (
≥î
->
log
, "%†[FSM] %†(%s->%s)",Öìr->
ho°
,

1091 
bgp_evít_°r
[
evít
],

1092 
	`LOOKUP
 (
bgp_°©us_msg
, 
≥î
->
°©us
),

1093 
	`LOOKUP
 (
bgp_°©us_msg
, 
√xt
));

1096 i‡(
FSM
 [
≥î
->
°©us
 -1][
evít
 - 1].
func
)

1097 
ªt
 = (*(
FSM
 [
≥î
->
°©us
 - 1][
evít
 - 1].
func
))(peer);

1100 i‡(
ªt
 >= 0)

1103 i‡(
√xt
 !
≥î
->
°©us
)

1104 
	`bgp_fsm_ch™ge_°©us
 (
≥î
, 
√xt
);

1107 
	`bgp_timî_£t
 (
≥î
);

1110  
ªt
;

1111 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_fsm.h

22 #i‚de‡
_QUAGGA_BGP_FSM_H


23 
	#_QUAGGA_BGP_FSM_H


	)

26 
	#BGP_READ_ON
(
T
,
F
,
V
) \

28 i‡(!(
T
Ë&& (
≥î
->
°©us
 !
Dñëed
)) \

29 
	`THREAD_READ_ON
(
ma°î
,
T
,
F
,
≥î
,
V
); \

30 } 0)

	)

32 
	#BGP_READ_OFF
(
T
) \

34 i‡(
T
) \

35 
	`THREAD_READ_OFF
(
T
); \

36 } 0)

	)

38 
	#BGP_WRITE_ON
(
T
,
F
,
V
) \

40 i‡(!(
T
Ë&& (
≥î
->
°©us
 !
Dñëed
)) \

41 
	`THREAD_WRITE_ON
(
ma°î
,(
T
),(
F
),
≥î
,(
V
)); \

42 } 0)

	)

44 
	#BGP_WRITE_OFF
(
T
) \

46 i‡(
T
) \

47 
	`THREAD_WRITE_OFF
(
T
); \

48 } 0)

	)

50 
	#BGP_TIMER_ON
(
T
,
F
,
V
) \

52 i‡(!(
T
Ë&& (
≥î
->
°©us
 !
Dñëed
)) \

53 
	`THREAD_TIMER_ON
(
ma°î
,(
T
),(
F
),
≥î
,(
V
)); \

54 } 0)

	)

56 
	#BGP_TIMER_OFF
(
T
) \

58 i‡(
T
) \

59 
	`THREAD_TIMER_OFF
(
T
); \

60 } 0)

	)

62 
	#BGP_EVENT_ADD
(
P
,
E
) \

64 i‡((
P
)->
°©us
 !
Dñëed
) \

65 
	`thªad_add_evít
 (
ma°î
, 
bgp_evít
, (
P
), (
E
)); \

66 } 0)

	)

68 
	#BGP_EVENT_FLUSH
(
P
) \

70 
	`as£π
 (
≥î
); \

71 
	`thªad_ˇn˚l_evít
 (
ma°î
, (
P
)); \

72 } 0)

	)

75 
bgp_evít
 (
thªad
 *);

76 
bgp_°›
 (
≥î
 *peer);

77 
bgp_timî_£t
 (
≥î
 *);

78 
bgp_fsm_ch™ge_°©us
 (
≥î
 *≥î, 
°©us
);

79 c⁄° *
≥î_down_°r
[];

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_grpc.c

1 #ifde‡
USE_GRPC


3 
Im∂eGoSåómThªad
 (
SRxProxy
* 
¥oxy
, 
uöt32_t
 
¥oxyID
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_info_hash.c

31 
	~<zebø.h
>

33 #ifde‡
USE_SRX


35 
	~"comm™d.h
"

36 
	~"lökli°.h
"

37 
	~"mem‹y.h
"

38 
	~"¥efix.h
"

39 
	~"vty.h
"

41 
	~"bgpd/bgpd.h
"

42 
	~"bgpd/bgp_a•©h.h
"

43 
	~"bgpd/bgp_©å.h
"

44 
	~"bgpd/bgp_öfo_hash.h
"

45 
	~"bgpd/bgp_rouã.h
"

46 
	~"bgpd/bgp_èbÀ.h
"

48 
	#SHOW_SCODE_HEADER
 "VÆid©i⁄ code: v vÆid,ÇÇŸfound, i invÆid, ? undeföed%s%s"

	)

49 
	#SHOW_HEADER
 " Idíà Nëw‹k I LocPr‡P©h%s"

	)

51 
	$show_öfo_hash
 (
vty
* vty, 
bgp
* bgp,

52 
bgp_öfo_hash
 *
hash
)

54 c⁄° 
RES_CODE_CHAR
[] = { 'v', 'n', 'i', '?' };

56 
bgp_öfo_hash_ôem
* 
cuº
;

57 
pbuf
[
INET6_ADDRSTRLEN
];

58 
©å
*áttr;

59 
vÆSèã
;

61 i‡(
	`HASH_COUNT
 (
hash
->
èbÀ
) == 0)

63 
	`vty_out
 (
vty
, " (Nÿíåõs)%s%s", 
VTY_NEWLINE
, VTY_NEWLINE);

67 
	`vty_out
 (
vty
, 
SHOW_HEADER
, 
VTY_NEWLINE
);

68 
cuº
 = 
hash
->
èbÀ
; cuº !
NULL
; cuº = cuº->
hh
.
√xt
)

70 
vÆSèã
 = 
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
cuº
->
öfo
);

71 
	`vty_out
 (
vty
, " %c(%c%c) %08X ",

72 
RES_CODE_CHAR
[
vÆSèã
],

73 
RES_CODE_CHAR
[
cuº
->
öfo
->
vÆ_ªs_ROA
],

74 
RES_CODE_CHAR
[
cuº
->
öfo
->
vÆ_ªs_BGPSEC
],

75 
cuº
->
idítifõr
);

78 i‡(
cuº
->
öfo
->
node
)

80 
	`vty_out
 (
vty
, "%15s/%-2d ",

81 
	`öë_¡›
 (
cuº
->
öfo
->
node
->
p
.
Ámûy
,

82 &
cuº
->
öfo
->
node
->
p
.
u
.
¥efix
,

83 
pbuf
, 
INET6_ADDRSTRLEN
),

84 
cuº
->
öfo
->
node
->
p
.
¥efixÀn
);

88 
	`vty_out
 (
vty
, "(NULLÇode) ");

92 i‡(
	`CHECK_FLAG
 (
cuº
->
öfo
->
Êags
, 
BGP_INFO_IGNORE
))

94 
	`vty_out
 (
vty
, "x ");

98 
	`vty_out
 (
vty
, " ");

101 
©å
 = 
cuº
->
öfo
->attr;

104 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
))

106 
	`vty_out
 (
vty
, "%d", 
©å
->
loˇl_¥ef
);

110 
	`vty_out
 (
vty
, "D:%d", 
bgp
->
deÁu…_loˇl_¥ef
);

113 
vÆSèã
)

115 
SRx_RESULT_VALID
:

116 
vÆSèã
 = 
VAL_LOCPRF_VALID
;

118 
SRx_RESULT_NOTFOUND
:

119 
vÆSèã
 = 
VAL_LOCPRF_NOTFOUND
;

121 
SRx_RESULT_INVALID
:

122 
vÆSèã
 = 
VAL_LOCPRF_INVALID
;

124 
SRx_RESULT_UNDEFINED
:

126 
vÆSèã
 = -1;

128 i‡(
vÆSèã
 != -1)

130 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
vÆSèã
].
is_£t
)

132 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
vÆSèã
].
ªœtive
)

134 
	`vty_out
 (
vty
, "%c%4d",

135 (
bgp
->
§x_vÆ_loˇl_¥ef
[
vÆSèã
].
ªœtive
 == 1) ? '+'

137 
bgp
->
§x_vÆ_loˇl_¥ef
[
vÆSèã
].
vÆue
);

141 
	`vty_out
 (
vty
, "->%4d", 
bgp
->
§x_vÆ_loˇl_¥ef
[
vÆSèã
].
vÆue
);

147 
	`vty_out
 (
vty
, " ");

151 i‡(
©å
->
a•©h
)

153 
	`a•©h_¥öt_vty
 (
vty
, " \"%s\"", 
©å
->
a•©h
, " ");

156 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

158 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

161 
	}
}

164 
DEFUN
 (
show_bgp_öfo_hashes
,

165 
show_bgp_öfo_hashes_cmd
,

167 
SHOW_STR


168 
BGP_STR


171 
li°node
* 
	gcuº
;

172 
bgp
* 
	gbgp
;

174 
vty_out
 (
vty
, 
SHOW_SCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

175 
ALL_LIST_ELEMENTS_RO
(
bm
->
bgp
, 
cuº
, bgp))

177 
vty_out
 (
vty
, "BGP infÿhash UID o‡AS %d%s", 
bgp
->
as
, 
VTY_NEWLINE
);

178 
show_öfo_hash
(
vty
, 
bgp
, bgp->
öfo_uid_hash
);

179 
vty_out
 (
vty
, "BGP infÿhash LID o‡AS %d%s", 
bgp
->
as
, 
VTY_NEWLINE
);

180 
show_öfo_hash
(
vty
, 
bgp
, bgp->
öfo_lid_hash
);

183  
	gCMD_SUCCESS
;

186 
	$bgp_Æl_öfo_hashes_öô
 ()

190 
	}
}

192 
bgp_öfo_hash
* 
	$bgp_öfo_hash_öô
 ()

194 
bgp_öfo_hash
* 
√w
;

196 
√w
 = 
	`XCALLOC
(
MTYPE_BGP_INFO_HASH
, (
bgp_öfo_hash
));

197 i‡(
√w
)

199 
√w
->
èbÀ
 = 
NULL
;

201  
√w
;

202 
	}
}

204 
	$bgp_öfo_hash_föish
 (
bgp_öfo_hash
** 
hash
)

206 
bgp_öfo_hash_ôem
* 
cuº
;

208 (*
hash
)->
èbÀ
)

210 
cuº
 = (*
hash
)->
èbÀ
;

211 
	`HASH_DEL
 ((*
hash
)->
èbÀ
, 
cuº
);

212 
	`XFREE
 (
MTYPE_BGP_INFO_HASH_ITEM
, 
cuº
);

215 
	`XFREE
 (
MTYPE_BGP_INFO_HASH
, *
hash
);

216 *
hash
 = 
NULL
;

217 
	}
}

228 
	$bgp_öfo_ªgi°î
 (
bgp_öfo_hash
* 
hash
, 
bgp_öfo
* 
öfo
,

229 
uöt32_t
 
idítifõr
)

231 i‡(
idítifõr
 == 0)

236 
bgp_öfo_hash_ôem
 *
√w
;

239 
√w
 = 
	`XCALLOC
 (
MTYPE_BGP_INFO_HASH_ITEM
, (
bgp_öfo_hash_ôem
));

240 i‡(
√w
 =
NULL
)

242 
	`zlog_îr
("NŸÉnough mem‹yÅÿ°‹êupd©ê[0x%80X]", 
idítifõr
);

246 
√w
->
idítifõr
 = identifier;

247 
√w
->
öfo
 = info;

249 
	`HASH_ADD
(
hh
, 
hash
->
èbÀ
, 
idítifõr
, (
uöt32_t
), 
√w
);

251 
öfo
->
öfo_hash
 = 
hash
;

254 
	}
}

262 
	$bgp_öfo_uƒegi°î
(
bgp_öfo_hash
* 
hash
, 
uöt32_t
 
idítifõr
)

264 
bgp_öfo_hash_ôem
* 
íåy
;

266 
	`HASH_FIND
(
hh
, 
hash
->
èbÀ
, &
idítifõr
, (
uöt32_t
), 
íåy
);

267 i‡(
íåy
)

269 
	`HASH_DEL
(
hash
->
èbÀ
, 
íåy
);

270 
	`XFREE
(
MTYPE_BGP_INFO_HASH
, 
íåy
);

272 
	}
}

282 
bgp_öfo
* 
	$bgp_öfo_„tch
 (
bgp_öfo_hash
* 
hash
,

283 
uöt32_t
 
idítifõr
)

285 
bgp_öfo_hash_ôem
* 
íåy
;

287 
	`HASH_FIND
 (
hh
, 
hash
->
èbÀ
, &
idítifõr
, (
uöt32_t
), 
íåy
);

289 if(
íåy
)

291  
íåy

hash
->
èbÀ
;É¡ry!=
NULL
;

292 
íåy
=(
bgp_öfo_hash_ôem
*)”¡ry->
hh
.
√xt
))

294 i‡(
íåy
->
idítifõr
 == identifier)

296  
íåy
->
öfo
;

300  
NULL
;

301 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_info_hash.h

32 
	~<zebø.h
>

34 #i‚de‡
_QUAGGA_BGP_INFO_HASH_H


35 
	#_QUAGGA_BGP_INFO_HASH_H


	)

37 #ifde‡
USE_SRX


39 
	~<uthash.h
>

41 
	sbgp_öfo_hash_ôem
 {

42 
uöt32_t
 
	midítifõr
;

43 
bgp_öfo
 *
	möfo
;

44 
UT_hash_h™dÀ
 
	mhh
;

47 
	sbgp_öfo_hash
 {

48 
bgp_öfo_hash_ôem
 *
	mèbÀ
;

53 
bgp_Æl_öfo_hashes_öô
 ();

56 
bgp_öfo_hash
* 
bgp_öfo_hash_öô
 ();

57 
bgp_öfo_hash_föish
 (
bgp_öfo_hash
 **);

61 
bgp_öfo_ªgi°î
 (
bgp_öfo_hash
 *, 
bgp_öfo
 *,

62 
uöt32_t
);

63 
bgp_öfo_uƒegi°î
 (
bgp_öfo_hash
 *, 
uöt32_t
);

64 
bgp_öfo
 * 
bgp_öfo_„tch
 (
bgp_öfo_hash
 *, 
uöt32_t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_main.c

21 
	~<zebø.h
>

23 
	~"ve˘‹.h
"

24 
	~"vty.h
"

25 
	~"comm™d.h
"

26 
	~"gë›t.h
"

27 
	~"thªad.h
"

28 
	~<lib/vîsi⁄.h
>

29 
	~"mem‹y.h
"

30 
	~"¥efix.h
"

31 
	~"log.h
"

32 
	~"¥ivs.h
"

33 
	~"sigevít.h
"

34 
	~"z˛õ¡.h
"

35 
	~"rouãm≠.h
"

36 
	~"fûãr.h
"

37 
	~"∂i°.h
"

38 
	~"°ªam.h
"

40 
	~"bgpd/bgpd.h
"

41 
	~"bgpd/bgp_©å.h
"

42 
	~"bgpd/bgp_m∂sv≤.h
"

43 
	~"bgpd/bgp_a•©h.h
"

44 
	~"bgpd/bgp_dump.h
"

45 
	~"bgpd/bgp_rouã.h
"

46 
	~"bgpd/bgp_√xth›.h
"

47 
	~"bgpd/bgp_ªgex.h
"

48 
	~"bgpd/bgp_˛i°.h
"

49 
	~"bgpd/bgp_debug.h
"

50 
	~"bgpd/bgp_fûãr.h
"

51 
	~"bgpd/bgp_zebø.h
"

52 #i‡
deföed
 (
__TIME_MEASURE__
)

53 
	~"libtm_rdtsc.h
"

57 c⁄° 
›ti⁄
 
	gl⁄g›ts
[] =

59 { "d´m⁄", 
no_¨gumít
, 
NULL
, 'd'},

60 { "c⁄fig_fûe", 
ªquúed_¨gumít
, 
NULL
, 'f'},

61 { "pid_fûe", 
ªquúed_¨gumít
, 
NULL
, 'i'},

62 { "sockë", 
ªquúed_¨gumít
, 
NULL
, 'z'},

63 { "bgp_p‹t", 
ªquúed_¨gumít
, 
NULL
, 'p'},

64 { "li°í⁄", 
ªquúed_¨gumít
, 
NULL
, 'l'},

65 { "vty_addr", 
ªquúed_¨gumít
, 
NULL
, 'A'},

66 { "vty_p‹t", 
ªquúed_¨gumít
, 
NULL
, 'P'},

67 { "ªèö", 
no_¨gumít
, 
NULL
, 'r'},

68 { "no_kî√l", 
no_¨gumít
, 
NULL
, 'n'},

69 { "u£r", 
ªquúed_¨gumít
, 
NULL
, 'u'},

70 { "group", 
ªquúed_¨gumít
, 
NULL
, 'g'},

71 { "vîsi⁄", 
no_¨gumít
, 
NULL
, 'v'},

72 { "dryrun", 
no_¨gumít
, 
NULL
, 'C'},

73 { "hñp", 
no_¨gumít
, 
NULL
, 'h'},

78 
sighup
 ();

79 
sigöt
 ();

80 
sigu§1
 ();

82 
bgp_exô
 ();

84 
quagga_sig«l_t
 
	gbgp_sig«ls
[] =

87 .
sig«l
 = 
SIGHUP
,

88 .
	gh™dÀr
 = &
sighup
,

91 .
	gsig«l
 = 
SIGUSR1
,

92 .
	gh™dÀr
 = &
sigu§1
,

95 .
	gsig«l
 = 
SIGINT
,

96 .
	gh™dÀr
 = &
sigöt
,

99 .
	gsig«l
 = 
SIGTERM
,

100 .
	gh™dÀr
 = &
sigöt
,

105 
	gc⁄fig_deÁu…
[] = 
SYSCONFDIR
 
BGP_DEFAULT_CONFIG
;

108 
	gªèö_mode
 = 0;

111 
thªad_ma°î
 *
	gma°î
;

114 *
	gc⁄fig_fûe
 = 
NULL
;

117 c⁄° *
	gpid_fûe
 = 
PATH_BGPD_PID
;

120 
	gvty_p‹t
 = 
BGP_VTY_PORT
;

121 *
	gvty_addr
 = 
NULL
;

123 #i‡
deföed
 (
__TIME_MEASURE__
)

128 
zebø_ˇ∑bûôõs_t
 
	g_ˇps_p
 [] =

130 
ZCAP_BIND
,

131 
ZCAP_NET_RAW
,

132 
ZCAP_NET_ADMIN
,

135 
zebø_¥ivs_t
 
	gbgpd_¥ivs
 =

137 #i‡
deföed
(
QUAGGA_USER
Ë&& deföed(
QUAGGA_GROUP
)

138 .
u£r
 = 
QUAGGA_USER
,

139 .
	ggroup
 = 
QUAGGA_GROUP
,

141 #ifde‡
VTY_GROUP


142 .
	gvty_group
 = 
VTY_GROUP
,

144 .
	gˇps_p
 = 
_ˇps_p
,

145 .
	gˇp_num_p
 = 
¨øy_size
(
_ˇps_p
),

146 .
	gˇp_num_i
 = 0,

151 
	$ußge
 (*
¥og«me
, 
°©us
)

153 i‡(
°©us
 != 0)

154 
	`Ârötf
 (
°dîr
, "Try `%†--hñp' f‹ m‹êöf‹m©i⁄.\n", 
¥og«me
);

157 
	`¥ötf
 ("Ußgê: %†[OPTION...]\n\n\
 which m™age†kî√»routögÅabÀ m™agemíà™d \
 bëwì¿dif„ª¡ÑoutögÖrŸocﬁs.\n\n\
-d, --d´m⁄ Run†ö d´m⁄ mode\n\
-f, --c⁄fig_fûê Së c⁄figuøti⁄ fûê«me\n\
-i, --pid_fûê SëÖro˚s†idítifõ∏fûê«me\n\
-z, --sockë SëÖ©h o‡zebø sockë\n\
-p, --bgp_p‹à Së bg∞¥Ÿocﬁ'†p‹ànumbî\n\
-l, --li°í⁄ Li°í o¿•ecifõdáddªs†(im∂õ†-n)\n\
-A, --vty_add∏ Së vty'†bödáddªss\n\
-P, --vty_p‹à Së vty'†p‹ànumbî\n\
-r, --ªèö WhíÖrogømÅîmö©es,ÑëaöáddedÑouã by bgpd.\n\
-n, --no_kî√» DÿnŸ in°Æ»rouãÅÿkî√l.\n\
-u, --u£∏ U£∏tÿru¿as\n\
-g, --grou∞ Grou∞tÿru¿as\n\
-v, --vîsi⁄ Pröà¥ogøm vîsi⁄\n\
-C, --dryru¿ Check c⁄figuøti⁄ f‹ vÆidôyándÉxô\n\
-c, TimêMósurög cou¡\n\
-h, --hñ∞ Di•œyÅhi†hñ∞™dÉxô\n\
\n\
 bug†tÿ%s\n", 
¥og«me
, 
ZEBRA_BUG_ADDRESS
);

180 
	`exô
 (
°©us
);

181 
	}
}

185 
	$sighup
 ()

187 
	`zlog
 (
NULL
, 
LOG_INFO
, "SIGHUPÑeceived");

190 
	`bgp_ãrmö©e
 ();

191 
	`bgp_ª£t
 ();

192 
	`zlog_öfo
 ("bgpdÑestarting!");

195 
	`vty_ªad_c⁄fig
 (
c⁄fig_fûe
, 
c⁄fig_deÁu…
);

198 
	`vty_£rv_sock
 (
vty_addr
, 
vty_p‹t
, 
BGP_VTYSH_PATH
);

201 
	}
}

205 
	$sigöt
 ()

207 
	`zlog_nŸi˚
 ("Terminating on signal");

209 i‡(! 
ªèö_mode
)

210 
	`bgp_ãrmö©e
 ();

212 
	`z¥ivs_ãrmö©e
 (&
bgpd_¥ivs
);

213 
	`bgp_exô
 (0);

214 
	}
}

218 
	$sigu§1
 ()

220 
	`zlog_rŸ©e
 (
NULL
);

221 
	}
}

231 
	$bgp_exô
 (
°©us
)

233 
bgp
 *bgp;

234 
li°node
 *
node
, *
¬ode
;

235 *
sockë
;

236 
öãrÁ˚
 *
iÂ
;

237 
z˛õ¡
 *zclient;

238 
z˛õ¡
 *
zlookup
;

241 
	`as£π
 (
°©us
 == 0);

244 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

245 
	`bgp_dñëe
 (
bgp
);

246 
	`li°_‰ì
 (
bm
->
bgp
);

249 
	`ALL_LIST_ELEMENTS_RO
(
bm
->
li°í_sockës
, 
node
, 
sockë
))

251 i‡(
	`˛o£
 (()()
sockë
) == -1)

252 
	`zlog_îr
 ("˛o£ (%d): %s", ()()
sockë
, 
	`ß„_°ªº‹
 (
î∫o
));

254 
	`li°_dñëe
 (
bm
->
li°í_sockës
);

257 i‡(
ªèö_mode
)

258 
	`if_add_hook
 (
IF_DELETE_HOOK
, 
NULL
);

259 
	`ALL_LIST_ELEMENTS
 (
iÊi°
, 
node
, 
¬ode
, 
iÂ
))

261 
li°node
 *
c_node
, *
c_¬ode
;

262 
c⁄√˘ed
 *
c
;

264 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
c_node
, 
c_¬ode
, 
c
))

265 
	`bgp_c⁄√˘ed_dñëe
 (
c
);

267 
	`if_dñëe
 (
iÂ
);

269 
	`li°_‰ì
 (
iÊi°
);

272 
	`bgp_©å_föish
 ();

275 
	`bgp_dump_föish
 ();

278 
	`bgp_rouã_föish
 ();

281 
	`rouã_m≠_föish
 ();

284 
	`bgp_sˇn_föish
 ();

287 
	`ac˚ss_li°_add_hook
 (
NULL
);

288 
	`ac˚ss_li°_dñëe_hook
 (
NULL
);

289 
	`ac˚ss_li°_ª£t
 ();

292 
	`as_li°_add_hook
 (
NULL
);

293 
	`as_li°_dñëe_hook
 (
NULL
);

294 
	`bgp_fûãr_ª£t
 ();

297 
	`¥efix_li°_add_hook
 (
NULL
);

298 
	`¥efix_li°_dñëe_hook
 (
NULL
);

299 
	`¥efix_li°_ª£t
 ();

302 
	`communôy_li°_ãrmö©e
 (
bgp_˛i°
);

304 
	`cmd_ãrmö©e
 ();

305 
	`vty_ãrmö©e
 ();

306 i‡(
z˛õ¡
)

307 
	`z˛õ¡_‰ì
 (
z˛õ¡
);

308 i‡(
zlookup
)

309 
	`z˛õ¡_‰ì
 (
zlookup
);

310 i‡(
bgp_√xth›_buf
)

311 
	`°ªam_‰ì
 (
bgp_√xth›_buf
);

314 i‡(
ma°î
)

315 
	`thªad_ma°î_‰ì
 (
ma°î
);

317 i‡(
zlog_deÁu…
)

318 
	`˛o£zlog
 (
zlog_deÁu…
);

320 i‡(
	`CONF_BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

321 
	`log_mem°©s_°dîr
 ("bgpd");

323 
	`exô
 (
°©us
);

324 
	}
}

329 
	$maö
 (
¨gc
, **
¨gv
)

331 *
p
;

332 
›t
;

333 
d´m⁄_mode
 = 0;

334 
dryrun
 = 0;

335 *
¥og«me
;

336 
thªad
Åhread;

337 
tmp_p‹t
;

340 
	`umask
 (0027);

343 
¥og«me
 = ((
p
 = 
	`°ºchr
 (
¨gv
[0], '/')) ? ++p :árgv[0]);

345 
zlog_deÁu…
 = 
	`›ízlog
 (
¥og«me
, 
ZLOG_BGP
,

346 
LOG_CONS
|
LOG_NDELAY
|
LOG_PID
, 
LOG_DAEMON
);

349 
	`bgp_ma°î_öô
 ();

350 #i‡
	`deföed
 (
__TIME_MEASURE__
)

351 
	`tm_rdtsc_öô
();

357 #i‡
	`deföed
 (
__TIME_MEASURE__
)

358 
›t
 = 
	`gë›t_l⁄g
 (
¨gc
, 
¨gv
, "df:i:z:hp:l:A:P:∫u:g:vCc:", 
l⁄g›ts
, 0);

360 
›t
 = 
	`gë›t_l⁄g
 (
¨gc
, 
¨gv
, "df:i:z:hp:l:A:P:∫u:g:vC", 
l⁄g›ts
, 0);

363 i‡(
›t
 =
EOF
)

366 
›t
)

371 
d´m⁄_mode
 = 1;

374 
c⁄fig_fûe
 = 
›èrg
;

377 
pid_fûe
 = 
›èrg
;

380 
	`z˛õ¡_£rv_∑th_£t
 (
›èrg
);

383 
tmp_p‹t
 = 
	`©oi
 (
›èrg
);

384 i‡(
tmp_p‹t
 <= 0 ||Åmp_port > 0xffff)

385 
bm
->
p‹t
 = 
BGP_PORT_DEFAULT
;

387 
bm
->
p‹t
 = 
tmp_p‹t
;

390 
vty_addr
 = 
›èrg
;

395 i‡(
	`°rcmp
(
›èrg
, "0") == 0)

397 
vty_p‹t
 = 0;

400 
vty_p‹t
 = 
	`©oi
 (
›èrg
);

401 i‡(
vty_p‹t
 <= 0 || vty_port > 0xffff)

402 
vty_p‹t
 = 
BGP_VTY_PORT
;

405 
ªèö_mode
 = 1;

408 
bm
->
addªss
 = 
›èrg
;

411 
	`bgp_›ti⁄_£t
 (
BGP_OPT_NO_FIB
);

414 
bgpd_¥ivs
.
u£r
 = 
›èrg
;

417 
bgpd_¥ivs
.
group
 = 
›èrg
;

420 
	`¥öt_vîsi⁄
 (
¥og«me
);

421 
	`exô
 (0);

424 
dryrun
 = 1;

426 #i‡
	`deföed
 (
__TIME_MEASURE__
)

428 
g_mósuªCou¡
 =0;

429 
g_mósuªCou¡
 = 
	`©oi
(
›èrg
);

430 
	`¥ötf
("[%s] TimêMósurög Cou¡: %ld\n", 
__FUNCTION__
, 
g_mósuªCou¡
);

434 
	`ußge
 (
¥og«me
, 0);

437 
	`ußge
 (
¥og«me
, 1);

443 
ma°î
 = 
bm
->master;

446 
	`§™d
 (
	`time
 (
NULL
));

447 
	`sig«l_öô
 (
ma°î
, 
	`¨øy_size
(
bgp_sig«ls
), bgp_signals);

448 
	`z¥ivs_öô
 (&
bgpd_¥ivs
);

449 
	`cmd_öô
 (1);

450 
	`vty_öô
 (
ma°î
);

451 
	`mem‹y_öô
 ();

454 
	`bgp_öô
 ();

457 
	`s‹t_node
 ();

460 
	`vty_ªad_c⁄fig
 (
c⁄fig_fûe
, 
c⁄fig_deÁu…
);

466 if(
dryrun
)

470 i‡(
d´m⁄_mode
 && 
	`d´m⁄
 (0, 0) < 0)

472 
	`zlog_îr
("BGPd d´m⁄ faûed: %s", 
	`°ªº‹
(
î∫o
));

478 
	`pid_ouçut
 (
pid_fûe
);

481 
	`vty_£rv_sock
 (
vty_addr
, 
vty_p‹t
, 
BGP_VTYSH_PATH
);

484 #ifde‡
USE_SRX


485 
	`zlog_nŸi˚
 ("BGPd (+SRxË%†°¨tög: vty@%d, bgp@%s:%d", 
QUAGGA_VERSION
,

487 
	`zlog_nŸi˚
 ("BGPd %†°¨tög: vty@%d, bgp@%s:%d", 
QUAGGA_VERSION
,

489 
vty_p‹t
,

490 (
bm
->
addªss
 ? bm->address : "<all>"),

491 
bm
->
p‹t
);

494 
	`thªad_„tch
 (
ma°î
, &
thªad
))

495 
	`thªad_ˇŒ
 (&
thªad
);

499 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mpath.c

24 
	~<zebø.h
>

26 
	~"comm™d.h
"

27 
	~"¥efix.h
"

28 
	~"lökli°.h
"

29 
	~"sockuni⁄.h
"

30 
	~"mem‹y.h
"

32 
	~"bgpd/bgpd.h
"

33 
	~"bgpd/bgp_èbÀ.h
"

34 
	~"bgpd/bgp_rouã.h
"

35 
	~"bgpd/bgp_©å.h
"

36 
	~"bgpd/bgp_debug.h
"

37 
	~"bgpd/bgp_a•©h.h
"

38 
	~"bgpd/bgp_communôy.h
"

39 
	~"bgpd/bgp_ecommunôy.h
"

40 
	~"bgpd/bgp_m∑th.h
"

48 
	$bgp_maximum_∑ths_£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

49 
≥îty≥
, 
u_öt16_t
 
max∑ths
)

51 i‡(!
bgp
 || (
afi
 >
AFI_MAX
Ë|| (
ßfi
 >
SAFI_MAX
))

54 
≥îty≥
)

56 
BGP_PEER_IBGP
:

57 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ibgp
 = maxpaths;

59 
BGP_PEER_EBGP
:

60 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ebgp
 = maxpaths;

67 
	}
}

75 
	$bgp_maximum_∑ths_un£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

76 
≥îty≥
)

78 i‡(!
bgp
 || (
afi
 >
AFI_MAX
Ë|| (
ßfi
 >
SAFI_MAX
))

81 
≥îty≥
)

83 
BGP_PEER_IBGP
:

84 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ibgp
 = 
BGP_DEFAULT_MAXPATHS
;

86 
BGP_PEER_EBGP
:

87 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ebgp
 = 
BGP_DEFAULT_MAXPATHS
;

94 
	}
}

104 
	$bgp_öfo_√xth›_cmp
 (
bgp_öfo
 *
bi1
, bgp_öfÿ*
bi2
)

106 
©å_exåa
 *
´1
, *
´2
;

107 
com∑ª
;

109 
´1
 = 
bi1
->
©å
->
exåa
;

110 
´2
 = 
bi2
->
©å
->
exåa
;

112 
com∑ª
 = 
	`IPV4_ADDR_CMP
 (&
bi1
->
©å
->
√xth›
, &
bi2
->attr->nexthop);

114 i‡(!
com∑ª
 && 
´1
 && 
´2
 && (´1->
mp_√xth›_Àn
 ==áe2->mp_nexthop_len))

116 
´1
->
mp_√xth›_Àn
)

120 
com∑ª
 = 
	`IPV4_ADDR_CMP
 (&
´1
->
mp_√xth›_globÆ_ö
,

121 &
´2
->
mp_√xth›_globÆ_ö
);

123 #ifde‡
HAVE_IPV6


125 
com∑ª
 = 
	`IPV6_ADDR_CMP
 (&
´1
->
mp_√xth›_globÆ
,

126 &
´2
->
mp_√xth›_globÆ
);

129 
com∑ª
 = 
	`IPV6_ADDR_CMP
 (&
´1
->
mp_√xth›_globÆ
,

130 &
´2
->
mp_√xth›_globÆ
);

131 i‡(!
com∑ª
)

132 
com∑ª
 = 
	`IPV6_ADDR_CMP
 (&
´1
->
mp_√xth›_loˇl
,

133 &
´2
->
mp_√xth›_loˇl
);

139  
com∑ª
;

140 
	}
}

155 
	$bgp_öfo_m∑th_cmp
 (*
vÆ1
, *
vÆ2
)

157 
bgp_öfo
 *
bi1
, *
bi2
;

158 
com∑ª
;

160 
bi1
 = 
vÆ1
;

161 
bi2
 = 
vÆ2
;

163 
com∑ª
 = 
	`bgp_öfo_√xth›_cmp
 (
bi1
, 
bi2
);

165 i‡(!
com∑ª
)

166 
com∑ª
 = 
	`sockuni⁄_cmp
 (
bi1
->
≥î
->
su_ªmŸe
, 
bi2
->peer->su_remote);

168  
com∑ª
;

169 
	}
}

178 
	$bgp_mp_li°_öô
 (
li°
 *
mp_li°
)

180 
	`as£π
 (
mp_li°
);

181 
	`mem£t
 (
mp_li°
, 0,  (
li°
));

182 
mp_li°
->
cmp
 = 
bgp_öfo_m∑th_cmp
;

183 
	}
}

191 
	$bgp_mp_li°_˛ór
 (
li°
 *
mp_li°
)

193 
	`as£π
 (
mp_li°
);

194 
	`li°_dñëe_Æl_node
 (
mp_li°
);

195 
	}
}

203 
	$bgp_mp_li°_add
 (
li°
 *
mp_li°
, 
bgp_öfo
 *
mpöfo
)

205 
	`as£π
 (
mp_li°
 && 
mpöfo
);

206 
	`li°node_add_s‹t
 (
mp_li°
, 
mpöfo
);

207 
	}
}

214 
bgp_öfo_m∑th
 *

215 
	$bgp_öfo_m∑th_√w
 ()

217 
bgp_öfo_m∑th
 *
√w_m∑th
;

218 
√w_m∑th
 = 
	`XCALLOC
 (
MTYPE_BGP_MPATH_INFO
,  (
bgp_öfo_m∑th
));

219  
√w_m∑th
;

220 
	}
}

228 
	$bgp_öfo_m∑th_‰ì
 (
bgp_öfo_m∑th
 **
m∑th
)

230 i‡(
m∑th
 && *mpath)

232 i‡((*
m∑th
)->
mp_©å
)

233 
	`bgp_©å_unöã∫
 (&(*
m∑th
)->
mp_©å
);

234 
	`XFREE
 (
MTYPE_BGP_MPATH_INFO
, *
m∑th
);

235 *
m∑th
 = 
NULL
;

237 
	}
}

245 
bgp_öfo_m∑th
 *

246 
	$bgp_öfo_m∑th_gë
 (
bgp_öfo
 *
böfo
)

248 
bgp_öfo_m∑th
 *
m∑th
;

249 i‡(!
böfo
->
m∑th
)

251 
m∑th
 = 
	`bgp_öfo_m∑th_√w
();

252 i‡(!
m∑th
)

253  
NULL
;

254 
böfo
->
m∑th
 = mpath;

255 
m∑th
->
mp_öfo
 = 
böfo
;

257  
böfo
->
m∑th
;

258 
	}
}

267 
	$bgp_öfo_m∑th_íqueue
 (
bgp_öfo
 *
¥ev_öfo
, bgp_öfÿ*
böfo
)

269 
bgp_öfo_m∑th
 *
¥ev
, *
m∑th
;

271 
¥ev
 = 
	`bgp_öfo_m∑th_gë
 (
¥ev_öfo
);

272 
m∑th
 = 
	`bgp_öfo_m∑th_gë
 (
böfo
);

273 i‡(!
¥ev
 || !
m∑th
)

276 
m∑th
->
mp_√xt
 = 
¥ev
->mp_next;

277 
m∑th
->
mp_¥ev
 = 
¥ev
;

278 i‡(
¥ev
->
mp_√xt
)

279 
¥ev
->
mp_√xt
->
mp_¥ev
 = 
m∑th
;

280 
¥ev
->
mp_√xt
 = 
m∑th
;

282 
	`SET_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_MULTIPATH
);

283 
	}
}

291 
	$bgp_öfo_m∑th_dequeue
 (
bgp_öfo
 *
böfo
)

293 
bgp_öfo_m∑th
 *
m∑th
 = 
böfo
->mpath;

294 i‡(!
m∑th
)

296 i‡(
m∑th
->
mp_¥ev
)

297 
m∑th
->
mp_¥ev
->
mp_√xt
 = mpath->mp_next;

298 i‡(
m∑th
->
mp_√xt
)

299 
m∑th
->
mp_√xt
->
mp_¥ev
 = mpath->mp_prev;

300 
m∑th
->
mp_√xt
 = m∑th->
mp_¥ev
 = 
NULL
;

301 
	`UNSET_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_MULTIPATH
);

302 
	}
}

309 
bgp_öfo
 *

310 
	$bgp_öfo_m∑th_√xt
 (
bgp_öfo
 *
böfo
)

312 i‡(!
böfo
->
m∑th
 || !böfo->m∑th->
mp_√xt
)

313  
NULL
;

314  
böfo
->
m∑th
->
mp_√xt
->
mp_öfo
;

315 
	}
}

322 
bgp_öfo
 *

323 
	$bgp_öfo_m∑th_fú°
 (
bgp_öfo
 *
böfo
)

325  
	`bgp_öfo_m∑th_√xt
 (
böfo
);

326 
	}
}

333 
u_öt32_t


334 
	$bgp_öfo_m∑th_cou¡
 (
bgp_öfo
 *
böfo
)

336 i‡(!
böfo
->
m∑th
)

338  
böfo
->
m∑th
->
mp_cou¡
;

339 
	}
}

347 
	$bgp_öfo_m∑th_cou¡_£t
 (
bgp_öfo
 *
böfo
, 
u_öt32_t
 
cou¡
)

349 
bgp_öfo_m∑th
 *
m∑th
;

350 i‡(!
cou¡
 && !
böfo
->
m∑th
)

352 
m∑th
 = 
	`bgp_öfo_m∑th_gë
 (
böfo
);

353 i‡(!
m∑th
)

355 
m∑th
->
mp_cou¡
 = 
cou¡
;

356 
	}
}

364 
©å
 *

365 
	$bgp_öfo_m∑th_©å
 (
bgp_öfo
 *
böfo
)

367 i‡(!
böfo
->
m∑th
)

368  
NULL
;

369  
böfo
->
m∑th
->
mp_©å
;

370 
	}
}

378 
	$bgp_öfo_m∑th_©å_£t
 (
bgp_öfo
 *
böfo
, 
©å
 *attr)

380 
bgp_öfo_m∑th
 *
m∑th
;

381 i‡(!
©å
 && !
böfo
->
m∑th
)

383 
m∑th
 = 
	`bgp_öfo_m∑th_gë
 (
böfo
);

384 i‡(!
m∑th
)

386 
m∑th
->
mp_©å
 = 
©å
;

387 
	}
}

396 
	$bgp_öfo_m∑th_upd©e
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
√w_be°
,

397 
bgp_öfo
 *
ﬁd_be°
, 
li°
 *
mp_li°
,

398 
bgp_max∑ths_cfg
 *
m∑th_cfg
)

400 
u_öt16_t
 
max∑ths
, 
m∑th_cou¡
, 
ﬁd_m∑th_cou¡
;

401 
li°node
 *
mp_node
, *
mp_√xt_node
;

402 
bgp_öfo
 *
cur_m∑th
, *
√w_m∑th
, *
√xt_m∑th
, *
¥ev_m∑th
;

403 
m∑th_ch™ged
, 
debug
;

404 
pfx_buf
[
INET_ADDRSTRLEN
], 
nh_buf
[2][INET_ADDRSTRLEN];

406 
m∑th_ch™ged
 = 0;

407 
max∑ths
 = 
BGP_DEFAULT_MAXPATHS
;

408 
m∑th_cou¡
 = 0;

409 
cur_m∑th
 = 
NULL
;

410 
ﬁd_m∑th_cou¡
 = 0;

411 
¥ev_m∑th
 = 
√w_be°
;

412 
mp_node
 = 
	`li°hód
 (
mp_li°
);

413 
debug
 = 
	`BGP_DEBUG
 (
evíts
, 
EVENTS
);

415 i‡(
debug
)

416 
	`¥efix2°r
 (&
∫
->
p
, 
pfx_buf
,  (pfx_buf));

418 i‡(
√w_be°
)

420 
m∑th_cou¡
++;

421 i‡(
√w_be°
 !
ﬁd_be°
)

422 
	`bgp_öfo_m∑th_dequeue
 (
√w_be°
);

423 
max∑ths
 = (
√w_be°
->
≥î
->
s‹t
 =
BGP_PEER_IBGP
) ?

424 
m∑th_cfg
->
max∑ths_ibgp
 : m∑th_cfg->
max∑ths_ebgp
;

427 i‡(
ﬁd_be°
)

429 
cur_m∑th
 = 
	`bgp_öfo_m∑th_fú°
 (
ﬁd_be°
);

430 
ﬁd_m∑th_cou¡
 = 
	`bgp_öfo_m∑th_cou¡
 (
ﬁd_be°
);

431 
	`bgp_öfo_m∑th_cou¡_£t
 (
ﬁd_be°
, 0);

432 
	`bgp_öfo_m∑th_dequeue
 (
ﬁd_be°
);

446 
mp_node
 || 
cur_m∑th
)

453 i‡(!
cur_m∑th
 && (
m∑th_cou¡
 >
max∑ths
))

456 
mp_√xt_node
 = 
mp_node
 ? 
	`li°√xäode
 (mp_nodeË: 
NULL
;

457 
√xt_m∑th
 = 
cur_m∑th
 ? 
	`bgp_öfo_m∑th_√xt
 (cur_m∑thË: 
NULL
;

463 i‡(
mp_node
 && (
	`li°gëd©a
 (mp_nodeË=
cur_m∑th
))

465 
	`li°_dñëe_node
 (
mp_li°
, 
mp_node
);

466 
	`bgp_öfo_m∑th_dequeue
 (
cur_m∑th
);

467 i‡((
m∑th_cou¡
 < 
max∑ths
) &&

468 
	`bgp_öfo_√xth›_cmp
 (
¥ev_m∑th
, 
cur_m∑th
))

470 
	`bgp_öfo_m∑th_íqueue
 (
¥ev_m∑th
, 
cur_m∑th
);

471 
¥ev_m∑th
 = 
cur_m∑th
;

472 
m∑th_cou¡
++;

476 
m∑th_ch™ged
 = 1;

477 i‡(
debug
)

478 
	`zlog_debug
 ("%†ªmovêm∑thÇexth› %†≥î %s", 
pfx_buf
,

479 
	`öë_¡›
 (
AF_INET
, &
cur_m∑th
->
©å
->
√xth›
,

480 
nh_buf
[0],  (nh_buf[0])),

481 
	`sockuni⁄2°r
 (
cur_m∑th
->
≥î
->
su_ªmŸe
,

482 
nh_buf
[1],  (nh_buf[1])));

484 
mp_node
 = 
mp_√xt_node
;

485 
cur_m∑th
 = 
√xt_m∑th
;

489 i‡(
cur_m∑th
 && (!
mp_node
 ||

490 (
	`bgp_öfo_m∑th_cmp
 (
cur_m∑th
,

491 
	`li°gëd©a
 (
mp_node
)) < 0)))

499 
	`bgp_öfo_m∑th_dequeue
 (
cur_m∑th
);

500 
m∑th_ch™ged
 = 1;

501 i‡(
debug
)

502 
	`zlog_debug
 ("%†ªmovêm∑thÇexth› %†≥î %s", 
pfx_buf
,

503 
	`öë_¡›
 (
AF_INET
, &
cur_m∑th
->
©å
->
√xth›
,

504 
nh_buf
[0],  (nh_buf[0])),

505 
	`sockuni⁄2°r
 (
cur_m∑th
->
≥î
->
su_ªmŸe
,

506 
nh_buf
[1],  (nh_buf[1])));

507 
cur_m∑th
 = 
√xt_m∑th
;

522 
√w_m∑th
 = 
	`li°gëd©a
 (
mp_node
);

523 
	`li°_dñëe_node
 (
mp_li°
, 
mp_node
);

524 i‡((
m∑th_cou¡
 < 
max∑ths
Ë&& (
√w_m∑th
 !
√w_be°
) &&

525 
	`bgp_öfo_√xth›_cmp
 (
¥ev_m∑th
, 
√w_m∑th
))

527 i‡(
√w_m∑th
 =
√xt_m∑th
)

528 
√xt_m∑th
 = 
	`bgp_öfo_m∑th_√xt
 (
√w_m∑th
);

529 
	`bgp_öfo_m∑th_dequeue
 (
√w_m∑th
);

531 
	`bgp_öfo_m∑th_íqueue
 (
¥ev_m∑th
, 
√w_m∑th
);

532 
¥ev_m∑th
 = 
√w_m∑th
;

533 
m∑th_ch™ged
 = 1;

534 
m∑th_cou¡
++;

535 i‡(
debug
)

536 
	`zlog_debug
 ("%†add m∑thÇexth› %†≥î %s", 
pfx_buf
,

537 
	`öë_¡›
 (
AF_INET
, &
√w_m∑th
->
©å
->
√xth›
,

538 
nh_buf
[0],  (nh_buf[0])),

539 
	`sockuni⁄2°r
 (
√w_m∑th
->
≥î
->
su_ªmŸe
,

540 
nh_buf
[1],  (nh_buf[1])));

542 
mp_node
 = 
mp_√xt_node
;

546 i‡(
√w_be°
)

548 
	`bgp_öfo_m∑th_cou¡_£t
 (
√w_be°
, 
m∑th_cou¡
-1);

549 i‡(
m∑th_ch™ged
 || (
	`bgp_öfo_m∑th_cou¡
 (
√w_be°
Ë!
ﬁd_m∑th_cou¡
))

550 
	`SET_FLAG
 (
√w_be°
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
);

552 
	}
}

561 
	$bgp_mp_dmed_de£À˘
 (
bgp_öfo
 *
dmed_be°
)

563 
bgp_öfo
 *
mpöfo
, *
m≤ext
;

565 i‡(!
dmed_be°
)

568 
mpöfo
 = 
	`bgp_öfo_m∑th_fú°
 (
dmed_be°
); mpöfo; mpöfÿ
m≤ext
)

570 
m≤ext
 = 
	`bgp_öfo_m∑th_√xt
 (
mpöfo
);

571 
	`bgp_öfo_m∑th_dequeue
 (
mpöfo
);

574 
	`bgp_öfo_m∑th_cou¡_£t
 (
dmed_be°
, 0);

575 
	`UNSET_FLAG
 (
dmed_be°
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
);

576 
	`as£π
 (
	`bgp_öfo_m∑th_fú°
 (
dmed_be°
) == 0);

577 
	}
}

592 
	$bgp_öfo_m∑th_aggªg©e_upd©e
 (
bgp_öfo
 *
√w_be°
,

593 
bgp_öfo
 *
ﬁd_be°
)

595 
bgp_öfo
 *
mpöfo
;

596 
a•©h
 *aspath;

597 
a•©h
 *
asmîge
;

598 
©å
 *
√w_©å
, *
ﬁd_©å
;

599 
u_ch¨
 
‹igö
, 
©å_chg
;

600 
communôy
 *communôy, *
commîge
;

601 
ecommunôy
 *
ecomm
, *
ecommîge
;

602 
©å_exåa
 *
´
;

603 
©å
áttr = { 0 };

605 i‡(
ﬁd_be°
 && (ﬁd_be° !
√w_be°
) &&

606 (
ﬁd_©å
 = 
	`bgp_öfo_m∑th_©å
 (
ﬁd_be°
)))

608 
	`bgp_©å_unöã∫
 (&
ﬁd_©å
);

609 
	`bgp_öfo_m∑th_©å_£t
 (
ﬁd_be°
, 
NULL
);

612 i‡(!
√w_be°
)

615 i‡(!
	`bgp_öfo_m∑th_cou¡
 (
√w_be°
))

617 i‡((
√w_©å
 = 
	`bgp_öfo_m∑th_©å
 (
√w_be°
)))

619 
	`bgp_©å_unöã∫
 (&
√w_©å
);

620 
	`bgp_öfo_m∑th_©å_£t
 (
√w_be°
, 
NULL
);

621 
	`SET_FLAG
 (
√w_be°
->
Êags
, 
BGP_INFO_ATTR_CHANGED
);

632 i‡(!
	`CHECK_FLAG
 (
√w_be°
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
) &&

633 (
ﬁd_be°
 =
√w_be°
))

635 
©å_chg
 = 0;

637 i‡(
	`CHECK_FLAG
 (
√w_be°
->
Êags
, 
BGP_INFO_ATTR_CHANGED
))

638 
©å_chg
 = 1;

640 
mpöfo
 = 
	`bgp_öfo_m∑th_fú°
 (
√w_be°
); mpinfo;

641 
mpöfo
 = 
	`bgp_öfo_m∑th_√xt
 (mpinfo))

643 i‡(
	`CHECK_FLAG
 (
mpöfo
->
Êags
, 
BGP_INFO_ATTR_CHANGED
))

645 
©å_chg
 = 1;

650 i‡(!
©å_chg
)

652 
	`as£π
 (
	`bgp_öfo_m∑th_©å
 (
√w_be°
));

657 
	`bgp_©å_dup
 (&
©å
, 
√w_be°
->attr);

660 
a•©h
 = 
	`a•©h_dup
 (
©å
.aspath);

661 
‹igö
 = 
©å
.origin;

662 
communôy
 = 
©å
.communôy ? 
	`communôy_dup
 (©å.communôyË: 
NULL
;

663 
´
 = 
©å
.
exåa
;

664 
ecomm
 = (
´
 &&áe->
ecommunôy
Ë? 
	`ecommunôy_dup
 (´->ecommunôyË: 
NULL
;

666 
mpöfo
 = 
	`bgp_öfo_m∑th_fú°
 (
√w_be°
); mpinfo;

667 
mpöfo
 = 
	`bgp_öfo_m∑th_√xt
 (mpinfo))

669 
asmîge
 = 
	`a•©h_aggªg©e
 (
a•©h
, 
mpöfo
->
©å
->aspath);

670 
	`a•©h_‰ì
 (
a•©h
);

671 
a•©h
 = 
asmîge
;

673 i‡(
‹igö
 < 
mpöfo
->
©å
->origin)

674 
‹igö
 = 
mpöfo
->
©å
->origin;

676 i‡(
mpöfo
->
©å
->
communôy
)

678 i‡(
communôy
)

680 
commîge
 = 
	`communôy_mîge
 (
communôy
, 
mpöfo
->
©å
->community);

681 
communôy
 = 
	`communôy_uniq_s‹t
 (
commîge
);

682 
	`communôy_‰ì
 (
commîge
);

685 
communôy
 = 
	`communôy_dup
 (
mpöfo
->
©å
->community);

688 
´
 = 
mpöfo
->
©å
->
exåa
;

689 i‡(
´
 &&áe->
ecommunôy
)

691 i‡(
ecomm
)

693 
ecommîge
 = 
	`ecommunôy_mîge
 (
ecomm
, 
´
->
ecommunôy
);

694 
ecomm
 = 
	`ecommunôy_uniq_s‹t
 (
ecommîge
);

695 
	`ecommunôy_‰ì
 (&
ecommîge
);

698 
ecomm
 = 
	`ecommunôy_dup
 (
´
->
ecommunôy
);

702 
©å
.
a•©h
 =áspath;

703 
©å
.
‹igö
 = origin;

704 i‡(
communôy
)

706 
©å
.
communôy
 = community;

707 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
);

709 i‡(
ecomm
)

711 
´
 = 
	`bgp_©å_exåa_gë
 (&
©å
);

712 
´
->
ecommunôy
 = 
ecomm
;

713 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
);

717 
©å
.
√xth›
.
s_addr
 = 0;

718 #ifde‡
HAVE_IPV6


719 i‡(
©å
.
exåa
)

720 
	`mem£t
 (&
©å
.
exåa
->
mp_√xth›_globÆ
, 0,  (
ö6_addr
));

725 
√w_©å
 = 
	`bgp_©å_öã∫
 (&
©å
);

726 
	`bgp_©å_exåa_‰ì
 (&
©å
);

728 i‡(
√w_©å
 !
	`bgp_öfo_m∑th_©å
 (
√w_be°
))

730 i‡((
ﬁd_©å
 = 
	`bgp_öfo_m∑th_©å
 (
√w_be°
)))

731 
	`bgp_©å_unöã∫
 (&
ﬁd_©å
);

732 
	`bgp_öfo_m∑th_©å_£t
 (
√w_be°
, 
√w_©å
);

733 
	`SET_FLAG
 (
√w_be°
->
Êags
, 
BGP_INFO_ATTR_CHANGED
);

736 
	`bgp_©å_unöã∫
 (&
√w_©å
);

737 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mpath.h

24 #i‚de‡
_QUAGGA_BGP_MPATH_H


25 
	#_QUAGGA_BGP_MPATH_H


	)

28 
	#BGP_DEFAULT_MAXPATHS
 1

	)

33 
	sbgp_öfo_m∑th


36 
bgp_öfo_m∑th
 *
	mmp_√xt
;

39 
bgp_öfo_m∑th
 *
	mmp_¥ev
;

42 
bgp_öfo
 *
	mmp_öfo
;

45 
u_öt32_t
 
	mmp_cou¡
;

48 
©å
 *
	mmp_©å
;

52 
bgp_maximum_∑ths_£t
 (
bgp
 *, 
afi_t
, 
ßfi_t
, , 
u_öt16_t
);

53 
bgp_maximum_∑ths_un£t
 (
bgp
 *, 
afi_t
, 
ßfi_t
, );

58 
bgp_mp_li°_öô
 (
li°
 *);

59 
bgp_mp_li°_˛ór
 (
li°
 *);

60 
bgp_mp_li°_add
 (
li°
 *, 
bgp_öfo
 *);

61 
bgp_mp_dmed_de£À˘
 (
bgp_öfo
 *);

62 
bgp_öfo_m∑th_upd©e
 (
bgp_node
 *, 
bgp_öfo
 *,

63 
bgp_öfo
 *, 
li°
 *,

64 
bgp_max∑ths_cfg
 *);

65 
bgp_öfo_m∑th_aggªg©e_upd©e
 (
bgp_öfo
 *,

66 
bgp_öfo
 *);

69 
bgp_öfo_m∑th_dequeue
 (
bgp_öfo
 *);

70 
bgp_öfo_m∑th_‰ì
 (
bgp_öfo_m∑th
 **);

73 
bgp_öfo
 *
bgp_öfo_m∑th_fú°
 (bgp_info *);

74 
bgp_öfo
 *
bgp_öfo_m∑th_√xt
 (bgp_info *);

77 
u_öt32_t
 
bgp_öfo_m∑th_cou¡
 (
bgp_öfo
 *);

78 
©å
 *
bgp_öfo_m∑th_©å
 (
bgp_öfo
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mplsvpn.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"¥efix.h
"

25 
	~"log.h
"

26 
	~"mem‹y.h
"

27 
	~"°ªam.h
"

29 
	~"bgpd/bgpd.h
"

30 
	~"bgpd/bgp_èbÀ.h
"

31 
	~"bgpd/bgp_rouã.h
"

32 
	~"bgpd/bgp_©å.h
"

33 
	~"bgpd/bgp_m∂sv≤.h
"

35 
u_öt16_t


36 
	$decode_rd_ty≥
 (
u_ch¨
 *
≤t
)

38 
u_öt16_t
 
v
;

40 
v
 = ((
u_öt16_t
Ë*
≤t
++ << 8);

41 
v
 |(
u_öt16_t
Ë*
≤t
;

42  
v
;

43 
	}
}

45 
u_öt32_t


46 
	$decode_œbñ
 (
u_ch¨
 *
≤t
)

48 
u_öt32_t
 
l
;

50 
l
 = ((
u_öt32_t
Ë*
≤t
++ << 12);

51 
l
 |(
u_öt32_t
Ë*
≤t
++ << 4;

52 
l
 |(
u_öt32_t
Ë((*
≤t
 & 0xf0) >> 4);

53  
l
;

54 
	}
}

57 
	$decode_rd_as
 (
u_ch¨
 *
≤t
, 
rd_as
 *rd_as)

59 
rd_as
->
as
 = (
u_öt16_t
Ë*
≤t
++ << 8;

60 
rd_as
->
as
 |(
u_öt16_t
Ë*
≤t
++;

62 
rd_as
->
vÆ
 = ((
u_öt32_t
Ë*
≤t
++ << 24);

63 
rd_as
->
vÆ
 |((
u_öt32_t
Ë*
≤t
++ << 16);

64 
rd_as
->
vÆ
 |((
u_öt32_t
Ë*
≤t
++ << 8);

65 
rd_as
->
vÆ
 |(
u_öt32_t
Ë*
≤t
;

66 
	}
}

69 
	$decode_rd_ù
 (
u_ch¨
 *
≤t
, 
rd_ù
 *rd_ip)

71 
	`mem˝y
 (&
rd_ù
->
ù
, 
≤t
, 4);

72 
≤t
 += 4;

74 
rd_ù
->
vÆ
 = ((
u_öt16_t
Ë*
≤t
++ << 8);

75 
rd_ù
->
vÆ
 |(
u_öt16_t
Ë*
≤t
;

76 
	}
}

79 
	$bgp_∆ri_∑r£_v≤v4
 (
≥î
 *≥î, 
©å
 *attr,

80 
bgp_∆ri
 *
∑ckë
)

82 
u_ch¨
 *
≤t
;

83 
u_ch¨
 *
lim
;

84 
¥efix
 
p
;

85 
psize
;

86 
¥efixÀn
;

87 
u_öt32_t
 
œbñ
;

88 
u_öt16_t
 
ty≥
;

89 
rd_as
Ñd_as;

90 
rd_ù
Ñd_ip;

91 
¥efix_rd
 
¥d
;

92 
u_ch¨
 *
èg≤t
;

95 i‡(
≥î
->
°©us
 !
E°ablished
)

99 
¥d
.
Ámûy
 = 
AF_UNSPEC
;

100 
¥d
.
¥efixÀn
 = 64;

102 
≤t
 = 
∑ckë
->
∆ri
;

103 
lim
 = 
≤t
 + 
∑ckë
->
Àngth
;

105 ; 
≤t
 < 
lim
;Ö¡ +
psize
)

108 
	`mem£t
 (&
p
, 0,  (
¥efix
));

111 
¥efixÀn
 = *
≤t
++;

112 
p
.
Ámûy
 = 
AF_INET
;

113 
psize
 = 
	`PSIZE
 (
¥efixÀn
);

115 i‡(
¥efixÀn
 < 88)

117 
	`zlog_îr
 ("¥efixÜígth i†Às†th™ 88: %d", 
¥efixÀn
);

121 
œbñ
 = 
	`decode_œbñ
 (
≤t
);

124 
èg≤t
 = 
≤t
;;

127 
	`mem˝y
 (&
¥d
.
vÆ
, 
≤t
 + 3, 8);

130 
ty≥
 = 
	`decode_rd_ty≥
 (
≤t
 + 3);

133 i‡(
ty≥
 =
RD_TYPE_AS
)

134 
	`decode_rd_as
 (
≤t
 + 5, &
rd_as
);

135 i‡(
ty≥
 =
RD_TYPE_IP
)

136 
	`decode_rd_ù
 (
≤t
 + 5, &
rd_ù
);

139 
	`zlog_îr
 ("InvÆid RDÅy≥ %d", 
ty≥
);

143 
p
.
¥efixÀn
 =Örefixlen - 88;

144 
	`mem˝y
 (&
p
.
u
.
¥efix
, 
≤t
 + 11, 
psize
 - 11);

147 i‡(
ty≥
 =
RD_TYPE_AS
)

148 
	`zlog_öfo
 ("¥efix %ld:%ld:%ld:%s/%d", 
œbñ
, 
rd_as
.
as
,Ñd_as.
vÆ
,

149 
	`öë_¡ﬂ
 (
p
.
u
.
¥efix4
),Ö.
¥efixÀn
);

150 i‡(
ty≥
 =
RD_TYPE_IP
)

151 
	`zlog_öfo
 ("¥efix %ld:%s:%ld:%s/%d", 
œbñ
, 
	`öë_¡ﬂ
 (
rd_ù
.
ù
),

152 
rd_ù
.
vÆ
, 
	`öë_¡ﬂ
 (
p
.
u
.
¥efix4
),Ö.
¥efixÀn
);

155 i‡(
≤t
 + 
psize
 > 
lim
)

158 i‡(
©å
)

159 
	`bgp_upd©e
 (
≥î
, &
p
, 
©å
, 
AFI_IP
, 
SAFI_MPLS_VPN
,

160 
ZEBRA_ROUTE_BGP
, 
BGP_ROUTE_NORMAL
, &
¥d
, 
èg≤t
, 0);

162 
	`bgp_wôhdøw
 (
≥î
, &
p
, 
©å
, 
AFI_IP
, 
SAFI_MPLS_VPN
,

163 
ZEBRA_ROUTE_BGP
, 
BGP_ROUTE_NORMAL
, &
¥d
, 
èg≤t
);

167 i‡(
≤t
 !
lim
)

171 
	}
}

174 
	$°r2¥efix_rd
 (c⁄° *
°r
, 
¥efix_rd
 *
¥d
)

176 
ªt
;

177 *
p
;

178 *
p2
;

179 
°ªam
 *
s
;

180 *
hÆf
;

181 
ö_addr
 
addr
;

183 
s
 = 
	`°ªam_√w
 (8);

185 
¥d
->
Ámûy
 = 
AF_UNSPEC
;

186 
¥d
->
¥efixÀn
 = 64;

188 
p
 = 
	`°rchr
 (
°r
, ':');

189 i‡(! 
p
)

192 i‡(! 
	`Æl_digô
 (
p
 + 1))

195 
hÆf
 = 
	`XMALLOC
 (
MTYPE_TMP
, (
p
 - 
°r
) + 1);

196 
	`mem˝y
 (
hÆf
, 
°r
, (
p
 - str));

197 
hÆf
[
p
 - 
°r
] = '\0';

199 
p2
 = 
	`°rchr
 (
°r
, '.');

201 i‡(! 
p2
)

203 i‡(! 
	`Æl_digô
 (
hÆf
))

205 
	`XFREE
 (
MTYPE_TMP
, 
hÆf
);

208 
	`°ªam_putw
 (
s
, 
RD_TYPE_AS
);

209 
	`°ªam_putw
 (
s
, 
	`©oi
 (
hÆf
));

210 
	`°ªam_pué
 (
s
, 
	`©ﬁ
 (
p
 + 1));

214 
ªt
 = 
	`öë_©⁄
 (
hÆf
, &
addr
);

215 i‡(! 
ªt
)

217 
	`XFREE
 (
MTYPE_TMP
, 
hÆf
);

220 
	`°ªam_putw
 (
s
, 
RD_TYPE_IP
);

221 
	`°ªam_put_ö_addr
 (
s
, &
addr
);

222 
	`°ªam_putw
 (
s
, 
	`©ﬁ
 (
p
 + 1));

224 
	`mem˝y
 (
¥d
->
vÆ
, 
s
->
d©a
, 8);

227 
	}
}

230 
	$°r2èg
 (c⁄° *
°r
, 
u_ch¨
 *
èg
)

232 
l
;

233 *
íd±r
;

234 
u_öt32_t
 
t
;

236 i‡(*
°r
 == '-')

239 
î∫o
 = 0;

240 
l
 = 
	`°πoul
 (
°r
, &
íd±r
, 10);

242 i‡(*
íd±r
 !'\0' || 
î∫o
 || 
l
 > 
UINT32_MAX
)

245 
t
 = (
u_öt32_t
Ë
l
;

247 
èg
[0] = (
u_ch¨
)(
t
 >> 12);

248 
èg
[1] = (
u_ch¨
)(
t
 >> 4);

249 
èg
[2] = (
u_ch¨
)(
t
 << 4);

252 
	}
}

255 
	$¥efix_rd2°r
 (
¥efix_rd
 *
¥d
, *
buf
, 
size_t
 
size
)

257 
u_ch¨
 *
≤t
;

258 
u_öt16_t
 
ty≥
;

259 
rd_as
Ñd_as;

260 
rd_ù
Ñd_ip;

262 i‡(
size
 < 
RD_ADDRSTRLEN
)

263  
NULL
;

265 
≤t
 = 
¥d
->
vÆ
;

267 
ty≥
 = 
	`decode_rd_ty≥
 (
≤t
);

269 i‡(
ty≥
 =
RD_TYPE_AS
)

271 
	`decode_rd_as
 (
≤t
 + 2, &
rd_as
);

272 
	`¢¥ötf
 (
buf
, 
size
, "%u:%d", 
rd_as
.
as
,Ñd_as.
vÆ
);

273  
buf
;

275 i‡(
ty≥
 =
RD_TYPE_IP
)

277 
	`decode_rd_ù
 (
≤t
 + 2, &
rd_ù
);

278 
	`¢¥ötf
 (
buf
, 
size
, "%s:%d", 
	`öë_¡ﬂ
 (
rd_ù
.
ù
),Ñd_ù.
vÆ
);

279  
buf
;

282  
NULL
;

283 
	}
}

286 
DEFUN
 (
v≤v4_√tw‹k
,

287 
v≤v4_√tw‹k_cmd
,

296  
bgp_°©ic_£t_v≤v4
 (
vty
, 
¨gv
[0],árgv[1],árgv[2]);

300 
DEFUN
 (
no_v≤v4_√tw‹k
,

301 
no_v≤v4_√tw‹k_cmd
,

303 
NO_STR


311  
bgp_°©ic_un£t_v≤v4
 (
vty
, 
¨gv
[0],árgv[1],árgv[2]);

315 
	$show_adj_rouã_v≤
 (
vty
 *vty, 
≥î
 *≥î, 
¥efix_rd
 *
¥d
)

317 
bgp
 *bgp;

318 
bgp_èbÀ
 *
èbÀ
;

319 
bgp_node
 *
∫
;

320 
bgp_node
 *
rm
;

321 
©å
 *attr;

322 
rd_hódî
;

323 
hódî
 = 1;

324 
v4_hódî
[] = " Network Next Hop Metric LocPrf Weight Path%s";

326 
bgp
 = 
	`bgp_gë_deÁu…
 ();

327 i‡(
bgp
 =
NULL
)

329 
	`vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

330  
CMD_WARNING
;

333 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rib
[
AFI_IP
][
SAFI_MPLS_VPN
]);Ñn;

334 
∫
 = 
	`bgp_rouã_√xt
 (rn))

336 i‡(
¥d
 && 
	`memcmp
 (
∫
->
p
.
u
.
vÆ
,Örd->val, 8) != 0)

339 i‡((
èbÀ
 = 
∫
->
öfo
Ë!
NULL
)

341 
rd_hódî
 = 1;

343 
rm
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñm;Ñm = 
	`bgp_rouã_√xt
 (rm))

344 i‡((
©å
 = 
rm
->
öfo
Ë!
NULL
)

346 i‡(
hódî
)

348 
	`vty_out
 (
vty
, "BGPÅable version is 0,ÜocalÑouter ID is %s%s",

349 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
), 
VTY_NEWLINE
);

350 
	`vty_out
 (
vty
, "Status codes: s suppressed, d damped, h history, * valid, > best, i - internal%s",

351 
VTY_NEWLINE
);

352 
	`vty_out
 (
vty
, "Origin codes: i - IGP,É - EGP, ? - incomplete%s%s",

353 
VTY_NEWLINE
, VTY_NEWLINE);

354 
	`vty_out
 (
vty
, 
v4_hódî
, 
VTY_NEWLINE
);

355 
hódî
 = 0;

358 i‡(
rd_hódî
)

360 
u_öt16_t
 
ty≥
;

361 
rd_as
Ñd_as;

362 
rd_ù
Ñd_ip;

363 
u_ch¨
 *
≤t
;

365 
≤t
 = 
∫
->
p
.
u
.
vÆ
;

368 
ty≥
 = 
	`decode_rd_ty≥
 (
≤t
);

370 i‡(
ty≥
 =
RD_TYPE_AS
)

371 
	`decode_rd_as
 (
≤t
 + 2, &
rd_as
);

372 i‡(
ty≥
 =
RD_TYPE_IP
)

373 
	`decode_rd_ù
 (
≤t
 + 2, &
rd_ù
);

375 
	`vty_out
 (
vty
, "Route Distinguisher: ");

377 i‡(
ty≥
 =
RD_TYPE_AS
)

378 
	`vty_out
 (
vty
, "%u:%d", 
rd_as
.
as
,Ñd_as.
vÆ
);

379 i‡(
ty≥
 =
RD_TYPE_IP
)

380 
	`vty_out
 (
vty
, "%s:%d", 
	`öë_¡ﬂ
 (
rd_ù
.
ù
),Ñd_ù.
vÆ
);

382 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

383 
rd_hódî
 = 0;

385 
	`rouã_vty_out_tmp
 (
vty
, &
rm
->
p
, 
©å
, 
SAFI_MPLS_VPN
);

389  
CMD_SUCCESS
;

390 
	}
}

392 
	ebgp_show_ty≥


394 
	mbgp_show_ty≥_n‹mÆ
,

395 
	mbgp_show_ty≥_ªgexp
,

396 
	mbgp_show_ty≥_¥efix_li°
,

397 
	mbgp_show_ty≥_fûãr_li°
,

398 
	mbgp_show_ty≥_√ighb‹
,

399 
	mbgp_show_ty≥_cidr_⁄ly
,

400 
	mbgp_show_ty≥_¥efix_l⁄gî
,

401 
	mbgp_show_ty≥_communôy_Æl
,

402 
	mbgp_show_ty≥_communôy
,

403 
	mbgp_show_ty≥_communôy_exa˘
,

404 
	mbgp_show_ty≥_communôy_li°
,

405 
	mbgp_show_ty≥_communôy_li°_exa˘


409 
	$bgp_show_m∂s_v≤
 (
vty
 *vty, 
¥efix_rd
 *
¥d
, 
bgp_show_ty≥
 
ty≥
,

410 *
ouçut_¨g
, 
ègs
)

412 
bgp
 *bgp;

413 
bgp_èbÀ
 *
èbÀ
;

414 
bgp_node
 *
∫
;

415 
bgp_node
 *
rm
;

416 
bgp_öfo
 *
ri
;

417 
rd_hódî
;

418 
hódî
 = 1;

419 
v4_hódî
[] = " Network Next Hop Metric LocPrf Weight Path%s";

420 
v4_hódî_èg
[] = " Network Next Hop InÅag/OutÅag%s";

422 
bgp
 = 
	`bgp_gë_deÁu…
 ();

423 i‡(
bgp
 =
NULL
)

425 
	`vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

426  
CMD_WARNING
;

429 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rib
[
AFI_IP
][
SAFI_MPLS_VPN
]);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

431 i‡(
¥d
 && 
	`memcmp
 (
∫
->
p
.
u
.
vÆ
,Örd->val, 8) != 0)

434 i‡((
èbÀ
 = 
∫
->
öfo
Ë!
NULL
)

436 
rd_hódî
 = 1;

438 
rm
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñm;Ñm = 
	`bgp_rouã_√xt
 (rm))

439 
ri
 = 
rm
->
öfo
;Ñi;Ñòri->
√xt
)

441 i‡(
ty≥
 =
bgp_show_ty≥_√ighb‹
)

443 
sockuni⁄
 *
su
 = 
ouçut_¨g
;

445 i‡(
ri
->
≥î
->
su_ªmŸe
 =
NULL
 || ! 
	`sockuni⁄_ßme
‘i->≥î->su_ªmŸe, 
su
))

448 i‡(
hódî
)

450 i‡(
ègs
)

451 
	`vty_out
 (
vty
, 
v4_hódî_èg
, 
VTY_NEWLINE
);

454 
	`vty_out
 (
vty
, "BGPÅable version is 0,ÜocalÑouter ID is %s%s",

455 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
), 
VTY_NEWLINE
);

456 
	`vty_out
 (
vty
, "Status codes: s suppressed, d damped, h history, * valid, > best, i - internal%s",

457 
VTY_NEWLINE
);

458 
	`vty_out
 (
vty
, "Origin codes: i - IGP,É - EGP, ? - incomplete%s%s",

459 
VTY_NEWLINE
, VTY_NEWLINE);

460 
	`vty_out
 (
vty
, 
v4_hódî
, 
VTY_NEWLINE
);

462 
hódî
 = 0;

465 i‡(
rd_hódî
)

467 
u_öt16_t
 
ty≥
;

468 
rd_as
Ñd_as;

469 
rd_ù
Ñd_ip;

470 
u_ch¨
 *
≤t
;

472 
≤t
 = 
∫
->
p
.
u
.
vÆ
;

475 
ty≥
 = 
	`decode_rd_ty≥
 (
≤t
);

477 i‡(
ty≥
 =
RD_TYPE_AS
)

478 
	`decode_rd_as
 (
≤t
 + 2, &
rd_as
);

479 i‡(
ty≥
 =
RD_TYPE_IP
)

480 
	`decode_rd_ù
 (
≤t
 + 2, &
rd_ù
);

482 
	`vty_out
 (
vty
, "Route Distinguisher: ");

484 i‡(
ty≥
 =
RD_TYPE_AS
)

485 
	`vty_out
 (
vty
, "%u:%d", 
rd_as
.
as
,Ñd_as.
vÆ
);

486 i‡(
ty≥
 =
RD_TYPE_IP
)

487 
	`vty_out
 (
vty
, "%s:%d", 
	`öë_¡ﬂ
 (
rd_ù
.
ù
),Ñd_ù.
vÆ
);

489 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

490 
rd_hódî
 = 0;

492 i‡(
ègs
)

493 
	`rouã_vty_out_èg
 (
vty
, &
rm
->
p
, 
ri
, 0, 
SAFI_MPLS_VPN
);

495 
	`rouã_vty_out
 (
vty
, &
rm
->
p
, 
ri
, 0, 
SAFI_MPLS_VPN
);

499  
CMD_SUCCESS
;

500 
	}
}

502 
DEFUN
 (
show_ù_bgp_v≤v4_Æl
,

503 
show_ù_bgp_v≤v4_Æl_cmd
,

505 
SHOW_STR


506 
IP_STR


507 
BGP_STR


511  
bgp_show_m∂s_v≤
 (
vty
, 
NULL
, 
bgp_show_ty≥_n‹mÆ
, NULL, 0);

514 
DEFUN
 (
show_ù_bgp_v≤v4_rd
,

515 
show_ù_bgp_v≤v4_rd_cmd
,

517 
SHOW_STR


518 
IP_STR


519 
BGP_STR


524 
	gªt
;

525 
¥efix_rd
 
	g¥d
;

527 
	gªt
 = 
°r2¥efix_rd
 (
¨gv
[0], &
¥d
);

528 i‡(! 
	gªt
)

530 
vty_out
 (
vty
, "%% MÆf‹med Rouã Di°öguishî%s", 
VTY_NEWLINE
);

531  
	gCMD_WARNING
;

533  
bgp_show_m∂s_v≤
 (
vty
, &
¥d
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
, 0);

536 
DEFUN
 (
show_ù_bgp_v≤v4_Æl_ègs
,

537 
show_ù_bgp_v≤v4_Æl_ègs_cmd
,

539 
SHOW_STR


540 
IP_STR


541 
BGP_STR


546  
bgp_show_m∂s_v≤
 (
vty
, 
NULL
, 
bgp_show_ty≥_n‹mÆ
, NULL, 1);

549 
DEFUN
 (
show_ù_bgp_v≤v4_rd_ègs
,

550 
show_ù_bgp_v≤v4_rd_ègs_cmd
,

552 
SHOW_STR


553 
IP_STR


554 
BGP_STR


560 
	gªt
;

561 
¥efix_rd
 
	g¥d
;

563 
	gªt
 = 
°r2¥efix_rd
 (
¨gv
[0], &
¥d
);

564 i‡(! 
	gªt
)

566 
vty_out
 (
vty
, "%% MÆf‹med Rouã Di°öguishî%s", 
VTY_NEWLINE
);

567  
	gCMD_WARNING
;

569  
bgp_show_m∂s_v≤
 (
vty
, &
¥d
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
, 1);

572 
DEFUN
 (
show_ù_bgp_v≤v4_Æl_√ighb‹_rouãs
,

573 
show_ù_bgp_v≤v4_Æl_√ighb‹_rouãs_cmd
,

575 
SHOW_STR


576 
IP_STR


577 
BGP_STR


584 
sockuni⁄
 
	gsu
;

585 
≥î
 *
	g≥î
;

586 
	gªt
;

588 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[0], &
su
);

589 i‡(
	gªt
 < 0)

591 
vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

592  
	gCMD_WARNING
;

595 
	g≥î
 = 
≥î_lookup
 (
NULL
, &
su
);

596 i‡(! 
	g≥î
 || !Öìr->
	gafc
[
AFI_IP
][
SAFI_MPLS_VPN
])

598 
vty_out
 (
vty
, "%% NÿsuchÇeighb‹ o∏addªs†Ámûy%s", 
VTY_NEWLINE
);

599  
	gCMD_WARNING
;

602  
bgp_show_m∂s_v≤
 (
vty
, 
NULL
, 
bgp_show_ty≥_√ighb‹
, &
su
, 0);

605 
DEFUN
 (
show_ù_bgp_v≤v4_rd_√ighb‹_rouãs
,

606 
show_ù_bgp_v≤v4_rd_√ighb‹_rouãs_cmd
,

608 
SHOW_STR


609 
IP_STR


610 
BGP_STR


618 
	gªt
;

619 
sockuni⁄
 
	gsu
;

620 
≥î
 *
	g≥î
;

621 
¥efix_rd
 
	g¥d
;

623 
	gªt
 = 
°r2¥efix_rd
 (
¨gv
[0], &
¥d
);

624 i‡(! 
	gªt
)

626 
vty_out
 (
vty
, "%% MÆf‹med Rouã Di°öguishî%s", 
VTY_NEWLINE
);

627  
	gCMD_WARNING
;

630 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[1], &
su
);

631 i‡(
	gªt
 < 0)

633 
vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

634  
	gCMD_WARNING
;

637 
	g≥î
 = 
≥î_lookup
 (
NULL
, &
su
);

638 i‡(! 
	g≥î
 || !Öìr->
	gafc
[
AFI_IP
][
SAFI_MPLS_VPN
])

640 
vty_out
 (
vty
, "%% NÿsuchÇeighb‹ o∏addªs†Ámûy%s", 
VTY_NEWLINE
);

641  
	gCMD_WARNING
;

644  
bgp_show_m∂s_v≤
 (
vty
, &
¥d
, 
bgp_show_ty≥_√ighb‹
, &
su
, 0);

647 
DEFUN
 (
show_ù_bgp_v≤v4_Æl_√ighb‹_advîti£d_rouãs
,

648 
show_ù_bgp_v≤v4_Æl_√ighb‹_advîti£d_rouãs_cmd
,

650 
SHOW_STR


651 
IP_STR


652 
BGP_STR


659 
	gªt
;

660 
≥î
 *
	g≥î
;

661 
sockuni⁄
 
	gsu
;

663 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[0], &
su
);

664 i‡(
	gªt
 < 0)

666 
vty_out
 (
vty
, "%% MÆf‹medáddªss: %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

667  
	gCMD_WARNING
;

669 
	g≥î
 = 
≥î_lookup
 (
NULL
, &
su
);

670 i‡(! 
	g≥î
 || !Öìr->
	gafc
[
AFI_IP
][
SAFI_MPLS_VPN
])

672 
vty_out
 (
vty
, "%% NÿsuchÇeighb‹ o∏addªs†Ámûy%s", 
VTY_NEWLINE
);

673  
	gCMD_WARNING
;

676  
show_adj_rouã_v≤
 (
vty
, 
≥î
, 
NULL
);

679 
DEFUN
 (
show_ù_bgp_v≤v4_rd_√ighb‹_advîti£d_rouãs
,

680 
show_ù_bgp_v≤v4_rd_√ighb‹_advîti£d_rouãs_cmd
,

682 
SHOW_STR


683 
IP_STR


684 
BGP_STR


692 
	gªt
;

693 
≥î
 *
	g≥î
;

694 
¥efix_rd
 
	g¥d
;

695 
sockuni⁄
 
	gsu
;

697 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[1], &
su
);

698 i‡(
	gªt
 < 0)

700 
vty_out
 (
vty
, "%% MÆf‹medáddªss: %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

701  
	gCMD_WARNING
;

703 
	g≥î
 = 
≥î_lookup
 (
NULL
, &
su
);

704 i‡(! 
	g≥î
 || !Öìr->
	gafc
[
AFI_IP
][
SAFI_MPLS_VPN
])

706 
vty_out
 (
vty
, "%% NÿsuchÇeighb‹ o∏addªs†Ámûy%s", 
VTY_NEWLINE
);

707  
	gCMD_WARNING
;

710 
	gªt
 = 
°r2¥efix_rd
 (
¨gv
[0], &
¥d
);

711 i‡(! 
	gªt
)

713 
vty_out
 (
vty
, "%% MÆf‹med Rouã Di°öguishî%s", 
VTY_NEWLINE
);

714  
	gCMD_WARNING
;

717  
show_adj_rouã_v≤
 (
vty
, 
≥î
, &
¥d
);

721 
	$bgp_m∂sv≤_öô
 ()

723 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
v≤v4_√tw‹k_cmd
);

724 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_v≤v4_√tw‹k_cmd
);

727 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_cmd
);

728 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_cmd
);

729 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_ègs_cmd
);

730 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_ègs_cmd
);

731 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹_rouãs_cmd
);

732 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹_rouãs_cmd
);

733 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹_advîti£d_rouãs_cmd
);

734 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹_advîti£d_rouãs_cmd
);

736 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_cmd
);

737 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_cmd
);

738 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_ègs_cmd
);

739 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_ègs_cmd
);

740 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹_rouãs_cmd
);

741 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹_rouãs_cmd
);

742 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹_advîti£d_rouãs_cmd
);

743 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹_advîti£d_rouãs_cmd
);

744 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mplsvpn.h

21 #i‚de‡
_QUAGGA_BGP_MPLSVPN_H


22 
	#_QUAGGA_BGP_MPLSVPN_H


	)

24 
	#RD_TYPE_AS
 0

	)

25 
	#RD_TYPE_IP
 1

	)

27 
	#RD_ADDRSTRLEN
 28

	)

29 
	srd_as


31 
u_öt16_t
 
	mty≥
;

32 
as_t
 
	mas
;

33 
u_öt32_t
 
	mvÆ
;

36 
	srd_ù


38 
u_öt16_t
 
	mty≥
;

39 
ö_addr
 
	mù
;

40 
u_öt16_t
 
	mvÆ
;

43 
bgp_m∂sv≤_öô
 ();

44 
bgp_∆ri_∑r£_v≤v4
 (
≥î
 *, 
©å
 *, 
bgp_∆ri
 *);

45 
u_öt32_t
 
decode_œbñ
 (
u_ch¨
 *);

46 
°r2¥efix_rd
 (c⁄° *, 
¥efix_rd
 *);

47 
°r2èg
 (c⁄° *, 
u_ch¨
 *);

48 *
¥efix_rd2°r
 (
¥efix_rd
 *, *, 
size_t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_network.c

21 
	~<zebø.h
>

23 
	~"thªad.h
"

24 
	~"sockuni⁄.h
"

25 
	~"sock›t.h
"

26 
	~"mem‹y.h
"

27 
	~"log.h
"

28 
	~"if.h
"

29 
	~"¥efix.h
"

30 
	~"comm™d.h
"

31 
	~"¥ivs.h
"

32 
	~"lökli°.h
"

33 
	~"√tw‹k.h
"

35 
	~"bgpd/bgpd.h
"

36 
	~"bgpd/bgp_fsm.h
"

37 
	~"bgpd/bgp_©å.h
"

38 
	~"bgpd/bgp_debug.h
"

39 
	~"bgpd/bgp_√tw‹k.h
"

41 
zebø_¥ivs_t
 
bgpd_¥ivs
;

44 
	sbgp_li°íî


46 
	mfd
;

47 
sockuni⁄
 
	msu
;

48 
thªad
 *
	mthªad
;

56 
	$bgp_md5_£t_sockë
 (
sockë
, 
sockuni⁄
 *
su
, c⁄° *
∑ssw‹d
)

58 
ªt
 = -1;

59 
í
 = 
ENOSYS
;

61 
	`as£π
 (
sockë
 >= 0);

63 #i‡
HAVE_DECL_TCP_MD5SIG


64 
ªt
 = 
	`sock›t_t˝_sig«tuª
 (
sockë
, 
su
, 
∑ssw‹d
);

65 
í
 = 
î∫o
;

68 i‡(
ªt
 < 0)

69 
	`zlog
 (
NULL
, 
LOG_WARNING
, "can't set TCP_MD5SIG option on socket %d: %s",

70 
sockë
, 
	`ß„_°ªº‹
 (
í
));

72  
ªt
;

73 
	}
}

77 
	$bgp_md5_£t_c⁄√˘
 (
sockë
, 
sockuni⁄
 *
su
, c⁄° *
∑ssw‹d
)

79 
ªt
 = -1;

81 #i‡
HAVE_DECL_TCP_MD5SIG


82 i‡–
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
) )

84 
	`zlog_îr
 ("%s: couldÇŸÑai£Örivs", 
__func__
);

85  
ªt
;

88 
ªt
 = 
	`bgp_md5_£t_sockë
 (
sockë
, 
su
, 
∑ssw‹d
);

90 i‡(
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

91 
	`zlog_îr
 ("%s: couldÇŸÜowîÖrivs", 
__func__
);

94  
ªt
;

95 
	}
}

98 
	$bgp_md5_£t
 (
≥î
 *peer)

100 
li°node
 *
node
;

101 
ªt
 = 0;

102 
bgp_li°íî
 *
li°íî
;

104 i‡–
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
) )

106 
	`zlog_îr
 ("%s: couldÇŸÑai£Örivs", 
__func__
);

113 
	`ALL_LIST_ELEMENTS_RO
(
bm
->
li°í_sockës
, 
node
, 
li°íî
))

114 i‡(
li°íî
->
su
.
ß
.
ß_Ámûy
 =
≥î
->su.sa.sa_family)

116 
ªt
 = 
	`bgp_md5_£t_sockë
 (
li°íî
->
fd
, &
≥î
->
su
,Öìr->
∑ssw‹d
);

120 i‡(
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

121 
	`zlog_îr
 ("%s: couldÇŸÜowîÖrivs", 
__func__
);

123  
ªt
;

124 
	}
}

128 
	$bgp_ac˚±
 (
thªad
 *thread)

130 
bgp_sock
;

131 
ac˚±_sock
;

132 
sockuni⁄
 
su
;

133 
bgp_li°íî
 *
li°íî
 = 
	`THREAD_ARG
(
thªad
);

134 
≥î
 *peer;

135 
≥î
 *
≥î1
;

136 
buf
[
SU_ADDRSTRLEN
];

139 
ac˚±_sock
 = 
	`THREAD_FD
 (
thªad
);

140 i‡(
ac˚±_sock
 < 0)

142 
	`zlog_îr
 ("ac˚±_sock i†√v©ivêvÆuê%d", 
ac˚±_sock
);

145 
li°íî
->
thªad
 = 
	`thªad_add_ªad
 (
ma°î
, 
bgp_ac˚±
,Üi°íî, 
ac˚±_sock
);

148 
bgp_sock
 = 
	`sockuni⁄_ac˚±
 (
ac˚±_sock
, &
su
);

149 i‡(
bgp_sock
 < 0)

151 
	`zlog_îr
 ("[Eº‹] BGP sockëác˚± faûed (%s)", 
	`ß„_°ªº‹
 (
î∫o
));

154 
	`£t_n⁄blockög
 (
bgp_sock
);

156 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

157 
	`zlog_debug
 ("[Evít] BGP c⁄√˘i⁄ from ho° %s", 
	`öë_sut›
 (&
su
, 
buf
));

160 
≥î1
 = 
	`≥î_lookup
 (
NULL
, &
su
);

161 i‡(! 
≥î1
 ||Öìr1->
°©us
 =
IdÀ
)

163 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

165 i‡(! 
≥î1
)

166 
	`zlog_debug
 ("[Event] BGP connection IPáddress %s isÇot configured",

167 
	`öë_sut›
 (&
su
, 
buf
));

169 
	`zlog_debug
 ("[Event] BGP connection IPáddress %s is Idle state",

170 
	`öë_sut›
 (&
su
, 
buf
));

172 
	`˛o£
 (
bgp_sock
);

177 i‡(
≥î1
->
s‹t
 =
BGP_PEER_EBGP
) {

178 
	`sock›t_âl
 (
≥î1
->
su
.
ß
.
ß_Ámûy
, 
bgp_sock
,Öìr1->
âl
);

179 i‡(
≥î1
->
gtsm_h›s
)

180 
	`sock›t_möâl
 (
≥î1
->
su
.
ß
.
ß_Ámûy
, 
bgp_sock
, 
MAXTTL
 + 1 -Öìr1->
gtsm_h›s
);

184 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

185 
	`zlog_debug
 ("[Event] Make dummyÖeer structure untilÑead OpenÖacket");

188 
buf
[
SU_ADDRSTRLEN
];

190 
≥î
 = 
	`≥î_¸óã_ac˚±
 (
≥î1
->
bgp
);

191 
	`SET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
);

192 
≥î
->
su
 = su;

193 
≥î
->
fd
 = 
bgp_sock
;

194 
≥î
->
°©us
 = 
A˘ive
;

195 
≥î
->
loˇl_id
 = 
≥î1
->local_id;

196 
≥î
->
v_hﬁdtime
 = 
≥î1
->v_holdtime;

197 
≥î
->
v_kì∑live
 = 
≥î1
->v_keepalive;

199 #ifde‡
USE_SRX


200 i‡(
	`CHECK_FLAG
 (
≥î1
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
))

202 if(
	`°ªam_gë_size
 (
≥î1
->
ibuf
Ë> 
BGP_MAX_PACKET_SIZE
)

203 
	`°ªam_ªsize
 (
≥î
->
ibuf
, 
BGP_MAX_PACKET_SIZE_EXTENDED
);

205 if(
	`CHECK_FLAG
(
≥î1
->
ˇp
, 
PEER_CAP_EXTENDED_MSG_SUPPORT
)

206 && (
	`°ªam_gë_size
 (
≥î1
->
w‹k
Ë> 
BGP_MAX_PACKET_SIZE
))

207 
	`°ªam_ªsize
 (
≥î
->
w‹k
, 
BGP_MAX_PACKET_SIZE_EXTENDED
);

209 if(!
	`CHECK_FLAG
(
≥î1
->
ˇp
, 
PEER_CAP_EXTENDED_MSG_SUPPORT
))

210 i‡(
	`CHECK_FLAG
 (
≥î1
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_LIBERAL
))

211 if(
	`°ªam_gë_size
 (
≥î1
->
ibuf
Ë> 
BGP_MAX_PACKET_SIZE
)

212 
	`°ªam_ªsize
 (
≥î
->
ibuf
, 
BGP_MAX_PACKET_SIZE_EXTENDED
);

217 
	`sockuni⁄2°r
 (&
su
, 
buf
, 
SU_ADDRSTRLEN
);

218 
≥î
->
ho°
 = 
	`XSTRDUP
 (
MTYPE_BGP_PEER_HOST
, 
buf
);

221 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_c⁄√˘i⁄_›í
);

224 
	}
}

228 
	$bgp_böd
 (
≥î
 *peer)

230 #ifde‡
SO_BINDTODEVICE


231 
ªt
;

232 
i‰eq
 ifreq;

234 i‡(! 
≥î
->
i‚ame
)

237 
	`°∫˝y
 ((*)&
i‰eq
.
i‰_«me
, 
≥î
->
i‚ame
,  (ifreq.ifr_name));

239 i‡–
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
) )

240 
	`zlog_îr
 ("bgp_bind: couldÇotÑaiseÖrivs");

242 
ªt
 = 
	`£tsock›t
 (
≥î
->
fd
, 
SOL_SOCKET
, 
SO_BINDTODEVICE
,

243 &
i‰eq
,  (ifreq));

245 i‡(
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

246 
	`zlog_îr
 ("bgp_bind: couldÇotÜowerÖrivs");

248 i‡(
ªt
 < 0)

250 
	`zlog
 (
≥î
->
log
, 
LOG_INFO
, "bödÅÿöãrÁ˚ %†Áûed",Öìr->
i‚ame
);

251  
ªt
;

255 
	}
}

258 
	$bgp_upd©e_addªss
 (
öãrÁ˚
 *
iÂ
, c⁄° 
sockuni⁄
 *
d°
,

259 
sockuni⁄
 *
addr
)

261 
¥efix
 *
p
, *
£l
, *
d
;

262 
c⁄√˘ed
 *connected;

263 
li°node
 *
node
;

264 
comm⁄
;

266 
d
 = 
	`sockuni⁄2ho°¥efix
 (
d°
);

267 
£l
 = 
NULL
;

268 
comm⁄
 = -1;

270 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
node
, connected))

272 
p
 = 
c⁄√˘ed
->
addªss
;

273 i‡(
p
->
Ámûy
 !
d
->family)

275 i‡(
	`¥efix_comm⁄_bôs
 (
p
, 
d
Ë> 
comm⁄
)

277 
£l
 = 
p
;

278 
comm⁄
 = 
	`¥efix_comm⁄_bôs
 (
£l
, 
d
);

282 
	`¥efix_‰ì
 (
d
);

283 i‡(!
£l
)

286 
	`¥efix2sockuni⁄
 (
£l
, 
addr
);

288 
	}
}

292 
	$bgp_upd©e_sour˚
 (
≥î
 *peer)

294 
öãrÁ˚
 *
iÂ
;

295 
sockuni⁄
 
addr
;

298 i‡(
≥î
->
upd©e_if
)

300 
iÂ
 = 
	`if_lookup_by_«me
 (
≥î
->
upd©e_if
);

301 i‡(! 
iÂ
)

304 i‡(
	`bgp_upd©e_addªss
 (
iÂ
, &
≥î
->
su
, &
addr
))

307 
	`sockuni⁄_böd
 (
≥î
->
fd
, &
addr
, 0, &addr);

311 i‡(
≥î
->
upd©e_sour˚
)

312 
	`sockuni⁄_böd
 (
≥î
->
fd
,Öìr->
upd©e_sour˚
, 0,Öeer->update_source);

313 
	}
}

317 
	$bgp_c⁄√˘
 (
≥î
 *peer)

319 
ifödex
 = 0;

322 
≥î
->
fd
 = 
	`sockuni⁄_sockë
 (&≥î->
su
);

323 i‡(
≥î
->
fd
 < 0)

327 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP
) {

328 
	`sock›t_âl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
,Öìr->
âl
);

329 i‡(
≥î
->
gtsm_h›s
)

330 
	`sock›t_möâl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
, 
MAXTTL
 + 1 -Öìr->
gtsm_h›s
);

333 
	`sock›t_ªu£addr
 (
≥î
->
fd
);

334 
	`sock›t_ªu£p‹t
 (
≥î
->
fd
);

336 #ifde‡
IPTOS_PREC_INTERNETCONTROL


337 i‡(
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
))

338 
	`zlog_îr
 ("%s: couldÇŸÑai£Örivs", 
__func__
);

339 i‡(
	`sockuni⁄_Ámûy
 (&
≥î
->
su
Ë=
AF_INET
)

340 
	`£tsock›t_ùv4_tos
 (
≥î
->
fd
, 
IPTOS_PREC_INTERNETCONTROL
);

341 #ifde‡
HAVE_IPV6


342 i‡(
	`sockuni⁄_Ámûy
 (&
≥î
->
su
Ë=
AF_INET6
)

343 
	`£tsock›t_ùv6_t˛ass
 (
≥î
->
fd
, 
IPTOS_PREC_INTERNETCONTROL
);

345 i‡(
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
))

346 
	`zlog_îr
 ("%s: couldÇŸÜowîÖrivs", 
__func__
);

349 i‡(
≥î
->
∑ssw‹d
)

350 
	`bgp_md5_£t_c⁄√˘
 (
≥î
->
fd
, &≥î->
su
,Öìr->
∑ssw‹d
);

353 
	`bgp_böd
 (
≥î
);

356 
	`bgp_upd©e_sour˚
 (
≥î
);

358 #ifde‡
HAVE_IPV6


359 i‡(
≥î
->
i‚ame
)

360 
ifödex
 = 
	`if_«mëoödex
 (
≥î
->
i‚ame
);

363 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

364 
	`∂og_debug
 (
≥î
->
log
, "%s [Event] Connect startÅo %s fd %d",

365 
≥î
->
ho°
,Öìr->ho°,Öìr->
fd
);

368  
	`sockuni⁄_c⁄√˘
 (
≥î
->
fd
, &≥î->
su
, 
	`ht⁄s
 (≥î->
p‹t
), 
ifödex
);

369 
	}
}

373 
	$bgp_gësock«me
 (
≥î
 *peer)

375 i‡(
≥î
->
su_loˇl
)

377 
	`sockuni⁄_‰ì
 (
≥î
->
su_loˇl
);

378 
≥î
->
su_loˇl
 = 
NULL
;

381 i‡(
≥î
->
su_ªmŸe
)

383 
	`sockuni⁄_‰ì
 (
≥î
->
su_ªmŸe
);

384 
≥î
->
su_ªmŸe
 = 
NULL
;

387 
≥î
->
su_loˇl
 = 
	`sockuni⁄_gësock«me
 (≥î->
fd
);

388 
≥î
->
su_ªmŸe
 = 
	`sockuni⁄_gë≥î«me
 (≥î->
fd
);

390 
	`bgp_√xth›_£t
 (
≥î
->
su_loˇl
,Öìr->
su_ªmŸe
, &≥î->
√xth›
,Öeer);

391 
	}
}

395 
	$bgp_li°íî
 (
sock
, 
sockaddr
 *
ß
, 
sockÀn_t
 
ßÀn
)

397 
bgp_li°íî
 *
li°íî
;

398 
ªt
, 
í
;

400 
	`sock›t_ªu£addr
 (
sock
);

401 
	`sock›t_ªu£p‹t
 (
sock
);

403 i‡(
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
))

404 
	`zlog_îr
 ("%s: couldÇŸÑai£Örivs", 
__func__
);

406 #ifde‡
IPTOS_PREC_INTERNETCONTROL


407 i‡(
ß
->
ß_Ámûy
 =
AF_INET
)

408 
	`£tsock›t_ùv4_tos
 (
sock
, 
IPTOS_PREC_INTERNETCONTROL
);

409 #ifde‡
HAVE_IPV6


410 i‡(
ß
->
ß_Ámûy
 =
AF_INET6
)

411 
	`£tsock›t_ùv6_t˛ass
 (
sock
, 
IPTOS_PREC_INTERNETCONTROL
);

415 
	`sock›t_v6⁄ly
 (
ß
->
ß_Ámûy
, 
sock
);

417 
ªt
 = 
	`böd
 (
sock
, 
ß
, 
ßÀn
);

418 
í
 = 
î∫o
;

419 i‡(
bgpd_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
))

420 
	`zlog_îr
 ("%s: couldÇŸÜowîÖrivs", 
__func__
);

422 i‡(
ªt
 < 0)

424 
	`zlog_îr
 ("böd: %s", 
	`ß„_°ªº‹
 (
í
));

425  
ªt
;

428 
ªt
 = 
	`li°í
 (
sock
, 3);

429 i‡(
ªt
 < 0)

431 
	`zlog_îr
 ("li°í: %s", 
	`ß„_°ªº‹
 (
î∫o
));

432  
ªt
;

435 
li°íî
 = 
	`XMALLOC
 (
MTYPE_BGP_LISTENER
, (*listener));

436 
li°íî
->
fd
 = 
sock
;

437 
	`mem˝y
(&
li°íî
->
su
, 
ß
, 
ßÀn
);

438 
li°íî
->
thªad
 = 
	`thªad_add_ªad
 (
ma°î
, 
bgp_ac˚±
,Üi°íî, 
sock
);

439 
	`li°node_add
 (
bm
->
li°í_sockës
, 
li°íî
);

442 
	}
}

445 #i‡
deföed
 (
HAVE_IPV6
Ë&& ! deföed (
NRL
)

447 
	$bgp_sockë
 (
p‹t
, c⁄° *
addªss
)

449 
addröfo
 *
aöfo
;

450 
addröfo
 *
aöfo_ßve
;

451 c⁄° 
addröfo
 
ªq
 = {

452 .
ai_Ámûy
 = 
AF_UNSPEC
,

453 .
ai_Êags
 = 
AI_PASSIVE
,

454 .
ai_sockty≥
 = 
SOCK_STREAM
,

456 
ªt
, 
cou¡
;

457 
p‹t_°r
[
BUFSIZ
];

459 
	`¢¥ötf
 (
p‹t_°r
, ’‹t_°r), "%d", 
p‹t
);

460 
p‹t_°r
[ (port_str) - 1] = '\0';

462 
ªt
 = 
	`gëaddröfo
 (
addªss
, 
p‹t_°r
, &
ªq
, &
aöfo_ßve
);

463 i‡(
ªt
 != 0)

465 
	`zlog_îr
 ("gëaddröfo: %s", 
	`gai_°ªº‹
 (
ªt
));

469 
cou¡
 = 0;

470 
aöfo
 = 
aöfo_ßve
;áöfo;áöfÿaöfo->
ai_√xt
)

472 
sock
;

474 i‡(
aöfo
->
ai_Ámûy
 !
AF_INET
 &&áöfo->ai_Ámûy !
AF_INET6
)

477 
sock
 = 
	`sockë
 (
aöfo
->
ai_Ámûy
,áöfo->
ai_sockty≥
,áöfo->
ai_¥Ÿocﬁ
);

478 i‡(
sock
 < 0)

480 
	`zlog_îr
 ("sockë: %s", 
	`ß„_°ªº‹
 (
î∫o
));

485 
	`sock›t_âl
 (
aöfo
->
ai_Ámûy
, 
sock
, 
MAXTTL
);

487 
ªt
 = 
	`bgp_li°íî
 (
sock
, 
aöfo
->
ai_addr
,áöfo->
ai_addæí
);

488 i‡(
ªt
 == 0)

489 ++
cou¡
;

491 
	`˛o£
(
sock
);

493 
	`‰ìaddröfo
 (
aöfo_ßve
);

494 i‡(
cou¡
 == 0)

496 
	`zlog_îr
 ("%s:ÇÿußbÀáddªs£s", 
__func__
);

501 
	}
}

505 
	$bgp_sockë
 (
p‹t
, c⁄° *
addªss
)

507 
sock
;

508 
sockÀn
;

509 
sockaddr_ö
 
sö
;

510 
ªt
, 
í
;

512 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_STREAM
, 0);

513 i‡(
sock
 < 0)

515 
	`zlog_îr
 ("sockë: %s", 
	`ß„_°ªº‹
 (
î∫o
));

516  
sock
;

520 
	`sock›t_âl
 (
AF_INET
, 
sock
, 
MAXTTL
);

522 
	`mem£t
 (&
sö
, 0,  (
sockaddr_ö
));

523 
sö
.
sö_Ámûy
 = 
AF_INET
;

524 
sö
.
sö_p‹t
 = 
	`ht⁄s
 (
p‹t
);

525 
sockÀn
 =  (
sockaddr_ö
);

527 i‡(
addªss
 && ((
ªt
 = 
	`öë_©⁄
◊ddªss, &
sö
.
sö_addr
)) < 1))

529 
	`zlog_îr
("bgp_socket: couldÇotÖarse ipáddress %s: %s",

530 
addªss
, 
	`ß„_°ªº‹
 (
î∫o
));

531  
ªt
;

533 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


534 
sö
.
sö_Àn
 = 
sockÀn
;

537 
ªt
 = 
	`bgp_li°íî
 (
sock
, (
sockaddr
 *Ë&
sö
, 
sockÀn
);

538 i‡(
ªt
 < 0)

540 
	`˛o£
 (
sock
);

541  
ªt
;

543  
sock
;

544 
	}
}

548 
	$bgp_˛o£
 ()

550 
li°node
 *
node
, *
√xt
;

551 
bgp_li°íî
 *
li°íî
;

553 
	`ALL_LIST_ELEMENTS
 (
bm
->
li°í_sockës
, 
node
, 
√xt
, 
li°íî
))

555 
	`thªad_ˇn˚l
 (
li°íî
->
thªad
);

556 
	`˛o£
 (
li°íî
->
fd
);

557 
	`li°node_dñëe
 (
bm
->
li°í_sockës
, 
li°íî
);

558 
	`XFREE
 (
MTYPE_BGP_LISTENER
, 
li°íî
);

560 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_network.h

21 #i‚de‡
_QUAGGA_BGP_NETWORK_H


22 
	#_QUAGGA_BGP_NETWORK_H


	)

24 
bgp_sockë
 (, const *);

25 
bgp_˛o£
 ();

26 
bgp_c⁄√˘
 (
≥î
 *);

27 
bgp_gësock«me
 (
≥î
 *);

29 
bgp_md5_£t
 (
≥î
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_nexthop.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"thªad.h
"

25 
	~"¥efix.h
"

26 
	~"z˛õ¡.h
"

27 
	~"°ªam.h
"

28 
	~"√tw‹k.h
"

29 
	~"log.h
"

30 
	~"mem‹y.h
"

31 
	~"hash.h
"

32 
	~"jhash.h
"

34 
	~"bgpd/bgpd.h
"

35 
	~"bgpd/bgp_èbÀ.h
"

36 
	~"bgpd/bgp_rouã.h
"

37 
	~"bgpd/bgp_©å.h
"

38 
	~"bgpd/bgp_√xth›.h
"

39 
	~"bgpd/bgp_debug.h
"

40 
	~"bgpd/bgp_damp.h
"

41 
	~"zebø/rib.h
"

42 
	~"zebø/z£rv.h
"

44 
bgp_√xth›_ˇche
 *
zlookup_quîy
 (
ö_addr
);

45 #ifde‡
HAVE_IPV6


46 
bgp_√xth›_ˇche
 *
zlookup_quîy_ùv6
 (
ö6_addr
 *);

50 
thªad
 *
	gbgp_sˇn_thªad
 = 
NULL
;

53 
thªad
 *
	gbgp_imp‹t_thªad
 = 
NULL
;

56 
	gbgp_sˇn_öãrvÆ
;

59 
	gbgp_imp‹t_öãrvÆ
;

62 
bgp_èbÀ
 *
	gbgp_√xth›_ˇche_èbÀ
[
AFI_MAX
];

63 
bgp_èbÀ
 *
	gˇche1_èbÀ
[
AFI_MAX
];

64 
bgp_èbÀ
 *
	gˇche2_èbÀ
[
AFI_MAX
];

67 
bgp_èbÀ
 *
	gbgp_c⁄√˘ed_èbÀ
[
AFI_MAX
];

70 
z˛õ¡
 *
	gzlookup
 = 
NULL
;

74 
	$bnc_√xth›_add
 (
bgp_√xth›_ˇche
 *
bnc
, 
√xth›
 *nexthop)

76 
√xth›
 *
œ°
;

78 
œ°
 = 
bnc
->
√xth›
;Üa° &&Üa°->
√xt
;Üast =Üast->next)

80 i‡(
œ°
)

81 
œ°
->
√xt
 = 
√xth›
;

83 
bnc
->
√xth›
 =Çexthop;

84 
√xth›
->
¥ev
 = 
œ°
;

85 
	}
}

88 
	$bnc_√xth›_‰ì
 (
bgp_√xth›_ˇche
 *
bnc
)

90 
√xth›
 *nexthop;

91 
√xth›
 *
√xt
 = 
NULL
;

93 
√xth›
 = 
bnc
->√xth›;Çexth›;Çexth› = 
√xt
)

95 
√xt
 = 
√xth›
->next;

96 
	`XFREE
 (
MTYPE_NEXTHOP
, 
√xth›
);

98 
	}
}

100 
bgp_√xth›_ˇche
 *

101 
	$bnc_√w
 ()

103  
	`XCALLOC
 (
MTYPE_BGP_NEXTHOP_CACHE
,  (
bgp_√xth›_ˇche
));

104 
	}
}

107 
	$bnc_‰ì
 (
bgp_√xth›_ˇche
 *
bnc
)

109 
	`bnc_√xth›_‰ì
 (
bnc
);

110 
	`XFREE
 (
MTYPE_BGP_NEXTHOP_CACHE
, 
bnc
);

111 
	}
}

114 
	$bgp_√xth›_ßme
 (
√xth›
 *
√xt1
, √xth› *
√xt2
)

116 i‡(
√xt1
->
ty≥
 !
√xt2
->type)

119 
√xt1
->
ty≥
)

121 
ZEBRA_NEXTHOP_IPV4
:

122 i‡(! 
	`IPV4_ADDR_SAME
 (&
√xt1
->
g©e
.
ùv4
, &
√xt2
->gate.ipv4))

125 
ZEBRA_NEXTHOP_IFINDEX
:

126 
ZEBRA_NEXTHOP_IFNAME
:

127 i‡(
√xt1
->
ifödex
 !
√xt2
->ifindex)

130 #ifde‡
HAVE_IPV6


131 
ZEBRA_NEXTHOP_IPV6
:

132 i‡(! 
	`IPV6_ADDR_SAME
 (&
√xt1
->
g©e
.
ùv6
, &
√xt2
->gate.ipv6))

135 
ZEBRA_NEXTHOP_IPV6_IFINDEX
:

136 
ZEBRA_NEXTHOP_IPV6_IFNAME
:

137 i‡(! 
	`IPV6_ADDR_SAME
 (&
√xt1
->
g©e
.
ùv6
, &
√xt2
->gate.ipv6))

139 i‡(
√xt1
->
ifödex
 !
√xt2
->ifindex)

148 
	}
}

151 
	$bgp_√xth›_ˇche_dif„ª¡
 (
bgp_√xth›_ˇche
 *
bnc1
,

152 
bgp_√xth›_ˇche
 *
bnc2
)

154 
i
;

155 
√xth›
 *
√xt1
, *
√xt2
;

157 i‡(
bnc1
->
√xth›_num
 !
bnc2
->nexthop_num)

160 
√xt1
 = 
bnc1
->
√xth›
;

161 
√xt2
 = 
bnc2
->
√xth›
;

163 
i
 = 0; i < 
bnc1
->
√xth›_num
; i++)

165 i‡(! 
	`bgp_√xth›_ßme
 (
√xt1
, 
√xt2
))

168 
√xt1
 =Çext1->
√xt
;

169 
√xt2
 =Çext2->
√xt
;

172 
	}
}

176 
	$bgp_√xth›_⁄lök
 (
afi_t
 
afi
, 
©å
 *attr)

178 
bgp_node
 *
∫
;

181 i‡(
zlookup
->
sock
 < 0)

185 i‡(
afi
 =
AFI_IP
)

187 
∫
 = 
	`bgp_node_m©ch_ùv4
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
], &
©å
->
√xth›
);

188 i‡(
∫
)

190 
	`bgp_u∆ock_node
 (
∫
);

194 #ifde‡
HAVE_IPV6


195 i‡(
afi
 =
AFI_IP6
)

197 i‡(
©å
->
exåa
->
mp_√xth›_Àn
 == 32)

199 i‡(
©å
->
exåa
->
mp_√xth›_Àn
 == 16)

201 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
©å
->
exåa
->
mp_√xth›_globÆ
))

204 
∫
 = 
	`bgp_node_m©ch_ùv6
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP6
],

205 &
©å
->
exåa
->
mp_√xth›_globÆ
);

206 i‡(
∫
)

208 
	`bgp_u∆ock_node
 (
∫
);

215 
	}
}

217 #ifde‡
HAVE_IPV6


220 
	$bgp_√xth›_lookup_ùv6
 (
≥î
 *≥î, 
bgp_öfo
 *
ri
, *
ch™ged
,

221 *
mëricch™ged
)

223 
bgp_node
 *
∫
;

224 
¥efix
 
p
;

225 
bgp_√xth›_ˇche
 *
bnc
;

226 
©å
 *attr;

229 i‡(
zlookup
->
sock
 < 0)

231 i‡(
ri
->
exåa
)

232 
ri
->
exåa
->
igpmëric
 = 0;

237 
©å
 = 
ri
->attr;

239 i‡(
©å
->
exåa
->
mp_√xth›_Àn
 != 16

240 || 
	`IN6_IS_ADDR_LINKLOCAL
 (&
©å
->
exåa
->
mp_√xth›_globÆ
))

243 
	`mem£t
 (&
p
, 0,  (
¥efix
));

244 
p
.
Ámûy
 = 
AF_INET6
;

245 
p
.
¥efixÀn
 = 
IPV6_MAX_BITLEN
;

246 
p
.
u
.
¥efix6
 = 
©å
->
exåa
->
mp_√xth›_globÆ
;

249 
∫
 = 
	`bgp_node_gë
 (
bgp_√xth›_ˇche_èbÀ
[
AFI_IP6
], &
p
);

251 i‡(
∫
->
öfo
)

253 
bnc
 = 
∫
->
öfo
;

254 
	`bgp_u∆ock_node
 (
∫
);

258 i‡(
NULL
 =(
bnc
 = 
	`zlookup_quîy_ùv6
 (&
©å
->
exåa
->
mp_√xth›_globÆ
)))

259 
bnc
 = 
	`bnc_√w
 ();

262 i‡(
ch™ged
)

264 
bgp_èbÀ
 *
ﬁd
;

265 
bgp_node
 *
ﬁd∫
;

267 i‡(
bgp_√xth›_ˇche_èbÀ
[
AFI_IP6
] =
ˇche1_èbÀ
[AFI_IP6])

268 
ﬁd
 = 
ˇche2_èbÀ
[
AFI_IP6
];

270 
ﬁd
 = 
ˇche1_èbÀ
[
AFI_IP6
];

272 
ﬁd∫
 = 
	`bgp_node_lookup
 (
ﬁd
, &
p
);

273 i‡(
ﬁd∫
)

275 
bgp_√xth›_ˇche
 *
ﬁdbnc
 = 
ﬁd∫
->
öfo
;

277 
bnc
->
ch™ged
 = 
	`bgp_√xth›_ˇche_dif„ª¡
 (bnc, 
ﬁdbnc
);

279 i‡(
bnc
->
mëric
 !
ﬁdbnc
->metric)

280 
bnc
->
mëricch™ged
 = 1;

282 
	`bgp_u∆ock_node
 (
ﬁd∫
);

286 
∫
->
öfo
 = 
bnc
;

289 i‡(
ch™ged
)

290 *
ch™ged
 = 
bnc
->changed;

292 i‡(
mëricch™ged
)

293 *
mëricch™ged
 = 
bnc
->metricchanged;

295 i‡(
bnc
->
vÆid
 && bnc->
mëric
)

296 (
	`bgp_öfo_exåa_gë
 (
ri
))->
igpmëric
 = 
bnc
->
mëric
;

297 i‡(
ri
->
exåa
)

298 
ri
->
exåa
->
igpmëric
 = 0;

300  
bnc
->
vÆid
;

301 
	}
}

306 
	$bgp_√xth›_lookup
 (
afi_t
 
afi
, 
≥î
 *≥î, 
bgp_öfo
 *
ri
,

307 *
ch™ged
, *
mëricch™ged
)

309 
bgp_node
 *
∫
;

310 
¥efix
 
p
;

311 
bgp_√xth›_ˇche
 *
bnc
;

312 
ö_addr
 
addr
;

315 i‡(
zlookup
->
sock
 < 0)

317 i‡(
ri
->
exåa
)

318 
ri
->
exåa
->
igpmëric
 = 0;

322 #ifde‡
HAVE_IPV6


323 i‡(
afi
 =
AFI_IP6
)

324  
	`bgp_√xth›_lookup_ùv6
 (
≥î
, 
ri
, 
ch™ged
, 
mëricch™ged
);

327 
addr
 = 
ri
->
©å
->
√xth›
;

329 
	`mem£t
 (&
p
, 0,  (
¥efix
));

330 
p
.
Ámûy
 = 
AF_INET
;

331 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

332 
p
.
u
.
¥efix4
 = 
addr
;

335 
∫
 = 
	`bgp_node_gë
 (
bgp_√xth›_ˇche_èbÀ
[
AFI_IP
], &
p
);

337 i‡(
∫
->
öfo
)

339 
bnc
 = 
∫
->
öfo
;

340 
	`bgp_u∆ock_node
 (
∫
);

344 i‡(
NULL
 =(
bnc
 = 
	`zlookup_quîy
 (
addr
)))

345 
bnc
 = 
	`bnc_√w
 ();

348 i‡(
ch™ged
)

350 
bgp_èbÀ
 *
ﬁd
;

351 
bgp_node
 *
ﬁd∫
;

353 i‡(
bgp_√xth›_ˇche_èbÀ
[
AFI_IP
] =
ˇche1_èbÀ
[AFI_IP])

354 
ﬁd
 = 
ˇche2_èbÀ
[
AFI_IP
];

356 
ﬁd
 = 
ˇche1_èbÀ
[
AFI_IP
];

358 
ﬁd∫
 = 
	`bgp_node_lookup
 (
ﬁd
, &
p
);

359 i‡(
ﬁd∫
)

361 
bgp_√xth›_ˇche
 *
ﬁdbnc
 = 
ﬁd∫
->
öfo
;

363 
bnc
->
ch™ged
 = 
	`bgp_√xth›_ˇche_dif„ª¡
 (bnc, 
ﬁdbnc
);

365 i‡(
bnc
->
mëric
 !
ﬁdbnc
->metric)

366 
bnc
->
mëricch™ged
 = 1;

368 
	`bgp_u∆ock_node
 (
ﬁd∫
);

372 
∫
->
öfo
 = 
bnc
;

375 i‡(
ch™ged
)

376 *
ch™ged
 = 
bnc
->changed;

378 i‡(
mëricch™ged
)

379 *
mëricch™ged
 = 
bnc
->metricchanged;

381 i‡(
bnc
->
vÆid
 && bnc->
mëric
)

382 (
	`bgp_öfo_exåa_gë
(
ri
))->
igpmëric
 = 
bnc
->
mëric
;

383 i‡(
ri
->
exåa
)

384 
ri
->
exåa
->
igpmëric
 = 0;

386  
bnc
->
vÆid
;

387 
	}
}

391 
	$bgp_√xth›_ˇche_ª£t
 (
bgp_èbÀ
 *
èbÀ
)

393 
bgp_node
 *
∫
;

394 
bgp_√xth›_ˇche
 *
bnc
;

396 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

397 i‡((
bnc
 = 
∫
->
öfo
Ë!
NULL
)

399 
	`bnc_‰ì
 (
bnc
);

400 
∫
->
öfo
 = 
NULL
;

401 
	`bgp_u∆ock_node
 (
∫
);

403 
	}
}

406 
	$bgp_sˇn
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

408 
bgp_node
 *
∫
;

409 
bgp
 *bgp;

410 
bgp_öfo
 *
bi
;

411 
bgp_öfo
 *
√xt
;

412 
≥î
 *peer;

413 
li°node
 *
node
, *
¬ode
;

414 
vÆid
;

415 
cuºít
;

416 
ch™ged
;

417 
mëricch™ged
;

420 i‡(
bgp_√xth›_ˇche_èbÀ
[
afi
] =
ˇche1_èbÀ
[afi])

421 
bgp_√xth›_ˇche_èbÀ
[
afi
] = 
ˇche2_èbÀ
[afi];

423 
bgp_√xth›_ˇche_èbÀ
[
afi
] = 
ˇche1_èbÀ
[afi];

426 
bgp
 = 
	`bgp_gë_deÁu…
 ();

427 i‡(
bgp
 =
NULL
)

431 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

433 i‡(
≥î
->
°©us
 !
E°ablished
)

436 i‡(
≥î
->
afc
[
afi
][
SAFI_UNICAST
])

437 
	`bgp_maximum_¥efix_ovîÊow
 (
≥î
, 
afi
, 
SAFI_UNICAST
, 1);

438 i‡(
≥î
->
afc
[
afi
][
SAFI_MULTICAST
])

439 
	`bgp_maximum_¥efix_ovîÊow
 (
≥î
, 
afi
, 
SAFI_MULTICAST
, 1);

440 i‡(
≥î
->
afc
[
afi
][
SAFI_MPLS_VPN
])

441 
	`bgp_maximum_¥efix_ovîÊow
 (
≥î
, 
afi
, 
SAFI_MPLS_VPN
, 1);

444 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rib
[
afi
][
SAFI_UNICAST
]);Ñn;

445 
∫
 = 
	`bgp_rouã_√xt
 (rn))

447 
bi
 = 
∫
->
öfo
; bi; bò
√xt
)

449 
√xt
 = 
bi
->next;

451 i‡(
bi
->
ty≥
 =
ZEBRA_ROUTE_BGP
 && bi->
sub_ty≥
 =
BGP_ROUTE_NORMAL
)

453 
ch™ged
 = 0;

454 
mëricch™ged
 = 0;

456 i‡(
bi
->
≥î
->
s‹t
 =
BGP_PEER_EBGP
 && bi->≥î->
âl
 == 1)

457 
vÆid
 = 
	`bgp_√xth›_⁄lök
 (
afi
, 
bi
->
©å
);

459 
vÆid
 = 
	`bgp_√xth›_lookup
 (
afi
, 
bi
->
≥î
, bi,

460 &
ch™ged
, &
mëricch™ged
);

462 
cuºít
 = 
	`CHECK_FLAG
 (
bi
->
Êags
, 
BGP_INFO_VALID
) ? 1 : 0;

464 i‡(
ch™ged
)

465 
	`SET_FLAG
 (
bi
->
Êags
, 
BGP_INFO_IGP_CHANGED
);

467 
	`UNSET_FLAG
 (
bi
->
Êags
, 
BGP_INFO_IGP_CHANGED
);

469 i‡(
vÆid
 !
cuºít
)

471 i‡(
	`CHECK_FLAG
 (
bi
->
Êags
, 
BGP_INFO_VALID
))

473 
	`bgp_aggªg©e_de¸emít
 (
bgp
, &
∫
->
p
, 
bi
,

474 
afi
, 
SAFI_UNICAST
);

475 
	`bgp_öfo_un£t_Êag
 (
∫
, 
bi
, 
BGP_INFO_VALID
);

479 
	`bgp_öfo_£t_Êag
 (
∫
, 
bi
, 
BGP_INFO_VALID
);

480 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, &
∫
->
p
, 
bi
,

481 
afi
, 
SAFI_UNICAST
);

485 i‡(
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
afi
][
SAFI_UNICAST
],

486 
BGP_CONFIG_DAMPENING
)

487 && 
bi
->
exåa
 && bi->exåa->
damp_öfo
 )

488 i‡(
	`bgp_damp_sˇn
 (
bi
, 
afi
, 
SAFI_UNICAST
))

489 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, &
∫
->
p
, 
bi
,

490 
afi
, 
SAFI_UNICAST
);

493 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
SAFI_UNICAST
);

497 i‡(
bgp_√xth›_ˇche_èbÀ
[
afi
] =
ˇche1_èbÀ
[afi])

498 
	`bgp_√xth›_ˇche_ª£t
 (
ˇche2_èbÀ
[
afi
]);

500 
	`bgp_√xth›_ˇche_ª£t
 (
ˇche1_èbÀ
[
afi
]);

502 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

504 i‡(
afi
 =
AFI_IP
)

505 
	`zlog_debug
 ("scanning IPv4 UnicastÑoutingÅables");

506 i‡(
afi
 =
AFI_IP6
)

507 
	`zlog_debug
 ("scanning IPv6 UnicastÑoutingÅables");

512 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

514 i‡(
≥î
->
°©us
 =
E°ablished


515 && 
	`CHECK_FLAG
(
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
)

516 && 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

517 
	`bgp_deÁu…_‹igö©e
 (
≥î
, 
afi
, 
ßfi
, 0);

519 
	}
}

523 
	$bgp_sˇn_timî
 (
thªad
 *
t
)

525 
bgp_sˇn_thªad
 =

526 
	`thªad_add_timî
 (
ma°î
, 
bgp_sˇn_timî
, 
NULL
, 
bgp_sˇn_öãrvÆ
);

528 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

529 
	`zlog_debug
 ("Performing BGP general scanning");

531 
	`bgp_sˇn
 (
AFI_IP
, 
SAFI_UNICAST
);

533 #ifde‡
HAVE_IPV6


534 
	`bgp_sˇn
 (
AFI_IP6
, 
SAFI_UNICAST
);

538 
	}
}

541 
	sbgp_addr


543 
ö_addr
 
	maddr
;

544 
	mªf˙t
;

547 
hash
 *
	gbgp_addªss_hash
;

550 
	$bgp_addªss_hash_Æloc
 (*
p
)

552 
ö_addr
 *
vÆ
 = 
p
;

553 
bgp_addr
 *
addr
;

555 
addr
 = 
	`XMALLOC
 (
MTYPE_BGP_ADDR
,  (
bgp_addr
));

556 
addr
->
ªf˙t
 = 0;

557 
addr
->addr.
s_addr
 = 
vÆ
->s_addr;

559  
addr
;

560 
	}
}

563 
	$bgp_addªss_hash_key_make
 (*
p
)

565 c⁄° 
bgp_addr
 *
addr
 = 
p
;

567  
	`jhash_1w‹d
(
addr
->addr.
s_addr
, 0);

568 
	}
}

571 
	$bgp_addªss_hash_cmp
 (c⁄° *
p1
, c⁄° *
p2
)

573 c⁄° 
bgp_addr
 *
addr1
 = 
p1
;

574 c⁄° 
bgp_addr
 *
addr2
 = 
p2
;

576  
addr1
->
addr
.
s_addr
 =
addr2
->addr.s_addr;

577 
	}
}

580 
	$bgp_addªss_öô
 ()

582 
bgp_addªss_hash
 = 
	`hash_¸óã
 (
bgp_addªss_hash_key_make
,

583 
bgp_addªss_hash_cmp
);

584 
	}
}

587 
	$bgp_addªss_add
 (
¥efix
 *
p
)

589 
bgp_addr
 
tmp
;

590 
bgp_addr
 *
addr
;

592 
tmp
.
addr
 = 
p
->
u
.
¥efix4
;

594 
addr
 = 
	`hash_gë
 (
bgp_addªss_hash
, &
tmp
, 
bgp_addªss_hash_Æloc
);

595 
addr
->
ªf˙t
++;

596 
	}
}

599 
	$bgp_addªss_dñ
 (
¥efix
 *
p
)

601 
bgp_addr
 
tmp
;

602 
bgp_addr
 *
addr
;

604 
tmp
.
addr
 = 
p
->
u
.
¥efix4
;

606 
addr
 = 
	`hash_lookup
 (
bgp_addªss_hash
, &
tmp
);

607 
addr
->
ªf˙t
--;

609 i‡(
addr
->
ªf˙t
 == 0)

611 
	`hash_ªÀa£
 (
bgp_addªss_hash
, 
addr
);

612 
	`XFREE
 (
MTYPE_BGP_ADDR
, 
addr
);

614 
	}
}

617 
	sbgp_c⁄√˘ed_ªf


619 
	mªf˙t
;

623 
	$bgp_c⁄√˘ed_add
 (
c⁄√˘ed
 *
ifc
)

625 
¥efix
 
p
;

626 
¥efix
 *
addr
;

627 
öãrÁ˚
 *
iÂ
;

628 
bgp_node
 *
∫
;

629 
bgp_c⁄√˘ed_ªf
 *
bc
;

631 
iÂ
 = 
ifc
->ifp;

633 i‡(! 
iÂ
)

636 i‡(
	`if_is_lo›back
 (
iÂ
))

639 
addr
 = 
ifc
->
addªss
;

641 i‡(
addr
->
Ámûy
 =
AF_INET
)

643 
	`PREFIX_COPY_IPV4
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

644 
	`≠∂y_mask_ùv4
 ((
¥efix_ùv4
 *Ë&
p
);

646 i‡(
	`¥efix_ùv4_™y
 ((
¥efix_ùv4
 *Ë&
p
))

649 
	`bgp_addªss_add
 (
addr
);

651 
∫
 = 
	`bgp_node_gë
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
], (
¥efix
 *Ë&
p
);

652 i‡(
∫
->
öfo
)

654 
bc
 = 
∫
->
öfo
;

655 
bc
->
ªf˙t
++;

659 
bc
 = 
	`XCALLOC
 (
MTYPE_BGP_CONN
,  (
bgp_c⁄√˘ed_ªf
));

660 
bc
->
ªf˙t
 = 1;

661 
∫
->
öfo
 = 
bc
;

664 #ifde‡
HAVE_IPV6


665 i‡(
addr
->
Ámûy
 =
AF_INET6
)

667 
	`PREFIX_COPY_IPV6
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

668 
	`≠∂y_mask_ùv6
 ((
¥efix_ùv6
 *Ë&
p
);

670 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
p
.
u
.
¥efix6
))

673 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
p
.
u
.
¥efix6
))

676 
∫
 = 
	`bgp_node_gë
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP6
], (
¥efix
 *Ë&
p
);

677 i‡(
∫
->
öfo
)

679 
bc
 = 
∫
->
öfo
;

680 
bc
->
ªf˙t
++;

684 
bc
 = 
	`XCALLOC
 (
MTYPE_BGP_CONN
,  (
bgp_c⁄√˘ed_ªf
));

685 
bc
->
ªf˙t
 = 1;

686 
∫
->
öfo
 = 
bc
;

690 
	}
}

693 
	$bgp_c⁄√˘ed_dñëe
 (
c⁄√˘ed
 *
ifc
)

695 
¥efix
 
p
;

696 
¥efix
 *
addr
;

697 
öãrÁ˚
 *
iÂ
;

698 
bgp_node
 *
∫
;

699 
bgp_c⁄√˘ed_ªf
 *
bc
;

701 
iÂ
 = 
ifc
->ifp;

703 i‡(
	`if_is_lo›back
 (
iÂ
))

706 
addr
 = 
ifc
->
addªss
;

708 i‡(
addr
->
Ámûy
 =
AF_INET
)

710 
	`PREFIX_COPY_IPV4
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

711 
	`≠∂y_mask_ùv4
 ((
¥efix_ùv4
 *Ë&
p
);

713 i‡(
	`¥efix_ùv4_™y
 ((
¥efix_ùv4
 *Ë&
p
))

716 
	`bgp_addªss_dñ
 (
addr
);

718 
∫
 = 
	`bgp_node_lookup
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
], &
p
);

719 i‡(! 
∫
)

722 
bc
 = 
∫
->
öfo
;

723 
bc
->
ªf˙t
--;

724 i‡(
bc
->
ªf˙t
 == 0)

726 
	`XFREE
 (
MTYPE_BGP_CONN
, 
bc
);

727 
∫
->
öfo
 = 
NULL
;

729 
	`bgp_u∆ock_node
 (
∫
);

730 
	`bgp_u∆ock_node
 (
∫
);

732 #ifde‡
HAVE_IPV6


733 i‡(
addr
->
Ámûy
 =
AF_INET6
)

735 
	`PREFIX_COPY_IPV6
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

736 
	`≠∂y_mask_ùv6
 ((
¥efix_ùv6
 *Ë&
p
);

738 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
p
.
u
.
¥efix6
))

741 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
p
.
u
.
¥efix6
))

744 
∫
 = 
	`bgp_node_lookup
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP6
], (
¥efix
 *Ë&
p
);

745 i‡(! 
∫
)

748 
bc
 = 
∫
->
öfo
;

749 
bc
->
ªf˙t
--;

750 i‡(
bc
->
ªf˙t
 == 0)

752 
	`XFREE
 (
MTYPE_BGP_CONN
, 
bc
);

753 
∫
->
öfo
 = 
NULL
;

755 
	`bgp_u∆ock_node
 (
∫
);

756 
	`bgp_u∆ock_node
 (
∫
);

759 
	}
}

762 
	$bgp_√xth›_£lf
 (
©å
 *attr)

764 
bgp_addr
 
tmp
, *
addr
;

766 
tmp
.
addr
 = 
©å
->
√xth›
;

768 
addr
 = 
	`hash_lookup
 (
bgp_addªss_hash
, &
tmp
);

769 i‡(
addr
)

773 
	}
}

775 
bgp_√xth›_ˇche
 *

776 
	$zlookup_ªad
 ()

778 
°ªam
 *
s
;

779 
uöt16_t
 
Àngth
;

780 
u_ch¨
 
m¨kî
;

781 
u_ch¨
 
vîsi⁄
;

782 
uöt16_t
 
comm™d
;

783 
nbyãs
;

784 
ö_addr
 
øddr
;

785 
uöt32_t
 
mëric
;

786 
i
;

787 
u_ch¨
 
√xth›_num
;

788 
√xth›
 *nexthop;

789 
bgp_√xth›_ˇche
 *
bnc
;

791 
s
 = 
zlookup
->
ibuf
;

792 
	`°ªam_ª£t
 (
s
);

794 
nbyãs
 = 
	`°ªam_ªad
 (
s
, 
zlookup
->
sock
, 2);

795 
Àngth
 = 
	`°ªam_gëw
 (
s
);

797 
nbyãs
 = 
	`°ªam_ªad
 (
s
, 
zlookup
->
sock
, 
Àngth
 - 2);

798 
m¨kî
 = 
	`°ªam_gëc
 (
s
);

799 
vîsi⁄
 = 
	`°ªam_gëc
 (
s
);

801 i‡(
vîsi⁄
 !
ZSERV_VERSION
 || 
m¨kî
 !
ZEBRA_HEADER_MARKER
)

803 
	`zlog_îr
("%s: socket %d version mismatch, marker %d, version %d",

804 
__func__
, 
zlookup
->
sock
, 
m¨kî
, 
vîsi⁄
);

805  
NULL
;

808 
comm™d
 = 
	`°ªam_gëw
 (
s
);

810 
øddr
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

811 
mëric
 = 
	`°ªam_gël
 (
s
);

812 
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

814 i‡(
√xth›_num
)

816 
bnc
 = 
	`bnc_√w
 ();

817 
bnc
->
vÆid
 = 1;

818 
bnc
->
mëric
 = metric;

819 
bnc
->
√xth›_num
 =Çexthop_num;

821 
i
 = 0; i < 
√xth›_num
; i++)

823 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

824 
√xth›
->
ty≥
 = 
	`°ªam_gëc
 (
s
);

825 
√xth›
->
ty≥
)

827 
ZEBRA_NEXTHOP_IPV4
:

828 
√xth›
->
g©e
.
ùv4
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

830 
ZEBRA_NEXTHOP_IFINDEX
:

831 
ZEBRA_NEXTHOP_IFNAME
:

832 
√xth›
->
ifödex
 = 
	`°ªam_gël
 (
s
);

838 
	`bnc_√xth›_add
 (
bnc
, 
√xth›
);

842  
NULL
;

844  
bnc
;

845 
	}
}

847 
bgp_√xth›_ˇche
 *

848 
	$zlookup_quîy
 (
ö_addr
 
addr
)

850 
ªt
;

851 
°ªam
 *
s
;

854 i‡(
zlookup
->
sock
 < 0)

855  
NULL
;

857 
s
 = 
zlookup
->
obuf
;

858 
	`°ªam_ª£t
 (
s
);

859 
	`z˛õ¡_¸óã_hódî
 (
s
, 
ZEBRA_IPV4_NEXTHOP_LOOKUP
);

860 
	`°ªam_put_ö_addr
 (
s
, &
addr
);

862 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

864 
ªt
 = 
	`wrôí
 (
zlookup
->
sock
, 
s
->
d©a
, 
	`°ªam_gë_ídp
 (s));

865 i‡(
ªt
 < 0)

867 
	`zlog_îr
 ("can't writeÅo zlookup->sock");

868 
	`˛o£
 (
zlookup
->
sock
);

869 
zlookup
->
sock
 = -1;

870  
NULL
;

872 i‡(
ªt
 == 0)

874 
	`zlog_îr
 ("zlookup->sock connection closed");

875 
	`˛o£
 (
zlookup
->
sock
);

876 
zlookup
->
sock
 = -1;

877  
NULL
;

880  
	`zlookup_ªad
 ();

881 
	}
}

883 #ifde‡
HAVE_IPV6


884 
bgp_√xth›_ˇche
 *

885 
	$zlookup_ªad_ùv6
 ()

887 
°ªam
 *
s
;

888 
uöt16_t
 
Àngth
;

889 
u_ch¨
 
vîsi⁄
, 
m¨kî
;

890 
uöt16_t
 
comm™d
;

891 
nbyãs
;

892 
ö6_addr
 
øddr
;

893 
uöt32_t
 
mëric
;

894 
i
;

895 
u_ch¨
 
√xth›_num
;

896 
√xth›
 *nexthop;

897 
bgp_√xth›_ˇche
 *
bnc
;

899 
s
 = 
zlookup
->
ibuf
;

900 
	`°ªam_ª£t
 (
s
);

902 
nbyãs
 = 
	`°ªam_ªad
 (
s
, 
zlookup
->
sock
, 2);

903 
Àngth
 = 
	`°ªam_gëw
 (
s
);

905 
nbyãs
 = 
	`°ªam_ªad
 (
s
, 
zlookup
->
sock
, 
Àngth
 - 2);

906 
m¨kî
 = 
	`°ªam_gëc
 (
s
);

907 
vîsi⁄
 = 
	`°ªam_gëc
 (
s
);

909 i‡(
vîsi⁄
 !
ZSERV_VERSION
 || 
m¨kî
 !
ZEBRA_HEADER_MARKER
)

911 
	`zlog_îr
("%s: socket %d version mismatch, marker %d, version %d",

912 
__func__
, 
zlookup
->
sock
, 
m¨kî
, 
vîsi⁄
);

913  
NULL
;

916 
comm™d
 = 
	`°ªam_gëw
 (
s
);

918 
	`°ªam_gë
 (&
øddr
, 
s
, 16);

920 
mëric
 = 
	`°ªam_gël
 (
s
);

921 
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

923 i‡(
√xth›_num
)

925 
bnc
 = 
	`bnc_√w
 ();

926 
bnc
->
vÆid
 = 1;

927 
bnc
->
mëric
 = metric;

928 
bnc
->
√xth›_num
 =Çexthop_num;

930 
i
 = 0; i < 
√xth›_num
; i++)

932 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

933 
√xth›
->
ty≥
 = 
	`°ªam_gëc
 (
s
);

934 
√xth›
->
ty≥
)

936 
ZEBRA_NEXTHOP_IPV6
:

937 
	`°ªam_gë
 (&
√xth›
->
g©e
.
ùv6
, 
s
, 16);

939 
ZEBRA_NEXTHOP_IPV6_IFINDEX
:

940 
ZEBRA_NEXTHOP_IPV6_IFNAME
:

941 
	`°ªam_gë
 (&
√xth›
->
g©e
.
ùv6
, 
s
, 16);

942 
√xth›
->
ifödex
 = 
	`°ªam_gël
 (
s
);

944 
ZEBRA_NEXTHOP_IFINDEX
:

945 
ZEBRA_NEXTHOP_IFNAME
:

946 
√xth›
->
ifödex
 = 
	`°ªam_gël
 (
s
);

952 
	`bnc_√xth›_add
 (
bnc
, 
√xth›
);

956  
NULL
;

958  
bnc
;

959 
	}
}

961 
bgp_√xth›_ˇche
 *

962 
	$zlookup_quîy_ùv6
 (
ö6_addr
 *
addr
)

964 
ªt
;

965 
°ªam
 *
s
;

968 i‡(
zlookup
->
sock
 < 0)

969  
NULL
;

971 
s
 = 
zlookup
->
obuf
;

972 
	`°ªam_ª£t
 (
s
);

973 
	`z˛õ¡_¸óã_hódî
 (
s
, 
ZEBRA_IPV6_NEXTHOP_LOOKUP
);

974 
	`°ªam_put
 (
s
, 
addr
, 16);

975 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

977 
ªt
 = 
	`wrôí
 (
zlookup
->
sock
, 
s
->
d©a
, 
	`°ªam_gë_ídp
 (s));

978 i‡(
ªt
 < 0)

980 
	`zlog_îr
 ("can't writeÅo zlookup->sock");

981 
	`˛o£
 (
zlookup
->
sock
);

982 
zlookup
->
sock
 = -1;

983  
NULL
;

985 i‡(
ªt
 == 0)

987 
	`zlog_îr
 ("zlookup->sock connection closed");

988 
	`˛o£
 (
zlookup
->
sock
);

989 
zlookup
->
sock
 = -1;

990  
NULL
;

993  
	`zlookup_ªad_ùv6
 ();

994 
	}
}

998 
	$bgp_imp‹t_check
 (
¥efix
 *
p
, 
u_öt32_t
 *
igpmëric
,

999 
ö_addr
 *
ig≤exth›
)

1001 
°ªam
 *
s
;

1002 
ªt
;

1003 
u_öt16_t
 
Àngth
, 
comm™d
;

1004 
u_ch¨
 
vîsi⁄
, 
m¨kî
;

1005 
nbyãs
;

1006 
ö_addr
 
addr
;

1007 
ö_addr
 
√xth›
;

1008 
u_öt32_t
 
mëric
 = 0;

1009 
u_ch¨
 
√xth›_num
;

1010 
u_ch¨
 
√xth›_ty≥
;

1013 i‡(
zlookup
->
sock
 < 0)

1015 i‡(
igpmëric
)

1016 *
igpmëric
 = 0;

1021 
s
 = 
zlookup
->
obuf
;

1022 
	`°ªam_ª£t
 (
s
);

1023 
	`z˛õ¡_¸óã_hódî
 (
s
, 
ZEBRA_IPV4_IMPORT_LOOKUP
);

1025 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
);

1026 
	`°ªam_put_ö_addr
 (
s
, &
p
->
u
.
¥efix4
);

1028 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

1031 
ªt
 = 
	`wrôí
 (
zlookup
->
sock
, 
s
->
d©a
, 
	`°ªam_gë_ídp
 (s));

1033 i‡(
ªt
 < 0)

1035 
	`zlog_îr
 ("can't writeÅo zlookup->sock");

1036 
	`˛o£
 (
zlookup
->
sock
);

1037 
zlookup
->
sock
 = -1;

1040 i‡(
ªt
 == 0)

1042 
	`zlog_îr
 ("zlookup->sock connection closed");

1043 
	`˛o£
 (
zlookup
->
sock
);

1044 
zlookup
->
sock
 = -1;

1049 
	`°ªam_ª£t
 (
s
);

1052 
nbyãs
 = 
	`°ªam_ªad
 (
s
, 
zlookup
->
sock
, 2);

1053 
Àngth
 = 
	`°ªam_gëw
 (
s
);

1056 
nbyãs
 = 
	`°ªam_ªad
 (
s
, 
zlookup
->
sock
, 
Àngth
 - 2);

1057 
m¨kî
 = 
	`°ªam_gëc
 (
s
);

1058 
vîsi⁄
 = 
	`°ªam_gëc
 (
s
);

1060 i‡(
vîsi⁄
 !
ZSERV_VERSION
 || 
m¨kî
 !
ZEBRA_HEADER_MARKER
)

1062 
	`zlog_îr
("%s: socket %d version mismatch, marker %d, version %d",

1063 
__func__
, 
zlookup
->
sock
, 
m¨kî
, 
vîsi⁄
);

1067 
comm™d
 = 
	`°ªam_gëw
 (
s
);

1069 
addr
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

1070 
mëric
 = 
	`°ªam_gël
 (
s
);

1071 
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

1074 i‡(
igpmëric
)

1075 *
igpmëric
 = 
mëric
;

1078 i‡(
√xth›_num
)

1080 
√xth›
.
s_addr
 = 0;

1081 
√xth›_ty≥
 = 
	`°ªam_gëc
 (
s
);

1082 i‡(
√xth›_ty≥
 =
ZEBRA_NEXTHOP_IPV4
)

1084 
√xth›
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

1085 i‡(
ig≤exth›
)

1086 *
ig≤exth›
 = 
√xth›
;

1089 *
ig≤exth›
 = 
√xth›
;

1095 
	}
}

1100 
	$bgp_imp‹t
 (
thªad
 *
t
)

1102 
bgp
 *bgp;

1103 
bgp_node
 *
∫
;

1104 
bgp_°©ic
 *bgp_static;

1105 
li°node
 *
node
, *
¬ode
;

1106 
vÆid
;

1107 
u_öt32_t
 
mëric
;

1108 
ö_addr
 
√xth›
;

1109 
afi_t
 
afi
;

1110 
ßfi_t
 
ßfi
;

1112 
bgp_imp‹t_thªad
 =

1113 
	`thªad_add_timî
 (
ma°î
, 
bgp_imp‹t
, 
NULL
, 
bgp_imp‹t_öãrvÆ
);

1115 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

1116 
	`zlog_debug
 ("ImportÅimerÉxpired.");

1118 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

1120 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

1121 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MPLS_VPN
; safi++)

1122 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rouã
[
afi
][
ßfi
]);Ñn;

1123 
∫
 = 
	`bgp_rouã_√xt
 (rn))

1124 i‡((
bgp_°©ic
 = 
∫
->
öfo
Ë!
NULL
)

1126 i‡(
bgp_°©ic
->
backdo‹
)

1129 
vÆid
 = 
bgp_°©ic
->valid;

1130 
mëric
 = 
bgp_°©ic
->
igpmëric
;

1131 
√xth›
 = 
bgp_°©ic
->
ig≤exth›
;

1133 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_IMPORT_CHECK
)

1134 && 
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

1135 
bgp_°©ic
->
vÆid
 = 
	`bgp_imp‹t_check
 (&
∫
->
p
, &bgp_°©ic->
igpmëric
,

1136 &
bgp_°©ic
->
ig≤exth›
);

1139 
bgp_°©ic
->
vÆid
 = 1;

1140 
bgp_°©ic
->
igpmëric
 = 0;

1141 
bgp_°©ic
->
ig≤exth›
.
s_addr
 = 0;

1144 i‡(
bgp_°©ic
->
vÆid
 != valid)

1146 i‡(
bgp_°©ic
->
vÆid
)

1147 
	`bgp_°©ic_upd©e
 (
bgp
, &
∫
->
p
, 
bgp_°©ic
, 
afi
, 
ßfi
);

1149 
	`bgp_°©ic_wôhdøw
 (
bgp
, &
∫
->
p
, 
afi
, 
ßfi
);

1151 i‡(
bgp_°©ic
->
vÆid
)

1153 i‡(
bgp_°©ic
->
igpmëric
 !
mëric


1154 || 
bgp_°©ic
->
ig≤exth›
.
s_addr
 !
√xth›
.s_addr

1155 || 
bgp_°©ic
->
rm≠
.
«me
)

1156 
	`bgp_°©ic_upd©e
 (
bgp
, &
∫
->
p
, 
bgp_°©ic
, 
afi
, 
ßfi
);

1161 
	}
}

1165 
	$zlookup_c⁄√˘
 (
thªad
 *
t
)

1167 
z˛õ¡
 *
zlookup
;

1169 
zlookup
 = 
	`THREAD_ARG
 (
t
);

1170 
zlookup
->
t_c⁄√˘
 = 
NULL
;

1172 i‡(
zlookup
->
sock
 != -1)

1175 i‡(
	`z˛õ¡_sockë_c⁄√˘
 (
zlookup
) < 0)

1179 
	}
}

1184 
	$bgp_mu…üc˚ss_check_v4
 (
ö_addr
 
√xth›
, *
≥î
)

1186 
bgp_node
 *
∫1
;

1187 
bgp_node
 *
∫2
;

1188 
¥efix
 
p1
;

1189 
¥efix
 
p2
;

1190 
ö_addr
 
addr
;

1191 
ªt
;

1193 
ªt
 = 
	`öë_©⁄
 (
≥î
, &
addr
);

1194 i‡(! 
ªt
)

1197 
	`mem£t
 (&
p1
, 0,  (
¥efix
));

1198 
p1
.
Ámûy
 = 
AF_INET
;

1199 
p1
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

1200 
p1
.
u
.
¥efix4
 = 
√xth›
;

1201 
	`mem£t
 (&
p2
, 0,  (
¥efix
));

1202 
p2
.
Ámûy
 = 
AF_INET
;

1203 
p2
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

1204 
p2
.
u
.
¥efix4
 = 
addr
;

1207 i‡(
zlookup
->
sock
 < 0)

1210 
∫1
 = 
	`bgp_node_m©ch
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
], &
p1
);

1211 i‡(! 
∫1
)

1213 
	`bgp_u∆ock_node
 (
∫1
);

1215 
∫2
 = 
	`bgp_node_m©ch
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
], &
p2
);

1216 i‡(! 
∫2
)

1218 
	`bgp_u∆ock_node
 (
∫2
);

1222 i‡(
∫1
 =
∫2
)

1226 
	}
}

1228 
DEFUN
 (
bgp_sˇn_time
,

1229 
bgp_sˇn_time_cmd
,

1235 
	gbgp_sˇn_öãrvÆ
 = 
©oi
 (
¨gv
[0]);

1237 i‡(
	gbgp_sˇn_thªad
)

1239 
thªad_ˇn˚l
 (
bgp_sˇn_thªad
);

1240 
	gbgp_sˇn_thªad
 =

1241 
thªad_add_timî
 (
ma°î
, 
bgp_sˇn_timî
, 
NULL
, 
bgp_sˇn_öãrvÆ
);

1244  
	gCMD_SUCCESS
;

1247 
DEFUN
 (
no_bgp_sˇn_time
,

1248 
no_bgp_sˇn_time_cmd
,

1250 
NO_STR


1254 
	gbgp_sˇn_öãrvÆ
 = 
BGP_SCAN_INTERVAL_DEFAULT
;

1256 i‡(
	gbgp_sˇn_thªad
)

1258 
thªad_ˇn˚l
 (
bgp_sˇn_thªad
);

1259 
	gbgp_sˇn_thªad
 =

1260 
thªad_add_timî
 (
ma°î
, 
bgp_sˇn_timî
, 
NULL
, 
bgp_sˇn_öãrvÆ
);

1263  
	gCMD_SUCCESS
;

1266 
ALIAS
 (
no_bgp_sˇn_time
,

1267 
no_bgp_sˇn_time_vÆ_cmd
,

1269 
NO_STR


1275 
	$show_ù_bgp_sˇn_èbÀs
 (
vty
 *vty, c⁄° 
dëaû
)

1277 
bgp_node
 *
∫
;

1278 
bgp_√xth›_ˇche
 *
bnc
;

1279 
buf
[
INET6_ADDRSTRLEN
];

1280 
u_ch¨
 
i
;

1282 i‡(
bgp_sˇn_thªad
)

1283 
	`vty_out
 (
vty
, "BGP sˇ¿i†ru¬ög%s", 
VTY_NEWLINE
);

1285 
	`vty_out
 (
vty
, "BGP sˇ¿i†nŸÑu¬ög%s", 
VTY_NEWLINE
);

1286 
	`vty_out
 (
vty
, "BGP sˇ¿öãrvÆ i†%d%s", 
bgp_sˇn_öãrvÆ
, 
VTY_NEWLINE
);

1288 
	`vty_out
 (
vty
, "CuºíàBGPÇexth› cache:%s", 
VTY_NEWLINE
);

1289 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp_√xth›_ˇche_èbÀ
[
AFI_IP
]);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

1290 i‡((
bnc
 = 
∫
->
öfo
Ë!
NULL
)

1292 i‡(
bnc
->
vÆid
)

1294 
	`vty_out
 (
vty
, " %s valid [IGP metric %d]%s",

1295 
	`öë_¡›
 (
AF_INET
, &
∫
->
p
.
u
.
¥efix4
, 
buf
, 
INET6_ADDRSTRLEN
), 
bnc
->
mëric
, 
VTY_NEWLINE
);

1296 i‡(
dëaû
)

1297 
i
 = 0; i < 
bnc
->
√xth›_num
; i++)

1298 
bnc
->
√xth›
[
i
].
ty≥
)

1300 
NEXTHOP_TYPE_IPV4
:

1301 
	`vty_out
 (
vty
, " g©ê%s%s", 
	`öë_¡›
 (
AF_INET
, &
bnc
->
√xth›
[
i
].
g©e
.
ùv4
, 
buf
, 
INET6_ADDRSTRLEN
), 
VTY_NEWLINE
);

1303 
NEXTHOP_TYPE_IFINDEX
:

1304 
	`vty_out
 (
vty
, " ifidx %u%s", 
bnc
->
√xth›
[
i
].
ifödex
, 
VTY_NEWLINE
);

1307 
	`vty_out
 (
vty
, " invÆidÇexth›Åy≥ %u%s", 
bnc
->
√xth›
[
i
].
ty≥
, 
VTY_NEWLINE
);

1311 
	`vty_out
 (
vty
, " %s invalid%s",

1312 
	`öë_¡›
 (
AF_INET
, &
∫
->
p
.
u
.
¥efix4
, 
buf
, 
INET6_ADDRSTRLEN
), 
VTY_NEWLINE
);

1315 #ifde‡
HAVE_IPV6


1317 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp_√xth›_ˇche_èbÀ
[
AFI_IP6
]);

1318 
∫
;

1319 
∫
 = 
	`bgp_rouã_√xt
 (rn))

1320 i‡((
bnc
 = 
∫
->
öfo
Ë!
NULL
)

1322 i‡(
bnc
->
vÆid
)

1324 
	`vty_out
 (
vty
, " %s valid [IGP metric %d]%s",

1325 
	`öë_¡›
 (
AF_INET6
, &
∫
->
p
.
u
.
¥efix6
, 
buf
, 
INET6_ADDRSTRLEN
),

1326 
bnc
->
mëric
, 
VTY_NEWLINE
);

1327 i‡(
dëaû
)

1328 
i
 = 0; i < 
bnc
->
√xth›_num
; i++)

1329 
bnc
->
√xth›
[
i
].
ty≥
)

1331 
NEXTHOP_TYPE_IPV6
:

1332 
	`vty_out
 (
vty
, " g©ê%s%s", 
	`öë_¡›
 (
AF_INET6
, &
bnc
->
√xth›
[
i
].
g©e
.
ùv6
, 
buf
, 
INET6_ADDRSTRLEN
), 
VTY_NEWLINE
);

1334 
NEXTHOP_TYPE_IFINDEX
:

1335 
	`vty_out
 (
vty
, " ifidx %u%s", 
bnc
->
√xth›
[
i
].
ifödex
, 
VTY_NEWLINE
);

1338 
	`vty_out
 (
vty
, " invÆidÇexth›Åy≥ %u%s", 
bnc
->
√xth›
[
i
].
ty≥
, 
VTY_NEWLINE
);

1342 
	`vty_out
 (
vty
, " %s invalid%s",

1343 
	`öë_¡›
 (
AF_INET6
, &
∫
->
p
.
u
.
¥efix6
, 
buf
, 
INET6_ADDRSTRLEN
),

1344 
VTY_NEWLINE
);

1349 
	`vty_out
 (
vty
, "BGP c⁄√˘edÑouã:%s", 
VTY_NEWLINE
);

1350 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
]);

1351 
∫
;

1352 
∫
 = 
	`bgp_rouã_√xt
 (rn))

1353 i‡(
∫
->
öfo
 !
NULL
)

1354 
	`vty_out
 (
vty
, " %s/%d%s", 
	`öë_¡ﬂ
 (
∫
->
p
.
u
.
¥efix4
),Ñn->p.
¥efixÀn
,

1355 
VTY_NEWLINE
);

1357 #ifde‡
HAVE_IPV6


1359 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP6
]);

1360 
∫
;

1361 
∫
 = 
	`bgp_rouã_√xt
 (rn))

1362 i‡(
∫
->
öfo
 !
NULL
)

1363 
	`vty_out
 (
vty
, " %s/%d%s",

1364 
	`öë_¡›
 (
AF_INET6
, &
∫
->
p
.
u
.
¥efix6
, 
buf
, 
INET6_ADDRSTRLEN
),

1365 
∫
->
p
.
¥efixÀn
,

1366 
VTY_NEWLINE
);

1370  
CMD_SUCCESS
;

1371 
	}
}

1373 
DEFUN
 (
show_ù_bgp_sˇn
,

1374 
show_ù_bgp_sˇn_cmd
,

1376 
SHOW_STR


1377 
IP_STR


1378 
BGP_STR


1381  
show_ù_bgp_sˇn_èbÀs
 (
vty
, 0);

1384 
DEFUN
 (
show_ù_bgp_sˇn_dëaû
,

1385 
show_ù_bgp_sˇn_dëaû_cmd
,

1387 
SHOW_STR


1388 
IP_STR


1389 
BGP_STR


1393  
show_ù_bgp_sˇn_èbÀs
 (
vty
, 1);

1397 
	$bgp_c⁄fig_wrôe_sˇn_time
 (
vty
 *vty)

1399 i‡(
bgp_sˇn_öãrvÆ
 !
BGP_SCAN_INTERVAL_DEFAULT
)

1400 
	`vty_out
 (
vty
, " bg∞sˇn-timê%d%s", 
bgp_sˇn_öãrvÆ
, 
VTY_NEWLINE
);

1401  
CMD_SUCCESS
;

1402 
	}
}

1405 
	$bgp_sˇn_öô
 ()

1407 
zlookup
 = 
	`z˛õ¡_√w
 ();

1408 
zlookup
->
sock
 = -1;

1409 
zlookup
->
t_c⁄√˘
 = 
	`thªad_add_evít
 (
ma°î
, 
zlookup_c⁄√˘
, zlookup, 0);

1411 
bgp_sˇn_öãrvÆ
 = 
BGP_SCAN_INTERVAL_DEFAULT
;

1412 
bgp_imp‹t_öãrvÆ
 = 
BGP_IMPORT_INTERVAL_DEFAULT
;

1414 
ˇche1_èbÀ
[
AFI_IP
] = 
	`bgp_èbÀ_öô
 (AFI_IP, 
SAFI_UNICAST
);

1415 
ˇche2_èbÀ
[
AFI_IP
] = 
	`bgp_èbÀ_öô
 (AFI_IP, 
SAFI_UNICAST
);

1416 
bgp_√xth›_ˇche_èbÀ
[
AFI_IP
] = 
ˇche1_èbÀ
[AFI_IP];

1418 
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
] = 
	`bgp_èbÀ_öô
 (AFI_IP, 
SAFI_UNICAST
);

1420 #ifde‡
HAVE_IPV6


1421 
ˇche1_èbÀ
[
AFI_IP6
] = 
	`bgp_èbÀ_öô
 (AFI_IP6, 
SAFI_UNICAST
);

1422 
ˇche2_èbÀ
[
AFI_IP6
] = 
	`bgp_èbÀ_öô
 (AFI_IP6, 
SAFI_UNICAST
);

1423 
bgp_√xth›_ˇche_èbÀ
[
AFI_IP6
] = 
ˇche1_èbÀ
[AFI_IP6];

1424 
bgp_c⁄√˘ed_èbÀ
[
AFI_IP6
] = 
	`bgp_èbÀ_öô
 (AFI_IP6, 
SAFI_UNICAST
);

1428 
bgp_sˇn_thªad
 = 
	`thªad_add_timî
 (
ma°î
, 
bgp_sˇn_timî
,

1429 
NULL
, 
bgp_sˇn_öãrvÆ
);

1431 
bgp_imp‹t_thªad
 = 
	`thªad_add_timî
 (
ma°î
, 
bgp_imp‹t
, 
NULL
, 0);

1433 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_sˇn_time_cmd
);

1434 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_sˇn_time_cmd
);

1435 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_sˇn_time_vÆ_cmd
);

1436 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_sˇn_cmd
);

1437 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_sˇn_dëaû_cmd
);

1438 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_sˇn_cmd
);

1439 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_sˇn_cmd
);

1440 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_sˇn_dëaû_cmd
);

1441 
	}
}

1444 
	$bgp_sˇn_föish
 ()

1447 
	`bgp_√xth›_ˇche_ª£t
 (
bgp_√xth›_ˇche_èbÀ
[
AFI_IP
]);

1449 
	`bgp_èbÀ_u∆ock
 (
ˇche1_èbÀ
[
AFI_IP
]);

1450 
ˇche1_èbÀ
[
AFI_IP
] = 
NULL
;

1452 
	`bgp_èbÀ_u∆ock
 (
ˇche2_èbÀ
[
AFI_IP
]);

1453 
ˇche2_èbÀ
[
AFI_IP
] = 
NULL
;

1455 
	`bgp_èbÀ_u∆ock
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
]);

1456 
bgp_c⁄√˘ed_èbÀ
[
AFI_IP
] = 
NULL
;

1458 #ifde‡
HAVE_IPV6


1460 
	`bgp_√xth›_ˇche_ª£t
 (
bgp_√xth›_ˇche_èbÀ
[
AFI_IP6
]);

1462 
	`bgp_èbÀ_u∆ock
 (
ˇche1_èbÀ
[
AFI_IP6
]);

1463 
ˇche1_èbÀ
[
AFI_IP6
] = 
NULL
;

1465 
	`bgp_èbÀ_u∆ock
 (
ˇche2_èbÀ
[
AFI_IP6
]);

1466 
ˇche2_èbÀ
[
AFI_IP6
] = 
NULL
;

1468 
	`bgp_èbÀ_u∆ock
 (
bgp_c⁄√˘ed_èbÀ
[
AFI_IP6
]);

1469 
bgp_c⁄√˘ed_èbÀ
[
AFI_IP6
] = 
NULL
;

1471 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_nexthop.h

21 #i‚de‡
_QUAGGA_BGP_NEXTHOP_H


22 
	#_QUAGGA_BGP_NEXTHOP_H


	)

24 
	~"if.h
"

26 
	#BGP_SCAN_INTERVAL_DEFAULT
 60

	)

27 
	#BGP_IMPORT_INTERVAL_DEFAULT
 15

	)

30 
	sbgp_√xth›_ˇche


33 
u_ch¨
 
	mvÆid
;

36 
u_ch¨
 
	mch™ged
;

39 
u_ch¨
 
	mmëricch™ged
;

42 
u_öt32_t
 
	mmëric
;

45 
u_ch¨
 
	m√xth›_num
;

46 
√xth›
 *
	m√xth›
;

49 
bgp_sˇn_öô
 ();

50 
bgp_sˇn_föish
 ();

51 
bgp_√xth›_lookup
 (
afi_t
, 
≥î
 *≥î, 
bgp_öfo
 *,

53 
bgp_c⁄√˘ed_add
 (
c⁄√˘ed
 *
c
);

54 
bgp_c⁄√˘ed_dñëe
 (
c⁄√˘ed
 *
c
);

55 
bgp_mu…üc˚ss_check_v4
 (
ö_addr
, *);

56 
bgp_c⁄fig_wrôe_sˇn_time
 (
vty
 *);

57 
bgp_√xth›_⁄lök
 (
afi_t
, 
©å
 *);

58 
bgp_√xth›_£lf
 (
©å
 *);

59 
bgp_addªss_öô
 ();

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_open.c

21 
	~<zebø.h
>

23 
	~"lökli°.h
"

24 
	~"¥efix.h
"

25 
	~"°ªam.h
"

26 
	~"thªad.h
"

27 
	~"log.h
"

28 
	~"comm™d.h
"

29 
	~"mem‹y.h
"

31 
	~"bgpd/bgpd.h
"

32 
	~"bgpd/bgp_©å.h
"

33 
	~"bgpd/bgp_debug.h
"

34 
	~"bgpd/bgp_fsm.h
"

35 
	~"bgpd/bgp_∑ckë.h
"

36 
	~"bgpd/bgp_›í.h
"

37 
	~"bgpd/bgp_a•©h.h
"

38 
	~"bgpd/bgp_vty.h
"

51 
	$bgp_ˇ∑bûôy_vty_out
 (
vty
 *vty, 
≥î
 *peer)

53 *
≤t
;

54 *
íd
;

55 
ˇ∑bûôy_mp_d©a
 
mpc
;

56 
ˇ∑bûôy_hódî
 *
hdr
;

58 
≤t
 = 
≥î
->
nŸify
.
d©a
;

59 
íd
 = 
≤t
 + 
≥î
->
nŸify
.
Àngth
;

61 
≤t
 < 
íd
)

63 i‡(
≤t
 +  (
ˇ∑bûôy_mp_d©a
Ë+ 2 > 
íd
)

66 
hdr
 = (
ˇ∑bûôy_hódî
 *)
≤t
;

67 i‡(
≤t
 + 
hdr
->
Àngth
 + 2 > 
íd
)

70 
	`mem˝y
 (&
mpc
, 
≤t
 + 2, (
ˇ∑bûôy_mp_d©a
));

72 i‡(
hdr
->
code
 =
CAPABILITY_CODE_MP
)

74 
	`vty_out
 (
vty
, " CapabilityÉrror for: MultiÖrotocol ");

76 
	`¡ohs
 (
mpc
.
afi
))

78 
AFI_IP
:

79 
	`vty_out
 (
vty
, "AFI IPv4, ");

81 
AFI_IP6
:

82 
	`vty_out
 (
vty
, "AFI IPv6, ");

85 
	`vty_out
 (
vty
, "AFI Unknow¿%d, ", 
	`¡ohs
 (
mpc
.
afi
));

88 
mpc
.
ßfi
)

90 
SAFI_UNICAST
:

91 
	`vty_out
 (
vty
, "SAFI Unicast");

93 
SAFI_MULTICAST
:

94 
	`vty_out
 (
vty
, "SAFI Multicast");

96 
SAFI_MPLS_LABELED_VPN
:

97 
	`vty_out
 (
vty
, "SAFI MPLS-labeled VPN");

100 
	`vty_out
 (
vty
, "SAFI Unknow¿%d ", 
mpc
.
ßfi
);

103 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

105 i‡(
hdr
->
code
 >= 128)

106 
	`vty_out
 (
vty
, " CapabilityÉrror: vendor specific capability code %d",

107 
hdr
->
code
);

109 
	`vty_out
 (
vty
, " CapabilityÉrror: unknown capability code %d",

110 
hdr
->
code
);

112 
≤t
 +
hdr
->
Àngth
 + 2;

114 
	}
}

117 
	$bgp_ˇ∑bûôy_mp_d©a
 (
°ªam
 *
s
, 
ˇ∑bûôy_mp_d©a
 *
mpc
)

119 
mpc
->
afi
 = 
	`°ªam_gëw
 (
s
);

120 
mpc
->
ª£rved
 = 
	`°ªam_gëc
 (
s
);

121 
mpc
->
ßfi
 = 
	`°ªam_gëc
 (
s
);

122 
	}
}

125 
	$bgp_afi_ßfi_vÆid_ödi˚s
 (
afi_t
 
afi
, 
ßfi_t
 *
ßfi
)

127 
afi
)

129 
AFI_IP
:

130 #ifde‡
HAVE_IPV6


131 
AFI_IP6
:

133 *
ßfi
)

136 
SAFI_MPLS_LABELED_VPN
:

137 *
ßfi
 = 
SAFI_MPLS_VPN
;

138 
SAFI_UNICAST
:

139 
SAFI_MULTICAST
:

140 
SAFI_MPLS_VPN
:

144 
	`zlog_debug
 ("unknow¿afi/ßfò(%u/%u)", 
afi
, *
ßfi
);

147 
	}
}

151 
	$bgp_ˇ∑bûôy_mp
 (
≥î
 *≥î, 
ˇ∑bûôy_hódî
 *
hdr
)

153 
ˇ∑bûôy_mp_d©a
 
mpc
;

154 
°ªam
 *
s
 = 
	`BGP_INPUT
 (
≥î
);

156 
	`bgp_ˇ∑bûôy_mp_d©a
 (
s
, &
mpc
);

158 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

159 
	`zlog_debug
 ("%s OPEN has MP_EXT CAP foráfi/safi: %u/%u",

160 
≥î
->
ho°
, 
mpc
.
afi
, mpc.
ßfi
);

162 i‡(!
	`bgp_afi_ßfi_vÆid_ödi˚s
 (
mpc
.
afi
, &mpc.
ßfi
))

166 
≥î
->
afc_ªcv
[
mpc
.
afi
][mpc.
ßfi
] = 1;

168 i‡(
≥î
->
afc
[
mpc
.
afi
][mpc.
ßfi
])

169 
≥î
->
afc_√go
[
mpc
.
afi
][mpc.
ßfi
] = 1;

174 
	}
}

177 
	$bgp_ˇ∑bûôy_‹f_nŸ_suµ‹t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

178 
u_ch¨
 
ty≥
, u_ch¨ 
mode
)

180 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

181 
	`zlog_debug
 ("%s Addr-family %d/%d has ORFÅype/mode %d/%dÇot supported",

182 
≥î
->
ho°
, 
afi
, 
ßfi
, 
ty≥
, 
mode
);

183 
	}
}

185 c⁄° 
mesßge
 
	g‹f_ty≥_°r
[] =

187 { 
ORF_TYPE_PREFIX
, "Prefixlist" },

188 { 
ORF_TYPE_PREFIX_OLD
, "Prefixlist (old)" },

190 c⁄° 
	g‹f_ty≥_°r_max
 = 
¨øy_size
(
‹f_ty≥_°r
);

192 c⁄° 
mesßge
 
	g‹f_mode_°r
[] =

194 { 
ORF_MODE_RECEIVE
, "Receive" },

195 { 
ORF_MODE_SEND
, "Send" },

196 { 
ORF_MODE_BOTH
, "Both" },

198 c⁄° 
	g‹f_mode_°r_max
 = 
¨øy_size
(
‹f_mode_°r
);

201 
	$bgp_ˇ∑bûôy_‹f_íåy
 (
≥î
 *≥î, 
ˇ∑bûôy_hódî
 *
hdr
)

203 
°ªam
 *
s
 = 
	`BGP_INPUT
 (
≥î
);

204 
ˇ∑bûôy_‹f_íåy
 
íåy
;

205 
afi_t
 
afi
;

206 
ßfi_t
 
ßfi
;

207 
u_ch¨
 
ty≥
;

208 
u_ch¨
 
mode
;

209 
u_öt16_t
 
sm_ˇp
 = 0;

210 
u_öt16_t
 
rm_ˇp
 = 0;

211 
i
;

214 
	`bgp_ˇ∑bûôy_mp_d©a
 (
s
, &
íåy
.
mpc
);

215 
íåy
.
num
 = 
	`°ªam_gëc
 (
s
);

216 
afi
 = 
íåy
.
mpc
.afi;

217 
ßfi
 = 
íåy
.
mpc
.safi;

219 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

220 
	`zlog_debug
 ("%s ORF CapÉntry foráfi/safi: %u/%u",

221 
≥î
->
ho°
, 
íåy
.
mpc
.
afi
,É¡ry.mpc.
ßfi
);

224 i‡(!
	`bgp_afi_ßfi_vÆid_ödi˚s
 (
íåy
.
mpc
.
afi
, &
ßfi
))

226 
	`zlog_öfo
 ("%s Addr-family %d/%dÇot supported."

228 
≥î
->
ho°
, 
íåy
.
mpc
.
afi
,É¡ry.mpc.
ßfi
);

233 i‡( (
ˇ∑bûôy_‹f_íåy
Ë+ (
íåy
.
num
 * 2Ë> 
hdr
->
Àngth
)

235 
	`zlog_öfo
 ("%s ORF CapabilityÉntryÜengthÉrror,"

237 
≥î
->
ho°
, 
hdr
->
Àngth
, 
íåy
.
num
);

238 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

242 
i
 = 0 ; i < 
íåy
.
num
 ; i++)

244 
ty≥
 = 
	`°ªam_gëc
(
s
);

245 
mode
 = 
	`°ªam_gëc
(
s
);

248 
mode
)

250 
ORF_MODE_BOTH
:

251 
ORF_MODE_SEND
:

252 
ORF_MODE_RECEIVE
:

255 
	`bgp_ˇ∑bûôy_‹f_nŸ_suµ‹t
 (
≥î
, 
afi
, 
ßfi
, 
ty≥
, 
mode
);

260 
hdr
->
code
)

262 
CAPABILITY_CODE_ORF
:

263 
ty≥
)

265 
ORF_TYPE_PREFIX
:

268 
	`bgp_ˇ∑bûôy_‹f_nŸ_suµ‹t
 (
≥î
, 
afi
, 
ßfi
, 
ty≥
, 
mode
);

272 
CAPABILITY_CODE_ORF_OLD
:

273 
ty≥
)

275 
ORF_TYPE_PREFIX_OLD
:

278 
	`bgp_ˇ∑bûôy_‹f_nŸ_suµ‹t
 (
≥î
, 
afi
, 
ßfi
, 
ty≥
, 
mode
);

283 
	`bgp_ˇ∑bûôy_‹f_nŸ_suµ‹t
 (
≥î
, 
afi
, 
ßfi
, 
ty≥
, 
mode
);

288 i‡(!((
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

289 || (
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_MULTICAST
)

290 || (
afi
 =
AFI_IP6
 && 
ßfi
 =
SAFI_UNICAST
)))

292 
	`bgp_ˇ∑bûôy_‹f_nŸ_suµ‹t
 (
≥î
, 
afi
, 
ßfi
, 
ty≥
, 
mode
);

296 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

297 
	`zlog_debug
 ("%s OPEN has %s ORF capability"

299 
≥î
->
ho°
, 
	`LOOKUP
 (
‹f_ty≥_°r
, 
ty≥
),

300 
	`LOOKUP
 (
‹f_mode_°r
, 
mode
),

301 
íåy
.
mpc
.
afi
, 
ßfi
);

303 i‡(
hdr
->
code
 =
CAPABILITY_CODE_ORF
)

305 
sm_ˇp
 = 
PEER_CAP_ORF_PREFIX_SM_RCV
;

306 
rm_ˇp
 = 
PEER_CAP_ORF_PREFIX_RM_RCV
;

308 i‡(
hdr
->
code
 =
CAPABILITY_CODE_ORF_OLD
)

310 
sm_ˇp
 = 
PEER_CAP_ORF_PREFIX_SM_OLD_RCV
;

311 
rm_ˇp
 = 
PEER_CAP_ORF_PREFIX_RM_OLD_RCV
;

315 
	`bgp_ˇ∑bûôy_‹f_nŸ_suµ‹t
 (
≥î
, 
afi
, 
ßfi
, 
ty≥
, 
mode
);

319 
mode
)

321 
ORF_MODE_BOTH
:

322 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
sm_ˇp
);

323 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
rm_ˇp
);

325 
ORF_MODE_SEND
:

326 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
sm_ˇp
);

328 
ORF_MODE_RECEIVE
:

329 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
rm_ˇp
);

334 
	}
}

337 
	$bgp_ˇ∑bûôy_ª°¨t
 (
≥î
 *≥î, 
ˇ∑bûôy_hódî
 *
ˇphdr
)

339 
°ªam
 *
s
 = 
	`BGP_INPUT
 (
≥î
);

340 
u_öt16_t
 
ª°¨t_Êag_time
;

341 
ª°¨t_bô
 = 0;

342 
size_t
 
íd
 = 
	`°ªam_gë_gëp
 (
s
Ë+ 
ˇphdr
->
Àngth
;

344 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_RESTART_RCV
);

345 
ª°¨t_Êag_time
 = 
	`°ªam_gëw
(
s
);

346 i‡(
	`CHECK_FLAG
 (
ª°¨t_Êag_time
, 
RESTART_R_BIT
))

347 
ª°¨t_bô
 = 1;

348 
	`UNSET_FLAG
 (
ª°¨t_Êag_time
, 0xF000);

349 
≥î
->
v_gr_ª°¨t
 = 
ª°¨t_Êag_time
;

351 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

353 
	`zlog_debug
 ("%†OPEN ha†Gø˚fu»Re°¨àˇ∑bûôy", 
≥î
->
ho°
);

354 
	`zlog_debug
 ("%s Peer has%srestarted. Restart Time : %d",

355 
≥î
->
ho°
, 
ª°¨t_bô
 ? " " : "Çot ",

356 
≥î
->
v_gr_ª°¨t
);

359 
	`°ªam_gë_gëp
 (
s
Ë+ 4 <
íd
)

361 
afi_t
 
afi
 = 
	`°ªam_gëw
 (
s
);

362 
ßfi_t
 
ßfi
 = 
	`°ªam_gëc
 (
s
);

363 
u_ch¨
 
Êag
 = 
	`°ªam_gëc
 (
s
);

365 i‡(!
	`bgp_afi_ßfi_vÆid_ödi˚s
 (
afi
, &
ßfi
))

367 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

368 
	`zlog_debug
 ("%s Addr-family %d/%d(afi/safi)Çot supported."

370 
≥î
->
ho°
, 
afi
, 
ßfi
);

372 i‡(!
≥î
->
afc
[
afi
][
ßfi
])

374 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

375 
	`zlog_debug
 ("%s Addr-family %d/%d(afi/safi)ÇotÉnabled."

377 
≥î
->
ho°
, 
afi
, 
ßfi
);

381 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

382 
	`zlog_debug
 ("%†Addªs†Ámûy %†is%•ª£rved", 
≥î
->
ho°
,

383 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
),

384 
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
],

385 
PEER_CAP_RESTART_AF_PRESERVE_RCV
)

388 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_RESTART_AF_RCV
);

389 i‡(
	`CHECK_FLAG
 (
Êag
, 
RESTART_F_BIT
))

390 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_RESTART_AF_PRESERVE_RCV
);

395 
	}
}

397 
as_t


398 
	$bgp_ˇ∑bûôy_as4
 (
≥î
 *≥î, 
ˇ∑bûôy_hódî
 *
hdr
)

400 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
);

402 i‡(
hdr
->
Àngth
 !
CAPABILITY_CODE_AS4_LEN
)

404 
	`zlog_îr
 ("%s AS4 capability has incorrect dataÜength %d",

405 
≥î
->
ho°
, 
hdr
->
Àngth
);

409 
as_t
 
as4
 = 
	`°ªam_gël
 (
	`BGP_INPUT
(
≥î
));

411 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4
))

412 
	`zlog_debug
 ("%s [AS4]áboutÅo set cap PEER_CAP_AS4_RCV, gotás4 %u",

413 
≥î
->
ho°
, 
as4
);

414  
as4
;

415 
	}
}

417 c⁄° 
mesßge
 
	gˇpcode_°r
[] =

419 { 
CAPABILITY_CODE_MP
, "MultiProtocol Extensions" },

420 { 
CAPABILITY_CODE_REFRESH
, "Route Refresh" },

421 { 
CAPABILITY_CODE_ORF
, "Cooperative Route Filtering" },

422 { 
CAPABILITY_CODE_RESTART
, "Graceful Restart" },

423 { 
CAPABILITY_CODE_AS4
, "4-octet ASÇumber" },

424 { 
CAPABILITY_CODE_DYNAMIC
, "Dynamic" },

425 { 
CAPABILITY_CODE_REFRESH_OLD
, "Route Refresh (Old)" },

426 { 
CAPABILITY_CODE_ORF_OLD
, "ORF (Old)" },

427 #ifde‡
USE_SRX


428 { 
CAPABILITY_CODE_EXTENDED
, "Extended Message Support" },

431 c⁄° 
	gˇpcode_°r_max
 = 
¨øy_size
(
ˇpcode_°r
);

434 c⁄° 
size_t
 
	gˇp_mösizes
[] =

436 [
CAPABILITY_CODE_MP
] =  (
ˇ∑bûôy_mp_d©a
),

437 [
CAPABILITY_CODE_REFRESH
] = 
CAPABILITY_CODE_REFRESH_LEN
,

438 [
CAPABILITY_CODE_ORF
] =  (
ˇ∑bûôy_‹f_íåy
),

439 [
CAPABILITY_CODE_RESTART
] =  (
ˇ∑bûôy_gr
),

440 [
CAPABILITY_CODE_AS4
] = 
CAPABILITY_CODE_AS4_LEN
,

441 [
CAPABILITY_CODE_DYNAMIC
] = 
CAPABILITY_CODE_DYNAMIC_LEN
,

442 [
CAPABILITY_CODE_REFRESH_OLD
] = 
CAPABILITY_CODE_REFRESH_LEN
,

443 [
CAPABILITY_CODE_ORF_OLD
] =  (
ˇ∑bûôy_‹f_íåy
),

444 #ifde‡
USE_SRX


445 [
CAPABILITY_CODE_EXTENDED
] = 
CAPABILITY_CODE_EXTENDED_LEN
,

457 
	$bgp_ˇ∑bûôy_∑r£
 (
≥î
 *≥î, 
size_t
 
Àngth
, *
mp_ˇ∑bûôy
,

458 
u_ch¨
 **
îr‹
)

460 
ªt
;

461 
°ªam
 *
s
 = 
	`BGP_INPUT
 (
≥î
);

462 
size_t
 
íd
 = 
	`°ªam_gë_gëp
 (
s
Ë+ 
Àngth
;

464 #ifde‡
USE_SRX


465 
Bgp£cC≠VÆ
 
cv
;

468 
	`as£π
 (
	`STREAM_READABLE
 (
s
Ë>
Àngth
);

470 
	`°ªam_gë_gëp
 (
s
Ë< 
íd
)

472 
size_t
 
°¨t
;

473 
u_ch¨
 *
•
 = 
	`°ªam_≤t
 (
s
);

474 
ˇ∑bûôy_hódî
 
ˇphdr
;

477 i‡(
	`°ªam_gë_gëp
(
s
Ë+ 2 > 
íd
)

479 
	`zlog_öfo
 ("%†C≠abûôyÜígthÉº‹ (< hódî)", 
≥î
->
ho°
);

480 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

484 
ˇphdr
.
code
 = 
	`°ªam_gëc
 (
s
);

485 
ˇphdr
.
Àngth
 = 
	`°ªam_gëc
 (
s
);

486 
°¨t
 = 
	`°ªam_gë_gëp
 (
s
);

489 i‡(
°¨t
 + 
ˇphdr
.
Àngth
 > 
íd
)

491 
	`zlog_öfo
 ("%†C≠abûôyÜígthÉº‹ (<Üígth)", 
≥î
->
ho°
);

492 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

496 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

497 
	`zlog_debug
 ("%s OPEN has %s capability (%u),Üength %u",

498 
≥î
->
ho°
,

499 
	`LOOKUP
 (
ˇpcode_°r
, 
ˇphdr
.
code
),

500 
ˇphdr
.
code
, c≠hdr.
Àngth
);

503 
ˇphdr
.
code
)

505 
CAPABILITY_CODE_MP
:

506 
CAPABILITY_CODE_REFRESH
:

507 
CAPABILITY_CODE_REFRESH_OLD
:

508 
CAPABILITY_CODE_ORF
:

509 
CAPABILITY_CODE_ORF_OLD
:

510 
CAPABILITY_CODE_RESTART
:

511 
CAPABILITY_CODE_AS4
:

512 
CAPABILITY_CODE_DYNAMIC
:

513 #ifde‡
USE_SRX


514 
CAPABILITY_CODE_BGPSEC
:

515 
CAPABILITY_CODE_EXTENDED
:

518 i‡(
ˇphdr
.
Àngth
 < 
ˇp_mösizes
[ˇphdr.
code
])

520 
	`zlog_öfo
 ("%s %s CapabilityÜengthÉrror: got %u,"

522 
≥î
->
ho°
,

523 
	`LOOKUP
 (
ˇpcode_°r
, 
ˇphdr
.
code
),

524 
ˇphdr
.
Àngth
,

525 (Ë
ˇp_mösizes
[
ˇphdr
.
code
]);

526 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

534 
ˇphdr
.
code
)

536 
CAPABILITY_CODE_MP
:

538 *
mp_ˇ∑bûôy
 = 1;

541 i‡(! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_OVERRIDE_CAPABILITY
))

544 
ªt
 = 
	`bgp_ˇ∑bûôy_mp
 (
≥î
, &
ˇphdr
);

547 i‡(
ªt
 < 0)

550 
	`mem˝y
 (*
îr‹
, 
•
, 
ˇphdr
.
Àngth
 + 2);

551 *
îr‹
 +
ˇphdr
.
Àngth
 + 2;

556 
CAPABILITY_CODE_REFRESH
:

557 
CAPABILITY_CODE_REFRESH_OLD
:

560 i‡(
ˇphdr
.
code
 =
CAPABILITY_CODE_REFRESH_OLD
)

561 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_OLD_RCV
);

563 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
);

566 
CAPABILITY_CODE_ORF
:

567 
CAPABILITY_CODE_ORF_OLD
:

568 i‡(
	`bgp_ˇ∑bûôy_‹f_íåy
 (
≥î
, &
ˇphdr
))

571 
CAPABILITY_CODE_RESTART
:

572 i‡(
	`bgp_ˇ∑bûôy_ª°¨t
 (
≥î
, &
ˇphdr
))

575 
CAPABILITY_CODE_DYNAMIC
:

576 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_DYNAMIC_RCV
);

578 
CAPABILITY_CODE_AS4
:

583 i‡(!
	`bgp_ˇ∑bûôy_as4
 (
≥î
, &
ˇphdr
))

586 #ifde‡
USE_SRX


587 
CAPABILITY_CODE_BGPSEC
:

588 
	`mem£t
(&
cv
, 0xff, (
Bgp£cC≠VÆ
));

589 
cv
.
vîsi⁄_dú
 = 
	`°ªam_gëc
(
s
);

590 
cv
.
afi
 = 
	`°ªam_gëw
(
s
);

592 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

594 
	`zlog_debug
("[BGPSEC] ------- BGPSEC capabilityÖarsing -------");

595 
	`zlog_debug
("[BGPSEC] %s capability code: %dÜength:%d version_dir:%02xáfi:%02x", \

596 
≥î
->
ho°
, 
ˇphdr
.
code
, c≠hdr.
Àngth
, 
cv
.
vîsi⁄_dú
, cv.
afi
);

600 if–(
cv
.
vîsi⁄_dú
 & ~(
BGPSEC_CAP_DIR_RECV
)) == 0)

602 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_BGPSEC_ADV
);

604 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

605 
	`zlog_debug
("[BGPSEC]Öeer Capability RECV set");

610 if–
cv
.
vîsi⁄_dú
 & (
BGPSEC_CAP_DIR_SEND
))

612 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_BGPSEC_ADV_SEND
);

614 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

615 
	`zlog_debug
("[BGPSEC]Öeer Capability SEND set");

620 
CAPABILITY_CODE_EXTENDED
:

621 
	`SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_EXTENDED_MSG_SUPPORT
);

622 if(
≥î
->
ibuf
)

624 if(
	`°ªam_gë_size
 (
≥î
->
ibuf
Ë<
BGP_MAX_PACKET_SIZE
)

625 
	`°ªam_ªsize
 (
≥î
->
ibuf
, 
BGP_MAX_PACKET_SIZE_EXTENDED
);

627 if(
≥î
->
w‹k
)

629 if(
	`°ªam_gë_size
 (
≥î
->
w‹k
Ë<
BGP_MAX_PACKET_SIZE
)

630 
	`°ªam_ªsize
 (
≥î
->
w‹k
, 
BGP_MAX_PACKET_SIZE_EXTENDED
);

635 i‡(
ˇphdr
.
code
 > 128)

639 
	`zlog_w¨n
 ("%s Vendor specific capability %d",

640 
≥î
->
ho°
, 
ˇphdr
.
code
);

644 
	`zlog_w¨n
 ("%s unrecognized capability code: %d - ignored",

645 
≥î
->
ho°
, 
ˇphdr
.
code
);

646 
	`mem˝y
 (*
îr‹
, 
•
, 
ˇphdr
.
Àngth
 + 2);

647 *
îr‹
 +
ˇphdr
.
Àngth
 + 2;

650 i‡(
	`°ªam_gë_gëp
(
s
Ë!(
°¨t
 + 
ˇphdr
.
Àngth
))

652 i‡(
	`°ªam_gë_gëp
(
s
Ë> (
°¨t
 + 
ˇphdr
.
Àngth
))

653 
	`zlog_w¨n
 ("%s Cap-parser for %sÑeadÖast cap-length, %u!",

654 
≥î
->
ho°
, 
	`LOOKUP
 (
ˇpcode_°r
, 
ˇphdr
.
code
),

655 
ˇphdr
.
Àngth
);

656 
	`°ªam_£t_gëp
 (
s
, 
°¨t
 + 
ˇphdr
.
Àngth
);

660 
	}
}

663 
	$bgp_auth_∑r£
 (
≥î
 *≥î, 
size_t
 
Àngth
)

665 
	`bgp_nŸify_£nd
 (
≥î
,

666 
BGP_NOTIFY_OPEN_ERR
,

667 
BGP_NOTIFY_OPEN_AUTH_FAILURE
);

669 
	}
}

672 
	$°ri˘_ˇ∑bûôy_ßme
 (
≥î
 *peer)

674 
i
, 
j
;

676 
i
 = 
AFI_IP
; i < 
AFI_MAX
; i++)

677 
j
 = 
SAFI_UNICAST
; j < 
SAFI_MAX
; j++)

678 i‡(
≥î
->
afc
[
i
][
j
] !≥î->
afc_√go
[i][j])

681 
	}
}

686 
as_t


687 
	$≥ek_f‹_as4_ˇ∑bûôy
 (
≥î
 *≥î, 
u_ch¨
 
Àngth
)

689 
°ªam
 *
s
 = 
	`BGP_INPUT
 (
≥î
);

690 
size_t
 
‹ig_gëp
 = 
	`°ªam_gë_gëp
 (
s
);

691 
size_t
 
íd
 = 
‹ig_gëp
 + 
Àngth
;

692 
as_t
 
as4
 = 0;

695 i‡(
	`STREAM_READABLE
(
s
Ë< 
Àngth
)

698 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4
))

699 
	`zlog_öfo
 ("%s [AS4]Ñcv OPEN w/ OPTIONÖarameterÜen: %u,"

701 
≥î
->
ho°
, 
Àngth
);

705 
	`°ªam_gë_gëp
(
s
Ë< 
íd
)

707 
u_ch¨
 
›t_ty≥
;

708 
u_ch¨
 
›t_Àngth
;

711 i‡(
	`°ªam_gë_gëp
 (
s
Ë+ 2 > 
íd
)

712 
íd
;

715 
›t_ty≥
 = 
	`°ªam_gëc
 (
s
);

716 
›t_Àngth
 = 
	`°ªam_gëc
 (
s
);

719 i‡(
	`°ªam_gë_gëp
 (
s
Ë+ 
›t_Àngth
 > 
íd
)

720 
íd
;

722 i‡(
›t_ty≥
 =
BGP_OPEN_OPT_CAP
)

724 
ˇpd_°¨t
 = 
	`°ªam_gë_gëp
 (
s
);

725 
ˇpd_íd
 = 
ˇpd_°¨t
 + 
›t_Àngth
;

727 
	`as£π
 (
ˇpd_íd
 <
íd
);

729 
	`°ªam_gë_gëp
 (
s
Ë< 
ˇpd_íd
)

731 
ˇ∑bûôy_hódî
 
hdr
;

733 i‡(
	`°ªam_gë_gëp
 (
s
Ë+ 2 > 
ˇpd_íd
)

734 
íd
;

736 
hdr
.
code
 = 
	`°ªam_gëc
 (
s
);

737 
hdr
.
Àngth
 = 
	`°ªam_gëc
 (
s
);

739 i‡((
	`°ªam_gë_gëp
(
s
Ë+ 
hdr
.
Àngth
Ë> 
ˇpd_íd
)

740 
íd
;

742 i‡(
hdr
.
code
 =
CAPABILITY_CODE_AS4
)

744 i‡(
	`BGP_DEBUG
 (
as4
, 
AS4
))

745 
	`zlog_öfo
 ("[AS4] found AS4 capability,áboutÅoÖarse");

746 
as4
 = 
	`bgp_ˇ∑bûôy_as4
 (
≥î
, &
hdr
);

748 
íd
;

750 
	`°ªam_f‹w¨d_gëp
 (
s
, 
hdr
.
Àngth
);

755 
íd
:

756 
	`°ªam_£t_gëp
 (
s
, 
‹ig_gëp
);

757  
as4
;

758 
	}
}

766 
	$bgp_›í_›ti⁄_∑r£
 (
≥î
 *≥î, 
u_ch¨
 
Àngth
, *
mp_ˇ∑bûôy
)

768 
ªt
;

769 
u_ch¨
 *
îr‹
;

770 
u_ch¨
 
îr‹_d©a
[
BGP_MAX_PACKET_SIZE
];

771 
°ªam
 *
s
 = 
	`BGP_INPUT
(
≥î
);

772 
size_t
 
íd
 = 
	`°ªam_gë_gëp
 (
s
Ë+ 
Àngth
;

774 
ªt
 = 0;

775 
îr‹
 = 
îr‹_d©a
;

777 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

778 
	`zlog_debug
 ("%sÑcv OPEN w/ OPTIONÖarameterÜen: %u",

779 
≥î
->
ho°
, 
Àngth
);

781 
	`°ªam_gë_gëp
(
s
Ë< 
íd
)

783 
u_ch¨
 
›t_ty≥
;

784 
u_ch¨
 
›t_Àngth
;

787 i‡(
	`STREAM_READABLE
(
s
) < 2)

789 
	`zlog_öfo
 ("%†O±i⁄ÜígthÉº‹", 
≥î
->
ho°
);

790 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

795 
›t_ty≥
 = 
	`°ªam_gëc
 (
s
);

796 
›t_Àngth
 = 
	`°ªam_gëc
 (
s
);

799 i‡(
	`STREAM_READABLE
 (
s
Ë< 
›t_Àngth
)

801 
	`zlog_öfo
 ("%†O±i⁄ÜígthÉº‹", 
≥î
->
ho°
);

802 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

806 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

807 
	`zlog_debug
 ("%sÑcvd OPEN w/ optionalÖarameterÅype %u (%s)Üen %u",

808 
≥î
->
ho°
, 
›t_ty≥
,

809 
›t_ty≥
 =
BGP_OPEN_OPT_AUTH
 ? "Authentication" :

810 
›t_ty≥
 =
BGP_OPEN_OPT_CAP
 ? "Capability" : "Unknown",

811 
›t_Àngth
);

813 
›t_ty≥
)

815 
BGP_OPEN_OPT_AUTH
:

816 
ªt
 = 
	`bgp_auth_∑r£
 (
≥î
, 
›t_Àngth
);

818 
BGP_OPEN_OPT_CAP
:

819 
ªt
 = 
	`bgp_ˇ∑bûôy_∑r£
 (
≥î
, 
›t_Àngth
, 
mp_ˇ∑bûôy
, &
îr‹
);

822 
	`bgp_nŸify_£nd
 (
≥î
,

823 
BGP_NOTIFY_OPEN_ERR
,

824 
BGP_NOTIFY_OPEN_UNSUP_PARAM
);

825 
ªt
 = -1;

830 if(
ªt
 < 0 &&Ñet == -2)

831 
	`bgp_nŸify_£nd
 (
≥î
,

832 
BGP_NOTIFY_OPEN_ERR
,

833 
BGP_NOTIFY_OPEN_UNSUP_BGPSEC
);

840 i‡(
ªt
 < 0)

846 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_STRICT_CAP_MATCH
))

849 i‡(
îr‹
 !
îr‹_d©a
)

851 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

852 
BGP_NOTIFY_OPEN_ERR
,

853 
BGP_NOTIFY_OPEN_UNSUP_CAPBL
,

854 
îr‹_d©a
, 
îr‹
 -Érror_data);

860 i‡(! 
	`°ri˘_ˇ∑bûôy_ßme
 (
≥î
))

862 
	`bgp_nŸify_£nd
 (
≥î
,

863 
BGP_NOTIFY_OPEN_ERR
,

864 
BGP_NOTIFY_OPEN_UNSUP_CAPBL
);

871 i‡(*
mp_ˇ∑bûôy
 &&

872 ! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_OVERRIDE_CAPABILITY
))

874 i‡(! 
≥î
->
afc_√go
[
AFI_IP
][
SAFI_UNICAST
]

875 && ! 
≥î
->
afc_√go
[
AFI_IP
][
SAFI_MULTICAST
]

876 && ! 
≥î
->
afc_√go
[
AFI_IP
][
SAFI_MPLS_VPN
]

877 && ! 
≥î
->
afc_√go
[
AFI_IP6
][
SAFI_UNICAST
]

878 && ! 
≥î
->
afc_√go
[
AFI_IP6
][
SAFI_MULTICAST
])

880 
	`∂og_îr
 (
≥î
->
log
, "%s [Error] Configured AFI/SAFIs doÇot "

882 
≥î
->
ho°
);

884 i‡(
îr‹
 !
îr‹_d©a
)

886 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

887 
BGP_NOTIFY_OPEN_ERR
,

888 
BGP_NOTIFY_OPEN_UNSUP_CAPBL
,

889 
îr‹_d©a
, 
îr‹
 -Érror_data);

891 
	`bgp_nŸify_£nd
 (
≥î
,

892 
BGP_NOTIFY_OPEN_ERR
,

893 
BGP_NOTIFY_OPEN_UNSUP_CAPBL
);

898 
	}
}

901 
	$bgp_›í_ˇ∑bûôy_‹f
 (
°ªam
 *
s
, 
≥î
 *peer,

902 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_ch¨
 
code
)

904 
u_ch¨
 
ˇp_Àn
;

905 
u_ch¨
 
‹f_Àn
;

906 
ˇµ
;

907 
‹Â
;

908 
numbîp
;

909 
numbî_of_‹fs
 = 0;

911 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

912 
ßfi
 = 
SAFI_MPLS_LABELED_VPN
;

914 
	`°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

915 
ˇµ
 = 
	`°ªam_gë_ídp
 (
s
);

916 
	`°ªam_putc
 (
s
, 0);

917 
	`°ªam_putc
 (
s
, 
code
);

918 
‹Â
 = 
	`°ªam_gë_ídp
 (
s
);

919 
	`°ªam_putc
 (
s
, 0);

920 
	`°ªam_putw
 (
s
, 
afi
);

921 
	`°ªam_putc
 (
s
, 0);

922 
	`°ªam_putc
 (
s
, 
ßfi
);

923 
numbîp
 = 
	`°ªam_gë_ídp
 (
s
);

924 
	`°ªam_putc
 (
s
, 0);

927 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_SM
)

928 || 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_RM
))

930 
	`°ªam_putc
 (
s
, (
code
 =
CAPABILITY_CODE_ORF
 ?

931 
ORF_TYPE_PREFIX
 : 
ORF_TYPE_PREFIX_OLD
));

933 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_SM
)

934 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_RM
))

936 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_ADV
);

937 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
);

938 
	`°ªam_putc
 (
s
, 
ORF_MODE_BOTH
);

940 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_SM
))

942 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_ADV
);

943 
	`°ªam_putc
 (
s
, 
ORF_MODE_SEND
);

947 
	`SET_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
);

948 
	`°ªam_putc
 (
s
, 
ORF_MODE_RECEIVE
);

950 
numbî_of_‹fs
++;

954 
	`°ªam_putc_©
 (
s
, 
numbîp
, 
numbî_of_‹fs
);

957 
‹f_Àn
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
‹Â
 - 1;

958 
	`°ªam_putc_©
 (
s
, 
‹Â
, 
‹f_Àn
);

961 
ˇp_Àn
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
ˇµ
 - 1;

962 
	`°ªam_putc_©
 (
s
, 
ˇµ
, 
ˇp_Àn
);

963 
	}
}

967 
	$bgp_›í_ˇ∑bûôy
 (
°ªam
 *
s
, 
≥î
 *peer)

969 
u_ch¨
 
Àn
;

970 
˝
;

971 
afi_t
 
afi
;

972 
ßfi_t
 
ßfi
;

973 
as_t
 
loˇl_as
;

976 
˝
 = 
	`°ªam_gë_ídp
 (
s
);

979 
	`°ªam_putc
 (
s
, 0);

982 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_CAPABILITY_OPEN
)

983 || 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DONT_CAPABILITY
))

987 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_UNICAST
])

989 
≥î
->
afc_adv
[
AFI_IP
][
SAFI_UNICAST
] = 1;

990 
	`°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

991 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
 + 2);

992 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP
);

993 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
);

994 
	`°ªam_putw
 (
s
, 
AFI_IP
);

995 
	`°ªam_putc
 (
s
, 0);

996 
	`°ªam_putc
 (
s
, 
SAFI_UNICAST
);

999 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_MULTICAST
])

1001 
≥î
->
afc_adv
[
AFI_IP
][
SAFI_MULTICAST
] = 1;

1002 
	`°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1003 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
 + 2);

1004 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP
);

1005 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
);

1006 
	`°ªam_putw
 (
s
, 
AFI_IP
);

1007 
	`°ªam_putc
 (
s
, 0);

1008 
	`°ªam_putc
 (
s
, 
SAFI_MULTICAST
);

1011 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_MPLS_VPN
])

1013 
≥î
->
afc_adv
[
AFI_IP
][
SAFI_MPLS_VPN
] = 1;

1014 
	`°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1015 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
 + 2);

1016 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP
);

1017 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
);

1018 
	`°ªam_putw
 (
s
, 
AFI_IP
);

1019 
	`°ªam_putc
 (
s
, 0);

1020 
	`°ªam_putc
 (
s
, 
SAFI_MPLS_LABELED_VPN
);

1023 #ifde‡
USE_SRX


1024 
boﬁ
 
m≤Ãi_v6_™noun˚d
 = 
Ál£
;

1027 #ifde‡
HAVE_IPV6


1029 i‡(
≥î
->
afc
[
AFI_IP6
][
SAFI_UNICAST
])

1031 
≥î
->
afc_adv
[
AFI_IP6
][
SAFI_UNICAST
] = 1;

1032 
	`°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1033 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
 + 2);

1034 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP
);

1035 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
);

1036 
	`°ªam_putw
 (
s
, 
AFI_IP6
);

1037 
	`°ªam_putc
 (
s
, 0);

1038 
	`°ªam_putc
 (
s
, 
SAFI_UNICAST
);

1040 #i‡
	`deföed
(
USE_SRX
Ë&& deföed(
HAVE_IPV6
)

1041 
m≤Ãi_v6_™noun˚d
 = 
åue
;

1043 #ifde‡
HAVE_IPV6


1044 
	}
}

1046 i‡(
	g≥î
->
	gafc
[
AFI_IP6
][
SAFI_MULTICAST
])

1048 
	g≥î
->
	gafc_adv
[
AFI_IP6
][
SAFI_MULTICAST
] = 1;

1049 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1050 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
 + 2);

1051 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP
);

1052 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
);

1053 
°ªam_putw
 (
s
, 
AFI_IP6
);

1054 
°ªam_putc
 (
s
, 0);

1055 
°ªam_putc
 (
s
, 
SAFI_MULTICAST
);

1057 #i‡
deföed
(
USE_SRX
Ë&& deföed(
HAVE_IPV6
)

1058 
	gm≤Ãi_v6_™noun˚d
 = 
åue
;

1060 #ifde‡
HAVE_IPV6


1065 
SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_ADV
);

1066 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1067 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_REFRESH_LEN
 + 2);

1068 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_REFRESH_OLD
);

1069 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_REFRESH_LEN
);

1070 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1071 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_REFRESH_LEN
 + 2);

1072 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_REFRESH
);

1073 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_REFRESH_LEN
);

1076 
SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_ADV
);

1077 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1078 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_AS4_LEN
 + 2);

1079 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_AS4
);

1080 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_AS4_LEN
);

1081 i‡–
	g≥î
->
	gch™ge_loˇl_as
 )

1082 
	gloˇl_as
 = 
≥î
->
ch™ge_loˇl_as
;

1084 
	gloˇl_as
 = 
≥î
->
loˇl_as
;

1085 
°ªam_pué
 (
s
, 
loˇl_as
 );

1088 
	gafi
 = 
AFI_IP
 ;áfò< 
	gAFI_MAX
 ;áfi++)

1089 
	gßfi
 = 
SAFI_UNICAST
 ; safò< 
	gSAFI_MAX
 ; safi++)

1090 i‡(
CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_SM
)

1091 || 
CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_RM
))

1093 
bgp_›í_ˇ∑bûôy_‹f
 (
s
, 
≥î
, 
afi
, 
ßfi
, 
CAPABILITY_CODE_ORF_OLD
);

1094 
bgp_›í_ˇ∑bûôy_‹f
 (
s
, 
≥î
, 
afi
, 
ßfi
, 
CAPABILITY_CODE_ORF
);

1098 i‡(
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DYNAMIC_CAPABILITY
))

1100 
SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_DYNAMIC_ADV
);

1101 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1102 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_DYNAMIC_LEN
 + 2);

1103 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_DYNAMIC
);

1104 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_DYNAMIC_LEN
);

1108 i‡(
bgp_Êag_check
 (
≥î
->
bgp
, 
BGP_FLAG_GRACEFUL_RESTART
))

1110 
SET_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_RESTART_ADV
);

1111 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1112 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_RESTART_LEN
 + 2);

1113 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_RESTART
);

1114 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_RESTART_LEN
);

1115 
°ªam_putw
 (
s
, 
≥î
->
bgp
->
ª°¨t_time
);

1117 #ifde‡
USE_SRX


1119 i‡(
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
))

1122 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1123 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
 + 2);

1124 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC
);

1125 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
);

1126 
makeBgp£cC≠abûôy
(
s
, 
BGPSEC_CAP_VERSION
, 
BGPSEC_CAP_DIR_SEND
, 
BGPSEC_CAP_AFI_IPv4
);

1128 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

1129 
zlog_debug
("[BGPSEC] %s: BGPSEC SEND C≠abûôy së f‹ IPv4", 
__FUNCTION__
);

1132 if(
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
))

1135 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1136 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
 + 2);

1137 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC
);

1138 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
);

1139 
makeBgp£cC≠abûôy
(
s
, 
BGPSEC_CAP_VERSION
, 
BGPSEC_CAP_DIR_RECV
, 
BGPSEC_CAP_AFI_IPv4
);

1141 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

1142 
zlog_debug
("[BGPSEC] %s: BGPSEC RECV C≠abûôy së f‹ IPv4", 
__FUNCTION__
);

1144 if(!
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
))

1146 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

1147 
zlog_debug
("[BGPSEC] %s: BGPSEC C≠abûôy NOT së f‹ IPv4", 
__FUNCTION__
);

1151 i‡(
	gm≤Ãi_v6_™noun˚d


1152 && (
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
)))

1155 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1156 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
 + 2);

1157 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC
);

1158 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
);

1159 
makeBgp£cC≠abûôy
(
s
, 
BGPSEC_CAP_VERSION
, 
BGPSEC_CAP_DIR_SEND
, 
BGPSEC_CAP_AFI_IPv6
);

1161 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

1162 
zlog_debug
("[BGPSEC] %s: BGPSEC SEND C≠abûôy së f‹ IPv6", 
__FUNCTION__
);

1165 i‡(
	gm≤Ãi_v6_™noun˚d


1166 && (
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
)))

1169 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1170 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
 + 2);

1171 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC
);

1172 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_BGPSEC_LEN
);

1173 
makeBgp£cC≠abûôy
(
s
, 
BGPSEC_CAP_VERSION
, 
BGPSEC_CAP_DIR_RECV
, 
BGPSEC_CAP_AFI_IPv6
);

1175 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

1176 
zlog_debug
("[BGPSEC] %s: BGPSEC RECV C≠abûôy së f‹ IPv6", 
__FUNCTION__
);

1178 if(!
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
))

1180 i‡(
BGP_DEBUG
 (
bgp£c
, 
BGPSEC_OUT
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

1181 
zlog_debug
("[BGPSEC] %s: BGPSEC C≠abûôy NOT së f‹ IPv6", 
__FUNCTION__
);

1185 i‡(
CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
))

1187 i‡(
BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1188 
zlog_debug
("%s: Exãnded MesßgêSuµ‹àC≠abûôy Së", 
__FUNCTION__
);

1190 
°ªam_putc
 (
s
, 
BGP_OPEN_OPT_CAP
);

1191 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_EXTENDED_LEN
+ 2);

1192 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_EXTENDED
);

1193 
°ªam_putc
 (
s
, 
CAPABILITY_CODE_EXTENDED_LEN
);

1198 
	gÀn
 = 
°ªam_gë_ídp
 (
s
Ë- 
˝
 - 1;

1199 
°ªam_putc_©
 (
s
, 
˝
, 
Àn
);

1202 #ifde‡
USE_SRX


1203 
makeBgp£cC≠abûôy
(
°ªam
* 
s
, 
uöt8_t
 
vîsi⁄
, uöt8_à
dú
, 
uöt16_t
 
afi
)

1205 
Bgp£cC≠VÆ
 
	gcv
;

1206 
mem£t
(&
cv
, 0x0, (
Bgp£cC≠VÆ
));

1207 
SET_FLAG
(
cv
.
vîsi⁄_dú
, 
vîsi⁄
);

1208 
SET_FLAG
(
cv
.
vîsi⁄_dú
, 
dú
);

1209 
	gcv
.
	gafi
 = 
afi
;

1211 
°ªam_putc
 (
s
, 
cv
.
vîsi⁄_dú
);

1212 
°ªam_putw
 (
s
, 
cv
.
afi
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_open.h

21 #i‚de‡
_QUAGGA_BGP_OPEN_H


22 
	#_QUAGGA_BGP_OPEN_H


	)

25 
	sˇ∑bûôy_hódî


27 
u_ch¨
 
	mcode
;

28 
u_ch¨
 
	mÀngth
;

32 
	sˇ∑bûôy_mp_d©a


34 
afi_t
 
	mafi
;

35 
u_ch¨
 
	mª£rved
;

36 
ßfi_t
 
	mßfi
;

39 #¥agm®
∑ck
(1)

40 
	sˇ∑bûôy_‹f_íåy


42 
ˇ∑bûôy_mp_d©a
 
	mmpc
;

43 
u_ch¨
 
	mnum
;

45 
u_ch¨
 
	mty≥
;

46 
u_ch¨
 
	mmode
;

47 } 
	m‹fs
[];

48 } 
__©åibuã__
 ((
∑cked
));

49 #¥agm®
∑ck
()

51 
	sˇ∑bûôy_as4


53 
uöt32_t
 
	mas4
;

56 #ifde‡
USE_SRX


58 
	sBgp£cC≠VÆ


60 
uöt8_t
 
	mvîsi⁄_dú
;

61 
	#BGPSEC_CAP_VERSION
 (0 << 4Ë

	)

62 
	#BGPSEC_CAP_DIR_RECV
 (0 << 3)

	)

63 
	#BGPSEC_CAP_DIR_SEND
 (1 << 3)

	)

66 
uöt16_t
 
	mafi
;

67 
	#BGPSEC_CAP_AFI_IPv4
 1

	)

68 
	#BGPSEC_CAP_AFI_IPv6
 2

	)

72 
	sgø˚ful_ª°¨t_af


74 
afi_t
 
	mafi
;

75 
ßfi_t
 
	mßfi
;

76 
u_ch¨
 
	mÊag
;

79 
	sˇ∑bûôy_gr


81 
u_öt16_t
 
	mª°¨t_Êag_time
;

82 
gø˚ful_ª°¨t_af
 
	mgr
[];

86 
	#CAPABILITY_CODE_MP
 1

	)

87 
	#CAPABILITY_CODE_REFRESH
 2

	)

88 
	#CAPABILITY_CODE_ORF
 3

	)

89 #ifde‡
USE_SRX


90 
	#CAPABILITY_CODE_EXTENDED
 6

	)

92 
	#CAPABILITY_CODE_RESTART
 64

	)

93 
	#CAPABILITY_CODE_AS4
 65

	)

94 
	#CAPABILITY_CODE_DYNAMIC
 66

	)

95 
	#CAPABILITY_CODE_REFRESH_OLD
 128

	)

96 
	#CAPABILITY_CODE_ORF_OLD
 130

	)

97 #i‡
deföed
(
USE_SRX
Ë&& !deföed(
CAPABILITY_CODE_BGPSEC
)

98 
	#CAPABILITY_CODE_BGPSEC
 7

	)

102 
	#CAPABILITY_CODE_MP_LEN
 4

	)

103 
	#CAPABILITY_CODE_REFRESH_LEN
 0

	)

104 
	#CAPABILITY_CODE_DYNAMIC_LEN
 0

	)

105 
	#CAPABILITY_CODE_RESTART_LEN
 2

	)

106 
	#CAPABILITY_CODE_AS4_LEN
 4

	)

107 #ifde‡
USE_SRX


108 
	#CAPABILITY_CODE_BGPSEC_LEN
 3

	)

109 
	#CAPABILITY_CODE_EXTENDED_LEN
 0

	)

115 
	#ORF_TYPE_PREFIX
 64

	)

116 
	#ORF_TYPE_PREFIX_OLD
 128

	)

119 
	#ORF_MODE_RECEIVE
 1

	)

120 
	#ORF_MODE_SEND
 2

	)

121 
	#ORF_MODE_BOTH
 3

	)

124 
	#CAPABILITY_ACTION_SET
 0

	)

125 
	#CAPABILITY_ACTION_UNSET
 1

	)

128 
	#RESTART_R_BIT
 0x8000

	)

129 
	#RESTART_F_BIT
 0x80

	)

131 
bgp_›í_›ti⁄_∑r£
 (
≥î
 *, 
u_ch¨
, *);

132 
bgp_›í_ˇ∑bûôy
 (
°ªam
 *, 
≥î
 *);

133 
bgp_ˇ∑bûôy_vty_out
 (
vty
 *, 
≥î
 *);

134 
as_t
 
≥ek_f‹_as4_ˇ∑bûôy
 (
≥î
 *, 
u_ch¨
);

135 
bgp_afi_ßfi_vÆid_ödi˚s
 (
afi_t
, 
ßfi_t
 *);

136 
makeBgp£cC≠abûôy
(
°ªam
* 
s
, 
uöt8_t
 
vîsi⁄
, uöt8_à
dú
, 
uöt16_t
 
afi
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_packet.c

21 
	~<zebø.h
>

22 #ifde‡
USE_SRX


23 
	~<§x/§x¸y±ﬂpi.h
>

26 
	~"thªad.h
"

27 
	~"°ªam.h
"

28 
	~"√tw‹k.h
"

29 
	~"¥efix.h
"

30 
	~"comm™d.h
"

31 
	~"log.h
"

32 
	~"mem‹y.h
"

33 
	~"sockuni⁄.h
"

34 
	~"lökli°.h
"

35 
	~"∂i°.h
"

37 
	~"bgpd/bgpd.h
"

38 
	~"bgpd/bgp_èbÀ.h
"

39 
	~"bgpd/bgp_dump.h
"

40 
	~"bgpd/bgp_©å.h
"

41 
	~"bgpd/bgp_debug.h
"

42 
	~"bgpd/bgp_fsm.h
"

43 
	~"bgpd/bgp_rouã.h
"

44 
	~"bgpd/bgp_∑ckë.h
"

45 
	~"bgpd/bgp_›í.h
"

46 
	~"bgpd/bgp_a•©h.h
"

47 
	~"bgpd/bgp_communôy.h
"

48 
	~"bgpd/bgp_ecommunôy.h
"

49 
	~"bgpd/bgp_√tw‹k.h
"

50 
	~"bgpd/bgp_m∂sv≤.h
"

51 
	~"bgpd/bgp_advîti£.h
"

52 
	~"bgpd/bgp_vty.h
"

53 #i‡
deföed
 (
__TIME_MEASURE__
)

54 
	~"libtm_rdtsc.h
"

57 
°ªam_put_¥efix
 (
°ªam
 *, 
¥efix
 *);

61 
	$bgp_∑ckë_£t_m¨kî
 (
°ªam
 *
s
, 
u_ch¨
 
ty≥
)

63 
i
;

66 
i
 = 0; i < 
BGP_MARKER_SIZE
; i++)

67 
	`°ªam_putc
 (
s
, 0xff);

70 
	`°ªam_putw
 (
s
, 0);

73 
	`°ªam_putc
 (
s
, 
ty≥
);

76  
	`°ªam_gë_ídp
 (
s
);

77 
	}
}

82 
	$bgp_∑ckë_£t_size
 (
°ªam
 *
s
)

84 
˝
;

87 
˝
 = 
	`°ªam_gë_ídp
 (
s
);

88 
	`°ªam_putw_©
 (
s
, 
BGP_MARKER_SIZE
, 
˝
);

90  
˝
;

91 
	}
}

95 
	$bgp_∑ckë_add
 (
≥î
 *≥î, 
°ªam
 *
s
)

98 
	`°ªam_fifo_push
 (
≥î
->
obuf
, 
s
);

99 
	}
}

103 
	$bgp_∑ckë_dñëe
 (
≥î
 *peer)

105 
	`°ªam_‰ì
 (
	`°ªam_fifo_p›
 (
≥î
->
obuf
));

106 
	}
}

110 
	$bgp_c⁄√˘_check
 (
≥î
 *peer)

112 
°©us
;

113 
sockÀn_t
 
¶í
;

114 
ªt
;

117 
	`BGP_READ_OFF
 (
≥î
->
t_ªad
);

118 
	`BGP_WRITE_OFF
 (
≥î
->
t_wrôe
);

121 
¶í
 =  (
°©us
);

122 
ªt
 = 
	`gësock›t
(
≥î
->
fd
, 
SOL_SOCKET
, 
SO_ERROR
, (*Ë&
°©us
, &
¶í
);

125 i‡(
ªt
 < 0)

127 
	`zlog
 (
≥î
->
log
, 
LOG_INFO
, "can't get sockopt forÇonblocking connect");

128 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_Áèl_îr‹
);

133 i‡(
°©us
 == 0)

135 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_c⁄√˘i⁄_›í
);

139 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

140 
	`∂og_debug
 (
≥î
->
log
, "%s [Event] Connect failed (%s)",

141 
≥î
->
ho°
, 
	`ß„_°ªº‹
 (
î∫o
));

142 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_c⁄√˘i⁄_›í_Áûed
);

144 
	}
}

146 #ifde‡
USE_SRX


147 
ecommunôy
* 
	$§xEcommunôyCh™ge
(
bgp
 *bgp, 
©å
 *©å, 
bgp_öfo
 *
böfo
)

149 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

150 
ecommunôy
 *
ecom
=
NULL
, *
ecom_‹ig
=NULL;

151 
°©e
;

153 
böfo
->
vÆ_ªs_ROA
)

155 
ECOMMUNITY_BGPSEC_VALID
:

156 
°©e
 = 
ECOMMUNITY_BGPSEC_VALID
; ;

157 
ECOMMUNITY_BGPSEC_NOT_FOUND
:

158 
°©e
 = 
ECOMMUNITY_BGPSEC_NOT_FOUND
; ;

159 
ECOMMUNITY_BGPSEC_INVALID
:

160 
°©e
 = 
ECOMMUNITY_BGPSEC_INVALID
; ;

162 
°©e
 = 
ECOMMUNITY_BGPSEC_NOT_FOUND
; ;

165 if(
©åe
)

167 
ecom
 = 
	`ecommunôy_bgp£c_°r2com
 (
bgp
->
§x_ecommunôy_subcode
, 
°©e
);

168 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
);

169 
ecom_‹ig
 = 
©åe
->
ecommunôy
;

170 
©åe
->
ecommunôy
 = 
ecom
;

173  
NULL
;

175  
ecom_‹ig
;

176 
	}
}

178 
	$§xEcommunôyRe°‹e
(
©å
 *©å, 
ecommunôy
* 
ecom_‹ig
)

180 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

181 
ecommunôy
 *
ecom
=
NULL
;

182 
ªt
=0;

184 if(
©åe
 &&áâª->
ecommunôy
 && (
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
)))

186 
©å
->
Êag
 &~(
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
));

187 
ecom
 = 
©åe
->
ecommunôy
;

188 
©åe
->
ecommunôy
 = 
ecom_‹ig
;

189 
ªt
 = 1;

192 if(
ecom
)

193 
	`‰ì
(
ecom
);

195  
ªt
;

196 
	}
}

200 
°ªam
 *

201 
	$bgp_upd©e_∑ckë
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

203 
°ªam
 *
s
;

204 
bgp_adj_out
 *
adj
;

205 
bgp_advîti£
 *
adv
;

206 
°ªam
 *
∑ckë
;

207 
bgp_node
 *
∫
 = 
NULL
;

208 
bgp_öfo
 *
böfo
 = 
NULL
;

209 
bgp_size_t
 
tŸÆ_©å_Àn
 = 0;

210 
pos
;

211 #ifde‡
USE_SRX


212 
u_ch¨
 
bFøg
 =0;

220 
boﬁ
 
u£AS∑th
 = 
Ál£
;

223 
s
 = 
≥î
->
w‹k
;

224 
	`°ªam_ª£t
 (
s
);

226 
adv
 = 
	`FIFO_HEAD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
upd©e
);

228 
adv
)

230 
	`as£π
 (
adv
->
∫
);

231 
∫
 = 
adv
->rn;

232 
adj
 = 
adv
->adj;

233 i‡(
adv
->
böfo
)

234 
böfo
 = 
adv
->binfo;

236 #ifde‡
USE_SRX


237 i‡(!
	`CHECK_FLAG
(
≥î
->
ˇp
, 
PEER_CAP_EXTENDED_MSG_SUPPORT
)

238 && 
	`STREAM_REMAIN
(
s
Ë> 
BGP_MAX_PACKET_SIZE
)

240 
size_t
 
ﬁdsize
, 
√wsize
 = 
BGP_MAX_PACKET_SIZE
;

241 
√wsize
 = 
	`°ªam_ªsize
 (
s
,Çewsize);

243 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

244 
	`zlog_debug
("[BGPSEC] [%s] streamÑemain:%dÖrefix size: %dÑn->p:%08xáttr:%p ",

245 
__FUNCTION__
, 
	`STREAM_REMAIN
 (
s
), 
	`PSIZE
 (
∫
->
p
.
¥efixÀn
),

246 
∫
->
p
.
u
.
¥efix4
, 
adv
->
bØ
->
©å
);

249 i‡(
	`STREAM_REMAIN
 (
s
Ë<
BGP_NLRI_LENGTH
 + 
	`PSIZE
 (
∫
->
p
.
¥efixÀn
))

253 i‡(
	`°ªam_em±y
 (
s
))

255 
¥efix_rd
 *
¥d
 = 
NULL
;

256 
u_ch¨
 *
èg
 = 
NULL
;

257 
≥î
 *
‰om
 = 
NULL
;

259 i‡(
∫
->
¥n
)

260 
¥d
 = (
¥efix_rd
 *Ë&
∫
->
¥n
->
p
;

261 i‡(
böfo
)

263 
‰om
 = 
böfo
->
≥î
;

264 i‡(
böfo
->
exåa
)

265 
èg
 = 
böfo
->
exåa
->tag;

268 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_UPDATE
);

269 
	`°ªam_putw
 (
s
, 0);

270 
pos
 = 
	`°ªam_gë_ídp
 (
s
);

271 
	`°ªam_putw
 (
s
, 0);

272 #ifde‡
USE_SRX


273 
ecommunôy
 *
ecom_‹ig
;

274 i‡(
	`CHECK_FLAG
 (
≥î
->
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY
))

275 
ecom_‹ig
 = 
	`§xEcommunôyCh™ge
(
≥î
->
bgp
, 
adv
->
bØ
->
©å
, 
böfo
);

276 
tŸÆ_©å_Àn
 = 
	`bgp_∑ckë_©åibuã
 (
NULL
, 
≥î
, 
s
,

277 
adv
->
bØ
->
©å
,

278 &
∫
->
p
, 
afi
, 
ßfi
,

279 
‰om
, 
¥d
, 
èg
, &
u£AS∑th
);

281 
tŸÆ_©å_Àn
 = 
	`bgp_∑ckë_©åibuã
 (
NULL
, 
≥î
, 
s
,

282 
adv
->
bØ
->
©å
,

283 &
∫
->
p
, 
afi
, 
ßfi
,

284 
‰om
, 
¥d
, 
èg
);

286 
	`°ªam_putw_©
 (
s
, 
pos
, 
tŸÆ_©å_Àn
);

287 #ifde‡
USE_SRX


288 i‡(
	`CHECK_FLAG
 (
≥î
->
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY
))

289 
bFøg
 = 
	`§xEcommunôyRe°‹e
(
adv
->
bØ
->
©å
, 
ecom_‹ig
);

293 #ifde‡
USE_SRX


298 i‡(
u£AS∑th
)

301 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

302 
	`°ªam_put_¥efix
 (
s
, &
∫
->
p
);

304 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_OUT
))

306 
buf
[
INET6_BUFSIZ
];

308 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%s send UPDATE %s/%d",

309 
≥î
->
ho°
,

310 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &‘n->p.
u
.
¥efix
), 
buf
, 
INET6_BUFSIZ
),

311 
∫
->
p
.
¥efixÀn
);

315 i‡(
adj
->
©å
)

317 
	`bgp_©å_unöã∫
 (&
adj
->
©å
);

320 
≥î
->
scou¡
[
afi
][
ßfi
]++;

322 
adj
->
©å
 = 
	`bgp_©å_öã∫
 (
adv
->
bØ
->attr);

324 #ifde‡
USE_SRX


325 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

326 
	`zlog_debug
("[BGPSEC] [%s] (after intern)ádj->attr:%p bgpsecáttr:%p ",\

327 
__FUNCTION__
, 
adj
->
©å
,ádj->©å->
bgp£cP©hAâr
 );

330 
adv
 = 
	`bgp_advîti£_˛ón
 (
≥î
, 
adj
, 
afi
, 
ßfi
);

332 i‡(! (
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
))

335 #ifde‡
USE_SRX


336 i‡–
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_MPE_IPV4
) )

339 
≥î
 *
‰om
 = 
NULL
;

340 
u_ch¨
 
bDoNŸFøg
 =0;

341 i‡(
böfo
)

343 
‰om
 = 
böfo
->
≥î
;

344 i‡(
‰om
)

348 if–(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
) \

349 && 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_BGPSEC_ADV
)) )

352 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

354 
	`zlog_debug
("[BGPSEC] from:%p from->as:%d from->cap:%04x",

355 
‰om
, from->
as
, from->
ˇp
);

360 i‡(
‰om
->
as
 >0 && from->a†!
≥î
->as)

362 i‡(!
	`CHECK_FLAG
 (
‰om
->
ˇp
, 
PEER_CAP_BGPSEC_ADV_SEND
)

363 || !
	`CHECK_FLAG
 (
‰om
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
))

365 
bDoNŸFøg
 =1;

376 i‡–(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
)

377 && 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_BGPSEC_ADV
))

378 || ((
	`CHECK_FLAG
 (
≥î
->
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY
))

379 && 
bFøg
 && 
‰om
))

382 i‡(
bDoNŸFøg
)

383 
d⁄Ÿ_‰ag
;

390 i‡(
adj
->
©å
->
a•©h
 &&ádj->©å->a•©h->
£gmíts
 &&

391 
adj
->
©å
->
a•©h
->
£gmíts
->
Àngth
 > 0 && !adj->©å->
bgp£cP©hAâr
)

392 
d⁄Ÿ_‰ag
;

394 
size_t
 
˝
 = 
	`°ªam_gë_gëp
(
s
);

395 
	`°ªam_£t_gëp
 (
s
, 
BGP_MARKER_SIZE
 + 2);

396 
u_ch¨
 
ty≥
 = 
	`°ªam_gëc
 (
s
);

397 
	`°ªam_£t_gëp
(
s
, 
˝
);

400 i‡(
ty≥
 =
BGP_MSG_UPDATE
)

402 
	`bgp_∑ckë_£t_size
 (
s
);

403 
∑ckë
 = 
	`°ªam_dup
 (
s
);

404 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

405 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

406 
	`zlog_debug
("*** Upd©êMesßgêFøgmíèti⁄ ON (tÿ≥î:%d)*** ", 
≥î
->
as
);

407 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

408 
	`°ªam_ª£t
 (
s
);

409  
∑ckë
;

413 
d⁄Ÿ_‰ag
:

414 
bDoNŸFøg
 = 0;

418 i‡(! 
	`°ªam_em±y
 (
s
))

420 
	`bgp_∑ckë_£t_size
 (
s
);

421 
∑ckë
 = 
	`°ªam_dup
 (
s
);

422 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

423 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

424 
	`°ªam_ª£t
 (
s
);

425  
∑ckë
;

427  
NULL
;

428 
	}
}

430 
°ªam
 *

431 
	$bgp_upd©e_∑ckë_e‹
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

433 
°ªam
 *
s
;

434 
°ªam
 *
∑ckë
;

436 i‡(
DISABLE_BGP_ANNOUNCE
)

437  
NULL
;

439 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

440 
	`zlog_debug
 ("£nd End-of-RIB f‹ %†tÿ%s", 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
), 
≥î
->
ho°
);

442 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

445 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_UPDATE
);

448 
	`°ªam_putw
 (
s
, 0);

450 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

453 
	`°ªam_putw
 (
s
, 0);

458 
	`°ªam_putw
 (
s
, 6);

459 
	`°ªam_putc
 (
s
, 
BGP_ATTR_FLAG_OPTIONAL
);

460 
	`°ªam_putc
 (
s
, 
BGP_ATTR_MP_UNREACH_NLRI
);

461 
	`°ªam_putc
 (
s
, 3);

462 
	`°ªam_putw
 (
s
, 
afi
);

463 
	`°ªam_putc
 (
s
, 
ßfi
);

466 
	`bgp_∑ckë_£t_size
 (
s
);

467 
∑ckë
 = 
	`°ªam_dup
 (
s
);

468 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

469 
	`°ªam_‰ì
 (
s
);

470  
∑ckë
;

471 
	}
}

474 
°ªam
 *

475 
	$bgp_wôhdøw_∑ckë
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

477 
°ªam
 *
s
;

478 
°ªam
 *
∑ckë
;

479 
bgp_adj_out
 *
adj
;

480 
bgp_advîti£
 *
adv
;

481 
bgp_node
 *
∫
;

482 
pos
;

483 
bgp_size_t
 
un„asibÀ_Àn
;

484 
bgp_size_t
 
tŸÆ_©å_Àn
;

486 
s
 = 
≥î
->
w‹k
;

487 
	`°ªam_ª£t
 (
s
);

489 (
adv
 = 
	`FIFO_HEAD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
wôhdøw
)Ë!
NULL
)

491 
	`as£π
 (
adv
->
∫
);

492 
adj
 = 
adv
->adj;

493 
∫
 = 
adv
->rn;

495 i‡(
	`STREAM_REMAIN
 (
s
)

496 < (
BGP_NLRI_LENGTH
 + 
BGP_TOTAL_ATTR_LEN
 + 
	`PSIZE
 (
∫
->
p
.
¥efixÀn
)))

499 i‡(
	`°ªam_em±y
 (
s
))

501 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_UPDATE
);

502 
	`°ªam_putw
 (
s
, 0);

505 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

506 
	`°ªam_put_¥efix
 (
s
, &
∫
->
p
);

509 
¥efix_rd
 *
¥d
 = 
NULL
;

511 i‡(
∫
->
¥n
)

512 
¥d
 = (
¥efix_rd
 *Ë&
∫
->
¥n
->
p
;

513 
pos
 = 
	`°ªam_gë_ídp
 (
s
);

514 
	`°ªam_putw
 (
s
, 0);

515 
tŸÆ_©å_Àn


516 
	`bgp_∑ckë_wôhdøw
 (
≥î
, 
s
, &
∫
->
p
, 
afi
, 
ßfi
, 
¥d
, 
NULL
);

519 
	`°ªam_putw_©
 (
s
, 
pos
, 
tŸÆ_©å_Àn
);

522 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_OUT
))

524 
buf
[
INET6_BUFSIZ
];

526 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%s send UPDATE %s/%d -- unreachable",

527 
≥î
->
ho°
,

528 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &‘n->p.
u
.
¥efix
), 
buf
, 
INET6_BUFSIZ
),

529 
∫
->
p
.
¥efixÀn
);

532 
≥î
->
scou¡
[
afi
][
ßfi
]--;

534 
	`bgp_adj_out_ªmove
 (
∫
, 
adj
, 
≥î
, 
afi
, 
ßfi
);

535 
	`bgp_u∆ock_node
 (
∫
);

537 i‡(! (
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
))

541 i‡(! 
	`°ªam_em±y
 (
s
))

543 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

545 
un„asibÀ_Àn


546 
	`°ªam_gë_ídp
 (
s
Ë- 
BGP_HEADER_SIZE
 - 
BGP_UNFEASIBLE_LEN
;

547 
	`°ªam_putw_©
 (
s
, 
BGP_HEADER_SIZE
, 
un„asibÀ_Àn
);

548 
	`°ªam_putw
 (
s
, 0);

550 
	`bgp_∑ckë_£t_size
 (
s
);

551 
∑ckë
 = 
	`°ªam_dup
 (
s
);

552 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

553 
	`°ªam_ª£t
 (
s
);

554  
∑ckë
;

557  
NULL
;

558 
	}
}

561 
	$bgp_deÁu…_upd©e_£nd
 (
≥î
 *≥î, 
©å
 *attr,

562 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
≥î
 *
‰om
)

564 
°ªam
 *
s
;

565 
°ªam
 *
∑ckë
;

566 
¥efix
 
p
;

567 
pos
;

568 
bgp_size_t
 
tŸÆ_©å_Àn
;

570 i‡(
DISABLE_BGP_ANNOUNCE
)

573 i‡(
afi
 =
AFI_IP
)

574 
	`°r2¥efix
 ("0.0.0.0/0", &
p
);

575 #ifde‡
HAVE_IPV6


577 
	`°r2¥efix
 ("::/0", &
p
);

581 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_OUT
))

583 
©å°r
[
BUFSIZ
];

584 
buf
[
INET6_BUFSIZ
];

585 
©å°r
[0] = '\0';

587 
	`bgp_dump_©å
 (
≥î
, 
©å
, 
©å°r
, 
BUFSIZ
);

588 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%s send UPDATE %s/%d %s",

589 
≥î
->
ho°
, 
	`öë_¡›
(
p
.
Ámûy
, &’.
u
.
¥efix
), 
buf
, 
INET6_BUFSIZ
),

590 
p
.
¥efixÀn
, 
©å°r
);

593 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

596 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_UPDATE
);

599 
	`°ªam_putw
 (
s
, 0);

602 
pos
 = 
	`°ªam_gë_ídp
 (
s
);

603 
	`°ªam_putw
 (
s
, 0);

604 #ifde‡
USE_SRX


605 
boﬁ
 
fU£dA•©h
 = 
Ál£
;

606 
tŸÆ_©å_Àn
 = 
	`bgp_∑ckë_©åibuã
 (
NULL
, 
≥î
, 
s
, 
©å
, &
p
, 
afi
, 
ßfi
,

607 
‰om
, 
NULL
, NULL, &
fU£dA•©h
);

609 
tŸÆ_©å_Àn
 = 
	`bgp_∑ckë_©åibuã
 (
NULL
, 
≥î
, 
s
, 
©å
, &
p
, 
afi
, 
ßfi
, 
‰om
, NULL, NULL);

613 
	`°ªam_putw_©
 (
s
, 
pos
, 
tŸÆ_©å_Àn
);

615 #ifde‡
USE_SRX


616 i‡(
fU£dA•©h
)

619 i‡(
p
.
Ámûy
 =
AF_INET
 && 
ßfi
 =
SAFI_UNICAST
)

620 
	`°ªam_put_¥efix
 (
s
, &
p
);

623 
	`bgp_∑ckë_£t_size
 (
s
);

625 
∑ckë
 = 
	`°ªam_dup
 (
s
);

626 
	`°ªam_‰ì
 (
s
);

629 #ifde‡
DEBUG


634 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

636 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

637 
	}
}

640 
	$bgp_deÁu…_wôhdøw_£nd
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

642 
°ªam
 *
s
;

643 
°ªam
 *
∑ckë
;

644 
¥efix
 
p
;

645 
pos
;

646 
˝
;

647 
bgp_size_t
 
un„asibÀ_Àn
;

648 
bgp_size_t
 
tŸÆ_©å_Àn
;

650 i‡(
DISABLE_BGP_ANNOUNCE
)

653 i‡(
afi
 =
AFI_IP
)

654 
	`°r2¥efix
 ("0.0.0.0/0", &
p
);

655 #ifde‡
HAVE_IPV6


657 
	`°r2¥efix
 ("::/0", &
p
);

660 
tŸÆ_©å_Àn
 = 0;

661 
pos
 = 0;

663 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_OUT
))

665 
buf
[
INET6_BUFSIZ
];

667 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%s send UPDATE %s/%d -- unreachable",

668 
≥î
->
ho°
, 
	`öë_¡›
(
p
.
Ámûy
, &’.
u
.
¥efix
), 
buf
, 
INET6_BUFSIZ
),

669 
p
.
¥efixÀn
);

672 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

675 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_UPDATE
);

678 
˝
 = 
	`°ªam_gë_ídp
 (
s
);

679 
	`°ªam_putw
 (
s
, 0);

682 i‡(
p
.
Ámûy
 =
AF_INET
 && 
ßfi
 =
SAFI_UNICAST
)

684 
	`°ªam_put_¥efix
 (
s
, &
p
);

686 
un„asibÀ_Àn
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
˝
 - 2;

689 
	`°ªam_putw_©
 (
s
, 
˝
, 
un„asibÀ_Àn
);

692 
	`°ªam_putw
 (
s
, 0);

696 
pos
 = 
	`°ªam_gë_ídp
 (
s
);

697 
	`°ªam_putw
 (
s
, 0);

698 
tŸÆ_©å_Àn
 = 
	`bgp_∑ckë_wôhdøw
 (
≥î
, 
s
, &
p
, 
afi
, 
ßfi
, 
NULL
, NULL);

701 
	`°ªam_putw_©
 (
s
, 
pos
, 
tŸÆ_©å_Àn
);

704 
	`bgp_∑ckë_£t_size
 (
s
);

706 
∑ckë
 = 
	`°ªam_dup
 (
s
);

707 
	`°ªam_‰ì
 (
s
);

710 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

712 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

713 
	}
}

716 
°ªam
 *

717 
	$bgp_wrôe_∑ckë
 (
≥î
 *peer)

719 
afi_t
 
afi
;

720 
ßfi_t
 
ßfi
;

721 
°ªam
 *
s
 = 
NULL
;

722 
bgp_advîti£
 *
adv
;

724 
s
 = 
	`°ªam_fifo_hód
 (
≥î
->
obuf
);

725 i‡(
s
)

726  
s
;

728 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

729 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

731 
adv
 = 
	`FIFO_HEAD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
wôhdøw
);

732 i‡(
adv
)

734 
s
 = 
	`bgp_wôhdøw_∑ckë
 (
≥î
, 
afi
, 
ßfi
);

735 i‡(
s
)

736  
s
;

740 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

741 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

743 
adv
 = 
	`FIFO_HEAD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
upd©e
);

744 i‡(
adv
)

746 i‡(
adv
->
böfo
 &&ádv->böfo->
u±ime
 < 
≥î
->
syn˘ime
)

748 i‡(
	`CHECK_FLAG
 (
adv
->
böfo
->
≥î
->
ˇp
, 
PEER_CAP_RESTART_RCV
)

749 && 
	`CHECK_FLAG
 (
adv
->
böfo
->
≥î
->
ˇp
, 
PEER_CAP_RESTART_ADV
)

750 && ! 
	`CHECK_FLAG
 (
adv
->
böfo
->
Êags
, 
BGP_INFO_STALE
)

751 && 
ßfi
 !
SAFI_MPLS_VPN
)

753 i‡(
	`CHECK_FLAG
 (
adv
->
böfo
->
≥î
->
af_sÊags
[
afi
][
ßfi
],

754 
PEER_STATUS_EOR_RECEIVED
))

755 
s
 = 
	`bgp_upd©e_∑ckë
 (
≥î
, 
afi
, 
ßfi
);

758 
s
 = 
	`bgp_upd©e_∑ckë
 (
≥î
, 
afi
, 
ßfi
);

762 i‡(
s
)

763  
s
;

766 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_RESTART_RCV
))

768 i‡(
≥î
->
afc_√go
[
afi
][
ßfi
] &&Öìr->
syn˘ime


769 && ! 
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_EOR_SEND
)

770 && 
ßfi
 !
SAFI_MPLS_VPN
)

772 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_EOR_SEND
);

773  
	`bgp_upd©e_∑ckë_e‹
 (
≥î
, 
afi
, 
ßfi
);

778  
NULL
;

779 
	}
}

784 
	$bgp_wrôe_¥o˚ed
 (
≥î
 *peer)

786 
afi_t
 
afi
;

787 
ßfi_t
 
ßfi
;

788 
bgp_advîti£
 *
adv
;

790 i‡(
	`°ªam_fifo_hód
 (
≥î
->
obuf
))

793 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

794 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

795 i‡(
	`FIFO_HEAD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
wôhdøw
))

798 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

799 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

800 i‡((
adv
 = 
	`FIFO_HEAD
 (&
≥î
->
sync
[
afi
][
ßfi
]->
upd©e
)Ë!
NULL
)

801 i‡(
adv
->
böfo
->
u±ime
 < 
≥î
->
syn˘ime
)

805 
	}
}

809 
	$bgp_wrôe
 (
thªad
 *thread)

811 
≥î
 *peer;

812 
u_ch¨
 
ty≥
;

813 
°ªam
 *
s
;

814 
num
;

815 
cou¡
 = 0;

818 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

819 
≥î
->
t_wrôe
 = 
NULL
;

822 i‡(
≥î
->
°©us
 =
C⁄√˘
)

824 
	`bgp_c⁄√˘_check
 (
≥î
);

828 
s
 = 
	`bgp_wrôe_∑ckë
 (
≥î
);

829 i‡(!
s
)

832 
	`sock›t_c‹k
 (
≥î
->
fd
, 1);

837 
wrôíum
;

840 
wrôíum
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
	`°ªam_gë_gëp
 (s);

843 
num
 = 
	`wrôe
 (
≥î
->
fd
, 
	`STREAM_PNT
 (
s
), 
wrôíum
);

844 i‡(
num
 < 0)

847 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

850 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_Áèl_îr‹
);

854 i‡(
num
 !
wrôíum
)

857 
	`°ªam_f‹w¨d_gëp
 (
s
, 
num
);

862 
	`°ªam_£t_gëp
 (
s
, 
BGP_MARKER_SIZE
 + 2);

863 
ty≥
 = 
	`°ªam_gëc
 (
s
);

865 
ty≥
)

867 
BGP_MSG_OPEN
:

868 
≥î
->
›í_out
++;

870 
BGP_MSG_UPDATE
:

871 
≥î
->
upd©e_out
++;

872 #ifde‡
USE_SRX


873 
	`sock›t_c‹k
 (
≥î
->
fd
, 0);

874 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

875 
	`zlog_debug
("[BGPSEC] upd©ê∑ckë couãr: %d", 
cou¡
);

881 
BGP_MSG_NOTIFY
:

882 
≥î
->
nŸify_out
++;

884 
≥î
->
v_°¨t
 *= 2;

887 i‡(
≥î
->
v_°¨t
 >= (60 * 2))

888 
≥î
->
v_°¨t
 = (60 * 2);

891 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

892 
d⁄e
;

894 
BGP_MSG_KEEPALIVE
:

895 
≥î
->
kì∑live_out
++;

897 
BGP_MSG_ROUTE_REFRESH_NEW
:

898 
BGP_MSG_ROUTE_REFRESH_OLD
:

899 
≥î
->
ª‰esh_out
++;

901 
BGP_MSG_CAPABILITY
:

902 
≥î
->
dy«mic_ˇp_out
++;

907 
	`bgp_∑ckë_dñëe
 (
≥î
);

909 ++
cou¡
 < 
BGP_WRITE_PACKET_MAX
 &&

910 (
s
 = 
	`bgp_wrôe_∑ckë
 (
≥î
)Ë!
NULL
);

912 i‡(
	`bgp_wrôe_¥o˚ed
 (
≥î
))

913 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

915 
d⁄e
:

916 
	`sock›t_c‹k
 (
≥î
->
fd
, 0);

918 
	}
}

923 
	$bgp_wrôe_nŸify
 (
≥î
 *peer)

925 
ªt
, 
vÆ
;

926 
u_ch¨
 
ty≥
;

927 
°ªam
 *
s
;

930 
s
 = 
	`°ªam_fifo_hód
 (
≥î
->
obuf
);

931 i‡(!
s
)

933 
	`as£π
 (
	`°ªam_gë_ídp
 (
s
Ë>
BGP_HEADER_SIZE
);

936 
vÆ
 = 
	`f˙é
 (
≥î
->
fd
, 
F_GETFL
, 0);

937 
	`f˙é
 (
≥î
->
fd
, 
F_SETFL
, 
vÆ
 & ~
O_NONBLOCK
);

940 
	`sock›t_c‹k
 (
≥î
->
fd
, 0);

942 
ªt
 = 
	`wrôe
 (
≥î
->
fd
, 
	`STREAM_DATA
 (
s
), 
	`°ªam_gë_ídp
 (s));

943 i‡(
ªt
 <= 0)

945 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_Áèl_îr‹
);

950 
vÆ
 = 1;

951 (Ë
	`£tsock›t
 (
≥î
->
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
,

952 (*Ë&
vÆ
,  (val));

955 
	`°ªam_£t_gëp
 (
s
, 
BGP_MARKER_SIZE
 + 2);

956 
ty≥
 = 
	`°ªam_gëc
 (
s
);

958 
	`as£π
 (
ty≥
 =
BGP_MSG_NOTIFY
);

961 
≥î
->
nŸify_out
++;

964 
≥î
->
v_°¨t
 *= 2;

967 i‡(
≥î
->
v_°¨t
 >= (60 * 2))

968 
≥î
->
v_°¨t
 = (60 * 2);

970 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

973 
	}
}

977 
	$bgp_kì∑live_£nd
 (
≥î
 *peer)

979 
°ªam
 *
s
;

980 
Àngth
;

982 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

985 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_KEEPALIVE
);

988 
Àngth
 = 
	`bgp_∑ckë_£t_size
 (
s
);

993 i‡(
	`BGP_DEBUG
 (
kì∑live
, 
KEEPALIVE
))

994 
	`zlog_debug
 ("%†£ndög KEEPALIVE", 
≥î
->
ho°
);

995 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

996 
	`zlog_debug
 ("%s send messageÅype %d,Üength (incl. header) %d",

997 
≥î
->
ho°
, 
BGP_MSG_KEEPALIVE
, 
Àngth
);

1000 
	`bgp_∑ckë_add
 (
≥î
, 
s
);

1002 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

1003 
	}
}

1007 
	$bgp_›í_£nd
 (
≥î
 *peer)

1009 
°ªam
 *
s
;

1010 
Àngth
;

1011 
u_öt16_t
 
£nd_hﬁdtime
;

1012 
as_t
 
loˇl_as
;

1014 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
))

1015 
£nd_hﬁdtime
 = 
≥î
->
hﬁdtime
;

1017 
£nd_hﬁdtime
 = 
≥î
->
bgp
->
deÁu…_hﬁdtime
;

1020 i‡(
≥î
->
ch™ge_loˇl_as
)

1021 
loˇl_as
 = 
≥î
->
ch™ge_loˇl_as
;

1023 
loˇl_as
 = 
≥î
->local_as;

1025 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

1028 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_OPEN
);

1031 
	`°ªam_putc
 (
s
, 
BGP_VERSION_4
);

1032 
	`°ªam_putw
 (
s
, (
loˇl_as
 <
BGP_AS_MAX
Ë? (
u_öt16_t
)Üocal_as

1033 : 
BGP_AS_TRANS
);

1034 
	`°ªam_putw
 (
s
, 
£nd_hﬁdtime
);

1035 
	`°ªam_put_ö_addr
 (
s
, &
≥î
->
loˇl_id
);

1038 
	`bgp_›í_ˇ∑bûôy
 (
s
, 
≥î
);

1041 
Àngth
 = 
	`bgp_∑ckë_£t_size
 (
s
);

1043 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1044 
	`zlog_debug
 ("%s sending OPEN, version %d, myás %u, holdtime %d, id %s",

1045 
≥î
->
ho°
, 
BGP_VERSION_4
, 
loˇl_as
,

1046 
£nd_hﬁdtime
, 
	`öë_¡ﬂ
 (
≥î
->
loˇl_id
));

1048 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1049 
	`zlog_debug
 ("%s send messageÅype %d,Üength (incl. header) %d",

1050 
≥î
->
ho°
, 
BGP_MSG_OPEN
, 
Àngth
);

1056 
	`bgp_∑ckë_add
 (
≥î
, 
s
);

1058 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

1059 
	}
}

1063 
	$bgp_nŸify_£nd_wôh_d©a
 (
≥î
 *≥î, 
u_ch¨
 
code
, u_ch¨ 
sub_code
,

1064 
u_ch¨
 *
d©a
, 
size_t
 
d©Æí
)

1066 
°ªam
 *
s
;

1067 
Àngth
;

1070 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

1073 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_NOTIFY
);

1076 
	`°ªam_putc
 (
s
, 
code
);

1077 
	`°ªam_putc
 (
s
, 
sub_code
);

1080 i‡(
d©a
)

1081 
	`°ªam_wrôe
 (
s
, 
d©a
, 
d©Æí
);

1084 
Àngth
 = 
	`bgp_∑ckë_£t_size
 (
s
);

1087 
	`°ªam_fifo_˛ón
 (
≥î
->
obuf
);

1088 
	`bgp_∑ckë_add
 (
≥î
, 
s
);

1092 
bgp_nŸify
 bgp_notify;

1093 
fú°
 = 0;

1094 
i
;

1095 
c
[4];

1097 
bgp_nŸify
.
code
 = code;

1098 
bgp_nŸify
.
subcode
 = 
sub_code
;

1099 
bgp_nŸify
.
d©a
 = 
NULL
;

1100 
bgp_nŸify
.
Àngth
 =Üígth - 
BGP_MSG_NOTIFY_MIN_SIZE
;

1102 i‡(
bgp_nŸify
.
Àngth
)

1104 
bgp_nŸify
.
d©a
 = 
	`XMALLOC
 (
MTYPE_TMP
, bgp_nŸify.
Àngth
 * 3);

1105 
i
 = 0; i < 
bgp_nŸify
.
Àngth
; i++)

1106 i‡(
fú°
)

1108 
	`•rötf
 (
c
, " %02x", 
d©a
[
i
]);

1109 
	`°rˇt
 (
bgp_nŸify
.
d©a
, 
c
);

1113 
fú°
 = 1;

1114 
	`•rötf
 (
c
, "%02x", 
d©a
[
i
]);

1115 
	`°r˝y
 (
bgp_nŸify
.
d©a
, 
c
);

1118 
	`bgp_nŸify_¥öt
 (
≥î
, &
bgp_nŸify
, "sending");

1119 i‡(
bgp_nŸify
.
d©a
)

1120 
	`XFREE
 (
MTYPE_TMP
, 
bgp_nŸify
.
d©a
);

1123 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1124 
	`zlog_debug
 ("%s send messageÅype %d,Üength (incl. header) %d",

1125 
≥î
->
ho°
, 
BGP_MSG_NOTIFY
, 
Àngth
);

1128 i‡(
sub_code
 !
BGP_NOTIFY_CEASE_CONFIG_CHANGE
)

1130 i‡(
sub_code
 =
BGP_NOTIFY_CEASE_ADMIN_RESET
)

1132 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_USER_RESET
;

1133 
	`zlog_öfo
 ("NŸifiˇti⁄ síàtÿ√ighb‹ %s: U£∏ª£t", 
≥î
->
ho°
);

1135 i‡(
sub_code
 =
BGP_NOTIFY_CEASE_ADMIN_SHUTDOWN
)

1137 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_USER_SHUTDOWN
;

1138 
	`zlog_öfo
 ("NŸifiˇti⁄ síàtÿ√ighb‹ %s: shutdown", 
≥î
->
ho°
);

1142 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_NOTIFY_SEND
;

1143 
	`zlog_öfo
 ("Notification sentÅoÇeighbor %s:Åype %u/%u",

1144 
≥î
->
ho°
, 
code
, 
sub_code
);

1148 
	`zlog_öfo
 ("Notification sentÅoÇeighbor %s: configuration change",

1149 
≥î
->
ho°
);

1152 
	`BGP_WRITE_OFF
 (
≥î
->
t_wrôe
);

1154 
	`bgp_wrôe_nŸify
 (
≥î
);

1155 
	}
}

1159 
	$bgp_nŸify_£nd
 (
≥î
 *≥î, 
u_ch¨
 
code
, u_ch¨ 
sub_code
)

1161 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
, 
code
, 
sub_code
, 
NULL
, 0);

1162 
	}
}

1166 
	$bgp_rouã_ª‰esh_£nd
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

1167 
u_ch¨
 
‹f_ty≥
, u_ch¨ 
whí_to_ª‰esh
, 
ªmove
)

1169 
°ªam
 *
s
;

1170 
°ªam
 *
∑ckë
;

1171 
Àngth
;

1172 
bgp_fûãr
 *
fûãr
;

1173 
‹f_ª‰esh
 = 0;

1175 i‡(
DISABLE_BGP_ANNOUNCE
)

1178 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1181 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

1182 
ßfi
 = 
SAFI_MPLS_LABELED_VPN
;

1184 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

1187 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
))

1188 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_ROUTE_REFRESH_NEW
);

1190 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_ROUTE_REFRESH_OLD
);

1193 
	`°ªam_putw
 (
s
, 
afi
);

1194 
	`°ªam_putc
 (
s
, 0);

1195 
	`°ªam_putc
 (
s
, 
ßfi
);

1197 i‡(
‹f_ty≥
 =
ORF_TYPE_PREFIX


1198 || 
‹f_ty≥
 =
ORF_TYPE_PREFIX_OLD
)

1199 i‡(
ªmove
 || 
fûãr
->
∂i°
[
FILTER_IN
].plist)

1201 
u_öt16_t
 
‹f_Àn
;

1202 
‹Â
;

1204 
‹f_ª‰esh
 = 1;

1205 
	`°ªam_putc
 (
s
, 
whí_to_ª‰esh
);

1206 
	`°ªam_putc
 (
s
, 
‹f_ty≥
);

1207 
‹Â
 = 
	`°ªam_gë_ídp
 (
s
);

1208 
	`°ªam_putw
 (
s
, 0);

1210 i‡(
ªmove
)

1212 
	`UNSET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_PREFIX_SEND
);

1213 
	`°ªam_putc
 (
s
, 
ORF_COMMON_PART_REMOVE_ALL
);

1214 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1215 
	`zlog_debug
 ("%s sending REFRESH_REQÅoÑemove ORF(%d) (%s) foráfi/safi: %d/%d",

1216 
≥î
->
ho°
, 
‹f_ty≥
,

1217 (
whí_to_ª‰esh
 =
REFRESH_DEFER
 ? "defer" : "immediate"),

1218 
afi
, 
ßfi
);

1222 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_PREFIX_SEND
);

1223 
	`¥efix_bgp_‹f_íåy
 (
s
, 
fûãr
->
∂i°
[
FILTER_IN
].plist,

1224 
ORF_COMMON_PART_ADD
, 
ORF_COMMON_PART_PERMIT
,

1225 
ORF_COMMON_PART_DENY
);

1226 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1227 
	`zlog_debug
 ("%s sending REFRESH_REQ withÖfxlist ORF(%d) (%s) foráfi/safi: %d/%d",

1228 
≥î
->
ho°
, 
‹f_ty≥
,

1229 (
whí_to_ª‰esh
 =
REFRESH_DEFER
 ? "defer" : "immediate"),

1230 
afi
, 
ßfi
);

1234 
‹f_Àn
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
‹Â
 - 2;

1235 
	`°ªam_putw_©
 (
s
, 
‹Â
, 
‹f_Àn
);

1239 
Àngth
 = 
	`bgp_∑ckë_£t_size
 (
s
);

1241 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1243 i‡(! 
‹f_ª‰esh
)

1244 
	`zlog_debug
 ("%s sending REFRESH_REQ foráfi/safi: %d/%d",

1245 
≥î
->
ho°
, 
afi
, 
ßfi
);

1246 
	`zlog_debug
 ("%s send messageÅype %d,Üength (incl. header) %d",

1247 
≥î
->
ho°
, 
	`CHECK_FLAG
 (≥î->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
) ?

1248 
BGP_MSG_ROUTE_REFRESH_NEW
 : 
BGP_MSG_ROUTE_REFRESH_OLD
, 
Àngth
);

1252 
∑ckë
 = 
	`°ªam_dup
 (
s
);

1253 
	`°ªam_‰ì
 (
s
);

1256 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

1258 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

1259 
	}
}

1263 
	$bgp_ˇ∑bûôy_£nd
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

1264 
ˇ∑bûôy_code
, 
a˘i⁄
)

1266 
°ªam
 *
s
;

1267 
°ªam
 *
∑ckë
;

1268 
Àngth
;

1271 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

1272 
ßfi
 = 
SAFI_MPLS_LABELED_VPN
;

1274 
s
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

1277 
	`bgp_∑ckë_£t_m¨kî
 (
s
, 
BGP_MSG_CAPABILITY
);

1280 i‡(
ˇ∑bûôy_code
 =
CAPABILITY_CODE_MP
)

1282 
	`°ªam_putc
 (
s
, 
a˘i⁄
);

1283 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP
);

1284 
	`°ªam_putc
 (
s
, 
CAPABILITY_CODE_MP_LEN
);

1285 
	`°ªam_putw
 (
s
, 
afi
);

1286 
	`°ªam_putc
 (
s
, 0);

1287 
	`°ªam_putc
 (
s
, 
ßfi
);

1289 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1290 
	`zlog_debug
 ("%s sending CAPABILITY has %s MP_EXT CAP foráfi/safi: %d/%d",

1291 
≥î
->
ho°
, 
a˘i⁄
 =
CAPABILITY_ACTION_SET
 ?

1292 "Advîtisög" : "Removög", 
afi
, 
ßfi
);

1296 
Àngth
 = 
	`bgp_∑ckë_£t_size
 (
s
);

1299 
∑ckë
 = 
	`°ªam_dup
 (
s
);

1300 
	`°ªam_‰ì
 (
s
);

1303 
	`bgp_∑ckë_add
 (
≥î
, 
∑ckë
);

1305 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1306 
	`zlog_debug
 ("%s send messageÅype %d,Üength (incl. header) %d",

1307 
≥î
->
ho°
, 
BGP_MSG_CAPABILITY
, 
Àngth
);

1309 
	`BGP_WRITE_ON
 (
≥î
->
t_wrôe
, 
bgp_wrôe
,Öìr->
fd
);

1310 
	}
}

1314 
	$bgp_cﬁlisi⁄_dëe˘
 (
≥î
 *
√w
, 
ö_addr
 
ªmŸe_id
)

1316 
≥î
 *peer;

1317 
li°node
 *
node
, *
¬ode
;

1318 
bgp
 *bgp;

1320 
bgp
 = 
	`bgp_gë_deÁu…
 ();

1321 i‡(! 
bgp
)

1333 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

1338 i‡(
≥î
 !
√w


1339 && (
≥î
->
°©us
 =
O≥nC⁄fúm
 ||Öìr->°©u†=
O≥nSít
)

1340 && 
	`sockuni⁄_ßme
 (&
≥î
->
su
, &
√w
->su))

1346 i‡(
	`¡ohl
 (
≥î
->
loˇl_id
.
s_addr
Ë<Çtoh»(
ªmŸe_id
.s_addr))

1354 i‡(
≥î
->
fd
 >= 0)

1355 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 
BGP_NOTIFY_CEASE_COLLISION_RESOLUTION
);

1366 i‡(
√w
->
fd
 >= 0)

1367 
	`bgp_nŸify_£nd
 (
√w
, 
BGP_NOTIFY_CEASE
,

1368 
BGP_NOTIFY_CEASE_COLLISION_RESOLUTION
);

1374 
	}
}

1377 
	$bgp_›í_ª˚ive
 (
≥î
 *≥î, 
bgp_size_t
 
size
)

1379 
ªt
;

1380 
u_ch¨
 
vîsi⁄
;

1381 
u_ch¨
 
›éí
;

1382 
u_öt16_t
 
hﬁdtime
;

1383 
u_öt16_t
 
£nd_hﬁdtime
;

1384 
as_t
 
ªmŸe_as
;

1385 
as_t
 
as4
 = 0;

1386 
≥î
 *
ªÆ≥î
;

1387 
ö_addr
 
ªmŸe_id
;

1388 
mp_ˇ∑bûôy
;

1389 
u_öt8_t
 
nŸify_d©a_ªmŸe_as
[2];

1390 
u_öt8_t
 
nŸify_d©a_ªmŸe_id
[4];

1392 
ªÆ≥î
 = 
NULL
;

1395 
vîsi⁄
 = 
	`°ªam_gëc
 (
≥î
->
ibuf
);

1396 
	`mem˝y
 (
nŸify_d©a_ªmŸe_as
, 
	`°ªam_≤t
 (
≥î
->
ibuf
), 2);

1397 
ªmŸe_as
 = 
	`°ªam_gëw
 (
≥î
->
ibuf
);

1398 
hﬁdtime
 = 
	`°ªam_gëw
 (
≥î
->
ibuf
);

1399 
	`mem˝y
 (
nŸify_d©a_ªmŸe_id
, 
	`°ªam_≤t
 (
≥î
->
ibuf
), 4);

1400 
ªmŸe_id
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
≥î
->
ibuf
);

1403 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1404 
	`zlog_debug
 ("%sÑcv OPEN, version %d,Ñemote-as (in open) %u,"

1406 
≥î
->
ho°
, 
vîsi⁄
, 
ªmŸe_as
, 
hﬁdtime
,

1407 
	`öë_¡ﬂ
 (
ªmŸe_id
));

1410 
mp_ˇ∑bûôy
 = 0;

1411 
›éí
 = 
	`°ªam_gëc
 (
≥î
->
ibuf
);

1413 i‡(
›éí
 != 0)

1419 
as4
 = 
	`≥ek_f‹_as4_ˇ∑bûôy
 (
≥î
, 
›éí
);

1423 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
Ë&& !
as4
)

1425 
	`zlog_îr
 ("%s bad OPEN, got AS4 capability, but AS4 setÅo 0",

1426 
≥î
->
ho°
);

1427 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_OPEN_ERR
,

1428 
BGP_NOTIFY_OPEN_BAD_PEER_AS
);

1432 i‡(
ªmŸe_as
 =
BGP_AS_TRANS
)

1438 i‡(
as4
 =
BGP_AS_TRANS
)

1440 
	`zlog_îr
 ("%s [AS4] NEW speaker using AS_TRANS for AS4,Çotállowed",

1441 
≥î
->
ho°
);

1442 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_OPEN_ERR
,

1443 
BGP_NOTIFY_OPEN_BAD_PEER_AS
);

1447 i‡(!
as4
 && 
	`BGP_DEBUG
 (as4, 
AS4
))

1448 
	`zlog_debug
 ("%s [AS4] OPENÑemote_as is AS_TRANS, butÇo AS4."

1449 " Odd, buà¥o˚edög.", 
≥î
->
ho°
);

1450 i‡(
as4
 < 
BGP_AS_MAX
 && 
	`BGP_DEBUG
 (as4, 
AS4
))

1451 
	`zlog_debug
 ("%s [AS4] OPENÑemote_as is AS_TRANS, but AS4 (%u) fits "

1452 "ö 2-byãs, vîy oddÖìr.", 
≥î
->
ho°
, 
as4
);

1453 i‡(
as4
)

1454 
ªmŸe_as
 = 
as4
;

1460 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_AS4_RCV
)

1461 && 
as4
 !
ªmŸe_as
)

1464 
	`zlog_îr
 ("%s bad OPEN, got AS4 capability, butÑemote_as %u"

1466 
≥î
->
ho°
, 
as4
, 
ªmŸe_as
);

1467 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_OPEN_ERR
,

1468 
BGP_NOTIFY_OPEN_BAD_PEER_AS
);

1474 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

1476 
as
 = 0;

1478 
ªÆ≥î
 = 
	`≥î_lookup_wôh_›í
 (&
≥î
->
su
, 
ªmŸe_as
, &
ªmŸe_id
, &
as
);

1480 i‡(! 
ªÆ≥î
)

1485 i‡(
as
)

1487 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1488 
	`zlog_debug
 ("%s bad OPEN, wrongÑouter identifier %s",

1489 
≥î
->
ho°
, 
	`öë_¡ﬂ
 (
ªmŸe_id
));

1490 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
, 
BGP_NOTIFY_OPEN_ERR
,

1491 
BGP_NOTIFY_OPEN_BAD_BGP_IDENT
,

1492 
nŸify_d©a_ªmŸe_id
, 4);

1496 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1497 
	`zlog_debug
 ("%s bad OPEN,Ñemote AS is %u,Éxpected %u",

1498 
≥î
->
ho°
, 
ªmŸe_as
,Öìr->
as
);

1499 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
, 
BGP_NOTIFY_OPEN_ERR
,

1500 
BGP_NOTIFY_OPEN_BAD_PEER_AS
,

1501 
nŸify_d©a_ªmŸe_as
, 2);

1509 
ªt
 = 
	`bgp_cﬁlisi⁄_dëe˘
 (
≥î
, 
ªmŸe_id
);

1510 i‡(
ªt
 < 0)

1511  
ªt
;

1514 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

1516 i‡(
ªÆ≥î
->
°©us
 =
E°ablished


1517 && 
	`CHECK_FLAG
 (
ªÆ≥î
->
sÊags
, 
PEER_STATUS_NSF_MODE
))

1519 
ªÆ≥î
->
œ°_ª£t
 = 
PEER_DOWN_NSF_CLOSE_SESSION
;

1520 
	`SET_FLAG
 (
ªÆ≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
);

1522 i‡(
ªt
 =0 && 
ªÆ≥î
->
°©us
 !
A˘ive


1523 && 
ªÆ≥î
->
°©us
 !
O≥nSít


1524 && 
ªÆ≥î
->
°©us
 !
O≥nC⁄fúm


1525 && 
ªÆ≥î
->
°©us
 !
C⁄√˘
)

1572 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

1573 
	`zlog_debug
 ("%sÖeer status is %s close connection",

1574 
ªÆ≥î
->
ho°
, 
	`LOOKUP
 (
bgp_°©us_msg
,

1575 
ªÆ≥î
->
°©us
));

1576 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

1577 
BGP_NOTIFY_CEASE_CONNECT_REJECT
);

1582 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

1583 
	`zlog_debug
 ("%s [Event] Transferáccept BGPÖeerÅoÑeal (state %s)",

1584 
≥î
->
ho°
,

1585 
	`LOOKUP
 (
bgp_°©us_msg
, 
ªÆ≥î
->
°©us
));

1587 
	`bgp_°›
 (
ªÆ≥î
);

1590 
ªÆ≥î
->
fd
 = 
≥î
->fd;

1591 
≥î
->
fd
 = -1;

1594 
	`°ªam_‰ì
 (
ªÆ≥î
->
ibuf
);

1595 
ªÆ≥î
->
ibuf
 = 
≥î
->ibuf;

1596 
ªÆ≥î
->
∑ckë_size
 = 
≥î
->packet_size;

1597 
≥î
->
ibuf
 = 
NULL
;

1600 
ªÆ≥î
->
°©us
 = 
≥î
->status;

1601 
	`bgp_°›
 (
≥î
);

1604 
≥î
 = 
ªÆ≥î
;

1605 
	`bgp_›í_£nd
 (
≥î
);

1606 i‡(
≥î
->
fd
 < 0)

1608 
	`zlog_îr
 ("bgp_open_receiveÖeer's fd isÇegative value %d",

1609 
≥î
->
fd
);

1612 
	`BGP_READ_ON
 (
≥î
->
t_ªad
, 
bgp_ªad
,Öìr->
fd
);

1616 i‡(
ªmŸe_id
.
s_addr
 == 0

1617 || 
	`IPV4_CLASS_DE
 (
	`¡ohl
 (
ªmŸe_id
.
s_addr
))

1618 || 
	`¡ohl
 (
≥î
->
loˇl_id
.
s_addr
Ë=¡oh»(
ªmŸe_id
.s_addr))

1620 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1621 
	`zlog_debug
 ("%s bad OPEN, wrongÑouter identifier %s",

1622 
≥î
->
ho°
, 
	`öë_¡ﬂ
 (
ªmŸe_id
));

1623 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

1624 
BGP_NOTIFY_OPEN_ERR
,

1625 
BGP_NOTIFY_OPEN_BAD_BGP_IDENT
,

1626 
nŸify_d©a_ªmŸe_id
, 4);

1631 
≥î
->
ªmŸe_id
 =Ñemote_id;

1634 i‡(
vîsi⁄
 !
BGP_VERSION_4
)

1636 
u_öt16_t
 
maxvî
 = 
	`ht⁄s
(
BGP_VERSION_4
);

1638 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1639 
	`zlog_debug
 ("%s badÖrotocol version,ÑemoteÑequested %d,ÜocalÑequest %d",

1640 
≥î
->
ho°
, 
vîsi⁄
, 
BGP_VERSION_4
);

1642 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

1643 
BGP_NOTIFY_OPEN_ERR
,

1644 
BGP_NOTIFY_OPEN_UNSUP_VERSION
,

1645 (
u_öt8_t
 *Ë&
maxvî
, 2);

1650 i‡(
ªmŸe_as
 !
≥î
->
as
)

1652 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1653 
	`zlog_debug
 ("%s bad OPEN,Ñemote AS is %u,Éxpected %u",

1654 
≥î
->
ho°
, 
ªmŸe_as
,Öìr->
as
);

1655 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

1656 
BGP_NOTIFY_OPEN_ERR
,

1657 
BGP_NOTIFY_OPEN_BAD_PEER_AS
,

1658 
nŸify_d©a_ªmŸe_as
, 2);

1668 i‡(
hﬁdtime
 < 3 && holdtime != 0)

1670 
	`bgp_nŸify_£nd
 (
≥î
,

1671 
BGP_NOTIFY_OPEN_ERR
,

1672 
BGP_NOTIFY_OPEN_UNACEP_HOLDTIME
);

1682 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
))

1683 
£nd_hﬁdtime
 = 
≥î
->
hﬁdtime
;

1685 
£nd_hﬁdtime
 = 
≥î
->
bgp
->
deÁu…_hﬁdtime
;

1687 i‡(
hﬁdtime
 < 
£nd_hﬁdtime
)

1688 
≥î
->
v_hﬁdtime
 = 
hﬁdtime
;

1690 
≥î
->
v_hﬁdtime
 = 
£nd_hﬁdtime
;

1692 
≥î
->
v_kì∑live
 =Öìr->
v_hﬁdtime
 / 3;

1695 i‡(
›éí
 != 0)

1697 i‡((
ªt
 = 
	`bgp_›í_›ti⁄_∑r£
 (
≥î
, 
›éí
, &
mp_ˇ∑bûôy
)) < 0)

1699 
	`bgp_nŸify_£nd
 (
≥î
,

1700 
BGP_NOTIFY_OPEN_ERR
,

1701 
BGP_NOTIFY_OPEN_UNACEP_HOLDTIME
);

1702  
ªt
;

1707 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1708 
	`zlog_debug
 ("%sÑcvd OPEN w/ OPTIONÖarameterÜen: 0",

1709 
≥î
->
ho°
);

1717 i‡(! 
mp_ˇ∑bûôy
 ||

1718 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_OVERRIDE_CAPABILITY
))

1720 
≥î
->
afc_√go
[
AFI_IP
][
SAFI_UNICAST
] =Öìr->
afc
[AFI_IP][SAFI_UNICAST];

1721 
≥î
->
afc_√go
[
AFI_IP
][
SAFI_MULTICAST
] =Öìr->
afc
[AFI_IP][SAFI_MULTICAST];

1722 
≥î
->
afc_√go
[
AFI_IP6
][
SAFI_UNICAST
] =Öìr->
afc
[AFI_IP6][SAFI_UNICAST];

1723 
≥î
->
afc_√go
[
AFI_IP6
][
SAFI_MULTICAST
] =Öìr->
afc
[AFI_IP6][SAFI_MULTICAST];

1727 
	`bgp_gësock«me
 (
≥î
);

1729 
	`BGP_EVENT_ADD
 (
≥î
, 
Re˚ive_OPEN_mesßge
);

1731 
≥î
->
∑ckë_size
 = 0;

1732 i‡(
≥î
->
ibuf
)

1733 
	`°ªam_ª£t
 (
≥î
->
ibuf
);

1736 
	}
}

1740 
	$bgp_upd©e_ª˚ive
 (
≥î
 *≥î, 
bgp_size_t
 
size
)

1742 
ªt
;

1743 
u_ch¨
 *
íd
;

1744 
°ªam
 *
s
;

1745 
©å
áttr;

1746 
©å_exåa
 
exåa
;

1747 
bgp_size_t
 
©åibuã_Àn
;

1748 
bgp_size_t
 
upd©e_Àn
;

1749 
bgp_size_t
 
wôhdøw_Àn
;

1750 
bgp_∆ri
 
upd©e
;

1751 
bgp_∆ri
 
wôhdøw
;

1752 
bgp_∆ri
 
mp_upd©e
;

1753 
bgp_∆ri
 
mp_wôhdøw
;

1756 i‡(
≥î
->
°©us
 !
E°ablished
)

1758 
	`zlog_îr
 ("%s [FSM] UpdateÖacketÑeceived under status %s",

1759 
≥î
->
ho°
, 
	`LOOKUP
 (
bgp_°©us_msg
,Öìr->
°©us
));

1760 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_FSM_ERR
, 0);

1765 
	`mem£t
 (&
©å
, 0,  (attr));

1766 
	`mem£t
 (&
exåa
, 0,  (
©å_exåa
));

1767 
	`mem£t
 (&
upd©e
, 0,  (
bgp_∆ri
));

1768 
	`mem£t
 (&
wôhdøw
, 0,  (
bgp_∆ri
));

1769 
	`mem£t
 (&
mp_upd©e
, 0,  (
bgp_∆ri
));

1770 
	`mem£t
 (&
mp_wôhdøw
, 0,  (
bgp_∆ri
));

1771 
©å
.
exåa
 = &extra;

1773 
s
 = 
≥î
->
ibuf
;

1774 
íd
 = 
	`°ªam_≤t
 (
s
Ë+ 
size
;

1780 i‡(
	`°ªam_≤t
 (
s
Ë+ 2 > 
íd
)

1782 
	`zlog_îr
 ("%s [Error] UpdateÖacketÉrror"

1784 
≥î
->
ho°
);

1785 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

1786 
BGP_NOTIFY_UPDATE_MAL_ATTR
);

1791 
wôhdøw_Àn
 = 
	`°ªam_gëw
 (
s
);

1794 i‡(
	`°ªam_≤t
 (
s
Ë+ 
wôhdøw_Àn
 > 
íd
)

1796 
	`zlog_îr
 ("%s [Error] UpdateÖacketÉrror"

1798 
≥î
->
ho°
, 
wôhdøw_Àn
);

1799 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

1800 
BGP_NOTIFY_UPDATE_MAL_ATTR
);

1805 i‡(
wôhdøw_Àn
 > 0)

1807 
ªt
 = 
	`bgp_∆ri_ßnôy_check
 (
≥î
, 
AFI_IP
, 
	`°ªam_≤t
 (
s
), 
wôhdøw_Àn
);

1808 i‡(
ªt
 < 0)

1811 i‡(
	`BGP_DEBUG
 (
∑ckë
, 
PACKET_RECV
))

1812 
	`zlog_debug
 ("%†[Upd©e:RECV] Un„asibÀ NLRIÑe˚ived", 
≥î
->
ho°
);

1814 
wôhdøw
.
afi
 = 
AFI_IP
;

1815 
wôhdøw
.
ßfi
 = 
SAFI_UNICAST
;

1816 
wôhdøw
.
∆ri
 = 
	`°ªam_≤t
 (
s
);

1817 
wôhdøw
.
Àngth
 = 
wôhdøw_Àn
;

1818 
	`°ªam_f‹w¨d_gëp
 (
s
, 
wôhdøw_Àn
);

1822 i‡(
	`°ªam_≤t
 (
s
Ë+ 2 > 
íd
)

1824 
	`zlog_w¨n
 ("%s [Error] Packet Error"

1826 
≥î
->
ho°
);

1827 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

1828 
BGP_NOTIFY_UPDATE_MAL_ATTR
);

1833 
©åibuã_Àn
 = 
	`°ªam_gëw
 (
s
);

1836 i‡(
	`°ªam_≤t
 (
s
Ë+ 
©åibuã_Àn
 > 
íd
)

1838 
	`zlog_w¨n
 ("%s [Error] Packet Error"

1840 
≥î
->
ho°
, 
©åibuã_Àn
);

1841 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

1842 
BGP_NOTIFY_UPDATE_MAL_ATTR
);

1853 
bgp_©å_∑r£_ªt_t
 
©å_∑r£_ªt
 = 
BGP_ATTR_PARSE_PROCEED
;

1857 
	#NLRI_ATTR_ARG
 (
©å_∑r£_ªt
 !
BGP_ATTR_PARSE_WITHDRAW
 ? &
©å
 : 
NULL
)

	)

1860 i‡(
©åibuã_Àn
)

1862 
©å_∑r£_ªt
 = 
	`bgp_©å_∑r£
 (
≥î
, &
©å
, 
©åibuã_Àn
,

1863 &
mp_upd©e
, &
mp_wôhdøw
);

1864 i‡(
©å_∑r£_ªt
 =
BGP_ATTR_PARSE_ERROR
)

1869 i‡(
©å_∑r£_ªt
 =
BGP_ATTR_PARSE_WITHDRAW


1870 || 
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

1872 
©å°r
[
BUFSIZ
];

1873 
©å°r
[0] = '\0';

1875 
ªt

	`bgp_dump_©å
 (
≥î
, &
©å
, 
©å°r
, 
BUFSIZ
);

1876 
lvl
 = (
©å_∑r£_ªt
 =
BGP_ATTR_PARSE_WITHDRAW
)

1877 ? 
LOG_ERR
 : 
LOG_DEBUG
;

1879 i‡(
©å_∑r£_ªt
 =
BGP_ATTR_PARSE_WITHDRAW
)

1880 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

1882 
≥î
->
ho°
);

1884 i‡(
ªt
)

1885 
	`zlog
 (
≥î
->
log
, 
lvl
, "%sÑcvd UPDATE w/áttr: %s",

1886 
≥î
->
ho°
, 
©å°r
);

1890 
upd©e_Àn
 = 
íd
 - 
	`°ªam_≤t
 (
s
);

1892 i‡(
upd©e_Àn
)

1895 
ªt
 = 
	`bgp_∆ri_ßnôy_check
 (
≥î
, 
AFI_IP
, 
	`°ªam_≤t
 (
s
), 
upd©e_Àn
);

1896 i‡(
ªt
 < 0)

1898 
	`bgp_©å_unöã∫_sub
 (&
©å
);

1903 
upd©e
.
afi
 = 
AFI_IP
;

1904 
upd©e
.
ßfi
 = 
SAFI_UNICAST
;

1905 
upd©e
.
∆ri
 = 
	`°ªam_≤t
 (
s
);

1906 
upd©e
.
Àngth
 = 
upd©e_Àn
;

1907 
	`°ªam_f‹w¨d_gëp
 (
s
, 
upd©e_Àn
);

1912 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_UNICAST
])

1914 i‡(
wôhdøw
.
Àngth
)

1915 
	`bgp_∆ri_∑r£
 (
≥î
, 
NULL
, &
wôhdøw
);

1917 i‡(
upd©e
.
Àngth
)

1921 
ªt
 = 
	`bgp_©å_check
 (
≥î
, &
©å
);

1922 i‡(
ªt
 < 0)

1924 
	`bgp_©å_unöã∫_sub
 (&
©å
);

1928 
	`bgp_∆ri_∑r£
 (
≥î
, 
NLRI_ATTR_ARG
, &
upd©e
);

1931 i‡(
mp_upd©e
.
Àngth


1932 && 
mp_upd©e
.
afi
 =
AFI_IP


1933 && 
mp_upd©e
.
ßfi
 =
SAFI_UNICAST
)

1934 
	`bgp_∆ri_∑r£
 (
≥î
, 
NLRI_ATTR_ARG
, &
mp_upd©e
);

1936 i‡(
mp_wôhdøw
.
Àngth


1937 && 
mp_wôhdøw
.
afi
 =
AFI_IP


1938 && 
mp_wôhdøw
.
ßfi
 =
SAFI_UNICAST
)

1939 
	`bgp_∆ri_∑r£
 (
≥î
, 
NULL
, &
mp_wôhdøw
);

1941 i‡(! 
©åibuã_Àn
 && ! 
wôhdøw_Àn
)

1944 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
AFI_IP
][
SAFI_UNICAST
],

1945 
PEER_STATUS_EOR_RECEIVED
);

1948 i‡(
≥î
->
nsf
[
AFI_IP
][
SAFI_UNICAST
])

1949 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
AFI_IP
, 
SAFI_UNICAST
);

1951 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1952 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "rcvd End-of-RIB for IPv4 Unicast from %s",

1953 
≥î
->
ho°
);

1956 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_MULTICAST
])

1958 i‡(
mp_upd©e
.
Àngth


1959 && 
mp_upd©e
.
afi
 =
AFI_IP


1960 && 
mp_upd©e
.
ßfi
 =
SAFI_MULTICAST
)

1961 
	`bgp_∆ri_∑r£
 (
≥î
, 
NLRI_ATTR_ARG
, &
mp_upd©e
);

1963 i‡(
mp_wôhdøw
.
Àngth


1964 && 
mp_wôhdøw
.
afi
 =
AFI_IP


1965 && 
mp_wôhdøw
.
ßfi
 =
SAFI_MULTICAST
)

1966 
	`bgp_∆ri_∑r£
 (
≥î
, 
NULL
, &
mp_wôhdøw
);

1968 i‡(! 
wôhdøw_Àn


1969 && 
mp_wôhdøw
.
afi
 =
AFI_IP


1970 && 
mp_wôhdøw
.
ßfi
 =
SAFI_MULTICAST


1971 && 
mp_wôhdøw
.
Àngth
 == 0)

1974 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
AFI_IP
][
SAFI_MULTICAST
],

1975 
PEER_STATUS_EOR_RECEIVED
);

1978 i‡(
≥î
->
nsf
[
AFI_IP
][
SAFI_MULTICAST
])

1979 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
AFI_IP
, 
SAFI_MULTICAST
);

1981 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

1982 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "rcvd End-of-RIB for IPv4 Multicast from %s",

1983 
≥î
->
ho°
);

1986 i‡(
≥î
->
afc
[
AFI_IP6
][
SAFI_UNICAST
])

1988 i‡(
mp_upd©e
.
Àngth


1989 && 
mp_upd©e
.
afi
 =
AFI_IP6


1990 && 
mp_upd©e
.
ßfi
 =
SAFI_UNICAST
)

1991 
	`bgp_∆ri_∑r£
 (
≥î
, 
NLRI_ATTR_ARG
, &
mp_upd©e
);

1993 i‡(
mp_wôhdøw
.
Àngth


1994 && 
mp_wôhdøw
.
afi
 =
AFI_IP6


1995 && 
mp_wôhdøw
.
ßfi
 =
SAFI_UNICAST
)

1996 
	`bgp_∆ri_∑r£
 (
≥î
, 
NULL
, &
mp_wôhdøw
);

1998 i‡(! 
wôhdøw_Àn


1999 && 
mp_wôhdøw
.
afi
 =
AFI_IP6


2000 && 
mp_wôhdøw
.
ßfi
 =
SAFI_UNICAST


2001 && 
mp_wôhdøw
.
Àngth
 == 0)

2004 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
AFI_IP6
][
SAFI_UNICAST
], 
PEER_STATUS_EOR_RECEIVED
);

2007 i‡(
≥î
->
nsf
[
AFI_IP6
][
SAFI_UNICAST
])

2008 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
AFI_IP6
, 
SAFI_UNICAST
);

2010 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2011 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "rcvd End-of-RIB for IPv6 Unicast from %s",

2012 
≥î
->
ho°
);

2015 i‡(
≥î
->
afc
[
AFI_IP6
][
SAFI_MULTICAST
])

2017 i‡(
mp_upd©e
.
Àngth


2018 && 
mp_upd©e
.
afi
 =
AFI_IP6


2019 && 
mp_upd©e
.
ßfi
 =
SAFI_MULTICAST
)

2020 
	`bgp_∆ri_∑r£
 (
≥î
, 
NLRI_ATTR_ARG
, &
mp_upd©e
);

2022 i‡(
mp_wôhdøw
.
Àngth


2023 && 
mp_wôhdøw
.
afi
 =
AFI_IP6


2024 && 
mp_wôhdøw
.
ßfi
 =
SAFI_MULTICAST
)

2025 
	`bgp_∆ri_∑r£
 (
≥î
, 
NULL
, &
mp_wôhdøw
);

2027 i‡(! 
wôhdøw_Àn


2028 && 
mp_wôhdøw
.
afi
 =
AFI_IP6


2029 && 
mp_wôhdøw
.
ßfi
 =
SAFI_MULTICAST


2030 && 
mp_wôhdøw
.
Àngth
 == 0)

2035 i‡(
≥î
->
nsf
[
AFI_IP6
][
SAFI_MULTICAST
])

2036 
	`bgp_˛ór_°Æe_rouã
 (
≥î
, 
AFI_IP6
, 
SAFI_MULTICAST
);

2038 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

2039 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "rcvd End-of-RIB for IPv6 Multicast from %s",

2040 
≥î
->
ho°
);

2043 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_MPLS_VPN
])

2045 i‡(
mp_upd©e
.
Àngth


2046 && 
mp_upd©e
.
afi
 =
AFI_IP


2047 && 
mp_upd©e
.
ßfi
 =
SAFI_MPLS_LABELED_VPN
)

2048 
	`bgp_∆ri_∑r£_v≤v4
 (
≥î
, 
NLRI_ATTR_ARG
, &
mp_upd©e
);

2050 i‡(
mp_wôhdøw
.
Àngth


2051 && 
mp_wôhdøw
.
afi
 =
AFI_IP


2052 && 
mp_wôhdøw
.
ßfi
 =
SAFI_MPLS_LABELED_VPN
)

2053 
	`bgp_∆ri_∑r£_v≤v4
 (
≥î
, 
NULL
, &
mp_wôhdøw
);

2055 i‡(! 
wôhdøw_Àn


2056 && 
mp_wôhdøw
.
afi
 =
AFI_IP


2057 && 
mp_wôhdøw
.
ßfi
 =
SAFI_MPLS_LABELED_VPN


2058 && 
mp_wôhdøw
.
Àngth
 == 0)

2062 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

2063 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "rcvd End-of-RIB for VPNv4 Unicast from %s",

2064 
≥î
->
ho°
);

2070 
	`bgp_©å_unöã∫_sub
 (&
©å
);

2074 i‡(
≥î
->
°©us
 !
E°ablished
)

2078 
≥î
->
upd©e_ö
++;

2079 
≥î
->
upd©e_time
 = 
	`bgp_˛ock
 ();

2082 
	`BGP_TIMER_OFF
 (
≥î
->
t_hﬁdtime
);

2083 
	`bgp_timî_£t
 (
≥î
);

2086 
	}
}

2090 
	$bgp_nŸify_ª˚ive
 (
≥î
 *≥î, 
bgp_size_t
 
size
)

2092 
bgp_nŸify
 bgp_notify;

2094 i‡(
≥î
->
nŸify
.
d©a
)

2096 
	`XFREE
 (
MTYPE_TMP
, 
≥î
->
nŸify
.
d©a
);

2097 
≥î
->
nŸify
.
d©a
 = 
NULL
;

2098 
≥î
->
nŸify
.
Àngth
 = 0;

2101 
bgp_nŸify
.
code
 = 
	`°ªam_gëc
 (
≥î
->
ibuf
);

2102 
bgp_nŸify
.
subcode
 = 
	`°ªam_gëc
 (
≥î
->
ibuf
);

2103 
bgp_nŸify
.
Àngth
 = 
size
 - 2;

2104 
bgp_nŸify
.
d©a
 = 
NULL
;

2107 
≥î
->
nŸify
.
code
 = 
bgp_nŸify
.code;

2108 
≥î
->
nŸify
.
subcode
 = 
bgp_nŸify
.subcode;

2110 i‡(
bgp_nŸify
.
Àngth
)

2112 
≥î
->
nŸify
.
Àngth
 = 
size
 - 2;

2113 
≥î
->
nŸify
.
d©a
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
size
 - 2);

2114 
	`mem˝y
 (
≥î
->
nŸify
.
d©a
, 
	`°ªam_≤t
 (≥î->
ibuf
), 
size
 - 2);

2119 
i
;

2120 
fú°
 = 0;

2121 
c
[4];

2123 i‡(
bgp_nŸify
.
Àngth
)

2125 
bgp_nŸify
.
d©a
 = 
	`XMALLOC
 (
MTYPE_TMP
, bgp_nŸify.
Àngth
 * 3);

2126 
i
 = 0; i < 
bgp_nŸify
.
Àngth
; i++)

2127 i‡(
fú°
)

2129 
	`•rötf
 (
c
, " %02x", 
	`°ªam_gëc
 (
≥î
->
ibuf
));

2130 
	`°rˇt
 (
bgp_nŸify
.
d©a
, 
c
);

2134 
fú°
 = 1;

2135 
	`•rötf
 (
c
, "%02x", 
	`°ªam_gëc
 (
≥î
->
ibuf
));

2136 
	`°r˝y
 (
bgp_nŸify
.
d©a
, 
c
);

2140 
	`bgp_nŸify_¥öt
(
≥î
, &
bgp_nŸify
, "received");

2141 i‡(
bgp_nŸify
.
d©a
)

2142 
	`XFREE
 (
MTYPE_TMP
, 
bgp_nŸify
.
d©a
);

2146 
≥î
->
nŸify_ö
++;

2148 i‡(
≥î
->
°©us
 =
E°ablished
)

2149 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_NOTIFY_RECEIVED
;

2155 i‡(
bgp_nŸify
.
code
 =
BGP_NOTIFY_OPEN_ERR
 &&

2156 
bgp_nŸify
.
subcode
 =
BGP_NOTIFY_OPEN_UNSUP_PARAM
 )

2157 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_CAPABILITY_OPEN
);

2159 
	`BGP_EVENT_ADD
 (
≥î
, 
Re˚ive_NOTIFICATION_mesßge
);

2160 
	}
}

2164 
	$bgp_kì∑live_ª˚ive
 (
≥î
 *≥î, 
bgp_size_t
 
size
)

2166 i‡(
	`BGP_DEBUG
 (
kì∑live
, 
KEEPALIVE
))

2167 
	`zlog_debug
 ("%†KEEPALIVEÑcvd", 
≥î
->
ho°
);

2169 
	`BGP_EVENT_ADD
 (
≥î
, 
Re˚ive_KEEPALIVE_mesßge
);

2170 
	}
}

2174 
	$bgp_rouã_ª‰esh_ª˚ive
 (
≥î
 *≥î, 
bgp_size_t
 
size
)

2176 
afi_t
 
afi
;

2177 
ßfi_t
 
ßfi
;

2178 
u_ch¨
 
ª£rved
;

2179 
°ªam
 *
s
;

2182 i‡(! 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_ADV
))

2184 
	`∂og_îr
 (
≥î
->
log
, "%s [Error] BGPÑouteÑefresh isÇotÉnabled",

2185 
≥î
->
ho°
);

2186 
	`bgp_nŸify_£nd
 (
≥î
,

2187 
BGP_NOTIFY_HEADER_ERR
,

2188 
BGP_NOTIFY_HEADER_BAD_MESTYPE
);

2193 i‡(
≥î
->
°©us
 !
E°ablished
)

2195 
	`∂og_îr
 (
≥î
->
log
,

2197 
≥î
->
ho°
, 
	`LOOKUP
 (
bgp_°©us_msg
,Öìr->
°©us
));

2198 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_FSM_ERR
, 0);

2202 
s
 = 
≥î
->
ibuf
;

2205 
afi
 = 
	`°ªam_gëw
 (
s
);

2206 
ª£rved
 = 
	`°ªam_gëc
 (
s
);

2207 
ßfi
 = 
	`°ªam_gëc
 (
s
);

2209 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2210 
	`zlog_debug
 ("%sÑcvd REFRESH_REQ foráfi/safi: %d/%d",

2211 
≥î
->
ho°
, 
afi
, 
ßfi
);

2214 i‡((
afi
 !
AFI_IP
 &&áfò!
AFI_IP6
)

2215 || (
ßfi
 !
SAFI_UNICAST
 && safò!
SAFI_MULTICAST


2216 && 
ßfi
 !
SAFI_MPLS_LABELED_VPN
))

2218 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2220 
	`zlog_debug
 ("%s REFRESH_REQ for unrecognizedáfi/safi: %d/%d - ignored",

2221 
≥î
->
ho°
, 
afi
, 
ßfi
);

2227 i‡(
ßfi
 =
SAFI_MPLS_LABELED_VPN
)

2228 
ßfi
 = 
SAFI_MPLS_VPN
;

2230 i‡(
size
 !
BGP_MSG_ROUTE_REFRESH_MIN_SIZE
 - 
BGP_HEADER_SIZE
)

2232 
u_ch¨
 *
íd
;

2233 
u_ch¨
 
whí_to_ª‰esh
;

2234 
u_ch¨
 
‹f_ty≥
;

2235 
u_öt16_t
 
‹f_Àn
;

2237 i‡(
size
 - (
BGP_MSG_ROUTE_REFRESH_MIN_SIZE
 - 
BGP_HEADER_SIZE
) < 5)

2239 
	`zlog_öfo
 ("%†ORFÑouãÑe‰eshÜígthÉº‹", 
≥î
->
ho°
);

2240 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

2244 
whí_to_ª‰esh
 = 
	`°ªam_gëc
 (
s
);

2245 
íd
 = 
	`°ªam_≤t
 (
s
Ë+ (
size
 - 5);

2247 (
	`°ªam_≤t
 (
s
Ë+ 2Ë< 
íd
)

2249 
‹f_ty≥
 = 
	`°ªam_gëc
 (
s
);

2250 
‹f_Àn
 = 
	`°ªam_gëw
 (
s
);

2253 i‡((
	`°ªam_≤t
 (
s
Ë+ 
‹f_Àn
Ë> 
íd
)

2255 i‡(
‹f_ty≥
 =
ORF_TYPE_PREFIX


2256 || 
‹f_ty≥
 =
ORF_TYPE_PREFIX_OLD
)

2258 
u_ch¨
 *
p_≤t
 = 
	`°ªam_≤t
 (
s
);

2259 
u_ch¨
 *
p_íd
 = 
	`°ªam_≤t
 (
s
Ë+ 
‹f_Àn
;

2260 
‹f_¥efix
 
‹Â
;

2261 
u_ch¨
 
comm⁄
 = 0;

2262 
u_öt32_t
 
£q
;

2263 
psize
;

2264 
«me
[
BUFSIZ
];

2265 
ªt
;

2267 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2269 
	`zlog_debug
 ("%sÑcvd Prefixlist ORF(%d)Üength %d",

2270 
≥î
->
ho°
, 
‹f_ty≥
, 
‹f_Àn
);

2276 i‡(
‹f_Àn
 < 7)

2280 
	`•rötf
 (
«me
, "%s.%d.%d", 
≥î
->
ho°
, 
afi
, 
ßfi
);

2282 
p_≤t
 < 
p_íd
)

2288 
ok
;

2289 
	`mem£t
 (&
‹Â
, 0,  (
‹f_¥efix
));

2290 
comm⁄
 = *
p_≤t
++;

2292 i‡(
comm⁄
 & 
ORF_COMMON_PART_REMOVE_ALL
)

2294 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2295 
	`zlog_debug
 ("%†rcvd Remove-AŒÖfxli° ORFÑeque°", 
≥î
->
ho°
);

2296 
	`¥efix_bgp_‹f_ªmove_Æl
 (
«me
);

2299 
ok
 = ((
p_íd
 - 
p_≤t
Ë>(
u_öt32_t
)) ;

2300 i‡(
ok
)

2302 
	`mem˝y
 (&
£q
, 
p_≤t
,  (
u_öt32_t
));

2303 
p_≤t
 + (
u_öt32_t
);

2304 
‹Â
.
£q
 = 
	`¡ohl
 (seq);

2307 
p_≤t
 = 
p_íd
 ;

2309 i‡((
ok
 = (
p_≤t
 < 
p_íd
)))

2310 
‹Â
.
ge
 = *
p_≤t
++ ;

2311 i‡((
ok
 = (
p_≤t
 < 
p_íd
)))

2312 
‹Â
.
À
 = *
p_≤t
++ ;

2313 i‡((
ok
 = (
p_≤t
 < 
p_íd
)))

2314 
‹Â
.
p
.
¥efixÀn
 = *
p_≤t
++ ;

2315 
‹Â
.
p
.
Ámûy
 = 
	`afi2Ámûy
 (
afi
);

2317 
psize
 = 
	`PSIZE
 (
‹Â
.
p
.
¥efixÀn
);

2318 i‡(
psize
 > 
	`¥efix_bÀn
(&
‹Â
.
p
))

2320 
ok
 = 0 ;

2321 
psize
 = 
	`¥efix_bÀn
(&
‹Â
.
p
) ;

2323 i‡(
psize
 > (
p_íd
 - 
p_≤t
))

2325 
ok
 = 0 ;

2326 
psize
 = 
p_íd
 - 
p_≤t
 ;

2329 i‡(
psize
 > 0)

2330 
	`mem˝y
 (&
‹Â
.
p
.
u
.
¥efix
, 
p_≤t
, 
psize
);

2331 
p_≤t
 +
psize
;

2333 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2335 
buf
[
INET6_BUFSIZ
];

2337 
	`zlog_debug
 ("%sÑcvd %s %s seq %u %s/%d ge %dÜe %d%s",

2338 
≥î
->
ho°
,

2339 (
comm⁄
 & 
ORF_COMMON_PART_REMOVE
 ? "Remove" : "Add"),

2340 (
comm⁄
 & 
ORF_COMMON_PART_DENY
 ? "deny" : "permit"),

2341 
‹Â
.
£q
,

2342 
	`öë_¡›
 (
‹Â
.
p
.
Ámûy
, &‹Â.p.
u
.
¥efix
, 
buf
, 
INET6_BUFSIZ
),

2343 
‹Â
.
p
.
¥efixÀn
, orÂ.
ge
, orÂ.
À
,

2344 
ok
 ? "" : " MALFORMED");

2347 i‡(
ok
)

2348 
ªt
 = 
	`¥efix_bgp_‹f_£t
 (
«me
, 
afi
, &
‹Â
,

2349 (
comm⁄
 & 
ORF_COMMON_PART_DENY
 ? 0 : 1 ),

2350 (
comm⁄
 & 
ORF_COMMON_PART_REMOVE
 ? 0 : 1));

2352 i‡(!
ok
 || (
ªt
 !
CMD_SUCCESS
))

2354 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2355 
	`zlog_debug
 ("%s Received misformattedÖrefixlist ORF."

2356 " RemovêAŒÖfxli°", 
≥î
->
ho°
);

2357 
	`¥efix_bgp_‹f_ªmove_Æl
 (
«me
);

2361 
≥î
->
‹f_∂i°
[
afi
][
ßfi
] =

2362 
	`¥efix_li°_lookup
 (
AFI_ORF_PREFIX
, 
«me
);

2364 
	`°ªam_f‹w¨d_gëp
 (
s
, 
‹f_Àn
);

2366 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2367 
	`zlog_debug
 ("%†rcvd Re‰esh %†ORFÑeque°", 
≥î
->
ho°
,

2368 
whí_to_ª‰esh
 =
REFRESH_DEFER
 ? "Defer" : "Immediate");

2369 i‡(
whí_to_ª‰esh
 =
REFRESH_DEFER
)

2374 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_WAIT_REFRESH
))

2375 
	`UNSET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_WAIT_REFRESH
);

2378 
	`bgp_™noun˚_rouã
 (
≥î
, 
afi
, 
ßfi
);

2379 
	}
}

2382 
	$bgp_ˇ∑bûôy_msg_∑r£
 (
≥î
 *≥î, 
u_ch¨
 *
≤t
, 
bgp_size_t
 
Àngth
)

2384 
u_ch¨
 *
íd
;

2385 
ˇ∑bûôy_mp_d©a
 
mpc
;

2386 
ˇ∑bûôy_hódî
 *
hdr
;

2387 
u_ch¨
 
a˘i⁄
;

2388 
bgp
 *bgp;

2389 
afi_t
 
afi
;

2390 
ßfi_t
 
ßfi
;

2392 
bgp
 = 
≥î
->bgp;

2393 
íd
 = 
≤t
 + 
Àngth
;

2395 
≤t
 < 
íd
)

2398 i‡(
≤t
 + 3 > 
íd
)

2400 
	`zlog_öfo
 ("%†C≠abûôyÜígthÉº‹", 
≥î
->
ho°
);

2401 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

2404 
a˘i⁄
 = *
≤t
;

2405 
hdr
 = (
ˇ∑bûôy_hódî
 *)(
≤t
 + 1);

2408 i‡(
a˘i⁄
 !
CAPABILITY_ACTION_SET


2409 && 
a˘i⁄
 !
CAPABILITY_ACTION_UNSET
)

2411 
	`zlog_öfo
 ("%s Capability Action ValueÉrror %d",

2412 
≥î
->
ho°
, 
a˘i⁄
);

2413 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

2417 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2418 
	`zlog_debug
 ("%s CAPABILITY hasáction: %d, code: %u,Üength %u",

2419 
≥î
->
ho°
, 
a˘i⁄
, 
hdr
->
code
, hdr->
Àngth
);

2422 i‡((
≤t
 + 
hdr
->
Àngth
 + 3Ë> 
íd
)

2424 
	`zlog_öfo
 ("%†C≠abûôyÜígthÉº‹", 
≥î
->
ho°
);

2425 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 0);

2430 
	`mem˝y
 (&
mpc
, 
≤t
 + 3,  (
ˇ∑bûôy_mp_d©a
));

2433 i‡(
hdr
->
code
 =
CAPABILITY_CODE_MP
)

2435 
afi
 = 
	`¡ohs
 (
mpc
.afi);

2436 
ßfi
 = 
mpc
.safi;

2439 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_OVERRIDE_CAPABILITY
))

2442 i‡(!
	`bgp_afi_ßfi_vÆid_ödi˚s
 (
afi
, &
ßfi
))

2444 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2445 
	`zlog_debug
 ("%s Dynamic Capability MP_EXTáfi/safi invalid "

2446 "(%u/%u)", 
≥î
->
ho°
, 
afi
, 
ßfi
);

2451 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2452 
	`zlog_debug
 ("%s CAPABILITY has %s MP_EXT CAP foráfi/safi: %u/%u",

2453 
≥î
->
ho°
,

2454 
a˘i⁄
 =
CAPABILITY_ACTION_SET


2456 
	`¡ohs
(
mpc
.
afi
Ë, mpc.
ßfi
);

2458 i‡(
a˘i⁄
 =
CAPABILITY_ACTION_SET
)

2460 
≥î
->
afc_ªcv
[
afi
][
ßfi
] = 1;

2461 i‡(
≥î
->
afc
[
afi
][
ßfi
])

2463 
≥î
->
afc_√go
[
afi
][
ßfi
] = 1;

2464 
	`bgp_™noun˚_rouã
 (
≥î
, 
afi
, 
ßfi
);

2469 
≥î
->
afc_ªcv
[
afi
][
ßfi
] = 0;

2470 
≥î
->
afc_√go
[
afi
][
ßfi
] = 0;

2472 i‡(
	`≥î_a˘ive_√go
 (
≥î
))

2473 
	`bgp_˛ór_rouã
 (
≥î
, 
afi
, 
ßfi
, 
BGP_CLEAR_ROUTE_NORMAL
);

2475 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

2480 
	`zlog_w¨n
 ("%s unrecognized capability code: %d - ignored",

2481 
≥î
->
ho°
, 
hdr
->
code
);

2483 
≤t
 +
hdr
->
Àngth
 + 3;

2486 
	}
}

2493 
	$bgp_ˇ∑bûôy_ª˚ive
 (
≥î
 *≥î, 
bgp_size_t
 
size
)

2495 
u_ch¨
 *
≤t
;

2498 
≤t
 = 
	`°ªam_≤t
 (
≥î
->
ibuf
);

2500 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2501 
	`zlog_debug
 ("%†rcv CAPABILITY", 
≥î
->
ho°
);

2504 i‡(! 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_DYNAMIC_ADV
))

2506 
	`∂og_îr
 (
≥î
->
log
, "%s [Error] BGP dynamic capability isÇotÉnabled",

2507 
≥î
->
ho°
);

2508 
	`bgp_nŸify_£nd
 (
≥î
,

2509 
BGP_NOTIFY_HEADER_ERR
,

2510 
BGP_NOTIFY_HEADER_BAD_MESTYPE
);

2515 i‡(
≥î
->
°©us
 !
E°ablished
)

2517 
	`∂og_îr
 (
≥î
->
log
,

2518 "%†[Eº‹] Dy«mi¯ˇ∑bûôyÖackëÑe˚ived undî sètu†%s", 
≥î
->
ho°
, 
	`LOOKUP
 (
bgp_°©us_msg
,Öìr->
°©us
));

2519 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_FSM_ERR
, 0);

2524  
	`bgp_ˇ∑bûôy_msg_∑r£
 (
≥î
, 
≤t
, 
size
);

2525 
	}
}

2529 
	$bgp_ªad_∑ckë
 (
≥î
 *peer)

2531 
nbyãs
;

2532 
ªadsize
;

2534 
ªadsize
 = 
≥î
->
∑ckë_size
 - 
	`°ªam_gë_ídp
 (≥î->
ibuf
);

2537 i‡(! 
ªadsize
)

2541 
nbyãs
 = 
	`°ªam_ªad_åy
 (
≥î
->
ibuf
,Öìr->
fd
, 
ªadsize
);

2544 i‡(
nbyãs
 < 0)

2547 i‡(
nbyãs
 == -2)

2550 
	`∂og_îr
 (
≥î
->
log
, "%s [Error] bgp_read_packetÉrror: %s",

2551 
≥î
->
ho°
, 
	`ß„_°ªº‹
 (
î∫o
));

2553 i‡(
≥î
->
°©us
 =
E°ablished
)

2555 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_MODE
))

2557 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_NSF_CLOSE_SESSION
;

2558 
	`SET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
);

2561 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CLOSE_SESSION
;

2564 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_Áèl_îr‹
);

2569 i‡(
nbyãs
 == 0)

2571 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

2572 
	`∂og_debug
 (
≥î
->
log
, "%s [Event] BGP connection closed fd %d",

2573 
≥î
->
ho°
,Öìr->
fd
);

2575 i‡(
≥î
->
°©us
 =
E°ablished
)

2577 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_MODE
))

2579 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_NSF_CLOSE_SESSION
;

2580 
	`SET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
);

2583 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CLOSE_SESSION
;

2586 
	`BGP_EVENT_ADD
 (
≥î
, 
TCP_c⁄√˘i⁄_˛o£d
);

2591 i‡(
	`°ªam_gë_ídp
 (
≥î
->
ibuf
Ë!≥î->
∑ckë_size
)

2595 
	}
}

2599 
	$bgp_m¨kî_Æl_⁄e
 (
°ªam
 *
s
, 
Àngth
)

2601 
i
;

2603 
i
 = 0; i < 
Àngth
; i++)

2604 i‡(
s
->
d©a
[
i
] != 0xff)

2608 
	}
}

2613 
time_t


2614 
	$bgp_ª˚¡_˛ock
 ()

2616  
	`ª˚¡_ªœtive_time
().
tv_£c
;

2617 
	}
}

2621 
	$bgp_ªad
 (
thªad
 *thread)

2623 
ªt
;

2624 
u_ch¨
 
ty≥
 = 0;

2625 
≥î
 *peer;

2626 
bgp_size_t
 
size
;

2627 
nŸify_d©a_Àngth
[2];

2630 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

2631 
≥î
->
t_ªad
 = 
NULL
;

2634 i‡(
≥î
->
°©us
 =
C⁄√˘
)

2636 
	`bgp_c⁄√˘_check
 (
≥î
);

2637 
d⁄e
;

2641 i‡(
≥î
->
fd
 < 0)

2643 
	`zlog_îr
 ("bgp_ªadÖìr'†fd i†√g©ivêvÆuê%d", 
≥î
->
fd
);

2646 
	`BGP_READ_ON
 (
≥î
->
t_ªad
, 
bgp_ªad
,Öìr->
fd
);

2650 i‡(
≥î
->
∑ckë_size
 == 0)

2651 
≥î
->
∑ckë_size
 = 
BGP_HEADER_SIZE
;

2653 i‡(
	`°ªam_gë_ídp
 (
≥î
->
ibuf
Ë< 
BGP_HEADER_SIZE
)

2655 
ªt
 = 
	`bgp_ªad_∑ckë
 (
≥î
);

2658 i‡(
ªt
 < 0)

2659 
d⁄e
;

2662 
	`°ªam_f‹w¨d_gëp
 (
≥î
->
ibuf
, 
BGP_MARKER_SIZE
);

2663 
	`mem˝y
 (
nŸify_d©a_Àngth
, 
	`°ªam_≤t
 (
≥î
->
ibuf
), 2);

2664 
size
 = 
	`°ªam_gëw
 (
≥î
->
ibuf
);

2665 
ty≥
 = 
	`°ªam_gëc
 (
≥î
->
ibuf
);

2667 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
Ë&& 
ty≥
 != 2 &&Åype != 0)

2668 
	`zlog_debug
 ("%sÑcv messageÅype %d,Üength (excl. header) %d",

2669 
≥î
->
ho°
, 
ty≥
, 
size
 - 
BGP_HEADER_SIZE
);

2672 i‡(((
ty≥
 =
BGP_MSG_OPEN
Ë|| (ty≥ =
BGP_MSG_KEEPALIVE
))

2673 && ! 
	`bgp_m¨kî_Æl_⁄e
 (
≥î
->
ibuf
, 
BGP_MARKER_SIZE
))

2675 
	`bgp_nŸify_£nd
 (
≥î
,

2676 
BGP_NOTIFY_HEADER_ERR
,

2677 
BGP_NOTIFY_HEADER_NOT_SYNC
);

2678 
d⁄e
;

2682 i‡(
ty≥
 !
BGP_MSG_OPEN
 &&Åy≥ !
BGP_MSG_UPDATE


2683 && 
ty≥
 !
BGP_MSG_NOTIFY
 &&Åy≥ !
BGP_MSG_KEEPALIVE


2684 && 
ty≥
 !
BGP_MSG_ROUTE_REFRESH_NEW


2685 && 
ty≥
 !
BGP_MSG_ROUTE_REFRESH_OLD


2686 && 
ty≥
 !
BGP_MSG_CAPABILITY
)

2688 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2689 
	`∂og_debug
 (
≥î
->
log
,

2691 
≥î
->
ho°
, 
ty≥
);

2692 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

2693 
BGP_NOTIFY_HEADER_ERR
,

2694 
BGP_NOTIFY_HEADER_BAD_MESTYPE
,

2695 &
ty≥
, 1);

2696 
d⁄e
;

2700 #ifde‡
USE_SRX


2701 
bgp_size_t
 
size_pﬁicy
;

2702 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
))

2705 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_EXTENDED_MSG_SUPPORT
))

2707 
size_pﬁicy
 = 
BGP_MAX_PACKET_SIZE_EXTENDED
;

2712 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_LIBERAL
))

2714 
size_pﬁicy
 = 
BGP_MAX_PACKET_SIZE_EXTENDED
;

2717 
size_pﬁicy
 = 
BGP_MAX_PACKET_SIZE
;

2722 
size_pﬁicy
 = 
BGP_MAX_PACKET_SIZE
;

2729 i‡((
size
 < 
BGP_HEADER_SIZE
)

2730 #ifde‡
USE_SRX


2731 || (
size
 > 
size_pﬁicy
)

2733 || (
size
 > 
BGP_MAX_PACKET_SIZE
)

2735 || (
ty≥
 =
BGP_MSG_OPEN
 && 
size
 < 
BGP_MSG_OPEN_MIN_SIZE
)

2736 || (
ty≥
 =
BGP_MSG_UPDATE
 && 
size
 < 
BGP_MSG_UPDATE_MIN_SIZE
)

2737 || (
ty≥
 =
BGP_MSG_NOTIFY
 && 
size
 < 
BGP_MSG_NOTIFY_MIN_SIZE
)

2738 || (
ty≥
 =
BGP_MSG_KEEPALIVE
 && 
size
 !
BGP_MSG_KEEPALIVE_MIN_SIZE
)

2739 || (
ty≥
 =
BGP_MSG_ROUTE_REFRESH_NEW
 && 
size
 < 
BGP_MSG_ROUTE_REFRESH_MIN_SIZE
)

2740 || (
ty≥
 =
BGP_MSG_ROUTE_REFRESH_OLD
 && 
size
 < 
BGP_MSG_ROUTE_REFRESH_MIN_SIZE
)

2741 || (
ty≥
 =
BGP_MSG_CAPABILITY
 && 
size
 < 
BGP_MSG_CAPABILITY_MIN_SIZE
))

2743 i‡(
	`BGP_DEBUG
 (
n‹mÆ
, 
NORMAL
))

2744 
	`∂og_debug
 (
≥î
->
log
,

2746 
≥î
->
ho°
, 
size
,

2747 
ty≥
 == 128 ? "ROUTE-REFRESH" :

2748 
bgp_ty≥_°r
[(Ë
ty≥
]);

2749 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
,

2750 
BGP_NOTIFY_HEADER_ERR
,

2751 
BGP_NOTIFY_HEADER_BAD_MESLEN
,

2752 (
u_ch¨
 *Ë
nŸify_d©a_Àngth
, 2);

2753 
d⁄e
;

2757 
≥î
->
∑ckë_size
 = 
size
;

2760 
ªt
 = 
	`bgp_ªad_∑ckë
 (
≥î
);

2761 i‡(
ªt
 < 0)

2762 
d⁄e
;

2765 
size
 = 
	`°ªam_gëw_‰om
 (
≥î
->
ibuf
, 
BGP_MARKER_SIZE
);

2766 
ty≥
 = 
	`°ªam_gëc_‰om
 (
≥î
->
ibuf
, 
BGP_MARKER_SIZE
 + 2);

2769 
	`bgp_dump_∑ckë
 (
≥î
, 
ty≥
,Öìr->
ibuf
);

2771 
size
 = (
≥î
->
∑ckë_size
 - 
BGP_HEADER_SIZE
);

2773 #i‡
	`deföed
 (
__TIME_MEASURE__
)

2775 
tCou¡
=0;

2779 
ty≥
)

2781 
BGP_MSG_OPEN
:

2782 
≥î
->
›í_ö
++;

2783 
	`bgp_›í_ª˚ive
 (
≥î
, 
size
);

2785 
BGP_MSG_UPDATE
:

2786 #i‡
	`deföed
 (
__TIME_MEASURE__
)

2787 if(
tCou¡
==0)

2789 
	`¥ötf
("[%s] Sèπ Re˚ivög U±ÿ%ld Cou¡s...\n", 
__FUNCTION__
, 
g_mósuªCou¡
);

2790 
°¨t_˛ock
 = 
	`rdtsc
();

2793 
≥î
->
ªadtime
 = 
	`bgp_ª˚¡_˛ock
 ();

2794 
	`bgp_upd©e_ª˚ive
 (
≥î
, 
size
);

2795 #i‡
	`deföed
 (
__TIME_MEASURE__
)

2796 
tCou¡
++;

2798 if(
tCou¡
 >
g_mósuªCou¡
 && g_measureCount != 0)

2800 
íd_˛ock
 = 
	`rdtsc
();

2802 
tCou¡
=0;

2806 
BGP_MSG_NOTIFY
:

2807 
	`bgp_nŸify_ª˚ive
 (
≥î
, 
size
);

2809 
BGP_MSG_KEEPALIVE
:

2810 
≥î
->
ªadtime
 = 
	`bgp_ª˚¡_˛ock
 ();

2811 
	`bgp_kì∑live_ª˚ive
 (
≥î
, 
size
);

2813 
BGP_MSG_ROUTE_REFRESH_NEW
:

2814 
BGP_MSG_ROUTE_REFRESH_OLD
:

2815 
≥î
->
ª‰esh_ö
++;

2816 
	`bgp_rouã_ª‰esh_ª˚ive
 (
≥î
, 
size
);

2818 
BGP_MSG_CAPABILITY
:

2819 
≥î
->
dy«mic_ˇp_ö
++;

2820 
	`bgp_ˇ∑bûôy_ª˚ive
 (
≥î
, 
size
);

2825 
≥î
->
∑ckë_size
 = 0;

2826 i‡(
≥î
->
ibuf
)

2827 
	`°ªam_ª£t
 (
≥î
->
ibuf
);

2829 
d⁄e
:

2830 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

2832 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

2833 
	`zlog_debug
 ("%†[Evít] Ac˚±ög BGPÖì∏dñëe", 
≥î
->
ho°
);

2834 
	`≥î_dñëe
 (
≥î
);

2837 
	}
}

2839 #ifde‡
USE_SRX


2840 
	$bgp_ªad2
 (
thªad
 *thread)

2843 
≥î
 *peer;

2846 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

2847 
≥î
->
t_ªad
 = 
NULL
;

2850 
	`zlog_debug
("ÉventÑead2 ---------\n");

2851 
	`BGP_READ_ON
 (
≥î
->
t_ªad
, 
bgp_ªad2
,Öìr->
fd
);

2853 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_packet.h

21 #i‚de‡
_QUAGGA_BGP_PACKET_H


22 
	#_QUAGGA_BGP_PACKET_H


	)

24 
	#BGP_NLRI_LENGTH
 1U

	)

25 
	#BGP_TOTAL_ATTR_LEN
 2U

	)

26 
	#BGP_UNFEASIBLE_LEN
 2U

	)

27 
	#BGP_WRITE_PACKET_MAX
 10U

	)

30 
	#REFRESH_IMMEDIATE
 1

	)

31 
	#REFRESH_DEFER
 2

	)

34 
	#ORF_COMMON_PART_ADD
 0x00

	)

35 
	#ORF_COMMON_PART_REMOVE
 0x80

	)

36 
	#ORF_COMMON_PART_REMOVE_ALL
 0xC0

	)

37 
	#ORF_COMMON_PART_PERMIT
 0x00

	)

38 
	#ORF_COMMON_PART_DENY
 0x20

	)

41 
bgp_ªad
 (
thªad
 *);

42 #ifde‡
USE_SRX


43 
bgp_ªad2
 (
thªad
 *);

44 
ecommunôy
* 
§xEcommunôyCh™ge
(
bgp
 *, 
©å
 *, 
bgp_öfo
 *);

45 
§xEcommunôyRe°‹e
(
©å
 *, 
ecommunôy
* );

47 
bgp_wrôe
 (
thªad
 *);

49 
bgp_kì∑live_£nd
 (
≥î
 *);

50 
bgp_›í_£nd
 (
≥î
 *);

51 
bgp_nŸify_£nd
 (
≥î
 *, 
u_öt8_t
, u_int8_t);

52 
bgp_nŸify_£nd_wôh_d©a
 (
≥î
 *, 
u_öt8_t
, u_int8_t,

53 
u_öt8_t
 *, 
size_t
);

54 
bgp_rouã_ª‰esh_£nd
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_ch¨
, u_char, );

55 
bgp_ˇ∑bûôy_£nd
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , );

56 
bgp_deÁu…_upd©e_£nd
 (
≥î
 *, 
©å
 *,

57 
afi_t
, 
ßfi_t
, 
≥î
 *);

58 
bgp_deÁu…_wôhdøw_£nd
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

60 
bgp_ˇ∑bûôy_ª˚ive
 (
≥î
 *, 
bgp_size_t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_regex.c

21 
	~<zebø.h
>

23 
	~"log.h
"

24 
	~"comm™d.h
"

25 
	~"mem‹y.h
"

27 
	~"bgpd.h
"

28 
	~"bgp_a•©h.h
"

29 
	~"bgp_ªgex.h
"

36 
ªgex_t
 *

37 
	$bgp_ªgcomp
 (c⁄° *
ªg°r
)

40 
i
, 
j
;

41 
Àn
;

42 
magic
 = 0;

43 *
magic_°r
;

44 
magic_ªgexp
[] = "(^|[,{}() ]|$)";

45 
ªt
;

46 
ªgex_t
 *
ªgex
;

48 
Àn
 = 
	`°æí
 (
ªg°r
);

49 
i
 = 0; i < 
Àn
; i++)

50 i‡(
ªg°r
[
i
] == '_')

51 
magic
++;

53 
magic_°r
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
Àn
 + (14 * 
magic
) + 1);

55 
i
 = 0, 
j
 = 0; i < 
Àn
; i++)

57 i‡(
ªg°r
[
i
] == '_')

59 
	`mem˝y
 (
magic_°r
 + 
j
, 
magic_ªgexp
, 
	`°æí
 (magic_regexp));

60 
j
 +
	`°æí
 (
magic_ªgexp
);

63 
magic_°r
[
j
++] = 
ªg°r
[
i
];

65 
magic_°r
[
j
] = '\0';

67 
ªgex
 = 
	`XMALLOC
 (
MTYPE_BGP_REGEXP
,  (
ªgex_t
));

69 
ªt
 = 
	`ªgcomp
 (
ªgex
, 
magic_°r
, 
REG_EXTENDED
|
REG_NOSUB
);

71 
	`XFREE
 (
MTYPE_TMP
, 
magic_°r
);

73 i‡(
ªt
 != 0)

75 
	`XFREE
 (
MTYPE_BGP_REGEXP
, 
ªgex
);

76  
NULL
;

79  
ªgex
;

80 
	}
}

83 
	$bgp_ªgexec
 (
ªgex_t
 *
ªgex
, 
a•©h
 *aspath)

85  
	`ªgexec
 (
ªgex
, 
a•©h
->
°r
, 0, 
NULL
, 0);

86 
	}
}

89 
	$bgp_ªgex_‰ì
 (
ªgex_t
 *
ªgex
)

91 
	`ªg‰ì
 (
ªgex
);

92 
	`XFREE
 (
MTYPE_BGP_REGEXP
, 
ªgex
);

93 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_regex.h

21 #i‚de‡
_QUAGGA_BGP_REGEX_H


22 
	#_QUAGGA_BGP_REGEX_H


	)

24 
	~<zebø.h
>

26 #ifde‡
HAVE_LIBPCREPOSIX


27 
	~<p¸ïosix.h
>

29 #ifde‡
HAVE_GNU_REGEX


30 
	~<ªgex.h
>

32 
	~"ªgex-gnu.h
"

36 
bgp_ªgex_‰ì
 (
ªgex_t
 *
ªgex
);

37 
ªgex_t
 *
bgp_ªgcomp
 (c⁄° *
°r
);

38 
bgp_ªgexec
 (
ªgex_t
 *
ªgex
, 
a•©h
 *aspath);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_route.c

21 
	~<zebø.h
>

23 
	~"¥efix.h
"

24 
	~"lökli°.h
"

25 
	~"mem‹y.h
"

26 
	~"comm™d.h
"

27 
	~"°ªam.h
"

28 
	~"fûãr.h
"

29 
	~"°r.h
"

30 
	~"log.h
"

31 
	~"rouãm≠.h
"

32 
	~"buf„r.h
"

33 
	~"sockuni⁄.h
"

34 
	~"∂i°.h
"

35 
	~"thªad.h
"

36 
	~"w‹kqueue.h
"

38 
	~"bgpd/bgpd.h
"

39 
	~"bgpd/bgp_èbÀ.h
"

40 
	~"bgpd/bgp_rouã.h
"

41 
	~"bgpd/bgp_©å.h
"

42 
	~"bgpd/bgp_debug.h
"

43 
	~"bgpd/bgp_a•©h.h
"

44 
	~"bgpd/bgp_ªgex.h
"

45 
	~"bgpd/bgp_communôy.h
"

46 
	~"bgpd/bgp_ecommunôy.h
"

47 
	~"bgpd/bgp_˛i°.h
"

48 
	~"bgpd/bgp_∑ckë.h
"

49 
	~"bgpd/bgp_fûãr.h
"

50 
	~"bgpd/bgp_fsm.h
"

51 
	~"bgpd/bgp_m∂sv≤.h
"

52 
	~"bgpd/bgp_√xth›.h
"

53 
	~"bgpd/bgp_damp.h
"

54 
	~"bgpd/bgp_advîti£.h
"

55 
	~"bgpd/bgp_zebø.h
"

56 
	~"bgpd/bgp_vty.h
"

57 
	~"bgpd/bgp_m∑th.h
"

59 #i‡
deföed
 (
__TIME_MEASURE__
)

60 
	~"libtm_rdtsc.h
"

63 #ifde‡
USE_SRX


64 
	~<sys/un.h
>

65 
	~"§x/§x_defs.h
"

66 
	~"§x/§x_≠i.h
"

67 
	~"bgpd/bgp_vÆid©e.h
"

71 c⁄° *
bgp_‹igö_°r
[];

72 c⁄° *
bgp_‹igö_l⁄g_°r
[];

74 #ifde‡
USE_SRX


75 
	#NUM_MAX_RECONNECT
 2

	)

76 
	#RETRY_TIMER_SEC
 10

	)

78 
boﬁ
 
h™dÀSRxVÆid©i⁄Resu…
 (
SRxVÆid©i⁄Resu…
* 
ªsu…
,

79 * 
bgpRouãr
);

80 
h™dÀSRxSig«tuªs
(
SRxUpd©eID
* 
upd©eID
, 
BGPSecD©a
* 
d©a
,

81 * 
bgpRouãr
);

82 
h™dÀSRxSynchReque°
(* 
bgpRouãr
);

83 
ª•awnRe˚ivePackë
(
thªad
 *
t
);

84 
thªad
 *
	gg_cuºít_ªad_thªad
;

86 
SRxThªad
* 
	$§x_thªad_¨g_√w
()

88 
SRxThªad
 *
rq
;

89 
rq
 = 
	`ˇŒoc
(1, (
SRxThªad
));

91  
rq
;

92 
	}
}

94 
	$checkClõ¡C⁄√˘i⁄
(
thªad
 *
t
)

96 
	`zlog_debug
 (" %†ˇŒed", 
__FUNCTION__
);

97 
thªad
 *
thr
=
NULL
;

99 
SRxThªad
 *
rq
;

100 
boﬁ
 
ªc⁄√˘ed
 = 
Ál£
;

101 
siMaxRec⁄√˘
 = 0;

103 
rq
 = (
SRxThªad
 *)
	`THREAD_ARG
(
t
);

104 
rq
->
t_ªad
 = 
NULL
;

107 
bgp
* bg∞
	`bgp_gë_deÁu…
();

110 
¥evClõ¡FD
 = 
	`gëI¡î«lSockëFD
(
bgp
->
§xProxy
, 
Ál£
);

111 
	`zlog_debug
 (" obèöedÖªviou†fd:%d,Ñq->˛õ¡FD:%d", 
¥evClõ¡FD
,

112 
rq
->
˛õ¡FD
);

114 
rq
->
¥evClõ¡FD
 = (rq->
˛õ¡FD
 >0) ?Ñq->clientFD :ÖrevClientFD ;

118 
ªc⁄√˘ed
 = 
	`ªc⁄√˘WôhSRx
(
bgp
->
§xProxy
);

120 if(
thr
)

122 
	`zlog_debug
 ("[%s] c™˚»thê¥eviou†thªad (fd:%d,%d)", 
__FUNCTION__
,

123 
rq
->
˛õ¡FD
, 
thr
->
u
.
fd
);

124 
	`thªad_ˇn˚l
(
thr
);

128 if(
ªc⁄√˘ed
)

130 
	`zlog_debug
 (" clo£Öªviou†sockë FD(%d)", 
rq
->
¥evClõ¡FD
);

131 
	`˛o£
(
rq
->
¥evClõ¡FD
);

134 
rq
->
˛õ¡FD
 = 
	`gëI¡î«lSockëFD
(
bgp
->
§xProxy
, 
åue
);

135 
rq
->
t_ªad
 = 
thr
 = 
	`thªad_add_ªad
 (
bm
->
ma°î
, 
ª•awnRe˚ivePackë
,Ñq,

136 
rq
->
˛õ¡FD
);

137 
g_cuºít_ªad_thªad
 = 
thr
;

138 
	`zlog_debug
 ("[%s] callÅhread-add-readágain forÅheÇew fd:%d",

139 
__FUNCTION__
, 
rq
->
˛õ¡FD
);

145 
thr
 = 
	`thªad_add_timî
 (
bm
->
ma°î
, 
checkClõ¡C⁄√˘i⁄
, 
rq
,

146 
RETRY_TIMER_SEC
 );

151 
siMaxRec⁄√˘
++;

152 if(
siMaxRec⁄√˘
 >
NUM_MAX_RECONNECT
 )

155 if(
rq
->
¥evClõ¡FD
 > 0)

157 
	`zlog_debug
 (" clo£Öªviou†sockëÖªvFD(%d)", 
rq
->
¥evClõ¡FD
);

158 
	`˛o£
(
rq
->
¥evClõ¡FD
);

161 
bgp

	`bgp_gë_deÁu…
();

162 i‡(
bgp
 =
NULL
)

167 
	`zlog_debug
 (" srx unset() bgp info hash finish()ándÑeleaseSRxProxy()");

168 
	`bgp_§x_un£t
(
bgp
);

169 
siMaxRec⁄√˘
 =0;

171 i‡(
bgp
->
§xProxy
)

173 
	`ªÀa£SRxProxy
 (
bgp
->
§xProxy
);

175 if(
thr
)

177 
	`thªad_ˇn˚l
(
thr
);

181 if(
rq
->
˛õ¡FD
 > 0)

183 
	`zlog_debug
 (" clo£Öªviou†sockëÑq->˛õ¡FD(%d)", 
rq
->
˛õ¡FD
);

184 
	`˛o£
(
rq
->
˛õ¡FD
);

187 
	`zlog_debug
 (" srx set defaultágain");

188 
	`§x_£t_deÁu…
(
bgp
);

192 
	}
}

194 
	$ª•awnRe˚ivePackë
(
thªad
 *
t
)

197 
SRxThªad
 *
rq
;

198 
boﬁ
 
bRëVÆ
 = 
åue
;

199 
rq
 = (
SRxThªad
 *)
	`THREAD_ARG
(
t
);

200 
˛õ¡FD
 = 
	`THREAD_VAL
(
t
);

201 
rq
->
˛õ¡FD
 = clientFD;

202 
rq
->
t_ªad
 = 
NULL
;

204 
thªad
 *
thr
 = 
NULL
;

208 
bRëVÆ
 = 
	`¥o˚ssPackës
(
rq
->
¥oxy
);

211 i‡(!
bRëVÆ
)

213 if(
g_cuºít_ªad_thªad
)

215 
	`thªad_ˇn˚l
(
g_cuºít_ªad_thªad
);

216 
	`zlog_debug
 ("[%s]ÑódÅhªad c™˚»", 
__FUNCTION__
);

218 
rq
->
t_ªad
 = 
	`thªad_add_timî
 (
bm
->
ma°î
, 
checkClõ¡C⁄√˘i⁄
,Ñq,

219 
RETRY_TIMER_SEC
);

227 
rq
->
t_ªad
 = 
thr
 = 
	`thªad_add_ªad
 (
bm
->
ma°î
, 
ª•awnRe˚ivePackë
,Ñq,

228 
˛õ¡FD
);

229 
g_cuºít_ªad_thªad
 = 
thr
;

232 
	}
}

234 
	$öôUnSockë
(
thªad
 *
t
)

236 
sockaddr_un
 
ßddru_rv
, 
ßddru_rv_ªcv
;

237 
ufd
, 
ufdRecv
;

239 
SRxThªad
 *
§x_rq
 = 
	`§x_thªad_¨g_√w
();

240 
g_rq
 = 
§x_rq
;

241 
§x_rq
->
sock
 = -1;

244 
	`mem£t
(&
ßddru_rv
, 0x00, (
sockaddr_un
));

248 
ßddru_rv
.
sun_Ámûy
 = 
AF_UNIX
;

249 
	`°∫˝y
(&
ßddru_rv
.
sun_∑th
[1], "srx", (saddru_rv.sun_path)-2);

253 
§x_rq
->
sock
 = 
ufd
 = 
	`sockë
(
AF_UNIX
, 
SOCK_DGRAM
, 
IPPROTO_IP
);

254 i‡(
ufd
 == -1)

256 
	`zlog_debug
 ("Fail: un_socket()");

259 i‡(
	`böd
(
ufd
, (
sockaddr
 *)&
ßddru_rv
, (saddru_rv)) == -1)

261 
	`zlog_debug
 ("Fail: un_socket bind()");

262 
	`exô
(
EXIT_FAILURE
);

267 
	`mem£t
(&
ßddru_rv_ªcv
, 0x00, (
sockaddr_un
));

268 
ßddru_rv_ªcv
.
sun_Ámûy
 = 
AF_UNIX
;

269 
	`°∫˝y
(&
ßddru_rv_ªcv
.
sun_∑th
[1], "srxRecv",

270 (
ßddru_rv_ªcv
.
sun_∑th
)-2);

271 
ufdRecv
 = 
	`sockë
(
AF_UNIX
, 
SOCK_DGRAM
, 
IPPROTO_IP
);

272 i‡(
ufdRecv
 == -1)

274 
	`zlog_debug
 ("Fail: un_socket()");

277 i‡(
	`böd
(
ufdRecv
, (
sockaddr
 *)&
ßddru_rv_ªcv
,

278 (
ßddru_rv_ªcv
)) == -1)

280 
	`zlog_debug
 ("Fail: un_socket bind()");

281 
	`exô
(
EXIT_FAILURE
);

291 i‡(
ÊagDoC⁄√˘Srx
 !
NULL
)

293 
	`zlog_debug
("RequestÅo connectÅo SRx server");

294 
boﬁ
 
isC⁄√˘ed
 = 
	`§x_c⁄√˘_¥oxy
((
bgp
*)
ÊagDoC⁄√˘Srx
) == 0;

295 i‡(
isC⁄√˘ed
)

297 
ÊagDoC⁄√˘Srx
 = 
NULL
;

299 
	`zlog_debug
("ConnectionÅo SRx-server %s",

300 (
isC⁄√˘ed
) ? "succeeded" : "failed");

303 
	}
}

305 
	$checkSídQueue
(
thªad
 *
t
)

307 
SRxThªad
 *
rq
;

308 
rq
 = (
SRxThªad
 *)
	`THREAD_ARG
(
t
);

309 if(
rq
)  1;

312 
	}
}

314 
	$thªadC⁄åﬁCÆl
(
ty≥
)

318 
SRxThªad
 *
rq
;

320 
rq
 = 
g_rq
;

322 if(
ty≥
 =
COM_ERR_PROXY_UNKNOWN
 && 
rq
->
˛õ¡FD
 != 0)

325 
	`FD_CLR
 (
rq
->
˛õ¡FD
, &
bm
->
ma°î
->
ªadfd
);

326 
	`zlog_debug
 (" FD_CLR called forávoiding select()Érror" );

328 if(
ty≥
 =
COM_ERR_PROXY_COULD_NOT_SEND
)

330 if–
	`FD_ISSET
(
rq
->
˛õ¡FD
, &
bm
->
ma°î
->
ªadfd
) )

332 
	`FD_CLR
 (
rq
->
˛õ¡FD
, &
bm
->
ma°î
->
ªadfd
);

333 
	`zlog_debug
 (" FD_CLR called forávoiding select()Érror" );

337 i‡(
ty≥
 =
COM_ERR_PROXY_UNKNOWN_UPDATE
)

344 if(
g_cuºít_ªad_thªad
)

346 
	`zlog_debug
 ("%†thªad c™˚l", 
__FUNCTION__
);

347 
	`thªad_ˇn˚l
(
g_cuºít_ªad_thªad
);

348 if(
rq
->
˛õ¡FD
 > 0)

350 
	`˛o£
(
rq
->
˛õ¡FD
);

351 
rq
->
˛õ¡FD
 = -1;

355 if–(
ty≥
 =
COM_ERR_PROXY_CONNECTION_LOST
)

356 || (
ty≥
 =
COM_PROXY_DISCONNECT
))

358 
	`zlog_debug
 (" Disconnect orÜost connection ,ÑespawnÅhreadáddÅimer" );

359 
	`thªad_add_timî
 (
bm
->
ma°î
, 
checkClõ¡C⁄√˘i⁄
, 
rq
, 
RETRY_TIMER_SEC
);

362 
	}
}

365 
bgp_node
 *

366 
	$bgp_afi_node_gë
 (
bgp_èbÀ
 *
èbÀ
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
¥efix
 *
p
,

367 
¥efix_rd
 *
¥d
)

369 
bgp_node
 *
∫
;

370 
bgp_node
 *
¥n
 = 
NULL
;

372 
	`as£π
 (
èbÀ
);

373 i‡(!
èbÀ
)

374  
NULL
;

376 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

378 
¥n
 = 
	`bgp_node_gë
 (
èbÀ
, (
¥efix
 *Ë
¥d
);

380 i‡(
¥n
->
öfo
 =
NULL
)

381 
¥n
->
öfo
 = 
	`bgp_èbÀ_öô
 (
afi
, 
ßfi
);

383 
	`bgp_u∆ock_node
 (
¥n
);

384 
èbÀ
 = 
¥n
->
öfo
;

387 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

389 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

390 
∫
->
¥n
 =Örn;

392  
∫
;

393 
	}
}

396 
bgp_öfo_exåa
 *

397 
	$bgp_öfo_exåa_√w
 ()

399 
bgp_öfo_exåa
 *
√w
;

400 
√w
 = 
	`XCALLOC
 (
MTYPE_BGP_ROUTE_EXTRA
,  (
bgp_öfo_exåa
));

401  
√w
;

402 
	}
}

405 
	$bgp_öfo_exåa_‰ì
 (
bgp_öfo_exåa
 **
exåa
)

407 i‡(
exåa
 && *extra)

409 i‡((*
exåa
)->
damp_öfo
)

410 
	`bgp_damp_öfo_‰ì
 ((*
exåa
)->
damp_öfo
, 0);

412 (*
exåa
)->
damp_öfo
 = 
NULL
;

414 
	`XFREE
 (
MTYPE_BGP_ROUTE_EXTRA
, *
exåa
);

416 *
exåa
 = 
NULL
;

418 
	}
}

423 
bgp_öfo_exåa
 *

424 
	$bgp_öfo_exåa_gë
 (
bgp_öfo
 *
ri
)

426 i‡(!
ri
->
exåa
)

427 
ri
->
exåa
 = 
	`bgp_öfo_exåa_√w
();

428  
ri
->
exåa
;

429 
	}
}

432 
bgp_öfo
 *

433 
	$bgp_öfo_√w
 ()

435 #ifde‡
USE_SRX


436 
bgp_öfo
 *
√w
 = 
	`XCALLOC
 (
MTYPE_BGP_ROUTE
,  (bgp_info));

437 i‡(
√w
)

439 
√w
->
node
 = 
NULL
;

440 
√w
->
öfo_hash
 = 
NULL
;

442 
√w
->
upd©eID
 = 0;

443 
√w
->
loˇlID
 = 0;

445  
√w
;

447  
	`XCALLOC
 (
MTYPE_BGP_ROUTE
,  (
bgp_öfo
));

449 
	}
}

453 
	$bgp_öfo_‰ì
 (
bgp_öfo
 *
böfo
)

455 i‡(
böfo
->
©å
)

456 
	`bgp_©å_unöã∫
 (&
böfo
->
©å
);

458 
	`bgp_öfo_exåa_‰ì
 (&
böfo
->
exåa
);

459 
	`bgp_öfo_m∑th_‰ì
 (&
böfo
->
m∑th
);

461 
	`≥î_u∆ock
 (
böfo
->
≥î
);

463 #ifde‡
USE_SRX


464 i‡(
böfo
->
öfo_hash
)

467 i‡(
böfo
->
upd©eID
 != 0)

469 
	`bgp_öfo_uƒegi°î
 (
böfo
->
öfo_hash
, böfo->
upd©eID
);

471 
	`dñëeUpd©e
(
böfo
->
≥î
->
bgp
->
§xProxy
, böfo->≥î->bgp->
§x_kìpWödow
,

472 
böfo
->
upd©eID
);

476 
	`bgp_öfo_uƒegi°î
 (
böfo
->
öfo_hash
, böfo->
loˇlID
);

478 
böfo
->
öfo_hash
 = 
NULL
;

482 
	`XFREE
 (
MTYPE_BGP_ROUTE
, 
böfo
);

483 
	}
}

485 
bgp_öfo
 *

486 
	$bgp_öfo_lock
 (
bgp_öfo
 *
böfo
)

488 
böfo
->
lock
++;

489  
böfo
;

490 
	}
}

492 
bgp_öfo
 *

493 
	$bgp_öfo_u∆ock
 (
bgp_öfo
 *
böfo
)

495 
	`as£π
 (
böfo
 && böfo->
lock
 > 0);

496 
böfo
->
lock
--;

498 i‡(
böfo
->
lock
 == 0)

501 
	`zlog_debug
 ("%s: u∆ockedánd fªeög", 
__func__
);

502 
	`zlog_backåa˚
 (
LOG_DEBUG
);

504 
	`bgp_öfo_‰ì
 (
böfo
);

505  
NULL
;

509 i‡(
böfo
->
lock
 == 1)

511 
	`zlog_debug
 ("%s: u∆ockedÅÿ1", 
__func__
);

512 
	`zlog_backåa˚
 (
LOG_DEBUG
);

516  
böfo
;

517 
	}
}

520 
	$bgp_öfo_add
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
)

522 
bgp_öfo
 *
t›
;

524 
t›
 = 
∫
->
öfo
;

526 
ri
->
√xt
 = 
∫
->
öfo
;

527 
ri
->
¥ev
 = 
NULL
;

528 i‡(
t›
)

529 
t›
->
¥ev
 = 
ri
;

530 
∫
->
öfo
 = 
ri
;

532 #ifde‡
USE_SRX


533 
ri
->
node
 = 
∫
;

536 
	`bgp_öfo_lock
 (
ri
);

537 
	`bgp_lock_node
 (
∫
);

538 
	`≥î_lock
 (
ri
->
≥î
);

539 
	}
}

544 
	$bgp_öfo_ª≠
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
)

546 i‡(
ri
->
√xt
)

547 
ri
->
√xt
->
¥ev
 =Ñi->prev;

548 i‡(
ri
->
¥ev
)

549 
ri
->
¥ev
->
√xt
 =Ñi->next;

551 
∫
->
öfo
 = 
ri
->
√xt
;

553 
	`bgp_öfo_m∑th_dequeue
 (
ri
);

554 
	`bgp_öfo_u∆ock
 (
ri
);

555 
	`bgp_u∆ock_node
 (
∫
);

556 
	}
}

559 
	$bgp_öfo_dñëe
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
)

561 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_REMOVED
);

563 
	`UNSET_FLAG
 (
ri
->
Êags
, 
BGP_INFO_VALID
);

564 
	}
}

570 
	$bgp_öfo_ª°‹e
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
)

572 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_REMOVED
);

574 
	`SET_FLAG
 (
ri
->
Êags
, 
BGP_INFO_VALID
);

575 
	}
}

579 
	$bgp_pcou¡_adju°
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
)

581 
bgp_èbÀ
 *
èbÀ
;

583 
	`as£π
 (
∫
 && 
	`bgp_node_èbÀ
 (rn));

584 
	`as£π
 (
ri
 &&Ñi->
≥î
 &&Ñi->≥î->
bgp
);

586 
èbÀ
 = 
	`bgp_node_èbÀ
 (
∫
);

589 i‡(
èbÀ
->
ty≥
 !
BGP_TABLE_MAIN


590 || 
ri
->
≥î
 =ri->≥î->
bgp
->
≥î_£lf
)

593 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri
)

594 && 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_COUNTED
))

597 
	`UNSET_FLAG
 (
ri
->
Êags
, 
BGP_INFO_COUNTED
);

600 i‡(
ri
->
≥î
->
pcou¡
[
èbÀ
->
afi
][èbÀ->
ßfi
])

601 
ri
->
≥î
->
pcou¡
[
èbÀ
->
afi
][èbÀ->
ßfi
]--;

604 
	`zlog_w¨n
 ("%s: AskedÅo decrement 0Örefix count forÖeer %s",

605 
__func__
, 
ri
->
≥î
->
ho°
);

606 
	`zlog_backåa˚
 (
LOG_WARNING
);

607 
	`zlog_w¨n
 ("%s: PÀa£Ñï‹àtÿQuagg®bugzûœ", 
__func__
);

610 i‡(!
	`BGP_INFO_HOLDDOWN
 (
ri
)

611 && !
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_COUNTED
))

613 
	`SET_FLAG
 (
ri
->
Êags
, 
BGP_INFO_COUNTED
);

614 
ri
->
≥î
->
pcou¡
[
èbÀ
->
afi
][èbÀ->
ßfi
]++;

616 
	}
}

623 
	$bgp_öfo_£t_Êag
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
, 
u_öt32_t
 
Êag
)

625 
	`SET_FLAG
 (
ri
->
Êags
, 
Êag
);

628 i‡(!
	`CHECK_FLAG
 (
Êag
, 
BGP_INFO_VALID
|
BGP_INFO_UNUSEABLE
))

631 
	`bgp_pcou¡_adju°
 (
∫
, 
ri
);

632 
	}
}

635 
	$bgp_öfo_un£t_Êag
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
, 
u_öt32_t
 
Êag
)

637 
	`UNSET_FLAG
 (
ri
->
Êags
, 
Êag
);

640 i‡(!
	`CHECK_FLAG
 (
Êag
, 
BGP_INFO_VALID
|
BGP_INFO_UNUSEABLE
))

643 
	`bgp_pcou¡_adju°
 (
∫
, 
ri
);

644 
	}
}

646 #ifde‡
USE_SRX


655 
	$bgp_öfo_£t_ign‹e_Êag
 (
bgp_öfo
* 
öfo
)

657 
ign‹e
;

658 
bgp
 *bgp;

659 
vÆRes
;

661 
ign‹e
 = 0;

662 
bgp
 = 
öfo
->
≥î
->bgp;

663 
vÆRes
 = 
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
öfo
);

666 i‡(
bgp
->
§x_c⁄fig
 & 
SRX_CONFIG_EVALUATE
)

668 
vÆRes
)

670 
SRx_RESULT_INVALID
:

671 i‡(
bgp
->
§x_vÆ_pﬁicy
 & 
SRX_VAL_POLICY_IGNORE_INVALID
)

673 
ign‹e
 = 1;

676 
SRx_RESULT_NOTFOUND
:

677 i‡(
bgp
->
§x_vÆ_pﬁicy
 & 
SRX_VAL_POLICY_IGNORE_NOTFOUND
)

679 
ign‹e
 = 1;

682 
SRx_RESULT_UNDEFINED
:

683 i‡(
bgp
->
§x_vÆ_pﬁicy
 & 
SRX_VAL_POLICY_IGNORE_UNDEFINED
)

685 
ign‹e
 = 1;

693 i‡(
ign‹e
)

695 
	`zlog_debug
 ("Evaluation disabled doÇot set ignore flag for update "

696 "[0x%08X]!", 
öfo
->
upd©eID
);

697 
ign‹e
 = 0;

704 i‡(
	`CHECK_FLAG
 (
öfo
->
Êags
, 
BGP_INFO_IGNORE
))

706 i‡(
ign‹e
 == 0)

710 
	`bgp_öfo_un£t_Êag
 (
öfo
->
node
, info, 
BGP_INFO_IGNORE
);

713 i‡(
ign‹e
 == 1)

717 
	`bgp_öfo_£t_Êag
 (
öfo
->
node
, info, 
BGP_INFO_IGNORE
);

720  
ign‹e
;

721 
	}
}

758 
	$§x_ˇlc_vÆid©i⁄_°©e
(
bgp
 *bgp, 
bgp_öfo
 *
öfo
)

760 
ªsu…
;

762 
ªsu…
 = 
SRx_RESULT_DONOTUSE
;

764 i‡(
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_PATH
))

766 
öfo
->
vÆ_ªs_ROA
)

768 
SRx_RESULT_VALID
:

769 
ªsu…
 = 
öfo
->
vÆ_ªs_BGPSEC
;

771 
SRx_RESULT_NOTFOUND
:

772 
SRx_RESULT_INVALID
:

773 
ªsu…
 = 
SRx_RESULT_INVALID
;

775 
SRx_RESULT_UNDEFINED
:

776 
ªsu…
 = 
öfo
->
vÆ_ªs_BGPSEC
 =
SRx_RESULT_INVALID


777 ? 
SRx_RESULT_INVALID


778 : 
SRx_RESULT_UNDEFINED
;

781 
	`zlog_îr
("BGPSEC validation calculationÑeports invalid ROA state. "

783 
ªsu…
 = 
öfo
->
vÆ_ªs_BGPSEC
 =
SRx_RESULT_UNDEFINED
;

787 i‡(
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_ORIGIN
))

789 
ªsu…
 = 
öfo
->
vÆ_ªs_ROA
;

792  
ªsu…
;

793 
	}
}

800 
	$§x_bgp_ªqueue_upd©e
(
bgp_öfo
 *
öfo
)

802 
bgp_èbÀ
 *
èbÀ
;

803 
èbÀ
 = (
bgp_èbÀ
 *)
öfo
->
node
->table->info;

805 
	`bgp_¥o˚ss
 (
öfo
->
≥î
->
bgp
, info->
node
, 
èbÀ
->
afi
,ÅabÀ->
ßfi
);

806 
	}
}

814 
	$§x_bgp_ªqueue_Æl
(
bgp
 *bgp)

816 
bgp_èbÀ
* 
èbÀ
;

817 
bgp_node
 *
bnode
;

819 i‡(
bgp
 !
NULL
)

821 
èbÀ
 = 
bgp
->
rib
[
AFI_IP
][
SAFI_MULTICAST
];

822 
bnode
 = 
	`bgp_èbÀ_t›
(
èbÀ
); bnode; bnodê
	`bgp_rouã_√xt
(bnode))

824 i‡(
bnode
->
öfo
 !
NULL
)

826 
	`§x_bgp_ªqueue_upd©e
(
bnode
->
öfo
);

830 
èbÀ
 = 
bgp
->
rib
[
AFI_IP
][
SAFI_UNICAST
];

831 
bnode
 = 
	`bgp_èbÀ_t›
(
èbÀ
); bnode; bnodê
	`bgp_rouã_√xt
(bnode))

833 i‡(
bnode
->
öfo
 !
NULL
)

835 
	`§x_bgp_ªqueue_upd©e
(
bnode
->
öfo
);

839 
	}
}

849 
	$checkEcomSRxVÆid
(
©å
*áttr)

851 
ªt
;

853 i‡(!
©å
->
exåa
)

856 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

858 i‡(!
©åe
->
ecommunôy
)

861 
ecommunôy
 *
ecom
 = 
©åe
->ecommunity;

863 if(!
ecom
->
°r
 || !ecom->
vÆ
)

866 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

868 
	`zlog_debug
("exãnded communôy: %†", 
ecom
->
°r
 );

869 
	`zlog_debug
("vÆ: (ty≥)0x%x, (VÆidSètus)0x%x ", 
ecom
->
vÆ
[0],Écom->val[7]);

872 
ecom
->
vÆ
[7])

874 
ECOMMUNITY_BGPSEC_VALID
:

875 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

876 
	`zlog_debug
(" QuaggaSRx Received \"SRx Ecommunity value VALID\" fromÖeer ");

877 
ªt
 = 
ECOMMUNITY_BGPSEC_VALID
;

879 
ECOMMUNITY_BGPSEC_NOT_FOUND
:

880 
ªt
 = 
ECOMMUNITY_BGPSEC_NOT_FOUND
;

882 
ECOMMUNITY_BGPSEC_INVALID
:

883 
ªt
 = 
ECOMMUNITY_BGPSEC_INVALID
;

886 
ªt
 = 
ECOMMUNITY_BGPSEC_UNDEFINED
;

889 
ªt
 = -1;

893  
ªt
;

894 
	}
}

907 
	$bgp_öfo_£t_vÆid©i⁄_ªsu…
 (
bgp_öfo
 *
öfo
,

908 
VÆid©i⁄Resu…Ty≥
 
ªsTy≥
,

909 
uöt8_t
 
rﬂResu…
, uöt8_à
bgp£cResu…
)

912 i‡((
ªsTy≥
 & 
SRX_FLAG_ROA_AND_BGPSEC
) == 0)

914 
	`zlog_debug
 ("NÿSRxÑesu…Örovided! - Upd©ê[0x%08X]", 
öfo
->
upd©eID
);

918 
bgp
 *bg∞
öfo
->
≥î
->bgp;

919 
ªqueue
 = 0;

922 
uöt8_t
 
ﬁdResu…
 = 
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
öfo
);

923 
uöt8_t
 
ﬁdIgn‹e
 = 
	`CHECK_FLAG
 (
öfo
->
Êags
, 
BGP_INFO_IGNORE
) ? 1 : 0;

926 i‡((
ªsTy≥
 & 
SRX_FLAG_ROA
) == SRX_FLAG_ROA)

928 
öfo
->
vÆ_ªs_ROA
 = 
rﬂResu…
;

930 i‡((
ªsTy≥
 & 
SRX_FLAG_BGPSEC
) == SRX_FLAG_BGPSEC)

932 
öfo
->
vÆ_ªs_BGPSEC
 = 
bgp£cResu…
;

937 
boﬁ
 
ign‹eCh™ged
 = 
	`bgp_öfo_£t_ign‹e_Êag
(
öfo
Ë!
ﬁdIgn‹e
;

938 
boﬁ
 
ªsu…Ch™ged
 = 
ﬁdResu…
 !
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
öfo
);

941 
ªqueue
 = 
ign‹eCh™ged
 || 
ªsu…Ch™ged
;

943 i‡(
ªqueue
)

945 
	`§x_bgp_ªqueue_upd©e
(
öfo
);

948 
	}
}

953 
u_öt32_t


954 
	$bgp_med_vÆue
 (
©å
 *©å, 
bgp
 *bgp)

956 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
))

957  
©å
->
med
;

960 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_MED_MISSING_AS_WORST
))

961  
BGP_MED_MAX
;

965 
	}
}

967 #ifde‡
USE_SRX


977 
u_öt32_t
 
	$§x_loc_¥ev_vÆue
(
bgp
* bgp, 
u_öt32_t
 
locPªf
,

978 
vÆResu…
)

980 
§x_loˇl_¥ef
* 
¥efPﬁicy
;

981 
boﬁ
 
isSë
;

983 
vÆResu…
)

985 
SRx_RESULT_VALID
:

986 
¥efPﬁicy
 = &
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_VALID
];

987 
isSë
 = 
¥efPﬁicy
->
is_£t
 > 0;

989 
SRx_RESULT_NOTFOUND
:

990 
¥efPﬁicy
 = &
bgp
->
§x_vÆ_loˇl_¥ef
[
SRx_RESULT_NOTFOUND
];

991 
isSë
 = 
¥efPﬁicy
->
is_£t
 > 0;

993 
SRx_RESULT_INVALID
:

994 
¥efPﬁicy
 = &
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_INVALID
];

995 
isSë
 = 
¥efPﬁicy
->
is_£t
 > 0;

998 
¥efPﬁicy
 = 
NULL
;

999 
isSë
 = 
Ál£
;

1002 i‡(
isSë
)

1004 i‡(
¥efPﬁicy
->
ªœtive
 == 0)

1006 
locPªf
 = 
¥efPﬁicy
->
vÆue
;

1008 i‡(
¥efPﬁicy
->
ªœtive
 == -1)

1010 
locPªf
 = (locPª‡> 
¥efPﬁicy
->
vÆue
) ? (locPref -ÖrefPolicy->value)

1015 
locPªf
 +
¥efPﬁicy
->
vÆue
;

1019  
locPªf
;

1020 
	}
}

1025 
	$bgp_öfo_cmp
 (
bgp
 *bgp, 
bgp_öfo
 *
√w
, bgp_öfÿ*
exi°
,

1026 *
∑ths_eq
)

1028 
©å
 *
√w©å
, *
exi°©å
;

1029 
©å_exåa
 *
√w©åe
, *
exi°©åe
;

1030 
bgp_≥î_s‹t_t
 
√w_s‹t
;

1031 
bgp_≥î_s‹t_t
 
exi°_s‹t
;

1032 
u_öt32_t
 
√w_¥ef
;

1033 
u_öt32_t
 
exi°_¥ef
;

1034 
u_öt32_t
 
√w_med
;

1035 
u_öt32_t
 
exi°_med
;

1036 
u_öt32_t
 
√w_weight
;

1037 
u_öt32_t
 
exi°_weight
;

1038 
uöt32_t
 
√wm
, 
exi°m
;

1039 
ö_addr
 
√w_id
;

1040 
ö_addr
 
exi°_id
;

1041 
√w_˛u°î
;

1042 
exi°_˛u°î
;

1043 
öã∫Æ_as_rouã
;

1044 
c⁄„d_as_rouã
;

1045 
ªt
;

1046 #ifde‡
USE_SRX


1047 
u£_evÆu©i⁄
 = 
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_ORIGIN
)

1048 || 
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_PATH
);

1049 
√w_ªsu…
 = 0;

1050 
exi°_ªsu…
 = 0;

1053 *
∑ths_eq
 = 0;

1056 i‡(
√w
 =
NULL
)

1058 i‡(
exi°
 =
NULL
)

1061 #ifde‡
USE_SRX


1062 i‡(
u£_evÆu©i⁄
)

1068 i‡(
	`CHECK_FLAG
 (
√w
->
Êags
, 
BGP_INFO_IGNORE
))

1070 
	`zlog_debug
("Ign‹êupd©ê[0x%08X] i¿decisi⁄Öro˚ss!", 
√w
->
upd©eID
);

1075 
exi°_ªsu…
 = 
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
exi°
);

1076 
√w_ªsu…
 = 
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
√w
);

1080 
√w©å
 = 
√w
->
©å
;

1081 
exi°©å
 = 
exi°
->
©å
;

1082 
√w©åe
 = 
√w©å
->
exåa
;

1083 
exi°©åe
 = 
exi°©å
->
exåa
;

1086 
√w_weight
 = 
exi°_weight
 = 0;

1088 i‡(
√w©åe
)

1089 
√w_weight
 = 
√w©åe
->
weight
;

1090 i‡(
exi°©åe
)

1091 
exi°_weight
 = 
exi°©åe
->
weight
;

1093 i‡(
√w_weight
 > 
exi°_weight
)

1095 i‡(
√w_weight
 < 
exi°_weight
)

1099 
√w_¥ef
 = 
exi°_¥ef
 = 
bgp
->
deÁu…_loˇl_¥ef
;

1101 i‡(
√w©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
))

1102 
√w_¥ef
 = 
√w©å
->
loˇl_¥ef
;

1103 i‡(
exi°©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
))

1104 
exi°_¥ef
 = 
exi°©å
->
loˇl_¥ef
;

1106 #ifde‡
USE_SRX


1107 i‡(
u£_evÆu©i⁄
)

1110 
√w_¥ef
 = 
	`§x_loc_¥ev_vÆue
(
bgp
,Çew_¥ef, 
√w_ªsu…
);

1111 
exi°_¥ef
 = 
	`§x_loc_¥ev_vÆue
(
bgp
,Éxi°_¥ef, 
exi°_ªsu…
);

1115 i‡(
√w_¥ef
 > 
exi°_¥ef
)

1117 i‡(
√w_¥ef
 < 
exi°_¥ef
)

1120 #ifde‡
USE_SRX


1121 i‡(
u£_evÆu©i⁄
 && 
	`CHECK_FLAG
 (
bgp
->
§x_vÆ_pﬁicy
,

1122 
SRX_VAL_POLICY_PREFER_VALID
))

1127 i‡((
√w_ªsu…
 =
SRx_RESULT_VALID
Ë&& (
exi°_ªsu…
 != SRx_RESULT_VALID))

1131 i‡((
√w_ªsu…
 !
SRx_RESULT_VALID
Ë&& (
exi°_ªsu…
 == SRx_RESULT_VALID))

1143 i‡(! (
√w
->
sub_ty≥
 =
BGP_ROUTE_NORMAL
))

1145 i‡(! (
exi°
->
sub_ty≥
 =
BGP_ROUTE_NORMAL
))

1149 i‡(! 
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_ASPATH_IGNORE
))

1151 
exi°_h›s
 = 
	`a•©h_cou¡_h›s
 (
exi°©å
->
a•©h
);

1152 
exi°_c⁄„ds
 = 
	`a•©h_cou¡_c⁄„ds
 (
exi°©å
->
a•©h
);

1154 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_ASPATH_CONFED
))

1156 
a•©h_h›s
;

1158 
a•©h_h›s
 = 
	`a•©h_cou¡_h›s
 (
√w©å
->
a•©h
);

1159 
a•©h_h›s
 +
	`a•©h_cou¡_c⁄„ds
 (
√w©å
->
a•©h
);

1161 i‡–
a•©h_h›s
 < (
exi°_h›s
 + 
exi°_c⁄„ds
))

1163 i‡–
a•©h_h›s
 > (
exi°_h›s
 + 
exi°_c⁄„ds
))

1168 
√wh›s
 = 
	`a•©h_cou¡_h›s
 (
√w©å
->
a•©h
);

1170 i‡(
√wh›s
 < 
exi°_h›s
)

1172 i‡(
√wh›s
 > 
exi°_h›s
)

1178 i‡(
√w©å
->
‹igö
 < 
exi°©å
->origin)

1180 i‡(
√w©å
->
‹igö
 > 
exi°©å
->origin)

1184 
öã∫Æ_as_rouã
 = (
	`a•©h_cou¡_h›s
 (
√w©å
->
a•©h
) == 0

1185 && 
	`a•©h_cou¡_h›s
 (
exi°©å
->
a•©h
) == 0);

1186 
c⁄„d_as_rouã
 = (
	`a•©h_cou¡_c⁄„ds
 (
√w©å
->
a•©h
) > 0

1187 && 
	`a•©h_cou¡_c⁄„ds
 (
exi°©å
->
a•©h
) > 0

1188 && 
	`a•©h_cou¡_h›s
 (
√w©å
->
a•©h
) == 0

1189 && 
	`a•©h_cou¡_h›s
 (
exi°©å
->
a•©h
) == 0);

1191 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_ALWAYS_COMPARE_MED
)

1192 || (
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_MED_CONFED
)

1193 && 
c⁄„d_as_rouã
)

1194 || 
	`a•©h_cmp_À·
 (
√w©å
->
a•©h
, 
exi°©å
->aspath)

1195 || 
	`a•©h_cmp_À·_c⁄„d
 (
√w©å
->
a•©h
, 
exi°©å
->aspath)

1196 || 
öã∫Æ_as_rouã
)

1198 
√w_med
 = 
	`bgp_med_vÆue
 (
√w
->
©å
, 
bgp
);

1199 
exi°_med
 = 
	`bgp_med_vÆue
 (
exi°
->
©å
, 
bgp
);

1201 i‡(
√w_med
 < 
exi°_med
)

1203 i‡(
√w_med
 > 
exi°_med
)

1208 
√w_s‹t
 = 
√w
->
≥î
->
s‹t
;

1209 
exi°_s‹t
 = 
exi°
->
≥î
->
s‹t
;

1211 i‡(
√w_s‹t
 =
BGP_PEER_EBGP


1212 && (
exi°_s‹t
 =
BGP_PEER_IBGP
 ||Éxi°_s‹à=
BGP_PEER_CONFED
))

1214 i‡(
exi°_s‹t
 =
BGP_PEER_EBGP


1215 && (
√w_s‹t
 =
BGP_PEER_IBGP
 ||Çew_s‹à=
BGP_PEER_CONFED
))

1219 
√wm
 = 
exi°m
 = 0;

1221 i‡(
√w
->
exåa
)

1222 
√wm
 = 
√w
->
exåa
->
igpmëric
;

1223 i‡(
exi°
->
exåa
)

1224 
exi°m
 = 
exi°
->
exåa
->
igpmëric
;

1226 i‡(
√wm
 < 
exi°m
)

1227 
ªt
 = 1;

1228 i‡(
√wm
 > 
exi°m
)

1229 
ªt
 = 0;

1232 i‡(
√wm
 =
exi°m
)

1234 i‡(
√w
->
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

1236 i‡(
	`a•©h_cmp
 (
√w
->
©å
->
a•©h
, 
exi°
->attr->aspath))

1237 *
∑ths_eq
 = 1;

1239 i‡(
√w
->
≥î
->
as
 =
exi°
->peer->as)

1240 *
∑ths_eq
 = 1;

1248  
ªt
;

1255 i‡(! 
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_COMPARE_ROUTER_ID
)

1256 && 
√w_s‹t
 =
BGP_PEER_EBGP


1257 && 
exi°_s‹t
 =
BGP_PEER_EBGP
)

1259 i‡(
	`CHECK_FLAG
 (
√w
->
Êags
, 
BGP_INFO_SELECTED
))

1261 i‡(
	`CHECK_FLAG
 (
exi°
->
Êags
, 
BGP_INFO_SELECTED
))

1266 i‡(
√w©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_ORIGINATOR_ID
))

1267 
√w_id
.
s_addr
 = 
√w©åe
->
‹igö©‹_id
.s_addr;

1269 
√w_id
.
s_addr
 = 
√w
->
≥î
->
ªmŸe_id
.s_addr;

1270 i‡(
exi°©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_ORIGINATOR_ID
))

1271 
exi°_id
.
s_addr
 = 
exi°©åe
->
‹igö©‹_id
.s_addr;

1273 
exi°_id
.
s_addr
 = 
exi°
->
≥î
->
ªmŸe_id
.s_addr;

1275 i‡(
	`¡ohl
 (
√w_id
.
s_addr
Ë<Çtoh»(
exi°_id
.s_addr))

1277 i‡(
	`¡ohl
 (
√w_id
.
s_addr
Ë>Çtoh»(
exi°_id
.s_addr))

1281 
√w_˛u°î
 = 
exi°_˛u°î
 = 0;

1283 i‡(
√w©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_CLUSTER_LIST
))

1284 
√w_˛u°î
 = 
√w©åe
->
˛u°î
->
Àngth
;

1285 i‡(
exi°©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_CLUSTER_LIST
))

1286 
exi°_˛u°î
 = 
exi°©åe
->
˛u°î
->
Àngth
;

1288 i‡(
√w_˛u°î
 < 
exi°_˛u°î
)

1290 i‡(
√w_˛u°î
 > 
exi°_˛u°î
)

1294 
ªt
 = 
	`sockuni⁄_cmp
 (
√w
->
≥î
->
su_ªmŸe
, 
exi°
->peer->su_remote);

1296 i‡(
ªt
 == 1)

1298 i‡(
ªt
 == -1)

1302 
	}
}

1304 
fûãr_ty≥


1305 
	$bgp_öput_fûãr
 (
≥î
 *≥î, 
¥efix
 *
p
, 
©å
 *attr,

1306 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1308 
bgp_fûãr
 *
fûãr
;

1310 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1312 
	#FILTER_EXIST_WARN
(
F
,
f
,
fûãr
) \

1313 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
) \

1314 && !(
F
 ## 
	`_IN
 (
fûãr
))) \

1315 
	`∂og_w¨n
 (
≥î
->
log
, "%s: CouldÇot find configured input %s-list %s!", \

1316 
≥î
->
ho°
, #f, 
F
 ## 
	`_IN_NAME
(
fûãr
));

	)

1318 i‡(
	`DISTRIBUTE_IN_NAME
 (
fûãr
)) {

1319 
	`FILTER_EXIST_WARN
(
DISTRIBUTE
, 
di°ribuã
, 
fûãr
);

1321 i‡(
	`ac˚ss_li°_≠∂y
 (
	`DISTRIBUTE_IN
 (
fûãr
), 
p
Ë=
FILTER_DENY
)

1322  
FILTER_DENY
;

1325 i‡(
	`PREFIX_LIST_IN_NAME
 (
fûãr
)) {

1326 
	`FILTER_EXIST_WARN
(
PREFIX_LIST
, 
¥efix
, 
fûãr
);

1328 i‡(
	`¥efix_li°_≠∂y
 (
	`PREFIX_LIST_IN
 (
fûãr
), 
p
Ë=
PREFIX_DENY
)

1329  
FILTER_DENY
;

1332 i‡(
	`FILTER_LIST_IN_NAME
 (
fûãr
)) {

1333 
	`FILTER_EXIST_WARN
(
FILTER_LIST
, 
as
, 
fûãr
);

1335 i‡(
	`as_li°_≠∂y
 (
	`FILTER_LIST_IN
 (
fûãr
), 
©å
->
a•©h
)=
AS_FILTER_DENY
)

1336  
FILTER_DENY
;

1339  
FILTER_PERMIT
;

1340 #unde‡
FILTER_EXIST_WARN


1341 
	}
}

1343 
fûãr_ty≥


1344 
	$bgp_ouçut_fûãr
 (
≥î
 *≥î, 
¥efix
 *
p
, 
©å
 *attr,

1345 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1347 
bgp_fûãr
 *
fûãr
;

1349 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1351 
	#FILTER_EXIST_WARN
(
F
,
f
,
fûãr
) \

1352 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_OUT
) \

1353 && !(
F
 ## 
	`_OUT
 (
fûãr
))) \

1354 
	`∂og_w¨n
 (
≥î
->
log
, "%s: CouldÇot find configured output %s-list %s!", \

1355 
≥î
->
ho°
, #f, 
F
 ## 
	`_OUT_NAME
(
fûãr
));

	)

1357 i‡(
	`DISTRIBUTE_OUT_NAME
 (
fûãr
)) {

1358 
	`FILTER_EXIST_WARN
(
DISTRIBUTE
, 
di°ribuã
, 
fûãr
);

1360 i‡(
	`ac˚ss_li°_≠∂y
 (
	`DISTRIBUTE_OUT
 (
fûãr
), 
p
Ë=
FILTER_DENY
)

1361  
FILTER_DENY
;

1364 i‡(
	`PREFIX_LIST_OUT_NAME
 (
fûãr
)) {

1365 
	`FILTER_EXIST_WARN
(
PREFIX_LIST
, 
¥efix
, 
fûãr
);

1367 i‡(
	`¥efix_li°_≠∂y
 (
	`PREFIX_LIST_OUT
 (
fûãr
), 
p
Ë=
PREFIX_DENY
)

1368  
FILTER_DENY
;

1371 i‡(
	`FILTER_LIST_OUT_NAME
 (
fûãr
)) {

1372 
	`FILTER_EXIST_WARN
(
FILTER_LIST
, 
as
, 
fûãr
);

1374 i‡(
	`as_li°_≠∂y
 (
	`FILTER_LIST_OUT
 (
fûãr
), 
©å
->
a•©h
Ë=
AS_FILTER_DENY
)

1375  
FILTER_DENY
;

1378  
FILTER_PERMIT
;

1379 #unde‡
FILTER_EXIST_WARN


1380 
	}
}

1384 
	$bgp_communôy_fûãr
 (
≥î
 *≥î, 
©å
 *attr)

1386 i‡(
©å
->
communôy
)

1389 i‡(
	`communôy_ö˛ude
 (
©å
->
communôy
, 
COMMUNITY_NO_ADVERTISE
))

1393 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP
 &&

1394 
	`communôy_ö˛ude
 (
©å
->
communôy
, 
COMMUNITY_NO_EXPORT
))

1398 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP


1399 || 
≥î
->
s‹t
 =
BGP_PEER_CONFED
)

1400 i‡(
	`communôy_ö˛ude
 (
©å
->
communôy
, 
COMMUNITY_NO_EXPORT_SUBCONFED
))

1404 
	}
}

1408 
	$bgp_˛u°î_fûãr
 (
≥î
 *≥î, 
©å
 *attr)

1410 
ö_addr
 
˛u°î_id
;

1412 i‡(
©å
->
exåa
 &&áâr->exåa->
˛u°î
)

1414 i‡(
≥î
->
bgp
->
c⁄fig
 & 
BGP_CONFIG_CLUSTER_ID
)

1415 
˛u°î_id
 = 
≥î
->
bgp
->cluster_id;

1417 
˛u°î_id
 = 
≥î
->
bgp
->
rouãr_id
;

1419 i‡(
	`˛u°î_lo›_check
 (
©å
->
exåa
->
˛u°î
, 
˛u°î_id
))

1423 
	}
}

1426 
	$bgp_öput_modifõr
 (
≥î
 *≥î, 
¥efix
 *
p
, 
©å
 *attr,

1427 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1429 
bgp_fûãr
 *
fûãr
;

1430 
bgp_öfo
 
öfo
;

1431 
rouã_m≠_ªsu…_t
 
ªt
;

1433 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1436 i‡(
≥î
->
weight
)

1437 (
	`bgp_©å_exåa_gë
 (
©å
))->
weight
 = 
≥î
->weight;

1440 i‡(
	`ROUTE_MAP_IN_NAME
 (
fûãr
))

1443 
öfo
.
≥î
 =Öeer;

1444 
öfo
.
©å
 =áttr;

1446 
	`SET_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_IN
);

1449 
ªt
 = 
	`rouã_m≠_≠∂y
 (
	`ROUTE_MAP_IN
 (
fûãr
), 
p
, 
RMAP_BGP
, &
öfo
);

1451 
≥î
->
rm≠_ty≥
 = 0;

1453 i‡(
ªt
 =
RMAP_DENYMATCH
)

1456 
	`bgp_©å_Êush
 (
©å
);

1457  
RMAP_DENY
;

1460  
RMAP_PERMIT
;

1461 
	}
}

1464 
	$bgp_exp‹t_modifõr
 (
≥î
 *
rs˛õ¡
, peer *peer,

1465 
¥efix
 *
p
, 
©å
 *©å, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1467 
bgp_fûãr
 *
fûãr
;

1468 
bgp_öfo
 
öfo
;

1469 
rouã_m≠_ªsu…_t
 
ªt
;

1471 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1474 i‡(
	`ROUTE_MAP_EXPORT_NAME
 (
fûãr
))

1477 
öfo
.
≥î
 = 
rs˛õ¡
;

1478 
öfo
.
©å
 =áttr;

1480 
	`SET_FLAG
 (
rs˛õ¡
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_EXPORT
);

1483 
ªt
 = 
	`rouã_m≠_≠∂y
 (
	`ROUTE_MAP_EXPORT
 (
fûãr
), 
p
, 
RMAP_BGP
, &
öfo
);

1485 
rs˛õ¡
->
rm≠_ty≥
 = 0;

1487 i‡(
ªt
 =
RMAP_DENYMATCH
)

1490 
	`bgp_©å_Êush
 (
©å
);

1491  
RMAP_DENY
;

1494  
RMAP_PERMIT
;

1495 
	}
}

1498 
	$bgp_imp‹t_modifõr
 (
≥î
 *
rs˛õ¡
, peer *peer,

1499 
¥efix
 *
p
, 
©å
 *©å, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1501 
bgp_fûãr
 *
fûãr
;

1502 
bgp_öfo
 
öfo
;

1503 
rouã_m≠_ªsu…_t
 
ªt
;

1505 
fûãr
 = &
rs˛õ¡
->fûãr[
afi
][
ßfi
];

1508 i‡(
≥î
->
weight
)

1509 (
	`bgp_©å_exåa_gë
 (
©å
))->
weight
 = 
≥î
->weight;

1512 i‡(
	`ROUTE_MAP_IMPORT_NAME
 (
fûãr
))

1515 
öfo
.
≥î
 =Öeer;

1516 
öfo
.
©å
 =áttr;

1518 
	`SET_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_IMPORT
);

1521 
ªt
 = 
	`rouã_m≠_≠∂y
 (
	`ROUTE_MAP_IMPORT
 (
fûãr
), 
p
, 
RMAP_BGP
, &
öfo
);

1523 
≥î
->
rm≠_ty≥
 = 0;

1525 i‡(
ªt
 =
RMAP_DENYMATCH
)

1528 
	`bgp_©å_Êush
 (
©å
);

1529  
RMAP_DENY
;

1532  
RMAP_PERMIT
;

1533 
	}
}

1536 
	$bgp_™noun˚_check
 (
bgp_öfo
 *
ri
, 
≥î
 *≥î, 
¥efix
 *
p
,

1537 
©å
 *©å, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1539 
ªt
;

1540 
buf
[
SU_ADDRSTRLEN
];

1541 
bgp_fûãr
 *
fûãr
;

1542 
≥î
 *
‰om
;

1543 
bgp
 *bgp;

1544 
å™•¨ít
;

1545 
ªÊe˘
;

1546 
©å
 *
rüâr
;

1548 
‰om
 = 
ri
->
≥î
;

1549 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1550 
bgp
 = 
≥î
->bgp;

1551 
rüâr
 = 
	`bgp_öfo_m∑th_cou¡
 (
ri
Ë? 
	`bgp_öfo_m∑th_©å
 (riË:Ñi->
©å
;

1553 i‡(
DISABLE_BGP_ANNOUNCE
)

1557 i‡(
	`CHECK_FLAG
(
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

1561 i‡(
‰om
 =
≥î
)

1565 i‡(
p
->
Ámûy
 =
AF_INET


1566 && 
	`IPV4_ADDR_SAME
(&
≥î
->
ªmŸe_id
, &
rüâr
->
√xth›
))

1568 #ifde‡
HAVE_IPV6


1569 i‡(
p
->
Ámûy
 =
AF_INET6


1570 && 
	`IPV6_ADDR_SAME
(&
≥î
->
ªmŸe_id
, &
rüâr
->
√xth›
))

1575 i‡(
ri
->
exåa
 &&Ñi->exåa->
suµªss
)

1576 i‡(! 
	`UNSUPPRESS_MAP_NAME
 (
fûãr
))

1580 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_DEFAULT_ORIGINATE
))

1582 i‡(
p
->
Ámûy
 =
AF_INET
 &&Ö->
u
.
¥efix4
.
s_addr
 =
INADDR_ANY
)

1584 #ifde‡
HAVE_IPV6


1585 i‡(
p
->
Ámûy
 =
AF_INET6
 &&Ö->
¥efixÀn
 == 0)

1591 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
)

1592 && 
	`CHECK_FLAG
 (
‰om
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

1593 
å™•¨ít
 = 1;

1595 
å™•¨ít
 = 0;

1598 i‡(! 
å™•¨ít
 && 
	`bgp_communôy_fûãr
 (
≥î
, 
rüâr
))

1603 i‡(
rüâr
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGINATOR_ID
))

1605 i‡(
	`IPV4_ADDR_SAME
 (&
≥î
->
ªmŸe_id
, &
rüâr
->
exåa
->
‹igö©‹_id
))

1607 i‡(
	`BGP_DEBUG
 (
fûãr
, 
FILTER
))

1608 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

1610 
≥î
->
ho°
,

1611 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

1612 
p
->
¥efixÀn
);

1618 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
)

1619 && (
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_RCV
)

1620 || 
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_OLD_RCV
)))

1621 i‡(
≥î
->
‹f_∂i°
[
afi
][
ßfi
])

1623 i‡(
	`¥efix_li°_≠∂y
 (
≥î
->
‹f_∂i°
[
afi
][
ßfi
], 
p
Ë=
PREFIX_DENY
)

1628 i‡(
	`bgp_ouçut_fûãr
 (
≥î
, 
p
, 
rüâr
, 
afi
, 
ßfi
Ë=
FILTER_DENY
)

1630 i‡(
	`BGP_DEBUG
 (
fûãr
, 
FILTER
))

1631 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

1633 
≥î
->
ho°
,

1634 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

1635 
p
->
¥efixÀn
);

1639 #ifde‡
BGP_SEND_ASPATH_CHECK


1641 i‡(
	`a•©h_lo›_check
 (
rüâr
->
a•©h
, 
≥î
->
as
))

1643 i‡(
	`BGP_DEBUG
 (
fûãr
, 
FILTER
))

1644 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

1646 
≥î
->
ho°
,Öìr->
as
);

1652 i‡(
	`CHECK_FLAG
(
bgp
->
c⁄fig
, 
BGP_CONFIG_CONFEDERATION
))

1654 i‡(
	`a•©h_lo›_check
(
rüâr
->
a•©h
, 
bgp
->
c⁄„d_id
))

1656 i‡(
	`BGP_DEBUG
 (
fûãr
, 
FILTER
))

1657 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

1659 
≥î
->
ho°
,

1660 
bgp
->
c⁄„d_id
);

1666 i‡(
‰om
->
s‹t
 =
BGP_PEER_IBGP
 && 
≥î
->sort == BGP_PEER_IBGP)

1667 
ªÊe˘
 = 1;

1669 
ªÊe˘
 = 0;

1672 i‡(
ªÊe˘
)

1675 i‡(
	`CHECK_FLAG
 (
‰om
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_REFLECTOR_CLIENT
))

1681 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_NO_CLIENT_TO_CLIENT
))

1682 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_REFLECTOR_CLIENT
))

1689 i‡(! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_REFLECTOR_CLIENT
))

1695 
	`bgp_©å_dup
 (
©å
, 
rüâr
);

1698 i‡((
≥î
->
s‹t
 =
BGP_PEER_IBGP


1699 || 
≥î
->
s‹t
 =
BGP_PEER_CONFED
)

1700 && (! (
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
))))

1702 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
);

1703 
©å
->
loˇl_¥ef
 = 
bgp
->
deÁu…_loˇl_¥ef
;

1707 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP


1708 && 
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
))

1710 i‡(
ri
->
≥î
 !
bgp
->
≥î_£lf
 && ! 
å™•¨ít


1711 && ! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MED_UNCHANGED
))

1712 
©å
->
Êag
 &~(
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
));

1716 i‡(
å™•¨ít
 || 
ªÊe˘


1717 || (
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_UNCHANGED
)

1718 && ((
p
->
Ámûy
 =
AF_INET
 && 
©å
->
√xth›
.
s_addr
)

1719 #ifde‡
HAVE_IPV6


1720 || (
p
->
Ámûy
 =
AF_INET6
 &&

1721 ! 
	`IN6_IS_ADDR_UNSPECIFIED
(&
©å
->
exåa
->
mp_√xth›_globÆ
))

1727 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_SELF
)

1728 || (
p
->
Ámûy
 =
AF_INET
 && 
©å
->
√xth›
.
s_addr
 == 0)

1729 #ifde‡
HAVE_IPV6


1730 || (
p
->
Ámûy
 =
AF_INET6
 &&

1731 
	`IN6_IS_ADDR_UNSPECIFIED
(&
©å
->
exåa
->
mp_√xth›_globÆ
))

1733 || (
≥î
->
s‹t
 =
BGP_PEER_EBGP


1734 && 
	`bgp_mu…üc˚ss_check_v4
 (
©å
->
√xth›
, 
≥î
->
ho°
) == 0))

1737 i‡(
p
->
Ámûy
 =
AF_INET
)

1739 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

1740 
	`mem˝y
 (&
©å
->
exåa
->
mp_√xth›_globÆ_ö
, &
≥î
->
√xth›
.
v4
,

1741 
IPV4_MAX_BYTELEN
);

1743 
	`mem˝y
 (&
©å
->
√xth›
, &
≥î
->√xth›.
v4
, 
IPV4_MAX_BYTELEN
);

1745 #ifde‡
HAVE_IPV6


1747 i‡(
p
->
Ámûy
 =
AF_INET6
)

1750 
	`mem˝y
 (&
©å
->
exåa
->
mp_√xth›_globÆ
, &
≥î
->
√xth›
.
v6_globÆ
,

1751 
IPV6_MAX_BYTELEN
);

1752 
©å
->
exåa
->
mp_√xth›_Àn
 = 16;

1757 #ifde‡
HAVE_IPV6


1758 i‡(
p
->
Ámûy
 =
AF_INET6
)

1761 i‡–
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
],

1762 
PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
) )

1764 i‡–
	`IN6_IS_ADDR_LINKLOCAL
 (&
©å
->
exåa
->
mp_√xth›_loˇl
) )

1765 
©å
->
exåa
->
mp_√xth›_Àn
=32;

1767 
©å
->
exåa
->
mp_√xth›_Àn
=16;

1774 
©å
->
exåa
->
mp_√xth›_Àn
 = 16;

1777 i‡(
≥î
->
sh¨ed_√tw‹k


1778 && ! 
	`IN6_IS_ADDR_UNSPECIFIED
 (&
≥î
->
√xth›
.
v6_loˇl
))

1780 
	`mem˝y
 (&
©å
->
exåa
->
mp_√xth›_loˇl
, &
≥î
->
√xth›
.
v6_loˇl
,

1781 
IPV6_MAX_BYTELEN
);

1782 
©å
->
exåa
->
mp_√xth›_Àn
 = 32;

1787 i‡(
ªÊe˘
)

1788 
©å
->
exåa
->
mp_√xth›_Àn
 = 16;

1791 i‡(! 
	`IN6_IS_ADDR_LINKLOCAL
 (&
≥î
->
√xth›
.
v6_loˇl
))

1792 
©å
->
exåa
->
mp_√xth›_Àn
 = 16;

1799 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP


1800 && 
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_REMOVE_PRIVATE_AS
)

1801 && 
	`a•©h_¥iv©e_as_check
 (
©å
->
a•©h
))

1802 
©å
->
a•©h
 = 
	`a•©h_em±y_gë
 ();

1805 i‡(
	`ROUTE_MAP_OUT_NAME
 (
fûãr
)

1806 || (
ri
->
exåa
 &&Ñi->exåa->
suµªss
) )

1808 
bgp_öfo
 
öfo
;

1809 
©å
 
dummy_©å
;

1810 
©å_exåa
 
dummy_exåa
;

1812 
dummy_©å
.
exåa
 = &
dummy_exåa
;

1814 
öfo
.
≥î
 =Öeer;

1815 
öfo
.
©å
 =áttr;

1819 i‡(
‰om
->
s‹t
 =
BGP_PEER_IBGP


1820 && 
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

1822 
	`bgp_©å_dup
 (&
dummy_©å
, 
©å
);

1823 
öfo
.
©å
 = &
dummy_©å
;

1826 
	`SET_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_OUT
);

1828 i‡(
ri
->
exåa
 &&Ñi->exåa->
suµªss
)

1829 
ªt
 = 
	`rouã_m≠_≠∂y
 (
	`UNSUPPRESS_MAP
 (
fûãr
), 
p
, 
RMAP_BGP
, &
öfo
);

1831 
ªt
 = 
	`rouã_m≠_≠∂y
 (
	`ROUTE_MAP_OUT
 (
fûãr
), 
p
, 
RMAP_BGP
, &
öfo
);

1833 
≥î
->
rm≠_ty≥
 = 0;

1835 i‡(
ªt
 =
RMAP_DENYMATCH
)

1837 
	`bgp_©å_Êush
 (
©å
);

1842 
	}
}

1845 
	$bgp_™noun˚_check_rs˛õ¡
 (
bgp_öfo
 *
ri
, 
≥î
 *
rs˛õ¡
,

1846 
¥efix
 *
p
, 
©å
 *©å, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1848 
ªt
;

1849 
buf
[
SU_ADDRSTRLEN
];

1850 
bgp_fûãr
 *
fûãr
;

1851 
bgp_öfo
 
öfo
;

1852 
≥î
 *
‰om
;

1853 
©å
 *
rüâr
;

1855 
‰om
 = 
ri
->
≥î
;

1856 
fûãr
 = &
rs˛õ¡
->fûãr[
afi
][
ßfi
];

1857 
rüâr
 = 
	`bgp_öfo_m∑th_cou¡
 (
ri
Ë? 
	`bgp_öfo_m∑th_©å
 (riË:Ñi->
©å
;

1859 i‡(
DISABLE_BGP_ANNOUNCE
)

1863 i‡(
‰om
 =
rs˛õ¡
)

1867 i‡(
ri
->
exåa
 &&Ñi->exåa->
suµªss
)

1868 i‡(! 
	`UNSUPPRESS_MAP_NAME
 (
fûãr
))

1872 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
af_sÊags
[
afi
][
ßfi
],

1873 
PEER_STATUS_DEFAULT_ORIGINATE
))

1875 i‡(
p
->
Ámûy
 =
AF_INET
 &&Ö->
u
.
¥efix4
.
s_addr
 =
INADDR_ANY
)

1877 #ifde‡
HAVE_IPV6


1878 i‡(
p
->
Ámûy
 =
AF_INET6
 &&Ö->
¥efixÀn
 == 0)

1885 i‡(
rüâr
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGINATOR_ID
))

1887 i‡(
	`IPV4_ADDR_SAME
 (&
rs˛õ¡
->
ªmŸe_id
,

1888 &
rüâr
->
exåa
->
‹igö©‹_id
))

1890 i‡(
	`BGP_DEBUG
 (
fûãr
, 
FILTER
))

1891 
	`zlog
 (
rs˛õ¡
->
log
, 
LOG_DEBUG
,

1893 
rs˛õ¡
->
ho°
,

1894 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

1895 
p
->
¥efixÀn
);

1901 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
)

1902 && (
	`CHECK_FLAG
 (
rs˛õ¡
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_RCV
)

1903 || 
	`CHECK_FLAG
 (
rs˛õ¡
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_OLD_RCV
)))

1904 i‡(
rs˛õ¡
->
‹f_∂i°
[
afi
][
ßfi
])

1906 i‡(
	`¥efix_li°_≠∂y
 (
rs˛õ¡
->
‹f_∂i°
[
afi
][
ßfi
], 
p
Ë=
PREFIX_DENY
)

1911 i‡(
	`bgp_ouçut_fûãr
 (
rs˛õ¡
, 
p
, 
rüâr
, 
afi
, 
ßfi
Ë=
FILTER_DENY
)

1913 i‡(
	`BGP_DEBUG
 (
fûãr
, 
FILTER
))

1914 
	`zlog
 (
rs˛õ¡
->
log
, 
LOG_DEBUG
,

1916 
rs˛õ¡
->
ho°
,

1917 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

1918 
p
->
¥efixÀn
);

1922 #ifde‡
BGP_SEND_ASPATH_CHECK


1924 i‡(
	`a•©h_lo›_check
 (
rüâr
->
a•©h
, 
rs˛õ¡
->
as
))

1926 i‡(
	`BGP_DEBUG
 (
fûãr
, 
FILTER
))

1927 
	`zlog
 (
rs˛õ¡
->
log
, 
LOG_DEBUG
,

1929 
rs˛õ¡
->
ho°
,Ñs˛õ¡->
as
);

1935 
	`bgp_©å_dup
 (
©å
, 
rüâr
);

1938 i‡((
p
->
Ámûy
 =
AF_INET
 && 
©å
->
√xth›
.
s_addr
 == 0)

1939 #ifde‡
HAVE_IPV6


1940 || (
p
->
Ámûy
 =
AF_INET6
 &&

1941 
	`IN6_IS_ADDR_UNSPECIFIED
(&
©å
->
exåa
->
mp_√xth›_globÆ
))

1946 i‡(
p
->
Ámûy
 =
AF_INET
)

1948 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

1949 
	`mem˝y
 (&
©å
->
exåa
->
mp_√xth›_globÆ_ö
, &
rs˛õ¡
->
√xth›
.
v4
,

1950 
IPV4_MAX_BYTELEN
);

1952 
	`mem˝y
 (&
©å
->
√xth›
, &
rs˛õ¡
->√xth›.
v4
, 
IPV4_MAX_BYTELEN
);

1954 #ifde‡
HAVE_IPV6


1956 i‡(
p
->
Ámûy
 =
AF_INET6
)

1959 
	`mem˝y
 (&
©å
->
exåa
->
mp_√xth›_globÆ
, &
rs˛õ¡
->
√xth›
.
v6_globÆ
,

1960 
IPV6_MAX_BYTELEN
);

1961 
©å
->
exåa
->
mp_√xth›_Àn
 = 16;

1966 #ifde‡
HAVE_IPV6


1967 i‡(
p
->
Ámûy
 =
AF_INET6
)

1969 
©å_exåa
 *
©åe
 = 
©å
->
exåa
;

1972 i‡–
	`CHECK_FLAG
 (
rs˛õ¡
->
af_Êags
[
afi
][
ßfi
],

1973 
PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
) )

1975 i‡–
	`IN6_IS_ADDR_LINKLOCAL
 (&
©åe
->
mp_√xth›_loˇl
) )

1976 
©åe
->
mp_√xth›_Àn
=32;

1978 
©åe
->
mp_√xth›_Àn
=16;

1985 i‡(
rs˛õ¡
->
sh¨ed_√tw‹k
 && 
‰om
->shared_network &&

1986 (
rs˛õ¡
->
ifödex
 =
‰om
->ifindex))

1988 i‡–
	`IN6_IS_ADDR_LINKLOCAL
 (&
©åe
->
mp_√xth›_loˇl
) )

1989 
©åe
->
mp_√xth›_Àn
=32;

1991 
©åe
->
mp_√xth›_Àn
=16;

1995 i‡(
rs˛õ¡
->
sh¨ed_√tw‹k


1996 && 
	`IN6_IS_ADDR_LINKLOCAL
 (&
rs˛õ¡
->
√xth›
.
v6_loˇl
))

1998 
	`mem˝y
 (&
©åe
->
mp_√xth›_loˇl
, &
rs˛õ¡
->
√xth›
.
v6_loˇl
,

1999 
IPV6_MAX_BYTELEN
);

2000 
©åe
->
mp_√xth›_Àn
 = 32;

2004 
©åe
->
mp_√xth›_Àn
 = 16;

2012 i‡(
rs˛õ¡
->
s‹t
 =
BGP_PEER_EBGP


2013 && 
	`≥î_af_Êag_check
 (
rs˛õ¡
, 
afi
, 
ßfi
, 
PEER_FLAG_REMOVE_PRIVATE_AS
)

2014 && 
	`a•©h_¥iv©e_as_check
 (
©å
->
a•©h
))

2015 
©å
->
a•©h
 = 
	`a•©h_em±y_gë
 ();

2018 i‡(
	`ROUTE_MAP_OUT_NAME
 (
fûãr
Ë|| (
ri
->
exåa
 &&Ñi->exåa->
suµªss
) )

2020 
öfo
.
≥î
 = 
rs˛õ¡
;

2021 
öfo
.
©å
 =áttr;

2023 
	`SET_FLAG
 (
rs˛õ¡
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_OUT
);

2025 i‡(
ri
->
exåa
 &&Ñi->exåa->
suµªss
)

2026 
ªt
 = 
	`rouã_m≠_≠∂y
 (
	`UNSUPPRESS_MAP
 (
fûãr
), 
p
, 
RMAP_BGP
, &
öfo
);

2028 
ªt
 = 
	`rouã_m≠_≠∂y
 (
	`ROUTE_MAP_OUT
 (
fûãr
), 
p
, 
RMAP_BGP
, &
öfo
);

2030 
rs˛õ¡
->
rm≠_ty≥
 = 0;

2032 i‡(
ªt
 =
RMAP_DENYMATCH
)

2034 
	`bgp_©å_Êush
 (
©å
);

2040 
	}
}

2042 
	sbgp_öfo_∑ú


2044 
bgp_öfo
 *
	mﬁd
;

2045 
bgp_öfo
 *
	m√w
;

2049 
	$bgp_be°_£À˘i⁄
 (
bgp
 *bgp, 
bgp_node
 *
∫
,

2050 
bgp_max∑ths_cfg
 *
m∑th_cfg
,

2051 
bgp_öfo_∑ú
 *
ªsu…
)

2053 
bgp_öfo
 *
√w_£À˘
;

2054 
bgp_öfo
 *
ﬁd_£À˘
;

2055 
bgp_öfo
 *
ri
;

2056 
bgp_öfo
 *
ri1
;

2057 
bgp_öfo
 *
ri2
;

2058 
bgp_öfo
 *
√xåi
 = 
NULL
;

2059 
∑ths_eq
, 
do_m∑th
;

2060 
li°
 
mp_li°
;

2062 
	`bgp_mp_li°_öô
 (&
mp_li°
);

2063 
do_m∑th
 = (
m∑th_cfg
->
max∑ths_ebgp
 !
BGP_DEFAULT_MAXPATHS
 ||

2064 
m∑th_cfg
->
max∑ths_ibgp
 !
BGP_DEFAULT_MAXPATHS
);

2067 
√w_£À˘
 = 
NULL
;

2068 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
))

2069 
ri1
 = 
∫
->
öfo
;Ñi1;Ñi1 =Ñi1->
√xt
)

2071 i‡(
	`CHECK_FLAG
 (
ri1
->
Êags
, 
BGP_INFO_DMED_CHECK
))

2073 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri1
))

2076 
√w_£À˘
 = 
ri1
;

2077 i‡(
do_m∑th
)

2078 
	`bgp_mp_li°_add
 (&
mp_li°
, 
ri1
);

2079 
ﬁd_£À˘
 = 
	`CHECK_FLAG
 (
ri1
->
Êags
, 
BGP_INFO_SELECTED
Ë?Ñi1 : 
NULL
;

2080 i‡(
ri1
->
√xt
)

2081 
ri2
 = 
ri1
->
√xt
;Ñi2;Ñi2 =Ñi2->next)

2083 i‡(
	`CHECK_FLAG
 (
ri2
->
Êags
, 
BGP_INFO_DMED_CHECK
))

2085 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri2
))

2088 i‡(
	`a•©h_cmp_À·
 (
ri1
->
©å
->
a•©h
, 
ri2
->attr->aspath)

2089 || 
	`a•©h_cmp_À·_c⁄„d
 (
ri1
->
©å
->
a•©h
,

2090 
ri2
->
©å
->
a•©h
))

2092 i‡(
	`CHECK_FLAG
 (
ri2
->
Êags
, 
BGP_INFO_SELECTED
))

2093 
ﬁd_£À˘
 = 
ri2
;

2094 i‡(
	`bgp_öfo_cmp
 (
bgp
, 
ri2
, 
√w_£À˘
, &
∑ths_eq
))

2096 
	`bgp_öfo_un£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_DMED_SELECTED
);

2097 
√w_£À˘
 = 
ri2
;

2098 i‡(
do_m∑th
 && !
∑ths_eq
)

2100 
	`bgp_mp_li°_˛ór
 (&
mp_li°
);

2101 
	`bgp_mp_li°_add
 (&
mp_li°
, 
ri2
);

2105 i‡(
do_m∑th
 && 
∑ths_eq
)

2106 
	`bgp_mp_li°_add
 (&
mp_li°
, 
ri2
);

2108 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri2
, 
BGP_INFO_DMED_CHECK
);

2111 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_DMED_CHECK
);

2112 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_DMED_SELECTED
);

2114 
	`bgp_öfo_m∑th_upd©e
 (
∫
, 
√w_£À˘
, 
ﬁd_£À˘
, &
mp_li°
, 
m∑th_cfg
);

2115 
	`bgp_mp_li°_˛ór
 (&
mp_li°
);

2119 
ﬁd_£À˘
 = 
NULL
;

2120 
√w_£À˘
 = 
NULL
;

2121 
ri
 = 
∫
->
öfo
; (rò!
NULL
Ë&& (
√xåi
 =Ñi->
√xt
, 1);Ñi =Çextri)

2123 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_SELECTED
))

2124 
ﬁd_£À˘
 = 
ri
;

2126 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri
))

2131 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_REMOVED
)

2132 && (
ri
 !
ﬁd_£À˘
))

2133 
	`bgp_öfo_ª≠
 (
∫
, 
ri
);

2138 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
)

2139 && (! 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_DMED_SELECTED
)))

2141 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_DMED_CHECK
);

2144 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_DMED_CHECK
);

2145 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_DMED_SELECTED
);

2147 i‡(
	`bgp_öfo_cmp
 (
bgp
, 
ri
, 
√w_£À˘
, &
∑ths_eq
))

2149 i‡(
do_m∑th
 && 
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
))

2150 
	`bgp_mp_dmed_de£À˘
 (
√w_£À˘
);

2152 
√w_£À˘
 = 
ri
;

2154 i‡(
do_m∑th
 && !
∑ths_eq
)

2156 
	`bgp_mp_li°_˛ór
 (&
mp_li°
);

2157 
	`bgp_mp_li°_add
 (&
mp_li°
, 
ri
);

2160 i‡(
do_m∑th
 && 
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
))

2161 
	`bgp_mp_dmed_de£À˘
 (
ri
);

2163 i‡(
do_m∑th
 && 
∑ths_eq
)

2164 
	`bgp_mp_li°_add
 (&
mp_li°
, 
ri
);

2168 i‡(!
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
))

2169 
	`bgp_öfo_m∑th_upd©e
 (
∫
, 
√w_£À˘
, 
ﬁd_£À˘
, &
mp_li°
, 
m∑th_cfg
);

2171 
	`bgp_öfo_m∑th_aggªg©e_upd©e
 (
√w_£À˘
, 
ﬁd_£À˘
);

2172 
	`bgp_mp_li°_˛ór
 (&
mp_li°
);

2174 
ªsu…
->
ﬁd
 = 
ﬁd_£À˘
;

2175 
ªsu…
->
√w
 = 
√w_£À˘
;

2178 
	}
}

2181 
	$bgp_¥o˚ss_™noun˚_£À˘ed
 (
≥î
 *≥î, 
bgp_öfo
 *
£À˘ed
,

2182 
bgp_node
 *
∫
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

2184 
¥efix
 *
p
;

2185 
©å
áttr;

2186 
©å_exåa
 
exåa
;

2188 
p
 = &
∫
->p;

2191 i‡(
≥î
->
°©us
 !
E°ablished
)

2195 i‡(! 
≥î
->
afc_√go
[
afi
][
ßfi
])

2199 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
],

2200 
PEER_STATUS_ORF_WAIT_REFRESH
))

2204 
©å
.
exåa
 = &extra;

2206 
	`bgp_node_èbÀ
 (
∫
)->
ty≥
)

2208 
BGP_TABLE_MAIN
:

2211 i‡(
£À˘ed
 && 
	`bgp_™noun˚_check
 (£À˘ed, 
≥î
, 
p
, &
©å
, 
afi
, 
ßfi
))

2212 
	`bgp_adj_out_£t
 (
∫
, 
≥î
, 
p
, &
©å
, 
afi
, 
ßfi
, 
£À˘ed
);

2214 
	`bgp_adj_out_un£t
 (
∫
, 
≥î
, 
p
, 
afi
, 
ßfi
);

2216 
BGP_TABLE_RSCLIENT
:

2219 i‡(
£À˘ed
 &&

2220 
	`bgp_™noun˚_check_rs˛õ¡
 (
£À˘ed
, 
≥î
, 
p
, &
©å
, 
afi
, 
ßfi
))

2221 
	`bgp_adj_out_£t
 (
∫
, 
≥î
, 
p
, &
©å
, 
afi
, 
ßfi
, 
£À˘ed
);

2223 
	`bgp_adj_out_un£t
 (
∫
, 
≥î
, 
p
, 
afi
, 
ßfi
);

2228 
	}
}

2230 
	sbgp_¥o˚ss_queue


2232 
bgp
 *
	mbgp
;

2233 
bgp_node
 *
	m∫
;

2234 
afi_t
 
	mafi
;

2235 
ßfi_t
 
	mßfi
;

2238 
wq_ôem_°©us


2239 
	$bgp_¥o˚ss_rs˛õ¡
 (
w‹k_queue
 *
wq
, *
d©a
)

2241 
bgp_¥o˚ss_queue
 *
pq
 = 
d©a
;

2242 
bgp
 *bg∞
pq
->bgp;

2243 
bgp_node
 *
∫
 = 
pq
->rn;

2244 
afi_t
 
afi
 = 
pq
->afi;

2245 
ßfi_t
 
ßfi
 = 
pq
->safi;

2246 
bgp_öfo
 *
√w_£À˘
;

2247 
bgp_öfo
 *
ﬁd_£À˘
;

2248 
bgp_öfo_∑ú
 
ﬁd_™d_√w
;

2249 
li°node
 *
node
, *
¬ode
;

2250 
≥î
 *
rs˛õ¡
 = 
	`bgp_node_èbÀ
 (
∫
)->
ow√r
;

2253 
	`bgp_be°_£À˘i⁄
 (
bgp
, 
∫
, &bgp->
max∑ths
[
afi
][
ßfi
], &
ﬁd_™d_√w
);

2254 
√w_£À˘
 = 
ﬁd_™d_√w
.
√w
;

2255 
ﬁd_£À˘
 = 
ﬁd_™d_√w
.
ﬁd
;

2257 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
sÊags
, 
PEER_STATUS_GROUP
))

2259 i‡(
rs˛õ¡
->
group
)

2260 
	`ALL_LIST_ELEMENTS
 (
rs˛õ¡
->
group
->
≥î
, 
node
, 
¬ode
,Ñsclient))

2263 i‡(
ﬁd_£À˘
 && old_£À˘ =
√w_£À˘
)

2264 i‡(!
	`CHECK_FLAG
 (
ﬁd_£À˘
->
Êags
, 
BGP_INFO_ATTR_CHANGED
))

2267 i‡(
ﬁd_£À˘
)

2268 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ﬁd_£À˘
, 
BGP_INFO_SELECTED
);

2269 i‡(
√w_£À˘
)

2271 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_SELECTED
);

2272 
	`bgp_öfo_un£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_ATTR_CHANGED
);

2273 
	`UNSET_FLAG
 (
√w_£À˘
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
);

2276 
	`bgp_¥o˚ss_™noun˚_£À˘ed
 (
rs˛õ¡
, 
√w_£À˘
, 
∫
,

2277 
afi
, 
ßfi
);

2282 i‡(
ﬁd_£À˘
)

2283 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ﬁd_£À˘
, 
BGP_INFO_SELECTED
);

2284 i‡(
√w_£À˘
)

2286 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_SELECTED
);

2287 
	`bgp_öfo_un£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_ATTR_CHANGED
);

2288 
	`UNSET_FLAG
 (
√w_£À˘
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
);

2290 
	`bgp_¥o˚ss_™noun˚_£À˘ed
 (
rs˛õ¡
, 
√w_£À˘
, 
∫
, 
afi
, 
ßfi
);

2293 i‡(
ﬁd_£À˘
 && 
	`CHECK_FLAG
 (ﬁd_£À˘->
Êags
, 
BGP_INFO_REMOVED
))

2294 
	`bgp_öfo_ª≠
 (
∫
, 
ﬁd_£À˘
);

2296 
	`UNSET_FLAG
 (
∫
->
Êags
, 
BGP_NODE_PROCESS_SCHEDULED
);

2297  
WQ_SUCCESS
;

2298 
	}
}

2300 
wq_ôem_°©us


2301 
	$bgp_¥o˚ss_maö
 (
w‹k_queue
 *
wq
, *
d©a
)

2303 #i‡
	`deföed
 (
__TIME_MEASURE__
)

2304 
tCou¡
=0;

2306 
bgp_¥o˚ss_queue
 *
pq
 = 
d©a
;

2307 
bgp
 *bg∞
pq
->bgp;

2308 
bgp_node
 *
∫
 = 
pq
->rn;

2309 
afi_t
 
afi
 = 
pq
->afi;

2310 
ßfi_t
 
ßfi
 = 
pq
->safi;

2311 
¥efix
 *
p
 = &
∫
->p;

2312 
bgp_öfo
 *
√w_£À˘
;

2313 
bgp_öfo
 *
ﬁd_£À˘
;

2314 
bgp_öfo_∑ú
 
ﬁd_™d_√w
;

2315 
li°node
 *
node
, *
¬ode
;

2316 
≥î
 *peer;

2318 #i‡
	`deföed
 (
__TIME_MEASURE__
)

2320 if(
tCou¡
==0)

2322 
	`¥ötf
("[%s] Sèπ Re˚ivög U±ÿ%ld Cou¡s...\n", 
__FUNCTION__
, 
g_mósuªCou¡
);

2323 
˛k_t0

	`rdtsc
();

2328 
	`bgp_be°_£À˘i⁄
 (
bgp
, 
∫
, &bgp->
max∑ths
[
afi
][
ßfi
], &
ﬁd_™d_√w
);

2329 
ﬁd_£À˘
 = 
ﬁd_™d_√w
.
ﬁd
;

2330 
√w_£À˘
 = 
ﬁd_™d_√w
.
√w
;

2333 i‡(
ﬁd_£À˘
 && old_£À˘ =
√w_£À˘
)

2335 i‡(! 
	`CHECK_FLAG
 (
ﬁd_£À˘
->
Êags
, 
BGP_INFO_ATTR_CHANGED
))

2337 i‡(
	`CHECK_FLAG
 (
ﬁd_£À˘
->
Êags
, 
BGP_INFO_IGP_CHANGED
) ||

2338 
	`CHECK_FLAG
 (
ﬁd_£À˘
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
))

2339 
	`bgp_zebø_™noun˚
 (
p
, 
ﬁd_£À˘
, 
bgp
, 
ßfi
);

2341 
	`UNSET_FLAG
 (
ﬁd_£À˘
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
);

2342 
	`UNSET_FLAG
 (
∫
->
Êags
, 
BGP_NODE_PROCESS_SCHEDULED
);

2343  
WQ_SUCCESS
;

2347 i‡(
ﬁd_£À˘
)

2348 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ﬁd_£À˘
, 
BGP_INFO_SELECTED
);

2349 i‡(
√w_£À˘
)

2351 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_SELECTED
);

2352 
	`bgp_öfo_un£t_Êag
 (
∫
, 
√w_£À˘
, 
BGP_INFO_ATTR_CHANGED
);

2353 
	`UNSET_FLAG
 (
√w_£À˘
->
Êags
, 
BGP_INFO_MULTIPATH_CHG
);

2358 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

2360 
	`bgp_¥o˚ss_™noun˚_£À˘ed
 (
≥î
, 
√w_£À˘
, 
∫
, 
afi
, 
ßfi
);

2364 i‡((
ßfi
 =
SAFI_UNICAST
 || safò=
SAFI_MULTICAST
Ë&& (! 
bgp
->
«me
 &&

2365 ! 
	`bgp_›ti⁄_check
 (
BGP_OPT_NO_FIB
)))

2367 i‡(
√w_£À˘


2368 && 
√w_£À˘
->
ty≥
 =
ZEBRA_ROUTE_BGP


2369 && 
√w_£À˘
->
sub_ty≥
 =
BGP_ROUTE_NORMAL
)

2370 
	`bgp_zebø_™noun˚
 (
p
, 
√w_£À˘
, 
bgp
, 
ßfi
);

2374 i‡(
ﬁd_£À˘


2375 && 
ﬁd_£À˘
->
ty≥
 =
ZEBRA_ROUTE_BGP


2376 && 
ﬁd_£À˘
->
sub_ty≥
 =
BGP_ROUTE_NORMAL
)

2377 
	`bgp_zebø_wôhdøw
 (
p
, 
ﬁd_£À˘
, 
ßfi
);

2382 i‡(
ﬁd_£À˘
 && 
	`CHECK_FLAG
 (ﬁd_£À˘->
Êags
, 
BGP_INFO_REMOVED
))

2383 
	`bgp_öfo_ª≠
 (
∫
, 
ﬁd_£À˘
);

2385 
	`UNSET_FLAG
 (
∫
->
Êags
, 
BGP_NODE_PROCESS_SCHEDULED
);

2386 #i‡
	`deföed
 (
__TIME_MEASURE__
)

2388 
tCou¡
++;

2391 if(
tCou¡
 >= 500000)

2393 
˛k_t1
 = 
	`rdtsc
();

2394 
	`¥öt_˛ock_time
(
˛k_t1
, 
˛k_t0
, "bgp_process_main");

2395 
tCou¡
=0;

2398 
	`¥ötf
–"[%s] cou¡ : %d\n", 
__FUNCTION__
, 
tCou¡
);

2402  
WQ_SUCCESS
;

2403 
	}
}

2406 
	$bgp_¥o˚ssq_dñ
 (
w‹k_queue
 *
wq
, *
d©a
)

2408 
bgp_¥o˚ss_queue
 *
pq
 = 
d©a
;

2409 
bgp_èbÀ
 *
èbÀ
 = 
	`bgp_node_èbÀ
 (
pq
->
∫
);

2411 
	`bgp_u∆ock
 (
pq
->
bgp
);

2412 
	`bgp_u∆ock_node
 (
pq
->
∫
);

2413 
	`bgp_èbÀ_u∆ock
 (
èbÀ
);

2414 
	`XFREE
 (
MTYPE_BGP_PROCESS_QUEUE
, 
pq
);

2415 
	}
}

2418 
	$bgp_¥o˚ss_queue_öô
 ()

2420 
bm
->
¥o˚ss_maö_queue


2421 
	`w‹k_queue_√w
 (
bm
->
ma°î
, "process_main_queue");

2422 
bm
->
¥o˚ss_rs˛õ¡_queue


2423 
	`w‹k_queue_√w
 (
bm
->
ma°î
, "process_rsclient_queue");

2425 i‡–!(
bm
->
¥o˚ss_maö_queue
 && bm->
¥o˚ss_rs˛õ¡_queue
) )

2427 
	`zlog_îr
 ("%s: FaûedÅÿÆloˇã w‹k queue", 
__func__
);

2428 
	`exô
 (1);

2431 
bm
->
¥o˚ss_maö_queue
->
•ec
.
w‹kfunc
 = &
bgp_¥o˚ss_maö
;

2432 
bm
->
¥o˚ss_maö_queue
->
•ec
.
dñ_ôem_d©a
 = &
bgp_¥o˚ssq_dñ
;

2433 
bm
->
¥o˚ss_maö_queue
->
•ec
.
max_ªåõs
 = 0;

2434 
bm
->
¥o˚ss_maö_queue
->
•ec
.
hﬁd
 = 50;

2436 
	`mem˝y
 (
bm
->
¥o˚ss_rs˛õ¡_queue
, bm->
¥o˚ss_maö_queue
,

2437  (
w‹k_queue
 *));

2438 
bm
->
¥o˚ss_rs˛õ¡_queue
->
•ec
.
w‹kfunc
 = &
bgp_¥o˚ss_rs˛õ¡
;

2439 
	}
}

2442 
	$bgp_¥o˚ss
 (
bgp
 *bgp, 
bgp_node
 *
∫
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

2444 
bgp_¥o˚ss_queue
 *
pqnode
;

2447 i‡(
	`CHECK_FLAG
 (
∫
->
Êags
, 
BGP_NODE_PROCESS_SCHEDULED
))

2450 i‡–(
bm
->
¥o˚ss_maö_queue
 =
NULL
) ||

2451 (
bm
->
¥o˚ss_rs˛õ¡_queue
 =
NULL
) )

2452 
	`bgp_¥o˚ss_queue_öô
 ();

2454 
pqnode
 = 
	`XCALLOC
 (
MTYPE_BGP_PROCESS_QUEUE
,

2455  (
bgp_¥o˚ss_queue
));

2456 i‡(!
pqnode
)

2460 
	`bgp_èbÀ_lock
 (
	`bgp_node_èbÀ
 (
∫
));

2461 
pqnode
->
∫
 = 
	`bgp_lock_node
 (rn);

2462 
pqnode
->
bgp
 = bgp;

2463 
	`bgp_lock
 (
bgp
);

2464 
pqnode
->
afi
 =áfi;

2465 
pqnode
->
ßfi
 = safi;

2467 
	`bgp_node_èbÀ
 (
∫
)->
ty≥
)

2469 
BGP_TABLE_MAIN
:

2470 
	`w‹k_queue_add
 (
bm
->
¥o˚ss_maö_queue
, 
pqnode
);

2472 
BGP_TABLE_RSCLIENT
:

2473 
	`w‹k_queue_add
 (
bm
->
¥o˚ss_rs˛õ¡_queue
, 
pqnode
);

2477 
	`SET_FLAG
 (
∫
->
Êags
, 
BGP_NODE_PROCESS_SCHEDULED
);

2479 
	}
}

2482 
	$bgp_maximum_¥efix_ª°¨t_timî
 (
thªad
 *thread)

2484 
≥î
 *peer;

2486 
≥î
 = 
	`THREAD_ARG
 (
thªad
);

2487 
≥î
->
t_pmax_ª°¨t
 = 
NULL
;

2489 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

2490 
	`zlog_debug
 ("%s Maximum-prefixÑestartÅimerÉxpired,ÑestoreÖeering",

2491 
≥î
->
ho°
);

2493 
	`≥î_˛ór
 (
≥î
);

2496 
	}
}

2499 
	$bgp_maximum_¥efix_ovîÊow
 (
≥î
 *≥î, 
afi_t
 
afi
,

2500 
ßfi_t
 
ßfi
, 
Æways
)

2502 i‡(!
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
))

2505 i‡(
≥î
->
pcou¡
[
afi
][
ßfi
] >Öìr->
pmax
[afi][safi])

2507 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_PREFIX_LIMIT
)

2508 && ! 
Æways
)

2511 
	`zlog
 (
≥î
->
log
, 
LOG_INFO
,

2513 "limô %ld", 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
), 
≥î
->
ho°
,

2514 
≥î
->
pcou¡
[
afi
][
ßfi
],Öìr->
pmax
[afi][safi]);

2515 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_PREFIX_LIMIT
);

2517 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
))

2521 
u_öt8_t
 
nd©a
[7];

2523 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

2524 
ßfi
 = 
SAFI_MPLS_LABELED_VPN
;

2526 
nd©a
[0] = (
afi
 >> 8);

2527 
nd©a
[1] = 
afi
;

2528 
nd©a
[2] = 
ßfi
;

2529 
nd©a
[3] = (
≥î
->
pmax
[
afi
][
ßfi
] >> 24);

2530 
nd©a
[4] = (
≥î
->
pmax
[
afi
][
ßfi
] >> 16);

2531 
nd©a
[5] = (
≥î
->
pmax
[
afi
][
ßfi
] >> 8);

2532 
nd©a
[6] = (
≥î
->
pmax
[
afi
][
ßfi
]);

2534 
	`SET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
);

2535 
	`bgp_nŸify_£nd_wôh_d©a
 (
≥î
, 
BGP_NOTIFY_CEASE
,

2536 
BGP_NOTIFY_CEASE_MAX_PREFIX
, 
nd©a
, 7);

2540 i‡(
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
])

2542 
≥î
->
v_pmax_ª°¨t
 =Öìr->
pmax_ª°¨t
[
afi
][
ßfi
] * 60;

2544 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

2545 
	`zlog_debug
 ("%s Maximum-prefixÑestartÅimer started for %d secs",

2546 
≥î
->
ho°
,Öìr->
v_pmax_ª°¨t
);

2548 
	`BGP_TIMER_ON
 (
≥î
->
t_pmax_ª°¨t
, 
bgp_maximum_¥efix_ª°¨t_timî
,

2549 
≥î
->
v_pmax_ª°¨t
);

2555 
	`UNSET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_PREFIX_LIMIT
);

2557 i‡(
≥î
->
pcou¡
[
afi
][
ßfi
] > (≥î->
pmax
[afi][ßfi] *Öìr->
pmax_thªshﬁd
[afi][safi] / 100))

2559 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_PREFIX_THRESHOLD
)

2560 && ! 
Æways
)

2563 
	`zlog
 (
≥î
->
log
, 
LOG_INFO
,

2565 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
), 
≥î
->
ho°
,Öìr->
pcou¡
[afi][safi],

2566 
≥î
->
pmax
[
afi
][
ßfi
]);

2567 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_PREFIX_THRESHOLD
);

2570 
	`UNSET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_PREFIX_THRESHOLD
);

2572 
	}
}

2578 
	$bgp_rib_ªmove
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
, 
≥î
 *peer,

2579 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

2581 
	`bgp_aggªg©e_de¸emít
 (
≥î
->
bgp
, &
∫
->
p
, 
ri
, 
afi
, 
ßfi
);

2583 i‡(!
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_HISTORY
))

2584 
	`bgp_öfo_dñëe
 (
∫
, 
ri
);

2586 
	`bgp_¥o˚ss
 (
≥î
->
bgp
, 
∫
, 
afi
, 
ßfi
);

2587 
	}
}

2590 
	$bgp_rib_wôhdøw
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
, 
≥î
 *peer,

2591 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

2593 
°©us
 = 
BGP_DAMP_NONE
;

2598 i‡(
	`CHECK_FLAG
 (
≥î
->
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
)

2599 && 
≥î
->
s‹t
 =
BGP_PEER_EBGP
)

2600 i‡–(
°©us
 = 
	`bgp_damp_wôhdøw
 (
ri
, 
∫
, 
afi
, 
ßfi
, 0))

2601 =
BGP_DAMP_SUPPRESSED
)

2603 
	`bgp_aggªg©e_de¸emít
 (
≥î
->
bgp
, &
∫
->
p
, 
ri
, 
afi
, 
ßfi
);

2607 
	`bgp_rib_ªmove
 (
∫
, 
ri
, 
≥î
, 
afi
, 
ßfi
);

2608 
	}
}

2611 
	$bgp_upd©e_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

2612 
©å
 *©å, 
≥î
 *≥î, 
¥efix
 *
p
, 
ty≥
,

2613 
sub_ty≥
, 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
)

2615 
bgp_node
 *
∫
;

2616 
bgp
 *bgp;

2617 
©å
 
√w_©å
;

2618 
©å_exåa
 
√w_exåa
;

2619 
©å
 *
©å_√w
;

2620 
©å
 *
©å_√w2
;

2621 
bgp_öfo
 *
ri
;

2622 
bgp_öfo
 *
√w
;

2623 c⁄° *
ªas⁄
;

2624 
buf
[
SU_ADDRSTRLEN
];

2627 i‡(
≥î
 =
rs˛õ¡
)

2630 
bgp
 = 
≥î
->bgp;

2631 
∫
 = 
	`bgp_afi_node_gë
 (
rs˛õ¡
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
¥d
);

2634 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

2635 i‡(
ri
->
≥î
 =≥î &&Ñi->
ty≥
 =ty≥ &&Ñi->
sub_ty≥
 == sub_type)

2639 i‡(
	`a•©h_lo›_check
 (
©å
->
a•©h
, 
rs˛õ¡
->
as
Ë> 
≥î
->
Ælowas_ö
[
afi
][
ßfi
])

2641 
ªas⁄
 = "as-path contains our own AS;";

2642 
fûãªd
;

2646 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGINATOR_ID
)

2647 && 
	`IPV4_ADDR_SAME
 (&
rs˛õ¡
->
ªmŸe_id
, &
©å
->
exåa
->
‹igö©‹_id
))

2649 
ªas⁄
 = "originator is us;";

2650 
fûãªd
;

2653 
√w_©å
.
exåa
 = &
√w_exåa
;

2654 
	`bgp_©å_dup
 (&
√w_©å
, 
©å
);

2657 i‡(
	`CHECK_FLAG
(
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
) &&

2658 
	`bgp_exp‹t_modifõr
 (
rs˛õ¡
, 
≥î
, 
p
, &
√w_©å
, 
afi
, 
ßfi
Ë=
RMAP_DENY
)

2660 
ªas⁄
 = "export-policy;";

2661 
fûãªd
;

2664 
©å_√w2
 = 
	`bgp_©å_öã∫
 (&
√w_©å
);

2667 i‡(
	`bgp_imp‹t_modifõr
 (
rs˛õ¡
, 
≥î
, 
p
, &
√w_©å
, 
afi
, 
ßfi
Ë=
RMAP_DENY
)

2669 
	`bgp_©å_unöã∫
 (&
©å_√w2
);

2671 
ªas⁄
 = "import-policy;";

2672 
fûãªd
;

2675 
©å_√w
 = 
	`bgp_©å_öã∫
 (&
√w_©å
);

2676 
	`bgp_©å_unöã∫
 (&
©å_√w2
);

2679 i‡((
afi
 =
AFI_IP
Ë&& ((
ßfi
 =
SAFI_UNICAST
Ë|| safò=
SAFI_MULTICAST
))

2682 i‡(
√w_©å
.
√xth›
.
s_addr
 == 0

2683 || 
	`IPV4_CLASS_DE
 (
	`¡ohl
 (
√w_©å
.
√xth›
.
s_addr
)))

2685 
	`bgp_©å_unöã∫
 (&
©å_√w
);

2687 
ªas⁄
 = "martianÇext-hop;";

2688 
fûãªd
;

2693 i‡(
ri
)

2695 
ri
->
u±ime
 = 
	`bgp_˛ock
 ();

2698 i‡(!
	`CHECK_FLAG
(
ri
->
Êags
, 
BGP_INFO_REMOVED
)

2699 && 
	`©åhash_cmp
 (
ri
->
©å
, 
©å_√w
))

2702 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

2704 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

2705 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

2707 
≥î
->
ho°
,

2708 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

2709 
p
->
¥efixÀn
, 
rs˛õ¡
->
ho°
);

2711 
	`bgp_u∆ock_node
 (
∫
);

2712 
	`bgp_©å_unöã∫
 (&
©å_√w
);

2718 i‡(
	`CHECK_FLAG
(
ri
->
Êags
, 
BGP_INFO_REMOVED
))

2719 
	`bgp_öfo_ª°‹e
 (
∫
, 
ri
);

2722 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

2723 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%sÑcvd %s/%d for RS-client %s",

2724 
≥î
->
ho°
,

2725 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

2726 
p
->
¥efixÀn
, 
rs˛õ¡
->
ho°
);

2729 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

2732 
	`bgp_©å_unöã∫
 (&
ri
->
©å
);

2733 
ri
->
©å
 = 
©å_√w
;

2736 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

2737 
	`mem˝y
 ((
	`bgp_öfo_exåa_gë
 (
ri
))->
èg
,Åag, 3);

2739 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_VALID
);

2742 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

2743 
	`bgp_u∆ock_node
 (
∫
);

2749 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

2751 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%sÑcvd %s/%d for RS-client %s",

2752 
≥î
->
ho°
,

2753 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

2754 
p
->
¥efixÀn
, 
rs˛õ¡
->
ho°
);

2758 
√w
 = 
	`bgp_öfo_√w
 ();

2759 
√w
->
ty≥
 =Åype;

2760 
√w
->
sub_ty≥
 = sub_type;

2761 
√w
->
≥î
 =Öeer;

2762 
√w
->
©å
 = 
©å_√w
;

2763 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

2766 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

2767 
	`mem˝y
 ((
	`bgp_öfo_exåa_gë
 (
√w
))->
èg
,Åag, 3);

2769 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w
, 
BGP_INFO_VALID
);

2772 
	`bgp_öfo_add
 (
∫
, 
√w
);

2775 
	`bgp_u∆ock_node
 (
∫
);

2778 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

2782 
fûãªd
:

2785 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

2786 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

2788 
≥î
->
ho°
,

2789 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

2790 
p
->
¥efixÀn
, 
rs˛õ¡
->
ho°
, 
ªas⁄
);

2792 i‡(
ri
)

2793 
	`bgp_rib_ªmove
 (
∫
, 
ri
, 
≥î
, 
afi
, 
ßfi
);

2795 
	`bgp_u∆ock_node
 (
∫
);

2798 
	}
}

2801 
	$bgp_wôhdøw_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

2802 
≥î
 *≥î, 
¥efix
 *
p
, 
ty≥
, 
sub_ty≥
,

2803 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
)

2805 
bgp_node
 *
∫
;

2806 
bgp_öfo
 *
ri
;

2807 
buf
[
SU_ADDRSTRLEN
];

2809 i‡(
rs˛õ¡
 =
≥î
)

2812 
∫
 = 
	`bgp_afi_node_gë
 (
rs˛õ¡
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
¥d
);

2815 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

2816 i‡(
ri
->
≥î
 =≥î &&Ñi->
ty≥
 =ty≥ &&Ñi->
sub_ty≥
 == sub_type)

2820 i‡(
ri
 && ! 
	`CHECK_FLAG
 (ri->
Êags
, 
BGP_INFO_HISTORY
))

2821 
	`bgp_rib_wôhdøw
 (
∫
, 
ri
, 
≥î
, 
afi
, 
ßfi
);

2822 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

2823 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

2824 "%†C™'àfödÅhêrouã %s/%d", 
≥î
->
ho°
,

2825 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

2826 
p
->
¥efixÀn
);

2829 
	`bgp_u∆ock_node
 (
∫
);

2830 
	}
}

2832 #ifde‡
USE_SRX


2833 
	$¥efix_to_IPPªfix
 (
¥efix
* 
§c
, 
IPPªfix
* 
d°
)

2835 
d°
->
Àngth
 = 
§c
->
¥efixÀn
;

2837 #ifde‡
HAVE_IPV6


2838 
d°
->
ù
.
vîsi⁄
 = 
	`GET_VERSION_OF_AF
 (
§c
->
Ámûy
);

2839 
	`mem˝y
 (&
d°
->
ù
.
addr
, &
§c
->
u
, 16);

2841 
d°
->
ù
.
vîsi⁄
 = 4;

2842 
d°
->
ù
.
addr
.
v4
.
u32
 = 
§c
->
u
.
¥efix4
.
s_addr
;

2844 
	}
}

2853 
BGPSecD©a
* 
	$§x_¸óã_bgp£c_d©a
 (
bgp
 *bgp, 
bgp_öfo
* 
öfo
)

2855 
©å
*áâ∏
öfo
->attr;

2856 
as£gmít
* 
∑thSeg
;

2857 
BGPSecD©a
* 
bgp£c
 = 
	`mÆloc
((BGPSecData));

2858 
	`mem£t
(
bgp£c
, 0, (
BGPSecD©a
));

2861 i‡(
©å
->
a•©h
 !
NULL
)

2863 
d©aIdx
 = 0;

2864 
£gIdx
 = 0;

2867 
∑thSeg
 = 
©å
->
a•©h
->
£gmíts
;

2868 
¥evSize
 = 0;

2870 
∑thSeg
 !
NULL
)

2872 i‡(
∑thSeg
->
ty≥
 =
AS_SEQUENCE
)

2874 
size
 = 
∑thSeg
->
Àngth
 * 4;

2875 
bgp£c
->
numbîH›s
 = 
∑thSeg
->
Àngth
;

2877 i‡(
bgp£c
->
asP©h
 =
NULL
)

2879 
bgp£c
->
asP©h
 = 
	`mÆloc
(
size
);

2883 
bgp£c
->
asP©h
 = 
	`ªÆloc
(bgp£c->asP©h, 
size
+
¥evSize
);

2887 
£gIdx
 = 0;£gIdx < 
∑thSeg
->
Àngth
; segIdx++)

2889 
bgp£c
->
asP©h
[
d©aIdx
++] = 
	`ht⁄l
(
∑thSeg
->
as
[
£gIdx
]);

2891 
¥evSize
 +
size
;

2893 
∑thSeg
 =Ö©hSeg->
√xt
;

2898 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
 !
NULL
)

2900 
SCA_BGP_P©hAâribuã
* 
∑
 = (SCA_BGP_P©hAâribuã*)
©å
->
bgp£c_vÆid©i⁄D©a
->
bgp£c_∑th_©å
;

2901 
size
 = (
∑
->
Êags
 & 
SCA_BGP_UPD_A_FLAGS_EXT_LENGTH
) > 0

2902 ? 
	`¡ohs
(((
SCA_BGPSEC_ExtP©hAâribuã
*)
∑
)->
©åLígth
)

2903 : ((
SCA_BGPSEC_N‹mP©hAâribuã
*)
∑
)->
©åLígth
;

2904 i‡–
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

2906 
size
 += 4;

2908 i‡(
bgp£c
->
bgp£c_∑th_©å
 =
NULL
)

2910 
bgp£c
->
bgp£c_∑th_©å
 = 
	`mÆloc
(
size
);

2914 
bgp£c
->
bgp£c_∑th_©å
 = 
	`ªÆloc
(bgp£c->bgp£c_∑th_©å, 
size
);

2916 
bgp£c
->
©å_Àngth
 = 
size
;

2917 i‡–
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

2919 
bgp£c
->
afi
 = ((
SCA_Pªfix
*)
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
)->afi;

2920 
bgp£c
->
ßfi
 = ((
SCA_Pªfix
*)
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
)->safi;

2921 
bgp£c
->
loˇl_as
 = 
öfo
->
≥î
->local_as;

2923 
	`mem˝y
(
bgp£c
->
bgp£c_∑th_©å
, 
©å
->
bgp£c_vÆid©i⁄D©a
->bgpsec_path_attr,

2924 
size
);

2927  
bgp£c
;

2928 
	}
}

2935 
	$§x_‰ì_bgp£c_d©a
 (
BGPSecD©a
* 
bgp£c
)

2938 i‡(
bgp£c
->
asP©h
 !
NULL
)

2940 
	`mem£t
(
bgp£c
->
asP©h
, 0, (bgp£c->
numbîH›s
 * 4));

2941 
	`‰ì
(
bgp£c
->
asP©h
);

2943 i‡(
bgp£c
->
bgp£c_∑th_©å
 !
NULL
)

2945 
	`mem£t
(
bgp£c
->
bgp£c_∑th_©å
, 0, bgp£c->
©å_Àngth
);

2946 
	`‰ì
 (
bgp£c
->
bgp£c_∑th_©å
);

2948 
	`mem£t
 (
bgp£c
, 0, (
BGPSecD©a
));

2949 
	`‰ì
(
bgp£c
);

2950 
	}
}

2954 
	#MAX_VALUE_INT
 0x0FFFFFFF

	)

2955 
	gsuiLoˇlID
 = 0;

2962 
uöt32_t
 
	$gëNextLoˇlID
()

2964 i‡(
suiLoˇlID
 < 
MAX_VALUE_INT
 )

2966 
suiLoˇlID
++;

2970 
suiLoˇlID
 = 1;

2973  
suiLoˇlID
;

2974 
	}
}

2988 
	$vîify_upd©e
 (
bgp
 *bgp, 
bgp_öfo
 *
öfo
,

2989 
SRxDeÁu…Resu…
* 
defResu…
, 
boﬁ
 
doRegi°îLoˇlID
)

2991 #i‡
	`deföed
 (
USE_GRPC
Ë&& deföed (
__TIME_MEASURE__
)

2992 
vÆCou¡
=0;

2993 
g_mósuªCou¡
;

2994 
vÆ_íd_˛ock
;

2999 i‡(
	`CHECK_FLAG
 (
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY
))

3001 
ªtVÆid
 = -1;

3002 
ªtVÆid
 = 
	`checkEcomSRxVÆid
(
öfo
->
©å
);

3004 if(
ªtVÆid
 >= 0 &&ÑetValid <= 3)

3006 if(
ªtVÆid
 =
ECOMMUNITY_BGPSEC_VALID
)

3008 
defResu…
->
ªsu…
.
rﬂResu…
 = 
SRx_RESULT_VALID
;

3009 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3010 
	`zlog_debug
(" Ecommunity Value [VALID] ");

3012 if(
ªtVÆid
 =
ECOMMUNITY_BGPSEC_NOT_FOUND
)

3014 
defResu…
->
ªsu…
.
rﬂResu…
 = 
SRx_RESULT_NOTFOUND
;

3015 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3016 
	`zlog_debug
(" Ecommunity Value [NOT FOUND] ");

3018 if(
ªtVÆid
 =
ECOMMUNITY_BGPSEC_INVALID
)

3020 
defResu…
->
ªsu…
.
rﬂResu…
 = 
SRx_RESULT_INVALID
;

3021 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3022 
	`zlog_debug
(" Ecommunity Value [INVALID] ");

3024 if(
ªtVÆid
 =
ECOMMUNITY_BGPSEC_UNDEFINED
)

3026 
defResu…
->
ªsu…
.
rﬂResu…
 = 
SRx_RESULT_UNDEFINED
;

3027 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3028 
	`zlog_debug
(" Ecommunity VALUE AB [Undefined]");

3034 i‡(
defResu…
->
ªsu…
.
rﬂResu…
 !
SRx_RESULT_DONOTUSE
)

3036 
öfo
->
vÆ_ªs_ROA
 = 
defResu…
->
ªsu…
.
rﬂResu…
;

3038 i‡(
defResu…
->
ªsu…
.
bgp£cResu…
 !
SRx_RESULT_DONOTUSE
)

3040 
öfo
->
vÆ_ªs_BGPSEC
 = 
defResu…
->
ªsu…
.
bgp£cResu…
;

3046 i‡(
öfo
->
loˇlID
 > 0 && 
doRegi°îLoˇlID
)

3048 
	`bgp_öfo_ªgi°î
 (
bgp
->
öfo_lid_hash
, 
öfo
, info->
loˇlID
);

3054 i‡(
	`isC⁄√˘ed
 (
bgp
->
§xProxy
))

3056 
as_t
 
ﬂs
;

3059 i‡(
öfo
->
loˇlID
 !0 || info->
upd©eID
 != 0)

3062 
ﬂs
 = 
	`a•©h_‹igö_as
 (
öfo
->
©å
->
a•©h
);

3065 
IPPªfix
* 
¥efix
 = 
	`mÆloc
((IPPrefix));

3066 
	`¥efix_to_IPPªfix
 (&
öfo
->
node
->
p
, 
¥efix
);

3070 
BGPSecD©a
* 
bgp£c
 = 
	`§x_¸óã_bgp£c_d©a
(
bgp
, 
öfo
);

3073 
boﬁ
 
u£P©hVÆ
 = 
Ál£
;

3074 i‡–
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

3076 
u£P©hVÆ
 = 
åue
;

3079 #ifde‡
USE_GRPC


3080 #i‡
	`deföed
 (
__TIME_MEASURE__
)

3081 if(
vÆCou¡
 == 0) {

3082 
˛k_t0
 = 
	`rdtsc
();

3087 
	`vîifyUpd©e_gΩc
(
bgp
->
§xProxy
, 
öfo
->
loˇlID
, 
åue
, 
u£P©hVÆ
, 
defResu…
,

3088 
¥efix
, 
ﬂs
, 
bgp£c
);

3089 #i‡
	`deföed
 (
__TIME_MEASURE__
)

3090 
vÆCou¡
++;

3092 if(
vÆCou¡
 >
g_mósuªCou¡
)

3094 
vÆ_íd_˛ock
 = 
	`rdtsc
();

3095 
	`¥ötf
(" vÆid©êcou¡Ñóched %ldándÅîmö©ê\n", 
g_mósuªCou¡
);

3096 
vÆCou¡
 =0;

3098 
	`¥öt_˛ock_time
(
íd_˛ock
, 
°¨t_˛ock
, "ReceivingÅime");

3099 
	`¥öt_˛ock_time
(
vÆ_íd_˛ock
 , 
˛k_t0
, "validationÅime :");

3100 
	`¥öt_˛ock_time
(
vÆ_íd_˛ock
 , 
°¨t_˛ock
, "overallÅime (including validation) :");

3105 
	`vîifyUpd©e
(
bgp
->
§xProxy
, 
öfo
->
loˇlID
, 
åue
, 
u£P©hVÆ
, 
defResu…
,

3106 
¥efix
, 
ﬂs
, 
bgp£c
);

3109 
	`§x_‰ì_bgp£c_d©a
(
bgp£c
);

3110 
	`‰ì
(
¥efix
);

3119 
	`bgp_öfo_£t_ign‹e_Êag
(
öfo
);

3120 
	}
}

3124 
	$bgp_upd©e_maö
 (
≥î
 *≥î, 
¥efix
 *
p
, 
©å
 *attr,

3125 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
ty≥
, 
sub_ty≥
,

3126 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
, 
so·_ªc⁄fig
)

3128 
ªt
;

3129 
a•©h_lo›_cou¡
 = 0;

3130 
bgp_node
 *
∫
;

3131 
bgp
 *bgp;

3132 
©å
 
√w_©å
;

3133 
©å_exåa
 
√w_exåa
;

3134 
©å
 *
©å_√w
;

3135 
bgp_öfo
 *
ri
;

3136 
bgp_öfo
 *
√w
;

3137 c⁄° *
ªas⁄
;

3138 
buf
[
SU_ADDRSTRLEN
];

3140 
bgp
 = 
≥î
->bgp;

3141 
∫
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
¥d
);

3145 i‡(! 
so·_ªc⁄fig
 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SOFT_RECONFIG
)

3146 && 
≥î
 !
bgp
->
≥î_£lf
)

3147 
	`bgp_adj_ö_£t
 (
∫
, 
≥î
, 
©å
);

3150 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

3151 i‡(
ri
->
≥î
 =≥î &&Ñi->
ty≥
 =ty≥ &&Ñi->
sub_ty≥
 == sub_type)

3155 i‡(
≥î
->
ch™ge_loˇl_as
)

3157 i‡(! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
))

3158 
a•©h_lo›_cou¡
 = 1;

3160 i‡(
	`a•©h_lo›_check
 (
©å
->
a•©h
, 
≥î
->
ch™ge_loˇl_as
Ë> 
a•©h_lo›_cou¡
)

3162 
ªas⁄
 = "as-path contains our own AS;";

3163 
fûãªd
;

3168 i‡(
	`a•©h_lo›_check
 (
©å
->
a•©h
, 
bgp
->
as
Ë> 
≥î
->
Ælowas_ö
[
afi
][
ßfi
]

3169 || (
	`CHECK_FLAG
(
bgp
->
c⁄fig
, 
BGP_CONFIG_CONFEDERATION
)

3170 && 
	`a•©h_lo›_check
(
©å
->
a•©h
, 
bgp
->
c⁄„d_id
)

3171 > 
≥î
->
Ælowas_ö
[
afi
][
ßfi
]))

3173 
ªas⁄
 = "as-path contains our own AS;";

3174 
fûãªd
;

3178 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGINATOR_ID
)

3179 && 
	`IPV4_ADDR_SAME
 (&
bgp
->
rouãr_id
, &
©å
->
exåa
->
‹igö©‹_id
))

3181 
ªas⁄
 = "originator is us;";

3182 
fûãªd
;

3186 i‡(
	`bgp_˛u°î_fûãr
 (
≥î
, 
©å
))

3188 
ªas⁄
 = "reflected fromÅhe same cluster;";

3189 
fûãªd
;

3193 i‡(
	`bgp_öput_fûãr
 (
≥î
, 
p
, 
©å
, 
afi
, 
ßfi
Ë=
FILTER_DENY
)

3195 
ªas⁄
 = "filter;";

3196 
fûãªd
;

3199 
√w_©å
.
exåa
 = &
√w_exåa
;

3200 
	`bgp_©å_dup
 (&
√w_©å
, 
©å
);

3203 i‡(
	`bgp_öput_modifõr
 (
≥î
, 
p
, &
√w_©å
, 
afi
, 
ßfi
Ë=
RMAP_DENY
)

3205 
ªas⁄
 = "route-map;";

3206 
fûãªd
;

3210 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

3214 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP
 &&Öìr->
âl
 == 1

3215 && ! 
	`bgp_√xth›_⁄lök
 (
afi
, &
√w_©å
)

3216 && ! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DISABLE_CONNECTED_CHECK
))

3218 
ªas⁄
 = "non-connectedÇext-hop;";

3219 
fûãªd
;

3224 i‡(
√w_©å
.
√xth›
.
s_addr
 == 0

3225 || 
	`IPV4_CLASS_DE
 (
	`¡ohl
 (
√w_©å
.
√xth›
.
s_addr
))

3226 || 
	`bgp_√xth›_£lf
 (&
√w_©å
))

3228 
ªas⁄
 = "martianÇext-hop;";

3229 
fûãªd
;

3233 
©å_√w
 = 
	`bgp_©å_öã∫
 (&
√w_©å
);

3236 i‡(
ri
)

3238 
ri
->
u±ime
 = 
	`bgp_˛ock
 ();

3241 i‡(!
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_REMOVED
)

3242 && 
	`©åhash_cmp
 (
ri
->
©å
, 
©å_√w
))

3244 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

3246 i‡(
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
)

3247 && 
≥î
->
s‹t
 =
BGP_PEER_EBGP


3248 && 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_HISTORY
))

3250 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3251 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%sÑcvd %s/%d",

3252 
≥î
->
ho°
,

3253 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3254 
p
->
¥efixÀn
);

3256 i‡(
	`bgp_damp_upd©e
 (
ri
, 
∫
, 
afi
, 
ßfi
Ë!
BGP_DAMP_SUPPRESSED
)

3258 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
ßfi
);

3259 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

3264 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3265 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

3267 
≥î
->
ho°
,

3268 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3269 
p
->
¥efixÀn
);

3272 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_STALE
))

3274 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_STALE
);

3275 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

3279 
	`bgp_u∆ock_node
 (
∫
);

3280 #ifde‡
USE_SRX


3281 i‡(
©å_√w
->
bgp£cP©hAâr
 && (©å_√w->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_BGPSEC
)) )

3283 
	`UNSET_FLAG
(
©å_√w
->
Êag
, 
BGP_ATTR_BGPSEC
);

3284 
	`bgp£c_∑th_‰ì
 (
©å_√w
->
bgp£cP©hAâr
);

3287 
	`bgp_©å_unöã∫
 (&
©å_√w
);

3293 i‡(
	`CHECK_FLAG
(
ri
->
Êags
, 
BGP_INFO_REMOVED
))

3295 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3296 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%sÑcvd %s/%d, flapped quickerÅhanÖrocessing",

3297 
≥î
->
ho°
,

3298 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3299 
p
->
¥efixÀn
);

3300 
	`bgp_öfo_ª°‹e
 (
∫
, 
ri
);

3304 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3305 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%sÑcvd %s/%d",

3306 
≥î
->
ho°
,

3307 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3308 
p
->
¥efixÀn
);

3311 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_STALE
))

3312 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_STALE
);

3315 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

3320 
	`bgp_aggªg©e_de¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
ßfi
);

3323 i‡(
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
)

3324 && 
≥î
->
s‹t
 =
BGP_PEER_EBGP
)

3328 i‡(! 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_HISTORY
))

3329 
	`bgp_damp_wôhdøw
 (
ri
, 
∫
, 
afi
, 
ßfi
, 1);

3333 
	`bgp_©å_unöã∫
 (&
ri
->
©å
);

3334 
ri
->
©å
 = 
©å_√w
;

3336 #ifde‡
USE_SRX


3340 i‡(
ri
->
öfo_hash
 !
NULL
)

3342 
	`bgp_öfo_uƒegi°î
(
ri
->
öfo_hash
,Ñi->
loˇlID
 != 0 ?Ñi->localID == 0

3343 : 
ri
->
upd©eID
);

3344 
ri
->
öfo_hash
 = 
NULL
;

3346 i‡(
ri
->
upd©eID
 > 0)

3348 
	`dñëeUpd©e
(
bgp
->
§xProxy
, bgp->
§x_kìpWödow
, 
ri
->
upd©eID
);

3349 
ri
->
upd©eID
 = 0;

3353 
ri
->
loˇlID
 = 0;

3356 
ri
->
vÆ_ªs_ROA
 = 
bgp
->
§x_deÁu…_rﬂVÆ
;

3357 
ri
->
vÆ_ªs_BGPSEC
 = 
bgp
->
§x_deÁu…_bgp£cVÆ
;

3362 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

3363 
	`mem˝y
 ((
	`bgp_öfo_exåa_gë
 (
ri
))->
èg
,Åag, 3);

3366 i‡(
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
)

3367 && 
≥î
->
s‹t
 =
BGP_PEER_EBGP
)

3370 
ªt
 = 
	`bgp_damp_upd©e
 (
ri
, 
∫
, 
afi
, 
ßfi
);

3371 i‡(
ªt
 =
BGP_DAMP_SUPPRESSED
)

3373 
	`bgp_u∆ock_node
 (
∫
);

3379 i‡((
afi
 =
AFI_IP
 ||áfò=
AFI_IP6
)

3380 && 
ßfi
 =
SAFI_UNICAST


3381 && (
≥î
->
s‹t
 =
BGP_PEER_IBGP


3382 || 
≥î
->
s‹t
 =
BGP_PEER_CONFED


3383 || (
≥î
->
s‹t
 =
BGP_PEER_EBGP
 &&Öìr->
âl
 != 1)

3384 || 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DISABLE_CONNECTED_CHECK
)))

3386 i‡(
	`bgp_√xth›_lookup
 (
afi
, 
≥î
, 
ri
, 
NULL
, NULL))

3387 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_VALID
);

3389 
	`bgp_öfo_un£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_VALID
);

3392 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_VALID
);

3395 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
ßfi
);

3397 #ifde‡
USE_SRX


3400 
ri
->
loˇlID
 = 
	`gëNextLoˇlID
();

3403 
SRxDeÁu…Resu…
* 
defRes
 = 
	`mÆloc
((SRxDefaultResult));

3408 
defRes
->
ªsSour˚ROA
 = 
SRxRS_ROUTER
;

3409 
defRes
->
ªsSour˚BGPSEC
 = 
SRxRS_ROUTER
;

3410 
defRes
->
ªsu…
.
rﬂResu…
 = 
bgp
->
§x_deÁu…_rﬂVÆ
;

3411 
defRes
->
ªsu…
.
bgp£cResu…
 = 
bgp
->
§x_deÁu…_bgp£cVÆ
;

3413 
	`vîify_upd©e
 (
bgp
, 
ri
, 
defRes
, 
åue
);

3414 
	`‰ì
(
defRes
);

3417 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

3418 
	`bgp_u∆ock_node
 (
∫
);

3424 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3426 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%sÑcvd %s/%d",

3427 
≥î
->
ho°
,

3428 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3429 
p
->
¥efixÀn
);

3433 
√w
 = 
	`bgp_öfo_√w
 ();

3434 
√w
->
ty≥
 =Åype;

3435 
√w
->
sub_ty≥
 = sub_type;

3436 
√w
->
≥î
 =Öeer;

3437 
√w
->
©å
 = 
©å_√w
;

3438 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

3440 #ifde‡
USE_SRX


3441 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

3443 
	`zlog_debug
("[BGPSEC] ----[%s]: ATTRIBUTE:áttr:%páspath:%p (attr interned) bpgsec:%p",\

3444 
__FUNCTION__
, 
©å_√w
,áâr_√w->
a•©h
,áâr_√w->
bgp£cP©hAâr
);

3445 if(
©å_√w
->
a•©h
 &&áâr_√w->a•©h->
£gmíts
)

3446 
	`zlog_debug
("[BGPSEC] [as_segment:%p]ás_segment_length:%dáspath_refcnt: %ld",

3447 
©å_√w
->
a•©h
->
£gmíts
,áâr_√w->a•©h->£gmíts->
Àngth
,

3448 
©å_√w
->
a•©h
->
ªf˙t
);

3451 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë&& BGP_DEBUG (bgp£c, 
BGPSEC_DETAIL
))

3452 if(
©å_√w
->
bgp£cP©hAâr
)

3453 
	`¥öt_sig«tuª
(
©å_√w
->
bgp£cP©hAâr
);

3456 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

3457 
	`mem˝y
 ((
	`bgp_öfo_exåa_gë
 (
√w
))->
èg
,Åag, 3);

3460 i‡((
afi
 =
AFI_IP
 ||áfò=
AFI_IP6
)

3461 && 
ßfi
 =
SAFI_UNICAST


3462 && (
≥î
->
s‹t
 =
BGP_PEER_IBGP


3463 || 
≥î
->
s‹t
 =
BGP_PEER_CONFED


3464 || (
≥î
->
s‹t
 =
BGP_PEER_EBGP
 &&Öìr->
âl
 != 1)

3465 || 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DISABLE_CONNECTED_CHECK
)))

3467 i‡(
	`bgp_√xth›_lookup
 (
afi
, 
≥î
, 
√w
, 
NULL
, NULL))

3468 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w
, 
BGP_INFO_VALID
);

3470 
	`bgp_öfo_un£t_Êag
 (
∫
, 
√w
, 
BGP_INFO_VALID
);

3473 
	`bgp_öfo_£t_Êag
 (
∫
, 
√w
, 
BGP_INFO_VALID
);

3476 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
√w
, 
afi
, 
ßfi
);

3479 
	`bgp_öfo_add
 (
∫
, 
√w
);

3481 #ifde‡
USE_SRX


3483 
√w
->
loˇlID
 = 
	`gëNextLoˇlID
();

3484 
√w
->
vÆ_ªs_ROA
 = 
bgp
->
§x_deÁu…_rﬂVÆ
;

3485 
√w
->
vÆ_ªs_BGPSEC
 = 
bgp
->
§x_deÁu…_bgp£cVÆ
;

3488 
SRxDeÁu…Resu…
* 
defRes
 = 
	`mÆloc
((SRxDefaultResult));

3493 
defRes
->
ªsSour˚ROA
 = 
SRxRS_ROUTER
;

3494 
defRes
->
ªsSour˚BGPSEC
 = 
SRxRS_ROUTER
;

3495 
defRes
->
ªsu…
.
rﬂResu…
 = 
bgp
->
§x_deÁu…_rﬂVÆ
;

3496 
defRes
->
ªsu…
.
bgp£cResu…
 = 
bgp
->
§x_deÁu…_bgp£cVÆ
;

3498 
	`vîify_upd©e
 (
bgp
, 
√w
, 
defRes
, 
åue
);

3499 
	`‰ì
(
defRes
);

3503 
	`bgp_u∆ock_node
 (
∫
);

3507 i‡(
	`bgp_maximum_¥efix_ovîÊow
 (
≥î
, 
afi
, 
ßfi
, 0))

3511 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

3517 
fûãªd
:

3518 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3519 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

3521 
≥î
->
ho°
,

3522 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3523 
p
->
¥efixÀn
, 
ªas⁄
);

3525 i‡(
ri
)

3526 
	`bgp_rib_ªmove
 (
∫
, 
ri
, 
≥î
, 
afi
, 
ßfi
);

3528 
	`bgp_u∆ock_node
 (
∫
);

3531 
	}
}

3534 
	$bgp_upd©e
 (
≥î
 *≥î, 
¥efix
 *
p
, 
©å
 *attr,

3535 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
ty≥
, 
sub_ty≥
,

3536 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
, 
so·_ªc⁄fig
)

3538 
≥î
 *
rs˛õ¡
;

3539 
li°node
 *
node
, *
¬ode
;

3540 
bgp
 *bgp;

3541 
ªt
;

3543 
ªt
 = 
	`bgp_upd©e_maö
 (
≥î
, 
p
, 
©å
, 
afi
, 
ßfi
, 
ty≥
, 
sub_ty≥
, 
¥d
, 
èg
,

3544 
so·_ªc⁄fig
);

3546 
bgp
 = 
≥î
->bgp;

3549 
	`ALL_LIST_ELEMENTS
 (
bgp
->
rs˛õ¡
, 
node
, 
¬ode
,Ñsclient))

3551 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

3552 
	`bgp_upd©e_rs˛õ¡
 (
rs˛õ¡
, 
afi
, 
ßfi
, 
©å
, 
≥î
, 
p
, 
ty≥
,

3553 
sub_ty≥
, 
¥d
, 
èg
);

3556  
ªt
;

3557 
	}
}

3560 
	$bgp_wôhdøw
 (
≥î
 *≥î, 
¥efix
 *
p
, 
©å
 *attr,

3561 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
ty≥
, 
sub_ty≥
,

3562 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
)

3564 
bgp
 *bgp;

3565 
buf
[
SU_ADDRSTRLEN
];

3566 
bgp_node
 *
∫
;

3567 
bgp_öfo
 *
ri
;

3568 
≥î
 *
rs˛õ¡
;

3569 
li°node
 *
node
, *
¬ode
;

3571 
bgp
 = 
≥î
->bgp;

3574 
	`ALL_LIST_ELEMENTS
 (
bgp
->
rs˛õ¡
, 
node
, 
¬ode
,Ñsclient))

3576 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

3577 
	`bgp_wôhdøw_rs˛õ¡
 (
rs˛õ¡
, 
afi
, 
ßfi
, 
≥î
, 
p
, 
ty≥
, 
sub_ty≥
, 
¥d
, 
èg
);

3581 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3582 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
, "%sÑcvd UPDATEábout %s/%d -- withdrawn",

3583 
≥î
->
ho°
,

3584 
	`öë_¡›
(
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3585 
p
->
¥efixÀn
);

3588 
∫
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
¥d
);

3592 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SOFT_RECONFIG
)

3593 && 
≥î
 !
bgp
->
≥î_£lf
)

3594 
	`bgp_adj_ö_un£t
 (
∫
, 
≥î
);

3597 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

3598 i‡(
ri
->
≥î
 =≥î &&Ñi->
ty≥
 =ty≥ &&Ñi->
sub_ty≥
 == sub_type)

3602 i‡(
ri
 && ! 
	`CHECK_FLAG
 (ri->
Êags
, 
BGP_INFO_HISTORY
))

3603 
	`bgp_rib_wôhdøw
 (
∫
, 
ri
, 
≥î
, 
afi
, 
ßfi
);

3604 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

3605 
	`zlog
 (
≥î
->
log
, 
LOG_DEBUG
,

3606 "%†C™'àfödÅhêrouã %s/%d", 
≥î
->
ho°
,

3607 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

3608 
p
->
¥efixÀn
);

3611 
	`bgp_u∆ock_node
 (
∫
);

3614 
	}
}

3617 
	$bgp_deÁu…_‹igö©e
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
wôhdøw
)

3619 
bgp
 *bgp;

3620 
©å
áttr;

3621 
a•©h
 *aspath;

3622 
¥efix
 
p
;

3623 
≥î
 *
‰om
;

3624 
bgp_node
 *
∫
;

3625 
bgp_öfo
 *
ri
;

3626 
ªt
 = 
RMAP_DENYMATCH
;

3628 i‡(!(
afi
 =
AFI_IP
 ||áfò=
AFI_IP6
))

3631 
bgp
 = 
≥î
->bgp;

3632 
‰om
 = 
bgp
->
≥î_£lf
;

3634 
	`bgp_©å_deÁu…_£t
 (&
©å
, 
BGP_ORIGIN_IGP
);

3635 
a•©h
 = 
©å
.aspath;

3636 
©å
.
loˇl_¥ef
 = 
bgp
->
deÁu…_loˇl_¥ef
;

3637 
	`mem˝y
 (&
©å
.
√xth›
, &
≥î
->√xth›.
v4
, 
IPV4_MAX_BYTELEN
);

3639 i‡(
afi
 =
AFI_IP
)

3640 
	`°r2¥efix
 ("0.0.0.0/0", &
p
);

3641 #ifde‡
HAVE_IPV6


3642 i‡(
afi
 =
AFI_IP6
)

3644 
©å_exåa
 *
´
 = 
©å
.
exåa
;

3646 
	`°r2¥efix
 ("::/0", &
p
);

3649 
	`mem˝y
 (&
´
->
mp_√xth›_globÆ
, &
≥î
->
√xth›
.
v6_globÆ
,

3650 
IPV6_MAX_BYTELEN
);

3651 
´
->
mp_√xth›_Àn
 = 16;

3655 i‡(
≥î
->
sh¨ed_√tw‹k


3656 && !
	`IN6_IS_ADDR_UNSPECIFIED
 (&
≥î
->
√xth›
.
v6_loˇl
))

3658 
	`mem˝y
 (&
´
->
mp_√xth›_loˇl
, &
≥î
->
√xth›
.
v6_loˇl
,

3659 
IPV6_MAX_BYTELEN
);

3660 
´
->
mp_√xth›_Àn
 = 32;

3665 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

3667 
	`SET_FLAG
 (
bgp
->
≥î_£lf
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_DEFAULT
);

3668 
∫
 = 
	`bgp_èbÀ_t›
(
bgp
->
rib
[
afi
][
ßfi
]);Ñn;Ñ¿
	`bgp_rouã_√xt
(rn))

3670 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

3672 
©å
 
dummy_©å
;

3673 
©å_exåa
 
dummy_exåa
;

3674 
bgp_öfo
 
öfo
;

3677 
dummy_©å
.
exåa
 = &
dummy_exåa
;

3678 
	`bgp_©å_dup
(&
dummy_©å
, 
ri
->
©å
);

3679 
öfo
.
≥î
 = 
ri
->peer;

3680 
öfo
.
©å
 = &
dummy_©å
;

3682 
ªt
 = 
	`rouã_m≠_≠∂y
(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
, &
∫
->
p
,

3683 
RMAP_BGP
, &
öfo
);

3687 
	`bgp_©å_Êush
(&
dummy_©å
);

3688 i‡(
ªt
 !
RMAP_DENYMATCH
)

3691 i‡(
ªt
 !
RMAP_DENYMATCH
)

3694 
bgp
->
≥î_£lf
->
rm≠_ty≥
 = 0;

3696 i‡(
ªt
 =
RMAP_DENYMATCH
)

3697 
wôhdøw
 = 1;

3700 i‡(
wôhdøw
)

3702 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_DEFAULT_ORIGINATE
))

3703 
	`bgp_deÁu…_wôhdøw_£nd
 (
≥î
, 
afi
, 
ßfi
);

3704 
	`UNSET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_DEFAULT_ORIGINATE
);

3708 i‡(! 
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_DEFAULT_ORIGINATE
))

3710 
	`SET_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_DEFAULT_ORIGINATE
);

3711 
	`bgp_deÁu…_upd©e_£nd
 (
≥î
, &
©å
, 
afi
, 
ßfi
, 
‰om
);

3715 
	`bgp_©å_exåa_‰ì
 (&
©å
);

3716 
	`a•©h_unöã∫
 (&
a•©h
);

3717 
	}
}

3720 
	$bgp_™noun˚_èbÀ
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

3721 
bgp_èbÀ
 *
èbÀ
, 
rs˛õ¡
)

3723 
bgp_node
 *
∫
;

3724 
bgp_öfo
 *
ri
;

3725 
©å
áttr;

3726 
©å_exåa
 
exåa
;

3728 i‡(! 
èbÀ
)

3729 
èbÀ
 = (
rs˛õ¡
Ë? 
≥î
->
rib
[
afi
][
ßfi
] :Öìr->
bgp
->rib[afi][safi];

3731 i‡(
ßfi
 !
SAFI_MPLS_VPN


3732 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
))

3733 
	`bgp_deÁu…_‹igö©e
 (
≥î
, 
afi
, 
ßfi
, 0);

3736 
©å
.
exåa
 = &extra;

3738 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
(rn))

3739 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

3740 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_SELECTED
Ë&&Ñi->
≥î
 !=Öeer)

3742 i‡–(
rs˛õ¡
) ?

3743 (
	`bgp_™noun˚_check_rs˛õ¡
 (
ri
, 
≥î
, &
∫
->
p
, &
©å
, 
afi
, 
ßfi
))

3744 : (
	`bgp_™noun˚_check
 (
ri
, 
≥î
, &
∫
->
p
, &
©å
, 
afi
, 
ßfi
)))

3745 
	`bgp_adj_out_£t
 (
∫
, 
≥î
, &∫->
p
, &
©å
, 
afi
, 
ßfi
, 
ri
);

3747 
	`bgp_adj_out_un£t
 (
∫
, 
≥î
, &∫->
p
, 
afi
, 
ßfi
);

3749 
	}
}

3752 
	$bgp_™noun˚_rouã
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

3754 
bgp_node
 *
∫
;

3755 
bgp_èbÀ
 *
èbÀ
;

3757 i‡(
≥î
->
°©us
 !
E°ablished
)

3760 i‡(! 
≥î
->
afc_√go
[
afi
][
ßfi
])

3764 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_WAIT_REFRESH
))

3767 i‡(
ßfi
 !
SAFI_MPLS_VPN
)

3768 
	`bgp_™noun˚_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
NULL
, 0);

3770 
∫
 = 
	`bgp_èbÀ_t›
 (
≥î
->
bgp
->
rib
[
afi
][
ßfi
]);Ñn;

3771 
∫
 = 
	`bgp_rouã_√xt
(rn))

3772 i‡((
èbÀ
 = (
∫
->
öfo
)Ë!
NULL
)

3773 
	`bgp_™noun˚_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
èbÀ
, 0);

3775 i‡(
	`CHECK_FLAG
(
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

3776 
	`bgp_™noun˚_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
NULL
, 1);

3777 
	}
}

3780 
	$bgp_™noun˚_rouã_Æl
 (
≥î
 *peer)

3782 
afi_t
 
afi
;

3783 
ßfi_t
 
ßfi
;

3785 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

3786 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

3787 
	`bgp_™noun˚_rouã
 (
≥î
, 
afi
, 
ßfi
);

3788 
	}
}

3791 
	$bgp_so·_ªc⁄fig_èbÀ_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
afi_t
 
afi
,

3792 
ßfi_t
 
ßfi
, 
bgp_èbÀ
 *
èbÀ
, 
¥efix_rd
 *
¥d
)

3794 
bgp_node
 *
∫
;

3795 
bgp_adj_ö
 *
aö
;

3797 i‡(! 
èbÀ
)

3798 
èbÀ
 = 
rs˛õ¡
->
bgp
->
rib
[
afi
][
ßfi
];

3800 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

3801 
aö
 = 
∫
->
adj_ö
;áö;áö =áö->
√xt
)

3803 
bgp_öfo
 *
ri
 = 
∫
->
öfo
;

3804 
u_ch¨
 *
èg
 = (
ri
 &&Ñi->
exåa
Ë?Ñi->exåa->èg : 
NULL
;

3806 
	`bgp_upd©e_rs˛õ¡
 (
rs˛õ¡
, 
afi
, 
ßfi
, 
aö
->
©å
,áö->
≥î
,

3807 &
∫
->
p
, 
ZEBRA_ROUTE_BGP
, 
BGP_ROUTE_NORMAL
, 
¥d
, 
èg
);

3809 
	}
}

3812 
	$bgp_so·_ªc⁄fig_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

3814 
bgp_èbÀ
 *
èbÀ
;

3815 
bgp_node
 *
∫
;

3817 i‡(
ßfi
 !
SAFI_MPLS_VPN
)

3818 
	`bgp_so·_ªc⁄fig_èbÀ_rs˛õ¡
 (
rs˛õ¡
, 
afi
, 
ßfi
, 
NULL
, NULL);

3821 
∫
 = 
	`bgp_èbÀ_t›
 (
rs˛õ¡
->
bgp
->
rib
[
afi
][
ßfi
]);Ñn;

3822 
∫
 = 
	`bgp_rouã_√xt
 (rn))

3823 i‡((
èbÀ
 = 
∫
->
öfo
Ë!
NULL
)

3825 
¥efix_rd
 
¥d
;

3826 
¥d
.
Ámûy
 = 
AF_UNSPEC
;

3827 
¥d
.
¥efixÀn
 = 64;

3828 
	`mem˝y
(&
¥d
.
vÆ
, 
∫
->
p
.
u
.val, 8);

3830 
	`bgp_so·_ªc⁄fig_èbÀ_rs˛õ¡
 (
rs˛õ¡
, 
afi
, 
ßfi
, 
èbÀ
, &
¥d
);

3832 
	}
}

3835 
	$bgp_so·_ªc⁄fig_èbÀ
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

3836 
bgp_èbÀ
 *
èbÀ
, 
¥efix_rd
 *
¥d
)

3838 
ªt
;

3839 
bgp_node
 *
∫
;

3840 
bgp_adj_ö
 *
aö
;

3842 i‡(! 
èbÀ
)

3843 
èbÀ
 = 
≥î
->
bgp
->
rib
[
afi
][
ßfi
];

3845 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

3846 
aö
 = 
∫
->
adj_ö
;áö;áö =áö->
√xt
)

3848 i‡(
aö
->
≥î
 ==Öeer)

3850 
bgp_öfo
 *
ri
 = 
∫
->
öfo
;

3851 
u_ch¨
 *
èg
 = (
ri
 &&Ñi->
exåa
Ë?Ñi->exåa->èg : 
NULL
;

3853 
ªt
 = 
	`bgp_upd©e
 (
≥î
, &
∫
->
p
, 
aö
->
©å
, 
afi
, 
ßfi
,

3854 
ZEBRA_ROUTE_BGP
, 
BGP_ROUTE_NORMAL
,

3855 
¥d
, 
èg
, 1);

3857 i‡(
ªt
 < 0)

3859 
	`bgp_u∆ock_node
 (
∫
);

3865 
	}
}

3868 
	$bgp_so·_ªc⁄fig_ö
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

3870 
bgp_node
 *
∫
;

3871 
bgp_èbÀ
 *
èbÀ
;

3873 i‡(
≥î
->
°©us
 !
E°ablished
)

3876 i‡(
ßfi
 !
SAFI_MPLS_VPN
)

3877 
	`bgp_so·_ªc⁄fig_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
NULL
, NULL);

3879 
∫
 = 
	`bgp_èbÀ_t›
 (
≥î
->
bgp
->
rib
[
afi
][
ßfi
]);Ñn;

3880 
∫
 = 
	`bgp_rouã_√xt
 (rn))

3881 i‡((
èbÀ
 = 
∫
->
öfo
Ë!
NULL
)

3883 
¥efix_rd
 
¥d
;

3884 
¥d
.
Ámûy
 = 
AF_UNSPEC
;

3885 
¥d
.
¥efixÀn
 = 64;

3886 
	`mem˝y
(&
¥d
.
vÆ
, 
∫
->
p
.
u
.val, 8);

3888 
	`bgp_so·_ªc⁄fig_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
èbÀ
, &
¥d
);

3890 
	}
}

3893 
	sbgp_˛ór_node_queue


3895 
bgp_node
 *
	m∫
;

3896 
bgp_˛ór_rouã_ty≥
 
	mpuΩo£
;

3899 
wq_ôem_°©us


3900 
	$bgp_˛ór_rouã_node
 (
w‹k_queue
 *
wq
, *
d©a
)

3902 
bgp_˛ór_node_queue
 *
˙q
 = 
d©a
;

3903 
bgp_node
 *
∫
 = 
˙q
->rn;

3904 
≥î
 *≥î = 
wq
->
•ec
.
d©a
;

3905 
bgp_öfo
 *
ri
;

3906 
afi_t
 
afi
 = 
	`bgp_node_èbÀ
 (
∫
)->afi;

3907 
ßfi_t
 
ßfi
 = 
	`bgp_node_èbÀ
 (
∫
)->safi;

3909 
	`as£π
 (
∫
 && 
≥î
);

3911 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

3912 i‡(
ri
->
≥î
 =≥î || 
˙q
->
puΩo£
 =
BGP_CLEAR_ROUTE_MY_RSCLIENT
)

3915 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
)

3916 && 
≥î
->
nsf
[
afi
][
ßfi
]

3917 && ! 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_STALE
)

3918 && ! 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_UNUSEABLE
))

3919 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_STALE
);

3921 
	`bgp_rib_ªmove
 (
∫
, 
ri
, 
≥î
, 
afi
, 
ßfi
);

3924  
WQ_SUCCESS
;

3925 
	}
}

3928 
	$bgp_˛ór_node_queue_dñ
 (
w‹k_queue
 *
wq
, *
d©a
)

3930 
bgp_˛ór_node_queue
 *
˙q
 = 
d©a
;

3931 
bgp_node
 *
∫
 = 
˙q
->rn;

3932 
bgp_èbÀ
 *
èbÀ
 = 
	`bgp_node_èbÀ
 (
∫
);

3934 
	`bgp_u∆ock_node
 (
∫
);

3935 
	`bgp_èbÀ_u∆ock
 (
èbÀ
);

3936 
	`XFREE
 (
MTYPE_BGP_CLEAR_NODE_QUEUE
, 
˙q
);

3937 
	}
}

3940 
	$bgp_˛ór_node_com∂ëe
 (
w‹k_queue
 *
wq
)

3942 
≥î
 *≥î = 
wq
->
•ec
.
d©a
;

3945 
	`BGP_EVENT_ADD
 (
≥î
, 
CÀ¨ög_Com∂ëed
);

3947 
	`≥î_u∆ock
 (
≥î
);

3948 
	}
}

3951 
	$bgp_˛ór_node_queue_öô
 (
≥î
 *peer)

3953 
w«me
[("clear xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx")];

3955 
	`¢¥ötf
 (
w«me
, (w«me), "˛ó∏%s", 
≥î
->
ho°
);

3956 #unde‡
CLEAR_QUEUE_NAME_LEN


3958 i‡–(
≥î
->
˛ór_node_queue
 = 
	`w‹k_queue_√w
 (
bm
->
ma°î
, 
w«me
)Ë=
NULL
)

3960 
	`zlog_îr
 ("%s: FaûedÅÿÆloˇã w‹k queue", 
__func__
);

3961 
	`exô
 (1);

3963 
≥î
->
˛ór_node_queue
->
•ec
.
hﬁd
 = 10;

3964 
≥î
->
˛ór_node_queue
->
•ec
.
w‹kfunc
 = &
bgp_˛ór_rouã_node
;

3965 
≥î
->
˛ór_node_queue
->
•ec
.
dñ_ôem_d©a
 = &
bgp_˛ór_node_queue_dñ
;

3966 
≥î
->
˛ór_node_queue
->
•ec
.
com∂ëi⁄_func
 = &
bgp_˛ór_node_com∂ëe
;

3967 
≥î
->
˛ór_node_queue
->
•ec
.
max_ªåõs
 = 0;

3970 
≥î
->
˛ór_node_queue
->
•ec
.
d©a
 =Öeer;

3971 
	}
}

3974 
	$bgp_˛ór_rouã_èbÀ
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

3975 
bgp_èbÀ
 *
èbÀ
, 
≥î
 *
rs˛õ¡
,

3976 
bgp_˛ór_rouã_ty≥
 
puΩo£
)

3978 
bgp_node
 *
∫
;

3981 i‡(! 
èbÀ
)

3982 
èbÀ
 = (
rs˛õ¡
Ë?Ñs˛õ¡->
rib
[
afi
][
ßfi
] : 
≥î
->
bgp
->rib[afi][safi];

3985 i‡(! 
èbÀ
)

3988 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

3990 
bgp_öfo
 *
ri
;

3991 
bgp_adj_ö
 *
aö
;

3992 
bgp_adj_out
 *
aout
;

4025 
aö
 = 
∫
->
adj_ö
;áö;áö =áö->
√xt
)

4026 i‡(
aö
->
≥î
 =≥î || 
puΩo£
 =
BGP_CLEAR_ROUTE_MY_RSCLIENT
)

4028 
	`bgp_adj_ö_ªmove
 (
∫
, 
aö
);

4029 
	`bgp_u∆ock_node
 (
∫
);

4032 
aout
 = 
∫
->
adj_out
;áout;áouàaout->
√xt
)

4033 i‡(
aout
->
≥î
 =≥î || 
puΩo£
 =
BGP_CLEAR_ROUTE_MY_RSCLIENT
)

4035 
	`bgp_adj_out_ªmove
 (
∫
, 
aout
, 
≥î
, 
afi
, 
ßfi
);

4036 
	`bgp_u∆ock_node
 (
∫
);

4040 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4041 i‡(
ri
->
≥î
 =≥î || 
puΩo£
 =
BGP_CLEAR_ROUTE_MY_RSCLIENT
)

4043 
bgp_˛ór_node_queue
 *
˙q
;

4046 
	`bgp_èbÀ_lock
 (
	`bgp_node_èbÀ
 (
∫
));

4047 
	`bgp_lock_node
 (
∫
);

4048 
˙q
 = 
	`XCALLOC
 (
MTYPE_BGP_CLEAR_NODE_QUEUE
,

4049  (
bgp_˛ór_node_queue
));

4050 
˙q
->
∫
 =Ñn;

4051 
˙q
->
puΩo£
 =Öurpose;

4052 
	`w‹k_queue_add
 (
≥î
->
˛ór_node_queue
, 
˙q
);

4057 
	}
}

4060 
	$bgp_˛ór_rouã
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

4061 
bgp_˛ór_rouã_ty≥
 
puΩo£
)

4063 
bgp_node
 *
∫
;

4064 
bgp_èbÀ
 *
èbÀ
;

4065 
≥î
 *
rs˛õ¡
;

4066 
li°node
 *
node
, *
¬ode
;

4068 i‡(
≥î
->
˛ór_node_queue
 =
NULL
)

4069 
	`bgp_˛ór_node_queue_öô
 (
≥î
);

4083 i‡(!
≥î
->
˛ór_node_queue
->
thªad
)

4084 
	`≥î_lock
 (
≥î
);

4086 
puΩo£
)

4088 
BGP_CLEAR_ROUTE_NORMAL
:

4089 i‡(
ßfi
 !
SAFI_MPLS_VPN
)

4090 
	`bgp_˛ór_rouã_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
NULL
, NULL, 
puΩo£
);

4092 
∫
 = 
	`bgp_èbÀ_t›
 (
≥î
->
bgp
->
rib
[
afi
][
ßfi
]);Ñn;

4093 
∫
 = 
	`bgp_rouã_√xt
 (rn))

4094 i‡((
èbÀ
 = 
∫
->
öfo
Ë!
NULL
)

4095 
	`bgp_˛ór_rouã_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
èbÀ
, 
NULL
, 
puΩo£
);

4097 
	`ALL_LIST_ELEMENTS
 (
≥î
->
bgp
->
rs˛õ¡
, 
node
, 
¬ode
,Ñsclient))

4098 i‡(
	`CHECK_FLAG
(
rs˛õ¡
->
af_Êags
[
afi
][
ßfi
],

4099 
PEER_FLAG_RSERVER_CLIENT
))

4100 
	`bgp_˛ór_rouã_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
NULL
, 
rs˛õ¡
, 
puΩo£
);

4103 
BGP_CLEAR_ROUTE_MY_RSCLIENT
:

4104 
	`bgp_˛ór_rouã_èbÀ
 (
≥î
, 
afi
, 
ßfi
, 
NULL
,Öìr, 
puΩo£
);

4108 
	`as£π
 (0);

4131 i‡(!
≥î
->
˛ór_node_queue
->
thªad
)

4132 
	`bgp_˛ór_node_com∂ëe
 (
≥î
->
˛ór_node_queue
);

4133 
	}
}

4136 
	$bgp_˛ór_rouã_Æl
 (
≥î
 *peer)

4138 
afi_t
 
afi
;

4139 
ßfi_t
 
ßfi
;

4141 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4142 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4143 
	`bgp_˛ór_rouã
 (
≥î
, 
afi
, 
ßfi
, 
BGP_CLEAR_ROUTE_NORMAL
);

4144 
	}
}

4147 
	$bgp_˛ór_adj_ö
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4149 
bgp_èbÀ
 *
èbÀ
;

4150 
bgp_node
 *
∫
;

4151 
bgp_adj_ö
 *
aö
;

4153 
èbÀ
 = 
≥î
->
bgp
->
rib
[
afi
][
ßfi
];

4155 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

4156 
aö
 = 
∫
->
adj_ö
;áö ;áö =áö->
√xt
)

4157 i‡(
aö
->
≥î
 ==Öeer)

4159 
	`bgp_adj_ö_ªmove
 (
∫
, 
aö
);

4160 
	`bgp_u∆ock_node
 (
∫
);

4163 
	}
}

4166 
	$bgp_˛ór_°Æe_rouã
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4168 
bgp_node
 *
∫
;

4169 
bgp_öfo
 *
ri
;

4170 
bgp_èbÀ
 *
èbÀ
;

4172 
èbÀ
 = 
≥î
->
bgp
->
rib
[
afi
][
ßfi
];

4174 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

4176 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4177 i‡(
ri
->
≥î
 ==Öeer)

4179 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_STALE
))

4180 
	`bgp_rib_ªmove
 (
∫
, 
ri
, 
≥î
, 
afi
, 
ßfi
);

4184 
	}
}

4188 
	$bgp_˛ónup_rouãs
 ()

4190 
bgp
 *bgp;

4191 
li°node
 *
node
, *
¬ode
;

4192 
bgp_node
 *
∫
;

4193 
bgp_èbÀ
 *
èbÀ
;

4194 
bgp_öfo
 *
ri
;

4196 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

4198 
èbÀ
 = 
bgp
->
rib
[
AFI_IP
][
SAFI_UNICAST
];

4200 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

4201 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4202 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_SELECTED
)

4203 && 
ri
->
ty≥
 =
ZEBRA_ROUTE_BGP


4204 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_NORMAL
)

4205 
	`bgp_zebø_wôhdøw
 (&
∫
->
p
, 
ri
,
SAFI_UNICAST
);

4207 
èbÀ
 = 
bgp
->
rib
[
AFI_IP6
][
SAFI_UNICAST
];

4209 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

4210 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4211 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_SELECTED
)

4212 && 
ri
->
ty≥
 =
ZEBRA_ROUTE_BGP


4213 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_NORMAL
)

4214 
	`bgp_zebø_wôhdøw
 (&
∫
->
p
, 
ri
,
SAFI_UNICAST
);

4216 
	}
}

4219 
	$bgp_ª£t
 ()

4221 
	`vty_ª£t
 ();

4222 
	`bgp_z˛õ¡_ª£t
 ();

4223 
	`ac˚ss_li°_ª£t
 ();

4224 
	`¥efix_li°_ª£t
 ();

4225 
	}
}

4230 
	$bgp_∆ri_∑r£
 (
≥î
 *≥î, 
©å
 *©å, 
bgp_∆ri
 *
∑ckë
)

4232 
u_ch¨
 *
≤t
;

4233 
u_ch¨
 *
lim
;

4234 
¥efix
 
p
;

4235 
psize
;

4236 
ªt
;

4239 i‡(
≥î
->
°©us
 !
E°ablished
)

4242 
≤t
 = 
∑ckë
->
∆ri
;

4243 
lim
 = 
≤t
 + 
∑ckë
->
Àngth
;

4245 ; 
≤t
 < 
lim
;Ö¡ +
psize
)

4248 
	`mem£t
 (&
p
, 0,  (
¥efix
));

4251 
p
.
¥efixÀn
 = *
≤t
++;

4252 
p
.
Ámûy
 = 
	`afi2Ámûy
 (
∑ckë
->
afi
);

4256 i‡((
∑ckë
->
afi
 =
AFI_IP
 && 
p
.
¥efixÀn
 > 32)

4257 || (
∑ckë
->
afi
 =
AFI_IP6
 && 
p
.
¥efixÀn
 > 128))

4261 
psize
 = 
	`PSIZE
 (
p
.
¥efixÀn
);

4264 i‡(
≤t
 + 
psize
 > 
lim
)

4268 
	`mem˝y
 (&
p
.
u
.
¥efix
, 
≤t
, 
psize
);

4271 i‡(
∑ckë
->
afi
 =
AFI_IP
 &&Öackë->
ßfi
 =
SAFI_UNICAST
)

4273 i‡(
	`IN_CLASSD
 (
	`¡ohl
 (
p
.
u
.
¥efix4
.
s_addr
)))

4282 
	`zlog
 (
≥î
->
log
, 
LOG_ERR
,

4284 
	`öë_¡ﬂ
 (
p
.
u
.
¥efix4
));

4290 #ifde‡
HAVE_IPV6


4292 i‡(
∑ckë
->
afi
 =
AFI_IP6
 &&Öackë->
ßfi
 =
SAFI_UNICAST
)

4294 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
p
.
u
.
¥efix6
))

4296 
buf
[
BUFSIZ
];

4298 
	`zlog
 (
≥î
->
log
, 
LOG_WARNING
,

4300 
	`öë_¡›
 (
AF_INET6
, &
p
.
u
.
¥efix6
, 
buf
, 
BUFSIZ
));

4308 i‡(
©å
)

4309 
ªt
 = 
	`bgp_upd©e
 (
≥î
, &
p
, 
©å
, 
∑ckë
->
afi
,Öackë->
ßfi
,

4310 
ZEBRA_ROUTE_BGP
, 
BGP_ROUTE_NORMAL
, 
NULL
, NULL, 0);

4312 
ªt
 = 
	`bgp_wôhdøw
 (
≥î
, &
p
, 
©å
, 
∑ckë
->
afi
,Öackë->
ßfi
,

4313 
ZEBRA_ROUTE_BGP
, 
BGP_ROUTE_NORMAL
, 
NULL
, NULL);

4317 i‡(
ªt
 < 0)

4322 i‡(
≤t
 !
lim
)

4326 
	}
}

4330 
	$bgp_∆ri_ßnôy_check
 (
≥î
 *≥î, 
afi
, 
u_ch¨
 *
≤t
,

4331 
bgp_size_t
 
Àngth
)

4333 
u_ch¨
 *
íd
;

4334 
u_ch¨
 
¥efixÀn
;

4335 
psize
;

4337 
íd
 = 
≤t
 + 
Àngth
;

4343 
≤t
 < 
íd
)

4345 
¥efixÀn
 = *
≤t
++;

4348 i‡((
afi
 =
AFI_IP
 && 
¥efixÀn
 > 32)

4349 || (
afi
 =
AFI_IP6
 && 
¥efixÀn
 > 128))

4351 
	`∂og_îr
 (
≥î
->
log
,

4353 
≥î
->
ho°
, 
¥efixÀn
);

4354 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

4355 
BGP_NOTIFY_UPDATE_INVAL_NETWORK
);

4360 
psize
 = 
	`PSIZE
 (
¥efixÀn
);

4362 i‡(
≤t
 + 
psize
 > 
íd
)

4364 
	`∂og_îr
 (
≥î
->
log
,

4367 
≥î
->
ho°
, 
psize
);

4368 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

4369 
BGP_NOTIFY_UPDATE_INVAL_NETWORK
);

4373 
≤t
 +
psize
;

4377 i‡(
≤t
 !
íd
)

4379 
	`∂og_îr
 (
≥î
->
log
,

4382 
≥î
->
ho°
);

4383 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_UPDATE_ERR
,

4384 
BGP_NOTIFY_UPDATE_INVAL_NETWORK
);

4388 
	}
}

4390 
bgp_°©ic
 *

4391 
	$bgp_°©ic_√w
 ()

4393  
	`XCALLOC
 (
MTYPE_BGP_STATIC
,  (
bgp_°©ic
));

4394 
	}
}

4397 
	$bgp_°©ic_‰ì
 (
bgp_°©ic
 *bgp_static)

4399 i‡(
bgp_°©ic
->
rm≠
.
«me
)

4400 
	`‰ì
 (
bgp_°©ic
->
rm≠
.
«me
);

4401 
	`XFREE
 (
MTYPE_BGP_STATIC
, 
bgp_°©ic
);

4402 
	}
}

4405 
	$bgp_°©ic_wôhdøw_rs˛õ¡
 (
bgp
 *bgp, 
≥î
 *
rs˛õ¡
,

4406 
¥efix
 *
p
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4408 
bgp_node
 *
∫
;

4409 
bgp_öfo
 *
ri
;

4411 
∫
 = 
	`bgp_afi_node_gë
 (
rs˛õ¡
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
NULL
);

4414 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4415 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf


4416 && 
ri
->
ty≥
 =
ZEBRA_ROUTE_BGP


4417 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_STATIC
)

4421 i‡(
ri
)

4423 
	`bgp_öfo_dñëe
 (
∫
, 
ri
);

4424 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4428 
	`bgp_u∆ock_node
 (
∫
);

4429 
	}
}

4432 
	$bgp_°©ic_upd©e_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
¥efix
 *
p
,

4433 
bgp_°©ic
 *bgp_static,

4434 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4436 
bgp_node
 *
∫
;

4437 
bgp_öfo
 *
ri
;

4438 
bgp_öfo
 *
√w
;

4439 
bgp_öfo
 
öfo
;

4440 
©å
 *
©å_√w
;

4441 
©å
áttr;

4442 
©å
 
√w_©å
;

4443 
©å_exåa
 
√w_exåa
;

4444 
bgp
 *bgp;

4445 
ªt
;

4446 
buf
[
SU_ADDRSTRLEN
];

4448 
bgp
 = 
rs˛õ¡
->bgp;

4450 
	`as£π
 (
bgp_°©ic
);

4451 i‡(!
bgp_°©ic
)

4454 
∫
 = 
	`bgp_afi_node_gë
 (
rs˛õ¡
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
NULL
);

4456 
	`bgp_©å_deÁu…_£t
 (&
©å
, 
BGP_ORIGIN_IGP
);

4458 
©å
.
√xth›
 = 
bgp_°©ic
->
ig≤exth›
;

4459 
©å
.
med
 = 
bgp_°©ic
->
igpmëric
;

4460 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
);

4462 i‡(
bgp_°©ic
->
©omic
)

4463 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
);

4466 i‡(
bgp_°©ic
->
rm≠
.
«me
)

4468 
©å
 
©å_tmp
 =áttr;

4469 
öfo
.
≥î
 = 
rs˛õ¡
;

4470 
öfo
.
©å
 = &
©å_tmp
;

4472 
	`SET_FLAG
 (
rs˛õ¡
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_EXPORT
);

4473 
	`SET_FLAG
 (
rs˛õ¡
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_NETWORK
);

4475 
ªt
 = 
	`rouã_m≠_≠∂y
 (
bgp_°©ic
->
rm≠
.
m≠
, 
p
, 
RMAP_BGP
, &
öfo
);

4477 
rs˛õ¡
->
rm≠_ty≥
 = 0;

4479 i‡(
ªt
 =
RMAP_DENYMATCH
)

4482 
	`bgp_©å_Êush
 (&
©å_tmp
);

4485 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4486 
	`bgp_°©ic_wôhdøw_rs˛õ¡
 (
bgp
, 
rs˛õ¡
, 
p
, 
afi
, 
ßfi
);

4487 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4491 
©å_√w
 = 
	`bgp_©å_öã∫
 (&
©å_tmp
);

4494 
©å_√w
 = 
	`bgp_©å_öã∫
 (&
©å
);

4496 
√w_©å
.
exåa
 = &
√w_exåa
;

4497 
	`bgp_©å_dup
(&
√w_©å
, 
©å_√w
);

4499 
	`SET_FLAG
 (
bgp
->
≥î_£lf
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_NETWORK
);

4501 i‡(
	`bgp_imp‹t_modifõr
 (
rs˛õ¡
, 
bgp
->
≥î_£lf
, 
p
, &
√w_©å
, 
afi
, 
ßfi
)

4502 =
RMAP_DENY
)

4505 i‡(
	`BGP_DEBUG
 (
upd©e
, 
UPDATE_IN
))

4506 
	`zlog
 (
rs˛õ¡
->
log
, 
LOG_DEBUG
,

4508 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

4509 
p
->
¥efixÀn
, 
rs˛õ¡
->
ho°
);

4511 
bgp
->
≥î_£lf
->
rm≠_ty≥
 = 0;

4513 
	`bgp_©å_unöã∫
 (&
©å_√w
);

4514 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4515 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4517 
	`bgp_°©ic_wôhdøw_rs˛õ¡
 (
bgp
, 
rs˛õ¡
, 
p
, 
afi
, 
ßfi
);

4522 
bgp
->
≥î_£lf
->
rm≠_ty≥
 = 0;

4524 
	`bgp_©å_unöã∫
 (&
©å_√w
);

4525 
©å_√w
 = 
	`bgp_©å_öã∫
 (&
√w_©å
);

4527 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4528 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf
 &&Ñi->
ty≥
 =
ZEBRA_ROUTE_BGP


4529 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_STATIC
)

4532 i‡(
ri
)

4534 i‡(
	`©åhash_cmp
 (
ri
->
©å
, 
©å_√w
) &&

4535 !
	`CHECK_FLAG
(
ri
->
Êags
, 
BGP_INFO_REMOVED
))

4537 
	`bgp_u∆ock_node
 (
∫
);

4538 
	`bgp_©å_unöã∫
 (&
©å_√w
);

4539 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4540 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4546 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

4549 i‡(
	`CHECK_FLAG
(
ri
->
Êags
, 
BGP_INFO_REMOVED
))

4550 
	`bgp_öfo_ª°‹e
(
∫
, 
ri
);

4551 
	`bgp_©å_unöã∫
 (&
ri
->
©å
);

4552 
ri
->
©å
 = 
©å_√w
;

4553 
ri
->
u±ime
 = 
	`bgp_˛ock
 ();

4556 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4557 
	`bgp_u∆ock_node
 (
∫
);

4558 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4559 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4565 
√w
 = 
	`bgp_öfo_√w
 ();

4566 
√w
->
ty≥
 = 
ZEBRA_ROUTE_BGP
;

4567 
√w
->
sub_ty≥
 = 
BGP_ROUTE_STATIC
;

4568 
√w
->
≥î
 = 
bgp
->
≥î_£lf
;

4569 
	`SET_FLAG
 (
√w
->
Êags
, 
BGP_INFO_VALID
);

4570 
√w
->
©å
 = 
©å_√w
;

4571 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

4574 
	`bgp_öfo_add
 (
∫
, 
√w
);

4577 
	`bgp_u∆ock_node
 (
∫
);

4580 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4583 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4584 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4585 
	}
}

4588 
	$bgp_°©ic_upd©e_maö
 (
bgp
 *bgp, 
¥efix
 *
p
,

4589 
bgp_°©ic
 *bgp_°©ic, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4591 
bgp_node
 *
∫
;

4592 
bgp_öfo
 *
ri
;

4593 
bgp_öfo
 *
√w
;

4594 
bgp_öfo
 
öfo
;

4595 
©å
áttr;

4596 
©å
 *
©å_√w
;

4597 
ªt
;

4599 
	`as£π
 (
bgp_°©ic
);

4600 i‡(!
bgp_°©ic
)

4603 
∫
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
NULL
);

4605 
	`bgp_©å_deÁu…_£t
 (&
©å
, 
BGP_ORIGIN_IGP
);

4607 
©å
.
√xth›
 = 
bgp_°©ic
->
ig≤exth›
;

4608 
©å
.
med
 = 
bgp_°©ic
->
igpmëric
;

4609 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
);

4611 i‡(
bgp_°©ic
->
©omic
)

4612 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
);

4615 i‡(
bgp_°©ic
->
rm≠
.
«me
)

4617 
©å
 
©å_tmp
 =áttr;

4618 
öfo
.
≥î
 = 
bgp
->
≥î_£lf
;

4619 
öfo
.
©å
 = &
©å_tmp
;

4621 
	`SET_FLAG
 (
bgp
->
≥î_£lf
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_NETWORK
);

4623 
ªt
 = 
	`rouã_m≠_≠∂y
 (
bgp_°©ic
->
rm≠
.
m≠
, 
p
, 
RMAP_BGP
, &
öfo
);

4625 
bgp
->
≥î_£lf
->
rm≠_ty≥
 = 0;

4627 i‡(
ªt
 =
RMAP_DENYMATCH
)

4630 
	`bgp_©å_Êush
 (&
©å_tmp
);

4633 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4634 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4635 
	`bgp_°©ic_wôhdøw
 (
bgp
, 
p
, 
afi
, 
ßfi
);

4638 
©å_√w
 = 
	`bgp_©å_öã∫
 (&
©å_tmp
);

4642 
©å_√w
 = 
	`bgp_©å_öã∫
 (&
©å
);

4645 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4646 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf
 &&Ñi->
ty≥
 =
ZEBRA_ROUTE_BGP


4647 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_STATIC
)

4650 i‡(
ri
)

4652 i‡(
	`©åhash_cmp
 (
ri
->
©å
, 
©å_√w
) &&

4653 !
	`CHECK_FLAG
(
ri
->
Êags
, 
BGP_INFO_REMOVED
))

4655 
	`bgp_u∆ock_node
 (
∫
);

4656 
	`bgp_©å_unöã∫
 (&
©å_√w
);

4657 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4658 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4664 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

4667 i‡(
	`CHECK_FLAG
(
ri
->
Êags
, 
BGP_INFO_REMOVED
))

4668 
	`bgp_öfo_ª°‹e
(
∫
, 
ri
);

4670 
	`bgp_aggªg©e_de¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
ßfi
);

4671 
	`bgp_©å_unöã∫
 (&
ri
->
©å
);

4672 
ri
->
©å
 = 
©å_√w
;

4673 
ri
->
u±ime
 = 
	`bgp_˛ock
 ();

4676 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
ßfi
);

4677 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4678 
	`bgp_u∆ock_node
 (
∫
);

4679 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4680 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4686 
√w
 = 
	`bgp_öfo_√w
 ();

4687 
√w
->
ty≥
 = 
ZEBRA_ROUTE_BGP
;

4688 
√w
->
sub_ty≥
 = 
BGP_ROUTE_STATIC
;

4689 
√w
->
≥î
 = 
bgp
->
≥î_£lf
;

4690 
	`SET_FLAG
 (
√w
->
Êags
, 
BGP_INFO_VALID
);

4691 
√w
->
©å
 = 
©å_√w
;

4692 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

4695 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
√w
, 
afi
, 
ßfi
);

4698 
	`bgp_öfo_add
 (
∫
, 
√w
);

4701 
	`bgp_u∆ock_node
 (
∫
);

4704 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4707 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

4708 
	`bgp_©å_exåa_‰ì
 (&
©å
);

4709 
	}
}

4712 
	$bgp_°©ic_upd©e
 (
bgp
 *bgp, 
¥efix
 *
p
,

4713 
bgp_°©ic
 *bgp_°©ic, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4715 
≥î
 *
rs˛õ¡
;

4716 
li°node
 *
node
, *
¬ode
;

4718 
	`bgp_°©ic_upd©e_maö
 (
bgp
, 
p
, 
bgp_°©ic
, 
afi
, 
ßfi
);

4720 
	`ALL_LIST_ELEMENTS
 (
bgp
->
rs˛õ¡
, 
node
, 
¬ode
,Ñsclient))

4722 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

4723 
	`bgp_°©ic_upd©e_rs˛õ¡
 (
rs˛õ¡
, 
p
, 
bgp_°©ic
, 
afi
, 
ßfi
);

4725 
	}
}

4728 
	$bgp_°©ic_upd©e_v≤v4
 (
bgp
 *bgp, 
¥efix
 *
p
, 
afi_t
 
afi
,

4729 
ßfi_t
 
ßfi
, 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
)

4731 
bgp_node
 *
∫
;

4732 
bgp_öfo
 *
√w
;

4734 
∫
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
¥d
);

4737 
√w
 = 
	`bgp_öfo_√w
 ();

4738 
√w
->
ty≥
 = 
ZEBRA_ROUTE_BGP
;

4739 
√w
->
sub_ty≥
 = 
BGP_ROUTE_STATIC
;

4740 
√w
->
≥î
 = 
bgp
->
≥î_£lf
;

4741 
√w
->
©å
 = 
	`bgp_©å_deÁu…_öã∫
 (
BGP_ORIGIN_IGP
);

4742 
	`SET_FLAG
 (
√w
->
Êags
, 
BGP_INFO_VALID
);

4743 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

4744 
√w
->
exåa
 = 
	`bgp_öfo_exåa_√w
();

4745 
	`mem˝y
 (
√w
->
exåa
->
èg
,Åag, 3);

4748 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
√w
, 
afi
, 
ßfi
);

4751 
	`bgp_öfo_add
 (
∫
, 
√w
);

4754 
	`bgp_u∆ock_node
 (
∫
);

4757 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4758 
	}
}

4761 
	$bgp_°©ic_wôhdøw
 (
bgp
 *bgp, 
¥efix
 *
p
, 
afi_t
 
afi
,

4762 
ßfi_t
 
ßfi
)

4764 
bgp_node
 *
∫
;

4765 
bgp_öfo
 *
ri
;

4767 
∫
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
NULL
);

4770 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4771 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf


4772 && 
ri
->
ty≥
 =
ZEBRA_ROUTE_BGP


4773 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_STATIC
)

4777 i‡(
ri
)

4779 
	`bgp_aggªg©e_de¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
ßfi
);

4780 
	`bgp_öfo_dñëe
 (
∫
, 
ri
);

4781 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4785 
	`bgp_u∆ock_node
 (
∫
);

4786 
	}
}

4789 
	$bgp_check_loˇl_rouãs_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4791 
bgp_°©ic
 *bgp_static;

4792 
bgp
 *bgp;

4793 
bgp_node
 *
∫
;

4794 
¥efix
 *
p
;

4796 
bgp
 = 
rs˛õ¡
->bgp;

4798 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rouã
[
afi
][
ßfi
]);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

4799 i‡((
bgp_°©ic
 = 
∫
->
öfo
Ë!
NULL
)

4801 
p
 = &
∫
->p;

4803 
	`bgp_°©ic_upd©e_rs˛õ¡
 (
rs˛õ¡
, 
p
, 
bgp_°©ic
,

4804 
afi
, 
ßfi
);

4806 
	}
}

4809 
	$bgp_°©ic_wôhdøw_v≤v4
 (
bgp
 *bgp, 
¥efix
 *
p
, 
afi_t
 
afi
,

4810 
ßfi_t
 
ßfi
, 
¥efix_rd
 *
¥d
, 
u_ch¨
 *
èg
)

4812 
bgp_node
 *
∫
;

4813 
bgp_öfo
 *
ri
;

4815 
∫
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
ßfi
],áfi, safi, 
p
, 
¥d
);

4818 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

4819 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf


4820 && 
ri
->
ty≥
 =
ZEBRA_ROUTE_BGP


4821 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_STATIC
)

4825 i‡(
ri
)

4827 
	`bgp_aggªg©e_de¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
ßfi
);

4828 
	`bgp_öfo_dñëe
 (
∫
, 
ri
);

4829 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

4833 
	`bgp_u∆ock_node
 (
∫
);

4834 
	}
}

4839 
	$bgp_°©ic_£t
 (
vty
 *vty, 
bgp
 *bgp, c⁄° *
ù_°r
,

4840 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, c⁄° *
rm≠
, 
backdo‹
)

4842 
ªt
;

4843 
¥efix
 
p
;

4844 
bgp_°©ic
 *bgp_static;

4845 
bgp_node
 *
∫
;

4846 
u_ch¨
 
√ed_upd©e
 = 0;

4849 
ªt
 = 
	`°r2¥efix
 (
ù_°r
, &
p
);

4850 i‡(! 
ªt
)

4852 
	`vty_out
 (
vty
, "%% MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

4853  
CMD_WARNING
;

4855 #ifde‡
HAVE_IPV6


4856 i‡(
afi
 =
AFI_IP6
 && 
	`IN6_IS_ADDR_LINKLOCAL
 (&
p
.
u
.
¥efix6
))

4858 
	`vty_out
 (
vty
, "%% MalformedÖrefix (link-localáddress)%s",

4859 
VTY_NEWLINE
);

4860  
CMD_WARNING
;

4864 
	`≠∂y_mask
 (&
p
);

4867 
∫
 = 
	`bgp_node_gë
 (
bgp
->
rouã
[
afi
][
ßfi
], &
p
);

4869 i‡(
∫
->
öfo
)

4872 
bgp_°©ic
 = 
∫
->
öfo
;

4875 i‡(
bgp_°©ic
->
vÆid
 && bgp_°©ic->
backdo‹
 != backdoor)

4876 
√ed_upd©e
 = 1;

4878 
bgp_°©ic
->
backdo‹
 = backdoor;

4880 i‡(
rm≠
)

4882 i‡(
bgp_°©ic
->
rm≠
.
«me
)

4883 
	`‰ì
 (
bgp_°©ic
->
rm≠
.
«me
);

4884 
bgp_°©ic
->
rm≠
.
«me
 = 
	`°rdup
 (rmap);

4885 
bgp_°©ic
->
rm≠
.
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (rmap);

4889 i‡(
bgp_°©ic
->
rm≠
.
«me
)

4890 
	`‰ì
 (
bgp_°©ic
->
rm≠
.
«me
);

4891 
bgp_°©ic
->
rm≠
.
«me
 = 
NULL
;

4892 
bgp_°©ic
->
rm≠
.
m≠
 = 
NULL
;

4893 
bgp_°©ic
->
vÆid
 = 0;

4895 
	`bgp_u∆ock_node
 (
∫
);

4900 
bgp_°©ic
 = 
	`bgp_°©ic_√w
 ();

4901 
bgp_°©ic
->
backdo‹
 = backdoor;

4902 
bgp_°©ic
->
vÆid
 = 0;

4903 
bgp_°©ic
->
igpmëric
 = 0;

4904 
bgp_°©ic
->
ig≤exth›
.
s_addr
 = 0;

4906 i‡(
rm≠
)

4908 i‡(
bgp_°©ic
->
rm≠
.
«me
)

4909 
	`‰ì
 (
bgp_°©ic
->
rm≠
.
«me
);

4910 
bgp_°©ic
->
rm≠
.
«me
 = 
	`°rdup
 (rmap);

4911 
bgp_°©ic
->
rm≠
.
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (rmap);

4913 
∫
->
öfo
 = 
bgp_°©ic
;

4917 i‡(! 
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_IMPORT_CHECK
))

4919 
bgp_°©ic
->
vÆid
 = 1;

4921 i‡(
√ed_upd©e
)

4922 
	`bgp_°©ic_wôhdøw
 (
bgp
, &
p
, 
afi
, 
ßfi
);

4923 i‡(! 
bgp_°©ic
->
backdo‹
)

4924 
	`bgp_°©ic_upd©e
 (
bgp
, &
p
, 
bgp_°©ic
, 
afi
, 
ßfi
);

4927  
CMD_SUCCESS
;

4928 
	}
}

4932 
	$bgp_°©ic_un£t
 (
vty
 *vty, 
bgp
 *bgp, c⁄° *
ù_°r
,

4933 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4935 
ªt
;

4936 
¥efix
 
p
;

4937 
bgp_°©ic
 *bgp_static;

4938 
bgp_node
 *
∫
;

4941 
ªt
 = 
	`°r2¥efix
 (
ù_°r
, &
p
);

4942 i‡(! 
ªt
)

4944 
	`vty_out
 (
vty
, "%% MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

4945  
CMD_WARNING
;

4947 #ifde‡
HAVE_IPV6


4948 i‡(
afi
 =
AFI_IP6
 && 
	`IN6_IS_ADDR_LINKLOCAL
 (&
p
.
u
.
¥efix6
))

4950 
	`vty_out
 (
vty
, "%% MalformedÖrefix (link-localáddress)%s",

4951 
VTY_NEWLINE
);

4952  
CMD_WARNING
;

4956 
	`≠∂y_mask
 (&
p
);

4958 
∫
 = 
	`bgp_node_lookup
 (
bgp
->
rouã
[
afi
][
ßfi
], &
p
);

4959 i‡(! 
∫
)

4961 
	`vty_out
 (
vty
, "%% Can't find specified staticÑoute configuration.%s",

4962 
VTY_NEWLINE
);

4963  
CMD_WARNING
;

4966 
bgp_°©ic
 = 
∫
->
öfo
;

4969 i‡(! 
bgp_°©ic
->
backdo‹
)

4970 
	`bgp_°©ic_wôhdøw
 (
bgp
, &
p
, 
afi
, 
ßfi
);

4973 
	`bgp_°©ic_‰ì
 (
bgp_°©ic
);

4974 
∫
->
öfo
 = 
NULL
;

4975 
	`bgp_u∆ock_node
 (
∫
);

4976 
	`bgp_u∆ock_node
 (
∫
);

4978  
CMD_SUCCESS
;

4979 
	}
}

4984 
	$bgp_°©ic_dñëe
 (
bgp
 *bgp)

4986 
afi_t
 
afi
;

4987 
ßfi_t
 
ßfi
;

4988 
bgp_node
 *
∫
;

4989 
bgp_node
 *
rm
;

4990 
bgp_èbÀ
 *
èbÀ
;

4991 
bgp_°©ic
 *bgp_static;

4993 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4994 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4995 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rouã
[
afi
][
ßfi
]);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

4996 i‡(
∫
->
öfo
 !
NULL
)

4998 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

5000 
èbÀ
 = 
∫
->
öfo
;

5002 
rm
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñm;Ñm = 
	`bgp_rouã_√xt
 (rm))

5004 
bgp_°©ic
 = 
∫
->
öfo
;

5005 
	`bgp_°©ic_wôhdøw_v≤v4
 (
bgp
, &
rm
->
p
,

5006 
AFI_IP
, 
SAFI_MPLS_VPN
,

5007 (
¥efix_rd
 *)&
∫
->
p
,

5008 
bgp_°©ic
->
èg
);

5009 
	`bgp_°©ic_‰ì
 (
bgp_°©ic
);

5010 
∫
->
öfo
 = 
NULL
;

5011 
	`bgp_u∆ock_node
 (
∫
);

5016 
bgp_°©ic
 = 
∫
->
öfo
;

5017 
	`bgp_°©ic_wôhdøw
 (
bgp
, &
∫
->
p
, 
afi
, 
ßfi
);

5018 
	`bgp_°©ic_‰ì
 (
bgp_°©ic
);

5019 
∫
->
öfo
 = 
NULL
;

5020 
	`bgp_u∆ock_node
 (
∫
);

5023 
	}
}

5026 
	$bgp_°©ic_£t_v≤v4
 (
vty
 *vty, c⁄° *
ù_°r
, c⁄° *
rd_°r
,

5027 c⁄° *
èg_°r
)

5029 
ªt
;

5030 
¥efix
 
p
;

5031 
¥efix_rd
 
¥d
;

5032 
bgp
 *bgp;

5033 
bgp_node
 *
¥n
;

5034 
bgp_node
 *
∫
;

5035 
bgp_èbÀ
 *
èbÀ
;

5036 
bgp_°©ic
 *bgp_static;

5037 
u_ch¨
 
èg
[3];

5039 
bgp
 = 
vty
->
ödex
;

5041 
ªt
 = 
	`°r2¥efix
 (
ù_°r
, &
p
);

5042 i‡(! 
ªt
)

5044 
	`vty_out
 (
vty
, "%% MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

5045  
CMD_WARNING
;

5047 
	`≠∂y_mask
 (&
p
);

5049 
ªt
 = 
	`°r2¥efix_rd
 (
rd_°r
, &
¥d
);

5050 i‡(! 
ªt
)

5052 
	`vty_out
 (
vty
, "%% MÆf‹medÑd%s", 
VTY_NEWLINE
);

5053  
CMD_WARNING
;

5056 
ªt
 = 
	`°r2èg
 (
èg_°r
, 
èg
);

5057 i‡(! 
ªt
)

5059 
	`vty_out
 (
vty
, "%% MÆf‹medÅag%s", 
VTY_NEWLINE
);

5060  
CMD_WARNING
;

5063 
¥n
 = 
	`bgp_node_gë
 (
bgp
->
rouã
[
AFI_IP
][
SAFI_MPLS_VPN
],

5064 (
¥efix
 *)&
¥d
);

5065 i‡(
¥n
->
öfo
 =
NULL
)

5066 
¥n
->
öfo
 = 
	`bgp_èbÀ_öô
 (
AFI_IP
, 
SAFI_MPLS_VPN
);

5068 
	`bgp_u∆ock_node
 (
¥n
);

5069 
èbÀ
 = 
¥n
->
öfo
;

5071 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, &
p
);

5073 i‡(
∫
->
öfo
)

5075 
	`vty_out
 (
vty
, "%% Samê√tw‹k c⁄figuøti⁄Éxi°s%s", 
VTY_NEWLINE
);

5076 
	`bgp_u∆ock_node
 (
∫
);

5081 
bgp_°©ic
 = 
	`bgp_°©ic_√w
 ();

5082 
bgp_°©ic
->
vÆid
 = 1;

5083 
	`mem˝y
 (
bgp_°©ic
->
èg
,Åag, 3);

5084 
∫
->
öfo
 = 
bgp_°©ic
;

5086 
	`bgp_°©ic_upd©e_v≤v4
 (
bgp
, &
p
, 
AFI_IP
, 
SAFI_MPLS_VPN
, &
¥d
, 
èg
);

5089  
CMD_SUCCESS
;

5090 
	}
}

5094 
	$bgp_°©ic_un£t_v≤v4
 (
vty
 *vty, c⁄° *
ù_°r
,

5095 c⁄° *
rd_°r
, c⁄° *
èg_°r
)

5097 
ªt
;

5098 
bgp
 *bgp;

5099 
¥efix
 
p
;

5100 
¥efix_rd
 
¥d
;

5101 
bgp_node
 *
¥n
;

5102 
bgp_node
 *
∫
;

5103 
bgp_èbÀ
 *
èbÀ
;

5104 
bgp_°©ic
 *bgp_static;

5105 
u_ch¨
 
èg
[3];

5107 
bgp
 = 
vty
->
ödex
;

5110 
ªt
 = 
	`°r2¥efix
 (
ù_°r
, &
p
);

5111 i‡(! 
ªt
)

5113 
	`vty_out
 (
vty
, "%% MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

5114  
CMD_WARNING
;

5116 
	`≠∂y_mask
 (&
p
);

5118 
ªt
 = 
	`°r2¥efix_rd
 (
rd_°r
, &
¥d
);

5119 i‡(! 
ªt
)

5121 
	`vty_out
 (
vty
, "%% MÆf‹medÑd%s", 
VTY_NEWLINE
);

5122  
CMD_WARNING
;

5125 
ªt
 = 
	`°r2èg
 (
èg_°r
, 
èg
);

5126 i‡(! 
ªt
)

5128 
	`vty_out
 (
vty
, "%% MÆf‹medÅag%s", 
VTY_NEWLINE
);

5129  
CMD_WARNING
;

5132 
¥n
 = 
	`bgp_node_gë
 (
bgp
->
rouã
[
AFI_IP
][
SAFI_MPLS_VPN
],

5133 (
¥efix
 *)&
¥d
);

5134 i‡(
¥n
->
öfo
 =
NULL
)

5135 
¥n
->
öfo
 = 
	`bgp_èbÀ_öô
 (
AFI_IP
, 
SAFI_MPLS_VPN
);

5137 
	`bgp_u∆ock_node
 (
¥n
);

5138 
èbÀ
 = 
¥n
->
öfo
;

5140 
∫
 = 
	`bgp_node_lookup
 (
èbÀ
, &
p
);

5142 i‡(
∫
)

5144 
	`bgp_°©ic_wôhdøw_v≤v4
 (
bgp
, &
p
, 
AFI_IP
, 
SAFI_MPLS_VPN
, &
¥d
, 
èg
);

5146 
bgp_°©ic
 = 
∫
->
öfo
;

5147 
	`bgp_°©ic_‰ì
 (
bgp_°©ic
);

5148 
∫
->
öfo
 = 
NULL
;

5149 
	`bgp_u∆ock_node
 (
∫
);

5150 
	`bgp_u∆ock_node
 (
∫
);

5153 
	`vty_out
 (
vty
, "%% C™'àfödÅhêrouã%s", 
VTY_NEWLINE
);

5155  
CMD_SUCCESS
;

5156 
	}
}

5158 
DEFUN
 (
bgp_√tw‹k
,

5159 
bgp_√tw‹k_cmd
,

5164  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¨gv
[0],

5165 
AFI_IP
, 
bgp_node_ßfi
 (
vty
), 
NULL
, 0);

5168 
DEFUN
 (
bgp_√tw‹k_rouã_m≠
,

5169 
bgp_√tw‹k_rouã_m≠_cmd
,

5176  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¨gv
[0],

5177 
AFI_IP
, 
bgp_node_ßfi
 (
vty
), 
¨gv
[1], 0);

5180 
DEFUN
 (
bgp_√tw‹k_backdo‹
,

5181 
bgp_√tw‹k_backdo‹_cmd
,

5187  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

5188 
NULL
, 1);

5191 
DEFUN
 (
bgp_√tw‹k_mask
,

5192 
bgp_√tw‹k_mask_cmd
,

5199 
	gªt
;

5200 
	g¥efix_°r
[
BUFSIZ
];

5202 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

5203 i‡(! 
	gªt
)

5205 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5206  
	gCMD_WARNING
;

5209  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¥efix_°r
,

5210 
AFI_IP
, 
bgp_node_ßfi
 (
vty
), 
NULL
, 0);

5213 
DEFUN
 (
bgp_√tw‹k_mask_rouã_m≠
,

5214 
bgp_√tw‹k_mask_rouã_m≠_cmd
,

5223 
	gªt
;

5224 
	g¥efix_°r
[
BUFSIZ
];

5226 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

5227 i‡(! 
	gªt
)

5229 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5230  
	gCMD_WARNING
;

5233  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¥efix_°r
,

5234 
AFI_IP
, 
bgp_node_ßfi
 (
vty
), 
¨gv
[2], 0);

5237 
DEFUN
 (
bgp_√tw‹k_mask_backdo‹
,

5238 
bgp_√tw‹k_mask_backdo‹_cmd
,

5246 
	gªt
;

5247 
	g¥efix_°r
[
BUFSIZ
];

5249 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

5250 i‡(! 
	gªt
)

5252 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5253  
	gCMD_WARNING
;

5256  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¥efix_°r
, 
AFI_IP
, 
SAFI_UNICAST
,

5257 
NULL
, 1);

5260 
DEFUN
 (
bgp_√tw‹k_mask_«tuøl
,

5261 
bgp_√tw‹k_mask_«tuøl_cmd
,

5266 
	gªt
;

5267 
	g¥efix_°r
[
BUFSIZ
];

5269 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0], 
NULL
, 
¥efix_°r
);

5270 i‡(! 
	gªt
)

5272 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5273  
	gCMD_WARNING
;

5276  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¥efix_°r
,

5277 
AFI_IP
, 
bgp_node_ßfi
 (
vty
), 
NULL
, 0);

5280 
DEFUN
 (
bgp_√tw‹k_mask_«tuøl_rouã_m≠
,

5281 
bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
,

5288 
	gªt
;

5289 
	g¥efix_°r
[
BUFSIZ
];

5291 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0], 
NULL
, 
¥efix_°r
);

5292 i‡(! 
	gªt
)

5294 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5295  
	gCMD_WARNING
;

5298  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¥efix_°r
,

5299 
AFI_IP
, 
bgp_node_ßfi
 (
vty
), 
¨gv
[1], 0);

5302 
DEFUN
 (
bgp_√tw‹k_mask_«tuøl_backdo‹
,

5303 
bgp_√tw‹k_mask_«tuøl_backdo‹_cmd
,

5309 
	gªt
;

5310 
	g¥efix_°r
[
BUFSIZ
];

5312 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0], 
NULL
, 
¥efix_°r
);

5313 i‡(! 
	gªt
)

5315 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5316  
	gCMD_WARNING
;

5319  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¥efix_°r
, 
AFI_IP
, 
SAFI_UNICAST
,

5320 
NULL
, 1);

5323 
DEFUN
 (
no_bgp_√tw‹k
,

5324 
no_bgp_√tw‹k_cmd
,

5326 
NO_STR


5330  
bgp_°©ic_un£t
 (
vty
, vty->
ödex
, 
¨gv
[0], 
AFI_IP
,

5331 
bgp_node_ßfi
 (
vty
));

5334 
ALIAS
 (
no_bgp_√tw‹k
,

5335 
no_bgp_√tw‹k_rouã_m≠_cmd
,

5337 
NO_STR


5343 
ALIAS
 (
no_bgp_√tw‹k
,

5344 
no_bgp_√tw‹k_backdo‹_cmd
,

5346 
NO_STR


5351 
DEFUN
 (
no_bgp_√tw‹k_mask
,

5352 
no_bgp_√tw‹k_mask_cmd
,

5354 
NO_STR


5360 
	gªt
;

5361 
	g¥efix_°r
[
BUFSIZ
];

5363 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

5364 i‡(! 
	gªt
)

5366 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5367  
	gCMD_WARNING
;

5370  
bgp_°©ic_un£t
 (
vty
, vty->
ödex
, 
¥efix_°r
, 
AFI_IP
,

5371 
bgp_node_ßfi
 (
vty
));

5374 
ALIAS
 (
no_bgp_√tw‹k_mask
,

5375 
no_bgp_√tw‹k_mask_rouã_m≠_cmd
,

5377 
NO_STR


5385 
ALIAS
 (
no_bgp_√tw‹k_mask
,

5386 
no_bgp_√tw‹k_mask_backdo‹_cmd
,

5388 
NO_STR


5395 
DEFUN
 (
no_bgp_√tw‹k_mask_«tuøl
,

5396 
no_bgp_√tw‹k_mask_«tuøl_cmd
,

5398 
NO_STR


5402 
	gªt
;

5403 
	g¥efix_°r
[
BUFSIZ
];

5405 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0], 
NULL
, 
¥efix_°r
);

5406 i‡(! 
	gªt
)

5408 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

5409  
	gCMD_WARNING
;

5412  
bgp_°©ic_un£t
 (
vty
, vty->
ödex
, 
¥efix_°r
, 
AFI_IP
,

5413 
bgp_node_ßfi
 (
vty
));

5416 
ALIAS
 (
no_bgp_√tw‹k_mask_«tuøl
,

5417 
no_bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
,

5419 
NO_STR


5425 
ALIAS
 (
no_bgp_√tw‹k_mask_«tuøl
,

5426 
no_bgp_√tw‹k_mask_«tuøl_backdo‹_cmd
,

5428 
NO_STR


5433 #ifde‡
HAVE_IPV6


5434 
DEFUN
 (
ùv6_bgp_√tw‹k
,

5435 
ùv6_bgp_√tw‹k_cmd
,

5440  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¨gv
[0], 
AFI_IP6
, 
bgp_node_ßfi
(vty),

5441 
NULL
, 0);

5444 
DEFUN
 (
ùv6_bgp_√tw‹k_rouã_m≠
,

5445 
ùv6_bgp_√tw‹k_rouã_m≠_cmd
,

5452  
bgp_°©ic_£t
 (
vty
, vty->
ödex
, 
¨gv
[0], 
AFI_IP6
,

5453 
bgp_node_ßfi
 (
vty
), 
¨gv
[1], 0);

5456 
DEFUN
 (
no_ùv6_bgp_√tw‹k
,

5457 
no_ùv6_bgp_√tw‹k_cmd
,

5459 
NO_STR


5463  
bgp_°©ic_un£t
 (
vty
, vty->
ödex
, 
¨gv
[0], 
AFI_IP6
, 
bgp_node_ßfi
(vty));

5466 
ALIAS
 (
no_ùv6_bgp_√tw‹k
,

5467 
no_ùv6_bgp_√tw‹k_rouã_m≠_cmd
,

5469 
NO_STR


5475 
ALIAS
 (
ùv6_bgp_√tw‹k
,

5476 
ﬁd_ùv6_bgp_√tw‹k_cmd
,

5478 
IPV6_STR


5479 
BGP_STR


5483 
ALIAS
 (
no_ùv6_bgp_√tw‹k
,

5484 
ﬁd_no_ùv6_bgp_√tw‹k_cmd
,

5486 
NO_STR


5487 
IPV6_STR


5488 
BGP_STR


5494 
ALIAS_DEPRECATED
 (
bgp_√tw‹k
,

5495 
bgp_√tw‹k_âl_cmd
,

5501 
ALIAS_DEPRECATED
 (
bgp_√tw‹k_backdo‹
,

5502 
bgp_√tw‹k_backdo‹_âl_cmd
,

5509 
ALIAS_DEPRECATED
 (
bgp_√tw‹k_mask
,

5510 
bgp_√tw‹k_mask_âl_cmd
,

5518 
ALIAS_DEPRECATED
 (
bgp_√tw‹k_mask_backdo‹
,

5519 
bgp_√tw‹k_mask_backdo‹_âl_cmd
,

5528 
ALIAS_DEPRECATED
 (
bgp_√tw‹k_mask_«tuøl
,

5529 
bgp_√tw‹k_mask_«tuøl_âl_cmd
,

5535 
ALIAS_DEPRECATED
 (
bgp_√tw‹k_mask_«tuøl_backdo‹
,

5536 
bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
,

5543 
ALIAS_DEPRECATED
 (
no_bgp_√tw‹k
,

5544 
no_bgp_√tw‹k_âl_cmd
,

5546 
NO_STR


5551 
ALIAS_DEPRECATED
 (
no_bgp_√tw‹k
,

5552 
no_bgp_√tw‹k_backdo‹_âl_cmd
,

5554 
NO_STR


5560 
ALIAS_DEPRECATED
 (
no_bgp_√tw‹k
,

5561 
no_bgp_√tw‹k_mask_âl_cmd
,

5563 
NO_STR


5570 
ALIAS_DEPRECATED
 (
no_bgp_√tw‹k_mask
,

5571 
no_bgp_√tw‹k_mask_backdo‹_âl_cmd
,

5573 
NO_STR


5581 
ALIAS_DEPRECATED
 (
no_bgp_√tw‹k_mask_«tuøl
,

5582 
no_bgp_√tw‹k_mask_«tuøl_âl_cmd
,

5584 
NO_STR


5589 
ALIAS_DEPRECATED
 (
no_bgp_√tw‹k_mask_«tuøl
,

5590 
no_bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
,

5592 
NO_STR


5598 #ifde‡
HAVE_IPV6


5599 
ALIAS_DEPRECATED
 (
ùv6_bgp_√tw‹k
,

5600 
ùv6_bgp_√tw‹k_âl_cmd
,

5606 
ALIAS_DEPRECATED
 (
no_ùv6_bgp_√tw‹k
,

5607 
no_ùv6_bgp_√tw‹k_âl_cmd
,

5609 
NO_STR


5626 
	sbgp_aggªg©e


5629 
u_ch¨
 
	msumm¨y_⁄ly
;

5632 
u_ch¨
 
	mas_£t
;

5635 
rouã_m≠
 *
	mm≠
;

5638 
	mcou¡
;

5641 
ßfi_t
 
	mßfi
;

5644 
bgp_aggªg©e
 *

5645 
	$bgp_aggªg©e_√w
 ()

5647  
	`XCALLOC
 (
MTYPE_BGP_AGGREGATE
,  (
bgp_aggªg©e
));

5648 
	}
}

5651 
	$bgp_aggªg©e_‰ì
 (
bgp_aggªg©e
 *
aggªg©e
)

5653 
	`XFREE
 (
MTYPE_BGP_AGGREGATE
, 
aggªg©e
);

5654 
	}
}

5657 
	$bgp_aggªg©e_rouã
 (
bgp
 *bgp, 
¥efix
 *
p
, 
bgp_öfo
 *
röew
,

5658 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
bgp_öfo
 *
dñ
,

5659 
bgp_aggªg©e
 *
aggªg©e
)

5661 
bgp_èbÀ
 *
èbÀ
;

5662 
bgp_node
 *
t›
;

5663 
bgp_node
 *
∫
;

5664 
u_ch¨
 
‹igö
;

5665 
a•©h
 *a•©h = 
NULL
;

5666 
a•©h
 *
asmîge
 = 
NULL
;

5667 
communôy
 *communôy = 
NULL
;

5668 
communôy
 *
commîge
 = 
NULL
;

5669 
ö_addr
 
√xth›
;

5670 
u_öt32_t
 
med
 = 0;

5671 
bgp_öfo
 *
ri
;

5672 
bgp_öfo
 *
√w
;

5673 
fú°
 = 1;

5674 
m©ch
 = 0;

5677 i‡(
röew
)

5679 
√xth›
 = 
röew
->
©å
->nexthop;

5680 
med
 = 
röew
->
©å
->med;

5691 
‹igö
 = 
BGP_ORIGIN_IGP
;

5693 
èbÀ
 = 
bgp
->
rib
[
afi
][
ßfi
];

5695 
t›
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

5696 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);Ñn;Ñ¿
	`bgp_rouã_√xt_u¡û
 (∫, 
t›
))

5697 i‡(
∫
->
p
.
¥efixÀn
 >Ö->prefixlen)

5699 
m©ch
 = 0;

5701 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

5703 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri
))

5706 i‡(
dñ
 && 
ri
 == del)

5709 i‡(! 
röew
 && 
fú°
)

5711 
√xth›
 = 
ri
->
©å
->nexthop;

5712 
med
 = 
ri
->
©å
->med;

5713 
fú°
 = 0;

5716 #ifde‡
AGGREGATE_NEXTHOP_CHECK


5717 i‡(! 
	`IPV4_ADDR_SAME
 (&
ri
->
©å
->
√xth›
, &nexthop)

5718 || 
ri
->
©å
->
med
 != med)

5720 i‡(
a•©h
)

5721 
	`a•©h_‰ì
 (
a•©h
);

5722 i‡(
communôy
)

5723 
	`communôy_‰ì
 (
communôy
);

5724 
	`bgp_u∆ock_node
 (
∫
);

5725 
	`bgp_u∆ock_node
 (
t›
);

5730 i‡(
ri
->
sub_ty≥
 !
BGP_ROUTE_AGGREGATE
)

5732 i‡(
aggªg©e
->
summ¨y_⁄ly
)

5734 (
	`bgp_öfo_exåa_gë
 (
ri
))->
suµªss
++;

5735 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

5736 
m©ch
++;

5739 
aggªg©e
->
cou¡
++;

5741 i‡(
aggªg©e
->
as_£t
)

5743 i‡(
‹igö
 < 
ri
->
©å
->origin)

5744 
‹igö
 = 
ri
->
©å
->origin;

5746 i‡(
a•©h
)

5748 
asmîge
 = 
	`a•©h_aggªg©e
 (
a•©h
, 
ri
->
©å
->aspath);

5749 
	`a•©h_‰ì
 (
a•©h
);

5750 
a•©h
 = 
asmîge
;

5753 
a•©h
 = 
	`a•©h_dup
 (
ri
->
©å
->aspath);

5755 i‡(
ri
->
©å
->
communôy
)

5757 i‡(
communôy
)

5759 
commîge
 = 
	`communôy_mîge
 (
communôy
,

5760 
ri
->
©å
->
communôy
);

5761 
communôy
 = 
	`communôy_uniq_s‹t
 (
commîge
);

5762 
	`communôy_‰ì
 (
commîge
);

5765 
communôy
 = 
	`communôy_dup
 (
ri
->
©å
->community);

5770 i‡(
m©ch
)

5771 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

5773 
	`bgp_u∆ock_node
 (
t›
);

5775 i‡(
röew
)

5777 
aggªg©e
->
cou¡
++;

5779 i‡(
aggªg©e
->
summ¨y_⁄ly
)

5780 (
	`bgp_öfo_exåa_gë
 (
röew
))->
suµªss
++;

5782 i‡(
aggªg©e
->
as_£t
)

5784 i‡(
‹igö
 < 
röew
->
©å
->origin)

5785 
‹igö
 = 
röew
->
©å
->origin;

5787 i‡(
a•©h
)

5789 
asmîge
 = 
	`a•©h_aggªg©e
 (
a•©h
, 
röew
->
©å
->aspath);

5790 
	`a•©h_‰ì
 (
a•©h
);

5791 
a•©h
 = 
asmîge
;

5794 
a•©h
 = 
	`a•©h_dup
 (
röew
->
©å
->aspath);

5796 i‡(
röew
->
©å
->
communôy
)

5798 i‡(
communôy
)

5800 
commîge
 = 
	`communôy_mîge
 (
communôy
,

5801 
röew
->
©å
->
communôy
);

5802 
communôy
 = 
	`communôy_uniq_s‹t
 (
commîge
);

5803 
	`communôy_‰ì
 (
commîge
);

5806 
communôy
 = 
	`communôy_dup
 (
röew
->
©å
->community);

5811 i‡(
aggªg©e
->
cou¡
 > 0)

5813 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

5814 
√w
 = 
	`bgp_öfo_√w
 ();

5815 
√w
->
ty≥
 = 
ZEBRA_ROUTE_BGP
;

5816 
√w
->
sub_ty≥
 = 
BGP_ROUTE_AGGREGATE
;

5817 
√w
->
≥î
 = 
bgp
->
≥î_£lf
;

5818 
	`SET_FLAG
 (
√w
->
Êags
, 
BGP_INFO_VALID
);

5819 
√w
->
©å
 = 
	`bgp_©å_aggªg©e_öã∫
 (
bgp
, 
‹igö
, 
a•©h
, 
communôy
, 
aggªg©e
->
as_£t
);

5820 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

5822 
	`bgp_öfo_add
 (
∫
, 
√w
);

5823 
	`bgp_u∆ock_node
 (
∫
);

5824 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

5828 i‡(
a•©h
)

5829 
	`a•©h_‰ì
 (
a•©h
);

5830 i‡(
communôy
)

5831 
	`communôy_‰ì
 (
communôy
);

5833 
	}
}

5835 
bgp_aggªg©e_dñëe
 (
bgp
 *, 
¥efix
 *, 
afi_t
, 
ßfi_t
,

5836 
bgp_aggªg©e
 *);

5839 
	$bgp_aggªg©e_ö¸emít
 (
bgp
 *bgp, 
¥efix
 *
p
,

5840 
bgp_öfo
 *
ri
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

5842 
bgp_node
 *
chûd
;

5843 
bgp_node
 *
∫
;

5844 
bgp_aggªg©e
 *
aggªg©e
;

5845 
bgp_èbÀ
 *
èbÀ
;

5848 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

5851 
èbÀ
 = 
bgp
->
aggªg©e
[
afi
][
ßfi
];

5854 i‡(
	`bgp_èbÀ_t›_nﬁock
 (
èbÀ
Ë=
NULL
)

5857 i‡(
p
->
¥efixÀn
 == 0)

5860 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri
))

5863 
chûd
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

5866 
∫
 = 
chûd
;Ñn;Ñ¿
	`bgp_node_∑ª¡_nﬁock
 (rn))

5867 i‡((
aggªg©e
 = 
∫
->
öfo
Ë!
NULL
 &&Ñn->
p
.
¥efixÀn
 <Ö->prefixlen)

5869 
	`bgp_aggªg©e_dñëe
 (
bgp
, &
∫
->
p
, 
afi
, 
ßfi
, 
aggªg©e
);

5870 
	`bgp_aggªg©e_rouã
 (
bgp
, &
∫
->
p
, 
ri
, 
afi
, 
ßfi
, 
NULL
, 
aggªg©e
);

5872 
	`bgp_u∆ock_node
 (
chûd
);

5873 
	}
}

5876 
	$bgp_aggªg©e_de¸emít
 (
bgp
 *bgp, 
¥efix
 *
p
,

5877 
bgp_öfo
 *
dñ
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

5879 
bgp_node
 *
chûd
;

5880 
bgp_node
 *
∫
;

5881 
bgp_aggªg©e
 *
aggªg©e
;

5882 
bgp_èbÀ
 *
èbÀ
;

5885 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

5888 
èbÀ
 = 
bgp
->
aggªg©e
[
afi
][
ßfi
];

5891 i‡(
	`bgp_èbÀ_t›_nﬁock
 (
èbÀ
Ë=
NULL
)

5894 i‡(
p
->
¥efixÀn
 == 0)

5897 
chûd
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

5900 
∫
 = 
chûd
;Ñn;Ñ¿
	`bgp_node_∑ª¡_nﬁock
 (rn))

5901 i‡((
aggªg©e
 = 
∫
->
öfo
Ë!
NULL
 &&Ñn->
p
.
¥efixÀn
 <Ö->prefixlen)

5903 
	`bgp_aggªg©e_dñëe
 (
bgp
, &
∫
->
p
, 
afi
, 
ßfi
, 
aggªg©e
);

5904 
	`bgp_aggªg©e_rouã
 (
bgp
, &
∫
->
p
, 
NULL
, 
afi
, 
ßfi
, 
dñ
, 
aggªg©e
);

5906 
	`bgp_u∆ock_node
 (
chûd
);

5907 
	}
}

5910 
	$bgp_aggªg©e_add
 (
bgp
 *bgp, 
¥efix
 *
p
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

5911 
bgp_aggªg©e
 *
aggªg©e
)

5913 
bgp_èbÀ
 *
èbÀ
;

5914 
bgp_node
 *
t›
;

5915 
bgp_node
 *
∫
;

5916 
bgp_öfo
 *
√w
;

5917 
bgp_öfo
 *
ri
;

5918 
m©ch
;

5919 
u_ch¨
 
‹igö
 = 
BGP_ORIGIN_IGP
;

5920 
a•©h
 *a•©h = 
NULL
;

5921 
a•©h
 *
asmîge
 = 
NULL
;

5922 
communôy
 *communôy = 
NULL
;

5923 
communôy
 *
commîge
 = 
NULL
;

5925 
èbÀ
 = 
bgp
->
rib
[
afi
][
ßfi
];

5928 i‡(
afi
 =
AFI_IP
 && 
p
->
¥efixÀn
 =
IPV4_MAX_BITLEN
)

5930 i‡(
afi
 =
AFI_IP6
 && 
p
->
¥efixÀn
 =
IPV6_MAX_BITLEN
)

5934 
t›
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

5935 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);Ñn;Ñ¿
	`bgp_rouã_√xt_u¡û
 (∫, 
t›
))

5936 i‡(
∫
->
p
.
¥efixÀn
 >Ö->prefixlen)

5938 
m©ch
 = 0;

5940 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

5942 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri
))

5945 i‡(
ri
->
sub_ty≥
 !
BGP_ROUTE_AGGREGATE
)

5949 i‡(
aggªg©e
->
summ¨y_⁄ly
)

5951 (
	`bgp_öfo_exåa_gë
 (
ri
))->
suµªss
++;

5952 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

5953 
m©ch
++;

5957 i‡(
aggªg©e
->
as_£t
)

5959 i‡(
‹igö
 < 
ri
->
©å
->origin)

5960 
‹igö
 = 
ri
->
©å
->origin;

5962 i‡(
a•©h
)

5964 
asmîge
 = 
	`a•©h_aggªg©e
 (
a•©h
, 
ri
->
©å
->aspath);

5965 
	`a•©h_‰ì
 (
a•©h
);

5966 
a•©h
 = 
asmîge
;

5969 
a•©h
 = 
	`a•©h_dup
 (
ri
->
©å
->aspath);

5971 i‡(
ri
->
©å
->
communôy
)

5973 i‡(
communôy
)

5975 
commîge
 = 
	`communôy_mîge
 (
communôy
,

5976 
ri
->
©å
->
communôy
);

5977 
communôy
 = 
	`communôy_uniq_s‹t
 (
commîge
);

5978 
	`communôy_‰ì
 (
commîge
);

5981 
communôy
 = 
	`communôy_dup
 (
ri
->
©å
->community);

5984 
aggªg©e
->
cou¡
++;

5989 i‡(
m©ch
)

5990 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

5992 
	`bgp_u∆ock_node
 (
t›
);

5995 i‡(
aggªg©e
->
cou¡
)

5997 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

5999 
√w
 = 
	`bgp_öfo_√w
 ();

6000 
√w
->
ty≥
 = 
ZEBRA_ROUTE_BGP
;

6001 
√w
->
sub_ty≥
 = 
BGP_ROUTE_AGGREGATE
;

6002 
√w
->
≥î
 = 
bgp
->
≥î_£lf
;

6003 
	`SET_FLAG
 (
√w
->
Êags
, 
BGP_INFO_VALID
);

6004 
√w
->
©å
 = 
	`bgp_©å_aggªg©e_öã∫
 (
bgp
, 
‹igö
, 
a•©h
, 
communôy
, 
aggªg©e
->
as_£t
);

6005 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

6007 
	`bgp_öfo_add
 (
∫
, 
√w
);

6008 
	`bgp_u∆ock_node
 (
∫
);

6011 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

6013 
	}
}

6016 
	$bgp_aggªg©e_dñëe
 (
bgp
 *bgp, 
¥efix
 *
p
, 
afi_t
 
afi
,

6017 
ßfi_t
 
ßfi
, 
bgp_aggªg©e
 *
aggªg©e
)

6019 
bgp_èbÀ
 *
èbÀ
;

6020 
bgp_node
 *
t›
;

6021 
bgp_node
 *
∫
;

6022 
bgp_öfo
 *
ri
;

6023 
m©ch
;

6025 
èbÀ
 = 
bgp
->
rib
[
afi
][
ßfi
];

6027 i‡(
afi
 =
AFI_IP
 && 
p
->
¥efixÀn
 =
IPV4_MAX_BITLEN
)

6029 i‡(
afi
 =
AFI_IP6
 && 
p
->
¥efixÀn
 =
IPV6_MAX_BITLEN
)

6033 
t›
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

6034 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);Ñn;Ñ¿
	`bgp_rouã_√xt_u¡û
 (∫, 
t›
))

6035 i‡(
∫
->
p
.
¥efixÀn
 >Ö->prefixlen)

6037 
m©ch
 = 0;

6039 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

6041 i‡(
	`BGP_INFO_HOLDDOWN
 (
ri
))

6044 i‡(
ri
->
sub_ty≥
 !
BGP_ROUTE_AGGREGATE
)

6046 i‡(
aggªg©e
->
summ¨y_⁄ly
 && 
ri
->
exåa
)

6048 
ri
->
exåa
->
suµªss
--;

6050 i‡(
ri
->
exåa
->
suµªss
 == 0)

6052 
	`bgp_öfo_£t_Êag
 (
∫
, 
ri
, 
BGP_INFO_ATTR_CHANGED
);

6053 
m©ch
++;

6056 
aggªg©e
->
cou¡
--;

6061 i‡(
m©ch
)

6062 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

6064 
	`bgp_u∆ock_node
 (
t›
);

6067 
∫
 = 
	`bgp_node_gë
 (
èbÀ
, 
p
);

6069 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

6070 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf


6071 && 
ri
->
ty≥
 =
ZEBRA_ROUTE_BGP


6072 && 
ri
->
sub_ty≥
 =
BGP_ROUTE_AGGREGATE
)

6076 i‡(
ri
)

6078 
	`bgp_öfo_dñëe
 (
∫
, 
ri
);

6079 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
ßfi
);

6083 
	`bgp_u∆ock_node
 (
∫
);

6084 
	}
}

6087 
	#AGGREGATE_SUMMARY_ONLY
 1

	)

6088 
	#AGGREGATE_AS_SET
 1

	)

6091 
	$bgp_aggªg©e_un£t
 (
vty
 *vty, c⁄° *
¥efix_°r
,

6092 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

6094 
ªt
;

6095 
¥efix
 
p
;

6096 
bgp_node
 *
∫
;

6097 
bgp
 *bgp;

6098 
bgp_aggªg©e
 *
aggªg©e
;

6101 
ªt
 = 
	`°r2¥efix
 (
¥efix_°r
, &
p
);

6102 i‡(!
ªt
)

6104 
	`vty_out
 (
vty
, "MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

6105  
CMD_WARNING
;

6107 
	`≠∂y_mask
 (&
p
);

6110 
bgp
 = 
vty
->
ödex
;

6113 
∫
 = 
	`bgp_node_lookup
 (
bgp
->
aggªg©e
[
afi
][
ßfi
], &
p
);

6114 i‡(! 
∫
)

6116 
	`vty_out
 (
vty
, "%% There isÇoággregate-address configuration.%s",

6117 
VTY_NEWLINE
);

6118  
CMD_WARNING
;

6121 
aggªg©e
 = 
∫
->
öfo
;

6122 i‡(
aggªg©e
->
ßfi
 & 
SAFI_UNICAST
)

6123 
	`bgp_aggªg©e_dñëe
 (
bgp
, &
p
, 
afi
, 
SAFI_UNICAST
, 
aggªg©e
);

6124 i‡(
aggªg©e
->
ßfi
 & 
SAFI_MULTICAST
)

6125 
	`bgp_aggªg©e_dñëe
 (
bgp
, &
p
, 
afi
, 
SAFI_MULTICAST
, 
aggªg©e
);

6128 
∫
->
öfo
 = 
NULL
;

6129 
	`bgp_aggªg©e_‰ì
 (
aggªg©e
);

6130 
	`bgp_u∆ock_node
 (
∫
);

6131 
	`bgp_u∆ock_node
 (
∫
);

6133  
CMD_SUCCESS
;

6134 
	}
}

6137 
	$bgp_aggªg©e_£t
 (
vty
 *vty, c⁄° *
¥efix_°r
,

6138 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

6139 
u_ch¨
 
summ¨y_⁄ly
, u_ch¨ 
as_£t
)

6141 
ªt
;

6142 
¥efix
 
p
;

6143 
bgp_node
 *
∫
;

6144 
bgp
 *bgp;

6145 
bgp_aggªg©e
 *
aggªg©e
;

6148 
ªt
 = 
	`°r2¥efix
 (
¥efix_°r
, &
p
);

6149 i‡(!
ªt
)

6151 
	`vty_out
 (
vty
, "MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

6152  
CMD_WARNING
;

6154 
	`≠∂y_mask
 (&
p
);

6157 
bgp
 = 
vty
->
ödex
;

6160 
∫
 = 
	`bgp_node_gë
 (
bgp
->
aggªg©e
[
afi
][
ßfi
], &
p
);

6162 i‡(
∫
->
öfo
)

6164 
	`vty_out
 (
vty
, "Thîêi†Æªady samêaggªg©ê√tw‹k.%s", 
VTY_NEWLINE
);

6166 
ªt
 = 
	`bgp_aggªg©e_un£t
 (
vty
, 
¥efix_°r
, 
afi
, 
ßfi
);

6167 i‡(
ªt
)

6169 
	`vty_out
 (
vty
, "Eº‹ dñëögággªg©e.%s", 
VTY_NEWLINE
);

6170 
	`bgp_u∆ock_node
 (
∫
);

6171  
CMD_WARNING
;

6176 
aggªg©e
 = 
	`bgp_aggªg©e_√w
 ();

6177 
aggªg©e
->
summ¨y_⁄ly
 = summary_only;

6178 
aggªg©e
->
as_£t
 =ás_set;

6179 
aggªg©e
->
ßfi
 = safi;

6180 
∫
->
öfo
 = 
aggªg©e
;

6183 i‡(
ßfi
 & 
SAFI_UNICAST
)

6184 
	`bgp_aggªg©e_add
 (
bgp
, &
p
, 
afi
, 
SAFI_UNICAST
, 
aggªg©e
);

6185 i‡(
ßfi
 & 
SAFI_MULTICAST
)

6186 
	`bgp_aggªg©e_add
 (
bgp
, &
p
, 
afi
, 
SAFI_MULTICAST
, 
aggªg©e
);

6188  
CMD_SUCCESS
;

6189 
	}
}

6191 
DEFUN
 (
aggªg©e_addªss
,

6192 
aggªg©e_addªss_cmd
,

6197  
bgp_aggªg©e_£t
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
bgp_node_ßfi
 (vty), 0, 0);

6200 
DEFUN
 (
aggªg©e_addªss_mask
,

6201 
aggªg©e_addªss_mask_cmd
,

6207 
	gªt
;

6208 
	g¥efix_°r
[
BUFSIZ
];

6210 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

6212 i‡(! 
	gªt
)

6214 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

6215  
	gCMD_WARNING
;

6218  
bgp_aggªg©e_£t
 (
vty
, 
¥efix_°r
, 
AFI_IP
, 
bgp_node_ßfi
 (vty),

6222 
DEFUN
 (
aggªg©e_addªss_summ¨y_⁄ly
,

6223 
aggªg©e_addªss_summ¨y_⁄ly_cmd
,

6229  
bgp_aggªg©e_£t
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
bgp_node_ßfi
 (vty),

6230 
AGGREGATE_SUMMARY_ONLY
, 0);

6233 
DEFUN
 (
aggªg©e_addªss_mask_summ¨y_⁄ly
,

6234 
aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
,

6241 
	gªt
;

6242 
	g¥efix_°r
[
BUFSIZ
];

6244 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

6246 i‡(! 
	gªt
)

6248 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

6249  
	gCMD_WARNING
;

6252  
bgp_aggªg©e_£t
 (
vty
, 
¥efix_°r
, 
AFI_IP
, 
bgp_node_ßfi
 (vty),

6253 
AGGREGATE_SUMMARY_ONLY
, 0);

6256 
DEFUN
 (
aggªg©e_addªss_as_£t
,

6257 
aggªg©e_addªss_as_£t_cmd
,

6263  
bgp_aggªg©e_£t
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
bgp_node_ßfi
 (vty),

6264 0, 
AGGREGATE_AS_SET
);

6267 
DEFUN
 (
aggªg©e_addªss_mask_as_£t
,

6268 
aggªg©e_addªss_mask_as_£t_cmd
,

6275 
	gªt
;

6276 
	g¥efix_°r
[
BUFSIZ
];

6278 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

6280 i‡(! 
	gªt
)

6282 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

6283  
	gCMD_WARNING
;

6286  
bgp_aggªg©e_£t
 (
vty
, 
¥efix_°r
, 
AFI_IP
, 
bgp_node_ßfi
 (vty),

6287 0, 
AGGREGATE_AS_SET
);

6291 
DEFUN
 (
aggªg©e_addªss_as_£t_summ¨y
,

6292 
aggªg©e_addªss_as_£t_summ¨y_cmd
,

6299  
bgp_aggªg©e_£t
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
bgp_node_ßfi
 (vty),

6300 
AGGREGATE_SUMMARY_ONLY
, 
AGGREGATE_AS_SET
);

6303 
ALIAS
 (
aggªg©e_addªss_as_£t_summ¨y
,

6304 
aggªg©e_addªss_summ¨y_as_£t_cmd
,

6311 
DEFUN
 (
aggªg©e_addªss_mask_as_£t_summ¨y
,

6312 
aggªg©e_addªss_mask_as_£t_summ¨y_cmd
,

6320 
	gªt
;

6321 
	g¥efix_°r
[
BUFSIZ
];

6323 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

6325 i‡(! 
	gªt
)

6327 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

6328  
	gCMD_WARNING
;

6331  
bgp_aggªg©e_£t
 (
vty
, 
¥efix_°r
, 
AFI_IP
, 
bgp_node_ßfi
 (vty),

6332 
AGGREGATE_SUMMARY_ONLY
, 
AGGREGATE_AS_SET
);

6335 
ALIAS
 (
aggªg©e_addªss_mask_as_£t_summ¨y
,

6336 
aggªg©e_addªss_mask_summ¨y_as_£t_cmd
,

6344 
DEFUN
 (
no_aggªg©e_addªss
,

6345 
no_aggªg©e_addªss_cmd
,

6347 
NO_STR


6351  
bgp_aggªg©e_un£t
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
bgp_node_ßfi
 (vty));

6354 
ALIAS
 (
no_aggªg©e_addªss
,

6355 
no_aggªg©e_addªss_summ¨y_⁄ly_cmd
,

6357 
NO_STR


6362 
ALIAS
 (
no_aggªg©e_addªss
,

6363 
no_aggªg©e_addªss_as_£t_cmd
,

6365 
NO_STR


6370 
ALIAS
 (
no_aggªg©e_addªss
,

6371 
no_aggªg©e_addªss_as_£t_summ¨y_cmd
,

6373 
NO_STR


6379 
ALIAS
 (
no_aggªg©e_addªss
,

6380 
no_aggªg©e_addªss_summ¨y_as_£t_cmd
,

6382 
NO_STR


6388 
DEFUN
 (
no_aggªg©e_addªss_mask
,

6389 
no_aggªg©e_addªss_mask_cmd
,

6391 
NO_STR


6396 
	gªt
;

6397 
	g¥efix_°r
[
BUFSIZ
];

6399 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

6401 i‡(! 
	gªt
)

6403 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

6404  
	gCMD_WARNING
;

6407  
bgp_aggªg©e_un£t
 (
vty
, 
¥efix_°r
, 
AFI_IP
, 
bgp_node_ßfi
 (vty));

6410 
ALIAS
 (
no_aggªg©e_addªss_mask
,

6411 
no_aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
,

6413 
NO_STR


6419 
ALIAS
 (
no_aggªg©e_addªss_mask
,

6420 
no_aggªg©e_addªss_mask_as_£t_cmd
,

6422 
NO_STR


6428 
ALIAS
 (
no_aggªg©e_addªss_mask
,

6429 
no_aggªg©e_addªss_mask_as_£t_summ¨y_cmd
,

6431 
NO_STR


6438 
ALIAS
 (
no_aggªg©e_addªss_mask
,

6439 
no_aggªg©e_addªss_mask_summ¨y_as_£t_cmd
,

6441 
NO_STR


6448 #ifde‡
HAVE_IPV6


6449 
DEFUN
 (
ùv6_aggªg©e_addªss
,

6450 
ùv6_aggªg©e_addªss_cmd
,

6455  
bgp_aggªg©e_£t
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, 0, 0);

6458 
DEFUN
 (
ùv6_aggªg©e_addªss_summ¨y_⁄ly
,

6459 
ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
,

6465  
bgp_aggªg©e_£t
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

6466 
AGGREGATE_SUMMARY_ONLY
, 0);

6469 
DEFUN
 (
no_ùv6_aggªg©e_addªss
,

6470 
no_ùv6_aggªg©e_addªss_cmd
,

6472 
NO_STR


6476  
bgp_aggªg©e_un£t
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
);

6479 
DEFUN
 (
no_ùv6_aggªg©e_addªss_summ¨y_⁄ly
,

6480 
no_ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
,

6482 
NO_STR


6487  
bgp_aggªg©e_un£t
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
);

6490 
ALIAS
 (
ùv6_aggªg©e_addªss
,

6491 
ﬁd_ùv6_aggªg©e_addªss_cmd
,

6493 
IPV6_STR


6494 
BGP_STR


6498 
ALIAS
 (
ùv6_aggªg©e_addªss_summ¨y_⁄ly
,

6499 
ﬁd_ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
,

6501 
IPV6_STR


6502 
BGP_STR


6507 
ALIAS
 (
no_ùv6_aggªg©e_addªss
,

6508 
ﬁd_no_ùv6_aggªg©e_addªss_cmd
,

6510 
NO_STR


6511 
IPV6_STR


6512 
BGP_STR


6516 
ALIAS
 (
no_ùv6_aggªg©e_addªss_summ¨y_⁄ly
,

6517 
ﬁd_no_ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
,

6519 
NO_STR


6520 
IPV6_STR


6521 
BGP_STR


6529 
	$bgp_ªdi°ribuã_add
 (
¥efix
 *
p
, c⁄° 
ö_addr
 *
√xth›
,

6530 c⁄° 
ö6_addr
 *
√xth›6
,

6531 
u_öt32_t
 
mëric
, 
u_ch¨
 
ty≥
)

6533 
bgp
 *bgp;

6534 
li°node
 *
node
, *
¬ode
;

6535 
bgp_öfo
 *
√w
;

6536 
bgp_öfo
 *
bi
;

6537 
bgp_öfo
 
öfo
;

6538 
bgp_node
 *
bn
;

6539 
©å
áttr;

6540 
©å
 *
√w_©å
;

6541 
afi_t
 
afi
;

6542 
ªt
;

6545 
	`bgp_©å_deÁu…_£t
 (&
©å
, 
BGP_ORIGIN_INCOMPLETE
);

6546 i‡(
√xth›
)

6547 
©å
.
√xth›
 = *nexthop;

6549 #ifde‡
HAVE_IPV6


6550 i‡(
√xth›6
)

6552 
©å_exåa
 *
exåa
 = 
	`bgp_©å_exåa_gë
(&
©å
);

6553 
exåa
->
mp_√xth›_globÆ
 = *
√xth›6
;

6554 
exåa
->
mp_√xth›_Àn
 = 16;

6558 
©å
.
med
 = 
mëric
;

6559 
©å
.
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
);

6561 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

6563 
afi
 = 
	`Ámûy2afi
 (
p
->
Ámûy
);

6565 i‡(
bgp
->
ªdi°
[
afi
][
ty≥
])

6567 
©å
 
©å_√w
;

6568 
©å_exåa
 
exåa_√w
;

6571 
©å_√w
.
exåa
 = &
exåa_√w
;

6572 
	`bgp_©å_dup
 (&
©å_√w
, &
©å
);

6574 i‡(
bgp
->
ªdi°_mëric_Êag
[
afi
][
ty≥
])

6575 
©å_√w
.
med
 = 
bgp
->
ªdi°_mëric
[
afi
][
ty≥
];

6578 i‡(
bgp
->
rm≠
[
afi
][
ty≥
].
m≠
)

6580 
öfo
.
≥î
 = 
bgp
->
≥î_£lf
;

6581 
öfo
.
©å
 = &
©å_√w
;

6583 
	`SET_FLAG
 (
bgp
->
≥î_£lf
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_REDISTRIBUTE
);

6585 
ªt
 = 
	`rouã_m≠_≠∂y
 (
bgp
->
rm≠
[
afi
][
ty≥
].
m≠
, 
p
, 
RMAP_BGP
,

6586 &
öfo
);

6588 
bgp
->
≥î_£lf
->
rm≠_ty≥
 = 0;

6590 i‡(
ªt
 =
RMAP_DENYMATCH
)

6593 
	`bgp_©å_Êush
 (&
©å_√w
);

6596 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

6597 
	`bgp_©å_exåa_‰ì
 (&
©å
);

6598 
	`bgp_ªdi°ribuã_dñëe
 (
p
, 
ty≥
);

6603 
bn
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
SAFI_UNICAST
],

6604 
afi
, 
SAFI_UNICAST
, 
p
, 
NULL
);

6606 
√w_©å
 = 
	`bgp_©å_öã∫
 (&
©å_√w
);

6608 
bi
 = 
bn
->
öfo
; bi; bòbi->
√xt
)

6609 i‡(
bi
->
≥î
 =
bgp
->
≥î_£lf


6610 && 
bi
->
sub_ty≥
 =
BGP_ROUTE_REDISTRIBUTE
)

6613 i‡(
bi
)

6615 i‡(
	`©åhash_cmp
 (
bi
->
©å
, 
√w_©å
) &&

6616 !
	`CHECK_FLAG
(
bi
->
Êags
, 
BGP_INFO_REMOVED
))

6618 
	`bgp_©å_unöã∫
 (&
√w_©å
);

6619 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

6620 
	`bgp_©å_exåa_‰ì
 (&
©å
);

6621 
	`bgp_u∆ock_node
 (
bn
);

6627 
	`bgp_öfo_£t_Êag
 (
bn
, 
bi
, 
BGP_INFO_ATTR_CHANGED
);

6630 i‡(
	`CHECK_FLAG
(
bi
->
Êags
, 
BGP_INFO_REMOVED
))

6631 
	`bgp_öfo_ª°‹e
(
bn
, 
bi
);

6633 
	`bgp_aggªg©e_de¸emít
 (
bgp
, 
p
, 
bi
, 
afi
, 
SAFI_UNICAST
);

6634 
	`bgp_©å_unöã∫
 (&
bi
->
©å
);

6635 
bi
->
©å
 = 
√w_©å
;

6636 
bi
->
u±ime
 = 
	`bgp_˛ock
 ();

6639 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
bi
, 
afi
, 
SAFI_UNICAST
);

6640 
	`bgp_¥o˚ss
 (
bgp
, 
bn
, 
afi
, 
SAFI_UNICAST
);

6641 
	`bgp_u∆ock_node
 (
bn
);

6642 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

6643 
	`bgp_©å_exåa_‰ì
 (&
©å
);

6648 
√w
 = 
	`bgp_öfo_√w
 ();

6649 
√w
->
ty≥
 =Åype;

6650 
√w
->
sub_ty≥
 = 
BGP_ROUTE_REDISTRIBUTE
;

6651 
√w
->
≥î
 = 
bgp
->
≥î_£lf
;

6652 
	`SET_FLAG
 (
√w
->
Êags
, 
BGP_INFO_VALID
);

6653 
√w
->
©å
 = 
√w_©å
;

6654 
√w
->
u±ime
 = 
	`bgp_˛ock
 ();

6656 
	`bgp_aggªg©e_ö¸emít
 (
bgp
, 
p
, 
√w
, 
afi
, 
SAFI_UNICAST
);

6657 
	`bgp_öfo_add
 (
bn
, 
√w
);

6658 
	`bgp_u∆ock_node
 (
bn
);

6659 
	`bgp_¥o˚ss
 (
bgp
, 
bn
, 
afi
, 
SAFI_UNICAST
);

6664 
	`a•©h_unöã∫
 (&
©å
.
a•©h
);

6665 
	`bgp_©å_exåa_‰ì
 (&
©å
);

6666 
	}
}

6669 
	$bgp_ªdi°ribuã_dñëe
 (
¥efix
 *
p
, 
u_ch¨
 
ty≥
)

6671 
bgp
 *bgp;

6672 
li°node
 *
node
, *
¬ode
;

6673 
afi_t
 
afi
;

6674 
bgp_node
 *
∫
;

6675 
bgp_öfo
 *
ri
;

6677 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

6679 
afi
 = 
	`Ámûy2afi
 (
p
->
Ámûy
);

6681 i‡(
bgp
->
ªdi°
[
afi
][
ty≥
])

6683 
∫
 = 
	`bgp_afi_node_gë
 (
bgp
->
rib
[
afi
][
SAFI_UNICAST
],áfi, SAFI_UNICAST, 
p
, 
NULL
);

6685 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

6686 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf


6687 && 
ri
->
ty≥
 ==Åype)

6690 i‡(
ri
)

6692 
	`bgp_aggªg©e_de¸emít
 (
bgp
, 
p
, 
ri
, 
afi
, 
SAFI_UNICAST
);

6693 
	`bgp_öfo_dñëe
 (
∫
, 
ri
);

6694 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
SAFI_UNICAST
);

6696 
	`bgp_u∆ock_node
 (
∫
);

6699 
	}
}

6703 
	$bgp_ªdi°ribuã_wôhdøw
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ty≥
)

6705 
bgp_node
 *
∫
;

6706 
bgp_öfo
 *
ri
;

6707 
bgp_èbÀ
 *
èbÀ
;

6709 
èbÀ
 = 
bgp
->
rib
[
afi
][
SAFI_UNICAST
];

6711 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

6713 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

6714 i‡(
ri
->
≥î
 =
bgp
->
≥î_£lf


6715 && 
ri
->
ty≥
 ==Åype)

6718 i‡(
ri
)

6720 
	`bgp_aggªg©e_de¸emít
 (
bgp
, &
∫
->
p
, 
ri
, 
afi
, 
SAFI_UNICAST
);

6721 
	`bgp_öfo_dñëe
 (
∫
, 
ri
);

6722 
	`bgp_¥o˚ss
 (
bgp
, 
∫
, 
afi
, 
SAFI_UNICAST
);

6725 
	}
}

6729 
	$rouã_vty_out_rouã
 (
¥efix
 *
p
, 
vty
 *vty)

6731 
Àn
;

6732 
u_öt32_t
 
de°ö©i⁄
;

6733 
buf
[
BUFSIZ
];

6735 i‡(
p
->
Ámûy
 =
AF_INET
)

6737 
Àn
 = 
	`vty_out
 (
vty
, "%s", 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
));

6738 
de°ö©i⁄
 = 
	`¡ohl
 (
p
->
u
.
¥efix4
.
s_addr
);

6740 i‡((
	`IN_CLASSC
 (
de°ö©i⁄
Ë&& 
p
->
¥efixÀn
 == 24)

6741 || (
	`IN_CLASSB
 (
de°ö©i⁄
Ë&& 
p
->
¥efixÀn
 == 16)

6742 || (
	`IN_CLASSA
 (
de°ö©i⁄
Ë&& 
p
->
¥efixÀn
 == 8)

6743 || 
p
->
u
.
¥efix4
.
s_addr
 == 0)

6748 
Àn
 +
	`vty_out
 (
vty
, "/%d", 
p
->
¥efixÀn
);

6751 
Àn
 = 
	`vty_out
 (
vty
, "%s/%d", 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

6752 
p
->
¥efixÀn
);

6754 
Àn
 = 17 -Üen;

6755 i‡(
Àn
 < 1)

6756 
	`vty_out
 (
vty
, "%s%*s", 
VTY_NEWLINE
, 20, " ");

6758 
	`vty_out
 (
vty
, "%*s", 
Àn
, " ");

6759 
	}
}

6761 
	ebgp_di•œy_ty≥


6763 
	mn‹mÆ_li°
,

6766 #ifde‡
USE_SRX


6775 
	$§x_vÆid©i⁄_vty_sh‹t_out
(
vty
 *vty, 
°©e
)

6777 
°©e
)

6779 
SRx_RESULT_VALID
:

6780 
	`vty_out
 (
vty
, "v");

6782 
SRx_RESULT_NOTFOUND
:

6783 
	`vty_out
 (
vty
, "n");

6785 
SRx_RESULT_INVALID
:

6786 
	`vty_out
 (
vty
, "i");

6788 
SRx_RESULT_UNDEFINED
:

6789 
	`vty_out
 (
vty
, "?");

6792 
	`vty_out
 (
vty
, "-");

6794 
	}
}

6802 
	$§x_rouã_vty_vÆid©i⁄_out
(
vty
 *vty,

6803 
bgp_öfo
 *
böfo
)

6805 
bgp
 *bgp;

6806 
bgp
 = 
böfo
->
≥î
->bgp;

6807 
vÆSèã
 = 
SRx_RESULT_UNDEFINED
;

6808 
locPªfPﬁ
 = -1;

6810 i‡((
bgp
->
§x_c⁄fig
 & 
SRX_CONFIG_DISPLAY_INFO
) != 0)

6813 i‡(
böfo
->
upd©eID
 == 0)

6815 i‡(
böfo
->
loˇlID
 != 0)

6817 
	`vty_out
 (
vty
, "+%07X ", 
böfo
->
loˇlID
);

6821 
	`vty_out
 (
vty
, "-------- ");

6826 
	`vty_out
 (
vty
, "%08X ", 
böfo
->
upd©eID
);

6829 
vÆSèã
 = 
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
böfo
);

6831 
	`§x_vÆid©i⁄_vty_sh‹t_out
(
vty
, 
vÆSèã
);

6832 
	`vty_out
 (
vty
, "(");

6833 i‡((
bgp
->
§x_c⁄fig
 & 
SRX_CONFIG_EVAL_ORIGIN
) != 0)

6836 
	`§x_vÆid©i⁄_vty_sh‹t_out
(
vty
, 
böfo
->
vÆ_ªs_ROA
);

6840 
	`vty_out
 (
vty
, "-");

6842 
	`vty_out
 (
vty
, ",");

6843 i‡((
bgp
->
§x_c⁄fig
 & 
SRX_CONFIG_EVAL_PATH
) != 0)

6846 
	`§x_vÆid©i⁄_vty_sh‹t_out
(
vty
, 
böfo
->
vÆ_ªs_BGPSEC
);

6850 
	`vty_out
 (
vty
, "-");

6852 
	`vty_out
 (
vty
, ") ");

6855 
vÆSèã
)

6857 
SRx_RESULT_VALID
:

6858 
locPªfPﬁ
 = 
VAL_LOCPRF_VALID
;

6860 
SRx_RESULT_NOTFOUND
:

6861 
locPªfPﬁ
 = 
VAL_LOCPRF_NOTFOUND
;

6863 
SRx_RESULT_INVALID
:

6864 
locPªfPﬁ
 = 
VAL_LOCPRF_INVALID
;

6867 
locPªfPﬁ
 = -1;

6869 i‡(
locPªfPﬁ
 > -1)

6871 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
locPªfPﬁ
].
is_£t
)

6873 
bgp
->
§x_vÆ_loˇl_¥ef
[
locPªfPﬁ
].
ªœtive
)

6876 
	`vty_out
 (
vty
, "-");

6879 
	`vty_out
 (
vty
, "+");

6882 
	`vty_out
 (
vty
, " ");

6884 
	`vty_out
 (
vty
, "%4d,", 
bgp
->
§x_vÆ_loˇl_¥ef
[
locPªfPﬁ
].
vÆue
);

6888 
	`vty_out
 (
vty
, " ");

6893 
	`vty_out
 (
vty
, " ");

6895 
	`vty_out
 (
vty
, " ");

6896 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_IGNORE
))

6898 
	`vty_out
 (
vty
, "I");

6900 i‡((
bgp
->
§x_c⁄fig
 & 
SRX_CONFIG_EVALUATE
) == 0)

6902 
	`vty_out
 (
vty
, "D");

6906 
	`vty_out
 (
vty
, " ");

6908 
	`vty_out
 (
vty
, " ");

6910 
	}
}

6916 
	$rouã_vty_sh‹t_°©us_out
 (
vty
 *vty, 
bgp_öfo
 *
böfo
)

6919 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_REMOVED
))

6920 
	`vty_out
 (
vty
, "R");

6921 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_STALE
))

6922 
	`vty_out
 (
vty
, "S");

6923 i‡(
böfo
->
exåa
 && böfo->exåa->
suµªss
)

6924 
	`vty_out
 (
vty
, "s");

6925 i‡(! 
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_HISTORY
))

6926 
	`vty_out
 (
vty
, "*");

6928 
	`vty_out
 (
vty
, " ");

6931 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_HISTORY
))

6932 
	`vty_out
 (
vty
, "h");

6933 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_DAMPED
))

6934 
	`vty_out
 (
vty
, "d");

6935 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_SELECTED
))

6936 
	`vty_out
 (
vty
, ">");

6938 
	`vty_out
 (
vty
, " ");

6941 i‡((
böfo
->
≥î
->
as
Ë&& (böfo->≥î->a†=böfo->≥î->
loˇl_as
))

6942 
	`vty_out
 (
vty
, "i");

6944 
	`vty_out
 (
vty
, " ");

6946 #ifde‡
USE_SRX


6947 
	`§x_rouã_vty_vÆid©i⁄_out
 (
vty
, 
böfo
);

6949 
	}
}

6953 
	$rouã_vty_out
 (
vty
 *vty, 
¥efix
 *
p
,

6954 
bgp_öfo
 *
böfo
, 
di•œy
, 
ßfi_t
 
ßfi
)

6956 
©å
 *attr;

6959 
	`rouã_vty_sh‹t_°©us_out
 (
vty
, 
böfo
);

6962 i‡(! 
di•œy
)

6963 
	`rouã_vty_out_rouã
 (
p
, 
vty
);

6965 
	`vty_out
 (
vty
, "%*s", 17, " ");

6968 
©å
 = 
böfo
->attr;

6969 i‡(
©å
)

6971 i‡(
p
->
Ámûy
 =
AF_INET
)

6973 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

6974 
	`vty_out
 (
vty
, "%-16s",

6975 
	`öë_¡ﬂ
 (
©å
->
exåa
->
mp_√xth›_globÆ_ö
));

6977 
	`vty_out
 (
vty
, "%-16s", 
	`öë_¡ﬂ
 (
©å
->
√xth›
));

6979 #ifde‡
HAVE_IPV6


6980 i‡(
p
->
Ámûy
 =
AF_INET6
)

6982 
Àn
;

6983 
buf
[
BUFSIZ
];

6985 
Àn
 = 
	`vty_out
 (
vty
, "%s",

6986 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_globÆ
,

6987 
buf
, 
BUFSIZ
));

6988 
Àn
 = 16 -Üen;

6989 i‡(
Àn
 < 1)

6990 
	`vty_out
 (
vty
, "%s%*s", 
VTY_NEWLINE
, 36, " ");

6992 
	`vty_out
 (
vty
, "%*s", 
Àn
, " ");

6996 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
))

6997 
	`vty_out
 (
vty
, "%10u", 
©å
->
med
);

6999 
	`vty_out
 (
vty
, " ");

7001 #ifde‡
USE_SRX


7003 
bgp
* bg∞
böfo
->
≥î
->bgp;

7004 
§xResu…
 = 
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
böfo
);

7005 
§x_loˇl_¥ef
* 
§xLocPªf
;

7006 
§xDoLocPªf
;

7008 i‡(
bgp
 !
NULL
)

7010 
§xResu…
)

7012 
SRx_RESULT_VALID
:

7013 
§xLocPªf
 = &
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_VALID
];

7014 
§xDoLocPªf
 = 1; ;

7015 
SRx_RESULT_NOTFOUND
:

7016 
§xLocPªf
 = &
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_NOTFOUND
];

7017 
§xDoLocPªf
 = 1; ;

7018 
SRx_RESULT_INVALID
:

7019 
§xLocPªf
 = &
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_INVALID
];

7020 
§xDoLocPªf
 = 1; ;

7022 
§xDoLocPªf
 = 0;

7023 
§xLocPªf
 = 
NULL
;

7028 
§xDoLocPªf
 = 0;

7029 
§xLocPªf
 = 
NULL
;

7033 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
))

7034 #ifde‡
USE_SRX


7036 i‡(
§xDoLocPªf
)

7038 
	`vty_out
 (
vty
, "%7ua", 
§xLocPªf
->
ªœtive


7039 ? 
©å
->
loˇl_¥ef
 + 
§xLocPªf
->
ªœtive
 * srxLocPªf->
vÆue


7040 : 
§xLocPªf
->
vÆue
);

7044 
	`vty_out
 (
vty
, "%7u ", 
©å
->
loˇl_¥ef
);

7047 
	`vty_out
 (
vty
, "%7u", 
©å
->
loˇl_¥ef
);

7050 #ifde‡
USE_SRX


7052 i‡(
§xDoLocPªf
 && 
§xLocPªf
->
is_£t
)

7054 
	`vty_out
 (
vty
, "%7us", 
§xLocPªf
->
vÆue
);

7058 #ifde‡
USE_SRX


7059 
	`vty_out
 (
vty
, " ");

7061 
	`vty_out
 (
vty
, " ");

7064 
	`vty_out
 (
vty
, "%7u ", (
©å
->
exåa
 ?áâr->exåa->
weight
 : 0));

7067 i‡(
©å
->
a•©h
)

7068 
	`a•©h_¥öt_vty
 (
vty
, "%s", 
©å
->
a•©h
, " ");

7071 
	`vty_out
 (
vty
, "%s", 
bgp_‹igö_°r
[
©å
->
‹igö
]);

7073 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7074 
	}
}

7078 
	$rouã_vty_out_tmp
 (
vty
 *vty, 
¥efix
 *
p
,

7079 
©å
 *©å, 
ßfi_t
 
ßfi
)

7082 
	`vty_out
 (
vty
, "*");

7083 
	`vty_out
 (
vty
, ">");

7084 
	`vty_out
 (
vty
, " ");

7087 
	`rouã_vty_out_rouã
 (
p
, 
vty
);

7090 i‡(
©å
)

7092 i‡(
p
->
Ámûy
 =
AF_INET
)

7094 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

7095 
	`vty_out
 (
vty
, "%-16s",

7096 
	`öë_¡ﬂ
 (
©å
->
exåa
->
mp_√xth›_globÆ_ö
));

7098 
	`vty_out
 (
vty
, "%-16s", 
	`öë_¡ﬂ
 (
©å
->
√xth›
));

7100 #ifde‡
HAVE_IPV6


7101 i‡(
p
->
Ámûy
 =
AF_INET6
)

7103 
Àn
;

7104 
buf
[
BUFSIZ
];

7106 
	`as£π
 (
©å
->
exåa
);

7108 
Àn
 = 
	`vty_out
 (
vty
, "%s",

7109 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_globÆ
,

7110 
buf
, 
BUFSIZ
));

7111 
Àn
 = 16 -Üen;

7112 i‡(
Àn
 < 1)

7113 
	`vty_out
 (
vty
, "%s%*s", 
VTY_NEWLINE
, 36, " ");

7115 
	`vty_out
 (
vty
, "%*s", 
Àn
, " ");

7119 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
))

7120 
	`vty_out
 (
vty
, "%10u", 
©å
->
med
);

7122 
	`vty_out
 (
vty
, " ");

7124 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
))

7125 
	`vty_out
 (
vty
, "%7u", 
©å
->
loˇl_¥ef
);

7127 
	`vty_out
 (
vty
, " ");

7129 
	`vty_out
 (
vty
, "%7u ", (
©å
->
exåa
 ?áâr->exåa->
weight
 : 0));

7132 i‡(
©å
->
a•©h
)

7133 
	`a•©h_¥öt_vty
 (
vty
, "%s", 
©å
->
a•©h
, " ");

7136 
	`vty_out
 (
vty
, "%s", 
bgp_‹igö_°r
[
©å
->
‹igö
]);

7139 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7140 
	}
}

7143 
	$rouã_vty_out_èg
 (
vty
 *vty, 
¥efix
 *
p
,

7144 
bgp_öfo
 *
böfo
, 
di•œy
, 
ßfi_t
 
ßfi
)

7146 
©å
 *attr;

7147 
u_öt32_t
 
œbñ
 = 0;

7149 i‡(!
böfo
->
exåa
)

7153 
	`rouã_vty_sh‹t_°©us_out
 (
vty
, 
böfo
);

7156 i‡(! 
di•œy
)

7157 
	`rouã_vty_out_rouã
 (
p
, 
vty
);

7159 
	`vty_out
 (
vty
, "%*s", 17, " ");

7162 
©å
 = 
böfo
->attr;

7163 i‡(
©å
)

7165 i‡(
p
->
Ámûy
 =
AF_INET
)

7167 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

7168 
	`vty_out
 (
vty
, "%-16s",

7169 
	`öë_¡ﬂ
 (
©å
->
exåa
->
mp_√xth›_globÆ_ö
));

7171 
	`vty_out
 (
vty
, "%-16s", 
	`öë_¡ﬂ
 (
©å
->
√xth›
));

7173 #ifde‡
HAVE_IPV6


7174 i‡(
p
->
Ámûy
 =
AF_INET6
)

7176 
	`as£π
 (
©å
->
exåa
);

7177 
buf
[
BUFSIZ
];

7178 
buf1
[
BUFSIZ
];

7179 i‡(
©å
->
exåa
->
mp_√xth›_Àn
 == 16)

7180 
	`vty_out
 (
vty
, "%s",

7181 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_globÆ
,

7182 
buf
, 
BUFSIZ
));

7183 i‡(
©å
->
exåa
->
mp_√xth›_Àn
 == 32)

7184 
	`vty_out
 (
vty
, "%s(%s)",

7185 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_globÆ
,

7186 
buf
, 
BUFSIZ
),

7187 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_loˇl
,

7188 
buf1
, 
BUFSIZ
));

7194 
œbñ
 = 
	`decode_œbñ
 (
böfo
->
exåa
->
èg
);

7196 
	`vty_out
 (
vty
, "nŸag/%d", 
œbñ
);

7198 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7199 
	}
}

7203 
	$damp_rouã_vty_out
 (
vty
 *vty, 
¥efix
 *
p
,

7204 
bgp_öfo
 *
böfo
, 
di•œy
, 
ßfi_t
 
ßfi
)

7206 
©å
 *attr;

7207 
Àn
;

7208 
timebuf
[
BGP_UPTIME_LEN
];

7211 
	`rouã_vty_sh‹t_°©us_out
 (
vty
, 
böfo
);

7214 i‡(! 
di•œy
)

7215 
	`rouã_vty_out_rouã
 (
p
, 
vty
);

7217 
	`vty_out
 (
vty
, "%*s", 17, " ");

7219 
Àn
 = 
	`vty_out
 (
vty
, "%s", 
böfo
->
≥î
->
ho°
);

7220 
Àn
 = 17 -Üen;

7221 i‡(
Àn
 < 1)

7222 
	`vty_out
 (
vty
, "%s%*s", 
VTY_NEWLINE
, 34, " ");

7224 
	`vty_out
 (
vty
, "%*s", 
Àn
, " ");

7226 
	`vty_out
 (
vty
, "%†", 
	`bgp_damp_ªu£_time_vty
 (vty, 
böfo
, 
timebuf
, 
BGP_UPTIME_LEN
));

7229 
©å
 = 
böfo
->attr;

7230 i‡(
©å
)

7233 i‡(
©å
->
a•©h
)

7234 
	`a•©h_¥öt_vty
 (
vty
, "%s", 
©å
->
a•©h
, " ");

7237 
	`vty_out
 (
vty
, "%s", 
bgp_‹igö_°r
[
©å
->
‹igö
]);

7239 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7240 
	}
}

7244 
	$Ê≠_rouã_vty_out
 (
vty
 *vty, 
¥efix
 *
p
,

7245 
bgp_öfo
 *
böfo
, 
di•œy
, 
ßfi_t
 
ßfi
)

7247 
©å
 *attr;

7248 
bgp_damp_öfo
 *
bdi
;

7249 
timebuf
[
BGP_UPTIME_LEN
];

7250 
Àn
;

7252 i‡(!
böfo
->
exåa
)

7255 
bdi
 = 
böfo
->
exåa
->
damp_öfo
;

7258 
	`rouã_vty_sh‹t_°©us_out
 (
vty
, 
böfo
);

7261 i‡(! 
di•œy
)

7262 
	`rouã_vty_out_rouã
 (
p
, 
vty
);

7264 
	`vty_out
 (
vty
, "%*s", 17, " ");

7266 
Àn
 = 
	`vty_out
 (
vty
, "%s", 
böfo
->
≥î
->
ho°
);

7267 
Àn
 = 16 -Üen;

7268 i‡(
Àn
 < 1)

7269 
	`vty_out
 (
vty
, "%s%*s", 
VTY_NEWLINE
, 33, " ");

7271 
	`vty_out
 (
vty
, "%*s", 
Àn
, " ");

7273 
Àn
 = 
	`vty_out
 (
vty
, "%d", 
bdi
->
Ê≠
);

7274 
Àn
 = 5 -Üen;

7275 i‡(
Àn
 < 1)

7276 
	`vty_out
 (
vty
, " ");

7278 
	`vty_out
 (
vty
, "%*†", 
Àn
, " ");

7280 
	`vty_out
 (
vty
, "%†", 
	`≥î_u±ime
 (
bdi
->
°¨t_time
,

7281 
timebuf
, 
BGP_UPTIME_LEN
));

7283 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_DAMPED
)

7284 && ! 
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_HISTORY
))

7285 
	`vty_out
 (
vty
, "%†", 
	`bgp_damp_ªu£_time_vty
 (vty, 
böfo
, 
timebuf
, 
BGP_UPTIME_LEN
));

7287 
	`vty_out
 (
vty
, "%*s ", 8, " ");

7290 
©å
 = 
böfo
->attr;

7291 i‡(
©å
)

7294 i‡(
©å
->
a•©h
)

7295 
	`a•©h_¥öt_vty
 (
vty
, "%s", 
©å
->
a•©h
, " ");

7298 
	`vty_out
 (
vty
, "%s", 
bgp_‹igö_°r
[
©å
->
‹igö
]);

7300 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7301 
	}
}

7303 #ifde‡
USE_SRX


7312 
	$§x_rouã_vty_out_dëaû
(
vty
 *vty, 
bgp
 *bgp,

7313 
bgp_öfo
 *
böfo
)

7315 c⁄° *
INDEX_STR
[4] =

7323 
	`vty_out
 (
vty
, " SRx Inf‹m©i⁄:%s", 
VTY_NEWLINE
);

7324 
	`vty_out
 (
vty
, " Upd©êID: 0x%08X%s", 
böfo
->
upd©eID
, 
VTY_NEWLINE
);

7325 i‡(
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_ORIGIN
))

7327 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_IGNORE
))

7329 
	`vty_out
 (
vty
, " Thi†upd©êwû»bêign‹ed!%s",
VTY_NEWLINE
);

7331 i‡(
	`a•©h_cou¡_h›s
 (
böfo
->
©å
->
a•©h
) == 0)

7333 
	`vty_out
 (
vty
, " Internal update,ÇoÖolicyÖrocessingÖerformed!!%s",

7334 
VTY_NEWLINE
);

7338 
	`vty_out
 (
vty
, " VÆid©i⁄:%s", 
VTY_NEWLINE
);

7339 
	`vty_out
 (
vty
, "Öªfix-‹igö: %s%s", 
INDEX_STR
[
böfo
->
vÆ_ªs_ROA
],

7340 
VTY_NEWLINE
);

7341 i‡(
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_PATH
))

7343 
	`vty_out
 (
vty
, "Ö©h: %s%s", 
INDEX_STR
[
böfo
->
vÆ_ªs_BGPSEC
],

7344 
VTY_NEWLINE
);

7345 
	`vty_out
 (
vty
, " bgpsec: %s (combination ofÖrefix-originánd "

7347 
INDEX_STR
[
	`§x_ˇlc_vÆid©i⁄_°©e
(
bgp
, 
böfo
)],

7348 
VTY_NEWLINE
);

7352 
	`vty_out
 (
vty
, "Öath:Örocessing disabled!%s",

7353 
VTY_NEWLINE
);

7358 
	`vty_out
 (
vty
, " PathType: ");

7359 i‡(!
böfo
->
©å
->
bgp£cP©hAâr
)

7361 
	`vty_out
 (
vty
, "AS-PATH%s", 
VTY_NEWLINE
);

7365 
P©hSegmít
* 
∑thSegmít
;

7366 
SigBlock
 *
sigBlock
;

7367 
SigSegmít
 *
sigSegmít1
;

7368 
SigSegmít
 *
sigSegmít2
;

7370 
blockCou¡î
=0;

7371 
£gCou¡î
=0;

7373 
∑thSegmít
 = 
böfo
->
©å
->
bgp£cP©hAâr
->
∑thSegmíts
;

7374 
sigBlock
 = 
böfo
->
©å
->
bgp£cP©hAâr
->
sigBlocks
;

7378 
∑thSegmít
)

7380 
£gCou¡î
++;

7381 
∑thSegmít
 =Ö©hSegmít->
√xt
;

7385 
sigBlock
 = 
böfo
->
©å
->
bgp£cP©hAâr
->
sigBlocks
;

7386 
blockCou¡î
=0;

7387 
sigBlock
)

7389 
blockCou¡î
++;

7390 
sigBlock
 = sigBlock->
√xt
;

7393 
	`vty_out
 (
vty
, "BGPSEC-Path ( %d signature blocks,Éach with %dÖath "

7394 "£gmíts)%s", 
blockCou¡î
, 
£gCou¡î
, 
VTY_NEWLINE
);

7396 
sigBlock
 = 
böfo
->
©å
->
bgp£cP©hAâr
->
sigBlocks
;

7397 
∑thSegmít
 = 
böfo
->
©å
->
bgp£cP©hAâr
->
∑thSegmíts
;

7398 
sigSegmít1
 = 
sigBlock
->
sigSegmíts
;

7399 
sigSegmít2
 = (
sigBlock
->
√xt
Ë? sigBlock->√xt->
sigSegmíts
 : 
NULL
;

7402 
sigBlock
)

7404 
	`vty_out
 (
vty
, " signature block #%d:álgorithm suite id %d%s",

7405 
blockCou¡î
, 
sigBlock
->
ÆgoSuôeId
, 
VTY_NEWLINE
);

7406 
sigBlock
 = sigBlock->
√xt
;

7410 
£gCou¡î
=0;

7411 
∑thSegmít
 = 
böfo
->
©å
->
bgp£cP©hAâr
->
∑thSegmíts
;

7412 
∑thSegmít
)

7414 
£gCou¡î
++;

7415 
	`vty_out
 (
vty
, "Ö©h segmíà%d:ás=%d;Öcou¡=%d%s", 
£gCou¡î
,

7416 
∑thSegmít
->
as
,Ö©hSegmít->
pCou¡
, 
VTY_NEWLINE
);

7417 
∑thSegmít
 =Ö©hSegmít->
√xt
;

7420 
i
;

7421 i‡(
sigSegmít1
)

7423 
	`vty_out
 (
vty
, " signature segment [%d]: block 1, ski=",

7424 
£gCou¡î
);

7425 
i
=0; i < 20; i++)

7427 
	`vty_out
 (
vty
, "%02X", 
sigSegmít1
->
ski
[
i
]);

7429 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7430 
sigSegmít1
 = sigSegmít1->
√xt
;

7433 i‡(
sigSegmít2
)

7435 
	`vty_out
 (
vty
, " signature segment [%d]: block 2, ski=",

7436 
£gCou¡î
);

7437 
i
=0; i < 20; i++)

7439 
	`vty_out
 (
vty
, "%02X", 
sigSegmít2
->
ski
[
i
]);

7441 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7442 
sigSegmít2
 = sigSegmít2->
√xt
;

7449 
	`vty_out
 (
vty
, " SRxÉvaluation is deactivated, validationÑesults "

7450 "¨êign‹ed!%s", 
VTY_NEWLINE
);

7452 
	}
}

7456 
	$rouã_vty_out_dëaû
 (
vty
 *vty, 
bgp
 *bgp, 
¥efix
 *
p
,

7457 
bgp_öfo
 *
böfo
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

7459 
buf
[
INET6_ADDRSTRLEN
];

7460 
buf1
[
BUFSIZ
];

7461 
©å
 *attr;

7462 
	`sockuni⁄_vty_out
 (
vty
 *, 
sockuni⁄
 *);

7463 #ifde‡
HAVE_CLOCK_MONOTONIC


7464 
time_t
 
tbuf
;

7467 
©å
 = 
böfo
->attr;

7469 i‡(
©å
)

7472 i‡(
©å
->
a•©h
)

7474 
	`vty_out
 (
vty
, " ");

7475 i‡(
	`a•©h_cou¡_h›s
 (
©å
->
a•©h
) == 0)

7476 
	`vty_out
 (
vty
, "Local");

7478 
	`a•©h_¥öt_vty
 (
vty
, "%s", 
©å
->
a•©h
, "");

7481 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_REMOVED
))

7482 
	`vty_out
 (
vty
, ", (removed)");

7483 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_STALE
))

7484 
	`vty_out
 (
vty
, ", (stale)");

7485 i‡(
	`CHECK_FLAG
 (
©å
->
Êag
, 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
)))

7486 
	`vty_out
 (
vty
, ", (aggregated by %u %s)",

7487 
©å
->
exåa
->
aggªg©‹_as
,

7488 
	`öë_¡ﬂ
 (
©å
->
exåa
->
aggªg©‹_addr
));

7489 i‡(
	`CHECK_FLAG
 (
böfo
->
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_REFLECTOR_CLIENT
))

7490 
	`vty_out
 (
vty
, ", (Received fromá RR-client)");

7491 i‡(
	`CHECK_FLAG
 (
böfo
->
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

7492 
	`vty_out
 (
vty
, ", (Received fromá RS-client)");

7493 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_HISTORY
))

7494 
	`vty_out
 (
vty
, ", (historyÉntry)");

7495 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_DAMPED
))

7496 
	`vty_out
 (
vty
, ", (suppressed dueÅo dampening)");

7497 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7499 #ifde‡
USE_SRX


7501 i‡(
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_DISPLAY_INFO
))

7503 
	`§x_rouã_vty_out_dëaû
(
vty
, 
bgp
, 
böfo
);

7508 i‡(
p
->
Ámûy
 =
AF_INET
)

7510 
	`vty_out
 (
vty
, " %s", 
ßfi
 =
SAFI_MPLS_VPN
 ?

7511 
	`öë_¡ﬂ
 (
©å
->
exåa
->
mp_√xth›_globÆ_ö
) :

7512 
	`öë_¡ﬂ
 (
©å
->
√xth›
));

7514 #ifde‡
HAVE_IPV6


7517 
	`as£π
 (
©å
->
exåa
);

7518 
	`vty_out
 (
vty
, " %s",

7519 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_globÆ
,

7520 
buf
, 
INET6_ADDRSTRLEN
));

7524 i‡(
böfo
->
≥î
 =
bgp
->
≥î_£lf
)

7526 
	`vty_out
 (
vty
, " from %s ",

7527 
p
->
Ámûy
 =
AF_INET
 ? "0.0.0.0" : "::");

7528 
	`vty_out
 (
vty
, "(%s)", 
	`öë_¡ﬂ
(
bgp
->
rouãr_id
));

7532 i‡(! 
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_VALID
))

7533 
	`vty_out
 (
vty
, " (inaccessible)");

7534 i‡(
böfo
->
exåa
 && böfo->exåa->
igpmëric
)

7535 
	`vty_out
 (
vty
, " (mëri¯%u)", 
böfo
->
exåa
->
igpmëric
);

7536 
	`vty_out
 (
vty
, " from %s", 
	`sockuni⁄2°r
 (&
böfo
->
≥î
->
su
, 
buf
, 
SU_ADDRSTRLEN
));

7537 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_ORIGINATOR_ID
))

7538 
	`vty_out
 (
vty
, " (%s)", 
	`öë_¡ﬂ
 (
©å
->
exåa
->
‹igö©‹_id
));

7540 
	`vty_out
 (
vty
, " (%s)", 
	`öë_¡›
 (
AF_INET
, &
böfo
->
≥î
->
ªmŸe_id
, 
buf1
, 
BUFSIZ
));

7542 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7544 #ifde‡
HAVE_IPV6


7546 i‡(
©å
->
exåa
 &&áâr->exåa->
mp_√xth›_Àn
 == 32)

7548 
	`vty_out
 (
vty
, " (%s)%s",

7549 
	`öë_¡›
 (
AF_INET6
, &
©å
->
exåa
->
mp_√xth›_loˇl
,

7550 
buf
, 
INET6_ADDRSTRLEN
),

7551 
VTY_NEWLINE
);

7556 
	`vty_out
 (
vty
, " Origö %s", 
bgp_‹igö_l⁄g_°r
[
©å
->
‹igö
]);

7558 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_MULTI_EXIT_DISC
))

7559 
	`vty_out
 (
vty
, ", mëri¯%u", 
©å
->
med
);

7561 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_LOCAL_PREF
))

7562 
	`vty_out
 (
vty
, ",ÜoˇÕª‡%u", 
©å
->
loˇl_¥ef
);

7564 
	`vty_out
 (
vty
, ",ÜoˇÕª‡%u", 
bgp
->
deÁu…_loˇl_¥ef
);

7566 i‡(
©å
->
exåa
 &&áâr->exåa->
weight
 != 0)

7567 
	`vty_out
 (
vty
, ", weighà%u", 
©å
->
exåa
->
weight
);

7569 i‡(! 
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_HISTORY
))

7570 
	`vty_out
 (
vty
, ", valid");

7572 i‡(
böfo
->
≥î
 !
bgp
->
≥î_£lf
)

7574 i‡(
böfo
->
≥î
->
as
 =böfo->≥î->
loˇl_as
)

7575 
	`vty_out
 (
vty
, ", internal");

7577 
	`vty_out
 (
vty
, ", %s",

7578 (
	`bgp_c⁄„dî©i⁄_≥îs_check
(
bgp
, 
böfo
->
≥î
->
as
) ? "confed-external" : "external"));

7580 i‡(
böfo
->
sub_ty≥
 =
BGP_ROUTE_AGGREGATE
)

7581 
	`vty_out
 (
vty
, ",ággregated,Üocal");

7582 i‡(
böfo
->
ty≥
 !
ZEBRA_ROUTE_BGP
)

7583 
	`vty_out
 (
vty
, ", sourced");

7585 
	`vty_out
 (
vty
, ", sourced,Üocal");

7587 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_ATOMIC_AGGREGATE
))

7588 
	`vty_out
 (
vty
, ",átomic-aggregate");

7590 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_MULTIPATH
) ||

7591 (
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_SELECTED
) &&

7592 
	`bgp_öfo_m∑th_cou¡
 (
böfo
)))

7593 
	`vty_out
 (
vty
, ", multipath");

7595 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_SELECTED
))

7596 
	`vty_out
 (
vty
, ", best");

7598 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7601 i‡(
©å
->
communôy
)

7602 
	`vty_out
 (
vty
, " Communôy: %s%s", 
©å
->
communôy
->
°r
,

7603 
VTY_NEWLINE
);

7606 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_EXT_COMMUNITIES
))

7607 
	`vty_out
 (
vty
, " Extended Community: %s%s",

7608 
©å
->
exåa
->
ecommunôy
->
°r
, 
VTY_NEWLINE
);

7611 i‡((
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_ORIGINATOR_ID
)) ||

7612 (
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_CLUSTER_LIST
)))

7614 
	`as£π
 (
©å
->
exåa
);

7615 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_ORIGINATOR_ID
))

7616 
	`vty_out
 (
vty
, " Originator: %s",

7617 
	`öë_¡ﬂ
 (
©å
->
exåa
->
‹igö©‹_id
));

7619 i‡(
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
(
BGP_ATTR_CLUSTER_LIST
))

7621 
i
;

7622 
	`vty_out
 (
vty
, ", ClusterÜist: ");

7623 
i
 = 0; i < 
©å
->
exåa
->
˛u°î
->
Àngth
 / 4; i++)

7624 
	`vty_out
 (
vty
, "%s ",

7625 
	`öë_¡ﬂ
 (
©å
->
exåa
->
˛u°î
->
li°
[
i
]));

7627 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7630 i‡(
böfo
->
exåa
 && böfo->exåa->
damp_öfo
)

7631 
	`bgp_damp_öfo_vty
 (
vty
, 
böfo
);

7634 #ifde‡
HAVE_CLOCK_MONOTONIC


7635 
tbuf
 = 
	`time
(
NULL
Ë- (
	`bgp_˛ock
(Ë- 
böfo
->
u±ime
);

7636 
	`vty_out
 (
vty
, " La° upd©e: %s", 
	`˘ime
(&
tbuf
));

7638 
	`vty_out
 (
vty
, " La° upd©e: %s", 
	`˘ime
(&
böfo
->
u±ime
));

7641 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

7642 
	}
}

7644 #ifde‡
USE_SRX


7645 
	#BGP_SRX_SHOW_SCODE_HEADER
 "Validation: v - valid,Ç -Çotfound, i - invalid, ? - undefined%s" \

7647 "SRxVÆ F‹m©: vÆid©i⁄Ñesu… (‹igö vÆid©i⁄,Ö©h vÆid©i⁄)%s"

	)

7649 
	#BGP_SRX_SHOW_HEADER
 " Idíà SRxVÆ SRxLP Sètu†Nëw‹k NexàH› Mëri¯ LocPr‡WeighàP©h%s"

	)

7652 
	#BGP_SHOW_SCODE_HEADER
 "Sètu†codes: s suµªs£d, d dam≥d, h hi°‹y, * vÆid, > be°, i - i¡î«l,%†Ñ RIB-Áûuª, S SèÀ, R Removed%s"

	)

7653 
	#BGP_SHOW_OCODE_HEADER
 "Origö codes: i - IGP,É - EGP, ? - incom∂ëe%s%s"

	)

7654 
	#BGP_SHOW_HEADER
 " Nëw‹k NexàH› Mëri¯LocPr‡WeighàP©h%s"

	)

7655 
	#BGP_SHOW_DAMP_HEADER
 " Nëw‹k From Reu£ P©h%s"

	)

7656 
	#BGP_SHOW_FLAP_HEADER
 " Nëw‹k From Fœp†Duøti⁄ Reu£ P©h%s"

	)

7658 
	ebgp_show_ty≥


7660 
	mbgp_show_ty≥_n‹mÆ
,

7661 
	mbgp_show_ty≥_ªgexp
,

7662 
	mbgp_show_ty≥_¥efix_li°
,

7663 
	mbgp_show_ty≥_fûãr_li°
,

7664 
	mbgp_show_ty≥_rouã_m≠
,

7665 
	mbgp_show_ty≥_√ighb‹
,

7666 
	mbgp_show_ty≥_cidr_⁄ly
,

7667 
	mbgp_show_ty≥_¥efix_l⁄gî
,

7668 
	mbgp_show_ty≥_communôy_Æl
,

7669 
	mbgp_show_ty≥_communôy
,

7670 
	mbgp_show_ty≥_communôy_exa˘
,

7671 
	mbgp_show_ty≥_communôy_li°
,

7672 
	mbgp_show_ty≥_communôy_li°_exa˘
,

7673 
	mbgp_show_ty≥_Ê≠_°©i°ics
,

7674 
	mbgp_show_ty≥_Ê≠_addªss
,

7675 
	mbgp_show_ty≥_Ê≠_¥efix
,

7676 
	mbgp_show_ty≥_Ê≠_cidr_⁄ly
,

7677 
	mbgp_show_ty≥_Ê≠_ªgexp
,

7678 
	mbgp_show_ty≥_Ê≠_fûãr_li°
,

7679 
	mbgp_show_ty≥_Ê≠_¥efix_li°
,

7680 
	mbgp_show_ty≥_Ê≠_¥efix_l⁄gî
,

7681 
	mbgp_show_ty≥_Ê≠_rouã_m≠
,

7682 
	mbgp_show_ty≥_Ê≠_√ighb‹
,

7683 
	mbgp_show_ty≥_dam≥nd_∑ths
,

7684 
	mbgp_show_ty≥_damp_√ighb‹


7688 
	$bgp_show_èbÀ
 (
vty
 *vty, 
bgp_èbÀ
 *
èbÀ
, 
ö_addr
 *
rouãr_id
,

7689 
bgp_show_ty≥
 
ty≥
, *
ouçut_¨g
)

7691 
bgp_öfo
 *
ri
;

7692 
bgp_node
 *
∫
;

7693 
hódî
 = 1;

7694 
di•œy
;

7695 
ouçut_cou¡
;

7697 #ifde‡
USE_SRX


7698 
di•œySRX
 = 0;

7702 
ouçut_cou¡
 = 0;

7705 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

7706 i‡(
∫
->
öfo
 !
NULL
)

7708 
di•œy
 = 0;

7710 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

7712 i‡(
ty≥
 =
bgp_show_ty≥_Ê≠_°©i°ics


7713 || 
ty≥
 =
bgp_show_ty≥_Ê≠_addªss


7714 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix


7715 || 
ty≥
 =
bgp_show_ty≥_Ê≠_cidr_⁄ly


7716 || 
ty≥
 =
bgp_show_ty≥_Ê≠_ªgexp


7717 || 
ty≥
 =
bgp_show_ty≥_Ê≠_fûãr_li°


7718 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_li°


7719 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_l⁄gî


7720 || 
ty≥
 =
bgp_show_ty≥_Ê≠_rouã_m≠


7721 || 
ty≥
 =
bgp_show_ty≥_Ê≠_√ighb‹


7722 || 
ty≥
 =
bgp_show_ty≥_dam≥nd_∑ths


7723 || 
ty≥
 =
bgp_show_ty≥_damp_√ighb‹
)

7725 i‡(!(
ri
->
exåa
 &&Ñi->exåa->
damp_öfo
))

7728 i‡(
ty≥
 =
bgp_show_ty≥_ªgexp


7729 || 
ty≥
 =
bgp_show_ty≥_Ê≠_ªgexp
)

7731 
ªgex_t
 *
ªgex
 = 
ouçut_¨g
;

7733 i‡(
	`bgp_ªgexec
 (
ªgex
, 
ri
->
©å
->
a•©h
Ë=
REG_NOMATCH
)

7736 i‡(
ty≥
 =
bgp_show_ty≥_¥efix_li°


7737 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_li°
)

7739 
¥efix_li°
 *
∂i°
 = 
ouçut_¨g
;

7741 i‡(
	`¥efix_li°_≠∂y
 (
∂i°
, &
∫
->
p
Ë!
PREFIX_PERMIT
)

7744 i‡(
ty≥
 =
bgp_show_ty≥_fûãr_li°


7745 || 
ty≥
 =
bgp_show_ty≥_Ê≠_fûãr_li°
)

7747 
as_li°
 *as_li° = 
ouçut_¨g
;

7749 i‡(
	`as_li°_≠∂y
 (
as_li°
, 
ri
->
©å
->
a•©h
Ë!
AS_FILTER_PERMIT
)

7752 i‡(
ty≥
 =
bgp_show_ty≥_rouã_m≠


7753 || 
ty≥
 =
bgp_show_ty≥_Ê≠_rouã_m≠
)

7755 
rouã_m≠
 *
rm≠
 = 
ouçut_¨g
;

7756 
bgp_öfo
 
böfo
;

7757 
©å
 
dummy_©å
;

7758 
©å_exåa
 
dummy_exåa
;

7759 
ªt
;

7761 
dummy_©å
.
exåa
 = &
dummy_exåa
;

7762 
	`bgp_©å_dup
 (&
dummy_©å
, 
ri
->
©å
);

7764 
böfo
.
≥î
 = 
ri
->peer;

7765 
böfo
.
©å
 = &
dummy_©å
;

7767 
ªt
 = 
	`rouã_m≠_≠∂y
 (
rm≠
, &
∫
->
p
, 
RMAP_BGP
, &
böfo
);

7768 i‡(
ªt
 =
RMAP_DENYMATCH
)

7771 i‡(
ty≥
 =
bgp_show_ty≥_√ighb‹


7772 || 
ty≥
 =
bgp_show_ty≥_Ê≠_√ighb‹


7773 || 
ty≥
 =
bgp_show_ty≥_damp_√ighb‹
)

7775 
sockuni⁄
 *
su
 = 
ouçut_¨g
;

7777 i‡(
ri
->
≥î
->
su_ªmŸe
 =
NULL
 || ! 
	`sockuni⁄_ßme
‘i->≥î->su_ªmŸe, 
su
))

7780 i‡(
ty≥
 =
bgp_show_ty≥_cidr_⁄ly


7781 || 
ty≥
 =
bgp_show_ty≥_Ê≠_cidr_⁄ly
)

7783 
u_öt32_t
 
de°ö©i⁄
;

7785 
de°ö©i⁄
 = 
	`¡ohl
 (
∫
->
p
.
u
.
¥efix4
.
s_addr
);

7786 i‡(
	`IN_CLASSC
 (
de°ö©i⁄
Ë&& 
∫
->
p
.
¥efixÀn
 == 24)

7788 i‡(
	`IN_CLASSB
 (
de°ö©i⁄
Ë&& 
∫
->
p
.
¥efixÀn
 == 16)

7790 i‡(
	`IN_CLASSA
 (
de°ö©i⁄
Ë&& 
∫
->
p
.
¥efixÀn
 == 8)

7793 i‡(
ty≥
 =
bgp_show_ty≥_¥efix_l⁄gî


7794 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_l⁄gî
)

7796 
¥efix
 *
p
 = 
ouçut_¨g
;

7798 i‡(! 
	`¥efix_m©ch
 (
p
, &
∫
->p))

7801 i‡(
ty≥
 =
bgp_show_ty≥_communôy_Æl
)

7803 i‡(! 
ri
->
©å
->
communôy
)

7806 i‡(
ty≥
 =
bgp_show_ty≥_communôy
)

7808 
communôy
 *
com
 = 
ouçut_¨g
;

7810 i‡(! 
ri
->
©å
->
communôy
 ||

7811 ! 
	`communôy_m©ch
 (
ri
->
©å
->
communôy
, 
com
))

7814 i‡(
ty≥
 =
bgp_show_ty≥_communôy_exa˘
)

7816 
communôy
 *
com
 = 
ouçut_¨g
;

7818 i‡(! 
ri
->
©å
->
communôy
 ||

7819 ! 
	`communôy_cmp
 (
ri
->
©å
->
communôy
, 
com
))

7822 i‡(
ty≥
 =
bgp_show_ty≥_communôy_li°
)

7824 
communôy_li°
 *
li°
 = 
ouçut_¨g
;

7826 i‡(! 
	`communôy_li°_m©ch
 (
ri
->
©å
->
communôy
, 
li°
))

7829 i‡(
ty≥
 =
bgp_show_ty≥_communôy_li°_exa˘
)

7831 
communôy_li°
 *
li°
 = 
ouçut_¨g
;

7833 i‡(! 
	`communôy_li°_exa˘_m©ch
 (
ri
->
©å
->
communôy
, 
li°
))

7836 i‡(
ty≥
 =
bgp_show_ty≥_Ê≠_addªss


7837 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix
)

7839 
¥efix
 *
p
 = 
ouçut_¨g
;

7841 i‡(! 
	`¥efix_m©ch
 (&
∫
->
p
,Ö))

7844 i‡(
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix
)

7845 i‡(
p
->
¥efixÀn
 !
∫
->p.prefixlen)

7848 i‡(
ty≥
 =
bgp_show_ty≥_dam≥nd_∑ths


7849 || 
ty≥
 =
bgp_show_ty≥_damp_√ighb‹
)

7851 i‡(! 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_DAMPED
)

7852 || 
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_HISTORY
))

7856 i‡(
hódî
)

7858 
	`vty_out
 (
vty
, "BGPÅabÀ vîsi⁄ i†0,Üoˇ»rouã∏ID i†%s%s", 
	`öë_¡ﬂ
 (*
rouãr_id
), 
VTY_NEWLINE
);

7859 
	`vty_out
 (
vty
, 
BGP_SHOW_SCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

7860 #ifde‡
USE_SRX


7861 i‡(
	`CHECK_FLAG
(
ri
->
≥î
->
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_DISPLAY_INFO
))

7863 
di•œySRX
 = 1;

7864 
	`vty_out
 (
vty
, 
BGP_SRX_SHOW_SCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE,

7865 
VTY_NEWLINE
);

7869 
di•œySRX
 = 0;

7872 
	`vty_out
 (
vty
, 
BGP_SHOW_OCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

7873 i‡(
ty≥
 =
bgp_show_ty≥_dam≥nd_∑ths


7874 || 
ty≥
 =
bgp_show_ty≥_damp_√ighb‹
)

7875 
	`vty_out
 (
vty
, 
BGP_SHOW_DAMP_HEADER
, 
VTY_NEWLINE
);

7876 i‡(
ty≥
 =
bgp_show_ty≥_Ê≠_°©i°ics


7877 || 
ty≥
 =
bgp_show_ty≥_Ê≠_addªss


7878 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix


7879 || 
ty≥
 =
bgp_show_ty≥_Ê≠_cidr_⁄ly


7880 || 
ty≥
 =
bgp_show_ty≥_Ê≠_ªgexp


7881 || 
ty≥
 =
bgp_show_ty≥_Ê≠_fûãr_li°


7882 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_li°


7883 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_l⁄gî


7884 || 
ty≥
 =
bgp_show_ty≥_Ê≠_rouã_m≠


7885 || 
ty≥
 =
bgp_show_ty≥_Ê≠_√ighb‹
)

7886 
	`vty_out
 (
vty
, 
BGP_SHOW_FLAP_HEADER
, 
VTY_NEWLINE
);

7888 #ifde‡
USE_SRX


7890 i‡(
di•œySRX
)

7892 
	`vty_out
 (
vty
, 
BGP_SRX_SHOW_HEADER
, 
VTY_NEWLINE
);

7896 
	`vty_out
 (
vty
, 
BGP_SHOW_HEADER
, 
VTY_NEWLINE
);

7900 
	`vty_out
 (
vty
, 
BGP_SHOW_HEADER
, 
VTY_NEWLINE
);

7902 
hódî
 = 0;

7905 i‡(
ty≥
 =
bgp_show_ty≥_dam≥nd_∑ths


7906 || 
ty≥
 =
bgp_show_ty≥_damp_√ighb‹
)

7907 
	`damp_rouã_vty_out
 (
vty
, &
∫
->
p
, 
ri
, 
di•œy
, 
SAFI_UNICAST
);

7908 i‡(
ty≥
 =
bgp_show_ty≥_Ê≠_°©i°ics


7909 || 
ty≥
 =
bgp_show_ty≥_Ê≠_addªss


7910 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix


7911 || 
ty≥
 =
bgp_show_ty≥_Ê≠_cidr_⁄ly


7912 || 
ty≥
 =
bgp_show_ty≥_Ê≠_ªgexp


7913 || 
ty≥
 =
bgp_show_ty≥_Ê≠_fûãr_li°


7914 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_li°


7915 || 
ty≥
 =
bgp_show_ty≥_Ê≠_¥efix_l⁄gî


7916 || 
ty≥
 =
bgp_show_ty≥_Ê≠_rouã_m≠


7917 || 
ty≥
 =
bgp_show_ty≥_Ê≠_√ighb‹
)

7918 
	`Ê≠_rouã_vty_out
 (
vty
, &
∫
->
p
, 
ri
, 
di•œy
, 
SAFI_UNICAST
);

7920 
	`rouã_vty_out
 (
vty
, &
∫
->
p
, 
ri
, 
di•œy
, 
SAFI_UNICAST
);

7921 
di•œy
++;

7923 i‡(
di•œy
)

7924 
ouçut_cou¡
++;

7928 i‡(
ouçut_cou¡
 == 0)

7930 i‡(
ty≥
 =
bgp_show_ty≥_n‹mÆ
)

7931 
	`vty_out
 (
vty
, "NÿBGPÇëw‹kÉxi°s%s", 
VTY_NEWLINE
);

7934 
	`vty_out
 (
vty
, "%sTotalÇumber ofÖrefixes %ld%s",

7935 
VTY_NEWLINE
, 
ouçut_cou¡
, VTY_NEWLINE);

7937  
CMD_SUCCESS
;

7938 
	}
}

7941 
	$bgp_show
 (
vty
 *vty, 
bgp
 *bgp, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

7942 
bgp_show_ty≥
 
ty≥
, *
ouçut_¨g
)

7944 
bgp_èbÀ
 *
èbÀ
;

7946 i‡(
bgp
 =
NULL
) {

7947 
bgp
 = 
	`bgp_gë_deÁu…
 ();

7950 i‡(
bgp
 =
NULL
)

7952 
	`vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

7953  
CMD_WARNING
;

7957 
èbÀ
 = 
bgp
->
rib
[
afi
][
ßfi
];

7959  
	`bgp_show_èbÀ
 (
vty
, 
èbÀ
, &
bgp
->
rouãr_id
, 
ty≥
, 
ouçut_¨g
);

7960 
	}
}

7964 
	$rouã_vty_out_dëaû_hódî
 (
vty
 *vty, 
bgp
 *bgp,

7965 
bgp_node
 *
∫
,

7966 
¥efix_rd
 *
¥d
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

7968 
bgp_öfo
 *
ri
;

7969 
¥efix
 *
p
;

7970 
≥î
 *peer;

7971 
li°node
 *
node
, *
¬ode
;

7972 
buf1
[
INET6_ADDRSTRLEN
];

7973 
buf2
[
INET6_ADDRSTRLEN
];

7974 
cou¡
 = 0;

7975 
be°
 = 0;

7976 
suµªss
 = 0;

7977 
no_exp‹t
 = 0;

7978 
no_advîti£
 = 0;

7979 
loˇl_as
 = 0;

7980 
fú°
 = 0;

7982 
p
 = &
∫
->p;

7983 
	`vty_out
 (
vty
, "BGPÑoutingÅableÉntry for %s%s%s/%d%s",

7984 (
ßfi
 =
SAFI_MPLS_VPN
 ?

7985 
	`¥efix_rd2°r
 (
¥d
, 
buf1
, 
RD_ADDRSTRLEN
) : ""),

7986 
ßfi
 =
SAFI_MPLS_VPN
 ? ":" : "",

7987 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf2
, 
INET6_ADDRSTRLEN
),

7988 
p
->
¥efixÀn
, 
VTY_NEWLINE
);

7990 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

7992 
cou¡
++;

7993 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_SELECTED
))

7995 
be°
 = 
cou¡
;

7996 i‡(
ri
->
exåa
 &&Ñi->exåa->
suµªss
)

7997 
suµªss
 = 1;

7998 i‡(
ri
->
©å
->
communôy
 !
NULL
)

8000 i‡(
	`communôy_ö˛ude
 (
ri
->
©å
->
communôy
, 
COMMUNITY_NO_ADVERTISE
))

8001 
no_advîti£
 = 1;

8002 i‡(
	`communôy_ö˛ude
 (
ri
->
©å
->
communôy
, 
COMMUNITY_NO_EXPORT
))

8003 
no_exp‹t
 = 1;

8004 i‡(
	`communôy_ö˛ude
 (
ri
->
©å
->
communôy
, 
COMMUNITY_LOCAL_AS
))

8005 
loˇl_as
 = 1;

8010 
	`vty_out
 (
vty
, "P©hs: (%dávaûabÀ", 
cou¡
);

8011 i‡(
be°
)

8013 
	`vty_out
 (
vty
, ", be° #%d", 
be°
);

8014 i‡(
ßfi
 =
SAFI_UNICAST
)

8015 
	`vty_out
 (
vty
, ",Åable Default-IP-Routing-Table");

8018 
	`vty_out
 (
vty
, ",Ço bestÖath");

8019 i‡(
no_advîti£
)

8020 
	`vty_out
 (
vty
, ",ÇotádvertisedÅoányÖeer");

8021 i‡(
no_exp‹t
)

8022 
	`vty_out
 (
vty
, ",ÇotádvertisedÅo EBGPÖeer");

8023 i‡(
loˇl_as
)

8024 
	`vty_out
 (
vty
, ",Çotádvertised outsideÜocal AS");

8025 i‡(
suµªss
)

8026 
	`vty_out
 (
vty
, ", Advertisements suppressed byánággregate.");

8027 
	`vty_out
 (
vty
, ")%s", 
VTY_NEWLINE
);

8030 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

8032 i‡(
	`bgp_adj_out_lookup
 (
≥î
, 
p
, 
afi
, 
ßfi
, 
∫
))

8034 i‡(! 
fú°
)

8035 
	`vty_out
 (
vty
, " Advîti£dÅÿn⁄Öìr-grou∞≥îs:%†", 
VTY_NEWLINE
);

8036 
	`vty_out
 (
vty
, " %s", 
	`sockuni⁄2°r
 (&
≥î
->
su
, 
buf1
, 
SU_ADDRSTRLEN
));

8037 
fú°
 = 1;

8040 i‡(! 
fú°
)

8041 
	`vty_out
 (
vty
, " NotádvertisedÅoányÖeer");

8042 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8043 
	}
}

8047 
	$bgp_show_rouã_ö_èbÀ
 (
vty
 *vty, 
bgp
 *bgp,

8048 
bgp_èbÀ
 *
rib
, c⁄° *
ù_°r
,

8049 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
¥efix_rd
 *
¥d
,

8050 
¥efix_check
)

8052 
ªt
;

8053 
hódî
;

8054 
di•œy
 = 0;

8055 
¥efix
 
m©ch
;

8056 
bgp_node
 *
∫
;

8057 
bgp_node
 *
rm
;

8058 
bgp_öfo
 *
ri
;

8059 
bgp_èbÀ
 *
èbÀ
;

8062 
ªt
 = 
	`°r2¥efix
 (
ù_°r
, &
m©ch
);

8063 i‡(! 
ªt
)

8065 
	`vty_out
 (
vty
, "addªs†i†mÆf‹med%s", 
VTY_NEWLINE
);

8066  
CMD_WARNING
;

8069 
m©ch
.
Ámûy
 = 
	`afi2Ámûy
 (
afi
);

8071 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

8073 
∫
 = 
	`bgp_èbÀ_t›
 (
rib
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

8075 i‡(
¥d
 && 
	`memcmp
 (
∫
->
p
.
u
.
vÆ
,Örd->val, 8) != 0)

8078 i‡((
èbÀ
 = 
∫
->
öfo
Ë!
NULL
)

8080 
hódî
 = 1;

8082 i‡((
rm
 = 
	`bgp_node_m©ch
 (
èbÀ
, &
m©ch
)Ë!
NULL
)

8084 i‡(
¥efix_check
 && 
rm
->
p
.
¥efixÀn
 !
m©ch
.prefixlen)

8086 
	`bgp_u∆ock_node
 (
rm
);

8090 
ri
 = 
rm
->
öfo
;Ñi;Ñòri->
√xt
)

8092 i‡(
hódî
)

8094 
	`rouã_vty_out_dëaû_hódî
 (
vty
, 
bgp
, 
rm
, (
¥efix_rd
 *)&
∫
->
p
,

8095 
AFI_IP
, 
SAFI_MPLS_VPN
);

8097 
hódî
 = 0;

8099 
di•œy
++;

8100 
	`rouã_vty_out_dëaû
 (
vty
, 
bgp
, &
rm
->
p
, 
ri
, 
AFI_IP
, 
SAFI_MPLS_VPN
);

8103 
	`bgp_u∆ock_node
 (
rm
);

8110 
hódî
 = 1;

8112 i‡((
∫
 = 
	`bgp_node_m©ch
 (
rib
, &
m©ch
)Ë!
NULL
)

8114 i‡(! 
¥efix_check
 || 
∫
->
p
.
¥efixÀn
 =
m©ch
.prefixlen)

8116 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

8118 i‡(
hódî
)

8120 
	`rouã_vty_out_dëaû_hódî
 (
vty
, 
bgp
, 
∫
, 
NULL
, 
afi
, 
ßfi
);

8121 
hódî
 = 0;

8123 
di•œy
++;

8124 
	`rouã_vty_out_dëaû
 (
vty
, 
bgp
, &
∫
->
p
, 
ri
, 
afi
, 
ßfi
);

8128 
	`bgp_u∆ock_node
 (
∫
);

8132 i‡(! 
di•œy
)

8134 
	`vty_out
 (
vty
, "%% Nëw‹kÇŸ i¿èbÀ%s", 
VTY_NEWLINE
);

8135  
CMD_WARNING
;

8138  
CMD_SUCCESS
;

8139 
	}
}

8143 
	$bgp_show_rouã
 (
vty
 *vty, c⁄° *
võw_«me
, c⁄° *
ù_°r
,

8144 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
¥efix_rd
 *
¥d
,

8145 
¥efix_check
)

8147 
bgp
 *bgp;

8150 i‡(
võw_«me
)

8152 
bgp
 = 
	`bgp_lookup_by_«me
 (
võw_«me
);

8153 i‡(
bgp
 =
NULL
)

8155 
	`vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
võw_«me
, 
VTY_NEWLINE
);

8156  
CMD_WARNING
;

8161 
bgp
 = 
	`bgp_gë_deÁu…
 ();

8162 i‡(
bgp
 =
NULL
)

8164 
	`vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

8165  
CMD_WARNING
;

8169  
	`bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, bgp->
rib
[
afi
][
ßfi
], 
ù_°r
,

8170 
afi
, 
ßfi
, 
¥d
, 
¥efix_check
);

8171 
	}
}

8174 
DEFUN
 (
show_ù_bgp
,

8175 
show_ù_bgp_cmd
,

8177 
SHOW_STR


8178 
IP_STR


8179 
BGP_STR
)

8181  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
bgp_show_ty≥_n‹mÆ
, NULL);

8184 
DEFUN
 (
show_ù_bgp_ùv4
,

8185 
show_ù_bgp_ùv4_cmd
,

8187 
SHOW_STR


8188 
IP_STR


8189 
BGP_STR


8194 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8195  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
bgp_show_ty≥_n‹mÆ
,

8196 
NULL
);

8198  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
bgp_show_ty≥_n‹mÆ
, NULL);

8201 
ALIAS
 (
show_ù_bgp_ùv4
,

8202 
show_bgp_ùv4_ßfi_cmd
,

8204 
SHOW_STR


8205 
BGP_STR


8210 
DEFUN
 (
show_ù_bgp_rouã
,

8211 
show_ù_bgp_rouã_cmd
,

8213 
SHOW_STR


8214 
IP_STR


8215 
BGP_STR


8218  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, NULL, 0);

8221 
DEFUN
 (
show_ù_bgp_ùv4_rouã
,

8222 
show_ù_bgp_ùv4_rouã_cmd
,

8224 
SHOW_STR


8225 
IP_STR


8226 
BGP_STR


8232 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8233  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MULTICAST
, NULL, 0);

8235  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP
, 
SAFI_UNICAST
, NULL, 0);

8238 
ALIAS
 (
show_ù_bgp_ùv4_rouã
,

8239 
show_bgp_ùv4_ßfi_rouã_cmd
,

8241 
SHOW_STR


8242 
BGP_STR


8248 
DEFUN
 (
show_ù_bgp_v≤v4_Æl_rouã
,

8249 
show_ù_bgp_v≤v4_Æl_rouã_cmd
,

8251 
SHOW_STR


8252 
IP_STR


8253 
BGP_STR


8258  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP
, 
SAFI_MPLS_VPN
, NULL, 0);

8261 
DEFUN
 (
show_ù_bgp_v≤v4_rd_rouã
,

8262 
show_ù_bgp_v≤v4_rd_rouã_cmd
,

8264 
SHOW_STR


8265 
IP_STR


8266 
BGP_STR


8272 
	gªt
;

8273 
¥efix_rd
 
	g¥d
;

8275 
	gªt
 = 
°r2¥efix_rd
 (
¨gv
[0], &
¥d
);

8276 i‡(! 
	gªt
)

8278 
vty_out
 (
vty
, "%% MÆf‹med Rouã Di°öguishî%s", 
VTY_NEWLINE
);

8279  
	gCMD_WARNING
;

8281  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MPLS_VPN
, &
¥d
, 0);

8284 
DEFUN
 (
show_ù_bgp_¥efix
,

8285 
show_ù_bgp_¥efix_cmd
,

8287 
SHOW_STR


8288 
IP_STR


8289 
BGP_STR


8292  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, NULL, 1);

8295 
DEFUN
 (
show_ù_bgp_ùv4_¥efix
,

8296 
show_ù_bgp_ùv4_¥efix_cmd
,

8298 
SHOW_STR


8299 
IP_STR


8300 
BGP_STR


8306 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8307  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MULTICAST
, NULL, 1);

8309  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP
, 
SAFI_UNICAST
, NULL, 1);

8312 
ALIAS
 (
show_ù_bgp_ùv4_¥efix
,

8313 
show_bgp_ùv4_ßfi_¥efix_cmd
,

8315 
SHOW_STR


8316 
BGP_STR


8322 
DEFUN
 (
show_ù_bgp_v≤v4_Æl_¥efix
,

8323 
show_ù_bgp_v≤v4_Æl_¥efix_cmd
,

8325 
SHOW_STR


8326 
IP_STR


8327 
BGP_STR


8332  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP
, 
SAFI_MPLS_VPN
, NULL, 1);

8335 
DEFUN
 (
show_ù_bgp_v≤v4_rd_¥efix
,

8336 
show_ù_bgp_v≤v4_rd_¥efix_cmd
,

8338 
SHOW_STR


8339 
IP_STR


8340 
BGP_STR


8346 
	gªt
;

8347 
¥efix_rd
 
	g¥d
;

8349 
	gªt
 = 
°r2¥efix_rd
 (
¨gv
[0], &
¥d
);

8350 i‡(! 
	gªt
)

8352 
vty_out
 (
vty
, "%% MÆf‹med Rouã Di°öguishî%s", 
VTY_NEWLINE
);

8353  
	gCMD_WARNING
;

8355  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MPLS_VPN
, &
¥d
, 1);

8358 
DEFUN
 (
show_ù_bgp_võw
,

8359 
show_ù_bgp_võw_cmd
,

8361 
SHOW_STR


8362 
IP_STR


8363 
BGP_STR


8367 
bgp
 *
	gbgp
;

8370 
	gbgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

8371 i‡(
	gbgp
 =
NULL
)

8373 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

8374  
	gCMD_WARNING
;

8377  
bgp_show
 (
vty
, 
bgp
, 
AFI_IP
, 
SAFI_UNICAST
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
);

8380 
DEFUN
 (
show_ù_bgp_võw_rouã
,

8381 
show_ù_bgp_võw_rouã_cmd
,

8383 
SHOW_STR


8384 
IP_STR


8385 
BGP_STR


8390  
bgp_show_rouã
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
, 
SAFI_UNICAST
, 
NULL
, 0);

8393 
DEFUN
 (
show_ù_bgp_võw_¥efix
,

8394 
show_ù_bgp_võw_¥efix_cmd
,

8396 
SHOW_STR


8397 
IP_STR


8398 
BGP_STR


8403  
bgp_show_rouã
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
, 
SAFI_UNICAST
, 
NULL
, 1);

8406 #ifde‡
HAVE_IPV6


8407 
DEFUN
 (
show_bgp
,

8408 
show_bgp_cmd
,

8410 
SHOW_STR


8411 
BGP_STR
)

8413  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
bgp_show_ty≥_n‹mÆ
,

8414 
NULL
);

8417 
ALIAS
 (
show_bgp
,

8418 
show_bgp_ùv6_cmd
,

8420 
SHOW_STR


8421 
BGP_STR


8424 
DEFUN
 (
show_bgp_ùv6_ßfi
,

8425 
show_bgp_ùv6_ßfi_cmd
,

8427 
SHOW_STR


8428 
BGP_STR


8433 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8434  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_MULTICAST
, 
bgp_show_ty≥_n‹mÆ
,

8435 
NULL
);

8437  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
bgp_show_ty≥_n‹mÆ
, NULL);

8441 
DEFUN
 (
show_ùv6_bgp
,

8442 
show_ùv6_bgp_cmd
,

8444 
SHOW_STR


8445 
IP_STR


8446 
BGP_STR
)

8448  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
bgp_show_ty≥_n‹mÆ
,

8449 
NULL
);

8452 
DEFUN
 (
show_bgp_rouã
,

8453 
show_bgp_rouã_cmd
,

8455 
SHOW_STR


8456 
BGP_STR


8459  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, NULL, 0);

8462 
ALIAS
 (
show_bgp_rouã
,

8463 
show_bgp_ùv6_rouã_cmd
,

8465 
SHOW_STR


8466 
BGP_STR


8470 
DEFUN
 (
show_bgp_ùv6_ßfi_rouã
,

8471 
show_bgp_ùv6_ßfi_rouã_cmd
,

8473 
SHOW_STR


8474 
BGP_STR


8480 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8481  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP6
, 
SAFI_MULTICAST
, NULL, 0);

8483  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP6
, 
SAFI_UNICAST
, NULL, 0);

8487 
DEFUN
 (
show_ùv6_bgp_rouã
,

8488 
show_ùv6_bgp_rouã_cmd
,

8490 
SHOW_STR


8491 
IP_STR


8492 
BGP_STR


8495  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, NULL, 0);

8498 
DEFUN
 (
show_bgp_¥efix
,

8499 
show_bgp_¥efix_cmd
,

8501 
SHOW_STR


8502 
BGP_STR


8505  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, NULL, 1);

8508 
ALIAS
 (
show_bgp_¥efix
,

8509 
show_bgp_ùv6_¥efix_cmd
,

8511 
SHOW_STR


8512 
BGP_STR


8516 
DEFUN
 (
show_bgp_ùv6_ßfi_¥efix
,

8517 
show_bgp_ùv6_ßfi_¥efix_cmd
,

8519 
SHOW_STR


8520 
BGP_STR


8526 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8527  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP6
, 
SAFI_MULTICAST
, NULL, 1);

8529  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[1], 
AFI_IP6
, 
SAFI_UNICAST
, NULL, 1);

8533 
DEFUN
 (
show_ùv6_bgp_¥efix
,

8534 
show_ùv6_bgp_¥efix_cmd
,

8536 
SHOW_STR


8537 
IP_STR


8538 
BGP_STR


8541  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, NULL, 1);

8544 
DEFUN
 (
show_bgp_võw
,

8545 
show_bgp_võw_cmd
,

8547 
SHOW_STR


8548 
BGP_STR


8552 
bgp
 *
	gbgp
;

8555 
	gbgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

8556 i‡(
	gbgp
 =
NULL
)

8558 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

8559  
	gCMD_WARNING
;

8562  
bgp_show
 (
vty
, 
bgp
, 
AFI_IP6
, 
SAFI_UNICAST
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
);

8565 
ALIAS
 (
show_bgp_võw
,

8566 
show_bgp_võw_ùv6_cmd
,

8568 
SHOW_STR


8569 
BGP_STR


8574 
DEFUN
 (
show_bgp_võw_rouã
,

8575 
show_bgp_võw_rouã_cmd
,

8577 
SHOW_STR


8578 
BGP_STR


8583  
bgp_show_rouã
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
, 
SAFI_UNICAST
, 
NULL
, 0);

8586 
ALIAS
 (
show_bgp_võw_rouã
,

8587 
show_bgp_võw_ùv6_rouã_cmd
,

8589 
SHOW_STR


8590 
BGP_STR


8596 
DEFUN
 (
show_bgp_võw_¥efix
,

8597 
show_bgp_võw_¥efix_cmd
,

8599 
SHOW_STR


8600 
BGP_STR


8605  
bgp_show_rouã
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
, 
SAFI_UNICAST
, 
NULL
, 1);

8608 
ALIAS
 (
show_bgp_võw_¥efix
,

8609 
show_bgp_võw_ùv6_¥efix_cmd
,

8611 
SHOW_STR


8612 
BGP_STR


8619 
DEFUN
 (
show_ùv6_mbgp
,

8620 
show_ùv6_mbgp_cmd
,

8622 
SHOW_STR


8623 
IP_STR


8624 
MBGP_STR
)

8626  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_MULTICAST
, 
bgp_show_ty≥_n‹mÆ
,

8627 
NULL
);

8631 
DEFUN
 (
show_ùv6_mbgp_rouã
,

8632 
show_ùv6_mbgp_rouã_cmd
,

8634 
SHOW_STR


8635 
IP_STR


8636 
MBGP_STR


8639  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_MULTICAST
, NULL, 0);

8643 
DEFUN
 (
show_ùv6_mbgp_¥efix
,

8644 
show_ùv6_mbgp_¥efix_cmd
,

8646 
SHOW_STR


8647 
IP_STR


8648 
MBGP_STR


8651  
bgp_show_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_MULTICAST
, NULL, 1);

8657 
	$bgp_show_ªgexp
 (
vty
 *vty, 
¨gc
, c⁄° **
¨gv
, 
afi_t
 
afi
,

8658 
ßfi_t
 
ßfi
, 
bgp_show_ty≥
 
ty≥
)

8660 
i
;

8661 
buf„r
 *
b
;

8662 *
ªg°r
;

8663 
fú°
;

8664 
ªgex_t
 *
ªgex
;

8665 
rc
;

8667 
fú°
 = 0;

8668 
b
 = 
	`buf„r_√w
 (1024);

8669 
i
 = 0; i < 
¨gc
; i++)

8671 i‡(
fú°
)

8672 
	`buf„r_putc
 (
b
, ' ');

8675 i‡((
	`°rcmp
 (
¨gv
[
i
], "unicast") == 0) || (strcmp (argv[i], "multicast") == 0))

8677 
fú°
 = 1;

8680 
	`buf„r_put°r
 (
b
, 
¨gv
[
i
]);

8682 
	`buf„r_putc
 (
b
, '\0');

8684 
ªg°r
 = 
	`buf„r_gë°r
 (
b
);

8685 
	`buf„r_‰ì
 (
b
);

8687 
ªgex
 = 
	`bgp_ªgcomp
 (
ªg°r
);

8688 
	`XFREE
(
MTYPE_TMP
, 
ªg°r
);

8689 i‡(! 
ªgex
)

8691 
	`vty_out
 (
vty
, "C™'àcompûêªgex∞%s%s", 
¨gv
[0],

8692 
VTY_NEWLINE
);

8693  
CMD_WARNING
;

8696 
rc
 = 
	`bgp_show
 (
vty
, 
NULL
, 
afi
, 
ßfi
, 
ty≥
, 
ªgex
);

8697 
	`bgp_ªgex_‰ì
 (
ªgex
);

8698  
rc
;

8699 
	}
}

8701 
DEFUN
 (
show_ù_bgp_ªgexp
,

8702 
show_ù_bgp_ªgexp_cmd
,

8704 
SHOW_STR


8705 
IP_STR


8706 
BGP_STR


8710  
bgp_show_ªgexp
 (
vty
, 
¨gc
, 
¨gv
, 
AFI_IP
, 
SAFI_UNICAST
,

8711 
bgp_show_ty≥_ªgexp
);

8714 
DEFUN
 (
show_ù_bgp_Ê≠_ªgexp
,

8715 
show_ù_bgp_Ê≠_ªgexp_cmd
,

8717 
SHOW_STR


8718 
IP_STR


8719 
BGP_STR


8724  
bgp_show_ªgexp
 (
vty
, 
¨gc
, 
¨gv
, 
AFI_IP
, 
SAFI_UNICAST
,

8725 
bgp_show_ty≥_Ê≠_ªgexp
);

8728 
DEFUN
 (
show_ù_bgp_ùv4_ªgexp
,

8729 
show_ù_bgp_ùv4_ªgexp_cmd
,

8731 
SHOW_STR


8732 
IP_STR


8733 
BGP_STR


8740 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8741  
bgp_show_ªgexp
 (
vty
, 
¨gc
, 
¨gv
, 
AFI_IP
, 
SAFI_MULTICAST
,

8742 
bgp_show_ty≥_ªgexp
);

8744  
bgp_show_ªgexp
 (
vty
, 
¨gc
, 
¨gv
, 
AFI_IP
, 
SAFI_UNICAST
,

8745 
bgp_show_ty≥_ªgexp
);

8748 #ifde‡
HAVE_IPV6


8749 
DEFUN
 (
show_bgp_ªgexp
,

8750 
show_bgp_ªgexp_cmd
,

8752 
SHOW_STR


8753 
BGP_STR


8757  
bgp_show_ªgexp
 (
vty
, 
¨gc
, 
¨gv
, 
AFI_IP6
, 
SAFI_UNICAST
,

8758 
bgp_show_ty≥_ªgexp
);

8761 
ALIAS
 (
show_bgp_ªgexp
,

8762 
show_bgp_ùv6_ªgexp_cmd
,

8764 
SHOW_STR


8765 
BGP_STR


8771 
DEFUN
 (
show_ùv6_bgp_ªgexp
,

8772 
show_ùv6_bgp_ªgexp_cmd
,

8774 
SHOW_STR


8775 
IP_STR


8776 
BGP_STR


8780  
bgp_show_ªgexp
 (
vty
, 
¨gc
, 
¨gv
, 
AFI_IP6
, 
SAFI_UNICAST
,

8781 
bgp_show_ty≥_ªgexp
);

8785 
DEFUN
 (
show_ùv6_mbgp_ªgexp
,

8786 
show_ùv6_mbgp_ªgexp_cmd
,

8788 
SHOW_STR


8789 
IP_STR


8790 
BGP_STR


8794  
bgp_show_ªgexp
 (
vty
, 
¨gc
, 
¨gv
, 
AFI_IP6
, 
SAFI_MULTICAST
,

8795 
bgp_show_ty≥_ªgexp
);

8800 
	$bgp_show_¥efix_li°
 (
vty
 *vty, c⁄° *
¥efix_li°_°r
, 
afi_t
 
afi
,

8801 
ßfi_t
 
ßfi
, 
bgp_show_ty≥
 
ty≥
)

8803 
¥efix_li°
 *
∂i°
;

8805 
∂i°
 = 
	`¥efix_li°_lookup
 (
afi
, 
¥efix_li°_°r
);

8806 i‡(
∂i°
 =
NULL
)

8808 
	`vty_out
 (
vty
, "%% %s isÇotá validÖrefix-listÇame%s",

8809 
¥efix_li°_°r
, 
VTY_NEWLINE
);

8810  
CMD_WARNING
;

8813  
	`bgp_show
 (
vty
, 
NULL
, 
afi
, 
ßfi
, 
ty≥
, 
∂i°
);

8814 
	}
}

8816 
DEFUN
 (
show_ù_bgp_¥efix_li°
,

8817 
show_ù_bgp_¥efix_li°_cmd
,

8819 
SHOW_STR


8820 
IP_STR


8821 
BGP_STR


8825  
bgp_show_¥efix_li°
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

8826 
bgp_show_ty≥_¥efix_li°
);

8829 
DEFUN
 (
show_ù_bgp_Ê≠_¥efix_li°
,

8830 
show_ù_bgp_Ê≠_¥efix_li°_cmd
,

8832 
SHOW_STR


8833 
IP_STR


8834 
BGP_STR


8839  
bgp_show_¥efix_li°
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

8840 
bgp_show_ty≥_Ê≠_¥efix_li°
);

8843 
DEFUN
 (
show_ù_bgp_ùv4_¥efix_li°
,

8844 
show_ù_bgp_ùv4_¥efix_li°_cmd
,

8846 
SHOW_STR


8847 
IP_STR


8848 
BGP_STR


8855 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8856  
bgp_show_¥efix_li°
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MULTICAST
,

8857 
bgp_show_ty≥_¥efix_li°
);

8859  
bgp_show_¥efix_li°
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_UNICAST
,

8860 
bgp_show_ty≥_¥efix_li°
);

8863 #ifde‡
HAVE_IPV6


8864 
DEFUN
 (
show_bgp_¥efix_li°
,

8865 
show_bgp_¥efix_li°_cmd
,

8867 
SHOW_STR


8868 
BGP_STR


8872  
bgp_show_¥efix_li°
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

8873 
bgp_show_ty≥_¥efix_li°
);

8876 
ALIAS
 (
show_bgp_¥efix_li°
,

8877 
show_bgp_ùv6_¥efix_li°_cmd
,

8879 
SHOW_STR


8880 
BGP_STR


8886 
DEFUN
 (
show_ùv6_bgp_¥efix_li°
,

8887 
show_ùv6_bgp_¥efix_li°_cmd
,

8889 
SHOW_STR


8890 
IPV6_STR


8891 
BGP_STR


8895  
bgp_show_¥efix_li°
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

8896 
bgp_show_ty≥_¥efix_li°
);

8900 
DEFUN
 (
show_ùv6_mbgp_¥efix_li°
,

8901 
show_ùv6_mbgp_¥efix_li°_cmd
,

8903 
SHOW_STR


8904 
IPV6_STR


8905 
MBGP_STR


8909  
bgp_show_¥efix_li°
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_MULTICAST
,

8910 
bgp_show_ty≥_¥efix_li°
);

8915 
	$bgp_show_fûãr_li°
 (
vty
 *vty, c⁄° *
fûãr
, 
afi_t
 
afi
,

8916 
ßfi_t
 
ßfi
, 
bgp_show_ty≥
 
ty≥
)

8918 
as_li°
 *as_list;

8920 
as_li°
 = 
	`as_li°_lookup
 (
fûãr
);

8921 i‡(
as_li°
 =
NULL
)

8923 
	`vty_out
 (
vty
, "%% %†i†nŸá vÆid AS-∑thác˚ss-li°Çame%s", 
fûãr
, 
VTY_NEWLINE
);

8924  
CMD_WARNING
;

8927  
	`bgp_show
 (
vty
, 
NULL
, 
afi
, 
ßfi
, 
ty≥
, 
as_li°
);

8928 
	}
}

8930 
DEFUN
 (
show_ù_bgp_fûãr_li°
,

8931 
show_ù_bgp_fûãr_li°_cmd
,

8933 
SHOW_STR


8934 
IP_STR


8935 
BGP_STR


8939  
bgp_show_fûãr_li°
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

8940 
bgp_show_ty≥_fûãr_li°
);

8943 
DEFUN
 (
show_ù_bgp_Ê≠_fûãr_li°
,

8944 
show_ù_bgp_Ê≠_fûãr_li°_cmd
,

8946 
SHOW_STR


8947 
IP_STR


8948 
BGP_STR


8953  
bgp_show_fûãr_li°
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

8954 
bgp_show_ty≥_Ê≠_fûãr_li°
);

8957 
DEFUN
 (
show_ù_bgp_ùv4_fûãr_li°
,

8958 
show_ù_bgp_ùv4_fûãr_li°_cmd
,

8960 
SHOW_STR


8961 
IP_STR


8962 
BGP_STR


8969 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8970  
bgp_show_fûãr_li°
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MULTICAST
,

8971 
bgp_show_ty≥_fûãr_li°
);

8973  
bgp_show_fûãr_li°
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_UNICAST
,

8974 
bgp_show_ty≥_fûãr_li°
);

8977 #ifde‡
HAVE_IPV6


8978 
DEFUN
 (
show_bgp_fûãr_li°
,

8979 
show_bgp_fûãr_li°_cmd
,

8981 
SHOW_STR


8982 
BGP_STR


8986  
bgp_show_fûãr_li°
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

8987 
bgp_show_ty≥_fûãr_li°
);

8990 
ALIAS
 (
show_bgp_fûãr_li°
,

8991 
show_bgp_ùv6_fûãr_li°_cmd
,

8993 
SHOW_STR


8994 
BGP_STR


9000 
DEFUN
 (
show_ùv6_bgp_fûãr_li°
,

9001 
show_ùv6_bgp_fûãr_li°_cmd
,

9003 
SHOW_STR


9004 
IPV6_STR


9005 
BGP_STR


9009  
bgp_show_fûãr_li°
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

9010 
bgp_show_ty≥_fûãr_li°
);

9014 
DEFUN
 (
show_ùv6_mbgp_fûãr_li°
,

9015 
show_ùv6_mbgp_fûãr_li°_cmd
,

9017 
SHOW_STR


9018 
IPV6_STR


9019 
MBGP_STR


9023  
bgp_show_fûãr_li°
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_MULTICAST
,

9024 
bgp_show_ty≥_fûãr_li°
);

9029 
	$bgp_show_rouã_m≠
 (
vty
 *vty, c⁄° *
rm≠_°r
, 
afi_t
 
afi
,

9030 
ßfi_t
 
ßfi
, 
bgp_show_ty≥
 
ty≥
)

9032 
rouã_m≠
 *
rm≠
;

9034 
rm≠
 = 
	`rouã_m≠_lookup_by_«me
 (
rm≠_°r
);

9035 i‡(! 
rm≠
)

9037 
	`vty_out
 (
vty
, "%% %s isÇotá validÑoute-mapÇame%s",

9038 
rm≠_°r
, 
VTY_NEWLINE
);

9039  
CMD_WARNING
;

9042  
	`bgp_show
 (
vty
, 
NULL
, 
afi
, 
ßfi
, 
ty≥
, 
rm≠
);

9043 
	}
}

9045 
DEFUN
 (
show_ù_bgp_rouã_m≠
,

9046 
show_ù_bgp_rouã_m≠_cmd
,

9048 
SHOW_STR


9049 
IP_STR


9050 
BGP_STR


9054  
bgp_show_rouã_m≠
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

9055 
bgp_show_ty≥_rouã_m≠
);

9058 
DEFUN
 (
show_ù_bgp_Ê≠_rouã_m≠
,

9059 
show_ù_bgp_Ê≠_rouã_m≠_cmd
,

9061 
SHOW_STR


9062 
IP_STR


9063 
BGP_STR


9068  
bgp_show_rouã_m≠
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

9069 
bgp_show_ty≥_Ê≠_rouã_m≠
);

9072 
DEFUN
 (
show_ù_bgp_ùv4_rouã_m≠
,

9073 
show_ù_bgp_ùv4_rouã_m≠_cmd
,

9075 
SHOW_STR


9076 
IP_STR


9077 
BGP_STR


9084 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

9085  
bgp_show_rouã_m≠
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MULTICAST
,

9086 
bgp_show_ty≥_rouã_m≠
);

9088  
bgp_show_rouã_m≠
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_UNICAST
,

9089 
bgp_show_ty≥_rouã_m≠
);

9092 
DEFUN
 (
show_bgp_rouã_m≠
,

9093 
show_bgp_rouã_m≠_cmd
,

9095 
SHOW_STR


9096 
BGP_STR


9100  
bgp_show_rouã_m≠
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

9101 
bgp_show_ty≥_rouã_m≠
);

9104 
ALIAS
 (
show_bgp_rouã_m≠
,

9105 
show_bgp_ùv6_rouã_m≠_cmd
,

9107 
SHOW_STR


9108 
BGP_STR


9113 
DEFUN
 (
show_ù_bgp_cidr_⁄ly
,

9114 
show_ù_bgp_cidr_⁄ly_cmd
,

9116 
SHOW_STR


9117 
IP_STR


9118 
BGP_STR


9121  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
,

9122 
bgp_show_ty≥_cidr_⁄ly
, 
NULL
);

9125 
DEFUN
 (
show_ù_bgp_Ê≠_cidr_⁄ly
,

9126 
show_ù_bgp_Ê≠_cidr_⁄ly_cmd
,

9128 
SHOW_STR


9129 
IP_STR


9130 
BGP_STR


9134  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
,

9135 
bgp_show_ty≥_Ê≠_cidr_⁄ly
, 
NULL
);

9138 
DEFUN
 (
show_ù_bgp_ùv4_cidr_⁄ly
,

9139 
show_ù_bgp_ùv4_cidr_⁄ly_cmd
,

9141 
SHOW_STR


9142 
IP_STR


9143 
BGP_STR


9149 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

9150  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
,

9151 
bgp_show_ty≥_cidr_⁄ly
, 
NULL
);

9153  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
,

9154 
bgp_show_ty≥_cidr_⁄ly
, 
NULL
);

9157 
DEFUN
 (
show_ù_bgp_communôy_Æl
,

9158 
show_ù_bgp_communôy_Æl_cmd
,

9160 
SHOW_STR


9161 
IP_STR


9162 
BGP_STR


9165  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
,

9166 
bgp_show_ty≥_communôy_Æl
, 
NULL
);

9169 
DEFUN
 (
show_ù_bgp_ùv4_communôy_Æl
,

9170 
show_ù_bgp_ùv4_communôy_Æl_cmd
,

9172 
SHOW_STR


9173 
IP_STR


9174 
BGP_STR


9180 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

9181  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
,

9182 
bgp_show_ty≥_communôy_Æl
, 
NULL
);

9184  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
,

9185 
bgp_show_ty≥_communôy_Æl
, 
NULL
);

9188 #ifde‡
HAVE_IPV6


9189 
DEFUN
 (
show_bgp_communôy_Æl
,

9190 
show_bgp_communôy_Æl_cmd
,

9192 
SHOW_STR


9193 
BGP_STR


9196  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
,

9197 
bgp_show_ty≥_communôy_Æl
, 
NULL
);

9200 
ALIAS
 (
show_bgp_communôy_Æl
,

9201 
show_bgp_ùv6_communôy_Æl_cmd
,

9203 
SHOW_STR


9204 
BGP_STR


9209 
DEFUN
 (
show_ùv6_bgp_communôy_Æl
,

9210 
show_ùv6_bgp_communôy_Æl_cmd
,

9212 
SHOW_STR


9213 
IPV6_STR


9214 
BGP_STR


9217  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
,

9218 
bgp_show_ty≥_communôy_Æl
, 
NULL
);

9222 
DEFUN
 (
show_ùv6_mbgp_communôy_Æl
,

9223 
show_ùv6_mbgp_communôy_Æl_cmd
,

9225 
SHOW_STR


9226 
IPV6_STR


9227 
MBGP_STR


9230  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_MULTICAST
,

9231 
bgp_show_ty≥_communôy_Æl
, 
NULL
);

9236 
	$bgp_show_communôy
 (
vty
 *vty, c⁄° *
võw_«me
, 
¨gc
,

9237 c⁄° **
¨gv
, 
exa˘
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

9239 
communôy
 *
com
;

9240 
buf„r
 *
b
;

9241 
bgp
 *bgp;

9242 
i
;

9243 *
°r
;

9244 
fú°
 = 0;

9247 i‡(
võw_«me
)

9249 
bgp
 = 
	`bgp_lookup_by_«me
 (
võw_«me
);

9250 i‡(
bgp
 =
NULL
)

9252 
	`vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
võw_«me
, 
VTY_NEWLINE
);

9253  
CMD_WARNING
;

9258 
bgp
 = 
	`bgp_gë_deÁu…
 ();

9259 i‡(
bgp
 =
NULL
)

9261 
	`vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

9262  
CMD_WARNING
;

9266 
b
 = 
	`buf„r_√w
 (1024);

9267 
i
 = 0; i < 
¨gc
; i++)

9269 i‡(
fú°
)

9270 
	`buf„r_putc
 (
b
, ' ');

9273 i‡((
	`°rcmp
 (
¨gv
[
i
], "unicast") == 0) || (strcmp (argv[i], "multicast") == 0))

9275 
fú°
 = 1;

9278 
	`buf„r_put°r
 (
b
, 
¨gv
[
i
]);

9280 
	`buf„r_putc
 (
b
, '\0');

9282 
°r
 = 
	`buf„r_gë°r
 (
b
);

9283 
	`buf„r_‰ì
 (
b
);

9285 
com
 = 
	`communôy_°r2com
 (
°r
);

9286 
	`XFREE
 (
MTYPE_TMP
, 
°r
);

9287 i‡(! 
com
)

9289 
	`vty_out
 (
vty
, "%% Communôy mÆf‹med: %s", 
VTY_NEWLINE
);

9290  
CMD_WARNING
;

9293  
	`bgp_show
 (
vty
, 
bgp
, 
afi
, 
ßfi
,

9294 (
exa˘
 ? 
bgp_show_ty≥_communôy_exa˘
 :

9295 
bgp_show_ty≥_communôy
), 
com
);

9296 
	}
}

9298 
DEFUN
 (
show_ù_bgp_communôy
,

9299 
show_ù_bgp_communôy_cmd
,

9301 
SHOW_STR


9302 
IP_STR


9303 
BGP_STR


9310  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 0, 
AFI_IP
, 
SAFI_UNICAST
);

9313 
ALIAS
 (
show_ù_bgp_communôy
,

9314 
show_ù_bgp_communôy2_cmd
,

9316 
SHOW_STR


9317 
IP_STR


9318 
BGP_STR


9329 
ALIAS
 (
show_ù_bgp_communôy
,

9330 
show_ù_bgp_communôy3_cmd
,

9332 
SHOW_STR


9333 
IP_STR


9334 
BGP_STR


9349 
ALIAS
 (
show_ù_bgp_communôy
,

9350 
show_ù_bgp_communôy4_cmd
,

9352 
SHOW_STR


9353 
IP_STR


9354 
BGP_STR


9373 
DEFUN
 (
show_ù_bgp_ùv4_communôy
,

9374 
show_ù_bgp_ùv4_communôy_cmd
,

9376 
SHOW_STR


9377 
IP_STR


9378 
BGP_STR


9388 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

9389  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 0, 
AFI_IP
, 
SAFI_MULTICAST
);

9391  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 0, 
AFI_IP
, 
SAFI_UNICAST
);

9394 
ALIAS
 (
show_ù_bgp_ùv4_communôy
,

9395 
show_ù_bgp_ùv4_communôy2_cmd
,

9397 
SHOW_STR


9398 
IP_STR


9399 
BGP_STR


9413 
ALIAS
 (
show_ù_bgp_ùv4_communôy
,

9414 
show_ù_bgp_ùv4_communôy3_cmd
,

9416 
SHOW_STR


9417 
IP_STR


9418 
BGP_STR


9436 
ALIAS
 (
show_ù_bgp_ùv4_communôy
,

9437 
show_ù_bgp_ùv4_communôy4_cmd
,

9439 
SHOW_STR


9440 
IP_STR


9441 
BGP_STR


9463 
DEFUN
 (
show_bgp_võw_afi_ßfi_communôy_Æl
,

9464 
show_bgp_võw_afi_ßfi_communôy_Æl_cmd
,

9465 #ifde‡
HAVE_IPV6


9470 
SHOW_STR


9471 
BGP_STR


9475 #ifde‡
HAVE_IPV6


9482 
	gafi
;

9483 
	gßfi
;

9484 
bgp
 *
	gbgp
;

9487 
	gbgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

9488 i‡(
	gbgp
 =
NULL
)

9490 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

9491  
	gCMD_WARNING
;

9494 #ifde‡
HAVE_IPV6


9495 
	gafi
 = (
°∫cmp
 (
¨gv
[1], "ùv6", 4Ë=0Ë? 
AFI_IP6
 : 
AFI_IP
;

9496 
	gßfi
 = (
°∫cmp
 (
¨gv
[2], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9498 
	gafi
 = 
AFI_IP
;

9499 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9501  
bgp_show
 (
vty
, 
bgp
, 
afi
, 
ßfi
, 
bgp_show_ty≥_communôy_Æl
, 
NULL
);

9504 
DEFUN
 (
show_bgp_võw_afi_ßfi_communôy
,

9505 
show_bgp_võw_afi_ßfi_communôy_cmd
,

9506 #ifde‡
HAVE_IPV6


9511 
SHOW_STR


9512 
BGP_STR


9516 #ifde‡
HAVE_IPV6


9527 
	gafi
;

9528 
	gßfi
;

9530 #ifde‡
HAVE_IPV6


9531 
	gafi
 = (
°∫cmp
 (
¨gv
[1], "ùv6", 4Ë=0Ë? 
AFI_IP6
 : 
AFI_IP
;

9532 
	gßfi
 = (
°∫cmp
 (
¨gv
[2], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9533  
bgp_show_communôy
 (
vty
, 
¨gv
[0], 
¨gc
-3, &¨gv[3], 0, 
afi
, 
ßfi
);

9535 
	gafi
 = 
AFI_IP
;

9536 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9537  
bgp_show_communôy
 (
vty
, 
¨gv
[0], 
¨gc
-2, &¨gv[2], 0, 
afi
, 
ßfi
);

9541 
ALIAS
 (
show_bgp_võw_afi_ßfi_communôy
,

9542 
show_bgp_võw_afi_ßfi_communôy2_cmd
,

9543 #ifde‡
HAVE_IPV6


9548 
SHOW_STR


9549 
BGP_STR


9553 #ifde‡
HAVE_IPV6


9568 
ALIAS
 (
show_bgp_võw_afi_ßfi_communôy
,

9569 
show_bgp_võw_afi_ßfi_communôy3_cmd
,

9570 #ifde‡
HAVE_IPV6


9575 
SHOW_STR


9576 
BGP_STR


9580 #ifde‡
HAVE_IPV6


9599 
ALIAS
 (
show_bgp_võw_afi_ßfi_communôy
,

9600 
show_bgp_võw_afi_ßfi_communôy4_cmd
,

9601 #ifde‡
HAVE_IPV6


9606 
SHOW_STR


9607 
BGP_STR


9611 #ifde‡
HAVE_IPV6


9634 
DEFUN
 (
show_ù_bgp_communôy_exa˘
,

9635 
show_ù_bgp_communôy_exa˘_cmd
,

9637 
SHOW_STR


9638 
IP_STR


9639 
BGP_STR


9647  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 1, 
AFI_IP
, 
SAFI_UNICAST
);

9650 
ALIAS
 (
show_ù_bgp_communôy_exa˘
,

9651 
show_ù_bgp_communôy2_exa˘_cmd
,

9653 
SHOW_STR


9654 
IP_STR


9655 
BGP_STR


9667 
ALIAS
 (
show_ù_bgp_communôy_exa˘
,

9668 
show_ù_bgp_communôy3_exa˘_cmd
,

9670 
SHOW_STR


9671 
IP_STR


9672 
BGP_STR


9688 
ALIAS
 (
show_ù_bgp_communôy_exa˘
,

9689 
show_ù_bgp_communôy4_exa˘_cmd
,

9691 
SHOW_STR


9692 
IP_STR


9693 
BGP_STR


9713 
DEFUN
 (
show_ù_bgp_ùv4_communôy_exa˘
,

9714 
show_ù_bgp_ùv4_communôy_exa˘_cmd
,

9716 
SHOW_STR


9717 
IP_STR


9718 
BGP_STR


9729 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

9730  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 1, 
AFI_IP
, 
SAFI_MULTICAST
);

9732  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 1, 
AFI_IP
, 
SAFI_UNICAST
);

9735 
ALIAS
 (
show_ù_bgp_ùv4_communôy_exa˘
,

9736 
show_ù_bgp_ùv4_communôy2_exa˘_cmd
,

9738 
SHOW_STR


9739 
IP_STR


9740 
BGP_STR


9755 
ALIAS
 (
show_ù_bgp_ùv4_communôy_exa˘
,

9756 
show_ù_bgp_ùv4_communôy3_exa˘_cmd
,

9758 
SHOW_STR


9759 
IP_STR


9760 
BGP_STR


9779 
ALIAS
 (
show_ù_bgp_ùv4_communôy_exa˘
,

9780 
show_ù_bgp_ùv4_communôy4_exa˘_cmd
,

9782 
SHOW_STR


9783 
IP_STR


9784 
BGP_STR


9807 #ifde‡
HAVE_IPV6


9808 
DEFUN
 (
show_bgp_communôy
,

9809 
show_bgp_communôy_cmd
,

9811 
SHOW_STR


9812 
BGP_STR


9819  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 0, 
AFI_IP6
, 
SAFI_UNICAST
);

9822 
ALIAS
 (
show_bgp_communôy
,

9823 
show_bgp_ùv6_communôy_cmd
,

9825 
SHOW_STR


9826 
BGP_STR


9834 
ALIAS
 (
show_bgp_communôy
,

9835 
show_bgp_communôy2_cmd
,

9837 
SHOW_STR


9838 
BGP_STR


9849 
ALIAS
 (
show_bgp_communôy
,

9850 
show_bgp_ùv6_communôy2_cmd
,

9852 
SHOW_STR


9853 
BGP_STR


9865 
ALIAS
 (
show_bgp_communôy
,

9866 
show_bgp_communôy3_cmd
,

9868 
SHOW_STR


9869 
BGP_STR


9884 
ALIAS
 (
show_bgp_communôy
,

9885 
show_bgp_ùv6_communôy3_cmd
,

9887 
SHOW_STR


9888 
BGP_STR


9904 
ALIAS
 (
show_bgp_communôy
,

9905 
show_bgp_communôy4_cmd
,

9907 
SHOW_STR


9908 
BGP_STR


9927 
ALIAS
 (
show_bgp_communôy
,

9928 
show_bgp_ùv6_communôy4_cmd
,

9930 
SHOW_STR


9931 
BGP_STR


9952 
DEFUN
 (
show_ùv6_bgp_communôy
,

9953 
show_ùv6_bgp_communôy_cmd
,

9955 
SHOW_STR


9956 
IPV6_STR


9957 
BGP_STR


9964  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 0, 
AFI_IP6
, 
SAFI_UNICAST
);

9968 
ALIAS
 (
show_ùv6_bgp_communôy
,

9969 
show_ùv6_bgp_communôy2_cmd
,

9971 
SHOW_STR


9972 
IPV6_STR


9973 
BGP_STR


9985 
ALIAS
 (
show_ùv6_bgp_communôy
,

9986 
show_ùv6_bgp_communôy3_cmd
,

9988 
SHOW_STR


9989 
IPV6_STR


9990 
BGP_STR


10006 
ALIAS
 (
show_ùv6_bgp_communôy
,

10007 
show_ùv6_bgp_communôy4_cmd
,

10009 
SHOW_STR


10010 
IPV6_STR


10011 
BGP_STR


10030 
DEFUN
 (
show_bgp_communôy_exa˘
,

10031 
show_bgp_communôy_exa˘_cmd
,

10033 
SHOW_STR


10034 
BGP_STR


10042  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 1, 
AFI_IP6
, 
SAFI_UNICAST
);

10045 
ALIAS
 (
show_bgp_communôy_exa˘
,

10046 
show_bgp_ùv6_communôy_exa˘_cmd
,

10048 
SHOW_STR


10049 
BGP_STR


10058 
ALIAS
 (
show_bgp_communôy_exa˘
,

10059 
show_bgp_communôy2_exa˘_cmd
,

10061 
SHOW_STR


10062 
BGP_STR


10074 
ALIAS
 (
show_bgp_communôy_exa˘
,

10075 
show_bgp_ùv6_communôy2_exa˘_cmd
,

10077 
SHOW_STR


10078 
BGP_STR


10091 
ALIAS
 (
show_bgp_communôy_exa˘
,

10092 
show_bgp_communôy3_exa˘_cmd
,

10094 
SHOW_STR


10095 
BGP_STR


10111 
ALIAS
 (
show_bgp_communôy_exa˘
,

10112 
show_bgp_ùv6_communôy3_exa˘_cmd
,

10114 
SHOW_STR


10115 
BGP_STR


10132 
ALIAS
 (
show_bgp_communôy_exa˘
,

10133 
show_bgp_communôy4_exa˘_cmd
,

10135 
SHOW_STR


10136 
BGP_STR


10156 
ALIAS
 (
show_bgp_communôy_exa˘
,

10157 
show_bgp_ùv6_communôy4_exa˘_cmd
,

10159 
SHOW_STR


10160 
BGP_STR


10182 
DEFUN
 (
show_ùv6_bgp_communôy_exa˘
,

10183 
show_ùv6_bgp_communôy_exa˘_cmd
,

10185 
SHOW_STR


10186 
IPV6_STR


10187 
BGP_STR


10195  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 1, 
AFI_IP6
, 
SAFI_UNICAST
);

10199 
ALIAS
 (
show_ùv6_bgp_communôy_exa˘
,

10200 
show_ùv6_bgp_communôy2_exa˘_cmd
,

10202 
SHOW_STR


10203 
IPV6_STR


10204 
BGP_STR


10217 
ALIAS
 (
show_ùv6_bgp_communôy_exa˘
,

10218 
show_ùv6_bgp_communôy3_exa˘_cmd
,

10220 
SHOW_STR


10221 
IPV6_STR


10222 
BGP_STR


10239 
ALIAS
 (
show_ùv6_bgp_communôy_exa˘
,

10240 
show_ùv6_bgp_communôy4_exa˘_cmd
,

10242 
SHOW_STR


10243 
IPV6_STR


10244 
BGP_STR


10265 
DEFUN
 (
show_ùv6_mbgp_communôy
,

10266 
show_ùv6_mbgp_communôy_cmd
,

10268 
SHOW_STR


10269 
IPV6_STR


10270 
MBGP_STR


10277  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 0, 
AFI_IP6
, 
SAFI_MULTICAST
);

10281 
ALIAS
 (
show_ùv6_mbgp_communôy
,

10282 
show_ùv6_mbgp_communôy2_cmd
,

10284 
SHOW_STR


10285 
IPV6_STR


10286 
MBGP_STR


10298 
ALIAS
 (
show_ùv6_mbgp_communôy
,

10299 
show_ùv6_mbgp_communôy3_cmd
,

10301 
SHOW_STR


10302 
IPV6_STR


10303 
MBGP_STR


10319 
ALIAS
 (
show_ùv6_mbgp_communôy
,

10320 
show_ùv6_mbgp_communôy4_cmd
,

10322 
SHOW_STR


10323 
IPV6_STR


10324 
MBGP_STR


10344 
DEFUN
 (
show_ùv6_mbgp_communôy_exa˘
,

10345 
show_ùv6_mbgp_communôy_exa˘_cmd
,

10347 
SHOW_STR


10348 
IPV6_STR


10349 
MBGP_STR


10357  
bgp_show_communôy
 (
vty
, 
NULL
, 
¨gc
, 
¨gv
, 1, 
AFI_IP6
, 
SAFI_MULTICAST
);

10361 
ALIAS
 (
show_ùv6_mbgp_communôy_exa˘
,

10362 
show_ùv6_mbgp_communôy2_exa˘_cmd
,

10364 
SHOW_STR


10365 
IPV6_STR


10366 
MBGP_STR


10379 
ALIAS
 (
show_ùv6_mbgp_communôy_exa˘
,

10380 
show_ùv6_mbgp_communôy3_exa˘_cmd
,

10382 
SHOW_STR


10383 
IPV6_STR


10384 
MBGP_STR


10401 
ALIAS
 (
show_ùv6_mbgp_communôy_exa˘
,

10402 
show_ùv6_mbgp_communôy4_exa˘_cmd
,

10404 
SHOW_STR


10405 
IPV6_STR


10406 
MBGP_STR


10428 
	$bgp_show_communôy_li°
 (
vty
 *vty, c⁄° *
com
, 
exa˘
,

10429 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

10431 
communôy_li°
 *
li°
;

10433 
li°
 = 
	`communôy_li°_lookup
 (
bgp_˛i°
, 
com
, 
COMMUNITY_LIST_MASTER
);

10434 i‡(
li°
 =
NULL
)

10436 
	`vty_out
 (
vty
, "%% %†i†nŸá vÆid communôy-li°Çame%s", 
com
,

10437 
VTY_NEWLINE
);

10438  
CMD_WARNING
;

10441  
	`bgp_show
 (
vty
, 
NULL
, 
afi
, 
ßfi
,

10442 (
exa˘
 ? 
bgp_show_ty≥_communôy_li°_exa˘
 :

10443 
bgp_show_ty≥_communôy_li°
), 
li°
);

10444 
	}
}

10446 
DEFUN
 (
show_ù_bgp_communôy_li°
,

10447 
show_ù_bgp_communôy_li°_cmd
,

10449 
SHOW_STR


10450 
IP_STR


10451 
BGP_STR


10456  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 0, 
AFI_IP
, 
SAFI_UNICAST
);

10459 
DEFUN
 (
show_ù_bgp_ùv4_communôy_li°
,

10460 
show_ù_bgp_ùv4_communôy_li°_cmd
,

10462 
SHOW_STR


10463 
IP_STR


10464 
BGP_STR


10472 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

10473  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[1], 0, 
AFI_IP
, 
SAFI_MULTICAST
);

10475  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[1], 0, 
AFI_IP
, 
SAFI_UNICAST
);

10478 
DEFUN
 (
show_ù_bgp_communôy_li°_exa˘
,

10479 
show_ù_bgp_communôy_li°_exa˘_cmd
,

10481 
SHOW_STR


10482 
IP_STR


10483 
BGP_STR


10489  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 1, 
AFI_IP
, 
SAFI_UNICAST
);

10492 
DEFUN
 (
show_ù_bgp_ùv4_communôy_li°_exa˘
,

10493 
show_ù_bgp_ùv4_communôy_li°_exa˘_cmd
,

10495 
SHOW_STR


10496 
IP_STR


10497 
BGP_STR


10506 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

10507  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[1], 1, 
AFI_IP
, 
SAFI_MULTICAST
);

10509  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[1], 1, 
AFI_IP
, 
SAFI_UNICAST
);

10512 #ifde‡
HAVE_IPV6


10513 
DEFUN
 (
show_bgp_communôy_li°
,

10514 
show_bgp_communôy_li°_cmd
,

10516 
SHOW_STR


10517 
BGP_STR


10522  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 0, 
AFI_IP6
, 
SAFI_UNICAST
);

10525 
ALIAS
 (
show_bgp_communôy_li°
,

10526 
show_bgp_ùv6_communôy_li°_cmd
,

10528 
SHOW_STR


10529 
BGP_STR


10536 
DEFUN
 (
show_ùv6_bgp_communôy_li°
,

10537 
show_ùv6_bgp_communôy_li°_cmd
,

10539 
SHOW_STR


10540 
IPV6_STR


10541 
BGP_STR


10545  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 0, 
AFI_IP6
, 
SAFI_UNICAST
);

10549 
DEFUN
 (
show_ùv6_mbgp_communôy_li°
,

10550 
show_ùv6_mbgp_communôy_li°_cmd
,

10552 
SHOW_STR


10553 
IPV6_STR


10554 
MBGP_STR


10558  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 0, 
AFI_IP6
, 
SAFI_MULTICAST
);

10561 
DEFUN
 (
show_bgp_communôy_li°_exa˘
,

10562 
show_bgp_communôy_li°_exa˘_cmd
,

10564 
SHOW_STR


10565 
BGP_STR


10571  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 1, 
AFI_IP6
, 
SAFI_UNICAST
);

10574 
ALIAS
 (
show_bgp_communôy_li°_exa˘
,

10575 
show_bgp_ùv6_communôy_li°_exa˘_cmd
,

10577 
SHOW_STR


10578 
BGP_STR


10586 
DEFUN
 (
show_ùv6_bgp_communôy_li°_exa˘
,

10587 
show_ùv6_bgp_communôy_li°_exa˘_cmd
,

10589 
SHOW_STR


10590 
IPV6_STR


10591 
BGP_STR


10596  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 1, 
AFI_IP6
, 
SAFI_UNICAST
);

10600 
DEFUN
 (
show_ùv6_mbgp_communôy_li°_exa˘
,

10601 
show_ùv6_mbgp_communôy_li°_exa˘_cmd
,

10603 
SHOW_STR


10604 
IPV6_STR


10605 
MBGP_STR


10610  
bgp_show_communôy_li°
 (
vty
, 
¨gv
[0], 1, 
AFI_IP6
, 
SAFI_MULTICAST
);

10615 
	$bgp_show_¥efix_l⁄gî
 (
vty
 *vty, c⁄° *
¥efix
, 
afi_t
 
afi
,

10616 
ßfi_t
 
ßfi
, 
bgp_show_ty≥
 
ty≥
)

10618 
ªt
;

10619 
¥efix
 *
p
;

10621 
p
 = 
	`¥efix_√w
();

10623 
ªt
 = 
	`°r2¥efix
 (
¥efix
, 
p
);

10624 i‡(! 
ªt
)

10626 
	`vty_out
 (
vty
, "%% MÆf‹med Pªfix%s", 
VTY_NEWLINE
);

10627  
CMD_WARNING
;

10630 
ªt
 = 
	`bgp_show
 (
vty
, 
NULL
, 
afi
, 
ßfi
, 
ty≥
, 
p
);

10631 
	`¥efix_‰ì
(
p
);

10632  
ªt
;

10633 
	}
}

10635 
DEFUN
 (
show_ù_bgp_¥efix_l⁄gî
,

10636 
show_ù_bgp_¥efix_l⁄gî_cmd
,

10638 
SHOW_STR


10639 
IP_STR


10640 
BGP_STR


10644  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

10645 
bgp_show_ty≥_¥efix_l⁄gî
);

10648 
DEFUN
 (
show_ù_bgp_Ê≠_¥efix_l⁄gî
,

10649 
show_ù_bgp_Ê≠_¥efix_l⁄gî_cmd
,

10651 
SHOW_STR


10652 
IP_STR


10653 
BGP_STR


10658  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

10659 
bgp_show_ty≥_Ê≠_¥efix_l⁄gî
);

10662 
DEFUN
 (
show_ù_bgp_ùv4_¥efix_l⁄gî
,

10663 
show_ù_bgp_ùv4_¥efix_l⁄gî_cmd
,

10665 
SHOW_STR


10666 
IP_STR


10667 
BGP_STR


10674 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

10675  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_MULTICAST
,

10676 
bgp_show_ty≥_¥efix_l⁄gî
);

10678  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[1], 
AFI_IP
, 
SAFI_UNICAST
,

10679 
bgp_show_ty≥_¥efix_l⁄gî
);

10682 
DEFUN
 (
show_ù_bgp_Ê≠_addªss
,

10683 
show_ù_bgp_Ê≠_addªss_cmd
,

10685 
SHOW_STR


10686 
IP_STR


10687 
BGP_STR


10691  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

10692 
bgp_show_ty≥_Ê≠_addªss
);

10695 
DEFUN
 (
show_ù_bgp_Ê≠_¥efix
,

10696 
show_ù_bgp_Ê≠_¥efix_cmd
,

10698 
SHOW_STR


10699 
IP_STR


10700 
BGP_STR


10704  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
,

10705 
bgp_show_ty≥_Ê≠_¥efix
);

10707 #ifde‡
HAVE_IPV6


10708 
DEFUN
 (
show_bgp_¥efix_l⁄gî
,

10709 
show_bgp_¥efix_l⁄gî_cmd
,

10711 
SHOW_STR


10712 
BGP_STR


10716  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

10717 
bgp_show_ty≥_¥efix_l⁄gî
);

10720 
ALIAS
 (
show_bgp_¥efix_l⁄gî
,

10721 
show_bgp_ùv6_¥efix_l⁄gî_cmd
,

10723 
SHOW_STR


10724 
BGP_STR


10730 
DEFUN
 (
show_ùv6_bgp_¥efix_l⁄gî
,

10731 
show_ùv6_bgp_¥efix_l⁄gî_cmd
,

10733 
SHOW_STR


10734 
IPV6_STR


10735 
BGP_STR


10739  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
,

10740 
bgp_show_ty≥_¥efix_l⁄gî
);

10744 
DEFUN
 (
show_ùv6_mbgp_¥efix_l⁄gî
,

10745 
show_ùv6_mbgp_¥efix_l⁄gî_cmd
,

10747 
SHOW_STR


10748 
IPV6_STR


10749 
MBGP_STR


10753  
bgp_show_¥efix_l⁄gî
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_MULTICAST
,

10754 
bgp_show_ty≥_¥efix_l⁄gî
);

10758 
≥î
 *

10759 
	$≥î_lookup_ö_võw
 (
vty
 *vty, c⁄° *
võw_«me
,

10760 c⁄° *
ù_°r
)

10762 
ªt
;

10763 
bgp
 *bgp;

10764 
≥î
 *peer;

10765 
sockuni⁄
 
su
;

10768 i‡(
võw_«me
)

10770 
bgp
 = 
	`bgp_lookup_by_«me
 (
võw_«me
);

10771 i‡(! 
bgp
)

10773 
	`vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
võw_«me
, 
VTY_NEWLINE
);

10774  
NULL
;

10779 
bgp
 = 
	`bgp_gë_deÁu…
 ();

10780 i‡(! 
bgp
)

10782 
	`vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

10783  
NULL
;

10788 
ªt
 = 
	`°r2sockuni⁄
 (
ù_°r
, &
su
);

10789 i‡(
ªt
 < 0)

10791 
	`vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
ù_°r
, 
VTY_NEWLINE
);

10792  
NULL
;

10796 
≥î
 = 
	`≥î_lookup
 (
bgp
, &
su
);

10797 i‡(! 
≥î
)

10799 
	`vty_out
 (
vty
, "NÿsuchÇeighb‹%s", 
VTY_NEWLINE
);

10800  
NULL
;

10803  
≥î
;

10804 
	}
}

10806 
	ebgp_°©s


10808 
	mBGP_STATS_MAXBITLEN
 = 0,

10809 
	mBGP_STATS_RIB
,

10810 
	mBGP_STATS_PREFIXES
,

10811 
	mBGP_STATS_TOTPLEN
,

10812 
	mBGP_STATS_UNAGGREGATEABLE
,

10813 
	mBGP_STATS_MAX_AGGREGATEABLE
,

10814 
	mBGP_STATS_AGGREGATES
,

10815 
	mBGP_STATS_SPACE
,

10816 
	mBGP_STATS_ASPATH_COUNT
,

10817 
	mBGP_STATS_ASPATH_MAXHOPS
,

10818 
	mBGP_STATS_ASPATH_TOTHOPS
,

10819 
	mBGP_STATS_ASPATH_MAXSIZE
,

10820 
	mBGP_STATS_ASPATH_TOTSIZE
,

10821 
	mBGP_STATS_ASN_HIGHEST
,

10822 
	mBGP_STATS_MAX
,

10825 c⁄° *
	gèbÀ_°©s_°rs
[] =

10827 [
BGP_STATS_PREFIXES
] = "Total Prefixes",

10828 [
BGP_STATS_TOTPLEN
] = "AverageÖrefixÜength",

10829 [
BGP_STATS_RIB
] = "Total Advertisements",

10830 [
BGP_STATS_UNAGGREGATEABLE
] = "UnaggregateableÖrefixes",

10831 [
BGP_STATS_MAX_AGGREGATEABLE
] = "MaximumággregateableÖrefixes",

10832 [
BGP_STATS_AGGREGATES
] = "BGP Aggregateádvertisements",

10833 [
BGP_STATS_SPACE
] = "Address spaceádvertised",

10834 [
BGP_STATS_ASPATH_COUNT
] = "Advertisements withÖaths",

10835 [
BGP_STATS_ASPATH_MAXHOPS
] = "Longest AS-Path (hops)",

10836 [
BGP_STATS_ASPATH_MAXSIZE
] = "Largest AS-Path (bytes)",

10837 [
BGP_STATS_ASPATH_TOTHOPS
] = "Average AS-PathÜength (hops)",

10838 [
BGP_STATS_ASPATH_TOTSIZE
] = "Average AS-Path size (bytes)",

10839 [
BGP_STATS_ASN_HIGHEST
] = "HighestÖublic ASN",

10840 [
BGP_STATS_MAX
] = 
NULL
,

10843 
	sbgp_èbÀ_°©s


10845 
bgp_èbÀ
 *
	mèbÀ
;

10846 
	mcou¡s
[
BGP_STATS_MAX
];

10850 
	#TALLY_SIGFIG
 100000

	)

10852 
	$øvg_èŒy
 (
cou¡
, 
ﬁdavg
, 
√wvÆ
)

10854 
√wtŸ
 = (
cou¡
-1Ë* 
ﬁdavg
 + (
√wvÆ
 * 
TALLY_SIGFIG
);

10855 
ªs
 = (
√wtŸ
 * 
TALLY_SIGFIG
Ë/ 
cou¡
;

10856 
ªt
 = 
√wtŸ
 / 
cou¡
;

10858 i‡((
ªs
 % 
TALLY_SIGFIG
) > (TALLY_SIGFIG/2))

10859  
ªt
 + 1;

10861  
ªt
;

10862 
	}
}

10866 
	$bgp_èbÀ_°©s_wÆkî
 (
thªad
 *
t
)

10868 
bgp_node
 *
∫
;

10869 
bgp_node
 *
t›
;

10870 
bgp_èbÀ_°©s
 *
ts
 = 
	`THREAD_ARG
 (
t
);

10871 
•a˚
 = 0;

10873 i‡(!(
t›
 = 
	`bgp_èbÀ_t›
 (
ts
->
èbÀ
)))

10876 
t›
->
p
.
Ámûy
)

10878 
AF_INET
:

10879 
•a˚
 = 
IPV4_MAX_BITLEN
;

10881 
AF_INET6
:

10882 
•a˚
 = 
IPV6_MAX_BITLEN
;

10886 
ts
->
cou¡s
[
BGP_STATS_MAXBITLEN
] = 
•a˚
;

10888 
∫
 = 
t›
;Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

10890 
bgp_öfo
 *
ri
;

10891 
bgp_node
 *
¥n
 = 
	`bgp_node_∑ª¡_nﬁock
 (
∫
);

10892 
röum
 = 0;

10894 i‡(
∫
 =
t›
)

10897 i‡(!
∫
->
öfo
)

10900 
ts
->
cou¡s
[
BGP_STATS_PREFIXES
]++;

10901 
ts
->
cou¡s
[
BGP_STATS_TOTPLEN
] +
∫
->
p
.
¥efixÀn
;

10904 
ts
->
cou¡s
[
BGP_STATS_AVGPLEN
]

10905 
	`øvg_èŒy
 (
ts
->
cou¡s
[
BGP_STATS_PREFIXES
],

10906 
ts
->
cou¡s
[
BGP_STATS_AVGPLEN
],

10907 
∫
->
p
.
¥efixÀn
);

10911 
¥n
 && !¥n->
öfo
)

10912 
¥n
 = 
	`bgp_node_∑ª¡_nﬁock
 (prn);

10914 i‡(
¥n
 =
NULL
 ||Ö∫ =
t›
)

10916 
ts
->
cou¡s
[
BGP_STATS_UNAGGREGATEABLE
]++;

10918 i‡(
•a˚
)

10919 
ts
->
cou¡s
[
BGP_STATS_SPACE
] +1 << (
•a˚
 - 
∫
->
p
.
¥efixÀn
);

10921 i‡(
¥n
->
öfo
)

10922 
ts
->
cou¡s
[
BGP_STATS_MAX_AGGREGATEABLE
]++;

10924 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

10926 
röum
++;

10927 
ts
->
cou¡s
[
BGP_STATS_RIB
]++;

10929 i‡(
ri
->
©å
 &&

10930 (
	`CHECK_FLAG
 (
ri
->
©å
->
Êag
,

10931 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
))))

10932 
ts
->
cou¡s
[
BGP_STATS_AGGREGATES
]++;

10935 i‡(
ri
->
©å
 &&Ñi->©å->
a•©h
)

10937 
h›s
 = 
	`a•©h_cou¡_h›s
 (
ri
->
©å
->
a•©h
);

10938 
size
 = 
	`a•©h_size
 (
ri
->
©å
->
a•©h
);

10939 
as_t
 
highe°
 = 
	`a•©h_highe°
 (
ri
->
©å
->
a•©h
);

10941 
ts
->
cou¡s
[
BGP_STATS_ASPATH_COUNT
]++;

10943 i‡(
h›s
 > 
ts
->
cou¡s
[
BGP_STATS_ASPATH_MAXHOPS
])

10944 
ts
->
cou¡s
[
BGP_STATS_ASPATH_MAXHOPS
] = 
h›s
;

10946 i‡(
size
 > 
ts
->
cou¡s
[
BGP_STATS_ASPATH_MAXSIZE
])

10947 
ts
->
cou¡s
[
BGP_STATS_ASPATH_MAXSIZE
] = 
size
;

10949 
ts
->
cou¡s
[
BGP_STATS_ASPATH_TOTHOPS
] +
h›s
;

10950 
ts
->
cou¡s
[
BGP_STATS_ASPATH_TOTSIZE
] +
size
;

10952 
ts
->
cou¡s
[
BGP_STATS_ASPATH_AVGHOPS
]

10953 
	`øvg_èŒy
 (
ts
->
cou¡s
[
BGP_STATS_ASPATH_COUNT
],

10954 
ts
->
cou¡s
[
BGP_STATS_ASPATH_AVGHOPS
],

10955 
h›s
);

10956 
ts
->
cou¡s
[
BGP_STATS_ASPATH_AVGSIZE
]

10957 
	`øvg_èŒy
 (
ts
->
cou¡s
[
BGP_STATS_ASPATH_COUNT
],

10958 
ts
->
cou¡s
[
BGP_STATS_ASPATH_AVGSIZE
],

10959 
size
);

10961 i‡(
highe°
 > 
ts
->
cou¡s
[
BGP_STATS_ASN_HIGHEST
])

10962 
ts
->
cou¡s
[
BGP_STATS_ASN_HIGHEST
] = 
highe°
;

10967 
	}
}

10970 
	$bgp_èbÀ_°©s
 (
vty
 *vty, 
bgp
 *bgp, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

10972 
bgp_èbÀ_°©s
 
ts
;

10973 
i
;

10975 i‡(!
bgp
->
rib
[
afi
][
ßfi
])

10977 
	`vty_out
 (
vty
, "%% NÿRIBÉxi° f‹ÅhêAFI/SAFI%s", 
VTY_NEWLINE
);

10978  
CMD_WARNING
;

10981 
	`mem£t
 (&
ts
, 0,  (ts));

10982 
ts
.
èbÀ
 = 
bgp
->
rib
[
afi
][
ßfi
];

10983 
	`thªad_execuã
 (
bm
->
ma°î
, 
bgp_èbÀ_°©s_wÆkî
, &
ts
, 0);

10985 
	`vty_out
 (
vty
, "BGP %s RIB statistics%s%s",

10986 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
), 
VTY_NEWLINE
, VTY_NEWLINE);

10988 
i
 = 0; i < 
BGP_STATS_MAX
; i++)

10990 i‡(!
èbÀ_°©s_°rs
[
i
])

10993 
i
)

10996 
BGP_STATS_ASPATH_AVGHOPS
:

10997 
BGP_STATS_ASPATH_AVGSIZE
:

10998 
BGP_STATS_AVGPLEN
:

10999 
	`vty_out
 (
vty
, "%-30s: ", 
èbÀ_°©s_°rs
[
i
]);

11000 
	`vty_out
 (
vty
, "%12.2f",

11001 ()
ts
.
cou¡s
[
i
] / ()
TALLY_SIGFIG
);

11004 
BGP_STATS_ASPATH_TOTHOPS
:

11005 
BGP_STATS_ASPATH_TOTSIZE
:

11006 
	`vty_out
 (
vty
, "%-30s: ", 
èbÀ_°©s_°rs
[
i
]);

11007 
	`vty_out
 (
vty
, "%12.2f",

11008 
ts
.
cou¡s
[
i
] ?

11009 ()
ts
.
cou¡s
[
i
] /

11010 ()
ts
.
cou¡s
[
BGP_STATS_ASPATH_COUNT
]

11013 
BGP_STATS_TOTPLEN
:

11014 
	`vty_out
 (
vty
, "%-30s: ", 
èbÀ_°©s_°rs
[
i
]);

11015 
	`vty_out
 (
vty
, "%12.2f",

11016 
ts
.
cou¡s
[
i
] ?

11017 ()
ts
.
cou¡s
[
i
] /

11018 ()
ts
.
cou¡s
[
BGP_STATS_PREFIXES
]

11021 
BGP_STATS_SPACE
:

11022 
	`vty_out
 (
vty
, "%-30s: ", 
èbÀ_°©s_°rs
[
i
]);

11023 
	`vty_out
 (
vty
, "%12Œu%s", 
ts
.
cou¡s
[
i
], 
VTY_NEWLINE
);

11024 i‡(
ts
.
cou¡s
[
BGP_STATS_MAXBITLEN
] < 9)

11026 
	`vty_out
 (
vty
, "%30s: ", "%%ánnounced ");

11027 
	`vty_out
 (
vty
, "%12.2f%s",

11028 100 * ()
ts
.
cou¡s
[
BGP_STATS_SPACE
] /

11029 ()((
uöt64_t
)1UL << 
ts
.
cou¡s
[
BGP_STATS_MAXBITLEN
]),

11030 
VTY_NEWLINE
);

11031 
	`vty_out
 (
vty
, "%30s: ", "/8Équivalent ");

11032 
	`vty_out
 (
vty
, "%12.2f%s",

11033 ()
ts
.
cou¡s
[
BGP_STATS_SPACE
] /

11034 ()(1UL << (
ts
.
cou¡s
[
BGP_STATS_MAXBITLEN
] - 8)),

11035 
VTY_NEWLINE
);

11036 i‡(
ts
.
cou¡s
[
BGP_STATS_MAXBITLEN
] < 25)

11038 
	`vty_out
 (
vty
, "%30s: ", "/24Équivalent ");

11039 
	`vty_out
 (
vty
, "%12.2f",

11040 ()
ts
.
cou¡s
[
BGP_STATS_SPACE
] /

11041 ()(1UL << (
ts
.
cou¡s
[
BGP_STATS_MAXBITLEN
] - 24)));

11044 
	`vty_out
 (
vty
, "%-30s: ", 
èbÀ_°©s_°rs
[
i
]);

11045 
	`vty_out
 (
vty
, "%12Œu", 
ts
.
cou¡s
[
i
]);

11048 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

11050  
CMD_SUCCESS
;

11051 
	}
}

11054 
	$bgp_èbÀ_°©s_vty
 (
vty
 *vty, c⁄° *
«me
,

11055 c⁄° *
afi_°r
, c⁄° *
ßfi_°r
)

11057 
bgp
 *bgp;

11058 
afi_t
 
afi
;

11059 
ßfi_t
 
ßfi
;

11061 i‡(
«me
)

11062 
bgp
 = 
	`bgp_lookup_by_«me
 (
«me
);

11064 
bgp
 = 
	`bgp_gë_deÁu…
 ();

11066 i‡(!
bgp
)

11068 
	`vty_out
 (
vty
, "%% Nÿsuch BGP in°™˚Éxi°%s", 
VTY_NEWLINE
);

11069  
CMD_WARNING
;

11071 i‡(
	`°∫cmp
 (
afi_°r
, "ipv", 3) == 0)

11073 i‡(
	`°∫cmp
 (
afi_°r
, "ipv4", 4) == 0)

11074 
afi
 = 
AFI_IP
;

11075 i‡(
	`°∫cmp
 (
afi_°r
, "ipv6", 4) == 0)

11076 
afi
 = 
AFI_IP6
;

11079 
	`vty_out
 (
vty
, "%% Invalidáddress family %s%s",

11080 
afi_°r
, 
VTY_NEWLINE
);

11081  
CMD_WARNING
;

11083 i‡(
	`°∫cmp
 (
ßfi_°r
, "m", 1) == 0)

11084 
ßfi
 = 
SAFI_MULTICAST
;

11085 i‡(
	`°∫cmp
 (
ßfi_°r
, "u", 1) == 0)

11086 
ßfi
 = 
SAFI_UNICAST
;

11087 i‡(
	`°∫cmp
 (
ßfi_°r
, "vpnv4", 5) == 0 || strncmp (safi_str, "vpnv6", 5) == 0)

11088 
ßfi
 = 
SAFI_MPLS_LABELED_VPN
;

11091 
	`vty_out
 (
vty
, "%% Invalid subsequentáddress family %s%s",

11092 
ßfi_°r
, 
VTY_NEWLINE
);

11093  
CMD_WARNING
;

11098 
	`vty_out
 (
vty
, "%% Invalidáddress family %s%s",

11099 
afi_°r
, 
VTY_NEWLINE
);

11100  
CMD_WARNING
;

11103  
	`bgp_èbÀ_°©s
 (
vty
, 
bgp
, 
afi
, 
ßfi
);

11104 
	}
}

11106 
DEFUN
 (
show_bgp_°©i°ics
,

11107 
show_bgp_°©i°ics_cmd
,

11109 
SHOW_STR


11110 
BGP_STR


11117  
bgp_èbÀ_°©s_vty
 (
vty
, 
NULL
, 
¨gv
[0],árgv[1]);

11120 
ALIAS
 (
show_bgp_°©i°ics
,

11121 
show_bgp_°©i°ics_v≤v4_cmd
,

11123 
SHOW_STR


11124 
BGP_STR


11129 
DEFUN
 (
show_bgp_°©i°ics_võw
,

11130 
show_bgp_°©i°ics_võw_cmd
,

11132 
SHOW_STR


11133 
BGP_STR


11141  
bgp_èbÀ_°©s_vty
 (
vty
, 
NULL
, 
¨gv
[0],árgv[1]);

11144 
ALIAS
 (
show_bgp_°©i°ics_võw
,

11145 
show_bgp_°©i°ics_võw_v≤v4_cmd
,

11147 
SHOW_STR


11148 
BGP_STR


11154 
	ebgp_pcou¡s


11156 
	mPCOUNT_ADJ_IN
 = 0,

11157 
	mPCOUNT_DAMPED
,

11158 
	mPCOUNT_REMOVED
,

11159 
	mPCOUNT_HISTORY
,

11160 
	mPCOUNT_STALE
,

11161 
	mPCOUNT_VALID
,

11162 #ifde‡
USE_SRX


11163 
	mPCOUNT_IGNORE
,

11165 
	mPCOUNT_ALL
,

11166 
	mPCOUNT_COUNTED
,

11167 
	mPCOUNT_PFCNT
,

11168 
	mPCOUNT_MAX
,

11171 c⁄° *
	gpcou¡_°rs
[] =

11173 [
PCOUNT_ADJ_IN
] = "Adj-in",

11174 [
PCOUNT_DAMPED
] = "Damped",

11175 [
PCOUNT_REMOVED
] = "Removed",

11176 [
PCOUNT_HISTORY
] = "History",

11177 [
PCOUNT_STALE
] = "Stale",

11178 [
PCOUNT_VALID
] = "Valid",

11179 #ifde‡
USE_SRX


11180 [
PCOUNT_IGNORE
] = "Ignore",

11182 [
PCOUNT_ALL
] = "All RIB",

11183 [
PCOUNT_COUNTED
] = "PfxCt counted",

11184 [
PCOUNT_PFCNT
] = "Useable",

11185 [
PCOUNT_MAX
] = 
NULL
,

11188 
	s≥î_pcou¡s


11190 
	mcou¡
[
PCOUNT_MAX
];

11191 c⁄° 
≥î
 *
	m≥î
;

11192 c⁄° 
bgp_èbÀ
 *
	mèbÀ
;

11196 
	$bgp_≥î_cou¡_wÆkî
 (
thªad
 *
t
)

11198 
bgp_node
 *
∫
;

11199 
≥î_pcou¡s
 *
pc
 = 
	`THREAD_ARG
 (
t
);

11200 c⁄° 
≥î
 *≥î = 
pc
->peer;

11202 
∫
 = 
	`bgp_èbÀ_t›
 (
pc
->
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

11204 
bgp_adj_ö
 *
aö
;

11205 
bgp_öfo
 *
ri
;

11207 
aö
 = 
∫
->
adj_ö
;áö;áö =áö->
√xt
)

11208 i‡(
aö
->
≥î
 ==Öeer)

11209 
pc
->
cou¡
[
PCOUNT_ADJ_IN
]++;

11211 
ri
 = 
∫
->
öfo
;Ñi;Ñòri->
√xt
)

11213 
buf
[
SU_ADDRSTRLEN
];

11215 i‡(
ri
->
≥î
 !=Öeer)

11218 
pc
->
cou¡
[
PCOUNT_ALL
]++;

11220 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_DAMPED
))

11221 
pc
->
cou¡
[
PCOUNT_DAMPED
]++;

11222 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_HISTORY
))

11223 
pc
->
cou¡
[
PCOUNT_HISTORY
]++;

11224 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_REMOVED
))

11225 
pc
->
cou¡
[
PCOUNT_REMOVED
]++;

11226 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_STALE
))

11227 
pc
->
cou¡
[
PCOUNT_STALE
]++;

11228 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_VALID
))

11229 
pc
->
cou¡
[
PCOUNT_VALID
]++;

11230 #ifde‡
USE_SRX


11231 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_IGNORE
))

11233 
pc
->
cou¡
[
PCOUNT_IGNORE
]++;

11236 i‡(!
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_UNUSEABLE
))

11237 
pc
->
cou¡
[
PCOUNT_PFCNT
]++;

11239 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_COUNTED
))

11241 
pc
->
cou¡
[
PCOUNT_COUNTED
]++;

11242 i‡(
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_UNUSEABLE
))

11243 
	`∂og_w¨n
 (
≥î
->
log
,

11245 
≥î
->
ho°
,

11246 
	`öë_¡›
(
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
,

11247 
buf
, 
SU_ADDRSTRLEN
),

11248 
∫
->
p
.
¥efixÀn
,

11249 
ri
->
Êags
);

11253 i‡(!
	`CHECK_FLAG
 (
ri
->
Êags
, 
BGP_INFO_UNUSEABLE
))

11254 
	`∂og_w¨n
 (
≥î
->
log
,

11256 
≥î
->
ho°
,

11257 
	`öë_¡›
(
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
,

11258 
buf
, 
SU_ADDRSTRLEN
),

11259 
∫
->
p
.
¥efixÀn
,

11260 
ri
->
Êags
);

11265 
	}
}

11268 
	$bgp_≥î_cou¡s
 (
vty
 *vty, 
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

11270 
≥î_pcou¡s
 
pcou¡s
 = { .
≥î
 =Öeer };

11271 
i
;

11273 i‡(!
≥î
 || !≥î->
bgp
 || !≥î->
afc
[
afi
][
ßfi
]

11274 || !
≥î
->
bgp
->
rib
[
afi
][
ßfi
])

11276 
	`vty_out
 (
vty
, "%% NÿsuchÇeighb‹ o∏addªs†Ámûy%s", 
VTY_NEWLINE
);

11277  
CMD_WARNING
;

11280 
	`mem£t
 (&
pcou¡s
, 0, (pcounts));

11281 
pcou¡s
.
≥î
 =Öeer;

11282 
pcou¡s
.
èbÀ
 = 
≥î
->
bgp
->
rib
[
afi
][
ßfi
];

11288 
	`thªad_execuã
 (
bm
->
ma°î
, 
bgp_≥î_cou¡_wÆkî
, &
pcou¡s
, 0);

11290 
	`vty_out
 (
vty
, "Prefix counts for %s, %s%s",

11291 
≥î
->
ho°
, 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
), 
VTY_NEWLINE
);

11292 
	`vty_out
 (
vty
, "PfxCt: %ld%s", 
≥î
->
pcou¡
[
afi
][
ßfi
], 
VTY_NEWLINE
);

11293 
	`vty_out
 (
vty
, "%sCounts from RIBÅable walk:%s%s",

11294 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE);

11296 
i
 = 0; i < 
PCOUNT_MAX
; i++)

11297 
	`vty_out
 (
vty
, "%20s: %-10d%s",

11298 
pcou¡_°rs
[
i
], 
pcou¡s
.
cou¡
[i], 
VTY_NEWLINE
);

11300 i‡(
pcou¡s
.
cou¡
[
PCOUNT_PFCNT
] !
≥î
->
pcou¡
[
afi
][
ßfi
])

11302 
	`vty_out
 (
vty
, "%s [pcount] PfxCt drift!%s",

11303 
≥î
->
ho°
, 
VTY_NEWLINE
);

11304 
	`vty_out
 (
vty
, "PleaseÑeportÅhis bug, withÅheábove command output%s",

11305 
VTY_NEWLINE
);

11308  
CMD_SUCCESS
;

11309 
	}
}

11311 
DEFUN
 (
show_ù_bgp_√ighb‹_¥efix_cou¡s
,

11312 
show_ù_bgp_√ighb‹_¥efix_cou¡s_cmd
,

11314 
SHOW_STR


11315 
IP_STR


11316 
BGP_STR


11322 
≥î
 *
	g≥î
;

11324 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11325 i‡(! 
	g≥î
)

11326  
	gCMD_WARNING
;

11328  
bgp_≥î_cou¡s
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
);

11331 
DEFUN
 (
show_bgp_ùv6_√ighb‹_¥efix_cou¡s
,

11332 
show_bgp_ùv6_√ighb‹_¥efix_cou¡s_cmd
,

11334 
SHOW_STR


11335 
BGP_STR


11342 
≥î
 *
	g≥î
;

11344 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11345 i‡(! 
	g≥î
)

11346  
	gCMD_WARNING
;

11348  
bgp_≥î_cou¡s
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_UNICAST
);

11351 
DEFUN
 (
show_ù_bgp_ùv4_√ighb‹_¥efix_cou¡s
,

11352 
show_ù_bgp_ùv4_√ighb‹_¥efix_cou¡s_cmd
,

11354 
SHOW_STR


11355 
IP_STR


11356 
BGP_STR


11365 
≥î
 *
	g≥î
;

11367 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

11368 i‡(! 
	g≥î
)

11369  
	gCMD_WARNING
;

11371 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

11372  
bgp_≥î_cou¡s
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_MULTICAST
);

11374  
bgp_≥î_cou¡s
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
);

11377 
DEFUN
 (
show_ù_bgp_v≤v4_√ighb‹_¥efix_cou¡s
,

11378 
show_ù_bgp_v≤v4_√ighb‹_¥efix_cou¡s_cmd
,

11380 
SHOW_STR


11381 
IP_STR


11382 
BGP_STR


11391 
≥î
 *
	g≥î
;

11393 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11394 i‡(! 
	g≥î
)

11395  
	gCMD_WARNING
;

11397  
bgp_≥î_cou¡s
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_MPLS_VPN
);

11402 
	$show_adj_rouã
 (
vty
 *vty, 
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

11403 
ö
)

11405 
bgp_èbÀ
 *
èbÀ
;

11406 
bgp_adj_ö
 *
aö
;

11407 
bgp_adj_out
 *
adj
;

11408 
ouçut_cou¡
;

11409 
bgp_node
 *
∫
;

11410 
hódî1
 = 1;

11411 
bgp
 *bgp;

11412 
hódî2
 = 1;

11414 
bgp
 = 
≥î
->bgp;

11416 i‡(! 
bgp
)

11419 
èbÀ
 = 
bgp
->
rib
[
afi
][
ßfi
];

11421 
ouçut_cou¡
 = 0;

11423 i‡(! 
ö
 && 
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
],

11424 
PEER_STATUS_DEFAULT_ORIGINATE
))

11426 
	`vty_out
 (
vty
, "BGPÅabÀ vîsi⁄ i†0,Üoˇ»rouã∏ID i†%s%s", 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
), 
VTY_NEWLINE
);

11427 
	`vty_out
 (
vty
, 
BGP_SHOW_SCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

11428 
	`vty_out
 (
vty
, 
BGP_SHOW_OCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

11430 
	`vty_out
 (
vty
, "Originating defaultÇetwork 0.0.0.0%s%s",

11431 
VTY_NEWLINE
, VTY_NEWLINE);

11432 
hódî1
 = 0;

11435 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

11436 i‡(
ö
)

11438 
aö
 = 
∫
->
adj_ö
;áö;áö =áö->
√xt
)

11439 i‡(
aö
->
≥î
 ==Öeer)

11441 i‡(
hódî1
)

11443 
	`vty_out
 (
vty
, "BGPÅabÀ vîsi⁄ i†0,Üoˇ»rouã∏ID i†%s%s", 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
), 
VTY_NEWLINE
);

11444 
	`vty_out
 (
vty
, 
BGP_SHOW_SCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

11445 
	`vty_out
 (
vty
, 
BGP_SHOW_OCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

11446 
hódî1
 = 0;

11448 i‡(
hódî2
)

11450 
	`vty_out
 (
vty
, 
BGP_SHOW_HEADER
, 
VTY_NEWLINE
);

11451 
hódî2
 = 0;

11453 i‡(
aö
->
©å
)

11455 
	`rouã_vty_out_tmp
 (
vty
, &
∫
->
p
, 
aö
->
©å
, 
ßfi
);

11456 
ouçut_cou¡
++;

11462 
adj
 = 
∫
->
adj_out
;ádj;ádj =ádj->
√xt
)

11463 i‡(
adj
->
≥î
 ==Öeer)

11465 i‡(
hódî1
)

11467 
	`vty_out
 (
vty
, "BGPÅabÀ vîsi⁄ i†0,Üoˇ»rouã∏ID i†%s%s", 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
), 
VTY_NEWLINE
);

11468 
	`vty_out
 (
vty
, 
BGP_SHOW_SCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

11469 
	`vty_out
 (
vty
, 
BGP_SHOW_OCODE_HEADER
, 
VTY_NEWLINE
, VTY_NEWLINE);

11470 
hódî1
 = 0;

11472 i‡(
hódî2
)

11474 
	`vty_out
 (
vty
, 
BGP_SHOW_HEADER
, 
VTY_NEWLINE
);

11475 
hódî2
 = 0;

11477 i‡(
adj
->
©å
)

11479 
	`rouã_vty_out_tmp
 (
vty
, &
∫
->
p
, 
adj
->
©å
, 
ßfi
);

11480 
ouçut_cou¡
++;

11485 i‡(
ouçut_cou¡
 != 0)

11486 
	`vty_out
 (
vty
, "%sTotalÇumber ofÖrefixes %ld%s",

11487 
VTY_NEWLINE
, 
ouçut_cou¡
, VTY_NEWLINE);

11488 
	}
}

11491 
	$≥î_adj_rouãs
 (
vty
 *vty, 
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
ö
)

11493 i‡(! 
≥î
 || !Öìr->
afc
[
afi
][
ßfi
])

11495 
	`vty_out
 (
vty
, "%% NÿsuchÇeighb‹ o∏addªs†Ámûy%s", 
VTY_NEWLINE
);

11496  
CMD_WARNING
;

11499 i‡(
ö
 && ! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SOFT_RECONFIG
))

11501 
	`vty_out
 (
vty
, "%% Inbound softÑeconfigurationÇotÉnabled%s",

11502 
VTY_NEWLINE
);

11503  
CMD_WARNING
;

11506 
	`show_adj_rouã
 (
vty
, 
≥î
, 
afi
, 
ßfi
, 
ö
);

11508  
CMD_SUCCESS
;

11509 
	}
}

11511 
DEFUN
 (
show_ù_bgp_võw_√ighb‹_advîti£d_rouã
,

11512 
show_ù_bgp_võw_√ighb‹_advîti£d_rouã_cmd
,

11514 
SHOW_STR


11515 
IP_STR


11516 
BGP_STR


11524 
≥î
 *
	g≥î
;

11526 i‡(
	g¨gc
 == 2)

11527 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

11529 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11531 i‡(! 
	g≥î
)

11532  
	gCMD_WARNING
;

11534  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
, 0);

11537 
ALIAS
 (
show_ù_bgp_võw_√ighb‹_advîti£d_rouã
,

11538 
show_ù_bgp_√ighb‹_advîti£d_rouã_cmd
,

11540 
SHOW_STR


11541 
IP_STR


11542 
BGP_STR


11548 
DEFUN
 (
show_ù_bgp_ùv4_√ighb‹_advîti£d_rouã
,

11549 
show_ù_bgp_ùv4_√ighb‹_advîti£d_rouã_cmd
,

11551 
SHOW_STR


11552 
IP_STR


11553 
BGP_STR


11562 
≥î
 *
	g≥î
;

11564 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

11565 i‡(! 
	g≥î
)

11566  
	gCMD_WARNING
;

11568 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

11569  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_MULTICAST
, 0);

11571  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
, 0);

11574 #ifde‡
HAVE_IPV6


11575 
DEFUN
 (
show_bgp_võw_√ighb‹_advîti£d_rouã
,

11576 
show_bgp_võw_√ighb‹_advîti£d_rouã_cmd
,

11578 
SHOW_STR


11579 
BGP_STR


11587 
≥î
 *
	g≥î
;

11589 i‡(
	g¨gc
 == 2)

11590 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

11592 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11594 i‡(! 
	g≥î
)

11595  
	gCMD_WARNING
;

11597  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_UNICAST
, 0);

11600 
ALIAS
 (
show_bgp_võw_√ighb‹_advîti£d_rouã
,

11601 
show_bgp_võw_ùv6_√ighb‹_advîti£d_rouã_cmd
,

11603 
SHOW_STR


11604 
BGP_STR


11613 
DEFUN
 (
show_bgp_võw_√ighb‹_ª˚ived_rouãs
,

11614 
show_bgp_võw_√ighb‹_ª˚ived_rouãs_cmd
,

11616 
SHOW_STR


11617 
BGP_STR


11625 
≥î
 *
	g≥î
;

11627 i‡(
	g¨gc
 == 2)

11628 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

11630 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11632 i‡(! 
	g≥î
)

11633  
	gCMD_WARNING
;

11635  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_UNICAST
, 1);

11638 
ALIAS
 (
show_bgp_võw_√ighb‹_ª˚ived_rouãs
,

11639 
show_bgp_võw_ùv6_√ighb‹_ª˚ived_rouãs_cmd
,

11641 
SHOW_STR


11642 
BGP_STR


11651 
ALIAS
 (
show_bgp_võw_√ighb‹_advîti£d_rouã
,

11652 
show_bgp_√ighb‹_advîti£d_rouã_cmd
,

11654 
SHOW_STR


11655 
BGP_STR


11661 
ALIAS
 (
show_bgp_võw_√ighb‹_advîti£d_rouã
,

11662 
show_bgp_ùv6_√ighb‹_advîti£d_rouã_cmd
,

11664 
SHOW_STR


11665 
BGP_STR


11673 
ALIAS
 (
show_bgp_võw_√ighb‹_advîti£d_rouã
,

11674 
ùv6_bgp_√ighb‹_advîti£d_rouã_cmd
,

11676 
SHOW_STR


11677 
IPV6_STR


11678 
BGP_STR


11685 
DEFUN
 (
ùv6_mbgp_√ighb‹_advîti£d_rouã
,

11686 
ùv6_mbgp_√ighb‹_advîti£d_rouã_cmd
,

11688 
SHOW_STR


11689 
IPV6_STR


11690 
MBGP_STR


11696 
≥î
 *
	g≥î
;

11698 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11699 i‡(! 
	g≥î
)

11700  
	gCMD_WARNING
;

11702  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_MULTICAST
, 0);

11706 
DEFUN
 (
show_ù_bgp_võw_√ighb‹_ª˚ived_rouãs
,

11707 
show_ù_bgp_võw_√ighb‹_ª˚ived_rouãs_cmd
,

11709 
SHOW_STR


11710 
IP_STR


11711 
BGP_STR


11719 
≥î
 *
	g≥î
;

11721 i‡(
	g¨gc
 == 2)

11722 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

11724 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

11726 i‡(! 
	g≥î
)

11727  
	gCMD_WARNING
;

11729  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
, 1);

11732 
ALIAS
 (
show_ù_bgp_võw_√ighb‹_ª˚ived_rouãs
,

11733 
show_ù_bgp_√ighb‹_ª˚ived_rouãs_cmd
,

11735 
SHOW_STR


11736 
IP_STR


11737 
BGP_STR


11743 
DEFUN
 (
show_ù_bgp_ùv4_√ighb‹_ª˚ived_rouãs
,

11744 
show_ù_bgp_ùv4_√ighb‹_ª˚ived_rouãs_cmd
,

11746 
SHOW_STR


11747 
IP_STR


11748 
BGP_STR


11757 
≥î
 *
	g≥î
;

11759 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

11760 i‡(! 
	g≥î
)

11761  
	gCMD_WARNING
;

11763 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

11764  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_MULTICAST
, 1);

11766  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
, 1);

11769 
DEFUN
 (
show_bgp_võw_afi_ßfi_√ighb‹_adv_ªcd_rouãs
,

11770 
show_bgp_võw_afi_ßfi_√ighb‹_adv_ªcd_rouãs_cmd
,

11771 #ifde‡
HAVE_IPV6


11776 
SHOW_STR


11777 
BGP_STR


11781 #ifde‡
HAVE_IPV6


11792 
	gafi
;

11793 
	gßfi
;

11794 
	gö
;

11795 
≥î
 *
	g≥î
;

11797 #ifde‡
HAVE_IPV6


11798 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[3]);

11800 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[2]);

11803 i‡(! 
	g≥î
)

11804  
	gCMD_WARNING
;

11806 #ifde‡
HAVE_IPV6


11807 
	gafi
 = (
°∫cmp
 (
¨gv
[1], "ùv6", 4Ë=0Ë? 
AFI_IP6
 : 
AFI_IP
;

11808 
	gßfi
 = (
°∫cmp
 (
¨gv
[2], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

11809 
	gö
 = (
°∫cmp
 (
¨gv
[4], "r", 1) == 0) ? 1 : 0;

11811 
	gafi
 = 
AFI_IP
;

11812 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

11813 
	gö
 = (
°∫cmp
 (
¨gv
[3], "r", 1) == 0) ? 1 : 0;

11816  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
afi
, 
ßfi
, 
ö
);

11819 
DEFUN
 (
show_ù_bgp_√ighb‹_ª˚ived_¥efix_fûãr
,

11820 
show_ù_bgp_√ighb‹_ª˚ived_¥efix_fûãr_cmd
,

11822 
SHOW_STR


11823 
IP_STR


11824 
BGP_STR


11831 
	g«me
[
BUFSIZ
];

11832 
sockuni⁄
 
	gsu
;

11833 
≥î
 *
	g≥î
;

11834 
	gcou¡
, 
	gªt
;

11836 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[0], &
su
);

11837 i‡(
	gªt
 < 0)

11839 
vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

11840  
	gCMD_WARNING
;

11843 
	g≥î
 = 
≥î_lookup
 (
NULL
, &
su
);

11844 i‡(! 
	g≥î
)

11845  
	gCMD_WARNING
;

11847 
•rötf
 (
«me
, "%s.%d.%d", 
≥î
->
ho°
, 
AFI_IP
, 
SAFI_UNICAST
);

11848 
	gcou¡
 = 
¥efix_bgp_show_¥efix_li°
 (
NULL
, 
AFI_IP
, 
«me
);

11849 i‡(
	gcou¡
)

11851 
vty_out
 (
vty
, "Addªs†Ámûy: IPv4 Uniˇ°%s", 
VTY_NEWLINE
);

11852 
¥efix_bgp_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
«me
);

11855  
	gCMD_SUCCESS
;

11858 
DEFUN
 (
show_ù_bgp_ùv4_√ighb‹_ª˚ived_¥efix_fûãr
,

11859 
show_ù_bgp_ùv4_√ighb‹_ª˚ived_¥efix_fûãr_cmd
,

11861 
SHOW_STR


11862 
IP_STR


11863 
BGP_STR


11873 
	g«me
[
BUFSIZ
];

11874 
sockuni⁄
 
	gsu
;

11875 
≥î
 *
	g≥î
;

11876 
	gcou¡
, 
	gªt
;

11878 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[1], &
su
);

11879 i‡(
	gªt
 < 0)

11881 
vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
¨gv
[1], 
VTY_NEWLINE
);

11882  
	gCMD_WARNING
;

11885 
	g≥î
 = 
≥î_lookup
 (
NULL
, &
su
);

11886 i‡(! 
	g≥î
)

11887  
	gCMD_WARNING
;

11889 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

11891 
•rötf
 (
«me
, "%s.%d.%d", 
≥î
->
ho°
, 
AFI_IP
, 
SAFI_MULTICAST
);

11892 
	gcou¡
 = 
¥efix_bgp_show_¥efix_li°
 (
NULL
, 
AFI_IP
, 
«me
);

11893 i‡(
	gcou¡
)

11895 
vty_out
 (
vty
, "Addªs†Ámûy: IPv4 Mu…iˇ°%s", 
VTY_NEWLINE
);

11896 
¥efix_bgp_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
«me
);

11901 
•rötf
 (
«me
, "%s.%d.%d", 
≥î
->
ho°
, 
AFI_IP
, 
SAFI_UNICAST
);

11902 
	gcou¡
 = 
¥efix_bgp_show_¥efix_li°
 (
NULL
, 
AFI_IP
, 
«me
);

11903 i‡(
	gcou¡
)

11905 
vty_out
 (
vty
, "Addªs†Ámûy: IPv4 Uniˇ°%s", 
VTY_NEWLINE
);

11906 
¥efix_bgp_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
«me
);

11910  
	gCMD_SUCCESS
;

11914 #ifde‡
HAVE_IPV6


11915 
ALIAS
 (
show_bgp_võw_√ighb‹_ª˚ived_rouãs
,

11916 
show_bgp_√ighb‹_ª˚ived_rouãs_cmd
,

11918 
SHOW_STR


11919 
BGP_STR


11925 
ALIAS
 (
show_bgp_võw_√ighb‹_ª˚ived_rouãs
,

11926 
show_bgp_ùv6_√ighb‹_ª˚ived_rouãs_cmd
,

11928 
SHOW_STR


11929 
BGP_STR


11936 
DEFUN
 (
show_bgp_√ighb‹_ª˚ived_¥efix_fûãr
,

11937 
show_bgp_√ighb‹_ª˚ived_¥efix_fûãr_cmd
,

11939 
SHOW_STR


11940 
BGP_STR


11947 
	g«me
[
BUFSIZ
];

11948 
sockuni⁄
 
	gsu
;

11949 
≥î
 *
	g≥î
;

11950 
	gcou¡
, 
	gªt
;

11952 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[0], &
su
);

11953 i‡(
	gªt
 < 0)

11955 
vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

11956  
	gCMD_WARNING
;

11959 
	g≥î
 = 
≥î_lookup
 (
NULL
, &
su
);

11960 i‡(! 
	g≥î
)

11961  
	gCMD_WARNING
;

11963 
•rötf
 (
«me
, "%s.%d.%d", 
≥î
->
ho°
, 
AFI_IP6
, 
SAFI_UNICAST
);

11964 
	gcou¡
 = 
¥efix_bgp_show_¥efix_li°
 (
NULL
, 
AFI_IP6
, 
«me
);

11965 i‡(
	gcou¡
)

11967 
vty_out
 (
vty
, "Addªs†Ámûy: IPv6 Uniˇ°%s", 
VTY_NEWLINE
);

11968 
¥efix_bgp_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
«me
);

11971  
	gCMD_SUCCESS
;

11974 
ALIAS
 (
show_bgp_√ighb‹_ª˚ived_¥efix_fûãr
,

11975 
show_bgp_ùv6_√ighb‹_ª˚ived_¥efix_fûãr_cmd
,

11977 
SHOW_STR


11978 
BGP_STR


11987 
ALIAS
 (
show_bgp_võw_√ighb‹_ª˚ived_rouãs
,

11988 
ùv6_bgp_√ighb‹_ª˚ived_rouãs_cmd
,

11990 
SHOW_STR


11991 
IPV6_STR


11992 
BGP_STR


11999 
DEFUN
 (
ùv6_mbgp_√ighb‹_ª˚ived_rouãs
,

12000 
ùv6_mbgp_√ighb‹_ª˚ived_rouãs_cmd
,

12002 
SHOW_STR


12003 
IPV6_STR


12004 
MBGP_STR


12010 
≥î
 *
	g≥î
;

12012 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12013 i‡(! 
	g≥î
)

12014  
	gCMD_WARNING
;

12016  
≥î_adj_rouãs
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_MULTICAST
, 1);

12019 
DEFUN
 (
show_bgp_võw_√ighb‹_ª˚ived_¥efix_fûãr
,

12020 
show_bgp_võw_√ighb‹_ª˚ived_¥efix_fûãr_cmd
,

12022 
SHOW_STR


12023 
BGP_STR


12032 
	g«me
[
BUFSIZ
];

12033 
sockuni⁄
 
	gsu
;

12034 
≥î
 *
	g≥î
;

12035 
bgp
 *
	gbgp
;

12036 
	gcou¡
, 
	gªt
;

12039 
	gbgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

12040 i‡(
	gbgp
 =
NULL
)

12042 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

12043  
	gCMD_WARNING
;

12046 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[1], &
su
);

12047 i‡(
	gªt
 < 0)

12049 
vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
¨gv
[1], 
VTY_NEWLINE
);

12050  
	gCMD_WARNING
;

12053 
	g≥î
 = 
≥î_lookup
 (
bgp
, &
su
);

12054 i‡(! 
	g≥î
)

12055  
	gCMD_WARNING
;

12057 
•rötf
 (
«me
, "%s.%d.%d", 
≥î
->
ho°
, 
AFI_IP6
, 
SAFI_UNICAST
);

12058 
	gcou¡
 = 
¥efix_bgp_show_¥efix_li°
 (
NULL
, 
AFI_IP6
, 
«me
);

12059 i‡(
	gcou¡
)

12061 
vty_out
 (
vty
, "Addªs†Ámûy: IPv6 Uniˇ°%s", 
VTY_NEWLINE
);

12062 
¥efix_bgp_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
«me
);

12065  
	gCMD_SUCCESS
;

12068 
ALIAS
 (
show_bgp_võw_√ighb‹_ª˚ived_¥efix_fûãr
,

12069 
show_bgp_võw_ùv6_√ighb‹_ª˚ived_¥efix_fûãr_cmd
,

12071 
SHOW_STR


12072 
BGP_STR


12084 
	$bgp_show_√ighb‹_rouã
 (
vty
 *vty, 
≥î
 *≥î, 
afi_t
 
afi
,

12085 
ßfi_t
 
ßfi
, 
bgp_show_ty≥
 
ty≥
)

12087 i‡(! 
≥î
 || !Öìr->
afc
[
afi
][
ßfi
])

12089 
	`vty_out
 (
vty
, "%% NÿsuchÇeighb‹ o∏addªs†Ámûy%s", 
VTY_NEWLINE
);

12090  
CMD_WARNING
;

12093  
	`bgp_show
 (
vty
, 
≥î
->
bgp
, 
afi
, 
ßfi
, 
ty≥
, &≥î->
su
);

12094 
	}
}

12096 
DEFUN
 (
show_ù_bgp_√ighb‹_rouãs
,

12097 
show_ù_bgp_√ighb‹_rouãs_cmd
,

12099 
SHOW_STR


12100 
IP_STR


12101 
BGP_STR


12107 
≥î
 *
	g≥î
;

12109 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12110 i‡(! 
	g≥î
)

12111  
	gCMD_WARNING
;

12113  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
,

12114 
bgp_show_ty≥_√ighb‹
);

12117 
DEFUN
 (
show_ù_bgp_√ighb‹_Ê≠
,

12118 
show_ù_bgp_√ighb‹_Ê≠_cmd
,

12120 
SHOW_STR


12121 
IP_STR


12122 
BGP_STR


12128 
≥î
 *
	g≥î
;

12130 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12131 i‡(! 
	g≥î
)

12132  
	gCMD_WARNING
;

12134  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
,

12135 
bgp_show_ty≥_Ê≠_√ighb‹
);

12138 
DEFUN
 (
show_ù_bgp_√ighb‹_damp
,

12139 
show_ù_bgp_√ighb‹_damp_cmd
,

12141 
SHOW_STR


12142 
IP_STR


12143 
BGP_STR


12149 
≥î
 *
	g≥î
;

12151 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12152 i‡(! 
	g≥î
)

12153  
	gCMD_WARNING
;

12155  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
,

12156 
bgp_show_ty≥_damp_√ighb‹
);

12159 
DEFUN
 (
show_ù_bgp_ùv4_√ighb‹_rouãs
,

12160 
show_ù_bgp_ùv4_√ighb‹_rouãs_cmd
,

12162 
SHOW_STR


12163 
IP_STR


12164 
BGP_STR


12173 
≥î
 *
	g≥î
;

12175 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

12176 i‡(! 
	g≥î
)

12177  
	gCMD_WARNING
;

12179 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

12180  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_MULTICAST
,

12181 
bgp_show_ty≥_√ighb‹
);

12183  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
,

12184 
bgp_show_ty≥_√ighb‹
);

12187 
DEFUN
 (
show_ù_bgp_võw_rs˛õ¡
,

12188 
show_ù_bgp_võw_rs˛õ¡_cmd
,

12190 
SHOW_STR


12191 
IP_STR


12192 
BGP_STR


12196 
NEIGHBOR_ADDR_STR
)

12198 
bgp_èbÀ
 *
	gèbÀ
;

12199 
≥î
 *
	g≥î
;

12201 i‡(
	g¨gc
 == 2)

12202 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12204 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12206 i‡(! 
	g≥î
)

12207  
	gCMD_WARNING
;

12209 i‡(! 
	g≥î
->
	gafc
[
AFI_IP
][
SAFI_UNICAST
])

12211 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12212 
VTY_NEWLINE
);

12213  
	gCMD_WARNING
;

12216 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
SAFI_UNICAST
],

12217 
PEER_FLAG_RSERVER_CLIENT
))

12219 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12220 
VTY_NEWLINE
);

12221  
	gCMD_WARNING
;

12224 
	gèbÀ
 = 
≥î
->
rib
[
AFI_IP
][
SAFI_UNICAST
];

12226  
bgp_show_èbÀ
 (
vty
, 
èbÀ
, &
≥î
->
ªmŸe_id
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
);

12229 
ALIAS
 (
show_ù_bgp_võw_rs˛õ¡
,

12230 
show_ù_bgp_rs˛õ¡_cmd
,

12232 
SHOW_STR


12233 
IP_STR


12234 
BGP_STR


12236 
NEIGHBOR_ADDR_STR
)

12238 
DEFUN
 (
show_bgp_võw_ùv4_ßfi_rs˛õ¡
,

12239 
show_bgp_võw_ùv4_ßfi_rs˛õ¡_cmd
,

12241 
SHOW_STR


12242 
BGP_STR


12249 
NEIGHBOR_ADDR_STR
)

12251 
bgp_èbÀ
 *
	gèbÀ
;

12252 
≥î
 *
	g≥î
;

12253 
ßfi_t
 
	gßfi
;

12255 i‡(
	g¨gc
 == 3) {

12256 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[2]);

12257 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12259 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

12260 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12263 i‡(! 
	g≥î
)

12264  
	gCMD_WARNING
;

12266 i‡(! 
	g≥î
->
	gafc
[
AFI_IP
][
ßfi
])

12268 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12269 
VTY_NEWLINE
);

12270  
	gCMD_WARNING
;

12273 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
ßfi
],

12274 
PEER_FLAG_RSERVER_CLIENT
))

12276 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12277 
VTY_NEWLINE
);

12278  
	gCMD_WARNING
;

12281 
	gèbÀ
 = 
≥î
->
rib
[
AFI_IP
][
ßfi
];

12283  
bgp_show_èbÀ
 (
vty
, 
èbÀ
, &
≥î
->
ªmŸe_id
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
);

12286 
ALIAS
 (
show_bgp_võw_ùv4_ßfi_rs˛õ¡
,

12287 
show_bgp_ùv4_ßfi_rs˛õ¡_cmd
,

12289 
SHOW_STR


12290 
BGP_STR


12295 
NEIGHBOR_ADDR_STR
)

12297 
DEFUN
 (
show_ù_bgp_võw_rs˛õ¡_rouã
,

12298 
show_ù_bgp_võw_rs˛õ¡_rouã_cmd
,

12300 
SHOW_STR


12301 
IP_STR


12302 
BGP_STR


12306 
NEIGHBOR_ADDR_STR


12309 
bgp
 *
	gbgp
;

12310 
≥î
 *
	g≥î
;

12313 i‡(
	g¨gc
 == 3)

12315 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

12316 i‡(
	gbgp
 =
NULL
)

12318 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

12319  
	gCMD_WARNING
;

12324 
	gbgp
 = 
bgp_gë_deÁu…
 ();

12325 i‡(
	gbgp
 =
NULL
)

12327 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

12328  
	gCMD_WARNING
;

12332 i‡(
	g¨gc
 == 3)

12333 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12335 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12337 i‡(! 
	g≥î
)

12338  
	gCMD_WARNING
;

12340 i‡(! 
	g≥î
->
	gafc
[
AFI_IP
][
SAFI_UNICAST
])

12342 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12343 
VTY_NEWLINE
);

12344  
	gCMD_WARNING
;

12347 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
SAFI_UNICAST
],

12348 
PEER_FLAG_RSERVER_CLIENT
))

12350 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12351 
VTY_NEWLINE
);

12352  
	gCMD_WARNING
;

12355  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP
][
SAFI_UNICAST
],

12356 (
¨gc
 =3Ë? 
¨gv
[2] :árgv[1],

12357 
AFI_IP
, 
SAFI_UNICAST
, 
NULL
, 0);

12360 
ALIAS
 (
show_ù_bgp_võw_rs˛õ¡_rouã
,

12361 
show_ù_bgp_rs˛õ¡_rouã_cmd
,

12363 
SHOW_STR


12364 
IP_STR


12365 
BGP_STR


12367 
NEIGHBOR_ADDR_STR


12370 
DEFUN
 (
show_bgp_võw_ùv4_ßfi_rs˛õ¡_rouã
,

12371 
show_bgp_võw_ùv4_ßfi_rs˛õ¡_rouã_cmd
,

12373 
SHOW_STR


12374 
BGP_STR


12381 
NEIGHBOR_ADDR_STR


12384 
bgp
 *
	gbgp
;

12385 
≥î
 *
	g≥î
;

12386 
ßfi_t
 
	gßfi
;

12389 i‡(
	g¨gc
 == 4)

12391 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

12392 i‡(
	gbgp
 =
NULL
)

12394 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

12395  
	gCMD_WARNING
;

12400 
	gbgp
 = 
bgp_gë_deÁu…
 ();

12401 i‡(
	gbgp
 =
NULL
)

12403 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

12404  
	gCMD_WARNING
;

12408 i‡(
	g¨gc
 == 4) {

12409 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[2]);

12410 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12412 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

12413 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12416 i‡(! 
	g≥î
)

12417  
	gCMD_WARNING
;

12419 i‡(! 
	g≥î
->
	gafc
[
AFI_IP
][
ßfi
])

12421 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12422 
VTY_NEWLINE
);

12423  
	gCMD_WARNING
;

12426 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
ßfi
],

12427 
PEER_FLAG_RSERVER_CLIENT
))

12429 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12430 
VTY_NEWLINE
);

12431  
	gCMD_WARNING
;

12434  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP
][
ßfi
],

12435 (
¨gc
 =4Ë? 
¨gv
[3] :árgv[2],

12436 
AFI_IP
, 
ßfi
, 
NULL
, 0);

12439 
ALIAS
 (
show_bgp_võw_ùv4_ßfi_rs˛õ¡_rouã
,

12440 
show_bgp_ùv4_ßfi_rs˛õ¡_rouã_cmd
,

12442 
SHOW_STR


12443 
BGP_STR


12448 
NEIGHBOR_ADDR_STR


12451 
DEFUN
 (
show_ù_bgp_võw_rs˛õ¡_¥efix
,

12452 
show_ù_bgp_võw_rs˛õ¡_¥efix_cmd
,

12454 
SHOW_STR


12455 
IP_STR


12456 
BGP_STR


12460 
NEIGHBOR_ADDR_STR


12463 
bgp
 *
	gbgp
;

12464 
≥î
 *
	g≥î
;

12467 i‡(
	g¨gc
 == 3)

12469 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

12470 i‡(
	gbgp
 =
NULL
)

12472 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

12473  
	gCMD_WARNING
;

12478 
	gbgp
 = 
bgp_gë_deÁu…
 ();

12479 i‡(
	gbgp
 =
NULL
)

12481 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

12482  
	gCMD_WARNING
;

12486 i‡(
	g¨gc
 == 3)

12487 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12489 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12491 i‡(! 
	g≥î
)

12492  
	gCMD_WARNING
;

12494 i‡(! 
	g≥î
->
	gafc
[
AFI_IP
][
SAFI_UNICAST
])

12496 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12497 
VTY_NEWLINE
);

12498  
	gCMD_WARNING
;

12501 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
SAFI_UNICAST
],

12502 
PEER_FLAG_RSERVER_CLIENT
))

12504 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12505 
VTY_NEWLINE
);

12506  
	gCMD_WARNING
;

12509  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP
][
SAFI_UNICAST
],

12510 (
¨gc
 =3Ë? 
¨gv
[2] :árgv[1],

12511 
AFI_IP
, 
SAFI_UNICAST
, 
NULL
, 1);

12514 
ALIAS
 (
show_ù_bgp_võw_rs˛õ¡_¥efix
,

12515 
show_ù_bgp_rs˛õ¡_¥efix_cmd
,

12517 
SHOW_STR


12518 
IP_STR


12519 
BGP_STR


12521 
NEIGHBOR_ADDR_STR


12524 
DEFUN
 (
show_bgp_võw_ùv4_ßfi_rs˛õ¡_¥efix
,

12525 
show_bgp_võw_ùv4_ßfi_rs˛õ¡_¥efix_cmd
,

12527 
SHOW_STR


12528 
BGP_STR


12535 
NEIGHBOR_ADDR_STR


12538 
bgp
 *
	gbgp
;

12539 
≥î
 *
	g≥î
;

12540 
ßfi_t
 
	gßfi
;

12543 i‡(
	g¨gc
 == 4)

12545 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

12546 i‡(
	gbgp
 =
NULL
)

12548 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

12549  
	gCMD_WARNING
;

12554 
	gbgp
 = 
bgp_gë_deÁu…
 ();

12555 i‡(
	gbgp
 =
NULL
)

12557 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

12558  
	gCMD_WARNING
;

12562 i‡(
	g¨gc
 == 4) {

12563 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[2]);

12564 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12566 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

12567 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12570 i‡(! 
	g≥î
)

12571  
	gCMD_WARNING
;

12573 i‡(! 
	g≥î
->
	gafc
[
AFI_IP
][
ßfi
])

12575 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12576 
VTY_NEWLINE
);

12577  
	gCMD_WARNING
;

12580 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
ßfi
],

12581 
PEER_FLAG_RSERVER_CLIENT
))

12583 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12584 
VTY_NEWLINE
);

12585  
	gCMD_WARNING
;

12588  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP
][
ßfi
],

12589 (
¨gc
 =4Ë? 
¨gv
[3] :árgv[2],

12590 
AFI_IP
, 
ßfi
, 
NULL
, 1);

12593 
ALIAS
 (
show_bgp_võw_ùv4_ßfi_rs˛õ¡_¥efix
,

12594 
show_bgp_ùv4_ßfi_rs˛õ¡_¥efix_cmd
,

12596 
SHOW_STR


12597 
BGP_STR


12602 
NEIGHBOR_ADDR_STR


12605 #ifde‡
HAVE_IPV6


12606 
DEFUN
 (
show_bgp_võw_√ighb‹_rouãs
,

12607 
show_bgp_võw_√ighb‹_rouãs_cmd
,

12609 
SHOW_STR


12610 
BGP_STR


12618 
≥î
 *
	g≥î
;

12620 i‡(
	g¨gc
 == 2)

12621 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12623 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12625 i‡(! 
	g≥î
)

12626  
	gCMD_WARNING
;

12628  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_UNICAST
,

12629 
bgp_show_ty≥_√ighb‹
);

12632 
ALIAS
 (
show_bgp_võw_√ighb‹_rouãs
,

12633 
show_bgp_võw_ùv6_√ighb‹_rouãs_cmd
,

12635 
SHOW_STR


12636 
BGP_STR


12645 
DEFUN
 (
show_bgp_võw_√ighb‹_damp
,

12646 
show_bgp_võw_√ighb‹_damp_cmd
,

12648 
SHOW_STR


12649 
BGP_STR


12657 
≥î
 *
	g≥î
;

12659 i‡(
	g¨gc
 == 2)

12660 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12662 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12664 i‡(! 
	g≥î
)

12665  
	gCMD_WARNING
;

12667  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_UNICAST
,

12668 
bgp_show_ty≥_damp_√ighb‹
);

12671 
ALIAS
 (
show_bgp_võw_√ighb‹_damp
,

12672 
show_bgp_võw_ùv6_√ighb‹_damp_cmd
,

12674 
SHOW_STR


12675 
BGP_STR


12684 
DEFUN
 (
show_bgp_võw_√ighb‹_Ê≠
,

12685 
show_bgp_võw_√ighb‹_Ê≠_cmd
,

12687 
SHOW_STR


12688 
BGP_STR


12696 
≥î
 *
	g≥î
;

12698 i‡(
	g¨gc
 == 2)

12699 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12701 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12703 i‡(! 
	g≥î
)

12704  
	gCMD_WARNING
;

12706  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_UNICAST
,

12707 
bgp_show_ty≥_Ê≠_√ighb‹
);

12710 
ALIAS
 (
show_bgp_võw_√ighb‹_Ê≠
,

12711 
show_bgp_võw_ùv6_√ighb‹_Ê≠_cmd
,

12713 
SHOW_STR


12714 
BGP_STR


12723 
ALIAS
 (
show_bgp_võw_√ighb‹_rouãs
,

12724 
show_bgp_√ighb‹_rouãs_cmd
,

12726 
SHOW_STR


12727 
BGP_STR


12734 
ALIAS
 (
show_bgp_võw_√ighb‹_rouãs
,

12735 
show_bgp_ùv6_√ighb‹_rouãs_cmd
,

12737 
SHOW_STR


12738 
BGP_STR


12746 
ALIAS
 (
show_bgp_võw_√ighb‹_rouãs
,

12747 
ùv6_bgp_√ighb‹_rouãs_cmd
,

12749 
SHOW_STR


12750 
IPV6_STR


12751 
BGP_STR


12758 
DEFUN
 (
ùv6_mbgp_√ighb‹_rouãs
,

12759 
ùv6_mbgp_√ighb‹_rouãs_cmd
,

12761 
SHOW_STR


12762 
IPV6_STR


12763 
MBGP_STR


12769 
≥î
 *
	g≥î
;

12771 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12772 i‡(! 
	g≥î
)

12773  
	gCMD_WARNING
;

12775  
bgp_show_√ighb‹_rouã
 (
vty
, 
≥î
, 
AFI_IP6
, 
SAFI_MULTICAST
,

12776 
bgp_show_ty≥_√ighb‹
);

12779 
ALIAS
 (
show_bgp_võw_√ighb‹_Ê≠
,

12780 
show_bgp_√ighb‹_Ê≠_cmd
,

12782 
SHOW_STR


12783 
BGP_STR


12789 
ALIAS
 (
show_bgp_võw_√ighb‹_Ê≠
,

12790 
show_bgp_ùv6_√ighb‹_Ê≠_cmd
,

12792 
SHOW_STR


12793 
BGP_STR


12800 
ALIAS
 (
show_bgp_võw_√ighb‹_damp
,

12801 
show_bgp_√ighb‹_damp_cmd
,

12803 
SHOW_STR


12804 
BGP_STR


12810 
ALIAS
 (
show_bgp_võw_√ighb‹_damp
,

12811 
show_bgp_ùv6_√ighb‹_damp_cmd
,

12813 
SHOW_STR


12814 
BGP_STR


12821 
DEFUN
 (
show_bgp_võw_rs˛õ¡
,

12822 
show_bgp_võw_rs˛õ¡_cmd
,

12824 
SHOW_STR


12825 
BGP_STR


12829 
NEIGHBOR_ADDR_STR
)

12831 
bgp_èbÀ
 *
	gèbÀ
;

12832 
≥î
 *
	g≥î
;

12834 i‡(
	g¨gc
 == 2)

12835 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12837 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12839 i‡(! 
	g≥î
)

12840  
	gCMD_WARNING
;

12842 i‡(! 
	g≥î
->
	gafc
[
AFI_IP6
][
SAFI_UNICAST
])

12844 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12845 
VTY_NEWLINE
);

12846  
	gCMD_WARNING
;

12849 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
SAFI_UNICAST
],

12850 
PEER_FLAG_RSERVER_CLIENT
))

12852 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12853 
VTY_NEWLINE
);

12854  
	gCMD_WARNING
;

12857 
	gèbÀ
 = 
≥î
->
rib
[
AFI_IP6
][
SAFI_UNICAST
];

12859  
bgp_show_èbÀ
 (
vty
, 
èbÀ
, &
≥î
->
ªmŸe_id
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
);

12862 
ALIAS
 (
show_bgp_võw_rs˛õ¡
,

12863 
show_bgp_rs˛õ¡_cmd
,

12865 
SHOW_STR


12866 
BGP_STR


12868 
NEIGHBOR_ADDR_STR
)

12870 
DEFUN
 (
show_bgp_võw_ùv6_ßfi_rs˛õ¡
,

12871 
show_bgp_võw_ùv6_ßfi_rs˛õ¡_cmd
,

12873 
SHOW_STR


12874 
BGP_STR


12881 
NEIGHBOR_ADDR_STR
)

12883 
bgp_èbÀ
 *
	gèbÀ
;

12884 
≥î
 *
	g≥î
;

12885 
ßfi_t
 
	gßfi
;

12887 i‡(
	g¨gc
 == 3) {

12888 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[2]);

12889 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12891 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

12892 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

12895 i‡(! 
	g≥î
)

12896  
	gCMD_WARNING
;

12898 i‡(! 
	g≥î
->
	gafc
[
AFI_IP6
][
ßfi
])

12900 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12901 
VTY_NEWLINE
);

12902  
	gCMD_WARNING
;

12905 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
ßfi
],

12906 
PEER_FLAG_RSERVER_CLIENT
))

12908 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12909 
VTY_NEWLINE
);

12910  
	gCMD_WARNING
;

12913 
	gèbÀ
 = 
≥î
->
rib
[
AFI_IP6
][
ßfi
];

12915  
bgp_show_èbÀ
 (
vty
, 
èbÀ
, &
≥î
->
ªmŸe_id
, 
bgp_show_ty≥_n‹mÆ
, 
NULL
);

12918 
ALIAS
 (
show_bgp_võw_ùv6_ßfi_rs˛õ¡
,

12919 
show_bgp_ùv6_ßfi_rs˛õ¡_cmd
,

12921 
SHOW_STR


12922 
BGP_STR


12927 
NEIGHBOR_ADDR_STR
)

12929 
DEFUN
 (
show_bgp_võw_rs˛õ¡_rouã
,

12930 
show_bgp_võw_rs˛õ¡_rouã_cmd
,

12932 
SHOW_STR


12933 
BGP_STR


12937 
NEIGHBOR_ADDR_STR


12940 
bgp
 *
	gbgp
;

12941 
≥î
 *
	g≥î
;

12944 i‡(
	g¨gc
 == 3)

12946 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

12947 i‡(
	gbgp
 =
NULL
)

12949 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

12950  
	gCMD_WARNING
;

12955 
	gbgp
 = 
bgp_gë_deÁu…
 ();

12956 i‡(
	gbgp
 =
NULL
)

12958 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

12959  
	gCMD_WARNING
;

12963 i‡(
	g¨gc
 == 3)

12964 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

12966 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

12968 i‡(! 
	g≥î
)

12969  
	gCMD_WARNING
;

12971 i‡(! 
	g≥î
->
	gafc
[
AFI_IP6
][
SAFI_UNICAST
])

12973 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

12974 
VTY_NEWLINE
);

12975  
	gCMD_WARNING
;

12978 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
SAFI_UNICAST
],

12979 
PEER_FLAG_RSERVER_CLIENT
))

12981 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

12982 
VTY_NEWLINE
);

12983  
	gCMD_WARNING
;

12986  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP6
][
SAFI_UNICAST
],

12987 (
¨gc
 =3Ë? 
¨gv
[2] :árgv[1],

12988 
AFI_IP6
, 
SAFI_UNICAST
, 
NULL
, 0);

12991 
ALIAS
 (
show_bgp_võw_rs˛õ¡_rouã
,

12992 
show_bgp_rs˛õ¡_rouã_cmd
,

12994 
SHOW_STR


12995 
BGP_STR


12997 
NEIGHBOR_ADDR_STR


13000 
DEFUN
 (
show_bgp_võw_ùv6_ßfi_rs˛õ¡_rouã
,

13001 
show_bgp_võw_ùv6_ßfi_rs˛õ¡_rouã_cmd
,

13003 
SHOW_STR


13004 
BGP_STR


13011 
NEIGHBOR_ADDR_STR


13014 
bgp
 *
	gbgp
;

13015 
≥î
 *
	g≥î
;

13016 
ßfi_t
 
	gßfi
;

13019 i‡(
	g¨gc
 == 4)

13021 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

13022 i‡(
	gbgp
 =
NULL
)

13024 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

13025  
	gCMD_WARNING
;

13030 
	gbgp
 = 
bgp_gë_deÁu…
 ();

13031 i‡(
	gbgp
 =
NULL
)

13033 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

13034  
	gCMD_WARNING
;

13038 i‡(
	g¨gc
 == 4) {

13039 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[2]);

13040 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

13042 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

13043 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

13046 i‡(! 
	g≥î
)

13047  
	gCMD_WARNING
;

13049 i‡(! 
	g≥î
->
	gafc
[
AFI_IP6
][
ßfi
])

13051 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

13052 
VTY_NEWLINE
);

13053  
	gCMD_WARNING
;

13056 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
ßfi
],

13057 
PEER_FLAG_RSERVER_CLIENT
))

13059 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

13060 
VTY_NEWLINE
);

13061  
	gCMD_WARNING
;

13064  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP6
][
ßfi
],

13065 (
¨gc
 =4Ë? 
¨gv
[3] :árgv[2],

13066 
AFI_IP6
, 
ßfi
, 
NULL
, 0);

13069 
ALIAS
 (
show_bgp_võw_ùv6_ßfi_rs˛õ¡_rouã
,

13070 
show_bgp_ùv6_ßfi_rs˛õ¡_rouã_cmd
,

13072 
SHOW_STR


13073 
BGP_STR


13078 
NEIGHBOR_ADDR_STR


13081 
DEFUN
 (
show_bgp_võw_rs˛õ¡_¥efix
,

13082 
show_bgp_võw_rs˛õ¡_¥efix_cmd
,

13084 
SHOW_STR


13085 
BGP_STR


13089 
NEIGHBOR_ADDR_STR


13092 
bgp
 *
	gbgp
;

13093 
≥î
 *
	g≥î
;

13096 i‡(
	g¨gc
 == 3)

13098 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

13099 i‡(
	gbgp
 =
NULL
)

13101 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

13102  
	gCMD_WARNING
;

13107 
	gbgp
 = 
bgp_gë_deÁu…
 ();

13108 i‡(
	gbgp
 =
NULL
)

13110 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

13111  
	gCMD_WARNING
;

13115 i‡(
	g¨gc
 == 3)

13116 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[1]);

13118 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[0]);

13120 i‡(! 
	g≥î
)

13121  
	gCMD_WARNING
;

13123 i‡(! 
	g≥î
->
	gafc
[
AFI_IP6
][
SAFI_UNICAST
])

13125 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

13126 
VTY_NEWLINE
);

13127  
	gCMD_WARNING
;

13130 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
SAFI_UNICAST
],

13131 
PEER_FLAG_RSERVER_CLIENT
))

13133 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

13134 
VTY_NEWLINE
);

13135  
	gCMD_WARNING
;

13138  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP6
][
SAFI_UNICAST
],

13139 (
¨gc
 =3Ë? 
¨gv
[2] :árgv[1],

13140 
AFI_IP6
, 
SAFI_UNICAST
, 
NULL
, 1);

13143 
ALIAS
 (
show_bgp_võw_rs˛õ¡_¥efix
,

13144 
show_bgp_rs˛õ¡_¥efix_cmd
,

13146 
SHOW_STR


13147 
BGP_STR


13149 
NEIGHBOR_ADDR_STR


13152 
DEFUN
 (
show_bgp_võw_ùv6_ßfi_rs˛õ¡_¥efix
,

13153 
show_bgp_võw_ùv6_ßfi_rs˛õ¡_¥efix_cmd
,

13155 
SHOW_STR


13156 
BGP_STR


13163 
NEIGHBOR_ADDR_STR


13166 
bgp
 *
	gbgp
;

13167 
≥î
 *
	g≥î
;

13168 
ßfi_t
 
	gßfi
;

13171 i‡(
	g¨gc
 == 4)

13173 
bgp
 = 
bgp_lookup_by_«me
 (
¨gv
[0]);

13174 i‡(
	gbgp
 =
NULL
)

13176 
vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

13177  
	gCMD_WARNING
;

13182 
	gbgp
 = 
bgp_gë_deÁu…
 ();

13183 i‡(
	gbgp
 =
NULL
)

13185 
vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

13186  
	gCMD_WARNING
;

13190 i‡(
	g¨gc
 == 4) {

13191 
≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
¨gv
[0],árgv[2]);

13192 
	gßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

13194 
	g≥î
 = 
≥î_lookup_ö_võw
 (
vty
, 
NULL
, 
¨gv
[1]);

13195 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

13198 i‡(! 
	g≥î
)

13199  
	gCMD_WARNING
;

13201 i‡(! 
	g≥î
->
	gafc
[
AFI_IP6
][
ßfi
])

13203 
vty_out
 (
vty
, "%% ActivateÅheÇeighbor forÅheáddress family first%s",

13204 
VTY_NEWLINE
);

13205  
	gCMD_WARNING
;

13208 i‡–! 
CHECK_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
ßfi
],

13209 
PEER_FLAG_RSERVER_CLIENT
))

13211 
vty_out
 (
vty
, "%% Neighbor isÇotá Route-Server client%s",

13212 
VTY_NEWLINE
);

13213  
	gCMD_WARNING
;

13216  
bgp_show_rouã_ö_èbÀ
 (
vty
, 
bgp
, 
≥î
->
rib
[
AFI_IP6
][
ßfi
],

13217 (
¨gc
 =4Ë? 
¨gv
[3] :árgv[2],

13218 
AFI_IP6
, 
ßfi
, 
NULL
, 1);

13221 
ALIAS
 (
show_bgp_võw_ùv6_ßfi_rs˛õ¡_¥efix
,

13222 
show_bgp_ùv6_ßfi_rs˛õ¡_¥efix_cmd
,

13224 
SHOW_STR


13225 
BGP_STR


13230 
NEIGHBOR_ADDR_STR


13235 
bgp_èbÀ
 *
	gbgp_di°™˚_èbÀ
;

13237 
	sbgp_di°™˚


13240 
u_ch¨
 
	mdi°™˚
;

13243 *
	mac˚ss_li°
;

13246 
bgp_di°™˚
 *

13247 
	$bgp_di°™˚_√w
 ()

13249  
	`XCALLOC
 (
MTYPE_BGP_DISTANCE
,  (
bgp_di°™˚
));

13250 
	}
}

13253 
	$bgp_di°™˚_‰ì
 (
bgp_di°™˚
 *
bdi°™˚
)

13255 
	`XFREE
 (
MTYPE_BGP_DISTANCE
, 
bdi°™˚
);

13256 
	}
}

13259 
	$bgp_di°™˚_£t
 (
vty
 *vty, c⁄° *
di°™˚_°r
,

13260 c⁄° *
ù_°r
, c⁄° *
ac˚ss_li°_°r
)

13262 
ªt
;

13263 
¥efix_ùv4
 
p
;

13264 
u_ch¨
 
di°™˚
;

13265 
bgp_node
 *
∫
;

13266 
bgp_di°™˚
 *
bdi°™˚
;

13268 
ªt
 = 
	`°r2¥efix_ùv4
 (
ù_°r
, &
p
);

13269 i‡(
ªt
 == 0)

13271 
	`vty_out
 (
vty
, "MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

13272  
CMD_WARNING
;

13275 
di°™˚
 = 
	`©oi
 (
di°™˚_°r
);

13278 
∫
 = 
	`bgp_node_gë
 (
bgp_di°™˚_èbÀ
, (
¥efix
 *Ë&
p
);

13279 i‡(
∫
->
öfo
)

13281 
bdi°™˚
 = 
∫
->
öfo
;

13282 
	`bgp_u∆ock_node
 (
∫
);

13286 
bdi°™˚
 = 
	`bgp_di°™˚_√w
 ();

13287 
∫
->
öfo
 = 
bdi°™˚
;

13291 
bdi°™˚
->
di°™˚
 = distance;

13294 i‡(
bdi°™˚
->
ac˚ss_li°
)

13296 
	`‰ì
 (
bdi°™˚
->
ac˚ss_li°
);

13297 
bdi°™˚
->
ac˚ss_li°
 = 
NULL
;

13299 i‡(
ac˚ss_li°_°r
)

13300 
bdi°™˚
->
ac˚ss_li°
 = 
	`°rdup
 (
ac˚ss_li°_°r
);

13302  
CMD_SUCCESS
;

13303 
	}
}

13306 
	$bgp_di°™˚_un£t
 (
vty
 *vty, c⁄° *
di°™˚_°r
,

13307 c⁄° *
ù_°r
, c⁄° *
ac˚ss_li°_°r
)

13309 
ªt
;

13310 
¥efix_ùv4
 
p
;

13311 
u_ch¨
 
di°™˚
;

13312 
bgp_node
 *
∫
;

13313 
bgp_di°™˚
 *
bdi°™˚
;

13315 
ªt
 = 
	`°r2¥efix_ùv4
 (
ù_°r
, &
p
);

13316 i‡(
ªt
 == 0)

13318 
	`vty_out
 (
vty
, "MÆf‹medÖªfix%s", 
VTY_NEWLINE
);

13319  
CMD_WARNING
;

13322 
di°™˚
 = 
	`©oi
 (
di°™˚_°r
);

13324 
∫
 = 
	`bgp_node_lookup
 (
bgp_di°™˚_èbÀ
, (
¥efix
 *)&
p
);

13325 i‡(! 
∫
)

13327 
	`vty_out
 (
vty
, "C™'àföd s≥cifõdÖªfix%s", 
VTY_NEWLINE
);

13328  
CMD_WARNING
;

13331 
bdi°™˚
 = 
∫
->
öfo
;

13333 i‡(
bdi°™˚
->
ac˚ss_li°
)

13334 
	`‰ì
 (
bdi°™˚
->
ac˚ss_li°
);

13335 
	`bgp_di°™˚_‰ì
 (
bdi°™˚
);

13337 
∫
->
öfo
 = 
NULL
;

13338 
	`bgp_u∆ock_node
 (
∫
);

13339 
	`bgp_u∆ock_node
 (
∫
);

13341  
CMD_SUCCESS
;

13342 
	}
}

13345 
u_ch¨


13346 
	$bgp_di°™˚_≠∂y
 (
¥efix
 *
p
, 
bgp_öfo
 *
röfo
, 
bgp
 *bgp)

13348 
bgp_node
 *
∫
;

13349 
¥efix_ùv4
 
q
;

13350 
≥î
 *peer;

13351 
bgp_di°™˚
 *
bdi°™˚
;

13352 
ac˚ss_li°
 *
Æi°
;

13353 
bgp_°©ic
 *bgp_static;

13355 i‡(! 
bgp
)

13358 i‡(
p
->
Ámûy
 !
AF_INET
)

13361 
≥î
 = 
röfo
->peer;

13363 i‡(
≥î
->
su
.
ß
.
ß_Ámûy
 !
AF_INET
)

13366 
	`mem£t
 (&
q
, 0,  (
¥efix_ùv4
));

13367 
q
.
Ámûy
 = 
AF_INET
;

13368 
q
.
¥efix
 = 
≥î
->
su
.
sö
.
sö_addr
;

13369 
q
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

13372 
∫
 = 
	`bgp_node_m©ch
 (
bgp_di°™˚_èbÀ
, (
¥efix
 *Ë&
q
);

13373 i‡(
∫
)

13375 
bdi°™˚
 = 
∫
->
öfo
;

13376 
	`bgp_u∆ock_node
 (
∫
);

13378 i‡(
bdi°™˚
->
ac˚ss_li°
)

13380 
Æi°
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP
, 
bdi°™˚
->
ac˚ss_li°
);

13381 i‡(
Æi°
 && 
	`ac˚ss_li°_≠∂y
 (Æi°, 
p
Ë=
FILTER_PERMIT
)

13382  
bdi°™˚
->
di°™˚
;

13385  
bdi°™˚
->
di°™˚
;

13389 
∫
 = 
	`bgp_node_lookup
 (
bgp
->
rouã
[
AFI_IP
][
SAFI_UNICAST
], 
p
);

13390 i‡(
∫
)

13392 
bgp_°©ic
 = 
∫
->
öfo
;

13393 
	`bgp_u∆ock_node
 (
∫
);

13395 i‡(
bgp_°©ic
->
backdo‹
)

13397 i‡(
bgp
->
di°™˚_loˇl
)

13398  
bgp
->
di°™˚_loˇl
;

13400  
ZEBRA_IBGP_DISTANCE_DEFAULT
;

13404 i‡(
≥î
->
s‹t
 =
BGP_PEER_EBGP
)

13406 i‡(
bgp
->
di°™˚_ebgp
)

13407  
bgp
->
di°™˚_ebgp
;

13408  
ZEBRA_EBGP_DISTANCE_DEFAULT
;

13412 i‡(
bgp
->
di°™˚_ibgp
)

13413  
bgp
->
di°™˚_ibgp
;

13414  
ZEBRA_IBGP_DISTANCE_DEFAULT
;

13416 
	}
}

13418 
DEFUN
 (
bgp_di°™˚
,

13419 
bgp_di°™˚_cmd
,

13427 
bgp
 *
	gbgp
;

13429 
	gbgp
 = 
vty
->
ödex
;

13431 
	gbgp
->
	gdi°™˚_ebgp
 = 
©oi
 (
¨gv
[0]);

13432 
	gbgp
->
	gdi°™˚_ibgp
 = 
©oi
 (
¨gv
[1]);

13433 
	gbgp
->
	gdi°™˚_loˇl
 = 
©oi
 (
¨gv
[2]);

13434  
	gCMD_SUCCESS
;

13437 
DEFUN
 (
no_bgp_di°™˚
,

13438 
no_bgp_di°™˚_cmd
,

13440 
NO_STR


13447 
bgp
 *
	gbgp
;

13449 
	gbgp
 = 
vty
->
ödex
;

13451 
	gbgp
->
	gdi°™˚_ebgp
= 0;

13452 
	gbgp
->
	gdi°™˚_ibgp
 = 0;

13453 
	gbgp
->
	gdi°™˚_loˇl
 = 0;

13454  
	gCMD_SUCCESS
;

13457 
ALIAS
 (
no_bgp_di°™˚
,

13458 
no_bgp_di°™˚2_cmd
,

13460 
NO_STR


13464 
DEFUN
 (
bgp_di°™˚_sour˚
,

13465 
bgp_di°™˚_sour˚_cmd
,

13471 
bgp_di°™˚_£t
 (
vty
, 
¨gv
[0],árgv[1], 
NULL
);

13472  
	gCMD_SUCCESS
;

13475 
DEFUN
 (
no_bgp_di°™˚_sour˚
,

13476 
no_bgp_di°™˚_sour˚_cmd
,

13478 
NO_STR


13483 
bgp_di°™˚_un£t
 (
vty
, 
¨gv
[0],árgv[1], 
NULL
);

13484  
	gCMD_SUCCESS
;

13487 
DEFUN
 (
bgp_di°™˚_sour˚_ac˚ss_li°
,

13488 
bgp_di°™˚_sour˚_ac˚ss_li°_cmd
,

13495 
bgp_di°™˚_£t
 (
vty
, 
¨gv
[0],árgv[1],árgv[2]);

13496  
	gCMD_SUCCESS
;

13499 
DEFUN
 (
no_bgp_di°™˚_sour˚_ac˚ss_li°
,

13500 
no_bgp_di°™˚_sour˚_ac˚ss_li°_cmd
,

13502 
NO_STR


13508 
bgp_di°™˚_un£t
 (
vty
, 
¨gv
[0],árgv[1],árgv[2]);

13509  
	gCMD_SUCCESS
;

13512 
DEFUN
 (
bgp_damp_£t
,

13513 
bgp_damp_£t_cmd
,

13522 
bgp
 *
	gbgp
;

13523 
	ghÆf
 = 
DEFAULT_HALF_LIFE
 * 60;

13524 
	gªu£
 = 
DEFAULT_REUSE
;

13525 
	gsuµªss
 = 
DEFAULT_SUPPRESS
;

13526 
	gmax
 = 4 * 
hÆf
;

13528 i‡(
	g¨gc
 == 4)

13530 
hÆf
 = 
©oi
 (
¨gv
[0]) * 60;

13531 
	gªu£
 = 
©oi
 (
¨gv
[1]);

13532 
	gsuµªss
 = 
©oi
 (
¨gv
[2]);

13533 
	gmax
 = 
©oi
 (
¨gv
[3]) * 60;

13535 i‡(
	g¨gc
 == 1)

13537 
hÆf
 = 
©oi
 (
¨gv
[0]) * 60;

13538 
	gmax
 = 4 * 
hÆf
;

13541 
	gbgp
 = 
vty
->
ödex
;

13542  
bgp_damp_íabÀ
 (
bgp
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty),

13543 
hÆf
, 
ªu£
, 
suµªss
, 
max
);

13546 
ALIAS
 (
bgp_damp_£t
,

13547 
bgp_damp_£t2_cmd
,

13553 
ALIAS
 (
bgp_damp_£t
,

13554 
bgp_damp_£t3_cmd
,

13559 
DEFUN
 (
bgp_damp_un£t
,

13560 
bgp_damp_un£t_cmd
,

13562 
NO_STR


13566 
bgp
 *
	gbgp
;

13568 
	gbgp
 = 
vty
->
ödex
;

13569  
bgp_damp_dißbÀ
 (
bgp
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty));

13572 
ALIAS
 (
bgp_damp_un£t
,

13573 
bgp_damp_un£t2_cmd
,

13575 
NO_STR


13583 
DEFUN
 (
show_ù_bgp_dam≥√d_∑ths
,

13584 
show_ù_bgp_dam≥√d_∑ths_cmd
,

13586 
SHOW_STR


13587 
IP_STR


13588 
BGP_STR


13591  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
bgp_show_ty≥_dam≥nd_∑ths
,

13592 
NULL
);

13595 
DEFUN
 (
show_ù_bgp_Ê≠_°©i°ics
,

13596 
show_ù_bgp_Ê≠_°©i°ics_cmd
,

13598 
SHOW_STR


13599 
IP_STR


13600 
BGP_STR


13603  
bgp_show
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
,

13604 
bgp_show_ty≥_Ê≠_°©i°ics
, 
NULL
);

13609 
	$bgp_˛ór_damp_rouã
 (
vty
 *vty, c⁄° *
võw_«me
,

13610 c⁄° *
ù_°r
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

13611 
¥efix_rd
 *
¥d
, 
¥efix_check
)

13613 
ªt
;

13614 
¥efix
 
m©ch
;

13615 
bgp_node
 *
∫
;

13616 
bgp_node
 *
rm
;

13617 
bgp_öfo
 *
ri
;

13618 
bgp_öfo
 *
ri_ãmp
;

13619 
bgp
 *bgp;

13620 
bgp_èbÀ
 *
èbÀ
;

13623 i‡(
võw_«me
)

13625 
bgp
 = 
	`bgp_lookup_by_«me
 (
võw_«me
);

13626 i‡(
bgp
 =
NULL
)

13628 
	`vty_out
 (
vty
, "%% C™'àföd BGP võw %s%s", 
võw_«me
, 
VTY_NEWLINE
);

13629  
CMD_WARNING
;

13634 
bgp
 = 
	`bgp_gë_deÁu…
 ();

13635 i‡(
bgp
 =
NULL
)

13637 
	`vty_out
 (
vty
, "%% NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

13638  
CMD_WARNING
;

13643 
ªt
 = 
	`°r2¥efix
 (
ù_°r
, &
m©ch
);

13644 i‡(! 
ªt
)

13646 
	`vty_out
 (
vty
, "%%áddªs†i†mÆf‹med%s", 
VTY_NEWLINE
);

13647  
CMD_WARNING
;

13650 
m©ch
.
Ámûy
 = 
	`afi2Ámûy
 (
afi
);

13652 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

13654 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rib
[
AFI_IP
][
SAFI_MPLS_VPN
]);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

13656 i‡(
¥d
 && 
	`memcmp
 (
∫
->
p
.
u
.
vÆ
,Örd->val, 8) != 0)

13659 i‡((
èbÀ
 = 
∫
->
öfo
Ë!
NULL
)

13660 i‡((
rm
 = 
	`bgp_node_m©ch
 (
èbÀ
, &
m©ch
)Ë!
NULL
)

13662 i‡(! 
¥efix_check
 || 
rm
->
p
.
¥efixÀn
 =
m©ch
.prefixlen)

13664 
ri
 = 
rm
->
öfo
;

13665 
ri
)

13667 i‡(
ri
->
exåa
 &&Ñi->exåa->
damp_öfo
)

13669 
ri_ãmp
 = 
ri
->
√xt
;

13670 
	`bgp_damp_öfo_‰ì
 (
ri
->
exåa
->
damp_öfo
, 1);

13671 
ri
 = 
ri_ãmp
;

13674 
ri
 =Ñi->
√xt
;

13678 
	`bgp_u∆ock_node
 (
rm
);

13684 i‡((
∫
 = 
	`bgp_node_m©ch
 (
bgp
->
rib
[
afi
][
ßfi
], &
m©ch
)Ë!
NULL
)

13686 i‡(! 
¥efix_check
 || 
∫
->
p
.
¥efixÀn
 =
m©ch
.prefixlen)

13688 
ri
 = 
∫
->
öfo
;

13689 
ri
)

13691 i‡(
ri
->
exåa
 &&Ñi->exåa->
damp_öfo
)

13693 
ri_ãmp
 = 
ri
->
√xt
;

13694 
	`bgp_damp_öfo_‰ì
 (
ri
->
exåa
->
damp_öfo
, 1);

13695 
ri
 = 
ri_ãmp
;

13698 
ri
 =Ñi->
√xt
;

13702 
	`bgp_u∆ock_node
 (
∫
);

13706  
CMD_SUCCESS
;

13707 
	}
}

13709 
DEFUN
 (
˛ór_ù_bgp_dam≥nög
,

13710 
˛ór_ù_bgp_dam≥nög_cmd
,

13712 
CLEAR_STR


13713 
IP_STR


13714 
BGP_STR


13717 
bgp_damp_öfo_˛ón
 ();

13718  
	gCMD_SUCCESS
;

13721 
DEFUN
 (
˛ór_ù_bgp_dam≥nög_¥efix
,

13722 
˛ór_ù_bgp_dam≥nög_¥efix_cmd
,

13724 
CLEAR_STR


13725 
IP_STR


13726 
BGP_STR


13730  
bgp_˛ór_damp_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP
,

13731 
SAFI_UNICAST
, 
NULL
, 1);

13734 
DEFUN
 (
˛ór_ù_bgp_dam≥nög_addªss
,

13735 
˛ór_ù_bgp_dam≥nög_addªss_cmd
,

13737 
CLEAR_STR


13738 
IP_STR


13739 
BGP_STR


13743  
bgp_˛ór_damp_rouã
 (
vty
, 
NULL
, 
¨gv
[0], 
AFI_IP
,

13744 
SAFI_UNICAST
, 
NULL
, 0);

13747 
DEFUN
 (
˛ór_ù_bgp_dam≥nög_addªss_mask
,

13748 
˛ór_ù_bgp_dam≥nög_addªss_mask_cmd
,

13750 
CLEAR_STR


13751 
IP_STR


13752 
BGP_STR


13757 
	gªt
;

13758 
	g¥efix_°r
[
BUFSIZ
];

13760 
	gªt
 = 
√tmask_°r2¥efix_°r
 (
¨gv
[0],árgv[1], 
¥efix_°r
);

13761 i‡(! 
	gªt
)

13763 
vty_out
 (
vty
, "%% Inc⁄si°íàaddªs†™d mask%s", 
VTY_NEWLINE
);

13764  
	gCMD_WARNING
;

13767  
bgp_˛ór_damp_rouã
 (
vty
, 
NULL
, 
¥efix_°r
, 
AFI_IP
,

13768 
SAFI_UNICAST
, 
NULL
, 0);

13772 
	$bgp_c⁄fig_wrôe_√tw‹k_v≤v4
 (
vty
 *vty, 
bgp
 *bgp,

13773 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, *
wrôe
)

13775 
bgp_node
 *
¥n
;

13776 
bgp_node
 *
∫
;

13777 
bgp_èbÀ
 *
èbÀ
;

13778 
¥efix
 *
p
;

13779 
¥efix_rd
 *
¥d
;

13780 
bgp_°©ic
 *bgp_static;

13781 
u_öt32_t
 
œbñ
;

13782 
buf
[
SU_ADDRSTRLEN
];

13783 
rdbuf
[
RD_ADDRSTRLEN
];

13786 
¥n
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rouã
[
afi
][
ßfi
]);Ö∫;Ö∫ = 
	`bgp_rouã_√xt
 (prn))

13787 i‡((
èbÀ
 = 
¥n
->
öfo
Ë!
NULL
)

13788 
∫
 = 
	`bgp_èbÀ_t›
 (
èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

13789 i‡((
bgp_°©ic
 = 
∫
->
öfo
Ë!
NULL
)

13791 
p
 = &
∫
->p;

13792 
¥d
 = (
¥efix_rd
 *Ë&
¥n
->
p
;

13795 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, 
wrôe
);

13798 
	`¥efix_rd2°r
 (
¥d
, 
rdbuf
, 
RD_ADDRSTRLEN
);

13799 
œbñ
 = 
	`decode_œbñ
 (
bgp_°©ic
->
èg
);

13801 
	`vty_out
 (
vty
, "Çetwork %s/%dÑd %sÅag %d",

13802 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

13803 
p
->
¥efixÀn
,

13804 
rdbuf
, 
œbñ
);

13805 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

13808 
	}
}

13813 
	$bgp_c⁄fig_wrôe_√tw‹k
 (
vty
 *vty, 
bgp
 *bgp,

13814 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, *
wrôe
)

13816 
bgp_node
 *
∫
;

13817 
¥efix
 *
p
;

13818 
bgp_°©ic
 *bgp_static;

13819 
bgp_aggªg©e
 *bgp_aggregate;

13820 
buf
[
SU_ADDRSTRLEN
];

13822 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_MPLS_VPN
)

13823  
	`bgp_c⁄fig_wrôe_√tw‹k_v≤v4
 (
vty
, 
bgp
, 
afi
, 
ßfi
, 
wrôe
);

13826 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rouã
[
afi
][
ßfi
]);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

13827 i‡((
bgp_°©ic
 = 
∫
->
öfo
Ë!
NULL
)

13829 
p
 = &
∫
->p;

13832 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, 
wrôe
);

13835 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
Ë&& 
afi
 =
AFI_IP
)

13837 
u_öt32_t
 
de°ö©i⁄
;

13838 
ö_addr
 
√tmask
;

13840 
de°ö©i⁄
 = 
	`¡ohl
 (
p
->
u
.
¥efix4
.
s_addr
);

13841 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
√tmask
);

13842 
	`vty_out
 (
vty
, "Çetwork %s",

13843 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
));

13845 i‡((
	`IN_CLASSC
 (
de°ö©i⁄
Ë&& 
p
->
¥efixÀn
 == 24)

13846 || (
	`IN_CLASSB
 (
de°ö©i⁄
Ë&& 
p
->
¥efixÀn
 == 16)

13847 || (
	`IN_CLASSA
 (
de°ö©i⁄
Ë&& 
p
->
¥efixÀn
 == 8)

13848 || 
p
->
u
.
¥efix4
.
s_addr
 == 0)

13853 
	`vty_out
 (
vty
, " mask %s", 
	`öë_¡ﬂ
 (
√tmask
));

13857 
	`vty_out
 (
vty
, "Çetwork %s/%d",

13858 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

13859 
p
->
¥efixÀn
);

13862 i‡(
bgp_°©ic
->
rm≠
.
«me
)

13863 
	`vty_out
 (
vty
, "Ñouã-m≠ %s", 
bgp_°©ic
->
rm≠
.
«me
);

13866 i‡(
bgp_°©ic
->
backdo‹
)

13867 
	`vty_out
 (
vty
, " backdoor");

13870 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

13874 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
aggªg©e
[
afi
][
ßfi
]);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

13875 i‡((
bgp_aggªg©e
 = 
∫
->
öfo
Ë!
NULL
)

13877 
p
 = &
∫
->p;

13880 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, 
wrôe
);

13882 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
Ë&& 
afi
 =
AFI_IP
)

13884 
ö_addr
 
√tmask
;

13886 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
√tmask
);

13887 
	`vty_out
 (
vty
, "ággregate-address %s %s",

13888 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

13889 
	`öë_¡ﬂ
 (
√tmask
));

13893 
	`vty_out
 (
vty
, "ággregate-address %s/%d",

13894 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
SU_ADDRSTRLEN
),

13895 
p
->
¥efixÀn
);

13898 i‡(
bgp_aggªg©e
->
as_£t
)

13899 
	`vty_out
 (
vty
, "ás-set");

13901 i‡(
bgp_aggªg©e
->
summ¨y_⁄ly
)

13902 
	`vty_out
 (
vty
, " summary-only");

13904 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

13908 
	}
}

13911 
	$bgp_c⁄fig_wrôe_di°™˚
 (
vty
 *vty, 
bgp
 *bgp)

13913 
bgp_node
 *
∫
;

13914 
bgp_di°™˚
 *
bdi°™˚
;

13917 i‡(
bgp
->
di°™˚_ebgp


13918 && 
bgp
->
di°™˚_ibgp


13919 && 
bgp
->
di°™˚_loˇl


13920 && (
bgp
->
di°™˚_ebgp
 !
ZEBRA_EBGP_DISTANCE_DEFAULT


13921 || 
bgp
->
di°™˚_ibgp
 !
ZEBRA_IBGP_DISTANCE_DEFAULT


13922 || 
bgp
->
di°™˚_loˇl
 !
ZEBRA_IBGP_DISTANCE_DEFAULT
))

13923 
	`vty_out
 (
vty
, " distance bgp %d %d %d%s",

13924 
bgp
->
di°™˚_ebgp
, bgp->
di°™˚_ibgp
, bgp->
di°™˚_loˇl
,

13925 
VTY_NEWLINE
);

13927 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp_di°™˚_èbÀ
);Ñn;Ñ¿
	`bgp_rouã_√xt
 (rn))

13928 i‡((
bdi°™˚
 = 
∫
->
öfo
Ë!
NULL
)

13930 
	`vty_out
 (
vty
, " di°™˚ %d %s/%d %s%s", 
bdi°™˚
->
di°™˚
,

13931 
	`öë_¡ﬂ
 (
∫
->
p
.
u
.
¥efix4
),Ñn->p.
¥efixÀn
,

13932 
bdi°™˚
->
ac˚ss_li°
 ? bdistance->access_list : "",

13933 
VTY_NEWLINE
);

13937 
	}
}

13941 
	$bgp_rouã_öô
 ()

13944 
bgp_di°™˚_èbÀ
 = 
	`bgp_èbÀ_öô
 (
AFI_IP
, 
SAFI_UNICAST
);

13947 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_cmd
);

13948 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_cmd
);

13949 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_«tuøl_cmd
);

13950 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_rouã_m≠_cmd
);

13951 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_rouã_m≠_cmd
);

13952 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
);

13953 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_backdo‹_cmd
);

13954 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_backdo‹_cmd
);

13955 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_«tuøl_backdo‹_cmd
);

13956 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_cmd
);

13957 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_cmd
);

13958 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_cmd
);

13959 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_rouã_m≠_cmd
);

13960 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_rouã_m≠_cmd
);

13961 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
);

13962 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_backdo‹_cmd
);

13963 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_backdo‹_cmd
);

13964 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_backdo‹_cmd
);

13966 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_cmd
);

13967 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_mask_cmd
);

13968 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_summ¨y_⁄ly_cmd
);

13969 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
);

13970 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_as_£t_cmd
);

13971 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_mask_as_£t_cmd
);

13972 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_as_£t_summ¨y_cmd
);

13973 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_mask_as_£t_summ¨y_cmd
);

13974 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_summ¨y_as_£t_cmd
);

13975 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
aggªg©e_addªss_mask_summ¨y_as_£t_cmd
);

13976 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_cmd
);

13977 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_summ¨y_⁄ly_cmd
);

13978 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_as_£t_cmd
);

13979 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_as_£t_summ¨y_cmd
);

13980 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_summ¨y_as_£t_cmd
);

13981 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_mask_cmd
);

13982 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
);

13983 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_mask_as_£t_cmd
);

13984 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_mask_as_£t_summ¨y_cmd
);

13985 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_aggªg©e_addªss_mask_summ¨y_as_£t_cmd
);

13988 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_cmd
);

13989 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_cmd
);

13990 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_«tuøl_cmd
);

13991 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_rouã_m≠_cmd
);

13992 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_rouã_m≠_cmd
);

13993 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
);

13994 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_cmd
);

13995 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_cmd
);

13996 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_cmd
);

13997 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_rouã_m≠_cmd
);

13998 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_rouã_m≠_cmd
);

13999 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
);

14001 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_cmd
);

14002 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_mask_cmd
);

14003 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14004 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
);

14005 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_as_£t_cmd
);

14006 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_mask_as_£t_cmd
);

14007 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_as_£t_summ¨y_cmd
);

14008 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_mask_as_£t_summ¨y_cmd
);

14009 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_summ¨y_as_£t_cmd
);

14010 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
aggªg©e_addªss_mask_summ¨y_as_£t_cmd
);

14011 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_cmd
);

14012 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14013 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_as_£t_cmd
);

14014 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_as_£t_summ¨y_cmd
);

14015 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_summ¨y_as_£t_cmd
);

14016 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_mask_cmd
);

14017 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
);

14018 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_mask_as_£t_cmd
);

14019 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_mask_as_£t_summ¨y_cmd
);

14020 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_aggªg©e_addªss_mask_summ¨y_as_£t_cmd
);

14023 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_cmd
);

14024 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_cmd
);

14025 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_«tuøl_cmd
);

14026 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_rouã_m≠_cmd
);

14027 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_rouã_m≠_cmd
);

14028 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
);

14029 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_cmd
);

14030 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_cmd
);

14031 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_cmd
);

14032 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_rouã_m≠_cmd
);

14033 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_rouã_m≠_cmd
);

14034 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_rouã_m≠_cmd
);

14035 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_cmd
);

14036 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_mask_cmd
);

14037 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14038 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
);

14039 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_as_£t_cmd
);

14040 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_mask_as_£t_cmd
);

14041 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_as_£t_summ¨y_cmd
);

14042 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_mask_as_£t_summ¨y_cmd
);

14043 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_summ¨y_as_£t_cmd
);

14044 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
aggªg©e_addªss_mask_summ¨y_as_£t_cmd
);

14045 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_cmd
);

14046 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14047 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_as_£t_cmd
);

14048 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_as_£t_summ¨y_cmd
);

14049 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_summ¨y_as_£t_cmd
);

14050 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_mask_cmd
);

14051 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_mask_summ¨y_⁄ly_cmd
);

14052 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_mask_as_£t_cmd
);

14053 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_mask_as_£t_summ¨y_cmd
);

14054 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_aggªg©e_addªss_mask_summ¨y_as_£t_cmd
);

14056 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_cmd
);

14057 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_cmd
);

14058 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_cmd
);

14059 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_rouã_cmd
);

14060 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_rouã_cmd
);

14061 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_rouã_cmd
);

14062 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_rouã_cmd
);

14063 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_rouã_cmd
);

14064 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_¥efix_cmd
);

14065 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_¥efix_cmd
);

14066 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_¥efix_cmd
);

14067 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_¥efix_cmd
);

14068 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_¥efix_cmd
);

14069 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_cmd
);

14070 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_rouã_cmd
);

14071 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_¥efix_cmd
);

14072 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ªgexp_cmd
);

14073 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_ªgexp_cmd
);

14074 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_¥efix_li°_cmd
);

14075 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_¥efix_li°_cmd
);

14076 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_fûãr_li°_cmd
);

14077 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_fûãr_li°_cmd
);

14078 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_rouã_m≠_cmd
);

14079 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_rouã_m≠_cmd
);

14080 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_cidr_⁄ly_cmd
);

14081 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_cidr_⁄ly_cmd
);

14082 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy_Æl_cmd
);

14083 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy_Æl_cmd
);

14084 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy_cmd
);

14085 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy2_cmd
);

14086 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy3_cmd
);

14087 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy4_cmd
);

14088 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy_cmd
);

14089 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy2_cmd
);

14090 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy3_cmd
);

14091 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy4_cmd
);

14092 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_afi_ßfi_communôy_Æl_cmd
);

14093 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_afi_ßfi_communôy_cmd
);

14094 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_afi_ßfi_communôy2_cmd
);

14095 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_afi_ßfi_communôy3_cmd
);

14096 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_afi_ßfi_communôy4_cmd
);

14097 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy_exa˘_cmd
);

14098 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy2_exa˘_cmd
);

14099 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy3_exa˘_cmd
);

14100 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy4_exa˘_cmd
);

14101 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy_exa˘_cmd
);

14102 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy2_exa˘_cmd
);

14103 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy3_exa˘_cmd
);

14104 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy4_exa˘_cmd
);

14105 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy_li°_cmd
);

14106 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy_li°_cmd
);

14107 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy_li°_exa˘_cmd
);

14108 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_communôy_li°_exa˘_cmd
);

14109 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_¥efix_l⁄gî_cmd
);

14110 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_¥efix_l⁄gî_cmd
);

14111 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹_advîti£d_rouã_cmd
);

14112 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_√ighb‹_advîti£d_rouã_cmd
);

14113 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹_ª˚ived_rouãs_cmd
);

14114 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_√ighb‹_ª˚ived_rouãs_cmd
);

14115 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_afi_ßfi_√ighb‹_adv_ªcd_rouãs_cmd
);

14116 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹_rouãs_cmd
);

14117 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_√ighb‹_rouãs_cmd
);

14118 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14119 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14120 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_dam≥√d_∑ths_cmd
);

14121 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_°©i°ics_cmd
);

14122 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_addªss_cmd
);

14123 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_¥efix_cmd
);

14124 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_cidr_⁄ly_cmd
);

14125 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_ªgexp_cmd
);

14126 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_fûãr_li°_cmd
);

14127 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_¥efix_li°_cmd
);

14128 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_¥efix_l⁄gî_cmd
);

14129 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_Ê≠_rouã_m≠_cmd
);

14130 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹_Ê≠_cmd
);

14131 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹_damp_cmd
);

14132 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_rs˛õ¡_cmd
);

14133 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_cmd
);

14134 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_rs˛õ¡_rouã_cmd
);

14135 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_rouã_cmd
);

14136 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_rs˛õ¡_¥efix_cmd
);

14137 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_¥efix_cmd
);

14138 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_√ighb‹_advîti£d_rouã_cmd
);

14139 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_√ighb‹_ª˚ived_rouãs_cmd
);

14140 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_rs˛õ¡_cmd
);

14141 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_cmd
);

14142 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_rs˛õ¡_rouã_cmd
);

14143 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_rouã_cmd
);

14144 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_võw_rs˛õ¡_¥efix_cmd
);

14145 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_¥efix_cmd
);

14148 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_rouã_cmd
);

14149 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_rouã_cmd
);

14150 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv4_ßfi_rouã_cmd
);

14151 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_v≤v4_rd_rouã_cmd
);

14152 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_¥efix_cmd
);

14153 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_¥efix_cmd
);

14154 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv4_ßfi_¥efix_cmd
);

14155 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_v≤v4_Æl_¥efix_cmd
);

14156 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_v≤v4_rd_¥efix_cmd
);

14157 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_võw_rouã_cmd
);

14158 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_võw_¥efix_cmd
);

14159 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy_cmd
);

14160 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy2_cmd
);

14161 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy3_cmd
);

14162 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy4_cmd
);

14163 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy_cmd
);

14164 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy2_cmd
);

14165 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy3_cmd
);

14166 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy4_cmd
);

14167 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_afi_ßfi_communôy_Æl_cmd
);

14168 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_afi_ßfi_communôy_cmd
);

14169 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_afi_ßfi_communôy2_cmd
);

14170 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_afi_ßfi_communôy3_cmd
);

14171 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_afi_ßfi_communôy4_cmd
);

14172 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy_exa˘_cmd
);

14173 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy2_exa˘_cmd
);

14174 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy3_exa˘_cmd
);

14175 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_communôy4_exa˘_cmd
);

14176 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy_exa˘_cmd
);

14177 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy2_exa˘_cmd
);

14178 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy3_exa˘_cmd
);

14179 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_communôy4_exa˘_cmd
);

14180 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_rs˛õ¡_rouã_cmd
);

14181 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_rouã_cmd
);

14182 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_rs˛õ¡_¥efix_cmd
);

14183 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_¥efix_cmd
);

14184 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_võw_rs˛õ¡_rouã_cmd
);

14185 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_rouã_cmd
);

14186 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_võw_rs˛õ¡_¥efix_cmd
);

14187 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_¥efix_cmd
);

14189 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_cmd
);

14190 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_cmd
);

14191 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_cmd
);

14192 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_rouã_cmd
);

14193 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_rouã_cmd
);

14194 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_rouã_cmd
);

14195 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_rouã_cmd
);

14196 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_rouã_cmd
);

14197 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_¥efix_cmd
);

14198 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_¥efix_cmd
);

14199 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_¥efix_cmd
);

14200 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_¥efix_cmd
);

14201 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_¥efix_cmd
);

14202 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_cmd
);

14203 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_rouã_cmd
);

14204 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_¥efix_cmd
);

14205 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ªgexp_cmd
);

14206 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_ªgexp_cmd
);

14207 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_¥efix_li°_cmd
);

14208 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_¥efix_li°_cmd
);

14209 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_fûãr_li°_cmd
);

14210 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_fûãr_li°_cmd
);

14211 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_rouã_m≠_cmd
);

14212 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_rouã_m≠_cmd
);

14213 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_cidr_⁄ly_cmd
);

14214 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_cidr_⁄ly_cmd
);

14215 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy_Æl_cmd
);

14216 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy_Æl_cmd
);

14217 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy_cmd
);

14218 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy2_cmd
);

14219 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy3_cmd
);

14220 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy4_cmd
);

14221 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy_cmd
);

14222 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy2_cmd
);

14223 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy3_cmd
);

14224 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy4_cmd
);

14225 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_afi_ßfi_communôy_Æl_cmd
);

14226 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_afi_ßfi_communôy_cmd
);

14227 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_afi_ßfi_communôy2_cmd
);

14228 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_afi_ßfi_communôy3_cmd
);

14229 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_afi_ßfi_communôy4_cmd
);

14230 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy_exa˘_cmd
);

14231 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy2_exa˘_cmd
);

14232 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy3_exa˘_cmd
);

14233 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy4_exa˘_cmd
);

14234 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy_exa˘_cmd
);

14235 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy2_exa˘_cmd
);

14236 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy3_exa˘_cmd
);

14237 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy4_exa˘_cmd
);

14238 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy_li°_cmd
);

14239 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy_li°_cmd
);

14240 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy_li°_exa˘_cmd
);

14241 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_communôy_li°_exa˘_cmd
);

14242 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_¥efix_l⁄gî_cmd
);

14243 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_¥efix_l⁄gî_cmd
);

14244 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹_advîti£d_rouã_cmd
);

14245 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_√ighb‹_advîti£d_rouã_cmd
);

14246 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹_ª˚ived_rouãs_cmd
);

14247 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_√ighb‹_ª˚ived_rouãs_cmd
);

14248 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_afi_ßfi_√ighb‹_adv_ªcd_rouãs_cmd
);

14249 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹_rouãs_cmd
);

14250 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_√ighb‹_rouãs_cmd
);

14251 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14252 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14253 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_dam≥√d_∑ths_cmd
);

14254 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_°©i°ics_cmd
);

14255 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_addªss_cmd
);

14256 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_¥efix_cmd
);

14257 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_cidr_⁄ly_cmd
);

14258 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_ªgexp_cmd
);

14259 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_fûãr_li°_cmd
);

14260 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_¥efix_li°_cmd
);

14261 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_¥efix_l⁄gî_cmd
);

14262 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_Ê≠_rouã_m≠_cmd
);

14263 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹_Ê≠_cmd
);

14264 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹_damp_cmd
);

14265 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_rs˛õ¡_cmd
);

14266 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_cmd
);

14267 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_rs˛õ¡_rouã_cmd
);

14268 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_rouã_cmd
);

14269 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_rs˛õ¡_¥efix_cmd
);

14270 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_¥efix_cmd
);

14271 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_√ighb‹_advîti£d_rouã_cmd
);

14272 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_√ighb‹_ª˚ived_rouãs_cmd
);

14273 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_rs˛õ¡_cmd
);

14274 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_cmd
);

14275 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_rs˛õ¡_rouã_cmd
);

14276 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_rouã_cmd
);

14277 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_võw_rs˛õ¡_¥efix_cmd
);

14278 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv4_ßfi_rs˛õ¡_¥efix_cmd
);

14281 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_dam≥nög_cmd
);

14282 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_dam≥nög_¥efix_cmd
);

14283 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_dam≥nög_addªss_cmd
);

14284 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_dam≥nög_addªss_mask_cmd
);

14287 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹_¥efix_cou¡s_cmd
);

14288 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_√ighb‹_¥efix_cou¡s_cmd
);

14289 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_√ighb‹_¥efix_cou¡s_cmd
);

14290 #ifde‡
HAVE_IPV6


14291 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹_¥efix_cou¡s_cmd
);

14294 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
ùv6_bgp_√tw‹k_cmd
);

14295 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
ùv6_bgp_√tw‹k_rouã_m≠_cmd
);

14296 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_ùv6_bgp_√tw‹k_cmd
);

14297 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_ùv6_bgp_√tw‹k_rouã_m≠_cmd
);

14299 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
ùv6_aggªg©e_addªss_cmd
);

14300 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14301 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_ùv6_aggªg©e_addªss_cmd
);

14302 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14304 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
ùv6_bgp_√tw‹k_cmd
);

14305 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_ùv6_bgp_√tw‹k_cmd
);

14308 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
ﬁd_ùv6_bgp_√tw‹k_cmd
);

14309 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
ﬁd_no_ùv6_bgp_√tw‹k_cmd
);

14311 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
ﬁd_ùv6_aggªg©e_addªss_cmd
);

14312 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
ﬁd_ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14313 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
ﬁd_no_ùv6_aggªg©e_addªss_cmd
);

14314 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
ﬁd_no_ùv6_aggªg©e_addªss_summ¨y_⁄ly_cmd
);

14316 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_cmd
);

14317 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_cmd
);

14318 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_cmd
);

14319 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_rouã_cmd
);

14320 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_rouã_cmd
);

14321 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_rouã_cmd
);

14322 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_¥efix_cmd
);

14323 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_¥efix_cmd
);

14324 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_¥efix_cmd
);

14325 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ªgexp_cmd
);

14326 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ªgexp_cmd
);

14327 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_¥efix_li°_cmd
);

14328 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_¥efix_li°_cmd
);

14329 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_fûãr_li°_cmd
);

14330 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_fûãr_li°_cmd
);

14331 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_rouã_m≠_cmd
);

14332 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_rouã_m≠_cmd
);

14333 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy_Æl_cmd
);

14334 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy_Æl_cmd
);

14335 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy_cmd
);

14336 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy_cmd
);

14337 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy2_cmd
);

14338 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy2_cmd
);

14339 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy3_cmd
);

14340 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy3_cmd
);

14341 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy4_cmd
);

14342 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy4_cmd
);

14343 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy_exa˘_cmd
);

14344 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy_exa˘_cmd
);

14345 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy2_exa˘_cmd
);

14346 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy2_exa˘_cmd
);

14347 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy3_exa˘_cmd
);

14348 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy3_exa˘_cmd
);

14349 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy4_exa˘_cmd
);

14350 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy4_exa˘_cmd
);

14351 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy_li°_cmd
);

14352 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy_li°_cmd
);

14353 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_communôy_li°_exa˘_cmd
);

14354 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_communôy_li°_exa˘_cmd
);

14355 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_¥efix_l⁄gî_cmd
);

14356 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_¥efix_l⁄gî_cmd
);

14357 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹_advîti£d_rouã_cmd
);

14358 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹_advîti£d_rouã_cmd
);

14359 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹_ª˚ived_rouãs_cmd
);

14360 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹_ª˚ived_rouãs_cmd
);

14361 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹_rouãs_cmd
);

14362 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹_rouãs_cmd
);

14363 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14364 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14365 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹_Ê≠_cmd
);

14366 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹_Ê≠_cmd
);

14367 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹_damp_cmd
);

14368 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹_damp_cmd
);

14369 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_rs˛õ¡_cmd
);

14370 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_cmd
);

14371 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_rs˛õ¡_rouã_cmd
);

14372 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_rouã_cmd
);

14373 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_rs˛õ¡_¥efix_cmd
);

14374 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_¥efix_cmd
);

14375 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_cmd
);

14376 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_cmd
);

14377 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_rouã_cmd
);

14378 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_rouã_cmd
);

14379 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_¥efix_cmd
);

14380 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_¥efix_cmd
);

14381 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_√ighb‹_advîti£d_rouã_cmd
);

14382 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_√ighb‹_advîti£d_rouã_cmd
);

14383 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_√ighb‹_ª˚ived_rouãs_cmd
);

14384 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_√ighb‹_ª˚ived_rouãs_cmd
);

14385 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_√ighb‹_rouãs_cmd
);

14386 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_√ighb‹_rouãs_cmd
);

14387 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14388 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14389 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_√ighb‹_Ê≠_cmd
);

14390 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_√ighb‹_Ê≠_cmd
);

14391 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_√ighb‹_damp_cmd
);

14392 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_√ighb‹_damp_cmd
);

14393 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_rs˛õ¡_cmd
);

14394 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_cmd
);

14395 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_rs˛õ¡_rouã_cmd
);

14396 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_rouã_cmd
);

14397 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_rs˛õ¡_¥efix_cmd
);

14398 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_¥efix_cmd
);

14403 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_rouã_cmd
);

14404 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_rouã_cmd
);

14405 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_ßfi_rouã_cmd
);

14406 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_¥efix_cmd
);

14407 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_¥efix_cmd
);

14408 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_ßfi_¥efix_cmd
);

14409 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy_cmd
);

14410 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy_cmd
);

14411 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy2_cmd
);

14412 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy2_cmd
);

14413 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy3_cmd
);

14414 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy3_cmd
);

14415 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy4_cmd
);

14416 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy4_cmd
);

14417 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy_exa˘_cmd
);

14418 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy_exa˘_cmd
);

14419 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy2_exa˘_cmd
);

14420 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy2_exa˘_cmd
);

14421 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy3_exa˘_cmd
);

14422 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy3_exa˘_cmd
);

14423 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_communôy4_exa˘_cmd
);

14424 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_communôy4_exa˘_cmd
);

14425 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_rs˛õ¡_rouã_cmd
);

14426 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_rouã_cmd
);

14427 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_rs˛õ¡_¥efix_cmd
);

14428 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_¥efix_cmd
);

14429 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_rouã_cmd
);

14430 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_ùv6_rouã_cmd
);

14431 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_¥efix_cmd
);

14432 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_ùv6_¥efix_cmd
);

14433 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14434 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_ùv6_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14435 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_rs˛õ¡_rouã_cmd
);

14436 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_rouã_cmd
);

14437 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_rs˛õ¡_¥efix_cmd
);

14438 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_¥efix_cmd
);

14440 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_cmd
);

14441 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_cmd
);

14442 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_cmd
);

14443 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_rouã_cmd
);

14444 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_rouã_cmd
);

14445 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_rouã_cmd
);

14446 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_¥efix_cmd
);

14447 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_¥efix_cmd
);

14448 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_¥efix_cmd
);

14449 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ªgexp_cmd
);

14450 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ªgexp_cmd
);

14451 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_¥efix_li°_cmd
);

14452 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_¥efix_li°_cmd
);

14453 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_fûãr_li°_cmd
);

14454 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_fûãr_li°_cmd
);

14455 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_rouã_m≠_cmd
);

14456 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_rouã_m≠_cmd
);

14457 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy_Æl_cmd
);

14458 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy_Æl_cmd
);

14459 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy_cmd
);

14460 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy_cmd
);

14461 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy2_cmd
);

14462 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy2_cmd
);

14463 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy3_cmd
);

14464 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy3_cmd
);

14465 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy4_cmd
);

14466 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy4_cmd
);

14467 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy_exa˘_cmd
);

14468 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy_exa˘_cmd
);

14469 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy2_exa˘_cmd
);

14470 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy2_exa˘_cmd
);

14471 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy3_exa˘_cmd
);

14472 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy3_exa˘_cmd
);

14473 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy4_exa˘_cmd
);

14474 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy4_exa˘_cmd
);

14475 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy_li°_cmd
);

14476 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy_li°_cmd
);

14477 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_communôy_li°_exa˘_cmd
);

14478 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_communôy_li°_exa˘_cmd
);

14479 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_¥efix_l⁄gî_cmd
);

14480 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_¥efix_l⁄gî_cmd
);

14481 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹_advîti£d_rouã_cmd
);

14482 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹_advîti£d_rouã_cmd
);

14483 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹_ª˚ived_rouãs_cmd
);

14484 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹_ª˚ived_rouãs_cmd
);

14485 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹_rouãs_cmd
);

14486 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹_rouãs_cmd
);

14487 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14488 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14489 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹_Ê≠_cmd
);

14490 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹_Ê≠_cmd
);

14491 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹_damp_cmd
);

14492 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹_damp_cmd
);

14493 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_rs˛õ¡_cmd
);

14494 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_cmd
);

14495 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_rs˛õ¡_rouã_cmd
);

14496 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_rouã_cmd
);

14497 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_rs˛õ¡_¥efix_cmd
);

14498 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_¥efix_cmd
);

14499 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_cmd
);

14500 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_cmd
);

14501 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_rouã_cmd
);

14502 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_rouã_cmd
);

14503 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_¥efix_cmd
);

14504 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_¥efix_cmd
);

14505 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_√ighb‹_advîti£d_rouã_cmd
);

14506 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_√ighb‹_advîti£d_rouã_cmd
);

14507 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_√ighb‹_ª˚ived_rouãs_cmd
);

14508 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_√ighb‹_ª˚ived_rouãs_cmd
);

14509 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_√ighb‹_rouãs_cmd
);

14510 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_√ighb‹_rouãs_cmd
);

14511 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14512 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_√ighb‹_ª˚ived_¥efix_fûãr_cmd
);

14513 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_√ighb‹_Ê≠_cmd
);

14514 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_√ighb‹_Ê≠_cmd
);

14515 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_√ighb‹_damp_cmd
);

14516 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_√ighb‹_damp_cmd
);

14517 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_rs˛õ¡_cmd
);

14518 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_cmd
);

14519 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_rs˛õ¡_rouã_cmd
);

14520 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_rouã_cmd
);

14521 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_rs˛õ¡_¥efix_cmd
);

14522 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võw_ùv6_ßfi_rs˛õ¡_¥efix_cmd
);

14525 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_°©i°ics_cmd
);

14526 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_°©i°ics_v≤v4_cmd
);

14527 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_°©i°ics_võw_cmd
);

14528 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_°©i°ics_võw_v≤v4_cmd
);

14531 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_cmd
);

14532 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_rouã_cmd
);

14533 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_¥efix_cmd
);

14534 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_ªgexp_cmd
);

14535 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_¥efix_li°_cmd
);

14536 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_fûãr_li°_cmd
);

14537 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy_Æl_cmd
);

14538 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy_cmd
);

14539 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy2_cmd
);

14540 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy3_cmd
);

14541 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy4_cmd
);

14542 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy_exa˘_cmd
);

14543 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy2_exa˘_cmd
);

14544 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy3_exa˘_cmd
);

14545 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy4_exa˘_cmd
);

14546 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy_li°_cmd
);

14547 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_communôy_li°_exa˘_cmd
);

14548 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_¥efix_l⁄gî_cmd
);

14549 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_cmd
);

14550 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_rouã_cmd
);

14551 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_¥efix_cmd
);

14552 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_ªgexp_cmd
);

14553 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_¥efix_li°_cmd
);

14554 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_fûãr_li°_cmd
);

14555 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy_Æl_cmd
);

14556 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy_cmd
);

14557 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy2_cmd
);

14558 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy3_cmd
);

14559 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy4_cmd
);

14560 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy_exa˘_cmd
);

14561 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy2_exa˘_cmd
);

14562 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy3_exa˘_cmd
);

14563 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy4_exa˘_cmd
);

14564 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy_li°_cmd
);

14565 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_communôy_li°_exa˘_cmd
);

14566 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_¥efix_l⁄gî_cmd
);

14569 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_cmd
);

14570 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_rouã_cmd
);

14571 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_¥efix_cmd
);

14572 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_ªgexp_cmd
);

14573 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_¥efix_li°_cmd
);

14574 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_fûãr_li°_cmd
);

14575 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy_Æl_cmd
);

14576 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy_cmd
);

14577 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy2_cmd
);

14578 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy3_cmd
);

14579 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy4_cmd
);

14580 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy_exa˘_cmd
);

14581 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy2_exa˘_cmd
);

14582 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy3_exa˘_cmd
);

14583 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy4_exa˘_cmd
);

14584 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy_li°_cmd
);

14585 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_communôy_li°_exa˘_cmd
);

14586 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_¥efix_l⁄gî_cmd
);

14587 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_cmd
);

14588 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_rouã_cmd
);

14589 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_¥efix_cmd
);

14590 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_ªgexp_cmd
);

14591 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_¥efix_li°_cmd
);

14592 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_fûãr_li°_cmd
);

14593 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy_Æl_cmd
);

14594 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy_cmd
);

14595 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy2_cmd
);

14596 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy3_cmd
);

14597 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy4_cmd
);

14598 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy_exa˘_cmd
);

14599 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy2_exa˘_cmd
);

14600 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy3_exa˘_cmd
);

14601 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy4_exa˘_cmd
);

14602 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy_li°_cmd
);

14603 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_communôy_li°_exa˘_cmd
);

14604 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_¥efix_l⁄gî_cmd
);

14607 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
ùv6_bgp_√ighb‹_advîti£d_rouã_cmd
);

14608 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ùv6_bgp_√ighb‹_advîti£d_rouã_cmd
);

14609 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
ùv6_mbgp_√ighb‹_advîti£d_rouã_cmd
);

14610 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ùv6_mbgp_√ighb‹_advîti£d_rouã_cmd
);

14613 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
ùv6_bgp_√ighb‹_ª˚ived_rouãs_cmd
);

14614 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ùv6_bgp_√ighb‹_ª˚ived_rouãs_cmd
);

14615 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
ùv6_mbgp_√ighb‹_ª˚ived_rouãs_cmd
);

14616 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ùv6_mbgp_√ighb‹_ª˚ived_rouãs_cmd
);

14619 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
ùv6_bgp_√ighb‹_rouãs_cmd
);

14620 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ùv6_bgp_√ighb‹_rouãs_cmd
);

14621 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
ùv6_mbgp_√ighb‹_rouãs_cmd
);

14622 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ùv6_mbgp_√ighb‹_rouãs_cmd
);

14625 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_di°™˚_cmd
);

14626 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_di°™˚_cmd
);

14627 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_di°™˚2_cmd
);

14628 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_di°™˚_sour˚_cmd
);

14629 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_di°™˚_sour˚_cmd
);

14630 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_di°™˚_sour˚_ac˚ss_li°_cmd
);

14631 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_di°™˚_sour˚_ac˚ss_li°_cmd
);

14633 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_damp_£t_cmd
);

14634 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_damp_£t2_cmd
);

14635 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_damp_£t3_cmd
);

14636 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_damp_un£t_cmd
);

14637 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_damp_un£t2_cmd
);

14638 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_damp_£t_cmd
);

14639 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_damp_£t2_cmd
);

14640 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_damp_£t3_cmd
);

14641 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_damp_un£t_cmd
);

14642 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_damp_un£t2_cmd
);

14645 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_âl_cmd
);

14646 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_âl_cmd
);

14647 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_«tuøl_âl_cmd
);

14648 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_backdo‹_âl_cmd
);

14649 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_backdo‹_âl_cmd
);

14650 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
);

14652 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_âl_cmd
);

14653 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_âl_cmd
);

14654 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_âl_cmd
);

14655 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_backdo‹_âl_cmd
);

14656 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_backdo‹_âl_cmd
);

14657 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
);

14659 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_âl_cmd
);

14660 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_âl_cmd
);

14661 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_«tuøl_âl_cmd
);

14662 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_backdo‹_âl_cmd
);

14663 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_backdo‹_âl_cmd
);

14664 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
);

14666 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_âl_cmd
);

14667 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_âl_cmd
);

14668 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_âl_cmd
);

14669 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_backdo‹_âl_cmd
);

14670 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_backdo‹_âl_cmd
);

14671 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
);

14673 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_âl_cmd
);

14674 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_âl_cmd
);

14675 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_«tuøl_âl_cmd
);

14676 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_backdo‹_âl_cmd
);

14677 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_backdo‹_âl_cmd
);

14678 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
);

14680 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_âl_cmd
);

14681 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_âl_cmd
);

14682 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_âl_cmd
);

14683 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_backdo‹_âl_cmd
);

14684 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_backdo‹_âl_cmd
);

14685 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_bgp_√tw‹k_mask_«tuøl_backdo‹_âl_cmd
);

14687 #ifde‡
HAVE_IPV6


14688 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
ùv6_bgp_√tw‹k_âl_cmd
);

14689 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_ùv6_bgp_√tw‹k_âl_cmd
);

14692 #ifde‡
USE_SRX


14693 
	`thªad_add_evít
 (
bm
->
ma°î
, 
öôUnSockë
, 
NULL
, 0);

14696 
	}
}

14699 
	$bgp_rouã_föish
 ()

14701 
	`bgp_èbÀ_u∆ock
 (
bgp_di°™˚_èbÀ
);

14702 
bgp_di°™˚_èbÀ
 = 
NULL
;

14703 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_route.h

21 #i‚de‡
_QUAGGA_BGP_ROUTE_H


22 
	#_QUAGGA_BGP_ROUTE_H


	)

24 
	~"bgp_èbÀ.h
"

25 #ifde‡
USE_SRX


26 
	~"bgp_öfo_hash.h
"

27 
	~<§x/§x_≠i.h
>

34 
	sbgp_öfo_exåa


37 
bgp_damp_öfo
 *
	mdamp_öfo
;

40 
	msuµªss
;

43 
u_öt32_t
 
	migpmëric
;

46 
u_ch¨
 
	mèg
[3];

49 
	sbgp_öfo


52 
bgp_öfo
 *
	m√xt
;

53 
bgp_öfo
 *
	m¥ev
;

56 
≥î
 *
	m≥î
;

59 
©å
 *
	m©å
;

62 
bgp_öfo_exåa
 *
	mexåa
;

66 
bgp_öfo_m∑th
 *
	mm∑th
;

69 
time_t
 
	mu±ime
;

72 
	mlock
;

75 
u_öt16_t
 
	mÊags
;

76 
	#BGP_INFO_IGP_CHANGED
 (1 << 0)

	)

77 
	#BGP_INFO_DAMPED
 (1 << 1)

	)

78 
	#BGP_INFO_HISTORY
 (1 << 2)

	)

79 
	#BGP_INFO_SELECTED
 (1 << 3)

	)

80 
	#BGP_INFO_VALID
 (1 << 4)

	)

81 
	#BGP_INFO_ATTR_CHANGED
 (1 << 5)

	)

82 
	#BGP_INFO_DMED_CHECK
 (1 << 6)

	)

83 
	#BGP_INFO_DMED_SELECTED
 (1 << 7)

	)

84 
	#BGP_INFO_STALE
 (1 << 8)

	)

85 
	#BGP_INFO_REMOVED
 (1 << 9)

	)

86 
	#BGP_INFO_COUNTED
 (1 << 10)

	)

87 
	#BGP_INFO_MULTIPATH
 (1 << 11)

	)

88 
	#BGP_INFO_MULTIPATH_CHG
 (1 << 12)

	)

89 #ifde‡
USE_SRX


90 
	#BGP_INFO_IGNORE
 (1 << 13)

	)

94 
u_ch¨
 
	mty≥
;

98 
u_ch¨
 
	msub_ty≥
;

99 
	#BGP_ROUTE_NORMAL
 0

	)

100 
	#BGP_ROUTE_STATIC
 1

	)

101 
	#BGP_ROUTE_AGGREGATE
 2

	)

102 
	#BGP_ROUTE_REDISTRIBUTE
 3

	)

104 #ifde‡
USE_SRX


105 
bgp_node
 *
	mnode
;

107 
bgp_öfo_hash
 *
	möfo_hash
;

108 
SRxUpd©eID
 
	mupd©eID
;

109 
uöt32_t
 
	mloˇlID
;

110 
SRxVÆid©i⁄Resu…VÆ
 
	mvÆ_ªs_ROA
;

111 
SRxVÆid©i⁄Resu…VÆ
 
	mvÆ_ªs_BGPSEC
;

116 
	sbgp_°©ic


119 
	mbackdo‹
;

122 
u_ch¨
 
	mvÆid
;

125 
u_öt32_t
 
	migpmëric
;

128 
ö_addr
 
	mig≤exth›
;

131 
u_öt32_t
 
	m©omic
;

136 *
	m«me
;

137 
rouã_m≠
 *
	mm≠
;

138 } 
	mrm≠
;

141 
u_ch¨
 
	mèg
[3];

144 #ifde‡
USE_SRX


146 
	sSRxThªad


148 
	msock
;

149 
thªad
 *
	mt_ªad
;

150 * 
	m˛c⁄√˘i⁄H™dÀr
;

151 
	m˛õ¡FD
;

152 
	m¥evClõ¡FD
;

153 * 
	m¥oxy
;

158 
SRxThªad
 *
	gg_rq
;

165 * 
	gÊagDoC⁄√˘Srx
;

168 
	#BGP_INFO_UNUSEABLE
 \

169 (
BGP_INFO_HISTORY
|
BGP_INFO_DAMPED
|
BGP_INFO_REMOVED
|
BGP_INFO_IGNORE
)

	)

174 
	#BGP_INFO_UNUSEABLE
 \

175 (
BGP_INFO_HISTORY
|
BGP_INFO_DAMPED
|
BGP_INFO_REMOVED
)

	)

183 
	#BGP_INFO_HOLDDOWN
(
BI
) \

184 (! 
	`CHECK_FLAG
 ((
BI
)->
Êags
, 
BGP_INFO_VALID
) \

185 || 
	`CHECK_FLAG
 ((
BI
)->
Êags
, 
BGP_INFO_UNUSEABLE
))

	)

187 
	#DISTRIBUTE_IN_NAME
(
F
Ë((F)->
dli°
[
FILTER_IN
].
«me
)

	)

188 
	#DISTRIBUTE_IN
(
F
Ë((F)->
dli°
[
FILTER_IN
].
Æi°
)

	)

189 
	#DISTRIBUTE_OUT_NAME
(
F
Ë((F)->
dli°
[
FILTER_OUT
].
«me
)

	)

190 
	#DISTRIBUTE_OUT
(
F
Ë((F)->
dli°
[
FILTER_OUT
].
Æi°
)

	)

192 
	#PREFIX_LIST_IN_NAME
(
F
Ë((F)->
∂i°
[
FILTER_IN
].
«me
)

	)

193 
	#PREFIX_LIST_IN
(
F
Ë((F)->
∂i°
[
FILTER_IN
].∂i°)

	)

194 
	#PREFIX_LIST_OUT_NAME
(
F
Ë((F)->
∂i°
[
FILTER_OUT
].
«me
)

	)

195 
	#PREFIX_LIST_OUT
(
F
Ë((F)->
∂i°
[
FILTER_OUT
].∂i°)

	)

197 
	#FILTER_LIST_IN_NAME
(
F
Ë((F)->
a¶i°
[
FILTER_IN
].
«me
)

	)

198 
	#FILTER_LIST_IN
(
F
Ë((F)->
a¶i°
[
FILTER_IN
].a¶i°)

	)

199 
	#FILTER_LIST_OUT_NAME
(
F
Ë((F)->
a¶i°
[
FILTER_OUT
].
«me
)

	)

200 
	#FILTER_LIST_OUT
(
F
Ë((F)->
a¶i°
[
FILTER_OUT
].a¶i°)

	)

202 
	#ROUTE_MAP_IN_NAME
(
F
Ë((F)->
m≠
[
RMAP_IN
].
«me
)

	)

203 
	#ROUTE_MAP_IN
(
F
Ë((F)->
m≠
[
RMAP_IN
].m≠)

	)

204 
	#ROUTE_MAP_OUT_NAME
(
F
Ë((F)->
m≠
[
RMAP_OUT
].
«me
)

	)

205 
	#ROUTE_MAP_OUT
(
F
Ë((F)->
m≠
[
RMAP_OUT
].m≠)

	)

207 
	#ROUTE_MAP_IMPORT_NAME
(
F
Ë((F)->
m≠
[
RMAP_IMPORT
].
«me
)

	)

208 
	#ROUTE_MAP_IMPORT
(
F
Ë((F)->
m≠
[
RMAP_IMPORT
].m≠)

	)

209 
	#ROUTE_MAP_EXPORT_NAME
(
F
Ë((F)->
m≠
[
RMAP_EXPORT
].
«me
)

	)

210 
	#ROUTE_MAP_EXPORT
(
F
Ë((F)->
m≠
[
RMAP_EXPORT
].m≠)

	)

212 
	#UNSUPPRESS_MAP_NAME
(
F
Ë((F)->
usm≠
.
«me
)

	)

213 
	#UNSUPPRESS_MAP
(
F
Ë((F)->
usm≠
.
m≠
)

	)

215 
	ebgp_˛ór_rouã_ty≥


217 
	mBGP_CLEAR_ROUTE_NORMAL
,

218 
	mBGP_CLEAR_ROUTE_MY_RSCLIENT


222 
bgp_rouã_öô
 ();

223 
bgp_rouã_föish
 ();

224 
bgp_˛ónup_rouãs
 ();

225 
bgp_™noun˚_rouã
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

226 
bgp_™noun˚_rouã_Æl
 (
≥î
 *);

227 
bgp_deÁu…_‹igö©e
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

228 
bgp_so·_ªc⁄fig_ö
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

229 
bgp_so·_ªc⁄fig_rs˛õ¡
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

230 
bgp_check_loˇl_rouãs_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
);

231 
bgp_˛ór_rouã
 (
≥î
 *, 
afi_t
, 
ßfi_t
,

232 
bgp_˛ór_rouã_ty≥
);

233 
bgp_˛ór_rouã_Æl
 (
≥î
 *);

234 
bgp_˛ór_adj_ö
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

235 
bgp_˛ór_°Æe_rouã
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

237 
bgp_öfo
 *
bgp_öfo_lock
 (bgp_info *);

238 
bgp_öfo
 *
bgp_öfo_u∆ock
 (bgp_info *);

239 
bgp_öfo_add
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
);

240 
bgp_öfo_dñëe
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
);

241 
bgp_öfo_exåa
 *
bgp_öfo_exåa_gë
 (
bgp_öfo
 *);

242 
bgp_öfo_£t_Êag
 (
bgp_node
 *, 
bgp_öfo
 *, 
u_öt32_t
);

243 
bgp_öfo_un£t_Êag
 (
bgp_node
 *, 
bgp_öfo
 *, 
u_öt32_t
);

244 #ifde‡
USE_SRX


245 
bgp_öfo_£t_ign‹e_Êag
(
bgp_öfo
 *);

246 
§x_bgp_ªqueue_upd©e
(
bgp_öfo
 *);

247 
§x_bgp_ªqueue_Æl
(
bgp
 *);

248 
bgp_öfo_£t_vÆid©i⁄_ªsu…
 (
bgp_öfo
 *,

249 
VÆid©i⁄Resu…Ty≥
 
ªsTy≥
,

250 
uöt8_t
 
rﬂResu…
, uöt8_à
bgp£cResu…
);

251 
vîify_upd©e
 (
bgp
 *bgp, 
bgp_öfo
 *
öfo
,

252 
SRxDeÁu…Resu…
* 
defResu…
, 
boﬁ
 
doRegi°îLoˇlID
);

253 
§x_ˇlc_vÆid©i⁄_°©e
(
bgp
 *, 
bgp_öfo
 *);

254 
SRxThªad
* 
§x_thªad_¨g_√w
();

255 
checkClõ¡C⁄√˘i⁄
(
thªad
 *
t
);

256 
öôUnSockë
(
thªad
 *
t
);

257 
checkSídQueue
(
thªad
 *
t
);

258 
thªadC⁄åﬁCÆl
(
ty≥
);

259 
§x_£t_deÁu…
(
bgp
 *bgp);

260 
checkEcomSRxVÆid
(
©å
*áttr);

261 
uöt32_t
 
gëNextLoˇlID
();

265 
bgp_∆ri_ßnôy_check
 (
≥î
 *, , 
u_ch¨
 *, 
bgp_size_t
);

266 
bgp_∆ri_∑r£
 (
≥î
 *, 
©å
 *, 
bgp_∆ri
 *);

268 
bgp_maximum_¥efix_ovîÊow
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

270 
bgp_ªdi°ribuã_add
 (
¥efix
 *, c⁄° 
ö_addr
 *,

271 c⁄° 
ö6_addr
 *,

272 
u_öt32_t
, 
u_ch¨
);

273 
bgp_ªdi°ribuã_dñëe
 (
¥efix
 *, 
u_ch¨
);

274 
bgp_ªdi°ribuã_wôhdøw
 (
bgp
 *, 
afi_t
, );

276 
bgp_°©ic_dñëe
 (
bgp
 *);

277 
bgp_°©ic_upd©e
 (
bgp
 *, 
¥efix
 *, 
bgp_°©ic
 *,

278 
afi_t
, 
ßfi_t
);

279 
bgp_°©ic_wôhdøw
 (
bgp
 *, 
¥efix
 *, 
afi_t
, 
ßfi_t
);

281 
bgp_°©ic_£t_v≤v4
 (
vty
 *vty, const *,

284 
bgp_°©ic_un£t_v≤v4
 (
vty
 *, const *,

288 
bgp_upd©e
 (
≥î
 *, 
¥efix
 *, 
©å
 *,

289 
afi_t
, 
ßfi_t
, , , 
¥efix_rd
 *,

290 
u_ch¨
 *, );

291 
bgp_wôhdøw
 (
≥î
 *, 
¥efix
 *, 
©å
 *,

292 
afi_t
, 
ßfi_t
, , , 
¥efix_rd
 *, 
u_ch¨
 *);

295 
bgp_¥o˚ss
 (
bgp
 *, 
bgp_node
 *, 
afi_t
, 
ßfi_t
);

296 
bgp_c⁄fig_wrôe_√tw‹k
 (
vty
 *, 
bgp
 *, 
afi_t
, 
ßfi_t
, *);

297 
bgp_c⁄fig_wrôe_di°™˚
 (
vty
 *, 
bgp
 *);

299 
bgp_aggªg©e_ö¸emít
 (
bgp
 *, 
¥efix
 *, 
bgp_öfo
 *,

300 
afi_t
, 
ßfi_t
);

301 
bgp_aggªg©e_de¸emít
 (
bgp
 *, 
¥efix
 *, 
bgp_öfo
 *,

302 
afi_t
, 
ßfi_t
);

304 
u_ch¨
 
bgp_di°™˚_≠∂y
 (
¥efix
 *, 
bgp_öfo
 *, 
bgp
 *);

306 
afi_t
 
bgp_node_afi
 (
vty
 *);

307 
ßfi_t
 
bgp_node_ßfi
 (
vty
 *);

309 
rouã_vty_out
 (
vty
 *, 
¥efix
 *, 
bgp_öfo
 *, , 
ßfi_t
);

310 
rouã_vty_out_èg
 (
vty
 *, 
¥efix
 *, 
bgp_öfo
 *, , 
ßfi_t
);

311 
rouã_vty_out_tmp
 (
vty
 *, 
¥efix
 *, 
©å
 *, 
ßfi_t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_routemap.c

21 
	~<zebø.h
>

23 
	~"¥efix.h
"

24 
	~"fûãr.h
"

25 
	~"rouãm≠.h
"

26 
	~"comm™d.h
"

27 
	~"lökli°.h
"

28 
	~"∂i°.h
"

29 
	~"mem‹y.h
"

30 
	~"log.h
"

31 #ifde‡
HAVE_LIBPCREPOSIX


32 
	~<p¸ïosix.h
>

34 #ifde‡
HAVE_GNU_REGEX


35 
	~<ªgex.h
>

37 
	~"ªgex-gnu.h
"

40 
	~"buf„r.h
"

41 
	~"sockuni⁄.h
"

43 
	~"bgpd/bgpd.h
"

44 
	~"bgpd/bgp_èbÀ.h
"

45 
	~"bgpd/bgp_©å.h
"

46 
	~"bgpd/bgp_a•©h.h
"

47 
	~"bgpd/bgp_rouã.h
"

48 
	~"bgpd/bgp_ªgex.h
"

49 
	~"bgpd/bgp_communôy.h
"

50 
	~"bgpd/bgp_˛i°.h
"

51 
	~"bgpd/bgp_fûãr.h
"

52 
	~"bgpd/bgp_m∂sv≤.h
"

53 
	~"bgpd/bgp_ecommunôy.h
"

54 
	~"bgpd/bgp_vty.h
"

109 
rouã_m≠_ªsu…_t


110 
	$rouã_m©ch_≥î
 (*
ruÀ
, 
¥efix
 *¥efix, 
rouã_m≠_obje˘_t
 
ty≥
,

111 *
obje˘
)

113 
sockuni⁄
 *
su
;

114 
sockuni⁄
 
su_def
 = { .
ß
.
ß_Ámûy
 = 
AF_INET
,

115 .
sö
.
sö_addr
.
s_addr
 = 
INADDR_ANY
 };

116 
≥î_group
 *
group
;

117 
≥î
 *peer;

118 
li°node
 *
node
, *
¬ode
;

120 i‡(
ty≥
 =
RMAP_BGP
)

122 
su
 = 
ruÀ
;

123 
≥î
 = ((
bgp_öfo
 *Ë
obje˘
)->peer;

125 i‡–! 
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_IMPORT
) &&

126 ! 
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_EXPORT
) )

127  
RMAP_NOMATCH
;

131 i‡(
	`sockuni⁄_ßme
 (
su
, &
su_def
))

133 
ªt
;

134 i‡–
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_NETWORK
) ||

135 
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_REDISTRIBUTE
) ||

136 
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_DEFAULT
))

137 
ªt
 = 
RMAP_MATCH
;

139 
ªt
 = 
RMAP_NOMATCH
;

140  
ªt
;

143 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

145 i‡(
	`sockuni⁄_ßme
 (
su
, &
≥î
->su))

146  
RMAP_MATCH
;

148  
RMAP_NOMATCH
;

152 
group
 = 
≥î
->group;

153 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

155 i‡(
	`sockuni⁄_ßme
 (
su
, &
≥î
->su))

156  
RMAP_MATCH
;

158  
RMAP_NOMATCH
;

161  
RMAP_NOMATCH
;

162 
	}
}

165 
	$rouã_m©ch_≥î_compûe
 (c⁄° *
¨g
)

167 
sockuni⁄
 *
su
;

168 
ªt
;

170 
su
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
sockuni⁄
));

172 
ªt
 = 
	`°r2sockuni⁄
 (
	`°rcmp
(
¨g
, "loˇl"Ë?árg : "0.0.0.0", 
su
);

173 i‡(
ªt
 < 0) {

174 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
su
);

175  
NULL
;

178  
su
;

179 
	}
}

183 
	$rouã_m©ch_≥î_‰ì
 (*
ruÀ
)

185 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

186 
	}
}

189 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_≥î_cmd
 =

192 
rouã_m©ch_≥î
,

193 
rouã_m©ch_≥î_compûe
,

194 
rouã_m©ch_≥î_‰ì


201 
rouã_m≠_ªsu…_t


202 
	$rouã_m©ch_ù_addªss
 (*
ruÀ
, 
¥efix
 *prefix,

203 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

205 
ac˚ss_li°
 *
Æi°
;

208 i‡(
ty≥
 =
RMAP_BGP
)

210 
Æi°
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

211 i‡(
Æi°
 =
NULL
)

212  
RMAP_NOMATCH
;

214  (
	`ac˚ss_li°_≠∂y
 (
Æi°
, 
¥efix
Ë=
FILTER_DENY
 ?

215 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

217  
RMAP_NOMATCH
;

218 
	}
}

223 
	$rouã_m©ch_ù_addªss_compûe
 (c⁄° *
¨g
)

225  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

226 
	}
}

230 
	$rouã_m©ch_ù_addªss_‰ì
 (*
ruÀ
)

232 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

233 
	}
}

236 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_addªss_cmd
 =

239 
rouã_m©ch_ù_addªss
,

240 
rouã_m©ch_ù_addªss_compûe
,

241 
rouã_m©ch_ù_addªss_‰ì


247 
rouã_m≠_ªsu…_t


248 
	$rouã_m©ch_ù_√xt_h›
 (*
ruÀ
, 
¥efix
 *prefix,

249 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

251 
ac˚ss_li°
 *
Æi°
;

252 
bgp_öfo
 *bgp_info;

253 
¥efix_ùv4
 
p
;

255 i‡(
ty≥
 =
RMAP_BGP
)

257 
bgp_öfo
 = 
obje˘
;

258 
p
.
Ámûy
 = 
AF_INET
;

259 
p
.
¥efix
 = 
bgp_öfo
->
©å
->
√xth›
;

260 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

262 
Æi°
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

263 i‡(
Æi°
 =
NULL
)

264  
RMAP_NOMATCH
;

266  (
	`ac˚ss_li°_≠∂y
 (
Æi°
, &
p
Ë=
FILTER_DENY
 ?

267 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

269  
RMAP_NOMATCH
;

270 
	}
}

275 
	$rouã_m©ch_ù_√xt_h›_compûe
 (c⁄° *
¨g
)

277  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

278 
	}
}

282 
	$rouã_m©ch_ù_√xt_h›_‰ì
 (*
ruÀ
)

284 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

285 
	}
}

288 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_√xt_h›_cmd
 =

291 
rouã_m©ch_ù_√xt_h›
,

292 
rouã_m©ch_ù_√xt_h›_compûe
,

293 
rouã_m©ch_ù_√xt_h›_‰ì


299 
rouã_m≠_ªsu…_t


300 
	$rouã_m©ch_ù_rouã_sour˚
 (*
ruÀ
, 
¥efix
 *prefix,

301 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

303 
ac˚ss_li°
 *
Æi°
;

304 
bgp_öfo
 *bgp_info;

305 
≥î
 *peer;

306 
¥efix_ùv4
 
p
;

308 i‡(
ty≥
 =
RMAP_BGP
)

310 
bgp_öfo
 = 
obje˘
;

311 
≥î
 = 
bgp_öfo
->peer;

313 i‡(! 
≥î
 || 
	`sockuni⁄_Ámûy
 (&≥î->
su
Ë!
AF_INET
)

314  
RMAP_NOMATCH
;

316 
p
.
Ámûy
 = 
AF_INET
;

317 
p
.
¥efix
 = 
≥î
->
su
.
sö
.
sö_addr
;

318 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

320 
Æi°
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

321 i‡(
Æi°
 =
NULL
)

322  
RMAP_NOMATCH
;

324  (
	`ac˚ss_li°_≠∂y
 (
Æi°
, &
p
Ë=
FILTER_DENY
 ?

325 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

327  
RMAP_NOMATCH
;

328 
	}
}

333 
	$rouã_m©ch_ù_rouã_sour˚_compûe
 (c⁄° *
¨g
)

335  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

336 
	}
}

340 
	$rouã_m©ch_ù_rouã_sour˚_‰ì
 (*
ruÀ
)

342 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

343 
	}
}

346 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_rouã_sour˚_cmd
 =

349 
rouã_m©ch_ù_rouã_sour˚
,

350 
rouã_m©ch_ù_rouã_sour˚_compûe
,

351 
rouã_m©ch_ù_rouã_sour˚_‰ì


356 
rouã_m≠_ªsu…_t


357 
	$rouã_m©ch_ù_addªss_¥efix_li°
 (*
ruÀ
, 
¥efix
 *prefix,

358 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

360 
¥efix_li°
 *
∂i°
;

362 i‡(
ty≥
 =
RMAP_BGP
)

364 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

365 i‡(
∂i°
 =
NULL
)

366  
RMAP_NOMATCH
;

368  (
	`¥efix_li°_≠∂y
 (
∂i°
, 
¥efix
Ë=
PREFIX_DENY
 ?

369 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

371  
RMAP_NOMATCH
;

372 
	}
}

375 
	$rouã_m©ch_ù_addªss_¥efix_li°_compûe
 (c⁄° *
¨g
)

377  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

378 
	}
}

381 
	$rouã_m©ch_ù_addªss_¥efix_li°_‰ì
 (*
ruÀ
)

383 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

384 
	}
}

386 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_addªss_¥efix_li°_cmd
 =

389 
rouã_m©ch_ù_addªss_¥efix_li°
,

390 
rouã_m©ch_ù_addªss_¥efix_li°_compûe
,

391 
rouã_m©ch_ù_addªss_¥efix_li°_‰ì


396 
rouã_m≠_ªsu…_t


397 
	$rouã_m©ch_ù_√xt_h›_¥efix_li°
 (*
ruÀ
, 
¥efix
 *prefix,

398 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

400 
¥efix_li°
 *
∂i°
;

401 
bgp_öfo
 *bgp_info;

402 
¥efix_ùv4
 
p
;

404 i‡(
ty≥
 =
RMAP_BGP
)

406 
bgp_öfo
 = 
obje˘
;

407 
p
.
Ámûy
 = 
AF_INET
;

408 
p
.
¥efix
 = 
bgp_öfo
->
©å
->
√xth›
;

409 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

411 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

412 i‡(
∂i°
 =
NULL
)

413  
RMAP_NOMATCH
;

415  (
	`¥efix_li°_≠∂y
 (
∂i°
, &
p
Ë=
PREFIX_DENY
 ?

416 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

418  
RMAP_NOMATCH
;

419 
	}
}

422 
	$rouã_m©ch_ù_√xt_h›_¥efix_li°_compûe
 (c⁄° *
¨g
)

424  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

425 
	}
}

428 
	$rouã_m©ch_ù_√xt_h›_¥efix_li°_‰ì
 (*
ruÀ
)

430 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

431 
	}
}

433 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_√xt_h›_¥efix_li°_cmd
 =

436 
rouã_m©ch_ù_√xt_h›_¥efix_li°
,

437 
rouã_m©ch_ù_√xt_h›_¥efix_li°_compûe
,

438 
rouã_m©ch_ù_√xt_h›_¥efix_li°_‰ì


443 
rouã_m≠_ªsu…_t


444 
	$rouã_m©ch_ù_rouã_sour˚_¥efix_li°
 (*
ruÀ
, 
¥efix
 *prefix,

445 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

447 
¥efix_li°
 *
∂i°
;

448 
bgp_öfo
 *bgp_info;

449 
≥î
 *peer;

450 
¥efix_ùv4
 
p
;

452 i‡(
ty≥
 =
RMAP_BGP
)

454 
bgp_öfo
 = 
obje˘
;

455 
≥î
 = 
bgp_öfo
->peer;

457 i‡(! 
≥î
 || 
	`sockuni⁄_Ámûy
 (&≥î->
su
Ë!
AF_INET
)

458  
RMAP_NOMATCH
;

460 
p
.
Ámûy
 = 
AF_INET
;

461 
p
.
¥efix
 = 
≥î
->
su
.
sö
.
sö_addr
;

462 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

464 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

465 i‡(
∂i°
 =
NULL
)

466  
RMAP_NOMATCH
;

468  (
	`¥efix_li°_≠∂y
 (
∂i°
, &
p
Ë=
PREFIX_DENY
 ?

469 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

471  
RMAP_NOMATCH
;

472 
	}
}

475 
	$rouã_m©ch_ù_rouã_sour˚_¥efix_li°_compûe
 (c⁄° *
¨g
)

477  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

478 
	}
}

481 
	$rouã_m©ch_ù_rouã_sour˚_¥efix_li°_‰ì
 (*
ruÀ
)

483 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

484 
	}
}

486 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_rouã_sour˚_¥efix_li°_cmd
 =

489 
rouã_m©ch_ù_rouã_sour˚_¥efix_li°
,

490 
rouã_m©ch_ù_rouã_sour˚_¥efix_li°_compûe
,

491 
rouã_m©ch_ù_rouã_sour˚_¥efix_li°_‰ì


497 
rouã_m≠_ªsu…_t


498 
	$rouã_m©ch_mëric
 (*
ruÀ
, 
¥efix
 *prefix,

499 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

501 
u_öt32_t
 *
med
;

502 
bgp_öfo
 *bgp_info;

504 i‡(
ty≥
 =
RMAP_BGP
)

506 
med
 = 
ruÀ
;

507 
bgp_öfo
 = 
obje˘
;

509 i‡(
bgp_öfo
->
©å
->
med
 == *med)

510  
RMAP_MATCH
;

512  
RMAP_NOMATCH
;

514  
RMAP_NOMATCH
;

515 
	}
}

519 
	$rouã_m©ch_mëric_compûe
 (c⁄° *
¨g
)

521 
u_öt32_t
 *
med
;

522 *
íd±r
 = 
NULL
;

523 
tmpvÆ
;

526 i‡(! 
	`Æl_digô
 (
¨g
))

527  
NULL
;

529 
î∫o
 = 0;

530 
tmpvÆ
 = 
	`°πoul
 (
¨g
, &
íd±r
, 10);

531 i‡(*
íd±r
 !'\0' || 
î∫o
 || 
tmpvÆ
 > 
UINT32_MAX
)

532  
NULL
;

534 
med
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
u_öt32_t
));

536 i‡(!
med
)

537  
med
;

539 *
med
 = 
tmpvÆ
;

540  
med
;

541 
	}
}

545 
	$rouã_m©ch_mëric_‰ì
 (*
ruÀ
)

547 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

548 
	}
}

551 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_mëric_cmd
 =

554 
rouã_m©ch_mëric
,

555 
rouã_m©ch_mëric_compûe
,

556 
rouã_m©ch_mëric_‰ì


562 
rouã_m≠_ªsu…_t


563 
	$rouã_m©ch_a•©h
 (*
ruÀ
, 
¥efix
 *prefix,

564 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

567 
as_li°
 *as_list;

568 
bgp_öfo
 *bgp_info;

570 i‡(
ty≥
 =
RMAP_BGP
)

572 
as_li°
 = 
	`as_li°_lookup
 ((*Ë
ruÀ
);

573 i‡(
as_li°
 =
NULL
)

574  
RMAP_NOMATCH
;

576 
bgp_öfo
 = 
obje˘
;

579  ((
	`as_li°_≠∂y
 (
as_li°
, 
bgp_öfo
->
©å
->
a•©h
Ë=
AS_FILTER_DENY
Ë? 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

581  
RMAP_NOMATCH
;

582 
	}
}

586 
	$rouã_m©ch_a•©h_compûe
 (c⁄° *
¨g
)

588  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

589 
	}
}

593 
	$rouã_m©ch_a•©h_‰ì
 (*
ruÀ
)

595 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

596 
	}
}

599 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_a•©h_cmd
 =

602 
rouã_m©ch_a•©h
,

603 
rouã_m©ch_a•©h_compûe
,

604 
rouã_m©ch_a•©h_‰ì


608 
	srm≠_communôy


610 *
	m«me
;

611 
	mexa˘
;

615 
rouã_m≠_ªsu…_t


616 
	$rouã_m©ch_communôy
 (*
ruÀ
, 
¥efix
 *prefix,

617 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

619 
communôy_li°
 *
li°
;

620 
bgp_öfo
 *bgp_info;

621 
rm≠_communôy
 *
rcom
;

623 i‡(
ty≥
 =
RMAP_BGP
)

625 
bgp_öfo
 = 
obje˘
;

626 
rcom
 = 
ruÀ
;

628 
li°
 = 
	`communôy_li°_lookup
 (
bgp_˛i°
, 
rcom
->
«me
, 
COMMUNITY_LIST_MASTER
);

629 i‡(! 
li°
)

630  
RMAP_NOMATCH
;

632 i‡(
rcom
->
exa˘
)

634 i‡(
	`communôy_li°_exa˘_m©ch
 (
bgp_öfo
->
©å
->
communôy
, 
li°
))

635  
RMAP_MATCH
;

639 i‡(
	`communôy_li°_m©ch
 (
bgp_öfo
->
©å
->
communôy
, 
li°
))

640  
RMAP_MATCH
;

643  
RMAP_NOMATCH
;

644 
	}
}

648 
	$rouã_m©ch_communôy_compûe
 (c⁄° *
¨g
)

650 
rm≠_communôy
 *
rcom
;

651 
Àn
;

652 *
p
;

654 
rcom
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
rm≠_communôy
));

656 
p
 = 
	`°rchr
 (
¨g
, ' ');

657 i‡(
p
)

659 
Àn
 = 
p
 - 
¨g
;

660 
rcom
->
«me
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
, 
Àn
 + 1);

661 
	`mem˝y
 (
rcom
->
«me
, 
¨g
, 
Àn
);

662 
rcom
->
exa˘
 = 1;

666 
rcom
->
«me
 = 
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

667 
rcom
->
exa˘
 = 0;

669  
rcom
;

670 
	}
}

674 
	$rouã_m©ch_communôy_‰ì
 (*
ruÀ
)

676 
rm≠_communôy
 *
rcom
 = 
ruÀ
;

678 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
rcom
->
«me
);

679 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
rcom
);

680 
	}
}

683 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_communôy_cmd
 =

686 
rouã_m©ch_communôy
,

687 
rouã_m©ch_communôy_compûe
,

688 
rouã_m©ch_communôy_‰ì


692 
rouã_m≠_ªsu…_t


693 
	$rouã_m©ch_ecommunôy
 (*
ruÀ
, 
¥efix
 *prefix,

694 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

696 
communôy_li°
 *
li°
;

697 
bgp_öfo
 *bgp_info;

699 i‡(
ty≥
 =
RMAP_BGP
)

701 
bgp_öfo
 = 
obje˘
;

703 i‡(!
bgp_öfo
->
©å
->
exåa
)

704  
RMAP_NOMATCH
;

706 
li°
 = 
	`communôy_li°_lookup
 (
bgp_˛i°
, (*Ë
ruÀ
,

707 
EXTCOMMUNITY_LIST_MASTER
);

708 i‡(! 
li°
)

709  
RMAP_NOMATCH
;

711 i‡(
	`ecommunôy_li°_m©ch
 (
bgp_öfo
->
©å
->
exåa
->
ecommunôy
, 
li°
))

712  
RMAP_MATCH
;

714  
RMAP_NOMATCH
;

715 
	}
}

719 
	$rouã_m©ch_ecommunôy_compûe
 (c⁄° *
¨g
)

721  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

722 
	}
}

726 
	$rouã_m©ch_ecommunôy_‰ì
 (*
ruÀ
)

728 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

729 
	}
}

732 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ecommunôy_cmd
 =

735 
rouã_m©ch_ecommunôy
,

736 
rouã_m©ch_ecommunôy_compûe
,

737 
rouã_m©ch_ecommunôy_‰ì


744 
rouã_m≠_ªsu…_t


745 
	$rouã_m©ch_‹igö
 (*
ruÀ
, 
¥efix
 *prefix,

746 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

748 
u_ch¨
 *
‹igö
;

749 
bgp_öfo
 *bgp_info;

751 i‡(
ty≥
 =
RMAP_BGP
)

753 
‹igö
 = 
ruÀ
;

754 
bgp_öfo
 = 
obje˘
;

756 i‡(
bgp_öfo
->
©å
->
‹igö
 == *origin)

757  
RMAP_MATCH
;

760  
RMAP_NOMATCH
;

761 
	}
}

764 
	$rouã_m©ch_‹igö_compûe
 (c⁄° *
¨g
)

766 
u_ch¨
 *
‹igö
;

768 
‹igö
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
u_ch¨
));

770 i‡(
	`°rcmp
 (
¨g
, "igp") == 0)

771 *
‹igö
 = 0;

772 i‡(
	`°rcmp
 (
¨g
, "egp") == 0)

773 *
‹igö
 = 1;

775 *
‹igö
 = 2;

777  
‹igö
;

778 
	}
}

782 
	$rouã_m©ch_‹igö_‰ì
 (*
ruÀ
)

784 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

785 
	}
}

788 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_‹igö_cmd
 =

791 
rouã_m©ch_‹igö
,

792 
rouã_m©ch_‹igö_compûe
,

793 
rouã_m©ch_‹igö_‰ì


798 
rouã_m≠_ªsu…_t


799 
	$rouã_m©ch_¥obabûôy
 (*
ruÀ
, 
¥efix
 *prefix,

800 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

802 
r
;

803 #i‡
_SVID_SOURCE
 || 
_BSD_SOURCE
 || 
_XOPEN_SOURCE
 >= 500

804 
r
 = 
	`øndom
();

806 
r
 = (Ë
	`ønd
();

809 *(*Ë
ruÀ
)

812 
RAND_MAX
:  
RMAP_MATCH
;

814 i‡(
r
 < *(*Ë
ruÀ
)

816  
RMAP_MATCH
;

820  
RMAP_NOMATCH
;

821 
	}
}

824 
	$rouã_m©ch_¥obabûôy_compûe
 (c⁄° *
¨g
)

826 *
lobuÀ
;

827 
≥rc
;

829 #i‡
_SVID_SOURCE
 || 
_BSD_SOURCE
 || 
_XOPEN_SOURCE
 >= 500

830 
	`§™dom
 (
	`time
 (
NULL
));

832 
	`§™d
 (
	`time
 (
NULL
));

835 
≥rc
 = 
	`©oi
 (
¨g
);

836 
lobuÀ
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  ());

838 
≥rc
)

840 0: *
lobuÀ
 = 0; ;

841 100: *
lobuÀ
 = 
RAND_MAX
; ;

842 : *
lobuÀ
 = 
RAND_MAX
 / 100 * 
≥rc
;

845  
lobuÀ
;

846 
	}
}

849 
	$rouã_m©ch_¥obabûôy_‰ì
 (*
ruÀ
)

851 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

852 
	}
}

854 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_¥obabûôy_cmd
 =

857 
rouã_m©ch_¥obabûôy
,

858 
rouã_m©ch_¥obabûôy_compûe
,

859 
rouã_m©ch_¥obabûôy_‰ì


867 
	srm≠_ù_√xth›_£t


869 
ö_addr
 *
	maddªss
;

870 
	m≥î_addªss
;

873 
rouã_m≠_ªsu…_t


874 
	$rouã_£t_ù_√xth›
 (*
ruÀ
, 
¥efix
 *prefix,

875 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

877 
rm≠_ù_√xth›_£t
 *
rös
 = 
ruÀ
;

878 
bgp_öfo
 *bgp_info;

879 
≥î
 *peer;

881 i‡(
ty≥
 =
RMAP_BGP
)

883 
bgp_öfo
 = 
obje˘
;

884 
≥î
 = 
bgp_öfo
->peer;

886 i‡(
rös
->
≥î_addªss
)

888 i‡((
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_IN
) ||

889 
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_IMPORT
))

890 && 
≥î
->
su_ªmŸe


891 && 
	`sockuni⁄_Ámûy
 (
≥î
->
su_ªmŸe
Ë=
AF_INET
)

893 
bgp_öfo
->
©å
->
√xth›
.
s_addr
 = 
	`sockuni⁄2ù
 (
≥î
->
su_ªmŸe
);

894 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
);

896 i‡(
	`CHECK_FLAG
 (
≥î
->
rm≠_ty≥
, 
PEER_RMAP_TYPE_OUT
)

897 && 
≥î
->
su_loˇl


898 && 
	`sockuni⁄_Ámûy
 (
≥î
->
su_loˇl
Ë=
AF_INET
)

900 
bgp_öfo
->
©å
->
√xth›
.
s_addr
 = 
	`sockuni⁄2ù
 (
≥î
->
su_loˇl
);

901 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
);

907 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_NEXT_HOP
);

908 
bgp_öfo
->
©å
->
√xth›
 = *
rös
->
addªss
;

912  
RMAP_OKAY
;

913 
	}
}

918 
	$rouã_£t_ù_√xth›_compûe
 (c⁄° *
¨g
)

920 
rm≠_ù_√xth›_£t
 *
rös
;

921 
ö_addr
 *
addªss
 = 
NULL
;

922 
≥î_addªss
 = 0;

923 
ªt
;

925 i‡(
	`°rcmp
 (
¨g
, "peer-address") == 0)

926 
≥î_addªss
 = 1;

929 
addªss
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
ö_addr
));

930 
ªt
 = 
	`öë_©⁄
 (
¨g
, 
addªss
);

932 i‡(
ªt
 == 0)

934 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
addªss
);

935  
NULL
;

939 
rös
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
rm≠_ù_√xth›_£t
));

941 
rös
->
addªss
 =áddress;

942 
rös
->
≥î_addªss
 =Öeer_address;

944  
rös
;

945 
	}
}

949 
	$rouã_£t_ù_√xth›_‰ì
 (*
ruÀ
)

951 
rm≠_ù_√xth›_£t
 *
rös
 = 
ruÀ
;

953 i‡(
rös
->
addªss
)

954 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
rös
->
addªss
);

956 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
rös
);

957 
	}
}

960 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_ù_√xth›_cmd
 =

963 
rouã_£t_ù_√xth›
,

964 
rouã_£t_ù_√xth›_compûe
,

965 
rouã_£t_ù_√xth›_‰ì


971 
rouã_m≠_ªsu…_t


972 
	$rouã_£t_loˇl_¥ef
 (*
ruÀ
, 
¥efix
 *prefix,

973 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

975 
u_öt32_t
 *
loˇl_¥ef
;

976 
bgp_öfo
 *bgp_info;

978 i‡(
ty≥
 =
RMAP_BGP
)

981 
loˇl_¥ef
 = 
ruÀ
;

982 
bgp_öfo
 = 
obje˘
;

985 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_LOCAL_PREF
);

986 
bgp_öfo
->
©å
->
loˇl_¥ef
 = *local_pref;

989  
RMAP_OKAY
;

990 
	}
}

994 
	$rouã_£t_loˇl_¥ef_compûe
 (c⁄° *
¨g
)

996 
tmp
;

997 
u_öt32_t
 *
loˇl_¥ef
;

998 *
íd±r
 = 
NULL
;

1001 i‡(! 
	`Æl_digô
 (
¨g
))

1002  
NULL
;

1004 
î∫o
 = 0;

1005 
tmp
 = 
	`°πoul
 (
¨g
, &
íd±r
, 10);

1006 i‡(*
íd±r
 !'\0' || 
î∫o
 || 
tmp
 > 
UINT32_MAX
)

1007  
NULL
;

1009 
loˇl_¥ef
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
u_öt32_t
));

1011 i‡(!
loˇl_¥ef
)

1012  
loˇl_¥ef
;

1014 *
loˇl_¥ef
 = 
tmp
;

1016  
loˇl_¥ef
;

1017 
	}
}

1021 
	$rouã_£t_loˇl_¥ef_‰ì
 (*
ruÀ
)

1023 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1024 
	}
}

1027 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_loˇl_¥ef_cmd
 =

1030 
rouã_£t_loˇl_¥ef
,

1031 
rouã_£t_loˇl_¥ef_compûe
,

1032 
rouã_£t_loˇl_¥ef_‰ì
,

1038 
rouã_m≠_ªsu…_t


1039 
	$rouã_£t_weight
 (*
ruÀ
, 
¥efix
 *¥efix, 
rouã_m≠_obje˘_t
 
ty≥
,

1040 *
obje˘
)

1042 
u_öt32_t
 *
weight
;

1043 
bgp_öfo
 *bgp_info;

1045 i‡(
ty≥
 =
RMAP_BGP
)

1048 
weight
 = 
ruÀ
;

1049 
bgp_öfo
 = 
obje˘
;

1052 i‡(*
weight
)

1053 (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
weight
 = *weight;

1054 i‡(
bgp_öfo
->
©å
->
exåa
)

1055 
bgp_öfo
->
©å
->
exåa
->
weight
 = 0;

1058  
RMAP_OKAY
;

1059 
	}
}

1063 
	$rouã_£t_weight_compûe
 (c⁄° *
¨g
)

1065 
tmp
;

1066 
u_öt32_t
 *
weight
;

1067 *
íd±r
 = 
NULL
;

1070 i‡(! 
	`Æl_digô
 (
¨g
))

1071  
NULL
;

1073 
î∫o
 = 0;

1074 
tmp
 = 
	`°πoul
 (
¨g
, &
íd±r
, 10);

1075 i‡(*
íd±r
 !'\0' || 
î∫o
 || 
tmp
 > 
UINT32_MAX
)

1076  
NULL
;

1078 
weight
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
u_öt32_t
));

1080 i‡(
weight
 =
NULL
)

1081  
weight
;

1083 *
weight
 = 
tmp
;

1085  
weight
;

1086 
	}
}

1090 
	$rouã_£t_weight_‰ì
 (*
ruÀ
)

1092 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1093 
	}
}

1096 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_weight_cmd
 =

1099 
rouã_£t_weight
,

1100 
rouã_£t_weight_compûe
,

1101 
rouã_£t_weight_‰ì
,

1107 
rouã_m≠_ªsu…_t


1108 
	$rouã_£t_mëric
 (*
ruÀ
, 
¥efix
 *prefix,

1109 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1111 *
mëric
;

1112 
u_öt32_t
 
mëric_vÆ
;

1113 
bgp_öfo
 *bgp_info;

1115 i‡(
ty≥
 =
RMAP_BGP
)

1118 
mëric
 = 
ruÀ
;

1119 
bgp_öfo
 = 
obje˘
;

1121 i‡(! (
bgp_öfo
->
©å
->
Êag
 & 
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
)))

1122 
bgp_öfo
->
©å
->
med
 = 0;

1123 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_MULTI_EXIT_DISC
);

1125 i‡(
	`Æl_digô
 (
mëric
))

1127 
mëric_vÆ
 = 
	`°πoul
 (
mëric
, (**)
NULL
, 10);

1128 
bgp_öfo
->
©å
->
med
 = 
mëric_vÆ
;

1132 
mëric_vÆ
 = 
	`°πoul
 (
mëric
+1, (**)
NULL
, 10);

1134 i‡(
	`°∫cmp
 (
mëric
, "+", 1) == 0)

1136 i‡(
bgp_öfo
->
©å
->
med
/2 + 
mëric_vÆ
/2 > 
BGP_MED_MAX
/2)

1137 
bgp_öfo
->
©å
->
med
 = 
BGP_MED_MAX
 - 1;

1139 
bgp_öfo
->
©å
->
med
 +
mëric_vÆ
;

1141 i‡(
	`°∫cmp
 (
mëric
, "-", 1) == 0)

1143 i‡(
bgp_öfo
->
©å
->
med
 <
mëric_vÆ
)

1144 
bgp_öfo
->
©å
->
med
 = 0;

1146 
bgp_öfo
->
©å
->
med
 -
mëric_vÆ
;

1150  
RMAP_OKAY
;

1151 
	}
}

1155 
	$rouã_£t_mëric_compûe
 (c⁄° *
¨g
)

1157 
u_öt32_t
 
mëric
;

1158 
œrg
;

1159 *
íd±r
 = 
NULL
;

1161 i‡(
	`Æl_digô
 (
¨g
))

1164 
î∫o
 = 0;

1165 
œrg
 = 
	`°πoul
 (
¨g
, &
íd±r
, 10);

1166 i‡(*
íd±r
 !'\0' || 
î∫o
 || 
œrg
 > 
UINT32_MAX
)

1167  
NULL
;

1168 
mëric
 = 
œrg
;

1173 i‡((
	`°∫cmp
 (
¨g
, "+", 1) != 0

1174 && 
	`°∫cmp
 (
¨g
, "-", 1) != 0)

1175 || (! 
	`Æl_digô
 (
¨g
+1)))

1176  
NULL
;

1178 
î∫o
 = 0;

1179 
œrg
 = 
	`°πoul
 (
¨g
+1, &
íd±r
, 10);

1180 i‡(*
íd±r
 !'\0' || 
î∫o
 || 
œrg
 > 
UINT32_MAX
)

1181  
NULL
;

1182 
mëric
 = 
œrg
;

1185  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

1186 
	}
}

1190 
	$rouã_£t_mëric_‰ì
 (*
ruÀ
)

1192 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1193 
	}
}

1196 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_mëric_cmd
 =

1199 
rouã_£t_mëric
,

1200 
rouã_£t_mëric_compûe
,

1201 
rouã_£t_mëric_‰ì
,

1207 
rouã_m≠_ªsu…_t


1208 
	$rouã_£t_a•©h_¥ïíd
 (*
ruÀ
, 
¥efix
 *¥efix, 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1210 
a•©h
 *aspath;

1211 
a•©h
 *
√w
;

1212 
bgp_öfo
 *
böfo
;

1214 i‡(
ty≥
 =
RMAP_BGP
)

1216 
a•©h
 = 
ruÀ
;

1217 
böfo
 = 
obje˘
;

1219 i‡(
böfo
->
©å
->
a•©h
->
ªf˙t
)

1220 
√w
 = 
	`a•©h_dup
 (
böfo
->
©å
->
a•©h
);

1222 
√w
 = 
böfo
->
©å
->
a•©h
;

1224 
	`a•©h_¥ïíd
 (
a•©h
, 
√w
);

1225 
böfo
->
©å
->
a•©h
 = 
√w
;

1228  
RMAP_OKAY
;

1229 
	}
}

1233 
	$rouã_£t_a•©h_¥ïíd_compûe
 (c⁄° *
¨g
)

1235 
a•©h
 *aspath;

1237 
a•©h
 = 
	`a•©h_°r2a•©h
 (
¨g
);

1238 i‡(! 
a•©h
)

1239  
NULL
;

1240  
a•©h
;

1241 
	}
}

1245 
	$rouã_£t_a•©h_¥ïíd_‰ì
 (*
ruÀ
)

1247 
a•©h
 *a•©h = 
ruÀ
;

1248 
	`a•©h_‰ì
 (
a•©h
);

1249 
	}
}

1252 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_a•©h_¥ïíd_cmd
 =

1255 
rouã_£t_a•©h_¥ïíd
,

1256 
rouã_£t_a•©h_¥ïíd_compûe
,

1257 
rouã_£t_a•©h_¥ïíd_‰ì
,

1266 
rouã_m≠_ªsu…_t


1267 
	$rouã_£t_a•©h_ex˛ude
 (*
ruÀ
, 
¥efix
 *
dummy
, 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1269 
a•©h
 * 
√w_∑th
, * 
ex˛ude_∑th
;

1270 
bgp_öfo
 *
böfo
;

1272 i‡(
ty≥
 =
RMAP_BGP
)

1274 
ex˛ude_∑th
 = 
ruÀ
;

1275 
böfo
 = 
obje˘
;

1276 i‡(
böfo
->
©å
->
a•©h
->
ªf˙t
)

1277 
√w_∑th
 = 
	`a•©h_dup
 (
böfo
->
©å
->
a•©h
);

1279 
√w_∑th
 = 
böfo
->
©å
->
a•©h
;

1280 
böfo
->
©å
->
a•©h
 = 
	`a•©h_fûãr_ex˛ude
 (
√w_∑th
, 
ex˛ude_∑th
);

1282  
RMAP_OKAY
;

1283 
	}
}

1292 
	$rouã_£t_a•©h_ex˛ude_compûe
 (c⁄° *
¨g
)

1294 
a•©h
 *aspath;

1296 
a•©h
 = 
	`a•©h_°r2a•©h
 (
¨g
);

1297 i‡(! 
a•©h
)

1298  
NULL
;

1299  
a•©h
;

1300 
	}
}

1303 
	$rouã_£t_a•©h_ex˛ude_‰ì
 (*
ruÀ
)

1305 
a•©h
 *a•©h = 
ruÀ
;

1306 
	`a•©h_‰ì
 (
a•©h
);

1307 
	}
}

1310 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_a•©h_ex˛ude_cmd
 =

1313 
rouã_£t_a•©h_ex˛ude
,

1314 
rouã_£t_a•©h_ex˛ude_compûe
,

1315 
rouã_£t_a•©h_ex˛ude_‰ì
,

1319 
	srm≠_com_£t


1321 
communôy
 *
	mcom
;

1322 
	maddôive
;

1323 
	mn⁄e
;

1327 
rouã_m≠_ªsu…_t


1328 
	$rouã_£t_communôy
 (*
ruÀ
, 
¥efix
 *prefix,

1329 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1331 
rm≠_com_£t
 *
rcs
;

1332 
bgp_öfo
 *
böfo
;

1333 
©å
 *attr;

1334 
communôy
 *
√w
 = 
NULL
;

1335 
communôy
 *
ﬁd
;

1336 
communôy
 *
mîge
;

1338 i‡(
ty≥
 =
RMAP_BGP
)

1340 
rcs
 = 
ruÀ
;

1341 
böfo
 = 
obje˘
;

1342 
©å
 = 
böfo
->attr;

1343 
ﬁd
 = 
©å
->
communôy
;

1346 i‡(
rcs
->
n⁄e
)

1348 
©å
->
Êag
 &~(
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
));

1349 
©å
->
communôy
 = 
NULL
;

1351 i‡(
ﬁd
 && old->
ªf˙t
 == 0)

1352 
	`communôy_‰ì
(
ﬁd
);

1353  
RMAP_OKAY
;

1357 i‡(
rcs
->
addôive
 && 
ﬁd
)

1359 
mîge
 = 
	`communôy_mîge
 (
	`communôy_dup
 (
ﬁd
), 
rcs
->
com
);

1365 i‡(
ﬁd
->
ªf˙t
 == 0)

1366 
	`communôy_‰ì
 (
ﬁd
);

1367 
√w
 = 
	`communôy_uniq_s‹t
 (
mîge
);

1368 
	`communôy_‰ì
 (
mîge
);

1371 
√w
 = 
	`communôy_dup
 (
rcs
->
com
);

1374 
©å
->
communôy
 = 
√w
;

1376 
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
);

1379  
RMAP_OKAY
;

1380 
	}
}

1384 
	$rouã_£t_communôy_compûe
 (c⁄° *
¨g
)

1386 
rm≠_com_£t
 *
rcs
;

1387 
communôy
 *
com
 = 
NULL
;

1388 *
•
;

1389 
addôive
 = 0;

1390 
n⁄e
 = 0;

1392 i‡(
	`°rcmp
 (
¨g
, "none") == 0)

1393 
n⁄e
 = 1;

1396 
•
 = 
	`°r°r
 (
¨g
, "additive");

1398 i‡(
•
 && s∞> 
¨g
)

1401 
addôive
 = 1;

1402 *(
•
 - 1) = '\0';

1405 
com
 = 
	`communôy_°r2com
 (
¨g
);

1407 i‡(
addôive
)

1408 *(
•
 - 1) = ' ';

1410 i‡(! 
com
)

1411  
NULL
;

1414 
rcs
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
rm≠_com_£t
));

1415 
rcs
->
com
 = com;

1416 
rcs
->
addôive
 =ádditive;

1417 
rcs
->
n⁄e
 =Çone;

1419  
rcs
;

1420 
	}
}

1424 
	$rouã_£t_communôy_‰ì
 (*
ruÀ
)

1426 
rm≠_com_£t
 *
rcs
 = 
ruÀ
;

1428 i‡(
rcs
->
com
)

1429 
	`communôy_‰ì
 (
rcs
->
com
);

1430 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
rcs
);

1431 
	}
}

1434 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_communôy_cmd
 =

1437 
rouã_£t_communôy
,

1438 
rouã_£t_communôy_compûe
,

1439 
rouã_£t_communôy_‰ì
,

1445 
rouã_m≠_ªsu…_t


1446 
	$rouã_£t_communôy_dñëe
 (*
ruÀ
, 
¥efix
 *prefix,

1447 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1449 
communôy_li°
 *
li°
;

1450 
communôy
 *
mîge
;

1451 
communôy
 *
√w
;

1452 
communôy
 *
ﬁd
;

1453 
bgp_öfo
 *
böfo
;

1455 i‡(
ty≥
 =
RMAP_BGP
)

1457 i‡(! 
ruÀ
)

1458  
RMAP_OKAY
;

1460 
böfo
 = 
obje˘
;

1461 
li°
 = 
	`communôy_li°_lookup
 (
bgp_˛i°
, 
ruÀ
, 
COMMUNITY_LIST_MASTER
);

1462 
ﬁd
 = 
böfo
->
©å
->
communôy
;

1464 i‡(
li°
 && 
ﬁd
)

1466 
mîge
 = 
	`communôy_li°_m©ch_dñëe
 (
	`communôy_dup
 (
ﬁd
), 
li°
);

1467 
√w
 = 
	`communôy_uniq_s‹t
 (
mîge
);

1468 
	`communôy_‰ì
 (
mîge
);

1474 i‡(
ﬁd
->
ªf˙t
 == 0)

1475 
	`communôy_‰ì
 (
ﬁd
);

1477 i‡(
√w
->
size
 == 0)

1479 
böfo
->
©å
->
communôy
 = 
NULL
;

1480 
böfo
->
©å
->
Êag
 &~
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
);

1481 
	`communôy_‰ì
 (
√w
);

1485 
böfo
->
©å
->
communôy
 = 
√w
;

1486 
böfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_COMMUNITIES
);

1491  
RMAP_OKAY
;

1492 
	}
}

1496 
	$rouã_£t_communôy_dñëe_compûe
 (c⁄° *
¨g
)

1498 *
p
;

1499 *
°r
;

1500 
Àn
;

1502 
p
 = 
	`°rchr
 (
¨g
, ' ');

1503 i‡(
p
)

1505 
Àn
 = 
p
 - 
¨g
;

1506 
°r
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
, 
Àn
 + 1);

1507 
	`mem˝y
 (
°r
, 
¨g
, 
Àn
);

1510 
°r
 = 
NULL
;

1512  
°r
;

1513 
	}
}

1517 
	$rouã_£t_communôy_dñëe_‰ì
 (*
ruÀ
)

1519 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1520 
	}
}

1523 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_communôy_dñëe_cmd
 =

1526 
rouã_£t_communôy_dñëe
,

1527 
rouã_£t_communôy_dñëe_compûe
,

1528 
rouã_£t_communôy_dñëe_‰ì
,

1534 
rouã_m≠_ªsu…_t


1535 
	$rouã_£t_ecommunôy_π
 (*
ruÀ
, 
¥efix
 *prefix,

1536 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1538 
ecommunôy
 *
ecom
;

1539 
ecommunôy
 *
√w_ecom
;

1540 
ecommunôy
 *
ﬁd_ecom
;

1541 
bgp_öfo
 *bgp_info;

1543 i‡(
ty≥
 =
RMAP_BGP
)

1545 
ecom
 = 
ruÀ
;

1546 
bgp_öfo
 = 
obje˘
;

1548 i‡(! 
ecom
)

1549  
RMAP_OKAY
;

1552 
ﬁd_ecom
 = (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
ecommunôy
;

1554 i‡(
ﬁd_ecom
)

1555 
√w_ecom
 = 
	`ecommunôy_mîge
 (
	`ecommunôy_dup
 (
ﬁd_ecom
), 
ecom
);

1557 
√w_ecom
 = 
	`ecommunôy_dup
 (
ecom
);

1559 
bgp_öfo
->
©å
->
exåa
->
ecommunôy
 = 
	`ecommunôy_öã∫
 (
√w_ecom
);

1561 i‡(
ﬁd_ecom
)

1562 
	`ecommunôy_unöã∫
 (&
ﬁd_ecom
);

1564 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
);

1566  
RMAP_OKAY
;

1567 
	}
}

1571 
	$rouã_£t_ecommunôy_π_compûe
 (c⁄° *
¨g
)

1573 
ecommunôy
 *
ecom
;

1575 
ecom
 = 
	`ecommunôy_°r2com
 (
¨g
, 
ECOMMUNITY_ROUTE_TARGET
, 0);

1576 i‡(! 
ecom
)

1577  
NULL
;

1578  
	`ecommunôy_öã∫
 (
ecom
);

1579 
	}
}

1583 
	$rouã_£t_ecommunôy_π_‰ì
 (*
ruÀ
)

1585 
ecommunôy
 *
ecom
 = 
ruÀ
;

1586 
	`ecommunôy_unöã∫
 (&
ecom
);

1587 
	}
}

1590 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_ecommunôy_π_cmd
 =

1593 
rouã_£t_ecommunôy_π
,

1594 
rouã_£t_ecommunôy_π_compûe
,

1595 
rouã_£t_ecommunôy_π_‰ì
,

1601 
rouã_m≠_ªsu…_t


1602 
	$rouã_£t_ecommunôy_soo
 (*
ruÀ
, 
¥efix
 *prefix,

1603 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1605 
ecommunôy
 *
ecom
, *
ﬁd_ecom
, *
√w_ecom
;

1606 
bgp_öfo
 *bgp_info;

1608 i‡(
ty≥
 =
RMAP_BGP
)

1610 
ecom
 = 
ruÀ
;

1611 
bgp_öfo
 = 
obje˘
;

1613 i‡(! 
ecom
)

1614  
RMAP_OKAY
;

1616 
ﬁd_ecom
 = (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
ecommunôy
;

1618 i‡(
ﬁd_ecom
)

1619 
√w_ecom
 = 
	`ecommunôy_mîge
 (
	`ecommunôy_dup
 (
ﬁd_ecom
), 
ecom
);

1621 
√w_ecom
 = 
	`ecommunôy_dup
 (
ecom
);

1623 
bgp_öfo
->
©å
->
exåa
->
ecommunôy
 = 
	`ecommunôy_öã∫
 (
√w_ecom
);

1625 i‡(
ﬁd_ecom
)

1626 
	`ecommunôy_unöã∫
 (&
ﬁd_ecom
);

1628 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
);

1630  
RMAP_OKAY
;

1631 
	}
}

1635 
	$rouã_£t_ecommunôy_soo_compûe
 (c⁄° *
¨g
)

1637 
ecommunôy
 *
ecom
;

1639 
ecom
 = 
	`ecommunôy_°r2com
 (
¨g
, 
ECOMMUNITY_SITE_ORIGIN
, 0);

1640 i‡(! 
ecom
)

1641  
NULL
;

1643  
	`ecommunôy_öã∫
 (
ecom
);

1644 
	}
}

1648 
	$rouã_£t_ecommunôy_soo_‰ì
 (*
ruÀ
)

1650 
ecommunôy
 *
ecom
 = 
ruÀ
;

1651 
	`ecommunôy_unöã∫
 (&
ecom
);

1652 
	}
}

1655 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_ecommunôy_soo_cmd
 =

1658 
rouã_£t_ecommunôy_soo
,

1659 
rouã_£t_ecommunôy_soo_compûe
,

1660 
rouã_£t_ecommunôy_soo_‰ì
,

1663 #ifde‡
USE_SRX


1667 
rouã_m≠_ªsu…_t


1668 
	$rouã_£t_ecommunôy_bgp£c
 (*
ruÀ
, 
¥efix
 *prefix,

1669 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1671 
ecommunôy
 *
ecom
;

1672 
ecommunôy
 *
√w_ecom
;

1673 
ecommunôy
 *
ﬁd_ecom
;

1674 
bgp_öfo
 *bgp_info;

1676 i‡(
ty≥
 =
RMAP_BGP
)

1678 
ecom
 = 
ruÀ
;

1679 
bgp_öfo
 = 
obje˘
;

1681 i‡(! 
ecom
)

1682  
RMAP_OKAY
;

1685 
ﬁd_ecom
 = (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
ecommunôy
;

1687 i‡(
ﬁd_ecom
)

1688 
√w_ecom
 = 
	`ecommunôy_mîge
 (
	`ecommunôy_dup
 (
ﬁd_ecom
), 
ecom
);

1690 
√w_ecom
 = 
	`ecommunôy_dup
 (
ecom
);

1693 
	`zlog_debug
(" bgp_öfo->vÆ_ªs_ROA:%d ", 
bgp_öfo
->
vÆ_ªs_ROA
);

1694 
	`zlog_debug
("Écom_vÆue: %08x ", *
√w_ecom
->
vÆ
);

1696 
bgp_öfo
->
©å
->
exåa
->
ecommunôy
 = 
	`ecommunôy_öã∫
 (
√w_ecom
);

1698 i‡(
ﬁd_ecom
)

1699 
	`ecommunôy_unöã∫
 (&
ﬁd_ecom
);

1701 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_EXT_COMMUNITIES
);

1702 
	`zlog_debug
(" i¡î√dÉcom_addr:%∞", 
bgp_öfo
->
©å
->
exåa
->
ecommunôy
);

1703 
	`zlog_debug
(" fœg:%08x ", 
bgp_öfo
->
©å
->
Êag
);

1707  
RMAP_OKAY
;

1708 
	}
}

1712 
	$rouã_£t_ecommunôy_bgp£c_compûe
 (c⁄° *
¨g
)

1714 
ecommunôy
 *
ecom
;

1715 
uiVÆid
;

1717 
uiVÆid
 = 
	`©oi
(
¨g
);

1719 i‡(
uiVÆid
 < 0 || uiVÆid > 
ECOMMUNITY_BGPSEC_INVALID
)

1720  
NULL
;

1722 
ecom
 = 
	`ecommunôy_bgp£c_°r2com
 (
ECOMMUNITY_BGPSEC_SUB
, 
uiVÆid
);

1723 i‡(! 
ecom
)

1724  
NULL
;

1725  
	`ecommunôy_öã∫
 (
ecom
);

1726 
	}
}

1730 
	$rouã_£t_ecommunôy_bgp£c_‰ì
 (*
ruÀ
)

1732 
ecommunôy
 *
ecom
 = 
ruÀ
;

1733 
	`ecommunôy_unöã∫
 (&
ecom
);

1734 
	}
}

1737 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_ecommunôy_bgp£c_cmd
 =

1740 
rouã_£t_ecommunôy_bgp£c
,

1741 
rouã_£t_ecommunôy_bgp£c_compûe
,

1742 
rouã_£t_ecommunôy_bgp£c_‰ì
,

1749 
rouã_m≠_ªsu…_t


1750 
	$rouã_£t_‹igö
 (*
ruÀ
, 
¥efix
 *¥efix, 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1752 
u_ch¨
 *
‹igö
;

1753 
bgp_öfo
 *bgp_info;

1755 i‡(
ty≥
 =
RMAP_BGP
)

1757 
‹igö
 = 
ruÀ
;

1758 
bgp_öfo
 = 
obje˘
;

1760 
bgp_öfo
->
©å
->
‹igö
 = *origin;

1763  
RMAP_OKAY
;

1764 
	}
}

1768 
	$rouã_£t_‹igö_compûe
 (c⁄° *
¨g
)

1770 
u_ch¨
 *
‹igö
;

1772 
‹igö
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
u_ch¨
));

1774 i‡(
	`°rcmp
 (
¨g
, "igp") == 0)

1775 *
‹igö
 = 0;

1776 i‡(
	`°rcmp
 (
¨g
, "egp") == 0)

1777 *
‹igö
 = 1;

1779 *
‹igö
 = 2;

1781  
‹igö
;

1782 
	}
}

1786 
	$rouã_£t_‹igö_‰ì
 (*
ruÀ
)

1788 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1789 
	}
}

1792 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_‹igö_cmd
 =

1795 
rouã_£t_‹igö
,

1796 
rouã_£t_‹igö_compûe
,

1797 
rouã_£t_‹igö_‰ì
,

1803 
rouã_m≠_ªsu…_t


1804 
	$rouã_£t_©omic_aggªg©e
 (*
ruÀ
, 
¥efix
 *prefix,

1805 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1807 
bgp_öfo
 *bgp_info;

1809 i‡(
ty≥
 =
RMAP_BGP
)

1811 
bgp_öfo
 = 
obje˘
;

1812 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ATOMIC_AGGREGATE
);

1815  
RMAP_OKAY
;

1816 
	}
}

1820 
	$rouã_£t_©omic_aggªg©e_compûe
 (c⁄° *
¨g
)

1823 
	}
}

1827 
	$rouã_£t_©omic_aggªg©e_‰ì
 (*
ruÀ
)

1830 
	}
}

1833 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_©omic_aggªg©e_cmd
 =

1836 
rouã_£t_©omic_aggªg©e
,

1837 
rouã_£t_©omic_aggªg©e_compûe
,

1838 
rouã_£t_©omic_aggªg©e_‰ì
,

1842 
	saggªg©‹


1844 
as_t
 
	mas
;

1845 
ö_addr
 
	maddªss
;

1848 
rouã_m≠_ªsu…_t


1849 
	$rouã_£t_aggªg©‹_as
 (*
ruÀ
, 
¥efix
 *prefix,

1850 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1852 
bgp_öfo
 *bgp_info;

1853 
aggªg©‹
 *aggregator;

1854 
©å_exåa
 *
´
;

1856 i‡(
ty≥
 =
RMAP_BGP
)

1858 
bgp_öfo
 = 
obje˘
;

1859 
aggªg©‹
 = 
ruÀ
;

1860 
´
 = 
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
);

1862 
´
->
aggªg©‹_as
 = 
aggªg©‹
->
as
;

1863 
´
->
aggªg©‹_addr
 = 
aggªg©‹
->
addªss
;

1864 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_AGGREGATOR
);

1867  
RMAP_OKAY
;

1868 
	}
}

1871 
	$rouã_£t_aggªg©‹_as_compûe
 (c⁄° *
¨g
)

1873 
aggªg©‹
 *aggregator;

1874 
as
[10];

1875 
addªss
[20];

1877 
aggªg©‹
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (aggregator));

1878 
	`ssˇnf
 (
¨g
, "%†%s", 
as
, 
addªss
);

1880 
aggªg©‹
->
as
 = 
	`°πoul
 (as, 
NULL
, 10);

1881 
	`öë_©⁄
 (
addªss
, &
aggªg©‹
->address);

1883  
aggªg©‹
;

1884 
	}
}

1887 
	$rouã_£t_aggªg©‹_as_‰ì
 (*
ruÀ
)

1889 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1890 
	}
}

1892 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_aggªg©‹_as_cmd
 =

1895 
rouã_£t_aggªg©‹_as
,

1896 
rouã_£t_aggªg©‹_as_compûe
,

1897 
rouã_£t_aggªg©‹_as_‰ì
,

1900 #ifde‡
HAVE_IPV6


1903 
rouã_m≠_ªsu…_t


1904 
	$rouã_m©ch_ùv6_addªss
 (*
ruÀ
, 
¥efix
 *prefix,

1905 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1907 
ac˚ss_li°
 *
Æi°
;

1909 i‡(
ty≥
 =
RMAP_BGP
)

1911 
Æi°
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP6
, (*Ë
ruÀ
);

1912 i‡(
Æi°
 =
NULL
)

1913  
RMAP_NOMATCH
;

1915  (
	`ac˚ss_li°_≠∂y
 (
Æi°
, 
¥efix
Ë=
FILTER_DENY
 ?

1916 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

1918  
RMAP_NOMATCH
;

1919 
	}
}

1922 
	$rouã_m©ch_ùv6_addªss_compûe
 (c⁄° *
¨g
)

1924  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

1925 
	}
}

1928 
	$rouã_m©ch_ùv6_addªss_‰ì
 (*
ruÀ
)

1930 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1931 
	}
}

1934 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ùv6_addªss_cmd
 =

1937 
rouã_m©ch_ùv6_addªss
,

1938 
rouã_m©ch_ùv6_addªss_compûe
,

1939 
rouã_m©ch_ùv6_addªss_‰ì


1944 
rouã_m≠_ªsu…_t


1945 
	$rouã_m©ch_ùv6_√xt_h›
 (*
ruÀ
, 
¥efix
 *prefix,

1946 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

1948 
ö6_addr
 *
addr
;

1949 
bgp_öfo
 *bgp_info;

1951 i‡(
ty≥
 =
RMAP_BGP
)

1953 
addr
 = 
ruÀ
;

1954 
bgp_öfo
 = 
obje˘
;

1956 i‡(!
bgp_öfo
->
©å
->
exåa
)

1957  
RMAP_NOMATCH
;

1959 i‡(
	`IPV6_ADDR_SAME
 (&
bgp_öfo
->
©å
->
exåa
->
mp_√xth›_globÆ
, 
ruÀ
))

1960  
RMAP_MATCH
;

1962 i‡(
bgp_öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 == 32 &&

1963 
	`IPV6_ADDR_SAME
 (&
bgp_öfo
->
©å
->
exåa
->
mp_√xth›_loˇl
, 
ruÀ
))

1964  
RMAP_MATCH
;

1966  
RMAP_NOMATCH
;

1969  
RMAP_NOMATCH
;

1970 
	}
}

1973 
	$rouã_m©ch_ùv6_√xt_h›_compûe
 (c⁄° *
¨g
)

1975 
ö6_addr
 *
addªss
;

1976 
ªt
;

1978 
addªss
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
ö6_addr
));

1980 
ªt
 = 
	`öë_±⁄
 (
AF_INET6
, 
¨g
, 
addªss
);

1981 i‡(!
ªt
)

1983 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
addªss
);

1984  
NULL
;

1987  
addªss
;

1988 
	}
}

1991 
	$rouã_m©ch_ùv6_√xt_h›_‰ì
 (*
ruÀ
)

1993 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

1994 
	}
}

1996 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ùv6_√xt_h›_cmd
 =

1999 
rouã_m©ch_ùv6_√xt_h›
,

2000 
rouã_m©ch_ùv6_√xt_h›_compûe
,

2001 
rouã_m©ch_ùv6_√xt_h›_‰ì


2006 
rouã_m≠_ªsu…_t


2007 
	$rouã_m©ch_ùv6_addªss_¥efix_li°
 (*
ruÀ
, 
¥efix
 *prefix,

2008 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

2010 
¥efix_li°
 *
∂i°
;

2012 i‡(
ty≥
 =
RMAP_BGP
)

2014 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_IP6
, (*Ë
ruÀ
);

2015 i‡(
∂i°
 =
NULL
)

2016  
RMAP_NOMATCH
;

2018  (
	`¥efix_li°_≠∂y
 (
∂i°
, 
¥efix
Ë=
PREFIX_DENY
 ?

2019 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

2021  
RMAP_NOMATCH
;

2022 
	}
}

2025 
	$rouã_m©ch_ùv6_addªss_¥efix_li°_compûe
 (c⁄° *
¨g
)

2027  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

2028 
	}
}

2031 
	$rouã_m©ch_ùv6_addªss_¥efix_li°_‰ì
 (*
ruÀ
)

2033 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

2034 
	}
}

2036 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ùv6_addªss_¥efix_li°_cmd
 =

2039 
rouã_m©ch_ùv6_addªss_¥efix_li°
,

2040 
rouã_m©ch_ùv6_addªss_¥efix_li°_compûe
,

2041 
rouã_m©ch_ùv6_addªss_¥efix_li°_‰ì


2047 
rouã_m≠_ªsu…_t


2048 
	$rouã_£t_ùv6_√xth›_globÆ
 (*
ruÀ
, 
¥efix
 *prefix,

2049 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

2051 
ö6_addr
 *
addªss
;

2052 
bgp_öfo
 *bgp_info;

2054 i‡(
ty≥
 =
RMAP_BGP
)

2057 
addªss
 = 
ruÀ
;

2058 
bgp_öfo
 = 
obje˘
;

2061 (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
mp_√xth›_globÆ
 = *
addªss
;

2064 i‡(
bgp_öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 == 0)

2065 
bgp_öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 = 16;

2068  
RMAP_OKAY
;

2069 
	}
}

2074 
	$rouã_£t_ùv6_√xth›_globÆ_compûe
 (c⁄° *
¨g
)

2076 
ªt
;

2077 
ö6_addr
 *
addªss
;

2079 
addªss
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
ö6_addr
));

2081 
ªt
 = 
	`öë_±⁄
 (
AF_INET6
, 
¨g
, 
addªss
);

2083 i‡(
ªt
 == 0)

2085 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
addªss
);

2086  
NULL
;

2089  
addªss
;

2090 
	}
}

2094 
	$rouã_£t_ùv6_√xth›_globÆ_‰ì
 (*
ruÀ
)

2096 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

2097 
	}
}

2100 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_ùv6_√xth›_globÆ_cmd
 =

2103 
rouã_£t_ùv6_√xth›_globÆ
,

2104 
rouã_£t_ùv6_√xth›_globÆ_compûe
,

2105 
rouã_£t_ùv6_√xth›_globÆ_‰ì


2111 
rouã_m≠_ªsu…_t


2112 
	$rouã_£t_ùv6_√xth›_loˇl
 (*
ruÀ
, 
¥efix
 *prefix,

2113 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

2115 
ö6_addr
 *
addªss
;

2116 
bgp_öfo
 *bgp_info;

2118 i‡(
ty≥
 =
RMAP_BGP
)

2121 
addªss
 = 
ruÀ
;

2122 
bgp_öfo
 = 
obje˘
;

2125 (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
mp_√xth›_loˇl
 = *
addªss
;

2128 i‡(
bgp_öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 != 32)

2129 
bgp_öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 = 32;

2132  
RMAP_OKAY
;

2133 
	}
}

2138 
	$rouã_£t_ùv6_√xth›_loˇl_compûe
 (c⁄° *
¨g
)

2140 
ªt
;

2141 
ö6_addr
 *
addªss
;

2143 
addªss
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
ö6_addr
));

2145 
ªt
 = 
	`öë_±⁄
 (
AF_INET6
, 
¨g
, 
addªss
);

2147 i‡(
ªt
 == 0)

2149 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
addªss
);

2150  
NULL
;

2153  
addªss
;

2154 
	}
}

2158 
	$rouã_£t_ùv6_√xth›_loˇl_‰ì
 (*
ruÀ
)

2160 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

2161 
	}
}

2164 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_ùv6_√xth›_loˇl_cmd
 =

2167 
rouã_£t_ùv6_√xth›_loˇl
,

2168 
rouã_£t_ùv6_√xth›_loˇl_compûe
,

2169 
rouã_£t_ùv6_√xth›_loˇl_‰ì


2175 
rouã_m≠_ªsu…_t


2176 
	$rouã_£t_v≤v4_√xth›
 (*
ruÀ
, 
¥efix
 *prefix,

2177 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

2179 
ö_addr
 *
addªss
;

2180 
bgp_öfo
 *bgp_info;

2182 i‡(
ty≥
 =
RMAP_BGP
)

2185 
addªss
 = 
ruÀ
;

2186 
bgp_öfo
 = 
obje˘
;

2189 (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
mp_√xth›_globÆ_ö
 = *
addªss
;

2192  
RMAP_OKAY
;

2193 
	}
}

2196 
	$rouã_£t_v≤v4_√xth›_compûe
 (c⁄° *
¨g
)

2198 
ªt
;

2199 
ö_addr
 *
addªss
;

2201 
addªss
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
ö_addr
));

2203 
ªt
 = 
	`öë_©⁄
 (
¨g
, 
addªss
);

2205 i‡(
ªt
 == 0)

2207 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
addªss
);

2208  
NULL
;

2211  
addªss
;

2212 
	}
}

2215 
	$rouã_£t_v≤v4_√xth›_‰ì
 (*
ruÀ
)

2217 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

2218 
	}
}

2221 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_v≤v4_√xth›_cmd
 =

2224 
rouã_£t_v≤v4_√xth›
,

2225 
rouã_£t_v≤v4_√xth›_compûe
,

2226 
rouã_£t_v≤v4_√xth›_‰ì


2232 
rouã_m≠_ªsu…_t


2233 
	$rouã_£t_‹igö©‹_id
 (*
ruÀ
, 
¥efix
 *¥efix, 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

2235 
ö_addr
 *
addªss
;

2236 
bgp_öfo
 *bgp_info;

2238 i‡(
ty≥
 =
RMAP_BGP
)

2240 
addªss
 = 
ruÀ
;

2241 
bgp_öfo
 = 
obje˘
;

2243 
bgp_öfo
->
©å
->
Êag
 |
	`ATTR_FLAG_BIT
 (
BGP_ATTR_ORIGINATOR_ID
);

2244 (
	`bgp_©å_exåa_gë
 (
bgp_öfo
->
©å
))->
‹igö©‹_id
 = *
addªss
;

2247  
RMAP_OKAY
;

2248 
	}
}

2252 
	$rouã_£t_‹igö©‹_id_compûe
 (c⁄° *
¨g
)

2254 
ªt
;

2255 
ö_addr
 *
addªss
;

2257 
addªss
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
ö_addr
));

2259 
ªt
 = 
	`öë_©⁄
 (
¨g
, 
addªss
);

2261 i‡(
ªt
 == 0)

2263 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
addªss
);

2264  
NULL
;

2267  
addªss
;

2268 
	}
}

2272 
	$rouã_£t_‹igö©‹_id_‰ì
 (*
ruÀ
)

2274 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

2275 
	}
}

2278 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_‹igö©‹_id_cmd
 =

2281 
rouã_£t_‹igö©‹_id
,

2282 
rouã_£t_‹igö©‹_id_compûe
,

2283 
rouã_£t_‹igö©‹_id_‰ì
,

2288 
	$bgp_rouã_m©ch_add
 (
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

2289 c⁄° *
comm™d
, c⁄° *
¨g
)

2291 
ªt
;

2293 
ªt
 = 
	`rouã_m≠_add_m©ch
 (
ödex
, 
comm™d
, 
¨g
);

2294 i‡(
ªt
)

2296 
ªt
)

2298 
RMAP_RULE_MISSING
:

2299 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

2300  
CMD_WARNING
;

2301 
RMAP_COMPILE_ERROR
:

2302 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

2303  
CMD_WARNING
;

2306  
CMD_SUCCESS
;

2307 
	}
}

2311 
	$bgp_rouã_m©ch_dñëe
 (
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

2312 c⁄° *
comm™d
, c⁄° *
¨g
)

2314 
ªt
;

2316 
ªt
 = 
	`rouã_m≠_dñëe_m©ch
 (
ödex
, 
comm™d
, 
¨g
);

2317 i‡(
ªt
)

2319 
ªt
)

2321 
RMAP_RULE_MISSING
:

2322 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

2323  
CMD_WARNING
;

2324 
RMAP_COMPILE_ERROR
:

2325 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

2326  
CMD_WARNING
;

2329  
CMD_SUCCESS
;

2330 
	}
}

2334 
	$bgp_rouã_£t_add
 (
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

2335 c⁄° *
comm™d
, c⁄° *
¨g
)

2337 
ªt
;

2339 
ªt
 = 
	`rouã_m≠_add_£t
 (
ödex
, 
comm™d
, 
¨g
);

2340 i‡(
ªt
)

2342 
ªt
)

2344 
RMAP_RULE_MISSING
:

2345 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

2346  
CMD_WARNING
;

2347 
RMAP_COMPILE_ERROR
:

2348 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

2349  
CMD_WARNING
;

2352  
CMD_SUCCESS
;

2353 
	}
}

2357 
	$bgp_rouã_£t_dñëe
 (
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

2358 c⁄° *
comm™d
, c⁄° *
¨g
)

2360 
ªt
;

2362 
ªt
 = 
	`rouã_m≠_dñëe_£t
 (
ödex
, 
comm™d
, 
¨g
);

2363 i‡(
ªt
)

2365 
ªt
)

2367 
RMAP_RULE_MISSING
:

2368 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

2369  
CMD_WARNING
;

2370 
RMAP_COMPILE_ERROR
:

2371 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

2372  
CMD_WARNING
;

2375  
CMD_SUCCESS
;

2376 
	}
}

2380 
	$bgp_rouã_m≠_upd©e
 (c⁄° *
unu£d
)

2382 
i
;

2383 
afi_t
 
afi
;

2384 
ßfi_t
 
ßfi
;

2385 
dúe˘
;

2386 
li°node
 *
node
, *
¬ode
;

2387 
li°node
 *
mnode
, *
m¬ode
;

2388 
bgp
 *bgp;

2389 
≥î
 *peer;

2390 
≥î_group
 *
group
;

2391 
bgp_fûãr
 *
fûãr
;

2392 
bgp_node
 *
bn
;

2393 
bgp_°©ic
 *bgp_static;

2396 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

2398 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

2400 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

2401 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

2403 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

2405 
dúe˘
 = 
RMAP_IN
; dúe˘ < 
RMAP_MAX
; direct++)

2407 i‡(
fûãr
->
m≠
[
dúe˘
].
«me
)

2408 
fûãr
->
m≠
[
dúe˘
].map =

2409 
	`rouã_m≠_lookup_by_«me
 (
fûãr
->
m≠
[
dúe˘
].
«me
);

2411 
fûãr
->
m≠
[
dúe˘
].m≠ = 
NULL
;

2414 i‡(
fûãr
->
usm≠
.
«me
)

2415 
fûãr
->
usm≠
.
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (fûãr->usm≠.
«me
);

2417 
fûãr
->
usm≠
.
m≠
 = 
NULL
;

2420 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
¬ode
, group))

2422 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

2423 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

2425 
fûãr
 = &
group
->
c⁄f
->fûãr[
afi
][
ßfi
];

2427 
dúe˘
 = 
RMAP_IN
; dúe˘ < 
RMAP_MAX
; direct++)

2429 i‡(
fûãr
->
m≠
[
dúe˘
].
«me
)

2430 
fûãr
->
m≠
[
dúe˘
].map =

2431 
	`rouã_m≠_lookup_by_«me
 (
fûãr
->
m≠
[
dúe˘
].
«me
);

2433 
fûãr
->
m≠
[
dúe˘
].m≠ = 
NULL
;

2436 i‡(
fûãr
->
usm≠
.
«me
)

2437 
fûãr
->
usm≠
.
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (fûãr->usm≠.
«me
);

2439 
fûãr
->
usm≠
.
m≠
 = 
NULL
;

2445 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

2447 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

2449 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

2450 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

2452 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

2453 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 =

2454 
	`rouã_m≠_lookup_by_«me
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

2456 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 = 
NULL
;

2462 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

2464 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

2465 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

2466 
bn
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rouã
[
afi
][
ßfi
]); bn;

2467 
bn
 = 
	`bgp_rouã_√xt
 (bn))

2468 i‡((
bgp_°©ic
 = 
bn
->
öfo
Ë!
NULL
)

2470 i‡(
bgp_°©ic
->
rm≠
.
«me
)

2471 
bgp_°©ic
->
rm≠
.
m≠
 =

2472 
	`rouã_m≠_lookup_by_«me
 (
bgp_°©ic
->
rm≠
.
«me
);

2474 
bgp_°©ic
->
rm≠
.
m≠
 = 
NULL
;

2479 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

2481 
i
 = 0; i < 
ZEBRA_ROUTE_MAX
; i++)

2483 i‡(
bgp
->
rm≠
[
ZEBRA_FAMILY_IPV4
][
i
].
«me
)

2484 
bgp
->
rm≠
[
ZEBRA_FAMILY_IPV4
][
i
].
m≠
 =

2485 
	`rouã_m≠_lookup_by_«me
 (
bgp
->
rm≠
[
ZEBRA_FAMILY_IPV4
][
i
].
«me
);

2486 #ifde‡
HAVE_IPV6


2487 i‡(
bgp
->
rm≠
[
ZEBRA_FAMILY_IPV6
][
i
].
«me
)

2488 
bgp
->
rm≠
[
ZEBRA_FAMILY_IPV6
][
i
].
m≠
 =

2489 
	`rouã_m≠_lookup_by_«me
 (
bgp
->
rm≠
[
ZEBRA_FAMILY_IPV6
][
i
].
«me
);

2493 
	}
}

2495 
DEFUN
 (
m©ch_≥î
,

2496 
m©ch_≥î_cmd
,

2498 
MATCH_STR


2503  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "≥î", 
¨gv
[0]);

2506 
DEFUN
 (
m©ch_≥î_loˇl
,

2507 
m©ch_≥î_loˇl_cmd
,

2509 
MATCH_STR


2513  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "peer", "local");

2516 
DEFUN
 (
no_m©ch_≥î
,

2517 
no_m©ch_≥î_cmd
,

2519 
NO_STR


2520 
MATCH_STR


2523 i‡(
	g¨gc
 == 0)

2524  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "≥î", 
NULL
);

2526  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "≥î", 
¨gv
[0]);

2529 
ALIAS
 (
no_m©ch_≥î
,

2530 
no_m©ch_≥î_vÆ_cmd
,

2532 
NO_STR


2533 
MATCH_STR


2538 
ALIAS
 (
no_m©ch_≥î
,

2539 
no_m©ch_≥î_loˇl_cmd
,

2541 
NO_STR


2542 
MATCH_STR


2546 
DEFUN
 (
m©ch_ù_addªss
,

2547 
m©ch_ù_addªss_cmd
,

2549 
MATCH_STR


2550 
IP_STR


2556  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùáddªss", 
¨gv
[0]);

2559 
DEFUN
 (
no_m©ch_ù_addªss
,

2560 
no_m©ch_ù_addªss_cmd
,

2562 
NO_STR


2563 
MATCH_STR


2564 
IP_STR


2567 i‡(
	g¨gc
 == 0)

2568  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªss", 
NULL
);

2570  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªss", 
¨gv
[0]);

2573 
ALIAS
 (
no_m©ch_ù_addªss
,

2574 
no_m©ch_ù_addªss_vÆ_cmd
,

2576 
NO_STR


2577 
MATCH_STR


2578 
IP_STR


2584 
DEFUN
 (
m©ch_ù_√xt_h›
,

2585 
m©ch_ù_√xt_h›_cmd
,

2587 
MATCH_STR


2588 
IP_STR


2594  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùÇext-h›", 
¨gv
[0]);

2597 
DEFUN
 (
no_m©ch_ù_√xt_h›
,

2598 
no_m©ch_ù_√xt_h›_cmd
,

2600 
NO_STR


2601 
MATCH_STR


2602 
IP_STR


2605 i‡(
	g¨gc
 == 0)

2606  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›", 
NULL
);

2608  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›", 
¨gv
[0]);

2611 
ALIAS
 (
no_m©ch_ù_√xt_h›
,

2612 
no_m©ch_ù_√xt_h›_vÆ_cmd
,

2614 
NO_STR


2615 
MATCH_STR


2616 
IP_STR


2624 
DEFUN
 (
m©ch_¥obabûôy
,

2625 
m©ch_¥obabûôy_cmd
,

2627 
MATCH_STR


2631  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "¥obabûôy", 
¨gv
[0]);

2634 
DEFUN
 (
no_m©ch_¥obabûôy
,

2635 
no_m©ch_¥obabûôy_cmd
,

2637 
NO_STR


2638 
MATCH_STR


2641  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "¥obabûôy", 
¨gc
 ? 
¨gv
[0] : 
NULL
);

2644 
ALIAS
 (
no_m©ch_¥obabûôy
,

2645 
no_m©ch_¥obabûôy_vÆ_cmd
,

2647 
NO_STR


2648 
MATCH_STR


2654 
DEFUN
 (
m©ch_ù_rouã_sour˚
,

2655 
m©ch_ù_rouã_sour˚_cmd
,

2657 
MATCH_STR


2658 
IP_STR


2664  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùÑouã-sour˚", 
¨gv
[0]);

2667 
DEFUN
 (
no_m©ch_ù_rouã_sour˚
,

2668 
no_m©ch_ù_rouã_sour˚_cmd
,

2670 
NO_STR


2671 
MATCH_STR


2672 
IP_STR


2675 i‡(
	g¨gc
 == 0)

2676  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÑouã-sour˚", 
NULL
);

2678  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÑouã-sour˚", 
¨gv
[0]);

2681 
ALIAS
 (
no_m©ch_ù_rouã_sour˚
,

2682 
no_m©ch_ù_rouã_sour˚_vÆ_cmd
,

2684 
NO_STR


2685 
MATCH_STR


2686 
IP_STR


2692 
DEFUN
 (
m©ch_ù_addªss_¥efix_li°
,

2693 
m©ch_ù_addªss_¥efix_li°_cmd
,

2695 
MATCH_STR


2696 
IP_STR


2701  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùáddªs†¥efix-li°", 
¨gv
[0]);

2704 
DEFUN
 (
no_m©ch_ù_addªss_¥efix_li°
,

2705 
no_m©ch_ù_addªss_¥efix_li°_cmd
,

2707 
NO_STR


2708 
MATCH_STR


2709 
IP_STR


2713 i‡(
	g¨gc
 == 0)

2714  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªs†¥efix-li°", 
NULL
);

2716  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªs†¥efix-li°", 
¨gv
[0]);

2719 
ALIAS
 (
no_m©ch_ù_addªss_¥efix_li°
,

2720 
no_m©ch_ù_addªss_¥efix_li°_vÆ_cmd
,

2722 
NO_STR


2723 
MATCH_STR


2724 
IP_STR


2729 
DEFUN
 (
m©ch_ù_√xt_h›_¥efix_li°
,

2730 
m©ch_ù_√xt_h›_¥efix_li°_cmd
,

2732 
MATCH_STR


2733 
IP_STR


2738  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùÇext-h›Öªfix-li°", 
¨gv
[0]);

2741 
DEFUN
 (
no_m©ch_ù_√xt_h›_¥efix_li°
,

2742 
no_m©ch_ù_√xt_h›_¥efix_li°_cmd
,

2744 
NO_STR


2745 
MATCH_STR


2746 
IP_STR


2750 i‡(
	g¨gc
 == 0)

2751  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›Öªfix-li°", 
NULL
);

2753  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›Öªfix-li°", 
¨gv
[0]);

2756 
ALIAS
 (
no_m©ch_ù_√xt_h›_¥efix_li°
,

2757 
no_m©ch_ù_√xt_h›_¥efix_li°_vÆ_cmd
,

2759 
NO_STR


2760 
MATCH_STR


2761 
IP_STR


2766 
DEFUN
 (
m©ch_ù_rouã_sour˚_¥efix_li°
,

2767 
m©ch_ù_rouã_sour˚_¥efix_li°_cmd
,

2769 
MATCH_STR


2770 
IP_STR


2775  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùÑouã-sour˚Öªfix-li°", 
¨gv
[0]);

2778 
DEFUN
 (
no_m©ch_ù_rouã_sour˚_¥efix_li°
,

2779 
no_m©ch_ù_rouã_sour˚_¥efix_li°_cmd
,

2781 
NO_STR


2782 
MATCH_STR


2783 
IP_STR


2787 i‡(
	g¨gc
 == 0)

2788  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÑouã-sour˚Öªfix-li°", 
NULL
);

2790  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÑouã-sour˚Öªfix-li°", 
¨gv
[0]);

2793 
ALIAS
 (
no_m©ch_ù_rouã_sour˚_¥efix_li°
,

2794 
no_m©ch_ù_rouã_sour˚_¥efix_li°_vÆ_cmd
,

2796 
NO_STR


2797 
MATCH_STR


2798 
IP_STR


2803 
DEFUN
 (
m©ch_mëric
,

2804 
m©ch_mëric_cmd
,

2806 
MATCH_STR


2810  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "mëric", 
¨gv
[0]);

2813 
DEFUN
 (
no_m©ch_mëric
,

2814 
no_m©ch_mëric_cmd
,

2816 
NO_STR


2817 
MATCH_STR


2820 i‡(
	g¨gc
 == 0)

2821  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "mëric", 
NULL
);

2823  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "mëric", 
¨gv
[0]);

2826 
ALIAS
 (
no_m©ch_mëric
,

2827 
no_m©ch_mëric_vÆ_cmd
,

2829 
NO_STR


2830 
MATCH_STR


2834 
DEFUN
 (
m©ch_communôy
,

2835 
m©ch_communôy_cmd
,

2837 
MATCH_STR


2843  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "communôy", 
¨gv
[0]);

2846 
DEFUN
 (
m©ch_communôy_exa˘
,

2847 
m©ch_communôy_exa˘_cmd
,

2849 
MATCH_STR


2856 
	gªt
;

2857 *
	g¨g°r
;

2859 
	g¨g°r
 = 
XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,

2860 
°æí
 (
¨gv
[0]) + strlen ("exact-match") + 2);

2862 
•rötf
 (
¨g°r
, "%†exa˘-m©ch", 
¨gv
[0]);

2864 
	gªt
 = 
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "communôy", 
¨g°r
);

2866 
XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g°r
);

2868  
	gªt
;

2871 
DEFUN
 (
no_m©ch_communôy
,

2872 
no_m©ch_communôy_cmd
,

2874 
NO_STR


2875 
MATCH_STR


2878  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "communôy", 
NULL
);

2881 
ALIAS
 (
no_m©ch_communôy
,

2882 
no_m©ch_communôy_vÆ_cmd
,

2884 
NO_STR


2885 
MATCH_STR


2891 
ALIAS
 (
no_m©ch_communôy
,

2892 
no_m©ch_communôy_exa˘_cmd
,

2894 
NO_STR


2895 
MATCH_STR


2902 
DEFUN
 (
m©ch_ecommunôy
,

2903 
m©ch_ecommunôy_cmd
,

2905 
MATCH_STR


2911  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "extcommunôy", 
¨gv
[0]);

2914 
DEFUN
 (
no_m©ch_ecommunôy
,

2915 
no_m©ch_ecommunôy_cmd
,

2917 
NO_STR


2918 
MATCH_STR


2921  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "extcommunôy", 
NULL
);

2924 
ALIAS
 (
no_m©ch_ecommunôy
,

2925 
no_m©ch_ecommunôy_vÆ_cmd
,

2927 
NO_STR


2928 
MATCH_STR


2934 
DEFUN
 (
m©ch_a•©h
,

2935 
m©ch_a•©h_cmd
,

2937 
MATCH_STR


2941  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "as-∑th", 
¨gv
[0]);

2944 
DEFUN
 (
no_m©ch_a•©h
,

2945 
no_m©ch_a•©h_cmd
,

2947 
NO_STR


2948 
MATCH_STR


2951  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "as-∑th", 
NULL
);

2954 
ALIAS
 (
no_m©ch_a•©h
,

2955 
no_m©ch_a•©h_vÆ_cmd
,

2957 
NO_STR


2958 
MATCH_STR


2962 
DEFUN
 (
m©ch_‹igö
,

2963 
m©ch_‹igö_cmd
,

2965 
MATCH_STR


2971 i‡(
°∫cmp
 (
¨gv
[0], "igp", 2) == 0)

2972  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "origin", "igp");

2973 i‡(
°∫cmp
 (
¨gv
[0], "egp", 1) == 0)

2974  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "origin", "egp");

2975 i‡(
°∫cmp
 (
¨gv
[0], "incomplete", 2) == 0)

2976  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "origin", "incomplete");

2978  
	gCMD_WARNING
;

2981 
DEFUN
 (
no_m©ch_‹igö
,

2982 
no_m©ch_‹igö_cmd
,

2984 
NO_STR


2985 
MATCH_STR


2988  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "‹igö", 
NULL
);

2991 
ALIAS
 (
no_m©ch_‹igö
,

2992 
no_m©ch_‹igö_vÆ_cmd
,

2994 
NO_STR


2995 
MATCH_STR


3001 
DEFUN
 (
£t_ù_√xth›
,

3002 
£t_ù_√xth›_cmd
,

3004 
SET_STR


3005 
IP_STR


3009 
sockuni⁄
 
	gsu
;

3010 
	gªt
;

3012 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[0], &
su
);

3013 i‡(
	gªt
 < 0)

3015 
vty_out
 (
vty
, "%% MÆf‹med Next-h›áddªss%s", 
VTY_NEWLINE
);

3016  
	gCMD_WARNING
;

3019  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "ùÇext-h›", 
¨gv
[0]);

3022 
DEFUN
 (
£t_ù_√xth›_≥î
,

3023 
£t_ù_√xth›_≥î_cmd
,

3025 
SET_STR


3026 
IP_STR


3030  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "ipÇext-hop", "peer-address");

3033 
DEFUN_DEPRECATED
 (
no_£t_ù_√xth›_≥î
,

3034 
no_£t_ù_√xth›_≥î_cmd
,

3036 
NO_STR


3037 
SET_STR


3038 
IP_STR


3042  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›", 
NULL
);

3046 
DEFUN
 (
no_£t_ù_√xth›
,

3047 
no_£t_ù_√xth›_cmd
,

3049 
NO_STR


3050 
SET_STR


3053 i‡(
	g¨gc
 == 0)

3054  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›", 
NULL
);

3056  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›", 
¨gv
[0]);

3059 
ALIAS
 (
no_£t_ù_√xth›
,

3060 
no_£t_ù_√xth›_vÆ_cmd
,

3062 
NO_STR


3063 
SET_STR


3064 
IP_STR


3068 
DEFUN
 (
£t_mëric
,

3069 
£t_mëric_cmd
,

3071 
SET_STR


3075  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "mëric", 
¨gv
[0]);

3078 
ALIAS
 (
£t_mëric
,

3079 
£t_mëric_addsub_cmd
,

3081 
SET_STR


3085 
DEFUN
 (
no_£t_mëric
,

3086 
no_£t_mëric_cmd
,

3088 
NO_STR


3089 
SET_STR


3092 i‡(
	g¨gc
 == 0)

3093  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "mëric", 
NULL
);

3095  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "mëric", 
¨gv
[0]);

3098 
ALIAS
 (
no_£t_mëric
,

3099 
no_£t_mëric_vÆ_cmd
,

3101 
NO_STR


3102 
SET_STR


3106 
DEFUN
 (
£t_loˇl_¥ef
,

3107 
£t_loˇl_¥ef_cmd
,

3109 
SET_STR


3113  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "loˇl-¥e„ªn˚", 
¨gv
[0]);

3116 
DEFUN
 (
no_£t_loˇl_¥ef
,

3117 
no_£t_loˇl_¥ef_cmd
,

3119 
NO_STR


3120 
SET_STR


3123 i‡(
	g¨gc
 == 0)

3124  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "loˇl-¥e„ªn˚", 
NULL
);

3126  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "loˇl-¥e„ªn˚", 
¨gv
[0]);

3129 
ALIAS
 (
no_£t_loˇl_¥ef
,

3130 
no_£t_loˇl_¥ef_vÆ_cmd
,

3132 
NO_STR


3133 
SET_STR


3137 
DEFUN
 (
£t_weight
,

3138 
£t_weight_cmd
,

3140 
SET_STR


3144  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "weight", 
¨gv
[0]);

3147 
DEFUN
 (
no_£t_weight
,

3148 
no_£t_weight_cmd
,

3150 
NO_STR


3151 
SET_STR


3154 i‡(
	g¨gc
 == 0)

3155  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "weight", 
NULL
);

3157  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "weight", 
¨gv
[0]);

3160 
ALIAS
 (
no_£t_weight
,

3161 
no_£t_weight_vÆ_cmd
,

3163 
NO_STR


3164 
SET_STR


3168 
DEFUN
 (
£t_a•©h_¥ïíd
,

3169 
£t_a•©h_¥ïíd_cmd
,

3170 "£àas-∑thÖª≥nd ." 
CMD_AS_RANGE
,

3171 
SET_STR


3176 
	gªt
;

3177 *
	g°r
;

3179 
	g°r
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

3180 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "as-∑thÖª≥nd", 
°r
);

3181 
XFREE
 (
MTYPE_TMP
, 
°r
);

3183  
	gªt
;

3186 
DEFUN
 (
no_£t_a•©h_¥ïíd
,

3187 
no_£t_a•©h_¥ïíd_cmd
,

3189 
NO_STR


3190 
SET_STR


3194 
	gªt
;

3195 *
	g°r
;

3197 i‡(
	g¨gc
 == 0)

3198  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "as-∑thÖª≥nd", 
NULL
);

3200 
	g°r
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

3201 
	gªt
 = 
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "as-∑thÖª≥nd", 
°r
);

3202 
XFREE
 (
MTYPE_TMP
, 
°r
);

3203  
	gªt
;

3206 
ALIAS
 (
no_£t_a•©h_¥ïíd
,

3207 
no_£t_a•©h_¥ïíd_vÆ_cmd
,

3208 "nÿ£àas-∑thÖª≥nd ." 
CMD_AS_RANGE
,

3209 
NO_STR


3210 
SET_STR


3215 
DEFUN
 (
£t_a•©h_ex˛ude
,

3216 
£t_a•©h_ex˛ude_cmd
,

3217 "£àas-∑thÉx˛udê." 
CMD_AS_RANGE
,

3218 
SET_STR


3223 
	gªt
;

3224 *
	g°r
;

3226 
	g°r
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

3227 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "as-∑thÉx˛ude", 
°r
);

3228 
XFREE
 (
MTYPE_TMP
, 
°r
);

3229  
	gªt
;

3232 
DEFUN
 (
no_£t_a•©h_ex˛ude
,

3233 
no_£t_a•©h_ex˛ude_cmd
,

3235 
NO_STR


3236 
SET_STR


3240 
	gªt
;

3241 *
	g°r
;

3243 i‡(
	g¨gc
 == 0)

3244  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "as-∑thÉx˛ude", 
NULL
);

3246 
	g°r
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

3247 
	gªt
 = 
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "as-∑thÉx˛ude", 
°r
);

3248 
XFREE
 (
MTYPE_TMP
, 
°r
);

3249  
	gªt
;

3252 
ALIAS
 (
no_£t_a•©h_ex˛ude
,

3253 
no_£t_a•©h_ex˛ude_vÆ_cmd
,

3254 "nÿ£àas-∑thÉx˛udê." 
CMD_AS_RANGE
,

3255 
NO_STR


3256 
SET_STR


3261 
DEFUN
 (
£t_communôy
,

3262 
£t_communôy_cmd
,

3264 
SET_STR


3268 
	gi
;

3269 
	gfú°
 = 0;

3270 
	gaddôive
 = 0;

3271 
buf„r
 *
	gb
;

3272 
communôy
 *
	gcom
 = 
NULL
;

3273 *
	g°r
;

3274 *
	g¨g°r
;

3275 
	gªt
;

3277 
	gb
 = 
buf„r_√w
 (1024);

3279 
	gi
 = 0; i < 
	g¨gc
; i++)

3281 i‡(
°∫cmp
 (
¨gv
[
i
], "addôive", 
°æí
 (argv[i])) == 0)

3283 
addôive
 = 1;

3287 i‡(
	gfú°
)

3288 
buf„r_putc
 (
b
, ' ');

3290 
	gfú°
 = 1;

3292 i‡(
°∫cmp
 (
¨gv
[
i
], "öã∫ë", 
°æí
 (argv[i])) == 0)

3294 
buf„r_put°r
 (
b
, "internet");

3297 i‡(
°∫cmp
 (
¨gv
[
i
], "loˇl-AS", 
°æí
 (argv[i])) == 0)

3299 
buf„r_put°r
 (
b
, "local-AS");

3302 i‡(
°∫cmp
 (
¨gv
[
i
], "no-a", 
°æí
 ("no-a")) == 0

3303 && 
°∫cmp
 (
¨gv
[
i
], "no-advîti£", 
°æí
 (argv[i])) == 0)

3305 
buf„r_put°r
 (
b
, "no-advertise");

3308 i‡(
°∫cmp
 (
¨gv
[
i
], "no-e", 
°æí
 ("no-e"))== 0

3309 && 
°∫cmp
 (
¨gv
[
i
], "no-exp‹t", 
°æí
 (argv[i])) == 0)

3311 
buf„r_put°r
 (
b
, "no-export");

3314 
buf„r_put°r
 (
b
, 
¨gv
[
i
]);

3316 
buf„r_putc
 (
b
, '\0');

3319 
	g°r
 = 
buf„r_gë°r
 (
b
);

3320 
buf„r_‰ì
 (
b
);

3322 i‡(
	g°r
)

3324 
	gcom
 = 
communôy_°r2com
 (
°r
);

3325 
XFREE
 (
MTYPE_TMP
, 
°r
);

3329 i‡(! 
	gcom
)

3331 
vty_out
 (
vty
, "%% MÆf‹med communôõ†©åibuã%s", 
VTY_NEWLINE
);

3332  
	gCMD_WARNING
;

3336 
	g°r
 = 
communôy_°r
 (
com
);

3338 i‡(
	gaddôive
)

3340 
	g¨g°r
 = 
XCALLOC
 (
MTYPE_TMP
, 
°æí
 (
°r
) + strlen ("ádditive") + 1);

3341 
°r˝y
 (
¨g°r
, 
°r
);

3342 
°r˝y
 (
¨g°r
 + 
°æí
 (
°r
), "ádditive");

3343 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "communôy", 
¨g°r
);

3344 
XFREE
 (
MTYPE_TMP
, 
¨g°r
);

3347 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "communôy", 
°r
);

3349 
communôy_‰ì
 (
com
);

3351  
	gªt
;

3354 
DEFUN
 (
£t_communôy_n⁄e
,

3355 
£t_communôy_n⁄e_cmd
,

3357 
SET_STR


3361  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "community", "none");

3364 
DEFUN
 (
no_£t_communôy
,

3365 
no_£t_communôy_cmd
,

3367 
NO_STR


3368 
SET_STR


3371  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "communôy", 
NULL
);

3374 
ALIAS
 (
no_£t_communôy
,

3375 
no_£t_communôy_vÆ_cmd
,

3377 
NO_STR


3378 
SET_STR


3382 
ALIAS
 (
no_£t_communôy
,

3383 
no_£t_communôy_n⁄e_cmd
,

3385 
NO_STR


3386 
SET_STR


3390 
DEFUN
 (
£t_communôy_dñëe
,

3391 
£t_communôy_dñëe_cmd
,

3393 
SET_STR


3400 *
	g°r
;

3402 
	g°r
 = 
XCALLOC
 (
MTYPE_TMP
, 
°æí
 (
¨gv
[0]) + strlen (" delete") + 1);

3403 
°r˝y
 (
°r
, 
¨gv
[0]);

3404 
°r˝y
 (
°r
 + 
°æí
 (
¨gv
[0]), " delete");

3406 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "comm-li°", 
°r
);

3408 
XFREE
 (
MTYPE_TMP
, 
°r
);

3409  
	gCMD_SUCCESS
;

3412 
DEFUN
 (
no_£t_communôy_dñëe
,

3413 
no_£t_communôy_dñëe_cmd
,

3415 
NO_STR


3416 
SET_STR


3419  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "comm-li°", 
NULL
);

3422 
ALIAS
 (
no_£t_communôy_dñëe
,

3423 
no_£t_communôy_dñëe_vÆ_cmd
,

3425 
NO_STR


3426 
SET_STR


3433 
DEFUN
 (
£t_ecommunôy_π
,

3434 
£t_ecommunôy_π_cmd
,

3436 
SET_STR


3441 
	gªt
;

3442 *
	g°r
;

3444 
	g°r
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

3445 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "extcommunôyÑt", 
°r
);

3446 
XFREE
 (
MTYPE_TMP
, 
°r
);

3448  
	gªt
;

3451 
DEFUN
 (
no_£t_ecommunôy_π
,

3452 
no_£t_ecommunôy_π_cmd
,

3454 
NO_STR


3455 
SET_STR


3459  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "extcommunôyÑt", 
NULL
);

3462 
ALIAS
 (
no_£t_ecommunôy_π
,

3463 
no_£t_ecommunôy_π_vÆ_cmd
,

3465 
NO_STR


3466 
SET_STR


3471 
DEFUN
 (
£t_ecommunôy_soo
,

3472 
£t_ecommunôy_soo_cmd
,

3474 
SET_STR


3479 
	gªt
;

3480 *
	g°r
;

3482 
	g°r
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

3483 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "extcommunôy soo", 
°r
);

3484 
XFREE
 (
MTYPE_TMP
, 
°r
);

3485  
	gªt
;

3488 
DEFUN
 (
no_£t_ecommunôy_soo
,

3489 
no_£t_ecommunôy_soo_cmd
,

3491 
NO_STR


3492 
SET_STR


3496  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "extcommunôy soo", 
NULL
);

3499 
ALIAS
 (
no_£t_ecommunôy_soo
,

3500 
no_£t_ecommunôy_soo_vÆ_cmd
,

3502 
NO_STR


3503 
SET_STR


3508 #ifde‡
USE_SRX


3509 
DEFUN
 (
£t_ecommunôy_bgp£c
,

3510 
£t_ecommunôy_bgp£c_cmd
,

3512 
SET_STR


3517 
	gªt
;

3518 *
	g°r
;

3520 
	g°r
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

3521 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "extcommunôy bgp£c", 
°r
);

3522 
XFREE
 (
MTYPE_TMP
, 
°r
);

3524  
	gªt
;

3527 
DEFUN
 (
no_£t_ecommunôy_bgp£c
,

3528 
no_£t_ecommunôy_bgp£c_cmd
,

3530 
NO_STR


3531 
SET_STR


3535  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "extcommunôy bgp£c", 
NULL
);

3539 
DEFUN
 (
£t_‹igö
,

3540 
£t_‹igö_cmd
,

3542 
SET_STR


3548 i‡(
°∫cmp
 (
¨gv
[0], "igp", 2) == 0)

3549  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "origin", "igp");

3550 i‡(
°∫cmp
 (
¨gv
[0], "egp", 1) == 0)

3551  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "origin", "egp");

3552 i‡(
°∫cmp
 (
¨gv
[0], "incomplete", 2) == 0)

3553  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "origin", "incomplete");

3555  
	gCMD_WARNING
;

3558 
DEFUN
 (
no_£t_‹igö
,

3559 
no_£t_‹igö_cmd
,

3561 
NO_STR


3562 
SET_STR


3565  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "‹igö", 
NULL
);

3568 
ALIAS
 (
no_£t_‹igö
,

3569 
no_£t_‹igö_vÆ_cmd
,

3571 
NO_STR


3572 
SET_STR


3578 
DEFUN
 (
£t_©omic_aggªg©e
,

3579 
£t_©omic_aggªg©e_cmd
,

3581 
SET_STR


3584  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "©omic-aggªg©e", 
NULL
);

3587 
DEFUN
 (
no_£t_©omic_aggªg©e
,

3588 
no_£t_©omic_aggªg©e_cmd
,

3590 
NO_STR


3591 
SET_STR


3594  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "©omic-aggªg©e", 
NULL
);

3597 
DEFUN
 (
£t_aggªg©‹_as
,

3598 
£t_aggªg©‹_as_cmd
,

3599 "£àaggªg©‹á†" 
CMD_AS_RANGE
 " A.B.C.D",

3600 
SET_STR


3606 
	gªt
;

3607 
as_t
 
	gas
;

3608 
ö_addr
 
	gaddªss
;

3609 *
	g¨g°r
;

3611 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[0], 1, 
BGP_AS4_MAX
);

3613 
	gªt
 = 
öë_©⁄
 (
¨gv
[1], &
addªss
);

3614 i‡(
	gªt
 == 0)

3616 
vty_out
 (
vty
, "Aggªg©‹ IPáddªs†i†övÆid%s", 
VTY_NEWLINE
);

3617  
	gCMD_WARNING
;

3620 
	g¨g°r
 = 
XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,

3621 
°æí
 (
¨gv
[0]) + strlen (argv[1]) + 2);

3623 
•rötf
 (
¨g°r
, "%†%s", 
¨gv
[0],árgv[1]);

3625 
	gªt
 = 
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "aggªg©‹ás", 
¨g°r
);

3627 
XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g°r
);

3629  
	gªt
;

3632 
DEFUN
 (
no_£t_aggªg©‹_as
,

3633 
no_£t_aggªg©‹_as_cmd
,

3635 
NO_STR


3636 
SET_STR


3640 
	gªt
;

3641 
as_t
 
	gas
;

3642 
ö_addr
 
	gaddªss
;

3643 *
	g¨g°r
;

3645 i‡(
	g¨gv
 == 0)

3646  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "aggªg©‹ás", 
NULL
);

3648 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[0], 1, 
BGP_AS4_MAX
);

3650 
	gªt
 = 
öë_©⁄
 (
¨gv
[1], &
addªss
);

3651 i‡(
	gªt
 == 0)

3653 
vty_out
 (
vty
, "Aggªg©‹ IPáddªs†i†övÆid%s", 
VTY_NEWLINE
);

3654  
	gCMD_WARNING
;

3657 
	g¨g°r
 = 
XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,

3658 
°æí
 (
¨gv
[0]) + strlen (argv[1]) + 2);

3660 
•rötf
 (
¨g°r
, "%†%s", 
¨gv
[0],árgv[1]);

3662 
	gªt
 = 
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "aggªg©‹ás", 
¨g°r
);

3664 
XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g°r
);

3666  
	gªt
;

3669 
ALIAS
 (
no_£t_aggªg©‹_as
,

3670 
no_£t_aggªg©‹_as_vÆ_cmd
,

3671 "nÿ£àaggªg©‹á†" 
CMD_AS_RANGE
 " A.B.C.D",

3672 
NO_STR


3673 
SET_STR


3680 #ifde‡
HAVE_IPV6


3681 
DEFUN
 (
m©ch_ùv6_addªss
,

3682 
m©ch_ùv6_addªss_cmd
,

3684 
MATCH_STR


3685 
IPV6_STR


3689  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùv6áddªss", 
¨gv
[0]);

3692 
DEFUN
 (
no_m©ch_ùv6_addªss
,

3693 
no_m©ch_ùv6_addªss_cmd
,

3695 
NO_STR


3696 
MATCH_STR


3697 
IPV6_STR


3701  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùv6áddªss", 
¨gv
[0]);

3704 
DEFUN
 (
m©ch_ùv6_√xt_h›
,

3705 
m©ch_ùv6_√xt_h›_cmd
,

3707 
MATCH_STR


3708 
IPV6_STR


3712  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùv6Çext-h›", 
¨gv
[0]);

3715 
DEFUN
 (
no_m©ch_ùv6_√xt_h›
,

3716 
no_m©ch_ùv6_√xt_h›_cmd
,

3718 
NO_STR


3719 
MATCH_STR


3720 
IPV6_STR


3724  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùv6Çext-h›", 
¨gv
[0]);

3727 
DEFUN
 (
m©ch_ùv6_addªss_¥efix_li°
,

3728 
m©ch_ùv6_addªss_¥efix_li°_cmd
,

3730 
MATCH_STR


3731 
IPV6_STR


3736  
bgp_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùv6áddªs†¥efix-li°", 
¨gv
[0]);

3739 
DEFUN
 (
no_m©ch_ùv6_addªss_¥efix_li°
,

3740 
no_m©ch_ùv6_addªss_¥efix_li°_cmd
,

3742 
NO_STR


3743 
MATCH_STR


3744 
IPV6_STR


3749  
bgp_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùv6áddªs†¥efix-li°", 
¨gv
[0]);

3752 
DEFUN
 (
£t_ùv6_√xth›_globÆ
,

3753 
£t_ùv6_√xth›_globÆ_cmd
,

3755 
SET_STR


3756 
IPV6_STR


3761  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "ùv6Çext-h› globÆ", 
¨gv
[0]);

3764 
DEFUN
 (
no_£t_ùv6_√xth›_globÆ
,

3765 
no_£t_ùv6_√xth›_globÆ_cmd
,

3767 
NO_STR


3768 
SET_STR


3769 
IPV6_STR


3773 i‡(
	g¨gc
 == 0)

3774  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "ùv6Çext-h› globÆ", 
NULL
);

3776  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "ùv6Çext-h› globÆ", 
¨gv
[0]);

3779 
ALIAS
 (
no_£t_ùv6_√xth›_globÆ
,

3780 
no_£t_ùv6_√xth›_globÆ_vÆ_cmd
,

3782 
NO_STR


3783 
SET_STR


3784 
IPV6_STR


3789 
DEFUN
 (
£t_ùv6_√xth›_loˇl
,

3790 
£t_ùv6_√xth›_loˇl_cmd
,

3792 
SET_STR


3793 
IPV6_STR


3798  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "ùv6Çext-h›Üoˇl", 
¨gv
[0]);

3801 
DEFUN
 (
no_£t_ùv6_√xth›_loˇl
,

3802 
no_£t_ùv6_√xth›_loˇl_cmd
,

3804 
NO_STR


3805 
SET_STR


3806 
IPV6_STR


3810 i‡(
	g¨gc
 == 0)

3811  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "ùv6Çext-h›Üoˇl", 
NULL
);

3813  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "ùv6Çext-h›Üoˇl", 
¨gv
[0]);

3816 
ALIAS
 (
no_£t_ùv6_√xth›_loˇl
,

3817 
no_£t_ùv6_√xth›_loˇl_vÆ_cmd
,

3819 
NO_STR


3820 
SET_STR


3821 
IPV6_STR


3827 
DEFUN
 (
£t_v≤v4_√xth›
,

3828 
£t_v≤v4_√xth›_cmd
,

3830 
SET_STR


3835  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "v≤v4Çext-h›", 
¨gv
[0]);

3838 
DEFUN
 (
no_£t_v≤v4_√xth›
,

3839 
no_£t_v≤v4_√xth›_cmd
,

3841 
NO_STR


3842 
SET_STR


3846 i‡(
	g¨gc
 == 0)

3847  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "v≤v4Çext-h›", 
NULL
);

3849  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "v≤v4Çext-h›", 
¨gv
[0]);

3852 
ALIAS
 (
no_£t_v≤v4_√xth›
,

3853 
no_£t_v≤v4_√xth›_vÆ_cmd
,

3855 
NO_STR


3856 
SET_STR


3861 
DEFUN
 (
£t_‹igö©‹_id
,

3862 
£t_‹igö©‹_id_cmd
,

3864 
SET_STR


3868  
bgp_rouã_£t_add
 (
vty
, vty->
ödex
, "‹igö©‹-id", 
¨gv
[0]);

3871 
DEFUN
 (
no_£t_‹igö©‹_id
,

3872 
no_£t_‹igö©‹_id_cmd
,

3874 
NO_STR


3875 
SET_STR


3878 i‡(
	g¨gc
 == 0)

3879  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "‹igö©‹-id", 
NULL
);

3881  
bgp_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "‹igö©‹-id", 
¨gv
[0]);

3884 
ALIAS
 (
no_£t_‹igö©‹_id
,

3885 
no_£t_‹igö©‹_id_vÆ_cmd
,

3887 
NO_STR


3888 
SET_STR


3892 
DEFUN_DEPRECATED
 (
£t_∑thlimô_âl
,

3893 
£t_∑thlimô_âl_cmd
,

3895 
SET_STR


3899  
	gCMD_SUCCESS
;

3902 
DEFUN_DEPRECATED
 (
no_£t_∑thlimô_âl
,

3903 
no_£t_∑thlimô_âl_cmd
,

3905 
NO_STR


3906 
SET_STR


3910  
	gCMD_SUCCESS
;

3913 
ALIAS
 (
no_£t_∑thlimô_âl
,

3914 
no_£t_∑thlimô_âl_vÆ_cmd
,

3916 
NO_STR


3917 
MATCH_STR


3921 
DEFUN_DEPRECATED
 (
m©ch_∑thlimô_as
,

3922 
m©ch_∑thlimô_as_cmd
,

3924 
MATCH_STR


3928  
	gCMD_SUCCESS
;

3931 
DEFUN_DEPRECATED
 (
no_m©ch_∑thlimô_as
,

3932 
no_m©ch_∑thlimô_as_cmd
,

3934 
NO_STR


3935 
MATCH_STR


3939  
	gCMD_SUCCESS
;

3942 
ALIAS
 (
no_m©ch_∑thlimô_as
,

3943 
no_m©ch_∑thlimô_as_vÆ_cmd
,

3945 
NO_STR


3946 
MATCH_STR


3953 
	$bgp_rouã_m≠_öô
 ()

3955 
	`rouã_m≠_öô
 ();

3956 
	`rouã_m≠_öô_vty
 ();

3957 
	`rouã_m≠_add_hook
 (
bgp_rouã_m≠_upd©e
);

3958 
	`rouã_m≠_dñëe_hook
 (
bgp_rouã_m≠_upd©e
);

3960 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_≥î_cmd
);

3961 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_addªss_cmd
);

3962 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_√xt_h›_cmd
);

3963 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_rouã_sour˚_cmd
);

3964 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_addªss_¥efix_li°_cmd
);

3965 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_√xt_h›_¥efix_li°_cmd
);

3966 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_rouã_sour˚_¥efix_li°_cmd
);

3967 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_a•©h_cmd
);

3968 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_communôy_cmd
);

3969 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ecommunôy_cmd
);

3970 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_mëric_cmd
);

3971 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_‹igö_cmd
);

3972 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_¥obabûôy_cmd
);

3974 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_ù_√xth›_cmd
);

3975 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_loˇl_¥ef_cmd
);

3976 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_weight_cmd
);

3977 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_mëric_cmd
);

3978 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_a•©h_¥ïíd_cmd
);

3979 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_a•©h_ex˛ude_cmd
);

3980 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_‹igö_cmd
);

3981 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_©omic_aggªg©e_cmd
);

3982 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_aggªg©‹_as_cmd
);

3983 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_communôy_cmd
);

3984 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_communôy_dñëe_cmd
);

3985 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_v≤v4_√xth›_cmd
);

3986 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_‹igö©‹_id_cmd
);

3987 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_ecommunôy_π_cmd
);

3988 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_ecommunôy_soo_cmd
);

3989 #ifde‡
USE_SRX


3990 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_ecommunôy_bgp£c_cmd
);

3993 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_≥î_cmd
);

3994 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_≥î_loˇl_cmd
);

3995 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_≥î_cmd
);

3996 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_≥î_vÆ_cmd
);

3997 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_≥î_loˇl_cmd
);

3998 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_addªss_cmd
);

3999 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_cmd
);

4000 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_vÆ_cmd
);

4001 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_√xt_h›_cmd
);

4002 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_cmd
);

4003 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_vÆ_cmd
);

4004 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_rouã_sour˚_cmd
);

4005 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_rouã_sour˚_cmd
);

4006 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_rouã_sour˚_vÆ_cmd
);

4007 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_addªss_¥efix_li°_cmd
);

4008 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_¥efix_li°_cmd
);

4009 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_¥efix_li°_vÆ_cmd
);

4010 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_√xt_h›_¥efix_li°_cmd
);

4011 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_¥efix_li°_cmd
);

4012 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_¥efix_li°_vÆ_cmd
);

4013 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_rouã_sour˚_¥efix_li°_cmd
);

4014 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_rouã_sour˚_¥efix_li°_cmd
);

4015 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_rouã_sour˚_¥efix_li°_vÆ_cmd
);

4017 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_a•©h_cmd
);

4018 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_a•©h_cmd
);

4019 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_a•©h_vÆ_cmd
);

4020 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_mëric_cmd
);

4021 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_mëric_cmd
);

4022 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_mëric_vÆ_cmd
);

4023 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_communôy_cmd
);

4024 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_communôy_exa˘_cmd
);

4025 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_communôy_cmd
);

4026 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_communôy_vÆ_cmd
);

4027 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_communôy_exa˘_cmd
);

4028 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ecommunôy_cmd
);

4029 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ecommunôy_cmd
);

4030 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ecommunôy_vÆ_cmd
);

4031 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_‹igö_cmd
);

4032 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_‹igö_cmd
);

4033 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_‹igö_vÆ_cmd
);

4034 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_¥obabûôy_cmd
);

4035 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_¥obabûôy_cmd
);

4036 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_¥obabûôy_vÆ_cmd
);

4038 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_ù_√xth›_cmd
);

4039 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_ù_√xth›_≥î_cmd
);

4040 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ù_√xth›_cmd
);

4041 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ù_√xth›_vÆ_cmd
);

4042 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_loˇl_¥ef_cmd
);

4043 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_loˇl_¥ef_cmd
);

4044 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_loˇl_¥ef_vÆ_cmd
);

4045 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_weight_cmd
);

4046 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_weight_cmd
);

4047 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_weight_vÆ_cmd
);

4048 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_mëric_cmd
);

4049 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_mëric_addsub_cmd
);

4050 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_mëric_cmd
);

4051 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_mëric_vÆ_cmd
);

4052 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_a•©h_¥ïíd_cmd
);

4053 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_a•©h_ex˛ude_cmd
);

4054 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_a•©h_¥ïíd_cmd
);

4055 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_a•©h_¥ïíd_vÆ_cmd
);

4056 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_a•©h_ex˛ude_cmd
);

4057 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_a•©h_ex˛ude_vÆ_cmd
);

4058 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_‹igö_cmd
);

4059 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_‹igö_cmd
);

4060 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_‹igö_vÆ_cmd
);

4061 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_©omic_aggªg©e_cmd
);

4062 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_©omic_aggªg©e_cmd
);

4063 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_aggªg©‹_as_cmd
);

4064 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_aggªg©‹_as_cmd
);

4065 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_aggªg©‹_as_vÆ_cmd
);

4066 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_communôy_cmd
);

4067 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_communôy_n⁄e_cmd
);

4068 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_communôy_cmd
);

4069 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_communôy_vÆ_cmd
);

4070 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_communôy_n⁄e_cmd
);

4071 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_communôy_dñëe_cmd
);

4072 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_communôy_dñëe_cmd
);

4073 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_communôy_dñëe_vÆ_cmd
);

4074 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_ecommunôy_π_cmd
);

4075 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ecommunôy_π_cmd
);

4076 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ecommunôy_π_vÆ_cmd
);

4077 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_ecommunôy_soo_cmd
);

4078 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ecommunôy_soo_cmd
);

4079 #ifde‡
USE_SRX


4080 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_ecommunôy_bgp£c_cmd
);

4081 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ecommunôy_bgp£c_cmd
);

4083 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ecommunôy_soo_vÆ_cmd
);

4084 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_v≤v4_√xth›_cmd
);

4085 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_v≤v4_√xth›_cmd
);

4086 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_v≤v4_√xth›_vÆ_cmd
);

4087 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_‹igö©‹_id_cmd
);

4088 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_‹igö©‹_id_cmd
);

4089 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_‹igö©‹_id_vÆ_cmd
);

4091 #ifde‡
HAVE_IPV6


4092 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ùv6_addªss_cmd
);

4093 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ùv6_√xt_h›_cmd
);

4094 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ùv6_addªss_¥efix_li°_cmd
);

4095 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_ùv6_√xth›_globÆ_cmd
);

4096 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_ùv6_√xth›_loˇl_cmd
);

4098 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ùv6_addªss_cmd
);

4099 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ùv6_addªss_cmd
);

4100 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ùv6_√xt_h›_cmd
);

4101 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ùv6_√xt_h›_cmd
);

4102 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ùv6_addªss_¥efix_li°_cmd
);

4103 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ùv6_addªss_¥efix_li°_cmd
);

4104 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_ùv6_√xth›_globÆ_cmd
);

4105 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ùv6_√xth›_globÆ_cmd
);

4106 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ùv6_√xth›_globÆ_vÆ_cmd
);

4107 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_ùv6_√xth›_loˇl_cmd
);

4108 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ùv6_√xth›_loˇl_cmd
);

4109 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_ùv6_√xth›_loˇl_vÆ_cmd
);

4115 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_∑thlimô_âl_cmd
);

4116 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_∑thlimô_âl_cmd
);

4117 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_∑thlimô_âl_vÆ_cmd
);

4118 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_∑thlimô_as_cmd
);

4119 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_∑thlimô_as_cmd
);

4120 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_∑thlimô_as_vÆ_cmd
);

4121 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_snmp.c

21 
	~<zebø.h
>

23 #ifde‡
HAVE_SNMP


24 
	~<√t-¢mp/√t-¢mp-c⁄fig.h
>

25 
	~<√t-¢mp/√t-¢mp-ö˛udes.h
>

27 
	~"if.h
"

28 
	~"log.h
"

29 
	~"¥efix.h
"

30 
	~"comm™d.h
"

31 
	~"thªad.h
"

32 
	~"smux.h
"

34 
	~"bgpd/bgpd.h
"

35 
	~"bgpd/bgp_èbÀ.h
"

36 
	~"bgpd/bgp_a•©h.h
"

37 
	~"bgpd/bgp_©å.h
"

38 
	~"bgpd/bgp_rouã.h
"

39 
	~"bgpd/bgp_fsm.h
"

40 
	~"bgpd/bgp_¢mp.h
"

43 
	#BGP4MIB
 1,3,6,1,2,1,15

	)

46 
	#BGPESTABLISHED
 1

	)

47 
	#BGPBACKWARDTRANSITION
 2

	)

50 
	#BGPVERSION
 0

	)

53 
	#BGPLOCALAS
 0

	)

56 
	#BGPPEERIDENTIFIER
 1

	)

57 
	#BGPPEERSTATE
 2

	)

58 
	#BGPPEERADMINSTATUS
 3

	)

59 
	#BGPPEERNEGOTIATEDVERSION
 4

	)

60 
	#BGPPEERLOCALADDR
 5

	)

61 
	#BGPPEERLOCALPORT
 6

	)

62 
	#BGPPEERREMOTEADDR
 7

	)

63 
	#BGPPEERREMOTEPORT
 8

	)

64 
	#BGPPEERREMOTEAS
 9

	)

65 
	#BGPPEERINUPDATES
 10

	)

66 
	#BGPPEEROUTUPDATES
 11

	)

67 
	#BGPPEERINTOTALMESSAGES
 12

	)

68 
	#BGPPEEROUTTOTALMESSAGES
 13

	)

69 
	#BGPPEERLASTERROR
 14

	)

70 
	#BGPPEERFSMESTABLISHEDTRANSITIONS
 15

	)

71 
	#BGPPEERFSMESTABLISHEDTIME
 16

	)

72 
	#BGPPEERCONNECTRETRYINTERVAL
 17

	)

73 
	#BGPPEERHOLDTIME
 18

	)

74 
	#BGPPEERKEEPALIVE
 19

	)

75 
	#BGPPEERHOLDTIMECONFIGURED
 20

	)

76 
	#BGPPEERKEEPALIVECONFIGURED
 21

	)

77 
	#BGPPEERMINASORIGINATIONINTERVAL
 22

	)

78 
	#BGPPEERMINROUTEADVERTISEMENTINTERVAL
 23

	)

79 
	#BGPPEERINUPDATEELAPSEDTIME
 24

	)

82 
	#BGPIDENTIFIER
 0

	)

85 
	#BGPPATHATTRPEER
 1

	)

86 
	#BGPPATHATTRDESTNETWORK
 2

	)

87 
	#BGPPATHATTRORIGIN
 3

	)

88 
	#BGPPATHATTRASPATH
 4

	)

89 
	#BGPPATHATTRNEXTHOP
 5

	)

90 
	#BGPPATHATTRINTERASMETRIC
 6

	)

93 
	#BGP4PATHATTRPEER
 1

	)

94 
	#BGP4PATHATTRIPADDRPREFIXLEN
 2

	)

95 
	#BGP4PATHATTRIPADDRPREFIX
 3

	)

96 
	#BGP4PATHATTRORIGIN
 4

	)

97 
	#BGP4PATHATTRASPATHSEGMENT
 5

	)

98 
	#BGP4PATHATTRNEXTHOP
 6

	)

99 
	#BGP4PATHATTRMULTIEXITDISC
 7

	)

100 
	#BGP4PATHATTRLOCALPREF
 8

	)

101 
	#BGP4PATHATTRATOMICAGGREGATE
 9

	)

102 
	#BGP4PATHATTRAGGREGATORAS
 10

	)

103 
	#BGP4PATHATTRAGGREGATORADDR
 11

	)

104 
	#BGP4PATHATTRCALCLOCALPREF
 12

	)

105 
	#BGP4PATHATTRBEST
 13

	)

106 
	#BGP4PATHATTRUNKNOWN
 14

	)

109 
	#INTEGER
 
ASN_INTEGER


	)

110 
	#INTEGER32
 
ASN_INTEGER


	)

111 
	#COUNTER32
 
ASN_COUNTER


	)

112 
	#OCTET_STRING
 
ASN_OCTET_STR


	)

113 
	#IPADDRESS
 
ASN_IPADDRESS


	)

114 
	#GAUGE32
 
ASN_UNSIGNED


	)

117 
SNMP_LOCAL_VARIABLES


120 
oid
 
	gbgp_oid
 [] = { 
BGP4MIB
 };

121 
oid
 
	gbgp_å≠_oid
 [] = { 
BGP4MIB
, 0 };

124 
ö_addr
 
	gbgp_em±y_addr
 = {0};

127 
u_ch¨
 *
bgpVîsi⁄
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *, ,

128 
size_t
 *, 
WrôeMëhod
 **);

129 
u_ch¨
 *
bgpLoˇlAs
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

130 , 
size_t
 *, 
WrôeMëhod
 **);

131 
u_ch¨
 *
bgpPìrTabÀ
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

132 , 
size_t
 *, 
WrôeMëhod
 **);

133 
u_ch¨
 *
bgpRcvdP©hAârTabÀ
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

134 , 
size_t
 *, 
WrôeMëhod
 **);

135 
u_ch¨
 *
bgpIdítifõr
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

136 , 
size_t
 *, 
WrôeMëhod
 **);

137 
u_ch¨
 *
bgp4P©hAârTabÀ
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

138 , 
size_t
 *, 
WrôeMëhod
 **);

141 
v¨übÀ
 
	gbgp_v¨übÀs
[] =

144 {
BGPVERSION
, 
OCTET_STRING
, 
RONLY
, 
bgpVîsi⁄
,

147 {
BGPLOCALAS
, 
INTEGER
, 
RONLY
, 
bgpLoˇlAs
,

150 {
BGPPEERIDENTIFIER
, 
IPADDRESS
, 
RONLY
, 
bgpPìrTabÀ
,

152 {
BGPPEERSTATE
, 
INTEGER
, 
RONLY
, 
bgpPìrTabÀ
,

154 {
BGPPEERADMINSTATUS
, 
INTEGER
, 
RWRITE
, 
bgpPìrTabÀ
,

156 {
BGPPEERNEGOTIATEDVERSION
, 
INTEGER32
, 
RONLY
, 
bgpPìrTabÀ
,

158 {
BGPPEERLOCALADDR
, 
IPADDRESS
, 
RONLY
, 
bgpPìrTabÀ
,

160 {
BGPPEERLOCALPORT
, 
INTEGER
, 
RONLY
, 
bgpPìrTabÀ
,

162 {
BGPPEERREMOTEADDR
, 
IPADDRESS
, 
RONLY
, 
bgpPìrTabÀ
,

164 {
BGPPEERREMOTEPORT
, 
INTEGER
, 
RONLY
, 
bgpPìrTabÀ
,

166 {
BGPPEERREMOTEAS
, 
INTEGER
, 
RONLY
, 
bgpPìrTabÀ
,

168 {
BGPPEERINUPDATES
, 
COUNTER32
, 
RONLY
, 
bgpPìrTabÀ
,

170 {
BGPPEEROUTUPDATES
, 
COUNTER32
, 
RONLY
, 
bgpPìrTabÀ
,

172 {
BGPPEERINTOTALMESSAGES
, 
COUNTER32
, 
RONLY
, 
bgpPìrTabÀ
,

174 {
BGPPEEROUTTOTALMESSAGES
, 
COUNTER32
, 
RONLY
, 
bgpPìrTabÀ
,

176 {
BGPPEERLASTERROR
, 
OCTET_STRING
, 
RONLY
, 
bgpPìrTabÀ
,

178 {
BGPPEERFSMESTABLISHEDTRANSITIONS
, 
COUNTER32
, 
RONLY
, 
bgpPìrTabÀ
,

180 {
BGPPEERFSMESTABLISHEDTIME
, 
GAUGE32
, 
RONLY
, 
bgpPìrTabÀ
,

182 {
BGPPEERCONNECTRETRYINTERVAL
, 
INTEGER
, 
RWRITE
, 
bgpPìrTabÀ
,

184 {
BGPPEERHOLDTIME
, 
INTEGER
, 
RONLY
, 
bgpPìrTabÀ
,

186 {
BGPPEERKEEPALIVE
, 
INTEGER
, 
RONLY
, 
bgpPìrTabÀ
,

188 {
BGPPEERHOLDTIMECONFIGURED
, 
INTEGER
, 
RWRITE
, 
bgpPìrTabÀ
,

190 {
BGPPEERKEEPALIVECONFIGURED
, 
INTEGER
, 
RWRITE
, 
bgpPìrTabÀ
,

192 {
BGPPEERMINASORIGINATIONINTERVAL
, 
INTEGER
, 
RWRITE
, 
bgpPìrTabÀ
,

194 {
BGPPEERMINROUTEADVERTISEMENTINTERVAL
, 
INTEGER
, 
RWRITE
, 
bgpPìrTabÀ
,

196 {
BGPPEERINUPDATEELAPSEDTIME
, 
GAUGE32
, 
RONLY
, 
bgpPìrTabÀ
,

199 {
BGPIDENTIFIER
, 
IPADDRESS
, 
RONLY
, 
bgpIdítifõr
,

202 {
BGPPATHATTRPEER
, 
IPADDRESS
, 
RONLY
, 
bgpRcvdP©hAârTabÀ
,

204 {
BGPPATHATTRDESTNETWORK
, 
IPADDRESS
, 
RONLY
, 
bgpRcvdP©hAârTabÀ
,

206 {
BGPPATHATTRORIGIN
, 
INTEGER
, 
RONLY
, 
bgpRcvdP©hAârTabÀ
,

208 {
BGPPATHATTRASPATH
, 
OCTET_STRING
, 
RONLY
, 
bgpRcvdP©hAârTabÀ
,

210 {
BGPPATHATTRNEXTHOP
, 
IPADDRESS
, 
RONLY
, 
bgpRcvdP©hAârTabÀ
,

212 {
BGPPATHATTRINTERASMETRIC
, 
INTEGER32
, 
RONLY
, 
bgpRcvdP©hAârTabÀ
,

215 {
BGP4PATHATTRPEER
, 
IPADDRESS
, 
RONLY
, 
bgp4P©hAârTabÀ
,

217 {
BGP4PATHATTRIPADDRPREFIXLEN
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

219 {
BGP4PATHATTRIPADDRPREFIX
, 
IPADDRESS
, 
RONLY
, 
bgp4P©hAârTabÀ
,

221 {
BGP4PATHATTRORIGIN
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

223 {
BGP4PATHATTRASPATHSEGMENT
, 
OCTET_STRING
, 
RONLY
, 
bgp4P©hAârTabÀ
,

225 {
BGP4PATHATTRNEXTHOP
, 
IPADDRESS
, 
RONLY
, 
bgp4P©hAârTabÀ
,

227 {
BGP4PATHATTRMULTIEXITDISC
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

229 {
BGP4PATHATTRLOCALPREF
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

231 {
BGP4PATHATTRATOMICAGGREGATE
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

233 {
BGP4PATHATTRAGGREGATORAS
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

235 {
BGP4PATHATTRAGGREGATORADDR
, 
IPADDRESS
, 
RONLY
, 
bgp4P©hAârTabÀ
,

237 {
BGP4PATHATTRCALCLOCALPREF
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

239 {
BGP4PATHATTRBEST
, 
INTEGER
, 
RONLY
, 
bgp4P©hAârTabÀ
,

241 {
BGP4PATHATTRUNKNOWN
, 
OCTET_STRING
, 
RONLY
, 
bgp4P©hAârTabÀ
,

246 
u_ch¨
 *

247 
	$bgpVîsi⁄
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
, 
exa˘
,

248 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

250 
u_ch¨
 
vîsi⁄
;

252 i‡(
	`smux_hódî_gíîic
(
v
, 
«me
, 
Àngth
, 
exa˘
, 
v¨_Àn
, 
wrôe_mëhod
)

253 =
MATCH_FAILED
)

254  
NULL
;

257 
vîsi⁄
 = (0x80 >> (
BGP_VERSION_4
 - 1));

260 *
v¨_Àn
 = 1;

261  (
u_ch¨
 *)&
vîsi⁄
;

262 
	}
}

264 
u_ch¨
 *

265 
	$bgpLoˇlAs
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
,

266 
exa˘
, 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

268 
bgp
 *bgp;

270 i‡(
	`smux_hódî_gíîic
(
v
, 
«me
, 
Àngth
, 
exa˘
, 
v¨_Àn
, 
wrôe_mëhod
)

271 =
MATCH_FAILED
)

272  
NULL
;

275 
bgp
 = 
	`bgp_gë_deÁu…
 ();

276 i‡(! 
bgp
)

277  
NULL
;

279  
	`SNMP_INTEGER
 (
bgp
->
as
);

280 
	}
}

282 
≥î
 *

283 
	$≥î_lookup_addr_ùv4
 (
ö_addr
 *
§c
)

285 
bgp
 *bgp;

286 
≥î
 *peer;

287 
li°node
 *
node
;

288 
ö_addr
 
addr
;

289 
ªt
;

291 
bgp
 = 
	`bgp_gë_deÁu…
 ();

292 i‡(! 
bgp
)

293  
NULL
;

295 
	`ALL_LIST_ELEMENTS_RO
 (
bgp
->
≥î
, 
node
,Öeer))

297 
ªt
 = 
	`öë_±⁄
 (
AF_INET
, 
≥î
->
ho°
, &
addr
);

298 i‡(
ªt
 > 0)

300 i‡(
	`IPV4_ADDR_SAME
 (&
addr
, 
§c
))

301  
≥î
;

304  
NULL
;

305 
	}
}

307 
≥î
 *

308 
	$bgp_≥î_lookup_√xt
 (
ö_addr
 *
§c
)

310 
bgp
 *bgp;

311 
≥î
 *peer;

312 
li°node
 *
node
;

313 
ö_addr
 *
p
;

314 
sockuni⁄
 
su
;

315 
ªt
;

317 
	`mem£t
 (&
su
, 0,  (
sockuni⁄
));

319 
bgp
 = 
	`bgp_gë_deÁu…
 ();

320 i‡(! 
bgp
)

321  
NULL
;

323 
	`ALL_LIST_ELEMENTS_RO
 (
bgp
->
≥î
, 
node
,Öeer))

325 
ªt
 = 
	`öë_±⁄
 (
AF_INET
, 
≥î
->
ho°
, &
su
.
sö
.
sö_addr
);

326 i‡(
ªt
 > 0)

328 
p
 = &
su
.
sö
.
sö_addr
;

330 i‡(
	`¡ohl
 (
p
->
s_addr
Ë>Çtoh»(
§c
->s_addr))

332 
§c
->
s_addr
 = 
p
->s_addr;

333  
≥î
;

337  
NULL
;

338 
	}
}

340 
≥î
 *

341 
	$bgpPìrTabÀ_lookup
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
,

342 
ö_addr
 *
addr
, 
exa˘
)

344 
≥î
 *≥î = 
NULL
;

345 
Àn
;

347 i‡(
exa˘
)

350 i‡(*
Àngth
 - 
v
->
«mñí
 ! (
ö_addr
))

351  
NULL
;

353 
	`oid2ö_addr
 (
«me
 + 
v
->
«mñí
, 
IN_ADDR_SIZE
, 
addr
);

355 
≥î
 = 
	`≥î_lookup_addr_ùv4
 (
addr
);

356  
≥î
;

360 
Àn
 = *
Àngth
 - 
v
->
«mñí
;

361 i‡(
Àn
 > 4)Üen = 4;

363 
	`oid2ö_addr
 (
«me
 + 
v
->
«mñí
, 
Àn
, 
addr
);

365 
≥î
 = 
	`bgp_≥î_lookup_√xt
 (
addr
);

367 i‡(
≥î
 =
NULL
)

368  
NULL
;

370 
	`oid_c›y_addr
 (
«me
 + 
v
->
«mñí
, 
addr
,  (
ö_addr
));

371 *
Àngth
 =  (
ö_addr
Ë+ 
v
->
«mñí
;

373  
≥î
;

375  
NULL
;

376 
	}
}

380 
	$wrôe_bgpPìrTabÀ
 (
a˘i⁄
, 
u_ch¨
 *
v¨_vÆ
,

381 
u_ch¨
 
v¨_vÆ_ty≥
, 
size_t
 
v¨_vÆ_Àn
,

382 
u_ch¨
 *
°©P
, 
oid
 *
«me
, 
size_t
 
Àngth
,

383 
v¨übÀ
 *
v
)

385 
ö_addr
 
addr
;

386 
≥î
 *peer;

387 
ötvÆ
;

388 
size_t
 
bigsize
 = 
SNMP_MAX_LEN
;

390 i‡(
v¨_vÆ_ty≥
 !
ASN_INTEGER
)

392  
SNMP_ERR_WRONGTYPE
;

394 i‡(
v¨_vÆ_Àn
 !=  ())

396  
SNMP_ERR_WRONGLENGTH
;

399 i‡(! 
	`a¢_∑r£_öt
(
v¨_vÆ
, &
bigsize
, &
v¨_vÆ_ty≥
,

400 &
ötvÆ
, ()))

402  
SNMP_ERR_WRONGENCODING
;

405 
	`mem£t
 (&
addr
, 0,  (
ö_addr
));

407 
≥î
 = 
	`bgpPìrTabÀ_lookup
 (
v
, 
«me
, &
Àngth
, &
addr
, 1);

408 i‡(! 
≥î
)

409  
SNMP_ERR_NOSUCHNAME
;

411 
	`¥ötf
 ("vÆ: %ld\n", 
ötvÆ
);

413 
v
->
magic
)

415 
BGPPEERADMINSTATUS
:

416 
	#BGP_PìrAdmö_°›
 1

	)

417 
	#BGP_PìrAdmö_°¨t
 2

	)

419 i‡(
ötvÆ
 =
BGP_PìrAdmö_°›
)

420 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

421 i‡(
ötvÆ
 =
BGP_PìrAdmö_°¨t
)

424  
SNMP_ERR_NOSUCHNAME
;

426 
BGPPEERCONNECTRETRYINTERVAL
:

427 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_CONNECT
);

428 
≥î
->
c⁄√˘
 = 
ötvÆ
;

429 
≥î
->
v_c⁄√˘
 = 
ötvÆ
;

431 
BGPPEERHOLDTIMECONFIGURED
:

432 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
);

433 
≥î
->
hﬁdtime
 = 
ötvÆ
;

434 
≥î
->
v_hﬁdtime
 = 
ötvÆ
;

436 
BGPPEERKEEPALIVECONFIGURED
:

437 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
);

438 
≥î
->
kì∑live
 = 
ötvÆ
;

439 
≥î
->
v_kì∑live
 = 
ötvÆ
;

441 
BGPPEERMINASORIGINATIONINTERVAL
:

442 
≥î
->
v_as‹ig
 = 
ötvÆ
;

444 
BGPPEERMINROUTEADVERTISEMENTINTERVAL
:

445 
≥î
->
v_rouãadv
 = 
ötvÆ
;

448  
SNMP_ERR_NOERROR
;

449 
	}
}

451 
u_ch¨
 *

452 
	$bgpPìrTabÀ
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
,

453 
exa˘
, 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

455 
ö_addr
 
addr
;

456 
≥î
 *peer;

458 i‡(
	`smux_hódî_èbÀ
(
v
, 
«me
, 
Àngth
, 
exa˘
, 
v¨_Àn
, 
wrôe_mëhod
)

459 =
MATCH_FAILED
)

460  
NULL
;

461 
	`mem£t
 (&
addr
, 0,  (
ö_addr
));

463 
≥î
 = 
	`bgpPìrTabÀ_lookup
 (
v
, 
«me
, 
Àngth
, &
addr
, 
exa˘
);

464 i‡(! 
≥î
)

465  
NULL
;

467 
v
->
magic
)

469 
BGPPEERIDENTIFIER
:

470  
	`SNMP_IPADDRESS
 (
≥î
->
ªmŸe_id
);

472 
BGPPEERSTATE
:

473  
	`SNMP_INTEGER
 (
≥î
->
°©us
);

475 
BGPPEERADMINSTATUS
:

476 *
wrôe_mëhod
 = 
wrôe_bgpPìrTabÀ
;

477 
	#BGP_PìrAdmö_°›
 1

	)

478 
	#BGP_PìrAdmö_°¨t
 2

	)

479 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_SHUTDOWN
))

480  
	`SNMP_INTEGER
 (
BGP_PìrAdmö_°›
);

482  
	`SNMP_INTEGER
 (
BGP_PìrAdmö_°¨t
);

484 
BGPPEERNEGOTIATEDVERSION
:

485  
	`SNMP_INTEGER
 (
BGP_VERSION_4
);

487 
BGPPEERLOCALADDR
:

488 i‡(
≥î
->
su_loˇl
)

489  
	`SNMP_IPADDRESS
 (
≥î
->
su_loˇl
->
sö
.
sö_addr
);

491  
	`SNMP_IPADDRESS
 (
bgp_em±y_addr
);

493 
BGPPEERLOCALPORT
:

494 i‡(
≥î
->
su_loˇl
)

495  
	`SNMP_INTEGER
 (
	`¡ohs
 (
≥î
->
su_loˇl
->
sö
.
sö_p‹t
));

497  
	`SNMP_INTEGER
 (0);

499 
BGPPEERREMOTEADDR
:

500 i‡(
≥î
->
su_ªmŸe
)

501  
	`SNMP_IPADDRESS
 (
≥î
->
su_ªmŸe
->
sö
.
sö_addr
);

503  
	`SNMP_IPADDRESS
 (
bgp_em±y_addr
);

505 
BGPPEERREMOTEPORT
:

506 i‡(
≥î
->
su_ªmŸe
)

507  
	`SNMP_INTEGER
 (
	`¡ohs
 (
≥î
->
su_ªmŸe
->
sö
.
sö_p‹t
));

509  
	`SNMP_INTEGER
 (0);

511 
BGPPEERREMOTEAS
:

512  
	`SNMP_INTEGER
 (
≥î
->
as
);

514 
BGPPEERINUPDATES
:

515  
	`SNMP_INTEGER
 (
≥î
->
upd©e_ö
);

517 
BGPPEEROUTUPDATES
:

518  
	`SNMP_INTEGER
 (
≥î
->
upd©e_out
);

520 
BGPPEERINTOTALMESSAGES
:

521  
	`SNMP_INTEGER
 (
≥î
->
›í_ö
 +Öìr->
upd©e_ö


522 + 
≥î
->
kì∑live_ö
 +Öìr->
nŸify_ö


523 + 
≥î
->
ª‰esh_ö
 +Öìr->
dy«mic_ˇp_ö
);

525 
BGPPEEROUTTOTALMESSAGES
:

526  
	`SNMP_INTEGER
 (
≥î
->
›í_out
 +Öìr->
upd©e_out


527 + 
≥î
->
kì∑live_out
 +Öìr->
nŸify_out


528 + 
≥î
->
ª‰esh_out
 +Öìr->
dy«mic_ˇp_out
);

530 
BGPPEERLASTERROR
:

532 
u_ch¨
 
œ°îr‹
[2];

533 
œ°îr‹
[0] = 
≥î
->
nŸify
.
code
;

534 
œ°îr‹
[1] = 
≥î
->
nŸify
.
subcode
;

535 *
v¨_Àn
 = 2;

536  (
u_ch¨
 *)&
œ°îr‹
;

539 
BGPPEERFSMESTABLISHEDTRANSITIONS
:

540  
	`SNMP_INTEGER
 (
≥î
->
e°ablished
);

542 
BGPPEERFSMESTABLISHEDTIME
:

543 i‡(
≥î
->
u±ime
 == 0)

544  
	`SNMP_INTEGER
 (0);

546  
	`SNMP_INTEGER
 (
	`bgp_˛ock
 (Ë- 
≥î
->
u±ime
);

548 
BGPPEERCONNECTRETRYINTERVAL
:

549 *
wrôe_mëhod
 = 
wrôe_bgpPìrTabÀ
;

550  
	`SNMP_INTEGER
 (
≥î
->
v_c⁄√˘
);

552 
BGPPEERHOLDTIME
:

553  
	`SNMP_INTEGER
 (
≥î
->
v_hﬁdtime
);

555 
BGPPEERKEEPALIVE
:

556  
	`SNMP_INTEGER
 (
≥î
->
v_kì∑live
);

558 
BGPPEERHOLDTIMECONFIGURED
:

559 *
wrôe_mëhod
 = 
wrôe_bgpPìrTabÀ
;

560 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
))

561  
	`SNMP_INTEGER
 (
≥î
->
hﬁdtime
);

563  
	`SNMP_INTEGER
 (
≥î
->
v_hﬁdtime
);

565 
BGPPEERKEEPALIVECONFIGURED
:

566 *
wrôe_mëhod
 = 
wrôe_bgpPìrTabÀ
;

567 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
))

568  
	`SNMP_INTEGER
 (
≥î
->
kì∑live
);

570  
	`SNMP_INTEGER
 (
≥î
->
v_kì∑live
);

572 
BGPPEERMINASORIGINATIONINTERVAL
:

573 *
wrôe_mëhod
 = 
wrôe_bgpPìrTabÀ
;

574  
	`SNMP_INTEGER
 (
≥î
->
v_as‹ig
);

576 
BGPPEERMINROUTEADVERTISEMENTINTERVAL
:

577 *
wrôe_mëhod
 = 
wrôe_bgpPìrTabÀ
;

578  
	`SNMP_INTEGER
 (
≥î
->
v_rouãadv
);

580 
BGPPEERINUPDATEELAPSEDTIME
:

581 i‡(
≥î
->
upd©e_time
 == 0)

582  
	`SNMP_INTEGER
 (0);

584  
	`SNMP_INTEGER
 (
	`bgp_˛ock
 (Ë- 
≥î
->
upd©e_time
);

587  
NULL
;

590  
NULL
;

591 
	}
}

593 
u_ch¨
 *

594 
	$bgpIdítifõr
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
,

595 
exa˘
, 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

597 
bgp
 *bgp;

599 i‡(
	`smux_hódî_gíîic
(
v
, 
«me
, 
Àngth
, 
exa˘
, 
v¨_Àn
, 
wrôe_mëhod
)

600 =
MATCH_FAILED
)

601  
NULL
;

603 
bgp
 = 
	`bgp_gë_deÁu…
 ();

604 i‡(!
bgp
)

605  
NULL
;

607  
	`SNMP_IPADDRESS
 (
bgp
->
rouãr_id
);

608 
	}
}

610 
u_ch¨
 *

611 
	$bgpRcvdP©hAârTabÀ
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
,

612 
exa˘
, 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

618  
NULL
;

619 
	}
}

621 
bgp_öfo
 *

622 
	$bgp4P©hAârLookup
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
,

623 
bgp
 *bgp, 
¥efix_ùv4
 *
addr
, 
exa˘
)

625 
oid
 *
off£t
;

626 
off£éí
;

627 
bgp_öfo
 *
böfo
;

628 
bgp_öfo
 *
mö
;

629 
bgp_node
 *
∫
;

630 
sockuni⁄
 
su
;

631 
Àn
;

632 
ö_addr
 
∑ddr
;

634 
	#BGP_PATHATTR_ENTRY_OFFSET
 \

635 (
IN_ADDR_SIZE
 + 1 + IN_ADDR_SIZE)

	)

637 i‡(
exa˘
)

639 i‡(*
Àngth
 - 
v
->
«mñí
 !
BGP_PATHATTR_ENTRY_OFFSET
)

640  
NULL
;

643 
off£t
 = 
«me
 + 
v
->
«mñí
;

644 
	`oid2ö_addr
 (
off£t
, 
IN_ADDR_SIZE
, &
addr
->
¥efix
);

645 
off£t
 +
IN_ADDR_SIZE
;

648 
addr
->
¥efixÀn
 = *
off£t
;

649 
off£t
++;

652 
su
.
sö
.
sö_Ámûy
 = 
AF_INET
;

653 
	`oid2ö_addr
 (
off£t
, 
IN_ADDR_SIZE
, &
su
.
sö
.
sö_addr
);

656 
∫
 = 
	`bgp_node_lookup
 (
bgp
->
rib
[
AFI_IP
][
SAFI_UNICAST
],

657 (
¥efix
 *Ë
addr
);

658 i‡(
∫
)

660 
	`bgp_u∆ock_node
 (
∫
);

662 
böfo
 = 
∫
->
öfo
; böfo; böfÿböfo->
√xt
)

663 i‡(
	`sockuni⁄_ßme
 (&
böfo
->
≥î
->
su
, &su))

664  
böfo
;

669 
off£t
 = 
«me
 + 
v
->
«mñí
;

670 
off£éí
 = *
Àngth
 - 
v
->
«mñí
;

671 
Àn
 = 
off£éí
;

673 i‡(
off£éí
 == 0)

674 
∫
 = 
	`bgp_èbÀ_t›
 (
bgp
->
rib
[
AFI_IP
][
SAFI_UNICAST
]);

677 i‡(
Àn
 > 
IN_ADDR_SIZE
)

678 
Àn
 = 
IN_ADDR_SIZE
;

680 
	`oid2ö_addr
 (
off£t
, 
Àn
, &
addr
->
¥efix
);

682 
off£t
 +
IN_ADDR_SIZE
;

683 
off£éí
 -
IN_ADDR_SIZE
;

685 i‡(
off£éí
 > 0)

686 
addr
->
¥efixÀn
 = *
off£t
;

688 
addr
->
¥efixÀn
 = 
Àn
 * 8;

690 
∫
 = 
	`bgp_node_gë
 (
bgp
->
rib
[
AFI_IP
][
SAFI_UNICAST
],

691 (
¥efix
 *Ë
addr
);

693 
off£t
++;

694 
off£éí
--;

697 i‡(
off£éí
 > 0)

699 
Àn
 = 
off£éí
;

700 i‡(
Àn
 > 
IN_ADDR_SIZE
)

701 
Àn
 = 
IN_ADDR_SIZE
;

703 
	`oid2ö_addr
 (
off£t
, 
Àn
, &
∑ddr
);

706 
∑ddr
.
s_addr
 = 0;

708 i‡(! 
∫
)

709  
NULL
;

713 
mö
 = 
NULL
;

715 
böfo
 = 
∫
->
öfo
; böfo; böfÿböfo->
√xt
)

717 i‡(
böfo
->
≥î
->
su
.
sö
.
sö_Ámûy
 =
AF_INET


718 && 
	`¡ohl
 (
∑ddr
.
s_addr
)

719 < 
	`¡ohl
 (
böfo
->
≥î
->
su
.
sö
.
sö_addr
.
s_addr
))

721 i‡(
mö
)

723 i‡(
	`¡ohl
 (
böfo
->
≥î
->
su
.
sö
.
sö_addr
.
s_addr
)

724 < 
	`¡ohl
 (
mö
->
≥î
->
su
.
sö
.
sö_addr
.
s_addr
))

725 
mö
 = 
böfo
;

728 
mö
 = 
böfo
;

732 i‡(
mö
)

734 *
Àngth
 = 
v
->
«mñí
 + 
BGP_PATHATTR_ENTRY_OFFSET
;

736 
off£t
 = 
«me
 + 
v
->
«mñí
;

737 
	`oid_c›y_addr
 (
off£t
, &
∫
->
p
.
u
.
¥efix4
, 
IN_ADDR_SIZE
);

738 
off£t
 +
IN_ADDR_SIZE
;

739 *
off£t
 = 
∫
->
p
.
¥efixÀn
;

740 
off£t
++;

741 
	`oid_c›y_addr
 (
off£t
, &
mö
->
≥î
->
su
.
sö
.
sö_addr
,

742 
IN_ADDR_SIZE
);

743 
addr
->
¥efix
 = 
∫
->
p
.
u
.
¥efix4
;

744 
addr
->
¥efixÀn
 = 
∫
->
p
.prefixlen;

746 
	`bgp_u∆ock_node
 (
∫
);

748  
mö
;

751 
∑ddr
.
s_addr
 = 0;

753 (
∫
 = 
	`bgp_rouã_√xt
 (∫)Ë!
NULL
);

755  
NULL
;

756 
	}
}

758 
u_ch¨
 *

759 
	$bgp4P©hAârTabÀ
 (
v¨übÀ
 *
v
, 
oid
 
«me
[], 
size_t
 *
Àngth
,

760 
exa˘
, 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

762 
bgp
 *bgp;

763 
bgp_öfo
 *
böfo
;

764 
¥efix_ùv4
 
addr
;

766 
bgp
 = 
	`bgp_gë_deÁu…
 ();

767 i‡(! 
bgp
)

768  
NULL
;

770 i‡(
	`smux_hódî_èbÀ
(
v
, 
«me
, 
Àngth
, 
exa˘
, 
v¨_Àn
, 
wrôe_mëhod
)

771 =
MATCH_FAILED
)

772  
NULL
;

773 
	`mem£t
 (&
addr
, 0,  (
¥efix_ùv4
));

775 
böfo
 = 
	`bgp4P©hAârLookup
 (
v
, 
«me
, 
Àngth
, 
bgp
, &
addr
, 
exa˘
);

776 i‡(! 
böfo
)

777  
NULL
;

779 
v
->
magic
)

781 
BGP4PATHATTRPEER
:

782  
	`SNMP_IPADDRESS
 (
böfo
->
≥î
->
su
.
sö
.
sö_addr
);

784 
BGP4PATHATTRIPADDRPREFIXLEN
:

785  
	`SNMP_INTEGER
 (
addr
.
¥efixÀn
);

787 
BGP4PATHATTRIPADDRPREFIX
:

788  
	`SNMP_IPADDRESS
 (
addr
.
¥efix
);

790 
BGP4PATHATTRORIGIN
:

791  
	`SNMP_INTEGER
 (
böfo
->
©å
->
‹igö
);

793 
BGP4PATHATTRASPATHSEGMENT
:

794  
	`a•©h_¢mp_∑th£g
 (
böfo
->
©å
->
a•©h
, 
v¨_Àn
);

796 
BGP4PATHATTRNEXTHOP
:

797  
	`SNMP_IPADDRESS
 (
böfo
->
©å
->
√xth›
);

799 
BGP4PATHATTRMULTIEXITDISC
:

800  
	`SNMP_INTEGER
 (
böfo
->
©å
->
med
);

802 
BGP4PATHATTRLOCALPREF
:

803  
	`SNMP_INTEGER
 (
böfo
->
©å
->
loˇl_¥ef
);

805 
BGP4PATHATTRATOMICAGGREGATE
:

806  
	`SNMP_INTEGER
 (1);

808 
BGP4PATHATTRAGGREGATORAS
:

809 i‡(
böfo
->
©å
->
exåa
)

810  
	`SNMP_INTEGER
 (
böfo
->
©å
->
exåa
->
aggªg©‹_as
);

812  
	`SNMP_INTEGER
 (0);

814 
BGP4PATHATTRAGGREGATORADDR
:

815 i‡(
böfo
->
©å
->
exåa
)

816  
	`SNMP_IPADDRESS
 (
böfo
->
©å
->
exåa
->
aggªg©‹_addr
);

818  
	`SNMP_INTEGER
 (0);

820 
BGP4PATHATTRCALCLOCALPREF
:

821  
	`SNMP_INTEGER
 (-1);

823 
BGP4PATHATTRBEST
:

824 
	#BGP4_P©hAârBe°_Ál£
 1

	)

825 
	#BGP4_P©hAârBe°_åue
 2

	)

826 i‡(
	`CHECK_FLAG
 (
böfo
->
Êags
, 
BGP_INFO_SELECTED
))

827  
	`SNMP_INTEGER
 (
BGP4_P©hAârBe°_åue
);

829  
	`SNMP_INTEGER
 (
BGP4_P©hAârBe°_Ál£
);

831 
BGP4PATHATTRUNKNOWN
:

832 *
v¨_Àn
 = 0;

833  
NULL
;

836  
NULL
;

837 
	}
}

840 
å≠_obje˘
 
	gbgpTøpLi°
[] =

842 {3, {3, 1, 
BGPPEERLASTERROR
}},

843 {3, {3, 1, 
BGPPEERSTATE
}}

847 
	$bgpTøpE°ablished
 (
≥î
 *peer)

849 
ªt
;

850 
ö_addr
 
addr
;

851 
oid
 
ödex
[ (oidË* 
IN_ADDR_SIZE
];

853 
ªt
 = 
	`öë_©⁄
 (
≥î
->
ho°
, &
addr
);

854 i‡(
ªt
 == 0)

857 
	`oid_c›y_addr
 (
ödex
, &
addr
, 
IN_ADDR_SIZE
);

859 
	`smux_å≠
 (
bgp_v¨übÀs
,  bgp_v¨übÀ†/  (
v¨übÀ
),

860 
bgp_å≠_oid
,  bgp_å≠_oid /  (
oid
),

861 
bgp_oid
,  bgp_oid /  (
oid
),

862 
ödex
, 
IN_ADDR_SIZE
,

863 
bgpTøpLi°
,  bgpTøpLi° /  (
å≠_obje˘
),

864 
BGPESTABLISHED
);

865 
	}
}

868 
	$bgpTøpBackw¨dTønsôi⁄
 (
≥î
 *peer)

870 
ªt
;

871 
ö_addr
 
addr
;

872 
oid
 
ödex
[ (oidË* 
IN_ADDR_SIZE
];

874 
ªt
 = 
	`öë_©⁄
 (
≥î
->
ho°
, &
addr
);

875 i‡(
ªt
 == 0)

878 
	`oid_c›y_addr
 (
ödex
, &
addr
, 
IN_ADDR_SIZE
);

880 
	`smux_å≠
 (
bgp_v¨übÀs
,  bgp_v¨übÀ†/  (
v¨übÀ
),

881 
bgp_å≠_oid
,  bgp_å≠_oid /  (
oid
),

882 
bgp_oid
,  bgp_oid /  (
oid
),

883 
ödex
, 
IN_ADDR_SIZE
,

884 
bgpTøpLi°
,  bgpTøpLi° /  (
å≠_obje˘
),

885 
BGPBACKWARDTRANSITION
);

886 
	}
}

889 
	$bgp_¢mp_öô
 ()

891 
	`smux_öô
 (
bm
->
ma°î
);

892 
	`REGISTER_MIB
("mibII/bgp", 
bgp_v¨übÀs
, 
v¨übÀ
, 
bgp_oid
);

893 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_snmp.h

21 #i‚de‡
_QUAGGA_BGP_SNMP_H


22 
	#_QUAGGA_BGP_SNMP_H


	)

24 
bgp_¢mp_öô
 ();

25 
bgpTøpE°ablished
 (
≥î
 *);

26 
bgpTøpBackw¨dTønsôi⁄
 (
≥î
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_table.c

21 
	~<zebø.h
>

23 
	~"¥efix.h
"

24 
	~"mem‹y.h
"

25 
	~"sockuni⁄.h
"

26 
	~"vty.h
"

28 
	~"bgpd/bgpd.h
"

29 
	~"bgpd/bgp_èbÀ.h
"

32 
	$bgp_èbÀ_lock
 (
bgp_èbÀ
 *
π
)

34 
π
->
lock
++;

35 
	}
}

38 
	$bgp_èbÀ_u∆ock
 (
bgp_èbÀ
 *
π
)

40 
	`as£π
 (
π
->
lock
 > 0);

41 
π
->
lock
--;

43 i‡(
π
->
lock
 != 0)

48 
	`rouã_èbÀ_föish
 (
π
->
rouã_èbÀ
);

49 
π
->
rouã_èbÀ
 = 
NULL
;

51 i‡(
π
->
ow√r
)

53 
	`≥î_u∆ock
 (
π
->
ow√r
);

54 
π
->
ow√r
 = 
NULL
;

57 
	`XFREE
 (
MTYPE_BGP_TABLE
, 
π
);

58 
	}
}

61 
	$bgp_èbÀ_föish
 (
bgp_èbÀ
 **
π
)

63 i‡(*
π
 !
NULL
)

65 
	`bgp_èbÀ_u∆ock
(*
π
);

66 *
π
 = 
NULL
;

68 
	}
}

73 
rouã_node
 *

74 
	$bgp_node_¸óã
 (
rouã_èbÀ_dñeg©e_t
 *
dñeg©e
, 
rouã_èbÀ
 *
èbÀ
)

76 
bgp_node
 *
node
;

77 
node
 = 
	`XCALLOC
 (
MTYPE_BGP_NODE
,  (
bgp_node
));

78  
	`bgp_node_to_∫ode
 (
node
);

79 
	}
}

85 
	$bgp_node_de°roy
 (
rouã_èbÀ_dñeg©e_t
 *
dñeg©e
,

86 
rouã_èbÀ
 *
èbÀ
, 
rouã_node
 *
node
)

88 
bgp_node
 *bgp_node;

89 
bgp_node
 = 
	`bgp_node_‰om_∫ode
 (
node
);

90 
	`XFREE
 (
MTYPE_BGP_NODE
, 
bgp_node
);

91 
	}
}

97 
rouã_èbÀ_dñeg©e_t
 
	gbgp_èbÀ_dñeg©e
 = {

98 .
¸óã_node
 = 
bgp_node_¸óã
,

99 .
	gde°roy_node
 = 
bgp_node_de°roy


105 
bgp_èbÀ
 *

106 
	$bgp_èbÀ_öô
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

108 
bgp_èbÀ
 *
π
;

110 
π
 = 
	`XCALLOC
 (
MTYPE_BGP_TABLE
,  (
bgp_èbÀ
));

112 
π
->
rouã_èbÀ
 = 
	`rouã_èbÀ_öô_wôh_dñeg©e
 (&
bgp_èbÀ_dñeg©e
);

117 
π
->
rouã_èbÀ
->
öfo
 =Ñt;

119 
	`bgp_èbÀ_lock
 (
π
);

120 
π
->
ty≥
 = 
BGP_TABLE_MAIN
;

121 
π
->
afi
 =áfi;

122 
π
->
ßfi
 = safi;

124  
π
;

125 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_table.h

21 #i‚de‡
_QUAGGA_BGP_TABLE_H


22 
	#_QUAGGA_BGP_TABLE_H


	)

24 
	~"èbÀ.h
"

28 
	mBGP_TABLE_MAIN
,

29 
	mBGP_TABLE_RSCLIENT
,

30 } 
	tbgp_èbÀ_t
;

32 
	sbgp_èbÀ


34 
bgp_èbÀ_t
 
	mty≥
;

37 
afi_t
 
	mafi
;

38 
ßfi_t
 
	mßfi
;

40 
	mlock
;

43 
≥î
 *
	mow√r
;

45 
rouã_èbÀ
 *
	mrouã_èbÀ
;

48 
	sbgp_node


58 
	mROUTE_NODE_FIELDS
;

60 
bgp_adj_out
 *
	madj_out
;

62 
bgp_adj_ö
 *
	madj_ö
;

64 
bgp_node
 *
	m¥n
;

66 
u_ch¨
 
	mÊags
;

67 
	#BGP_NODE_PROCESS_SCHEDULED
 (1 << 0)

	)

75 
	sbgp_èbÀ_ôî_t_


77 
bgp_èbÀ
 *
	mèbÀ
;

78 
rouã_èbÀ_ôî_t
 
	mπ_ôî
;

79 } 
	tbgp_èbÀ_ôî_t
;

81 
bgp_èbÀ
 *
bgp_èbÀ_öô
 (
afi_t
, 
ßfi_t
);

82 
bgp_èbÀ_lock
 (
bgp_èbÀ
 *);

83 
bgp_èbÀ_u∆ock
 (
bgp_èbÀ
 *);

84 
bgp_èbÀ_föish
 (
bgp_èbÀ
 **);

92 
ölöe
 
bgp_node
 *

93 
	$bgp_node_‰om_∫ode
 (
rouã_node
 *
∫ode
)

95  (
bgp_node
 *Ë
∫ode
;

96 
	}
}

103 
ölöe
 
rouã_node
 *

104 
	$bgp_node_to_∫ode
 (
bgp_node
 *
node
)

106  (
rouã_node
 *Ë
node
;

107 
	}
}

114 
ölöe
 
bgp_èbÀ
 *

115 
	$bgp_node_èbÀ
 (
bgp_node
 *
node
)

117  
	`bgp_node_to_∫ode
 (
node
)->
èbÀ
->
öfo
;

118 
	}
}

125 
ölöe
 *

126 
	$bgp_node_öfo
 (c⁄° 
bgp_node
 *
node
)

128  
node
->
öfo
;

129 
	}
}

134 
ölöe
 

135 
	$bgp_node_£t_öfo
 (
bgp_node
 *
node
, *
öfo
)

137 
node
->
öfo
 = info;

138 
	}
}

143 
ölöe
 
¥efix
 *

144 
	$bgp_node_¥efix
 (
bgp_node
 *
node
)

146  &
node
->
p
;

147 
	}
}

152 
ölöe
 
u_ch¨


153 
	$bgp_node_¥efixÀn
 (
bgp_node
 *
node
)

155  
	`bgp_node_¥efix
 (
node
)->
¥efixÀn
;

156 
	}
}

163 
ölöe
 
bgp_node
 *

164 
	$bgp_node_∑ª¡_nﬁock
 (
bgp_node
 *
node
)

166  
	`bgp_node_‰om_∫ode
 (
node
->
∑ª¡
);

167 
	}
}

172 
ölöe
 

173 
	$bgp_u∆ock_node
 (
bgp_node
 *
node
)

175 
	`rouã_u∆ock_node
 (
	`bgp_node_to_∫ode
 (
node
));

176 
	}
}

185 
ölöe
 
bgp_node
 *

186 
	$bgp_èbÀ_t›_nﬁock
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
)

188  
	`bgp_node_‰om_∫ode
 (
èbÀ
->
rouã_èbÀ
->
t›
);

189 
	}
}

194 
ölöe
 
bgp_node
 *

195 
	$bgp_èbÀ_t›
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
)

197  
	`bgp_node_‰om_∫ode
 (
	`rouã_t›
 (
èbÀ
->
rouã_èbÀ
));

198 
	}
}

203 
ölöe
 
bgp_node
 *

204 
	$bgp_rouã_√xt
 (
bgp_node
 *
node
)

206  
	`bgp_node_‰om_∫ode
 (
	`rouã_√xt
 (
	`bgp_node_to_∫ode
 (
node
)));

207 
	}
}

212 
ölöe
 
bgp_node
 *

213 
	$bgp_rouã_√xt_u¡û
 (
bgp_node
 *
node
, bgp_nodê*
limô
)

215 
rouã_node
 *
∫ode
;

217 
∫ode
 = 
	`rouã_√xt_u¡û
 (
	`bgp_node_to_∫ode
 (
node
),

218 
	`bgp_node_to_∫ode
 (
limô
));

219  
	`bgp_node_‰om_∫ode
 (
∫ode
);

220 
	}
}

225 
ölöe
 
bgp_node
 *

226 
	$bgp_node_gë
 (
bgp_èbÀ
 *c⁄° 
èbÀ
, 
¥efix
 *
p
)

228  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_gë
 (
èbÀ
->
rouã_èbÀ
, 
p
));

229 
	}
}

234 
ölöe
 
bgp_node
 *

235 
	$bgp_node_lookup
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
, 
¥efix
 *
p
)

237  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_lookup
 (
èbÀ
->
rouã_èbÀ
, 
p
));

238 
	}
}

243 
ölöe
 
bgp_node
 *

244 
	$bgp_lock_node
 (
bgp_node
 *
node
)

246  
	`bgp_node_‰om_∫ode
 (
	`rouã_lock_node
 (
	`bgp_node_to_∫ode
 (
node
)));

247 
	}
}

252 
ölöe
 
bgp_node
 *

253 
	$bgp_node_m©ch
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
¥efix
 *
p
)

255  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_m©ch
 (
èbÀ
->
rouã_èbÀ
, 
p
));

256 
	}
}

261 
ölöe
 
bgp_node
 *

262 
	$bgp_node_m©ch_ùv4
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
ö_addr
 *
addr
)

264  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_m©ch_ùv4
 (
èbÀ
->
rouã_èbÀ
,

265 
addr
));

266 
	}
}

268 #ifde‡
HAVE_IPV6


273 
ölöe
 
bgp_node
 *

274 
	$bgp_node_m©ch_ùv6
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
ö6_addr
 *
addr
)

276  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_m©ch_ùv6
 (
èbÀ
->
rouã_èbÀ
,

277 
addr
));

278 
	}
}

282 
ölöe
 

283 
	$bgp_èbÀ_cou¡
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
)

285  
	`rouã_èbÀ_cou¡
 (
èbÀ
->
rouã_èbÀ
);

286 
	}
}

291 
ölöe
 
bgp_node
 *

292 
	$bgp_èbÀ_gë_√xt
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
¥efix
 *
p
)

294  
	`bgp_node_‰om_∫ode
 (
	`rouã_èbÀ_gë_√xt
 (
èbÀ
->
rouã_èbÀ
, 
p
));

295 
	}
}

300 
ölöe
 

301 
	$bgp_èbÀ_ôî_öô
 (
bgp_èbÀ_ôî_t
 * 
ôî
, 
bgp_èbÀ
 *
èbÀ
)

303 
	`bgp_èbÀ_lock
 (
èbÀ
);

304 
ôî
->
èbÀ
 =Åable;

305 
	`rouã_èbÀ_ôî_öô
 (&
ôî
->
π_ôî
, 
èbÀ
->
rouã_èbÀ
);

306 
	}
}

311 
ölöe
 
bgp_node
 *

312 
	$bgp_èbÀ_ôî_√xt
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

314  
	`bgp_node_‰om_∫ode
 (
	`rouã_èbÀ_ôî_√xt
 (&
ôî
->
π_ôî
));

315 
	}
}

320 
ölöe
 

321 
	$bgp_èbÀ_ôî_˛ónup
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

323 
	`rouã_èbÀ_ôî_˛ónup
 (&
ôî
->
π_ôî
);

324 
	`bgp_èbÀ_u∆ock
 (
ôî
->
èbÀ
);

325 
ôî
->
èbÀ
 = 
NULL
;

326 
	}
}

331 
ölöe
 

332 
	$bgp_èbÀ_ôî_∑u£
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

334 
	`rouã_èbÀ_ôî_∑u£
 (&
ôî
->
π_ôî
);

335 
	}
}

340 
ölöe
 

341 
	$bgp_èbÀ_ôî_is_d⁄e
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

343  
	`rouã_èbÀ_ôî_is_d⁄e
 (&
ôî
->
π_ôî
);

344 
	}
}

349 
ölöe
 

350 
	$bgp_èbÀ_ôî_°¨ãd
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

352  
	`rouã_èbÀ_ôî_°¨ãd
 (&
ôî
->
π_ôî
);

353 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_validate.c

1 
	~<zebø.h
>

2 #ifde‡
USE_SRX


4 
	~"log.h
"

5 
	~"hash.h
"

6 
	~"jhash.h
"

7 
	~"mem‹y.h
"

8 
	~"ve˘‹.h
"

9 
	~"¥efix.h
"

10 
	~"log.h
"

11 
	~"°ªam.h
"

12 
	~"vty.h
"

13 
	~"bgpd/bgpd.h
"

14 
	~"bgpd/bgp_©å.h
"

15 
	~"bgpd/bgp_debug.h
"

16 
	~"bgpd/bgp_a•©h.h
"

17 
	~"bgpd/bgp_vÆid©e.h
"

19 
	~<§x/§x¸y±ﬂpi.h
>

20 
SRxCry±oAPI
 *
	gg_ˇpi
;

21 
	#RET_ID_OFFSET
 1

	)

24 
hash
 *
	gbgp£chash
;

26 
u_öt8_t
* 
ski_√w
();

27 *
sig«tuª_√w
(
size_t
 
size
);

28 
P©hSegmít
* 
∑thSegmít_New
();

29 
SigSegmít
* 
sigSegmít_New
();

30 
SigBlock
* 
sigBlock_New
();

31 
bgp£c_sigBlock_‰ì_Æl
 (
SigBlock
 *
sb
);

32 
bgp£c_sigBlock_‰ì
 (
SigBlock
 *
sb
);

33 
sigSegmít_‰ì_Æl
(
SigSegmít
 *
ss
);

34 
sigSegmít_‰ì
(
SigSegmít
 *
ss
);

35 
bgp£c_∑th_£gmít_‰ì_Æl
 (
P©hSegmít
 *
£g
);

36 
bgp£c_∑th_£gmít_‰ì
 (
P©hSegmít
 *
£g
);

37 
Bgp£cP©hAâr
 * 
bgp£c_∑th_©å_√w
 ();

38 * 
bgp£c_∑th_hash_Æloc
 (*
¨g
);

41 
	$bgp£c_∑th_©å_cmp
 (c⁄° *
¨g1
, c⁄° *
¨g2
)

43 i‡(
¨g1
 =
¨g2
)

45 i‡(
¨g1
 =
NULL
 && 
¨g2
 == NULL)

48 c⁄° 
P©hSegmít
 *
£g1
 = ((c⁄° 
Bgp£cP©hAâr
 *)
¨g1
)->
∑thSegmíts
;

49 c⁄° 
P©hSegmít
 *
£g2
 = ((c⁄° 
Bgp£cP©hAâr
 *)
¨g2
)->
∑thSegmíts
;

51 c⁄° 
SigBlock
 *
sb1
 = ((c⁄° 
Bgp£cP©hAâr
 *)
¨g1
)->
sigBlocks
;

52 c⁄° 
SigBlock
 *
sb2
 = ((c⁄° 
Bgp£cP©hAâr
 *)
¨g2
)->
sigBlocks
;

54 c⁄° 
SigSegmít
 *
ss1
;

55 c⁄° 
SigSegmít
 *
ss2
;

57 
£g1
 || 
£g2
)

59 i‡((!
£g1
 && 
£g2
) || (seg1 && !seg2))

61 i‡(
£g1
->
as
 !
£g2
->as)

63 i‡(
£g1
->
pCou¡
 !
£g2
->pCount)

65 i‡(
£g1
->
Êags
 !
£g2
->flags)

67 
£g1
 = seg1->
√xt
;

68 
£g2
 = seg2->
√xt
;

71 
sb1
 || 
sb2
)

73 i‡((!
sb1
 && 
sb2
) || (sb1 && !sb2))

75 i‡(
sb1
->
sigBlockLí
 !
sb2
->sigBlockLen)

77 i‡(
sb1
->
ÆgoSuôeId
 !
sb2
->algoSuiteId)

80 
ss1
 = 
sb1
->
sigSegmíts
;

81 
ss2
 = 
sb2
->
sigSegmíts
;

83 
ss1
 || 
ss2
)

85 i‡((!
ss1
 && 
ss2
) || (ss1 && !ss2))

87 i‡(
	`memcmp
(
ss1
->
ski
, 
ss2
->ski, 
BGPSEC_SKI_LENGTH
) != 0)

89 i‡(
ss1
->
sigLí
 !
ss2
->sigLen)

91 i‡(
	`memcmp
(
ss1
->
sig«tuª
, 
ss2
->sig«tuª, ss1->
sigLí
) != 0)

94 
ss1
 = ss1->
√xt
;

95 
ss2
 = ss2->
√xt
;

98 
sb1
 = sb1->
√xt
;

99 
sb2
 = sb2->
√xt
;

102 
	}
}

106 
	$bgp£c_∑th_©å_key_make
 (*
p
)

108 
Bgp£cP©hAâr
 *
b∑
 = (Bgp£cP©hAâ∏*Ë
p
;

109 
P©hSegmít
 *
£g
 = 
b∑
->
∑thSegmíts
;

110 
SigBlock
 *
sb
 = 
b∑
->
sigBlocks
;

111 
SigSegmít
 *
ss
;

112 
key
 = 0;

115 i‡(
sb
)

117 
ss
 = 
sb
->
sigSegmíts
;

118 
key
 +
	`jhash
(
sb
, 4, 0);

119 
key
 +
	`jhash
 (
ss
->
sig«tuª
, ss->
sigLí
, 0);

134 
	#MIX
(
vÆ
Ë
key
 = 
	`jhash_1w‹d
(vÆ, key)

	)

135 
	`MIX
(
b∑
->
£cuªP©hLí
);

136 
key
 +
	`jhash
(
b∑
->
∑thSegmíts
, 4, 0);

137 
key
 +
	`jhash
(
b∑
->
sigBlocks
, 4, 0);

140  
key
;

141 
	}
}

148 
	$bgp£c_∑th_©å_öô
()

155 
bgp£chash
 = 
	`hash_¸óã_size
 (32767, 
bgp£c_∑th_©å_key_make
, 
bgp£c_∑th_©å_cmp
);

156 
g_ˇpi
 = 
	`mÆloc
((
SRxCry±oAPI
));

157 
	`mem£t
 (
g_ˇpi
, 0, (
SRxCry±oAPI
));

158 
sˇ_°©us_t
 
sˇ_°©us
 = 
API_STATUS_OK
;

160 if(
	`§xCry±oInô
(
g_ˇpi
, &
sˇ_°©us
Ë=
API_FAILURE
)

162 
	`zlog_îr
("[BGPSEC] SRxCry±oAPIÇŸ inôülized (0x%X)!\n", 
sˇ_°©us
);

164 
	}
}

171 
SRxCry±oAPI
* 
	$gëSrxCAPI
()

173  
g_ˇpi
;

174 
	}
}

179 
	$bgp£c_∑th_©å_föish
 ()

181 
	`hash_‰ì
 (
bgp£chash
);

182 
bgp£chash
 = 
NULL
;

183 
	}
}

185 * 
	$bgp£c_∑th_hash_Æloc
 (*
¨g
)

187 c⁄° 
Bgp£cP©hAâr
 *
b∑
 = 
¨g
;

188 
Bgp£cP©hAâr
 *
√w
;

189 
P©hSegmít
 *
√wSeg
, *
‹igSeg
;

192 
	`as£π
 (
b∑
->
sigBlocks
);

193 
	`as£π
 (
b∑
->
∑thSegmíts
);

194 i‡(! 
b∑
->
sigBlocks
->
sigSegmíts
)

195  
NULL
;

198 
√w
 = 
	`bgp£c_∑th_©å_√w
();

199 
√w
->
£cuªP©hLí
 = 
b∑
->securePathLen;

200 
√w
->
∑thSegmíts
 = 
	`∑thSegmít_New
();

203 
‹igSeg
 = 
b∑
->
∑thSegmíts
;

204 
√wSeg
 = 
√w
->
∑thSegmíts
;

205 
‹igSeg
)

207 *
√wSeg
 = *
‹igSeg
;

209 if(
‹igSeg
->
√xt
)

211 
√wSeg
->
√xt
 = 
	`∑thSegmít_New
();

212 
√wSeg
 =ÇewSeg->
√xt
;

215 
‹igSeg
 = origSeg->
√xt
;

219 
SigSegmít
 *
√wSig
, *
‹igSig
;

220 if(
b∑
->
sigBlocks
)

222 
√w
->
sigBlocks
 = 
	`sigBlock_New
();

223 *
√w
->
sigBlocks
 = *
b∑
->sigBlocks;

225 
√wSig
 = 
√w
->
sigBlocks
->
sigSegmíts
 = 
	`sigSegmít_New
();

226 
‹igSig
 = 
b∑
->
sigBlocks
->
sigSegmíts
;

228 
‹igSig
)

230 *
√wSig
 = *
‹igSig
;

233 if(
‹igSig
->
ski
)

235 
√wSig
->
ski
 = 
	`ˇŒoc
 (1, 
BGPSEC_SKI_LENGTH
);

236 
	`mem˝y
(
√wSig
->
ski
, 
‹igSig
->ski, 
BGPSEC_SKI_LENGTH
);

240 if(
‹igSig
->
sig«tuª
)

242 
√wSig
->
sig«tuª
 = 
	`ˇŒoc
 (1, 
‹igSig
->
sigLí
);

243 
	`mem˝y
(
√wSig
->
sig«tuª
, 
‹igSig
->sig«tuª, origSig->
sigLí
);

246 if(
‹igSig
->
√xt
)

248 
√wSig
->
√xt
 = 
	`sigSegmít_New
();

249 
√wSig
 =ÇewSig->
√xt
;

252 
‹igSig
 = origSig->
√xt
;

256 
√w
->
ªf˙t
 = 0;

257  
√w
;

258 
	}
}

267 
Bgp£cP©hAâr
 * 
	$bgp£c_∑th_©å_√w
 ()

269 
Bgp£cP©hAâr
 *
√w
;

270 
√w
 = 
	`XCALLOC
 (
MTYPE_BGPSEC_PATH
,  (
Bgp£cP©hAâr
));

271 
	`mem£t
(
√w
, 0x0, (
Bgp£cP©hAâr
));

272  
√w
;

273 
	}
}

283 
Bgp£cP©hAâr
 * 
	$bgp£c_∑th_©å_Æl_√w
()

285 
Bgp£cP©hAâr
 *
b∑
;

287 
b∑
 = 
	`bgp£c_∑th_©å_√w
();

288 
b∑
->
∑thSegmíts
 = 
	`∑thSegmít_New
();

289 
b∑
->
sigBlocks
 = 
	`sigBlock_New
();

290 
b∑
->
sigBlocks
->
sigSegmíts
 = 
	`sigSegmít_New
();

292  
b∑
;

293 
	}
}

302 
	$bgp£c_∑th_£gmít_‰ì
 (
P©hSegmít
 *
£g
)

304 i‡(
£g
 !
NULL
)

306 
	`mem£t
(
£g
, 0, (
P©hSegmít
));

307 
	`XFREE
 (
MTYPE_BGPSEC_PATH_SEG
, 
£g
);

311 
	}
}

318 
	$bgp£c_∑th_£gmít_‰ì_Æl
 (
P©hSegmít
 *
£g
)

320 
P©hSegmít
 *
¥ev
;

322 
£g
 !
NULL
)

324 
¥ev
 = 
£g
;

325 
£g
 = seg->
√xt
;

326 
	`bgp£c_∑th_£gmít_‰ì
 (
¥ev
);

328 
	}
}

338 
	$sigSegmít_‰ì
(
SigSegmít
 *
ss
)

340 i‡(
ss
 !
NULL
)

343 i‡(
ss
->
ski
 !
NULL
)

345 
	`mem£t
–
ss
->
ski
, 0, 
SKI_LENGTH
);

346 
	`‰ì
(
ss
->
ski
);

350 i‡(
ss
->
sig«tuª
 !
NULL
)

352 
	`mem£t
(
ss
->
sig«tuª
, 0, ss->
sigLí
);

353 
	`‰ì
(
ss
->
sig«tuª
);

356 
	`mem£t
 (
ss
, 0, (
SigSegmít
));

358 
	`XFREE
 (
MTYPE_BGPSEC_SIG_SEG
, 
ss
);

360 
	}
}

367 
	$sigSegmít_‰ì_Æl
(
SigSegmít
 *
ss
)

369 
SigSegmít
 *
¥ev
;

371 
ss
 !
NULL
)

373 
¥ev
 = 
ss
;

374 
ss
 = ss->
√xt
;

375 
	`sigSegmít_‰ì
(
¥ev
);

377 
	}
}

386 
	$bgp£c_sigBlock_‰ì
 (
SigBlock
 *
sb
)

388 i‡(
sb
 !
NULL
)

391 
	`sigSegmít_‰ì_Æl
(
sb
->
sigSegmíts
);

392 
	`mem£t
 (
sb
, 0, (
SigBlock
));

393 
	`XFREE
 (
MTYPE_BGPSEC_SIG_BLK
, 
sb
);

395 
	}
}

402 
	$bgp£c_sigBlock_‰ì_Æl
 (
SigBlock
 *
sb
)

404 
SigBlock
 *
¥ev
;

406 
sb
 !
NULL
)

408 
¥ev
 = 
sb
;

409 
sb
 = sb->
√xt
;

410 
	`bgp£c_sigBlock_‰ì
 (
¥ev
);

412 
	}
}

421 
	$bgp£c_∑th_‰ì
 (
Bgp£cP©hAâr
 *
b∑
)

423 i‡(
b∑
 !
NULL
)

425 
	`bgp£c_∑th_£gmít_‰ì_Æl
 (
b∑
->
∑thSegmíts
);

426 
	`bgp£c_sigBlock_‰ì_Æl
 (
b∑
->
sigBlocks
);

428 
	`mem£t
(
b∑
, 0, (
Bgp£cP©hAâr
));

429 
	`XFREE
 (
MTYPE_BGPSEC_PATH
, 
b∑
);

431 
	}
}

435 
	$bgp£c_∑th_unöã∫
 (
Bgp£cP©hAâr
 **
pb∑
)

437 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

438 
	`zlog_debug
("[BGPSEC] bgpsec_path_unintern function called");

439 
Bgp£cP©hAâr
 *
ªt
;

440 
Bgp£cP©hAâr
 *
b∑
 = *
pb∑
;

442 i‡(
b∑
->
ªf˙t
)

443 
b∑
->
ªf˙t
--;

445 i‡(
b∑
->
ªf˙t
 == 0)

448 
ªt
 = 
	`hash_ªÀa£
 (
bgp£chash
, 
b∑
);

449 
	`as£π
 (
ªt
 !
NULL
);

450 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_DETAIL
))

451 
	`zlog_debug
("[BGPSEC] [%s] b∑: %∞wû»bêunöã∫ed ", 
__FUNCTION__
, 
b∑
);

452 
	`bgp£c_∑th_‰ì
 (
b∑
);

453 *
pb∑
 = 
NULL
;

455 
	}
}

459 
Bgp£cP©hAâr
 *
	$bgp£c_∑th_öã∫
 (
Bgp£cP©hAâr
 *
b∑
)

461 
Bgp£cP©hAâr
 *
föd
;

464 
	`as£π
 (
b∑
->
ªf˙t
 == 0);

467 
föd
 = 
	`hash_gë
 (
bgp£chash
, 
b∑
, 
bgp£c_∑th_hash_Æloc
);

470 i‡(
föd
 !
b∑
)

471 
	`bgp£c_∑th_‰ì
 (
b∑
);

473 
föd
->
ªf˙t
++;

475  
föd
;

476 
	}
}

486 
P©hSegmít
* 
	$∑thSegmít_New
()

488 
P©hSegmít
 *
√w
;

489 
√w
 = 
	`XCALLOC
 (
MTYPE_BGPSEC_PATH_SEG
,  (
P©hSegmít
));

490 
	`mem£t
(
√w
, 0x00, (
P©hSegmít
));

492  
√w
;

493 
	}
}

500 
u_öt8_t
* 
	$ski_√w
()

502 
u_öt8_t
* 
ski
 = 
	`mÆloc
 (
SKI_LENGTH
);

503 
	`mem£t
(
ski
, 0, 
SKI_LENGTH
);

504  
ski
;

505 
	}
}

508 *
	$sig«tuª_√w
(
size_t
 
size
)

510 
u_öt8_t
* 
sig«tuª
;

511 
sig«tuª
 = 
	`XMALLOC
(
MTYPE_BGPSEC_SIGNATURE
, 
size
);

512 
	`mem£t
(
sig«tuª
, 0, 
size
);

513  
sig«tuª
;

515 
	}
}

524 
SigSegmít
* 
	$sigSegmít_New
()

527 
SigSegmít
 *
√w
;

528 
√w
 = 
	`XCALLOC
 (
MTYPE_BGPSEC_SIG_SEG
,  (
SigSegmít
));

529 
	`mem£t
(
√w
, 0x00, (
SigSegmít
));

531  
√w
;

532 
	}
}

541 
SigBlock
* 
	$sigBlock_New
()

543 
SigBlock
 *
√w
;

544 
√w
 = 
	`XCALLOC
 (
MTYPE_BGPSEC_SIG_BLK
,  (
SigBlock
));

545 
	`mem£t
(
√w
, 0x00, (
SigBlock
));

547  
√w
;

548 
	}
}

564 
Bgp£cP©hAâr
* 
	$bgp£c_∑r£
(
©å
 *©å, 
≥î
 *peer,

565 
°ªam
 *
s
, 
size_t
 
Àngth
)

569 
u_ch¨
* 
°¨ç
 = 
NULL
;

570 
u_ch¨
* 
ídp
 = 
NULL
;

572 
size_t
 
°¨t_gëp
 = 0;

573 
size_t
 
°¨t_ídp
 = 0;

575 
size_t
 
•p
 = 0;

577 
size_t
 
sbp
 = 0;

582 i‡((
	`STREAM_READABLE
(
s
Ë< 
Àngth
) || (length <= 0))

584 
	`zlog_îr
("bad bgpsecÖacket -Üength mismatch");

585  
NULL
;

588 
°¨ç
 = 
	`BGP_INPUT_PNT
 (
≥î
);

589 
°¨t_gëp
 = 
	`°ªam_gë_gëp
 (
s
);

590 
°¨t_ídp
 = 
	`°ªam_gë_ídp
 (
s
);

591 
ídp
 = 
°¨ç
 + 
Àngth
;

593 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

595 
	`zlog_debug
("[IN] %p - startp: %p-- getp:%dÉndp:%d --Éndp(startp+length):%pÜength:%d ", \

596 
	`°ªam_≤t
(
s
), 
°¨ç
, ()
°¨t_gëp
, ()
°¨t_ídp
, 
ídp
, ()
Àngth
);

601 
numSecuªP©hSegmít
 = 0;

603 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

605 
	`zlog_debug
("[IN]Öeerás:%dÖeer->local_as:%d Secure_Path Len:%d",\

606 
≥î
->
as
,Öìr->
loˇl_as
, 
	`°ªam_gëw_‰om
(
s
, 
°¨t_gëp
));

610 
u_öt16_t
 
•l
 = 
	`°ªam_gëw_‰om
(
s
, 
°¨t_gëp
);

611 
u_öt16_t
 
numSeg
 = 0;

613 i‡–(
•l
-
OCTET_SECURE_PATH_LEN
Ë% 
OCTET_SECURE_PATH_SEGMENT
 != 0)

615 
	`zlog_îr
(" SecurePath LengthÖarsingÉrror");

616  
NULL
;

619 
numSeg
 = (
•l
 - 
OCTET_SECURE_PATH_LEN
Ë/ 
OCTET_SECURE_PATH_SEGMENT
;

621 
Bgp£cP©hAâr
* 
b∑
 = 
NULL
;

622 
P©hSegmít
 *
£g
;

623 
SigBlock
 *
sb
;

625 
boﬁ
 
sy¡axEº‹
 = 
Ál£
;

637 
u_sh‹t
 
ôî
;

638 
P©hSegmít
 *
¥ev
 = 
NULL
, *
hód
 = NULL;

641 
b∑
 = 
	`bgp£c_∑th_©å_√w
();

643 
b∑
->
£cuªP©hLí
 = 
	`°ªam_gëw
(
s
);

646 
ôî
 = 
numSecuªP©hSegmít
 =

647 (
b∑
->
£cuªP©hLí
 - 
OCTET_SECURE_PATH_LEN
Ë/ 
OCTET_SECURE_PATH_SEGMENT
;

650 
ôî
)

653 i‡(
	`STREAM_READABLE
(
s
Ë< 
OCTET_SECURE_PATH_SEGMENT
)

655 
sy¡axEº‹
 = 
åue
;

658 
£g
 = 
	`∑thSegmít_New
();

661 i‡(
¥ev
)

663 
¥ev
->
√xt
 = 
£g
;

667 
b∑
->
∑thSegmíts
 = 
hód
 = 
£g
;

671 
£g
->
pCou¡
 = 
	`°ªam_gëc
(
s
);

672 
£g
->
Êags
 = 
	`°ªam_gëc
(
s
);

673 
£g
->
as
 = 
	`°ªam_gël
(
s
);

675 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

677 
	`zlog_debug
("[IN] Secuª_P©h segmíà--> %d AS:%d", 
ôî
, 
£g
->
as
);

680 
¥ev
 = 
£g
;

682 
ôî
--;

694 
SigSegmít
 *
ss_¥ev
 = 
NULL
, *
ss_cuº
 = NULL;

698 i‡(
	`STREAM_READABLE
(
s
) < 1)

700 
sy¡axEº‹
 = 
åue
;

703 
numSigBlocks
 = 0;

704 
	`STREAM_READABLE
(
s
) > 0)

706 
numSigBlocks
++;

707 i‡(
numSigBlocks
 > 
BGPSEC_MAX_SIGBLOCK
)

709 
sy¡axEº‹
 = 
åue
;

713 i‡(
b∑
->
sigBlocks
 =
NULL
)

716 
sb
 = 
b∑
->
sigBlocks
 = 
	`sigBlock_New
();

720 
sb
->
√xt
 = 
	`sigBlock_New
();

721 
sb
 = sb->
√xt
;

724 
sb
->
sigBlockLí
 = 
	`°ªam_gëw
(
s
);

725 i‡((
sb
->
sigBlockLí
-2Ë> 
	`STREAM_READABLE
(
s
))

728 
sy¡axEº‹
 = 
åue
;

731 
sb
->
ÆgoSuôeId
 = 
	`°ªam_gëc
(
s
);

733 
u_öt16_t
 
ªmaöögByãs
 = 
sb
->
sigBlockLí
 - 3;

735 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

737 
	`zlog_debug
("[IN] Secure_Block --> %d, AlgoID: %u, Length: %u",

738 
numSigBlocks
, 
sb
->
ÆgoSuôeId
, sb->
sigBlockLí
);

741 
numSig«tuªs
 = 0;

745 
ªmaöögByãs
 > 0)

747 
numSig«tuªs
++;

748 i‡(
sb
->
sigSegmíts
 =
NULL
)

750 
sb
->
sigSegmíts
 = 
	`sigSegmít_New
();

751 
ss_¥ev
 = 
NULL
;

752 
ss_cuº
 = 
sb
->
sigSegmíts
;

756 
ss_¥ev
->
√xt
 = 
	`sigSegmít_New
();

757 
ss_cuº
 = 
ss_¥ev
->
√xt
;

759 
ss_¥ev
 = 
ss_cuº
;

761 
ss_cuº
->
ski
 = 
	`ski_√w
();

762 
	`°ªam_gë
(
ss_cuº
->
ski
, 
s
, 
SKI_LENGTH
);

763 
ªmaöögByãs
 -
SKI_LENGTH
;

764 
ss_cuº
->
sigLí
 = 
	`°ªam_gëw
(
s
);

765 
ªmaöögByãs
 -= 2;

767 i‡(
	`STREAM_READABLE
(
s
Ë< 
ss_cuº
->
sigLí
)

770 
	`zlog_îr
("Bad bgpsec signatUreÜength: biggerÅhanÑemaining byte");

771 
sy¡axEº‹
 = 
åue
;

775 
ss_cuº
->
sig«tuª
 = 
	`sig«tuª_√w
(ss_cuº->
sigLí
);

776 
	`°ªam_gë
(
ss_cuº
->
sig«tuª
, 
s
, ss_cuº->
sigLí
);

777 
ªmaöögByãs
 -
ss_cuº
->
sigLí
;

779 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

781 
	`zlog_debug
("[IN] signature --> %d, Length: %u",

782 
numSig«tuªs
, 
ss_cuº
->
sigLí
);

785 i‡(
numSig«tuªs
 !
numSecuªP©hSegmít
)

787 
	`zlog_îr
("Number signatures doesÇot matchÇumber secureÖath segments");

788 
sy¡axEº‹
 = 
åue
;

793 i‡(
sy¡axEº‹
)

796 
	`bgp£c_∑th_‰ì
(
b∑
);

797 
b∑
 = 
NULL
;

800 i‡(
	`BGP_DEBUG
 (
bgp£c
, 
BGPSEC_IN
Ë|| BGP_DEBUG(bgp£c, 
BGPSEC_DETAIL
))

802 
	`zlog_debug
("[IN] %s:Ñëu∫ vÆue(föÆ b∑): %p", 
__FUNCTION__
, 
b∑
);

805  
b∑
;

806 
	}
}

825 
SCA_Sig«tuª
* 
	$signBGPSecP©hAâr
(
bgp
* bgp, 
≥î
*Öeer,

826 
¥efix
* 
pfx
, 
©å
*áttr,

827 
u_öt8_t
 
pCou¡
, u_öt8_à
Êags
)

831 
	#BLOCK_0
 0

	)

832 
	#BLOCK_1
 1

	)

837 
boﬁ
 
tmpD©a
 = 
Ál£
;

839 i‡(
bgp
->
§xCAPI
 =
NULL
)

841  
NULL
;

848 
as_t
 
èrgëAS
 = 
	`ht⁄l
(
≥î
->
as
);

849 
as_t
 
loˇlAS
 = 
	`ht⁄l
(
bgp
->
as
);

852 
SCA_BGPSEC_SecuªP©hSegmít
 
•Seg
;

853 
•Seg
.
pCou¡
 =ÖCount;

854 
•Seg
.
Êags
 = flags;

855 
•Seg
.
a¢
 = 
	`ht⁄l
(
bgp
->
as
);

859 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
 =
NULL
)

863 
©å
->
bgp£c_vÆid©i⁄D©a
 = 
	`mÆloc
((
SCA_BGPSecVÆid©i⁄D©a
));

864 
	`mem£t
(
©å
->
bgp£c_vÆid©i⁄D©a
, 0, (
SCA_BGPSecVÆid©i⁄D©a
));

865 
tmpD©a
 = 
åue
;

873 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[0] =
NULL
)

877 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
bgp£c_∑th_©å
 =
NULL
)

881 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
 =
NULL
)

884 
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
 = 
	`mÆloc
((
SCA_Pªfix
));

885 
	`mem£t
(
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
, 0, (
SCA_Pªfix
));

886 
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
->
afi
 = 
	`ht⁄s
(
	`Ámûy2afi
(
pfx
->
Ámûy
));

887 
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
->
ßfi
 = 
SAFI_UNICAST
;

889 
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
->
Àngth
 = (
u_öt8_t
)
pfx
->
¥efixÀn
;

890 
bLí
 = (
pfx
->
¥efixÀn
 + 7) / 8;

891 
	`mem˝y
(
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
->
addr
.
ù
, 
pfx
->
u
.
vÆ
, 
bLí
);

897 
SCA_BGPSecSignD©a
 
sˇSignD©a
;

898 
	`mem£t
 (&
sˇSignD©a
, 0, (
SCA_BGPSecSignD©a
));

901 
sˇSignD©a
.
Æg‹ôhmID
 = 
bgp
->
§x_bgp£c_key
[bgp->
§x_bgp£c_a˘ive_key
].
ÆgoID
;

902 
sˇSignD©a
.
myHo°
 = &
•Seg
;

903 
sˇSignD©a
.
≥îAS
 = 
èrgëAS
;

904 
sˇSignD©a
.
∆ri
 = 
©å
->
bgp£c_vÆid©i⁄D©a
->nlri;

905 
sˇSignD©a
.
ski
 = 
bgp
->
§x_bgp£c_key
[bgp->
§x_bgp£c_a˘ive_key
].ski;

906 
sˇSignD©a
.
°©us
 = 
API_STATUS_OK
;

910 
sˇSignD©a
.
sig«tuª
 = 
NULL
;

911 i‡–
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

914 i‡(!
tmpD©a
)

915 
	`sˇ_gíî©eHashMesßge
(
©å
->
bgp£c_vÆid©i⁄D©a
,

916 
SCA_ECDSA_ALGORITHM
, &
©å
->
bgp£c_vÆid©i⁄D©a
->
°©us
);

918 
sˇSignD©a
.
hashMesßge
 = 
©å
->
bgp£c_vÆid©i⁄D©a
->hashMesßge[
BLOCK_0
];

922 
SCA_BGPSecSignD©a
 * 
bgp£c_d©a
[2];

923 
	`mem£t
(
bgp£c_d©a
, 
SCA_MAX_SIGBLOCK_COUNT
, (
SCA_BGPSecSignD©a
 *));

924 
bgp£c_d©a
[0] = &
sˇSignD©a
;

925 
bgp£c_d©a
[1] = 
NULL
;

930 
cou¡SigBlocks
 = 1;

934 i‡(
bgp
->
§xCAPI
->
	`sign
(
cou¡SigBlocks
, 
bgp£c_d©a
Ë=
API_FAILURE
)

936 
	`zlog_îr
("[BGPSEC] SigningÅhe bgpsecÖathÅoÖeer %u failed status (0x%X)\n",

937 
≥î
->
as
, 
sˇSignD©a
.
°©us
);

938 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
BLOCK_0
] =
NULL
)

942 i‡(!
bgp
->
§xCAPI
->
	`‰ìHashMesßge
(
sˇSignD©a
.
hashMesßge
))

946 
	`‰ìSCA_HashMesßge
(
sˇSignD©a
.
hashMesßge
);

948 
sˇSignD©a
.
hashMesßge
 = 
NULL
;

953 i‡–!
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

955 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
BLOCK_0
] !
sˇSignD©a
.hashMessage)

957 i‡(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
BLOCK_0
] !
NULL
)

959 i‡(!
bgp
->
§xCAPI
->
	`‰ìHashMesßge
(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
BLOCK_0
]));

961 
	`‰ìSCA_HashMesßge
(
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
BLOCK_0
]);

963 
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
BLOCK_0
] = 
NULL
;

967 i‡(!
tmpD©a
)

969 
©å
->
bgp£c_vÆid©i⁄D©a
->
hashMesßge
[
BLOCK_0
] = 
sˇSignD©a
.hashMessage;

973 
	`‰ìSCA_HashMesßge
(
sˇSignD©a
.
hashMesßge
);

978 i‡(
tmpD©a
)

981 
	`‰ì
 (
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
);

982 
©å
->
bgp£c_vÆid©i⁄D©a
->
∆ri
 = 
NULL
;

983 
	`‰ì
 (
©å
->
bgp£c_vÆid©i⁄D©a
);

984 
©å
->
bgp£c_vÆid©i⁄D©a
 = 
NULL
;

985 
sˇSignD©a
.
hashMesßge
 = 
NULL
;

988  
sˇSignD©a
.
sig«tuª
;

989 
	}
}

1005 
	$c⁄°ru˘BGPSecP©hAâribuã
(
bgp
 *bgp, 
≥î
 *peer,

1006 
a•©h
 *a•©h, 
¥efix
* 
p
,

1007 
°ªam
 *
s
, 
©å
 *attr,

1008 
u_öt8_t
 
Êags
, u_öt8_à
pCou¡
,

1009 
SCA_Sig«tuª
** 
sig«tuªs
, 
numSig«tuªs
)

1011 
size_t
 
©åLíPå
 = 
	`°ªam_gë_ídp
(
s
);

1015 
Bgp£cP©hAâr
* 
b∑
 = 
	`bgp£cDup
(
©å
->
bgp£cP©hAâr
, 
åue
);

1017 
uöt16_t
 
£cP©hLí
 = 
LEN_SECPATHSEGMENT


1018 + ((
b∑
->
£cuªP©hLí
 == 0) ? 2 : bpa->securePathLen);

1019 
	`°ªam_putw
 (
s
, 
£cP©hLí
);

1022 
numP©hSegmíts
 = 1;

1023 
	`°ªam_putc
 (
s
, 
pCou¡
);

1024 
	`°ªam_putc
 (
s
, 
Êags
);

1025 
	`°ªam_pué
 (
s
, 
bgp
->
as
);

1026 
P©hSegmít
* 
pSeg
 = 
b∑
->
∑thSegmíts
;

1027 
pSeg
 !
NULL
)

1029 
numP©hSegmíts
++;

1030 
	`°ªam_putc
 (
s
, 
pSeg
->
pCou¡
);

1031 
	`°ªam_putc
 (
s
, 
pSeg
->
Êags
);

1032 
	`°ªam_pué
 (
s
, 
pSeg
->
as
);

1033 
pSeg
 =ÖSeg->
√xt
;

1036 
sigIdx
 = 0;

1037 
SigBlock
* 
sigBlock
 = 
NULL
;

1042 
SigBlock
* 
¥evBlock
 = 
NULL
;

1044 
SCA_Sig«tuª
* 
sig«tuª
 = 
NULL
;

1045 
sigIdx
 = 0; sigIdx < 
numSig«tuªs
; sigIdx++)

1047 
sigBlock
 = 
b∑
->
sigBlocks
;

1048 
¥evBlock
 = 
sigBlock
;

1049 
sig«tuª
 = 
sig«tuªs
[
sigIdx
];

1054 (
sigBlock
 !
NULL
Ë&& (sigBlock->
ÆgoSuôeId
 !
sig«tuª
->
ÆgoID
))

1056 
sigBlock
 = sigBlock->
√xt
;

1057 
¥evBlock
 = 
sigBlock
;

1059 i‡(
sigBlock
 =
NULL
)

1061 i‡(
numP©hSegmíts
 != 1)

1063 
	`zlog_îr
("[BGPSEC]ÇoÖath segments, something went completely wrong!\n");

1069 
sigBlock
 = 
	`sigBlock_New
();

1070 
¥evBlock
 = 
NULL
;

1071 
sigBlock
->
ÆgoSuôeId
 = 
sig«tuª
->
ÆgoID
;

1075 
size_t
 
sbPoöãr
 = 
	`°ªam_gë_ídp
 (
s
);

1076 
	`°ªam_putw
 (
s
, 0);

1078 
	`°ªam_putc
 (
s
, 
sigBlock
->
ÆgoSuôeId
);

1081 
	`°ªam_put
 (
s
, 
sig«tuª
->
ski
, 
SKI_LENGTH
);

1082 
	`°ªam_putw
 (
s
, 
sig«tuª
->
sigLí
);

1083 
	`°ªam_put
 (
s
, 
sig«tuª
->
sigBuff
, sig«tuª->
sigLí
);

1086 
SigSegmít
* 
sigSeg
 = 
sigBlock
->
sigSegmíts
;

1087 
sigSeg
 !
NULL
)

1089 
	`°ªam_put
 (
s
, 
sigSeg
->
ski
, 
SKI_LENGTH
);

1090 
	`°ªam_putw
 (
s
, 
sigSeg
->
sigLí
);

1091 
	`°ªam_put
 (
s
, 
sigSeg
->
sig«tuª
, sigSeg->
sigLí
);

1092 
sigSeg
 = sigSeg->
√xt
;

1096 
size_t
 
sbEndPoöãr
 = 
	`°ªam_gë_ídp
(
s
);

1097 
uöt16_t
 
sbLígth
 = (uöt16_t)(
sbEndPoöãr
 - 
sbPoöãr
);

1099 
	`°ªam_putw_©
 (
s
, 
sbPoöãr
, 
sbLígth
);

1101 i‡(
b∑
->
sigBlocks
 =
sigBlock
)

1103 
b∑
->
sigBlocks
 = 
sigBlock
->
√xt
;

1105 i‡(
¥evBlock
 !
NULL
)

1109 
¥evBlock
->
√xt
 = 
sigBlock
->next;

1112 
	`bgp£c_sigBlock_‰ì
(
sigBlock
);

1113 
sigBlock
 = 
NULL
;

1116 
size_t
 
ídPå
 = 
	`°ªam_gë_ídp
(
s
);

1117 
uöt16_t
 
©åLí
 = (uöt16_t)(
ídPå
 - 
©åLíPå
);

1118 
	`bgp£c_∑th_‰ì
(
b∑
);

1119 
b∑
 = 
NULL
;

1121  
©åLí
;

1122 
	}
}

1124 
	$ã°_¥öt
(
Bgp£cPdu
 
pdu
, 
size_t
 *
b±r
, *
sigbuff
, * 
hashbuff
, size_à
psize
)

1126 
i
=0;

1127 
	`¥ötf
(" \¿%s: \¿", 
__FUNCTION__
);

1128 
	`¥ötf
("Secuª_P©hÜígth: %d", 
pdu
.
Àn_SecuªP©h
);

1129 
	`¥ötf
(" - ASnum: %d \n", 
pdu
.
asNum
);

1130 
	`¥ötf
(" -Öcou¡: %d \n", 
pdu
.
pCou¡
);

1131 
	`¥ötf
(" - fœgs: %d \n\n", 
pdu
.
Êags
);

1132 
	`¥ötf
("Sig«tuª_BlockÜígth: %d(0x%02xË\n", 
pdu
.
Àn_SigBlock
,Ödu.len_SigBlock);

1133 
	`¥ötf
(" - Alg‹ôhm SuôêID: %d \n", 
pdu
.
ÆgoSuôeId
);

1134 
	`¥ötf
(" - SKI: %∞[b±r:%p]\n", 
pdu
.
ski
, 
b±r
);

1135 ;
i
<
BGPSEC_SKI_LENGTH
; i++)

1136 
	`¥ötf
("%02X ", *
pdu
.
ski
++);

1137 
	`¥ötf
("\n");

1138 
	`¥ötf
(" - sigÜígth: %d \n", 
pdu
.
Àn_Sig
);

1139 
	`¥ötf
(" - signature: \n");

1141 
i
=0; i<
pdu
.
Àn_Sig
; i++ )

1143 if(
i
%16 ==0Ë
	`¥ötf
("\n");

1144 
	`¥ötf
("%02x ", ()
sigbuff
[
i
]);

1146 
	`¥ötf
("\n");

1147  
i
=0; i<
psize
; i++)

1148 
	`¥ötf
("%02x ", 
hashbuff
[12+
i
]);

1149 
	`¥ötf
(" -- hashÖrefix\n");

1151 
	`¥ötf
("--áll verify hashbuff\n");

1152 
i
=0; i<12+
psize
; i++)

1153 
	`¥ötf
("%02x ", 
hashbuff
[
i
]);

1154 
	`¥ötf
("\n");

1155 
	}
}

1163 
	$¥öt_sig«tuª
(
Bgp£cP©hAâr
 *
b∑
)

1166 
P©hSegmít
 *
£g
 = 
b∑
->
∑thSegmíts
;

1167 
SigBlock
 *
sb
 = 
b∑
->
sigBlocks
;

1168 
SigSegmít
 *
ss
 = 
sb
->
sigSegmíts
;

1170 if(
£g
 && 
sb
 && 
ss
);

1172 
i
;

1173 
sig_Àngth
 = 
ss
->
sigLí
;

1175 if(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_STDOUT
] > 0)

1178 
i
=0; i<
sig_Àngth
; i++ )

1180 if(
i
%16 ==0Ë
	`¥ötf
("\n");

1181 
	`¥ötf
("%02x ", ()
ss
->
sig«tuª
[
i
]);

1183 
	`¥ötf
(" - from[%s]\n", 
__FUNCTION__
);

1185 
	}
}

1187 
	$bgp£cS™ôyCheck
(
Bgp£cP©hAâr
 *
b∑
)

1189 
P©hSegmít
 *
£g
;

1190 
SigBlock
 *
sb
;

1191 
SigSegmít
 *
ss
;

1193 if(!
b∑
)

1196 
£g
 = 
b∑
->
∑thSegmíts
;

1197 
sb
 = 
b∑
->
sigBlocks
;

1199 if(!
£g
 || !
sb
)

1202 
ss
 = 
sb
->
sigSegmíts
;

1204 if(!
ss
)

1207 if(!
ss
->
sig«tuª
 || !ss->
ski
)

1211 
	}
}

1224 
Bgp£cP©hAâr
 * 
	$bgp£cDup
(
Bgp£cP©hAâr
 *
‹ig
, 
boﬁ
 
√wIfNULL
)

1226 
Bgp£cP©hAâr
* 
√w
 = 
NULL
;

1228 if(
	`bgp£cS™ôyCheck
(
‹ig
) == 0)

1231 
√w
 = 
	`bgp£c_∑th_©å_Æl_√w
();

1233 
√w
->
£cuªP©hLí
 = 
‹ig
->securePathLen;

1236 
	`c⁄ˇtP©hSegmít
(
√w
->
∑thSegmíts
, 
‹ig
->pathSegments);

1239 
	`c⁄ˇtSigBlock
(
√w
->
sigBlocks
, 
‹ig
->sigBlocks);

1241 i‡((
√w
 =
NULL
Ë&& 
√wIfNULL
)

1243 
√w
 = 
	`bgp£c_∑th_©å_√w
();

1246  
√w
;

1247 
	}
}

1249 
	$c⁄ˇtSigSegmít
(
SigSegmít
* c⁄° 
√w
, SigSegmíà* c⁄° 
‹ig
)

1251 
SigSegmít
 *
§c
 = 
‹ig
;

1252 
SigSegmít
 *
≤t
 = 
√w
;

1254 
≤t
)

1257 
≤t
->
ski
 = 
	`ˇŒoc
 (1, 
BGPSEC_SKI_LENGTH
);

1258 
	`as£π
(
§c
->
ski
);

1259 
	`mem˝y
(
≤t
->
ski
, 
§c
->ski, 
BGPSEC_SKI_LENGTH
);

1261 
≤t
->
sigLí
 = 
§c
->sigLen;

1264 
≤t
->
sig«tuª
 = 
	`ˇŒoc
 (1, 
§c
->
sigLí
);

1265 
	`as£π
(
§c
->
sig«tuª
);

1266 
	`mem˝y
(
≤t
->
sig«tuª
, 
§c
->sig«tuª, src->
sigLí
);

1268 if(
§c
->
√xt
)

1270 
§c
 = src->
√xt
;

1271 
≤t
->
√xt
 = 
	`sigSegmít_New
();

1274 
≤t
 =Ö¡->
√xt
;

1277 
	}
}

1279 
	$c⁄ˇtSigBlock
(
SigBlock
* c⁄° 
√w
, SigBlock * c⁄° 
‹ig
)

1282 
SigBlock
 *
§c
 = 
‹ig
;

1283 
SigBlock
 *
≤t
 = 
√w
;

1285 
≤t
)

1287 
≤t
->
sigBlockLí
 = 
§c
->sigBlockLen;

1288 
≤t
->
ÆgoSuôeId
 = 
§c
->algoSuiteId;

1290 
	`c⁄ˇtSigSegmít
(
≤t
->
sigSegmíts
, 
§c
->sigSegments);

1292 if(
§c
->
√xt
)

1294 
§c
 = src->
√xt
;

1295 
≤t
->
√xt
 = 
	`sigBlock_New
();

1298 
≤t
 =Ö¡->
√xt
;

1301 
	}
}

1303 
	$c⁄ˇtP©hSegmít
(
P©hSegmít
 * c⁄° 
√w_£g
,

1304 
P©hSegmít
 * c⁄° 
‹ig
)

1308 
P©hSegmít
 *
§c
 = 
‹ig
;

1309 
P©hSegmít
 *
≤tSeg
 = 
√w_£g
;

1311 
≤tSeg
)

1313 
≤tSeg
->
as
 = 
§c
->as;

1314 
≤tSeg
->
pCou¡
 = 
§c
->pCount;

1315 
≤tSeg
->
Êags
 = 
§c
->flags;

1317 if(
§c
->
√xt
)

1319 
§c
 = src->
√xt
;

1320 
≤tSeg
->
√xt
 = 
	`∑thSegmít_New
();

1323 
≤tSeg
 =Ö¡Seg->
√xt
;

1326 
	}
}

1336 
	#CHAR_CONV_CONST
 0x37

	)

1337 
	#DIGIT_CONV_CONST
 0x30

	)

1338 
	#LEN_BYTE_NIBBLE
 0x02

	)

1340 
	$hex2bö_byã
(* 
ö
)

1342 
ªsu…
=0;

1343 
i
=0;

1344 
i
=0; i < 
LEN_BYTE_NIBBLE
; i++)

1346 if(
ö
[
i
] > 0x40)

1347 
ªsu…
 |((
ö
[
i
] - 
CHAR_CONV_CONST
) & 0x0f) << (4-(i*4));

1348 if(
ö
[
i
] > 0x30 && in[i] < 0x40)

1349 
ªsu…
 |(
ö
[
i
] - 
DIGIT_CONV_CONST
) << (4-(i*4));

1351  
ªsu…
;

1352 
	}
}

1362 
	$‰ìSCA_HashMesßge
(
SCA_HashMesßge
* 
mesßge
)

1364 i‡(
g_ˇpi
 !
NULL
)

1366 i‡(
g_ˇpi
->
	`‰ìHashMesßge
(
mesßge
))

1368 
mesßge
 = 
NULL
;

1371 i‡(
mesßge
 !
NULL
)

1373 
	`sˇ_‰ìHashI≈ut
(
mesßge
);

1375 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_validate.h

35 #i‚de‡
_QUAGGA_BGP_VALIDATE_H


36 
	#_QUAGGA_BGP_VALIDATE_H


	)

38 #ifde‡
USE_SRX


40 
	#BGPSEC_SKI_LENGTH
 20

	)

41 
	#BGPSEC_ALGO_ID
 1

	)

42 
	#BGPSEC_ALGO_ID_LENGTH
 1

	)

43 
	#BGPSEC_MAX_SIG_LENGTH
 128

	)

44 
	#BGPSEC_AFI_LENGTH
 1

	)

45 
	#BGPSEC_MAX_INFO_ATTR_LENGTH
 0

	)

48 
	#BGPSEC_SUCCESS
 0

	)

49 
	#BGPSEC_FAILURE
 -1

	)

51 
	#BGPSEC_ALGORITHM_SHA256_ECDSA_P_256
 1

	)

52 
	#BGPSEC_OPENSSL_ID_SHA256_ECDSA_P_256
 
NID_X9_62_¥ime256v1


	)

53 
	#BGPSEC_DEFAULT_CURVE
 
BGPSEC_ALGORITHM_SHA256_ECDSA_P_256


	)

56 
	#BGPSEC_VERIFY_ERROR
 -1

	)

57 
	#BGPSEC_VERIFY_INVALID
 0

	)

58 
	#BGPSEC_VERIFY_SUCCESS
 1

	)

60 
	#BGPSEC_MAX_SIGBLOCK
 2

	)

62 
	#OCTET_SECURE_PATH_SEGMENT
 6

	)

63 
	#OCTET_SECURE_PATH_LEN
 2

	)

64 
	#OCTET_ALGORITHM_ID
 1

	)

65 
	#OCTET_SIG_BLOCK_LEN
 2

	)

66 
	#OCTET_SIGNATURE_LEN
 2

	)

69 
	sP©hSegmít


71 
P©hSegmít
 *
	m√xt
;

72 
u_öt32_t
 
	mas
;

73 
u_öt8_t
 
	mpCou¡
;

74 
u_öt8_t
 
	mÊags
;

75 
	mªf˙t
;

78 
	sSigSegmít


80 
SigSegmít
 *
	m√xt
;

81 
u_ch¨
 *
	mski
;

82 
u_öt16_t
 
	msigLí
;

83 
u_ch¨
 *
	msig«tuª
;

84 
	mªf˙t
;

87 
	sSigBlock


89 
SigBlock
 *
	m√xt
;

90 
u_öt16_t
 
	msigBlockLí
;

91 
u_öt8_t
 
	mÆgoSuôeId
;

92 
SigSegmít
 *
	msigSegmíts
;

93 
	mªf˙t
;

97 
	sBgp£cP©hAâr


99 
size_t
 
	m£cuªP©hLí
;

102 
P©hSegmít
 *
	m∑thSegmíts
;

103 
SigBlock
 *
	msigBlocks
;

106 
	mªf˙t
;

111 
	sBgp£cPdu


113 
size_t
 
	mÀn_SecuªP©h
;

114 
u_öt8_t
 
	mpCou¡
;

115 
u_öt8_t
 
	mÊags
;

116 
u_öt32_t
 
	masNum
;

117 
u_öt16_t
 
	mÀn_SigBlock
;

118 
u_öt8_t
 
	mÆgoSuôeId
;

119 
u_ch¨
 *
	mski
;

120 
u_öt16_t
 
	mÀn_Sig
;

121 
u_ch¨
 *
	msig«tuª
;

125 
ölöe
 

126 
	$put_u32
(*
p
, 
u_öt32_t
 
x
)

128 
x
 = 
	`ht⁄l
(x);

129 
	`mem˝y
(
p
, &
x
, 4);

130 
	}
}

132 
bgp£cSignD©aWôhAsciiSKI
();

133 
Bgp£cP©hAâr
 *
bgp£c_∑th_öã∫
 (Bgp£cP©hAâ∏*
b∑
);

134 
bgp£c_∑th_unöã∫
 (
Bgp£cP©hAâr
 **
pb∑
);

135 
bgp£c_∑th_‰ì
 (
Bgp£cP©hAâr
 *
b∑
);

136 
bgp£c_∑th_©å_föish
 ();

137 
bgp£c_∑th_©å_öô
 ();

143 
SRxCry±oAPI
* 
gëSrxCAPI
();

144 
bgp£c_∑th_©å_cmp
 (c⁄° *
¨g1
, c⁄° *
¨g2
);

145 
bgp£c_∑th_©å_key_make
 (*
p
);

157 
Bgp£cP©hAâr
 * 
bgp£cDup
(Bgp£cP©hAâ∏*
‹ig
, 
boﬁ
 
√wIfNULL
);

159 
c⁄ˇtP©hSegmít
(
P©hSegmít
 * const , PathSegment * const);

160 
c⁄ˇtSigSegmít
(
SigSegmít
* const , SigSegment * const);

161 
c⁄ˇtSigBlock
(
SigBlock
* const , SigBlock * const);

174 
bgp£cVîifyCÆÀr
(
≥î
 *≥î, 
©å
 *attr,

175 
¥efix
 
p
, 
sˇ_°©us_t
* 
°©us
);

192 
c⁄°ru˘BGPSecP©hAâribuã
(
bgp
 *bgp, 
≥î
 *peer,

193 
a•©h
 *a•©h, 
¥efix
* 
p
,

194 
°ªam
 *
s
, 
©å
 *attr,

195 
u_öt8_t
 
Êags
, u_öt8_à
pCou¡
,

196 
SCA_Sig«tuª
** 
sig«tuª
, 
numSig«tuªs
);

198 
bgp£cS™ôyCheck
(
Bgp£cP©hAâr
 *);

213 
Bgp£cP©hAâr
* 
bgp£c_∑r£
(
©å
 *©å, 
≥î
 *peer,

214 
°ªam
* 
s
, 
size_t
 
Àngth
);

233 
SCA_Sig«tuª
* 
signBGPSecP©hAâr
(
bgp
* bgp, 
≥î
*Öeer,

234 
¥efix
* 
pfx
, 
©å
*áttr,

235 
u_öt8_t
 
pCou¡
, u_öt8_à
Êags
);

245 
‰ìSCA_HashMesßge
(
SCA_HashMesßge
* 
mesßge
);

249 
ã°_¥öt
(
Bgp£cPdu
 , 
size_t
 *, *, * , size_t );

250 
¥öt_sig«tuª
(
Bgp£cP©hAâr
 *);

251 
hex2bö_byã
(* );

254 
	#GEN_SKI_ASCII
(
buf
, 
ski
, 
ski_Àn
) \

256 * 
˝
 = 
buf
; \

257 
i
; \

258 
i
=0; i<
ski_Àn
; i++) { \

259 
	`•rötf
(
˝
, "%02X", (
u_öt8_t
)
ski
[
i
]); \

260 
˝
+=2; \

262 
buf
[(buf)-1] = '\0'; \

263 } 0)

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_vty.c

21 
	~<zebø.h
>

22 #ifde‡
USE_SRX


23 
	~<§x/§x¸y±ﬂpi.h
>

26 
	~"comm™d.h
"

27 
	~"¥efix.h
"

28 
	~"∂i°.h
"

29 
	~"buf„r.h
"

30 
	~"lökli°.h
"

31 
	~"°ªam.h
"

32 
	~"thªad.h
"

33 
	~"log.h
"

34 
	~"mem‹y.h
"

35 
	~"hash.h
"

37 
	~"bgpd/bgpd.h
"

38 
	~"bgpd/bgp_advîti£.h
"

39 
	~"bgpd/bgp_©å.h
"

40 
	~"bgpd/bgp_a•©h.h
"

41 
	~"bgpd/bgp_communôy.h
"

42 
	~"bgpd/bgp_ecommunôy.h
"

43 
	~"bgpd/bgp_damp.h
"

44 
	~"bgpd/bgp_debug.h
"

45 
	~"bgpd/bgp_fsm.h
"

46 
	~"bgpd/bgp_m∂sv≤.h
"

47 
	~"bgpd/bgp_√xth›.h
"

48 
	~"bgpd/bgp_›í.h
"

49 
	~"bgpd/bgp_ªgex.h
"

50 
	~"bgpd/bgp_rouã.h
"

51 
	~"bgpd/bgp_zebø.h
"

52 
	~"bgpd/bgp_èbÀ.h
"

53 
	~"bgpd/bgp_vty.h
"

54 
	~"bgpd/bgp_m∑th.h
"

55 
	~"bgp_vÆid©e.h
"

57 
ö_addr
 
rouãr_id_zebø
;

60 
afi_t


61 
	$bgp_node_afi
 (
vty
 *vty)

63 i‡(
vty
->
node
 =
BGP_IPV6_NODE
 || vty->nodê=
BGP_IPV6M_NODE
)

64  
AFI_IP6
;

65  
AFI_IP
;

66 
	}
}

70 
ßfi_t


71 
	$bgp_node_ßfi
 (
vty
 *vty)

73 i‡(
vty
->
node
 =
BGP_VPNV4_NODE
)

74  
SAFI_MPLS_VPN
;

75 i‡(
vty
->
node
 =
BGP_IPV4M_NODE
 || vty->nodê=
BGP_IPV6M_NODE
)

76  
SAFI_MULTICAST
;

77  
SAFI_UNICAST
;

78 
	}
}

81 
	$≥î_addªss_£lf_check
 (
sockuni⁄
 *
su
)

83 
öãrÁ˚
 *
iÂ
 = 
NULL
;

85 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET
)

86 
iÂ
 = 
	`if_lookup_by_ùv4_exa˘
 (&
su
->
sö
.
sö_addr
);

87 #ifde‡
HAVE_IPV6


88 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET6
)

89 
iÂ
 = 
	`if_lookup_by_ùv6_exa˘
 (&
su
->
sö6
.
sö6_addr
);

92 i‡(
iÂ
)

96 
	}
}

99 
≥î
 *

100 
	$≥î_lookup_vty
 (
vty
 *vty, c⁄° *
ù_°r
)

102 
ªt
;

103 
bgp
 *bgp;

104 
sockuni⁄
 
su
;

105 
≥î
 *peer;

107 
bgp
 = 
vty
->
ödex
;

109 
ªt
 = 
	`°r2sockuni⁄
 (
ù_°r
, &
su
);

110 i‡(
ªt
 < 0)

112 
	`vty_out
 (
vty
, "%% MÆf‹medáddªss: %s%s", 
ù_°r
, 
VTY_NEWLINE
);

113  
NULL
;

116 
≥î
 = 
	`≥î_lookup
 (
bgp
, &
su
);

117 i‡(! 
≥î
)

119 
	`vty_out
 (
vty
, "%% S≥cifyÑemŸe-a†‹Öìr-grou∞comm™d†fú°%s", 
VTY_NEWLINE
);

120  
NULL
;

122  
≥î
;

123 
	}
}

126 
≥î
 *

127 
	$≥î_™d_group_lookup_vty
 (
vty
 *vty, c⁄° *
≥î_°r
)

129 
ªt
;

130 
bgp
 *bgp;

131 
sockuni⁄
 
su
;

132 
≥î
 *peer;

133 
≥î_group
 *
group
;

135 
bgp
 = 
vty
->
ödex
;

137 
ªt
 = 
	`°r2sockuni⁄
 (
≥î_°r
, &
su
);

138 i‡(
ªt
 == 0)

140 
≥î
 = 
	`≥î_lookup
 (
bgp
, &
su
);

141 i‡(
≥î
)

142  
≥î
;

146 
group
 = 
	`≥î_group_lookup
 (
bgp
, 
≥î_°r
);

147 i‡(
group
)

148  
group
->
c⁄f
;

151 
	`vty_out
 (
vty
, "%% SpecifyÑemote-as orÖeer-group commands first%s",

152 
VTY_NEWLINE
);

154  
NULL
;

155 
	}
}

158 
	$bgp_vty_ªtu∫
 (
vty
 *vty, 
ªt
)

160 c⁄° *
°r
 = 
NULL
;

162 
ªt
)

164 
BGP_ERR_INVALID_VALUE
:

165 
°r
 = "Invalid value";

167 
BGP_ERR_INVALID_FLAG
:

168 
°r
 = "Invalid flag";

170 
BGP_ERR_PEER_INACTIVE
:

171 
°r
 = "ActivateÅheÇeighbor forÅheáddress family first";

173 
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
:

174 
°r
 = "Invalid command foráÖeer-group member";

176 
BGP_ERR_PEER_GROUP_SHUTDOWN
:

177 
°r
 = "Peer-group has been shutdown. ActivateÅheÖeer-group first";

179 
BGP_ERR_PEER_GROUP_HAS_THE_FLAG
:

180 
°r
 = "ThisÖeer isáÖeer-group member. Please changeÖeer-group configuration";

182 
BGP_ERR_PEER_FLAG_CONFLICT
:

183 
°r
 = "Can't set override-capabilityánd strict-capability-matchátÅhe sameÅime";

185 
BGP_ERR_PEER_GROUP_MEMBER_EXISTS
:

186 
°r
 = "Noáctivate forÖeergroup can be given only ifÖeer-group hasÇo members";

188 
BGP_ERR_PEER_BELONGS_TO_GROUP
:

189 
°r
 = "Noáctivate forán individualÖeer-group member is invalid";

191 
BGP_ERR_PEER_GROUP_AF_UNCONFIGURED
:

192 
°r
 = "ActivateÅheÖeer-group forÅheáddress family first";

194 
BGP_ERR_PEER_GROUP_NO_REMOTE_AS
:

195 
°r
 = "SpecifyÑemote-as orÖeer-groupÑemote AS first";

197 
BGP_ERR_PEER_GROUP_CANT_CHANGE
:

198 
°r
 = "Cannot changeÅheÖeer-group. Deconfigure first";

200 
BGP_ERR_PEER_GROUP_MISMATCH
:

201 
°r
 = "Cannot have differentÖeer-group forÅheÇeighbor";

203 
BGP_ERR_PEER_FILTER_CONFLICT
:

204 
°r
 = "Prefix/distributeÜist canÇot co-exist";

206 
BGP_ERR_NOT_INTERNAL_PEER
:

207 
°r
 = "Invalid command. Notán internalÇeighbor";

209 
BGP_ERR_REMOVE_PRIVATE_AS
:

210 
°r
 = "Private AS cannot beÑemoved for IBGPÖeers";

212 
BGP_ERR_LOCAL_AS_ALLOWED_ONLY_FOR_EBGP
:

213 
°r
 = "Local-ASállowed only for EBGPÖeers";

215 
BGP_ERR_CANNOT_HAVE_LOCAL_AS_SAME_AS
:

216 
°r
 = "Cannot haveÜocal-as sameás BGP ASÇumber";

218 
BGP_ERR_TCPSIG_FAILED
:

219 
°r
 = "Error whileápplying TCP-SigÅo session(s)";

221 
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
:

222 
°r
 = "ebgp-multihopándÅtl-security cannot be configuredÅogether";

224 
BGP_ERR_NO_IBGP_WITH_TTLHACK
:

225 
°r
 = "ttl-security onlyállowed for EBGPÖeers";

228 i‡(
°r
)

230 
	`vty_out
 (
vty
, "%% %s%s", 
°r
, 
VTY_NEWLINE
);

231  
CMD_WARNING
;

233  
CMD_SUCCESS
;

234 
	}
}

238 
DEFUN
 (
bgp_mu…ùÀ_ö°™˚_func
,

239 
bgp_mu…ùÀ_ö°™˚_cmd
,

241 
BGP_STR


244 
bgp_›ti⁄_£t
 (
BGP_OPT_MULTIPLE_INSTANCE
);

245  
	gCMD_SUCCESS
;

248 
DEFUN
 (
no_bgp_mu…ùÀ_ö°™˚
,

249 
no_bgp_mu…ùÀ_ö°™˚_cmd
,

251 
NO_STR


252 
BGP_STR


255 
	gªt
;

257 
	gªt
 = 
bgp_›ti⁄_un£t
 (
BGP_OPT_MULTIPLE_INSTANCE
);

258 i‡(
	gªt
 < 0)

260 
vty_out
 (
vty
, "%% Thîê¨êm‹êth™ÅwÿBGP in°™˚s%s", 
VTY_NEWLINE
);

261  
	gCMD_WARNING
;

263  
	gCMD_SUCCESS
;

266 
DEFUN
 (
bgp_c⁄fig_ty≥
,

267 
bgp_c⁄fig_ty≥_cmd
,

269 
BGP_STR


274 i‡(
°∫cmp
 (
¨gv
[0], "c", 1) == 0)

275 
bgp_›ti⁄_£t
 (
BGP_OPT_CONFIG_CISCO
);

277 
bgp_›ti⁄_un£t
 (
BGP_OPT_CONFIG_CISCO
);

279  
	gCMD_SUCCESS
;

282 
DEFUN
 (
no_bgp_c⁄fig_ty≥
,

283 
no_bgp_c⁄fig_ty≥_cmd
,

285 
NO_STR


286 
BGP_STR


289 
bgp_›ti⁄_un£t
 (
BGP_OPT_CONFIG_CISCO
);

290  
	gCMD_SUCCESS
;

293 
DEFUN
 (
no_synchr⁄iz©i⁄
,

294 
no_synchr⁄iz©i⁄_cmd
,

296 
NO_STR


299  
	gCMD_SUCCESS
;

302 
DEFUN
 (
no_auto_summ¨y
,

303 
no_auto_summ¨y_cmd
,

305 
NO_STR


308  
	gCMD_SUCCESS
;

311 
DEFUN_DEPRECATED
 (
√ighb‹_vîsi⁄
,

312 
√ighb‹_vîsi⁄_cmd
,

313 
NEIGHBOR_CMD
 "version (4|4-)",

314 
NEIGHBOR_STR


315 
NEIGHBOR_ADDR_STR


319  
	gCMD_SUCCESS
;

323 
DEFUN
 (
rouãr_bgp
,

324 
rouãr_bgp_cmd
,

325 "rouã∏bg∞" 
CMD_AS_RANGE
,

326 
ROUTER_STR


327 
BGP_STR


328 
AS_STR
)

330 
	gªt
;

331 
as_t
 
	gas
;

332 
bgp
 *
	gbgp
;

333 c⁄° *
	g«me
 = 
NULL
;

335 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[0], 1, 
BGP_AS4_MAX
);

337 i‡(
	g¨gc
 == 2)

338 
«me
 = 
¨gv
[1];

340 
	gªt
 = 
bgp_gë
 (&
bgp
, &
as
, 
«me
);

341 
	gªt
)

343 
	gBGP_ERR_MULTIPLE_INSTANCE_NOT_SET
:

344 
vty_out
 (
vty
, "Please specify 'bgp multiple-instance' first%s",

345 
VTY_NEWLINE
);

346  
	gCMD_WARNING
;

347 
	gBGP_ERR_AS_MISMATCH
:

348 
vty_out
 (
vty
, "BGP i†ÆªadyÑu¬ög; AS i†%u%s", 
as
, 
VTY_NEWLINE
);

349  
	gCMD_WARNING
;

350 
	gBGP_ERR_INSTANCE_MISMATCH
:

351 
vty_out
 (
vty
, "BGP võwÇamê™d ASÇumbî mism©ch%s", 
VTY_NEWLINE
);

352 
vty_out
 (
vty
, "BGP instance isálreadyÑunning; AS is %u%s",

353 
as
, 
VTY_NEWLINE
);

354  
	gCMD_WARNING
;

357 
	gvty
->
	gnode
 = 
BGP_NODE
;

358 
	gvty
->
	gödex
 = 
bgp
;

360  
	gCMD_SUCCESS
;

363 
ALIAS
 (
rouãr_bgp
,

364 
rouãr_bgp_võw_cmd
,

365 "rouã∏bg∞" 
CMD_AS_RANGE
 " view WORD",

366 
ROUTER_STR


367 
BGP_STR


368 
AS_STR


373 
DEFUN
 (
no_rouãr_bgp
,

374 
no_rouãr_bgp_cmd
,

375 "nÿrouã∏bg∞" 
CMD_AS_RANGE
,

376 
NO_STR


377 
ROUTER_STR


378 
BGP_STR


379 
AS_STR
)

381 
as_t
 
	gas
;

382 
bgp
 *
	gbgp
;

383 c⁄° *
	g«me
 = 
NULL
;

385 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[0], 1, 
BGP_AS4_MAX
);

387 i‡(
	g¨gc
 == 2)

388 
«me
 = 
¨gv
[1];

391 
	gbgp
 = 
bgp_lookup
 (
as
, 
«me
);

392 i‡(! 
	gbgp
)

394 
vty_out
 (
vty
, "%% C™'àföd BGP in°™˚%s", 
VTY_NEWLINE
);

395  
	gCMD_WARNING
;

398 
bgp_dñëe
 (
bgp
);

400  
	gCMD_SUCCESS
;

403 
ALIAS
 (
no_rouãr_bgp
,

404 
no_rouãr_bgp_võw_cmd
,

405 "nÿrouã∏bg∞" 
CMD_AS_RANGE
 " view WORD",

406 
NO_STR


407 
ROUTER_STR


408 
BGP_STR


409 
AS_STR


415 
DEFUN
 (
bgp_rouãr_id
,

416 
bgp_rouãr_id_cmd
,

418 
BGP_STR


422 
	gªt
;

423 
ö_addr
 
	gid
;

424 
bgp
 *
	gbgp
;

426 
	gbgp
 = 
vty
->
ödex
;

428 
	gªt
 = 
öë_©⁄
 (
¨gv
[0], &
id
);

429 i‡(! 
	gªt
)

431 
vty_out
 (
vty
, "%% MÆf‹med bg∞rouã∏idítifõr%s", 
VTY_NEWLINE
);

432  
	gCMD_WARNING
;

435 
	gbgp
->
	grouãr_id_°©ic
 = 
id
;

436 
bgp_rouãr_id_£t
 (
bgp
, &
id
);

438  
	gCMD_SUCCESS
;

441 
DEFUN
 (
no_bgp_rouãr_id
,

442 
no_bgp_rouãr_id_cmd
,

444 
NO_STR


445 
BGP_STR


448 
	gªt
;

449 
ö_addr
 
	gid
;

450 
bgp
 *
	gbgp
;

452 
	gbgp
 = 
vty
->
ödex
;

454 i‡(
	g¨gc
 == 1)

456 
ªt
 = 
öë_©⁄
 (
¨gv
[0], &
id
);

457 i‡(! 
	gªt
)

459 
vty_out
 (
vty
, "%% MÆf‹med BGPÑouã∏idítifõr%s", 
VTY_NEWLINE
);

460  
	gCMD_WARNING
;

463 i‡(! 
IPV4_ADDR_SAME
 (&
bgp
->
rouãr_id_°©ic
, &
id
))

465 
vty_out
 (
vty
, "%% BGPÑouãr-id d€¢'àm©ch%s", 
VTY_NEWLINE
);

466  
	gCMD_WARNING
;

470 
	gbgp
->
	grouãr_id_°©ic
.
	gs_addr
 = 0;

471 
bgp_rouãr_id_£t
 (
bgp
, &
rouãr_id_zebø
);

473  
	gCMD_SUCCESS
;

476 
ALIAS
 (
no_bgp_rouãr_id
,

477 
no_bgp_rouãr_id_vÆ_cmd
,

479 
NO_STR


480 
BGP_STR


486 
DEFUN
 (
bgp_˛u°î_id
,

487 
bgp_˛u°î_id_cmd
,

489 
BGP_STR


493 
	gªt
;

494 
bgp
 *
	gbgp
;

495 
ö_addr
 
	g˛u°î
;

497 
	gbgp
 = 
vty
->
ödex
;

499 
	gªt
 = 
öë_©⁄
 (
¨gv
[0], &
˛u°î
);

500 i‡(! 
	gªt
)

502 
vty_out
 (
vty
, "%% MÆf‹med bg∞˛u°î idítifõr%s", 
VTY_NEWLINE
);

503  
	gCMD_WARNING
;

506 
bgp_˛u°î_id_£t
 (
bgp
, &
˛u°î
);

508  
	gCMD_SUCCESS
;

511 
ALIAS
 (
bgp_˛u°î_id
,

512 
bgp_˛u°î_id32_cmd
,

514 
BGP_STR


518 
DEFUN
 (
no_bgp_˛u°î_id
,

519 
no_bgp_˛u°î_id_cmd
,

521 
NO_STR


522 
BGP_STR


525 
	gªt
;

526 
bgp
 *
	gbgp
;

527 
ö_addr
 
	g˛u°î
;

529 
	gbgp
 = 
vty
->
ödex
;

531 i‡(
	g¨gc
 == 1)

533 
ªt
 = 
öë_©⁄
 (
¨gv
[0], &
˛u°î
);

534 i‡(! 
	gªt
)

536 
vty_out
 (
vty
, "%% MÆf‹med bg∞˛u°î idítifõr%s", 
VTY_NEWLINE
);

537  
	gCMD_WARNING
;

541 
bgp_˛u°î_id_un£t
 (
bgp
);

543  
	gCMD_SUCCESS
;

546 
ALIAS
 (
no_bgp_˛u°î_id
,

547 
no_bgp_˛u°î_id_¨g_cmd
,

549 
NO_STR


550 
BGP_STR


554 
DEFUN
 (
bgp_c⁄„dî©i⁄_idítifõr
,

555 
bgp_c⁄„dî©i⁄_idítifõr_cmd
,

556 "bg∞c⁄„dî©i⁄ idítifõ∏" 
CMD_AS_RANGE
,

562 
bgp
 *
	gbgp
;

563 
as_t
 
	gas
;

565 
	gbgp
 = 
vty
->
ödex
;

567 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[0], 1, 
BGP_AS4_MAX
);

569 
bgp_c⁄„dî©i⁄_id_£t
 (
bgp
, 
as
);

571  
	gCMD_SUCCESS
;

574 
DEFUN
 (
no_bgp_c⁄„dî©i⁄_idítifõr
,

575 
no_bgp_c⁄„dî©i⁄_idítifõr_cmd
,

577 
NO_STR


582 
bgp
 *
	gbgp
;

583 
as_t
 
	gas
;

585 
	gbgp
 = 
vty
->
ödex
;

587 i‡(
	g¨gc
 == 1)

588 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[0], 1, 
BGP_AS4_MAX
);

590 
bgp_c⁄„dî©i⁄_id_un£t
 (
bgp
);

592  
	gCMD_SUCCESS
;

595 
ALIAS
 (
no_bgp_c⁄„dî©i⁄_idítifõr
,

596 
no_bgp_c⁄„dî©i⁄_idítifõr_¨g_cmd
,

597 "nÿbg∞c⁄„dî©i⁄ idítifõ∏" 
CMD_AS_RANGE
,

598 
NO_STR


604 
DEFUN
 (
bgp_c⁄„dî©i⁄_≥îs
,

605 
bgp_c⁄„dî©i⁄_≥îs_cmd
,

606 "bg∞c⁄„dî©i⁄Öìr†." 
CMD_AS_RANGE
,

610 
AS_STR
)

612 
bgp
 *
	gbgp
;

613 
as_t
 
	gas
;

614 
	gi
;

616 
	gbgp
 = 
vty
->
ödex
;

618 
	gi
 = 0; i < 
	g¨gc
; i++)

620 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[
i
], 1, 
BGP_AS4_MAX
);

622 i‡(
	gbgp
->
	gas
 =
as
)

624 
vty_out
 (
vty
, "%% Local member-ASÇotállowed in confedÖeerÜist%s",

625 
VTY_NEWLINE
);

629 
bgp_c⁄„dî©i⁄_≥îs_add
 (
bgp
, 
as
);

631  
	gCMD_SUCCESS
;

634 
DEFUN
 (
no_bgp_c⁄„dî©i⁄_≥îs
,

635 
no_bgp_c⁄„dî©i⁄_≥îs_cmd
,

636 "nÿbg∞c⁄„dî©i⁄Öìr†." 
CMD_AS_RANGE
,

637 
NO_STR


641 
AS_STR
)

643 
bgp
 *
	gbgp
;

644 
as_t
 
	gas
;

645 
	gi
;

647 
	gbgp
 = 
vty
->
ödex
;

649 
	gi
 = 0; i < 
	g¨gc
; i++)

651 
VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨gv
[
i
], 1, 
BGP_AS4_MAX
);

653 
bgp_c⁄„dî©i⁄_≥îs_ªmove
 (
bgp
, 
as
);

655  
	gCMD_SUCCESS
;

659 
DEFUN
 (
bgp_max∑ths
,

660 
bgp_max∑ths_cmd
,

665 
bgp
 *
	gbgp
;

666 
u_öt16_t
 
	gmax∑ths
;

667 
	gªt
;

669 
	gbgp
 = 
vty
->
ödex
;

671 
VTY_GET_INTEGER_RANGE
 ("maximum-∑ths", 
max∑ths
, 
¨gv
[0], 1, 255);

673 
	gªt
 = 
bgp_maximum_∑ths_£t
 (
bgp
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty),

674 
BGP_PEER_EBGP
, 
max∑ths
);

675 i‡(
	gªt
 < 0)

677 
vty_out
 (
vty
,

679 
max∑ths
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty), 
VTY_NEWLINE
);

680  
	gCMD_WARNING
;

683  
	gCMD_SUCCESS
;

686 
DEFUN
 (
bgp_max∑ths_ibgp
,

687 
bgp_max∑ths_ibgp_cmd
,

693 
bgp
 *
	gbgp
;

694 
u_öt16_t
 
	gmax∑ths
;

695 
	gªt
;

697 
	gbgp
 = 
vty
->
ödex
;

699 
VTY_GET_INTEGER_RANGE
 ("maximum-∑ths", 
max∑ths
, 
¨gv
[0], 1, 255);

701 
	gªt
 = 
bgp_maximum_∑ths_£t
 (
bgp
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty),

702 
BGP_PEER_IBGP
, 
max∑ths
);

703 i‡(
	gªt
 < 0)

705 
vty_out
 (
vty
,

707 
max∑ths
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty), 
VTY_NEWLINE
);

708  
	gCMD_WARNING
;

711  
	gCMD_SUCCESS
;

714 
DEFUN
 (
no_bgp_max∑ths
,

715 
no_bgp_max∑ths_cmd
,

717 
NO_STR


721 
bgp
 *
	gbgp
;

722 
	gªt
;

724 
	gbgp
 = 
vty
->
ödex
;

726 
	gªt
 = 
bgp_maximum_∑ths_un£t
 (
bgp
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty),

727 
BGP_PEER_EBGP
);

728 i‡(
	gªt
 < 0)

730 
vty_out
 (
vty
,

732 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty), 
VTY_NEWLINE
);

733  
	gCMD_WARNING
;

736  
	gCMD_SUCCESS
;

739 
ALIAS
 (
no_bgp_max∑ths
,

740 
no_bgp_max∑ths_¨g_cmd
,

742 
NO_STR


746 
DEFUN
 (
no_bgp_max∑ths_ibgp
,

747 
no_bgp_max∑ths_ibgp_cmd
,

749 
NO_STR


754 
bgp
 *
	gbgp
;

755 
	gªt
;

757 
	gbgp
 = 
vty
->
ödex
;

759 
	gªt
 = 
bgp_maximum_∑ths_un£t
 (
bgp
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty),

760 
BGP_PEER_IBGP
);

761 i‡(
	gªt
 < 0)

763 
vty_out
 (
vty
,

765 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
(vty), 
VTY_NEWLINE
);

766  
	gCMD_WARNING
;

769  
	gCMD_SUCCESS
;

772 
ALIAS
 (
no_bgp_max∑ths_ibgp
,

773 
no_bgp_max∑ths_ibgp_¨g_cmd
,

775 
NO_STR


781 
	$bgp_c⁄fig_wrôe_max∑ths
 (
vty
 *vty, 
bgp
 *bgp, 
afi_t
 
afi
,

782 
ßfi_t
 
ßfi
, *
wrôe
)

784 i‡(
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ebgp
 !
BGP_DEFAULT_MAXPATHS
)

786 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, 
wrôe
);

787 
	`vty_out
 (
vty
, " maximum-paths %d%s",

788 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ebgp
, 
VTY_NEWLINE
);

791 i‡(
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ibgp
 !
BGP_DEFAULT_MAXPATHS
)

793 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, 
wrôe
);

794 
	`vty_out
 (
vty
, " maximum-paths ibgp %d%s",

795 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ibgp
, 
VTY_NEWLINE
);

799 
	}
}

803 
DEFUN
 (
bgp_timîs
,

804 
bgp_timîs_cmd
,

811 
bgp
 *
	gbgp
;

812 
	gkì∑live
 = 0;

813 
	ghﬁdtime
 = 0;

815 
	gbgp
 = 
vty
->
ödex
;

817 
VTY_GET_INTEGER
 ("kì∑live", 
kì∑live
, 
¨gv
[0]);

818 
VTY_GET_INTEGER
 ("hﬁdtime", 
hﬁdtime
, 
¨gv
[1]);

821 i‡(
	ghﬁdtime
 < 3 && holdtime != 0)

823 
vty_out
 (
vty
, "%% holdÅime value must beÉither 0 or greaterÅhan 3%s",

824 
VTY_NEWLINE
);

825  
	gCMD_WARNING
;

828 
bgp_timîs_£t
 (
bgp
, 
kì∑live
, 
hﬁdtime
);

830  
	gCMD_SUCCESS
;

833 
DEFUN
 (
no_bgp_timîs
,

834 
no_bgp_timîs_cmd
,

836 
NO_STR


840 
bgp
 *
	gbgp
;

842 
	gbgp
 = 
vty
->
ödex
;

843 
bgp_timîs_un£t
 (
bgp
);

845  
	gCMD_SUCCESS
;

848 
ALIAS
 (
no_bgp_timîs
,

849 
no_bgp_timîs_¨g_cmd
,

851 
NO_STR


857 
DEFUN
 (
bgp_˛õ¡_to_˛õ¡_ªÊe˘i⁄
,

858 
bgp_˛õ¡_to_˛õ¡_ªÊe˘i⁄_cmd
,

864 
bgp
 *
	gbgp
;

866 
	gbgp
 = 
vty
->
ödex
;

867 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_NO_CLIENT_TO_CLIENT
);

868  
	gCMD_SUCCESS
;

871 
DEFUN
 (
no_bgp_˛õ¡_to_˛õ¡_ªÊe˘i⁄
,

872 
no_bgp_˛õ¡_to_˛õ¡_ªÊe˘i⁄_cmd
,

874 
NO_STR


879 
bgp
 *
	gbgp
;

881 
	gbgp
 = 
vty
->
ödex
;

882 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_NO_CLIENT_TO_CLIENT
);

883  
	gCMD_SUCCESS
;

887 
DEFUN
 (
bgp_Æways_com∑ª_med
,

888 
bgp_Æways_com∑ª_med_cmd
,

893 
bgp
 *
	gbgp
;

895 
	gbgp
 = 
vty
->
ödex
;

896 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_ALWAYS_COMPARE_MED
);

897  
	gCMD_SUCCESS
;

900 
DEFUN
 (
no_bgp_Æways_com∑ª_med
,

901 
no_bgp_Æways_com∑ª_med_cmd
,

903 
NO_STR


907 
bgp
 *
	gbgp
;

909 
	gbgp
 = 
vty
->
ödex
;

910 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_ALWAYS_COMPARE_MED
);

911  
	gCMD_SUCCESS
;

915 
DEFUN
 (
bgp_dëîmöi°ic_med
,

916 
bgp_dëîmöi°ic_med_cmd
,

921 
bgp
 *
	gbgp
;

923 
	gbgp
 = 
vty
->
ödex
;

924 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
);

925  
	gCMD_SUCCESS
;

928 
DEFUN
 (
no_bgp_dëîmöi°ic_med
,

929 
no_bgp_dëîmöi°ic_med_cmd
,

931 
NO_STR


935 
bgp
 *
	gbgp
;

937 
	gbgp
 = 
vty
->
ödex
;

938 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
);

939  
	gCMD_SUCCESS
;

943 
DEFUN
 (
bgp_gø˚ful_ª°¨t
,

944 
bgp_gø˚ful_ª°¨t_cmd
,

949 
bgp
 *
	gbgp
;

951 
	gbgp
 = 
vty
->
ödex
;

952 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_GRACEFUL_RESTART
);

953  
	gCMD_SUCCESS
;

956 
DEFUN
 (
no_bgp_gø˚ful_ª°¨t
,

957 
no_bgp_gø˚ful_ª°¨t_cmd
,

959 
NO_STR


963 
bgp
 *
	gbgp
;

965 
	gbgp
 = 
vty
->
ödex
;

966 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_GRACEFUL_RESTART
);

967  
	gCMD_SUCCESS
;

970 
DEFUN
 (
bgp_gø˚ful_ª°¨t_°Æï©h_time
,

971 
bgp_gø˚ful_ª°¨t_°Æï©h_time_cmd
,

978 
bgp
 *
	gbgp
;

979 
u_öt32_t
 
	g°Æï©h
;

981 
	gbgp
 = 
vty
->
ödex
;

982 i‡(! 
	gbgp
)

983  
	gCMD_WARNING
;

985 
VTY_GET_INTEGER_RANGE
 ("°Æï©h-time", 
°Æï©h
, 
¨gv
[0], 1, 3600);

986 
	gbgp
->
	g°Æï©h_time
 = 
°Æï©h
;

987  
	gCMD_SUCCESS
;

990 
DEFUN
 (
no_bgp_gø˚ful_ª°¨t_°Æï©h_time
,

991 
no_bgp_gø˚ful_ª°¨t_°Æï©h_time_cmd
,

993 
NO_STR


998 
bgp
 *
	gbgp
;

1000 
	gbgp
 = 
vty
->
ödex
;

1001 i‡(! 
	gbgp
)

1002  
	gCMD_WARNING
;

1004 
	gbgp
->
	g°Æï©h_time
 = 
BGP_DEFAULT_STALEPATH_TIME
;

1005  
	gCMD_SUCCESS
;

1008 
ALIAS
 (
no_bgp_gø˚ful_ª°¨t_°Æï©h_time
,

1009 
no_bgp_gø˚ful_ª°¨t_°Æï©h_time_vÆ_cmd
,

1011 
NO_STR


1018 
DEFUN
 (
bgp_Á°_exã∫Æ_Áûovî
,

1019 
bgp_Á°_exã∫Æ_Áûovî_cmd
,

1021 
BGP_STR


1024 
bgp
 *
	gbgp
;

1026 
	gbgp
 = 
vty
->
ödex
;

1027 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_NO_FAST_EXT_FAILOVER
);

1028  
	gCMD_SUCCESS
;

1031 
DEFUN
 (
no_bgp_Á°_exã∫Æ_Áûovî
,

1032 
no_bgp_Á°_exã∫Æ_Áûovî_cmd
,

1034 
NO_STR


1035 
BGP_STR


1038 
bgp
 *
	gbgp
;

1040 
	gbgp
 = 
vty
->
ödex
;

1041 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_NO_FAST_EXT_FAILOVER
);

1042  
	gCMD_SUCCESS
;

1046 
DEFUN
 (
bgp_íf‹˚_fú°_as
,

1047 
bgp_íf‹˚_fú°_as_cmd
,

1049 
BGP_STR


1052 
bgp
 *
	gbgp
;

1054 
	gbgp
 = 
vty
->
ödex
;

1055 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_ENFORCE_FIRST_AS
);

1056  
	gCMD_SUCCESS
;

1059 
DEFUN
 (
no_bgp_íf‹˚_fú°_as
,

1060 
no_bgp_íf‹˚_fú°_as_cmd
,

1062 
NO_STR


1063 
BGP_STR


1066 
bgp
 *
	gbgp
;

1068 
	gbgp
 = 
vty
->
ödex
;

1069 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_ENFORCE_FIRST_AS
);

1070  
	gCMD_SUCCESS
;

1074 
DEFUN
 (
bgp_be°∑th_com∑ª_rouãr_id
,

1075 
bgp_be°∑th_com∑ª_rouãr_id_cmd
,

1081 
bgp
 *
	gbgp
;

1083 
	gbgp
 = 
vty
->
ödex
;

1084 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_COMPARE_ROUTER_ID
);

1085  
	gCMD_SUCCESS
;

1088 
DEFUN
 (
no_bgp_be°∑th_com∑ª_rouãr_id
,

1089 
no_bgp_be°∑th_com∑ª_rouãr_id_cmd
,

1091 
NO_STR


1096 
bgp
 *
	gbgp
;

1098 
	gbgp
 = 
vty
->
ödex
;

1099 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_COMPARE_ROUTER_ID
);

1100  
	gCMD_SUCCESS
;

1104 
DEFUN
 (
bgp_be°∑th_a•©h_ign‹e
,

1105 
bgp_be°∑th_a•©h_ign‹e_cmd
,

1112 
bgp
 *
	gbgp
;

1114 
	gbgp
 = 
vty
->
ödex
;

1115 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_ASPATH_IGNORE
);

1116  
	gCMD_SUCCESS
;

1119 
DEFUN
 (
no_bgp_be°∑th_a•©h_ign‹e
,

1120 
no_bgp_be°∑th_a•©h_ign‹e_cmd
,

1122 
NO_STR


1128 
bgp
 *
	gbgp
;

1130 
	gbgp
 = 
vty
->
ödex
;

1131 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_ASPATH_IGNORE
);

1132  
	gCMD_SUCCESS
;

1136 
DEFUN
 (
bgp_be°∑th_a•©h_c⁄„d
,

1137 
bgp_be°∑th_a•©h_c⁄„d_cmd
,

1144 
bgp
 *
	gbgp
;

1146 
	gbgp
 = 
vty
->
ödex
;

1147 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_ASPATH_CONFED
);

1148  
	gCMD_SUCCESS
;

1151 
DEFUN
 (
no_bgp_be°∑th_a•©h_c⁄„d
,

1152 
no_bgp_be°∑th_a•©h_c⁄„d_cmd
,

1154 
NO_STR


1160 
bgp
 *
	gbgp
;

1162 
	gbgp
 = 
vty
->
ödex
;

1163 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_ASPATH_CONFED
);

1164  
	gCMD_SUCCESS
;

1168 
DEFUN
 (
bgp_log_√ighb‹_ch™ges
,

1169 
bgp_log_√ighb‹_ch™ges_cmd
,

1174 
bgp
 *
	gbgp
;

1176 
	gbgp
 = 
vty
->
ödex
;

1177 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_LOG_NEIGHBOR_CHANGES
);

1178  
	gCMD_SUCCESS
;

1181 
DEFUN
 (
no_bgp_log_√ighb‹_ch™ges
,

1182 
no_bgp_log_√ighb‹_ch™ges_cmd
,

1184 
NO_STR


1188 
bgp
 *
	gbgp
;

1190 
	gbgp
 = 
vty
->
ödex
;

1191 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_LOG_NEIGHBOR_CHANGES
);

1192  
	gCMD_SUCCESS
;

1196 
DEFUN
 (
bgp_be°∑th_med
,

1197 
bgp_be°∑th_med_cmd
,

1205 
bgp
 *
	gbgp
;

1207 
	gbgp
 = 
vty
->
ödex
;

1209 i‡(
°∫cmp
 (
¨gv
[0], "confed", 1) == 0)

1210 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_MED_CONFED
);

1212 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_MED_MISSING_AS_WORST
);

1214  
	gCMD_SUCCESS
;

1217 
DEFUN
 (
bgp_be°∑th_med2
,

1218 
bgp_be°∑th_med2_cmd
,

1226 
bgp
 *
	gbgp
;

1228 
	gbgp
 = 
vty
->
ödex
;

1229 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_MED_CONFED
);

1230 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_MED_MISSING_AS_WORST
);

1231  
	gCMD_SUCCESS
;

1234 
ALIAS
 (
bgp_be°∑th_med2
,

1235 
bgp_be°∑th_med3_cmd
,

1243 
DEFUN
 (
no_bgp_be°∑th_med
,

1244 
no_bgp_be°∑th_med_cmd
,

1246 
NO_STR


1253 
bgp
 *
	gbgp
;

1255 
	gbgp
 = 
vty
->
ödex
;

1257 i‡(
°∫cmp
 (
¨gv
[0], "confed", 1) == 0)

1258 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_MED_CONFED
);

1260 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_MED_MISSING_AS_WORST
);

1262  
	gCMD_SUCCESS
;

1265 
DEFUN
 (
no_bgp_be°∑th_med2
,

1266 
no_bgp_be°∑th_med2_cmd
,

1268 
NO_STR


1275 
bgp
 *
	gbgp
;

1277 
	gbgp
 = 
vty
->
ödex
;

1278 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_MED_CONFED
);

1279 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_MED_MISSING_AS_WORST
);

1280  
	gCMD_SUCCESS
;

1283 
ALIAS
 (
no_bgp_be°∑th_med2
,

1284 
no_bgp_be°∑th_med3_cmd
,

1286 
NO_STR


1294 
DEFUN
 (
no_bgp_deÁu…_ùv4_uniˇ°
,

1295 
no_bgp_deÁu…_ùv4_uniˇ°_cmd
,

1297 
NO_STR


1302 
bgp
 *
	gbgp
;

1304 
	gbgp
 = 
vty
->
ödex
;

1305 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_NO_DEFAULT_IPV4
);

1306  
	gCMD_SUCCESS
;

1309 
DEFUN
 (
bgp_deÁu…_ùv4_uniˇ°
,

1310 
bgp_deÁu…_ùv4_uniˇ°_cmd
,

1316 
bgp
 *
	gbgp
;

1318 
	gbgp
 = 
vty
->
ödex
;

1319 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_NO_DEFAULT_IPV4
);

1320  
	gCMD_SUCCESS
;

1324 
DEFUN
 (
bgp_√tw‹k_imp‹t_check
,

1325 
bgp_√tw‹k_imp‹t_check_cmd
,

1331 
bgp
 *
	gbgp
;

1333 
	gbgp
 = 
vty
->
ödex
;

1334 
bgp_Êag_£t
 (
bgp
, 
BGP_FLAG_IMPORT_CHECK
);

1335  
	gCMD_SUCCESS
;

1338 
DEFUN
 (
no_bgp_√tw‹k_imp‹t_check
,

1339 
no_bgp_√tw‹k_imp‹t_check_cmd
,

1341 
NO_STR


1346 
bgp
 *
	gbgp
;

1348 
	gbgp
 = 
vty
->
ödex
;

1349 
bgp_Êag_un£t
 (
bgp
, 
BGP_FLAG_IMPORT_CHECK
);

1350  
	gCMD_SUCCESS
;

1353 
DEFUN
 (
bgp_deÁu…_loˇl_¥e„ªn˚
,

1354 
bgp_deÁu…_loˇl_¥e„ªn˚_cmd
,

1361 
bgp
 *
	gbgp
;

1362 
u_öt32_t
 
	gloˇl_¥ef
;

1364 
	gbgp
 = 
vty
->
ödex
;

1366 
VTY_GET_INTEGER
 ("loˇ»¥e„ªn˚", 
loˇl_¥ef
, 
¨gv
[0]);

1368 
bgp_deÁu…_loˇl_¥e„ªn˚_£t
 (
bgp
, 
loˇl_¥ef
);

1370  
	gCMD_SUCCESS
;

1373 
DEFUN
 (
no_bgp_deÁu…_loˇl_¥e„ªn˚
,

1374 
no_bgp_deÁu…_loˇl_¥e„ªn˚_cmd
,

1376 
NO_STR


1381 
bgp
 *
	gbgp
;

1383 
	gbgp
 = 
vty
->
ödex
;

1384 
bgp_deÁu…_loˇl_¥e„ªn˚_un£t
 (
bgp
);

1385  
	gCMD_SUCCESS
;

1388 
ALIAS
 (
no_bgp_deÁu…_loˇl_¥e„ªn˚
,

1389 
no_bgp_deÁu…_loˇl_¥e„ªn˚_vÆ_cmd
,

1391 
NO_STR


1397 #ifde‡
USE_SRX


1398 
	$DEFUN
 (
§x_show_c⁄fig
,

1399 
§x_show_c⁄fig_cmd
,

1400 
SRX_VTY_CMD_SHOW_CONFIG
,

1401 
SRX_VTY_HLP_SHOW_CONFIG
)

1403 
	#_BLANKS
 " "

	)

1404 
bgp
 *bgp;

1405 
doPﬁicy
;

1407 
bgp
 = 
vty
->
ödex
;

1408 
doPﬁicy
 = 0;

1410 
	`vty_out
 (
vty
, "SRx-Sîvî c⁄figuøti⁄ sëtögs:%s", 
VTY_NEWLINE
);

1411 
	`vty_out
 (
vty
, " srx-£rvî.....: %s%s", 
bgp
->
§x_ho°
, 
VTY_NEWLINE
);

1412 
	`vty_out
 (
vty
, "Ö‹t...........: %d%s", 
bgp
->
§x_p‹t
, 
VTY_NEWLINE
);

1413 
	`vty_out
 (
vty
, "Öroxy-id.......: 0x%08X (%u.%u.%u.%u - %u)%s",

1414 
bgp
->
§x_¥oxyID
,

1415 (
bgp
->
§x_¥oxyID
 >> 24) & 0xFF,

1416 (
bgp
->
§x_¥oxyID
 >> 16) & 0xFF,

1417 (
bgp
->
§x_¥oxyID
 >> 8) & 0xFF,

1418 (
bgp
->
§x_¥oxyID
Ë& 0xFF, bgp->§x_¥oxyID, 
VTY_NEWLINE
);

1419 
	`vty_out
 (
vty
, " kìp-wödow....: %d%s", 
bgp
->
§x_kìpWödow
, 
VTY_NEWLINE
);

1420 
	`vty_out
 (
vty
, " c⁄√˘ed......: %s%s", (
	`isC⁄√˘ed
(
bgp
->
§xProxy
)

1421 ? "åue" : "Ál£"), 
VTY_NEWLINE
);

1423 
	`vty_out
 (
vty
, "BGPSEC c⁄figuøti⁄ sëtögs:%s", 
VTY_NEWLINE
);

1424 
	`vty_out
 (
vty
, "á˘ivêkey.....: %u%s", 
bgp
->
§x_bgp£c_a˘ive_key
,

1425 
VTY_NEWLINE
);

1426 
kIdx
 = 0;

1427 
bIdx
 = 0;

1428 
skiSå
[
SKI_HEX_LENGTH
+1];

1429 *
skiPå
;

1430 ; 
kIdx
 < 
SRX_MAX_PRIVKEYS
; kIdx++)

1432 
	`mem£t
(
skiSå
, '\0', 
SKI_HEX_LENGTH
+1);

1433 
skiPå
 = 
skiSå
;

1434 
bIdx
 = 0; bIdx < 
SKI_LENGTH
; bIdx++)

1436 
skiPå
 +
	`•rötf
(skiPå, "%02X", 
bgp
->
§x_bgp£c_key
[
kIdx
].
ski
[
bIdx
]);

1438 
	`vty_out
 (
vty
, " Priv©êkey %u %ß˘ive%s", 
kIdx
,

1439 
bgp
->
§x_bgp£c_a˘ive_key
 =
kIdx
 ? "- ":"- in", 
VTY_NEWLINE
);

1440 
	`vty_out
 (
vty
, " -álg‹ôh-id..: %u%s", 
bgp
->
§x_bgp£c_key
[
kIdx
].
ÆgoID
,

1441 
VTY_NEWLINE
);

1442 
	`vty_out
 (
vty
, " - ski..........: %s%s", 
skiSå
, 
VTY_NEWLINE
);

1443 
	`vty_out
 (
vty
, " - DER-loaded...: %s%s",

1444 
bgp
->
§x_bgp£c_key
[
kIdx
].
keyLígth
 > 0 ? "yes":"no", 
VTY_NEWLINE
);

1447 
	`vty_out
 (
vty
, "SRx Rouã∏C⁄figuøti⁄ sëtögs:%s", 
VTY_NEWLINE
);

1448 
	`vty_out
 (
vty
, "Évaluation.....: ");

1449 i‡(
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_PATH
))

1451 i‡(
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

1453 
	`vty_out
 (
vty
, "bgpsec (prefix-originándÖathÖrocessing) using "

1454 "§x-£rvî%s", 
VTY_NEWLINE
);

1458 
	`vty_out
 (
vty
, "bgpsec (prefix-originándÖathÖrocessing)Üocally%s",

1459 
VTY_NEWLINE
);

1462 i‡(
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_ORIGIN
))

1464 
	`vty_out
 (
vty
, "‹igö_⁄ly (¥efix-‹igöÖro˚ssög)%s", 
VTY_NEWLINE
);

1468 
	`vty_out
 (
vty
, "dißbÀd!%s", 
VTY_NEWLINE
);

1472 
	`vty_out
 (
vty
, " default value..: (origin) ");

1473 
bgp
->
§x_deÁu…_rﬂVÆ
)

1475 
SRx_RESULT_VALID
:

1476 
	`vty_out
 (
vty
, " v = vÆid%s", 
VTY_NEWLINE
); ;

1477 
SRx_RESULT_NOTFOUND
:

1478 
	`vty_out
 (
vty
, "Ç =ÇŸfound%s", 
VTY_NEWLINE
); ;

1479 
SRx_RESULT_INVALID
:

1480 
	`vty_out
 (
vty
, " i = invÆid%s", 
VTY_NEWLINE
); ;

1481 
SRx_RESULT_UNDEFINED
:

1482 
	`vty_out
 (
vty
, " ? = undeföed%s", 
VTY_NEWLINE
); ;

1484 
	`vty_out
 (
vty
, " invÆid vÆue%s", 
VTY_NEWLINE
);

1488 
	`vty_out
 (
vty
, " default value..: (Öath ) ");

1489 
bgp
->
§x_deÁu…_bgp£cVÆ
)

1491 
SRx_RESULT_VALID
:

1492 
	`vty_out
 (
vty
, " v = vÆid%s", 
VTY_NEWLINE
); ;

1493 
SRx_RESULT_INVALID
:

1494 
	`vty_out
 (
vty
, " i = invÆid%s", 
VTY_NEWLINE
); ;

1495 
SRx_RESULT_UNDEFINED
:

1496 
	`vty_out
 (
vty
, " ? = undeföed%s", 
VTY_NEWLINE
); ;

1498 
	`vty_out
 (
vty
, " invÆid vÆue%s", 
VTY_NEWLINE
);

1502 
	`vty_out
 (
vty
, "Öolicy.........: ");

1503 i‡(
bgp
->
§x_vÆ_pﬁicy
 & 
SRX_VAL_POLICY_IGNORE_NOTFOUND
)

1505 
	`vty_out
 (
vty
, "%sign‹e-nŸfound%s", (
doPﬁicy
 ? 
_BLANKS
 : ""),
VTY_NEWLINE
);

1506 
doPﬁicy
 = 1;

1508 i‡(
bgp
->
§x_vÆ_pﬁicy
 & 
SRX_VAL_POLICY_IGNORE_INVALID
)

1510 
	`vty_out
 (
vty
, "%sign‹e-övÆid%s", (
doPﬁicy
 ? 
_BLANKS
 : ""), 
VTY_NEWLINE
);

1511 
doPﬁicy
 = 1;

1513 i‡(
bgp
->
§x_vÆ_pﬁicy
 & 
SRX_VAL_POLICY_IGNORE_UNDEFINED
)

1515 
	`vty_out
 (
vty
, "%sign‹e-undeföed%s", (
doPﬁicy
 ? 
_BLANKS
 : ""),

1516 
VTY_NEWLINE
);

1517 
doPﬁicy
 = 1;

1519 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_VALID
].
is_£t
)

1521 
	`vty_out
 (
vty
, "%¶oˇl-¥e„ªn˚ vÆid %d", (
doPﬁicy
 ? 
_BLANKS
 : ""),

1522 
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_VALID
].
vÆue
);

1523 
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_VALID
].
ªœtive
)

1525 -1 : 
	`vty_out
 (
vty
, " SUBTRACT%s", 
VTY_NEWLINE
); ;

1526 1 : 
	`vty_out
 (
vty
, " ADD%s", 
VTY_NEWLINE
); ;

1527 : 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1529 
doPﬁicy
 = 1;

1531 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_NOTFOUND
].
is_£t
)

1533 
	`vty_out
 (
vty
, "%¶oˇl-¥e„ªn˚ÇŸfound %d", (
doPﬁicy
 ? 
_BLANKS
 : ""),

1534 
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_NOTFOUND
].
vÆue
);

1535 
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_NOTFOUND
].
ªœtive
)

1537 -1 : 
	`vty_out
 (
vty
, " SUBTRACT%s", 
VTY_NEWLINE
); ;

1538 1 : 
	`vty_out
 (
vty
, " ADD%s", 
VTY_NEWLINE
); ;

1539 : 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1541 
doPﬁicy
 = 1;

1543 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_INVALID
].
is_£t
)

1545 
	`vty_out
 (
vty
, "%¶oˇl-¥e„ªn˚ invÆid %d", (
doPﬁicy
 ? 
_BLANKS
 : ""),

1546 
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_INVALID
].
vÆue
);

1547 
bgp
->
§x_vÆ_loˇl_¥ef
[
VAL_LOCPRF_INVALID
].
ªœtive
)

1549 -1 : 
	`vty_out
 (
vty
, " SUBTRACT%s", 
VTY_NEWLINE
); ;

1550 1 : 
	`vty_out
 (
vty
, " ADD%s", 
VTY_NEWLINE
); ;

1551 : 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1553 
doPﬁicy
 = 1;

1555 i‡(
bgp
->
§x_vÆ_pﬁicy
 & 
SRX_VAL_POLICY_PREFER_VALID
)

1557 
	`vty_out
 (
vty
, "%•ª„r-vÆid%s", (
doPﬁicy
 ? 
_BLANKS
 : ""), 
VTY_NEWLINE
);

1558 
doPﬁicy
 = 1;

1560 i‡(
doPﬁicy
 == 0)

1562 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1565 i‡(
	`CHECK_FLAG
(
bgp
->
§x_ecommunôy_Êags
,
SRX_BGP_FLAG_ECOMMUNITY
))

1567 
	`vty_out
 (
vty
, "Éxàcommunôy..: %d%s", 
bgp
->
§x_ecommunôy_subcode
,

1568 
VTY_NEWLINE
);

1569 
	`vty_out
 (
vty
, " incl-eBGP......: %s%s",

1570 (
	`CHECK_FLAG
(
bgp
->
§x_ecommunôy_Êags
,
SRX_BGP_FLAG_ECOMMUNITY_EBGP
)

1571 ? "åue" : "Ál£"), 
VTY_NEWLINE
);

1575 
	`vty_out
 (
vty
, "Éxàcommunôy..: off%s", 
VTY_NEWLINE
);

1578  
CMD_SUCCESS
;

1579 
	}
}

1581 
	$DEFUN
 (
§x_£t_£rvî
,

1582 
§x_£t_£rvî_cmd
,

1583 
SRX_VTY_CMD_SET_SERVER
,

1584 
SRX_VTY_HLP_SET_SERVER
)

1586 
bgp
 *bgp;

1587 
p‹t
;

1589 
bgp
 = 
vty
->
ödex
;

1591 i‡(
¨gc
 != 2)

1593  
CMD_ERR_INCOMPLETE
;

1597 i‡(
	`°æí
(
¨gv
[
SRX_VTY_PARAM_CONNECT_SRV
]) == 0)

1599 
	`vty_out
 (
vty
, "%% Em±y SRx ho°Çame%s", 
VTY_NEWLINE
);

1600  
CMD_WARNING
;

1604 
	`VTY_GET_INTEGER_RANGE
 ("P‹t", 
p‹t
, 
¨gv
[
SRX_VTY_PARAM_CONNECT_PORT
],

1608  
	`bgp_§x_£t
 (
bgp
, 
vty
, 
¨gv
[
SRX_VTY_PARAM_CONNECT_SRV
], 
p‹t
, 
Ál£
);

1609 
	}
}

1611 
	$DEFUN
 (
§x_c⁄√˘_sh‹t
,

1612 
§x_c⁄√˘_sh‹t_cmd
,

1613 
SRX_VTY_CMD_CONNECT_SHORT
,

1614 
SRX_VTY_HLP_CONNECT_SHORT
)

1616 
bgp
 *bgp;

1617 
bgp
 = 
vty
->
ödex
;

1620 i‡(
bgp
->
§x_ho°
 =
NULL
)

1622 
	`vty_out
 (
vty
, "%% SRx hostÇameÇot defined, use \"%s\" orÖass serveránd "

1624 
SRX_VTY_CMD_SET_SERVER_SHORT
, 
VTY_NEWLINE
);

1625  
CMD_WARNING
;

1628 i‡(
	`°æí
(
bgp
->
§x_ho°
) == 0)

1630 
	`vty_out
 (
vty
, "Em±y SRx ho°Çame%s", 
VTY_NEWLINE
);

1631  
CMD_WARNING
;

1635 i‡(
bgp
->
§x_p‹t
 == 0)

1637 
	`vty_out
 (
vty
, "%% SRxÖ‹ànŸ s≥cifõd!%s", 
VTY_NEWLINE
);

1638  
CMD_WARNING
;

1642  
	`bgp_§x_£t
 (
bgp
, 
vty
, bgp->
§x_ho°
, bgp->
§x_p‹t
, 
åue
);

1643 
	}
}

1654 
	$§x_£t_ski
(
vty
* vty, 
u_öt8_t
 
skiNum
, * 
skiSå
, u_öt8_à
ÆgoID
)

1656 
ªtVÆ
 = 
CMD_SUCCESS
;

1657 
bgp
* bg∞
vty
->
ödex
;

1659 i‡(
	`°æí
(
skiSå
Ë!
SKI_HEX_LENGTH
)

1661 
	`vty_out
 (
vty
, "SKI mu° bêexa˘ 20 byã†ASCII %s", 
VTY_NEWLINE
);

1662  
CMD_ERR_INCOMPLETE
;

1664 i‡(
skiNum
 >
SRX_MAX_PRIVKEYS
)

1666 
	`vty_out
 (
vty
, "Selectán ski between 0..%u, The selected ski %u is outside ofÅhere boundaries",

1667 
SRX_MAX_PRIVKEYS
-1, 
skiNum
, 
VTY_NEWLINE
);

1668  
CMD_ERR_INCOMPLETE
;

1672 
BGPSecKey
* 
key
 = &
bgp
->
§x_bgp£c_key
[
skiNum
];

1673 i‡(
key
->
keyLígth
 > 0)

1676 i‡(
bgp
->
§xCAPI
 !
NULL
)

1678 
sˇ_°©us_t
 
keySètus
 = 
API_STATUS_OK
;

1679 i‡(
bgp
->
§xCAPI
->
	`uƒegi°îPriv©eKey
(
key
->
a¢
, key->
ski
, key->
ÆgoID
, &
keySètus
Ë=
API_FAILURE
)

1681 
	`vty_out
 (
vty
, "Removal ofÖreviousÑouter key '%s' failed (status:0x%X)!%s",

1682 
skiSå
, 
keySètus
, 
VTY_NEWLINE
);

1686 
	`vty_out
 (
vty
, "OldÑouter key '%s' successfullyÑemoved!%s",

1687 
skiSå
, 
VTY_NEWLINE
);

1692 
	`‰ì
(
key
->
keyD©a
);

1693 
key
->
keyD©a
 = 
NULL
;

1694 
key
->
keyLígth
 = 0;

1698 
key
->
ÆgoID
 =álgoID;

1699 
key
->
a¢
 = 
	`ht⁄l
(
bgp
->
as
);

1700 
	`mem£t
(
key
->
ski
, 0, 
SKI_LENGTH
);

1703 
max
 = 
	`°æí
(
skiSå
Ë< 
SKI_LENGTH
 ? strlen(skiStr) : SKI_LENGTH;

1704 
idx
 = 0;

1705 * 
ch
 = 
skiSå
;

1706 ; 
idx
 < 
max
; idx++)

1708 
key
->
ski
[
idx
] = 
	`hex2bö_byã
(
ch
);

1709 
ch
 += 2;

1714 
sˇ_°©us_t
 
keySètus
 = 
API_STATUS_OK
;

1715 i‡(
	`sˇ_lﬂdKey
(
key
, 
åue
, &
keySètus
Ë=
API_SUCCESS
)

1718 i‡(
bgp
->
§xCAPI
 !
NULL
)

1720 i‡(
bgp
->
§xCAPI
->
	`ªgi°îPriv©eKey
(
key
, &
keySètus
Ë=
API_FAILURE
)

1722 
	`zlog_îr
 ("Installation ofÑouter key: #%u,álgorithm-id: %u, ski: '%s' failed (status:0x%X)!\n",

1723 
skiNum
, 
ÆgoID
, 
skiSå
, 
keySètus
);

1724 
	`vty_out
 (
vty
, "Installation ofÑouter key: #%u,álgorithm-id: %u, ski: '%s' failed (status:0x%X)!%s",

1725 
skiNum
, 
ÆgoID
, 
skiSå
, 
keySètus
, 
VTY_NEWLINE
);

1726 
ªtVÆ
 = 
CMD_WARNING
;

1730 
	`zlog_öfo
 ("Router key: #%u,álgorithm-id: %u, ski: '%s' successfully installed!\n",

1731 
skiNum
, 
ÆgoID
, 
skiSå
);

1732 
	`vty_out
 (
vty
, "Router key: #%u,álgorithm-id: %u, ski: '%s' successfully installed!%s",

1733 
skiNum
, 
ÆgoID
, 
skiSå
, 
VTY_NEWLINE
);

1738 
	`zlog_w¨n
 ("Cannot installÑouter key '%s', cryptoápiÇotávailable!",

1739 
skiSå
);

1740 
	`vty_out
 (
vty
, "Cannot installÑouter key '%s', cryptoápiÇotávailable!%s",

1741 
skiSå
, 
VTY_NEWLINE
);

1743 
ªtVÆ
 = 
CMD_WARNING
;

1748 
	`zlog_w¨n
 ("Router key %u '%s'Çot found in key_volt - Check configuration of SRxCryptoAPI!",

1749 
skiNum
, 
skiSå
);

1750 
	`vty_out
 (
vty
, "Router key %u '%s'Çot found in key_volt - Check configuration of SRxCryptoAPI!%s",

1751 
skiNum
, 
skiSå
, 
VTY_NEWLINE
);

1752 
ªtVÆ
 = 
CMD_WARNING
;

1755  
ªtVÆ
;

1756 
	}
}

1762 
	$DEFUN
 (
bgp£c_ski
,

1763 
bgp£c_ski_cmd
,

1764 
SRX_VTY_CMD_BGPSEC_DEP_SKI
,

1765 
SRX_VTY_HLP_BGPSEC_DEP_SKI
)

1767 
bgp
 *bgp;

1768 
bgp
 = 
vty
->
ödex
;

1770 i‡(
¨gc
 != 1)

1772  
CMD_ERR_INCOMPLETE
;

1775 
	`vty_out
(
vty
, "WARNING: The configuration command '%s' is deprecated! Use '%s %s' instead %s",

1776 
SRX_VTY_CMD_BGPSEC_DEP_SKI_PRNT
, 
SRX_VTY_CMD_BGPSEC_SKI_PRNT
, 
¨gv
[0],

1777 
VTY_NEWLINE
);

1778 
	`zlog_w¨n
("The configuration command '%s' is deprecated! Use '%s %s' instead %s",

1779 
SRX_VTY_CMD_BGPSEC_DEP_SKI_PRNT
, 
SRX_VTY_CMD_BGPSEC_SKI_PRNT
, 
¨gv
[0],

1780 
VTY_NEWLINE
);

1783 
bgp
->
§x_bgp£c_a˘ive_key
 = 0;

1784  
	`§x_£t_ski
(
vty
, 
bgp
->
§x_bgp£c_a˘ive_key
, (*)
¨gv
[0],

1785 
SCA_ECDSA_ALGORITHM
);

1786 
	}
}

1789 
	$DEFUN
 (
bgp£c_sign
,

1790 
bgp£c_sign_cmd
,

1791 
SRX_VTY_CMD_BGPSEC_DEP_SIGN
,

1792 
SRX_VTY_HLP_BGPSEC_DEP_SIGN
)

1794 
	`vty_out
(
vty
, "This command doesÇot haveányáffectánymore -Ñemove it.%s",

1795 
VTY_NEWLINE
);

1797  
CMD_WARNING
;

1798 
	}
}

1800 
	$DEFUN
 (
§x_bgp£c_ski
,

1801 
§x_bgp£c_ski_cmd
,

1802 
SRX_VTY_CMD_BGPSEC_SKI
,

1803 
SRX_VTY_HLP_BGPSEC_SKI
)

1805 
bgp
 *bgp;

1806 
bgp
 = 
vty
->
ödex
;

1808 i‡(
¨gc
 != 3)

1810  
CMD_ERR_INCOMPLETE
;

1814 
uöt32_t
 
skiNum
 = (uöt32_t)
	`©oi
(
¨gv
[0]);

1815 
ÆgoID
 = 
	`©oi
(
¨gv
[1]);

1816 * 
skiSå
 = (*)
¨gv
[2];

1817 
ªtVÆ
 = 
CMD_ERR_INCOMPLETE
;

1818 i‡(
skiNum
 >
SRX_MAX_PRIVKEYS
)

1820 
	`zlog_îr
("ThisÖrovided skiÇumber is outside ofÅheáccepted boundaries%s",

1821 
VTY_NEWLINE
);

1822 
	`vty_out
(
vty
, "ThisÖrovided skiÇumber is outside ofÅheáccepted boundaries%s",

1823 
VTY_NEWLINE
);

1827 i‡–(
ÆgoID
 < 
SRX_VTY_PARAM_BGPSEC_MIN_ALGOID
)

1828 || (
ÆgoID
 > 
SRX_VTY_PARAM_BGPSEC_MAX_ALGOID
))

1830 
	`zlog_îr
("ThisÖrovidedálgorithm identifier is outside ofÅheáccepted boundaries%s",

1831 
VTY_NEWLINE
);

1832 
	`vty_out
(
vty
, "ThisÖrovidedálgorithm identifier is outside ofÅheáccepted boundaries%s",

1833 
VTY_NEWLINE
);

1837 
ªtVÆ
 = 
	`§x_£t_ski
(
vty
, 
skiNum
, 
skiSå
, 
ÆgoID
);

1841  
ªtVÆ
;

1842 
	}
}

1844 
	$DEFUN
 (
§x_bgp£c_a˘ive_ski
,

1845 
§x_bgp£c_a˘ive_ski_cmd
,

1846 
SRX_VTY_CMD_BGPSEC_ACTIVE_SKI
,

1847 
SRX_VTY_HLP_BGPSEC_ACTIVE_SKI
)

1849 
bgp
 *bgp;

1850 
bgp
 = 
vty
->
ödex
;

1852 i‡(
¨gc
 != 1)

1854  
CMD_ERR_INCOMPLETE
;

1857 
ªtVÆ
 = 
CMD_SUCCESS
;

1859 
uöt32_t
 
a˘iveNum
 = (uöt32_t)
	`©oi
(
¨gv
[0]);

1860 i‡(
a˘iveNum
 >
SRX_MAX_PRIVKEYS
)

1862 
	`vty_out
(
vty
, "ThisÖrovided skiÇumber is outside ofÅheáccepted boundaries%s",

1863 
VTY_NEWLINE
);

1864 
ªtVÆ
 = 
CMD_ERR_INCOMPLETE
;

1868 
bgp
->
§x_bgp£c_a˘ive_key
 = 
a˘iveNum
;

1871  
ªtVÆ
;

1872 
	}
}

1874 
	$DEFUN
 (
§x_bgp£c_ªgi°î_pkeys
,

1875 
§x_bgp£c_ªgi°î_pkeys_cmd
,

1876 
SRX_VTY_CMD_BGPSEC_REGISTER_P_KEYS
,

1877 
SRX_VTY_HLP_BGPSEC_REGISTER_P_KEYS
)

1879 
bgp
 *bgp;

1880 
bgp
 = 
vty
->
ödex
;

1882 i‡(
¨gc
 != 1)

1884  
CMD_ERR_INCOMPLETE
;

1887 
ªtVÆ
 = 
CMD_SUCCESS
;

1891 
kIdx
 = 0;

1892 ; 
kIdx
 < 
SRX_MAX_PRIVKEYS
; kIdx++)

1894 i‡(
bgp
->
§x_bgp£c_key
[
kIdx
].
keyLígth
 = 0)

1896 
sˇ_°©us_t
 
mySètus
 = 
API_STATUS_OK
;

1897 i‡(
	`sˇ_lﬂdKey
(&
bgp
->
§x_bgp£c_key
[
kIdx
], 
åue
, &
mySètus
Ë=
API_FAILURE
)

1899 
	`zlog_w¨n
 ("Router key %uÇot found in key_volt (status: 0x%X) - Check configuration of SRxCryptoAPI!",

1900 
kIdx
, 
mySètus
);

1901 
	`vty_out
 (
vty
, "Router key %uÇot found in key_volt (status: 0x%X) - Check configuration of SRxCryptoAPI!%s",

1902 
kIdx
, 
mySètus
, 
VTY_NEWLINE
);

1903 
ªtVÆ
 = 
CMD_WARNING
;

1909 i‡(
bgp
->
§xCAPI
 !
NULL
)

1911 
kIdx
 = 0; kIdx < 
SRX_MAX_PRIVKEYS
; kIdx++)

1913 
sˇ_°©us_t
 
keySètus
 = 
API_STATUS_OK
;

1914 i‡(
bgp
->
§xCAPI
->
	`ªgi°îPriv©eKey
(&bgp->
§x_bgp£c_key
[
kIdx
], &
keySètus
Ë=
API_FAILURE
)

1916 
	`zlog_îr
 ("Installation ofÑouter key %u failed (status:0x%X)!",

1917 
kIdx
, 
keySètus
);

1918 
	`vty_out
 (
vty
, "Installation ofÑouter key %u failed (status:0x%X)!%s",

1919 
kIdx
, 
keySètus
, 
VTY_NEWLINE
);

1926 
	`zlog_w¨n
 ("Cannot installÑouter keys, cryptoápiÇotávailable!");

1927 
	`vty_out
 (
vty
, "Cannot installÑouter keys, cryptoápiÇotávailable!%s",

1928 
VTY_NEWLINE
);

1930 
ªtVÆ
 = 
CMD_WARNING
;

1933  
ªtVÆ
;

1934 
	}
}

1936 
	$DEFUN
 (
§x_c⁄√˘
,

1937 
§x_c⁄√˘_cmd
,

1938 
SRX_VTY_CMD_CONNECT
,

1939 
SRX_VTY_HLP_CONNECT
)

1941 
bgp
 *bgp;

1942 
p‹t
;

1944 
bgp
 = 
vty
->
ödex
;

1947 i‡(
¨gc
 != 2)

1949  
CMD_ERR_INCOMPLETE
;

1953 i‡(
	`°æí
(
¨gv
[
SRX_VTY_PARAM_CONNECT_SRV
]) == 0)

1955 
	`vty_out
 (
vty
, "%% Em±y SRx ho°Çame%s", 
VTY_NEWLINE
);

1956  
CMD_ERR_INCOMPLETE
;

1960 
	`VTY_GET_INTEGER_RANGE
 ("P‹t", 
p‹t
, 
¨gv
[
SRX_VTY_PARAM_CONNECT_PORT
],

1964  
	`bgp_§x_£t
 (
bgp
, 
vty
, 
¨gv
[
SRX_VTY_PARAM_CONNECT_SRV
], 
p‹t
, 
åue
);

1965 
	}
}

1967 
	$DEFUN
 (
§x_disc⁄√˘
,

1968 
§x_disc⁄√˘_cmd
,

1969 
SRX_VTY_CMD_DISCONNECT
,

1970 
SRX_VTY_HLP_DISCONNECT
)

1972 
bgp
 *bgp;

1974 
bgp
 = 
vty
->
ödex
;

1975 
	`bgp_§x_un£t
 (
bgp
);

1976  
CMD_SUCCESS
;

1977 
	}
}

1979 
	$DEFUN
 (
§x_evÆu©i⁄
,

1980 
§x_evÆu©i⁄_cmd
,

1981 
SRX_VTY_CMD_EVALUATE
,

1982 
SRX_VTY_HLP_EVALUATE
)

1984 
bgp
* bgp;

1985 
mode
;

1987 
bgp
 = 
vty
->
ödex
;

1988 
mode
 = 
SRX_CONFIG_EVAL_ORIGIN
;

1989 i‡(
	`°∫cmp
(
¨gv
[0], 
SRX_VTY_EVAL_BGPSEC
, 1) == 0)

1991 
mode
 |
SRX_CONFIG_EVAL_PATH
;

1994 
	`bgp_§x_evÆu©i⁄
(
bgp
, 
mode
);

1995  
CMD_SUCCESS
;

1996 
	}
}

1999 
	$DEFUN
 (
§x_evÆu©i⁄_bgp£c_di°ribuã
,

2000 
§x_evÆu©i⁄_bgp£c_di°ribuã_cmd
,

2001 
SRX_VTY_CMD_EVAL_WITHSRX
,

2002 
SRX_VTY_HLP_EVAL_WITHSRX
)

2004 
bgp
* bgp;

2005 
bgp
 = 
vty
->
ödex
;

2006 
	`bgp_§x_evÆu©i⁄
(
bgp
, 
SRX_CONFIG_EVAL_DISTR
);

2007 
	}
}

2010 
	$DEFUN
 (
§x_c⁄f_deÁu…_rﬂ_ªsu…_vÆid
,

2011 
§x_c⁄f_deÁu…_rﬂ_ªsu…_vÆid_cmd
,

2012 
SRX_VTY_CMD_CONF_DEF_ROA_RES_VALID
,

2013 
SRX_VTY_HLP_CONF_DEF_ROA_RES_VALID
)

2015 
bgp
* bgp;

2016 
bgp
 = 
vty
->
ödex
;

2017 
	`bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
, 
SRX_VTY_PARAM_ORIGIN_VALUE
,

2018 
SRx_RESULT_VALID
);

2019  
CMD_SUCCESS
;

2020 
	}
}

2022 
	$DEFUN
 (
§x_c⁄f_deÁu…_rﬂ_ªsu…_unknown
,

2023 
§x_c⁄f_deÁu…_rﬂ_ªsu…_unknown_cmd
,

2024 
SRX_VTY_CMD_CONF_DEF_ROA_RES_NOTFOUND
,

2025 
SRX_VTY_HLP_CONF_DEF_ROA_RES_NOTFOUND
)

2027 
bgp
* bgp;

2028 
bgp
 = 
vty
->
ödex
;

2029 
	`bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
, 
SRX_VTY_PARAM_ORIGIN_VALUE
,

2030 
SRx_RESULT_NOTFOUND
);

2031  
CMD_SUCCESS
;

2032 
	}
}

2034 
	$DEFUN
 (
§x_c⁄f_deÁu…_rﬂ_ªsu…_övÆid
,

2035 
§x_c⁄f_deÁu…_rﬂ_ªsu…_övÆid_cmd
,

2036 
SRX_VTY_CMD_CONF_DEF_ROA_RES_INVALID
,

2037 
SRX_VTY_HLP_CONF_DEF_ROA_RES_INVALID
)

2039 
bgp
* bgp;

2040 
bgp
 = 
vty
->
ödex
;

2041 
	`bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
, 
SRX_VTY_PARAM_ORIGIN_VALUE
,

2042 
SRx_RESULT_INVALID
);

2043  
CMD_SUCCESS
;

2044 
	}
}

2046 
	$DEFUN
 (
§x_c⁄f_deÁu…_rﬂ_ªsu…_undeföed
,

2047 
§x_c⁄f_deÁu…_rﬂ_ªsu…_undeföed_cmd
,

2048 
SRX_VTY_CMD_CONF_DEF_ROA_RES_UNDEFINED
,

2049 
SRX_VTY_HLP_CONF_DEF_ROA_RES_UNDEFINED
)

2051 
bgp
* bgp;

2052 
bgp
 = 
vty
->
ödex
;

2053 
	`bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
, 
SRX_VTY_PARAM_ORIGIN_VALUE
,

2054 
SRx_RESULT_UNDEFINED
);

2055  
CMD_SUCCESS
;

2056 
	}
}

2058 
	$DEFUN
 (
§x_c⁄f_deÁu…_∑th_ªsu…_vÆid
,

2059 
§x_c⁄f_deÁu…_∑th_ªsu…_vÆid_cmd
,

2060 
SRX_VTY_CMD_CONF_DEF_PATH_RES_VALID
,

2061 
SRX_VTY_HLP_CONF_DEF_PATH_RES_VALID
)

2063 
bgp
* bgp;

2064 
bgp
 = 
vty
->
ödex
;

2065 
	`bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
, 
SRX_VTY_PARAM_PATH_VALUE
,

2066 
SRx_RESULT_VALID
);

2067  
CMD_SUCCESS
;

2068 
	}
}

2070 
	$DEFUN
 (
§x_c⁄f_deÁu…_∑th_ªsu…_övÆid
,

2071 
§x_c⁄f_deÁu…_∑th_ªsu…_övÆid_cmd
,

2072 
SRX_VTY_CMD_CONF_DEF_PATH_RES_INVALID
,

2073 
SRX_VTY_HLP_CONF_DEF_PATH_RES_INVALID
)

2075 
bgp
* bgp;

2076 
bgp
 = 
vty
->
ödex
;

2077 
	`bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
, 
SRX_VTY_PARAM_PATH_VALUE
,

2078 
SRx_RESULT_INVALID
);

2079  
CMD_SUCCESS
;

2080 
	}
}

2082 
	$DEFUN
 (
§x_c⁄f_deÁu…_∑th_ªsu…_undeföed
,

2083 
§x_c⁄f_deÁu…_∑th_ªsu…_undeföed_cmd
,

2084 
SRX_VTY_CMD_CONF_DEF_PATH_RES_UNDEFINED
,

2085 
SRX_VTY_HLP_CONF_DEF_PATH_RES_UNDEFINED
)

2087 
bgp
* bgp;

2088 
bgp
 = 
vty
->
ödex
;

2089 
	`bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
, 
SRX_VTY_PARAM_PATH_VALUE
,

2090 
SRx_RESULT_UNDEFINED
);

2091  
CMD_SUCCESS
;

2092 
	}
}

2095 
	$DEFUN
 (
no_§x_evÆu©i⁄
,

2096 
no_§x_evÆu©i⁄_cmd
,

2097 
SRX_VTY_CMD_NO_EVALUATE
,

2098 
SRX_VTY_HLP_NO_EVALUATE
)

2100 
bgp
 *bgp;

2102 
bgp
 = 
vty
->
ödex
;

2103 
	`bgp_§x_evÆu©i⁄
 (
bgp
, 0);

2104  
CMD_SUCCESS
;

2105 
	}
}

2108 
	$DEFUN
 (
§x_≠∂y_pﬁicy
,

2109 
§x_≠∂y_pﬁicy_cmd
,

2110 
SRX_VTY_CMD_APPLY_POLICY
,

2111 
SRX_VTY_HLP_APPLY_POLICY
)

2113 
bgp
 *bgp;

2115 
bgp
 = 
vty
->
ödex
;

2116 
	`zlog_debug
("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX");

2117 
	`§x_bgp_ªqueue_Æl
(
bgp
);

2118  
CMD_SUCCESS
;

2119 
	}
}

2123 
	$DEFUN
 (
§x_di•œy
,

2124 
§x_di•œy_cmd
,

2125 
SRX_VTY_CMD_DISPLAY
,

2126 
SRX_VTY_HLP_DISPLAY
)

2128 
bgp
 *bgp;

2130 
bgp
 = 
vty
->
ödex
;

2131 
	`bgp_§x_di•œy
 (
bgp
, 1);

2132  
CMD_SUCCESS
;

2133 
	}
}

2135 
DEFUN
 (
no_§x_di•œy
,

2136 
no_§x_di•œy_cmd
,

2137 "nÿ" 
SRX_VTY_CMD_DISPLAY
,

2138 
NO_STR


2139 
SRX_VTY_HLP_DISPLAY_NO
)

2141 
bgp
 *
	gbgp
;

2143 
	gbgp
 = 
vty
->
ödex
;

2144 
bgp_§x_di•œy
 (
bgp
, 0);

2145  
	gCMD_SUCCESS
;

2148 
	$DEFUN
 (
§x_kìpwödow
,

2149 
§x_kìpwödow_cmd
,

2150 
SRX_VTY_CMD_KEEPWINDOW
,

2151 
SRX_VTY_HLP_KEEPWINDOW
)

2153 
bgp
 *bgp;

2156 
bgp
 = 
vty
->
ödex
;

2157 
bgp
->
§x_kìpWödow
 = 
	`°πoul
 (
¨gv
[0], 
NULL
, 10);

2159  
CMD_SUCCESS
;

2160 
	}
}

2162 
	$DEFUN
 (
§x_¥oxyid
,

2163 
§x_¥oxyid_cmd
,

2164 
SRX_VTY_CMD_PROXYID
,

2165 
SRX_VTY_HLP_PROXYID
)

2167 
bgp
 *bg∞
vty
->
ödex
;

2168 
ö_addr
 
addªss
;

2169 
uöt32_t
 
hAddªss
 = 0;

2171 i‡(
	`öë_©⁄
(
¨gv
[0], &
addªss
) != 0)

2173 
hAddªss
 = 
addªss
.
s_addr
;

2177 
	`vty_out
 (
vty
, "%% MalformedÖroxy id (%s). Use A.B.C.D format%s",

2178 
¨gv
[0], 
VTY_NEWLINE
);

2179  
CMD_WARNING
;

2182 
ªtVÆ
 = 
	`§x_£t_¥oxyID
(
bgp
, 
	`¡ohl
(
hAddªss
));

2184 i‡(
ªtVÆ
 !
CMD_SUCCESS
)

2186 
hAddªss
 = 
	`ht⁄l
(
bgp
->
§xProxy
->
¥oxyID
);

2187 
	`vty_out
 (
vty
, "%% Proxy isálready connectedÅo SRx server usingÖroxy id "

2189 "i†c⁄√˘ed!%s", (
hAddªss
 >> 24) & 0xFF,

2190 (
hAddªss
 >> 16) & 0xFF, (hAddress >> 8) & 0xFF,

2191 
hAddªss
 & 0xFF, hAddªss, 
VTY_NEWLINE
);

2194  
ªtVÆ
;

2195 
	}
}

2206 
	$∑r£_loˇl_¥ef_ödex
 (c⁄° *
°r
)

2208 i‡(
	`°∫cmp
 (
°r
, "v", 1) == 0)

2210  
VAL_LOCPRF_VALID
;

2212  (
	`°∫cmp
 (
°r
, "n", 1Ë=0Ë? 
VAL_LOCPRF_NOTFOUND


2213 : 
VAL_LOCPRF_INVALID
;

2214 
	}
}

2225 
	$vÆid©i⁄_loˇl_¥e„ªn˚
(
¨gc
, c⁄° ** 
¨gv
,

2226 
bgp
* bgp, 
£t
)

2228 
ödex
, 
ªœtive
;

2229 
uöt32_t
 
Õ_vÆ
;

2231 
ödex
 = 
	`∑r£_loˇl_¥ef_ödex
 (
¨gv
[0]);

2233 i‡(
£t
 == 1)

2235 
Õ_vÆ
 = 
	`°πoul
 (
¨gv
[1], 
NULL
, 10);

2237 i‡(
¨gc
 == 2)

2238 
ªœtive
 = 0;

2240 
ªœtive
 = (
	`°∫cmp
 (
¨gv
[2], "a", 1) == 0) ? 1 : -1;

2242 
	`§x_vÆ_loˇl_¥e„ªn˚_£t
 (
bgp
, 
ödex
, 
ªœtive
, 
Õ_vÆ
);

2246 
	`§x_vÆ_loˇl_¥e„ªn˚_un£t
 (
bgp
, 
ödex
);

2248  
CMD_SUCCESS
;

2249 
	}
}

2251 
	$DEFUN
 (
§x_pﬁicy_loˇl_¥e„ªn˚_v¨
,

2252 
§x_pﬁicy_loˇl_¥e„ªn˚_v¨_cmd
,

2253 
SRX_VTY_CMD_POL_LOCP_VAR
,

2254 
SRX_VTY_HLP_POL_LOCP_VAR


2257  
	`vÆid©i⁄_loˇl_¥e„ªn˚
(
¨gc
, 
¨gv
, 
vty
->
ödex
, 1);

2258 
	}
}

2260 
	$DEFUN
 (
§x_pﬁicy_loˇl_¥e„ªn˚_fix
,

2261 
§x_pﬁicy_loˇl_¥e„ªn˚_fix_cmd
,

2262 
SRX_VTY_CMD_POL_LOCP_FIX
,

2263 
SRX_VTY_HLP_POL_LOCP_FIX


2266  
	`vÆid©i⁄_loˇl_¥e„ªn˚
(
¨gc
, 
¨gv
, 
vty
->
ödex
, 1);

2267 
	}
}

2269 
	$DEFUN
 (
no_§x_pﬁicy_loˇl_¥e„ªn˚
,

2270 
no_§x_pﬁicy_loˇl_¥e„ªn˚_cmd
,

2271 
SRX_VTY_CMD_NO_POL_LOCP
,

2272 
SRX_VTY_HLP_NO_POL_LOCP


2275  
	`vÆid©i⁄_loˇl_¥e„ªn˚
(
¨gc
, 
¨gv
, 
vty
->
ödex
, 0);

2276 
	}
}

2278 
	$DEFUN
 (
§x_pﬁicy_ign‹e_nŸfound
,

2279 
§x_pﬁicy_ign‹e_nŸfound_cmd
,

2280 
SRX_VTY_CMD_POL_IGNORE_NOTFOUND
,

2281 
SRX_VTY_HLP_POL_IGNORE_NOTFOUND
)

2283 
	`§x_vÆ_pﬁicy_£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_IGNORE_NOTFOUND
);

2284  
CMD_SUCCESS
;

2285 
	}
}

2287 
DEFUN
 (
no_§x_pﬁicy_ign‹e_nŸfound
,

2288 
no_§x_pﬁicy_ign‹e_nŸfound_cmd
,

2289 "nÿ" 
SRX_VTY_CMD_POL_IGNORE_NOTFOUND
,

2290 
NO_STR


2291 
SRX_VTY_HLP_POL_IGNORE_NOTFOUND
)

2293 
§x_vÆ_pﬁicy_un£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_IGNORE_NOTFOUND
);

2294  
	gCMD_SUCCESS
;

2297 
	$DEFUN
 (
§x_pﬁicy_ign‹e_övÆid
,

2298 
§x_pﬁicy_ign‹e_övÆid_cmd
,

2299 
SRX_VTY_CMD_POL_IGNORE_INVALID
,

2300 
SRX_VTY_HLP_POL_IGNORE_INVALID
)

2302 
	`§x_vÆ_pﬁicy_£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_IGNORE_INVALID
);

2303  
CMD_SUCCESS
;

2304 
	}
}

2306 
DEFUN
 (
no_§x_pﬁicy_ign‹e_övÆid
,

2307 
no_§x_pﬁicy_ign‹e_övÆid_cmd
,

2308 "nÿ" 
SRX_VTY_CMD_POL_IGNORE_INVALID
,

2309 
NO_STR


2310 
SRX_VTY_HLP_POL_IGNORE_INVALID
)

2312 
§x_vÆ_pﬁicy_un£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_IGNORE_INVALID
);

2313  
	gCMD_SUCCESS
;

2316 
	$DEFUN
 (
§x_pﬁicy_ign‹e_undeföed
,

2317 
§x_pﬁicy_ign‹e_undeföed_cmd
,

2318 
SRX_VTY_CMD_POL_IGNORE_UNDEFINED
,

2319 
SRX_VTY_HLP_POL_IGNORE_UNDEFINED
)

2321 
	`§x_vÆ_pﬁicy_£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_IGNORE_UNDEFINED
);

2322  
CMD_SUCCESS
;

2323 
	}
}

2325 
DEFUN
 (
no_§x_pﬁicy_ign‹e_undeföed
,

2326 
no_§x_pﬁicy_ign‹e_undeföed_cmd
,

2327 "nÿ" 
SRX_VTY_CMD_POL_IGNORE_UNDEFINED
,

2328 
NO_STR


2329 
SRX_VTY_HLP_POL_IGNORE_UNDEFINED
)

2331 
§x_vÆ_pﬁicy_un£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_IGNORE_UNDEFINED
);

2332  
	gCMD_SUCCESS
;

2335 
	$DEFUN
 (
§x_pﬁicy_¥e„r_vÆid
,

2336 
§x_pﬁicy_¥e„r_vÆid_cmd
,

2337 
SRX_VTY_CMD_POL_PREFV
,

2338 
SRX_VTY_HLP_POL_PREFV
)

2340  
	`§x_vÆ_pﬁicy_£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_PREFER_VALID
);

2341 
	}
}

2343 
DEFUN
 (
no_§x_pﬁicy_¥e„r_vÆid
,

2344 
no_§x_pﬁicy_¥e„r_vÆid_cmd
,

2345 "nÿ" 
SRX_VTY_CMD_POL_PREFV
,

2346 
NO_STR


2347 
SRX_VTY_HLP_POL_PREFV
)

2349  
§x_vÆ_pﬁicy_un£t
 (
vty
->
ödex
, 
SRX_VAL_POLICY_PREFER_VALID
);

2352 
	$DEFUN
 (
§x_£nd_extcommunôy
,

2353 
§x_£nd_extcommunôy_cmd
,

2354 
SRX_VTY_CMD_EXT_CSTR
,

2355 
SRX_VTY_HLP_EXT_CSTR
)

2357  
	`§x_extcommunôy_£t
 (
vty
->
ödex
, 
	`©oi
(
¨gv
[0]), "");

2358 
	}
}

2360 
	$DEFUN
 (
§x_£nd_extcommunôy_ebgp
,

2361 
§x_£nd_extcommunôy_ebgp_cmd
,

2362 
SRX_VTY_CMD_EXT_CSTR_EBGP
,

2363 
SRX_VTY_HLP_EXT_CSTR_EBGP
)

2365  
	`§x_extcommunôy_£t
 (
vty
->
ödex
, 
	`©oi
(
¨gv
[0]),árgv[1]);

2366 
	}
}

2368 
	$DEFUN
 (
no_§x_£nd_extcommunôy
,

2369 
no_§x_£nd_extcommunôy_cmd
,

2370 
SRX_VTY_CMD_NO_EXT_CSTR
,

2371 
NO_STR


2372 
SRX_VTY_HLP_NO_EXT_CSTR
)

2374  
	`§x_extcommunôy_un£t
(
vty
->
ödex
);

2375 
	}
}

2379 
	$≥î_ªmŸe_as_vty
 (
vty
 *vty, c⁄° *
≥î_°r
,

2380 c⁄° *
as_°r
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

2382 
ªt
;

2383 
bgp
 *bgp;

2384 
as_t
 
as
;

2385 
sockuni⁄
 
su
;

2387 
bgp
 = 
vty
->
ödex
;

2390 
	`VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
as_°r
, 1, 
BGP_AS4_MAX
);

2393 
ªt
 = 
	`°r2sockuni⁄
 (
≥î_°r
, &
su
);

2394 i‡(
ªt
 < 0)

2396 
ªt
 = 
	`≥î_group_ªmŸe_as
 (
bgp
, 
≥î_°r
, &
as
);

2397 i‡(
ªt
 < 0)

2399 
	`vty_out
 (
vty
, "%% Cª©êthê≥î-grou∞fú°%s", 
VTY_NEWLINE
);

2400  
CMD_WARNING
;

2402  
CMD_SUCCESS
;

2405 i‡(
	`≥î_addªss_£lf_check
 (&
su
))

2407 
	`vty_out
 (
vty
, "%% CanÇot configureÅheÜocal systemásÇeighbor%s",

2408 
VTY_NEWLINE
);

2409  
CMD_WARNING
;

2412 
ªt
 = 
	`≥î_ªmŸe_as
 (
bgp
, &
su
, &
as
, 
afi
, 
ßfi
);

2415 
ªt
)

2417 
BGP_ERR_PEER_GROUP_MEMBER
:

2418 
	`vty_out
 (
vty
, "%% Pìr-grou∞AS %u. C™nŸ c⁄figuªÑemŸe-a†f‹ membî%s", 
as
, 
VTY_NEWLINE
);

2419  
CMD_WARNING
;

2420 
BGP_ERR_PEER_GROUP_PEER_TYPE_DIFFERENT
:

2421 
	`vty_out
 (
vty
, "%% ThêAS# c™ÇŸ bêch™ged from %uÅÿ%s,Öìr-grou∞membî†mu° bêÆ»öã∫Æ o∏Æ»exã∫Æ%s", 
as
, 
as_°r
, 
VTY_NEWLINE
);

2422  
CMD_WARNING
;

2424  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2425 
	}
}

2427 
DEFUN
 (
√ighb‹_ªmŸe_as
,

2428 
√ighb‹_ªmŸe_as_cmd
,

2429 
NEIGHBOR_CMD2
 "ªmŸe-a†" 
CMD_AS_RANGE
,

2430 
NEIGHBOR_STR


2431 
NEIGHBOR_ADDR_STR2


2433 
AS_STR
)

2435  
≥î_ªmŸe_as_vty
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
, 
SAFI_UNICAST
);

2438 
DEFUN
 (
√ighb‹_≥î_group
,

2439 
√ighb‹_≥î_group_cmd
,

2441 
NEIGHBOR_STR


2445 
bgp
 *
	gbgp
;

2446 
≥î_group
 *
	ggroup
;

2448 
	gbgp
 = 
vty
->
ödex
;

2450 
	ggroup
 = 
≥î_group_gë
 (
bgp
, 
¨gv
[0]);

2451 i‡(! 
	ggroup
)

2452  
	gCMD_WARNING
;

2454  
	gCMD_SUCCESS
;

2457 
	$DEFUN
 (
no_√ighb‹
,

2458 
no_√ighb‹_cmd
,

2459 
NO_NEIGHBOR_CMD2
,

2460 
NO_STR


2461 
NEIGHBOR_STR


2462 
NEIGHBOR_ADDR_STR2
)

2464 
ªt
;

2465 
sockuni⁄
 
su
;

2466 
≥î_group
 *
group
;

2467 
≥î
 *peer;

2469 
ªt
 = 
	`°r2sockuni⁄
 (
¨gv
[0], &
su
);

2470 i‡(
ªt
 < 0)

2472 
group
 = 
	`≥î_group_lookup
 (
vty
->
ödex
, 
¨gv
[0]);

2473 i‡(
group
)

2474 
	`≥î_group_dñëe
 (
group
);

2477 
	`vty_out
 (
vty
, "%% Cª©êthê≥î-grou∞fú°%s", 
VTY_NEWLINE
);

2478  
CMD_WARNING
;

2483 
≥î
 = 
	`≥î_lookup
 (
vty
->
ödex
, &
su
);

2484 i‡(
≥î
)

2485 
	`≥î_dñëe
 (
≥î
);

2488  
CMD_SUCCESS
;

2489 
	}
}

2491 
ALIAS
 (
no_√ighb‹
,

2492 
no_√ighb‹_ªmŸe_as_cmd
,

2493 
NO_NEIGHBOR_CMD
 "ªmŸe-a†" 
CMD_AS_RANGE
,

2494 
NO_STR


2495 
NEIGHBOR_STR


2496 
NEIGHBOR_ADDR_STR


2498 
AS_STR
)

2500 
DEFUN
 (
no_√ighb‹_≥î_group
,

2501 
no_√ighb‹_≥î_group_cmd
,

2503 
NO_STR


2504 
NEIGHBOR_STR


2508 
≥î_group
 *
	ggroup
;

2510 
	ggroup
 = 
≥î_group_lookup
 (
vty
->
ödex
, 
¨gv
[0]);

2511 i‡(
	ggroup
)

2512 
≥î_group_dñëe
 (
group
);

2515 
vty_out
 (
vty
, "%% Cª©êthê≥î-grou∞fú°%s", 
VTY_NEWLINE
);

2516  
	gCMD_WARNING
;

2518  
	gCMD_SUCCESS
;

2521 
DEFUN
 (
no_√ighb‹_≥î_group_ªmŸe_as
,

2522 
no_√ighb‹_≥î_group_ªmŸe_as_cmd
,

2523 "nÿ√ighb‹ WORDÑemŸe-a†" 
CMD_AS_RANGE
,

2524 
NO_STR


2525 
NEIGHBOR_STR


2528 
AS_STR
)

2530 
≥î_group
 *
	ggroup
;

2532 
	ggroup
 = 
≥î_group_lookup
 (
vty
->
ödex
, 
¨gv
[0]);

2533 i‡(
	ggroup
)

2534 
≥î_group_ªmŸe_as_dñëe
 (
group
);

2537 
vty_out
 (
vty
, "%% Cª©êthê≥î-grou∞fú°%s", 
VTY_NEWLINE
);

2538  
	gCMD_WARNING
;

2540  
	gCMD_SUCCESS
;

2543 
DEFUN
 (
√ighb‹_loˇl_as
,

2544 
√ighb‹_loˇl_as_cmd
,

2545 
NEIGHBOR_CMD2
 "loˇl-a†" 
CMD_AS_RANGE
,

2546 
NEIGHBOR_STR


2547 
NEIGHBOR_ADDR_STR2


2551 
≥î
 *
	g≥î
;

2552 
	gªt
;

2554 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2555 i‡(! 
	g≥î
)

2556  
	gCMD_WARNING
;

2558 
	gªt
 = 
≥î_loˇl_as_£t
 (
≥î
, 
©oi
 (
¨gv
[1]), 0, 0);

2559  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2562 
DEFUN
 (
√ighb‹_loˇl_as_no_¥ïíd
,

2563 
√ighb‹_loˇl_as_no_¥ïíd_cmd
,

2564 
NEIGHBOR_CMD2
 "loˇl-a†" 
CMD_AS_RANGE
 "Ço-prepend",

2565 
NEIGHBOR_STR


2566 
NEIGHBOR_ADDR_STR2


2571 
≥î
 *
	g≥î
;

2572 
	gªt
;

2574 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2575 i‡(! 
	g≥î
)

2576  
	gCMD_WARNING
;

2578 
	gªt
 = 
≥î_loˇl_as_£t
 (
≥î
, 
©oi
 (
¨gv
[1]), 1, 0);

2579  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2582 
DEFUN
 (
√ighb‹_loˇl_as_no_¥ïíd_ª∂a˚_as
,

2583 
√ighb‹_loˇl_as_no_¥ïíd_ª∂a˚_as_cmd
,

2584 
NEIGHBOR_CMD2
 "loˇl-a†" 
CMD_AS_RANGE
 "Ço-prependÑeplace-as",

2585 
NEIGHBOR_STR


2586 
NEIGHBOR_ADDR_STR2


2592 
≥î
 *
	g≥î
;

2593 
	gªt
;

2595 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2596 i‡(! 
	g≥î
)

2597  
	gCMD_WARNING
;

2599 
	gªt
 = 
≥î_loˇl_as_£t
 (
≥î
, 
©oi
 (
¨gv
[1]), 1, 1);

2600  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2604 
DEFUN
 (
no_√ighb‹_loˇl_as
,

2605 
no_√ighb‹_loˇl_as_cmd
,

2606 
NO_NEIGHBOR_CMD2
 "local-as",

2607 
NO_STR


2608 
NEIGHBOR_STR


2609 
NEIGHBOR_ADDR_STR2


2612 
≥î
 *
	g≥î
;

2613 
	gªt
;

2615 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2616 i‡(! 
	g≥î
)

2617  
	gCMD_WARNING
;

2619 
	gªt
 = 
≥î_loˇl_as_un£t
 (
≥î
);

2620  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2623 
ALIAS
 (
no_√ighb‹_loˇl_as
,

2624 
no_√ighb‹_loˇl_as_vÆ_cmd
,

2625 
NO_NEIGHBOR_CMD2
 "loˇl-a†" 
CMD_AS_RANGE
,

2626 
NO_STR


2627 
NEIGHBOR_STR


2628 
NEIGHBOR_ADDR_STR2


2632 
ALIAS
 (
no_√ighb‹_loˇl_as
,

2633 
no_√ighb‹_loˇl_as_vÆ2_cmd
,

2634 
NO_NEIGHBOR_CMD2
 "loˇl-a†" 
CMD_AS_RANGE
 "Ço-prepend",

2635 
NO_STR


2636 
NEIGHBOR_STR


2637 
NEIGHBOR_ADDR_STR2


2642 
ALIAS
 (
no_√ighb‹_loˇl_as
,

2643 
no_√ighb‹_loˇl_as_vÆ3_cmd
,

2644 
NO_NEIGHBOR_CMD2
 "loˇl-a†" 
CMD_AS_RANGE
 "Ço-prependÑeplace-as",

2645 
NO_STR


2646 
NEIGHBOR_STR


2647 
NEIGHBOR_ADDR_STR2


2653 
DEFUN
 (
√ighb‹_∑ssw‹d
,

2654 
√ighb‹_∑ssw‹d_cmd
,

2655 
NEIGHBOR_CMD2
 "password LINE",

2656 
NEIGHBOR_STR


2657 
NEIGHBOR_ADDR_STR2


2661 
≥î
 *
	g≥î
;

2662 
	gªt
;

2664 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2665 i‡(! 
	g≥î
)

2666  
	gCMD_WARNING
;

2668 
	gªt
 = 
≥î_∑ssw‹d_£t
 (
≥î
, 
¨gv
[1]);

2669  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2672 
DEFUN
 (
no_√ighb‹_∑ssw‹d
,

2673 
no_√ighb‹_∑ssw‹d_cmd
,

2674 
NO_NEIGHBOR_CMD2
 "password",

2675 
NO_STR


2676 
NEIGHBOR_STR


2677 
NEIGHBOR_ADDR_STR2


2680 
≥î
 *
	g≥î
;

2681 
	gªt
;

2683 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2684 i‡(! 
	g≥î
)

2685  
	gCMD_WARNING
;

2687 
	gªt
 = 
≥î_∑ssw‹d_un£t
 (
≥î
);

2688  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2691 
DEFUN
 (
√ighb‹_a˘iv©e
,

2692 
√ighb‹_a˘iv©e_cmd
,

2693 
NEIGHBOR_CMD2
 "activate",

2694 
NEIGHBOR_STR


2695 
NEIGHBOR_ADDR_STR2


2698 
≥î
 *
	g≥î
;

2700 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2701 i‡(! 
	g≥î
)

2702  
	gCMD_WARNING
;

2704 
≥î_a˘iv©e
 (
≥î
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty));

2706  
	gCMD_SUCCESS
;

2709 
DEFUN
 (
no_√ighb‹_a˘iv©e
,

2710 
no_√ighb‹_a˘iv©e_cmd
,

2711 
NO_NEIGHBOR_CMD2
 "activate",

2712 
NO_STR


2713 
NEIGHBOR_STR


2714 
NEIGHBOR_ADDR_STR2


2717 
	gªt
;

2718 
≥î
 *
	g≥î
;

2721 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

2722 i‡(! 
	g≥î
)

2723  
	gCMD_WARNING
;

2725 
	gªt
 = 
≥î_dó˘iv©e
 (
≥î
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty));

2727  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2730 
DEFUN
 (
√ighb‹_£t_≥î_group
,

2731 
√ighb‹_£t_≥î_group_cmd
,

2732 
NEIGHBOR_CMD
 "peer-group WORD",

2733 
NEIGHBOR_STR


2734 
NEIGHBOR_ADDR_STR


2738 
	gªt
;

2739 
as_t
 
	gas
;

2740 
sockuni⁄
 
	gsu
;

2741 
bgp
 *
	gbgp
;

2742 
≥î_group
 *
	ggroup
;

2744 
	gbgp
 = 
vty
->
ödex
;

2746 
	gªt
 = 
°r2sockuni⁄
 (
¨gv
[0], &
su
);

2747 i‡(
	gªt
 < 0)

2749 
vty_out
 (
vty
, "%% MÆf‹medáddªss: %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

2750  
	gCMD_WARNING
;

2753 
	ggroup
 = 
≥î_group_lookup
 (
bgp
, 
¨gv
[1]);

2754 i‡(! 
	ggroup
)

2756 
vty_out
 (
vty
, "%% C⁄figuªÅhê≥î-grou∞fú°%s", 
VTY_NEWLINE
);

2757  
	gCMD_WARNING
;

2760 i‡(
≥î_addªss_£lf_check
 (&
su
))

2762 
vty_out
 (
vty
, "%% CanÇot configureÅheÜocal systemásÇeighbor%s",

2763 
VTY_NEWLINE
);

2764  
	gCMD_WARNING
;

2767 
	gªt
 = 
≥î_group_böd
 (
bgp
, &
su
, 
group
, 
bgp_node_afi
 (
vty
),

2768 
bgp_node_ßfi
 (
vty
), &
as
);

2770 i‡(
	gªt
 =
BGP_ERR_PEER_GROUP_PEER_TYPE_DIFFERENT
)

2772 
vty_out
 (
vty
, "%% Pì∏wôh AS %u c™nŸ bêöÅhi†≥î-group, membî†mu° bêÆ»öã∫Æ o∏Æ»exã∫Æ%s", 
as
, 
VTY_NEWLINE
);

2773  
	gCMD_WARNING
;

2776  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2779 
DEFUN
 (
no_√ighb‹_£t_≥î_group
,

2780 
no_√ighb‹_£t_≥î_group_cmd
,

2781 
NO_NEIGHBOR_CMD
 "peer-group WORD",

2782 
NO_STR


2783 
NEIGHBOR_STR


2784 
NEIGHBOR_ADDR_STR


2788 
	gªt
;

2789 
bgp
 *
	gbgp
;

2790 
≥î
 *
	g≥î
;

2791 
≥î_group
 *
	ggroup
;

2793 
	gbgp
 = 
vty
->
ödex
;

2795 
	g≥î
 = 
≥î_lookup_vty
 (
vty
, 
¨gv
[0]);

2796 i‡(! 
	g≥î
)

2797  
	gCMD_WARNING
;

2799 
	ggroup
 = 
≥î_group_lookup
 (
bgp
, 
¨gv
[1]);

2800 i‡(! 
	ggroup
)

2802 
vty_out
 (
vty
, "%% C⁄figuªÅhê≥î-grou∞fú°%s", 
VTY_NEWLINE
);

2803  
	gCMD_WARNING
;

2806 
	gªt
 = 
≥î_group_unböd
 (
bgp
, 
≥î
, 
group
, 
bgp_node_afi
 (
vty
),

2807 
bgp_node_ßfi
 (
vty
));

2809  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2813 
	$≥î_Êag_modify_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

2814 
u_öt16_t
 
Êag
, 
£t
)

2816 
ªt
;

2817 
≥î
 *peer;

2819 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

2820 i‡(! 
≥î
)

2821  
CMD_WARNING
;

2823 i‡(
£t
)

2824 
ªt
 = 
	`≥î_Êag_£t
 (
≥î
, 
Êag
);

2826 
ªt
 = 
	`≥î_Êag_un£t
 (
≥î
, 
Êag
);

2828  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

2829 
	}
}

2832 
	$≥î_Êag_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
u_öt16_t
 
Êag
)

2834  
	`≥î_Êag_modify_vty
 (
vty
, 
ù_°r
, 
Êag
, 1);

2835 
	}
}

2838 
	$≥î_Êag_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
u_öt16_t
 
Êag
)

2840  
	`≥î_Êag_modify_vty
 (
vty
, 
ù_°r
, 
Êag
, 0);

2841 
	}
}

2844 
DEFUN
 (
√ighb‹_∑ssive
,

2845 
√ighb‹_∑ssive_cmd
,

2846 
NEIGHBOR_CMD2
 "passive",

2847 
NEIGHBOR_STR


2848 
NEIGHBOR_ADDR_STR2


2851  
≥î_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_PASSIVE
);

2854 
DEFUN
 (
no_√ighb‹_∑ssive
,

2855 
no_√ighb‹_∑ssive_cmd
,

2856 
NO_NEIGHBOR_CMD2
 "passive",

2857 
NO_STR


2858 
NEIGHBOR_STR


2859 
NEIGHBOR_ADDR_STR2


2862  
≥î_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_PASSIVE
);

2866 
DEFUN
 (
√ighb‹_shutdown
,

2867 
√ighb‹_shutdown_cmd
,

2868 
NEIGHBOR_CMD2
 "shutdown",

2869 
NEIGHBOR_STR


2870 
NEIGHBOR_ADDR_STR2


2873  
≥î_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_SHUTDOWN
);

2876 
DEFUN
 (
no_√ighb‹_shutdown
,

2877 
no_√ighb‹_shutdown_cmd
,

2878 
NO_NEIGHBOR_CMD2
 "shutdown",

2879 
NO_STR


2880 
NEIGHBOR_STR


2881 
NEIGHBOR_ADDR_STR2


2884  
≥î_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_SHUTDOWN
);

2888 
DEFUN_DEPRECATED
 (
√ighb‹_ˇ∑bûôy_rouã_ª‰esh
,

2889 
√ighb‹_ˇ∑bûôy_rouã_ª‰esh_cmd
,

2890 
NEIGHBOR_CMD2
 "capabilityÑoute-refresh",

2891 
NEIGHBOR_STR


2892 
NEIGHBOR_ADDR_STR2


2896  
	gCMD_SUCCESS
;

2899 
DEFUN_DEPRECATED
 (
no_√ighb‹_ˇ∑bûôy_rouã_ª‰esh
,

2900 
no_√ighb‹_ˇ∑bûôy_rouã_ª‰esh_cmd
,

2901 
NO_NEIGHBOR_CMD2
 "capabilityÑoute-refresh",

2902 
NO_STR


2903 
NEIGHBOR_STR


2904 
NEIGHBOR_ADDR_STR2


2908  
	gCMD_SUCCESS
;

2912 
DEFUN
 (
√ighb‹_ˇ∑bûôy_dy«mic
,

2913 
√ighb‹_ˇ∑bûôy_dy«mic_cmd
,

2914 
NEIGHBOR_CMD2
 "capability dynamic",

2915 
NEIGHBOR_STR


2916 
NEIGHBOR_ADDR_STR2


2920  
≥î_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_DYNAMIC_CAPABILITY
);

2923 
DEFUN
 (
no_√ighb‹_ˇ∑bûôy_dy«mic
,

2924 
no_√ighb‹_ˇ∑bûôy_dy«mic_cmd
,

2925 
NO_NEIGHBOR_CMD2
 "capability dynamic",

2926 
NO_STR


2927 
NEIGHBOR_STR


2928 
NEIGHBOR_ADDR_STR2


2932  
≥î_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_DYNAMIC_CAPABILITY
);

2936 
DEFUN
 (
√ighb‹_d⁄t_ˇ∑bûôy_√gŸüã
,

2937 
√ighb‹_d⁄t_ˇ∑bûôy_√gŸüã_cmd
,

2938 
NEIGHBOR_CMD2
 "dont-capability-negotiate",

2939 
NEIGHBOR_STR


2940 
NEIGHBOR_ADDR_STR2


2943  
≥î_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_DONT_CAPABILITY
);

2946 
DEFUN
 (
no_√ighb‹_d⁄t_ˇ∑bûôy_√gŸüã
,

2947 
no_√ighb‹_d⁄t_ˇ∑bûôy_√gŸüã_cmd
,

2948 
NO_NEIGHBOR_CMD2
 "dont-capability-negotiate",

2949 
NO_STR


2950 
NEIGHBOR_STR


2951 
NEIGHBOR_ADDR_STR2


2954  
≥î_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_DONT_CAPABILITY
);

2957 #ifde‡
USE_SRX


2960 
	$DEFUN
 (
√ighb‹_ˇ∑bûôy_bgp£c
,

2961 
√ighb‹_ˇ∑bûôy_bgp£c_cmd
,

2962 
SRX_VTY_CMD_NEIGHBOR_BGPSEC_MODE
,

2963 
SRX_VTY_HLP_NEIGHBOR_BGPSEC_MODE
)

2965 
u_öt16_t
 
Êag
 = 0;

2967 i‡(
	`°∫cmp
 (
¨gv
[1], "s", 1) == 0)

2969 
Êag
 = 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
 | 
PEER_FLAG_BGPSEC_MPE_IPV4
;

2971 i‡(
	`°∫cmp
 (
¨gv
[1], "re", 2) == 0)

2973 
Êag
 = 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
;

2975 i‡(
	`°∫cmp
 (
¨gv
[1], "b", 1) == 0)

2977 
Êag
 = 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
 | 
PEER_FLAG_BGPSEC_CAPABILITY_RECV


2978 | 
PEER_FLAG_BGPSEC_MPE_IPV4
;

2980 i‡(
	`°∫cmp
 (
¨gv
[1], "m", 1) == 0)

2982 
Êag
 = 
PEER_FLAG_BGPSEC_MIGRATE
;

2984 i‡(
	`°∫cmp
 (
¨gv
[1], "ro", 2) == 0)

2986 
Êag
 = 
PEER_FLAG_BGPSEC_ROUTE_SERVER
;

2990  
CMD_ERR_INCOMPLETE
;

2993  
	`≥î_Êag_£t_vty
(
vty
, 
¨gv
[0], 
Êag
);

2994 
	}
}

2997 
	$DEFUN
 (
no_√ighb‹_ˇ∑bûôy_bgp£c
,

2998 
no_√ighb‹_ˇ∑bûôy_bgp£c_cmd
,

2999 
SRX_VTY_CMD_NO_NEIGHBOR_BGPSEC_MODE
,

3000 
SRX_VTY_HLP_NO_NEIGHBOR_BGPSEC_MODE
)

3002 
u_öt16_t
 
Êag
 = 0;

3004 i‡(
	`°∫cmp
 (
¨gv
[1], "s", 1) == 0)

3006 
Êag
 = 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
 | 
PEER_FLAG_BGPSEC_MPE_IPV4
;

3008 i‡(
	`°∫cmp
 (
¨gv
[1], "re", 2) == 0)

3010 
Êag
 = 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
;

3012 i‡(
	`°∫cmp
 (
¨gv
[1], "b", 1) == 0)

3014 
Êag
 = 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
 | 
PEER_FLAG_BGPSEC_CAPABILITY_RECV


3015 | 
PEER_FLAG_BGPSEC_MPE_IPV4
;

3017 i‡(
	`°∫cmp
 (
¨gv
[1], "m", 1) == 0)

3019 
Êag
 = 
PEER_FLAG_BGPSEC_MIGRATE
;

3021 i‡(
	`°∫cmp
 (
¨gv
[1], "ro", 1) == 0)

3023 
Êag
 = 
PEER_FLAG_BGPSEC_ROUTE_SERVER
;

3027  
CMD_ERR_INCOMPLETE
;

3030  
	`≥î_Êag_un£t_vty
(
vty
, 
¨gv
[0], 
Êag
);

3031 
	}
}

3035 
DEFUN
 (
√ighb‹_bgp£c_m≤Ãi_ùv4
,

3036 
√ighb‹_bgp£c_m≤Ãi_ùv4_cmd
,

3037 
NEIGHBOR_CMD2
 "mpe",

3038 
NEIGHBOR_STR


3039 
NEIGHBOR_ADDR_STR2


3042 
u_öt16_t
 
	gÊag
 = 0;

3044 
	gÊag
 = 
PEER_FLAG_BGPSEC_MPE_IPV4
;

3046 
vty_out
 (
vty
, "This command is deprecatedándÇot usedánymore. " \

3048 
VTY_NEWLINE
);

3051 
≥î_Êag_£t_vty
(
vty
, 
¨gv
[0], 
Êag
);

3052  
	gCMD_WARNING
;

3061 
	$__ªsizeBuf„r
(
≥î
 *≥î, 
size_t
 
√wsize
)

3063 
size_t
 
ﬁdsize
;

3064 if(
≥î
->
ibuf
)

3066 
ﬁdsize
 = 
	`°ªam_gë_size
 (
≥î
->
ibuf
);

3067 i‡(
ﬁdsize
 !
√wsize
)

3069 
√wsize
 = 
	`°ªam_ªsize
 (
≥î
->
ibuf
,Çewsize);

3072 if(
≥î
->
w‹k
)

3074 
ﬁdsize
 = 
	`°ªam_gë_size
 (
≥î
->
w‹k
);

3075 i‡(
ﬁdsize
 !
√wsize
)

3077 
√wsize
 = 
	`°ªam_ªsize
 (
≥î
->
w‹k
,Çewsize);

3080 
	}
}

3085 
	$_£tExãndedMesßgeSuµ‹t
(
vty
 *vty, c⁄° * 
ù
, 
boﬁ
 
íabÀ
)

3087 
≥î
 *≥î = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù
);

3088 * 
msg1
 = 
NULL
;

3089 
ªtVÆ
 = 
CMD_WARNING
;

3091 i‡(
≥î
)

3093 i‡(!
≥î
->
e°ablished
)

3095 
	`__ªsizeBuf„r
(
≥î
, 
íabÀ
 ? 
BGP_MAX_PACKET_SIZE_EXTENDED


3096 : 
BGP_MAX_PACKET_SIZE
);

3097 i‡(
íabÀ
)

3099 
ªtVÆ
 = 
	`≥î_Êag_£t_vty
 (
vty
, 
ù
, 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
);

3103 
ªtVÆ
 = 
	`≥î_Êag_un£t_vty
 (
vty
, 
ù
, 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
);

3105 i‡(
ªtVÆ
 =
CMD_SUCCESS
)

3107 
msg1
 = 
íabÀ
 ? "EnabledÉxtended message capability"

3112 
msg1
 = "Error modifyingÉxtended message capability";

3117 
msg1
 = "Cannot modifyÉxtended message capability while session isÉstablished!\0";

3121 i‡(
msg1
 !
NULL
)

3124 
	`vty_out
 (
vty
, "%†%s", 
msg1
, 
VTY_NEWLINE
);

3127  
ªtVÆ
;

3128 
	}
}

3134 
	$_£tExãndedMesßgeLibîÆ
(
vty
 *vty, c⁄° * 
ù
, 
boﬁ
 
íabÀ
)

3136 
ªtVÆ
 = 
CMD_WARNING
;

3137 * 
msg1
 = 
NULL
;

3138 * 
msg2
 = 
NULL
;

3139 
≥î
 *≥î = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù
);

3141 i‡(
≥î
)

3143 
ªtVÆ
 = 
	`≥î_Êag_£t_vty
(
vty
, 
ù
, 
PEER_FLAG_EXTENDED_MESSAGE_LIBERAL
);

3145 i‡(
ªtVÆ
 =
CMD_SUCCESS
)

3147 i‡(!
íabÀ
)

3150 
msg1
 = "DisabledÉxtended messageÜiberalÖolicy";

3152 i‡(!
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
))

3154 
	`__ªsizeBuf„r
(
≥î
, 
BGP_MAX_PACKET_SIZE
);

3158 
msg2
 = "Extended message capability stilláctive";

3163 
msg1
 = "EnabledÉxtended messageÜiberalÖolicy";

3164 
	`__ªsizeBuf„r
(
≥î
, 
BGP_MAX_PACKET_SIZE_EXTENDED
);

3169 
msg1
 = "Error modifyingÜiberalÖolicy flag!";

3174 i‡(
msg1
 !
NULL
)

3177 
	`vty_out
 (
vty
, "%†%s", 
msg1
, 
VTY_NEWLINE
);

3179 i‡(
msg2
 !
NULL
)

3182 
	`vty_out
 (
vty
, "%†%s", 
msg2
, 
VTY_NEWLINE
);

3185  
ªtVÆ
;

3186 
	}
}

3189 
DEFUN
 (
√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t
,

3190 
√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_cmd
,

3191 
NEIGHBOR_CMD2
 "capabilityÉxtended",

3192 
NEIGHBOR_STR


3193 
NEIGHBOR_ADDR_STR2


3197  
_£tExãndedMesßgeSuµ‹t
(
vty
, 
¨gv
[0], 
åue
);

3200 
DEFUN
 (
no_√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t
,

3201 
no_√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_cmd
,

3202 
NO_NEIGHBOR_CMD2
 "capabilityÉxtended",

3203 
NO_STR


3204 
NEIGHBOR_STR


3205 
NEIGHBOR_ADDR_STR2


3209  
_£tExãndedMesßgeSuµ‹t
(
vty
, 
¨gv
[0], 
Ál£
);

3214 
DEFUN
 (
√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_libîÆ
,

3215 
√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_libîÆ_cmd
,

3216 
NEIGHBOR_CMD2
 "capabilityÉxtendedÜiberal",

3217 
NEIGHBOR_STR


3218 
NEIGHBOR_ADDR_STR2


3223  
_£tExãndedMesßgeLibîÆ
(
vty
, 
¨gv
[0], 
åue
);

3227 
DEFUN
 (
no_√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_libîÆ
,

3228 
no_√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_libîÆ_cmd
,

3229 
NO_NEIGHBOR_CMD2
 "capabilityÉxtended (liberal)",

3230 
NO_STR


3231 
NEIGHBOR_STR


3232 
NEIGHBOR_ADDR_STR2


3237  
_£tExãndedMesßgeLibîÆ
(
vty
, 
¨gv
[0], 
Ál£
);

3243 
	$≥î_af_Êag_modify_vty
 (
vty
 *vty, c⁄° *
≥î_°r
, 
afi_t
 
afi
,

3244 
ßfi_t
 
ßfi
, 
u_öt32_t
 
Êag
, 
£t
)

3246 
ªt
;

3247 
≥î
 *peer;

3249 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
≥î_°r
);

3250 i‡(! 
≥î
)

3251  
CMD_WARNING
;

3253 i‡(
£t
)

3254 
ªt
 = 
	`≥î_af_Êag_£t
 (
≥î
, 
afi
, 
ßfi
, 
Êag
);

3256 
ªt
 = 
	`≥î_af_Êag_un£t
 (
≥î
, 
afi
, 
ßfi
, 
Êag
);

3258  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

3259 
	}
}

3262 
	$≥î_af_Êag_£t_vty
 (
vty
 *vty, c⁄° *
≥î_°r
, 
afi_t
 
afi
,

3263 
ßfi_t
 
ßfi
, 
u_öt32_t
 
Êag
)

3265  
	`≥î_af_Êag_modify_vty
 (
vty
, 
≥î_°r
, 
afi
, 
ßfi
, 
Êag
, 1);

3266 
	}
}

3269 
	$≥î_af_Êag_un£t_vty
 (
vty
 *vty, c⁄° *
≥î_°r
, 
afi_t
 
afi
,

3270 
ßfi_t
 
ßfi
, 
u_öt32_t
 
Êag
)

3272  
	`≥î_af_Êag_modify_vty
 (
vty
, 
≥î_°r
, 
afi
, 
ßfi
, 
Êag
, 0);

3273 
	}
}

3276 
DEFUN
 (
√ighb‹_ˇ∑bûôy_‹f_¥efix
,

3277 
√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
,

3278 
NEIGHBOR_CMD2
 "capability orfÖrefix-list (both|send|receive)",

3279 
NEIGHBOR_STR


3280 
NEIGHBOR_ADDR_STR2


3288 
u_öt16_t
 
	gÊag
 = 0;

3290 i‡(
°∫cmp
 (
¨gv
[1], "s", 1) == 0)

3291 
Êag
 = 
PEER_FLAG_ORF_PREFIX_SM
;

3292 i‡(
°∫cmp
 (
¨gv
[1], "r", 1) == 0)

3293 
Êag
 = 
PEER_FLAG_ORF_PREFIX_RM
;

3294 i‡(
°∫cmp
 (
¨gv
[1], "b", 1) == 0)

3295 
Êag
 = 
PEER_FLAG_ORF_PREFIX_SM
|
PEER_FLAG_ORF_PREFIX_RM
;

3297  
	gCMD_WARNING
;

3299  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3300 
bgp_node_ßfi
 (
vty
), 
Êag
);

3303 
DEFUN
 (
no_√ighb‹_ˇ∑bûôy_‹f_¥efix
,

3304 
no_√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
,

3305 
NO_NEIGHBOR_CMD2
 "capability orfÖrefix-list (both|send|receive)",

3306 
NO_STR


3307 
NEIGHBOR_STR


3308 
NEIGHBOR_ADDR_STR2


3316 
u_öt16_t
 
	gÊag
 = 0;

3318 i‡(
°∫cmp
 (
¨gv
[1], "s", 1) == 0)

3319 
Êag
 = 
PEER_FLAG_ORF_PREFIX_SM
;

3320 i‡(
°∫cmp
 (
¨gv
[1], "r", 1) == 0)

3321 
Êag
 = 
PEER_FLAG_ORF_PREFIX_RM
;

3322 i‡(
°∫cmp
 (
¨gv
[1], "b", 1) == 0)

3323 
Êag
 = 
PEER_FLAG_ORF_PREFIX_SM
|
PEER_FLAG_ORF_PREFIX_RM
;

3325  
	gCMD_WARNING
;

3327  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3328 
bgp_node_ßfi
 (
vty
), 
Êag
);

3332 
DEFUN
 (
√ighb‹_√xth›_£lf
,

3333 
√ighb‹_√xth›_£lf_cmd
,

3334 
NEIGHBOR_CMD2
 "next-hop-self",

3335 
NEIGHBOR_STR


3336 
NEIGHBOR_ADDR_STR2


3339  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3340 
bgp_node_ßfi
 (
vty
), 
PEER_FLAG_NEXTHOP_SELF
);

3343 
DEFUN
 (
no_√ighb‹_√xth›_£lf
,

3344 
no_√ighb‹_√xth›_£lf_cmd
,

3345 
NO_NEIGHBOR_CMD2
 "next-hop-self",

3346 
NO_STR


3347 
NEIGHBOR_STR


3348 
NEIGHBOR_ADDR_STR2


3351  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3352 
bgp_node_ßfi
 (
vty
), 
PEER_FLAG_NEXTHOP_SELF
);

3356 
DEFUN
 (
√ighb‹_ªmove_¥iv©e_as
,

3357 
√ighb‹_ªmove_¥iv©e_as_cmd
,

3358 
NEIGHBOR_CMD2
 "remove-private-AS",

3359 
NEIGHBOR_STR


3360 
NEIGHBOR_ADDR_STR2


3363  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3364 
bgp_node_ßfi
 (
vty
),

3365 
PEER_FLAG_REMOVE_PRIVATE_AS
);

3368 
DEFUN
 (
no_√ighb‹_ªmove_¥iv©e_as
,

3369 
no_√ighb‹_ªmove_¥iv©e_as_cmd
,

3370 
NO_NEIGHBOR_CMD2
 "remove-private-AS",

3371 
NO_STR


3372 
NEIGHBOR_STR


3373 
NEIGHBOR_ADDR_STR2


3376  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3377 
bgp_node_ßfi
 (
vty
),

3378 
PEER_FLAG_REMOVE_PRIVATE_AS
);

3382 
DEFUN
 (
√ighb‹_£nd_communôy
,

3383 
√ighb‹_£nd_communôy_cmd
,

3384 
NEIGHBOR_CMD2
 "send-community",

3385 
NEIGHBOR_STR


3386 
NEIGHBOR_ADDR_STR2


3389  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3390 
bgp_node_ßfi
 (
vty
),

3391 
PEER_FLAG_SEND_COMMUNITY
);

3394 
DEFUN
 (
no_√ighb‹_£nd_communôy
,

3395 
no_√ighb‹_£nd_communôy_cmd
,

3396 
NO_NEIGHBOR_CMD2
 "send-community",

3397 
NO_STR


3398 
NEIGHBOR_STR


3399 
NEIGHBOR_ADDR_STR2


3402  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3403 
bgp_node_ßfi
 (
vty
),

3404 
PEER_FLAG_SEND_COMMUNITY
);

3408 
DEFUN
 (
√ighb‹_£nd_communôy_ty≥
,

3409 
√ighb‹_£nd_communôy_ty≥_cmd
,

3410 
NEIGHBOR_CMD2
 "send-community (both|extended|standard)",

3411 
NEIGHBOR_STR


3412 
NEIGHBOR_ADDR_STR2


3418 i‡(
°∫cmp
 (
¨gv
[1], "s", 1) == 0)

3419  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3420 
bgp_node_ßfi
 (
vty
),

3421 
PEER_FLAG_SEND_COMMUNITY
);

3422 i‡(
°∫cmp
 (
¨gv
[1], "e", 1) == 0)

3423  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3424 
bgp_node_ßfi
 (
vty
),

3425 
PEER_FLAG_SEND_EXT_COMMUNITY
);

3427  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3428 
bgp_node_ßfi
 (
vty
),

3429 (
PEER_FLAG_SEND_COMMUNITY
|

3430 
PEER_FLAG_SEND_EXT_COMMUNITY
));

3433 
DEFUN
 (
no_√ighb‹_£nd_communôy_ty≥
,

3434 
no_√ighb‹_£nd_communôy_ty≥_cmd
,

3435 
NO_NEIGHBOR_CMD2
 "send-community (both|extended|standard)",

3436 
NO_STR


3437 
NEIGHBOR_STR


3438 
NEIGHBOR_ADDR_STR2


3444 i‡(
°∫cmp
 (
¨gv
[1], "s", 1) == 0)

3445  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3446 
bgp_node_ßfi
 (
vty
),

3447 
PEER_FLAG_SEND_COMMUNITY
);

3448 i‡(
°∫cmp
 (
¨gv
[1], "e", 1) == 0)

3449  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3450 
bgp_node_ßfi
 (
vty
),

3451 
PEER_FLAG_SEND_EXT_COMMUNITY
);

3453  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3454 
bgp_node_ßfi
 (
vty
),

3455 (
PEER_FLAG_SEND_COMMUNITY
 |

3456 
PEER_FLAG_SEND_EXT_COMMUNITY
));

3460 
DEFUN
 (
√ighb‹_so·_ªc⁄figuøti⁄
,

3461 
√ighb‹_so·_ªc⁄figuøti⁄_cmd
,

3462 
NEIGHBOR_CMD2
 "soft-reconfiguration inbound",

3463 
NEIGHBOR_STR


3464 
NEIGHBOR_ADDR_STR2


3468  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0],

3469 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty),

3470 
PEER_FLAG_SOFT_RECONFIG
);

3473 
DEFUN
 (
no_√ighb‹_so·_ªc⁄figuøti⁄
,

3474 
no_√ighb‹_so·_ªc⁄figuøti⁄_cmd
,

3475 
NO_NEIGHBOR_CMD2
 "soft-reconfiguration inbound",

3476 
NO_STR


3477 
NEIGHBOR_STR


3478 
NEIGHBOR_ADDR_STR2


3482  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0],

3483 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty),

3484 
PEER_FLAG_SOFT_RECONFIG
);

3487 
DEFUN
 (
√ighb‹_rouã_ªÊe˘‹_˛õ¡
,

3488 
√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
,

3489 
NEIGHBOR_CMD2
 "route-reflector-client",

3490 
NEIGHBOR_STR


3491 
NEIGHBOR_ADDR_STR2


3494 
≥î
 *
	g≥î
;

3497 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

3498 i‡(! 
	g≥î
)

3499  
	gCMD_WARNING
;

3501  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3502 
bgp_node_ßfi
 (
vty
),

3503 
PEER_FLAG_REFLECTOR_CLIENT
);

3506 
DEFUN
 (
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡
,

3507 
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
,

3508 
NO_NEIGHBOR_CMD2
 "route-reflector-client",

3509 
NO_STR


3510 
NEIGHBOR_STR


3511 
NEIGHBOR_ADDR_STR2


3514  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3515 
bgp_node_ßfi
 (
vty
),

3516 
PEER_FLAG_REFLECTOR_CLIENT
);

3520 
	$≥î_rs˛õ¡_£t_vty
 (
vty
 *vty, c⁄° *
≥î_°r
,

3521 
afi
, 
ßfi
)

3523 
ªt
;

3524 
bgp
 *bgp;

3525 
≥î
 *peer;

3526 
≥î_group
 *
group
;

3527 
li°node
 *
node
, *
¬ode
;

3528 
bgp_fûãr
 *
pfûãr
;

3529 
bgp_fûãr
 *
gfûãr
;

3530 
locked_™d_added
 = 0;

3532 
bgp
 = 
vty
->
ödex
;

3534 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
≥î_°r
);

3535 i‡–! 
≥î
 )

3536  
CMD_WARNING
;

3539 i‡–
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
) )

3540  
CMD_SUCCESS
;

3542 i‡–! 
	`≥î_rs˛õ¡_a˘ive
 (
≥î
) )

3544 
≥î
 = 
	`≥î_lock
 (peer);

3545 
	`li°node_add_s‹t
 (
bgp
->
rs˛õ¡
, 
≥î
);

3546 
locked_™d_added
 = 1;

3549 
ªt
 = 
	`≥î_af_Êag_£t
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_RSERVER_CLIENT
);

3550 i‡(
ªt
 < 0)

3552 i‡(
locked_™d_added
)

3554 
	`li°node_dñëe
 (
bgp
->
rs˛õ¡
, 
≥î
);

3555 
	`≥î_u∆ock
 (
≥î
);

3558  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

3561 
≥î
->
rib
[
afi
][
ßfi
] = 
	`bgp_èbÀ_öô
 (afi, safi);

3562 
≥î
->
rib
[
afi
][
ßfi
]->
ty≥
 = 
BGP_TABLE_RSCLIENT
;

3564 
≥î
->
rib
[
afi
][
ßfi
]->
ow√r
 = 
	`≥î_lock
 (peer);

3567 
	`bgp_check_loˇl_rouãs_rs˛õ¡
 (
≥î
, 
afi
, 
ßfi
);

3570 
	`bgp_so·_ªc⁄fig_rs˛õ¡
 (
≥î
, 
afi
, 
ßfi
);

3572 i‡(
	`CHECK_FLAG
(
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3574 
group
 = 
≥î
->group;

3575 
gfûãr
 = &
≥î
->
fûãr
[
afi
][
ßfi
];

3577 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3579 
pfûãr
 = &
≥î
->
fûãr
[
afi
][
ßfi
];

3583 
ªt
 = 
	`≥î_af_Êag_£t
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_RSERVER_CLIENT
);

3584 i‡(
ªt
 < 0)

3585  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

3588 
≥î
->
rib
[
afi
][
ßfi
] = 
group
->
c⁄f
->rib[afi][safi];

3591 i‡(
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

3592 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
);

3593 i‡(
gfûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

3595 
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_IMPORT].name);

3596 
pfûãr
->
m≠
[
RMAP_IMPORT
].m≠ = 
gfûãr
->map[RMAP_IMPORT].map;

3600 
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
 = 
NULL
;

3601 
pfûãr
->
m≠
[
RMAP_IMPORT
].m≠ =
NULL
;

3605 i‡(
gfûãr
->
m≠
[
RMAP_EXPORT
].
«me
 && ! 
pfûãr
->map[RMAP_EXPORT].name)

3607 
pfûãr
->
m≠
[
RMAP_EXPORT
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_EXPORT].name);

3608 
pfûãr
->
m≠
[
RMAP_EXPORT
].m≠ = 
gfûãr
->map[RMAP_EXPORT].map;

3612  
CMD_SUCCESS
;

3613 
	}
}

3616 
	$≥î_rs˛õ¡_un£t_vty
 (
vty
 *vty, c⁄° *
≥î_°r
,

3617 
afi
, 
ßfi
)

3619 
ªt
;

3620 
bgp
 *bgp;

3621 
≥î
 *peer;

3622 
≥î_group
 *
group
;

3623 
li°node
 *
node
, *
¬ode
;

3625 
bgp
 = 
vty
->
ödex
;

3627 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
≥î_°r
);

3628 i‡–! 
≥î
 )

3629  
CMD_WARNING
;

3632 i‡–! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
) )

3633  
CMD_SUCCESS
;

3635 i‡(
	`CHECK_FLAG
(
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3637 
group
 = 
≥î
->group;

3639 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3641 
ªt
 = 
	`≥î_af_Êag_un£t
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_RSERVER_CLIENT
);

3642 i‡(
ªt
 < 0)

3643  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

3645 
≥î
->
rib
[
afi
][
ßfi
] = 
NULL
;

3648 
≥î
 = 
group
->
c⁄f
;

3651 
ªt
 = 
	`≥î_af_Êag_un£t
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_RSERVER_CLIENT
);

3652 i‡(
ªt
 < 0)

3653  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

3655 i‡–! 
	`≥î_rs˛õ¡_a˘ive
 (
≥î
) )

3657 
	`bgp_˛ór_rouã
 (
≥î
, 
afi
, 
ßfi
, 
BGP_CLEAR_ROUTE_MY_RSCLIENT
);

3658 
	`li°node_dñëe
 (
bgp
->
rs˛õ¡
, 
≥î
);

3659 
	`≥î_u∆ock
 (
≥î
);

3662 
	`bgp_èbÀ_föish
 (&
≥î
->
rib
[
	`bgp_node_afi
(
vty
)][
	`bgp_node_ßfi
(vty)]);

3664  
CMD_SUCCESS
;

3665 
	}
}

3668 
DEFUN
 (
√ighb‹_rouã_£rvî_˛õ¡
,

3669 
√ighb‹_rouã_£rvî_˛õ¡_cmd
,

3670 
NEIGHBOR_CMD2
 "route-server-client",

3671 
NEIGHBOR_STR


3672 
NEIGHBOR_ADDR_STR2


3675  
≥î_rs˛õ¡_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
(vty),

3676 
bgp_node_ßfi
(
vty
));

3679 
DEFUN
 (
no_√ighb‹_rouã_£rvî_˛õ¡
,

3680 
no_√ighb‹_rouã_£rvî_˛õ¡_cmd
,

3681 
NO_NEIGHBOR_CMD2
 "route-server-client",

3682 
NO_STR


3683 
NEIGHBOR_STR


3684 
NEIGHBOR_ADDR_STR2


3687  
≥î_rs˛õ¡_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
(vty),

3688 
bgp_node_ßfi
(
vty
));

3691 
DEFUN
 (
√ighb‹_√xth›_loˇl_unch™ged
,

3692 
√ighb‹_√xth›_loˇl_unch™ged_cmd
,

3693 
NEIGHBOR_CMD2
 "nexthop-local unchanged",

3694 
NEIGHBOR_STR


3695 
NEIGHBOR_ADDR_STR2


3699  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3700 
bgp_node_ßfi
 (
vty
),

3701 
PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
 );

3704 
DEFUN
 (
no_√ighb‹_√xth›_loˇl_unch™ged
,

3705 
no_√ighb‹_√xth›_loˇl_unch™ged_cmd
,

3706 
NO_NEIGHBOR_CMD2
 "nexthop-local unchanged",

3707 
NO_STR


3708 
NEIGHBOR_STR


3709 
NEIGHBOR_ADDR_STR2


3713  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3714 
bgp_node_ßfi
 (
vty
),

3715 
PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
 );

3718 
DEFUN
 (
√ighb‹_©å_unch™ged
,

3719 
√ighb‹_©å_unch™ged_cmd
,

3720 
NEIGHBOR_CMD2
 "attribute-unchanged",

3721 
NEIGHBOR_STR


3722 
NEIGHBOR_ADDR_STR2


3725  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3726 
bgp_node_ßfi
 (
vty
),

3727 (
PEER_FLAG_AS_PATH_UNCHANGED
 |

3728 
PEER_FLAG_NEXTHOP_UNCHANGED
 |

3729 
PEER_FLAG_MED_UNCHANGED
));

3732 
DEFUN
 (
√ighb‹_©å_unch™ged1
,

3733 
√ighb‹_©å_unch™ged1_cmd
,

3734 
NEIGHBOR_CMD2
 "attribute-unchanged (as-path|next-hop|med)",

3735 
NEIGHBOR_STR


3736 
NEIGHBOR_ADDR_STR2


3742 
u_öt16_t
 
	gÊags
 = 0;

3744 i‡(
°∫cmp
 (
¨gv
[1], "as-path", 1) == 0)

3745 
SET_FLAG
 (
Êags
, 
PEER_FLAG_AS_PATH_UNCHANGED
);

3746 i‡(
°∫cmp
 (
¨gv
[1], "next-hop", 1) == 0)

3747 
SET_FLAG
 (
Êags
, 
PEER_FLAG_NEXTHOP_UNCHANGED
);

3748 i‡(
°∫cmp
 (
¨gv
[1], "med", 1) == 0)

3749 
SET_FLAG
 (
Êags
, 
PEER_FLAG_MED_UNCHANGED
);

3751  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3752 
bgp_node_ßfi
 (
vty
), 
Êags
);

3755 
DEFUN
 (
√ighb‹_©å_unch™ged2
,

3756 
√ighb‹_©å_unch™ged2_cmd
,

3757 
NEIGHBOR_CMD2
 "attribute-unchangedás-path (next-hop|med)",

3758 
NEIGHBOR_STR


3759 
NEIGHBOR_ADDR_STR2


3765 
u_öt16_t
 
	gÊags
 = 
PEER_FLAG_AS_PATH_UNCHANGED
;

3767 i‡(
°∫cmp
 (
¨gv
[1], "next-hop", 1) == 0)

3768 
SET_FLAG
 (
Êags
, 
PEER_FLAG_NEXTHOP_UNCHANGED
);

3769 i‡(
°∫cmp
 (
¨gv
[1], "med", 1) == 0)

3770 
SET_FLAG
 (
Êags
, 
PEER_FLAG_MED_UNCHANGED
);

3772  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3773 
bgp_node_ßfi
 (
vty
), 
Êags
);

3777 
DEFUN
 (
√ighb‹_©å_unch™ged3
,

3778 
√ighb‹_©å_unch™ged3_cmd
,

3779 
NEIGHBOR_CMD2
 "attribute-unchangedÇext-hop (as-path|med)",

3780 
NEIGHBOR_STR


3781 
NEIGHBOR_ADDR_STR2


3787 
u_öt16_t
 
	gÊags
 = 
PEER_FLAG_NEXTHOP_UNCHANGED
;

3789 i‡(
°∫cmp
 (
¨gv
[1], "as-path", 1) == 0)

3790 
SET_FLAG
 (
Êags
, 
PEER_FLAG_AS_PATH_UNCHANGED
);

3791 i‡(
°∫cmp
 (
¨gv
[1], "med", 1) == 0)

3792 
SET_FLAG
 (
Êags
, 
PEER_FLAG_MED_UNCHANGED
);

3794  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3795 
bgp_node_ßfi
 (
vty
), 
Êags
);

3798 
DEFUN
 (
√ighb‹_©å_unch™ged4
,

3799 
√ighb‹_©å_unch™ged4_cmd
,

3800 
NEIGHBOR_CMD2
 "attribute-unchanged med (as-path|next-hop)",

3801 
NEIGHBOR_STR


3802 
NEIGHBOR_ADDR_STR2


3808 
u_öt16_t
 
	gÊags
 = 
PEER_FLAG_MED_UNCHANGED
;

3810 i‡(
°∫cmp
 (
¨gv
[1], "as-path", 1) == 0)

3811 
SET_FLAG
 (
Êags
, 
PEER_FLAG_AS_PATH_UNCHANGED
);

3812 i‡(
°∫cmp
 (
¨gv
[1], "next-hop", 1) == 0)

3813 
SET_FLAG
 (
Êags
, 
PEER_FLAG_NEXTHOP_UNCHANGED
);

3815  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3816 
bgp_node_ßfi
 (
vty
), 
Êags
);

3819 
ALIAS
 (
√ighb‹_©å_unch™ged
,

3820 
√ighb‹_©å_unch™ged5_cmd
,

3821 
NEIGHBOR_CMD2
 "attribute-unchangedás-pathÇext-hop med",

3822 
NEIGHBOR_STR


3823 
NEIGHBOR_ADDR_STR2


3829 
ALIAS
 (
√ighb‹_©å_unch™ged
,

3830 
√ighb‹_©å_unch™ged6_cmd
,

3831 
NEIGHBOR_CMD2
 "attribute-unchangedás-path medÇext-hop",

3832 
NEIGHBOR_STR


3833 
NEIGHBOR_ADDR_STR2


3839 
ALIAS
 (
√ighb‹_©å_unch™ged
,

3840 
√ighb‹_©å_unch™ged7_cmd
,

3841 
NEIGHBOR_CMD2
 "attribute-unchangedÇext-hop medás-path",

3842 
NEIGHBOR_STR


3843 
NEIGHBOR_ADDR_STR2


3849 
ALIAS
 (
√ighb‹_©å_unch™ged
,

3850 
√ighb‹_©å_unch™ged8_cmd
,

3851 
NEIGHBOR_CMD2
 "attribute-unchangedÇext-hopás-path med",

3852 
NEIGHBOR_STR


3853 
NEIGHBOR_ADDR_STR2


3859 
ALIAS
 (
√ighb‹_©å_unch™ged
,

3860 
√ighb‹_©å_unch™ged9_cmd
,

3861 
NEIGHBOR_CMD2
 "attribute-unchanged medÇext-hopás-path",

3862 
NEIGHBOR_STR


3863 
NEIGHBOR_ADDR_STR2


3869 
ALIAS
 (
√ighb‹_©å_unch™ged
,

3870 
√ighb‹_©å_unch™ged10_cmd
,

3871 
NEIGHBOR_CMD2
 "attribute-unchanged medás-pathÇext-hop",

3872 
NEIGHBOR_STR


3873 
NEIGHBOR_ADDR_STR2


3879 
DEFUN
 (
no_√ighb‹_©å_unch™ged
,

3880 
no_√ighb‹_©å_unch™ged_cmd
,

3881 
NO_NEIGHBOR_CMD2
 "attribute-unchanged",

3882 
NO_STR


3883 
NEIGHBOR_STR


3884 
NEIGHBOR_ADDR_STR2


3887  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3888 
bgp_node_ßfi
 (
vty
),

3889 (
PEER_FLAG_AS_PATH_UNCHANGED
 |

3890 
PEER_FLAG_NEXTHOP_UNCHANGED
 |

3891 
PEER_FLAG_MED_UNCHANGED
));

3894 
DEFUN
 (
no_√ighb‹_©å_unch™ged1
,

3895 
no_√ighb‹_©å_unch™ged1_cmd
,

3896 
NO_NEIGHBOR_CMD2
 "attribute-unchanged (as-path|next-hop|med)",

3897 
NO_STR


3898 
NEIGHBOR_STR


3899 
NEIGHBOR_ADDR_STR2


3905 
u_öt16_t
 
	gÊags
 = 0;

3907 i‡(
°∫cmp
 (
¨gv
[1], "as-path", 1) == 0)

3908 
SET_FLAG
 (
Êags
, 
PEER_FLAG_AS_PATH_UNCHANGED
);

3909 i‡(
°∫cmp
 (
¨gv
[1], "next-hop", 1) == 0)

3910 
SET_FLAG
 (
Êags
, 
PEER_FLAG_NEXTHOP_UNCHANGED
);

3911 i‡(
°∫cmp
 (
¨gv
[1], "med", 1) == 0)

3912 
SET_FLAG
 (
Êags
, 
PEER_FLAG_MED_UNCHANGED
);

3914  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3915 
bgp_node_ßfi
 (
vty
), 
Êags
);

3918 
DEFUN
 (
no_√ighb‹_©å_unch™ged2
,

3919 
no_√ighb‹_©å_unch™ged2_cmd
,

3920 
NO_NEIGHBOR_CMD2
 "attribute-unchangedás-path (next-hop|med)",

3921 
NO_STR


3922 
NEIGHBOR_STR


3923 
NEIGHBOR_ADDR_STR2


3929 
u_öt16_t
 
	gÊags
 = 
PEER_FLAG_AS_PATH_UNCHANGED
;

3931 i‡(
°∫cmp
 (
¨gv
[1], "next-hop", 1) == 0)

3932 
SET_FLAG
 (
Êags
, 
PEER_FLAG_NEXTHOP_UNCHANGED
);

3933 i‡(
°∫cmp
 (
¨gv
[1], "med", 1) == 0)

3934 
SET_FLAG
 (
Êags
, 
PEER_FLAG_MED_UNCHANGED
);

3936  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3937 
bgp_node_ßfi
 (
vty
), 
Êags
);

3940 
DEFUN
 (
no_√ighb‹_©å_unch™ged3
,

3941 
no_√ighb‹_©å_unch™ged3_cmd
,

3942 
NO_NEIGHBOR_CMD2
 "attribute-unchangedÇext-hop (as-path|med)",

3943 
NO_STR


3944 
NEIGHBOR_STR


3945 
NEIGHBOR_ADDR_STR2


3951 
u_öt16_t
 
	gÊags
 = 
PEER_FLAG_NEXTHOP_UNCHANGED
;

3953 i‡(
°∫cmp
 (
¨gv
[1], "as-path", 1) == 0)

3954 
SET_FLAG
 (
Êags
, 
PEER_FLAG_AS_PATH_UNCHANGED
);

3955 i‡(
°∫cmp
 (
¨gv
[1], "med", 1) == 0)

3956 
SET_FLAG
 (
Êags
, 
PEER_FLAG_MED_UNCHANGED
);

3958  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3959 
bgp_node_ßfi
 (
vty
), 
Êags
);

3962 
DEFUN
 (
no_√ighb‹_©å_unch™ged4
,

3963 
no_√ighb‹_©å_unch™ged4_cmd
,

3964 
NO_NEIGHBOR_CMD2
 "attribute-unchanged med (as-path|next-hop)",

3965 
NO_STR


3966 
NEIGHBOR_STR


3967 
NEIGHBOR_ADDR_STR2


3973 
u_öt16_t
 
	gÊags
 = 
PEER_FLAG_MED_UNCHANGED
;

3975 i‡(
°∫cmp
 (
¨gv
[1], "as-path", 1) == 0)

3976 
SET_FLAG
 (
Êags
, 
PEER_FLAG_AS_PATH_UNCHANGED
);

3977 i‡(
°∫cmp
 (
¨gv
[1], "next-hop", 1) == 0)

3978 
SET_FLAG
 (
Êags
, 
PEER_FLAG_NEXTHOP_UNCHANGED
);

3980  
≥î_af_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

3981 
bgp_node_ßfi
 (
vty
), 
Êags
);

3984 
ALIAS
 (
no_√ighb‹_©å_unch™ged
,

3985 
no_√ighb‹_©å_unch™ged5_cmd
,

3986 
NO_NEIGHBOR_CMD2
 "attribute-unchangedás-pathÇext-hop med",

3987 
NO_STR


3988 
NEIGHBOR_STR


3989 
NEIGHBOR_ADDR_STR2


3995 
ALIAS
 (
no_√ighb‹_©å_unch™ged
,

3996 
no_√ighb‹_©å_unch™ged6_cmd
,

3997 
NO_NEIGHBOR_CMD2
 "attribute-unchangedás-path medÇext-hop",

3998 
NO_STR


3999 
NEIGHBOR_STR


4000 
NEIGHBOR_ADDR_STR2


4006 
ALIAS
 (
no_√ighb‹_©å_unch™ged
,

4007 
no_√ighb‹_©å_unch™ged7_cmd
,

4008 
NO_NEIGHBOR_CMD2
 "attribute-unchangedÇext-hop medás-path",

4009 
NO_STR


4010 
NEIGHBOR_STR


4011 
NEIGHBOR_ADDR_STR2


4017 
ALIAS
 (
no_√ighb‹_©å_unch™ged
,

4018 
no_√ighb‹_©å_unch™ged8_cmd
,

4019 
NO_NEIGHBOR_CMD2
 "attribute-unchangedÇext-hopás-path med",

4020 
NO_STR


4021 
NEIGHBOR_STR


4022 
NEIGHBOR_ADDR_STR2


4028 
ALIAS
 (
no_√ighb‹_©å_unch™ged
,

4029 
no_√ighb‹_©å_unch™ged9_cmd
,

4030 
NO_NEIGHBOR_CMD2
 "attribute-unchanged medÇext-hopás-path",

4031 
NO_STR


4032 
NEIGHBOR_STR


4033 
NEIGHBOR_ADDR_STR2


4039 
ALIAS
 (
no_√ighb‹_©å_unch™ged
,

4040 
no_√ighb‹_©å_unch™ged10_cmd
,

4041 
NO_NEIGHBOR_CMD2
 "attribute-unchanged medás-pathÇext-hop",

4042 
NO_STR


4043 
NEIGHBOR_STR


4044 
NEIGHBOR_ADDR_STR2


4051 
DEFUN_DEPRECATED
 (
√ighb‹_å™•¨ít_as
,

4052 
√ighb‹_å™•¨ít_as_cmd
,

4053 
NEIGHBOR_CMD
 "transparent-as",

4054 
NEIGHBOR_STR


4055 
NEIGHBOR_ADDR_STR


4058  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4059 
bgp_node_ßfi
 (
vty
),

4060 
PEER_FLAG_AS_PATH_UNCHANGED
);

4063 
DEFUN_DEPRECATED
 (
√ighb‹_å™•¨ít_√xth›
,

4064 
√ighb‹_å™•¨ít_√xth›_cmd
,

4065 
NEIGHBOR_CMD
 "transparent-nexthop",

4066 
NEIGHBOR_STR


4067 
NEIGHBOR_ADDR_STR


4070  
≥î_af_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4071 
bgp_node_ßfi
 (
vty
),

4072 
PEER_FLAG_NEXTHOP_UNCHANGED
);

4077 
	$≥î_ebgp_mu…ih›_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4078 c⁄° *
âl_°r
)

4080 
≥î
 *peer;

4081 
âl
;

4083 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4084 i‡(! 
≥î
)

4085  
CMD_WARNING
;

4087 i‡(! 
âl_°r
)

4088 
âl
 = 
TTL_MAX
;

4090 
	`VTY_GET_INTEGER_RANGE
 ("TTL", 
âl
, 
âl_°r
, 1, 255);

4092  
	`bgp_vty_ªtu∫
 (
vty
, 
	`≥î_ebgp_mu…ih›_£t
 (
≥î
, 
âl
));

4093 
	}
}

4096 
	$≥î_ebgp_mu…ih›_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
)

4098 
≥î
 *peer;

4100 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4101 i‡(! 
≥î
)

4102  
CMD_WARNING
;

4104  
	`bgp_vty_ªtu∫
 (
vty
, 
	`≥î_ebgp_mu…ih›_un£t
 (
≥î
));

4105 
	}
}

4108 
DEFUN
 (
√ighb‹_ebgp_mu…ih›
,

4109 
√ighb‹_ebgp_mu…ih›_cmd
,

4110 
NEIGHBOR_CMD2
 "ebgp-multihop",

4111 
NEIGHBOR_STR


4112 
NEIGHBOR_ADDR_STR2


4115  
≥î_ebgp_mu…ih›_£t_vty
 (
vty
, 
¨gv
[0], 
NULL
);

4118 
DEFUN
 (
√ighb‹_ebgp_mu…ih›_âl
,

4119 
√ighb‹_ebgp_mu…ih›_âl_cmd
,

4120 
NEIGHBOR_CMD2
 "ebgp-multihop <1-255>",

4121 
NEIGHBOR_STR


4122 
NEIGHBOR_ADDR_STR2


4126  
≥î_ebgp_mu…ih›_£t_vty
 (
vty
, 
¨gv
[0],árgv[1]);

4129 
DEFUN
 (
no_√ighb‹_ebgp_mu…ih›
,

4130 
no_√ighb‹_ebgp_mu…ih›_cmd
,

4131 
NO_NEIGHBOR_CMD2
 "ebgp-multihop",

4132 
NO_STR


4133 
NEIGHBOR_STR


4134 
NEIGHBOR_ADDR_STR2


4137  
≥î_ebgp_mu…ih›_un£t_vty
 (
vty
, 
¨gv
[0]);

4140 
ALIAS
 (
no_√ighb‹_ebgp_mu…ih›
,

4141 
no_√ighb‹_ebgp_mu…ih›_âl_cmd
,

4142 
NO_NEIGHBOR_CMD2
 "ebgp-multihop <1-255>",

4143 
NO_STR


4144 
NEIGHBOR_STR


4145 
NEIGHBOR_ADDR_STR2


4150 
DEFUN
 (
√ighb‹_dißbÀ_c⁄√˘ed_check
,

4151 
√ighb‹_dißbÀ_c⁄√˘ed_check_cmd
,

4152 
NEIGHBOR_CMD2
 "disable-connected-check",

4153 
NEIGHBOR_STR


4154 
NEIGHBOR_ADDR_STR2


4157  
≥î_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_DISABLE_CONNECTED_CHECK
);

4160 
DEFUN
 (
no_√ighb‹_dißbÀ_c⁄√˘ed_check
,

4161 
no_√ighb‹_dißbÀ_c⁄√˘ed_check_cmd
,

4162 
NO_NEIGHBOR_CMD2
 "disable-connected-check",

4163 
NO_STR


4164 
NEIGHBOR_STR


4165 
NEIGHBOR_ADDR_STR2


4168  
≥î_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_DISABLE_CONNECTED_CHECK
);

4172 
ALIAS
 (
√ighb‹_dißbÀ_c⁄√˘ed_check
,

4173 
√ighb‹_íf‹˚_mu…ih›_cmd
,

4174 
NEIGHBOR_CMD2
 "enforce-multihop",

4175 
NEIGHBOR_STR


4176 
NEIGHBOR_ADDR_STR2


4180 
ALIAS
 (
no_√ighb‹_dißbÀ_c⁄√˘ed_check
,

4181 
no_√ighb‹_íf‹˚_mu…ih›_cmd
,

4182 
NO_NEIGHBOR_CMD2
 "enforce-multihop",

4183 
NO_STR


4184 
NEIGHBOR_STR


4185 
NEIGHBOR_ADDR_STR2


4188 
DEFUN
 (
√ighb‹_des¸ùti⁄
,

4189 
√ighb‹_des¸ùti⁄_cmd
,

4190 
NEIGHBOR_CMD2
 "description .LINE",

4191 
NEIGHBOR_STR


4192 
NEIGHBOR_ADDR_STR2


4196 
≥î
 *
	g≥î
;

4197 *
	g°r
;

4199 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

4200 i‡(! 
	g≥î
)

4201  
	gCMD_WARNING
;

4203 i‡(
	g¨gc
 == 1)

4204  
CMD_SUCCESS
;

4206 
	g°r
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 1);

4208 
≥î_des¸ùti⁄_£t
 (
≥î
, 
°r
);

4210 
XFREE
 (
MTYPE_TMP
, 
°r
);

4212  
	gCMD_SUCCESS
;

4215 
DEFUN
 (
no_√ighb‹_des¸ùti⁄
,

4216 
no_√ighb‹_des¸ùti⁄_cmd
,

4217 
NO_NEIGHBOR_CMD2
 "description",

4218 
NO_STR


4219 
NEIGHBOR_STR


4220 
NEIGHBOR_ADDR_STR2


4223 
≥î
 *
	g≥î
;

4225 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

4226 i‡(! 
	g≥î
)

4227  
	gCMD_WARNING
;

4229 
≥î_des¸ùti⁄_un£t
 (
≥î
);

4231  
	gCMD_SUCCESS
;

4234 
ALIAS
 (
no_√ighb‹_des¸ùti⁄
,

4235 
no_√ighb‹_des¸ùti⁄_vÆ_cmd
,

4236 
NO_NEIGHBOR_CMD2
 "description .LINE",

4237 
NO_STR


4238 
NEIGHBOR_STR


4239 
NEIGHBOR_ADDR_STR2


4245 
	$≥î_upd©e_sour˚_vty
 (
vty
 *vty, c⁄° *
≥î_°r
,

4246 c⁄° *
sour˚_°r
)

4248 
≥î
 *peer;

4250 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
≥î_°r
);

4251 i‡(! 
≥î
)

4252  
CMD_WARNING
;

4254 i‡(
sour˚_°r
)

4256 
sockuni⁄
 
su
;

4257 
ªt
 = 
	`°r2sockuni⁄
 (
sour˚_°r
, &
su
);

4259 i‡(
ªt
 == 0)

4260 
	`≥î_upd©e_sour˚_addr_£t
 (
≥î
, &
su
);

4262 
	`≥î_upd©e_sour˚_if_£t
 (
≥î
, 
sour˚_°r
);

4265 
	`≥î_upd©e_sour˚_un£t
 (
≥î
);

4267  
CMD_SUCCESS
;

4268 
	}
}

4270 
	#BGP_UPDATE_SOURCE_STR
 "(A.B.C.D|X:X::X:X|WORD)"

	)

4271 
	#BGP_UPDATE_SOURCE_HELP_STR
 \

4274 "I¡îÁ˚Çamê‘equúe†zebøÅÿbêru¬ög)\n"

	)

4276 
DEFUN
 (
√ighb‹_upd©e_sour˚
,

4277 
√ighb‹_upd©e_sour˚_cmd
,

4278 
NEIGHBOR_CMD2
 "upd©e-sour˚ " 
BGP_UPDATE_SOURCE_STR
,

4279 
NEIGHBOR_STR


4280 
NEIGHBOR_ADDR_STR2


4282 
BGP_UPDATE_SOURCE_HELP_STR
)

4284  
≥î_upd©e_sour˚_vty
 (
vty
, 
¨gv
[0],árgv[1]);

4287 
DEFUN
 (
no_√ighb‹_upd©e_sour˚
,

4288 
no_√ighb‹_upd©e_sour˚_cmd
,

4289 
NO_NEIGHBOR_CMD2
 "update-source",

4290 
NO_STR


4291 
NEIGHBOR_STR


4292 
NEIGHBOR_ADDR_STR2


4295  
≥î_upd©e_sour˚_vty
 (
vty
, 
¨gv
[0], 
NULL
);

4299 
	$≥î_deÁu…_‹igö©e_£t_vty
 (
vty
 *vty, c⁄° *
≥î_°r
,

4300 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

4301 c⁄° *
rm≠
, 
£t
)

4303 
ªt
;

4304 
≥î
 *peer;

4306 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
≥î_°r
);

4307 i‡(! 
≥î
)

4308  
CMD_WARNING
;

4310 i‡(
£t
)

4311 
ªt
 = 
	`≥î_deÁu…_‹igö©e_£t
 (
≥î
, 
afi
, 
ßfi
, 
rm≠
);

4313 
ªt
 = 
	`≥î_deÁu…_‹igö©e_un£t
 (
≥î
, 
afi
, 
ßfi
);

4315  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4316 
	}
}

4319 
DEFUN
 (
√ighb‹_deÁu…_‹igö©e
,

4320 
√ighb‹_deÁu…_‹igö©e_cmd
,

4321 
NEIGHBOR_CMD2
 "default-originate",

4322 
NEIGHBOR_STR


4323 
NEIGHBOR_ADDR_STR2


4326  
≥î_deÁu…_‹igö©e_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4327 
bgp_node_ßfi
 (
vty
), 
NULL
, 1);

4330 
DEFUN
 (
√ighb‹_deÁu…_‹igö©e_rm≠
,

4331 
√ighb‹_deÁu…_‹igö©e_rm≠_cmd
,

4332 
NEIGHBOR_CMD2
 "default-originateÑoute-map WORD",

4333 
NEIGHBOR_STR


4334 
NEIGHBOR_ADDR_STR2


4339  
≥î_deÁu…_‹igö©e_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4340 
bgp_node_ßfi
 (
vty
), 
¨gv
[1], 1);

4343 
DEFUN
 (
no_√ighb‹_deÁu…_‹igö©e
,

4344 
no_√ighb‹_deÁu…_‹igö©e_cmd
,

4345 
NO_NEIGHBOR_CMD2
 "default-originate",

4346 
NO_STR


4347 
NEIGHBOR_STR


4348 
NEIGHBOR_ADDR_STR2


4351  
≥î_deÁu…_‹igö©e_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4352 
bgp_node_ßfi
 (
vty
), 
NULL
, 0);

4355 
ALIAS
 (
no_√ighb‹_deÁu…_‹igö©e
,

4356 
no_√ighb‹_deÁu…_‹igö©e_rm≠_cmd
,

4357 
NO_NEIGHBOR_CMD2
 "default-originateÑoute-map WORD",

4358 
NO_STR


4359 
NEIGHBOR_STR


4360 
NEIGHBOR_ADDR_STR2


4367 
	$≥î_p‹t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi
,

4368 c⁄° *
p‹t_°r
)

4370 
≥î
 *peer;

4371 
u_öt16_t
 
p‹t
;

4372 
£rvít
 *
•
;

4374 
≥î
 = 
	`≥î_lookup_vty
 (
vty
, 
ù_°r
);

4375 i‡(! 
≥î
)

4376  
CMD_WARNING
;

4378 i‡(! 
p‹t_°r
)

4380 
•
 = 
	`gë£rvby«me
 ("bgp", "tcp");

4381 
p‹t
 = (
•
 =
NULL
Ë? 
BGP_PORT_DEFAULT
 : 
	`¡ohs
 (•->
s_p‹t
);

4385 
	`VTY_GET_INTEGER
("p‹t", 
p‹t
, 
p‹t_°r
);

4388 
	`≥î_p‹t_£t
 (
≥î
, 
p‹t
);

4390  
CMD_SUCCESS
;

4391 
	}
}

4394 
DEFUN
 (
√ighb‹_p‹t
,

4395 
√ighb‹_p‹t_cmd
,

4396 
NEIGHBOR_CMD
 "port <0-65535>",

4397 
NEIGHBOR_STR


4398 
NEIGHBOR_ADDR_STR


4402  
≥î_p‹t_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
,árgv[1]);

4405 
DEFUN
 (
no_√ighb‹_p‹t
,

4406 
no_√ighb‹_p‹t_cmd
,

4407 
NO_NEIGHBOR_CMD
 "port",

4408 
NO_STR


4409 
NEIGHBOR_STR


4410 
NEIGHBOR_ADDR_STR


4413  
≥î_p‹t_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
NULL
);

4416 
ALIAS
 (
no_√ighb‹_p‹t
,

4417 
no_√ighb‹_p‹t_vÆ_cmd
,

4418 
NO_NEIGHBOR_CMD
 "port <0-65535>",

4419 
NO_STR


4420 
NEIGHBOR_STR


4421 
NEIGHBOR_ADDR_STR


4427 
	$≥î_weight_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4428 c⁄° *
weight_°r
)

4430 
ªt
;

4431 
≥î
 *peer;

4432 
weight
;

4434 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4435 i‡(! 
≥î
)

4436  
CMD_WARNING
;

4438 
	`VTY_GET_INTEGER_RANGE
("weight", 
weight
, 
weight_°r
, 0, 65535);

4440 
ªt
 = 
	`≥î_weight_£t
 (
≥î
, 
weight
);

4442  
CMD_SUCCESS
;

4443 
	}
}

4446 
	$≥î_weight_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
)

4448 
≥î
 *peer;

4450 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4451 i‡(! 
≥î
)

4452  
CMD_WARNING
;

4454 
	`≥î_weight_un£t
 (
≥î
);

4456  
CMD_SUCCESS
;

4457 
	}
}

4459 
DEFUN
 (
√ighb‹_weight
,

4460 
√ighb‹_weight_cmd
,

4461 
NEIGHBOR_CMD2
 "weight <0-65535>",

4462 
NEIGHBOR_STR


4463 
NEIGHBOR_ADDR_STR2


4467  
≥î_weight_£t_vty
 (
vty
, 
¨gv
[0],árgv[1]);

4470 
DEFUN
 (
no_√ighb‹_weight
,

4471 
no_√ighb‹_weight_cmd
,

4472 
NO_NEIGHBOR_CMD2
 "weight",

4473 
NO_STR


4474 
NEIGHBOR_STR


4475 
NEIGHBOR_ADDR_STR2


4478  
≥î_weight_un£t_vty
 (
vty
, 
¨gv
[0]);

4481 
ALIAS
 (
no_√ighb‹_weight
,

4482 
no_√ighb‹_weight_vÆ_cmd
,

4483 
NO_NEIGHBOR_CMD2
 "weight <0-65535>",

4484 
NO_STR


4485 
NEIGHBOR_STR


4486 
NEIGHBOR_ADDR_STR2


4491 
DEFUN
 (
√ighb‹_ovîride_ˇ∑bûôy
,

4492 
√ighb‹_ovîride_ˇ∑bûôy_cmd
,

4493 
NEIGHBOR_CMD2
 "override-capability",

4494 
NEIGHBOR_STR


4495 
NEIGHBOR_ADDR_STR2


4498  
≥î_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_OVERRIDE_CAPABILITY
);

4501 
DEFUN
 (
no_√ighb‹_ovîride_ˇ∑bûôy
,

4502 
no_√ighb‹_ovîride_ˇ∑bûôy_cmd
,

4503 
NO_NEIGHBOR_CMD2
 "override-capability",

4504 
NO_STR


4505 
NEIGHBOR_STR


4506 
NEIGHBOR_ADDR_STR2


4509  
≥î_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_OVERRIDE_CAPABILITY
);

4512 
DEFUN
 (
√ighb‹_°ri˘_ˇ∑bûôy
,

4513 
√ighb‹_°ri˘_ˇ∑bûôy_cmd
,

4514 
NEIGHBOR_CMD
 "strict-capability-match",

4515 
NEIGHBOR_STR


4516 
NEIGHBOR_ADDR_STR


4519  
≥î_Êag_£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_STRICT_CAP_MATCH
);

4522 
DEFUN
 (
no_√ighb‹_°ri˘_ˇ∑bûôy
,

4523 
no_√ighb‹_°ri˘_ˇ∑bûôy_cmd
,

4524 
NO_NEIGHBOR_CMD
 "strict-capability-match",

4525 
NO_STR


4526 
NEIGHBOR_STR


4527 
NEIGHBOR_ADDR_STR


4530  
≥î_Êag_un£t_vty
 (
vty
, 
¨gv
[0], 
PEER_FLAG_STRICT_CAP_MATCH
);

4534 
	$≥î_timîs_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4535 c⁄° *
kìp_°r
, c⁄° *
hﬁd_°r
)

4537 
ªt
;

4538 
≥î
 *peer;

4539 
u_öt32_t
 
kì∑live
;

4540 
u_öt32_t
 
hﬁdtime
;

4542 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4543 i‡(! 
≥î
)

4544  
CMD_WARNING
;

4546 
	`VTY_GET_INTEGER_RANGE
 ("Kì∑live", 
kì∑live
, 
kìp_°r
, 0, 65535);

4547 
	`VTY_GET_INTEGER_RANGE
 ("Hﬁdtime", 
hﬁdtime
, 
hﬁd_°r
, 0, 65535);

4549 
ªt
 = 
	`≥î_timîs_£t
 (
≥î
, 
kì∑live
, 
hﬁdtime
);

4551  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4552 
	}
}

4555 
	$≥î_timîs_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
)

4557 
ªt
;

4558 
≥î
 *peer;

4560 
≥î
 = 
	`≥î_lookup_vty
 (
vty
, 
ù_°r
);

4561 i‡(! 
≥î
)

4562  
CMD_WARNING
;

4564 
ªt
 = 
	`≥î_timîs_un£t
 (
≥î
);

4566  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4567 
	}
}

4569 
DEFUN
 (
√ighb‹_timîs
,

4570 
√ighb‹_timîs_cmd
,

4571 
NEIGHBOR_CMD2
 "timers <0-65535> <0-65535>",

4572 
NEIGHBOR_STR


4573 
NEIGHBOR_ADDR_STR2


4578  
≥î_timîs_£t_vty
 (
vty
, 
¨gv
[0],árgv[1],árgv[2]);

4581 
DEFUN
 (
no_√ighb‹_timîs
,

4582 
no_√ighb‹_timîs_cmd
,

4583 
NO_NEIGHBOR_CMD2
 "timers",

4584 
NO_STR


4585 
NEIGHBOR_STR


4586 
NEIGHBOR_ADDR_STR2


4589  
≥î_timîs_un£t_vty
 (
vty
, 
¨gv
[0]);

4593 
	$≥î_timîs_c⁄√˘_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4594 c⁄° *
time_°r
)

4596 
ªt
;

4597 
≥î
 *peer;

4598 
u_öt32_t
 
c⁄√˘
;

4600 
≥î
 = 
	`≥î_lookup_vty
 (
vty
, 
ù_°r
);

4601 i‡(! 
≥î
)

4602  
CMD_WARNING
;

4604 
	`VTY_GET_INTEGER_RANGE
 ("C⁄√˘Åime", 
c⁄√˘
, 
time_°r
, 0, 65535);

4606 
ªt
 = 
	`≥î_timîs_c⁄√˘_£t
 (
≥î
, 
c⁄√˘
);

4608  
CMD_SUCCESS
;

4609 
	}
}

4612 
	$≥î_timîs_c⁄√˘_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
)

4614 
ªt
;

4615 
≥î
 *peer;

4617 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4618 i‡(! 
≥î
)

4619  
CMD_WARNING
;

4621 
ªt
 = 
	`≥î_timîs_c⁄√˘_un£t
 (
≥î
);

4623  
CMD_SUCCESS
;

4624 
	}
}

4626 
DEFUN
 (
√ighb‹_timîs_c⁄√˘
,

4627 
√ighb‹_timîs_c⁄√˘_cmd
,

4628 
NEIGHBOR_CMD
 "timers connect <0-65535>",

4629 
NEIGHBOR_STR


4630 
NEIGHBOR_ADDR_STR


4635  
≥î_timîs_c⁄√˘_£t_vty
 (
vty
, 
¨gv
[0],árgv[1]);

4638 
DEFUN
 (
no_√ighb‹_timîs_c⁄√˘
,

4639 
no_√ighb‹_timîs_c⁄√˘_cmd
,

4640 
NO_NEIGHBOR_CMD
 "timers connect",

4641 
NO_STR


4642 
NEIGHBOR_STR


4643 
NEIGHBOR_ADDR_STR


4647  
≥î_timîs_c⁄√˘_un£t_vty
 (
vty
, 
¨gv
[0]);

4650 
ALIAS
 (
no_√ighb‹_timîs_c⁄√˘
,

4651 
no_√ighb‹_timîs_c⁄√˘_vÆ_cmd
,

4652 
NO_NEIGHBOR_CMD
 "timers connect <0-65535>",

4653 
NO_STR


4654 
NEIGHBOR_STR


4655 
NEIGHBOR_ADDR_STR


4661 
	$≥î_advîti£_öãrvÆ_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4662 c⁄° *
time_°r
, 
£t
)

4664 
ªt
;

4665 
≥î
 *peer;

4666 
u_öt32_t
 
rouãadv
 = 0;

4668 
≥î
 = 
	`≥î_lookup_vty
 (
vty
, 
ù_°r
);

4669 i‡(! 
≥î
)

4670  
CMD_WARNING
;

4672 i‡(
time_°r
)

4673 
	`VTY_GET_INTEGER_RANGE
 ("advîti£ i¡îvÆ", 
rouãadv
, 
time_°r
, 0, 600);

4675 i‡(
£t
)

4676 
ªt
 = 
	`≥î_advîti£_öãrvÆ_£t
 (
≥î
, 
rouãadv
);

4678 
ªt
 = 
	`≥î_advîti£_öãrvÆ_un£t
 (
≥î
);

4680  
CMD_SUCCESS
;

4681 
	}
}

4683 
DEFUN
 (
√ighb‹_advîti£_öãrvÆ
,

4684 
√ighb‹_advîti£_öãrvÆ_cmd
,

4685 
NEIGHBOR_CMD
 "advertisement-interval <0-600>",

4686 
NEIGHBOR_STR


4687 
NEIGHBOR_ADDR_STR


4691  
≥î_advîti£_öãrvÆ_vty
 (
vty
, 
¨gv
[0],árgv[1], 1);

4694 
DEFUN
 (
no_√ighb‹_advîti£_öãrvÆ
,

4695 
no_√ighb‹_advîti£_öãrvÆ_cmd
,

4696 
NO_NEIGHBOR_CMD
 "advertisement-interval",

4697 
NO_STR


4698 
NEIGHBOR_STR


4699 
NEIGHBOR_ADDR_STR


4702  
≥î_advîti£_öãrvÆ_vty
 (
vty
, 
¨gv
[0], 
NULL
, 0);

4705 
ALIAS
 (
no_√ighb‹_advîti£_öãrvÆ
,

4706 
no_√ighb‹_advîti£_öãrvÆ_vÆ_cmd
,

4707 
NO_NEIGHBOR_CMD
 "advertisement-interval <0-600>",

4708 
NO_STR


4709 
NEIGHBOR_STR


4710 
NEIGHBOR_ADDR_STR


4716 
	$≥î_öãrÁ˚_vty
 (
vty
 *vty, c⁄° *
ù_°r
, c⁄° *
°r
)

4718 
ªt
;

4719 
≥î
 *peer;

4721 
≥î
 = 
	`≥î_lookup_vty
 (
vty
, 
ù_°r
);

4722 i‡(! 
≥î
)

4723  
CMD_WARNING
;

4725 i‡(
°r
)

4726 
ªt
 = 
	`≥î_öãrÁ˚_£t
 (
≥î
, 
°r
);

4728 
ªt
 = 
	`≥î_öãrÁ˚_un£t
 (
≥î
);

4730  
CMD_SUCCESS
;

4731 
	}
}

4733 
DEFUN
 (
√ighb‹_öãrÁ˚
,

4734 
√ighb‹_öãrÁ˚_cmd
,

4735 
NEIGHBOR_CMD
 "interface WORD",

4736 
NEIGHBOR_STR


4737 
NEIGHBOR_ADDR_STR


4741  
≥î_öãrÁ˚_vty
 (
vty
, 
¨gv
[0],árgv[1]);

4744 
DEFUN
 (
no_√ighb‹_öãrÁ˚
,

4745 
no_√ighb‹_öãrÁ˚_cmd
,

4746 
NO_NEIGHBOR_CMD
 "interface WORD",

4747 
NO_STR


4748 
NEIGHBOR_STR


4749 
NEIGHBOR_ADDR_STR


4753  
≥î_öãrÁ˚_vty
 (
vty
, 
¨gv
[0], 
NULL
);

4758 
	$≥î_di°ribuã_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4759 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

4760 c⁄° *
«me_°r
, c⁄° *
dúe˘_°r
)

4762 
ªt
;

4763 
≥î
 *peer;

4764 
dúe˘
 = 
FILTER_IN
;

4766 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4767 i‡(! 
≥î
)

4768  
CMD_WARNING
;

4771 i‡(
	`°∫cmp
 (
dúe˘_°r
, "i", 1) == 0)

4772 
dúe˘
 = 
FILTER_IN
;

4773 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

4774 
dúe˘
 = 
FILTER_OUT
;

4776 
ªt
 = 
	`≥î_di°ribuã_£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
, 
«me_°r
);

4778  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4779 
	}
}

4782 
	$≥î_di°ribuã_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

4783 
ßfi_t
 
ßfi
, c⁄° *
dúe˘_°r
)

4785 
ªt
;

4786 
≥î
 *peer;

4787 
dúe˘
 = 
FILTER_IN
;

4789 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4790 i‡(! 
≥î
)

4791  
CMD_WARNING
;

4794 i‡(
	`°∫cmp
 (
dúe˘_°r
, "i", 1) == 0)

4795 
dúe˘
 = 
FILTER_IN
;

4796 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

4797 
dúe˘
 = 
FILTER_OUT
;

4799 
ªt
 = 
	`≥î_di°ribuã_un£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
);

4801  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4802 
	}
}

4804 
DEFUN
 (
√ighb‹_di°ribuã_li°
,

4805 
√ighb‹_di°ribuã_li°_cmd
,

4806 
NEIGHBOR_CMD2
 "distribute-list (<1-199>|<1300-2699>|WORD) (in|out)",

4807 
NEIGHBOR_STR


4808 
NEIGHBOR_ADDR_STR2


4816  
≥î_di°ribuã_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4817 
bgp_node_ßfi
 (
vty
), 
¨gv
[1],árgv[2]);

4820 
DEFUN
 (
no_√ighb‹_di°ribuã_li°
,

4821 
no_√ighb‹_di°ribuã_li°_cmd
,

4822 
NO_NEIGHBOR_CMD2
 "distribute-list (<1-199>|<1300-2699>|WORD) (in|out)",

4823 
NO_STR


4824 
NEIGHBOR_STR


4825 
NEIGHBOR_ADDR_STR2


4833  
≥î_di°ribuã_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4834 
bgp_node_ßfi
 (
vty
), 
¨gv
[2]);

4839 
	$≥î_¥efix_li°_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

4840 
ßfi_t
 
ßfi
, c⁄° *
«me_°r
,

4841 c⁄° *
dúe˘_°r
)

4843 
ªt
;

4844 
≥î
 *peer;

4845 
dúe˘
 = 
FILTER_IN
;

4847 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4848 i‡(! 
≥î
)

4849  
CMD_WARNING
;

4852 i‡(
	`°∫cmp
 (
dúe˘_°r
, "i", 1) == 0)

4853 
dúe˘
 = 
FILTER_IN
;

4854 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

4855 
dúe˘
 = 
FILTER_OUT
;

4857 
ªt
 = 
	`≥î_¥efix_li°_£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
, 
«me_°r
);

4859  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4860 
	}
}

4863 
	$≥î_¥efix_li°_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

4864 
ßfi_t
 
ßfi
, c⁄° *
dúe˘_°r
)

4866 
ªt
;

4867 
≥î
 *peer;

4868 
dúe˘
 = 
FILTER_IN
;

4870 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4871 i‡(! 
≥î
)

4872  
CMD_WARNING
;

4875 i‡(
	`°∫cmp
 (
dúe˘_°r
, "i", 1) == 0)

4876 
dúe˘
 = 
FILTER_IN
;

4877 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

4878 
dúe˘
 = 
FILTER_OUT
;

4880 
ªt
 = 
	`≥î_¥efix_li°_un£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
);

4882  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4883 
	}
}

4885 
DEFUN
 (
√ighb‹_¥efix_li°
,

4886 
√ighb‹_¥efix_li°_cmd
,

4887 
NEIGHBOR_CMD2
 "prefix-list WORD (in|out)",

4888 
NEIGHBOR_STR


4889 
NEIGHBOR_ADDR_STR2


4895  
≥î_¥efix_li°_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4896 
bgp_node_ßfi
 (
vty
), 
¨gv
[1],árgv[2]);

4899 
DEFUN
 (
no_√ighb‹_¥efix_li°
,

4900 
no_√ighb‹_¥efix_li°_cmd
,

4901 
NO_NEIGHBOR_CMD2
 "prefix-list WORD (in|out)",

4902 
NO_STR


4903 
NEIGHBOR_STR


4904 
NEIGHBOR_ADDR_STR2


4910  
≥î_¥efix_li°_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4911 
bgp_node_ßfi
 (
vty
), 
¨gv
[2]);

4915 
	$≥î_a¶i°_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4916 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

4917 c⁄° *
«me_°r
, c⁄° *
dúe˘_°r
)

4919 
ªt
;

4920 
≥î
 *peer;

4921 
dúe˘
 = 
FILTER_IN
;

4923 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4924 i‡(! 
≥î
)

4925  
CMD_WARNING
;

4928 i‡(
	`°∫cmp
 (
dúe˘_°r
, "i", 1) == 0)

4929 
dúe˘
 = 
FILTER_IN
;

4930 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

4931 
dúe˘
 = 
FILTER_OUT
;

4933 
ªt
 = 
	`≥î_a¶i°_£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
, 
«me_°r
);

4935  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4936 
	}
}

4939 
	$≥î_a¶i°_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4940 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

4941 c⁄° *
dúe˘_°r
)

4943 
ªt
;

4944 
≥î
 *peer;

4945 
dúe˘
 = 
FILTER_IN
;

4947 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

4948 i‡(! 
≥î
)

4949  
CMD_WARNING
;

4952 i‡(
	`°∫cmp
 (
dúe˘_°r
, "i", 1) == 0)

4953 
dúe˘
 = 
FILTER_IN
;

4954 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

4955 
dúe˘
 = 
FILTER_OUT
;

4957 
ªt
 = 
	`≥î_a¶i°_un£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
);

4959  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

4960 
	}
}

4962 
DEFUN
 (
√ighb‹_fûãr_li°
,

4963 
√ighb‹_fûãr_li°_cmd
,

4964 
NEIGHBOR_CMD2
 "filter-list WORD (in|out)",

4965 
NEIGHBOR_STR


4966 
NEIGHBOR_ADDR_STR2


4972  
≥î_a¶i°_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4973 
bgp_node_ßfi
 (
vty
), 
¨gv
[1],árgv[2]);

4976 
DEFUN
 (
no_√ighb‹_fûãr_li°
,

4977 
no_√ighb‹_fûãr_li°_cmd
,

4978 
NO_NEIGHBOR_CMD2
 "filter-list WORD (in|out)",

4979 
NO_STR


4980 
NEIGHBOR_STR


4981 
NEIGHBOR_ADDR_STR2


4987  
≥î_a¶i°_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

4988 
bgp_node_ßfi
 (
vty
), 
¨gv
[2]);

4993 
	$≥î_rouã_m≠_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
,

4994 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

4995 c⁄° *
«me_°r
, c⁄° *
dúe˘_°r
)

4997 
ªt
;

4998 
≥î
 *peer;

4999 
dúe˘
 = 
RMAP_IN
;

5001 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

5002 i‡(! 
≥î
)

5003  
CMD_WARNING
;

5006 i‡(
	`°∫cmp
 (
dúe˘_°r
, "in", 2) == 0)

5007 
dúe˘
 = 
RMAP_IN
;

5008 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

5009 
dúe˘
 = 
RMAP_OUT
;

5010 i‡(
	`°∫cmp
 (
dúe˘_°r
, "im", 2) == 0)

5011 
dúe˘
 = 
RMAP_IMPORT
;

5012 i‡(
	`°∫cmp
 (
dúe˘_°r
, "e", 1) == 0)

5013 
dúe˘
 = 
RMAP_EXPORT
;

5015 
ªt
 = 
	`≥î_rouã_m≠_£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
, 
«me_°r
);

5017  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5018 
	}
}

5021 
	$≥î_rouã_m≠_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

5022 
ßfi_t
 
ßfi
, c⁄° *
dúe˘_°r
)

5024 
ªt
;

5025 
≥î
 *peer;

5026 
dúe˘
 = 
RMAP_IN
;

5028 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

5029 i‡(! 
≥î
)

5030  
CMD_WARNING
;

5033 i‡(
	`°∫cmp
 (
dúe˘_°r
, "in", 2) == 0)

5034 
dúe˘
 = 
RMAP_IN
;

5035 i‡(
	`°∫cmp
 (
dúe˘_°r
, "o", 1) == 0)

5036 
dúe˘
 = 
RMAP_OUT
;

5037 i‡(
	`°∫cmp
 (
dúe˘_°r
, "im", 2) == 0)

5038 
dúe˘
 = 
RMAP_IMPORT
;

5039 i‡(
	`°∫cmp
 (
dúe˘_°r
, "e", 1) == 0)

5040 
dúe˘
 = 
RMAP_EXPORT
;

5042 
ªt
 = 
	`≥î_rouã_m≠_un£t
 (
≥î
, 
afi
, 
ßfi
, 
dúe˘
);

5044  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5045 
	}
}

5047 
DEFUN
 (
√ighb‹_rouã_m≠
,

5048 
√ighb‹_rouã_m≠_cmd
,

5049 
NEIGHBOR_CMD2
 "route-map WORD (in|out|import|export)",

5050 
NEIGHBOR_STR


5051 
NEIGHBOR_ADDR_STR2


5059  
≥î_rouã_m≠_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5060 
bgp_node_ßfi
 (
vty
), 
¨gv
[1],árgv[2]);

5063 
DEFUN
 (
no_√ighb‹_rouã_m≠
,

5064 
no_√ighb‹_rouã_m≠_cmd
,

5065 
NO_NEIGHBOR_CMD2
 "route-map WORD (in|out|import|export)",

5066 
NO_STR


5067 
NEIGHBOR_STR


5068 
NEIGHBOR_ADDR_STR2


5076  
≥î_rouã_m≠_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5077 
bgp_node_ßfi
 (
vty
), 
¨gv
[2]);

5082 
	$≥î_unsuµªss_m≠_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

5083 
ßfi_t
 
ßfi
, c⁄° *
«me_°r
)

5085 
ªt
;

5086 
≥î
 *peer;

5088 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

5089 i‡(! 
≥î
)

5090  
CMD_WARNING
;

5092 
ªt
 = 
	`≥î_unsuµªss_m≠_£t
 (
≥î
, 
afi
, 
ßfi
, 
«me_°r
);

5094  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5095 
	}
}

5099 
	$≥î_unsuµªss_m≠_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

5100 
ßfi_t
 
ßfi
)

5102 
ªt
;

5103 
≥î
 *peer;

5105 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

5106 i‡(! 
≥î
)

5107  
CMD_WARNING
;

5109 
ªt
 = 
	`≥î_unsuµªss_m≠_un£t
 (
≥î
, 
afi
, 
ßfi
);

5111  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5112 
	}
}

5114 
DEFUN
 (
√ighb‹_unsuµªss_m≠
,

5115 
√ighb‹_unsuµªss_m≠_cmd
,

5116 
NEIGHBOR_CMD2
 "unsuppress-map WORD",

5117 
NEIGHBOR_STR


5118 
NEIGHBOR_ADDR_STR2


5122  
≥î_unsuµªss_m≠_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5123 
bgp_node_ßfi
 (
vty
), 
¨gv
[1]);

5126 
DEFUN
 (
no_√ighb‹_unsuµªss_m≠
,

5127 
no_√ighb‹_unsuµªss_m≠_cmd
,

5128 
NO_NEIGHBOR_CMD2
 "unsuppress-map WORD",

5129 
NO_STR


5130 
NEIGHBOR_STR


5131 
NEIGHBOR_ADDR_STR2


5135  
≥î_unsuµªss_m≠_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5136 
bgp_node_ßfi
 (
vty
));

5140 
	$≥î_maximum_¥efix_£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

5141 
ßfi_t
 
ßfi
, c⁄° *
num_°r
,

5142 c⁄° *
thªshﬁd_°r
, 
w¨nög
,

5143 c⁄° *
ª°¨t_°r
)

5145 
ªt
;

5146 
≥î
 *peer;

5147 
u_öt32_t
 
max
;

5148 
u_ch¨
 
thªshﬁd
;

5149 
u_öt16_t
 
ª°¨t
;

5151 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

5152 i‡(! 
≥î
)

5153  
CMD_WARNING
;

5155 
	`VTY_GET_INTEGER
 ("maximumÇumbî", 
max
, 
num_°r
);

5156 i‡(
thªshﬁd_°r
)

5157 
thªshﬁd
 = 
	`©oi
 (
thªshﬁd_°r
);

5159 
thªshﬁd
 = 
MAXIMUM_PREFIX_THRESHOLD_DEFAULT
;

5161 i‡(
ª°¨t_°r
)

5162 
ª°¨t
 = 
	`©oi
 (
ª°¨t_°r
);

5164 
ª°¨t
 = 0;

5166 
ªt
 = 
	`≥î_maximum_¥efix_£t
 (
≥î
, 
afi
, 
ßfi
, 
max
, 
thªshﬁd
, 
w¨nög
, 
ª°¨t
);

5168  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5169 
	}
}

5172 
	$≥î_maximum_¥efix_un£t_vty
 (
vty
 *vty, c⁄° *
ù_°r
, 
afi_t
 
afi
,

5173 
ßfi_t
 
ßfi
)

5175 
ªt
;

5176 
≥î
 *peer;

5178 
≥î
 = 
	`≥î_™d_group_lookup_vty
 (
vty
, 
ù_°r
);

5179 i‡(! 
≥î
)

5180  
CMD_WARNING
;

5182 
ªt
 = 
	`≥î_maximum_¥efix_un£t
 (
≥î
, 
afi
, 
ßfi
);

5184  
	`bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5185 
	}
}

5190 
DEFUN
 (
√ighb‹_maximum_¥efix
,

5191 
√ighb‹_maximum_¥efix_cmd
,

5192 
NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295>",

5193 
NEIGHBOR_STR


5194 
NEIGHBOR_ADDR_STR2


5198  
≥î_maximum_¥efix_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5199 
bgp_node_ßfi
 (
vty
), 
¨gv
[1], 
NULL
, 0,

5200 
NULL
);

5203 
DEFUN
 (
√ighb‹_maximum_¥efix_thªshﬁd
,

5204 
√ighb‹_maximum_¥efix_thªshﬁd_cmd
,

5205 
NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> <1-100>",

5206 
NEIGHBOR_STR


5207 
NEIGHBOR_ADDR_STR2


5212  
≥î_maximum_¥efix_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5213 
bgp_node_ßfi
 (
vty
), 
¨gv
[1],árgv[2], 0,

5214 
NULL
);

5217 
DEFUN
 (
√ighb‹_maximum_¥efix_w¨nög
,

5218 
√ighb‹_maximum_¥efix_w¨nög_cmd
,

5219 
NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> warning-only",

5220 
NEIGHBOR_STR


5221 
NEIGHBOR_ADDR_STR2


5226  
≥î_maximum_¥efix_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5227 
bgp_node_ßfi
 (
vty
), 
¨gv
[1], 
NULL
, 1,

5228 
NULL
);

5231 
DEFUN
 (
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög
,

5232 
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
,

5233 
NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> <1-100> warning-only",

5234 
NEIGHBOR_STR


5235 
NEIGHBOR_ADDR_STR2


5241  
≥î_maximum_¥efix_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5242 
bgp_node_ßfi
 (
vty
), 
¨gv
[1],árgv[2], 1, 
NULL
);

5245 
DEFUN
 (
√ighb‹_maximum_¥efix_ª°¨t
,

5246 
√ighb‹_maximum_¥efix_ª°¨t_cmd
,

5247 
NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295>Ñestart <1-65535>",

5248 
NEIGHBOR_STR


5249 
NEIGHBOR_ADDR_STR2


5255  
≥î_maximum_¥efix_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5256 
bgp_node_ßfi
 (
vty
), 
¨gv
[1], 
NULL
, 0,árgv[2]);

5259 
DEFUN
 (
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t
,

5260 
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
,

5261 
NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> <1-100>Ñestart <1-65535>",

5262 
NEIGHBOR_STR


5263 
NEIGHBOR_ADDR_STR2


5270  
≥î_maximum_¥efix_£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5271 
bgp_node_ßfi
 (
vty
), 
¨gv
[1],árgv[2], 0,árgv[3]);

5274 
DEFUN
 (
no_√ighb‹_maximum_¥efix
,

5275 
no_√ighb‹_maximum_¥efix_cmd
,

5276 
NO_NEIGHBOR_CMD2
 "maximum-prefix",

5277 
NO_STR


5278 
NEIGHBOR_STR


5279 
NEIGHBOR_ADDR_STR2


5282  
≥î_maximum_¥efix_un£t_vty
 (
vty
, 
¨gv
[0], 
bgp_node_afi
 (vty),

5283 
bgp_node_ßfi
 (
vty
));

5286 
ALIAS
 (
no_√ighb‹_maximum_¥efix
,

5287 
no_√ighb‹_maximum_¥efix_vÆ_cmd
,

5288 
NO_NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295>",

5289 
NO_STR


5290 
NEIGHBOR_STR


5291 
NEIGHBOR_ADDR_STR2


5295 
ALIAS
 (
no_√ighb‹_maximum_¥efix
,

5296 
no_√ighb‹_maximum_¥efix_thªshﬁd_cmd
,

5297 
NO_NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> warning-only",

5298 
NO_STR


5299 
NEIGHBOR_STR


5300 
NEIGHBOR_ADDR_STR2


5305 
ALIAS
 (
no_√ighb‹_maximum_¥efix
,

5306 
no_√ighb‹_maximum_¥efix_w¨nög_cmd
,

5307 
NO_NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> warning-only",

5308 
NO_STR


5309 
NEIGHBOR_STR


5310 
NEIGHBOR_ADDR_STR2


5315 
ALIAS
 (
no_√ighb‹_maximum_¥efix
,

5316 
no_√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
,

5317 
NO_NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> <1-100> warning-only",

5318 
NO_STR


5319 
NEIGHBOR_STR


5320 
NEIGHBOR_ADDR_STR2


5326 
ALIAS
 (
no_√ighb‹_maximum_¥efix
,

5327 
no_√ighb‹_maximum_¥efix_ª°¨t_cmd
,

5328 
NO_NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295>Ñestart <1-65535>",

5329 
NO_STR


5330 
NEIGHBOR_STR


5331 
NEIGHBOR_ADDR_STR2


5337 
ALIAS
 (
no_√ighb‹_maximum_¥efix
,

5338 
no_√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
,

5339 
NO_NEIGHBOR_CMD2
 "maximum-prefix <1-4294967295> <1-100>Ñestart <1-65535>",

5340 
NO_STR


5341 
NEIGHBOR_STR


5342 
NEIGHBOR_ADDR_STR2


5350 
DEFUN
 (
√ighb‹_Ælowas_ö
,

5351 
√ighb‹_Ælowas_ö_cmd
,

5352 
NEIGHBOR_CMD2
 "allowas-in",

5353 
NEIGHBOR_STR


5354 
NEIGHBOR_ADDR_STR2


5357 
	gªt
;

5358 
≥î
 *
	g≥î
;

5359 
	gÆlow_num
;

5361 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

5362 i‡(! 
	g≥î
)

5363  
	gCMD_WARNING
;

5365 i‡(
	g¨gc
 == 1)

5366 
Ælow_num
 = 3;

5368 
VTY_GET_INTEGER_RANGE
 ("ASÇumbî", 
Ælow_num
, 
¨gv
[1], 1, 10);

5370 
	gªt
 = 
≥î_Ælowas_ö_£t
 (
≥î
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty),

5371 
Ælow_num
);

5373  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5376 
ALIAS
 (
√ighb‹_Ælowas_ö
,

5377 
√ighb‹_Ælowas_ö_¨g_cmd
,

5378 
NEIGHBOR_CMD2
 "allowas-in <1-10>",

5379 
NEIGHBOR_STR


5380 
NEIGHBOR_ADDR_STR2


5384 
DEFUN
 (
no_√ighb‹_Ælowas_ö
,

5385 
no_√ighb‹_Ælowas_ö_cmd
,

5386 
NO_NEIGHBOR_CMD2
 "allowas-in",

5387 
NO_STR


5388 
NEIGHBOR_STR


5389 
NEIGHBOR_ADDR_STR2


5392 
	gªt
;

5393 
≥î
 *
	g≥î
;

5395 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

5396 i‡(! 
	g≥î
)

5397  
	gCMD_WARNING
;

5399 
	gªt
 = 
≥î_Ælowas_ö_un£t
 (
≥î
, 
bgp_node_afi
 (
vty
), 
bgp_node_ßfi
 (vty));

5401  
bgp_vty_ªtu∫
 (
vty
, 
ªt
);

5404 
DEFUN
 (
√ighb‹_âl_£curôy
,

5405 
√ighb‹_âl_£curôy_cmd
,

5406 
NEIGHBOR_CMD2
 "ttl-security hops <1-254>",

5407 
NEIGHBOR_STR


5408 
NEIGHBOR_ADDR_STR2


5411 
≥î
 *
	g≥î
;

5412 
	ggtsm_h›s
;

5414 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

5415 i‡(! 
	g≥î
)

5416  
	gCMD_WARNING
;

5418 
VTY_GET_INTEGER_RANGE
 ("", 
gtsm_h›s
, 
¨gv
[1], 1, 254);

5420  
bgp_vty_ªtu∫
 (
vty
, 
≥î_âl_£curôy_h›s_£t
 (
≥î
, 
gtsm_h›s
));

5423 
DEFUN
 (
no_√ighb‹_âl_£curôy
,

5424 
no_√ighb‹_âl_£curôy_cmd
,

5425 
NO_NEIGHBOR_CMD2
 "ttl-security hops <1-254>",

5426 
NO_STR


5427 
NEIGHBOR_STR


5428 
NEIGHBOR_ADDR_STR2


5431 
≥î
 *
	g≥î
;

5433 
	g≥î
 = 
≥î_™d_group_lookup_vty
 (
vty
, 
¨gv
[0]);

5434 i‡(! 
	g≥î
)

5435  
	gCMD_WARNING
;

5437  
bgp_vty_ªtu∫
 (
vty
, 
≥î_âl_£curôy_h›s_un£t
 (
≥î
));

5441 
DEFUN
 (
addªss_Ámûy_ùv4
,

5442 
addªss_Ámûy_ùv4_cmd
,

5447 
	gvty
->
	gnode
 = 
BGP_IPV4_NODE
;

5448  
	gCMD_SUCCESS
;

5451 
DEFUN
 (
addªss_Ámûy_ùv4_ßfi
,

5452 
addªss_Ámûy_ùv4_ßfi_cmd
,

5459 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

5460 
vty
->
node
 = 
BGP_IPV4M_NODE
;

5462 
	gvty
->
	gnode
 = 
BGP_IPV4_NODE
;

5464  
	gCMD_SUCCESS
;

5467 
DEFUN
 (
addªss_Ámûy_ùv6
,

5468 
addªss_Ámûy_ùv6_cmd
,

5473 
	gvty
->
	gnode
 = 
BGP_IPV6_NODE
;

5474  
	gCMD_SUCCESS
;

5477 
DEFUN
 (
addªss_Ámûy_ùv6_ßfi
,

5478 
addªss_Ámûy_ùv6_ßfi_cmd
,

5485 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

5486 
vty
->
node
 = 
BGP_IPV6M_NODE
;

5488 
	gvty
->
	gnode
 = 
BGP_IPV6_NODE
;

5490  
	gCMD_SUCCESS
;

5493 
DEFUN
 (
addªss_Ámûy_v≤v4
,

5494 
addªss_Ámûy_v≤v4_cmd
,

5499 
	gvty
->
	gnode
 = 
BGP_VPNV4_NODE
;

5500  
	gCMD_SUCCESS
;

5503 
ALIAS
 (
addªss_Ámûy_v≤v4
,

5504 
addªss_Ámûy_v≤v4_uniˇ°_cmd
,

5510 
DEFUN
 (
exô_addªss_Ámûy
,

5511 
exô_addªss_Ámûy_cmd
,

5515 i‡(
	gvty
->
	gnode
 =
BGP_IPV4_NODE


5516 || 
vty
->
node
 =
BGP_IPV4M_NODE


5517 || 
vty
->
node
 =
BGP_VPNV4_NODE


5518 || 
vty
->
node
 =
BGP_IPV6_NODE


5519 || 
vty
->
node
 =
BGP_IPV6M_NODE
)

5520 
vty
->
node
 = 
BGP_NODE
;

5521  
	gCMD_SUCCESS
;

5525 
	e˛ór_s‹t


5527 
	m˛ór_Æl
,

5528 
	m˛ór_≥î
,

5529 
	m˛ór_group
,

5530 
	m˛ór_exã∫Æ
,

5531 
	m˛ór_as


5535 
	$bgp_˛ór_vty_îr‹
 (
vty
 *vty, 
≥î
 *≥î, 
afi_t
 
afi
,

5536 
ßfi_t
 
ßfi
, 
îr‹
)

5538 
îr‹
)

5540 
BGP_ERR_AF_UNCONFIGURED
:

5541 
	`vty_out
 (
vty
,

5543 
afi
 =
AFI_IP6
 ? "IPv6" : 
ßfi
 =
SAFI_MPLS_VPN
 ? "VPNv4" : "IPv4",

5544 
ßfi
 =
SAFI_MULTICAST
 ? "Multicast" : "Unicast",

5545 
≥î
->
ho°
, 
VTY_NEWLINE
);

5547 
BGP_ERR_SOFT_RECONFIG_UNCONFIGURED
:

5548 
	`vty_out
 (
vty
, "%%BGP: Inbound so·Ñec⁄fig f‹ %†nŸÖossibÀá†ô%† ha†√ôhîÑe‰esh c≠abûôy,Ç‹ inbound so·Ñec⁄fig%s", 
≥î
->
ho°
, 
VTY_NEWLINE
, VTY_NEWLINE);

5553 
	}
}

5557 
	$bgp_˛ór
 (
vty
 *vty, 
bgp
 *bgp, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

5558 
˛ór_s‹t
 
s‹t
,
bgp_˛ór_ty≥
 
°y≥
, c⁄° *
¨g
)

5560 
ªt
;

5561 
≥î
 *peer;

5562 
li°node
 *
node
, *
¬ode
;

5565 i‡(
s‹t
 =
˛ór_Æl
)

5567 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

5569 i‡(
°y≥
 =
BGP_CLEAR_SOFT_NONE
)

5570 
ªt
 = 
	`≥î_˛ór
 (
≥î
);

5572 
ªt
 = 
	`≥î_˛ór_so·
 (
≥î
, 
afi
, 
ßfi
, 
°y≥
);

5574 i‡(
ªt
 < 0)

5575 
	`bgp_˛ór_vty_îr‹
 (
vty
, 
≥î
, 
afi
, 
ßfi
, 
ªt
);

5577  
CMD_SUCCESS
;

5581 i‡(
s‹t
 =
˛ór_≥î
)

5583 
sockuni⁄
 
su
;

5584 
ªt
;

5587 
ªt
 = 
	`°r2sockuni⁄
 (
¨g
, &
su
);

5588 i‡(
ªt
 < 0)

5590 
	`vty_out
 (
vty
, "MÆf‹medáddªss: %s%s", 
¨g
, 
VTY_NEWLINE
);

5591  
CMD_WARNING
;

5593 
≥î
 = 
	`≥î_lookup
 (
bgp
, &
su
);

5594 i‡(! 
≥î
)

5596 
	`vty_out
 (
vty
, "%%BGP: Unknow¿√ighb‹ - \"%s\"%s", 
¨g
, 
VTY_NEWLINE
);

5597  
CMD_WARNING
;

5600 i‡(
°y≥
 =
BGP_CLEAR_SOFT_NONE
)

5601 
ªt
 = 
	`≥î_˛ór
 (
≥î
);

5603 
ªt
 = 
	`≥î_˛ór_so·
 (
≥î
, 
afi
, 
ßfi
, 
°y≥
);

5605 i‡(
ªt
 < 0)

5606 
	`bgp_˛ór_vty_îr‹
 (
vty
, 
≥î
, 
afi
, 
ßfi
, 
ªt
);

5608  
CMD_SUCCESS
;

5612 i‡(
s‹t
 =
˛ór_group
)

5614 
≥î_group
 *
group
;

5616 
group
 = 
	`≥î_group_lookup
 (
bgp
, 
¨g
);

5617 i‡(! 
group
)

5619 
	`vty_out
 (
vty
, "%%BGP: NÿsuchÖìr-grou∞%s%s", 
¨g
, 
VTY_NEWLINE
);

5620  
CMD_WARNING
;

5623 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

5625 i‡(
°y≥
 =
BGP_CLEAR_SOFT_NONE
)

5627 
ªt
 = 
	`≥î_˛ór
 (
≥î
);

5631 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

5634 
ªt
 = 
	`≥î_˛ór_so·
 (
≥î
, 
afi
, 
ßfi
, 
°y≥
);

5636 i‡(
ªt
 < 0)

5637 
	`bgp_˛ór_vty_îr‹
 (
vty
, 
≥î
, 
afi
, 
ßfi
, 
ªt
);

5639  
CMD_SUCCESS
;

5642 i‡(
s‹t
 =
˛ór_exã∫Æ
)

5644 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

5646 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

5649 i‡(
°y≥
 =
BGP_CLEAR_SOFT_NONE
)

5650 
ªt
 = 
	`≥î_˛ór
 (
≥î
);

5652 
ªt
 = 
	`≥î_˛ór_so·
 (
≥î
, 
afi
, 
ßfi
, 
°y≥
);

5654 i‡(
ªt
 < 0)

5655 
	`bgp_˛ór_vty_îr‹
 (
vty
, 
≥î
, 
afi
, 
ßfi
, 
ªt
);

5657  
CMD_SUCCESS
;

5660 i‡(
s‹t
 =
˛ór_as
)

5662 
as_t
 
as
;

5663 
föd
 = 0;

5665 
	`VTY_GET_INTEGER_RANGE
 ("AS", 
as
, 
¨g
, 1, 
BGP_AS4_MAX
);

5667 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

5669 i‡(
≥î
->
as
 !=ás)

5672 
föd
 = 1;

5673 i‡(
°y≥
 =
BGP_CLEAR_SOFT_NONE
)

5674 
ªt
 = 
	`≥î_˛ór
 (
≥î
);

5676 
ªt
 = 
	`≥î_˛ór_so·
 (
≥î
, 
afi
, 
ßfi
, 
°y≥
);

5678 i‡(
ªt
 < 0)

5679 
	`bgp_˛ór_vty_îr‹
 (
vty
, 
≥î
, 
afi
, 
ßfi
, 
ªt
);

5681 i‡(! 
föd
)

5682 
	`vty_out
 (
vty
, "%%BGP: Nÿ≥î i†c⁄figuªd wôh AS %s%s", 
¨g
,

5683 
VTY_NEWLINE
);

5684  
CMD_SUCCESS
;

5687  
CMD_SUCCESS
;

5688 
	}
}

5691 
	$bgp_˛ór_vty
 (
vty
 *vty, c⁄° *
«me
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

5692 
˛ór_s‹t
 
s‹t
, 
bgp_˛ór_ty≥
 
°y≥
,

5693 c⁄° *
¨g
)

5695 
bgp
 *bgp;

5698 i‡(
«me
)

5700 
bgp
 = 
	`bgp_lookup_by_«me
 (
«me
);

5701 i‡(
bgp
 =
NULL
)

5703 
	`vty_out
 (
vty
, "C™'àföd BGP võw %s%s", 
«me
, 
VTY_NEWLINE
);

5704  
CMD_WARNING
;

5709 
bgp
 = 
	`bgp_gë_deÁu…
 ();

5710 i‡(
bgp
 =
NULL
)

5712 
	`vty_out
 (
vty
, "NÿBGPÖro˚s†i†c⁄figuªd%s", 
VTY_NEWLINE
);

5713  
CMD_WARNING
;

5717  
	`bgp_˛ór
 (
vty
, 
bgp
, 
afi
, 
ßfi
, 
s‹t
, 
°y≥
, 
¨g
);

5718 
	}
}

5720 
DEFUN
 (
˛ór_ù_bgp_Æl
,

5721 
˛ór_ù_bgp_Æl_cmd
,

5723 
CLEAR_STR


5724 
IP_STR


5725 
BGP_STR


5728 i‡(
	g¨gc
 == 1)

5729  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 0, 0, 
˛ór_Æl
, 
BGP_CLEAR_SOFT_NONE
, 
NULL
);

5731  
bgp_˛ór_vty
 (
vty
, 
NULL
, 0, 0, 
˛ór_Æl
, 
BGP_CLEAR_SOFT_NONE
, NULL);

5734 
ALIAS
 (
˛ór_ù_bgp_Æl
,

5735 
˛ór_bgp_Æl_cmd
,

5737 
CLEAR_STR


5738 
BGP_STR


5741 
ALIAS
 (
˛ór_ù_bgp_Æl
,

5742 
˛ór_bgp_ùv6_Æl_cmd
,

5744 
CLEAR_STR


5745 
BGP_STR


5749 
ALIAS
 (
˛ór_ù_bgp_Æl
,

5750 
˛ór_ù_bgp_ö°™˚_Æl_cmd
,

5752 
CLEAR_STR


5753 
IP_STR


5754 
BGP_STR


5759 
ALIAS
 (
˛ór_ù_bgp_Æl
,

5760 
˛ór_bgp_ö°™˚_Æl_cmd
,

5762 
CLEAR_STR


5763 
BGP_STR


5768 
DEFUN
 (
˛ór_ù_bgp_≥î
,

5769 
˛ór_ù_bgp_≥î_cmd
,

5771 
CLEAR_STR


5772 
IP_STR


5773 
BGP_STR


5777  
bgp_˛ór_vty
 (
vty
, 
NULL
, 0, 0, 
˛ór_≥î
, 
BGP_CLEAR_SOFT_NONE
, 
¨gv
[0]);

5780 
ALIAS
 (
˛ór_ù_bgp_≥î
,

5781 
˛ór_bgp_≥î_cmd
,

5783 
CLEAR_STR


5784 
BGP_STR


5788 
ALIAS
 (
˛ór_ù_bgp_≥î
,

5789 
˛ór_bgp_ùv6_≥î_cmd
,

5791 
CLEAR_STR


5792 
BGP_STR


5797 
DEFUN
 (
˛ór_ù_bgp_≥î_group
,

5798 
˛ór_ù_bgp_≥î_group_cmd
,

5800 
CLEAR_STR


5801 
IP_STR


5802 
BGP_STR


5806  
bgp_˛ór_vty
 (
vty
, 
NULL
, 0, 0, 
˛ór_group
, 
BGP_CLEAR_SOFT_NONE
, 
¨gv
[0]);

5809 
ALIAS
 (
˛ór_ù_bgp_≥î_group
,

5810 
˛ór_bgp_≥î_group_cmd
,

5812 
CLEAR_STR


5813 
BGP_STR


5817 
ALIAS
 (
˛ór_ù_bgp_≥î_group
,

5818 
˛ór_bgp_ùv6_≥î_group_cmd
,

5820 
CLEAR_STR


5821 
BGP_STR


5826 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ
,

5827 
˛ór_ù_bgp_exã∫Æ_cmd
,

5829 
CLEAR_STR


5830 
IP_STR


5831 
BGP_STR


5834  
bgp_˛ór_vty
 (
vty
, 
NULL
, 0, 0, 
˛ór_exã∫Æ
, 
BGP_CLEAR_SOFT_NONE
, NULL);

5837 
ALIAS
 (
˛ór_ù_bgp_exã∫Æ
,

5838 
˛ór_bgp_exã∫Æ_cmd
,

5840 
CLEAR_STR


5841 
BGP_STR


5844 
ALIAS
 (
˛ór_ù_bgp_exã∫Æ
,

5845 
˛ór_bgp_ùv6_exã∫Æ_cmd
,

5847 
CLEAR_STR


5848 
BGP_STR


5852 
DEFUN
 (
˛ór_ù_bgp_as
,

5853 
˛ór_ù_bgp_as_cmd
,

5854 "˛ó∏ù bg∞" 
CMD_AS_RANGE
,

5855 
CLEAR_STR


5856 
IP_STR


5857 
BGP_STR


5860  
bgp_˛ór_vty
 (
vty
, 
NULL
, 0, 0, 
˛ór_as
, 
BGP_CLEAR_SOFT_NONE
, 
¨gv
[0]);

5863 
ALIAS
 (
˛ór_ù_bgp_as
,

5864 
˛ór_bgp_as_cmd
,

5865 "˛ó∏bg∞" 
CMD_AS_RANGE
,

5866 
CLEAR_STR


5867 
BGP_STR


5870 
ALIAS
 (
˛ór_ù_bgp_as
,

5871 
˛ór_bgp_ùv6_as_cmd
,

5872 "˛ó∏bg∞ùv6 " 
CMD_AS_RANGE
,

5873 
CLEAR_STR


5874 
BGP_STR


5879 
DEFUN
 (
˛ór_ù_bgp_Æl_so·_out
,

5880 
˛ór_ù_bgp_Æl_so·_out_cmd
,

5882 
CLEAR_STR


5883 
IP_STR


5884 
BGP_STR


5889 i‡(
	g¨gc
 == 1)

5890  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

5891 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

5893  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

5894 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

5897 
ALIAS
 (
˛ór_ù_bgp_Æl_so·_out
,

5898 
˛ór_ù_bgp_Æl_out_cmd
,

5900 
CLEAR_STR


5901 
IP_STR


5902 
BGP_STR


5906 
ALIAS
 (
˛ór_ù_bgp_Æl_so·_out
,

5907 
˛ór_ù_bgp_ö°™˚_Æl_so·_out_cmd
,

5909 
CLEAR_STR


5910 
IP_STR


5911 
BGP_STR


5918 
DEFUN
 (
˛ór_ù_bgp_Æl_ùv4_so·_out
,

5919 
˛ór_ù_bgp_Æl_ùv4_so·_out_cmd
,

5921 
CLEAR_STR


5922 
IP_STR


5923 
BGP_STR


5931 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

5932  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

5933 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

5935  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

5936 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

5939 
ALIAS
 (
˛ór_ù_bgp_Æl_ùv4_so·_out
,

5940 
˛ór_ù_bgp_Æl_ùv4_out_cmd
,

5942 
CLEAR_STR


5943 
IP_STR


5944 
BGP_STR


5951 
DEFUN
 (
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_out
,

5952 
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_out_cmd
,

5954 
CLEAR_STR


5955 
IP_STR


5956 
BGP_STR


5965 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

5966  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

5967 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

5969  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

5970 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

5973 
DEFUN
 (
˛ór_ù_bgp_Æl_v≤v4_so·_out
,

5974 
˛ór_ù_bgp_Æl_v≤v4_so·_out_cmd
,

5976 
CLEAR_STR


5977 
IP_STR


5978 
BGP_STR


5985  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_Æl
,

5986 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

5989 
ALIAS
 (
˛ór_ù_bgp_Æl_v≤v4_so·_out
,

5990 
˛ór_ù_bgp_Æl_v≤v4_out_cmd
,

5992 
CLEAR_STR


5993 
IP_STR


5994 
BGP_STR


6000 
DEFUN
 (
˛ór_bgp_Æl_so·_out
,

6001 
˛ór_bgp_Æl_so·_out_cmd
,

6003 
CLEAR_STR


6004 
BGP_STR


6009 i‡(
	g¨gc
 == 1)

6010  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6011 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

6013  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6014 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

6017 
ALIAS
 (
˛ór_bgp_Æl_so·_out
,

6018 
˛ór_bgp_ö°™˚_Æl_so·_out_cmd
,

6020 
CLEAR_STR


6021 
BGP_STR


6028 
ALIAS
 (
˛ór_bgp_Æl_so·_out
,

6029 
˛ór_bgp_Æl_out_cmd
,

6031 
CLEAR_STR


6032 
BGP_STR


6036 
ALIAS
 (
˛ór_bgp_Æl_so·_out
,

6037 
˛ór_bgp_ùv6_Æl_so·_out_cmd
,

6039 
CLEAR_STR


6040 
BGP_STR


6046 
ALIAS
 (
˛ór_bgp_Æl_so·_out
,

6047 
˛ór_bgp_ùv6_Æl_out_cmd
,

6049 
CLEAR_STR


6050 
BGP_STR


6055 
DEFUN
 (
˛ór_ù_bgp_≥î_so·_out
,

6056 
˛ór_ù_bgp_≥î_so·_out_cmd
,

6058 
CLEAR_STR


6059 
IP_STR


6060 
BGP_STR


6065  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6066 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6069 
ALIAS
 (
˛ór_ù_bgp_≥î_so·_out
,

6070 
˛ór_ù_bgp_≥î_out_cmd
,

6072 
CLEAR_STR


6073 
IP_STR


6074 
BGP_STR


6078 
DEFUN
 (
˛ór_ù_bgp_≥î_ùv4_so·_out
,

6079 
˛ór_ù_bgp_≥î_ùv4_so·_out_cmd
,

6081 
CLEAR_STR


6082 
IP_STR


6083 
BGP_STR


6091 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

6092  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_≥î
,

6093 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6095  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6096 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6099 
ALIAS
 (
˛ór_ù_bgp_≥î_ùv4_so·_out
,

6100 
˛ór_ù_bgp_≥î_ùv4_out_cmd
,

6102 
CLEAR_STR


6103 
IP_STR


6104 
BGP_STR


6111 
DEFUN
 (
˛ór_ù_bgp_≥î_v≤v4_so·_out
,

6112 
˛ór_ù_bgp_≥î_v≤v4_so·_out_cmd
,

6114 
CLEAR_STR


6115 
IP_STR


6116 
BGP_STR


6123  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_≥î
,

6124 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6127 
ALIAS
 (
˛ór_ù_bgp_≥î_v≤v4_so·_out
,

6128 
˛ór_ù_bgp_≥î_v≤v4_out_cmd
,

6130 
CLEAR_STR


6131 
IP_STR


6132 
BGP_STR


6138 
DEFUN
 (
˛ór_bgp_≥î_so·_out
,

6139 
˛ór_bgp_≥î_so·_out_cmd
,

6141 
CLEAR_STR


6142 
BGP_STR


6148  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6149 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6152 
ALIAS
 (
˛ór_bgp_≥î_so·_out
,

6153 
˛ór_bgp_ùv6_≥î_so·_out_cmd
,

6155 
CLEAR_STR


6156 
BGP_STR


6163 
ALIAS
 (
˛ór_bgp_≥î_so·_out
,

6164 
˛ór_bgp_≥î_out_cmd
,

6166 
CLEAR_STR


6167 
BGP_STR


6172 
ALIAS
 (
˛ór_bgp_≥î_so·_out
,

6173 
˛ór_bgp_ùv6_≥î_out_cmd
,

6175 
CLEAR_STR


6176 
BGP_STR


6182 
DEFUN
 (
˛ór_ù_bgp_≥î_group_so·_out
,

6183 
˛ór_ù_bgp_≥î_group_so·_out_cmd
,

6185 
CLEAR_STR


6186 
IP_STR


6187 
BGP_STR


6193  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

6194 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6197 
ALIAS
 (
˛ór_ù_bgp_≥î_group_so·_out
,

6198 
˛ór_ù_bgp_≥î_group_out_cmd
,

6200 
CLEAR_STR


6201 
IP_STR


6202 
BGP_STR


6207 
DEFUN
 (
˛ór_ù_bgp_≥î_group_ùv4_so·_out
,

6208 
˛ór_ù_bgp_≥î_group_ùv4_so·_out_cmd
,

6210 
CLEAR_STR


6211 
IP_STR


6212 
BGP_STR


6221 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

6222  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_group
,

6223 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6225  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

6226 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6229 
ALIAS
 (
˛ór_ù_bgp_≥î_group_ùv4_so·_out
,

6230 
˛ór_ù_bgp_≥î_group_ùv4_out_cmd
,

6232 
CLEAR_STR


6233 
IP_STR


6234 
BGP_STR


6242 
DEFUN
 (
˛ór_bgp_≥î_group_so·_out
,

6243 
˛ór_bgp_≥î_group_so·_out_cmd
,

6245 
CLEAR_STR


6246 
BGP_STR


6252  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_group
,

6253 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6256 
ALIAS
 (
˛ór_bgp_≥î_group_so·_out
,

6257 
˛ór_bgp_ùv6_≥î_group_so·_out_cmd
,

6259 
CLEAR_STR


6260 
BGP_STR


6267 
ALIAS
 (
˛ór_bgp_≥î_group_so·_out
,

6268 
˛ór_bgp_≥î_group_out_cmd
,

6270 
CLEAR_STR


6271 
BGP_STR


6276 
ALIAS
 (
˛ór_bgp_≥î_group_so·_out
,

6277 
˛ór_bgp_ùv6_≥î_group_out_cmd
,

6279 
CLEAR_STR


6280 
BGP_STR


6286 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_so·_out
,

6287 
˛ór_ù_bgp_exã∫Æ_so·_out_cmd
,

6289 
CLEAR_STR


6290 
IP_STR


6291 
BGP_STR


6296  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

6297 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

6300 
ALIAS
 (
˛ór_ù_bgp_exã∫Æ_so·_out
,

6301 
˛ór_ù_bgp_exã∫Æ_out_cmd
,

6303 
CLEAR_STR


6304 
IP_STR


6305 
BGP_STR


6309 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_ùv4_so·_out
,

6310 
˛ór_ù_bgp_exã∫Æ_ùv4_so·_out_cmd
,

6312 
CLEAR_STR


6313 
IP_STR


6314 
BGP_STR


6322 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

6323  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_exã∫Æ
,

6324 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

6326  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

6327 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

6330 
ALIAS
 (
˛ór_ù_bgp_exã∫Æ_ùv4_so·_out
,

6331 
˛ór_ù_bgp_exã∫Æ_ùv4_out_cmd
,

6333 
CLEAR_STR


6334 
IP_STR


6335 
BGP_STR


6342 
DEFUN
 (
˛ór_bgp_exã∫Æ_so·_out
,

6343 
˛ór_bgp_exã∫Æ_so·_out_cmd
,

6345 
CLEAR_STR


6346 
BGP_STR


6351  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

6352 
BGP_CLEAR_SOFT_OUT
, 
NULL
);

6355 
ALIAS
 (
˛ór_bgp_exã∫Æ_so·_out
,

6356 
˛ór_bgp_ùv6_exã∫Æ_so·_out_cmd
,

6358 
CLEAR_STR


6359 
BGP_STR


6365 
ALIAS
 (
˛ór_bgp_exã∫Æ_so·_out
,

6366 
˛ór_bgp_exã∫Æ_out_cmd
,

6368 
CLEAR_STR


6369 
BGP_STR


6373 
ALIAS
 (
˛ór_bgp_exã∫Æ_so·_out
,

6374 
˛ór_bgp_ùv6_exã∫Æ_out_cmd
,

6376 
CLEAR_STR


6377 
BGP_STR


6382 
DEFUN
 (
˛ór_ù_bgp_as_so·_out
,

6383 
˛ór_ù_bgp_as_so·_out_cmd
,

6384 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " soft out",

6385 
CLEAR_STR


6386 
IP_STR


6387 
BGP_STR


6392  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

6393 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6396 
ALIAS
 (
˛ór_ù_bgp_as_so·_out
,

6397 
˛ór_ù_bgp_as_out_cmd
,

6398 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " out",

6399 
CLEAR_STR


6400 
IP_STR


6401 
BGP_STR


6405 
DEFUN
 (
˛ór_ù_bgp_as_ùv4_so·_out
,

6406 
˛ór_ù_bgp_as_ùv4_so·_out_cmd
,

6407 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " ipv4 (unicast|multicast) soft out",

6408 
CLEAR_STR


6409 
IP_STR


6410 
BGP_STR


6418 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

6419  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_as
,

6420 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6422  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

6423 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6426 
ALIAS
 (
˛ór_ù_bgp_as_ùv4_so·_out
,

6427 
˛ór_ù_bgp_as_ùv4_out_cmd
,

6428 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " ipv4 (unicast|multicast) out",

6429 
CLEAR_STR


6430 
IP_STR


6431 
BGP_STR


6438 
DEFUN
 (
˛ór_ù_bgp_as_v≤v4_so·_out
,

6439 
˛ór_ù_bgp_as_v≤v4_so·_out_cmd
,

6440 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " vpnv4 unicast soft out",

6441 
CLEAR_STR


6442 
IP_STR


6443 
BGP_STR


6450  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_as
,

6451 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6454 
ALIAS
 (
˛ór_ù_bgp_as_v≤v4_so·_out
,

6455 
˛ór_ù_bgp_as_v≤v4_out_cmd
,

6456 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " vpnv4 unicast out",

6457 
CLEAR_STR


6458 
IP_STR


6459 
BGP_STR


6465 
DEFUN
 (
˛ór_bgp_as_so·_out
,

6466 
˛ór_bgp_as_so·_out_cmd
,

6467 "˛ó∏bg∞" 
CMD_AS_RANGE
 " soft out",

6468 
CLEAR_STR


6469 
BGP_STR


6474  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_as
,

6475 
BGP_CLEAR_SOFT_OUT
, 
¨gv
[0]);

6478 
ALIAS
 (
˛ór_bgp_as_so·_out
,

6479 
˛ór_bgp_ùv6_as_so·_out_cmd
,

6480 "˛ó∏bg∞ùv6 " 
CMD_AS_RANGE
 " soft out",

6481 
CLEAR_STR


6482 
BGP_STR


6488 
ALIAS
 (
˛ór_bgp_as_so·_out
,

6489 
˛ór_bgp_as_out_cmd
,

6490 "˛ó∏bg∞" 
CMD_AS_RANGE
 " out",

6491 
CLEAR_STR


6492 
BGP_STR


6496 
ALIAS
 (
˛ór_bgp_as_so·_out
,

6497 
˛ór_bgp_ùv6_as_out_cmd
,

6498 "˛ó∏bg∞ùv6 " 
CMD_AS_RANGE
 " out",

6499 
CLEAR_STR


6500 
BGP_STR


6506 
DEFUN
 (
˛ór_ù_bgp_Æl_so·_ö
,

6507 
˛ór_ù_bgp_Æl_so·_ö_cmd
,

6509 
CLEAR_STR


6510 
IP_STR


6511 
BGP_STR


6516 i‡(
	g¨gc
 == 1)

6517  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6518 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6520  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6521 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6524 
ALIAS
 (
˛ór_ù_bgp_Æl_so·_ö
,

6525 
˛ór_ù_bgp_ö°™˚_Æl_so·_ö_cmd
,

6527 
CLEAR_STR


6528 
IP_STR


6529 
BGP_STR


6536 
ALIAS
 (
˛ór_ù_bgp_Æl_so·_ö
,

6537 
˛ór_ù_bgp_Æl_ö_cmd
,

6539 
CLEAR_STR


6540 
IP_STR


6541 
BGP_STR


6545 
DEFUN
 (
˛ór_ù_bgp_Æl_ö_¥efix_fûãr
,

6546 
˛ór_ù_bgp_Æl_ö_¥efix_fûãr_cmd
,

6548 
CLEAR_STR


6549 
IP_STR


6550 
BGP_STR


6555 i‡(
	g¨gc
== 1)

6556  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6557 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

6559  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6560 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

6563 
ALIAS
 (
˛ór_ù_bgp_Æl_ö_¥efix_fûãr
,

6564 
˛ór_ù_bgp_ö°™˚_Æl_ö_¥efix_fûãr_cmd
,

6566 
CLEAR_STR


6567 
IP_STR


6568 
BGP_STR


6576 
DEFUN
 (
˛ór_ù_bgp_Æl_ùv4_so·_ö
,

6577 
˛ór_ù_bgp_Æl_ùv4_so·_ö_cmd
,

6579 
CLEAR_STR


6580 
IP_STR


6581 
BGP_STR


6589 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

6590  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

6591 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6593  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6594 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6597 
ALIAS
 (
˛ór_ù_bgp_Æl_ùv4_so·_ö
,

6598 
˛ór_ù_bgp_Æl_ùv4_ö_cmd
,

6600 
CLEAR_STR


6601 
IP_STR


6602 
BGP_STR


6609 
DEFUN
 (
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_ö
,

6610 
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_ö_cmd
,

6612 
CLEAR_STR


6613 
IP_STR


6614 
BGP_STR


6624 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

6625  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

6626 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6628  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6629 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6632 
DEFUN
 (
˛ór_ù_bgp_Æl_ùv4_ö_¥efix_fûãr
,

6633 
˛ór_ù_bgp_Æl_ùv4_ö_¥efix_fûãr_cmd
,

6635 
CLEAR_STR


6636 
IP_STR


6637 
BGP_STR


6645 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

6646  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

6647 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

6649  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6650 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

6653 
DEFUN
 (
˛ór_ù_bgp_ö°™˚_Æl_ùv4_ö_¥efix_fûãr
,

6654 
˛ór_ù_bgp_ö°™˚_Æl_ùv4_ö_¥efix_fûãr_cmd
,

6656 
CLEAR_STR


6657 
IP_STR


6658 
BGP_STR


6666 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

6667  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

6668 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

6670  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6671 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

6674 
DEFUN
 (
˛ór_ù_bgp_Æl_v≤v4_so·_ö
,

6675 
˛ór_ù_bgp_Æl_v≤v4_so·_ö_cmd
,

6677 
CLEAR_STR


6678 
IP_STR


6679 
BGP_STR


6686  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_Æl
,

6687 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6690 
ALIAS
 (
˛ór_ù_bgp_Æl_v≤v4_so·_ö
,

6691 
˛ór_ù_bgp_Æl_v≤v4_ö_cmd
,

6693 
CLEAR_STR


6694 
IP_STR


6695 
BGP_STR


6701 
DEFUN
 (
˛ór_bgp_Æl_so·_ö
,

6702 
˛ór_bgp_Æl_so·_ö_cmd
,

6704 
CLEAR_STR


6705 
BGP_STR


6710 i‡(
	g¨gc
 == 1)

6711  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6712 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6714  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6715 
BGP_CLEAR_SOFT_IN
, 
NULL
);

6718 
ALIAS
 (
˛ór_bgp_Æl_so·_ö
,

6719 
˛ór_bgp_ö°™˚_Æl_so·_ö_cmd
,

6721 
CLEAR_STR


6722 
BGP_STR


6729 
ALIAS
 (
˛ór_bgp_Æl_so·_ö
,

6730 
˛ór_bgp_ùv6_Æl_so·_ö_cmd
,

6732 
CLEAR_STR


6733 
BGP_STR


6739 
ALIAS
 (
˛ór_bgp_Æl_so·_ö
,

6740 
˛ór_bgp_Æl_ö_cmd
,

6742 
CLEAR_STR


6743 
BGP_STR


6747 
ALIAS
 (
˛ór_bgp_Æl_so·_ö
,

6748 
˛ór_bgp_ùv6_Æl_ö_cmd
,

6750 
CLEAR_STR


6751 
BGP_STR


6756 
DEFUN
 (
˛ór_bgp_Æl_ö_¥efix_fûãr
,

6757 
˛ór_bgp_Æl_ö_¥efix_fûãr_cmd
,

6759 
CLEAR_STR


6760 
BGP_STR


6765  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

6766 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

6769 
ALIAS
 (
˛ór_bgp_Æl_ö_¥efix_fûãr
,

6770 
˛ór_bgp_ùv6_Æl_ö_¥efix_fûãr_cmd
,

6772 
CLEAR_STR


6773 
BGP_STR


6779 
DEFUN
 (
˛ór_ù_bgp_≥î_so·_ö
,

6780 
˛ór_ù_bgp_≥î_so·_ö_cmd
,

6782 
CLEAR_STR


6783 
IP_STR


6784 
BGP_STR


6789  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6790 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

6793 
ALIAS
 (
˛ór_ù_bgp_≥î_so·_ö
,

6794 
˛ór_ù_bgp_≥î_ö_cmd
,

6796 
CLEAR_STR


6797 
IP_STR


6798 
BGP_STR


6802 
DEFUN
 (
˛ór_ù_bgp_≥î_ö_¥efix_fûãr
,

6803 
˛ór_ù_bgp_≥î_ö_¥efix_fûãr_cmd
,

6805 
CLEAR_STR


6806 
IP_STR


6807 
BGP_STR


6812  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6813 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

6816 
DEFUN
 (
˛ór_ù_bgp_≥î_ùv4_so·_ö
,

6817 
˛ór_ù_bgp_≥î_ùv4_so·_ö_cmd
,

6819 
CLEAR_STR


6820 
IP_STR


6821 
BGP_STR


6829 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

6830  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_≥î
,

6831 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

6833  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6834 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

6837 
ALIAS
 (
˛ór_ù_bgp_≥î_ùv4_so·_ö
,

6838 
˛ór_ù_bgp_≥î_ùv4_ö_cmd
,

6840 
CLEAR_STR


6841 
IP_STR


6842 
BGP_STR


6849 
DEFUN
 (
˛ór_ù_bgp_≥î_ùv4_ö_¥efix_fûãr
,

6850 
˛ór_ù_bgp_≥î_ùv4_ö_¥efix_fûãr_cmd
,

6852 
CLEAR_STR


6853 
IP_STR


6854 
BGP_STR


6862 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

6863  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_≥î
,

6864 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

6866  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6867 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

6870 
DEFUN
 (
˛ór_ù_bgp_≥î_v≤v4_so·_ö
,

6871 
˛ór_ù_bgp_≥î_v≤v4_so·_ö_cmd
,

6873 
CLEAR_STR


6874 
IP_STR


6875 
BGP_STR


6882  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_≥î
,

6883 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

6886 
ALIAS
 (
˛ór_ù_bgp_≥î_v≤v4_so·_ö
,

6887 
˛ór_ù_bgp_≥î_v≤v4_ö_cmd
,

6889 
CLEAR_STR


6890 
IP_STR


6891 
BGP_STR


6897 
DEFUN
 (
˛ór_bgp_≥î_so·_ö
,

6898 
˛ór_bgp_≥î_so·_ö_cmd
,

6900 
CLEAR_STR


6901 
BGP_STR


6907  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6908 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

6911 
ALIAS
 (
˛ór_bgp_≥î_so·_ö
,

6912 
˛ór_bgp_ùv6_≥î_so·_ö_cmd
,

6914 
CLEAR_STR


6915 
BGP_STR


6922 
ALIAS
 (
˛ór_bgp_≥î_so·_ö
,

6923 
˛ór_bgp_≥î_ö_cmd
,

6925 
CLEAR_STR


6926 
BGP_STR


6931 
ALIAS
 (
˛ór_bgp_≥î_so·_ö
,

6932 
˛ór_bgp_ùv6_≥î_ö_cmd
,

6934 
CLEAR_STR


6935 
BGP_STR


6941 
DEFUN
 (
˛ór_bgp_≥î_ö_¥efix_fûãr
,

6942 
˛ór_bgp_≥î_ö_¥efix_fûãr_cmd
,

6944 
CLEAR_STR


6945 
BGP_STR


6951  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_≥î
,

6952 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

6955 
ALIAS
 (
˛ór_bgp_≥î_ö_¥efix_fûãr
,

6956 
˛ór_bgp_ùv6_≥î_ö_¥efix_fûãr_cmd
,

6958 
CLEAR_STR


6959 
BGP_STR


6966 
DEFUN
 (
˛ór_ù_bgp_≥î_group_so·_ö
,

6967 
˛ór_ù_bgp_≥î_group_so·_ö_cmd
,

6969 
CLEAR_STR


6970 
IP_STR


6971 
BGP_STR


6977  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

6978 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

6981 
ALIAS
 (
˛ór_ù_bgp_≥î_group_so·_ö
,

6982 
˛ór_ù_bgp_≥î_group_ö_cmd
,

6984 
CLEAR_STR


6985 
IP_STR


6986 
BGP_STR


6991 
DEFUN
 (
˛ór_ù_bgp_≥î_group_ö_¥efix_fûãr
,

6992 
˛ór_ù_bgp_≥î_group_ö_¥efix_fûãr_cmd
,

6994 
CLEAR_STR


6995 
IP_STR


6996 
BGP_STR


7002  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

7003 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7006 
DEFUN
 (
˛ór_ù_bgp_≥î_group_ùv4_so·_ö
,

7007 
˛ór_ù_bgp_≥î_group_ùv4_so·_ö_cmd
,

7009 
CLEAR_STR


7010 
IP_STR


7011 
BGP_STR


7020 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7021  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_group
,

7022 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7024  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

7025 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7028 
ALIAS
 (
˛ór_ù_bgp_≥î_group_ùv4_so·_ö
,

7029 
˛ór_ù_bgp_≥î_group_ùv4_ö_cmd
,

7031 
CLEAR_STR


7032 
IP_STR


7033 
BGP_STR


7041 
DEFUN
 (
˛ór_ù_bgp_≥î_group_ùv4_ö_¥efix_fûãr
,

7042 
˛ór_ù_bgp_≥î_group_ùv4_ö_¥efix_fûãr_cmd
,

7044 
CLEAR_STR


7045 
IP_STR


7046 
BGP_STR


7055 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7056  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_group
,

7057 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7059  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

7060 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7063 
DEFUN
 (
˛ór_bgp_≥î_group_so·_ö
,

7064 
˛ór_bgp_≥î_group_so·_ö_cmd
,

7066 
CLEAR_STR


7067 
BGP_STR


7073  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_group
,

7074 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7077 
ALIAS
 (
˛ór_bgp_≥î_group_so·_ö
,

7078 
˛ór_bgp_ùv6_≥î_group_so·_ö_cmd
,

7080 
CLEAR_STR


7081 
BGP_STR


7088 
ALIAS
 (
˛ór_bgp_≥î_group_so·_ö
,

7089 
˛ór_bgp_≥î_group_ö_cmd
,

7091 
CLEAR_STR


7092 
BGP_STR


7097 
ALIAS
 (
˛ór_bgp_≥î_group_so·_ö
,

7098 
˛ór_bgp_ùv6_≥î_group_ö_cmd
,

7100 
CLEAR_STR


7101 
BGP_STR


7107 
DEFUN
 (
˛ór_bgp_≥î_group_ö_¥efix_fûãr
,

7108 
˛ór_bgp_≥î_group_ö_¥efix_fûãr_cmd
,

7110 
CLEAR_STR


7111 
BGP_STR


7117  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_group
,

7118 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7121 
ALIAS
 (
˛ór_bgp_≥î_group_ö_¥efix_fûãr
,

7122 
˛ór_bgp_ùv6_≥î_group_ö_¥efix_fûãr_cmd
,

7124 
CLEAR_STR


7125 
BGP_STR


7132 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_so·_ö
,

7133 
˛ór_ù_bgp_exã∫Æ_so·_ö_cmd
,

7135 
CLEAR_STR


7136 
IP_STR


7137 
BGP_STR


7142  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7143 
BGP_CLEAR_SOFT_IN
, 
NULL
);

7146 
ALIAS
 (
˛ór_ù_bgp_exã∫Æ_so·_ö
,

7147 
˛ór_ù_bgp_exã∫Æ_ö_cmd
,

7149 
CLEAR_STR


7150 
IP_STR


7151 
BGP_STR


7155 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_ö_¥efix_fûãr
,

7156 
˛ór_ù_bgp_exã∫Æ_ö_¥efix_fûãr_cmd
,

7158 
CLEAR_STR


7159 
IP_STR


7160 
BGP_STR


7165  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7166 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

7169 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_ùv4_so·_ö
,

7170 
˛ór_ù_bgp_exã∫Æ_ùv4_so·_ö_cmd
,

7172 
CLEAR_STR


7173 
IP_STR


7174 
BGP_STR


7182 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

7183  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_exã∫Æ
,

7184 
BGP_CLEAR_SOFT_IN
, 
NULL
);

7186  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7187 
BGP_CLEAR_SOFT_IN
, 
NULL
);

7190 
ALIAS
 (
˛ór_ù_bgp_exã∫Æ_ùv4_so·_ö
,

7191 
˛ór_ù_bgp_exã∫Æ_ùv4_ö_cmd
,

7193 
CLEAR_STR


7194 
IP_STR


7195 
BGP_STR


7202 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_ùv4_ö_¥efix_fûãr
,

7203 
˛ór_ù_bgp_exã∫Æ_ùv4_ö_¥efix_fûãr_cmd
,

7205 
CLEAR_STR


7206 
IP_STR


7207 
BGP_STR


7215 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

7216  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_exã∫Æ
,

7217 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

7219  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7220 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

7223 
DEFUN
 (
˛ór_bgp_exã∫Æ_so·_ö
,

7224 
˛ór_bgp_exã∫Æ_so·_ö_cmd
,

7226 
CLEAR_STR


7227 
BGP_STR


7232  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7233 
BGP_CLEAR_SOFT_IN
, 
NULL
);

7236 
ALIAS
 (
˛ór_bgp_exã∫Æ_so·_ö
,

7237 
˛ór_bgp_ùv6_exã∫Æ_so·_ö_cmd
,

7239 
CLEAR_STR


7240 
BGP_STR


7246 
ALIAS
 (
˛ór_bgp_exã∫Æ_so·_ö
,

7247 
˛ór_bgp_exã∫Æ_ö_cmd
,

7249 
CLEAR_STR


7250 
BGP_STR


7254 
ALIAS
 (
˛ór_bgp_exã∫Æ_so·_ö
,

7255 
˛ór_bgp_ùv6_exã∫Æ_ö_cmd
,

7257 
CLEAR_STR


7258 
BGP_STR


7263 
DEFUN
 (
˛ór_bgp_exã∫Æ_ö_¥efix_fûãr
,

7264 
˛ór_bgp_exã∫Æ_ö_¥efix_fûãr_cmd
,

7266 
CLEAR_STR


7267 
BGP_STR


7272  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7273 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
NULL
);

7276 
ALIAS
 (
˛ór_bgp_exã∫Æ_ö_¥efix_fûãr
,

7277 
˛ór_bgp_ùv6_exã∫Æ_ö_¥efix_fûãr_cmd
,

7279 
CLEAR_STR


7280 
BGP_STR


7286 
DEFUN
 (
˛ór_ù_bgp_as_so·_ö
,

7287 
˛ór_ù_bgp_as_so·_ö_cmd
,

7288 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " soft in",

7289 
CLEAR_STR


7290 
IP_STR


7291 
BGP_STR


7296  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

7297 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7300 
ALIAS
 (
˛ór_ù_bgp_as_so·_ö
,

7301 
˛ór_ù_bgp_as_ö_cmd
,

7302 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " in",

7303 
CLEAR_STR


7304 
IP_STR


7305 
BGP_STR


7309 
DEFUN
 (
˛ór_ù_bgp_as_ö_¥efix_fûãr
,

7310 
˛ór_ù_bgp_as_ö_¥efix_fûãr_cmd
,

7311 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " inÖrefix-filter",

7312 
CLEAR_STR


7313 
IP_STR


7314 
BGP_STR


7319  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

7320 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7323 
DEFUN
 (
˛ór_ù_bgp_as_ùv4_so·_ö
,

7324 
˛ór_ù_bgp_as_ùv4_so·_ö_cmd
,

7325 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " ipv4 (unicast|multicast) soft in",

7326 
CLEAR_STR


7327 
IP_STR


7328 
BGP_STR


7336 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7337  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_as
,

7338 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7340  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

7341 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7344 
ALIAS
 (
˛ór_ù_bgp_as_ùv4_so·_ö
,

7345 
˛ór_ù_bgp_as_ùv4_ö_cmd
,

7346 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " ipv4 (unicast|multicast) in",

7347 
CLEAR_STR


7348 
IP_STR


7349 
BGP_STR


7356 
DEFUN
 (
˛ór_ù_bgp_as_ùv4_ö_¥efix_fûãr
,

7357 
˛ór_ù_bgp_as_ùv4_ö_¥efix_fûãr_cmd
,

7358 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " ipv4 (unicast|multicast) inÖrefix-filter",

7359 
CLEAR_STR


7360 
IP_STR


7361 
BGP_STR


7369 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7370  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_as
,

7371 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7373  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

7374 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7377 
DEFUN
 (
˛ór_ù_bgp_as_v≤v4_so·_ö
,

7378 
˛ór_ù_bgp_as_v≤v4_so·_ö_cmd
,

7379 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " vpnv4 unicast soft in",

7380 
CLEAR_STR


7381 
IP_STR


7382 
BGP_STR


7389  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_as
,

7390 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7393 
ALIAS
 (
˛ór_ù_bgp_as_v≤v4_so·_ö
,

7394 
˛ór_ù_bgp_as_v≤v4_ö_cmd
,

7395 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " vpnv4 unicast in",

7396 
CLEAR_STR


7397 
IP_STR


7398 
BGP_STR


7404 
DEFUN
 (
˛ór_bgp_as_so·_ö
,

7405 
˛ór_bgp_as_so·_ö_cmd
,

7406 "˛ó∏bg∞" 
CMD_AS_RANGE
 " soft in",

7407 
CLEAR_STR


7408 
BGP_STR


7413  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_as
,

7414 
BGP_CLEAR_SOFT_IN
, 
¨gv
[0]);

7417 
ALIAS
 (
˛ór_bgp_as_so·_ö
,

7418 
˛ór_bgp_ùv6_as_so·_ö_cmd
,

7419 "˛ó∏bg∞ùv6 " 
CMD_AS_RANGE
 " soft in",

7420 
CLEAR_STR


7421 
BGP_STR


7427 
ALIAS
 (
˛ór_bgp_as_so·_ö
,

7428 
˛ór_bgp_as_ö_cmd
,

7429 "˛ó∏bg∞" 
CMD_AS_RANGE
 " in",

7430 
CLEAR_STR


7431 
BGP_STR


7435 
ALIAS
 (
˛ór_bgp_as_so·_ö
,

7436 
˛ór_bgp_ùv6_as_ö_cmd
,

7437 "˛ó∏bg∞ùv6 " 
CMD_AS_RANGE
 " in",

7438 
CLEAR_STR


7439 
BGP_STR


7444 
DEFUN
 (
˛ór_bgp_as_ö_¥efix_fûãr
,

7445 
˛ór_bgp_as_ö_¥efix_fûãr_cmd
,

7446 "˛ó∏bg∞" 
CMD_AS_RANGE
 " inÖrefix-filter",

7447 
CLEAR_STR


7448 
BGP_STR


7453  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_as
,

7454 
BGP_CLEAR_SOFT_IN_ORF_PREFIX
, 
¨gv
[0]);

7457 
ALIAS
 (
˛ór_bgp_as_ö_¥efix_fûãr
,

7458 
˛ór_bgp_ùv6_as_ö_¥efix_fûãr_cmd
,

7459 "˛ó∏bg∞ùv6 " 
CMD_AS_RANGE
 " inÖrefix-filter",

7460 
CLEAR_STR


7461 
BGP_STR


7468 
DEFUN
 (
˛ór_ù_bgp_Æl_so·
,

7469 
˛ór_ù_bgp_Æl_so·_cmd
,

7471 
CLEAR_STR


7472 
IP_STR


7473 
BGP_STR


7477 i‡(
	g¨gc
 == 1)

7478  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7479 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7481  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7482 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7485 
ALIAS
 (
˛ór_ù_bgp_Æl_so·
,

7486 
˛ór_ù_bgp_ö°™˚_Æl_so·_cmd
,

7488 
CLEAR_STR


7489 
IP_STR


7490 
BGP_STR


7497 
DEFUN
 (
˛ór_ù_bgp_Æl_ùv4_so·
,

7498 
˛ór_ù_bgp_Æl_ùv4_so·_cmd
,

7500 
CLEAR_STR


7501 
IP_STR


7502 
BGP_STR


7509 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

7510  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

7511 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7513  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7514 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7517 
DEFUN
 (
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·
,

7518 
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_cmd
,

7520 
CLEAR_STR


7521 
IP_STR


7522 
BGP_STR


7531 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7532  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_Æl
,

7533 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7535  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7536 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7539 
DEFUN
 (
˛ór_ù_bgp_Æl_v≤v4_so·
,

7540 
˛ór_ù_bgp_Æl_v≤v4_so·_cmd
,

7542 
CLEAR_STR


7543 
IP_STR


7544 
BGP_STR


7550  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_Æl
,

7551 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7554 
DEFUN
 (
˛ór_bgp_Æl_so·
,

7555 
˛ór_bgp_Æl_so·_cmd
,

7557 
CLEAR_STR


7558 
BGP_STR


7562 i‡(
	g¨gc
 == 1)

7563  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7564 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7566  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7567 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7570 
ALIAS
 (
˛ór_bgp_Æl_so·
,

7571 
˛ór_bgp_ö°™˚_Æl_so·_cmd
,

7573 
CLEAR_STR


7574 
BGP_STR


7580 
ALIAS
 (
˛ór_bgp_Æl_so·
,

7581 
˛ór_bgp_ùv6_Æl_so·_cmd
,

7583 
CLEAR_STR


7584 
BGP_STR


7589 
DEFUN
 (
˛ór_ù_bgp_≥î_so·
,

7590 
˛ór_ù_bgp_≥î_so·_cmd
,

7592 
CLEAR_STR


7593 
IP_STR


7594 
BGP_STR


7598  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

7599 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7602 
DEFUN
 (
˛ór_ù_bgp_≥î_ùv4_so·
,

7603 
˛ór_ù_bgp_≥î_ùv4_so·_cmd
,

7605 
CLEAR_STR


7606 
IP_STR


7607 
BGP_STR


7614 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7615  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_≥î
,

7616 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7618  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

7619 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7622 
DEFUN
 (
˛ór_ù_bgp_≥î_v≤v4_so·
,

7623 
˛ór_ù_bgp_≥î_v≤v4_so·_cmd
,

7625 
CLEAR_STR


7626 
IP_STR


7627 
BGP_STR


7633  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_≥î
,

7634 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7637 
DEFUN
 (
˛ór_bgp_≥î_so·
,

7638 
˛ór_bgp_≥î_so·_cmd
,

7640 
CLEAR_STR


7641 
BGP_STR


7646  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_≥î
,

7647 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7650 
ALIAS
 (
˛ór_bgp_≥î_so·
,

7651 
˛ór_bgp_ùv6_≥î_so·_cmd
,

7653 
CLEAR_STR


7654 
BGP_STR


7660 
DEFUN
 (
˛ór_ù_bgp_≥î_group_so·
,

7661 
˛ór_ù_bgp_≥î_group_so·_cmd
,

7663 
CLEAR_STR


7664 
IP_STR


7665 
BGP_STR


7670  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

7671 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7674 
DEFUN
 (
˛ór_ù_bgp_≥î_group_ùv4_so·
,

7675 
˛ór_ù_bgp_≥î_group_ùv4_so·_cmd
,

7677 
CLEAR_STR


7678 
IP_STR


7679 
BGP_STR


7687 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7688  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_group
,

7689 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7691  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_group
,

7692 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7695 
DEFUN
 (
˛ór_bgp_≥î_group_so·
,

7696 
˛ór_bgp_≥î_group_so·_cmd
,

7698 
CLEAR_STR


7699 
BGP_STR


7704  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_group
,

7705 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7708 
ALIAS
 (
˛ór_bgp_≥î_group_so·
,

7709 
˛ór_bgp_ùv6_≥î_group_so·_cmd
,

7711 
CLEAR_STR


7712 
BGP_STR


7718 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_so·
,

7719 
˛ór_ù_bgp_exã∫Æ_so·_cmd
,

7721 
CLEAR_STR


7722 
IP_STR


7723 
BGP_STR


7727  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7728 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7731 
DEFUN
 (
˛ór_ù_bgp_exã∫Æ_ùv4_so·
,

7732 
˛ór_ù_bgp_exã∫Æ_ùv4_so·_cmd
,

7734 
CLEAR_STR


7735 
IP_STR


7736 
BGP_STR


7743 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

7744  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_exã∫Æ
,

7745 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7747  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7748 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7751 
DEFUN
 (
˛ór_bgp_exã∫Æ_so·
,

7752 
˛ór_bgp_exã∫Æ_so·_cmd
,

7754 
CLEAR_STR


7755 
BGP_STR


7759  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_exã∫Æ
,

7760 
BGP_CLEAR_SOFT_BOTH
, 
NULL
);

7763 
ALIAS
 (
˛ór_bgp_exã∫Æ_so·
,

7764 
˛ór_bgp_ùv6_exã∫Æ_so·_cmd
,

7766 
CLEAR_STR


7767 
BGP_STR


7772 
DEFUN
 (
˛ór_ù_bgp_as_so·
,

7773 
˛ór_ù_bgp_as_so·_cmd
,

7774 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " soft",

7775 
CLEAR_STR


7776 
IP_STR


7777 
BGP_STR


7781  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

7782 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7785 
DEFUN
 (
˛ór_ù_bgp_as_ùv4_so·
,

7786 
˛ór_ù_bgp_as_ùv4_so·_cmd
,

7787 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " ipv4 (unicast|multicast) soft",

7788 
CLEAR_STR


7789 
IP_STR


7790 
BGP_STR


7797 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

7798  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
, 
˛ór_as
,

7799 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7801  
bgp_˛ór_vty
 (
vty
, 
NULL
,
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_as
,

7802 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7805 
DEFUN
 (
˛ór_ù_bgp_as_v≤v4_so·
,

7806 
˛ór_ù_bgp_as_v≤v4_so·_cmd
,

7807 "˛ó∏ù bg∞" 
CMD_AS_RANGE
 " vpnv4 unicast soft",

7808 
CLEAR_STR


7809 
IP_STR


7810 
BGP_STR


7816  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
, 
˛ór_as
,

7817 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7820 
DEFUN
 (
˛ór_bgp_as_so·
,

7821 
˛ór_bgp_as_so·_cmd
,

7822 "˛ó∏bg∞" 
CMD_AS_RANGE
 " soft",

7823 
CLEAR_STR


7824 
BGP_STR


7828  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_as
,

7829 
BGP_CLEAR_SOFT_BOTH
, 
¨gv
[0]);

7832 
ALIAS
 (
˛ór_bgp_as_so·
,

7833 
˛ór_bgp_ùv6_as_so·_cmd
,

7834 "˛ó∏bg∞ùv6 " 
CMD_AS_RANGE
 " soft",

7835 
CLEAR_STR


7836 
BGP_STR


7842 #ifde‡
HAVE_IPV6


7843 
DEFUN
 (
˛ór_bgp_Æl_rs˛õ¡
,

7844 
˛ór_bgp_Æl_rs˛õ¡_cmd
,

7846 
CLEAR_STR


7847 
BGP_STR


7851 i‡(
	g¨gc
 == 1)

7852  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7853 
BGP_CLEAR_SOFT_RSCLIENT
, 
NULL
);

7855  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7856 
BGP_CLEAR_SOFT_RSCLIENT
, 
NULL
);

7859 
ALIAS
 (
˛ór_bgp_Æl_rs˛õ¡
,

7860 
˛ór_bgp_ùv6_Æl_rs˛õ¡_cmd
,

7862 
CLEAR_STR


7863 
BGP_STR


7868 
ALIAS
 (
˛ór_bgp_Æl_rs˛õ¡
,

7869 
˛ór_bgp_ö°™˚_Æl_rs˛õ¡_cmd
,

7871 
CLEAR_STR


7872 
BGP_STR


7878 
ALIAS
 (
˛ór_bgp_Æl_rs˛õ¡
,

7879 
˛ór_bgp_ùv6_ö°™˚_Æl_rs˛õ¡_cmd
,

7881 
CLEAR_STR


7882 
BGP_STR


7890 
DEFUN
 (
˛ór_ù_bgp_Æl_rs˛õ¡
,

7891 
˛ór_ù_bgp_Æl_rs˛õ¡_cmd
,

7893 
CLEAR_STR


7894 
IP_STR


7895 
BGP_STR


7899 i‡(
	g¨gc
 == 1)

7900  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7901 
BGP_CLEAR_SOFT_RSCLIENT
, 
NULL
);

7903  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_Æl
,

7904 
BGP_CLEAR_SOFT_RSCLIENT
, 
NULL
);

7907 
ALIAS
 (
˛ór_ù_bgp_Æl_rs˛õ¡
,

7908 
˛ór_ù_bgp_ö°™˚_Æl_rs˛õ¡_cmd
,

7910 
CLEAR_STR


7911 
IP_STR


7912 
BGP_STR


7918 #ifde‡
HAVE_IPV6


7919 
DEFUN
 (
˛ór_bgp_≥î_rs˛õ¡
,

7920 
˛ór_bgp_≥î_rs˛õ¡_cmd
,

7922 
CLEAR_STR


7923 
BGP_STR


7928 i‡(
	g¨gc
 == 2)

7929  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_≥î
,

7930 
BGP_CLEAR_SOFT_RSCLIENT
, 
¨gv
[1]);

7932  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
, 
˛ór_≥î
,

7933 
BGP_CLEAR_SOFT_RSCLIENT
, 
¨gv
[0]);

7936 
ALIAS
 (
˛ór_bgp_≥î_rs˛õ¡
,

7937 
˛ór_bgp_ùv6_≥î_rs˛õ¡_cmd
,

7939 
CLEAR_STR


7940 
BGP_STR


7946 
ALIAS
 (
˛ór_bgp_≥î_rs˛õ¡
,

7947 
˛ór_bgp_ö°™˚_≥î_rs˛õ¡_cmd
,

7949 
CLEAR_STR


7950 
BGP_STR


7957 
ALIAS
 (
˛ór_bgp_≥î_rs˛õ¡
,

7958 
˛ór_bgp_ùv6_ö°™˚_≥î_rs˛õ¡_cmd
,

7960 
CLEAR_STR


7961 
BGP_STR


7970 
DEFUN
 (
˛ór_ù_bgp_≥î_rs˛õ¡
,

7971 
˛ór_ù_bgp_≥î_rs˛õ¡_cmd
,

7973 
CLEAR_STR


7974 
IP_STR


7975 
BGP_STR


7980 i‡(
	g¨gc
 == 2)

7981  
bgp_˛ór_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

7982 
BGP_CLEAR_SOFT_RSCLIENT
, 
¨gv
[1]);

7984  
bgp_˛ór_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
, 
˛ór_≥î
,

7985 
BGP_CLEAR_SOFT_RSCLIENT
, 
¨gv
[0]);

7988 
ALIAS
 (
˛ór_ù_bgp_≥î_rs˛õ¡
,

7989 
˛ór_ù_bgp_ö°™˚_≥î_rs˛õ¡_cmd
,

7991 
CLEAR_STR


7992 
IP_STR


7993 
BGP_STR


8000 
DEFUN
 (
show_bgp_võws
,

8001 
show_bgp_võws_cmd
,

8003 
SHOW_STR


8004 
BGP_STR


8007 
li°
 *
	gö°
 = 
bm
->
bgp
;

8008 
li°node
 *
	gnode
;

8009 
bgp
 *
	gbgp
;

8011 i‡(!
bgp_›ti⁄_check
 (
BGP_OPT_MULTIPLE_INSTANCE
))

8013 
vty_out
 (
vty
, "Mu…ùÀ BGP võw†¨ênŸ deföed%s", 
VTY_NEWLINE
);

8014  
	gCMD_WARNING
;

8017 
vty_out
 (
vty
, "Deföed BGP võws:%s", 
VTY_NEWLINE
);

8018 
ALL_LIST_ELEMENTS_RO
(
ö°
, 
node
, 
bgp
))

8019 
vty_out
 (
vty
, "\t%s (AS%u)%s",

8020 
bgp
->
«me
 ? bgp->name : "(null)",

8021 
bgp
->
as
, 
VTY_NEWLINE
);

8023  
	gCMD_SUCCESS
;

8026 
DEFUN
 (
show_bgp_mem‹y
,

8027 
show_bgp_mem‹y_cmd
,

8029 
SHOW_STR


8030 
BGP_STR


8033 
	gmem°rbuf
[
MTYPE_MEMSTR_LEN
];

8034 
	gcou¡
;

8037 
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_NODE
);

8038 
vty_out
 (
vty
, "%ld RIBÇodes, usög %†o‡mem‹y%s", 
cou¡
,

8039 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8040 
cou¡
 *  (
bgp_node
)),

8041 
VTY_NEWLINE
);

8043 
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_ROUTE
);

8044 
vty_out
 (
vty
, "%ld BGPÑouãs, usög %†o‡mem‹y%s", 
cou¡
,

8045 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8046 
cou¡
 *  (
bgp_öfo
)),

8047 
VTY_NEWLINE
);

8048 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_ROUTE_EXTRA
)))

8049 
vty_out
 (
vty
, "%ld BGPÑouãáncûœrõs, usög %†o‡mem‹y%s", 
cou¡
,

8050 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8051 
cou¡
 *  (
bgp_öfo_exåa
)),

8052 
VTY_NEWLINE
);

8054 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_STATIC
)))

8055 
vty_out
 (
vty
, "%ld Sèti¯rouãs, usög %†o‡mem‹y%s", 
cou¡
,

8056 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8057 
cou¡
 *  (
bgp_°©ic
)),

8058 
VTY_NEWLINE
);

8061 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_ADJ_IN
)))

8062 
vty_out
 (
vty
, "%ld Adj-I¿íåõs, usög %†o‡mem‹y%s", 
cou¡
,

8063 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8064 
cou¡
 *  (
bgp_adj_ö
)),

8065 
VTY_NEWLINE
);

8066 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_ADJ_OUT
)))

8067 
vty_out
 (
vty
, "%ld Adj-Ouàíåõs, usög %†o‡mem‹y%s", 
cou¡
,

8068 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8069 
cou¡
 *  (
bgp_adj_out
)),

8070 
VTY_NEWLINE
);

8072 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_NEXTHOP_CACHE
)))

8073 
vty_out
 (
vty
, "%ld Nexth› cachêíåõs, usög %†o‡mem‹y%s", 
cou¡
,

8074 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8075 
cou¡
 *  (
bgp_√xth›_ˇche
)),

8076 
VTY_NEWLINE
);

8078 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_DAMP_INFO
)))

8079 
vty_out
 (
vty
, "%ld Dam≥nögÉ¡rõs, usög %†o‡mem‹y%s", 
cou¡
,

8080 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8081 
cou¡
 *  (
bgp_damp_öfo
)),

8082 
VTY_NEWLINE
);

8085 
	gcou¡
 = 
©å_cou¡
();

8086 
vty_out
 (
vty
, "%ld BGPáâribuãs, usög %†o‡mem‹y%s", 
cou¡
,

8087 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8088 
cou¡
 * (
©å
)),

8089 
VTY_NEWLINE
);

8090 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_ATTR_EXTRA
)))

8091 
vty_out
 (
vty
, "%ld BGPÉxå®©åibuãs, usög %†o‡mem‹y%s", 
cou¡
,

8092 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8093 
cou¡
 * (
©å_exåa
)),

8094 
VTY_NEWLINE
);

8096 i‡((
	gcou¡
 = 
©å_unknown_cou¡
()))

8097 
vty_out
 (
vty
, "%ld unknow¿©åibuãs%s", 
cou¡
, 
VTY_NEWLINE
);

8100 
	gcou¡
 = 
a•©h_cou¡
 ();

8101 
vty_out
 (
vty
, "%ld BGP AS-PATHÉ¡rõs, usög %†o‡mem‹y%s", 
cou¡
,

8102 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8103 
cou¡
 *  (
a•©h
)),

8104 
VTY_NEWLINE
);

8106 
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_AS_SEG
);

8107 
vty_out
 (
vty
, "%ld BGP AS-PATH segmíts, usög %†o‡mem‹y%s", 
cou¡
,

8108 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8109 
cou¡
 *  (
as£gmít
)),

8110 
VTY_NEWLINE
);

8113 i‡((
	gcou¡
 = 
communôy_cou¡
 ()))

8114 
vty_out
 (
vty
, "%ld BGP communôyÉ¡rõs, usög %†o‡mem‹y%s", 
cou¡
,

8115 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8116 
cou¡
 *  (
communôy
)),

8117 
VTY_NEWLINE
);

8118 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_ECOMMUNITY
)))

8119 
vty_out
 (
vty
, "%ld BGP communôyÉ¡rõs, usög %†o‡mem‹y%s", 
cou¡
,

8120 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8121 
cou¡
 *  (
ecommunôy
)),

8122 
VTY_NEWLINE
);

8124 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_CLUSTER
)))

8125 
vty_out
 (
vty
, "%ld Clu°îÜi°s, usög %†o‡mem‹y%s", 
cou¡
,

8126 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8127 
cou¡
 *  (
˛u°î_li°
)),

8128 
VTY_NEWLINE
);

8131 
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_PEER
);

8132 
vty_out
 (
vty
, "%ldÖìrs, usög %†o‡mem‹y%s", 
cou¡
,

8133 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8134 
cou¡
 *  (
≥î
)),

8135 
VTY_NEWLINE
);

8137 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_PEER_GROUP
)))

8138 
vty_out
 (
vty
, "%ldÖì∏groups, usög %†o‡mem‹y%s", 
cou¡
,

8139 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8140 
cou¡
 *  (
≥î_group
)),

8141 
VTY_NEWLINE
);

8144 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_HASH
)))

8145 
vty_out
 (
vty
, "%ld hashÅabÀs, usög %†o‡mem‹y%s", 
cou¡
,

8146 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8147 
cou¡
 *  (
hash
)),

8148 
VTY_NEWLINE
);

8149 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_HASH_BACKET
)))

8150 
vty_out
 (
vty
, "%ld hash buckës, usög %†o‡mem‹y%s", 
cou¡
,

8151 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8152 
cou¡
 *  (
hash_backë
)),

8153 
VTY_NEWLINE
);

8154 i‡((
	gcou¡
 = 
mty≥_°©s_Æloc
 (
MTYPE_BGP_REGEXP
)))

8155 
vty_out
 (
vty
, "%ld compûedÑegexes, usög %†o‡mem‹y%s", 
cou¡
,

8156 
mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8157 
cou¡
 *  (
ªgex_t
)),

8158 
VTY_NEWLINE
);

8159  
	gCMD_SUCCESS
;

8164 
	$bgp_show_summ¨y
 (
vty
 *vty, 
bgp
 *bgp, 
afi
, 
ßfi
)

8166 
≥î
 *peer;

8167 
li°node
 *
node
, *
¬ode
;

8168 
cou¡
 = 0;

8169 
timebuf
[
BGP_UPTIME_LEN
];

8170 
Àn
;

8173 
hódî
[] = "Neighbor V AS MsgRcvd MsgSent TblVer InQ OutQ Up/Down State/PfxRcd";

8175 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

8177 i‡(
≥î
->
afc
[
afi
][
ßfi
])

8179 i‡(!
cou¡
)

8181 
íts
;

8182 
mem°rbuf
[
MTYPE_MEMSTR_LEN
];

8185 
	`vty_out
 (
vty
,

8187 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
), bgp->
as
, 
VTY_NEWLINE
);

8189 
íts
 = 
	`bgp_èbÀ_cou¡
 (
bgp
->
rib
[
afi
][
ßfi
]);

8190 
	`vty_out
 (
vty
, "RIBÉ¡rõ†%ld, usög %†o‡mem‹y%s", 
íts
,

8191 
	`mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8192 
íts
 *  (
bgp_node
)),

8193 
VTY_NEWLINE
);

8195 #ifde‡
USE_SRX


8196 
	`vty_out
 (
vty
,

8198 
bgp
->
§x_ho°
, bgp->
§x_p‹t
, 
VTY_NEWLINE
);

8202 
íts
 = 
	`li°cou¡
 (
bgp
->
≥î
);

8203 
	`vty_out
 (
vty
, "Peers %ld, using %s of memory%s",

8204 
íts
,

8205 
	`mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8206 
íts
 *  (
≥î
)),

8207 
VTY_NEWLINE
);

8209 i‡((
íts
 = 
	`li°cou¡
 (
bgp
->
rs˛õ¡
)))

8210 
	`vty_out
 (
vty
, "RS-ClientÖeers %ld, using %s of memory%s",

8211 
íts
,

8212 
	`mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8213 
íts
 *  (
≥î
)),

8214 
VTY_NEWLINE
);

8216 i‡((
íts
 = 
	`li°cou¡
 (
bgp
->
group
)))

8217 
	`vty_out
 (
vty
, "Pì∏group†%ld, usög %†o‡mem‹y%s", 
íts
,

8218 
	`mty≥_mem°r
 (
mem°rbuf
,  (memstrbuf),

8219 
íts
 *  (
≥î_group
)),

8220 
VTY_NEWLINE
);

8222 i‡(
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
afi
][
ßfi
], 
BGP_CONFIG_DAMPENING
))

8223 
	`vty_out
 (
vty
, "Dam≥nögÉ«bÀd.%s", 
VTY_NEWLINE
);

8224 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8225 
	`vty_out
 (
vty
, "%s%s", 
hódî
, 
VTY_NEWLINE
);

8228 
cou¡
++;

8230 
Àn
 = 
	`vty_out
 (
vty
, "%s", 
≥î
->
ho°
);

8231 
Àn
 = 16 -Üen;

8232 i‡(
Àn
 < 1)

8233 
	`vty_out
 (
vty
, "%s%*s", 
VTY_NEWLINE
, 16, " ");

8235 
	`vty_out
 (
vty
, "%*s", 
Àn
, " ");

8237 
	`vty_out
 (
vty
, "4 ");

8239 
	`vty_out
 (
vty
, "%5u %7d %7d %8d %4d %4lu ",

8240 
≥î
->
as
,

8241 
≥î
->
›í_ö
 +Öìr->
upd©e_ö
 +Öìr->
kì∑live_ö


8242 + 
≥î
->
nŸify_ö
 +Öìr->
ª‰esh_ö
 +Öìr->
dy«mic_ˇp_ö
,

8243 
≥î
->
›í_out
 +Öìr->
upd©e_out
 +Öìr->
kì∑live_out


8244 + 
≥î
->
nŸify_out
 +Öìr->
ª‰esh_out


8245 + 
≥î
->
dy«mic_ˇp_out
,

8246 0, 0, (Ë
≥î
->
obuf
->
cou¡
);

8248 
	`vty_out
 (
vty
, "%8s",

8249 
	`≥î_u±ime
 (
≥î
->
u±ime
, 
timebuf
, 
BGP_UPTIME_LEN
));

8251 i‡(
≥î
->
°©us
 =
E°ablished
)

8253 
	`vty_out
 (
vty
, " %8ld", 
≥î
->
pcou¡
[
afi
][
ßfi
]);

8257 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_SHUTDOWN
))

8258 
	`vty_out
 (
vty
, " Idle (Admin)");

8259 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
))

8260 
	`vty_out
 (
vty
, " Idle (PfxCt)");

8262 
	`vty_out
 (
vty
, " %-11s", 
	`LOOKUP
(
bgp_°©us_msg
, 
≥î
->
°©us
));

8265 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8269 i‡(
cou¡
)

8270 
	`vty_out
 (
vty
, "%sTŸÆÇumbî o‡√ighb‹†%d%s", 
VTY_NEWLINE
,

8271 
cou¡
, 
VTY_NEWLINE
);

8273 
	`vty_out
 (
vty
, "No %sÇeighbor is configured%s",

8274 
afi
 =
AFI_IP
 ? "IPv4" : "IPv6", 
VTY_NEWLINE
);

8275  
CMD_SUCCESS
;

8276 
	}
}

8279 
	$bgp_show_summ¨y_vty
 (
vty
 *vty, c⁄° *
«me
,

8280 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

8282 
bgp
 *bgp;

8284 i‡(
«me
)

8286 
bgp
 = 
	`bgp_lookup_by_«me
 (
«me
);

8288 i‡(! 
bgp
)

8290 
	`vty_out
 (
vty
, "%% Nÿsuch BGP in°™˚Éxi°%s", 
VTY_NEWLINE
);

8291  
CMD_WARNING
;

8294 
	`bgp_show_summ¨y
 (
vty
, 
bgp
, 
afi
, 
ßfi
);

8295  
CMD_SUCCESS
;

8298 
bgp
 = 
	`bgp_gë_deÁu…
 ();

8300 i‡(
bgp
)

8301 
	`bgp_show_summ¨y
 (
vty
, 
bgp
, 
afi
, 
ßfi
);

8303  
CMD_SUCCESS
;

8304 
	}
}

8307 
DEFUN
 (
show_ù_bgp_summ¨y
,

8308 
show_ù_bgp_summ¨y_cmd
,

8310 
SHOW_STR


8311 
IP_STR


8312 
BGP_STR


8315  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
);

8318 
DEFUN
 (
show_ù_bgp_ö°™˚_summ¨y
,

8319 
show_ù_bgp_ö°™˚_summ¨y_cmd
,

8321 
SHOW_STR


8322 
IP_STR


8323 
BGP_STR


8328  
bgp_show_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
);

8331 
DEFUN
 (
show_ù_bgp_ùv4_summ¨y
,

8332 
show_ù_bgp_ùv4_summ¨y_cmd
,

8334 
SHOW_STR


8335 
IP_STR


8336 
BGP_STR


8342 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8343  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
);

8345  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
);

8348 
ALIAS
 (
show_ù_bgp_ùv4_summ¨y
,

8349 
show_bgp_ùv4_ßfi_summ¨y_cmd
,

8351 
SHOW_STR


8352 
BGP_STR


8358 
DEFUN
 (
show_ù_bgp_ö°™˚_ùv4_summ¨y
,

8359 
show_ù_bgp_ö°™˚_ùv4_summ¨y_cmd
,

8361 
SHOW_STR


8362 
IP_STR


8363 
BGP_STR


8371 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

8372  
bgp_show_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_MULTICAST
);

8374  
bgp_show_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
);

8377 
ALIAS
 (
show_ù_bgp_ö°™˚_ùv4_summ¨y
,

8378 
show_bgp_ö°™˚_ùv4_ßfi_summ¨y_cmd
,

8380 
SHOW_STR


8381 
BGP_STR


8389 
DEFUN
 (
show_ù_bgp_v≤v4_Æl_summ¨y
,

8390 
show_ù_bgp_v≤v4_Æl_summ¨y_cmd
,

8392 
SHOW_STR


8393 
IP_STR


8394 
BGP_STR


8399  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
);

8402 
DEFUN
 (
show_ù_bgp_v≤v4_rd_summ¨y
,

8403 
show_ù_bgp_v≤v4_rd_summ¨y_cmd
,

8405 
SHOW_STR


8406 
IP_STR


8407 
BGP_STR


8413 
	gªt
;

8414 
¥efix_rd
 
	g¥d
;

8416 
	gªt
 = 
°r2¥efix_rd
 (
¨gv
[0], &
¥d
);

8417 i‡(! 
	gªt
)

8419 
vty_out
 (
vty
, "%% MÆf‹med Rouã Di°öguishî%s", 
VTY_NEWLINE
);

8420  
	gCMD_WARNING
;

8423  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MPLS_VPN
);

8426 #ifde‡
HAVE_IPV6


8427 
DEFUN
 (
show_bgp_summ¨y
,

8428 
show_bgp_summ¨y_cmd
,

8430 
SHOW_STR


8431 
BGP_STR


8434  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
);

8437 
DEFUN
 (
show_bgp_ö°™˚_summ¨y
,

8438 
show_bgp_ö°™˚_summ¨y_cmd
,

8440 
SHOW_STR


8441 
BGP_STR


8446  
bgp_show_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
);

8449 
ALIAS
 (
show_bgp_summ¨y
,

8450 
show_bgp_ùv6_summ¨y_cmd
,

8452 
SHOW_STR


8453 
BGP_STR


8457 
ALIAS
 (
show_bgp_ö°™˚_summ¨y
,

8458 
show_bgp_ö°™˚_ùv6_summ¨y_cmd
,

8460 
SHOW_STR


8461 
BGP_STR


8467 
DEFUN
 (
show_bgp_ùv6_ßfi_summ¨y
,

8468 
show_bgp_ùv6_ßfi_summ¨y_cmd
,

8470 
SHOW_STR


8471 
BGP_STR


8477 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

8478  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_MULTICAST
);

8480  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
);

8483 
DEFUN
 (
show_bgp_ö°™˚_ùv6_ßfi_summ¨y
,

8484 
show_bgp_ö°™˚_ùv6_ßfi_summ¨y_cmd
,

8486 
SHOW_STR


8487 
BGP_STR


8495 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

8496  
bgp_show_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_MULTICAST
);

8498  
bgp_show_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
);

8502 
DEFUN
 (
show_ùv6_bgp_summ¨y
,

8503 
show_ùv6_bgp_summ¨y_cmd
,

8505 
SHOW_STR


8506 
IPV6_STR


8507 
BGP_STR


8510  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
);

8514 
DEFUN
 (
show_ùv6_mbgp_summ¨y
,

8515 
show_ùv6_mbgp_summ¨y_cmd
,

8517 
SHOW_STR


8518 
IPV6_STR


8519 
MBGP_STR


8522  
bgp_show_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_MULTICAST
);

8527 
	$afi_ßfi_¥öt
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

8529 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

8531 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_MULTICAST
)

8533 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_MPLS_VPN
)

8535 i‡(
afi
 =
AFI_IP6
 && 
ßfi
 =
SAFI_UNICAST
)

8537 i‡(
afi
 =
AFI_IP6
 && 
ßfi
 =
SAFI_MULTICAST
)

8541 
	}
}

8544 
	eshow_ty≥


8546 
	mshow_Æl
,

8547 
	mshow_≥î


8551 
	$bgp_show_≥î_afi_‹f_ˇp
 (
vty
 *vty, 
≥î
 *
p
,

8552 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

8553 
u_öt16_t
 
adv_smˇp
, u_öt16_à
adv_rmˇp
,

8554 
u_öt16_t
 
rcv_smˇp
, u_öt16_à
rcv_rmˇp
)

8557 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
adv_smˇp
)

8558 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
rcv_smˇp
))

8560 
	`vty_out
 (
vty
, " Send-mode: ");

8561 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
adv_smˇp
))

8562 
	`vty_out
 (
vty
, "advertised");

8563 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
rcv_smˇp
))

8564 
	`vty_out
 (
vty
, "%sreceived",

8565 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
adv_smˇp
) ?

8567 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8571 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
adv_rmˇp
)

8572 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
rcv_rmˇp
))

8574 
	`vty_out
 (
vty
, " Receive-mode: ");

8575 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
adv_rmˇp
))

8576 
	`vty_out
 (
vty
, "advertised");

8577 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
rcv_rmˇp
))

8578 
	`vty_out
 (
vty
, "%sreceived",

8579 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
adv_rmˇp
) ?

8581 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8583 
	}
}

8586 
	$bgp_show_≥î_afi
 (
vty
 *vty, 
≥î
 *
p
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

8588 
bgp_fûãr
 *
fûãr
;

8589 
‹f_pfx_«me
[
BUFSIZ
];

8590 
‹f_pfx_cou¡
;

8592 
fûãr
 = &
p
->fûãr[
afi
][
ßfi
];

8594 
	`vty_out
 (
vty
, " F‹áddªs†Ámûy: %s%s", 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
),

8595 
VTY_NEWLINE
);

8597 i‡(
p
->
af_group
[
afi
][
ßfi
])

8598 
	`vty_out
 (
vty
, " %†≥î-grou∞membî%s", 
p
->
group
->
«me
, 
VTY_NEWLINE
);

8600 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_ADV
)

8601 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_RCV
)

8602 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_OLD_RCV
)

8603 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
)

8604 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_RCV
)

8605 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_OLD_RCV
))

8606 
	`vty_out
 (
vty
, " AF-dïíd™àˇ∑bûôõs:%s", 
VTY_NEWLINE
);

8608 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_ADV
)

8609 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_RCV
)

8610 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
)

8611 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_RCV
))

8613 
	`vty_out
 (
vty
, " Outbound Route Filter (ORF)Åype (%d) Prefix-list:%s",

8614 
ORF_TYPE_PREFIX
, 
VTY_NEWLINE
);

8615 
	`bgp_show_≥î_afi_‹f_ˇp
 (
vty
, 
p
, 
afi
, 
ßfi
,

8616 
PEER_CAP_ORF_PREFIX_SM_ADV
,

8617 
PEER_CAP_ORF_PREFIX_RM_ADV
,

8618 
PEER_CAP_ORF_PREFIX_SM_RCV
,

8619 
PEER_CAP_ORF_PREFIX_RM_RCV
);

8621 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_ADV
)

8622 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_OLD_RCV
)

8623 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_ADV
)

8624 || 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_OLD_RCV
))

8626 
	`vty_out
 (
vty
, " Outbound Route Filter (ORF)Åype (%d) Prefix-list:%s",

8627 
ORF_TYPE_PREFIX_OLD
, 
VTY_NEWLINE
);

8628 
	`bgp_show_≥î_afi_‹f_ˇp
 (
vty
, 
p
, 
afi
, 
ßfi
,

8629 
PEER_CAP_ORF_PREFIX_SM_ADV
,

8630 
PEER_CAP_ORF_PREFIX_RM_ADV
,

8631 
PEER_CAP_ORF_PREFIX_SM_OLD_RCV
,

8632 
PEER_CAP_ORF_PREFIX_RM_OLD_RCV
);

8635 
	`•rötf
 (
‹f_pfx_«me
, "%s.%d.%d", 
p
->
ho°
, 
afi
, 
ßfi
);

8636 
‹f_pfx_cou¡
 = 
	`¥efix_bgp_show_¥efix_li°
 (
NULL
, 
afi
, 
‹f_pfx_«me
);

8638 i‡(
	`CHECK_FLAG
 (
p
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_PREFIX_SEND
)

8639 || 
‹f_pfx_cou¡
)

8641 
	`vty_out
 (
vty
, " Outbound Route Filter (ORF):");

8642 i‡(
	`CHECK_FLAG
 (
p
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_PREFIX_SEND
))

8643 
	`vty_out
 (
vty
, " sent;");

8644 i‡(
‹f_pfx_cou¡
)

8645 
	`vty_out
 (
vty
, "Ñe˚ived (%dÉ¡rõs)", 
‹f_pfx_cou¡
);

8646 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8648 i‡(
	`CHECK_FLAG
 (
p
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_WAIT_REFRESH
))

8649 
	`vty_out
 (
vty
, " Fú° upd©êi†de„ºed u¡û ORF o∏ROUTE-REFRESH i†ª˚ived%s", 
VTY_NEWLINE
);

8651 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_REFLECTOR_CLIENT
))

8652 
	`vty_out
 (
vty
, " Rouã-ReÊe˘‹ Clõ¡%s", 
VTY_NEWLINE
);

8653 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

8654 
	`vty_out
 (
vty
, " Rouã-Sîvî Clõ¡%s", 
VTY_NEWLINE
);

8655 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SOFT_RECONFIG
))

8656 
	`vty_out
 (
vty
, " Inbound so·Ñec⁄figuøti⁄áŒowed%s", 
VTY_NEWLINE
);

8657 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_REMOVE_PRIVATE_AS
))

8658 
	`vty_out
 (
vty
, " Priv©êASÇumbîÑemoved from upd©e†tÿthi†√ighb‹%s", 
VTY_NEWLINE
);

8659 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_SELF
))

8660 
	`vty_out
 (
vty
, " NEXT_HOP i†Æway†thi†rouãr%s", 
VTY_NEWLINE
);

8661 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_AS_PATH_UNCHANGED
))

8662 
	`vty_out
 (
vty
, " AS_PATH i†¥›ag©ed unch™gedÅÿthi†√ighb‹%s", 
VTY_NEWLINE
);

8663 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_UNCHANGED
))

8664 
	`vty_out
 (
vty
, " NEXT_HOP i†¥›ag©ed unch™gedÅÿthi†√ighb‹%s", 
VTY_NEWLINE
);

8665 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MED_UNCHANGED
))

8666 
	`vty_out
 (
vty
, " MED i†¥›ag©ed unch™gedÅÿthi†√ighb‹%s", 
VTY_NEWLINE
);

8667 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_COMMUNITY
)

8668 || 
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_EXT_COMMUNITY
))

8670 
	`vty_out
 (
vty
, " Communityáttribute sentÅoÅhisÇeighbor");

8671 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_COMMUNITY
)

8672 && 
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_EXT_COMMUNITY
))

8673 
	`vty_out
 (
vty
, "(bŸh)%s", 
VTY_NEWLINE
);

8674 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_EXT_COMMUNITY
))

8675 
	`vty_out
 (
vty
, "”xãnded)%s", 
VTY_NEWLINE
);

8677 
	`vty_out
 (
vty
, "(°™d¨d)%s", 
VTY_NEWLINE
);

8679 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
))

8681 
	`vty_out
 (
vty
, " Default information originate,");

8683 i‡(
p
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

8684 
	`vty_out
 (
vty
, " defaultÑoute-map %s%s,",

8685 
p
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 ? "*" : "",

8686 
p
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

8687 i‡(
	`CHECK_FLAG
 (
p
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_DEFAULT_ORIGINATE
))

8688 
	`vty_out
 (
vty
, " deÁu… sít%s", 
VTY_NEWLINE
);

8690 
	`vty_out
 (
vty
, " deÁu…ÇŸ sít%s", 
VTY_NEWLINE
);

8693 i‡(
fûãr
->
∂i°
[
FILTER_IN
].
«me


8694 || 
fûãr
->
dli°
[
FILTER_IN
].
«me


8695 || 
fûãr
->
a¶i°
[
FILTER_IN
].
«me


8696 || 
fûãr
->
m≠
[
RMAP_IN
].
«me
)

8697 
	`vty_out
 (
vty
, " InboundÖ©hÖﬁicy c⁄figuªd%s", 
VTY_NEWLINE
);

8698 i‡(
fûãr
->
∂i°
[
FILTER_OUT
].
«me


8699 || 
fûãr
->
dli°
[
FILTER_OUT
].
«me


8700 || 
fûãr
->
a¶i°
[
FILTER_OUT
].
«me


8701 || 
fûãr
->
m≠
[
RMAP_OUT
].
«me


8702 || 
fûãr
->
usm≠
.
«me
)

8703 
	`vty_out
 (
vty
, " OutboundÖ©hÖﬁicy c⁄figuªd%s", 
VTY_NEWLINE
);

8704 i‡(
fûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

8705 
	`vty_out
 (
vty
, " Imp‹àpﬁicy f‹Åhi†RS-˛õ¡ c⁄figuªd%s", 
VTY_NEWLINE
);

8706 i‡(
fûãr
->
m≠
[
RMAP_EXPORT
].
«me
)

8707 
	`vty_out
 (
vty
, " Exp‹àpﬁicy f‹Åhi†RS-˛õ¡ c⁄figuªd%s", 
VTY_NEWLINE
);

8710 i‡(
fûãr
->
∂i°
[
FILTER_IN
].
«me
)

8711 
	`vty_out
 (
vty
, " Incoming updateÖrefix filterÜist is %s%s%s",

8712 
fûãr
->
∂i°
[
FILTER_IN
].plist ? "*" : "",

8713 
fûãr
->
∂i°
[
FILTER_IN
].
«me
,

8714 
VTY_NEWLINE
);

8715 i‡(
fûãr
->
∂i°
[
FILTER_OUT
].
«me
)

8716 
	`vty_out
 (
vty
, " Outgoing updateÖrefix filterÜist is %s%s%s",

8717 
fûãr
->
∂i°
[
FILTER_OUT
].plist ? "*" : "",

8718 
fûãr
->
∂i°
[
FILTER_OUT
].
«me
,

8719 
VTY_NEWLINE
);

8722 i‡(
fûãr
->
dli°
[
FILTER_IN
].
«me
)

8723 
	`vty_out
 (
vty
, " Incoming updateÇetwork filterÜist is %s%s%s",

8724 
fûãr
->
dli°
[
FILTER_IN
].
Æi°
 ? "*" : "",

8725 
fûãr
->
dli°
[
FILTER_IN
].
«me
,

8726 
VTY_NEWLINE
);

8727 i‡(
fûãr
->
dli°
[
FILTER_OUT
].
«me
)

8728 
	`vty_out
 (
vty
, " Outgoing updateÇetwork filterÜist is %s%s%s",

8729 
fûãr
->
dli°
[
FILTER_OUT
].
Æi°
 ? "*" : "",

8730 
fûãr
->
dli°
[
FILTER_OUT
].
«me
,

8731 
VTY_NEWLINE
);

8734 i‡(
fûãr
->
a¶i°
[
FILTER_IN
].
«me
)

8735 
	`vty_out
 (
vty
, " Incoming update ASÖath filterÜist is %s%s%s",

8736 
fûãr
->
a¶i°
[
FILTER_IN
].aslist ? "*" : "",

8737 
fûãr
->
a¶i°
[
FILTER_IN
].
«me
,

8738 
VTY_NEWLINE
);

8739 i‡(
fûãr
->
a¶i°
[
FILTER_OUT
].
«me
)

8740 
	`vty_out
 (
vty
, " Outgoing update ASÖath filterÜist is %s%s%s",

8741 
fûãr
->
a¶i°
[
FILTER_OUT
].aslist ? "*" : "",

8742 
fûãr
->
a¶i°
[
FILTER_OUT
].
«me
,

8743 
VTY_NEWLINE
);

8746 i‡(
fûãr
->
m≠
[
RMAP_IN
].
«me
)

8747 
	`vty_out
 (
vty
, " Route map for incomingádvertisements is %s%s%s",

8748 
fûãr
->
m≠
[
RMAP_IN
].map ? "*" : "",

8749 
fûãr
->
m≠
[
RMAP_IN
].
«me
,

8750 
VTY_NEWLINE
);

8751 i‡(
fûãr
->
m≠
[
RMAP_OUT
].
«me
)

8752 
	`vty_out
 (
vty
, " Route map for outgoingádvertisements is %s%s%s",

8753 
fûãr
->
m≠
[
RMAP_OUT
].map ? "*" : "",

8754 
fûãr
->
m≠
[
RMAP_OUT
].
«me
,

8755 
VTY_NEWLINE
);

8756 i‡(
fûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

8757 
	`vty_out
 (
vty
, " Route map forádvertisements going intoÅhis RS-client'sÅable is %s%s%s",

8758 
fûãr
->
m≠
[
RMAP_IMPORT
].map ? "*" : "",

8759 
fûãr
->
m≠
[
RMAP_IMPORT
].
«me
,

8760 
VTY_NEWLINE
);

8761 i‡(
fûãr
->
m≠
[
RMAP_EXPORT
].
«me
)

8762 
	`vty_out
 (
vty
, " Route map forádvertisements coming fromÅhis RS-client is %s%s%s",

8763 
fûãr
->
m≠
[
RMAP_EXPORT
].map ? "*" : "",

8764 
fûãr
->
m≠
[
RMAP_EXPORT
].
«me
,

8765 
VTY_NEWLINE
);

8768 i‡(
fûãr
->
usm≠
.
«me
)

8769 
	`vty_out
 (
vty
, " Route map for selective unsuppress is %s%s%s",

8770 
fûãr
->
usm≠
.
m≠
 ? "*" : "",

8771 
fûãr
->
usm≠
.
«me
, 
VTY_NEWLINE
);

8774 
	`vty_out
 (
vty
, " %ldác˚±edÖªfixes%s", 
p
->
pcou¡
[
afi
][
ßfi
], 
VTY_NEWLINE
);

8777 i‡(
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
))

8779 
	`vty_out
 (
vty
, " MaximumÖªfixe†Ælowed %ld%s%s", 
p
->
pmax
[
afi
][
ßfi
],

8780 
	`CHECK_FLAG
 (
p
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
)

8781 ? " (w¨nög-⁄ly)" : "", 
VTY_NEWLINE
);

8782 
	`vty_out
 (
vty
, " Threshold for warning message %d%%",

8783 
p
->
pmax_thªshﬁd
[
afi
][
ßfi
]);

8784 i‡(
p
->
pmax_ª°¨t
[
afi
][
ßfi
])

8785 
	`vty_out
 (
vty
, ",Ñe°¨àöãrvÆ %d mö", 
p
->
pmax_ª°¨t
[
afi
][
ßfi
]);

8786 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8789 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8790 
	}
}

8793 
	$bgp_show_≥î
 (
vty
 *vty, 
≥î
 *
p
)

8795 
bgp
 *bgp;

8796 
buf1
[
BUFSIZ
];

8797 
timebuf
[
BGP_UPTIME_LEN
];

8798 
afi_t
 
afi
;

8799 
ßfi_t
 
ßfi
;

8801 
bgp
 = 
p
->bgp;

8804 
	`vty_out
 (
vty
, "BGPÇeighb‹ i†%s, ", 
p
->
ho°
);

8805 
	`vty_out
 (
vty
, "ªmŸêAS %u, ", 
p
->
as
);

8806 
	`vty_out
 (
vty
, "local AS %u%s%s, ",

8807 
p
->
ch™ge_loˇl_as
 ?Ö->ch™ge_loˇl_a†:Ö->
loˇl_as
,

8808 
	`CHECK_FLAG
 (
p
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
) ?

8810 
	`CHECK_FLAG
 (
p
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
) ?

8812 
	`vty_out
 (
vty
, "%sÜink%s",

8813 
p
->
as
 =p->
loˇl_as
 ? "internal" : "external",

8814 
VTY_NEWLINE
);

8817 i‡(
p
->
desc
)

8818 
	`vty_out
 (
vty
, " Des¸ùti⁄: %s%s", 
p
->
desc
, 
VTY_NEWLINE
);

8821 i‡(
p
->
group
)

8822 
	`vty_out
 (
vty
, " Member ofÖeer-group %s for sessionÖarameters%s",

8823 
p
->
group
->
«me
, 
VTY_NEWLINE
);

8826 i‡(
	`CHECK_FLAG
 (
p
->
Êags
, 
PEER_FLAG_SHUTDOWN
))

8827 
	`vty_out
 (
vty
, " Admöi°øtivñy shuàdown%s", 
VTY_NEWLINE
);

8830 
	`vty_out
 (
vty
, " BGP version 4");

8831 
	`vty_out
 (
vty
, ",ÑemoteÑouter ID %s%s",

8832 
	`öë_¡›
 (
AF_INET
, &
p
->
ªmŸe_id
, 
buf1
, 
BUFSIZ
),

8833 
VTY_NEWLINE
);

8836 i‡(
	`CHECK_FLAG
 (
bgp
->
c⁄fig
, 
BGP_CONFIG_CONFEDERATION
)

8837 && 
	`bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
, 
p
->
as
))

8838 
	`vty_out
 (
vty
, " Neighb‹ undî comm⁄ádmöi°øti⁄%s", 
VTY_NEWLINE
);

8841 
	`vty_out
 (
vty
, " BGP state = %s",

8842 
	`LOOKUP
 (
bgp_°©us_msg
, 
p
->
°©us
));

8843 i‡(
p
->
°©us
 =
E°ablished
)

8844 
	`vty_out
 (
vty
, ", up for %8s",

8845 
	`≥î_u±ime
 (
p
->
u±ime
, 
timebuf
, 
BGP_UPTIME_LEN
));

8846 i‡(
p
->
°©us
 =
A˘ive
)

8848 i‡(
	`CHECK_FLAG
 (
p
->
Êags
, 
PEER_FLAG_PASSIVE
))

8849 
	`vty_out
 (
vty
, " (passive)");

8850 i‡(
	`CHECK_FLAG
 (
p
->
sÊags
, 
PEER_STATUS_NSF_WAIT
))

8851 
	`vty_out
 (
vty
, " (NSFÖassive)");

8853 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8856 
	`vty_out
 (
vty
, " La°Ñód %s", 
	`≥î_u±ime
 (
p
->
ªadtime
, 
timebuf
, 
BGP_UPTIME_LEN
));

8859 
	`vty_out
 (
vty
, ", holdÅime is %d, keepalive interval is %d seconds%s",

8860 
p
->
v_hﬁdtime
,Ö->
v_kì∑live
, 
VTY_NEWLINE
);

8861 i‡(
	`CHECK_FLAG
 (
p
->
c⁄fig
, 
PEER_CONFIG_TIMER
))

8863 
	`vty_out
 (
vty
, " C⁄figuªd hﬁdÅimêi†%d", 
p
->
hﬁdtime
);

8864 
	`vty_out
 (
vty
, ", keepalive interval is %d seconds%s",

8865 
p
->
kì∑live
, 
VTY_NEWLINE
);

8869 i‡(
p
->
°©us
 =
E°ablished
)

8871 i‡(
p
->
ˇp


8872 || 
p
->
afc_adv
[
AFI_IP
][
SAFI_UNICAST
]

8873 || 
p
->
afc_ªcv
[
AFI_IP
][
SAFI_UNICAST
]

8874 || 
p
->
afc_adv
[
AFI_IP
][
SAFI_MULTICAST
]

8875 || 
p
->
afc_ªcv
[
AFI_IP
][
SAFI_MULTICAST
]

8876 #ifde‡
HAVE_IPV6


8877 || 
p
->
afc_adv
[
AFI_IP6
][
SAFI_UNICAST
]

8878 || 
p
->
afc_ªcv
[
AFI_IP6
][
SAFI_UNICAST
]

8879 || 
p
->
afc_adv
[
AFI_IP6
][
SAFI_MULTICAST
]

8880 || 
p
->
afc_ªcv
[
AFI_IP6
][
SAFI_MULTICAST
]

8882 || 
p
->
afc_adv
[
AFI_IP
][
SAFI_MPLS_VPN
]

8883 || 
p
->
afc_ªcv
[
AFI_IP
][
SAFI_MPLS_VPN
])

8885 
	`vty_out
 (
vty
, " Neighb‹ c≠abûôõs:%s", 
VTY_NEWLINE
);

8888 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_AS4_RCV
)

8889 || 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_AS4_ADV
))

8891 
	`vty_out
 (
vty
, " 4 Byte AS:");

8892 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_AS4_ADV
))

8893 
	`vty_out
 (
vty
, "ádvertised");

8894 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_AS4_RCV
))

8895 
	`vty_out
 (
vty
, " %sreceived",

8896 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_AS4_ADV
) ? "and " : "");

8897 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8900 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_DYNAMIC_RCV
)

8901 || 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_DYNAMIC_ADV
))

8903 
	`vty_out
 (
vty
, " Dynamic:");

8904 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_DYNAMIC_ADV
))

8905 
	`vty_out
 (
vty
, "ádvertised");

8906 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_DYNAMIC_RCV
))

8907 
	`vty_out
 (
vty
, " %sreceived",

8908 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_DYNAMIC_ADV
) ? "and " : "");

8909 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8913 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_ADV
)

8914 || 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
)

8915 || 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_OLD_RCV
))

8917 
	`vty_out
 (
vty
, " RouteÑefresh:");

8918 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_ADV
))

8919 
	`vty_out
 (
vty
, "ádvertised");

8920 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
)

8921 || 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_OLD_RCV
))

8922 
	`vty_out
 (
vty
, " %sreceived(%s)",

8923 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_ADV
) ? "and " : "",

8924 (
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_OLD_RCV
)

8925 && 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
)) ?

8926 "ﬁd &Çew" : 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_REFRESH_OLD_RCV
) ? "old" : "new");

8928 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8932 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

8933 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

8934 i‡(
p
->
afc_adv
[
afi
][
ßfi
] ||Ö->
afc_ªcv
[afi][safi])

8936 
	`vty_out
 (
vty
, " Addªs†Ámûy %s:", 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
));

8937 i‡(
p
->
afc_adv
[
afi
][
ßfi
])

8938 
	`vty_out
 (
vty
, "ádvertised");

8939 i‡(
p
->
afc_ªcv
[
afi
][
ßfi
])

8940 
	`vty_out
 (
vty
, " %§e˚ived", 
p
->
afc_adv
[
afi
][
ßfi
] ? "and " : "");

8941 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8945 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_RESTART_RCV
)

8946 || 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_RESTART_ADV
))

8948 
	`vty_out
 (
vty
, " Graceful Restart Capabilty:");

8949 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_RESTART_ADV
))

8950 
	`vty_out
 (
vty
, "ádvertised");

8951 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_RESTART_RCV
))

8952 
	`vty_out
 (
vty
, " %sreceived",

8953 
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_RESTART_ADV
) ? "and " : "");

8954 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8956 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_RESTART_RCV
))

8958 
ª°¨t_af_cou¡
 = 0;

8960 
	`vty_out
 (
vty
, " Remote RestartÅimer is %d seconds%s",

8961 
p
->
v_gr_ª°¨t
, 
VTY_NEWLINE
);

8962 
	`vty_out
 (
vty
, " Addªs†Ámûõ†byÖìr:%† ", 
VTY_NEWLINE
);

8964 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

8965 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

8966 i‡(
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_RESTART_AF_RCV
))

8968 
	`vty_out
 (
vty
, "%s%s(%s)", 
ª°¨t_af_cou¡
 ? ", " : "",

8969 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
),

8970 
	`CHECK_FLAG
 (
p
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_RESTART_AF_PRESERVE_RCV
) ?

8972 
ª°¨t_af_cou¡
++;

8974 i‡(! 
ª°¨t_af_cou¡
)

8975 
	`vty_out
 (
vty
, "none");

8976 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

8983 i‡(
	`CHECK_FLAG
 (
p
->
ˇp
, 
PEER_CAP_RESTART_RCV
)

8984 || 
p
->
t_gr_ª°¨t


8985 || 
p
->
t_gr_°Æe
)

8987 
e‹_£nd_af_cou¡
 = 0;

8988 
e‹_ª˚ive_af_cou¡
 = 0;

8990 
	`vty_out
 (
vty
, " Gø˚fu»ª°¨àöf‹m©i⁄s:%s", 
VTY_NEWLINE
);

8991 i‡(
p
->
°©us
 =
E°ablished
)

8993 
	`vty_out
 (
vty
, " End-of-RIB send: ");

8994 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

8995 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

8996 i‡(
	`CHECK_FLAG
 (
p
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_EOR_SEND
))

8998 
	`vty_out
 (
vty
, "%s%s", 
e‹_£nd_af_cou¡
 ? ", " : "",

8999 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
));

9000 
e‹_£nd_af_cou¡
++;

9002 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

9004 
	`vty_out
 (
vty
, " End-of-RIBÑeceived: ");

9005 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

9006 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

9007 i‡(
	`CHECK_FLAG
 (
p
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_EOR_RECEIVED
))

9009 
	`vty_out
 (
vty
, "%s%s", 
e‹_ª˚ive_af_cou¡
 ? ", " : "",

9010 
	`afi_ßfi_¥öt
 (
afi
, 
ßfi
));

9011 
e‹_ª˚ive_af_cou¡
++;

9013 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

9016 i‡(
p
->
t_gr_ª°¨t
)

9017 
	`vty_out
 (
vty
, " TheÑemainingÅime ofÑestartÅimer is %ld%s",

9018 
	`thªad_timî_ªmaö_£c⁄d
 (
p
->
t_gr_ª°¨t
), 
VTY_NEWLINE
);

9020 i‡(
p
->
t_gr_°Æe
)

9021 
	`vty_out
 (
vty
, " TheÑemainingÅime of stalepathÅimer is %ld%s",

9022 
	`thªad_timî_ªmaö_£c⁄d
 (
p
->
t_gr_°Æe
), 
VTY_NEWLINE
);

9026 
	`vty_out
 (
vty
, " Mesßgê°©i°ics:%s", 
VTY_NEWLINE
);

9027 
	`vty_out
 (
vty
, " Inq dïth i†0%s", 
VTY_NEWLINE
);

9028 
	`vty_out
 (
vty
, " Outq dïth i†%lu%s", (Ë
p
->
obuf
->
cou¡
, 
VTY_NEWLINE
);

9029 
	`vty_out
 (
vty
, " Síà Rcvd%s", 
VTY_NEWLINE
);

9030 
	`vty_out
 (
vty
, " O≥ns: %10d %10d%s", 
p
->
›í_out
,Ö->
›í_ö
, 
VTY_NEWLINE
);

9031 
	`vty_out
 (
vty
, " NŸifiˇti⁄s: %10d %10d%s", 
p
->
nŸify_out
,Ö->
nŸify_ö
, 
VTY_NEWLINE
);

9032 
	`vty_out
 (
vty
, " Upd©es: %10d %10d%s", 
p
->
upd©e_out
,Ö->
upd©e_ö
, 
VTY_NEWLINE
);

9033 
	`vty_out
 (
vty
, " Kì∑lives: %10d %10d%s", 
p
->
kì∑live_out
,Ö->
kì∑live_ö
, 
VTY_NEWLINE
);

9034 
	`vty_out
 (
vty
, " Rouã Re‰esh: %10d %10d%s", 
p
->
ª‰esh_out
,Ö->
ª‰esh_ö
, 
VTY_NEWLINE
);

9035 
	`vty_out
 (
vty
, " C≠abûôy: %10d %10d%s", 
p
->
dy«mic_ˇp_out
,Ö->
dy«mic_ˇp_ö
, 
VTY_NEWLINE
);

9036 
	`vty_out
 (
vty
, " TŸÆ: %10d %10d%s", 
p
->
›í_out
 +Ö->
nŸify_out
 +

9037 
p
->
upd©e_out
 +Ö->
kì∑live_out
 +Ö->
ª‰esh_out
 +Ö->
dy«mic_ˇp_out
,

9038 
p
->
›í_ö
 +Ö->
nŸify_ö
 +Ö->
upd©e_ö
 +Ö->
kì∑live_ö
 +Ö->
ª‰esh_ö
 +

9039 
p
->
dy«mic_ˇp_ö
, 
VTY_NEWLINE
);

9042 
	`vty_out
 (
vty
, " MinimumÅime betweenádvertisementÑuns is %d seconds%s",

9043 
p
->
v_rouãadv
, 
VTY_NEWLINE
);

9046 i‡(
p
->
upd©e_if
 ||Ö->
upd©e_sour˚
)

9048 
	`vty_out
 (
vty
, " Update source is ");

9049 i‡(
p
->
upd©e_if
)

9050 
	`vty_out
 (
vty
, "%s", 
p
->
upd©e_if
);

9051 i‡(
p
->
upd©e_sour˚
)

9052 
	`vty_out
 (
vty
, "%s",

9053 
	`sockuni⁄2°r
 (
p
->
upd©e_sour˚
, 
buf1
, 
SU_ADDRSTRLEN
));

9054 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

9058 i‡(
	`CHECK_FLAG
 (
p
->
c⁄fig
, 
PEER_CONFIG_WEIGHT
))

9059 
	`vty_out
 (
vty
, " DeÁu… weighà%d%s", 
p
->
weight
,

9060 
VTY_NEWLINE
);

9062 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

9065 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

9066 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_MAX
 ; safi++)

9067 i‡(
p
->
afc
[
afi
][
ßfi
])

9068 
	`bgp_show_≥î_afi
 (
vty
, 
p
, 
afi
, 
ßfi
);

9070 
	`vty_out
 (
vty
, " ConnectionsÉstablished %d; dropped %d%s",

9071 
p
->
e°ablished
,Ö->
dr›≥d
,

9072 
VTY_NEWLINE
);

9074 i‡(! 
p
->
dr›≥d
)

9075 
	`vty_out
 (
vty
, " La°Ñe£à√vî%s", 
VTY_NEWLINE
);

9077 
	`vty_out
 (
vty
, " LastÑeset %s, dueÅo %s%s",

9078 
	`≥î_u±ime
 (
p
->
ª£âime
, 
timebuf
, 
BGP_UPTIME_LEN
),

9079 
≥î_down_°r
[(Ë
p
->
œ°_ª£t
], 
VTY_NEWLINE
);

9081 i‡(
	`CHECK_FLAG
 (
p
->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
))

9083 
	`vty_out
 (
vty
, " Pì∏hadÉx˚ededÅhêmax.Ço. o‡¥efixe†c⁄figuªd.%s", 
VTY_NEWLINE
);

9085 i‡(
p
->
t_pmax_ª°¨t
)

9086 
	`vty_out
 (
vty
, " ReduceÅheÇo. ofÖrefix from %s, willÑestart in %ld seconds%s",

9087 
p
->
ho°
, 
	`thªad_timî_ªmaö_£c⁄d
 (p->
t_pmax_ª°¨t
),

9088 
VTY_NEWLINE
);

9090 
	`vty_out
 (
vty
, " ReduceÅheÇo. ofÖrefixánd clear ip bgp %sÅoÑestoreÖeering%s",

9091 
p
->
ho°
, 
VTY_NEWLINE
);

9095 i‡(
p
->
s‹t
 !
BGP_PEER_IBGP
)

9097 i‡(
p
->
gtsm_h›s
 > 0)

9098 
	`vty_out
 (
vty
, " External BGPÇeighbor may be upÅo %d hopsáway.%s",

9099 
p
->
gtsm_h›s
, 
VTY_NEWLINE
);

9100 i‡(
p
->
âl
 > 1)

9101 
	`vty_out
 (
vty
, " External BGPÇeighbor may be upÅo %d hopsáway.%s",

9102 
p
->
âl
, 
VTY_NEWLINE
);

9106 i‡(
p
->
su_loˇl
)

9108 
	`vty_out
 (
vty
, "Local host: %s, LocalÖort: %d%s",

9109 
	`sockuni⁄2°r
 (
p
->
su_loˇl
, 
buf1
, 
SU_ADDRSTRLEN
),

9110 
	`¡ohs
 (
p
->
su_loˇl
->
sö
.
sö_p‹t
),

9111 
VTY_NEWLINE
);

9115 i‡(
p
->
su_ªmŸe
)

9117 
	`vty_out
 (
vty
, "Foreign host: %s, ForeignÖort: %d%s",

9118 
	`sockuni⁄2°r
 (
p
->
su_ªmŸe
, 
buf1
, 
SU_ADDRSTRLEN
),

9119 
	`¡ohs
 (
p
->
su_ªmŸe
->
sö
.
sö_p‹t
),

9120 
VTY_NEWLINE
);

9124 i‡(
p
->
su_loˇl
)

9126 
	`vty_out
 (
vty
, "Nexthop: %s%s",

9127 
	`öë_¡›
 (
AF_INET
, &
p
->
√xth›
.
v4
, 
buf1
, 
BUFSIZ
),

9128 
VTY_NEWLINE
);

9129 #ifde‡
HAVE_IPV6


9130 
	`vty_out
 (
vty
, "Nexthop global: %s%s",

9131 
	`öë_¡›
 (
AF_INET6
, &
p
->
√xth›
.
v6_globÆ
, 
buf1
, 
BUFSIZ
),

9132 
VTY_NEWLINE
);

9133 
	`vty_out
 (
vty
, "NexthopÜocal: %s%s",

9134 
	`öë_¡›
 (
AF_INET6
, &
p
->
√xth›
.
v6_loˇl
, 
buf1
, 
BUFSIZ
),

9135 
VTY_NEWLINE
);

9136 
	`vty_out
 (
vty
, "BGP connection: %s%s",

9137 
p
->
sh¨ed_√tw‹k
 ? "sharedÇetwork" : "non sharedÇetwork",

9138 
VTY_NEWLINE
);

9143 i‡(
p
->
t_°¨t
)

9144 
	`vty_out
 (
vty
, "Next startÅimer due in %ld seconds%s",

9145 
	`thªad_timî_ªmaö_£c⁄d
 (
p
->
t_°¨t
), 
VTY_NEWLINE
);

9146 i‡(
p
->
t_c⁄√˘
)

9147 
	`vty_out
 (
vty
, "Next connectÅimer due in %ld seconds%s",

9148 
	`thªad_timî_ªmaö_£c⁄d
 (
p
->
t_c⁄√˘
), 
VTY_NEWLINE
);

9150 
	`vty_out
 (
vty
, "ReadÅhread: %s WriteÅhread: %s%s",

9151 
p
->
t_ªad
 ? "on" : "off",

9152 
p
->
t_wrôe
 ? "on" : "off",

9153 
VTY_NEWLINE
);

9155 i‡(
p
->
nŸify
.
code
 =
BGP_NOTIFY_OPEN_ERR


9156 && 
p
->
nŸify
.
subcode
 =
BGP_NOTIFY_OPEN_UNSUP_CAPBL
)

9157 
	`bgp_ˇ∑bûôy_vty_out
 (
vty
, 
p
);

9159 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

9160 
	}
}

9163 
	$bgp_show_√ighb‹
 (
vty
 *vty, 
bgp
 *bgp,

9164 
show_ty≥
 
ty≥
, 
sockuni⁄
 *
su
)

9166 
li°node
 *
node
, *
¬ode
;

9167 
≥î
 *peer;

9168 
föd
 = 0;

9170 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

9172 
ty≥
)

9174 
show_Æl
:

9175 
	`bgp_show_≥î
 (
vty
, 
≥î
);

9177 
show_≥î
:

9178 i‡(
	`sockuni⁄_ßme
 (&
≥î
->
su
, su))

9180 
föd
 = 1;

9181 
	`bgp_show_≥î
 (
vty
, 
≥î
);

9187 i‡(
ty≥
 =
show_≥î
 && ! 
föd
)

9188 
	`vty_out
 (
vty
, "%% NÿsuchÇeighb‹%s", 
VTY_NEWLINE
);

9190  
CMD_SUCCESS
;

9191 
	}
}

9194 
	$bgp_show_√ighb‹_vty
 (
vty
 *vty, c⁄° *
«me
,

9195 
show_ty≥
 
ty≥
, c⁄° *
ù_°r
)

9197 
ªt
;

9198 
bgp
 *bgp;

9199 
sockuni⁄
 
su
;

9201 i‡(
ù_°r
)

9203 
ªt
 = 
	`°r2sockuni⁄
 (
ù_°r
, &
su
);

9204 i‡(
ªt
 < 0)

9206 
	`vty_out
 (
vty
, "%% MÆf‹medáddªss: %s%s", 
ù_°r
, 
VTY_NEWLINE
);

9207  
CMD_WARNING
;

9211 i‡(
«me
)

9213 
bgp
 = 
	`bgp_lookup_by_«me
 (
«me
);

9215 i‡(! 
bgp
)

9217 
	`vty_out
 (
vty
, "%% Nÿsuch BGP in°™˚Éxi°%s", 
VTY_NEWLINE
);

9218  
CMD_WARNING
;

9221 
	`bgp_show_√ighb‹
 (
vty
, 
bgp
, 
ty≥
, &
su
);

9223  
CMD_SUCCESS
;

9226 
bgp
 = 
	`bgp_gë_deÁu…
 ();

9228 i‡(
bgp
)

9229 
	`bgp_show_√ighb‹
 (
vty
, 
bgp
, 
ty≥
, &
su
);

9231  
CMD_SUCCESS
;

9232 
	}
}

9235 
DEFUN
 (
show_ù_bgp_√ighb‹s
,

9236 
show_ù_bgp_√ighb‹s_cmd
,

9238 
SHOW_STR


9239 
IP_STR


9240 
BGP_STR


9243  
bgp_show_√ighb‹_vty
 (
vty
, 
NULL
, 
show_Æl
, NULL);

9246 
ALIAS
 (
show_ù_bgp_√ighb‹s
,

9247 
show_ù_bgp_ùv4_√ighb‹s_cmd
,

9249 
SHOW_STR


9250 
IP_STR


9251 
BGP_STR


9257 
ALIAS
 (
show_ù_bgp_√ighb‹s
,

9258 
show_ù_bgp_v≤v4_Æl_√ighb‹s_cmd
,

9260 
SHOW_STR


9261 
IP_STR


9262 
BGP_STR


9267 
ALIAS
 (
show_ù_bgp_√ighb‹s
,

9268 
show_ù_bgp_v≤v4_rd_√ighb‹s_cmd
,

9270 
SHOW_STR


9271 
IP_STR


9272 
BGP_STR


9278 
ALIAS
 (
show_ù_bgp_√ighb‹s
,

9279 
show_bgp_√ighb‹s_cmd
,

9281 
SHOW_STR


9282 
BGP_STR


9285 
ALIAS
 (
show_ù_bgp_√ighb‹s
,

9286 
show_bgp_ùv6_√ighb‹s_cmd
,

9288 
SHOW_STR


9289 
BGP_STR


9293 
DEFUN
 (
show_ù_bgp_√ighb‹s_≥î
,

9294 
show_ù_bgp_√ighb‹s_≥î_cmd
,

9296 
SHOW_STR


9297 
IP_STR


9298 
BGP_STR


9303  
bgp_show_√ighb‹_vty
 (
vty
, 
NULL
, 
show_≥î
, 
¨gv
[
¨gc
 - 1]);

9306 
ALIAS
 (
show_ù_bgp_√ighb‹s_≥î
,

9307 
show_ù_bgp_ùv4_√ighb‹s_≥î_cmd
,

9309 
SHOW_STR


9310 
IP_STR


9311 
BGP_STR


9319 
ALIAS
 (
show_ù_bgp_√ighb‹s_≥î
,

9320 
show_ù_bgp_v≤v4_Æl_√ighb‹s_≥î_cmd
,

9322 
SHOW_STR


9323 
IP_STR


9324 
BGP_STR


9330 
ALIAS
 (
show_ù_bgp_√ighb‹s_≥î
,

9331 
show_ù_bgp_v≤v4_rd_√ighb‹s_≥î_cmd
,

9333 
SHOW_STR


9334 
IP_STR


9335 
BGP_STR


9341 
ALIAS
 (
show_ù_bgp_√ighb‹s_≥î
,

9342 
show_bgp_√ighb‹s_≥î_cmd
,

9344 
SHOW_STR


9345 
BGP_STR


9350 
ALIAS
 (
show_ù_bgp_√ighb‹s_≥î
,

9351 
show_bgp_ùv6_√ighb‹s_≥î_cmd
,

9353 
SHOW_STR


9354 
BGP_STR


9360 
DEFUN
 (
show_ù_bgp_ö°™˚_√ighb‹s
,

9361 
show_ù_bgp_ö°™˚_√ighb‹s_cmd
,

9363 
SHOW_STR


9364 
IP_STR


9365 
BGP_STR


9370  
bgp_show_√ighb‹_vty
 (
vty
, 
¨gv
[0], 
show_Æl
, 
NULL
);

9373 
ALIAS
 (
show_ù_bgp_ö°™˚_√ighb‹s
,

9374 
show_bgp_ö°™˚_√ighb‹s_cmd
,

9376 
SHOW_STR


9377 
BGP_STR


9382 
ALIAS
 (
show_ù_bgp_ö°™˚_√ighb‹s
,

9383 
show_bgp_ö°™˚_ùv6_√ighb‹s_cmd
,

9385 
SHOW_STR


9386 
BGP_STR


9392 
DEFUN
 (
show_ù_bgp_ö°™˚_√ighb‹s_≥î
,

9393 
show_ù_bgp_ö°™˚_√ighb‹s_≥î_cmd
,

9395 
SHOW_STR


9396 
IP_STR


9397 
BGP_STR


9404  
bgp_show_√ighb‹_vty
 (
vty
, 
¨gv
[0], 
show_≥î
,árgv[1]);

9407 
ALIAS
 (
show_ù_bgp_ö°™˚_√ighb‹s_≥î
,

9408 
show_bgp_ö°™˚_√ighb‹s_≥î_cmd
,

9410 
SHOW_STR


9411 
BGP_STR


9418 
ALIAS
 (
show_ù_bgp_ö°™˚_√ighb‹s_≥î
,

9419 
show_bgp_ö°™˚_ùv6_√ighb‹s_≥î_cmd
,

9421 
SHOW_STR


9422 
BGP_STR


9433 
DEFUN
 (
show_ù_bgp_∑ths
,

9434 
show_ù_bgp_∑ths_cmd
,

9436 
SHOW_STR


9437 
IP_STR


9438 
BGP_STR


9441 
vty_out
 (
vty
, "Addªs†Ref˙àP©h%s", 
VTY_NEWLINE
);

9442 
a•©h_¥öt_Æl_vty
 (
vty
);

9443  
	gCMD_SUCCESS
;

9446 
DEFUN
 (
show_ù_bgp_ùv4_∑ths
,

9447 
show_ù_bgp_ùv4_∑ths_cmd
,

9449 
SHOW_STR


9450 
IP_STR


9451 
BGP_STR


9457 
vty_out
 (
vty
, "Address Refcnt Path\r\n");

9458 
a•©h_¥öt_Æl_vty
 (
vty
);

9460  
	gCMD_SUCCESS
;

9463 
	~"hash.h
"

9466 
	$communôy_show_Æl_ôî©‹
 (
hash_backë
 *
backë
, 
vty
 *vty)

9468 
communôy
 *
com
;

9470 
com
 = (
communôy
 *Ë
backë
->
d©a
;

9471 
	`vty_out
 (
vty
, "[%p] (%ldË%s%s", 
backë
, 
com
->
ªf˙t
,

9472 
	`communôy_°r
 (
com
), 
VTY_NEWLINE
);

9473 
	}
}

9476 
DEFUN
 (
show_ù_bgp_communôy_öfo
,

9477 
show_ù_bgp_communôy_öfo_cmd
,

9479 
SHOW_STR


9480 
IP_STR


9481 
BGP_STR


9484 
vty_out
 (
vty
, "Addªs†Ref˙àCommunôy%s", 
VTY_NEWLINE
);

9486 
hash_ôî©e
 (
communôy_hash
 (),

9487 ((*Ë(
hash_backë
 *, *))

9488 
communôy_show_Æl_ôî©‹
,

9489 
vty
);

9491  
	gCMD_SUCCESS
;

9494 
DEFUN
 (
show_ù_bgp_©å_öfo
,

9495 
show_ù_bgp_©å_öfo_cmd
,

9497 
SHOW_STR


9498 
IP_STR


9499 
BGP_STR


9502 
©å_show_Æl
 (
vty
);

9503  
	gCMD_SUCCESS
;

9507 
	$bgp_wrôe_rs˛õ¡_summ¨y
 (
vty
 *vty, 
≥î
 *
rs˛õ¡
,

9508 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

9510 
timebuf
[
BGP_UPTIME_LEN
];

9511 
rmbuf
[14];

9512 c⁄° *
rm«me
;

9513 
≥î
 *peer;

9514 
li°node
 *
node
, *
¬ode
;

9515 
Àn
;

9516 
cou¡
 = 0;

9518 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
sÊags
, 
PEER_STATUS_GROUP
))

9520 
	`ALL_LIST_ELEMENTS
 (
rs˛õ¡
->
group
->
≥î
, 
node
, 
¬ode
,Öeer))

9522 
cou¡
++;

9523 
	`bgp_wrôe_rs˛õ¡_summ¨y
 (
vty
, 
≥î
, 
afi
, 
ßfi
);

9525  
cou¡
;

9528 
Àn
 = 
	`vty_out
 (
vty
, "%s", 
rs˛õ¡
->
ho°
);

9529 
Àn
 = 16 -Üen;

9531 i‡(
Àn
 < 1)

9532 
	`vty_out
 (
vty
, "%s%*s", 
VTY_NEWLINE
, 16, " ");

9534 
	`vty_out
 (
vty
, "%*s", 
Àn
, " ");

9536 
	`vty_out
 (
vty
, "4 ");

9538 
	`vty_out
 (
vty
, "%11d ", 
rs˛õ¡
->
as
);

9540 
rm«me
 = 
	`ROUTE_MAP_EXPORT_NAME
(&
rs˛õ¡
->
fûãr
[
afi
][
ßfi
]);

9541 i‡–
rm«me
 && 
	`°æí
 (rmname) > 13 )

9543 
	`•rötf
 (
rmbuf
, "%13s", "...");

9544 
rm«me
 = 
	`°∫˝y
 (
rmbuf
,Ñmname, 10);

9546 i‡(! 
rm«me
)

9547 
rm«me
 = "<none>";

9548 
	`vty_out
 (
vty
, " %13†", 
rm«me
);

9550 
rm«me
 = 
	`ROUTE_MAP_IMPORT_NAME
(&
rs˛õ¡
->
fûãr
[
afi
][
ßfi
]);

9551 i‡–
rm«me
 && 
	`°æí
 (rmname) > 13 )

9553 
	`•rötf
 (
rmbuf
, "%13s", "...");

9554 
rm«me
 = 
	`°∫˝y
 (
rmbuf
,Ñmname, 10);

9556 i‡(! 
rm«me
)

9557 
rm«me
 = "<none>";

9558 
	`vty_out
 (
vty
, " %13†", 
rm«me
);

9560 
	`vty_out
 (
vty
, "%8s", 
	`≥î_u±ime
 (
rs˛õ¡
->
u±ime
, 
timebuf
, 
BGP_UPTIME_LEN
));

9562 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
Êags
, 
PEER_FLAG_SHUTDOWN
))

9563 
	`vty_out
 (
vty
, " Idle (Admin)");

9564 i‡(
	`CHECK_FLAG
 (
rs˛õ¡
->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
))

9565 
	`vty_out
 (
vty
, " Idle (PfxCt)");

9567 
	`vty_out
 (
vty
, " %-11s", 
	`LOOKUP
(
bgp_°©us_msg
, 
rs˛õ¡
->
°©us
));

9569 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

9572 
	}
}

9575 
	$bgp_show_rs˛õ¡_summ¨y
 (
vty
 *vty, 
bgp
 *bgp,

9576 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

9578 
≥î
 *peer;

9579 
li°node
 *
node
, *
¬ode
;

9580 
cou¡
 = 0;

9583 
hódî
[] = "Neighbor V AS Export-Policy Import-Policy Up/Down State";

9585 
	`ALL_LIST_ELEMENTS
 (
bgp
->
rs˛õ¡
, 
node
, 
¬ode
, 
≥î
))

9587 i‡(
≥î
->
afc
[
afi
][
ßfi
] &&

9588 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

9590 i‡(! 
cou¡
)

9592 
	`vty_out
 (
vty
,

9594 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
), 
VTY_NEWLINE
);

9595 
	`vty_out
 (
vty
,

9596 "Rouã Sîvî'†loˇ»ASÇumbî %u%s", 
bgp
->
as
,

9597 
VTY_NEWLINE
);

9599 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

9600 
	`vty_out
 (
vty
, "%s%s", 
hódî
, 
VTY_NEWLINE
);

9603 
cou¡
 +
	`bgp_wrôe_rs˛õ¡_summ¨y
 (
vty
, 
≥î
, 
afi
, 
ßfi
);

9607 i‡(
cou¡
)

9608 
	`vty_out
 (
vty
, "%sTŸÆÇumbî o‡Rouã Sîvî Clõ¡†%d%s", 
VTY_NEWLINE
,

9609 
cou¡
, 
VTY_NEWLINE
);

9611 
	`vty_out
 (
vty
, "No %s Route Server Client is configured%s",

9612 
afi
 =
AFI_IP
 ? "IPv4" : "IPv6", 
VTY_NEWLINE
);

9614  
CMD_SUCCESS
;

9615 
	}
}

9618 
	$bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
 *vty, c⁄° *
«me
,

9619 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

9621 
bgp
 *bgp;

9623 i‡(
«me
)

9625 
bgp
 = 
	`bgp_lookup_by_«me
 (
«me
);

9627 i‡(! 
bgp
)

9629 
	`vty_out
 (
vty
, "%% Nÿsuch BGP in°™˚Éxi°%s", 
VTY_NEWLINE
);

9630  
CMD_WARNING
;

9633 
	`bgp_show_rs˛õ¡_summ¨y
 (
vty
, 
bgp
, 
afi
, 
ßfi
);

9634  
CMD_SUCCESS
;

9637 
bgp
 = 
	`bgp_gë_deÁu…
 ();

9639 i‡(
bgp
)

9640 
	`bgp_show_rs˛õ¡_summ¨y
 (
vty
, 
bgp
, 
afi
, 
ßfi
);

9642  
CMD_SUCCESS
;

9643 
	}
}

9646 
DEFUN
 (
show_ù_bgp_rs˛õ¡_summ¨y
,

9647 
show_ù_bgp_rs˛õ¡_summ¨y_cmd
,

9649 
SHOW_STR


9650 
IP_STR


9651 
BGP_STR


9655  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
);

9658 
DEFUN
 (
show_ù_bgp_ö°™˚_rs˛õ¡_summ¨y
,

9659 
show_ù_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
,

9661 
SHOW_STR


9662 
IP_STR


9663 
BGP_STR


9669  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
);

9672 
DEFUN
 (
show_ù_bgp_ùv4_rs˛õ¡_summ¨y
,

9673 
show_ù_bgp_ùv4_rs˛õ¡_summ¨y_cmd
,

9675 
SHOW_STR


9676 
IP_STR


9677 
BGP_STR


9684 i‡(
°∫cmp
 (
¨gv
[0], "m", 1) == 0)

9685  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_MULTICAST
);

9687  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
SAFI_UNICAST
);

9690 
DEFUN
 (
show_ù_bgp_ö°™˚_ùv4_rs˛õ¡_summ¨y
,

9691 
show_ù_bgp_ö°™˚_ùv4_rs˛õ¡_summ¨y_cmd
,

9693 
SHOW_STR


9694 
IP_STR


9695 
BGP_STR


9704 i‡(
°∫cmp
 (
¨gv
[1], "m", 1) == 0)

9705  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_MULTICAST
);

9707  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
SAFI_UNICAST
);

9710 
DEFUN
 (
show_bgp_ö°™˚_ùv4_ßfi_rs˛õ¡_summ¨y
,

9711 
show_bgp_ö°™˚_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
,

9713 
SHOW_STR


9714 
BGP_STR


9723 
ßfi_t
 
	gßfi
;

9725 i‡(
	g¨gc
 == 2) {

9726 
ßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9727  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP
, 
ßfi
);

9729 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9730  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP
, 
ßfi
);

9734 
ALIAS
 (
show_bgp_ö°™˚_ùv4_ßfi_rs˛õ¡_summ¨y
,

9735 
show_bgp_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
,

9737 
SHOW_STR


9738 
BGP_STR


9745 #ifde‡
HAVE_IPV6


9746 
DEFUN
 (
show_bgp_rs˛õ¡_summ¨y
,

9747 
show_bgp_rs˛õ¡_summ¨y_cmd
,

9749 
SHOW_STR


9750 
BGP_STR


9754  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
SAFI_UNICAST
);

9757 
DEFUN
 (
show_bgp_ö°™˚_rs˛õ¡_summ¨y
,

9758 
show_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
,

9760 
SHOW_STR


9761 
BGP_STR


9767  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
SAFI_UNICAST
);

9770 
ALIAS
 (
show_bgp_rs˛õ¡_summ¨y
,

9771 
show_bgp_ùv6_rs˛õ¡_summ¨y_cmd
,

9773 
SHOW_STR


9774 
BGP_STR


9779 
ALIAS
 (
show_bgp_ö°™˚_rs˛õ¡_summ¨y
,

9780 
show_bgp_ö°™˚_ùv6_rs˛õ¡_summ¨y_cmd
,

9782 
SHOW_STR


9783 
BGP_STR


9790 
DEFUN
 (
show_bgp_ö°™˚_ùv6_ßfi_rs˛õ¡_summ¨y
,

9791 
show_bgp_ö°™˚_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
,

9793 
SHOW_STR


9794 
BGP_STR


9803 
ßfi_t
 
	gßfi
;

9805 i‡(
	g¨gc
 == 2) {

9806 
ßfi
 = (
°∫cmp
 (
¨gv
[1], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9807  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
¨gv
[0], 
AFI_IP6
, 
ßfi
);

9809 
	gßfi
 = (
°∫cmp
 (
¨gv
[0], "m", 1Ë=0Ë? 
SAFI_MULTICAST
 : 
SAFI_UNICAST
;

9810  
bgp_show_rs˛õ¡_summ¨y_vty
 (
vty
, 
NULL
, 
AFI_IP6
, 
ßfi
);

9814 
ALIAS
 (
show_bgp_ö°™˚_ùv6_ßfi_rs˛õ¡_summ¨y
,

9815 
show_bgp_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
,

9817 
SHOW_STR


9818 
BGP_STR


9829 
DEFUN
 (
bgp_ªdi°ribuã_ùv4
,

9830 
bgp_ªdi°ribuã_ùv4_cmd
,

9831 "ªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
,

9833 
QUAGGA_IP_REDIST_HELP_STR_BGPD
)

9835 
	gty≥
;

9837 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9838 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9840 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9841  
	gCMD_WARNING
;

9843  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

9846 
DEFUN
 (
bgp_ªdi°ribuã_ùv4_rm≠
,

9847 
bgp_ªdi°ribuã_ùv4_rm≠_cmd
,

9848 "ªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 "Ñoute-map WORD",

9850 
QUAGGA_IP_REDIST_HELP_STR_BGPD


9854 
	gty≥
;

9856 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9857 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9859 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9860  
	gCMD_WARNING
;

9863 
bgp_ªdi°ribuã_rm≠_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
, 
¨gv
[1]);

9864  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

9867 
DEFUN
 (
bgp_ªdi°ribuã_ùv4_mëric
,

9868 
bgp_ªdi°ribuã_ùv4_mëric_cmd
,

9869 "ªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 " metric <0-4294967295>",

9871 
QUAGGA_IP_REDIST_HELP_STR_BGPD


9875 
	gty≥
;

9876 
u_öt32_t
 
	gmëric
;

9878 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9879 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9881 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9882  
	gCMD_WARNING
;

9884 
VTY_GET_INTEGER
 ("mëric", 
mëric
, 
¨gv
[1]);

9886 
bgp_ªdi°ribuã_mëric_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
, 
mëric
);

9887  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

9890 
DEFUN
 (
bgp_ªdi°ribuã_ùv4_rm≠_mëric
,

9891 
bgp_ªdi°ribuã_ùv4_rm≠_mëric_cmd
,

9892 "ªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 "Ñoute-map WORD metric <0-4294967295>",

9894 
QUAGGA_IP_REDIST_HELP_STR_BGPD


9900 
	gty≥
;

9901 
u_öt32_t
 
	gmëric
;

9903 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9904 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9906 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9907  
	gCMD_WARNING
;

9909 
VTY_GET_INTEGER
 ("mëric", 
mëric
, 
¨gv
[2]);

9911 
bgp_ªdi°ribuã_rm≠_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
, 
¨gv
[1]);

9912 
bgp_ªdi°ribuã_mëric_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
, 
mëric
);

9913  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

9916 
DEFUN
 (
bgp_ªdi°ribuã_ùv4_mëric_rm≠
,

9917 
bgp_ªdi°ribuã_ùv4_mëric_rm≠_cmd
,

9918 "ªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 " metric <0-4294967295>Ñoute-map WORD",

9920 
QUAGGA_IP_REDIST_HELP_STR_BGPD


9926 
	gty≥
;

9927 
u_öt32_t
 
	gmëric
;

9929 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9930 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9932 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9933  
	gCMD_WARNING
;

9935 
VTY_GET_INTEGER
 ("mëric", 
mëric
, 
¨gv
[1]);

9937 
bgp_ªdi°ribuã_mëric_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
, 
mëric
);

9938 
bgp_ªdi°ribuã_rm≠_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
, 
¨gv
[2]);

9939  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

9942 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv4
,

9943 
no_bgp_ªdi°ribuã_ùv4_cmd
,

9944 "nÿªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
,

9945 
NO_STR


9947 
QUAGGA_IP_REDIST_HELP_STR_BGPD
)

9949 
	gty≥
;

9951 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9952 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9954 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9955  
	gCMD_WARNING
;

9958  
bgp_ªdi°ribuã_un£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

9961 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv4_rm≠
,

9962 
no_bgp_ªdi°ribuã_ùv4_rm≠_cmd
,

9963 "nÿªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 "Ñoute-map WORD",

9964 
NO_STR


9966 
QUAGGA_IP_REDIST_HELP_STR_BGPD


9970 
	gty≥
;

9972 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9973 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9975 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9976  
	gCMD_WARNING
;

9979 
bgp_ªdi°ribuã_rouãm≠_un£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

9980  
	gCMD_SUCCESS
;

9983 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv4_mëric
,

9984 
no_bgp_ªdi°ribuã_ùv4_mëric_cmd
,

9985 "nÿªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 " metric <0-4294967295>",

9986 
NO_STR


9988 
QUAGGA_IP_REDIST_HELP_STR_BGPD


9992 
	gty≥
;

9994 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

9995 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

9997 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

9998  
	gCMD_WARNING
;

10001 
bgp_ªdi°ribuã_mëric_un£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

10002  
	gCMD_SUCCESS
;

10005 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv4_rm≠_mëric
,

10006 
no_bgp_ªdi°ribuã_ùv4_rm≠_mëric_cmd
,

10007 "nÿªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 "Ñoute-map WORD metric <0-4294967295>",

10008 
NO_STR


10010 
QUAGGA_IP_REDIST_HELP_STR_BGPD


10016 
	gty≥
;

10018 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

10019 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10021 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10022  
	gCMD_WARNING
;

10025 
bgp_ªdi°ribuã_mëric_un£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

10026 
bgp_ªdi°ribuã_rouãm≠_un£t
 (
vty
->
ödex
, 
AFI_IP
, 
ty≥
);

10027  
	gCMD_SUCCESS
;

10030 
ALIAS
 (
no_bgp_ªdi°ribuã_ùv4_rm≠_mëric
,

10031 
no_bgp_ªdi°ribuã_ùv4_mëric_rm≠_cmd
,

10032 "nÿªdi°ribuã " 
QUAGGA_IP_REDIST_STR_BGPD
 " metric <0-4294967295>Ñoute-map WORD",

10033 
NO_STR


10035 
QUAGGA_IP_REDIST_HELP_STR_BGPD


10041 #ifde‡
HAVE_IPV6


10042 
DEFUN
 (
bgp_ªdi°ribuã_ùv6
,

10043 
bgp_ªdi°ribuã_ùv6_cmd
,

10044 "ªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
,

10046 
QUAGGA_IP6_REDIST_HELP_STR_BGPD
)

10048 
	gty≥
;

10050 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10051 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10053 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10054  
	gCMD_WARNING
;

10057  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10060 
DEFUN
 (
bgp_ªdi°ribuã_ùv6_rm≠
,

10061 
bgp_ªdi°ribuã_ùv6_rm≠_cmd
,

10062 "ªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 "Ñoute-map WORD",

10064 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10068 
	gty≥
;

10070 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10071 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10073 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10074  
	gCMD_WARNING
;

10077 
bgp_ªdi°ribuã_rm≠_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
, 
¨gv
[1]);

10078  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10081 
DEFUN
 (
bgp_ªdi°ribuã_ùv6_mëric
,

10082 
bgp_ªdi°ribuã_ùv6_mëric_cmd
,

10083 "ªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 " metric <0-4294967295>",

10085 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10089 
	gty≥
;

10090 
u_öt32_t
 
	gmëric
;

10092 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10093 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10095 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10096  
	gCMD_WARNING
;

10098 
VTY_GET_INTEGER
 ("mëric", 
mëric
, 
¨gv
[1]);

10100 
bgp_ªdi°ribuã_mëric_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
, 
mëric
);

10101  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10104 
DEFUN
 (
bgp_ªdi°ribuã_ùv6_rm≠_mëric
,

10105 
bgp_ªdi°ribuã_ùv6_rm≠_mëric_cmd
,

10106 "ªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 "Ñoute-map WORD metric <0-4294967295>",

10108 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10114 
	gty≥
;

10115 
u_öt32_t
 
	gmëric
;

10117 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10118 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10120 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10121  
	gCMD_WARNING
;

10123 
VTY_GET_INTEGER
 ("mëric", 
mëric
, 
¨gv
[2]);

10125 
bgp_ªdi°ribuã_rm≠_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
, 
¨gv
[1]);

10126 
bgp_ªdi°ribuã_mëric_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
, 
mëric
);

10127  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10130 
DEFUN
 (
bgp_ªdi°ribuã_ùv6_mëric_rm≠
,

10131 
bgp_ªdi°ribuã_ùv6_mëric_rm≠_cmd
,

10132 "ªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 " metric <0-4294967295>Ñoute-map WORD",

10134 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10140 
	gty≥
;

10141 
u_öt32_t
 
	gmëric
;

10143 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10144 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10146 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10147  
	gCMD_WARNING
;

10149 
VTY_GET_INTEGER
 ("mëric", 
mëric
, 
¨gv
[1]);

10151 
bgp_ªdi°ribuã_mëric_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
, 
mëric
);

10152 
bgp_ªdi°ribuã_rm≠_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
, 
¨gv
[2]);

10153  
bgp_ªdi°ribuã_£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10156 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv6
,

10157 
no_bgp_ªdi°ribuã_ùv6_cmd
,

10158 "nÿªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
,

10159 
NO_STR


10161 
QUAGGA_IP6_REDIST_HELP_STR_BGPD
)

10163 
	gty≥
;

10165 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10166 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10168 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10169  
	gCMD_WARNING
;

10172  
bgp_ªdi°ribuã_un£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10175 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv6_rm≠
,

10176 
no_bgp_ªdi°ribuã_ùv6_rm≠_cmd
,

10177 "nÿªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 "Ñoute-map WORD",

10178 
NO_STR


10180 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10184 
	gty≥
;

10186 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10187 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10189 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10190  
	gCMD_WARNING
;

10193 
bgp_ªdi°ribuã_rouãm≠_un£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10194  
	gCMD_SUCCESS
;

10197 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv6_mëric
,

10198 
no_bgp_ªdi°ribuã_ùv6_mëric_cmd
,

10199 "nÿªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 " metric <0-4294967295>",

10200 
NO_STR


10202 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10206 
	gty≥
;

10208 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10209 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10211 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10212  
	gCMD_WARNING
;

10215 
bgp_ªdi°ribuã_mëric_un£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10216  
	gCMD_SUCCESS
;

10219 
DEFUN
 (
no_bgp_ªdi°ribuã_ùv6_rm≠_mëric
,

10220 
no_bgp_ªdi°ribuã_ùv6_rm≠_mëric_cmd
,

10221 "nÿªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 "Ñoute-map WORD metric <0-4294967295>",

10222 
NO_STR


10224 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10230 
	gty≥
;

10232 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

10233 i‡(
	gty≥
 < 0 ||Åy≥ =
ZEBRA_ROUTE_BGP
)

10235 
vty_out
 (
vty
, "%% InvÆidÑouãÅy≥%s", 
VTY_NEWLINE
);

10236  
	gCMD_WARNING
;

10239 
bgp_ªdi°ribuã_mëric_un£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10240 
bgp_ªdi°ribuã_rouãm≠_un£t
 (
vty
->
ödex
, 
AFI_IP6
, 
ty≥
);

10241  
	gCMD_SUCCESS
;

10244 
ALIAS
 (
no_bgp_ªdi°ribuã_ùv6_rm≠_mëric
,

10245 
no_bgp_ªdi°ribuã_ùv6_mëric_rm≠_cmd
,

10246 "nÿªdi°ribuã " 
QUAGGA_IP6_REDIST_STR_BGPD
 " metric <0-4294967295>Ñoute-map WORD",

10247 
NO_STR


10249 
QUAGGA_IP6_REDIST_HELP_STR_BGPD


10257 
	$bgp_c⁄fig_wrôe_ªdi°ribuã
 (
vty
 *vty, 
bgp
 *bgp, 
afi_t
 
afi
,

10258 
ßfi_t
 
ßfi
, *
wrôe
)

10260 
i
;

10263 i‡(
ßfi
 !
SAFI_UNICAST
)

10266 
i
 = 0; i < 
ZEBRA_ROUTE_MAX
; i++)

10269 i‡(
bgp
->
ªdi°
[
afi
][
i
] && i !
ZEBRA_ROUTE_BGP
)

10272 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, 
wrôe
);

10275 
	`vty_out
 (
vty
, "Ñedi°ribuã %s", 
	`zebø_rouã_°rög
(
i
));

10277 i‡(
bgp
->
ªdi°_mëric_Êag
[
afi
][
i
])

10278 
	`vty_out
 (
vty
, " mëri¯%u", 
bgp
->
ªdi°_mëric
[
afi
][
i
]);

10280 i‡(
bgp
->
rm≠
[
afi
][
i
].
«me
)

10281 
	`vty_out
 (
vty
, "Ñouã-m≠ %s", 
bgp
->
rm≠
[
afi
][
i
].
«me
);

10283 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

10286  *
wrôe
;

10287 
	}
}

10290 
cmd_node
 
	gbgp_node
 =

10292 
BGP_NODE
,

10297 
cmd_node
 
	gbgp_ùv4_uniˇ°_node
 =

10299 
BGP_IPV4_NODE
,

10304 
cmd_node
 
	gbgp_ùv4_mu…iˇ°_node
 =

10306 
BGP_IPV4M_NODE
,

10311 
cmd_node
 
	gbgp_ùv6_uniˇ°_node
 =

10313 
BGP_IPV6_NODE
,

10318 
cmd_node
 
	gbgp_ùv6_mu…iˇ°_node
 =

10320 
BGP_IPV6M_NODE
,

10325 
cmd_node
 
	gbgp_v≤v4_node
 =

10327 
BGP_VPNV4_NODE
,

10332 
communôy_li°_vty
 ();

10335 
	$bgp_vty_öô
 ()

10338 
	`ö°Æl_node
 (&
bgp_node
, 
bgp_c⁄fig_wrôe
);

10339 
	`ö°Æl_node
 (&
bgp_ùv4_uniˇ°_node
, 
NULL
);

10340 
	`ö°Æl_node
 (&
bgp_ùv4_mu…iˇ°_node
, 
NULL
);

10341 
	`ö°Æl_node
 (&
bgp_ùv6_uniˇ°_node
, 
NULL
);

10342 
	`ö°Æl_node
 (&
bgp_ùv6_mu…iˇ°_node
, 
NULL
);

10343 
	`ö°Æl_node
 (&
bgp_v≤v4_node
, 
NULL
);

10346 
	`ö°Æl_deÁu…
 (
BGP_NODE
);

10347 
	`ö°Æl_deÁu…
 (
BGP_IPV4_NODE
);

10348 
	`ö°Æl_deÁu…
 (
BGP_IPV4M_NODE
);

10349 
	`ö°Æl_deÁu…
 (
BGP_IPV6_NODE
);

10350 
	`ö°Æl_deÁu…
 (
BGP_IPV6M_NODE
);

10351 
	`ö°Æl_deÁu…
 (
BGP_VPNV4_NODE
);

10354 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
bgp_mu…ùÀ_ö°™˚_cmd
);

10355 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_bgp_mu…ùÀ_ö°™˚_cmd
);

10358 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
bgp_c⁄fig_ty≥_cmd
);

10359 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_bgp_c⁄fig_ty≥_cmd
);

10362 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_synchr⁄iz©i⁄_cmd
);

10363 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_auto_summ¨y_cmd
);

10366 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_bgp_cmd
);

10367 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_bgp_võw_cmd
);

10370 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_rouãr_bgp_cmd
);

10371 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_rouãr_bgp_võw_cmd
);

10374 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_rouãr_id_cmd
);

10375 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_rouãr_id_cmd
);

10376 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_rouãr_id_vÆ_cmd
);

10379 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_˛u°î_id_cmd
);

10380 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_˛u°î_id32_cmd
);

10381 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_˛u°î_id_cmd
);

10382 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_˛u°î_id_¨g_cmd
);

10385 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_c⁄„dî©i⁄_idítifõr_cmd
);

10386 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_c⁄„dî©i⁄_idítifõr_cmd
);

10387 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_c⁄„dî©i⁄_idítifõr_¨g_cmd
);

10390 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_c⁄„dî©i⁄_≥îs_cmd
);

10391 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_c⁄„dî©i⁄_≥îs_cmd
);

10394 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_max∑ths_cmd
);

10395 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_max∑ths_cmd
);

10396 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_max∑ths_¨g_cmd
);

10397 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_max∑ths_cmd
);

10398 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_max∑ths_cmd
);

10399 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_max∑ths_¨g_cmd
);

10400 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_max∑ths_ibgp_cmd
);

10401 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_max∑ths_ibgp_cmd
);

10402 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_max∑ths_ibgp_¨g_cmd
);

10403 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
bgp_max∑ths_ibgp_cmd
);

10404 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_max∑ths_ibgp_cmd
);

10405 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_bgp_max∑ths_ibgp_¨g_cmd
);

10408 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_timîs_cmd
);

10409 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_timîs_cmd
);

10410 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_timîs_¨g_cmd
);

10413 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_˛õ¡_to_˛õ¡_ªÊe˘i⁄_cmd
);

10414 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_˛õ¡_to_˛õ¡_ªÊe˘i⁄_cmd
);

10417 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_Æways_com∑ª_med_cmd
);

10418 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_Æways_com∑ª_med_cmd
);

10421 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_dëîmöi°ic_med_cmd
);

10422 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_dëîmöi°ic_med_cmd
);

10425 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_gø˚ful_ª°¨t_cmd
);

10426 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_gø˚ful_ª°¨t_cmd
);

10427 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_gø˚ful_ª°¨t_°Æï©h_time_cmd
);

10428 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_gø˚ful_ª°¨t_°Æï©h_time_cmd
);

10429 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_gø˚ful_ª°¨t_°Æï©h_time_vÆ_cmd
);

10432 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_Á°_exã∫Æ_Áûovî_cmd
);

10433 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_Á°_exã∫Æ_Áûovî_cmd
);

10436 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_íf‹˚_fú°_as_cmd
);

10437 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_íf‹˚_fú°_as_cmd
);

10440 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_be°∑th_com∑ª_rouãr_id_cmd
);

10441 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_be°∑th_com∑ª_rouãr_id_cmd
);

10444 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_be°∑th_a•©h_ign‹e_cmd
);

10445 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_be°∑th_a•©h_ign‹e_cmd
);

10448 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_be°∑th_a•©h_c⁄„d_cmd
);

10449 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_be°∑th_a•©h_c⁄„d_cmd
);

10452 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_log_√ighb‹_ch™ges_cmd
);

10453 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_log_√ighb‹_ch™ges_cmd
);

10456 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_be°∑th_med_cmd
);

10457 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_be°∑th_med2_cmd
);

10458 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_be°∑th_med3_cmd
);

10459 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_be°∑th_med_cmd
);

10460 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_be°∑th_med2_cmd
);

10461 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_be°∑th_med3_cmd
);

10464 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_deÁu…_ùv4_uniˇ°_cmd
);

10465 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_deÁu…_ùv4_uniˇ°_cmd
);

10468 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_√tw‹k_imp‹t_check_cmd
);

10469 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_√tw‹k_imp‹t_check_cmd
);

10472 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_deÁu…_loˇl_¥e„ªn˚_cmd
);

10473 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_deÁu…_loˇl_¥e„ªn˚_cmd
);

10474 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_deÁu…_loˇl_¥e„ªn˚_vÆ_cmd
);

10476 #ifde‡
USE_SRX


10478 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_show_c⁄fig_cmd
);

10480 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄√˘_sh‹t_cmd
);

10481 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄√˘_cmd
);

10482 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_disc⁄√˘_cmd
);

10484 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_£t_£rvî_cmd
);

10486 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄f_deÁu…_rﬂ_ªsu…_vÆid_cmd
);

10487 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄f_deÁu…_rﬂ_ªsu…_unknown_cmd
);

10488 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄f_deÁu…_rﬂ_ªsu…_övÆid_cmd
);

10489 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄f_deÁu…_rﬂ_ªsu…_undeföed_cmd
);

10490 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄f_deÁu…_∑th_ªsu…_vÆid_cmd
);

10491 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄f_deÁu…_∑th_ªsu…_övÆid_cmd
);

10492 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_c⁄f_deÁu…_∑th_ªsu…_undeföed_cmd
);

10494 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_evÆu©i⁄_cmd
);

10495 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_evÆu©i⁄_cmd
);

10496 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_evÆu©i⁄_bgp£c_di°ribuã_cmd
);

10503 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_di•œy_cmd
);

10504 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_di•œy_cmd
);

10506 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_kìpwödow_cmd
);

10507 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_¥oxyid_cmd
);

10509 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_pﬁicy_loˇl_¥e„ªn˚_v¨_cmd
);

10510 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_pﬁicy_loˇl_¥e„ªn˚_fix_cmd
);

10511 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_pﬁicy_loˇl_¥e„ªn˚_cmd
);

10513 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_pﬁicy_ign‹e_nŸfound_cmd
);

10514 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_pﬁicy_ign‹e_nŸfound_cmd
);

10516 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_pﬁicy_ign‹e_övÆid_cmd
);

10517 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_pﬁicy_ign‹e_övÆid_cmd
);

10519 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_pﬁicy_ign‹e_undeföed_cmd
);

10520 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_pﬁicy_ign‹e_undeföed_cmd
);

10522 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_pﬁicy_¥e„r_vÆid_cmd
);

10523 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_pﬁicy_¥e„r_vÆid_cmd
);

10527 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp£c_ski_cmd
);

10530 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp£c_sign_cmd
);

10532 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_bgp£c_ski_cmd
);

10533 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_bgp£c_a˘ive_ski_cmd
);

10534 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_bgp£c_ªgi°î_pkeys_cmd
);

10536 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_£nd_extcommunôy_cmd
);

10537 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
§x_£nd_extcommunôy_ebgp_cmd
);

10538 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_§x_£nd_extcommunôy_cmd
);

10542 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ªmŸe_as_cmd
);

10543 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_cmd
);

10544 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ªmŸe_as_cmd
);

10547 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_≥î_group_cmd
);

10548 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_≥î_group_cmd
);

10549 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_≥î_group_ªmŸe_as_cmd
);

10552 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_loˇl_as_cmd
);

10553 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_loˇl_as_no_¥ïíd_cmd
);

10554 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_loˇl_as_no_¥ïíd_ª∂a˚_as_cmd
);

10555 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_loˇl_as_cmd
);

10556 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_loˇl_as_vÆ_cmd
);

10557 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_loˇl_as_vÆ2_cmd
);

10558 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_loˇl_as_vÆ3_cmd
);

10561 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_∑ssw‹d_cmd
);

10562 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_∑ssw‹d_cmd
);

10565 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_a˘iv©e_cmd
);

10566 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_a˘iv©e_cmd
);

10567 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_a˘iv©e_cmd
);

10568 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_a˘iv©e_cmd
);

10569 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_a˘iv©e_cmd
);

10570 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_a˘iv©e_cmd
);

10573 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_a˘iv©e_cmd
);

10574 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_a˘iv©e_cmd
);

10575 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_a˘iv©e_cmd
);

10576 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_a˘iv©e_cmd
);

10577 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_a˘iv©e_cmd
);

10578 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_a˘iv©e_cmd
);

10581 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_£t_≥î_group_cmd
);

10582 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_£t_≥î_group_cmd
);

10583 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_£t_≥î_group_cmd
);

10584 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_£t_≥î_group_cmd
);

10585 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_£t_≥î_group_cmd
);

10586 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_£t_≥î_group_cmd
);

10589 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_£t_≥î_group_cmd
);

10590 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_£t_≥î_group_cmd
);

10591 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_£t_≥î_group_cmd
);

10592 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_£t_≥î_group_cmd
);

10593 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_£t_≥î_group_cmd
);

10594 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_£t_≥î_group_cmd
);

10597 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10598 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10599 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10600 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10601 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10602 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10603 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10604 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10605 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10606 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10607 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10608 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_so·_ªc⁄figuøti⁄_cmd
);

10611 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged_cmd
);

10612 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged1_cmd
);

10613 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged2_cmd
);

10614 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged3_cmd
);

10615 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged4_cmd
);

10616 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged5_cmd
);

10617 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged6_cmd
);

10618 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged7_cmd
);

10619 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged8_cmd
);

10620 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged9_cmd
);

10621 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_©å_unch™ged10_cmd
);

10622 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged_cmd
);

10623 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged1_cmd
);

10624 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged2_cmd
);

10625 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged3_cmd
);

10626 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged4_cmd
);

10627 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged5_cmd
);

10628 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged6_cmd
);

10629 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged7_cmd
);

10630 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged8_cmd
);

10631 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged9_cmd
);

10632 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_©å_unch™ged10_cmd
);

10633 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged_cmd
);

10634 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged1_cmd
);

10635 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged2_cmd
);

10636 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged3_cmd
);

10637 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged4_cmd
);

10638 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged5_cmd
);

10639 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged6_cmd
);

10640 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged7_cmd
);

10641 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged8_cmd
);

10642 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged9_cmd
);

10643 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_©å_unch™ged10_cmd
);

10644 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged_cmd
);

10645 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged1_cmd
);

10646 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged2_cmd
);

10647 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged3_cmd
);

10648 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged4_cmd
);

10649 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged5_cmd
);

10650 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged6_cmd
);

10651 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged7_cmd
);

10652 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged8_cmd
);

10653 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged9_cmd
);

10654 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_©å_unch™ged10_cmd
);

10655 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged_cmd
);

10656 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged1_cmd
);

10657 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged2_cmd
);

10658 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged3_cmd
);

10659 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged4_cmd
);

10660 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged5_cmd
);

10661 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged6_cmd
);

10662 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged7_cmd
);

10663 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged8_cmd
);

10664 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged9_cmd
);

10665 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_©å_unch™ged10_cmd
);

10666 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged_cmd
);

10667 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged1_cmd
);

10668 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged2_cmd
);

10669 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged3_cmd
);

10670 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged4_cmd
);

10671 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged5_cmd
);

10672 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged6_cmd
);

10673 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged7_cmd
);

10674 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged8_cmd
);

10675 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged9_cmd
);

10676 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_©å_unch™ged10_cmd
);

10677 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged_cmd
);

10678 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged1_cmd
);

10679 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged2_cmd
);

10680 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged3_cmd
);

10681 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged4_cmd
);

10682 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged5_cmd
);

10683 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged6_cmd
);

10684 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged7_cmd
);

10685 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged8_cmd
);

10686 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged9_cmd
);

10687 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_©å_unch™ged10_cmd
);

10688 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged_cmd
);

10689 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged1_cmd
);

10690 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged2_cmd
);

10691 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged3_cmd
);

10692 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged4_cmd
);

10693 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged5_cmd
);

10694 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged6_cmd
);

10695 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged7_cmd
);

10696 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged8_cmd
);

10697 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged9_cmd
);

10698 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_©å_unch™ged10_cmd
);

10699 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged_cmd
);

10700 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged1_cmd
);

10701 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged2_cmd
);

10702 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged3_cmd
);

10703 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged4_cmd
);

10704 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged5_cmd
);

10705 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged6_cmd
);

10706 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged7_cmd
);

10707 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged8_cmd
);

10708 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged9_cmd
);

10709 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_©å_unch™ged10_cmd
);

10710 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged_cmd
);

10711 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged1_cmd
);

10712 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged2_cmd
);

10713 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged3_cmd
);

10714 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged4_cmd
);

10715 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged5_cmd
);

10716 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged6_cmd
);

10717 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged7_cmd
);

10718 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged8_cmd
);

10719 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged9_cmd
);

10720 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_©å_unch™ged10_cmd
);

10721 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged_cmd
);

10722 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged1_cmd
);

10723 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged2_cmd
);

10724 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged3_cmd
);

10725 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged4_cmd
);

10726 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged5_cmd
);

10727 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged6_cmd
);

10728 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged7_cmd
);

10729 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged8_cmd
);

10730 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged9_cmd
);

10731 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_©å_unch™ged10_cmd
);

10732 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged_cmd
);

10733 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged1_cmd
);

10734 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged2_cmd
);

10735 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged3_cmd
);

10736 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged4_cmd
);

10737 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged5_cmd
);

10738 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged6_cmd
);

10739 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged7_cmd
);

10740 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged8_cmd
);

10741 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged9_cmd
);

10742 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_©å_unch™ged10_cmd
);

10745 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_√xth›_loˇl_unch™ged_cmd
);

10746 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_√xth›_loˇl_unch™ged_cmd
);

10750 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_å™•¨ít_as_cmd
);

10751 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_å™•¨ít_√xth›_cmd
);

10754 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_√xth›_£lf_cmd
);

10755 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_√xth›_£lf_cmd
);

10756 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_√xth›_£lf_cmd
);

10757 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_√xth›_£lf_cmd
);

10758 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_√xth›_£lf_cmd
);

10759 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_√xth›_£lf_cmd
);

10760 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_√xth›_£lf_cmd
);

10761 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_√xth›_£lf_cmd
);

10762 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_√xth›_£lf_cmd
);

10763 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_√xth›_£lf_cmd
);

10764 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_√xth›_£lf_cmd
);

10765 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_√xth›_£lf_cmd
);

10768 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ªmove_¥iv©e_as_cmd
);

10769 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ªmove_¥iv©e_as_cmd
);

10770 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_ªmove_¥iv©e_as_cmd
);

10771 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_ªmove_¥iv©e_as_cmd
);

10772 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_ªmove_¥iv©e_as_cmd
);

10773 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_ªmove_¥iv©e_as_cmd
);

10774 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_ªmove_¥iv©e_as_cmd
);

10775 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_ªmove_¥iv©e_as_cmd
);

10776 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_ªmove_¥iv©e_as_cmd
);

10777 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_ªmove_¥iv©e_as_cmd
);

10778 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_ªmove_¥iv©e_as_cmd
);

10779 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_ªmove_¥iv©e_as_cmd
);

10782 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_£nd_communôy_cmd
);

10783 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_£nd_communôy_ty≥_cmd
);

10784 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_£nd_communôy_cmd
);

10785 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_£nd_communôy_ty≥_cmd
);

10786 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_£nd_communôy_cmd
);

10787 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_£nd_communôy_ty≥_cmd
);

10788 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_£nd_communôy_cmd
);

10789 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_£nd_communôy_ty≥_cmd
);

10790 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_£nd_communôy_cmd
);

10791 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_£nd_communôy_ty≥_cmd
);

10792 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_£nd_communôy_cmd
);

10793 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_£nd_communôy_ty≥_cmd
);

10794 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_£nd_communôy_cmd
);

10795 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_£nd_communôy_ty≥_cmd
);

10796 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_£nd_communôy_cmd
);

10797 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_£nd_communôy_ty≥_cmd
);

10798 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_£nd_communôy_cmd
);

10799 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_£nd_communôy_ty≥_cmd
);

10800 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_£nd_communôy_cmd
);

10801 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_£nd_communôy_ty≥_cmd
);

10802 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_£nd_communôy_cmd
);

10803 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_£nd_communôy_ty≥_cmd
);

10804 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_£nd_communôy_cmd
);

10805 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_£nd_communôy_ty≥_cmd
);

10808 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10809 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10810 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10811 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10812 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10813 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10814 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10815 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10816 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10817 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10818 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10819 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_rouã_ªÊe˘‹_˛õ¡_cmd
);

10822 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10823 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10824 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10825 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10826 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10827 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10828 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10829 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10830 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10831 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10832 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10833 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_rouã_£rvî_˛õ¡_cmd
);

10836 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_∑ssive_cmd
);

10837 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_∑ssive_cmd
);

10840 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_shutdown_cmd
);

10841 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_shutdown_cmd
);

10844 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ˇ∑bûôy_rouã_ª‰esh_cmd
);

10845 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ˇ∑bûôy_rouã_ª‰esh_cmd
);

10848 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10849 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10850 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10851 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10852 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10853 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10854 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10855 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10856 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10857 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_ˇ∑bûôy_‹f_¥efix_cmd
);

10858 #ifde‡
USE_SRX


10859 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ˇ∑bûôy_bgp£c_cmd
);

10860 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ˇ∑bûôy_bgp£c_cmd
);

10862 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_bgp£c_m≤Ãi_ùv4_cmd
);

10865 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_cmd
);

10866 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_cmd
);

10867 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_libîÆ_cmd
);

10868 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ˇ∑bûôy_exãnded_mesßge_suµ‹t_libîÆ_cmd
);

10872 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ˇ∑bûôy_dy«mic_cmd
);

10873 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ˇ∑bûôy_dy«mic_cmd
);

10876 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_d⁄t_ˇ∑bûôy_√gŸüã_cmd
);

10877 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_d⁄t_ˇ∑bûôy_√gŸüã_cmd
);

10880 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ebgp_mu…ih›_cmd
);

10881 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ebgp_mu…ih›_âl_cmd
);

10882 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ebgp_mu…ih›_cmd
);

10883 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ebgp_mu…ih›_âl_cmd
);

10886 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_dißbÀ_c⁄√˘ed_check_cmd
);

10887 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_dißbÀ_c⁄√˘ed_check_cmd
);

10888 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_íf‹˚_mu…ih›_cmd
);

10889 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_íf‹˚_mu…ih›_cmd
);

10892 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_des¸ùti⁄_cmd
);

10893 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_des¸ùti⁄_cmd
);

10894 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_des¸ùti⁄_vÆ_cmd
);

10897 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_upd©e_sour˚_cmd
);

10898 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_upd©e_sour˚_cmd
);

10901 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_deÁu…_‹igö©e_cmd
);

10902 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10903 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_cmd
);

10904 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10905 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_deÁu…_‹igö©e_cmd
);

10906 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10907 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_cmd
);

10908 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10909 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_deÁu…_‹igö©e_cmd
);

10910 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10911 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_cmd
);

10912 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10913 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_deÁu…_‹igö©e_cmd
);

10914 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10915 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_cmd
);

10916 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10917 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_deÁu…_‹igö©e_cmd
);

10918 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10919 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_cmd
);

10920 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_deÁu…_‹igö©e_rm≠_cmd
);

10923 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_p‹t_cmd
);

10924 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_p‹t_cmd
);

10925 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_p‹t_vÆ_cmd
);

10928 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_weight_cmd
);

10929 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_weight_cmd
);

10930 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_weight_vÆ_cmd
);

10933 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_ovîride_ˇ∑bûôy_cmd
);

10934 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_ovîride_ˇ∑bûôy_cmd
);

10937 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_°ri˘_ˇ∑bûôy_cmd
);

10938 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_°ri˘_ˇ∑bûôy_cmd
);

10941 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_timîs_cmd
);

10942 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_timîs_cmd
);

10945 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_timîs_c⁄√˘_cmd
);

10946 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_timîs_c⁄√˘_cmd
);

10947 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_timîs_c⁄√˘_vÆ_cmd
);

10950 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_advîti£_öãrvÆ_cmd
);

10951 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_advîti£_öãrvÆ_cmd
);

10952 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_advîti£_öãrvÆ_vÆ_cmd
);

10955 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_vîsi⁄_cmd
);

10958 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_öãrÁ˚_cmd
);

10959 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_öãrÁ˚_cmd
);

10962 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_di°ribuã_li°_cmd
);

10963 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_di°ribuã_li°_cmd
);

10964 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_di°ribuã_li°_cmd
);

10965 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_di°ribuã_li°_cmd
);

10966 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_di°ribuã_li°_cmd
);

10967 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_di°ribuã_li°_cmd
);

10968 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_di°ribuã_li°_cmd
);

10969 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_di°ribuã_li°_cmd
);

10970 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_di°ribuã_li°_cmd
);

10971 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_di°ribuã_li°_cmd
);

10972 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_di°ribuã_li°_cmd
);

10973 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_di°ribuã_li°_cmd
);

10976 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_¥efix_li°_cmd
);

10977 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_¥efix_li°_cmd
);

10978 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_¥efix_li°_cmd
);

10979 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_¥efix_li°_cmd
);

10980 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_¥efix_li°_cmd
);

10981 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_¥efix_li°_cmd
);

10982 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_¥efix_li°_cmd
);

10983 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_¥efix_li°_cmd
);

10984 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_¥efix_li°_cmd
);

10985 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_¥efix_li°_cmd
);

10986 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_¥efix_li°_cmd
);

10987 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_¥efix_li°_cmd
);

10990 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_fûãr_li°_cmd
);

10991 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_fûãr_li°_cmd
);

10992 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_fûãr_li°_cmd
);

10993 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_fûãr_li°_cmd
);

10994 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_fûãr_li°_cmd
);

10995 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_fûãr_li°_cmd
);

10996 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_fûãr_li°_cmd
);

10997 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_fûãr_li°_cmd
);

10998 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_fûãr_li°_cmd
);

10999 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_fûãr_li°_cmd
);

11000 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_fûãr_li°_cmd
);

11001 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_fûãr_li°_cmd
);

11004 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_rouã_m≠_cmd
);

11005 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_rouã_m≠_cmd
);

11006 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_rouã_m≠_cmd
);

11007 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_rouã_m≠_cmd
);

11008 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_rouã_m≠_cmd
);

11009 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_rouã_m≠_cmd
);

11010 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_rouã_m≠_cmd
);

11011 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_rouã_m≠_cmd
);

11012 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_rouã_m≠_cmd
);

11013 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_rouã_m≠_cmd
);

11014 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_rouã_m≠_cmd
);

11015 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_rouã_m≠_cmd
);

11018 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_unsuµªss_m≠_cmd
);

11019 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_unsuµªss_m≠_cmd
);

11020 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_unsuµªss_m≠_cmd
);

11021 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_unsuµªss_m≠_cmd
);

11022 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_unsuµªss_m≠_cmd
);

11023 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_unsuµªss_m≠_cmd
);

11024 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_unsuµªss_m≠_cmd
);

11025 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_unsuµªss_m≠_cmd
);

11026 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_unsuµªss_m≠_cmd
);

11027 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_unsuµªss_m≠_cmd
);

11028 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_unsuµªss_m≠_cmd
);

11029 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_unsuµªss_m≠_cmd
);

11032 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_maximum_¥efix_cmd
);

11033 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11034 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_maximum_¥efix_w¨nög_cmd
);

11035 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11036 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11037 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11038 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_maximum_¥efix_cmd
);

11039 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_maximum_¥efix_vÆ_cmd
);

11040 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11041 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_maximum_¥efix_w¨nög_cmd
);

11042 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11043 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11044 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11045 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_maximum_¥efix_cmd
);

11046 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11047 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_maximum_¥efix_w¨nög_cmd
);

11048 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11049 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11050 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11051 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_maximum_¥efix_cmd
);

11052 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_maximum_¥efix_vÆ_cmd
);

11053 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11054 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_maximum_¥efix_w¨nög_cmd
);

11055 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11056 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11057 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11058 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_maximum_¥efix_cmd
);

11059 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11060 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_maximum_¥efix_w¨nög_cmd
);

11061 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11062 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11063 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11064 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_maximum_¥efix_cmd
);

11065 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_maximum_¥efix_vÆ_cmd
);

11066 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11067 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_maximum_¥efix_w¨nög_cmd
);

11068 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11069 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11070 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11071 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_maximum_¥efix_cmd
);

11072 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11073 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_maximum_¥efix_w¨nög_cmd
);

11074 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11075 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11076 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11077 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_maximum_¥efix_cmd
);

11078 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_maximum_¥efix_vÆ_cmd
);

11079 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11080 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_maximum_¥efix_w¨nög_cmd
);

11081 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11082 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11083 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11084 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_maximum_¥efix_cmd
);

11085 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11086 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_maximum_¥efix_w¨nög_cmd
);

11087 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11088 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11089 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11090 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_maximum_¥efix_cmd
);

11091 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_maximum_¥efix_vÆ_cmd
);

11092 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11093 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_maximum_¥efix_w¨nög_cmd
);

11094 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11095 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11096 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11097 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_maximum_¥efix_cmd
);

11098 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11099 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_maximum_¥efix_w¨nög_cmd
);

11100 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11101 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11102 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11103 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_maximum_¥efix_cmd
);

11104 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_maximum_¥efix_vÆ_cmd
);

11105 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_cmd
);

11106 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_maximum_¥efix_w¨nög_cmd
);

11107 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_w¨nög_cmd
);

11108 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_maximum_¥efix_ª°¨t_cmd
);

11109 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_maximum_¥efix_thªshﬁd_ª°¨t_cmd
);

11112 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_Ælowas_ö_cmd
);

11113 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_Ælowas_ö_¨g_cmd
);

11114 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_Ælowas_ö_cmd
);

11115 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_Ælowas_ö_cmd
);

11116 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
√ighb‹_Ælowas_ö_¨g_cmd
);

11117 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
no_√ighb‹_Ælowas_ö_cmd
);

11118 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_Ælowas_ö_cmd
);

11119 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
√ighb‹_Ælowas_ö_¨g_cmd
);

11120 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
no_√ighb‹_Ælowas_ö_cmd
);

11121 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_Ælowas_ö_cmd
);

11122 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
√ighb‹_Ælowas_ö_¨g_cmd
);

11123 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_√ighb‹_Ælowas_ö_cmd
);

11124 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_Ælowas_ö_cmd
);

11125 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
√ighb‹_Ælowas_ö_¨g_cmd
);

11126 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
no_√ighb‹_Ælowas_ö_cmd
);

11127 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_Ælowas_ö_cmd
);

11128 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
√ighb‹_Ælowas_ö_¨g_cmd
);

11129 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
no_√ighb‹_Ælowas_ö_cmd
);

11132 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv4_cmd
);

11133 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv4_ßfi_cmd
);

11134 #ifde‡
HAVE_IPV6


11135 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv6_cmd
);

11136 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv6_ßfi_cmd
);

11138 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_v≤v4_cmd
);

11139 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_v≤v4_uniˇ°_cmd
);

11142 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
exô_addªss_Ámûy_cmd
);

11143 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
exô_addªss_Ámûy_cmd
);

11144 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
exô_addªss_Ámûy_cmd
);

11145 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
exô_addªss_Ámûy_cmd
);

11146 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
exô_addªss_Ámûy_cmd
);

11149 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_cmd
);

11150 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_cmd
);

11151 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_cmd
);

11152 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_cmd
);

11153 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_cmd
);

11154 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_cmd
);

11155 #ifde‡
HAVE_IPV6


11156 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_cmd
);

11157 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ö°™˚_Æl_cmd
);

11158 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_cmd
);

11159 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_cmd
);

11160 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_cmd
);

11161 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_group_cmd
);

11162 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_group_cmd
);

11163 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_exã∫Æ_cmd
);

11164 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_exã∫Æ_cmd
);

11165 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_as_cmd
);

11166 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_as_cmd
);

11170 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_so·_ö_cmd
);

11171 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_so·_ö_cmd
);

11172 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ö_cmd
);

11173 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ö_¥efix_fûãr_cmd
);

11174 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_ö_¥efix_fûãr_cmd
);

11175 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_so·_ö_cmd
);

11176 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ö_cmd
);

11177 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ö_¥efix_fûãr_cmd
);

11178 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_so·_ö_cmd
);

11179 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ö_cmd
);

11180 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ö_¥efix_fûãr_cmd
);

11181 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_so·_ö_cmd
);

11182 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ö_cmd
);

11183 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ö_¥efix_fûãr_cmd
);

11184 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_so·_ö_cmd
);

11185 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ö_cmd
);

11186 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ö_¥efix_fûãr_cmd
);

11187 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ùv4_so·_ö_cmd
);

11188 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_ö_cmd
);

11189 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ùv4_ö_cmd
);

11190 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ùv4_ö_¥efix_fûãr_cmd
);

11191 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_ùv4_ö_¥efix_fûãr_cmd
);

11192 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ùv4_so·_ö_cmd
);

11193 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ùv4_ö_cmd
);

11194 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ùv4_ö_¥efix_fûãr_cmd
);

11195 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ùv4_so·_ö_cmd
);

11196 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ùv4_ö_cmd
);

11197 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ùv4_ö_¥efix_fûãr_cmd
);

11198 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ùv4_so·_ö_cmd
);

11199 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ùv4_ö_cmd
);

11200 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ùv4_ö_¥efix_fûãr_cmd
);

11201 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ùv4_so·_ö_cmd
);

11202 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ùv4_ö_cmd
);

11203 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ùv4_ö_¥efix_fûãr_cmd
);

11204 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_v≤v4_so·_ö_cmd
);

11205 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_v≤v4_ö_cmd
);

11206 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_v≤v4_so·_ö_cmd
);

11207 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_v≤v4_ö_cmd
);

11208 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_v≤v4_so·_ö_cmd
);

11209 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_v≤v4_ö_cmd
);

11210 #ifde‡
HAVE_IPV6


11211 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_so·_ö_cmd
);

11212 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ö°™˚_Æl_so·_ö_cmd
);

11213 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_ö_cmd
);

11214 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_ö_¥efix_fûãr_cmd
);

11215 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_so·_ö_cmd
);

11216 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_ö_cmd
);

11217 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_ö_¥efix_fûãr_cmd
);

11218 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_group_so·_ö_cmd
);

11219 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_group_ö_cmd
);

11220 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_group_ö_¥efix_fûãr_cmd
);

11221 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_exã∫Æ_so·_ö_cmd
);

11222 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_exã∫Æ_ö_cmd
);

11223 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_exã∫Æ_ö_¥efix_fûãr_cmd
);

11224 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_as_so·_ö_cmd
);

11225 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_as_ö_cmd
);

11226 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_as_ö_¥efix_fûãr_cmd
);

11227 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_so·_ö_cmd
);

11228 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_ö_cmd
);

11229 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_ö_¥efix_fûãr_cmd
);

11230 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_so·_ö_cmd
);

11231 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_ö_cmd
);

11232 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_ö_¥efix_fûãr_cmd
);

11233 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_group_so·_ö_cmd
);

11234 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_group_ö_cmd
);

11235 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_group_ö_¥efix_fûãr_cmd
);

11236 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_exã∫Æ_so·_ö_cmd
);

11237 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_exã∫Æ_ö_cmd
);

11238 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_exã∫Æ_ö_¥efix_fûãr_cmd
);

11239 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_as_so·_ö_cmd
);

11240 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_as_ö_cmd
);

11241 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_as_ö_¥efix_fûãr_cmd
);

11245 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_so·_out_cmd
);

11246 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_so·_out_cmd
);

11247 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_out_cmd
);

11248 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_so·_out_cmd
);

11249 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_out_cmd
);

11250 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_so·_out_cmd
);

11251 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_out_cmd
);

11252 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_so·_out_cmd
);

11253 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_out_cmd
);

11254 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_so·_out_cmd
);

11255 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_out_cmd
);

11256 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ùv4_so·_out_cmd
);

11257 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_out_cmd
);

11258 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ùv4_out_cmd
);

11259 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ùv4_so·_out_cmd
);

11260 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ùv4_out_cmd
);

11261 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ùv4_so·_out_cmd
);

11262 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ùv4_out_cmd
);

11263 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ùv4_so·_out_cmd
);

11264 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ùv4_out_cmd
);

11265 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ùv4_so·_out_cmd
);

11266 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ùv4_out_cmd
);

11267 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_v≤v4_so·_out_cmd
);

11268 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_v≤v4_out_cmd
);

11269 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_v≤v4_so·_out_cmd
);

11270 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_v≤v4_out_cmd
);

11271 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_v≤v4_so·_out_cmd
);

11272 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_v≤v4_out_cmd
);

11273 #ifde‡
HAVE_IPV6


11274 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_so·_out_cmd
);

11275 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ö°™˚_Æl_so·_out_cmd
);

11276 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_out_cmd
);

11277 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_so·_out_cmd
);

11278 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_out_cmd
);

11279 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_group_so·_out_cmd
);

11280 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_group_out_cmd
);

11281 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_exã∫Æ_so·_out_cmd
);

11282 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_exã∫Æ_out_cmd
);

11283 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_as_so·_out_cmd
);

11284 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_as_out_cmd
);

11285 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_so·_out_cmd
);

11286 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_out_cmd
);

11287 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_so·_out_cmd
);

11288 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_out_cmd
);

11289 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_group_so·_out_cmd
);

11290 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_group_out_cmd
);

11291 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_exã∫Æ_so·_out_cmd
);

11292 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_exã∫Æ_out_cmd
);

11293 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_as_so·_out_cmd
);

11294 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_as_out_cmd
);

11298 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_so·_cmd
);

11299 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_so·_cmd
);

11300 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_so·_cmd
);

11301 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_so·_cmd
);

11302 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_so·_cmd
);

11303 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_so·_cmd
);

11304 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_ùv4_so·_cmd
);

11305 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_ùv4_so·_cmd
);

11306 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_ùv4_so·_cmd
);

11307 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_group_ùv4_so·_cmd
);

11308 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_exã∫Æ_ùv4_so·_cmd
);

11309 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_ùv4_so·_cmd
);

11310 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_v≤v4_so·_cmd
);

11311 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_v≤v4_so·_cmd
);

11312 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_as_v≤v4_so·_cmd
);

11313 #ifde‡
HAVE_IPV6


11314 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_so·_cmd
);

11315 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ö°™˚_Æl_so·_cmd
);

11316 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_so·_cmd
);

11317 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_group_so·_cmd
);

11318 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_exã∫Æ_so·_cmd
);

11319 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_as_so·_cmd
);

11320 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_so·_cmd
);

11321 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_so·_cmd
);

11322 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_group_so·_cmd
);

11323 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_exã∫Æ_so·_cmd
);

11324 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_as_so·_cmd
);

11328 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_Æl_rs˛õ¡_cmd
);

11329 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_Æl_rs˛õ¡_cmd
);

11330 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_≥î_rs˛õ¡_cmd
);

11331 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_bgp_ö°™˚_≥î_rs˛õ¡_cmd
);

11332 #ifde‡
HAVE_IPV6


11333 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_Æl_rs˛õ¡_cmd
);

11334 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ö°™˚_Æl_rs˛õ¡_cmd
);

11335 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_Æl_rs˛õ¡_cmd
);

11336 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_ö°™˚_Æl_rs˛õ¡_cmd
);

11337 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_≥î_rs˛õ¡_cmd
);

11338 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ö°™˚_≥î_rs˛õ¡_cmd
);

11339 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_≥î_rs˛õ¡_cmd
);

11340 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_bgp_ùv6_ö°™˚_≥î_rs˛õ¡_cmd
);

11344 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_summ¨y_cmd
);

11345 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ö°™˚_summ¨y_cmd
);

11346 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_summ¨y_cmd
);

11347 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_summ¨y_cmd
);

11348 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ö°™˚_ùv4_summ¨y_cmd
);

11349 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv4_ßfi_summ¨y_cmd
);

11350 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_summ¨y_cmd
);

11351 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_summ¨y_cmd
);

11352 #ifde‡
HAVE_IPV6


11353 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_summ¨y_cmd
);

11354 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_summ¨y_cmd
);

11355 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_summ¨y_cmd
);

11356 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_summ¨y_cmd
);

11357 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv6_summ¨y_cmd
);

11358 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv6_ßfi_summ¨y_cmd
);

11360 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_summ¨y_cmd
);

11361 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ö°™˚_summ¨y_cmd
);

11362 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_summ¨y_cmd
);

11363 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv4_ßfi_summ¨y_cmd
);

11364 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ö°™˚_ùv4_summ¨y_cmd
);

11365 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_ùv4_ßfi_summ¨y_cmd
);

11366 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_v≤v4_Æl_summ¨y_cmd
);

11367 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_v≤v4_rd_summ¨y_cmd
);

11368 #ifde‡
HAVE_IPV6


11369 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_summ¨y_cmd
);

11370 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_summ¨y_cmd
);

11371 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_summ¨y_cmd
);

11372 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_ßfi_summ¨y_cmd
);

11373 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_ùv6_summ¨y_cmd
);

11374 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_ùv6_ßfi_summ¨y_cmd
);

11376 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_summ¨y_cmd
);

11377 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ö°™˚_summ¨y_cmd
);

11378 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_summ¨y_cmd
);

11379 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_summ¨y_cmd
);

11380 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ö°™˚_ùv4_summ¨y_cmd
);

11381 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv4_ßfi_summ¨y_cmd
);

11382 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_summ¨y_cmd
);

11383 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_summ¨y_cmd
);

11384 #ifde‡
HAVE_IPV6


11385 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_summ¨y_cmd
);

11386 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_summ¨y_cmd
);

11387 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_summ¨y_cmd
);

11388 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_summ¨y_cmd
);

11389 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv6_summ¨y_cmd
);

11390 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv6_ßfi_summ¨y_cmd
);

11394 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹s_cmd
);

11395 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_√ighb‹s_cmd
);

11396 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_√ighb‹s_≥î_cmd
);

11397 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_√ighb‹s_≥î_cmd
);

11398 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹s_cmd
);

11399 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹s_cmd
);

11400 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹s_≥î_cmd
);

11401 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹s_≥î_cmd
);

11402 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ö°™˚_√ighb‹s_cmd
);

11403 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ö°™˚_√ighb‹s_≥î_cmd
);

11404 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_√ighb‹s_≥î_cmd
);

11405 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_√ighb‹s_≥î_cmd
);

11406 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹s_≥î_cmd
);

11407 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹s_≥î_cmd
);

11408 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ö°™˚_√ighb‹s_≥î_cmd
);

11409 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹s_cmd
);

11410 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_√ighb‹s_cmd
);

11411 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_√ighb‹s_≥î_cmd
);

11412 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_√ighb‹s_≥î_cmd
);

11413 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹s_cmd
);

11414 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹s_cmd
);

11415 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_Æl_√ighb‹s_≥î_cmd
);

11416 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_v≤v4_rd_√ighb‹s_≥î_cmd
);

11417 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ö°™˚_√ighb‹s_cmd
);

11418 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ö°™˚_√ighb‹s_≥î_cmd
);

11420 #ifde‡
HAVE_IPV6


11421 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹s_cmd
);

11422 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹s_cmd
);

11423 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_√ighb‹s_≥î_cmd
);

11424 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_√ighb‹s_≥î_cmd
);

11425 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_√ighb‹s_cmd
);

11426 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv6_√ighb‹s_cmd
);

11427 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_√ighb‹s_≥î_cmd
);

11428 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv6_√ighb‹s_≥î_cmd
);

11429 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_√ighb‹s_≥î_cmd
);

11430 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_√ighb‹s_≥î_cmd
);

11431 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_√ighb‹s_≥î_cmd
);

11432 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_ùv6_√ighb‹s_≥î_cmd
);

11433 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹s_cmd
);

11434 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹s_cmd
);

11435 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_√ighb‹s_≥î_cmd
);

11436 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_√ighb‹s_≥î_cmd
);

11437 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_√ighb‹s_cmd
);

11438 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv6_√ighb‹s_cmd
);

11439 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_√ighb‹s_≥î_cmd
);

11440 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv6_√ighb‹s_≥î_cmd
);

11443 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_bgp_summ¨y_cmd
);

11444 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mbgp_summ¨y_cmd
);

11445 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_bgp_summ¨y_cmd
);

11446 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mbgp_summ¨y_cmd
);

11450 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_rs˛õ¡_summ¨y_cmd
);

11451 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
);

11452 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_rs˛õ¡_summ¨y_cmd
);

11453 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ö°™˚_ùv4_rs˛õ¡_summ¨y_cmd
);

11454 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
);

11455 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
);

11456 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_rs˛õ¡_summ¨y_cmd
);

11457 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
);

11458 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ùv4_rs˛õ¡_summ¨y_cmd
);

11459 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_ù_bgp_ö°™˚_ùv4_rs˛õ¡_summ¨y_cmd
);

11460 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
);

11461 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
);

11462 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_rs˛õ¡_summ¨y_cmd
);

11463 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
);

11464 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_rs˛õ¡_summ¨y_cmd
);

11465 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ö°™˚_ùv4_rs˛õ¡_summ¨y_cmd
);

11466 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
);

11467 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv4_ßfi_rs˛õ¡_summ¨y_cmd
);

11469 #ifde‡
HAVE_IPV6


11470 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_rs˛õ¡_summ¨y_cmd
);

11471 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_rs˛õ¡_summ¨y_cmd
);

11472 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
);

11473 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv6_rs˛õ¡_summ¨y_cmd
);

11474 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ö°™˚_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
);

11475 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
);

11476 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_rs˛õ¡_summ¨y_cmd
);

11477 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_rs˛õ¡_summ¨y_cmd
);

11478 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
);

11479 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_ùv6_rs˛õ¡_summ¨y_cmd
);

11480 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ö°™˚_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
);

11481 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
);

11482 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_rs˛õ¡_summ¨y_cmd
);

11483 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_rs˛õ¡_summ¨y_cmd
);

11484 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_rs˛õ¡_summ¨y_cmd
);

11485 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv6_rs˛õ¡_summ¨y_cmd
);

11486 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ö°™˚_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
);

11487 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_ùv6_ßfi_rs˛õ¡_summ¨y_cmd
);

11491 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_∑ths_cmd
);

11492 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_ùv4_∑ths_cmd
);

11493 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_∑ths_cmd
);

11494 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_ùv4_∑ths_cmd
);

11497 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_communôy_öfo_cmd
);

11498 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_communôy_öfo_cmd
);

11501 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_bgp_©å_öfo_cmd
);

11502 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_bgp_©å_öfo_cmd
);

11505 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_ªdi°ribuã_ùv4_cmd
);

11506 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_ªdi°ribuã_ùv4_cmd
);

11507 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_ªdi°ribuã_ùv4_rm≠_cmd
);

11508 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_ªdi°ribuã_ùv4_rm≠_cmd
);

11509 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_ªdi°ribuã_ùv4_mëric_cmd
);

11510 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_ªdi°ribuã_ùv4_mëric_cmd
);

11511 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_ªdi°ribuã_ùv4_rm≠_mëric_cmd
);

11512 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
bgp_ªdi°ribuã_ùv4_mëric_rm≠_cmd
);

11513 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_ªdi°ribuã_ùv4_rm≠_mëric_cmd
);

11514 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_bgp_ªdi°ribuã_ùv4_mëric_rm≠_cmd
);

11515 #ifde‡
HAVE_IPV6


11516 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
bgp_ªdi°ribuã_ùv6_cmd
);

11517 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_bgp_ªdi°ribuã_ùv6_cmd
);

11518 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
bgp_ªdi°ribuã_ùv6_rm≠_cmd
);

11519 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_bgp_ªdi°ribuã_ùv6_rm≠_cmd
);

11520 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
bgp_ªdi°ribuã_ùv6_mëric_cmd
);

11521 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_bgp_ªdi°ribuã_ùv6_mëric_cmd
);

11522 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
bgp_ªdi°ribuã_ùv6_rm≠_mëric_cmd
);

11523 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
bgp_ªdi°ribuã_ùv6_mëric_rm≠_cmd
);

11524 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_bgp_ªdi°ribuã_ùv6_rm≠_mëric_cmd
);

11525 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
no_bgp_ªdi°ribuã_ùv6_mëric_rm≠_cmd
);

11529 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
√ighb‹_âl_£curôy_cmd
);

11530 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
no_√ighb‹_âl_£curôy_cmd
);

11533 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_mem‹y_cmd
);

11534 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_mem‹y_cmd
);

11535 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_mem‹y_cmd
);

11538 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_bgp_võws_cmd
);

11539 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_bgp_võws_cmd
);

11540 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_bgp_võws_cmd
);

11543 
	`communôy_li°_vty
 ();

11544 
	}
}

11546 
	~"mem‹y.h
"

11547 
	~"bgp_ªgex.h
"

11548 
	~"bgp_˛i°.h
"

11549 
	~"bgp_ecommunôy.h
"

11555 
	$communôy_dúe˘_°r
 (
dúe˘
)

11557 
dúe˘
)

11559 
COMMUNITY_DENY
:

11561 
COMMUNITY_PERMIT
:

11566 
	}
}

11570 
	$communôy_li°_≥º‹
 (
vty
 *vty, 
ªt
)

11572 
ªt
)

11574 
COMMUNITY_LIST_ERR_CANT_FIND_LIST
:

11575 
	`vty_out
 (
vty
, "%% C™'àföd communôy-li°%s", 
VTY_NEWLINE
);

11577 
COMMUNITY_LIST_ERR_MALFORMED_VAL
:

11578 
	`vty_out
 (
vty
, "%% MÆf‹med communôy-li° vÆue%s", 
VTY_NEWLINE
);

11580 
COMMUNITY_LIST_ERR_STANDARD_CONFLICT
:

11581 
	`vty_out
 (
vty
, "%% CommunôyÇamêc⁄Êi˘,Öªviou¶y deföedá†°™d¨d communôy%s", 
VTY_NEWLINE
);

11583 
COMMUNITY_LIST_ERR_EXPANDED_CONFLICT
:

11584 
	`vty_out
 (
vty
, "%% CommunôyÇamêc⁄Êi˘,Öªviou¶y deföedá†ex∑nded communôy%s", 
VTY_NEWLINE
);

11587 
	}
}

11591 
	$communôy_li°_£t_vty
 (
vty
 *vty, 
¨gc
, c⁄° **
¨gv
,

11592 
°yÀ
, 
ªje˘_Æl_digô_«me
)

11594 
ªt
;

11595 
dúe˘
;

11596 *
°r
;

11599 i‡(
	`°∫cmp
 (
¨gv
[1], "p", 1) == 0)

11600 
dúe˘
 = 
COMMUNITY_PERMIT
;

11601 i‡(
	`°∫cmp
 (
¨gv
[1], "d", 1) == 0)

11602 
dúe˘
 = 
COMMUNITY_DENY
;

11605 
	`vty_out
 (
vty
, "%% Matching condition must beÖermit or deny%s",

11606 
VTY_NEWLINE
);

11607  
CMD_WARNING
;

11611 i‡(
ªje˘_Æl_digô_«me
 && 
	`Æl_digô
 (
¨gv
[0]))

11613 
	`vty_out
 (
vty
, "%% CommunôyÇamêˇ¬Ÿ havêÆ»digôs%s", 
VTY_NEWLINE
);

11614  
CMD_WARNING
;

11618 i‡(
¨gc
 > 1)

11619 
°r
 = 
	`¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 2);

11621 
°r
 = 
NULL
;

11625 
ªt
 = 
	`communôy_li°_£t
 (
bgp_˛i°
, 
¨gv
[0], 
°r
, 
dúe˘
, 
°yÀ
);

11629 i‡(
°r
)

11630 
	`XFREE
 (
MTYPE_TMP
, 
°r
);

11632 i‡(
ªt
 < 0)

11635 
	`communôy_li°_≥º‹
 (
vty
, 
ªt
);

11636  
CMD_WARNING
;

11639  
CMD_SUCCESS
;

11640 
	}
}

11644 
	$communôy_li°_un£t_vty
 (
vty
 *vty, 
¨gc
, c⁄° **
¨gv
,

11645 
°yÀ
)

11647 
ªt
;

11648 
dúe˘
 = 0;

11649 *
°r
 = 
NULL
;

11651 i‡(
¨gc
 > 1)

11654 i‡(
	`°∫cmp
 (
¨gv
[1], "p", 1) == 0)

11655 
dúe˘
 = 
COMMUNITY_PERMIT
;

11656 i‡(
	`°∫cmp
 (
¨gv
[1], "d", 1) == 0)

11657 
dúe˘
 = 
COMMUNITY_DENY
;

11660 
	`vty_out
 (
vty
, "%% Matching condition must beÖermit or deny%s",

11661 
VTY_NEWLINE
);

11662  
CMD_WARNING
;

11666 
°r
 = 
	`¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 2);

11670 
ªt
 = 
	`communôy_li°_un£t
 (
bgp_˛i°
, 
¨gv
[0], 
°r
, 
dúe˘
, 
°yÀ
);

11674 i‡(
°r
)

11675 
	`XFREE
 (
MTYPE_TMP
, 
°r
);

11677 i‡(
ªt
 < 0)

11679 
	`communôy_li°_≥º‹
 (
vty
, 
ªt
);

11680  
CMD_WARNING
;

11683  
CMD_SUCCESS
;

11684 
	}
}

11687 
	#COMMUNITY_LIST_STR
 "Addá communôyÜi°É¡ry\n"

	)

11688 
	#COMMUNITY_VAL_STR
 "CommunôyÇumbî i¿Ø:¬ f‹m© o∏öã∫ë|loˇl-AS|no-advîti£|no-exp‹t\n"

	)

11690 
DEFUN
 (
ù_communôy_li°_°™d¨d
,

11691 
ù_communôy_li°_°™d¨d_cmd
,

11693 
IP_STR


11694 
COMMUNITY_LIST_STR


11698 
COMMUNITY_VAL_STR
)

11700  
communôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_STANDARD
, 0);

11703 
ALIAS
 (
ù_communôy_li°_°™d¨d
,

11704 
ù_communôy_li°_°™d¨d2_cmd
,

11706 
IP_STR


11707 
COMMUNITY_LIST_STR


11712 
DEFUN
 (
ù_communôy_li°_ex∑nded
,

11713 
ù_communôy_li°_ex∑nded_cmd
,

11715 
IP_STR


11716 
COMMUNITY_LIST_STR


11722  
communôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_EXPANDED
, 0);

11725 
DEFUN
 (
ù_communôy_li°_«me_°™d¨d
,

11726 
ù_communôy_li°_«me_°™d¨d_cmd
,

11728 
IP_STR


11729 
COMMUNITY_LIST_STR


11734 
COMMUNITY_VAL_STR
)

11736  
communôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_STANDARD
, 1);

11739 
ALIAS
 (
ù_communôy_li°_«me_°™d¨d
,

11740 
ù_communôy_li°_«me_°™d¨d2_cmd
,

11742 
IP_STR


11743 
COMMUNITY_LIST_STR


11749 
DEFUN
 (
ù_communôy_li°_«me_ex∑nded
,

11750 
ù_communôy_li°_«me_ex∑nded_cmd
,

11752 
IP_STR


11753 
COMMUNITY_LIST_STR


11760  
communôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_EXPANDED
, 1);

11763 
DEFUN
 (
no_ù_communôy_li°_°™d¨d_Æl
,

11764 
no_ù_communôy_li°_°™d¨d_Æl_cmd
,

11766 
NO_STR


11767 
IP_STR


11768 
COMMUNITY_LIST_STR


11771  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_STANDARD
);

11774 
DEFUN
 (
no_ù_communôy_li°_ex∑nded_Æl
,

11775 
no_ù_communôy_li°_ex∑nded_Æl_cmd
,

11777 
NO_STR


11778 
IP_STR


11779 
COMMUNITY_LIST_STR


11782  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_EXPANDED
);

11785 
DEFUN
 (
no_ù_communôy_li°_«me_°™d¨d_Æl
,

11786 
no_ù_communôy_li°_«me_°™d¨d_Æl_cmd
,

11788 
NO_STR


11789 
IP_STR


11790 
COMMUNITY_LIST_STR


11794  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_STANDARD
);

11797 
DEFUN
 (
no_ù_communôy_li°_«me_ex∑nded_Æl
,

11798 
no_ù_communôy_li°_«me_ex∑nded_Æl_cmd
,

11800 
NO_STR


11801 
IP_STR


11802 
COMMUNITY_LIST_STR


11806  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_EXPANDED
);

11809 
DEFUN
 (
no_ù_communôy_li°_°™d¨d
,

11810 
no_ù_communôy_li°_°™d¨d_cmd
,

11812 
NO_STR


11813 
IP_STR


11814 
COMMUNITY_LIST_STR


11818 
COMMUNITY_VAL_STR
)

11820  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_STANDARD
);

11823 
DEFUN
 (
no_ù_communôy_li°_ex∑nded
,

11824 
no_ù_communôy_li°_ex∑nded_cmd
,

11826 
NO_STR


11827 
IP_STR


11828 
COMMUNITY_LIST_STR


11834  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_EXPANDED
);

11837 
DEFUN
 (
no_ù_communôy_li°_«me_°™d¨d
,

11838 
no_ù_communôy_li°_«me_°™d¨d_cmd
,

11840 
NO_STR


11841 
IP_STR


11842 
COMMUNITY_LIST_STR


11847 
COMMUNITY_VAL_STR
)

11849  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_STANDARD
);

11852 
DEFUN
 (
no_ù_communôy_li°_«me_ex∑nded
,

11853 
no_ù_communôy_li°_«me_ex∑nded_cmd
,

11855 
NO_STR


11856 
IP_STR


11857 
COMMUNITY_LIST_STR


11864  
communôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
COMMUNITY_LIST_EXPANDED
);

11868 
	$communôy_li°_show
 (
vty
 *vty, 
communôy_li°
 *
li°
)

11870 
communôy_íåy
 *
íåy
;

11872 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

11874 i‡(
íåy
 =
li°
->
hód
)

11876 i‡(
	`Æl_digô
 (
li°
->
«me
))

11877 
	`vty_out
 (
vty
, "Community %sÜist %s%s",

11878 
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD
 ?

11880 
li°
->
«me
, 
VTY_NEWLINE
);

11882 
	`vty_out
 (
vty
, "Named Community %sÜist %s%s",

11883 
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD
 ?

11885 
li°
->
«me
, 
VTY_NEWLINE
);

11887 i‡(
íåy
->
™y
)

11888 
	`vty_out
 (
vty
, " %s%s",

11889 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
), 
VTY_NEWLINE
);

11891 
	`vty_out
 (
vty
, " %s %s%s",

11892 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
),

11893 
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD


11894 ? 
	`communôy_°r
 (
íåy
->
u
.
com
Ë:É¡ry->
c⁄fig
,

11895 
VTY_NEWLINE
);

11897 
	}
}

11899 
DEFUN
 (
show_ù_communôy_li°
,

11900 
show_ù_communôy_li°_cmd
,

11902 
SHOW_STR


11903 
IP_STR


11906 
communôy_li°
 *
	gli°
;

11907 
communôy_li°_ma°î
 *
	gcm
;

11909 
	gcm
 = 
communôy_li°_ma°î_lookup
 (
bgp_˛i°
, 
COMMUNITY_LIST_MASTER
);

11910 i‡(! 
	gcm
)

11911  
	gCMD_SUCCESS
;

11913 
	gli°
 = 
cm
->
num
.
hód
;Üi°;Üi° = 
li°
->
√xt
)

11914 
communôy_li°_show
 (
vty
, 
li°
);

11916 
	gli°
 = 
cm
->
°r
.
hód
;Üi°;Üi° = 
li°
->
√xt
)

11917 
communôy_li°_show
 (
vty
, 
li°
);

11919  
	gCMD_SUCCESS
;

11922 
DEFUN
 (
show_ù_communôy_li°_¨g
,

11923 
show_ù_communôy_li°_¨g_cmd
,

11925 
SHOW_STR


11926 
IP_STR


11931 
communôy_li°
 *
	gli°
;

11933 
	gli°
 = 
communôy_li°_lookup
 (
bgp_˛i°
, 
¨gv
[0], 
COMMUNITY_LIST_MASTER
);

11934 i‡(! 
	gli°
)

11936 
vty_out
 (
vty
, "%% C™'àföd communôy-li°%s", 
VTY_NEWLINE
);

11937  
	gCMD_WARNING
;

11940 
communôy_li°_show
 (
vty
, 
li°
);

11942  
	gCMD_SUCCESS
;

11946 
	$extcommunôy_li°_£t_vty
 (
vty
 *vty, 
¨gc
, c⁄° **
¨gv
,

11947 
°yÀ
, 
ªje˘_Æl_digô_«me
)

11949 
ªt
;

11950 
dúe˘
;

11951 *
°r
;

11954 i‡(
	`°∫cmp
 (
¨gv
[1], "p", 1) == 0)

11955 
dúe˘
 = 
COMMUNITY_PERMIT
;

11956 i‡(
	`°∫cmp
 (
¨gv
[1], "d", 1) == 0)

11957 
dúe˘
 = 
COMMUNITY_DENY
;

11960 
	`vty_out
 (
vty
, "%% Matching condition must beÖermit or deny%s",

11961 
VTY_NEWLINE
);

11962  
CMD_WARNING
;

11966 i‡(
ªje˘_Æl_digô_«me
 && 
	`Æl_digô
 (
¨gv
[0]))

11968 
	`vty_out
 (
vty
, "%% CommunôyÇamêˇ¬Ÿ havêÆ»digôs%s", 
VTY_NEWLINE
);

11969  
CMD_WARNING
;

11973 i‡(
¨gc
 > 1)

11974 
°r
 = 
	`¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 2);

11976 
°r
 = 
NULL
;

11978 
ªt
 = 
	`extcommunôy_li°_£t
 (
bgp_˛i°
, 
¨gv
[0], 
°r
, 
dúe˘
, 
°yÀ
);

11982 i‡(
°r
)

11983 
	`XFREE
 (
MTYPE_TMP
, 
°r
);

11985 i‡(
ªt
 < 0)

11987 
	`communôy_li°_≥º‹
 (
vty
, 
ªt
);

11988  
CMD_WARNING
;

11990  
CMD_SUCCESS
;

11991 
	}
}

11994 
	$extcommunôy_li°_un£t_vty
 (
vty
 *vty, 
¨gc
, c⁄° **
¨gv
,

11995 
°yÀ
)

11997 
ªt
;

11998 
dúe˘
 = 0;

11999 *
°r
 = 
NULL
;

12001 i‡(
¨gc
 > 1)

12004 i‡(
	`°∫cmp
 (
¨gv
[1], "p", 1) == 0)

12005 
dúe˘
 = 
COMMUNITY_PERMIT
;

12006 i‡(
	`°∫cmp
 (
¨gv
[1], "d", 1) == 0)

12007 
dúe˘
 = 
COMMUNITY_DENY
;

12010 
	`vty_out
 (
vty
, "%% Matching condition must beÖermit or deny%s",

12011 
VTY_NEWLINE
);

12012  
CMD_WARNING
;

12016 
°r
 = 
	`¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 2);

12020 
ªt
 = 
	`extcommunôy_li°_un£t
 (
bgp_˛i°
, 
¨gv
[0], 
°r
, 
dúe˘
, 
°yÀ
);

12024 i‡(
°r
)

12025 
	`XFREE
 (
MTYPE_TMP
, 
°r
);

12027 i‡(
ªt
 < 0)

12029 
	`communôy_li°_≥º‹
 (
vty
, 
ªt
);

12030  
CMD_WARNING
;

12033  
CMD_SUCCESS
;

12034 
	}
}

12037 
	#EXTCOMMUNITY_LIST_STR
 "AddáÉxãnded communôyÜi°É¡ry\n"

	)

12038 
	#EXTCOMMUNITY_VAL_STR
 "Exãnded communôyáâribuã i¿'πáa:¬_‹_IPaddr:¬' OR 'soÿØ:¬_‹_IPaddr:¬' f‹m©\n"

	)

12040 
DEFUN
 (
ù_extcommunôy_li°_°™d¨d
,

12041 
ù_extcommunôy_li°_°™d¨d_cmd
,

12043 
IP_STR


12044 
EXTCOMMUNITY_LIST_STR


12048 
EXTCOMMUNITY_VAL_STR
)

12050  
extcommunôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_STANDARD
, 0);

12053 
ALIAS
 (
ù_extcommunôy_li°_°™d¨d
,

12054 
ù_extcommunôy_li°_°™d¨d2_cmd
,

12056 
IP_STR


12057 
EXTCOMMUNITY_LIST_STR


12062 
DEFUN
 (
ù_extcommunôy_li°_ex∑nded
,

12063 
ù_extcommunôy_li°_ex∑nded_cmd
,

12065 
IP_STR


12066 
EXTCOMMUNITY_LIST_STR


12072  
extcommunôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_EXPANDED
, 0);

12075 
DEFUN
 (
ù_extcommunôy_li°_«me_°™d¨d
,

12076 
ù_extcommunôy_li°_«me_°™d¨d_cmd
,

12078 
IP_STR


12079 
EXTCOMMUNITY_LIST_STR


12084 
EXTCOMMUNITY_VAL_STR
)

12086  
extcommunôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_STANDARD
, 1);

12089 
ALIAS
 (
ù_extcommunôy_li°_«me_°™d¨d
,

12090 
ù_extcommunôy_li°_«me_°™d¨d2_cmd
,

12092 
IP_STR


12093 
EXTCOMMUNITY_LIST_STR


12099 
DEFUN
 (
ù_extcommunôy_li°_«me_ex∑nded
,

12100 
ù_extcommunôy_li°_«me_ex∑nded_cmd
,

12102 
IP_STR


12103 
EXTCOMMUNITY_LIST_STR


12110  
extcommunôy_li°_£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_EXPANDED
, 1);

12113 
DEFUN
 (
no_ù_extcommunôy_li°_°™d¨d_Æl
,

12114 
no_ù_extcommunôy_li°_°™d¨d_Æl_cmd
,

12116 
NO_STR


12117 
IP_STR


12118 
EXTCOMMUNITY_LIST_STR


12121  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_STANDARD
);

12124 
DEFUN
 (
no_ù_extcommunôy_li°_ex∑nded_Æl
,

12125 
no_ù_extcommunôy_li°_ex∑nded_Æl_cmd
,

12127 
NO_STR


12128 
IP_STR


12129 
EXTCOMMUNITY_LIST_STR


12132  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_EXPANDED
);

12135 
DEFUN
 (
no_ù_extcommunôy_li°_«me_°™d¨d_Æl
,

12136 
no_ù_extcommunôy_li°_«me_°™d¨d_Æl_cmd
,

12138 
NO_STR


12139 
IP_STR


12140 
EXTCOMMUNITY_LIST_STR


12144  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_STANDARD
);

12147 
DEFUN
 (
no_ù_extcommunôy_li°_«me_ex∑nded_Æl
,

12148 
no_ù_extcommunôy_li°_«me_ex∑nded_Æl_cmd
,

12150 
NO_STR


12151 
IP_STR


12152 
EXTCOMMUNITY_LIST_STR


12156  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_EXPANDED
);

12159 
DEFUN
 (
no_ù_extcommunôy_li°_°™d¨d
,

12160 
no_ù_extcommunôy_li°_°™d¨d_cmd
,

12162 
NO_STR


12163 
IP_STR


12164 
EXTCOMMUNITY_LIST_STR


12168 
EXTCOMMUNITY_VAL_STR
)

12170  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_STANDARD
);

12173 
DEFUN
 (
no_ù_extcommunôy_li°_ex∑nded
,

12174 
no_ù_extcommunôy_li°_ex∑nded_cmd
,

12176 
NO_STR


12177 
IP_STR


12178 
EXTCOMMUNITY_LIST_STR


12184  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_EXPANDED
);

12187 
DEFUN
 (
no_ù_extcommunôy_li°_«me_°™d¨d
,

12188 
no_ù_extcommunôy_li°_«me_°™d¨d_cmd
,

12190 
NO_STR


12191 
IP_STR


12192 
EXTCOMMUNITY_LIST_STR


12197 
EXTCOMMUNITY_VAL_STR
)

12199  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_STANDARD
);

12202 
DEFUN
 (
no_ù_extcommunôy_li°_«me_ex∑nded
,

12203 
no_ù_extcommunôy_li°_«me_ex∑nded_cmd
,

12205 
NO_STR


12206 
IP_STR


12207 
EXTCOMMUNITY_LIST_STR


12214  
extcommunôy_li°_un£t_vty
 (
vty
, 
¨gc
, 
¨gv
, 
EXTCOMMUNITY_LIST_EXPANDED
);

12218 
	$extcommunôy_li°_show
 (
vty
 *vty, 
communôy_li°
 *
li°
)

12220 
communôy_íåy
 *
íåy
;

12222 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

12224 i‡(
íåy
 =
li°
->
hód
)

12226 i‡(
	`Æl_digô
 (
li°
->
«me
))

12227 
	`vty_out
 (
vty
, "Extended community %sÜist %s%s",

12228 
íåy
->
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD
 ?

12230 
li°
->
«me
, 
VTY_NEWLINE
);

12232 
	`vty_out
 (
vty
, "NamedÉxtended community %sÜist %s%s",

12233 
íåy
->
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD
 ?

12235 
li°
->
«me
, 
VTY_NEWLINE
);

12237 i‡(
íåy
->
™y
)

12238 
	`vty_out
 (
vty
, " %s%s",

12239 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
), 
VTY_NEWLINE
);

12241 
	`vty_out
 (
vty
, " %s %s%s",

12242 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
),

12243 
íåy
->
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD
 ?

12244 
íåy
->
u
.
ecom
->
°r
 :É¡ry->
c⁄fig
,

12245 
VTY_NEWLINE
);

12247 
	}
}

12249 
DEFUN
 (
show_ù_extcommunôy_li°
,

12250 
show_ù_extcommunôy_li°_cmd
,

12252 
SHOW_STR


12253 
IP_STR


12256 
communôy_li°
 *
	gli°
;

12257 
communôy_li°_ma°î
 *
	gcm
;

12259 
	gcm
 = 
communôy_li°_ma°î_lookup
 (
bgp_˛i°
, 
EXTCOMMUNITY_LIST_MASTER
);

12260 i‡(! 
	gcm
)

12261  
	gCMD_SUCCESS
;

12263 
	gli°
 = 
cm
->
num
.
hód
;Üi°;Üi° = 
li°
->
√xt
)

12264 
extcommunôy_li°_show
 (
vty
, 
li°
);

12266 
	gli°
 = 
cm
->
°r
.
hód
;Üi°;Üi° = 
li°
->
√xt
)

12267 
extcommunôy_li°_show
 (
vty
, 
li°
);

12269  
	gCMD_SUCCESS
;

12272 
DEFUN
 (
show_ù_extcommunôy_li°_¨g
,

12273 
show_ù_extcommunôy_li°_¨g_cmd
,

12275 
SHOW_STR


12276 
IP_STR


12281 
communôy_li°
 *
	gli°
;

12283 
	gli°
 = 
communôy_li°_lookup
 (
bgp_˛i°
, 
¨gv
[0], 
EXTCOMMUNITY_LIST_MASTER
);

12284 i‡(! 
	gli°
)

12286 
vty_out
 (
vty
, "%% C™'àfödÉxtcommunôy-li°%s", 
VTY_NEWLINE
);

12287  
	gCMD_WARNING
;

12290 
extcommunôy_li°_show
 (
vty
, 
li°
);

12292  
	gCMD_SUCCESS
;

12297 
	$communôy_li°_c⁄fig_°r
 (
communôy_íåy
 *
íåy
)

12299 c⁄° *
°r
;

12301 i‡(
íåy
->
™y
)

12302 
°r
 = "";

12305 i‡(
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD
)

12306 
°r
 = 
	`communôy_°r
 (
íåy
->
u
.
com
);

12308 
°r
 = 
íåy
->
c⁄fig
;

12310  
°r
;

12311 
	}
}

12315 
	$communôy_li°_c⁄fig_wrôe
 (
vty
 *vty)

12317 
communôy_li°
 *
li°
;

12318 
communôy_íåy
 *
íåy
;

12319 
communôy_li°_ma°î
 *
cm
;

12320 
wrôe
 = 0;

12323 
cm
 = 
	`communôy_li°_ma°î_lookup
 (
bgp_˛i°
, 
COMMUNITY_LIST_MASTER
);

12325 
li°
 = 
cm
->
num
.
hód
;Üi°;Üi° =Üi°->
√xt
)

12326 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

12328 
	`vty_out
 (
vty
, "ip community-list %s %s %s%s",

12329 
li°
->
«me
, 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
),

12330 
	`communôy_li°_c⁄fig_°r
 (
íåy
),

12331 
VTY_NEWLINE
);

12332 
wrôe
++;

12334 
li°
 = 
cm
->
°r
.
hód
;Üi°;Üi° =Üi°->
√xt
)

12335 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

12337 
	`vty_out
 (
vty
, "ip community-list %s %s %s %s%s",

12338 
íåy
->
°yÀ
 =
COMMUNITY_LIST_STANDARD


12340 
li°
->
«me
, 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
),

12341 
	`communôy_li°_c⁄fig_°r
 (
íåy
),

12342 
VTY_NEWLINE
);

12343 
wrôe
++;

12347 
cm
 = 
	`communôy_li°_ma°î_lookup
 (
bgp_˛i°
, 
EXTCOMMUNITY_LIST_MASTER
);

12349 
li°
 = 
cm
->
num
.
hód
;Üi°;Üi° =Üi°->
√xt
)

12350 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

12352 
	`vty_out
 (
vty
, "ipÉxtcommunity-list %s %s %s%s",

12353 
li°
->
«me
, 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
),

12354 
	`communôy_li°_c⁄fig_°r
 (
íåy
), 
VTY_NEWLINE
);

12355 
wrôe
++;

12357 
li°
 = 
cm
->
°r
.
hód
;Üi°;Üi° =Üi°->
√xt
)

12358 
íåy
 = 
li°
->
hód
;É¡ry;É¡ry =É¡ry->
√xt
)

12360 
	`vty_out
 (
vty
, "ipÉxtcommunity-list %s %s %s %s%s",

12361 
íåy
->
°yÀ
 =
EXTCOMMUNITY_LIST_STANDARD


12363 
li°
->
«me
, 
	`communôy_dúe˘_°r
 (
íåy
->
dúe˘
),

12364 
	`communôy_li°_c⁄fig_°r
 (
íåy
), 
VTY_NEWLINE
);

12365 
wrôe
++;

12367  
wrôe
;

12368 
	}
}

12370 
cmd_node
 
	gcommunôy_li°_node
 =

12372 
COMMUNITY_LIST_NODE
,

12378 
	$communôy_li°_vty
 ()

12380 
	`ö°Æl_node
 (&
communôy_li°_node
, 
communôy_li°_c⁄fig_wrôe
);

12383 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_communôy_li°_°™d¨d_cmd
);

12384 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_communôy_li°_°™d¨d2_cmd
);

12385 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_communôy_li°_ex∑nded_cmd
);

12386 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_communôy_li°_«me_°™d¨d_cmd
);

12387 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_communôy_li°_«me_°™d¨d2_cmd
);

12388 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_communôy_li°_«me_ex∑nded_cmd
);

12389 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_°™d¨d_Æl_cmd
);

12390 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_ex∑nded_Æl_cmd
);

12391 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_«me_°™d¨d_Æl_cmd
);

12392 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_«me_ex∑nded_Æl_cmd
);

12393 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_°™d¨d_cmd
);

12394 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_ex∑nded_cmd
);

12395 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_«me_°™d¨d_cmd
);

12396 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_communôy_li°_«me_ex∑nded_cmd
);

12397 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_communôy_li°_cmd
);

12398 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_communôy_li°_¨g_cmd
);

12399 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_communôy_li°_cmd
);

12400 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_communôy_li°_¨g_cmd
);

12403 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_extcommunôy_li°_°™d¨d_cmd
);

12404 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_extcommunôy_li°_°™d¨d2_cmd
);

12405 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_extcommunôy_li°_ex∑nded_cmd
);

12406 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_extcommunôy_li°_«me_°™d¨d_cmd
);

12407 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_extcommunôy_li°_«me_°™d¨d2_cmd
);

12408 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_extcommunôy_li°_«me_ex∑nded_cmd
);

12409 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_°™d¨d_Æl_cmd
);

12410 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_ex∑nded_Æl_cmd
);

12411 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_«me_°™d¨d_Æl_cmd
);

12412 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_«me_ex∑nded_Æl_cmd
);

12413 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_°™d¨d_cmd
);

12414 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_ex∑nded_cmd
);

12415 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_«me_°™d¨d_cmd
);

12416 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_extcommunôy_li°_«me_ex∑nded_cmd
);

12417 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_extcommunôy_li°_cmd
);

12418 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_extcommunôy_li°_¨g_cmd
);

12419 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_extcommunôy_li°_cmd
);

12420 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_extcommunôy_li°_¨g_cmd
);

12421 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_vty.h

21 #i‚de‡
_QUAGGA_BGP_VTY_H


22 
	#_QUAGGA_BGP_VTY_H


	)

24 
	#CMD_AS_RANGE
 "<1-4294967295>"

	)

26 
bgp_vty_öô
 ();

27 c⁄° *
afi_ßfi_¥öt
 (
afi_t
, 
ßfi_t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_zebra.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"°ªam.h
"

25 
	~"√tw‹k.h
"

26 
	~"¥efix.h
"

27 
	~"log.h
"

28 
	~"sockuni⁄.h
"

29 
	~"z˛õ¡.h
"

30 
	~"rouãm≠.h
"

31 
	~"thªad.h
"

33 
	~"bgpd/bgpd.h
"

34 
	~"bgpd/bgp_rouã.h
"

35 
	~"bgpd/bgp_©å.h
"

36 
	~"bgpd/bgp_√xth›.h
"

37 
	~"bgpd/bgp_zebø.h
"

38 
	~"bgpd/bgp_fsm.h
"

39 
	~"bgpd/bgp_debug.h
"

40 
	~"bgpd/bgp_m∑th.h
"

43 
z˛õ¡
 *
	gz˛õ¡
 = 
NULL
;

44 
ö_addr
 
	grouãr_id_zebø
;

47 
°ªam
 *
	gbgp_√xth›_buf
 = 
NULL
;

51 
	$bgp_rouãr_id_upd©e
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
zebø_size_t
 
Àngth
)

53 
¥efix
 
rouãr_id
;

54 
li°node
 *
node
, *
¬ode
;

55 
bgp
 *bgp;

57 
	`zebø_rouãr_id_upd©e_ªad
(
z˛õ¡
->
ibuf
,&
rouãr_id
);

59 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

61 
buf
[128];

62 
	`¥efix2°r
(&
rouãr_id
, 
buf
, (buf));

63 
	`zlog_debug
("ZebøÑcvd:Ñouã∏id upd©ê%s", 
buf
);

66 
rouãr_id_zebø
 = 
rouãr_id
.
u
.
¥efix4
;

68 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

70 i‡(!
bgp
->
rouãr_id_°©ic
.
s_addr
)

71 
	`bgp_rouãr_id_£t
 (
bgp
, &
rouãr_id
.
u
.
¥efix4
);

75 
	}
}

79 
	$bgp_öãrÁ˚_add
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
zebø_size_t
 
Àngth
)

81 
öãrÁ˚
 *
iÂ
;

83 
iÂ
 = 
	`zebø_öãrÁ˚_add_ªad
 (
z˛õ¡
->
ibuf
);

85 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
Ë&& 
iÂ
)

86 
	`zlog_debug
("ZebøÑcvd: i¡îÁ˚ádd %s", 
iÂ
->
«me
);

89 
	}
}

92 
	$bgp_öãrÁ˚_dñëe
 (
comm™d
, 
z˛õ¡
 *zclient,

93 
zebø_size_t
 
Àngth
)

95 
°ªam
 *
s
;

96 
öãrÁ˚
 *
iÂ
;

98 
s
 = 
z˛õ¡
->
ibuf
;

99 
iÂ
 = 
	`zebø_öãrÁ˚_°©e_ªad
 (
s
);

100 
iÂ
->
ifödex
 = 
IFINDEX_INTERNAL
;

102 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

103 
	`zlog_debug
("ZebøÑcvd: i¡îÁ˚ dñëê%s", 
iÂ
->
«me
);

106 
	}
}

109 
	$bgp_öãrÁ˚_up
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
zebø_size_t
 
Àngth
)

111 
°ªam
 *
s
;

112 
öãrÁ˚
 *
iÂ
;

113 
c⁄√˘ed
 *
c
;

114 
li°node
 *
node
, *
¬ode
;

116 
s
 = 
z˛õ¡
->
ibuf
;

117 
iÂ
 = 
	`zebø_öãrÁ˚_°©e_ªad
 (
s
);

119 i‡(! 
iÂ
)

122 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

123 
	`zlog_debug
("ZebøÑcvd: i¡îÁ˚ %†up", 
iÂ
->
«me
);

125 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
node
, 
¬ode
, 
c
))

126 
	`bgp_c⁄√˘ed_add
 (
c
);

129 
	}
}

132 
	$bgp_öãrÁ˚_down
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
zebø_size_t
 
Àngth
)

134 
°ªam
 *
s
;

135 
öãrÁ˚
 *
iÂ
;

136 
c⁄√˘ed
 *
c
;

137 
li°node
 *
node
, *
¬ode
;

139 
s
 = 
z˛õ¡
->
ibuf
;

140 
iÂ
 = 
	`zebø_öãrÁ˚_°©e_ªad
 (
s
);

141 i‡(! 
iÂ
)

144 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

145 
	`zlog_debug
("ZebøÑcvd: i¡îÁ˚ %†down", 
iÂ
->
«me
);

147 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
node
, 
¬ode
, 
c
))

148 
	`bgp_c⁄√˘ed_dñëe
 (
c
);

152 
li°node
 *
mnode
;

153 
bgp
 *bgp;

154 
≥î
 *peer;

155 
öãrÁ˚
 *
≥î_if
;

157 
	`ALL_LIST_ELEMENTS_RO
 (
bm
->
bgp
, 
mnode
, bgp))

159 i‡(
	`CHECK_FLAG
 (
bgp
->
Êags
, 
BGP_FLAG_NO_FAST_EXT_FAILOVER
))

162 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

164 i‡(
≥î
->
âl
 != 1)

167 i‡(
≥î
->
su
.
ß
.
ß_Ámûy
 =
AF_INET
)

168 
≥î_if
 = 
	`if_lookup_by_ùv4
 (&
≥î
->
su
.
sö
.
sö_addr
);

172 i‡(
iÂ
 =
≥î_if
)

173 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

179 
	}
}

182 
	$bgp_öãrÁ˚_addªss_add
 (
comm™d
, 
z˛õ¡
 *zclient,

183 
zebø_size_t
 
Àngth
)

185 
c⁄√˘ed
 *
ifc
;

187 
ifc
 = 
	`zebø_öãrÁ˚_addªss_ªad
 (
comm™d
, 
z˛õ¡
->
ibuf
);

189 i‡(
ifc
 =
NULL
)

192 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

194 
buf
[128];

195 
	`¥efix2°r
(
ifc
->
addªss
, 
buf
, (buf));

196 
	`zlog_debug
("ZebraÑcvd: interface %sáddressádd %s",

197 
ifc
->
iÂ
->
«me
, 
buf
);

200 i‡(
	`if_is_›î©ive
 (
ifc
->
iÂ
))

201 
	`bgp_c⁄√˘ed_add
 (
ifc
);

204 
	}
}

207 
	$bgp_öãrÁ˚_addªss_dñëe
 (
comm™d
, 
z˛õ¡
 *zclient,

208 
zebø_size_t
 
Àngth
)

210 
c⁄√˘ed
 *
ifc
;

212 
ifc
 = 
	`zebø_öãrÁ˚_addªss_ªad
 (
comm™d
, 
z˛õ¡
->
ibuf
);

214 i‡(
ifc
 =
NULL
)

217 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

219 
buf
[128];

220 
	`¥efix2°r
(
ifc
->
addªss
, 
buf
, (buf));

221 
	`zlog_debug
("ZebraÑcvd: interface %sáddress delete %s",

222 
ifc
->
iÂ
->
«me
, 
buf
);

225 i‡(
	`if_is_›î©ive
 (
ifc
->
iÂ
))

226 
	`bgp_c⁄√˘ed_dñëe
 (
ifc
);

228 
	`c⁄√˘ed_‰ì
 (
ifc
);

231 
	}
}

235 
	$zebø_ªad_ùv4
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
zebø_size_t
 
Àngth
)

237 
°ªam
 *
s
;

238 
z≠i_ùv4
 
≠i
;

239 
ö_addr
 
√xth›
;

240 
¥efix_ùv4
 
p
;

242 
s
 = 
z˛õ¡
->
ibuf
;

243 
√xth›
.
s_addr
 = 0;

246 
≠i
.
ty≥
 = 
	`°ªam_gëc
 (
s
);

247 
≠i
.
Êags
 = 
	`°ªam_gëc
 (
s
);

248 
≠i
.
mesßge
 = 
	`°ªam_gëc
 (
s
);

251 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

252 
p
.
Ámûy
 = 
AF_INET
;

253 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

254 
	`°ªam_gë
 (&
p
.
¥efix
, 
s
, 
	`PSIZE
 (p.
¥efixÀn
));

257 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

259 
≠i
.
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

260 
√xth›
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

262 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_IFINDEX
))

264 
≠i
.
ifödex_num
 = 
	`°ªam_gëc
 (
s
);

265 
	`°ªam_gël
 (
s
);

267 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

268 
≠i
.
di°™˚
 = 
	`°ªam_gëc
 (
s
);

269 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
))

270 
≠i
.
mëric
 = 
	`°ªam_gël
 (
s
);

272 
≠i
.
mëric
 = 0;

274 i‡(
comm™d
 =
ZEBRA_IPV4_ROUTE_ADD
)

276 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

278 
buf
[2][
INET_ADDRSTRLEN
];

279 
	`zlog_debug
("ZebraÑcvd: IPv4Ñouteádd %s %s/%dÇexthop %s metric %u",

280 
	`zebø_rouã_°rög
(
≠i
.
ty≥
),

281 
	`öë_¡›
(
AF_INET
, &
p
.
¥efix
, 
buf
[0], (buf[0])),

282 
p
.
¥efixÀn
,

283 
	`öë_¡›
(
AF_INET
, &
√xth›
, 
buf
[1], (buf[1])),

284 
≠i
.
mëric
);

286 
	`bgp_ªdi°ribuã_add
((
¥efix
 *)&
p
, &
√xth›
, 
NULL
,

287 
≠i
.
mëric
,ápi.
ty≥
);

291 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

293 
buf
[2][
INET_ADDRSTRLEN
];

294 
	`zlog_debug
("ZebraÑcvd: IPv4Ñoute delete %s %s/%d "

296 
	`zebø_rouã_°rög
(
≠i
.
ty≥
),

297 
	`öë_¡›
(
AF_INET
, &
p
.
¥efix
, 
buf
[0], (buf[0])),

298 
p
.
¥efixÀn
,

299 
	`öë_¡›
(
AF_INET
, &
√xth›
, 
buf
[1], (buf[1])),

300 
≠i
.
mëric
);

302 
	`bgp_ªdi°ribuã_dñëe
((
¥efix
 *)&
p
, 
≠i
.
ty≥
);

306 
	}
}

308 #ifde‡
HAVE_IPV6


311 
	$zebø_ªad_ùv6
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
zebø_size_t
 
Àngth
)

313 
°ªam
 *
s
;

314 
z≠i_ùv6
 
≠i
;

315 
ö6_addr
 
√xth›
;

316 
¥efix_ùv6
 
p
;

318 
s
 = 
z˛õ¡
->
ibuf
;

319 
	`mem£t
 (&
√xth›
, 0,  (
ö6_addr
));

322 
≠i
.
ty≥
 = 
	`°ªam_gëc
 (
s
);

323 
≠i
.
Êags
 = 
	`°ªam_gëc
 (
s
);

324 
≠i
.
mesßge
 = 
	`°ªam_gëc
 (
s
);

327 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv6
));

328 
p
.
Ámûy
 = 
AF_INET6
;

329 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

330 
	`°ªam_gë
 (&
p
.
¥efix
, 
s
, 
	`PSIZE
 (p.
¥efixÀn
));

333 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

335 
≠i
.
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

336 
	`°ªam_gë
 (&
√xth›
, 
s
, 16);

338 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_IFINDEX
))

340 
≠i
.
ifödex_num
 = 
	`°ªam_gëc
 (
s
);

341 
	`°ªam_gël
 (
s
);

343 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

344 
≠i
.
di°™˚
 = 
	`°ªam_gëc
 (
s
);

346 
≠i
.
di°™˚
 = 0;

347 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
))

348 
≠i
.
mëric
 = 
	`°ªam_gël
 (
s
);

350 
≠i
.
mëric
 = 0;

353 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
p
.
¥efix
))

356 i‡(
comm™d
 =
ZEBRA_IPV6_ROUTE_ADD
)

358 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

360 
buf
[2][
INET6_ADDRSTRLEN
];

361 
	`zlog_debug
("ZebraÑcvd: IPv6Ñouteádd %s %s/%dÇexthop %s metric %u",

362 
	`zebø_rouã_°rög
(
≠i
.
ty≥
),

363 
	`öë_¡›
(
AF_INET6
, &
p
.
¥efix
, 
buf
[0], (buf[0])),

364 
p
.
¥efixÀn
,

365 
	`öë_¡›
(
AF_INET
, &
√xth›
, 
buf
[1], (buf[1])),

366 
≠i
.
mëric
);

368 
	`bgp_ªdi°ribuã_add
 ((
¥efix
 *)&
p
, 
NULL
, &
√xth›
,

369 
≠i
.
mëric
,ápi.
ty≥
);

373 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

375 
buf
[2][
INET6_ADDRSTRLEN
];

376 
	`zlog_debug
("ZebraÑcvd: IPv6Ñoute delete %s %s/%d "

378 
	`zebø_rouã_°rög
(
≠i
.
ty≥
),

379 
	`öë_¡›
(
AF_INET6
, &
p
.
¥efix
, 
buf
[0], (buf[0])),

380 
p
.
¥efixÀn
,

381 
	`öë_¡›
(
AF_INET6
, &
√xth›
, 
buf
[1], (buf[1])),

382 
≠i
.
mëric
);

384 
	`bgp_ªdi°ribuã_dñëe
 ((
¥efix
 *Ë&
p
, 
≠i
.
ty≥
);

388 
	}
}

391 
öãrÁ˚
 *

392 
	$if_lookup_by_ùv4
 (
ö_addr
 *
addr
)

394 
li°node
 *
i‚ode
;

395 
li°node
 *
˙ode
;

396 
öãrÁ˚
 *
iÂ
;

397 
c⁄√˘ed
 *connected;

398 
¥efix_ùv4
 
p
;

399 
¥efix
 *
˝
;

401 
p
.
Ámûy
 = 
AF_INET
;

402 
p
.
¥efix
 = *
addr
;

403 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

405 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
i‚ode
, 
iÂ
))

407 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, connected))

409 
˝
 = 
c⁄√˘ed
->
addªss
;

411 i‡(
˝
->
Ámûy
 =
AF_INET
)

412 i‡(
	`¥efix_m©ch
 (
˝
, (
¥efix
 *)&
p
))

413  
iÂ
;

416  
NULL
;

417 
	}
}

419 
öãrÁ˚
 *

420 
	$if_lookup_by_ùv4_exa˘
 (
ö_addr
 *
addr
)

422 
li°node
 *
i‚ode
;

423 
li°node
 *
˙ode
;

424 
öãrÁ˚
 *
iÂ
;

425 
c⁄√˘ed
 *connected;

426 
¥efix
 *
˝
;

428 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
i‚ode
, 
iÂ
))

430 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, connected))

432 
˝
 = 
c⁄√˘ed
->
addªss
;

434 i‡(
˝
->
Ámûy
 =
AF_INET
)

435 i‡(
	`IPV4_ADDR_SAME
 (&
˝
->
u
.
¥efix4
, 
addr
))

436  
iÂ
;

439  
NULL
;

440 
	}
}

442 #ifde‡
HAVE_IPV6


443 
öãrÁ˚
 *

444 
	$if_lookup_by_ùv6
 (
ö6_addr
 *
addr
)

446 
li°node
 *
i‚ode
;

447 
li°node
 *
˙ode
;

448 
öãrÁ˚
 *
iÂ
;

449 
c⁄√˘ed
 *connected;

450 
¥efix_ùv6
 
p
;

451 
¥efix
 *
˝
;

453 
p
.
Ámûy
 = 
AF_INET6
;

454 
p
.
¥efix
 = *
addr
;

455 
p
.
¥efixÀn
 = 
IPV6_MAX_BITLEN
;

457 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
i‚ode
, 
iÂ
))

459 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, connected))

461 
˝
 = 
c⁄√˘ed
->
addªss
;

463 i‡(
˝
->
Ámûy
 =
AF_INET6
)

464 i‡(
	`¥efix_m©ch
 (
˝
, (
¥efix
 *)&
p
))

465  
iÂ
;

468  
NULL
;

469 
	}
}

471 
öãrÁ˚
 *

472 
	$if_lookup_by_ùv6_exa˘
 (
ö6_addr
 *
addr
)

474 
li°node
 *
i‚ode
;

475 
li°node
 *
˙ode
;

476 
öãrÁ˚
 *
iÂ
;

477 
c⁄√˘ed
 *connected;

478 
¥efix
 *
˝
;

480 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
i‚ode
, 
iÂ
))

482 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, connected))

484 
˝
 = 
c⁄√˘ed
->
addªss
;

486 i‡(
˝
->
Ámûy
 =
AF_INET6
)

487 i‡(
	`IPV6_ADDR_SAME
 (&
˝
->
u
.
¥efix6
, 
addr
))

488  
iÂ
;

491  
NULL
;

492 
	}
}

495 
	$if_gë_ùv6_globÆ
 (
öãrÁ˚
 *
iÂ
, 
ö6_addr
 *
addr
)

497 
li°node
 *
˙ode
;

498 
c⁄√˘ed
 *connected;

499 
¥efix
 *
˝
;

501 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, connected))

503 
˝
 = 
c⁄√˘ed
->
addªss
;

505 i‡(
˝
->
Ámûy
 =
AF_INET6
)

506 i‡(! 
	`IN6_IS_ADDR_LINKLOCAL
 (&
˝
->
u
.
¥efix6
))

508 
	`mem˝y
 (
addr
, &
˝
->
u
.
¥efix6
, 
IPV6_MAX_BYTELEN
);

513 
	}
}

516 
	$if_gë_ùv6_loˇl
 (
öãrÁ˚
 *
iÂ
, 
ö6_addr
 *
addr
)

518 
li°node
 *
˙ode
;

519 
c⁄√˘ed
 *connected;

520 
¥efix
 *
˝
;

522 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, connected))

524 
˝
 = 
c⁄√˘ed
->
addªss
;

526 i‡(
˝
->
Ámûy
 =
AF_INET6
)

527 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
˝
->
u
.
¥efix6
))

529 
	`mem˝y
 (
addr
, &
˝
->
u
.
¥efix6
, 
IPV6_MAX_BYTELEN
);

534 
	}
}

538 
	$bgp_√xth›_£t
 (
sockuni⁄
 *
loˇl
, sockuni⁄ *
ªmŸe
,

539 
bgp_√xth›
 *
√xth›
, 
≥î
 *peer)

541 
ªt
 = 0;

542 
öãrÁ˚
 *
iÂ
 = 
NULL
;

544 
	`mem£t
 (
√xth›
, 0,  (
bgp_√xth›
));

546 i‡(!
loˇl
)

548 i‡(!
ªmŸe
)

551 i‡(
loˇl
->
ß
.
ß_Ámûy
 =
AF_INET
)

553 
√xth›
->
v4
 = 
loˇl
->
sö
.
sö_addr
;

554 
iÂ
 = 
	`if_lookup_by_ùv4
 (&
loˇl
->
sö
.
sö_addr
);

556 #ifde‡
HAVE_IPV6


557 i‡(
loˇl
->
ß
.
ß_Ámûy
 =
AF_INET6
)

559 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
loˇl
->
sö6
.
sö6_addr
))

561 i‡(
≥î
->
i‚ame
)

562 
iÂ
 = 
	`if_lookup_by_ödex
 (
	`if_«mëoödex
 (
≥î
->
i‚ame
));

565 
iÂ
 = 
	`if_lookup_by_ùv6
 (&
loˇl
->
sö6
.
sö6_addr
);

569 i‡(!
iÂ
)

572 
√xth›
->
iÂ
 = ifp;

575 i‡(
loˇl
->
ß
.
ß_Ámûy
 =
AF_INET
)

577 #ifde‡
HAVE_IPV6


579 
ªt
 = 
	`if_gë_ùv6_globÆ
 (
iÂ
, &
√xth›
->
v6_globÆ
);

582 i‡(!
ªt
)

583 
	`if_gë_ùv6_loˇl
 (
iÂ
, &
√xth›
->
v6_globÆ
);

585 
	`if_gë_ùv6_loˇl
 (
iÂ
, &
√xth›
->
v6_loˇl
);

589 #ifde‡
HAVE_IPV6


591 i‡(
loˇl
->
ß
.
ß_Ámûy
 =
AF_INET6
)

593 
öãrÁ˚
 *
dúe˘
 = 
NULL
;

596 i‡(
≥î
->
loˇl_id
.
s_addr
)

597 
√xth›
->
v4
 = 
≥î
->
loˇl_id
;

600 i‡(! 
	`IN6_IS_ADDR_LINKLOCAL
 (&
loˇl
->
sö6
.
sö6_addr
))

602 
	`mem˝y
 (&
√xth›
->
v6_globÆ
, &
loˇl
->
sö6
.
sö6_addr
,

603 
IPV6_MAX_BYTELEN
);

606 
dúe˘
 = 
	`if_lookup_by_ùv6
 (&
ªmŸe
->
sö6
.
sö6_addr
);

607 i‡(
dúe˘
)

608 
	`if_gë_ùv6_loˇl
 (
iÂ
, &
√xth›
->
v6_loˇl
);

613 
ªt
 = 
	`if_gë_ùv6_globÆ
 (
iÂ
, &
√xth›
->
v6_globÆ
);

617 i‡(!
ªt
)

618 
	`mem˝y
 (&
√xth›
->
v6_globÆ
, &
loˇl
->
sö6
.
sö6_addr
,

619 
IPV6_MAX_BYTELEN
);

621 
	`mem˝y
 (&
√xth›
->
v6_loˇl
, &
loˇl
->
sö6
.
sö6_addr
,

622 
IPV6_MAX_BYTELEN
);

626 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
loˇl
->
sö6
.
sö6_addr
) ||

627 
	`if_lookup_by_ùv6
 (&
ªmŸe
->
sö6
.
sö6_addr
))

628 
≥î
->
sh¨ed_√tw‹k
 = 1;

630 
≥î
->
sh¨ed_√tw‹k
 = 0;

633 #ifde‡
KAME


634 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
√xth›
->
v6_globÆ
)

635 && 
	`IN6_LINKLOCAL_IFINDEX
 (
√xth›
->
v6_globÆ
))

637 
	`SET_IN6_LINKLOCAL_IFINDEX
 (
√xth›
->
v6_globÆ
, 0);

639 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
√xth›
->
v6_loˇl
)

640 && 
	`IN6_LINKLOCAL_IFINDEX
 (
√xth›
->
v6_loˇl
))

642 
	`SET_IN6_LINKLOCAL_IFINDEX
 (
√xth›
->
v6_loˇl
, 0);

646  
ªt
;

647 
	}
}

650 
	$bgp_zebø_™noun˚
 (
¥efix
 *
p
, 
bgp_öfo
 *
öfo
, 
bgp
 *bgp, 
ßfi_t
 
ßfi
)

652 
Êags
;

653 
u_ch¨
 
di°™˚
;

654 
≥î
 *peer;

655 
bgp_öfo
 *
mpöfo
;

656 
size_t
 
ﬁdsize
, 
√wsize
;

658 i‡(
z˛õ¡
->
sock
 < 0)

661 i‡(! 
z˛õ¡
->
ªdi°
[
ZEBRA_ROUTE_BGP
])

664 
Êags
 = 0;

665 
≥î
 = 
öfo
->peer;

667 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
 ||Öìr->s‹à=
BGP_PEER_CONFED
)

669 
	`SET_FLAG
 (
Êags
, 
ZEBRA_FLAG_IBGP
);

670 
	`SET_FLAG
 (
Êags
, 
ZEBRA_FLAG_INTERNAL
);

673 i‡((
≥î
->
s‹t
 =
BGP_PEER_EBGP
 &&Öìr->
âl
 != 1)

674 || 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DISABLE_CONNECTED_CHECK
))

675 
	`SET_FLAG
 (
Êags
, 
ZEBRA_FLAG_INTERNAL
);

678 i‡((
ﬁdsize
 = 
	`°ªam_gë_size
 (
bgp_√xth›_buf
)) <

679 ( (
ö_addr
 *Ë* (
	`bgp_öfo_m∑th_cou¡
 (
öfo
) + 1)))

681 
√wsize
 = ( (
ö_addr
 *Ë* (
	`bgp_öfo_m∑th_cou¡
 (
öfo
) + 1));

682 
√wsize
 = 
	`°ªam_ªsize
 (
bgp_√xth›_buf
,Çewsize);

683 i‡(
√wsize
 =
ﬁdsize
)

685 
	`zlog_îr
 ("can'tÑesizeÇexthop buffer");

690 
	`°ªam_ª£t
 (
bgp_√xth›_buf
);

692 i‡(
p
->
Ámûy
 =
AF_INET
)

694 
z≠i_ùv4
 
≠i
;

695 
ö_addr
 *
√xth›
;

697 
≠i
.
Êags
 = flags;

698 
√xth›
 = &
öfo
->
©å
->nexthop;

699 
	`°ªam_put
 (
bgp_√xth›_buf
, &
√xth›
,  (
ö_addr
 *));

700 
mpöfo
 = 
	`bgp_öfo_m∑th_fú°
 (
öfo
); mpinfo;

701 
mpöfo
 = 
	`bgp_öfo_m∑th_√xt
 (mpinfo))

703 
√xth›
 = &
mpöfo
->
©å
->nexthop;

704 
	`°ªam_put
 (
bgp_√xth›_buf
, &
√xth›
,  (
ö_addr
 *));

707 
≠i
.
ty≥
 = 
ZEBRA_ROUTE_BGP
;

708 
≠i
.
mesßge
 = 0;

709 
≠i
.
ßfi
 = safi;

710 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
);

711 
≠i
.
√xth›_num
 = 1 + 
	`bgp_öfo_m∑th_cou¡
 (
öfo
);

712 
≠i
.
√xth›
 = (
ö_addr
 **)
	`STREAM_DATA
 (
bgp_√xth›_buf
);

713 
≠i
.
ifödex_num
 = 0;

714 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
);

715 
≠i
.
mëric
 = 
öfo
->
©å
->
med
;

717 
di°™˚
 = 
	`bgp_di°™˚_≠∂y
 (
p
, 
öfo
, 
bgp
);

719 i‡(
di°™˚
)

721 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_DISTANCE
);

722 
≠i
.
di°™˚
 = distance;

725 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

727 
i
;

728 
buf
[2][
INET_ADDRSTRLEN
];

729 
	`zlog_debug
("Zebra send: IPv4Ñouteádd %s/%dÇexthop %s metric %u"

731 
	`öë_¡›
(
AF_INET
, &
p
->
u
.
¥efix4
, 
buf
[0], (buf[0])),

732 
p
->
¥efixÀn
,

733 
	`öë_¡›
(
AF_INET
, 
≠i
.
√xth›
[0], 
buf
[1], (buf[1])),

734 
≠i
.
mëric
,ápi.
√xth›_num
);

735 
i
 = 1; i < 
≠i
.
√xth›_num
; i++)

736 
	`zlog_debug
("Zebra send: IPv4Ñouteádd [nexthop %d] %s",

737 
i
, 
	`öë_¡›
(
AF_INET
, 
≠i
.
√xth›
[i], 
buf
[1],

738 (
buf
[1])));

741 
	`z≠i_ùv4_rouã
 (
ZEBRA_IPV4_ROUTE_ADD
, 
z˛õ¡
,

742 (
¥efix_ùv4
 *Ë
p
, &
≠i
);

744 #ifde‡
HAVE_IPV6


746 i‡(
p
->
Ámûy
 =
AF_INET6
)

748 
ifödex
;

749 
ö6_addr
 *
√xth›
;

750 
z≠i_ùv6
 
≠i
;

752 
ifödex
 = 0;

753 
√xth›
 = 
NULL
;

755 
	`as£π
 (
öfo
->
©å
->
exåa
);

758 i‡(
öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 == 16)

759 
√xth›
 = &
öfo
->
©å
->
exåa
->
mp_√xth›_globÆ
;

762 i‡(
öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 == 32)

765 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
öfo
->
©å
->
exåa
->
mp_√xth›_globÆ
)

766 && 
≥î
->
su_ªmŸe
->
ß
.
ß_Ámûy
 =
AF_INET6
)

767 
√xth›
 = &
≥î
->
su_ªmŸe
->
sö6
.
sö6_addr
;

769 
√xth›
 = &
öfo
->
©å
->
exåa
->
mp_√xth›_loˇl
;

771 i‡(
öfo
->
≥î
->
√xth›
.
iÂ
)

772 
ifödex
 = 
öfo
->
≥î
->
√xth›
.
iÂ
->ifindex;

775 i‡(
√xth›
 =
NULL
)

778 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (
√xth›
Ë&& ! 
ifödex
)

780 i‡(
öfo
->
≥î
->
i‚ame
)

781 
ifödex
 = 
	`if_«mëoödex
 (
öfo
->
≥î
->
i‚ame
);

782 i‡(
öfo
->
≥î
->
√xth›
.
iÂ
)

783 
ifödex
 = 
öfo
->
≥î
->
√xth›
.
iÂ
->ifindex;

787 
≠i
.
Êags
 = flags;

788 
≠i
.
ty≥
 = 
ZEBRA_ROUTE_BGP
;

789 
≠i
.
mesßge
 = 0;

790 
≠i
.
ßfi
 = safi;

791 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
);

792 
≠i
.
√xth›_num
 = 1;

793 
≠i
.
√xth›
 = &nexthop;

794 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_IFINDEX
);

795 
≠i
.
ifödex_num
 = 1;

796 
≠i
.
ifödex
 = &ifindex;

797 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
);

798 
≠i
.
mëric
 = 
öfo
->
©å
->
med
;

800 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

802 
buf
[2][
INET6_ADDRSTRLEN
];

803 
	`zlog_debug
("Zebra send: IPv6Ñouteádd %s/%dÇexthop %s metric %u",

804 
	`öë_¡›
(
AF_INET6
, &
p
->
u
.
¥efix6
, 
buf
[0], (buf[0])),

805 
p
->
¥efixÀn
,

806 
	`öë_¡›
(
AF_INET6
, 
√xth›
, 
buf
[1], (buf[1])),

807 
≠i
.
mëric
);

810 
	`z≠i_ùv6_rouã
 (
ZEBRA_IPV6_ROUTE_ADD
, 
z˛õ¡
,

811 (
¥efix_ùv6
 *Ë
p
, &
≠i
);

814 
	}
}

817 
	$bgp_zebø_wôhdøw
 (
¥efix
 *
p
, 
bgp_öfo
 *
öfo
, 
ßfi_t
 
ßfi
)

819 
Êags
;

820 
≥î
 *peer;

822 i‡(
z˛õ¡
->
sock
 < 0)

825 i‡(! 
z˛õ¡
->
ªdi°
[
ZEBRA_ROUTE_BGP
])

828 
≥î
 = 
öfo
->peer;

829 
Êags
 = 0;

831 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

833 
	`SET_FLAG
 (
Êags
, 
ZEBRA_FLAG_INTERNAL
);

834 
	`SET_FLAG
 (
Êags
, 
ZEBRA_FLAG_IBGP
);

837 i‡((
≥î
->
s‹t
 =
BGP_PEER_EBGP
 &&Öìr->
âl
 != 1)

838 || 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DISABLE_CONNECTED_CHECK
))

839 
	`SET_FLAG
 (
Êags
, 
ZEBRA_FLAG_INTERNAL
);

841 i‡(
p
->
Ámûy
 =
AF_INET
)

843 
z≠i_ùv4
 
≠i
;

844 
ö_addr
 *
√xth›
;

846 
≠i
.
Êags
 = flags;

847 
√xth›
 = &
öfo
->
©å
->nexthop;

849 
≠i
.
ty≥
 = 
ZEBRA_ROUTE_BGP
;

850 
≠i
.
mesßge
 = 0;

851 
≠i
.
ßfi
 = safi;

852 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
);

853 
≠i
.
√xth›_num
 = 1;

854 
≠i
.
√xth›
 = &nexthop;

855 
≠i
.
ifödex_num
 = 0;

856 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
);

857 
≠i
.
mëric
 = 
öfo
->
©å
->
med
;

859 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

861 
buf
[2][
INET_ADDRSTRLEN
];

862 
	`zlog_debug
("Zebra send: IPv4Ñoute delete %s/%dÇexthop %s metric %u",

863 
	`öë_¡›
(
AF_INET
, &
p
->
u
.
¥efix4
, 
buf
[0], (buf[0])),

864 
p
->
¥efixÀn
,

865 
	`öë_¡›
(
AF_INET
, 
√xth›
, 
buf
[1], (buf[1])),

866 
≠i
.
mëric
);

869 
	`z≠i_ùv4_rouã
 (
ZEBRA_IPV4_ROUTE_DELETE
, 
z˛õ¡
,

870 (
¥efix_ùv4
 *Ë
p
, &
≠i
);

872 #ifde‡
HAVE_IPV6


874 i‡(
p
->
Ámûy
 =
AF_INET6
)

876 
z≠i_ùv6
 
≠i
;

877 
ifödex
;

878 
ö6_addr
 *
√xth›
;

880 
	`as£π
 (
öfo
->
©å
->
exåa
);

882 
ifödex
 = 0;

883 
√xth›
 = 
NULL
;

886 i‡(
öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 == 16)

887 
√xth›
 = &
öfo
->
©å
->
exåa
->
mp_√xth›_globÆ
;

890 i‡(
öfo
->
©å
->
exåa
->
mp_√xth›_Àn
 == 32)

892 
√xth›
 = &
öfo
->
©å
->
exåa
->
mp_√xth›_loˇl
;

893 i‡(
öfo
->
≥î
->
√xth›
.
iÂ
)

894 
ifödex
 = 
öfo
->
≥î
->
√xth›
.
iÂ
->ifindex;

897 i‡(
√xth›
 =
NULL
)

900 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (
√xth›
Ë&& ! 
ifödex
)

901 i‡(
öfo
->
≥î
->
i‚ame
)

902 
ifödex
 = 
	`if_«mëoödex
 (
öfo
->
≥î
->
i‚ame
);

904 
≠i
.
Êags
 = flags;

905 
≠i
.
ty≥
 = 
ZEBRA_ROUTE_BGP
;

906 
≠i
.
mesßge
 = 0;

907 
≠i
.
ßfi
 = safi;

908 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
);

909 
≠i
.
√xth›_num
 = 1;

910 
≠i
.
√xth›
 = &nexthop;

911 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_IFINDEX
);

912 
≠i
.
ifödex_num
 = 1;

913 
≠i
.
ifödex
 = &ifindex;

914 
	`SET_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
);

915 
≠i
.
mëric
 = 
öfo
->
©å
->
med
;

917 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

919 
buf
[2][
INET6_ADDRSTRLEN
];

920 
	`zlog_debug
("Zebra send: IPv6Ñoute delete %s/%dÇexthop %s metric %u",

921 
	`öë_¡›
(
AF_INET6
, &
p
->
u
.
¥efix6
, 
buf
[0], (buf[0])),

922 
p
->
¥efixÀn
,

923 
	`öë_¡›
(
AF_INET6
, 
√xth›
, 
buf
[1], (buf[1])),

924 
≠i
.
mëric
);

927 
	`z≠i_ùv6_rouã
 (
ZEBRA_IPV6_ROUTE_DELETE
, 
z˛õ¡
,

928 (
¥efix_ùv6
 *Ë
p
, &
≠i
);

931 
	}
}

935 
	$bgp_ªdi°ribuã_£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ty≥
)

938 
bgp
->
ªdi°
[
afi
][
ty≥
] = 1;

941 i‡(
z˛õ¡
->
ªdi°
[
ty≥
])

942  
CMD_WARNING
;

944 
z˛õ¡
->
ªdi°
[
ty≥
] = 1;

947 i‡(
z˛õ¡
->
sock
 < 0)

948  
CMD_WARNING
;

950 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

951 
	`zlog_debug
("Zebø síd:Ñedi°ribuãádd %s", 
	`zebø_rouã_°rög
(
ty≥
));

954 
	`zebø_ªdi°ribuã_£nd
 (
ZEBRA_REDISTRIBUTE_ADD
, 
z˛õ¡
, 
ty≥
);

956  
CMD_SUCCESS
;

957 
	}
}

961 
	$bgp_ªdi°ribuã_rm≠_£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ty≥
,

962 c⁄° *
«me
)

964 i‡(
bgp
->
rm≠
[
afi
][
ty≥
].
«me


965 && (
	`°rcmp
 (
bgp
->
rm≠
[
afi
][
ty≥
].
«me
,Çame) == 0))

968 i‡(
bgp
->
rm≠
[
afi
][
ty≥
].
«me
)

969 
	`‰ì
 (
bgp
->
rm≠
[
afi
][
ty≥
].
«me
);

970 
bgp
->
rm≠
[
afi
][
ty≥
].
«me
 = 
	`°rdup
 (name);

971 
bgp
->
rm≠
[
afi
][
ty≥
].
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (
«me
);

974 
	}
}

978 
	$bgp_ªdi°ribuã_mëric_£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ty≥
,

979 
u_öt32_t
 
mëric
)

981 i‡(
bgp
->
ªdi°_mëric_Êag
[
afi
][
ty≥
]

982 && 
bgp
->
ªdi°_mëric
[
afi
][
ty≥
] =
mëric
)

985 
bgp
->
ªdi°_mëric_Êag
[
afi
][
ty≥
] = 1;

986 
bgp
->
ªdi°_mëric
[
afi
][
ty≥
] = 
mëric
;

989 
	}
}

993 
	$bgp_ªdi°ribuã_un£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ty≥
)

996 
bgp
->
ªdi°
[
afi
][
ty≥
] = 0;

999 i‡(
bgp
->
rm≠
[
afi
][
ty≥
].
«me
)

1000 
	`‰ì
 (
bgp
->
rm≠
[
afi
][
ty≥
].
«me
);

1001 
bgp
->
rm≠
[
afi
][
ty≥
].
«me
 = 
NULL
;

1002 
bgp
->
rm≠
[
afi
][
ty≥
].
m≠
 = 
NULL
;

1005 
bgp
->
ªdi°_mëric_Êag
[
afi
][
ty≥
] = 0;

1006 
bgp
->
ªdi°_mëric
[
afi
][
ty≥
] = 0;

1009 i‡(! 
z˛õ¡
->
ªdi°
[
ty≥
])

1010  
CMD_WARNING
;

1011 
z˛õ¡
->
ªdi°
[
ty≥
] = 0;

1013 i‡(
bgp
->
ªdi°
[
AFI_IP
][
ty≥
] == 0

1014 && 
bgp
->
ªdi°
[
AFI_IP6
][
ty≥
] == 0

1015 && 
z˛õ¡
->
sock
 >= 0)

1018 i‡(
	`BGP_DEBUG
(
zebø
, 
ZEBRA
))

1019 
	`zlog_debug
("Zebra send:Ñedistribute delete %s",

1020 
	`zebø_rouã_°rög
(
ty≥
));

1021 
	`zebø_ªdi°ribuã_£nd
 (
ZEBRA_REDISTRIBUTE_DELETE
, 
z˛õ¡
, 
ty≥
);

1025 
	`bgp_ªdi°ribuã_wôhdøw
 (
bgp
, 
afi
, 
ty≥
);

1027  
CMD_SUCCESS
;

1028 
	}
}

1032 
	$bgp_ªdi°ribuã_rouãm≠_un£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ty≥
)

1034 i‡(! 
bgp
->
rm≠
[
afi
][
ty≥
].
«me
)

1038 
	`‰ì
 (
bgp
->
rm≠
[
afi
][
ty≥
].
«me
);

1039 
bgp
->
rm≠
[
afi
][
ty≥
].
«me
 = 
NULL
;

1040 
bgp
->
rm≠
[
afi
][
ty≥
].
m≠
 = 
NULL
;

1043 
	}
}

1047 
	$bgp_ªdi°ribuã_mëric_un£t
 (
bgp
 *bgp, 
afi_t
 
afi
, 
ty≥
)

1049 i‡(! 
bgp
->
ªdi°_mëric_Êag
[
afi
][
ty≥
])

1053 
bgp
->
ªdi°_mëric_Êag
[
afi
][
ty≥
] = 0;

1054 
bgp
->
ªdi°_mëric
[
afi
][
ty≥
] = 0;

1057 
	}
}

1060 
	$bgp_z˛õ¡_ª£t
 ()

1062 
	`z˛õ¡_ª£t
 (
z˛õ¡
);

1063 
	}
}

1066 
	$bgp_zebø_öô
 ()

1069 
z˛õ¡
 = 
	`z˛õ¡_√w
 ();

1070 
	`z˛õ¡_öô
 (
z˛õ¡
, 
ZEBRA_ROUTE_BGP
);

1071 
z˛õ¡
->
rouãr_id_upd©e
 = 
bgp_rouãr_id_upd©e
;

1072 
z˛õ¡
->
öãrÁ˚_add
 = 
bgp_öãrÁ˚_add
;

1073 
z˛õ¡
->
öãrÁ˚_dñëe
 = 
bgp_öãrÁ˚_dñëe
;

1074 
z˛õ¡
->
öãrÁ˚_addªss_add
 = 
bgp_öãrÁ˚_addªss_add
;

1075 
z˛õ¡
->
öãrÁ˚_addªss_dñëe
 = 
bgp_öãrÁ˚_addªss_dñëe
;

1076 
z˛õ¡
->
ùv4_rouã_add
 = 
zebø_ªad_ùv4
;

1077 
z˛õ¡
->
ùv4_rouã_dñëe
 = 
zebø_ªad_ùv4
;

1078 
z˛õ¡
->
öãrÁ˚_up
 = 
bgp_öãrÁ˚_up
;

1079 
z˛õ¡
->
öãrÁ˚_down
 = 
bgp_öãrÁ˚_down
;

1080 #ifde‡
HAVE_IPV6


1081 
z˛õ¡
->
ùv6_rouã_add
 = 
zebø_ªad_ùv6
;

1082 
z˛õ¡
->
ùv6_rouã_dñëe
 = 
zebø_ªad_ùv6
;

1086 
	`if_öô
 ();

1088 
bgp_√xth›_buf
 = 
	`°ªam_√w
(
BGP_NEXTHOP_BUF_SIZE
);

1089 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_zebra.h

21 #i‚de‡
_QUAGGA_BGP_ZEBRA_H


22 
	#_QUAGGA_BGP_ZEBRA_H


	)

24 
	#BGP_NEXTHOP_BUF_SIZE
 (8 *  (
ö_addr
 *))

	)

26 
°ªam
 *
bgp_√xth›_buf
;

28 
bgp_zebø_öô
 ();

29 
bgp_if_upd©e_Æl
 ();

30 
bgp_c⁄fig_wrôe_max∑ths
 (
vty
 *, 
bgp
 *, 
afi_t
,

31 
ßfi_t
, *);

32 
bgp_c⁄fig_wrôe_ªdi°ribuã
 (
vty
 *, 
bgp
 *, 
afi_t
, 
ßfi_t
,

34 
bgp_zebø_™noun˚
 (
¥efix
 *, 
bgp_öfo
 *, 
bgp
 *, 
ßfi_t
);

35 
bgp_zebø_wôhdøw
 (
¥efix
 *, 
bgp_öfo
 *, 
ßfi_t
);

37 
bgp_ªdi°ribuã_£t
 (
bgp
 *, 
afi_t
, );

38 
bgp_ªdi°ribuã_rm≠_£t
 (
bgp
 *, 
afi_t
, , const *);

39 
bgp_ªdi°ribuã_mëric_£t
 (
bgp
 *, 
afi_t
, , 
u_öt32_t
);

40 
bgp_ªdi°ribuã_un£t
 (
bgp
 *, 
afi_t
, );

41 
bgp_ªdi°ribuã_rouãm≠_un£t
 (
bgp
 *, 
afi_t
, );

42 
bgp_ªdi°ribuã_mëric_un£t
 (
bgp
 *, 
afi_t
, );

44 
öãrÁ˚
 *
if_lookup_by_ùv4
 (
ö_addr
 *);

45 
öãrÁ˚
 *
if_lookup_by_ùv4_exa˘
 (
ö_addr
 *);

46 #ifde‡
HAVE_IPV6


47 
öãrÁ˚
 *
if_lookup_by_ùv6
 (
ö6_addr
 *);

48 
öãrÁ˚
 *
if_lookup_by_ùv6_exa˘
 (
ö6_addr
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgpd.c

21 
	~<zebø.h
>

23 
	~"¥efix.h
"

24 
	~"thªad.h
"

25 
	~"buf„r.h
"

26 
	~"°ªam.h
"

27 
	~"comm™d.h
"

28 
	~"sockuni⁄.h
"

29 
	~"√tw‹k.h
"

30 
	~"mem‹y.h
"

31 
	~"fûãr.h
"

32 
	~"rouãm≠.h
"

33 
	~"°r.h
"

34 
	~"log.h
"

35 
	~"∂i°.h
"

36 
	~"lökli°.h
"

37 
	~"w‹kqueue.h
"

39 
	~"bgpd/bgpd.h
"

40 
	~"bgpd/bgp_èbÀ.h
"

41 
	~"bgpd/bgp_a•©h.h
"

42 
	~"bgpd/bgp_rouã.h
"

43 
	~"bgpd/bgp_dump.h
"

44 
	~"bgpd/bgp_debug.h
"

45 
	~"bgpd/bgp_communôy.h
"

46 
	~"bgpd/bgp_©å.h
"

47 
	~"bgpd/bgp_ªgex.h
"

48 
	~"bgpd/bgp_˛i°.h
"

49 
	~"bgpd/bgp_fsm.h
"

50 
	~"bgpd/bgp_∑ckë.h
"

51 
	~"bgpd/bgp_zebø.h
"

52 
	~"bgpd/bgp_›í.h
"

53 
	~"bgpd/bgp_fûãr.h
"

54 
	~"bgpd/bgp_√xth›.h
"

55 
	~"bgpd/bgp_damp.h
"

56 
	~"bgpd/bgp_m∂sv≤.h
"

57 
	~"bgpd/bgp_advîti£.h
"

58 
	~"bgpd/bgp_√tw‹k.h
"

59 
	~"bgpd/bgp_vty.h
"

60 
	~"bgpd/bgp_m∑th.h
"

61 #ifde‡
HAVE_SNMP


62 
	~"bgpd/bgp_¢mp.h
"

65 #ifde‡
USE_SRX


66 
	~"bgpd/bgp_öfo_hash.h
"

67 
	~"bgpd/bgp_vÆid©e.h
"

69 #i‡
deföed
(
__TIME_MEASURE__
)

74 
boﬁ
 
h™dÀSRxVÆid©i⁄Resu…
 (
SRxUpd©eID
 
upd©eID
, 
uöt32_t
 
loˇlID
,

75 
VÆid©i⁄Resu…Ty≥
 
vÆTy≥
,

76 
uöt8_t
 
rﬂResu…
, uöt8_à
bgp£cResu…
,

77 * 
bgpRouãr
);

78 
h™dÀSRxSig«tuªs
(
SRxUpd©eID
 
upd©eID
, 
BGPSecCÆlbackD©a
* 
d©a
,

79 * 
bgpRouãr
);

80 
h™dÀSRxSynchReque°
(* 
bgpRouãr
);

81 
h™dÀSRxMesßges
(
SRxProxyCommCode
 
maöCode
, 
subCode
, * 
u£rPå
);

82 
§x_£t_deÁu…
(
bgp
 *bgp);

83 
ª•awnRe˚ivePackë
(
thªad
 *
t
);

87 
bgp_ma°î
 
	gbgp_ma°î
;

89 
ö_addr
 
rouãr_id_zebø
;

92 
bgp_ma°î
 *
	gbm
;

95 
communôy_li°_h™dÀr
 *
	gbgp_˛i°
;

99 
	$bgp_›ti⁄_£t
 (
Êag
)

101 
Êag
)

103 
BGP_OPT_NO_FIB
:

104 
BGP_OPT_MULTIPLE_INSTANCE
:

105 
BGP_OPT_CONFIG_CISCO
:

106 
BGP_OPT_NO_LISTEN
:

107 
	`SET_FLAG
 (
bm
->
›ti⁄s
, 
Êag
);

110  
BGP_ERR_INVALID_FLAG
;

113 
	}
}

116 
	$bgp_›ti⁄_un£t
 (
Êag
)

118 
Êag
)

120 
BGP_OPT_MULTIPLE_INSTANCE
:

121 i‡(
	`li°cou¡
 (
bm
->
bgp
) > 1)

122  
BGP_ERR_MULTIPLE_INSTANCE_USED
;

124 
BGP_OPT_NO_FIB
:

125 
BGP_OPT_CONFIG_CISCO
:

126 
	`UNSET_FLAG
 (
bm
->
›ti⁄s
, 
Êag
);

129  
BGP_ERR_INVALID_FLAG
;

132 
	}
}

135 
	$bgp_›ti⁄_check
 (
Êag
)

137  
	`CHECK_FLAG
 (
bm
->
›ti⁄s
, 
Êag
);

138 
	}
}

142 
	$bgp_Êag_£t
 (
bgp
 *bgp, 
Êag
)

144 
	`SET_FLAG
 (
bgp
->
Êags
, 
Êag
);

146 
	}
}

149 
	$bgp_Êag_un£t
 (
bgp
 *bgp, 
Êag
)

151 
	`UNSET_FLAG
 (
bgp
->
Êags
, 
Êag
);

153 
	}
}

156 
	$bgp_Êag_check
 (
bgp
 *bgp, 
Êag
)

158  
	`CHECK_FLAG
 (
bgp
->
Êags
, 
Êag
);

159 
	}
}

163 
	$bgp_c⁄fig_£t
 (
bgp
 *bgp, 
c⁄fig
)

165 
	`SET_FLAG
 (
bgp
->
c⁄fig
, config);

166 
	}
}

169 
	$bgp_c⁄fig_un£t
 (
bgp
 *bgp, 
c⁄fig
)

171 
	`UNSET_FLAG
 (
bgp
->
c⁄fig
, config);

172 
	}
}

175 
	$bgp_c⁄fig_check
 (
bgp
 *bgp, 
c⁄fig
)

177  
	`CHECK_FLAG
 (
bgp
->
c⁄fig
, config);

178 
	}
}

180 #ifde‡
USE_SRX


187 
	$§x_c⁄fig_£t
 (
bgp
 *bgp, 
Êags
)

189 
	`SET_FLAG
 (
bgp
->
§x_c⁄fig
, 
Êags
);

190 
	}
}

198 
	$§x_c⁄fig_un£t
 (
bgp
 *bgp, 
Êags
)

200 
	`UNSET_FLAG
 (
bgp
->
§x_c⁄fig
, 
Êags
);

201 
	}
}

210 
	$§x_c⁄fig_check
 (
bgp
 *bgp, 
uöt16_t
 
Êags
)

212  (
bgp
->
§x_c⁄fig
 & 
Êags
) == flags;

213 
	}
}

225 
	$§x_£t_¥oxyID
(
bgp
* bgp, 
uöt32_t
 
¥oxyID
)

227 
ªtVÆ
 = 
CMD_SUCCESS
;

228 i‡(!
	`isC⁄√˘ed
(
bgp
->
§xProxy
))

230 
bgp
->
§x_¥oxyID
 = 
¥oxyID
;

231 i‡(
bgp
->
§xProxy
 !
NULL
)

234 
bgp
->
§xProxy
->
¥oxyID
 = bgp->
§x_¥oxyID
;

239 
ªtVÆ
 = 
CMD_WARNING
;

242  
ªtVÆ
;

243 
	}
}

249 
	$bgp_rouãr_id_£t
 (
bgp
 *bgp, 
ö_addr
 *
id
)

251 
≥î
 *peer;

252 
li°node
 *
node
, *
¬ode
;

254 i‡(
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_ROUTER_ID
)

255 && 
	`IPV4_ADDR_SAME
 (&
bgp
->
rouãr_id
, 
id
))

258 
	`IPV4_ADDR_COPY
 (&
bgp
->
rouãr_id
, 
id
);

259 
	`bgp_c⁄fig_£t
 (
bgp
, 
BGP_CONFIG_ROUTER_ID
);

262 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

264 
	`IPV4_ADDR_COPY
 (&
≥î
->
loˇl_id
, 
id
);

266 i‡(
≥î
->
°©us
 =
E°ablished
)

268 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_RID_CHANGE
;

269 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

270 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

273 #ifde‡
USE_SRX


274 i‡(
bgp
->
§x_¥oxyID
 == 0)

276 
	`§x_£t_¥oxyID
(
bgp
, 
	`¡ohl
(bgp->
rouãr_id
.
s_addr
));

280 
	}
}

284 
	$bgp_˛u°î_id_£t
 (
bgp
 *bgp, 
ö_addr
 *
˛u°î_id
)

286 
≥î
 *peer;

287 
li°node
 *
node
, *
¬ode
;

289 i‡(
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_CLUSTER_ID
)

290 && 
	`IPV4_ADDR_SAME
 (&
bgp
->
˛u°î_id
, cluster_id))

293 
	`IPV4_ADDR_COPY
 (&
bgp
->
˛u°î_id
, cluster_id);

294 
	`bgp_c⁄fig_£t
 (
bgp
, 
BGP_CONFIG_CLUSTER_ID
);

297 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

299 i‡(
≥î
->
s‹t
 !
BGP_PEER_IBGP
)

302 i‡(
≥î
->
°©us
 =
E°ablished
)

304 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CLID_CHANGE
;

305 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

306 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

310 
	}
}

313 
	$bgp_˛u°î_id_un£t
 (
bgp
 *bgp)

315 
≥î
 *peer;

316 
li°node
 *
node
, *
¬ode
;

318 i‡(! 
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_CLUSTER_ID
))

321 
bgp
->
˛u°î_id
.
s_addr
 = 0;

322 
	`bgp_c⁄fig_un£t
 (
bgp
, 
BGP_CONFIG_CLUSTER_ID
);

325 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

327 i‡(
≥î
->
s‹t
 !
BGP_PEER_IBGP
)

330 i‡(
≥î
->
°©us
 =
E°ablished
)

332 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CLID_CHANGE
;

333 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

334 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

338 
	}
}

343 
time_t
 
	$bgp_˛ock
 ()

345 
timevÆ
 
tv
;

347 
	`quagga_gëtime
(
QUAGGA_CLK_MONOTONIC
, &
tv
);

348  
tv
.
tv_£c
;

349 
	}
}

353 
	$bgp_timîs_£t
 (
bgp
 *bgp, 
u_öt32_t
 
kì∑live
, u_öt32_à
hﬁdtime
)

355 
bgp
->
deÁu…_kì∑live
 = (
kì∑live
 < 
hﬁdtime
 / 3

356 ? 
kì∑live
 : 
hﬁdtime
 / 3);

357 
bgp
->
deÁu…_hﬁdtime
 = 
hﬁdtime
;

360 
	}
}

363 
	$bgp_timîs_un£t
 (
bgp
 *bgp)

365 
bgp
->
deÁu…_kì∑live
 = 
BGP_DEFAULT_KEEPALIVE
;

366 
bgp
->
deÁu…_hﬁdtime
 = 
BGP_DEFAULT_HOLDTIME
;

369 
	}
}

373 
	$bgp_c⁄„dî©i⁄_id_£t
 (
bgp
 *bgp, 
as_t
 
as
)

375 
≥î
 *peer;

376 
li°node
 *
node
, *
¬ode
;

377 
Æªady_c⁄„d
;

379 i‡(
as
 == 0)

380  
BGP_ERR_INVALID_AS
;

383 
Æªady_c⁄„d
 = 
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_CONFEDERATION
);

384 
bgp
->
c⁄„d_id
 = 
as
;

385 
	`bgp_c⁄fig_£t
 (
bgp
, 
BGP_CONFIG_CONFEDERATION
);

390 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

394 i‡(
Æªady_c⁄„d
)

396 i‡(
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_EBGP
)

398 
≥î
->
loˇl_as
 = 
as
;

399 i‡(
≥î
->
°©us
 =
E°ablished
)

401 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CONFED_ID_CHANGE
;

402 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

403 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

407 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

414 i‡(
	`≥î_s‹t
 (
≥î
Ë!
BGP_PEER_IBGP
)

417 i‡(
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_EBGP
)

418 
≥î
->
loˇl_as
 = 
as
;

419 i‡(
≥î
->
°©us
 =
E°ablished
)

421 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CONFED_ID_CHANGE
;

422 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

423 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

426 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

431 
	}
}

434 
	$bgp_c⁄„dî©i⁄_id_un£t
 (
bgp
 *bgp)

436 
≥î
 *peer;

437 
li°node
 *
node
, *
¬ode
;

439 
bgp
->
c⁄„d_id
 = 0;

440 
	`bgp_c⁄fig_un£t
 (
bgp
, 
BGP_CONFIG_CONFEDERATION
);

442 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

445 i‡(
	`≥î_s‹t
 (
≥î
Ë!
BGP_PEER_IBGP
)

447 
≥î
->
loˇl_as
 = 
bgp
->
as
;

448 i‡(
≥î
->
°©us
 =
E°ablished
)

450 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CONFED_ID_CHANGE
;

451 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

452 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

456 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

460 
	}
}

464 
	$bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
 *bgp, 
as_t
 
as
)

466 
i
;

468 i‡(! 
bgp
)

471 
i
 = 0; i < 
bgp
->
c⁄„d_≥îs_˙t
; i++)

472 i‡(
bgp
->
c⁄„d_≥îs
[
i
] =
as
)

476 
	}
}

480 
	$bgp_c⁄„dî©i⁄_≥îs_add
 (
bgp
 *bgp, 
as_t
 
as
)

482 
≥î
 *peer;

483 
li°node
 *
node
, *
¬ode
;

485 i‡(! 
bgp
)

486  
BGP_ERR_INVALID_BGP
;

488 i‡(
bgp
->
as
 ==ás)

489  
BGP_ERR_INVALID_AS
;

491 i‡(
	`bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
, 
as
))

494 i‡(
bgp
->
c⁄„d_≥îs
)

495 
bgp
->
c⁄„d_≥îs
 = 
	`XREALLOC
 (
MTYPE_BGP_CONFED_LIST
,

496 
bgp
->
c⁄„d_≥îs
,

497 (
bgp
->
c⁄„d_≥îs_˙t
 + 1Ë*  (
as_t
));

499 
bgp
->
c⁄„d_≥îs
 = 
	`XMALLOC
 (
MTYPE_BGP_CONFED_LIST
,

500 (
bgp
->
c⁄„d_≥îs_˙t
 + 1Ë*  (
as_t
));

502 
bgp
->
c⁄„d_≥îs
[bgp->
c⁄„d_≥îs_˙t
] = 
as
;

503 
bgp
->
c⁄„d_≥îs_˙t
++;

505 i‡(
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_CONFEDERATION
))

507 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

509 i‡(
≥î
->
as
 ==ás)

511 
≥î
->
loˇl_as
 = 
bgp
->
as
;

512 i‡(
≥î
->
°©us
 =
E°ablished
)

514 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CONFED_PEER_CHANGE
;

515 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

516 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

519 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

524 
	}
}

528 
	$bgp_c⁄„dî©i⁄_≥îs_ªmove
 (
bgp
 *bgp, 
as_t
 
as
)

530 
i
;

531 
j
;

532 
≥î
 *peer;

533 
li°node
 *
node
, *
¬ode
;

535 i‡(! 
bgp
)

538 i‡(! 
	`bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
, 
as
))

541 
i
 = 0; i < 
bgp
->
c⁄„d_≥îs_˙t
; i++)

542 i‡(
bgp
->
c⁄„d_≥îs
[
i
] =
as
)

543 
j
 = 
i
 + 1; j < 
bgp
->
c⁄„d_≥îs_˙t
; j++)

544 
bgp
->
c⁄„d_≥îs
[
j
 - 1] = bgp->confed_peers[j];

546 
bgp
->
c⁄„d_≥îs_˙t
--;

548 i‡(
bgp
->
c⁄„d_≥îs_˙t
 == 0)

550 i‡(
bgp
->
c⁄„d_≥îs
)

551 
	`XFREE
 (
MTYPE_BGP_CONFED_LIST
, 
bgp
->
c⁄„d_≥îs
);

552 
bgp
->
c⁄„d_≥îs
 = 
NULL
;

555 
bgp
->
c⁄„d_≥îs
 = 
	`XREALLOC
 (
MTYPE_BGP_CONFED_LIST
,

556 
bgp
->
c⁄„d_≥îs
,

557 
bgp
->
c⁄„d_≥îs_˙t
 *  (
as_t
));

561 i‡(
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_CONFEDERATION
))

563 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

565 i‡(
≥î
->
as
 ==ás)

567 
≥î
->
loˇl_as
 = 
bgp
->
c⁄„d_id
;

568 i‡(
≥î
->
°©us
 =
E°ablished
)

570 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CONFED_PEER_CHANGE
;

571 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

572 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

575 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

581 
	}
}

585 
	$bgp_deÁu…_loˇl_¥e„ªn˚_£t
 (
bgp
 *bgp, 
u_öt32_t
 
loˇl_¥ef
)

587 i‡(! 
bgp
)

590 
bgp
->
deÁu…_loˇl_¥ef
 = 
loˇl_¥ef
;

593 
	}
}

596 
	$bgp_deÁu…_loˇl_¥e„ªn˚_un£t
 (
bgp
 *bgp)

598 i‡(! 
bgp
)

601 
bgp
->
deÁu…_loˇl_¥ef
 = 
BGP_DEFAULT_LOCAL_PREF
;

604 
	}
}

606 #ifde‡
USE_SRX


617 
	$§x_c⁄√˘_¥oxy
(
bgp
 *bgp)

619 
˛õ¡FD
 = -1;

620 
boﬁ
 
c⁄√˘ed
 = 
Ál£
;

625 i‡(
g_rq
 !
NULL
)

627 #ifde‡
USE_GRPC


628 
c⁄√˘ed
 = 
	`c⁄√˘ToSRx_gΩc
(
bgp
->
§xProxy
, bgp->
§x_ho°
, bgp->
§x_p‹t
,

629 
bgp
->
§x_h™dshakeTimeout
, 
Ál£
);

631 i‡(
c⁄√˘ed
)

633 i‡–
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

634 
	`zlog_öfo
 ("\033[92m""Enabled Distributed Evaluation on SRx server <GRPC>""\033[0m" );

639 
c⁄√˘ed
 = 
	`c⁄√˘ToSRx
 (
bgp
->
§xProxy
, bgp->
§x_ho°
, bgp->
§x_p‹t
,

640 
bgp
->
§x_h™dshakeTimeout
, 
åue
);

641 i‡(
c⁄√˘ed
)

643 
g_rq
->
¥oxy
 = 
bgp
->
§xProxy
;

644 
˛õ¡FD
 = 
	`gëI¡î«lSockëFD
(
bgp
->
§xProxy
, 
åue
);

646 
g_rq
->
t_ªad
 = 
	`thªad_add_ªad
 (
bm
->
ma°î
, 
ª•awnRe˚ivePackë
,

647 
g_rq
, 
˛õ¡FD
);

648 
bgp
->
§x_¥oxyID
 = bgp->
§xProxy
->
¥oxyID
;

649 
	`zlog_öfo
 ("C⁄√˘ÅÿSRx sîvî %s:%d", 
bgp
->
§x_ho°
, bgp->
§x_p‹t
);

651 i‡–
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

653 
	`zlog_öfo
 ("\033[92m""Enabled Distributed Evaluation on SRx server""\033[0m" );

658 
	`zlog_îr
 ("CouldÇot connectÅo SRx serverát %s:%d, check if server is "

659 "ru¬ög", 
bgp
->
§x_ho°
, bgp->
§x_p‹t
);

664  
c⁄√˘ed
 ? 0 : 1;

665 
	}
}

679 
	$bgp_§x_£t
(
bgp
 *bgp, 
vty
 *vty,

680 c⁄° *
ho°
, 
p‹t
, 
boﬁ
 
doC⁄√˘
)

682 
¥ev_£t
, 
ßme_ho°
 = 0;

684 
¥ev_£t
 = 
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_SRX
);

685 
	`zlog_debug
(" bg∞¥eviou†c⁄fig_Æªady_£àcheckög %d \n", 
¥ev_£t
);

687 i‡(
	`isC⁄√˘ed
(
bgp
->
§xProxy
))

689 
	`vty_out
 (
vty
, "%% Already connectedÅo SRx-server. Disconnect first!%s",

690 
VTY_NEWLINE
);

691  
CMD_WARNING
;

694 i‡(
¥ev_£t
)

696 
ßme_ho°
 = (
	`°rcmp
 (
bgp
->
§x_ho°
, 
ho°
) == 0);

699 i‡(!
ßme_ho°
)

701 
	`XFREE
 (
MTYPE_SRX_HOST
, 
bgp
->
§x_ho°
);

705 
	`bgp_c⁄fig_£t
 (
bgp
, 
BGP_CONFIG_SRX
);

706 i‡(!
ßme_ho°
)

708 
bgp
->
§x_ho°
 = 
	`XSTRDUP
 (
MTYPE_SRX_HOST
, 
ho°
);

710 
bgp
->
§x_p‹t
 = 
p‹t
;

712 i‡(
bgp
->
§xProxy
 !
NULL
)

714 
¥oxyID°r
[20];

715 
pc⁄fID°r
[20];

716 
	`mem£t
(
¥oxyID°r
, '\0', 20);

717 
	`mem£t
(
pc⁄fID°r
, '\0', 20);

718 
	`•rötf
(
¥oxyID°r
, "%u.%u.%u.%u",

719 (
bgp
->
§xProxy
->
¥oxyID
 >> 24) & 0xFF,

720 (
bgp
->
§xProxy
->
¥oxyID
 >> 16) & 0xFF,

721 (
bgp
->
§xProxy
->
¥oxyID
 >> 8) & 0xFF,

722 
bgp
->
§xProxy
->
¥oxyID
 & 0xFF);

723 
	`•rötf
(
pc⁄fID°r
, "%u.%u.%u.%u",

724 (
bgp
->
§x_¥oxyID
 >> 24) & 0xFF,

725 (
bgp
->
§x_¥oxyID
 >> 16) & 0xFF,

726 (
bgp
->
§x_¥oxyID
 >> 8) & 0xFF,

727 
bgp
->
§x_¥oxyID
 & 0xFF);

729 
	`zlog_debug
(" cuºíà§x_¥oxy_id: %†(%uË", 
¥oxyID°r
,

730 
bgp
->
§xProxy
->
¥oxyID
);

732 
	`zlog_debug
(" Proxy instantiated withÖroxy id %s (%u)ánd configured "

733 "wôhÖroxy id %†(%u)\n",
¥oxyID°r
, 
bgp
->
§xProxy
->
¥oxyID
,

734 
pc⁄fID°r
, 
bgp
->
§x_¥oxyID
);

737 i‡(
doC⁄√˘
)

740 i‡(
	`§x_c⁄√˘_¥oxy
(
bgp
) == 1)

745 
ÊagDoC⁄√˘Srx
 = 
bgp
;

750  
CMD_SUCCESS
;

751 
	}
}

761 
	$bgp_§x_un£t
 (
bgp
 *bgp)

763 
ªtVÆ
 = 0;

765 i‡(
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_SRX
))

767 
	`bgp_c⁄fig_un£t
 (
bgp
, 
BGP_CONFIG_SRX
);

768 
	`XFREE
 (
MTYPE_SRX_HOST
, 
bgp
->
§x_ho°
);

770 if(
g_rq
->
t_ªad
)

772 
	`zlog_debug
 ("%†thªad c™˚l", 
__FUNCTION__
);

773 
	`thªad_ˇn˚l
(
g_rq
->
t_ªad
);

776 
	`disc⁄√˘FromSRx
 (
bgp
->
§xProxy
, bgp->
§x_kìpWödow
);

780 
	`zlog_öfo
("BGP session isÇot connectedÅoán SRx server!");

781 
ªtVÆ
 = -1;

784  
ªtVÆ
;

785 
	}
}

794 
	$bgp_§x_evÆu©i⁄
 (
bgp
 *bgp, 
mode
)

796 
mode
)

799 
	`§x_c⁄fig_un£t
 (
bgp
, 
SRX_CONFIG_EVAL_DISTR
);

801 
SRX_CONFIG_EVAL_DISTR
:

802 
	`§x_c⁄fig_£t
 (
bgp
, 
SRX_CONFIG_EVAL_DISTR
);

804 
SRX_CONFIG_EVALUATE
:

805 
SRX_CONFIG_EVAL_PATH
:

806 
	`§x_c⁄fig_un£t
 (
bgp
, 
SRX_CONFIG_EVAL_DISTR
);

807 
	`§x_c⁄fig_£t
 (
bgp
, 
SRX_CONFIG_EVALUATE
);

809 
SRX_CONFIG_EVAL_ORIGIN
:

810 
	`§x_c⁄fig_un£t
 (
bgp
, 
SRX_CONFIG_EVAL_DISTR
);

811 
	`§x_c⁄fig_£t
 (
bgp
, 
SRX_CONFIG_EVAL_ORIGIN
);

814 
	`zlog_îr
("InvÆid srxÉvÆu©i⁄ fœg %uÖas£d, ign‹êô!", 
mode
);

817  
CMD_SUCCESS
;

818 
	}
}

827 
	$bgp_§x_di•œy
 (
bgp
 *bgp, 
íabÀ
)

829 i‡(
íabÀ
)

831 
	`§x_c⁄fig_£t
 (
bgp
, 
SRX_CONFIG_DISPLAY_INFO
);

835 
	`§x_c⁄fig_un£t
 (
bgp
, 
SRX_CONFIG_DISPLAY_INFO
);

838  
CMD_SUCCESS
;

839 
	}
}

849 
	$bgp_§x_c⁄f_deÁu…_ªsu…
(
bgp
 *bgp, 
ty≥
, 
def_vÆue
)

851 
ty≥
)

853 
SRX_VTY_PARAM_ORIGIN_VALUE
:

854 
bgp
->
§x_deÁu…_rﬂVÆ
 = 
def_vÆue
;

856 
SRX_VTY_PARAM_PATH_VALUE
:

857 
bgp
->
§x_deÁu…_bgp£cVÆ
 = 
def_vÆue
;

860 
	`zlog_îr
("InvÆid deÁu… vÆid©i⁄Ñesu…Åy≥ [%d]!", 
ty≥
);

862  
CMD_SUCCESS
;

863 
	}
}

875 
	$§x_vÆ_loˇl_¥e„ªn˚_£t
 (
bgp
 *bgp, 
ödex
, 
ªœtive
,

876 
uöt32_t
 
vÆue
)

878 
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
is_£t
 = 1;

879 
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
ªœtive
 =Ñelative;

880 
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
vÆue
 = value;

881  
CMD_SUCCESS
;

882 
	}
}

892 
	$§x_vÆ_loˇl_¥e„ªn˚_un£t
 (
bgp
 *bgp, 
ödex
)

894 
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
is_£t
 = 0;

895 
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
ªœtive
 = 1;

896 
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
vÆue
 = 0;

897  
CMD_SUCCESS
;

898 
	}
}

907 
	$§x_vÆ_pﬁicy_£t
 (
bgp
 *bgp, 
uöt16_t
 
pﬁicy
)

909 
	`SET_FLAG
 (
bgp
->
§x_vÆ_pﬁicy
, 
pﬁicy
);

910  
CMD_SUCCESS
;

911 
	}
}

920 
	$§x_vÆ_pﬁicy_un£t
 (
bgp
 *bgp, 
uöt16_t
 
pﬁicy
)

922 
	`UNSET_FLAG
 (
bgp
->
§x_vÆ_pﬁicy
, 
pﬁicy
);

923  
CMD_SUCCESS
;

924 
	}
}

935 
	$§x_extcommunôy_£t
 (
bgp
 *bgp, 
uöt8_t
 
subcode
, c⁄° * 
cmd
)

937 
	`SET_FLAG
(
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY
);

940 if(
	`°æí
(
cmd
) > 0)

942 i‡(
	`°∫cmp
("öc", 
cmd
, 3) == 0)

944 
	`SET_FLAG
(
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY_EBGP
);

948 
	`UNSET_FLAG
(
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY_EBGP
);

951 
bgp
->
§x_ecommunôy_subcode
 = 
subcode
;

953  
CMD_SUCCESS
;

954 
	}
}

962 
	$§x_extcommunôy_un£t
 (
bgp
 *bgp)

964 
	`UNSET_FLAG
(
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY
);

965 
	`UNSET_FLAG
(
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY_EBGP
);

966 
bgp
->
§x_ecommunôy_subcode
 = 0;

967  
CMD_SUCCESS
;

968 
	}
}

976 
	$≥î_rs˛õ¡_a˘ive
 (
≥î
 *peer)

978 
i
;

979 
j
;

981 
i
=
AFI_IP
; i < 
AFI_MAX
; i++)

982 
j
=
SAFI_UNICAST
; j < 
SAFI_MAX
; j++)

983 i‡(
	`CHECK_FLAG
(
≥î
->
af_Êags
[
i
][
j
], 
PEER_FLAG_RSERVER_CLIENT
)

984 && ! 
≥î
->
af_group
[
i
][
j
])

987 
	}
}

991 
	$≥î_cmp
 (
≥î
 *
p1
, ≥î *
p2
)

993  
	`sockuni⁄_cmp
 (&
p1
->
su
, &
p2
->su);

994 
	}
}

997 
	$≥î_af_Êag_check
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
Êag
)

999  
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
);

1000 
	}
}

1004 
	$≥î_af_Êag_ª£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1006 
i
;

1007 
bgp_fûãr
 *
fûãr
;

1008 
‹f_«me
[
BUFSIZ
];

1010 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1013 
i
 = 
FILTER_IN
; i < 
FILTER_MAX
; i++)

1015 i‡(
fûãr
->
dli°
[
i
].
«me
)

1017 
	`‰ì
 (
fûãr
->
dli°
[
i
].
«me
);

1018 
fûãr
->
dli°
[
i
].
«me
 = 
NULL
;

1020 i‡(
fûãr
->
∂i°
[
i
].
«me
)

1022 
	`‰ì
 (
fûãr
->
∂i°
[
i
].
«me
);

1023 
fûãr
->
∂i°
[
i
].
«me
 = 
NULL
;

1025 i‡(
fûãr
->
a¶i°
[
i
].
«me
)

1027 
	`‰ì
 (
fûãr
->
a¶i°
[
i
].
«me
);

1028 
fûãr
->
a¶i°
[
i
].
«me
 = 
NULL
;

1031 
i
 = 
RMAP_IN
; i < 
RMAP_MAX
; i++)

1033 i‡(
fûãr
->
m≠
[
i
].
«me
)

1035 
	`‰ì
 (
fûãr
->
m≠
[
i
].
«me
);

1036 
fûãr
->
m≠
[
i
].
«me
 = 
NULL
;

1041 i‡(
fûãr
->
usm≠
.
«me
)

1042 
	`‰ì
 (
fûãr
->
usm≠
.
«me
);

1043 
fûãr
->
usm≠
.
«me
 = 
NULL
;

1044 
fûãr
->
usm≠
.
m≠
 = 
NULL
;

1047 
≥î
->
af_Êags
[
afi
][
ßfi
] = 0;

1050 
≥î
->
af_sÊags
[
afi
][
ßfi
] = 0;

1053 
≥î
->
af_ˇp
[
afi
][
ßfi
] = 0;

1056 
≥î
->
‹f_∂i°
[
afi
][
ßfi
] = 
NULL
;

1057 
	`•rötf
 (
‹f_«me
, "%s.%d.%d", 
≥î
->
ho°
, 
afi
, 
ßfi
);

1058 
	`¥efix_bgp_‹f_ªmove_Æl
 (
‹f_«me
);

1061 i‡(! 
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
))

1063 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_COMMUNITY
);

1064 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_EXT_COMMUNITY
);

1068 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

1069 
	`‰ì
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

1070 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
 = 
NULL
;

1071 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 = 
NULL
;

1074 
≥î
->
pmax
[
afi
][
ßfi
] = 0;

1075 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] = 
MAXIMUM_PREFIX_THRESHOLD_DEFAULT
;

1076 
	}
}

1080 
	$≥î_globÆ_c⁄fig_ª£t
 (
≥î
 *peer)

1082 
≥î
->
weight
 = 0;

1083 
≥î
->
ch™ge_loˇl_as
 = 0;

1084 
≥î
->
âl
 = (
	`≥î_s‹t
 (≥îË=
BGP_PEER_IBGP
 ? 255 : 1);

1085 i‡(
≥î
->
upd©e_sour˚
)

1087 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

1088 
≥î
->
upd©e_sour˚
 = 
NULL
;

1090 i‡(
≥î
->
upd©e_if
)

1092 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

1093 
≥î
->
upd©e_if
 = 
NULL
;

1096 i‡(
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_IBGP
)

1097 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_IBGP_ROUTEADV
;

1099 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_EBGP_ROUTEADV
;

1101 
≥î
->
Êags
 = 0;

1102 
≥î
->
c⁄fig
 = 0;

1103 
≥î
->
hﬁdtime
 = 0;

1104 
≥î
->
kì∑live
 = 0;

1105 
≥î
->
c⁄√˘
 = 0;

1106 
≥î
->
v_c⁄√˘
 = 
BGP_DEFAULT_CONNECT_RETRY
;

1107 
	}
}

1110 
bgp_≥î_s‹t_t


1111 
	$≥î_ˇlc_s‹t
 (
≥î
 *peer)

1113 
bgp
 *bgp;

1115 
bgp
 = 
≥î
->bgp;

1118 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

1120 i‡(
≥î
->
as
)

1121  (
bgp
->
as
 =
≥î
->a†? 
BGP_PEER_IBGP
 : 
BGP_PEER_EBGP
);

1124 
≥î
 *
≥î1
;

1125 
≥î1
 = 
	`li°node_hód
 (
≥î
->
group
->peer);

1126 i‡(
≥î1
)

1127  (
≥î1
->
loˇl_as
 =≥î1->
as


1128 ? 
BGP_PEER_IBGP
 : 
BGP_PEER_EBGP
);

1130  
BGP_PEER_INTERNAL
;

1134 i‡(
bgp
 && 
	`CHECK_FLAG
 (bgp->
c⁄fig
, 
BGP_CONFIG_CONFEDERATION
))

1136 i‡(
≥î
->
loˇl_as
 == 0)

1137  
BGP_PEER_INTERNAL
;

1139 i‡(
≥î
->
loˇl_as
 =≥î->
as
)

1141 i‡(
≥î
->
loˇl_as
 =
bgp
->
c⁄„d_id
)

1142  
BGP_PEER_EBGP
;

1144  
BGP_PEER_IBGP
;

1147 i‡(
	`bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
, 
≥î
->
as
))

1148  
BGP_PEER_CONFED
;

1150  
BGP_PEER_EBGP
;

1154  (
≥î
->
loˇl_as
 == 0

1155 ? 
BGP_PEER_INTERNAL
 : 
≥î
->
loˇl_as
 =≥î->
as


1156 ? 
BGP_PEER_IBGP
 : 
BGP_PEER_EBGP
);

1158 
	}
}

1161 
bgp_≥î_s‹t_t


1162 
	$≥î_s‹t
 (
≥î
 *peer)

1164 
≥î
->
s‹t
 = 
	`≥î_ˇlc_s‹t
 (peer);

1165  
≥î
->
s‹t
;

1166 
	}
}

1169 
	$≥î_‰ì
 (
≥î
 *peer)

1171 
	`as£π
 (
≥î
->
°©us
 =
Dñëed
);

1173 
	`bgp_u∆ock
(
≥î
->
bgp
);

1178 
	`bgp_timî_£t
 (
≥î
);

1179 
	`BGP_READ_OFF
 (
≥î
->
t_ªad
);

1180 
	`BGP_WRITE_OFF
 (
≥î
->
t_wrôe
);

1181 
	`BGP_EVENT_FLUSH
 (
≥î
);

1183 i‡(
≥î
->
desc
)

1184 
	`XFREE
 (
MTYPE_PEER_DESC
, 
≥î
->
desc
);

1187 i‡(
≥î
->
ho°
)

1188 
	`XFREE
 (
MTYPE_BGP_PEER_HOST
, 
≥î
->
ho°
);

1191 i‡(
≥î
->
upd©e_sour˚
)

1192 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

1194 i‡(
≥î
->
upd©e_if
)

1195 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

1197 i‡(
≥î
->
˛ór_node_queue
)

1198 
	`w‹k_queue_‰ì
 (
≥î
->
˛ór_node_queue
);

1200 
	`bgp_sync_dñëe
 (
≥î
);

1201 
	`mem£t
 (
≥î
, 0,  (peer));

1203 
	`XFREE
 (
MTYPE_BGP_PEER
, 
≥î
);

1204 
	}
}

1207 
≥î
 *

1208 
	$≥î_lock
 (
≥î
 *peer)

1210 
	`as£π
 (
≥î
 && (≥î->
lock
 >= 0));

1212 
≥î
->
lock
++;

1214  
≥î
;

1215 
	}
}

1220 
≥î
 *

1221 
	$≥î_u∆ock
 (
≥î
 *peer)

1223 
	`as£π
 (
≥î
 && (≥î->
lock
 > 0));

1225 
≥î
->
lock
--;

1227 i‡(
≥î
->
lock
 == 0)

1230 
	`zlog_debug
 ("unlockedánd freeing");

1231 
	`zlog_backåa˚
 (
LOG_DEBUG
);

1233 
	`≥î_‰ì
 (
≥î
);

1234  
NULL
;

1238 i‡(
≥î
->
lock
 == 1)

1240 
	`zlog_debug
 ("unlockedÅo 1");

1241 
	`zlog_backåa˚
 (
LOG_DEBUG
);

1245  
≥î
;

1246 
	}
}

1249 
≥î
 *

1250 
	$≥î_√w
 (
bgp
 *bgp)

1252 
afi_t
 
afi
;

1253 
ßfi_t
 
ßfi
;

1254 
≥î
 *peer;

1255 
£rvít
 *
•
;

1258 
	`as£π
 (
bgp
);

1259 i‡(!
bgp
)

1260  
NULL
;

1263 
≥î
 = 
	`XCALLOC
 (
MTYPE_BGP_PEER
,  (peer));

1266 
≥î
->
fd
 = -1;

1267 
≥î
->
v_°¨t
 = 
BGP_INIT_START_TIMER
;

1268 
≥î
->
v_c⁄√˘
 = 
BGP_DEFAULT_CONNECT_RETRY
;

1269 
≥î
->
v_as‹ig
 = 
BGP_DEFAULT_ASORIGINATE
;

1270 
≥î
->
°©us
 = 
IdÀ
;

1271 
≥î
->
o°©us
 = 
IdÀ
;

1272 
≥î
->
weight
 = 0;

1273 
≥î
->
∑ssw‹d
 = 
NULL
;

1274 
≥î
->
bgp
 = bgp;

1275 
≥î
 = 
	`≥î_lock
 (peer);

1276 
	`bgp_lock
 (
bgp
);

1279 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

1280 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

1282 i‡(! 
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
))

1284 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_COMMUNITY
);

1285 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SEND_EXT_COMMUNITY
);

1287 
≥î
->
‹f_∂i°
[
afi
][
ßfi
] = 
NULL
;

1289 
	`SET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_CAPABILITY_OPEN
);

1292 
≥î
->
ibuf
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

1293 
≥î
->
obuf
 = 
	`°ªam_fifo_√w
 ();

1294 
≥î
->
w‹k
 = 
	`°ªam_√w
 (
BGP_MAX_PACKET_SIZE
);

1296 
	`bgp_sync_öô
 (
≥î
);

1299 
•
 = 
	`gë£rvby«me
 ("bgp", "tcp");

1300 
≥î
->
p‹t
 = (
•
 =
NULL
Ë? 
BGP_PORT_DEFAULT
 : 
	`¡ohs
 (•->
s_p‹t
);

1302  
≥î
;

1303 
	}
}

1306 
≥î
 *

1307 
	$≥î_¸óã
 (
sockuni⁄
 *
su
, 
bgp
 *bgp, 
as_t
 
loˇl_as
,

1308 
as_t
 
ªmŸe_as
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1310 
a˘ive
;

1311 
≥î
 *peer;

1312 
buf
[
SU_ADDRSTRLEN
];

1314 
≥î
 = 
	`≥î_√w
 (
bgp
);

1315 
≥î
->
su
 = *su;

1316 
≥î
->
loˇl_as
 =Üocal_as;

1317 
≥î
->
as
 = 
ªmŸe_as
;

1318 
≥î
->
loˇl_id
 = 
bgp
->
rouãr_id
;

1319 
≥î
->
v_hﬁdtime
 = 
bgp
->
deÁu…_hﬁdtime
;

1320 
≥î
->
v_kì∑live
 = 
bgp
->
deÁu…_kì∑live
;

1321 i‡(
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_IBGP
)

1322 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_IBGP_ROUTEADV
;

1324 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_EBGP_ROUTEADV
;

1326 
≥î
 = 
	`≥î_lock
 (peer);

1327 
	`li°node_add_s‹t
 (
bgp
->
≥î
,Öeer);

1329 
a˘ive
 = 
	`≥î_a˘ive
 (
≥î
);

1331 i‡(
afi
 && 
ßfi
)

1332 
≥î
->
afc
[
afi
][
ßfi
] = 1;

1335 
≥î
->
ªadtime
 =Öìr->
ª£âime
 = 
	`bgp_˛ock
 ();

1338 
≥î
->
âl
 = (≥î->
s‹t
 =
BGP_PEER_IBGP
) ? 255 : 1;

1341 
	`sockuni⁄2°r
 (
su
, 
buf
, 
SU_ADDRSTRLEN
);

1342 
≥î
->
ho°
 = 
	`XSTRDUP
 (
MTYPE_BGP_PEER_HOST
, 
buf
);

1345 i‡(! 
a˘ive
 && 
	`≥î_a˘ive
 (
≥î
))

1346 
	`bgp_timî_£t
 (
≥î
);

1348  
≥î
;

1349 
	}
}

1352 
≥î
 *

1353 
	$≥î_¸óã_ac˚±
 (
bgp
 *bgp)

1355 
≥î
 *peer;

1357 
≥î
 = 
	`≥î_√w
 (
bgp
);

1359 
≥î
 = 
	`≥î_lock
 (peer);

1360 
	`li°node_add_s‹t
 (
bgp
->
≥î
,Öeer);

1362  
≥î
;

1363 
	}
}

1367 
	$≥î_as_ch™ge
 (
≥î
 *≥î, 
as_t
 
as
)

1369 
bgp_≥î_s‹t_t
 
ty≥
;

1372 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

1374 i‡(
≥î
->
°©us
 =
E°ablished
)

1376 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_REMOTE_AS_CHANGE
;

1377 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

1378 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

1381 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

1383 
ty≥
 = 
	`≥î_s‹t
 (
≥î
);

1384 
≥î
->
as
 =ás;

1386 i‡(
	`bgp_c⁄fig_check
 (
≥î
->
bgp
, 
BGP_CONFIG_CONFEDERATION
)

1387 && ! 
	`bgp_c⁄„dî©i⁄_≥îs_check
 (
≥î
->
bgp
, 
as
)

1388 && 
≥î
->
bgp
->
as
 !=ás)

1389 
≥î
->
loˇl_as
 =Öìr->
bgp
->
c⁄„d_id
;

1391 
≥î
->
loˇl_as
 =Öìr->
bgp
->
as
;

1394 i‡(
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_IBGP
)

1395 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_IBGP_ROUTEADV
;

1397 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_EBGP_ROUTEADV
;

1400 i‡(
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_IBGP
)

1401 
≥î
->
âl
 = 255;

1402 i‡(
ty≥
 =
BGP_PEER_IBGP
)

1403 
≥î
->
âl
 = 1;

1406 i‡(
	`≥î_s‹t
 (
≥î
Ë!
BGP_PEER_IBGP
)

1408 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
SAFI_UNICAST
],

1409 
PEER_FLAG_REFLECTOR_CLIENT
);

1410 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
SAFI_MULTICAST
],

1411 
PEER_FLAG_REFLECTOR_CLIENT
);

1412 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
AFI_IP
][
SAFI_MPLS_VPN
],

1413 
PEER_FLAG_REFLECTOR_CLIENT
);

1414 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
SAFI_UNICAST
],

1415 
PEER_FLAG_REFLECTOR_CLIENT
);

1416 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
AFI_IP6
][
SAFI_MULTICAST
],

1417 
PEER_FLAG_REFLECTOR_CLIENT
);

1421 i‡(
	`≥î_s‹t
 (
≥î
Ë!
BGP_PEER_EBGP
)

1423 
≥î
->
ch™ge_loˇl_as
 = 0;

1424 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

1425 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

1427 
	}
}

1432 
	$≥î_ªmŸe_as
 (
bgp
 *bgp, 
sockuni⁄
 *
su
, 
as_t
 *
as
,

1433 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1435 
≥î
 *peer;

1436 
as_t
 
loˇl_as
;

1438 
≥î
 = 
	`≥î_lookup
 (
bgp
, 
su
);

1440 i‡(
≥î
)

1443 i‡(
≥î
->
group
)

1445 i‡(
≥î
->
group
->
c⁄f
->
as
)

1448 *
as
 = 
≥î
->
group
->
c⁄f
->as;

1449  
BGP_ERR_PEER_GROUP_MEMBER
;

1451 i‡(
	`≥î_s‹t
 (
≥î
->
group
->
c⁄f
Ë=
BGP_PEER_IBGP
)

1453 i‡(
bgp
->
as
 != *as)

1455 *
as
 = 
≥î
->as;

1456  
BGP_ERR_PEER_GROUP_PEER_TYPE_DIFFERENT
;

1461 i‡(
bgp
->
as
 == *as)

1463 *
as
 = 
≥î
->as;

1464  
BGP_ERR_PEER_GROUP_PEER_TYPE_DIFFERENT
;

1470 i‡(
≥î
->
as
 != *as)

1471 
	`≥î_as_ch™ge
 (
≥î
, *
as
);

1478 i‡(
	`bgp_c⁄fig_check
 (
bgp
, 
BGP_CONFIG_CONFEDERATION
)

1479 && ! 
	`bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
, *
as
)

1480 && 
bgp
->
as
 != *as)

1481 
loˇl_as
 = 
bgp
->
c⁄„d_id
;

1483 
loˇl_as
 = 
bgp
->
as
;

1488 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_NO_DEFAULT_IPV4
)

1489 && 
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

1490 
≥î
 = 
	`≥î_¸óã
 (
su
, 
bgp
, 
loˇl_as
, *
as
, 0, 0);

1492 
≥î
 = 
	`≥î_¸óã
 (
su
, 
bgp
, 
loˇl_as
, *
as
, 
afi
, 
ßfi
);

1496 
	}
}

1500 
	$≥î_a˘iv©e
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1502 
a˘ive
;

1504 i‡(
≥î
->
afc
[
afi
][
ßfi
])

1508 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

1509 
≥î
->
afc
[
afi
][
ßfi
] = 1;

1512 
a˘ive
 = 
	`≥î_a˘ive
 (
≥î
);

1514 
≥î
->
afc
[
afi
][
ßfi
] = 1;

1516 i‡(! 
a˘ive
 && 
	`≥î_a˘ive
 (
≥î
))

1517 
	`bgp_timî_£t
 (
≥î
);

1520 i‡(
≥î
->
°©us
 =
E°ablished
)

1522 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_DYNAMIC_RCV
))

1524 
≥î
->
afc_adv
[
afi
][
ßfi
] = 1;

1525 
	`bgp_ˇ∑bûôy_£nd
 (
≥î
, 
afi
, 
ßfi
,

1526 
CAPABILITY_CODE_MP
,

1527 
CAPABILITY_ACTION_SET
);

1528 i‡(
≥î
->
afc_ªcv
[
afi
][
ßfi
])

1530 
≥î
->
afc_√go
[
afi
][
ßfi
] = 1;

1531 
	`bgp_™noun˚_rouã
 (
≥î
, 
afi
, 
ßfi
);

1536 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_AF_ACTIVATE
;

1537 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

1538 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

1544 
	}
}

1547 
	$≥î_dó˘iv©e
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1549 
≥î_group
 *
group
;

1550 
≥î
 *
≥î1
;

1551 
li°node
 *
node
, *
¬ode
;

1553 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

1555 
group
 = 
≥î
->group;

1557 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
, 
≥î1
))

1559 i‡(
≥î1
->
af_group
[
afi
][
ßfi
])

1560  
BGP_ERR_PEER_GROUP_MEMBER_EXISTS
;

1565 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

1566  
BGP_ERR_PEER_BELONGS_TO_GROUP
;

1569 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

1573 
≥î
->
afc
[
afi
][
ßfi
] = 0;

1574 
	`≥î_af_Êag_ª£t
 (
≥î
, 
afi
, 
ßfi
);

1576 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

1578 i‡(
≥î
->
°©us
 =
E°ablished
)

1580 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_DYNAMIC_RCV
))

1582 
≥î
->
afc_adv
[
afi
][
ßfi
] = 0;

1583 
≥î
->
afc_√go
[
afi
][
ßfi
] = 0;

1585 i‡(
	`≥î_a˘ive_√go
 (
≥î
))

1587 
	`bgp_ˇ∑bûôy_£nd
 (
≥î
, 
afi
, 
ßfi
,

1588 
CAPABILITY_CODE_MP
,

1589 
CAPABILITY_ACTION_UNSET
);

1590 
	`bgp_˛ór_rouã
 (
≥î
, 
afi
, 
ßfi
, 
BGP_CLEAR_ROUTE_NORMAL
);

1591 
≥î
->
pcou¡
[
afi
][
ßfi
] = 0;

1595 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_NEIGHBOR_DELETE
;

1596 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

1597 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

1602 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_NEIGHBOR_DELETE
;

1603 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

1604 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

1609 
	}
}

1612 
	$≥î_nsf_°›
 (
≥î
 *peer)

1614 
afi_t
 
afi
;

1615 
ßfi_t
 
ßfi
;

1617 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
);

1618 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_MODE
);

1620 
afi
 = 
AFI_IP
 ;áfò< 
AFI_MAX
 ;áfi++)

1621 
ßfi
 = 
SAFI_UNICAST
 ; safò< 
SAFI_RESERVED_3
 ; safi++)

1622 
≥î
->
nsf
[
afi
][
ßfi
] = 0;

1624 i‡(
≥î
->
t_gr_ª°¨t
)

1626 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_ª°¨t
);

1627 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

1628 
	`zlog_debug
 ("%†gø˚fu»ª°¨àtimî st›≥d", 
≥î
->
ho°
);

1630 i‡(
≥î
->
t_gr_°Æe
)

1632 
	`BGP_TIMER_OFF
 (
≥î
->
t_gr_°Æe
);

1633 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

1634 
	`zlog_debug
 ("%†gø˚fu»ª°¨à°Æï©hÅimî st›≥d", 
≥î
->
ho°
);

1636 
	`bgp_˛ór_rouã_Æl
 (
≥î
);

1637 
	}
}

1651 
	$≥î_dñëe
 (
≥î
 *peer)

1653 
i
;

1654 
afi_t
 
afi
;

1655 
ßfi_t
 
ßfi
;

1656 
bgp
 *bgp;

1657 
bgp_fûãr
 *
fûãr
;

1658 
li°node
 *
≤
;

1660 
	`as£π
 (
≥î
->
°©us
 !
Dñëed
);

1662 
bgp
 = 
≥î
->bgp;

1664 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
))

1665 
	`≥î_nsf_°›
 (
≥î
);

1669 i‡(
≥î
->
group
)

1671 i‡((
≤
 = 
	`li°node_lookup
 (
≥î
->
group
->peer,Öeer)))

1673 
≥î
 = 
	`≥î_u∆ock
 (peer);

1674 
	`li°_dñëe_node
 (
≥î
->
group
->≥î, 
≤
);

1676 
≥î
->
group
 = 
NULL
;

1683 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_NEIGHBOR_DELETE
;

1684 
	`bgp_°›
 (
≥î
);

1685 
	`bgp_fsm_ch™ge_°©us
 (
≥î
, 
Dñëed
);

1688 i‡(
≥î
->
∑ssw‹d
)

1690 
	`XFREE
 (
MTYPE_PEER_PASSWORD
, 
≥î
->
∑ssw‹d
);

1691 
≥î
->
∑ssw‹d
 = 
NULL
;

1693 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

1694 
	`bgp_md5_£t
 (
≥î
);

1697 
	`bgp_timî_£t
 (
≥î
);

1700 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
)

1701 && (
≤
 = 
	`li°node_lookup
 (
bgp
->
≥î
,Öeer)))

1703 
	`≥î_u∆ock
 (
≥î
);

1704 
	`li°_dñëe_node
 (
bgp
->
≥î
, 
≤
);

1707 i‡(
	`≥î_rs˛õ¡_a˘ive
 (
≥î
)

1708 && (
≤
 = 
	`li°node_lookup
 (
bgp
->
rs˛õ¡
, 
≥î
)))

1710 
	`≥î_u∆ock
 (
≥î
);

1711 
	`li°_dñëe_node
 (
bgp
->
rs˛õ¡
, 
≤
);

1714 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

1715 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

1716 i‡(
	`CHECK_FLAG
(
≥î
->
af_Êags
[
afi
][
ßfi
],

1717 
PEER_FLAG_RSERVER_CLIENT
))

1718 
	`bgp_˛ór_rouã
 (
≥î
, 
afi
, 
ßfi
, 
BGP_CLEAR_ROUTE_MY_RSCLIENT
);

1723 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

1724 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

1725 i‡(
≥î
->
rib
[
afi
][
ßfi
] && !Öìr->
af_group
[afi][safi])

1726 
	`bgp_èbÀ_föish
 (&
≥î
->
rib
[
afi
][
ßfi
]);

1729 i‡(
≥î
->
ibuf
)

1730 
	`°ªam_‰ì
 (
≥î
->
ibuf
);

1731 i‡(
≥î
->
obuf
)

1732 
	`°ªam_fifo_‰ì
 (
≥î
->
obuf
);

1733 i‡(
≥î
->
w‹k
)

1734 
	`°ªam_‰ì
 (
≥î
->
w‹k
);

1735 
≥î
->
obuf
 = 
NULL
;

1736 
≥î
->
w‹k
 =Öìr->
ibuf
 = 
NULL
;

1739 i‡(
≥î
->
su_loˇl
)

1740 
	`sockuni⁄_‰ì
 (
≥î
->
su_loˇl
);

1741 i‡(
≥î
->
su_ªmŸe
)

1742 
	`sockuni⁄_‰ì
 (
≥î
->
su_ªmŸe
);

1743 
≥î
->
su_loˇl
 =Öìr->
su_ªmŸe
 = 
NULL
;

1746 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

1747 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

1749 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

1751 
i
 = 
FILTER_IN
; i < 
FILTER_MAX
; i++)

1753 i‡(
fûãr
->
dli°
[
i
].
«me
)

1754 
	`‰ì
 (
fûãr
->
dli°
[
i
].
«me
);

1755 i‡(
fûãr
->
∂i°
[
i
].
«me
)

1756 
	`‰ì
 (
fûãr
->
∂i°
[
i
].
«me
);

1757 i‡(
fûãr
->
a¶i°
[
i
].
«me
)

1758 
	`‰ì
 (
fûãr
->
a¶i°
[
i
].
«me
);

1760 
fûãr
->
dli°
[
i
].
«me
 = 
NULL
;

1761 
fûãr
->
∂i°
[
i
].
«me
 = 
NULL
;

1762 
fûãr
->
a¶i°
[
i
].
«me
 = 
NULL
;

1764 
i
 = 
RMAP_IN
; i < 
RMAP_MAX
; i++)

1766 i‡(
fûãr
->
m≠
[
i
].
«me
)

1767 
	`‰ì
 (
fûãr
->
m≠
[
i
].
«me
);

1768 
fûãr
->
m≠
[
i
].
«me
 = 
NULL
;

1771 i‡(
fûãr
->
usm≠
.
«me
)

1772 
	`‰ì
 (
fûãr
->
usm≠
.
«me
);

1774 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

1775 
	`‰ì
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

1777 
fûãr
->
usm≠
.
«me
 = 
NULL
;

1778 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
 = 
NULL
;

1781 
	`≥î_u∆ock
 (
≥î
);

1784 
	}
}

1787 
	$≥î_group_cmp
 (
≥î_group
 *
g1
, ≥î_grou∞*
g2
)

1789  
	`°rcmp
 (
g1
->
«me
, 
g2
->name);

1790 
	}
}

1794 
	$≥î_group_a˘ive
 (
≥î
 *peer)

1796 i‡(
≥î
->
af_group
[
AFI_IP
][
SAFI_UNICAST
]

1797 || 
≥î
->
af_group
[
AFI_IP
][
SAFI_MULTICAST
]

1798 || 
≥î
->
af_group
[
AFI_IP
][
SAFI_MPLS_VPN
]

1799 || 
≥î
->
af_group
[
AFI_IP6
][
SAFI_UNICAST
]

1800 || 
≥î
->
af_group
[
AFI_IP6
][
SAFI_MULTICAST
])

1803 
	}
}

1806 
≥î_group
 *

1807 
	$≥î_group_√w
 ()

1809  (
≥î_group
 *Ë
	`XCALLOC
 (
MTYPE_PEER_GROUP
,

1810  (
≥î_group
));

1811 
	}
}

1814 
	$≥î_group_‰ì
 (
≥î_group
 *
group
)

1816 
	`XFREE
 (
MTYPE_PEER_GROUP
, 
group
);

1817 
	}
}

1819 
≥î_group
 *

1820 
	$≥î_group_lookup
 (
bgp
 *bgp, c⁄° *
«me
)

1822 
≥î_group
 *
group
;

1823 
li°node
 *
node
, *
¬ode
;

1825 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
¬ode
, group))

1827 i‡(
	`°rcmp
 (
group
->
«me
,Çame) == 0)

1828  
group
;

1830  
NULL
;

1831 
	}
}

1833 
≥î_group
 *

1834 
	$≥î_group_gë
 (
bgp
 *bgp, c⁄° *
«me
)

1836 
≥î_group
 *
group
;

1838 
group
 = 
	`≥î_group_lookup
 (
bgp
, 
«me
);

1839 i‡(
group
)

1840  
group
;

1842 
group
 = 
	`≥î_group_√w
 ();

1843 
group
->
bgp
 = bgp;

1844 
group
->
«me
 = 
	`°rdup
 (name);

1845 
group
->
≥î
 = 
	`li°_√w
 ();

1846 
group
->
c⁄f
 = 
	`≥î_√w
 (
bgp
);

1847 i‡(! 
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_NO_DEFAULT_IPV4
))

1848 
group
->
c⁄f
->
afc
[
AFI_IP
][
SAFI_UNICAST
] = 1;

1849 
group
->
c⁄f
->
ho°
 = 
	`XSTRDUP
 (
MTYPE_BGP_PEER_HOST
, 
«me
);

1850 
group
->
c⁄f
->group = group;

1851 
group
->
c⁄f
->
as
 = 0;

1852 
group
->
c⁄f
->
âl
 = 1;

1853 
group
->
c⁄f
->
gtsm_h›s
 = 0;

1854 
group
->
c⁄f
->
v_rouãadv
 = 
BGP_DEFAULT_EBGP_ROUTEADV
;

1855 
	`UNSET_FLAG
 (
group
->
c⁄f
->
c⁄fig
, 
PEER_CONFIG_TIMER
);

1856 
	`UNSET_FLAG
 (
group
->
c⁄f
->
c⁄fig
, 
PEER_CONFIG_CONNECT
);

1857 
group
->
c⁄f
->
kì∑live
 = 0;

1858 
group
->
c⁄f
->
hﬁdtime
 = 0;

1859 
group
->
c⁄f
->
c⁄√˘
 = 0;

1860 
	`SET_FLAG
 (
group
->
c⁄f
->
sÊags
, 
PEER_STATUS_GROUP
);

1861 
	`li°node_add_s‹t
 (
bgp
->
group
, group);

1864 
	}
}

1867 
	$≥î_group2≥î_c⁄fig_c›y
 (
≥î_group
 *
group
, 
≥î
 *peer,

1868 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

1870 
ö
 = 
FILTER_IN
;

1871 
out
 = 
FILTER_OUT
;

1872 
≥î
 *
c⁄f
;

1873 
bgp_fûãr
 *
pfûãr
;

1874 
bgp_fûãr
 *
gfûãr
;

1876 
c⁄f
 = 
group
->conf;

1877 
pfûãr
 = &
≥î
->
fûãr
[
afi
][
ßfi
];

1878 
gfûãr
 = &
c⁄f
->
fûãr
[
afi
][
ßfi
];

1881 i‡(
c⁄f
->
as
)

1882 
≥î
->
as
 = 
c⁄f
->as;

1885 i‡(
c⁄f
->
ch™ge_loˇl_as
)

1886 
≥î
->
ch™ge_loˇl_as
 = 
c⁄f
->change_local_as;

1889 
≥î
->
âl
 = 
c⁄f
->ttl;

1892 
≥î
->
gtsm_h›s
 = 
c⁄f
->gtsm_hops;

1895 
≥î
->
weight
 = 
c⁄f
->weight;

1898 
≥î
->
Êags
 = 
c⁄f
->flags;

1900 
≥î
->
af_Êags
[
afi
][
ßfi
] = 
c⁄f
->af_flags[afi][safi];

1902 
≥î
->
c⁄fig
 = 
c⁄f
->config;

1905 
≥î
->
hﬁdtime
 = 
c⁄f
->holdtime;

1906 
≥î
->
kì∑live
 = 
c⁄f
->keepalive;

1907 
≥î
->
c⁄√˘
 = 
c⁄f
->connect;

1908 i‡(
	`CHECK_FLAG
 (
c⁄f
->
c⁄fig
, 
PEER_CONFIG_CONNECT
))

1909 
≥î
->
v_c⁄√˘
 = 
c⁄f
->
c⁄√˘
;

1911 
≥î
->
v_c⁄√˘
 = 
BGP_DEFAULT_CONNECT_RETRY
;

1914 i‡(
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_IBGP
)

1915 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_IBGP_ROUTEADV
;

1917 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_EBGP_ROUTEADV
;

1920 i‡(
≥î
->
∑ssw‹d
)

1921 
	`XFREE
 (
MTYPE_PEER_PASSWORD
, 
≥î
->
∑ssw‹d
);

1923 i‡(
c⁄f
->
∑ssw‹d
)

1924 
≥î
->
∑ssw‹d
 = 
	`XSTRDUP
 (
MTYPE_PEER_PASSWORD
, 
c⁄f
->password);

1926 
≥î
->
∑ssw‹d
 = 
NULL
;

1928 
	`bgp_md5_£t
 (
≥î
);

1931 
≥î
->
pmax
[
afi
][
ßfi
] = 
c⁄f
->pmax[afi][safi];

1932 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] = 
c⁄f
->pmax_threshold[afi][safi];

1933 
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
] = 
c⁄f
->pmax_restart[afi][safi];

1936 
≥î
->
Ælowas_ö
[
afi
][
ßfi
] = 
c⁄f
->allowas_in[afi][safi];

1939 i‡(
	`CHECK_FLAG
(
c⁄f
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

1942 
≥î
->
rib
[
afi
][
ßfi
] = 
group
->
c⁄f
->rib[afi][safi];

1945 i‡(
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

1946 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
);

1947 i‡(
gfûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

1949 
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_IMPORT].name);

1950 
pfûãr
->
m≠
[
RMAP_IMPORT
].m≠ = 
gfûãr
->map[RMAP_IMPORT].map;

1954 
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
 = 
NULL
;

1955 
pfûãr
->
m≠
[
RMAP_IMPORT
].m≠ = 
NULL
;

1959 i‡(
gfûãr
->
m≠
[
RMAP_EXPORT
].
«me
 && ! 
pfûãr
->map[RMAP_EXPORT].name)

1961 
pfûãr
->
m≠
[
RMAP_EXPORT
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_EXPORT].name);

1962 
pfûãr
->
m≠
[
RMAP_EXPORT
].m≠ = 
gfûãr
->map[RMAP_EXPORT].map;

1967 i‡(
c⁄f
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

1969 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

1970 
	`‰ì
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

1971 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
 = 
	`°rdup
 (
c⁄f
->default_rmap[afi][safi].name);

1972 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 = 
c⁄f
->default_rmap[afi][safi].map;

1976 i‡(
c⁄f
->
upd©e_sour˚
)

1978 i‡(
≥î
->
upd©e_sour˚
)

1979 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

1980 i‡(
≥î
->
upd©e_if
)

1982 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

1983 
≥î
->
upd©e_if
 = 
NULL
;

1985 
≥î
->
upd©e_sour˚
 = 
	`sockuni⁄_dup
 (
c⁄f
->update_source);

1987 i‡(
c⁄f
->
upd©e_if
)

1989 i‡(
≥î
->
upd©e_if
)

1990 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

1991 i‡(
≥î
->
upd©e_sour˚
)

1993 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

1994 
≥î
->
upd©e_sour˚
 = 
NULL
;

1996 
≥î
->
upd©e_if
 = 
	`XSTRDUP
 (
MTYPE_PEER_UPDATE_SOURCE
, 
c⁄f
->update_if);

2000 i‡(
gfûãr
->
dli°
[
ö
].
«me
 && ! 
pfûãr
->dlist[in].name)

2002 i‡(
pfûãr
->
dli°
[
ö
].
«me
)

2003 
	`‰ì
 (
pfûãr
->
dli°
[
ö
].
«me
);

2004 
pfûãr
->
dli°
[
ö
].
«me
 = 
	`°rdup
 (
gfûãr
->dlist[in].name);

2005 
pfûãr
->
dli°
[
ö
].
Æi°
 = 
gfûãr
->dlist[in].alist;

2007 i‡(
gfûãr
->
∂i°
[
ö
].
«me
 && ! 
pfûãr
->plist[in].name)

2009 i‡(
pfûãr
->
∂i°
[
ö
].
«me
)

2010 
	`‰ì
 (
pfûãr
->
∂i°
[
ö
].
«me
);

2011 
pfûãr
->
∂i°
[
ö
].
«me
 = 
	`°rdup
 (
gfûãr
->plist[in].name);

2012 
pfûãr
->
∂i°
[
ö
].∂i° = 
gfûãr
->plist[in].plist;

2014 i‡(
gfûãr
->
a¶i°
[
ö
].
«me
 && ! 
pfûãr
->aslist[in].name)

2016 i‡(
pfûãr
->
a¶i°
[
ö
].
«me
)

2017 
	`‰ì
 (
pfûãr
->
a¶i°
[
ö
].
«me
);

2018 
pfûãr
->
a¶i°
[
ö
].
«me
 = 
	`°rdup
 (
gfûãr
->aslist[in].name);

2019 
pfûãr
->
a¶i°
[
ö
].a¶i° = 
gfûãr
->aslist[in].aslist;

2021 i‡(
gfûãr
->
m≠
[
RMAP_IN
].
«me
 && ! 
pfûãr
->map[RMAP_IN].name)

2023 i‡(
pfûãr
->
m≠
[
RMAP_IN
].
«me
)

2024 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_IN
].
«me
);

2025 
pfûãr
->
m≠
[
RMAP_IN
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_IN].name);

2026 
pfûãr
->
m≠
[
RMAP_IN
].m≠ = 
gfûãr
->map[RMAP_IN].map;

2030 i‡(
gfûãr
->
dli°
[
out
].
«me
)

2032 i‡(
pfûãr
->
dli°
[
out
].
«me
)

2033 
	`‰ì
 (
pfûãr
->
dli°
[
out
].
«me
);

2034 
pfûãr
->
dli°
[
out
].
«me
 = 
	`°rdup
 (
gfûãr
->dlist[out].name);

2035 
pfûãr
->
dli°
[
out
].
Æi°
 = 
gfûãr
->dlist[out].alist;

2039 i‡(
pfûãr
->
dli°
[
out
].
«me
)

2040 
	`‰ì
 (
pfûãr
->
dli°
[
out
].
«me
);

2041 
pfûãr
->
dli°
[
out
].
«me
 = 
NULL
;

2042 
pfûãr
->
dli°
[
out
].
Æi°
 = 
NULL
;

2044 i‡(
gfûãr
->
∂i°
[
out
].
«me
)

2046 i‡(
pfûãr
->
∂i°
[
out
].
«me
)

2047 
	`‰ì
 (
pfûãr
->
∂i°
[
out
].
«me
);

2048 
pfûãr
->
∂i°
[
out
].
«me
 = 
	`°rdup
 (
gfûãr
->plist[out].name);

2049 
pfûãr
->
∂i°
[
out
].∂i° = 
gfûãr
->plist[out].plist;

2053 i‡(
pfûãr
->
∂i°
[
out
].
«me
)

2054 
	`‰ì
 (
pfûãr
->
∂i°
[
out
].
«me
);

2055 
pfûãr
->
∂i°
[
out
].
«me
 = 
NULL
;

2056 
pfûãr
->
∂i°
[
out
].∂i° = 
NULL
;

2058 i‡(
gfûãr
->
a¶i°
[
out
].
«me
)

2060 i‡(
pfûãr
->
a¶i°
[
out
].
«me
)

2061 
	`‰ì
 (
pfûãr
->
a¶i°
[
out
].
«me
);

2062 
pfûãr
->
a¶i°
[
out
].
«me
 = 
	`°rdup
 (
gfûãr
->aslist[out].name);

2063 
pfûãr
->
a¶i°
[
out
].a¶i° = 
gfûãr
->aslist[out].aslist;

2067 i‡(
pfûãr
->
a¶i°
[
out
].
«me
)

2068 
	`‰ì
 (
pfûãr
->
a¶i°
[
out
].
«me
);

2069 
pfûãr
->
a¶i°
[
out
].
«me
 = 
NULL
;

2070 
pfûãr
->
a¶i°
[
out
].a¶i° = 
NULL
;

2072 i‡(
gfûãr
->
m≠
[
RMAP_OUT
].
«me
)

2074 i‡(
pfûãr
->
m≠
[
RMAP_OUT
].
«me
)

2075 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_OUT
].
«me
);

2076 
pfûãr
->
m≠
[
RMAP_OUT
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_OUT].name);

2077 
pfûãr
->
m≠
[
RMAP_OUT
].m≠ = 
gfûãr
->map[RMAP_OUT].map;

2081 i‡(
pfûãr
->
m≠
[
RMAP_OUT
].
«me
)

2082 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_OUT
].
«me
);

2083 
pfûãr
->
m≠
[
RMAP_OUT
].
«me
 = 
NULL
;

2084 
pfûãr
->
m≠
[
RMAP_OUT
].m≠ = 
NULL
;

2088 i‡(
gfûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

2090 i‡(
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

2091 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
);

2092 
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_IMPORT].name);

2093 
pfûãr
->
m≠
[
RMAP_IMPORT
].m≠ = 
gfûãr
->map[RMAP_IMPORT].map;

2097 i‡(
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
)

2098 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
);

2099 
pfûãr
->
m≠
[
RMAP_IMPORT
].
«me
 = 
NULL
;

2100 
pfûãr
->
m≠
[
RMAP_IMPORT
].m≠ = 
NULL
;

2102 i‡(
gfûãr
->
m≠
[
RMAP_EXPORT
].
«me
 && ! 
pfûãr
->map[RMAP_EXPORT].name)

2104 i‡(
pfûãr
->
m≠
[
RMAP_EXPORT
].
«me
)

2105 
	`‰ì
 (
pfûãr
->
m≠
[
RMAP_EXPORT
].
«me
);

2106 
pfûãr
->
m≠
[
RMAP_EXPORT
].
«me
 = 
	`°rdup
 (
gfûãr
->map[RMAP_EXPORT].name);

2107 
pfûãr
->
m≠
[
RMAP_EXPORT
].m≠ = 
gfûãr
->map[RMAP_EXPORT].map;

2110 i‡(
gfûãr
->
usm≠
.
«me
)

2112 i‡(
pfûãr
->
usm≠
.
«me
)

2113 
	`‰ì
 (
pfûãr
->
usm≠
.
«me
);

2114 
pfûãr
->
usm≠
.
«me
 = 
	`°rdup
 (
gfûãr
->usmap.name);

2115 
pfûãr
->
usm≠
.
m≠
 = 
gfûãr
->usmap.map;

2119 i‡(
pfûãr
->
usm≠
.
«me
)

2120 
	`‰ì
 (
pfûãr
->
usm≠
.
«me
);

2121 
pfûãr
->
usm≠
.
«me
 = 
NULL
;

2122 
pfûãr
->
usm≠
.
m≠
 = 
NULL
;

2124 
	}
}

2128 
	$≥î_group_ªmŸe_as
 (
bgp
 *bgp, c⁄° *
group_«me
, 
as_t
 *
as
)

2130 
≥î_group
 *
group
;

2131 
≥î
 *peer;

2132 
li°node
 *
node
, *
¬ode
;

2134 
group
 = 
	`≥î_group_lookup
 (
bgp
, 
group_«me
);

2135 i‡(! 
group
)

2138 i‡(
group
->
c⁄f
->
as
 == *as)

2143 
	`≥î_as_ch™ge
 (
group
->
c⁄f
, *
as
);

2145 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

2147 i‡(
≥î
->
as
 != *as)

2148 
	`≥î_as_ch™ge
 (
≥î
, *
as
);

2152 
	}
}

2155 
	$≥î_group_dñëe
 (
≥î_group
 *
group
)

2157 
bgp
 *bgp;

2158 
≥î
 *peer;

2159 
li°node
 *
node
, *
¬ode
;

2161 
bgp
 = 
group
->bgp;

2163 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

2165 
≥î
->
group
 = 
NULL
;

2166 
	`≥î_dñëe
 (
≥î
);

2168 
	`li°_dñëe
 (
group
->
≥î
);

2170 
	`‰ì
 (
group
->
«me
);

2171 
group
->
«me
 = 
NULL
;

2173 
group
->
c⁄f
->grou∞
NULL
;

2174 
	`≥î_dñëe
 (
group
->
c⁄f
);

2177 
	`li°node_dñëe
 (
bgp
->
group
, group);

2179 
	`≥î_group_‰ì
 (
group
);

2182 
	}
}

2185 
	$≥î_group_ªmŸe_as_dñëe
 (
≥î_group
 *
group
)

2187 
≥î
 *peer;

2188 
li°node
 *
node
, *
¬ode
;

2190 i‡(! 
group
->
c⁄f
->
as
)

2193 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

2195 
≥î
->
group
 = 
NULL
;

2196 
	`≥î_dñëe
 (
≥î
);

2198 
	`li°_dñëe_Æl_node
 (
group
->
≥î
);

2200 
group
->
c⁄f
->
as
 = 0;

2203 
	}
}

2207 
	$≥î_group_böd
 (
bgp
 *bgp, 
sockuni⁄
 *
su
,

2208 
≥î_group
 *
group
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
as_t
 *
as
)

2210 
≥î
 *peer;

2211 
fú°_membî
 = 0;

2214 i‡(! 
group
->
c⁄f
->
afc
[
afi
][
ßfi
])

2215  
BGP_ERR_PEER_GROUP_AF_UNCONFIGURED
;

2218 
≥î
 = 
	`≥î_lookup
 (
bgp
, 
su
);

2221 i‡(! 
≥î
)

2223 i‡(! 
group
->
c⁄f
->
as
)

2224  
BGP_ERR_PEER_GROUP_NO_REMOTE_AS
;

2226 
≥î
 = 
	`≥î_¸óã
 (
su
, 
bgp
, bgp->
as
, 
group
->
c⁄f
->as, 
afi
, 
ßfi
);

2227 
≥î
->
group
 = group;

2228 
≥î
->
af_group
[
afi
][
ßfi
] = 1;

2230 
≥î
 = 
	`≥î_lock
 (peer);

2231 
	`li°node_add
 (
group
->
≥î
,Öeer);

2232 
	`≥î_group2≥î_c⁄fig_c›y
 (
group
, 
≥î
, 
afi
, 
ßfi
);

2238 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

2240 i‡(
	`°rcmp
 (
≥î
->
group
->
«me
, group->name) != 0)

2241  
BGP_ERR_PEER_GROUP_CANT_CHANGE
;

2247 i‡(
	`≥î_group_a˘ive
 (
≥î
)

2248 && 
	`°rcmp
 (
≥î
->
group
->
«me
, group->name) != 0)

2249  
BGP_ERR_PEER_GROUP_MISMATCH
;

2251 i‡(! 
group
->
c⁄f
->
as
)

2253 i‡(
	`≥î_s‹t
 (
group
->
c⁄f
Ë!
BGP_PEER_INTERNAL


2254 && 
	`≥î_s‹t
 (
group
->
c⁄f
Ë!≥î_s‹à(
≥î
))

2256 i‡(
as
)

2257 *
as
 = 
≥î
->as;

2258  
BGP_ERR_PEER_GROUP_PEER_TYPE_DIFFERENT
;

2261 i‡(
	`≥î_s‹t
 (
group
->
c⁄f
Ë=
BGP_PEER_INTERNAL
)

2262 
fú°_membî
 = 1;

2265 
≥î
->
af_group
[
afi
][
ßfi
] = 1;

2266 
≥î
->
afc
[
afi
][
ßfi
] = 1;

2267 i‡(! 
≥î
->
group
)

2269 
≥î
->
group
 = group;

2271 
≥î
 = 
	`≥î_lock
 (peer);

2272 
	`li°node_add
 (
group
->
≥î
,Öeer);

2275 
	`as£π
 (
group
 && 
≥î
->group == group);

2277 i‡(
fú°_membî
)

2280 i‡(
	`≥î_s‹t
 (
group
->
c⁄f
Ë=
BGP_PEER_IBGP
)

2281 
group
->
c⁄f
->
v_rouãadv
 = 
BGP_DEFAULT_IBGP_ROUTEADV
;

2283 
group
->
c⁄f
->
v_rouãadv
 = 
BGP_DEFAULT_EBGP_ROUTEADV
;

2286 i‡(
	`≥î_s‹t
 (
group
->
c⁄f
Ë=
BGP_PEER_IBGP
)

2287 
group
->
c⁄f
->
âl
 = 255;

2290 i‡(
	`≥î_s‹t
 (
group
->
c⁄f
Ë!
BGP_PEER_EBGP
)

2292 
group
->
c⁄f
->
ch™ge_loˇl_as
 = 0;

2293 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

2294 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

2298 i‡(
	`CHECK_FLAG
(
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

2300 
li°node
 *
≤
;

2305 i‡(! 
	`≥î_rs˛õ¡_a˘ive
 (
≥î
)

2306 && (
≤
 = 
	`li°node_lookup
 (
bgp
->
rs˛õ¡
, 
≥î
)))

2308 
	`≥î_u∆ock
 (
≥î
);

2309 
	`li°_dñëe_node
 (
bgp
->
rs˛õ¡
, 
≤
);

2312 
	`bgp_˛ór_rouã
 (
≥î
, 
afi
, 
ßfi
, 
BGP_CLEAR_ROUTE_MY_RSCLIENT
);

2315 
	`bgp_èbÀ_föish
 (&
≥î
->
rib
[
afi
][
ßfi
]);

2318 i‡(
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_IMPORT
].
«me
)

2320 
	`‰ì
 (
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_IMPORT
].
«me
);

2321 
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_IMPORT
].
«me
 = 
NULL
;

2322 
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_IMPORT
].m≠ = 
NULL
;

2326 i‡(! 
	`CHECK_FLAG
(
group
->
c⁄f
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
)

2327 && 
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_EXPORT
].
«me
)

2329 
	`‰ì
 (
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_EXPORT
].
«me
);

2330 
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_EXPORT
].
«me
 = 
NULL
;

2331 
≥î
->
fûãr
[
afi
][
ßfi
].
m≠
[
RMAP_EXPORT
].m≠ = 
NULL
;

2335 
	`≥î_group2≥î_c⁄fig_c›y
 (
group
, 
≥î
, 
afi
, 
ßfi
);

2337 i‡(
≥î
->
°©us
 =
E°ablished
)

2339 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_RMAP_BIND
;

2340 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

2341 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

2344 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

2347 
	}
}

2350 
	$≥î_group_unböd
 (
bgp
 *bgp, 
≥î
 *peer,

2351 
≥î_group
 *
group
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

2353 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

2356 i‡(
group
 !
≥î
->group)

2357  
BGP_ERR_PEER_GROUP_MISMATCH
;

2359 
≥î
->
af_group
[
afi
][
ßfi
] = 0;

2360 
≥î
->
afc
[
afi
][
ßfi
] = 0;

2361 
	`≥î_af_Êag_ª£t
 (
≥î
, 
afi
, 
ßfi
);

2363 i‡(
≥î
->
rib
[
afi
][
ßfi
])

2364 
≥î
->
rib
[
afi
][
ßfi
] = 
NULL
;

2366 i‡(! 
	`≥î_group_a˘ive
 (
≥î
))

2368 
	`as£π
 (
	`li°node_lookup
 (
group
->
≥î
,Öeer));

2369 
	`≥î_u∆ock
 (
≥î
);

2370 
	`li°node_dñëe
 (
group
->
≥î
,Öeer);

2371 
≥î
->
group
 = 
NULL
;

2372 i‡(
group
->
c⁄f
->
as
)

2374 
	`≥î_dñëe
 (
≥î
);

2377 
	`≥î_globÆ_c⁄fig_ª£t
 (
≥î
);

2380 i‡(
≥î
->
°©us
 =
E°ablished
)

2382 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_RMAP_UNBIND
;

2383 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

2384 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

2387 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

2390 
	}
}

2392 #ifde‡
USE_SRX


2394 
	$§xLockUpd©e
(
bgp_öfo
* 
öfo
)

2397 
	}
}

2399 
	$§xUnLockUpd©e
(
bgp_öfo
* 
öfo
)

2402 
	}
}

2414 
	$h™dÀSRxMesßges
(
SRxProxyCommCode
 
maöCode
, 
subCode
, * 
u£rPå
)

2417 
	`thªadC⁄åﬁCÆl
(()
maöCode
);

2418 
	}
}

2425 #i‡
deföed
 (
__TIME_MEASURE__
)

2426 
	~"libtm_rdtsc.h
"

2428 
boﬁ
 
	$h™dÀSRxVÆid©i⁄Resu…
 (
SRxUpd©eID
 
upd©eID
, 
uöt32_t
 
loˇlID
,

2429 
VÆid©i⁄Resu…Ty≥
 
vÆTy≥
,

2430 
uöt8_t
 
rﬂResu…
, uöt8_à
bgp£cResu…
,

2431 * 
bgpRouãr
)

2433 
bgp_öfo
* 
öfo
;

2434 
bgp
* bg∞(bgp*)
bgpRouãr
;

2436 
boﬁ
 
ªtVÆ
 = 
Ál£
;

2438 #i‡
	`deföed
 (
__TIME_MEASURE__
Ë&& !deföed (
USE_GRPC
)

2439 
vÆCou¡
=0;

2440 
g_mósuªCou¡
;

2441 
vÆ_íd_˛ock
;

2444 i‡(
loˇlID
 != 0)

2446 
öfo
 = 
	`bgp_öfo_„tch
(
bgp
->
öfo_lid_hash
, 
loˇlID
);

2447 i‡(
öfo
)

2450 
öfo
->
upd©eID
 = updateID;

2451 
	`bgp_öfo_ªgi°î
 (
bgp
->
öfo_uid_hash
, 
öfo
, 
upd©eID
);

2453 
	`bgp_öfo_uƒegi°î
 (
bgp
->
öfo_lid_hash
, 
loˇlID
);

2454 
öfo
->
loˇlID
 = 0;

2469 i‡–!
	`CHECK_FLAG
(
bgp
->
§x_c⁄fig
, 
SRX_CONFIG_EVAL_DISTR
))

2471 i‡(
bgp
->
§xCAPI
 !
NULL
 && 
öfo
->
©å
->
bgp£c_vÆid©i⁄D©a
 != NULL)

2475 
vÆResu…
 = 
bgp
->
§xCAPI
->
	`vÆid©e
(
öfo
->
©å
->
bgp£c_vÆid©i⁄D©a
);

2476 
bgp£cResu…
 = 
vÆResu…
 =
API_VALRESULT_VALID
 ? 
SRx_RESULT_VALID


2477 : 
SRx_RESULT_INVALID
;

2479 i‡(
bgp£cResu…
 =
SRx_RESULT_INVALID
)

2481 i‡((
öfo
->
©å
->
bgp£c_vÆid©i⁄D©a
->
°©us
 & 
API_STATUS_ERROR_MASK
) > 0)

2483 
	`zlog_îr
("Update [0x%08X] validationÑeturned invalid withánÉrror: status=0x%X\n",

2484 
upd©eID
, 
öfo
->
©å
->
bgp£c_vÆid©i⁄D©a
->
°©us
);

2488 
vÆTy≥
 |
VRT_BGPSEC
;

2491 
	`bgp_öfo_£t_vÆid©i⁄_ªsu…
 (
öfo
, 
vÆTy≥
, 
rﬂResu…
, 
bgp£cResu…
);

2492 
ªtVÆ
 = 
åue
;

2497 #i‡
	`deföed
 (
__TIME_MEASURE__
Ë&& !deföed (
USE_GRPC
)

2498 if(
vÆCou¡
 == 0)

2500 
˛k_t0
 = 
	`rdtsc
();

2504 
öfo
 = 
	`bgp_öfo_„tch
(
bgp
->
öfo_uid_hash
, 
upd©eID
);

2505 i‡(
öfo
)

2508 
	`bgp_öfo_£t_vÆid©i⁄_ªsu…
 (
öfo
, 
vÆTy≥
, 
rﬂResu…
, 
bgp£cResu…
);

2509 
ªtVÆ
 = 
åue
;

2511 #i‡
	`deföed
 (
__TIME_MEASURE__
Ë&& !deföed (
USE_GRPC
)

2512 
vÆCou¡
++;

2513 if(
vÆCou¡
 >
g_mósuªCou¡
)

2515 
vÆ_íd_˛ock
 = 
	`rdtsc
();

2516 
	`¥ötf
(" vÆid©êcou¡Ñóched %ldándÅîmö©ê\n", 
g_mósuªCou¡
);

2517 
vÆCou¡
 =0;

2519 
	`¥öt_˛ock_time
(
íd_˛ock
, 
°¨t_˛ock
, "ReceivingÅime");

2520 
	`¥öt_˛ock_time
(
vÆ_íd_˛ock
 , 
˛k_t0
, "validationÅime :");

2521 
	`¥öt_˛ock_time
(
vÆ_íd_˛ock
 , 
°¨t_˛ock
, "overallÅime (including validation) :");

2526 i‡(!
ªtVÆ
)

2528 
	`zlog_w¨n
("update [0x%08X] isÇot known, sendá deleteÅoÅhe server!",

2529 
upd©eID
);

2530 
	`dñëeUpd©e
(
bgp
->
§xProxy
, bgp->
§x_kìpWödow
, 
upd©eID
);

2534  
ªtVÆ
;

2535 
	}
}

2538 
	$h™dÀSRxSig«tuªs
(
SRxUpd©eID
 
upd©eID
, 
BGPSecCÆlbackD©a
* 
d©a
,

2539 * 
bgpRouãr
)

2544 
	`zlog_öfo
 ("*** Received SRx Signatures for update [0x%08X]! ***\n",

2545 
upd©eID
);

2547 
	}
}

2555 
	$_h™dÀSRxSynchReque°_¥o˚ssTabÀ
(
bgp
* bgp,

2556 
bgp_èbÀ
* 
èbÀ
)

2558 
bgp_öfo
 *
böfo
;

2559 
bgp_node
 *
bnode
;

2561 
SRxDeÁu…Resu…
 
defResu…
;

2564 
bnode
 = 
	`bgp_èbÀ_t›
(
èbÀ
); bnode; bnodê
	`bgp_rouã_√xt
(bnode))

2566 i‡(
bnode
->
öfo
 !
NULL
)

2568 
böfo
 = (
bgp_öfo
*)
bnode
->
öfo
;

2569 
	`§xLockUpd©e
(
böfo
);

2570 
defResu…
.
ªsSour˚ROA
 = 
SRxRS_ROUTER
;

2571 
defResu…
.
ªsSour˚BGPSEC
 = 
SRxRS_ROUTER
;

2572 
defResu…
.
ªsu…
.
rﬂResu…
 = 
böfo
->
vÆ_ªs_ROA
;

2573 
defResu…
.
ªsu…
.
bgp£cResu…
 = 
böfo
->
vÆ_ªs_BGPSEC
;

2574 
	`vîify_upd©e
 (
bgp
, 
böfo
, &
defResu…
, 
Ál£
);

2575 
	`§xUnLockUpd©e
(
böfo
);

2578 
	}
}

2589 
	$h™dÀSRxSynchReque°
(* 
bgpRouãr
)

2591 
	`zlog_öfo
 ("*** Received SRx Synchronization Request! ***\n");

2593 
bgp
* bg∞(bgp*)
bgpRouãr
;

2594 i‡(
bgp
 =
NULL
)

2596 
	`zlog_îr
("*** SRx didÇotÖrovide configured BGP session for "

2601 
	`_h™dÀSRxSynchReque°_¥o˚ssTabÀ
(
bgp
, bgp->
rib
[
AFI_IP
][
SAFI_MULTICAST
]);

2602 
	`_h™dÀSRxSynchReque°_¥o˚ssTabÀ
(
bgp
, bgp->
rib
[
AFI_IP
][
SAFI_UNICAST
]);

2603 
	}
}

2616 
	$§x_£t_deÁu…
(
bgp
 *bgp)

2619 if(!
bgp
->
öfo_uid_hash
)

2621 
bgp
->
öfo_uid_hash
 = 
	`bgp_öfo_hash_öô
();

2622 
bgp
->
öfo_lid_hash
 = 
	`bgp_öfo_hash_öô
();

2624 
	`§x_£t_¥oxyID
(
bgp
, 
	`¡ohl
(bgp->
rouãr_id
.
s_addr
));

2626 
bgp
->
§x_kìpWödow
 = 
SRX_KEEP_WINDOW
;

2627 
bgp
->
§x_h™dshakeTimeout
 = 
SRX_HANDHAKE_TIMEOUT
;

2630 
bgp
->
§x_vÆ_pﬁicy
 = 
SRX_VAL_POLICY_IGNORE_UNDEFINED
;

2634 
bgp
->
§x_c⁄fig
 = 
SRX_CONFIG_EVAL_ORIGIN


2635 | 
SRX_CONFIG_DISPLAY_INFO
;

2638 
bgp
->
§x_deÁu…_rﬂVÆ
 = 
SRx_RESULT_UNDEFINED
;

2639 
bgp
->
§x_deÁu…_bgp£cVÆ
 = 
SRx_RESULT_UNDEFINED
;

2642 
bgp
->
§xProxy
 = 
	`¸óãSRxProxy
(
h™dÀSRxVÆid©i⁄Resu…
, 
h™dÀSRxSig«tuªs
,

2643 
h™dÀSRxSynchReque°
, 
h™dÀSRxMesßges
,

2644 
bgp
->
§x_¥oxyID
, bgp->
as
, bgp);

2649 
bgp
->
§xCAPI
 = 
	`gëSrxCAPI
();

2660 
	`mem£t
(
bgp
->
§x_bgp£c_key
, 0,  (
BGPSecKey
));

2662 #ifde‡
USE_GRPC


2663 
	`gΩc_öô
(
bgp
->
§xProxy
, bgp->
§x_¥oxyID
);

2665 
	}
}

2671 
bgp
 *

2672 
	$bgp_¸óã
 (
as_t
 *
as
, c⁄° *
«me
)

2674 
bgp
 *bgp;

2675 
afi_t
 
afi
;

2676 
ßfi_t
 
ßfi
;

2678 i‡–(
bgp
 = 
	`XCALLOC
 (
MTYPE_BGP
,  (bgp))Ë=
NULL
)

2679  
NULL
;

2681 
	`bgp_lock
 (
bgp
);

2682 
bgp
->
≥î_£lf
 = 
	`≥î_√w
 (bgp);

2683 
bgp
->
≥î_£lf
->
ho°
 = 
	`XSTRDUP
 (
MTYPE_BGP_PEER_HOST
, "Staticánnouncement");

2685 
bgp
->
≥î
 = 
	`li°_√w
 ();

2686 
bgp
->
≥î
->
cmp
 = ((*)(*, *)Ë
≥î_cmp
;

2688 
bgp
->
group
 = 
	`li°_√w
 ();

2689 
bgp
->
group
->
cmp
 = ((*)(*, *)Ë
≥î_group_cmp
;

2691 
bgp
->
rs˛õ¡
 = 
	`li°_√w
 ();

2692 
bgp
->
rs˛õ¡
->
cmp
 = ((*)(*, *)Ë
≥î_cmp
;

2694 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

2695 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

2697 
bgp
->
rouã
[
afi
][
ßfi
] = 
	`bgp_èbÀ_öô
 (afi, safi);

2698 
bgp
->
aggªg©e
[
afi
][
ßfi
] = 
	`bgp_èbÀ_öô
 (afi, safi);

2699 
bgp
->
rib
[
afi
][
ßfi
] = 
	`bgp_èbÀ_öô
 (afi, safi);

2700 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ebgp
 = 
BGP_DEFAULT_MAXPATHS
;

2701 
bgp
->
max∑ths
[
afi
][
ßfi
].
max∑ths_ibgp
 = 
BGP_DEFAULT_MAXPATHS
;

2704 
bgp
->
deÁu…_loˇl_¥ef
 = 
BGP_DEFAULT_LOCAL_PREF
;

2705 
bgp
->
deÁu…_hﬁdtime
 = 
BGP_DEFAULT_HOLDTIME
;

2706 
bgp
->
deÁu…_kì∑live
 = 
BGP_DEFAULT_KEEPALIVE
;

2707 
bgp
->
ª°¨t_time
 = 
BGP_DEFAULT_RESTART_TIME
;

2708 
bgp
->
°Æï©h_time
 = 
BGP_DEFAULT_STALEPATH_TIME
;

2710 
bgp
->
as
 = *as;

2712 i‡(
«me
)

2713 
bgp
->
«me
 = 
	`°rdup
 (name);

2715 #ifde‡
USE_SRX


2716 
	`§x_£t_deÁu…
(
bgp
);

2719  
bgp
;

2720 
	}
}

2723 
bgp
 *

2724 
	$bgp_gë_deÁu…
 ()

2726 i‡(
bm
->
bgp
->
hód
)

2727  (
	`li°gëd©a
 (
	`li°hód
 (
bm
->
bgp
)));

2728  
NULL
;

2729 
	}
}

2732 
bgp
 *

2733 
	$bgp_lookup
 (
as_t
 
as
, c⁄° *
«me
)

2735 
bgp
 *bgp;

2736 
li°node
 *
node
, *
¬ode
;

2738 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

2739 i‡(
bgp
->
as
 ==ás

2740 && ((
bgp
->
«me
 =
NULL
 &&Çame == NULL)

2741 || (
bgp
->
«me
 &&Çamê&& 
	`°rcmp
 (bgp->name,Çame) == 0)))

2742  
bgp
;

2743  
NULL
;

2744 
	}
}

2747 
bgp
 *

2748 
	$bgp_lookup_by_«me
 (c⁄° *
«me
)

2750 
bgp
 *bgp;

2751 
li°node
 *
node
, *
¬ode
;

2753 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
node
, 
¬ode
, bgp))

2754 i‡((
bgp
->
«me
 =
NULL
 &&Çame == NULL)

2755 || (
bgp
->
«me
 &&Çamê&& 
	`°rcmp
 (bgp->name,Çame) == 0))

2756  
bgp
;

2757  
NULL
;

2758 
	}
}

2762 
	$bgp_gë
 (
bgp
 **
bgp_vÆ
, 
as_t
 *
as
, c⁄° *
«me
)

2764 
bgp
 *bgp;

2767 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_MULTIPLE_INSTANCE
))

2769 i‡(
«me
)

2770 
bgp
 = 
	`bgp_lookup_by_«me
 (
«me
);

2772 
bgp
 = 
	`bgp_gë_deÁu…
 ();

2775 i‡(
bgp
)

2777 i‡(
bgp
->
as
 != *as)

2779 *
as
 = 
bgp
->as;

2780  
BGP_ERR_INSTANCE_MISMATCH
;

2782 *
bgp_vÆ
 = 
bgp
;

2789 i‡(
«me
)

2790  
BGP_ERR_MULTIPLE_INSTANCE_NOT_SET
;

2793 
bgp
 = 
	`bgp_gë_deÁu…
 ();

2795 i‡(
bgp
)

2797 i‡(
bgp
->
as
 != *as)

2799 *
as
 = 
bgp
->as;

2800  
BGP_ERR_AS_MISMATCH
;

2802 *
bgp_vÆ
 = 
bgp
;

2807 
bgp
 = 
	`bgp_¸óã
 (
as
, 
«me
);

2808 
	`bgp_rouãr_id_£t
(
bgp
, &
rouãr_id_zebø
);

2809 *
bgp_vÆ
 = 
bgp
;

2812 i‡(
	`li°_i£m±y
(
bm
->
bgp
)

2813 && !
	`bgp_›ti⁄_check
 (
BGP_OPT_NO_LISTEN
))

2815 i‡(
	`bgp_sockë
 (
bm
->
p‹t
, bm->
addªss
) < 0)

2816  
BGP_ERR_INVALID_VALUE
;

2819 
	`li°node_add
 (
bm
->
bgp
, bgp);

2822 
	}
}

2826 
	$bgp_dñëe
 (
bgp
 *bgp)

2828 
≥î
 *peer;

2829 
≥î_group
 *
group
;

2830 
li°node
 *
node
;

2831 
li°node
 *
√xt
;

2832 
afi_t
 
afi
;

2833 
i
;

2836 
	`bgp_°©ic_dñëe
 (
bgp
);

2839 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

2840 
i
 = 0; i < 
ZEBRA_ROUTE_MAX
; i++)

2841 i‡(
i
 !
ZEBRA_ROUTE_BGP
)

2842 
	`bgp_ªdi°ribuã_un£t
 (
bgp
, 
afi
, 
i
);

2844 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
√xt
,Öeer))

2845 
	`≥î_dñëe
 (
≥î
);

2847 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
√xt
, group))

2848 
	`≥î_group_dñëe
 (
group
);

2850 
	`as£π
 (
	`li°cou¡
 (
bgp
->
rs˛õ¡
) == 0);

2852 i‡(
bgp
->
≥î_£lf
) {

2853 
	`≥î_dñëe
(
bgp
->
≥î_£lf
);

2854 
bgp
->
≥î_£lf
 = 
NULL
;

2860 
	`li°node_dñëe
 (
bm
->
bgp
, bgp);

2861 i‡(
	`li°_i£m±y
(
bm
->
bgp
))

2862 
	`bgp_˛o£
 ();

2864 
	`bgp_u∆ock
(
bgp
);

2867 
	}
}

2869 
bgp_‰ì
 (
bgp
 *);

2872 
	$bgp_lock
 (
bgp
 *bgp)

2874 ++
bgp
->
lock
;

2875 
	}
}

2878 
	$bgp_u∆ock
(
bgp
 *bgp)

2880 
	`as£π
(
bgp
->
lock
 > 0);

2881 i‡(--
bgp
->
lock
 == 0)

2882 
	`bgp_‰ì
 (
bgp
);

2883 
	}
}

2886 
	$bgp_‰ì
 (
bgp
 *bgp)

2888 
afi_t
 
afi
;

2889 
ßfi_t
 
ßfi
;

2891 
	`li°_dñëe
 (
bgp
->
group
);

2892 
	`li°_dñëe
 (
bgp
->
≥î
);

2893 
	`li°_dñëe
 (
bgp
->
rs˛õ¡
);

2895 i‡(
bgp
->
«me
)

2896 
	`‰ì
 (
bgp
->
«me
);

2898 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

2899 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

2901 i‡(
bgp
->
rouã
[
afi
][
ßfi
])

2902 
	`bgp_èbÀ_föish
 (&
bgp
->
rouã
[
afi
][
ßfi
]);

2903 i‡(
bgp
->
aggªg©e
[
afi
][
ßfi
])

2904 
	`bgp_èbÀ_föish
 (&
bgp
->
aggªg©e
[
afi
][
ßfi
]) ;

2905 i‡(
bgp
->
rib
[
afi
][
ßfi
])

2906 
	`bgp_èbÀ_föish
 (&
bgp
->
rib
[
afi
][
ßfi
]);

2909 #ifde‡
USE_SRX


2910 
	`bgp_öfo_hash_föish
 (&
bgp
->
öfo_uid_hash
);

2911 
	`bgp_öfo_hash_föish
 (&
bgp
->
öfo_lid_hash
);

2912 i‡(
bgp
->
§xProxy
)

2914 
	`ªÀa£SRxProxy
 (
bgp
->
§xProxy
);

2916 
kIdx
 = 0;

2917 ; 
kIdx
 < 
SRX_MAX_PRIVKEYS
; kIdx++)

2919 i‡(
bgp
->
§x_bgp£c_key
[
kIdx
].
keyLígth
 > 0)

2921 
	`‰ì
(
bgp
->
§x_bgp£c_key
[
kIdx
].
keyD©a
);

2924 
	`mem£t
(
bgp
->
§x_bgp£c_key
, 0, (
BGPSecKey
Ë* 
SRX_MAX_PRIVKEYS
);

2927 
	`XFREE
 (
MTYPE_BGP
, 
bgp
);

2928 
	}
}

2930 
≥î
 *

2931 
	$≥î_lookup
 (
bgp
 *bgp, 
sockuni⁄
 *
su
)

2933 
≥î
 *peer;

2934 
li°node
 *
node
, *
¬ode
;

2936 i‡(
bgp
 !
NULL
)

2938 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

2939 i‡(
	`sockuni⁄_ßme
 (&
≥î
->
su
, su)

2940 && ! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

2941  
≥î
;

2943 i‡(
bm
->
bgp
 !
NULL
)

2945 
li°node
 *
bg≤ode
, *
nbg≤ode
;

2947 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
bg≤ode
, 
nbg≤ode
, bgp))

2948 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

2949 i‡(
	`sockuni⁄_ßme
 (&
≥î
->
su
, su)

2950 && ! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

2951  
≥î
;

2953  
NULL
;

2954 
	}
}

2956 
≥î
 *

2957 
	$≥î_lookup_wôh_›í
 (
sockuni⁄
 *
su
, 
as_t
 
ªmŸe_as
,

2958 
ö_addr
 *
ªmŸe_id
, *
as
)

2960 
≥î
 *peer;

2961 
li°node
 *
node
;

2962 
li°node
 *
bg≤ode
;

2963 
bgp
 *bgp;

2965 i‡(! 
bm
->
bgp
)

2966  
NULL
;

2968 
	`ALL_LIST_ELEMENTS_RO
 (
bm
->
bgp
, 
bg≤ode
, bgp))

2970 
	`ALL_LIST_ELEMENTS_RO
 (
bgp
->
≥î
, 
node
,Öeer))

2972 i‡(
	`sockuni⁄_ßme
 (&
≥î
->
su
, su)

2973 && ! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

2975 i‡(
≥î
->
as
 =
ªmŸe_as


2976 && 
≥î
->
ªmŸe_id
.
s_addr
 ==Ñemote_id->s_addr)

2977  
≥î
;

2978 i‡(
≥î
->
as
 =
ªmŸe_as
)

2979 *
as
 = 1;

2983 
	`ALL_LIST_ELEMENTS_RO
 (
bgp
->
≥î
, 
node
,Öeer))

2985 i‡(
	`sockuni⁄_ßme
 (&
≥î
->
su
, su)

2986 && ! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

2988 i‡(
≥î
->
as
 =
ªmŸe_as


2989 && 
≥î
->
ªmŸe_id
.
s_addr
 == 0)

2990  
≥î
;

2991 i‡(
≥î
->
as
 =
ªmŸe_as
)

2992 *
as
 = 1;

2996  
NULL
;

2997 
	}
}

3001 
	$≥î_a˘ive
 (
≥î
 *peer)

3003 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_UNICAST
]

3004 || 
≥î
->
afc
[
AFI_IP
][
SAFI_MULTICAST
]

3005 || 
≥î
->
afc
[
AFI_IP
][
SAFI_MPLS_VPN
]

3006 || 
≥î
->
afc
[
AFI_IP6
][
SAFI_UNICAST
]

3007 || 
≥î
->
afc
[
AFI_IP6
][
SAFI_MULTICAST
])

3010 
	}
}

3014 
	$≥î_a˘ive_√go
 (
≥î
 *peer)

3016 i‡(
≥î
->
afc_√go
[
AFI_IP
][
SAFI_UNICAST
]

3017 || 
≥î
->
afc_√go
[
AFI_IP
][
SAFI_MULTICAST
]

3018 || 
≥î
->
afc_√go
[
AFI_IP
][
SAFI_MPLS_VPN
]

3019 || 
≥î
->
afc_√go
[
AFI_IP6
][
SAFI_UNICAST
]

3020 || 
≥î
->
afc_√go
[
AFI_IP6
][
SAFI_MULTICAST
])

3023 
	}
}

3026 
	e≥î_ch™ge_ty≥


3028 
	m≥î_ch™ge_n⁄e
,

3029 
	m≥î_ch™ge_ª£t
,

3030 
	m≥î_ch™ge_ª£t_ö
,

3031 
	m≥î_ch™ge_ª£t_out
,

3035 
	$≥î_ch™ge_a˘i⁄
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

3036 
≥î_ch™ge_ty≥
 
ty≥
)

3038 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3041 i‡(
ty≥
 =
≥î_ch™ge_ª£t
)

3042 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3043 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3044 i‡(
ty≥
 =
≥î_ch™ge_ª£t_ö
)

3046 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_OLD_RCV
)

3047 || 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
))

3048 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
, 0, 0, 0);

3050 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3051 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3053 i‡(
ty≥
 =
≥î_ch™ge_ª£t_out
)

3054 
	`bgp_™noun˚_rouã
 (
≥î
, 
afi
, 
ßfi
);

3055 
	}
}

3057 
	s≥î_Êag_a˘i⁄


3060 
u_öt32_t
 
	mÊag
;

3063 
u_ch¨
 
	mnŸ_f‹_membî
;

3066 
≥î_ch™ge_ty≥
 
	mty≥
;

3069 
u_ch¨
 
	m≥î_down
;

3072 c⁄° 
≥î_Êag_a˘i⁄
 
	g≥î_Êag_a˘i⁄_li°
[] =

3074 { 
PEER_FLAG_PASSIVE
, 0, 
≥î_ch™ge_ª£t
 },

3075 { 
PEER_FLAG_SHUTDOWN
, 0, 
≥î_ch™ge_ª£t
 },

3076 { 
PEER_FLAG_DONT_CAPABILITY
, 0, 
≥î_ch™ge_n⁄e
 },

3077 { 
PEER_FLAG_OVERRIDE_CAPABILITY
, 0, 
≥î_ch™ge_n⁄e
 },

3078 { 
PEER_FLAG_STRICT_CAP_MATCH
, 0, 
≥î_ch™ge_n⁄e
 },

3079 { 
PEER_FLAG_DYNAMIC_CAPABILITY
, 0, 
≥î_ch™ge_ª£t
 },

3080 { 
PEER_FLAG_DISABLE_CONNECTED_CHECK
, 0, 
≥î_ch™ge_ª£t
 },

3081 #ifde‡
USE_SRX


3084 { 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
, 0, 
≥î_ch™ge_n⁄e
 },

3085 { 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
, 0, 
≥î_ch™ge_n⁄e
 },

3086 { 
PEER_FLAG_BGPSEC_MPE_IPV4
, 0, 
≥î_ch™ge_n⁄e
 },

3087 { 
PEER_FLAG_BGPSEC_MIGRATE
, 0, 
≥î_ch™ge_n⁄e
 },

3088 { 
PEER_FLAG_BGPSEC_ROUTE_SERVER
, 0, 
≥î_ch™ge_n⁄e
 },

3089 { 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
, 0, 
≥î_ch™ge_n⁄e
 },

3090 { 
PEER_FLAG_EXTENDED_MESSAGE_LIBERAL
, 0, 
≥î_ch™ge_n⁄e
 },

3095 c⁄° 
≥î_Êag_a˘i⁄
 
	g≥î_af_Êag_a˘i⁄_li°
[] =

3097 { 
PEER_FLAG_NEXTHOP_SELF
, 1, 
≥î_ch™ge_ª£t_out
 },

3098 { 
PEER_FLAG_SEND_COMMUNITY
, 1, 
≥î_ch™ge_ª£t_out
 },

3099 { 
PEER_FLAG_SEND_EXT_COMMUNITY
, 1, 
≥î_ch™ge_ª£t_out
 },

3100 { 
PEER_FLAG_SOFT_RECONFIG
, 0, 
≥î_ch™ge_ª£t_ö
 },

3101 { 
PEER_FLAG_REFLECTOR_CLIENT
, 1, 
≥î_ch™ge_ª£t
 },

3102 { 
PEER_FLAG_RSERVER_CLIENT
, 1, 
≥î_ch™ge_ª£t
 },

3103 { 
PEER_FLAG_AS_PATH_UNCHANGED
, 1, 
≥î_ch™ge_ª£t_out
 },

3104 { 
PEER_FLAG_NEXTHOP_UNCHANGED
, 1, 
≥î_ch™ge_ª£t_out
 },

3105 { 
PEER_FLAG_MED_UNCHANGED
, 1, 
≥î_ch™ge_ª£t_out
 },

3106 { 
PEER_FLAG_REMOVE_PRIVATE_AS
, 1, 
≥î_ch™ge_ª£t_out
 },

3107 { 
PEER_FLAG_ALLOWAS_IN
, 0, 
≥î_ch™ge_ª£t_ö
 },

3108 { 
PEER_FLAG_ORF_PREFIX_SM
, 1, 
≥î_ch™ge_ª£t
 },

3109 { 
PEER_FLAG_ORF_PREFIX_RM
, 1, 
≥î_ch™ge_ª£t
 },

3110 { 
PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
, 0, 
≥î_ch™ge_ª£t_out
 },

3116 
	$≥î_Êag_a˘i⁄_£t
 (c⁄° 
≥î_Êag_a˘i⁄
 *
a˘i⁄_li°
, 
size
,

3117 
≥î_Êag_a˘i⁄
 *
a˘i⁄
, 
u_öt32_t
 
Êag
)

3119 
i
;

3120 
found
 = 0;

3121 
ª£t_ö
 = 0;

3122 
ª£t_out
 = 0;

3123 c⁄° 
≥î_Êag_a˘i⁄
 *
m©ch
 = 
NULL
;

3126 
i
 = 0; i < 
size
; i++)

3128 
m©ch
 = &
a˘i⁄_li°
[
i
];

3130 i‡(
m©ch
->
Êag
 == 0)

3133 i‡(
m©ch
->
Êag
 & flag)

3135 
found
 = 1;

3137 i‡(
m©ch
->
ty≥
 =
≥î_ch™ge_ª£t_ö
)

3138 
ª£t_ö
 = 1;

3139 i‡(
m©ch
->
ty≥
 =
≥î_ch™ge_ª£t_out
)

3140 
ª£t_out
 = 1;

3141 i‡(
m©ch
->
ty≥
 =
≥î_ch™ge_ª£t
)

3143 
ª£t_ö
 = 1;

3144 
ª£t_out
 = 1;

3146 i‡(
m©ch
->
nŸ_f‹_membî
)

3147 
a˘i⁄
->
nŸ_f‹_membî
 = 1;

3152 i‡(
ª£t_ö
 && 
ª£t_out
)

3153 
a˘i⁄
->
ty≥
 = 
≥î_ch™ge_ª£t
;

3154 i‡(
ª£t_ö
)

3155 
a˘i⁄
->
ty≥
 = 
≥î_ch™ge_ª£t_ö
;

3156 i‡(
ª£t_out
)

3157 
a˘i⁄
->
ty≥
 = 
≥î_ch™ge_ª£t_out
;

3159 
a˘i⁄
->
ty≥
 = 
≥î_ch™ge_n⁄e
;

3161  
found
;

3162 
	}
}

3165 
	$≥î_Êag_modify_a˘i⁄
 (
≥î
 *≥î, 
u_öt32_t
 
Êag
)

3167 i‡(
Êag
 =
PEER_FLAG_SHUTDOWN
)

3169 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
Êag
))

3171 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
))

3172 
	`≥î_nsf_°›
 (
≥î
);

3174 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
);

3175 i‡(
≥î
->
t_pmax_ª°¨t
)

3177 
	`BGP_TIMER_OFF
 (
≥î
->
t_pmax_ª°¨t
);

3178 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

3179 
	`zlog_debug
 ("%s Maximum-prefixÑestartÅimer canceled",

3180 
≥î
->
ho°
);

3183 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_NSF_WAIT
))

3184 
	`≥î_nsf_°›
 (
≥î
);

3186 i‡(
≥î
->
°©us
 =
E°ablished
)

3187 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3188 
BGP_NOTIFY_CEASE_ADMIN_SHUTDOWN
);

3190 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3194 
≥î
->
v_°¨t
 = 
BGP_INIT_START_TIMER
;

3195 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3198 i‡(
≥î
->
°©us
 =
E°ablished
)

3200 i‡(
Êag
 =
PEER_FLAG_DYNAMIC_CAPABILITY
)

3201 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CAPABILITY_CHANGE
;

3202 i‡(
Êag
 =
PEER_FLAG_PASSIVE
)

3203 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_PASSIVE_CHANGE
;

3204 i‡(
Êag
 =
PEER_FLAG_DISABLE_CONNECTED_CHECK
)

3205 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_MULTIHOP_CHANGE
;

3207 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3208 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3211 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3212 
	}
}

3216 
	$≥î_Êag_modify
 (
≥î
 *≥î, 
u_öt32_t
 
Êag
, 
£t
)

3218 
found
;

3219 
size
;

3220 
≥î_group
 *
group
;

3221 
li°node
 *
node
, *
¬ode
;

3222 
≥î_Êag_a˘i⁄
 
a˘i⁄
;

3224 
	`mem£t
 (&
a˘i⁄
, 0,  (
≥î_Êag_a˘i⁄
));

3225 
size
 =  
≥î_Êag_a˘i⁄_li°
 /  (
≥î_Êag_a˘i⁄
);

3227 
found
 = 
	`≥î_Êag_a˘i⁄_£t
 (
≥î_Êag_a˘i⁄_li°
, 
size
, &
a˘i⁄
, 
Êag
);

3230 i‡(! 
found
)

3231  
BGP_ERR_INVALID_FLAG
;

3234 i‡(
a˘i⁄
.
nŸ_f‹_membî
 && 
	`≥î_group_a˘ive
 (
≥î
))

3235  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

3239 i‡(! 
£t
 && 
	`≥î_group_a˘ive
 (
≥î
))

3240 i‡(
	`CHECK_FLAG
 (
≥î
->
group
->
c⁄f
->
Êags
, 
Êag
))

3242 i‡(
Êag
 =
PEER_FLAG_SHUTDOWN
)

3243  
BGP_ERR_PEER_GROUP_SHUTDOWN
;

3245  
BGP_ERR_PEER_GROUP_HAS_THE_FLAG
;

3249 i‡(
£t


3250 && 
	`CHECK_FLAG
 (
≥î
->
Êags
 | 
Êag
, 
PEER_FLAG_STRICT_CAP_MATCH
)

3251 && 
	`CHECK_FLAG
 (
≥î
->
Êags
 | 
Êag
, 
PEER_FLAG_OVERRIDE_CAPABILITY
))

3252  
BGP_ERR_PEER_FLAG_CONFLICT
;

3254 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3256 i‡(
£t
 && 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
Êag
) == flag)

3258 i‡(! 
£t
 && ! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
Êag
))

3262 i‡(
£t
)

3263 
	`SET_FLAG
 (
≥î
->
Êags
, 
Êag
);

3265 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
Êag
);

3267 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3269 i‡(
a˘i⁄
.
ty≥
 =
≥î_ch™ge_ª£t
)

3270 
	`≥î_Êag_modify_a˘i⁄
 (
≥î
, 
Êag
);

3276 
group
 = 
≥î
->group;

3278 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3280 i‡(
£t
 && 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
Êag
) == flag)

3283 i‡(! 
£t
 && ! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
Êag
))

3286 i‡(
£t
)

3287 
	`SET_FLAG
 (
≥î
->
Êags
, 
Êag
);

3289 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
Êag
);

3291 i‡(
a˘i⁄
.
ty≥
 =
≥î_ch™ge_ª£t
)

3292 
	`≥î_Êag_modify_a˘i⁄
 (
≥î
, 
Êag
);

3295 
	}
}

3298 
	$≥î_Êag_£t
 (
≥î
 *≥î, 
u_öt32_t
 
Êag
)

3300  
	`≥î_Êag_modify
 (
≥î
, 
Êag
, 1);

3301 
	}
}

3304 
	$≥î_Êag_un£t
 (
≥î
 *≥î, 
u_öt32_t
 
Êag
)

3306  
	`≥î_Êag_modify
 (
≥î
, 
Êag
, 0);

3307 
	}
}

3310 
	$≥î_is_group_membî
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

3312 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

3315 
	}
}

3318 
	$≥î_af_Êag_modify
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
Êag
,

3319 
£t
)

3321 
found
;

3322 
size
;

3323 
li°node
 *
node
, *
¬ode
;

3324 
≥î_group
 *
group
;

3325 
≥î_Êag_a˘i⁄
 
a˘i⁄
;

3327 
	`mem£t
 (&
a˘i⁄
, 0,  (
≥î_Êag_a˘i⁄
));

3328 
size
 =  
≥î_af_Êag_a˘i⁄_li°
 /  (
≥î_Êag_a˘i⁄
);

3330 
found
 = 
	`≥î_Êag_a˘i⁄_£t
 (
≥î_af_Êag_a˘i⁄_li°
, 
size
, &
a˘i⁄
, 
Êag
);

3333 i‡(! 
found
)

3334  
BGP_ERR_INVALID_FLAG
;

3337 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

3338  
BGP_ERR_PEER_INACTIVE
;

3341 i‡(
a˘i⁄
.
nŸ_f‹_membî
 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

3342  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

3345 i‡(
Êag
 & 
PEER_FLAG_REFLECTOR_CLIENT


3346 && 
	`≥î_s‹t
 (
≥î
Ë!
BGP_PEER_IBGP
)

3347  
BGP_ERR_NOT_INTERNAL_PEER
;

3350 i‡(
Êag
 & 
PEER_FLAG_REMOVE_PRIVATE_AS


3351 && 
	`≥î_s‹t
 (
≥î
Ë=
BGP_PEER_IBGP
)

3352  
BGP_ERR_REMOVE_PRIVATE_AS
;

3356 i‡(! 
£t
 && 
≥î
->
af_group
[
afi
][
ßfi
])

3357 i‡(
	`CHECK_FLAG
 (
≥î
->
group
->
c⁄f
->
af_Êags
[
afi
][
ßfi
], 
Êag
))

3358  
BGP_ERR_PEER_GROUP_HAS_THE_FLAG
;

3361 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3363 i‡(
£t
 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
) == flag)

3365 i‡(! 
£t
 && ! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
))

3369 i‡(
£t
)

3370 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
);

3372 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
);

3375 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
)

3376 && 
≥î
->
°©us
 =
E°ablished
)

3378 i‡(! 
£t
 && 
Êag
 =
PEER_FLAG_SOFT_RECONFIG
)

3379 
	`bgp_˛ór_adj_ö
 (
≥î
, 
afi
, 
ßfi
);

3382 i‡(
Êag
 =
PEER_FLAG_REFLECTOR_CLIENT
)

3383 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_RR_CLIENT_CHANGE
;

3384 i‡(
Êag
 =
PEER_FLAG_RSERVER_CLIENT
)

3385 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_RS_CLIENT_CHANGE
;

3386 i‡(
Êag
 =
PEER_FLAG_ORF_PREFIX_SM
)

3387 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CAPABILITY_CHANGE
;

3388 i‡(
Êag
 =
PEER_FLAG_ORF_PREFIX_RM
)

3389 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CAPABILITY_CHANGE
;

3391 
	`≥î_ch™ge_a˘i⁄
 (
≥î
, 
afi
, 
ßfi
, 
a˘i⁄
.
ty≥
);

3397 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3399 
group
 = 
≥î
->group;

3401 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3403 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

3406 i‡(
£t
 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
) == flag)

3409 i‡(! 
£t
 && ! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
))

3412 i‡(
£t
)

3413 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
);

3415 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
Êag
);

3417 i‡(
≥î
->
°©us
 =
E°ablished
)

3419 i‡(! 
£t
 && 
Êag
 =
PEER_FLAG_SOFT_RECONFIG
)

3420 
	`bgp_˛ór_adj_ö
 (
≥î
, 
afi
, 
ßfi
);

3423 i‡(
Êag
 =
PEER_FLAG_REFLECTOR_CLIENT
)

3424 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_RR_CLIENT_CHANGE
;

3425 i‡(
Êag
 =
PEER_FLAG_RSERVER_CLIENT
)

3426 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_RS_CLIENT_CHANGE
;

3427 i‡(
Êag
 =
PEER_FLAG_ORF_PREFIX_SM
)

3428 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CAPABILITY_CHANGE
;

3429 i‡(
Êag
 =
PEER_FLAG_ORF_PREFIX_RM
)

3430 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_CAPABILITY_CHANGE
;

3432 
	`≥î_ch™ge_a˘i⁄
 (
≥î
, 
afi
, 
ßfi
, 
a˘i⁄
.
ty≥
);

3438 
	}
}

3441 
	$≥î_af_Êag_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
Êag
)

3443  
	`≥î_af_Êag_modify
 (
≥î
, 
afi
, 
ßfi
, 
Êag
, 1);

3444 
	}
}

3447 
	$≥î_af_Êag_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
Êag
)

3449  
	`≥î_af_Êag_modify
 (
≥î
, 
afi
, 
ßfi
, 
Êag
, 0);

3450 
	}
}

3454 
	$≥î_ebgp_mu…ih›_£t
 (
≥î
 *≥î, 
âl
)

3456 
≥î_group
 *
group
;

3457 
li°node
 *
node
, *
¬ode
;

3458 
≥î
 *
≥î1
;

3460 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

3464 i‡(
âl
 !
MAXTTL
)

3466 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3468 
group
 = 
≥î
->group;

3469 i‡(
group
->
c⁄f
->
gtsm_h›s
 != 0)

3470  
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
;

3472 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
, 
≥î1
))

3474 i‡(
≥î1
->
s‹t
 =
BGP_PEER_IBGP
)

3477 i‡(
≥î1
->
gtsm_h›s
 != 0)

3478  
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
;

3483 i‡(
≥î
->
gtsm_h›s
 != 0)

3484  
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
;

3488 
≥î
->
âl
 =Åtl;

3490 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3492 i‡(
≥î
->
fd
 >0 &&Öìr->
s‹t
 !
BGP_PEER_IBGP
)

3493 
	`sock›t_âl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
,Öìr->
âl
);

3497 
group
 = 
≥î
->group;

3498 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3500 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

3503 
≥î
->
âl
 = 
group
->
c⁄f
->ttl;

3505 i‡(
≥î
->
fd
 >= 0)

3506 
	`sock›t_âl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
,Öìr->
âl
);

3510 
	}
}

3513 
	$≥î_ebgp_mu…ih›_un£t
 (
≥î
 *peer)

3515 
≥î_group
 *
group
;

3516 
li°node
 *
node
, *
¬ode
;

3518 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

3521 i‡(
≥î
->
gtsm_h›s
 !0 &&Öìr->
âl
 !
MAXTTL
)

3522  
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
;

3524 i‡(
	`≥î_group_a˘ive
 (
≥î
))

3525 
≥î
->
âl
 =Öìr->
group
->
c⁄f
->ttl;

3527 
≥î
->
âl
 = 1;

3529 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3531 i‡(
≥î
->
fd
 >0 &&Öìr->
s‹t
 !
BGP_PEER_IBGP
)

3532 
	`sock›t_âl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
,Öìr->
âl
);

3536 
group
 = 
≥î
->group;

3537 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3539 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

3542 
≥î
->
âl
 = 1;

3544 i‡(
≥î
->
fd
 >= 0)

3545 
	`sock›t_âl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
,Öìr->
âl
);

3549 
	}
}

3553 
	$≥î_des¸ùti⁄_£t
 (
≥î
 *≥î, *
desc
)

3555 i‡(
≥î
->
desc
)

3556 
	`XFREE
 (
MTYPE_PEER_DESC
, 
≥î
->
desc
);

3558 
≥î
->
desc
 = 
	`XSTRDUP
 (
MTYPE_PEER_DESC
, desc);

3561 
	}
}

3564 
	$≥î_des¸ùti⁄_un£t
 (
≥î
 *peer)

3566 i‡(
≥î
->
desc
)

3567 
	`XFREE
 (
MTYPE_PEER_DESC
, 
≥î
->
desc
);

3569 
≥î
->
desc
 = 
NULL
;

3572 
	}
}

3576 
	$≥î_upd©e_sour˚_if_£t
 (
≥î
 *≥î, c⁄° *
i‚ame
)

3578 
≥î_group
 *
group
;

3579 
li°node
 *
node
, *
¬ode
;

3581 i‡(
≥î
->
upd©e_if
)

3583 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
)

3584 && 
	`°rcmp
 (
≥î
->
upd©e_if
, 
i‚ame
) == 0)

3587 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

3588 
≥î
->
upd©e_if
 = 
NULL
;

3591 i‡(
≥î
->
upd©e_sour˚
)

3593 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

3594 
≥î
->
upd©e_sour˚
 = 
NULL
;

3597 
≥î
->
upd©e_if
 = 
	`XSTRDUP
 (
MTYPE_PEER_UPDATE_SOURCE
, 
i‚ame
);

3599 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3601 i‡(
≥î
->
°©us
 =
E°ablished
)

3603 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_UPDATE_SOURCE_CHANGE
;

3604 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3605 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3608 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3613 
group
 = 
≥î
->group;

3614 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3616 i‡(
≥î
->
upd©e_if
)

3618 i‡(
	`°rcmp
 (
≥î
->
upd©e_if
, 
i‚ame
) == 0)

3621 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

3622 
≥î
->
upd©e_if
 = 
NULL
;

3625 i‡(
≥î
->
upd©e_sour˚
)

3627 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

3628 
≥î
->
upd©e_sour˚
 = 
NULL
;

3631 
≥î
->
upd©e_if
 = 
	`XSTRDUP
 (
MTYPE_PEER_UPDATE_SOURCE
, 
i‚ame
);

3633 i‡(
≥î
->
°©us
 =
E°ablished
)

3635 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_UPDATE_SOURCE_CHANGE
;

3636 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3637 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3640 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3643 
	}
}

3646 
	$≥î_upd©e_sour˚_addr_£t
 (
≥î
 *≥î, 
sockuni⁄
 *
su
)

3648 
≥î_group
 *
group
;

3649 
li°node
 *
node
, *
¬ode
;

3651 i‡(
≥î
->
upd©e_sour˚
)

3653 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
)

3654 && 
	`sockuni⁄_cmp
 (
≥î
->
upd©e_sour˚
, 
su
) == 0)

3656 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

3657 
≥î
->
upd©e_sour˚
 = 
NULL
;

3660 i‡(
≥î
->
upd©e_if
)

3662 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

3663 
≥î
->
upd©e_if
 = 
NULL
;

3666 
≥î
->
upd©e_sour˚
 = 
	`sockuni⁄_dup
 (
su
);

3668 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3670 i‡(
≥î
->
°©us
 =
E°ablished
)

3672 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_UPDATE_SOURCE_CHANGE
;

3673 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3674 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3677 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3682 
group
 = 
≥î
->group;

3683 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3685 i‡(
≥î
->
upd©e_sour˚
)

3687 i‡(
	`sockuni⁄_cmp
 (
≥î
->
upd©e_sour˚
, 
su
) == 0)

3689 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

3690 
≥î
->
upd©e_sour˚
 = 
NULL
;

3693 i‡(
≥î
->
upd©e_if
)

3695 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

3696 
≥î
->
upd©e_if
 = 
NULL
;

3699 
≥î
->
upd©e_sour˚
 = 
	`sockuni⁄_dup
 (
su
);

3701 i‡(
≥î
->
°©us
 =
E°ablished
)

3703 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_UPDATE_SOURCE_CHANGE
;

3704 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3705 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3708 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3711 
	}
}

3714 
	$≥î_upd©e_sour˚_un£t
 (
≥î
 *peer)

3716 
sockuni⁄
 *
su
;

3717 
≥î_group
 *
group
;

3718 
li°node
 *
node
, *
¬ode
;

3720 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
)

3721 && ! 
≥î
->
upd©e_sour˚


3722 && ! 
≥î
->
upd©e_if
)

3725 i‡(
≥î
->
upd©e_sour˚
)

3727 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

3728 
≥î
->
upd©e_sour˚
 = 
NULL
;

3730 i‡(
≥î
->
upd©e_if
)

3732 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

3733 
≥î
->
upd©e_if
 = 
NULL
;

3736 i‡(
	`≥î_group_a˘ive
 (
≥î
))

3738 
group
 = 
≥î
->group;

3740 i‡(
group
->
c⁄f
->
upd©e_sour˚
)

3742 
su
 = 
	`sockuni⁄_dup
 (
group
->
c⁄f
->
upd©e_sour˚
);

3743 
≥î
->
upd©e_sour˚
 = 
su
;

3745 i‡(
group
->
c⁄f
->
upd©e_if
)

3746 
≥î
->
upd©e_if
 =

3747 
	`XSTRDUP
 (
MTYPE_PEER_UPDATE_SOURCE
, 
group
->
c⁄f
->
upd©e_if
);

3750 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3752 i‡(
≥î
->
°©us
 =
E°ablished
)

3754 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_UPDATE_SOURCE_CHANGE
;

3755 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3756 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3759 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3764 
group
 = 
≥î
->group;

3765 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3767 i‡(! 
≥î
->
upd©e_sour˚
 && !Öìr->
upd©e_if
)

3770 i‡(
≥î
->
upd©e_sour˚
)

3772 
	`sockuni⁄_‰ì
 (
≥î
->
upd©e_sour˚
);

3773 
≥î
->
upd©e_sour˚
 = 
NULL
;

3776 i‡(
≥î
->
upd©e_if
)

3778 
	`XFREE
 (
MTYPE_PEER_UPDATE_SOURCE
, 
≥î
->
upd©e_if
);

3779 
≥î
->
upd©e_if
 = 
NULL
;

3782 i‡(
≥î
->
°©us
 =
E°ablished
)

3784 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_UPDATE_SOURCE_CHANGE
;

3785 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

3786 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

3789 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

3792 
	}
}

3795 
	$≥î_deÁu…_‹igö©e_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

3796 c⁄° *
rm≠
)

3798 
≥î_group
 *
group
;

3799 
li°node
 *
node
, *
¬ode
;

3802 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

3803  
BGP_ERR_PEER_INACTIVE
;

3806 i‡(
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

3807  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

3809 i‡(! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
)

3810 || (
rm≠
 && ! 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

3811 || (
rm≠
 && 
	`°rcmp
 (rm≠, 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
) != 0))

3813 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
);

3815 i‡(
rm≠
)

3817 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

3818 
	`‰ì
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

3819 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
 = 
	`°rdup
 (
rm≠
);

3820 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (
rm≠
);

3824 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3826 i‡(
≥î
->
°©us
 =
E°ablished
 &&Öìr->
afc_√go
[
afi
][
ßfi
])

3827 
	`bgp_deÁu…_‹igö©e
 (
≥î
, 
afi
, 
ßfi
, 0);

3832 
group
 = 
≥î
->group;

3833 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3835 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
);

3837 i‡(
rm≠
)

3839 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

3840 
	`‰ì
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

3841 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
 = 
	`°rdup
 (
rm≠
);

3842 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (
rm≠
);

3845 i‡(
≥î
->
°©us
 =
E°ablished
 &&Öìr->
afc_√go
[
afi
][
ßfi
])

3846 
	`bgp_deÁu…_‹igö©e
 (
≥î
, 
afi
, 
ßfi
, 0);

3849 
	}
}

3852 
	$≥î_deÁu…_‹igö©e_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

3854 
≥î_group
 *
group
;

3855 
li°node
 *
node
, *
¬ode
;

3858 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

3859  
BGP_ERR_PEER_INACTIVE
;

3862 i‡(
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

3863  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

3865 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
))

3867 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
);

3869 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

3870 
	`‰ì
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

3871 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
 = 
NULL
;

3872 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 = 
NULL
;

3875 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3877 i‡(
≥î
->
°©us
 =
E°ablished
 &&Öìr->
afc_√go
[
afi
][
ßfi
])

3878 
	`bgp_deÁu…_‹igö©e
 (
≥î
, 
afi
, 
ßfi
, 1);

3883 
group
 = 
≥î
->group;

3884 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3886 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_DEFAULT_ORIGINATE
);

3888 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

3889 
	`‰ì
 (
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

3890 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
 = 
NULL
;

3891 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
m≠
 = 
NULL
;

3893 i‡(
≥î
->
°©us
 =
E°ablished
 &&Öìr->
afc_√go
[
afi
][
ßfi
])

3894 
	`bgp_deÁu…_‹igö©e
 (
≥î
, 
afi
, 
ßfi
, 1);

3897 
	}
}

3900 
	$≥î_p‹t_£t
 (
≥î
 *≥î, 
u_öt16_t
 
p‹t
)

3902 
≥î
->
p‹t
 =Öort;

3904 
	}
}

3907 
	$≥î_p‹t_un£t
 (
≥î
 *peer)

3909 
≥î
->
p‹t
 = 
BGP_PORT_DEFAULT
;

3911 
	}
}

3915 
	$≥î_weight_£t
 (
≥î
 *≥î, 
u_öt16_t
 
weight
)

3917 
≥î_group
 *
group
;

3918 
li°node
 *
node
, *
¬ode
;

3920 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_WEIGHT
);

3921 
≥î
->
weight
 = weight;

3923 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3927 
group
 = 
≥î
->group;

3928 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3930 
≥î
->
weight
 = 
group
->
c⁄f
->weight;

3933 
	}
}

3936 
	$≥î_weight_un£t
 (
≥î
 *peer)

3938 
≥î_group
 *
group
;

3939 
li°node
 *
node
, *
¬ode
;

3942 i‡(
	`≥î_group_a˘ive
 (
≥î
))

3943 
≥î
->
weight
 =Öìr->
group
->
c⁄f
->weight;

3945 
≥î
->
weight
 = 0;

3947 
	`UNSET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_WEIGHT
);

3949 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3953 
group
 = 
≥î
->group;

3954 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3956 
≥î
->
weight
 = 0;

3959 
	}
}

3962 
	$≥î_timîs_£t
 (
≥î
 *≥î, 
u_öt32_t
 
kì∑live
, u_öt32_à
hﬁdtime
)

3964 
≥î_group
 *
group
;

3965 
li°node
 *
node
, *
¬ode
;

3968 i‡(
	`≥î_group_a˘ive
 (
≥î
))

3969  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

3972 i‡(
kì∑live
 > 65535)

3973  
BGP_ERR_INVALID_VALUE
;

3976 i‡(
hﬁdtime
 > 65535)

3977  
BGP_ERR_INVALID_VALUE
;

3980 i‡(
hﬁdtime
 < 3 && holdtime != 0)

3981  
BGP_ERR_INVALID_VALUE
;

3984 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
);

3985 
≥î
->
hﬁdtime
 = holdtime;

3986 
≥î
->
kì∑live
 = (kì∑livê< 
hﬁdtime
 / 3 ? keepalive : holdtime / 3);

3988 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

3992 
group
 = 
≥î
->group;

3993 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

3995 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
);

3996 
≥î
->
hﬁdtime
 = 
group
->
c⁄f
->holdtime;

3997 
≥î
->
kì∑live
 = 
group
->
c⁄f
->keepalive;

4000 
	}
}

4003 
	$≥î_timîs_un£t
 (
≥î
 *peer)

4005 
≥î_group
 *
group
;

4006 
li°node
 *
node
, *
¬ode
;

4008 i‡(
	`≥î_group_a˘ive
 (
≥î
))

4009  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4012 
	`UNSET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
);

4013 
≥î
->
kì∑live
 = 0;

4014 
≥î
->
hﬁdtime
 = 0;

4016 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4020 
group
 = 
≥î
->group;

4021 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4023 
	`UNSET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
);

4024 
≥î
->
hﬁdtime
 = 0;

4025 
≥î
->
kì∑live
 = 0;

4029 
	}
}

4032 
	$≥î_timîs_c⁄√˘_£t
 (
≥î
 *≥î, 
u_öt32_t
 
c⁄√˘
)

4034 i‡(
	`≥î_group_a˘ive
 (
≥î
))

4035  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4037 i‡(
c⁄√˘
 > 65535)

4038  
BGP_ERR_INVALID_VALUE
;

4041 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_CONNECT
);

4042 
≥î
->
c⁄√˘
 = connect;

4045 
≥î
->
v_c⁄√˘
 = 
c⁄√˘
;

4048 
	}
}

4051 
	$≥î_timîs_c⁄√˘_un£t
 (
≥î
 *peer)

4053 i‡(
	`≥î_group_a˘ive
 (
≥î
))

4054  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4057 
	`UNSET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_CONNECT
);

4058 
≥î
->
c⁄√˘
 = 0;

4061 
≥î
->
v_c⁄√˘
 = 
BGP_DEFAULT_CONNECT_RETRY
;

4064 
	}
}

4067 
	$≥î_advîti£_öãrvÆ_£t
 (
≥î
 *≥î, 
u_öt32_t
 
rouãadv
)

4069 i‡(
	`≥î_group_a˘ive
 (
≥î
))

4070  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4072 i‡(
rouãadv
 > 600)

4073  
BGP_ERR_INVALID_VALUE
;

4075 
	`SET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_ROUTEADV
);

4076 
≥î
->
rouãadv
 =Ñouteadv;

4077 
≥î
->
v_rouãadv
 = 
rouãadv
;

4080 
	}
}

4083 
	$≥î_advîti£_öãrvÆ_un£t
 (
≥î
 *peer)

4085 i‡(
	`≥î_group_a˘ive
 (
≥î
))

4086  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4088 
	`UNSET_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_ROUTEADV
);

4089 
≥î
->
rouãadv
 = 0;

4091 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

4092 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_IBGP_ROUTEADV
;

4094 
≥î
->
v_rouãadv
 = 
BGP_DEFAULT_EBGP_ROUTEADV
;

4097 
	}
}

4101 
	$≥î_öãrÁ˚_£t
 (
≥î
 *≥î, c⁄° *
°r
)

4103 i‡(
≥î
->
i‚ame
)

4104 
	`‰ì
 (
≥î
->
i‚ame
);

4105 
≥î
->
i‚ame
 = 
	`°rdup
 (
°r
);

4108 
	}
}

4111 
	$≥î_öãrÁ˚_un£t
 (
≥î
 *peer)

4113 i‡(
≥î
->
i‚ame
)

4114 
	`‰ì
 (
≥î
->
i‚ame
);

4115 
≥î
->
i‚ame
 = 
NULL
;

4118 
	}
}

4122 
	$≥î_Ælowas_ö_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
Ælow_num
)

4124 
≥î_group
 *
group
;

4125 
li°node
 *
node
, *
¬ode
;

4127 i‡(
Ælow_num
 < 1 ||állow_num > 10)

4128  
BGP_ERR_INVALID_VALUE
;

4130 i‡(
≥î
->
Ælowas_ö
[
afi
][
ßfi
] !
Ælow_num
)

4132 
≥î
->
Ælowas_ö
[
afi
][
ßfi
] = 
Ælow_num
;

4133 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ALLOWAS_IN
);

4134 
	`≥î_ch™ge_a˘i⁄
 (
≥î
, 
afi
, 
ßfi
, 
≥î_ch™ge_ª£t_ö
);

4137 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4140 
group
 = 
≥î
->group;

4141 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4143 i‡(
≥î
->
Ælowas_ö
[
afi
][
ßfi
] !
Ælow_num
)

4145 
≥î
->
Ælowas_ö
[
afi
][
ßfi
] = 
Ælow_num
;

4146 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ALLOWAS_IN
);

4147 
	`≥î_ch™ge_a˘i⁄
 (
≥î
, 
afi
, 
ßfi
, 
≥î_ch™ge_ª£t_ö
);

4152 
	}
}

4155 
	$≥î_Ælowas_ö_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

4157 
≥î_group
 *
group
;

4158 
li°node
 *
node
, *
¬ode
;

4160 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ALLOWAS_IN
))

4162 
≥î
->
Ælowas_ö
[
afi
][
ßfi
] = 0;

4163 
	`≥î_af_Êag_un£t
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_ALLOWAS_IN
);

4166 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4169 
group
 = 
≥î
->group;

4170 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4172 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ALLOWAS_IN
))

4174 
≥î
->
Ælowas_ö
[
afi
][
ßfi
] = 0;

4175 
	`≥î_af_Êag_un£t
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_ALLOWAS_IN
);

4179 
	}
}

4182 
	$≥î_loˇl_as_£t
 (
≥î
 *≥î, 
as_t
 
as
, 
no_¥ïíd
, 
ª∂a˚_as
)

4184 
bgp
 *bg∞
≥î
->bgp;

4185 
≥î_group
 *
group
;

4186 
li°node
 *
node
, *
¬ode
;

4188 i‡(
	`≥î_s‹t
 (
≥î
Ë!
BGP_PEER_EBGP


4189 && 
	`≥î_s‹t
 (
≥î
Ë!
BGP_PEER_INTERNAL
)

4190  
BGP_ERR_LOCAL_AS_ALLOWED_ONLY_FOR_EBGP
;

4192 i‡(
bgp
->
as
 ==ás)

4193  
BGP_ERR_CANNOT_HAVE_LOCAL_AS_SAME_AS
;

4195 i‡(
	`≥î_group_a˘ive
 (
≥î
))

4196  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4198 i‡(
≥î
->
as
 ==ás)

4199  
BGP_ERR_CANNOT_HAVE_LOCAL_AS_SAME_AS_REMOTE_AS
;

4201 i‡(
≥î
->
ch™ge_loˇl_as
 =
as
 &&

4202 ((
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
Ë&& 
no_¥ïíd
)

4203 || (! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
Ë&& ! 
no_¥ïíd
)) &&

4204 ((
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
Ë&& 
ª∂a˚_as
)

4205 || (! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
Ë&& ! 
ª∂a˚_as
)))

4208 
≥î
->
ch™ge_loˇl_as
 = 
as
;

4209 i‡(
no_¥ïíd
)

4210 
	`SET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

4212 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

4214 i‡(
ª∂a˚_as
)

4215 
	`SET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

4217 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

4219 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4221 i‡(
≥î
->
°©us
 =
E°ablished
)

4223 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_LOCAL_AS_CHANGE
;

4224 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

4225 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4228 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4233 
group
 = 
≥î
->group;

4234 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4236 
≥î
->
ch™ge_loˇl_as
 = 
as
;

4237 i‡(
no_¥ïíd
)

4238 
	`SET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

4240 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

4242 i‡(
ª∂a˚_as
)

4243 
	`SET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

4245 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

4247 i‡(
≥î
->
°©us
 =
E°ablished
)

4249 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_LOCAL_AS_CHANGE
;

4250 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

4251 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4254 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4258 
	}
}

4261 
	$≥î_loˇl_as_un£t
 (
≥î
 *peer)

4263 
≥î_group
 *
group
;

4264 
li°node
 *
node
, *
¬ode
;

4266 i‡(
	`≥î_group_a˘ive
 (
≥î
))

4267  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4269 i‡(! 
≥î
->
ch™ge_loˇl_as
)

4272 
≥î
->
ch™ge_loˇl_as
 = 0;

4273 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

4274 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

4276 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4278 i‡(
≥î
->
°©us
 =
E°ablished
)

4280 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_LOCAL_AS_CHANGE
;

4281 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

4282 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4285 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4290 
group
 = 
≥î
->group;

4291 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4293 
≥î
->
ch™ge_loˇl_as
 = 0;

4294 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
);

4295 
	`UNSET_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
);

4297 i‡(
≥î
->
°©us
 =
E°ablished
)

4299 
≥î
->
œ°_ª£t
 = 
PEER_DOWN_LOCAL_AS_CHANGE
;

4300 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

4301 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4304 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4307 
	}
}

4311 
	$≥î_∑ssw‹d_£t
 (
≥î
 *≥î, c⁄° *
∑ssw‹d
)

4313 
li°node
 *
¬
, *
¬ode
;

4314 
Àn
 = 
∑ssw‹d
 ? 
	`°æí
(password) : 0;

4315 
ªt
 = 
BGP_SUCCESS
;

4317 i‡((
Àn
 < 
PEER_PASSWORD_MINLEN
Ë|| (À¿> 
PEER_PASSWORD_MAXLEN
))

4318  
BGP_ERR_INVALID_VALUE
;

4320 i‡(
≥î
->
∑ssw‹d
 && 
	`°rcmp
 (peer->password,Öassword) == 0

4321 && ! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4324 i‡(
≥î
->
∑ssw‹d
)

4325 
	`XFREE
 (
MTYPE_PEER_PASSWORD
, 
≥î
->
∑ssw‹d
);

4327 
≥î
->
∑ssw‹d
 = 
	`XSTRDUP
 (
MTYPE_PEER_PASSWORD
,Öassword);

4329 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4331 i‡(
≥î
->
°©us
 =
E°ablished
)

4332 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4334 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4336  (
	`bgp_md5_£t
 (
≥î
Ë>0Ë? 
BGP_SUCCESS
 : 
BGP_ERR_TCPSIG_FAILED
;

4339 
	`ALL_LIST_ELEMENTS
 (
≥î
->
group
->≥î, 
¬
, 
¬ode
,Öeer))

4341 i‡(
≥î
->
∑ssw‹d
 && 
	`°rcmp
 (peer->password,Öassword) == 0)

4344 i‡(
≥î
->
∑ssw‹d
)

4345 
	`XFREE
 (
MTYPE_PEER_PASSWORD
, 
≥î
->
∑ssw‹d
);

4347 
≥î
->
∑ssw‹d
 = 
	`XSTRDUP
(
MTYPE_PEER_PASSWORD
,Öassword);

4349 i‡(
≥î
->
°©us
 =
E°ablished
)

4350 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4352 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4354 i‡(
	`bgp_md5_£t
 (
≥î
) < 0)

4355 
ªt
 = 
BGP_ERR_TCPSIG_FAILED
;

4358  
ªt
;

4359 
	}
}

4362 
	$≥î_∑ssw‹d_un£t
 (
≥î
 *peer)

4364 
li°node
 *
¬
, *
¬ode
;

4366 i‡(!
≥î
->
∑ssw‹d


4367 && !
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4370 i‡(!
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4372 i‡(
	`≥î_group_a˘ive
 (
≥î
)

4373 && 
≥î
->
group
->
c⁄f
->
∑ssw‹d


4374 && 
	`°rcmp
 (
≥î
->
group
->
c⁄f
->
∑ssw‹d
,Öeer->password) == 0)

4375  
BGP_ERR_PEER_GROUP_HAS_THE_FLAG
;

4377 i‡(
≥î
->
°©us
 =
E°ablished
)

4378 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4380 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4382 i‡(
≥î
->
∑ssw‹d
)

4383 
	`XFREE
 (
MTYPE_PEER_PASSWORD
, 
≥î
->
∑ssw‹d
);

4385 
≥î
->
∑ssw‹d
 = 
NULL
;

4387 
	`bgp_md5_£t
 (
≥î
);

4392 
	`XFREE
 (
MTYPE_PEER_PASSWORD
, 
≥î
->
∑ssw‹d
);

4393 
≥î
->
∑ssw‹d
 = 
NULL
;

4395 
	`ALL_LIST_ELEMENTS
 (
≥î
->
group
->≥î, 
¬
, 
¬ode
,Öeer))

4397 i‡(!
≥î
->
∑ssw‹d
)

4400 i‡(
≥î
->
°©us
 =
E°ablished
)

4401 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
, 
BGP_NOTIFY_CEASE_CONFIG_CHANGE
);

4403 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

4405 
	`XFREE
 (
MTYPE_PEER_PASSWORD
, 
≥î
->
∑ssw‹d
);

4406 
≥î
->
∑ssw‹d
 = 
NULL
;

4408 
	`bgp_md5_£t
 (
≥î
);

4412 
	}
}

4416 
	$≥î_di°ribuã_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
,

4417 c⁄° *
«me
)

4419 
bgp_fûãr
 *
fûãr
;

4420 
≥î_group
 *
group
;

4421 
li°node
 *
node
, *
¬ode
;

4423 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4424  
BGP_ERR_PEER_INACTIVE
;

4426 i‡(
dúe˘
 !
FILTER_IN
 && dúe˘ !
FILTER_OUT
)

4427  
BGP_ERR_INVALID_VALUE
;

4429 i‡(
dúe˘
 =
FILTER_OUT
 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4430  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4432 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4434 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4435  
BGP_ERR_PEER_FILTER_CONFLICT
;

4437 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4438 
	`‰ì
 (
fûãr
->
dli°
[
dúe˘
].
«me
);

4439 
fûãr
->
dli°
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4440 
fûãr
->
dli°
[
dúe˘
].
Æi°
 = 
	`ac˚ss_li°_lookup
 (
afi
, 
«me
);

4442 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4445 
group
 = 
≥î
->group;

4446 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4448 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4450 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4453 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4454 
	`‰ì
 (
fûãr
->
dli°
[
dúe˘
].
«me
);

4455 
fûãr
->
dli°
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4456 
fûãr
->
dli°
[
dúe˘
].
Æi°
 = 
	`ac˚ss_li°_lookup
 (
afi
, 
«me
);

4460 
	}
}

4463 
	$≥î_di°ribuã_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
)

4465 
bgp_fûãr
 *
fûãr
;

4466 
bgp_fûãr
 *
gfûãr
;

4467 
≥î_group
 *
group
;

4468 
li°node
 *
node
, *
¬ode
;

4470 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4471  
BGP_ERR_PEER_INACTIVE
;

4473 i‡(
dúe˘
 !
FILTER_IN
 && dúe˘ !
FILTER_OUT
)

4474  
BGP_ERR_INVALID_VALUE
;

4476 i‡(
dúe˘
 =
FILTER_OUT
 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4477  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4479 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4482 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

4484 
gfûãr
 = &
≥î
->
group
->
c⁄f
->
fûãr
[
afi
][
ßfi
];

4486 i‡(
gfûãr
->
dli°
[
dúe˘
].
«me
)

4488 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4489 
	`‰ì
 (
fûãr
->
dli°
[
dúe˘
].
«me
);

4490 
fûãr
->
dli°
[
dúe˘
].
«me
 = 
	`°rdup
 (
gfûãr
->dlist[direct].name);

4491 
fûãr
->
dli°
[
dúe˘
].
Æi°
 = 
gfûãr
->dlist[direct].alist;

4496 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4497 
	`‰ì
 (
fûãr
->
dli°
[
dúe˘
].
«me
);

4498 
fûãr
->
dli°
[
dúe˘
].
«me
 = 
NULL
;

4499 
fûãr
->
dli°
[
dúe˘
].
Æi°
 = 
NULL
;

4501 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4504 
group
 = 
≥î
->group;

4505 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4507 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4509 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4512 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4513 
	`‰ì
 (
fûãr
->
dli°
[
dúe˘
].
«me
);

4514 
fûãr
->
dli°
[
dúe˘
].
«me
 = 
NULL
;

4515 
fûãr
->
dli°
[
dúe˘
].
Æi°
 = 
NULL
;

4519 
	}
}

4523 
	$≥î_di°ribuã_upd©e
 (
ac˚ss_li°
 *
ac˚ss
)

4525 
afi_t
 
afi
;

4526 
ßfi_t
 
ßfi
;

4527 
dúe˘
;

4528 
li°node
 *
mnode
, *
m¬ode
;

4529 
li°node
 *
node
, *
¬ode
;

4530 
bgp
 *bgp;

4531 
≥î
 *peer;

4532 
≥î_group
 *
group
;

4533 
bgp_fûãr
 *
fûãr
;

4535 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

4537 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

4539 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4540 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4542 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4544 
dúe˘
 = 
FILTER_IN
; dúe˘ < 
FILTER_MAX
; direct++)

4546 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4547 
fûãr
->
dli°
[
dúe˘
].
Æi°
 =

4548 
	`ac˚ss_li°_lookup
 (
afi
, 
fûãr
->
dli°
[
dúe˘
].
«me
);

4550 
fûãr
->
dli°
[
dúe˘
].
Æi°
 = 
NULL
;

4554 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
¬ode
, group))

4556 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4557 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4559 
fûãr
 = &
group
->
c⁄f
->fûãr[
afi
][
ßfi
];

4561 
dúe˘
 = 
FILTER_IN
; dúe˘ < 
FILTER_MAX
; direct++)

4563 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4564 
fûãr
->
dli°
[
dúe˘
].
Æi°
 =

4565 
	`ac˚ss_li°_lookup
 (
afi
, 
fûãr
->
dli°
[
dúe˘
].
«me
);

4567 
fûãr
->
dli°
[
dúe˘
].
Æi°
 = 
NULL
;

4572 
	}
}

4576 
	$≥î_¥efix_li°_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
,

4577 c⁄° *
«me
)

4579 
bgp_fûãr
 *
fûãr
;

4580 
≥î_group
 *
group
;

4581 
li°node
 *
node
, *
¬ode
;

4583 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4584  
BGP_ERR_PEER_INACTIVE
;

4586 i‡(
dúe˘
 !
FILTER_IN
 && dúe˘ !
FILTER_OUT
)

4587  
BGP_ERR_INVALID_VALUE
;

4589 i‡(
dúe˘
 =
FILTER_OUT
 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4590  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4592 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4594 i‡(
fûãr
->
dli°
[
dúe˘
].
«me
)

4595  
BGP_ERR_PEER_FILTER_CONFLICT
;

4597 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4598 
	`‰ì
 (
fûãr
->
∂i°
[
dúe˘
].
«me
);

4599 
fûãr
->
∂i°
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4600 
fûãr
->
∂i°
[
dúe˘
].∂i° = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

4602 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4605 
group
 = 
≥î
->group;

4606 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4608 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4610 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4613 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4614 
	`‰ì
 (
fûãr
->
∂i°
[
dúe˘
].
«me
);

4615 
fûãr
->
∂i°
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4616 
fûãr
->
∂i°
[
dúe˘
].∂i° = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

4619 
	}
}

4622 
	$≥î_¥efix_li°_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
)

4624 
bgp_fûãr
 *
fûãr
;

4625 
bgp_fûãr
 *
gfûãr
;

4626 
≥î_group
 *
group
;

4627 
li°node
 *
node
, *
¬ode
;

4629 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4630  
BGP_ERR_PEER_INACTIVE
;

4632 i‡(
dúe˘
 !
FILTER_IN
 && dúe˘ !
FILTER_OUT
)

4633  
BGP_ERR_INVALID_VALUE
;

4635 i‡(
dúe˘
 =
FILTER_OUT
 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4636  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4638 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4641 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

4643 
gfûãr
 = &
≥î
->
group
->
c⁄f
->
fûãr
[
afi
][
ßfi
];

4645 i‡(
gfûãr
->
∂i°
[
dúe˘
].
«me
)

4647 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4648 
	`‰ì
 (
fûãr
->
∂i°
[
dúe˘
].
«me
);

4649 
fûãr
->
∂i°
[
dúe˘
].
«me
 = 
	`°rdup
 (
gfûãr
->plist[direct].name);

4650 
fûãr
->
∂i°
[
dúe˘
].∂i° = 
gfûãr
->plist[direct].plist;

4655 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4656 
	`‰ì
 (
fûãr
->
∂i°
[
dúe˘
].
«me
);

4657 
fûãr
->
∂i°
[
dúe˘
].
«me
 = 
NULL
;

4658 
fûãr
->
∂i°
[
dúe˘
].∂i° = 
NULL
;

4660 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4663 
group
 = 
≥î
->group;

4664 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4666 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4668 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4671 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4672 
	`‰ì
 (
fûãr
->
∂i°
[
dúe˘
].
«me
);

4673 
fûãr
->
∂i°
[
dúe˘
].
«me
 = 
NULL
;

4674 
fûãr
->
∂i°
[
dúe˘
].∂i° = 
NULL
;

4678 
	}
}

4682 
	$≥î_¥efix_li°_upd©e
 (
¥efix_li°
 *
∂i°
)

4684 
li°node
 *
mnode
, *
m¬ode
;

4685 
li°node
 *
node
, *
¬ode
;

4686 
bgp
 *bgp;

4687 
≥î
 *peer;

4688 
≥î_group
 *
group
;

4689 
bgp_fûãr
 *
fûãr
;

4690 
afi_t
 
afi
;

4691 
ßfi_t
 
ßfi
;

4692 
dúe˘
;

4694 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

4696 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

4698 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4699 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4701 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4703 
dúe˘
 = 
FILTER_IN
; dúe˘ < 
FILTER_MAX
; direct++)

4705 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4706 
fûãr
->
∂i°
[
dúe˘
].plist =

4707 
	`¥efix_li°_lookup
 (
afi
, 
fûãr
->
∂i°
[
dúe˘
].
«me
);

4709 
fûãr
->
∂i°
[
dúe˘
].∂i° = 
NULL
;

4713 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
¬ode
, group))

4715 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4716 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4718 
fûãr
 = &
group
->
c⁄f
->fûãr[
afi
][
ßfi
];

4720 
dúe˘
 = 
FILTER_IN
; dúe˘ < 
FILTER_MAX
; direct++)

4722 i‡(
fûãr
->
∂i°
[
dúe˘
].
«me
)

4723 
fûãr
->
∂i°
[
dúe˘
].plist =

4724 
	`¥efix_li°_lookup
 (
afi
, 
fûãr
->
∂i°
[
dúe˘
].
«me
);

4726 
fûãr
->
∂i°
[
dúe˘
].∂i° = 
NULL
;

4731 
	}
}

4734 
	$≥î_a¶i°_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
,

4735 c⁄° *
«me
)

4737 
bgp_fûãr
 *
fûãr
;

4738 
≥î_group
 *
group
;

4739 
li°node
 *
node
, *
¬ode
;

4741 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4742  
BGP_ERR_PEER_INACTIVE
;

4744 i‡(
dúe˘
 !
FILTER_IN
 && dúe˘ !
FILTER_OUT
)

4745  
BGP_ERR_INVALID_VALUE
;

4747 i‡(
dúe˘
 =
FILTER_OUT
 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4748  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4750 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4752 i‡(
fûãr
->
a¶i°
[
dúe˘
].
«me
)

4753 
	`‰ì
 (
fûãr
->
a¶i°
[
dúe˘
].
«me
);

4754 
fûãr
->
a¶i°
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4755 
fûãr
->
a¶i°
[
dúe˘
].a¶i° = 
	`as_li°_lookup
 (
«me
);

4757 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4760 
group
 = 
≥î
->group;

4761 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4763 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4765 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4768 i‡(
fûãr
->
a¶i°
[
dúe˘
].
«me
)

4769 
	`‰ì
 (
fûãr
->
a¶i°
[
dúe˘
].
«me
);

4770 
fûãr
->
a¶i°
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4771 
fûãr
->
a¶i°
[
dúe˘
].a¶i° = 
	`as_li°_lookup
 (
«me
);

4774 
	}
}

4777 
	$≥î_a¶i°_un£t
 (
≥î
 *≥î,
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
)

4779 
bgp_fûãr
 *
fûãr
;

4780 
bgp_fûãr
 *
gfûãr
;

4781 
≥î_group
 *
group
;

4782 
li°node
 *
node
, *
¬ode
;

4784 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4785  
BGP_ERR_PEER_INACTIVE
;

4787 i‡(
dúe˘
 !
FILTER_IN
 && dúe˘ !
FILTER_OUT
)

4788  
BGP_ERR_INVALID_VALUE
;

4790 i‡(
dúe˘
 =
FILTER_OUT
 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4791  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4793 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4796 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

4798 
gfûãr
 = &
≥î
->
group
->
c⁄f
->
fûãr
[
afi
][
ßfi
];

4800 i‡(
gfûãr
->
a¶i°
[
dúe˘
].
«me
)

4802 i‡(
fûãr
->
a¶i°
[
dúe˘
].
«me
)

4803 
	`‰ì
 (
fûãr
->
a¶i°
[
dúe˘
].
«me
);

4804 
fûãr
->
a¶i°
[
dúe˘
].
«me
 = 
	`°rdup
 (
gfûãr
->aslist[direct].name);

4805 
fûãr
->
a¶i°
[
dúe˘
].a¶i° = 
gfûãr
->aslist[direct].aslist;

4810 i‡(
fûãr
->
a¶i°
[
dúe˘
].
«me
)

4811 
	`‰ì
 (
fûãr
->
a¶i°
[
dúe˘
].
«me
);

4812 
fûãr
->
a¶i°
[
dúe˘
].
«me
 = 
NULL
;

4813 
fûãr
->
a¶i°
[
dúe˘
].a¶i° = 
NULL
;

4815 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4818 
group
 = 
≥î
->group;

4819 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4821 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4823 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4826 i‡(
fûãr
->
a¶i°
[
dúe˘
].
«me
)

4827 
	`‰ì
 (
fûãr
->
a¶i°
[
dúe˘
].
«me
);

4828 
fûãr
->
a¶i°
[
dúe˘
].
«me
 = 
NULL
;

4829 
fûãr
->
a¶i°
[
dúe˘
].a¶i° = 
NULL
;

4833 
	}
}

4836 
	$≥î_a¶i°_upd©e
 ()

4838 
afi_t
 
afi
;

4839 
ßfi_t
 
ßfi
;

4840 
dúe˘
;

4841 
li°node
 *
mnode
, *
m¬ode
;

4842 
li°node
 *
node
, *
¬ode
;

4843 
bgp
 *bgp;

4844 
≥î
 *peer;

4845 
≥î_group
 *
group
;

4846 
bgp_fûãr
 *
fûãr
;

4848 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

4850 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

4852 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4853 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4855 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4857 
dúe˘
 = 
FILTER_IN
; dúe˘ < 
FILTER_MAX
; direct++)

4859 i‡(
fûãr
->
a¶i°
[
dúe˘
].
«me
)

4860 
fûãr
->
a¶i°
[
dúe˘
].aslist =

4861 
	`as_li°_lookup
 (
fûãr
->
a¶i°
[
dúe˘
].
«me
);

4863 
fûãr
->
a¶i°
[
dúe˘
].a¶i° = 
NULL
;

4867 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
¬ode
, group))

4869 
afi
 = 
AFI_IP
;áfò< 
AFI_MAX
;áfi++)

4870 
ßfi
 = 
SAFI_UNICAST
; safò< 
SAFI_MAX
; safi++)

4872 
fûãr
 = &
group
->
c⁄f
->fûãr[
afi
][
ßfi
];

4874 
dúe˘
 = 
FILTER_IN
; dúe˘ < 
FILTER_MAX
; direct++)

4876 i‡(
fûãr
->
a¶i°
[
dúe˘
].
«me
)

4877 
fûãr
->
a¶i°
[
dúe˘
].aslist =

4878 
	`as_li°_lookup
 (
fûãr
->
a¶i°
[
dúe˘
].
«me
);

4880 
fûãr
->
a¶i°
[
dúe˘
].a¶i° = 
NULL
;

4885 
	}
}

4889 
	$≥î_rouã_m≠_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
,

4890 c⁄° *
«me
)

4892 
bgp_fûãr
 *
fûãr
;

4893 
≥î_group
 *
group
;

4894 
li°node
 *
node
, *
¬ode
;

4896 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4897  
BGP_ERR_PEER_INACTIVE
;

4899 i‡(
dúe˘
 !
RMAP_IN
 && dúe˘ !
RMAP_OUT
 &&

4900 
dúe˘
 !
RMAP_IMPORT
 && dúe˘ !
RMAP_EXPORT
)

4901  
BGP_ERR_INVALID_VALUE
;

4903 i‡–(
dúe˘
 =
RMAP_OUT
 || dúe˘ =
RMAP_IMPORT
)

4904 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4905  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4907 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4909 i‡(
fûãr
->
m≠
[
dúe˘
].
«me
)

4910 
	`‰ì
 (
fûãr
->
m≠
[
dúe˘
].
«me
);

4912 
fûãr
->
m≠
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4913 
fûãr
->
m≠
[
dúe˘
].m≠ = 
	`rouã_m≠_lookup_by_«me
 (
«me
);

4915 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4918 
group
 = 
≥î
->group;

4919 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4921 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4923 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4926 i‡(
fûãr
->
m≠
[
dúe˘
].
«me
)

4927 
	`‰ì
 (
fûãr
->
m≠
[
dúe˘
].
«me
);

4928 
fûãr
->
m≠
[
dúe˘
].
«me
 = 
	`°rdup
 (name);

4929 
fûãr
->
m≠
[
dúe˘
].m≠ = 
	`rouã_m≠_lookup_by_«me
 (
«me
);

4932 
	}
}

4936 
	$≥î_rouã_m≠_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
dúe˘
)

4938 
bgp_fûãr
 *
fûãr
;

4939 
bgp_fûãr
 *
gfûãr
;

4940 
≥î_group
 *
group
;

4941 
li°node
 *
node
, *
¬ode
;

4943 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

4944  
BGP_ERR_PEER_INACTIVE
;

4946 i‡(
dúe˘
 !
RMAP_IN
 && dúe˘ !
RMAP_OUT
 &&

4947 
dúe˘
 !
RMAP_IMPORT
 && dúe˘ !
RMAP_EXPORT
)

4948  
BGP_ERR_INVALID_VALUE
;

4950 i‡–(
dúe˘
 =
RMAP_OUT
 || dúe˘ =
RMAP_IMPORT
)

4951 && 
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

4952  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

4954 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4957 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

4959 
gfûãr
 = &
≥î
->
group
->
c⁄f
->
fûãr
[
afi
][
ßfi
];

4961 i‡(
gfûãr
->
m≠
[
dúe˘
].
«me
)

4963 i‡(
fûãr
->
m≠
[
dúe˘
].
«me
)

4964 
	`‰ì
 (
fûãr
->
m≠
[
dúe˘
].
«me
);

4965 
fûãr
->
m≠
[
dúe˘
].
«me
 = 
	`°rdup
 (
gfûãr
->map[direct].name);

4966 
fûãr
->
m≠
[
dúe˘
].m≠ = 
gfûãr
->map[direct].map;

4971 i‡(
fûãr
->
m≠
[
dúe˘
].
«me
)

4972 
	`‰ì
 (
fûãr
->
m≠
[
dúe˘
].
«me
);

4973 
fûãr
->
m≠
[
dúe˘
].
«me
 = 
NULL
;

4974 
fûãr
->
m≠
[
dúe˘
].m≠ = 
NULL
;

4976 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

4979 
group
 = 
≥î
->group;

4980 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

4982 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

4984 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

4987 i‡(
fûãr
->
m≠
[
dúe˘
].
«me
)

4988 
	`‰ì
 (
fûãr
->
m≠
[
dúe˘
].
«me
);

4989 
fûãr
->
m≠
[
dúe˘
].
«me
 = 
NULL
;

4990 
fûãr
->
m≠
[
dúe˘
].m≠ = 
NULL
;

4993 
	}
}

4997 
	$≥î_unsuµªss_m≠_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

4998 c⁄° *
«me
)

5000 
bgp_fûãr
 *
fûãr
;

5001 
≥î_group
 *
group
;

5002 
li°node
 *
node
, *
¬ode
;

5004 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

5005  
BGP_ERR_PEER_INACTIVE
;

5007 i‡(
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

5008  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

5010 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

5012 i‡(
fûãr
->
usm≠
.
«me
)

5013 
	`‰ì
 (
fûãr
->
usm≠
.
«me
);

5015 
fûãr
->
usm≠
.
«me
 = 
	`°rdup
 (name);

5016 
fûãr
->
usm≠
.
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (
«me
);

5018 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5021 
group
 = 
≥î
->group;

5022 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

5024 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

5026 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

5029 i‡(
fûãr
->
usm≠
.
«me
)

5030 
	`‰ì
 (
fûãr
->
usm≠
.
«me
);

5031 
fûãr
->
usm≠
.
«me
 = 
	`°rdup
 (name);

5032 
fûãr
->
usm≠
.
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (
«me
);

5035 
	}
}

5039 
	$≥î_unsuµªss_m≠_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

5041 
bgp_fûãr
 *
fûãr
;

5042 
≥î_group
 *
group
;

5043 
li°node
 *
node
, *
¬ode
;

5045 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

5046  
BGP_ERR_PEER_INACTIVE
;

5048 i‡(
	`≥î_is_group_membî
 (
≥î
, 
afi
, 
ßfi
))

5049  
BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
;

5051 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

5053 i‡(
fûãr
->
usm≠
.
«me
)

5054 
	`‰ì
 (
fûãr
->
usm≠
.
«me
);

5055 
fûãr
->
usm≠
.
«me
 = 
NULL
;

5056 
fûãr
->
usm≠
.
m≠
 = 
NULL
;

5058 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5061 
group
 = 
≥î
->group;

5062 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

5064 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

5066 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

5069 i‡(
fûãr
->
usm≠
.
«me
)

5070 
	`‰ì
 (
fûãr
->
usm≠
.
«me
);

5071 
fûãr
->
usm≠
.
«me
 = 
NULL
;

5072 
fûãr
->
usm≠
.
m≠
 = 
NULL
;

5075 
	}
}

5078 
	$≥î_maximum_¥efix_£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

5079 
u_öt32_t
 
max
, 
u_ch¨
 
thªshﬁd
,

5080 
w¨nög
, 
u_öt16_t
 
ª°¨t
)

5082 
≥î_group
 *
group
;

5083 
li°node
 *
node
, *
¬ode
;

5085 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

5086  
BGP_ERR_PEER_INACTIVE
;

5088 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
);

5089 
≥î
->
pmax
[
afi
][
ßfi
] = 
max
;

5090 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] = 
thªshﬁd
;

5091 
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
] = 
ª°¨t
;

5092 i‡(
w¨nög
)

5093 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5095 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5097 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5100 
group
 = 
≥î
->group;

5101 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

5103 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

5106 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
);

5107 
≥î
->
pmax
[
afi
][
ßfi
] = 
max
;

5108 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] = 
thªshﬁd
;

5109 
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
] = 
ª°¨t
;

5110 i‡(
w¨nög
)

5111 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5113 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5116 
	}
}

5119 
	$≥î_maximum_¥efix_un£t
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

5121 
≥î_group
 *
group
;

5122 
li°node
 *
node
, *
¬ode
;

5124 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

5125  
BGP_ERR_PEER_INACTIVE
;

5128 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

5130 i‡(
	`CHECK_FLAG
 (
≥î
->
group
->
c⁄f
->
af_Êags
[
afi
][
ßfi
],

5131 
PEER_FLAG_MAX_PREFIX
))

5132 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
);

5134 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
);

5136 i‡(
	`CHECK_FLAG
 (
≥î
->
group
->
c⁄f
->
af_Êags
[
afi
][
ßfi
],

5137 
PEER_FLAG_MAX_PREFIX_WARNING
))

5138 
	`SET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5140 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5142 
≥î
->
pmax
[
afi
][
ßfi
] =Öìr->
group
->
c⁄f
->pmax[afi][safi];

5143 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] =Öìr->
group
->
c⁄f
->pmax_threshold[afi][safi];

5144 
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
] =Öìr->
group
->
c⁄f
->pmax_restart[afi][safi];

5148 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
);

5149 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5150 
≥î
->
pmax
[
afi
][
ßfi
] = 0;

5151 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] = 0;

5152 
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
] = 0;

5154 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5157 
group
 = 
≥î
->group;

5158 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

5160 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

5163 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
);

5164 
	`UNSET_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
);

5165 
≥î
->
pmax
[
afi
][
ßfi
] = 0;

5166 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] = 0;

5167 
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
] = 0;

5170 
	}
}

5174 
	$≥î_âl_£curôy_h›s_£t
 (
≥î
 *≥î, 
gtsm_h›s
)

5176 
≥î_group
 *
group
;

5177 
li°node
 *
node
, *
¬ode
;

5178 
≥î
 *
≥î1
;

5179 
ªt
;

5181 
	`zlog_debug
 ("≥î_âl_£curôy_h›s_£t: së gtsm_h›†tÿ%d f‹ %s", 
gtsm_h›s
, 
≥î
->
ho°
);

5183 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

5184  
BGP_ERR_NO_IBGP_WITH_TTLHACK
;

5194 i‡(
≥î
->
gtsm_h›s
 == 0) {

5195 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5197 
group
 = 
≥î
->group;

5198 i‡(
group
->
c⁄f
->
âl
 != 1)

5199  
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
;

5201 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
, 
≥î1
))

5203 i‡(
≥î1
->
s‹t
 =
BGP_PEER_IBGP
)

5206 i‡(
≥î1
->
âl
 != 1)

5207  
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
;

5212 i‡(
≥î
->
âl
 != 1)

5213  
BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
;

5216 
ªt
 = 
	`≥î_ebgp_mu…ih›_£t
 (
≥î
, 
MAXTTL
);

5217 i‡(
ªt
 != 0)

5218  
ªt
;

5221 
≥î
->
gtsm_h›s
 = gtsm_hops;

5223 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5225 i‡(
≥î
->
fd
 >0 &&Öìr->
s‹t
 !
BGP_PEER_IBGP
)

5226 
	`sock›t_möâl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
, 
MAXTTL
 + 1 - 
gtsm_h›s
);

5230 
group
 = 
≥î
->group;

5231 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

5233 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

5236 
≥î
->
gtsm_h›s
 = 
group
->
c⁄f
->gtsm_hops;

5243 i‡(
≥î
->
°©us
 =
E°ablished
)

5245 i‡(
≥î
->
fd
 >0 &&Öìr->
gtsm_h›s
 != 0)

5246 
	`sock›t_möâl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
,

5247 
MAXTTL
 + 1 - 
≥î
->
gtsm_h›s
);

5249 i‡(
≥î
->
°©us
 < 
E°ablished
)

5251 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

5252 
	`zlog_debug
 ("%†Mö-â»ch™ged", 
≥î
->
ho°
);

5253 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

5259 
	}
}

5262 
	$≥î_âl_£curôy_h›s_un£t
 (
≥î
 *peer)

5264 
≥î_group
 *
group
;

5265 
li°node
 *
node
, *
¬ode
;

5266 
≥î
 *
›ìr
;

5268 
	`zlog_debug
 ("≥î_âl_£curôy_h›s_un£t: së gtsm_h›†tÿzîÿf‹ %s", 
≥î
->
ho°
);

5270 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

5274 i‡(
	`≥î_group_a˘ive
 (
≥î
))

5275 
≥î
->
gtsm_h›s
 =Öìr->
group
->
c⁄f
->gtsm_hops;

5277 
≥î
->
gtsm_h›s
 = 0;

5279 
›ìr
 = 
≥î
;

5280 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5282 i‡(
≥î
->
fd
 >0 &&Öìr->
s‹t
 !
BGP_PEER_IBGP
)

5283 
	`sock›t_möâl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
, 0);

5287 
group
 = 
≥î
->group;

5288 
	`ALL_LIST_ELEMENTS
 (
group
->
≥î
, 
node
, 
¬ode
,Öeer))

5290 i‡(
≥î
->
s‹t
 =
BGP_PEER_IBGP
)

5293 
≥î
->
gtsm_h›s
 = 0;

5295 i‡(
≥î
->
fd
 >= 0)

5296 
	`sock›t_möâl
 (
≥î
->
su
.
ß
.
ß_Ámûy
,Öìr->
fd
, 0);

5300  
	`≥î_ebgp_mu…ih›_un£t
 (
›ìr
);

5301 
	}
}

5304 
	$≥î_˛ór
 (
≥î
 *peer)

5306 i‡(! 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_SHUTDOWN
))

5308 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
))

5310 
	`UNSET_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_PREFIX_OVERFLOW
);

5311 i‡(
≥î
->
t_pmax_ª°¨t
)

5313 
	`BGP_TIMER_OFF
 (
≥î
->
t_pmax_ª°¨t
);

5314 i‡(
	`BGP_DEBUG
 (
evíts
, 
EVENTS
))

5315 
	`zlog_debug
 ("%s Maximum-prefixÑestartÅimer canceled",

5316 
≥î
->
ho°
);

5318 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_Sèπ
);

5322 
≥î
->
v_°¨t
 = 
BGP_INIT_START_TIMER
;

5323 i‡(
≥î
->
°©us
 =
E°ablished
)

5324 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

5325 
BGP_NOTIFY_CEASE_ADMIN_RESET
);

5327 
	`BGP_EVENT_ADD
 (
≥î
, 
BGP_St›
);

5330 
	}
}

5333 
	$≥î_˛ór_so·
 (
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

5334 
bgp_˛ór_ty≥
 
°y≥
)

5336 i‡(
≥î
->
°©us
 !
E°ablished
)

5339 i‡(! 
≥î
->
afc
[
afi
][
ßfi
])

5340  
BGP_ERR_AF_UNCONFIGURED
;

5342 i‡(
°y≥
 =
BGP_CLEAR_SOFT_RSCLIENT
)

5344 i‡(! 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
))

5346 
	`bgp_check_loˇl_rouãs_rs˛õ¡
 (
≥î
, 
afi
, 
ßfi
);

5347 
	`bgp_so·_ªc⁄fig_rs˛õ¡
 (
≥î
, 
afi
, 
ßfi
);

5350 i‡(
°y≥
 =
BGP_CLEAR_SOFT_OUT
 || sty≥ =
BGP_CLEAR_SOFT_BOTH
)

5351 
	`bgp_™noun˚_rouã
 (
≥î
, 
afi
, 
ßfi
);

5353 i‡(
°y≥
 =
BGP_CLEAR_SOFT_IN_ORF_PREFIX
)

5355 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_SM_ADV
)

5356 && (
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_RCV
)

5357 || 
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_OLD_RCV
)))

5359 
bgp_fûãr
 *
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

5360 
u_ch¨
 
¥efix_ty≥
;

5362 i‡(
	`CHECK_FLAG
 (
≥î
->
af_ˇp
[
afi
][
ßfi
], 
PEER_CAP_ORF_PREFIX_RM_RCV
))

5363 
¥efix_ty≥
 = 
ORF_TYPE_PREFIX
;

5365 
¥efix_ty≥
 = 
ORF_TYPE_PREFIX_OLD
;

5367 i‡(
fûãr
->
∂i°
[
FILTER_IN
].plist)

5369 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_PREFIX_SEND
))

5370 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
,

5371 
¥efix_ty≥
, 
REFRESH_DEFER
, 1);

5372 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
, 
¥efix_ty≥
,

5373 
REFRESH_IMMEDIATE
, 0);

5377 i‡(
	`CHECK_FLAG
 (
≥î
->
af_sÊags
[
afi
][
ßfi
], 
PEER_STATUS_ORF_PREFIX_SEND
))

5378 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
,

5379 
¥efix_ty≥
, 
REFRESH_IMMEDIATE
, 1);

5381 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
, 0, 0, 0);

5387 i‡(
°y≥
 =
BGP_CLEAR_SOFT_IN
 || sty≥ =
BGP_CLEAR_SOFT_BOTH


5388 || 
°y≥
 =
BGP_CLEAR_SOFT_IN_ORF_PREFIX
)

5392 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SOFT_RECONFIG
))

5393 
	`bgp_so·_ªc⁄fig_ö
 (
≥î
, 
afi
, 
ßfi
);

5398 i‡(
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_OLD_RCV
)

5399 || 
	`CHECK_FLAG
 (
≥î
->
ˇp
, 
PEER_CAP_REFRESH_NEW_RCV
))

5400 
	`bgp_rouã_ª‰esh_£nd
 (
≥î
, 
afi
, 
ßfi
, 0, 0, 0);

5402  
BGP_ERR_SOFT_RECONFIG_UNCONFIGURED
;

5406 
	}
}

5411 
	$≥î_u±ime
 (
time_t
 
u±ime2
, *
buf
, 
size_t
 
Àn
)

5413 
time_t
 
u±ime1
;

5414 
tm
 *tm;

5417 i‡(
Àn
 < 
BGP_UPTIME_LEN
)

5419 
	`zlog_w¨n
 ("≥î_u±imê(): buf„∏sh‹ègê%lu", (
u_l⁄g
)
Àn
);

5421 
	`¢¥ötf
 (
buf
, 
Àn
, "<error> ");

5422  
buf
;

5426 i‡(
u±ime2
 == 0)

5428 
	`¢¥ötf
 (
buf
, 
Àn
, "never ");

5429  
buf
;

5433 
u±ime1
 = 
	`bgp_˛ock
 ();

5434 
u±ime1
 -
u±ime2
;

5435 
tm
 = 
	`gmtime
 (&
u±ime1
);

5438 
	#ONE_DAY_SECOND
 60*60*24

	)

5439 
	#ONE_WEEK_SECOND
 60*60*24*7

	)

5441 i‡(
u±ime1
 < 
ONE_DAY_SECOND
)

5442 
	`¢¥ötf
 (
buf
, 
Àn
, "%02d:%02d:%02d",

5443 
tm
->
tm_hour
,Åm->
tm_mö
,Åm->
tm_£c
);

5444 i‡(
u±ime1
 < 
ONE_WEEK_SECOND
)

5445 
	`¢¥ötf
 (
buf
, 
Àn
, "%dd%02dh%02dm",

5446 
tm
->
tm_yday
,Åm->
tm_hour
,Åm->
tm_mö
);

5448 
	`¢¥ötf
 (
buf
, 
Àn
, "%02dw%dd%02dh",

5449 
tm
->
tm_yday
/7,Åm->tm_yday - (—m->tm_yday/7Ë* 7),Åm->
tm_hour
);

5450  
buf
;

5451 
	}
}

5454 
	$bgp_c⁄fig_wrôe_fûãr
 (
vty
 *vty, 
≥î
 *peer,

5455 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

5457 
bgp_fûãr
 *
fûãr
;

5458 
bgp_fûãr
 *
gfûãr
 = 
NULL
;

5459 *
addr
;

5460 
ö
 = 
FILTER_IN
;

5461 
out
 = 
FILTER_OUT
;

5463 
addr
 = 
≥î
->
ho°
;

5464 
fûãr
 = &
≥î
->fûãr[
afi
][
ßfi
];

5465 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

5466 
gfûãr
 = &
≥î
->
group
->
c⁄f
->
fûãr
[
afi
][
ßfi
];

5469 i‡(
fûãr
->
dli°
[
ö
].
«me
)

5470 i‡(! 
gfûãr
 || ! gfûãr->
dli°
[
ö
].
«me


5471 || 
	`°rcmp
 (
fûãr
->
dli°
[
ö
].
«me
, 
gfûãr
->dlist[in].name) != 0)

5472 
	`vty_out
 (
vty
, "Çeighb‹ %†di°ribuã-li° %†ö%s", 
addr
,

5473 
fûãr
->
dli°
[
ö
].
«me
, 
VTY_NEWLINE
);

5474 i‡(
fûãr
->
dli°
[
out
].
«me
 && ! 
gfûãr
)

5475 
	`vty_out
 (
vty
, "Çeighb‹ %†di°ribuã-li° %†out%s", 
addr
,

5476 
fûãr
->
dli°
[
out
].
«me
, 
VTY_NEWLINE
);

5479 i‡(
fûãr
->
∂i°
[
ö
].
«me
)

5480 i‡(! 
gfûãr
 || ! gfûãr->
∂i°
[
ö
].
«me


5481 || 
	`°rcmp
 (
fûãr
->
∂i°
[
ö
].
«me
, 
gfûãr
->plist[in].name) != 0)

5482 
	`vty_out
 (
vty
, "Çeighb‹ %†¥efix-li° %†ö%s", 
addr
,

5483 
fûãr
->
∂i°
[
ö
].
«me
, 
VTY_NEWLINE
);

5484 i‡(
fûãr
->
∂i°
[
out
].
«me
 && ! 
gfûãr
)

5485 
	`vty_out
 (
vty
, "Çeighb‹ %†¥efix-li° %†out%s", 
addr
,

5486 
fûãr
->
∂i°
[
out
].
«me
, 
VTY_NEWLINE
);

5489 i‡(
fûãr
->
m≠
[
RMAP_IN
].
«me
)

5490 i‡(! 
gfûãr
 || ! gfûãr->
m≠
[
RMAP_IN
].
«me


5491 || 
	`°rcmp
 (
fûãr
->
m≠
[
RMAP_IN
].
«me
, 
gfûãr
->map[RMAP_IN].name) != 0)

5492 
	`vty_out
 (
vty
, "Çeighb‹ %†rouã-m≠ %†ö%s", 
addr
,

5493 
fûãr
->
m≠
[
RMAP_IN
].
«me
, 
VTY_NEWLINE
);

5494 i‡(
fûãr
->
m≠
[
RMAP_OUT
].
«me
 && ! 
gfûãr
)

5495 
	`vty_out
 (
vty
, "Çeighb‹ %†rouã-m≠ %†out%s", 
addr
,

5496 
fûãr
->
m≠
[
RMAP_OUT
].
«me
, 
VTY_NEWLINE
);

5497 i‡(
fûãr
->
m≠
[
RMAP_IMPORT
].
«me
 && ! 
gfûãr
)

5498 
	`vty_out
 (
vty
, "Çeighb‹ %†rouã-m≠ %†imp‹t%s", 
addr
,

5499 
fûãr
->
m≠
[
RMAP_IMPORT
].
«me
, 
VTY_NEWLINE
);

5500 i‡(
fûãr
->
m≠
[
RMAP_EXPORT
].
«me
)

5501 i‡(! 
gfûãr
 || ! gfûãr->
m≠
[
RMAP_EXPORT
].
«me


5502 || 
	`°rcmp
 (
fûãr
->
m≠
[
RMAP_EXPORT
].
«me
,

5503 
gfûãr
->
m≠
[
RMAP_EXPORT
].
«me
) != 0)

5504 
	`vty_out
 (
vty
, "Çeighb‹ %†rouã-m≠ %†exp‹t%s", 
addr
,

5505 
fûãr
->
m≠
[
RMAP_EXPORT
].
«me
, 
VTY_NEWLINE
);

5508 i‡(
fûãr
->
usm≠
.
«me
 && ! 
gfûãr
)

5509 
	`vty_out
 (
vty
, "Çeighb‹ %†unsuµªss-m≠ %s%s", 
addr
,

5510 
fûãr
->
usm≠
.
«me
, 
VTY_NEWLINE
);

5513 i‡(
fûãr
->
a¶i°
[
ö
].
«me
)

5514 i‡(! 
gfûãr
 || ! gfûãr->
a¶i°
[
ö
].
«me


5515 || 
	`°rcmp
 (
fûãr
->
a¶i°
[
ö
].
«me
, 
gfûãr
->aslist[in].name) != 0)

5516 
	`vty_out
 (
vty
, "Çeighb‹ %†fûãr-li° %†ö%s", 
addr
,

5517 
fûãr
->
a¶i°
[
ö
].
«me
, 
VTY_NEWLINE
);

5518 i‡(
fûãr
->
a¶i°
[
out
].
«me
 && ! 
gfûãr
)

5519 
	`vty_out
 (
vty
, "Çeighb‹ %†fûãr-li° %†out%s", 
addr
,

5520 
fûãr
->
a¶i°
[
out
].
«me
, 
VTY_NEWLINE
);

5521 
	}
}

5525 
	$bgp_c⁄fig_wrôe_≥î
 (
vty
 *vty, 
bgp
 *bgp,

5526 
≥î
 *≥î, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

5528 
≥î
 *
g_≥î
 = 
NULL
;

5529 
buf
[
SU_ADDRSTRLEN
];

5530 *
addr
;

5532 
addr
 = 
≥î
->
ho°
;

5533 i‡(
	`≥î_group_a˘ive
 (
≥î
))

5534 
g_≥î
 = 
≥î
->
group
->
c⁄f
;

5539 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

5542 i‡(! 
	`≥î_group_a˘ive
 (
≥î
))

5544 i‡(
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_GROUP
))

5545 
	`vty_out
 (
vty
, "Çeighb‹ %†≥î-group%s", 
addr
,

5546 
VTY_NEWLINE
);

5547 i‡(
≥î
->
as
)

5548 
	`vty_out
 (
vty
, "Çeighb‹ %†ªmŸe-a†%u%s", 
addr
, 
≥î
->
as
,

5549 
VTY_NEWLINE
);

5553 i‡(! 
g_≥î
->
as
)

5554 
	`vty_out
 (
vty
, "Çeighb‹ %†ªmŸe-a†%u%s", 
addr
, 
≥î
->
as
,

5555 
VTY_NEWLINE
);

5556 i‡(
≥î
->
af_group
[
AFI_IP
][
SAFI_UNICAST
])

5557 
	`vty_out
 (
vty
, "Çeighb‹ %†≥î-grou∞%s%s", 
addr
,

5558 
≥î
->
group
->
«me
, 
VTY_NEWLINE
);

5562 i‡(
≥î
->
ch™ge_loˇl_as
)

5563 i‡(! 
	`≥î_group_a˘ive
 (
≥î
))

5564 
	`vty_out
 (
vty
, "Çeighb‹ %†loˇl-a†%u%s%s%s", 
addr
,

5565 
≥î
->
ch™ge_loˇl_as
,

5566 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_NO_PREPEND
) ?

5568 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_LOCAL_AS_REPLACE_AS
) ?

5569 "Ñïœ˚-as" : "", 
VTY_NEWLINE
);

5572 i‡(
≥î
->
desc
)

5573 
	`vty_out
 (
vty
, "Çeighb‹ %†des¸ùti⁄ %s%s", 
addr
, 
≥î
->
desc
,

5574 
VTY_NEWLINE
);

5577 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_SHUTDOWN
))

5578 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5579 ! 
	`CHECK_FLAG
 (
g_≥î
->
Êags
, 
PEER_FLAG_SHUTDOWN
))

5580 
	`vty_out
 (
vty
, "Çeighb‹ %†shutdown%s", 
addr
, 
VTY_NEWLINE
);

5583 i‡(
≥î
->
∑ssw‹d
)

5584 i‡(!
	`≥î_group_a˘ive
 (
≥î
)

5585 || ! 
g_≥î
->
∑ssw‹d


5586 || 
	`°rcmp
 (
≥î
->
∑ssw‹d
, 
g_≥î
->password) != 0)

5587 
	`vty_out
 (
vty
, "Çeighb‹ %†∑ssw‹d %s%s", 
addr
, 
≥î
->
∑ssw‹d
,

5588 
VTY_NEWLINE
);

5591 i‡(
≥î
->
p‹t
 !
BGP_PORT_DEFAULT
)

5592 
	`vty_out
 (
vty
, "Çeighb‹ %†p‹à%d%s", 
addr
, 
≥î
->
p‹t
,

5593 
VTY_NEWLINE
);

5596 i‡(
≥î
->
i‚ame
)

5597 
	`vty_out
 (
vty
, "Çeighb‹ %†öãrÁ˚ %s%s", 
addr
, 
≥î
->
i‚ame
,

5598 
VTY_NEWLINE
);

5601 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_PASSIVE
))

5602 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5603 ! 
	`CHECK_FLAG
 (
g_≥î
->
Êags
, 
PEER_FLAG_PASSIVE
))

5604 
	`vty_out
 (
vty
, "Çeighb‹ %†∑ssive%s", 
addr
, 
VTY_NEWLINE
);

5607 i‡(
≥î
->
s‹t
 !
BGP_PEER_IBGP
 &&Öìr->
âl
 != 1 &&

5608 !(
≥î
->
gtsm_h›s
 !0 &&Öìr->
âl
 =
MAXTTL
))

5609 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5610 
g_≥î
->
âl
 !
≥î
->ttl)

5611 
	`vty_out
 (
vty
, "Çeighb‹ %†ebgp-mu…ih› %d%s", 
addr
, 
≥î
->
âl
,

5612 
VTY_NEWLINE
);

5615 i‡(
≥î
->
s‹t
 !
BGP_PEER_IBGP
 &&Öìr->
gtsm_h›s
 != 0)

5616 i‡(! 
	`≥î_group_a˘ive
 (
≥î
Ë|| 
g_≥î
->
gtsm_h›s
 !=Öeer->gtsm_hops)

5617 
	`vty_out
 (
vty
, "Çeighb‹ %†âl-£curôy h›†%d%s", 
addr
,

5618 
≥î
->
gtsm_h›s
, 
VTY_NEWLINE
);

5621 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DISABLE_CONNECTED_CHECK
))

5622 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5623 ! 
	`CHECK_FLAG
 (
g_≥î
->
Êags
, 
PEER_FLAG_DISABLE_CONNECTED_CHECK
))

5624 
	`vty_out
 (
vty
, "Çeighb‹ %†dißbÀ-c⁄√˘ed-check%s", 
addr
, 
VTY_NEWLINE
);

5627 i‡(
≥î
->
upd©e_if
)

5628 i‡(! 
	`≥î_group_a˘ive
 (
≥î
Ë|| ! 
g_≥î
->
upd©e_if


5629 || 
	`°rcmp
 (
g_≥î
->
upd©e_if
, 
≥î
->update_if) != 0)

5630 
	`vty_out
 (
vty
, "Çeighb‹ %†upd©e-sour˚ %s%s", 
addr
,

5631 
≥î
->
upd©e_if
, 
VTY_NEWLINE
);

5632 i‡(
≥î
->
upd©e_sour˚
)

5633 i‡(! 
	`≥î_group_a˘ive
 (
≥î
Ë|| ! 
g_≥î
->
upd©e_sour˚


5634 || 
	`sockuni⁄_cmp
 (
g_≥î
->
upd©e_sour˚
,

5635 
≥î
->
upd©e_sour˚
) != 0)

5636 
	`vty_out
 (
vty
, "Çeighb‹ %†upd©e-sour˚ %s%s", 
addr
,

5637 
	`sockuni⁄2°r
 (
≥î
->
upd©e_sour˚
, 
buf
, 
SU_ADDRSTRLEN
),

5638 
VTY_NEWLINE
);

5641 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_ROUTEADV
))

5642 
	`vty_out
 (
vty
, "Çeighbor %sádvertisement-interval %d%s",

5643 
addr
, 
≥î
->
v_rouãadv
, 
VTY_NEWLINE
);

5646 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_TIMER
)

5647 && ! 
	`≥î_group_a˘ive
 (
≥î
))

5648 
	`vty_out
 (
vty
, "Çeighb‹ %†timî†%d %d%s", 
addr
,

5649 
≥î
->
kì∑live
,Öìr->
hﬁdtime
, 
VTY_NEWLINE
);

5651 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_CONNECT
))

5652 
	`vty_out
 (
vty
, "Çeighb‹ %†timî†c⁄√˘ %d%s", 
addr
,

5653 
≥î
->
c⁄√˘
, 
VTY_NEWLINE
);

5656 i‡(
	`CHECK_FLAG
 (
≥î
->
c⁄fig
, 
PEER_CONFIG_WEIGHT
))

5657 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5658 
g_≥î
->
weight
 !
≥î
->weight)

5659 
	`vty_out
 (
vty
, "Çeighb‹ %†weighà%d%s", 
addr
, 
≥î
->
weight
,

5660 
VTY_NEWLINE
);

5663 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DYNAMIC_CAPABILITY
))

5664 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5665 ! 
	`CHECK_FLAG
 (
g_≥î
->
Êags
, 
PEER_FLAG_DYNAMIC_CAPABILITY
))

5666 
	`vty_out
 (
vty
, "Çeighb‹ %†ˇ∑bûôy dy«mic%s", 
addr
,

5667 
VTY_NEWLINE
);

5670 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_DONT_CAPABILITY
))

5671 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5672 ! 
	`CHECK_FLAG
 (
g_≥î
->
Êags
, 
PEER_FLAG_DONT_CAPABILITY
))

5673 
	`vty_out
 (
vty
, "Çeighb‹ %†d⁄t-ˇ∑bûôy-√gŸüã%s", 
addr
,

5674 
VTY_NEWLINE
);

5675 #ifde‡
USE_SRX


5677 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
) &&

5678 
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
))

5679 
	`vty_out
 (
vty
, "Çeighb‹ %†bgp£¯bŸh%s", 
addr
, 
VTY_NEWLINE
);

5680 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_SEND
))

5681 
	`vty_out
 (
vty
, "Çeighb‹ %†bgp£¯¢d %s", 
addr
, 
VTY_NEWLINE
);

5682 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_BGPSEC_CAPABILITY_RECV
))

5683 
	`vty_out
 (
vty
, "Çeighb‹ %†bgp£¯ª¯%s", 
addr
, 
VTY_NEWLINE
);

5686 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_LIBERAL
))

5688 
	`vty_out
 (
vty
, "Çeighb‹ %†ˇ∑bûôyÉxãndedÜibîÆ%s", 
addr
,

5689 
VTY_NEWLINE
);

5691 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
))

5693 
	`vty_out
 (
vty
, "Çeighb‹ %†ˇ∑bûôyÉxãnded%s", 
addr
,

5694 
VTY_NEWLINE
);

5700 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_OVERRIDE_CAPABILITY
))

5701 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5702 ! 
	`CHECK_FLAG
 (
g_≥î
->
Êags
, 
PEER_FLAG_OVERRIDE_CAPABILITY
))

5703 
	`vty_out
 (
vty
, "Çeighb‹ %†ovîride-ˇ∑bûôy%s", 
addr
,

5704 
VTY_NEWLINE
);

5707 i‡(
	`CHECK_FLAG
 (
≥î
->
Êags
, 
PEER_FLAG_STRICT_CAP_MATCH
))

5708 i‡(! 
	`≥î_group_a˘ive
 (
≥î
) ||

5709 ! 
	`CHECK_FLAG
 (
g_≥î
->
Êags
, 
PEER_FLAG_STRICT_CAP_MATCH
))

5710 
	`vty_out
 (
vty
, "Çeighb‹ %†°ri˘-ˇ∑bûôy-m©ch%s", 
addr
,

5711 
VTY_NEWLINE
);

5713 i‡(! 
≥î
->
af_group
[
AFI_IP
][
SAFI_UNICAST
])

5715 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_NO_DEFAULT_IPV4
))

5717 i‡(
≥î
->
afc
[
AFI_IP
][
SAFI_UNICAST
])

5718 
	`vty_out
 (
vty
, "Çeighb‹ %†a˘iv©e%s", 
addr
, 
VTY_NEWLINE
);

5722 i‡(! 
≥î
->
afc
[
AFI_IP
][
SAFI_UNICAST
])

5723 
	`vty_out
 (
vty
, "Çÿ√ighb‹ %†a˘iv©e%s", 
addr
, 
VTY_NEWLINE
);

5733 i‡(! (
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
))

5735 i‡(
≥î
->
af_group
[
afi
][
ßfi
])

5736 
	`vty_out
 (
vty
, "Çeighb‹ %†≥î-grou∞%s%s", 
addr
,

5737 
≥î
->
group
->
«me
, 
VTY_NEWLINE
);

5739 
	`vty_out
 (
vty
, "Çeighb‹ %†a˘iv©e%s", 
addr
, 
VTY_NEWLINE
);

5743 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_SM
)

5744 || 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_RM
))

5745 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

5747 
	`vty_out
 (
vty
, "Çeighb‹ %†ˇ∑bûôy or‡¥efix-li°", 
addr
);

5749 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_SM
)

5750 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_RM
))

5751 
	`vty_out
 (
vty
, " both");

5752 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_ORF_PREFIX_SM
))

5753 
	`vty_out
 (
vty
, " send");

5755 
	`vty_out
 (
vty
, "Ñeceive");

5756 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

5760 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_REFLECTOR_CLIENT
)

5761 && ! 
≥î
->
af_group
[
afi
][
ßfi
])

5762 
	`vty_out
 (
vty
, "Çeighb‹ %†rouã-ªÊe˘‹-˛õ¡%s", 
addr
,

5763 
VTY_NEWLINE
);

5766 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_NEXTHOP_SELF
)

5767 && ! 
≥î
->
af_group
[
afi
][
ßfi
])

5768 
	`vty_out
 (
vty
, "Çeighb‹ %†√xt-h›-£lf%s", 
addr
, 
VTY_NEWLINE
);

5771 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_REMOVE_PRIVATE_AS
)

5772 && ! 
≥î
->
af_group
[
afi
][
ßfi
])

5773 
	`vty_out
 (
vty
, "Çeighbor %sÑemove-private-AS%s",

5774 
addr
, 
VTY_NEWLINE
);

5777 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
])

5779 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
))

5781 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_COMMUNITY
)

5782 && 
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_EXT_COMMUNITY
))

5783 
	`vty_out
 (
vty
, "Çeighb‹ %†£nd-communôy bŸh%s", 
addr
, 
VTY_NEWLINE
);

5784 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_EXT_COMMUNITY
))

5785 
	`vty_out
 (
vty
, "Çeighbor %s send-communityÉxtended%s",

5786 
addr
, 
VTY_NEWLINE
);

5787 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_COMMUNITY
))

5788 
	`vty_out
 (
vty
, "Çeighb‹ %†£nd-communôy%s", 
addr
, 
VTY_NEWLINE
);

5792 i‡(! 
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_COMMUNITY
)

5793 && ! 
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_EXT_COMMUNITY
))

5794 
	`vty_out
 (
vty
, "ÇoÇeighbor %s send-community both%s",

5795 
addr
, 
VTY_NEWLINE
);

5796 i‡(! 
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_EXT_COMMUNITY
))

5797 
	`vty_out
 (
vty
, "ÇoÇeighbor %s send-communityÉxtended%s",

5798 
addr
, 
VTY_NEWLINE
);

5799 i‡(! 
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_SEND_COMMUNITY
))

5800 
	`vty_out
 (
vty
, "ÇoÇeighbor %s send-community%s",

5801 
addr
, 
VTY_NEWLINE
);

5806 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_DEFAULT_ORIGINATE
)

5807 && ! 
≥î
->
af_group
[
afi
][
ßfi
])

5809 
	`vty_out
 (
vty
, "Çeighb‹ %†deÁu…-‹igö©e", 
addr
);

5810 i‡(
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
)

5811 
	`vty_out
 (
vty
, "Ñouã-m≠ %s", 
≥î
->
deÁu…_rm≠
[
afi
][
ßfi
].
«me
);

5812 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

5816 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SOFT_RECONFIG
))

5817 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
] ||

5818 ! 
	`CHECK_FLAG
 (
g_≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_SOFT_RECONFIG
))

5819 
	`vty_out
 (
vty
, "Çeighb‹ %†so·-ªc⁄figuøti⁄ inbound%s", 
addr
,

5820 
VTY_NEWLINE
);

5823 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX
))

5824 i‡(! 
≥î
->
af_group
[
afi
][
ßfi
]

5825 || 
g_≥î
->
pmax
[
afi
][
ßfi
] !
≥î
->pmax[afi][safi]

5826 || 
g_≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] !
≥î
->pmax_threshold[afi][safi]

5827 || 
	`CHECK_FLAG
 (
g_≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
)

5828 !
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
))

5830 
	`vty_out
 (
vty
, "Çeighb‹ %†maximum-¥efix %ld", 
addr
, 
≥î
->
pmax
[
afi
][
ßfi
]);

5831 i‡(
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
] !
MAXIMUM_PREFIX_THRESHOLD_DEFAULT
)

5832 
	`vty_out
 (
vty
, " %d", 
≥î
->
pmax_thªshﬁd
[
afi
][
ßfi
]);

5833 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MAX_PREFIX_WARNING
))

5834 
	`vty_out
 (
vty
, " warning-only");

5835 i‡(
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
])

5836 
	`vty_out
 (
vty
, "Ñe°¨à%d", 
≥î
->
pmax_ª°¨t
[
afi
][
ßfi
]);

5837 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

5841 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_RSERVER_CLIENT
)

5842 && ! 
≥î
->
af_group
[
afi
][
ßfi
])

5843 
	`vty_out
 (
vty
, "Çeighb‹ %†rouã-£rvî-˛õ¡%s", 
addr
, 
VTY_NEWLINE
);

5846 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
)

5847 && ! 
≥î
->
af_group
[
afi
][
ßfi
])

5848 
	`vty_out
 (
vty
, "Çeighb‹ %†√xth›-loˇ»unch™ged%s", 
addr
, 
VTY_NEWLINE
);

5851 i‡(
	`≥î_af_Êag_check
 (
≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_ALLOWAS_IN
))

5852 i‡(! 
	`≥î_group_a˘ive
 (
≥î
)

5853 || ! 
	`≥î_af_Êag_check
 (
g_≥î
, 
afi
, 
ßfi
, 
PEER_FLAG_ALLOWAS_IN
)

5854 || 
≥î
->
Ælowas_ö
[
afi
][
ßfi
] !
g_≥î
->allowas_in[afi][safi])

5856 i‡(
≥î
->
Ælowas_ö
[
afi
][
ßfi
] == 3)

5857 
	`vty_out
 (
vty
, "Çeighb‹ %†Ælowas-ö%s", 
addr
, 
VTY_NEWLINE
);

5859 
	`vty_out
 (
vty
, "Çeighb‹ %†Ælowas-ö %d%s", 
addr
,

5860 
≥î
->
Ælowas_ö
[
afi
][
ßfi
], 
VTY_NEWLINE
);

5864 
	`bgp_c⁄fig_wrôe_fûãr
 (
vty
, 
≥î
, 
afi
, 
ßfi
);

5867 i‡((
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_AS_PATH_UNCHANGED
)

5868 || 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_UNCHANGED
)

5869 || 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MED_UNCHANGED
))

5870 && ! 
≥î
->
af_group
[
afi
][
ßfi
])

5872 i‡(
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_AS_PATH_UNCHANGED
)

5873 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_UNCHANGED
)

5874 && 
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MED_UNCHANGED
))

5875 
	`vty_out
 (
vty
, "Çeighb‹ %†©åibuã-unch™ged%s", 
addr
, 
VTY_NEWLINE
);

5877 
	`vty_out
 (
vty
, "Çeighb‹ %†©åibuã-unch™ged%s%s%s%s", 
addr
,

5878 (
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_AS_PATH_UNCHANGED
)) ?

5880 (
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_NEXTHOP_UNCHANGED
)) ?

5882 (
	`CHECK_FLAG
 (
≥î
->
af_Êags
[
afi
][
ßfi
], 
PEER_FLAG_MED_UNCHANGED
)) ?

5883 " med" : "", 
VTY_NEWLINE
);

5885 
	}
}

5889 
	$bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
 *vty, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
,

5890 *
wrôe
)

5892 i‡(*
wrôe
)

5895 i‡(
afi
 =
AFI_IP
 && 
ßfi
 =
SAFI_UNICAST
)

5898 
	`vty_out
 (
vty
, "!%†addªss-Ámûy ", 
VTY_NEWLINE
);

5900 i‡(
afi
 =
AFI_IP
)

5902 i‡(
ßfi
 =
SAFI_MULTICAST
)

5903 
	`vty_out
 (
vty
, "ipv4 multicast");

5904 i‡(
ßfi
 =
SAFI_MPLS_VPN
)

5905 
	`vty_out
 (
vty
, "vpnv4 unicast");

5907 i‡(
afi
 =
AFI_IP6
)

5909 
	`vty_out
 (
vty
, "ipv6");

5911 i‡(
ßfi
 =
SAFI_MULTICAST
)

5912 
	`vty_out
 (
vty
, " multicast");

5915 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

5917 *
wrôe
 = 1;

5918 
	}
}

5922 
	$bgp_c⁄fig_wrôe_Ámûy
 (
vty
 *vty, 
bgp
 *bgp, 
afi_t
 
afi
,

5923 
ßfi_t
 
ßfi
)

5925 
wrôe
 = 0;

5926 
≥î
 *peer;

5927 
≥î_group
 *
group
;

5928 
li°node
 *
node
, *
¬ode
;

5930 
	`bgp_c⁄fig_wrôe_√tw‹k
 (
vty
, 
bgp
, 
afi
, 
ßfi
, &
wrôe
);

5932 
	`bgp_c⁄fig_wrôe_ªdi°ribuã
 (
vty
, 
bgp
, 
afi
, 
ßfi
, &
wrôe
);

5934 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
¬ode
, group))

5936 i‡(
group
->
c⁄f
->
afc
[
afi
][
ßfi
])

5938 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, &
wrôe
);

5939 
	`bgp_c⁄fig_wrôe_≥î
 (
vty
, 
bgp
, 
group
->
c⁄f
, 
afi
, 
ßfi
);

5942 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

5944 i‡(
≥î
->
afc
[
afi
][
ßfi
])

5946 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

5948 
	`bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
, 
afi
, 
ßfi
, &
wrôe
);

5949 
	`bgp_c⁄fig_wrôe_≥î
 (
vty
, 
bgp
, 
≥î
, 
afi
, 
ßfi
);

5954 
	`bgp_c⁄fig_wrôe_max∑ths
 (
vty
, 
bgp
, 
afi
, 
ßfi
, &
wrôe
);

5956 i‡(
wrôe
)

5957 
	`vty_out
 (
vty
, "Éxô-addªss-Ámûy%s", 
VTY_NEWLINE
);

5959  
wrôe
;

5960 
	}
}

5962 #ifde‡
USE_SRX


5963 
	$§x_c⁄fig_wrôe_c⁄figuøti⁄
 (
vty
 *vty, 
bgp
 *bgp)

5965 c⁄° *
INDEX_STR
[3] =

5972 
noEÀmíts
 = 3;

5973 
ödex
;

5976 
	`vty_out
 (
vty
, "%†! SRx Basi¯C⁄figuøti⁄ Sëtögs%s", 
VTY_NEWLINE
, VTY_NEWLINE);

5977 
	`vty_out
 (
vty
, " srx set-proxy-id %u.%u.%u.%u%s",

5978 (
bgp
->
§x_¥oxyID
 >> 24) & 0xFF, (bgp->srx_proxyID >> 16) & 0xFF,

5979 (
bgp
->
§x_¥oxyID
 >> 8) & 0xFF, bgp->srx_proxyID & 0xFF,

5980 
VTY_NEWLINE
);

5983 i‡(
bgp
->
§x_ho°
 !
NULL
)

5985 
	`vty_out
 (
vty
, " %†%†%d%s", 
SRX_VTY_CMD_SET_SERVER_SHORT
,

5986 
bgp
->
§x_ho°
, bgp->
§x_p‹t
, 
VTY_NEWLINE
);

5991 
	`vty_out
 (
vty
, " %†%d%s", 
SRX_VTY_CMD_KEEPWINDOW_SHORT
,

5992 
bgp
->
§x_kìpWödow
, 
VTY_NEWLINE
);

5995 i‡(
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_PATH
))

5997 i‡(
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_DISTR
))

5999 
	`vty_out
 (
vty
, " srxÉvÆu©i⁄ %†di°ribuãd%s", 
SRX_VTY_EVAL_BGPSEC
,

6000 
VTY_NEWLINE
);

6004 
	`vty_out
 (
vty
, " srxÉvÆu©i⁄ %s%s", 
SRX_VTY_EVAL_BGPSEC
, 
VTY_NEWLINE
);

6007 i‡(
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_ORIGIN
))

6009 
	`vty_out
 (
vty
, " srxÉvÆu©i⁄ %s%s", 
SRX_VTY_EVAL_ORIGIN_ONLY
,

6010 
VTY_NEWLINE
);

6014 
	`vty_out
 (
vty
, "Çÿ§xÉvÆu©i⁄%s", 
VTY_NEWLINE
);

6017 i‡(
	`CHECK_FLAG
(
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY
))

6019 i‡(
	`CHECK_FLAG
(
bgp
->
§x_ecommunôy_Êags
, 
SRX_BGP_FLAG_ECOMMUNITY_EBGP
))

6021 
	`vty_out
 (
vty
, " srxÉxtcommunity %d include_ebgp%s",

6022 
bgp
->
§x_ecommunôy_subcode
, 
VTY_NEWLINE
);

6026 
	`vty_out
 (
vty
, " srxÉxtcommunity %d only_ibgp%s",

6027 
bgp
->
§x_ecommunôy_subcode
, 
VTY_NEWLINE
);

6032 
	`vty_out
 (
vty
, "Çÿ§xÉxtcommunôy%s", 
VTY_NEWLINE
);

6036 
	`vty_out
 (
vty
, " %s%s%s",

6037 
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_DISPLAY_INFO
) ? "" : "no ",

6038 
SRX_VTY_CMD_DISPLAY
, 
VTY_NEWLINE
);

6041 
	`vty_out
 (
vty
, "%†! SRx EvÆu©i⁄ C⁄figuøti⁄ Sëtögs%s", 
VTY_NEWLINE
, VTY_NEWLINE);

6046 
bgp
->
§x_deÁu…_rﬂVÆ
)

6048 
SRx_RESULT_VALID
:

6049 
	`vty_out
 (
vty
, " %s", 
SRX_VTY_CMD_CONF_DEF_ROA_RES_VALID
 );

6051 
SRx_RESULT_NOTFOUND
:

6052 
	`vty_out
 (
vty
, " %s", 
SRX_VTY_CMD_CONF_DEF_ROA_RES_NOTFOUND
 );

6054 
SRx_RESULT_INVALID
:

6055 
	`vty_out
 (
vty
, " %s", 
SRX_VTY_CMD_CONF_DEF_ROA_RES_INVALID
 );

6057 
SRx_RESULT_UNDEFINED
:

6059 
	`vty_out
 (
vty
, " %s", 
SRX_VTY_CMD_CONF_DEF_ROA_RES_UNDEFINED
 );

6062 
	`vty_out
 (
vty
, "%s", (vty->
ty≥
 =
VTY_TERM
) ? "\r" : "");

6065 
bgp
->
§x_deÁu…_bgp£cVÆ
)

6067 
SRx_RESULT_VALID
:

6068 
	`vty_out
 (
vty
, " %s", 
SRX_VTY_CMD_CONF_DEF_PATH_RES_VALID
 );

6070 
SRx_RESULT_INVALID
:

6071 
	`vty_out
 (
vty
, " %s", 
SRX_VTY_CMD_CONF_DEF_PATH_RES_INVALID
 );

6073 
SRx_RESULT_UNDEFINED
:

6075 
	`vty_out
 (
vty
, " %s", 
SRX_VTY_CMD_CONF_DEF_PATH_RES_UNDEFINED
 );

6079 
	`vty_out
 (
vty
, "%s", (vty->
ty≥
 =
VTY_TERM
) ? "\r" : "");

6082 
ödex
 = 0; index < 
noEÀmíts
; index++)

6084 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
is_£t
)

6086 
	`vty_out
 (
vty
, " %†%†%u", 
SRX_VTY_CMD_POL_LOCP
, 
INDEX_STR
[
ödex
],

6087 
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
vÆue
);

6089 i‡(
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
ªœtive
)

6091 
	`vty_out
 (
vty
, " %s", (
bgp
->
§x_vÆ_loˇl_¥ef
[
ödex
].
ªœtive
 == 1)

6095 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

6100 i‡(
	`CHECK_FLAG
 (
bgp
->
§x_vÆ_pﬁicy
, 
SRX_VAL_POLICY_PREFER_VALID
))

6102 
	`vty_out
 (
vty
, " %s%s", 
SRX_VTY_CMD_POL_PREFV
, 
VTY_NEWLINE
);

6106 i‡(
	`CHECK_FLAG
 (
bgp
->
§x_vÆ_pﬁicy
, 
SRX_VAL_POLICY_IGNORE_NOTFOUND
))

6108 i‡(
	`§x_c⁄fig_check
(
bgp
, 
SRX_CONFIG_EVAL_PATH
))

6110 
	`vty_out
 (
vty
, " ! The followingÖolicy onlyáppliesÅo \""

6112 
SRX_VTY_EVAL_ORIGIN_ONLY
,
VTY_NEWLINE
);

6114 
	`vty_out
 (
vty
, " %s%s", 
SRX_VTY_CMD_POL_IGNORE_NOTFOUND
, 
VTY_NEWLINE
);

6116 i‡(
	`CHECK_FLAG
 (
bgp
->
§x_vÆ_pﬁicy
, 
SRX_VAL_POLICY_IGNORE_INVALID
))

6118 
	`vty_out
 (
vty
, " %s%s", 
SRX_VTY_CMD_POL_IGNORE_INVALID
, 
VTY_NEWLINE
);

6122 i‡(
	`bgp_c⁄fig_check
(
bgp
, 
BGP_CONFIG_SRX
))

6125 
	`vty_out
 (
vty
, "%†! C⁄√˘ÅÿSRx-£rvî%s", 
VTY_NEWLINE
, VTY_NEWLINE);

6126 
	`vty_out
 (
vty
, " %s%s", 
SRX_VTY_CMD_CONNECT_SHORT
, 
VTY_NEWLINE
);

6130 
	}
}

6134 
	$bgp_c⁄fig_wrôe
 (
vty
 *vty)

6136 
wrôe
 = 0;

6137 
bgp
 *bgp;

6138 
≥î_group
 *
group
;

6139 
≥î
 *peer;

6140 
li°node
 *
node
, *
¬ode
;

6141 
li°node
 *
mnode
, *
m¬ode
;

6144 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_MULTIPLE_INSTANCE
))

6146 
	`vty_out
 (
vty
, "bg∞mu…ùÀ-ö°™˚%s", 
VTY_NEWLINE
);

6147 
wrôe
++;

6151 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
))

6153 
	`vty_out
 (
vty
, "bg∞c⁄fig-ty≥ cisco%s", 
VTY_NEWLINE
);

6154 
wrôe
++;

6158 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

6160 i‡(
wrôe
)

6161 
	`vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

6164 
	`vty_out
 (
vty
, "rouã∏bg∞%u", 
bgp
->
as
);

6166 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_MULTIPLE_INSTANCE
))

6168 i‡(
bgp
->
«me
)

6169 
	`vty_out
 (
vty
, " võw %s", 
bgp
->
«me
);

6171 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

6174 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
))

6175 
	`vty_out
 (
vty
, "Çÿsynchr⁄iz©i⁄%s", 
VTY_NEWLINE
);

6178 i‡(
	`CHECK_FLAG
 (
bgp
->
Êags
, 
BGP_FLAG_NO_FAST_EXT_FAILOVER
))

6179 
	`vty_out
 (
vty
, "Çÿbg∞Á°-exã∫Æ-Áûovî%s", 
VTY_NEWLINE
);

6182 i‡(
	`CHECK_FLAG
 (
bgp
->
c⁄fig
, 
BGP_CONFIG_ROUTER_ID
))

6183 
	`vty_out
 (
vty
, " bg∞rouãr-id %s%s", 
	`öë_¡ﬂ
 (
bgp
->
rouãr_id
),

6184 
VTY_NEWLINE
);

6185 #ifde‡
USE_SRX


6188 
kIdx
 = 0;

6189 
bIdx
 = 0;

6190 ; 
kIdx
 < 
SRX_MAX_PRIVKEYS
; kIdx++)

6192 
skiSå
[
SKI_HEX_LENGTH
+1];

6193 * 
cPå
 = 
skiSå
;

6194 
	`mem£t
(
skiSå
, 0, 
SKI_HEX_LENGTH
+1);

6195 
bIdx
 = 0; bIdx < 
SKI_LENGTH
; bIdx++)

6197 
cPå
 +
	`•rötf
(cPå, "%02X", 
bgp
->
§x_bgp£c_key
[
kIdx
].
ski
[
bIdx
]);

6199 i‡(
kIdx
 == 0)

6201 
	`vty_out
 (
vty
, "! Thêfﬁlowög f‹m i†dïªˇãd.%s", 
VTY_NEWLINE
);

6202 
	`vty_out
 (
vty
, "! bgp£¯skò%s%s", 
skiSå
, 
VTY_NEWLINE
);

6205 
	`vty_out
 (
vty
, " srx bgp£¯skò%u %s%s", 
kIdx
, 
skiSå
, 
VTY_NEWLINE
);

6207 
	`vty_out
 (
vty
, " srx bgp£¯a˘ive-skò%u%s", 
bgp
->
§x_bgp£c_a˘ive_key
,

6208 
VTY_NEWLINE
);

6212 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_LOG_NEIGHBOR_CHANGES
))

6213 
	`vty_out
 (
vty
, " bg∞log-√ighb‹-ch™ges%s", 
VTY_NEWLINE
);

6216 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_ALWAYS_COMPARE_MED
))

6217 
	`vty_out
 (
vty
, " bg∞Æways-com∑ª-med%s", 
VTY_NEWLINE
);

6220 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_NO_DEFAULT_IPV4
))

6221 
	`vty_out
 (
vty
, "Çÿbg∞deÁu… ipv4-uniˇ°%s", 
VTY_NEWLINE
);

6224 i‡(
bgp
->
deÁu…_loˇl_¥ef
 !
BGP_DEFAULT_LOCAL_PREF
)

6225 
	`vty_out
 (
vty
, " bgp defaultÜocal-preference %d%s",

6226 
bgp
->
deÁu…_loˇl_¥ef
, 
VTY_NEWLINE
);

6229 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_NO_CLIENT_TO_CLIENT
))

6230 
	`vty_out
 (
vty
, "Çÿbg∞˛õ¡-to-˛õ¡ÑeÊe˘i⁄%s", 
VTY_NEWLINE
);

6233 i‡(
	`CHECK_FLAG
 (
bgp
->
c⁄fig
, 
BGP_CONFIG_CLUSTER_ID
))

6234 
	`vty_out
 (
vty
, " bg∞˛u°î-id %s%s", 
	`öë_¡ﬂ
 (
bgp
->
˛u°î_id
),

6235 
VTY_NEWLINE
);

6238 i‡(
	`CHECK_FLAG
 (
bgp
->
c⁄fig
, 
BGP_CONFIG_CONFEDERATION
))

6239 
	`vty_out
 (
vty
, " bg∞c⁄„dî©i⁄ idítifõ∏%i%s", 
bgp
->
c⁄„d_id
,

6240 
VTY_NEWLINE
);

6243 i‡(
bgp
->
c⁄„d_≥îs_˙t
 > 0)

6245 
i
;

6247 
	`vty_out
 (
vty
, " bgp confederationÖeers");

6249 
i
 = 0; i < 
bgp
->
c⁄„d_≥îs_˙t
; i++)

6250 
	`vty_out
(
vty
, " %u", 
bgp
->
c⁄„d_≥îs
[
i
]);

6252 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

6256 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_ENFORCE_FIRST_AS
))

6257 
	`vty_out
 (
vty
, " bg∞íf‹˚-fú°-as%s", 
VTY_NEWLINE
);

6260 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_DETERMINISTIC_MED
))

6261 
	`vty_out
 (
vty
, " bg∞dëîmöi°ic-med%s", 
VTY_NEWLINE
);

6264 i‡(
bgp
->
°Æï©h_time
 !
BGP_DEFAULT_STALEPATH_TIME
)

6265 
	`vty_out
 (
vty
, " bgp graceful-restart stalepath-time %d%s",

6266 
bgp
->
°Æï©h_time
, 
VTY_NEWLINE
);

6267 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_GRACEFUL_RESTART
))

6268 
	`vty_out
 (
vty
, " bg∞gø˚ful-ª°¨t%s", 
VTY_NEWLINE
);

6271 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_ASPATH_IGNORE
))

6272 
	`vty_out
 (
vty
, " bg∞be°∑thás-∑th ign‹e%s", 
VTY_NEWLINE
);

6273 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_ASPATH_CONFED
))

6274 
	`vty_out
 (
vty
, " bg∞be°∑thás-∑th c⁄„d%s", 
VTY_NEWLINE
);

6275 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_COMPARE_ROUTER_ID
))

6276 
	`vty_out
 (
vty
, " bg∞be°∑th com∑ª-rouãrid%s", 
VTY_NEWLINE
);

6277 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_MED_CONFED
)

6278 || 
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_MED_MISSING_AS_WORST
))

6280 
	`vty_out
 (
vty
, " bgp bestpath med");

6281 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_MED_CONFED
))

6282 
	`vty_out
 (
vty
, " confed");

6283 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_MED_MISSING_AS_WORST
))

6284 
	`vty_out
 (
vty
, " missing-as-worst");

6285 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

6289 i‡(
	`bgp_Êag_check
 (
bgp
, 
BGP_FLAG_IMPORT_CHECK
))

6290 
	`vty_out
 (
vty
, " bg∞√tw‹k imp‹t-check%s", 
VTY_NEWLINE
);

6293 
	`bgp_c⁄fig_wrôe_sˇn_time
 (
vty
);

6296 i‡(
	`CHECK_FLAG
 (
bgp
->
af_Êags
[
AFI_IP
][
SAFI_UNICAST
],

6297 
BGP_CONFIG_DAMPENING
))

6298 
	`bgp_c⁄fig_wrôe_damp
 (
vty
);

6301 
	`bgp_c⁄fig_wrôe_√tw‹k
 (
vty
, 
bgp
, 
AFI_IP
, 
SAFI_UNICAST
, &
wrôe
);

6304 
	`bgp_c⁄fig_wrôe_ªdi°ribuã
 (
vty
, 
bgp
, 
AFI_IP
, 
SAFI_UNICAST
, &
wrôe
);

6307 i‡(
bgp
->
deÁu…_kì∑live
 !
BGP_DEFAULT_KEEPALIVE


6308 && 
bgp
->
deÁu…_hﬁdtime
 !
BGP_DEFAULT_HOLDTIME
)

6309 
	`vty_out
 (
vty
, "Åimî†bg∞%d %d%s", 
bgp
->
deÁu…_kì∑live
,

6310 
bgp
->
deÁu…_hﬁdtime
, 
VTY_NEWLINE
);

6313 
	`ALL_LIST_ELEMENTS
 (
bgp
->
group
, 
node
, 
¬ode
, group))

6315 
	`bgp_c⁄fig_wrôe_≥î
 (
vty
, 
bgp
, 
group
->
c⁄f
, 
AFI_IP
, 
SAFI_UNICAST
);

6319 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

6321 i‡(! 
	`CHECK_FLAG
 (
≥î
->
sÊags
, 
PEER_STATUS_ACCEPT_PEER
))

6322 
	`bgp_c⁄fig_wrôe_≥î
 (
vty
, 
bgp
, 
≥î
, 
AFI_IP
, 
SAFI_UNICAST
);

6326 
	`bgp_c⁄fig_wrôe_max∑ths
 (
vty
, 
bgp
, 
AFI_IP
, 
SAFI_UNICAST
, &
wrôe
);

6329 
	`bgp_c⁄fig_wrôe_di°™˚
 (
vty
, 
bgp
);

6332 i‡(
	`bgp_›ti⁄_check
 (
BGP_OPT_CONFIG_CISCO
))

6333 
	`vty_out
 (
vty
, "Çÿauto-summ¨y%s", 
VTY_NEWLINE
);

6336 
wrôe
 +
	`bgp_c⁄fig_wrôe_Ámûy
 (
vty
, 
bgp
, 
AFI_IP
, 
SAFI_MULTICAST
);

6339 
wrôe
 +
	`bgp_c⁄fig_wrôe_Ámûy
 (
vty
, 
bgp
, 
AFI_IP
, 
SAFI_MPLS_VPN
);

6342 
wrôe
 +
	`bgp_c⁄fig_wrôe_Ámûy
 (
vty
, 
bgp
, 
AFI_IP6
, 
SAFI_UNICAST
);

6345 
wrôe
 +
	`bgp_c⁄fig_wrôe_Ámûy
 (
vty
, 
bgp
, 
AFI_IP6
, 
SAFI_MULTICAST
);

6348 #ifde‡
USE_SRX


6349 
	`§x_c⁄fig_wrôe_c⁄figuøti⁄
 (
vty
, 
bgp
);

6352 
wrôe
++;

6354  
wrôe
;

6355 
	}
}

6358 
	$bgp_ma°î_öô
 ()

6360 
	`mem£t
 (&
bgp_ma°î
, 0,  (bgp_master));

6362 
bm
 = &
bgp_ma°î
;

6363 
bm
->
bgp
 = 
	`li°_√w
 ();

6364 
bm
->
li°í_sockës
 = 
	`li°_√w
 ();

6365 
bm
->
p‹t
 = 
BGP_PORT_DEFAULT
;

6366 
bm
->
ma°î
 = 
	`thªad_ma°î_¸óã
 ();

6367 
bm
->
°¨t_time
 = 
	`bgp_˛ock
 ();

6368 
	}
}

6372 
	$bgp_öô
 ()

6375 
	`bgp_vty_öô
 ();

6378 
	`bgp_zebø_öô
 ();

6381 
	`bgp_©å_öô
 ();

6382 
	`bgp_debug_öô
 ();

6383 
	`bgp_dump_öô
 ();

6384 
	`bgp_rouã_öô
 ();

6385 
	`bgp_rouã_m≠_öô
 ();

6386 
	`bgp_addªss_öô
 ();

6387 
	`bgp_sˇn_öô
 ();

6388 
	`bgp_m∂sv≤_öô
 ();

6389 #ifde‡
USE_SRX


6390 
	`bgp_Æl_öfo_hashes_öô
 ();

6394 
	`ac˚ss_li°_öô
 ();

6395 
	`ac˚ss_li°_add_hook
 (
≥î_di°ribuã_upd©e
);

6396 
	`ac˚ss_li°_dñëe_hook
 (
≥î_di°ribuã_upd©e
);

6399 
	`bgp_fûãr_öô
 ();

6400 
	`as_li°_add_hook
 (
≥î_a¶i°_upd©e
);

6401 
	`as_li°_dñëe_hook
 (
≥î_a¶i°_upd©e
);

6404 
	`¥efix_li°_öô
 ();

6405 
	`¥efix_li°_add_hook
 (
≥î_¥efix_li°_upd©e
);

6406 
	`¥efix_li°_dñëe_hook
 (
≥î_¥efix_li°_upd©e
);

6409 
bgp_˛i°
 = 
	`communôy_li°_öô
 ();

6411 #ifde‡
HAVE_SNMP


6412 
	`bgp_¢mp_öô
 ();

6414 
	}
}

6416 #ifde‡
USE_GRPC


6417 
SRxProxy
 *
g_¥oxy
;

6418 
Im∂eGoSåómThªad
 (
SRxProxy
* 
¥oxy
, 
uöt32_t
 
¥oxyID
);

6420 
	$gΩc_öô
 (
SRxProxy
* 
¥oxy
, 
uöt32_t
 
¥oxyID
)

6423 
boﬁ
 
öôResu…
 = 
	`ˇŒSRxGRPC_Inô
("localhost:50000");

6424 
	`¥ötf
("¥oxy: %p,Öroxy ID [deÁul]: %08x, gΩcE«bÀd[%d]\n", 
¥oxy
, 
¥oxyID
, 
öôResu…
);

6426 
g_¥oxy
 = 
¥oxy
;

6429 
	`Im∂eGoSåómThªad
(
¥oxy
, 
¥oxyID
);

6430 
	}
}

6434 
	$bgp_ãrmö©e
 ()

6436 
bgp
 *bgp;

6437 
≥î
 *peer;

6438 
li°node
 *
node
, *
¬ode
;

6439 
li°node
 *
mnode
, *
m¬ode
;

6441 
	`ALL_LIST_ELEMENTS
 (
bm
->
bgp
, 
mnode
, 
m¬ode
, bgp))

6442 
	`ALL_LIST_ELEMENTS
 (
bgp
->
≥î
, 
node
, 
¬ode
,Öeer))

6443 i‡(
≥î
->
°©us
 =
E°ablished
)

6444 
	`bgp_nŸify_£nd
 (
≥î
, 
BGP_NOTIFY_CEASE
,

6445 
BGP_NOTIFY_CEASE_PEER_UNCONFIG
);

6447 
	`bgp_˛ónup_rouãs
 ();

6449 i‡(
bm
->
¥o˚ss_maö_queue
)

6451 
	`w‹k_queue_‰ì
 (
bm
->
¥o˚ss_maö_queue
);

6452 
bm
->
¥o˚ss_maö_queue
 = 
NULL
;

6454 i‡(
bm
->
¥o˚ss_rs˛õ¡_queue
)

6456 
	`w‹k_queue_‰ì
 (
bm
->
¥o˚ss_rs˛õ¡_queue
);

6457 
bm
->
¥o˚ss_rs˛õ¡_queue
 = 
NULL
;

6459 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgpd.h

21 #i‚de‡
_QUAGGA_BGPD_H


22 
	#_QUAGGA_BGPD_H


	)

25 
	~"sockuni⁄.h
"

27 #ifde‡
USE_SRX


28 
	~<§x/§x_≠i.h
>

29 
	~<§x/§x¸y±ﬂpi.h
>

30 
	~"bgp_öfo_hash.h
"

33 
	#SRX_PRINT_HEX
(
DATA
, 
DLEN
) \

35 
•h_idx
 = 0; \

36 
•h_idx
 < 
DLEN
) \

38 i‡(
•h_idx
 % 16 == 0) \

40 
	`¥ötf
 ("\n"); \

42 i‡(
•h_idx
 % 8 == 0) \

44 
	`¥ötf
 (" "); \

46 
	`¥ötf
(" %02X", 
DATA
[
•h_idx
]); \

47 
•h_idx
++; \

49 
	`¥ötf
 ("\n"); \

50 }

	)

54 
	#SRX_MAX_PRIVKEYS
 2

	)

56 
	#SRX_VTY_HLP_STR
 "SRx c⁄figuøti⁄ sëtög\n"

	)

58 
	#SRX_VTY_EVAL_ORIGIN_ONLY
 "‹igö_⁄ly"

	)

59 
	#SRX_VTY_EVAL_BGPSEC
 "bgp£c"

	)

61 
	#SRX_VTY_PARAM_CONNECT_SRV
 0

	)

62 
	#SRX_VTY_PARAM_CONNECT_PORT
 1

	)

63 
	#SRX_VTY_CMD_CONNECT_SHORT
 "§x c⁄√˘"

	)

64 
	#SRX_VTY_HLP_CONNECT_SHORT
 
SRX_VTY_HLP_STR
 \

65 "C⁄√˘Åhêrouã∏wôh SRx sîvî\n"

	)

66 
	#SRX_VTY_CMD_CONNECT
 
SRX_VTY_CMD_CONNECT_SHORT
 " .LINE <0-65535>"

	)

67 
	#SRX_VTY_OUT_CONNECT
 "§x c⁄√˘ %†%d%s"

	)

68 
	#SRX_VTY_HLP_CONNECT
 
SRX_VTY_HLP_CONNECT_SHORT
 \

70 "S≥cifõ†SRx sîvîÖ‹t\n"

	)

72 
	#SRX_VTY_CMD_DISCONNECT
 "§x disc⁄√˘"

	)

73 
	#SRX_VTY_HLP_DISCONNECT
 
SRX_VTY_HLP_STR
 \

74 "Disc⁄√˘ fromÅhêSRx sîvî\n"

	)

76 
	#SRX_VTY_CMD_DISPLAY
 "§x di•œy"

	)

77 
	#SRX_VTY_OUT_DISPLAY
 "§x dü∂ay%s"

	)

78 
	#SRX_VTY_HLP_DISPLAY
 
SRX_VTY_HLP_STR
 \

80 " comm™ds\n"

	)

81 
	#SRX_VTY_HLP_DISPLAY_NO
 
SRX_VTY_HLP_STR
 \

83 " comm™ds\n"

	)

85 
	#SRX_VTY_CMD_EVALUATE
 "§xÉvÆu©i⁄ (" 
SRX_VTY_EVAL_ORIGIN_ONLY
 \

86 "|" 
SRX_VTY_EVAL_BGPSEC
 ")"

	)

87 
	#SRX_VTY_OUT_EVALUATE
 "§xÉvÆu©i⁄ %s%s"

	)

88 
	#SRX_VTY_HLP_EVALUATE
 
SRX_VTY_HLP_STR
 \

93 " ROA'†™dÖ©h vÆid©i⁄\n"

	)

94 
	#SRX_VTY_CMD_NO_EVALUATE
 "nÿ§xÉvÆu©i⁄"

	)

95 
	#SRX_VTY_HLP_NO_EVALUATE
 
NO_STR
 
SRX_VTY_HLP_STR
 \

97 

	)

99 
	#SRX_VTY_CMD_EVAL_WITHSRX
 "§xÉvÆu©i⁄ " 
SRX_VTY_EVAL_BGPSEC
 \

100 " di°ribuãd"

	)

101 
	#SRX_VTY_OUT_EVAL_WITHSRX
 "§xÉvÆu©i⁄ " 
SRX_VTY_EVAL_BGPSEC
 \

102 " di°ribuãd%s"

	)

103 
	#SRX_VTY_HLP_EVAL_WITHSRX
 
SRX_VTY_HLP_STR
 \

107 "Pîf‹mÖ©h vÆid©i⁄ usög srx-£rvî.\n"

	)

109 
	#SRX_VTY_CMD_KEEPWINDOW_SHORT
 "§x kìp-wödow"

	)

110 
	#SRX_VTY_CMD_KEEPWINDOW
 
SRX_VTY_CMD_KEEPWINDOW_SHORT
 " <0-65535>"

	)

111 
	#SRX_VTY_HLP_KEEPWINDOW
 
SRX_VTY_HLP_STR
 \

115 "Timêö sec⁄d†\'0\' dißbÀ†thi†„©uª!\n"

	)

118 
	#SRX_VTY_CMD_SET_SERVER_SHORT
 "§x së-£rvî"

	)

119 
	#SRX_VTY_CMD_SET_SERVER
 
SRX_VTY_CMD_SET_SERVER_SHORT
 " .LINE <0-65535>"

	)

120 
	#SRX_VTY_HLP_SET_SERVER
 
SRX_VTY_HLP_STR
 \

121 "SëÅhêSRx sîvî c⁄√˘i⁄Ö¨amëîs\n"

	)

123 
	#SRX_VTY_CMD_PROXYID
 "§x së-¥oxy-id A.B.C.D"

	)

124 
	#SRX_VTY_HLP_PROXYID
 
SRX_VTY_HLP_STR
 \

129 "ö IPv4 f‹m©.\n"

	)

131 
	#SRX_VTY_CMD_SHOW_CONFIG
 "show srx-c⁄fig"

	)

132 
	#SRX_VTY_HLP_SHOW_CONFIG
 
SHOW_STR
 "SRx-BGP Rouã∏c⁄figuøti⁄\n"

	)

135 
	#SRX_VTY_PARAM_ORIGIN_VALUE
 0

	)

136 
	#SRX_VTY_PARAM_PATH_VALUE
 1

	)

138 
	#SRX_VTY_PARAM_BGPSEC_MIN_ALGOID
 1

	)

139 
	#SRX_VTY_PARAM_BGPSEC_MAX_ALGOID
 254

	)

142 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "§x së-‹igö-vÆuê"

	)

143 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_VALID
 \

144 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "vÆid\n"

	)

145 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_NOTFOUND
 \

146 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "nŸfound\n"

	)

147 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_INVALID
 \

148 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "övÆid\n"

	)

149 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_UNDEFINED
 \

150 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "undeföed\n"

	)

152 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 
SRX_VTY_HLP_STR
 \

156 "vÆuêi†"

	)

157 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_VALID
 \

158 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "vÆid\n"

	)

159 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_NOTFOUND
 \

160 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "nŸfound\n"

	)

161 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_INVALID
 \

162 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "övÆid\n"

	)

163 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_UNDEFINED
 \

164 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "undeföed\n"

	)

167 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "§x së-∑th-vÆuê"

	)

168 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_VALID
 \

169 
SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "vÆid\n"

	)

170 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_INVALID
 \

171 
SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "övÆid\n"

	)

172 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_UNDEFINED
 \

173 
SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "undeföed\n"

	)

175 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 
SRX_VTY_HLP_STR
 \

179 "vÆuêi†"

	)

180 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_VALID
 \

181 
SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 "vÆid\n"

	)

182 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_INVALID
 \

183 
SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 "övÆid\n"

	)

184 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_UNDEFINED
 \

185 
SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 "undeföed\n"

	)

188 
	#SRX_VTY_CMD_APPLY_POLICY
 "§xáµly-pﬁicy"

	)

189 
	#SRX_VTY_HLP_APPLY_POLICY
 
SRX_VTY_HLP_STR
 \

191 "ÅhêRIB.\n"

	)

194 
	#SRX_VTY_HLP_POLICY
 "EvÆu©i⁄Öﬁicy comm™d\n"

	)

195 
	#SRX_VTY_HLP_ORIGIN_ONLY
 "(" 
SRX_VTY_EVAL_ORIGIN_ONLY
 "Ë"

	)

198 
	#SRX_VTY_CMD_POL_IGNORE_NOTFOUND
 "§xÖﬁicy ign‹e-nŸfound"

	)

199 
	#SRX_VTY_HLP_POL_IGNORE_NOTFOUND
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

200 
SRX_VTY_HLP_ORIGIN_ONLY
 \

202 "ªsu… = UNKNOWN.\n"

	)

204 
	#SRX_VTY_CMD_POL_IGNORE_INVALID
 "§xÖﬁicy ign‹e-övÆid"

	)

205 
	#SRX_VTY_HLP_POL_IGNORE_INVALID
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

207 "Ñesu… = INVALID.\n"

	)

209 
	#SRX_VTY_CMD_POL_IGNORE_UNDEFINED
 "§xÖﬁicy ign‹e-undeföed"

	)

210 
	#SRX_VTY_HLP_POL_IGNORE_UNDEFINED
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

212 " vÆid©i⁄Ñesu…ávaûabÀ.\n"

	)

215 
	#SRX_VTY_HLP_POL_LOCP
 "M™ùuœãÜoˇ»¥e„ªn˚\n"

	)

216 
	#SRX_VTY_HLP_POL_LOCP_V
 "Pﬁicy f‹ vÆid©i⁄Ñesu… = VALID\n"

	)

217 
	#SRX_VTY_HLP_POL_LOCP_U
 
SRX_VTY_HLP_ORIGIN_ONLY
 "Policy for " \

218 "vÆid©i⁄Ñesu… = UNKNOWN\n"

	)

219 
	#SRX_VTY_HLP_POL_LOCP_I
 "Pﬁicy f‹ vÆid©i⁄Ñesu… = INVALID\n"

	)

221 
	#SRX_VTY_HLP_POL_LOCP_A
 "TÿbêaddedÅÿthêgivíÜoˇ»¥ef\n"

	)

222 
	#SRX_VTY_HLP_POL_LOCP_S
 "Tÿbêsubåa˘ed fromÅhêgivíÜoˇ»¥ef\n"

	)

224 
	#SRX_VTY_CMD_POL_LOCP
 "§xÖﬁicyÜoˇl-¥e„ªn˚"

	)

225 
	#SRX_VTY_CMD_POL_LOCP_FIX
 
SRX_VTY_CMD_POL_LOCP
 \

226 " (vÆid|nŸfound|övÆidË<0-4294967295>"

	)

227 
	#SRX_VTY_HLP_POL_LOCP_FIX
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

228 
SRX_VTY_HLP_POL_LOCP
 \

229 
SRX_VTY_HLP_POL_LOCP_V
 \

230 
SRX_VTY_HLP_POL_LOCP_U
 \

231 
SRX_VTY_HLP_POL_LOCP_I
 \

232 "Thêloˇ»¥e„ªn˚ vÆue.\n"

	)

234 
	#SRX_VTY_CMD_POL_LOCP_VAR
 
SRX_VTY_CMD_POL_LOCP_FIX
 \

235 " (add|subåa˘)"

	)

236 
	#SRX_VTY_HLP_POL_LOCP_VAR
 
SRX_VTY_HLP_POL_LOCP_FIX
 \

237 
SRX_VTY_HLP_POL_LOCP_A
 \

238 
SRX_VTY_HLP_POL_LOCP_S


	)

240 
	#SRX_VTY_CMD_NO_POL_LOCP
 "nÿ" 
SRX_VTY_CMD_POL_LOCP
 \

241 " (vÆid|nŸfound|övÆid)"

	)

242 
	#SRX_VTY_HLP_NO_POL_LOCP
 
NO_STR
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

243 
SRX_VTY_HLP_POL_LOCP
 \

244 
SRX_VTY_HLP_POL_LOCP_V
 \

245 
SRX_VTY_HLP_POL_LOCP_U
 \

246 
SRX_VTY_HLP_POL_LOCP_I
 \

247 

	)

249 
	#SRX_VTY_CMD_POL_PREFV
 "§xÖﬁicyÖª„r-vÆid"

	)

250 
	#SRX_VTY_OUT_POL_PREFV
 
SRX_VTY_CMD_POL_PREFV
 "%s"

	)

251 
	#SRX_VTY_HLP_POL_PREFV
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

253 " wôh vÆid >ány othî\n"

	)

256 
	#SRX_VTY_CMD_EXT_CSTR
 "§xÉxtcommunôy <0-255>"

	)

257 
	#SRX_VTY_HLP_EXT_CSTR
 
SRX_VTY_HLP_STR
 "Configure community string for" \

259 "Thêsub codêo‡thêexãnded communôy.\n"

	)

261 
	#SRX_VTY_CMD_EXT_CSTR_EBGP
 
SRX_VTY_CMD_EXT_CSTR
 " (ö˛ude_ebgp|⁄ly_ibgp)"

	)

262 
	#SRX_VTY_HLP_EXT_CSTR_EBGP
 
SRX_VTY_HLP_EXT_CSTR
 \

264 "O∆y iBGPÖìr†-álsÿu£dÅÿtu∫ of‡eBGPÖìrs\n"

	)

266 
	#SRX_VTY_CMD_NO_EXT_CSTR
 "nÿ§xÉxtcommunôy"

	)

267 
	#SRX_VTY_HLP_NO_EXT_CSTR
 
NO_STR
 
SRX_VTY_HLP_STR
 \

269 "Ñesu…Åøns„r.\n"

	)

272 
	#SRX_VTY_HLP_BGPSEC
 "BGPSEC s≥cifi¯c⁄figuøti⁄\n"

	)

274 
	#SRX_VTY_CMD_BGPSEC_SKI_PRNT
 "§x bgp£¯skò(0|1Ë<1-254>"

	)

275 
	#SRX_VTY_CMD_BGPSEC_SKI
 
SRX_VTY_CMD_BGPSEC_SKI_PRNT
 " WORD"

	)

276 
	#SRX_VTY_OUT_BGPSEC_SKI
 "§x bgp£¯skò%u %s%s"

	)

277 
	#SRX_VTY_HLP_BGPSEC_SKI
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_BGPSEC
 \

280 "ThêSKI,á 20 byã vÆuêa†40 byã HEX såög o‡thêSKI"

	)

282 
	#SRX_VTY_CMD_BGPSEC_ACTIVE_SKI
 "§x bgp£¯a˘ivê(0|1)"

	)

283 
	#SRX_VTY_OUT_BGPSEC_ACTIVE_SKI
 "§x bgp£¯a˘ivê%u%s"

	)

284 
	#SRX_VTY_HLP_BGPSEC_ACTIVE_SKI
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_BGPSEC
 \

285 "C⁄figuª which key i†a˘ive"

	)

287 
	#SRX_VTY_CMD_BGPSEC_REGISTER_P_KEYS
 "§x bgp£¯ªgi°î keys"

	)

288 
	#SRX_VTY_HLP_BGPSEC_REGISTER_P_KEYS
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_BGPSEC
 \

291 "ªgi°øti⁄ faûed!\n"

	)

294 
	#SRX_VTY_HLP_BGPSEC_DEP
 "PÀa£ u£Åhêª∂a˚míà'§x bgp£¯...'\n"

	)

295 
	#SRX_VTY_CMD_BGPSEC_DEP_SKI_PRNT
 "bgp£¯ski"

	)

296 
	#SRX_VTY_CMD_BGPSEC_DEP_SKI
 
SRX_VTY_CMD_BGPSEC_DEP_SKI_PRNT
 " WORD"

	)

297 
	#SRX_VTY_HLP_BGPSEC_DEP_SKI
 
SRX_VTY_HLP_BGPSEC_DEP
 \

299 "U£ '" 
SRX_VTY_CMD_BGPSEC_SKI_PRNT
 \

300 " <ski>' in°ód!\n"

	)

302 
	#SRX_VTY_CMD_BGPSEC_DEP_SIGN
 "bgp£¯sig¿(key|id)"

	)

303 
	#SRX_VTY_HLP_BGPSEC_DEP_SIGN
 
SRX_VTY_HLP_BGPSEC_DEP
 \

304 "Thi†comm™d i†ªmoved!\n"

	)

307 
	#SRX_VTY_CMD_NEIGHBOR_BGPSEC
 
NEIGHBOR_CMD2
 "bgp£¯"

	)

308 
	#SRX_VTY_HLP_NEIGHBOR_BGPSEC
 
NEIGHBOR_STR
 
NEIGHBOR_ADDR_STR2
 \

309 "C⁄figuªÅhêbgp£¯ˇ∑bûôyÅÿthê≥î\n"

	)

311 
	#SRX_VTY_CMD_NEIGHBOR_BGPSEC_MODE
 
SRX_VTY_CMD_NEIGHBOR_BGPSEC
 \

312 "(¢d|ªc|bŸh)"

	)

314 
	#SRX_VTY_HLP_NEIGHBOR_BGPSEC_MODE
 
SRX_VTY_HLP_NEIGHBOR_BGPSEC
 \

317 "Síd BGPSECándÑe˚ivêBGPSEC\n"

	)

323 
	#SRX_VTY_CMD_NO_NEIGHBOR_BGPSEC_MODE
 
NO_NEIGHBOR_CMD2
 "bgpsec " \

324 "(¢d|ªc|bŸh)"

	)

326 
	#SRX_VTY_HLP_NO_NEIGHBOR_BGPSEC_MODE
 
NO_STR
 
SRX_VTY_HLP_NEIGHBOR_BGPSEC
 \

329 "Síd BGPSECándÑe˚ivêBGPSEC\n"

	)

341 
u_öt32_t
 
	tas_t
;

342 
u_öt16_t
 
	tas16_t
;

343 
u_öt16_t
 
	tbgp_size_t
;

346 
	sbgp_ma°î


349 
li°
 *
	mbgp
;

352 
thªad_ma°î
 *
	mma°î
;

355 
w‹k_queue
 *
	m¥o˚ss_maö_queue
;

356 
w‹k_queue
 *
	m¥o˚ss_rs˛õ¡_queue
;

359 
li°
 *
	mli°í_sockës
;

362 
u_öt16_t
 
	mp‹t
;

365 *
	maddªss
;

368 
time_t
 
	m°¨t_time
;

371 
u_ch¨
 
	m›ti⁄s
;

372 
	#BGP_OPT_NO_FIB
 (1 << 0)

	)

373 
	#BGP_OPT_MULTIPLE_INSTANCE
 (1 << 1)

	)

374 
	#BGP_OPT_CONFIG_CISCO
 (1 << 2)

	)

375 
	#BGP_OPT_NO_LISTEN
 (1 << 3)

	)

378 #ifde‡
USE_SRX


382 
	s§x_loˇl_¥ef
 {

384 
	mis_£t
;

386 
	mªœtive
;

388 
uöt32_t
 
	mvÆue
;

393 
	sbgp


396 
as_t
 
	mas
;

399 *
	m«me
;

402 
	mlock
;

405 
≥î
 *
	m≥î_£lf
;

408 
li°
 *
	m≥î
;

411 
li°
 *
	mgroup
;

414 
li°
 *
	mrs˛õ¡
;

417 
u_öt16_t
 
	mc⁄fig
;

418 
	#BGP_CONFIG_ROUTER_ID
 (1 << 0)

	)

419 
	#BGP_CONFIG_CLUSTER_ID
 (1 << 1)

	)

420 
	#BGP_CONFIG_CONFEDERATION
 (1 << 2)

	)

421 #ifde‡
USE_SRX


422 
	#BGP_CONFIG_SRX
 (1 << 3)

	)

425 
u_öt16_t
 
	m§x_c⁄fig
;

426 
	#SRX_CONFIG_EVAL_ORIGIN
 (1 << 1)

	)

428 
	#SRX_CONFIG_EVAL_PATH
 (1 << 2)

	)

429 
	#SRX_CONFIG_EVALUATE
 (
SRX_CONFIG_EVAL_ORIGIN
 | 
SRX_CONFIG_EVAL_PATH
)

	)

431 
	#SRX_CONFIG_EVAL_DISTR
 ((1 << 3Ë| 
SRX_CONFIG_EVALUATE
)

	)

432 
	#SRX_CONFIG_DISPLAY_INFO
 (1 << 4)

	)

436 
ö_addr
 
	mrouãr_id
;

437 
ö_addr
 
	mrouãr_id_°©ic
;

440 
ö_addr
 
	m˛u°î_id
;

443 
as_t
 
	mc⁄„d_id
;

444 
as_t
 *
	mc⁄„d_≥îs
;

445 
	mc⁄„d_≥îs_˙t
;

448 
u_öt16_t
 
	mÊags
;

449 
	#BGP_FLAG_ALWAYS_COMPARE_MED
 (1 << 0)

	)

450 
	#BGP_FLAG_DETERMINISTIC_MED
 (1 << 1)

	)

451 
	#BGP_FLAG_MED_MISSING_AS_WORST
 (1 << 2)

	)

452 
	#BGP_FLAG_MED_CONFED
 (1 << 3)

	)

453 
	#BGP_FLAG_NO_DEFAULT_IPV4
 (1 << 4)

	)

454 
	#BGP_FLAG_NO_CLIENT_TO_CLIENT
 (1 << 5)

	)

455 
	#BGP_FLAG_ENFORCE_FIRST_AS
 (1 << 6)

	)

456 
	#BGP_FLAG_COMPARE_ROUTER_ID
 (1 << 7)

	)

457 
	#BGP_FLAG_ASPATH_IGNORE
 (1 << 8)

	)

458 
	#BGP_FLAG_IMPORT_CHECK
 (1 << 9)

	)

459 
	#BGP_FLAG_NO_FAST_EXT_FAILOVER
 (1 << 10)

	)

460 
	#BGP_FLAG_LOG_NEIGHBOR_CHANGES
 (1 << 11)

	)

461 
	#BGP_FLAG_GRACEFUL_RESTART
 (1 << 12)

	)

462 
	#BGP_FLAG_ASPATH_CONFED
 (1 << 13)

	)

465 
u_öt16_t
 
	maf_Êags
[
AFI_MAX
][
SAFI_MAX
];

466 
	#BGP_CONFIG_DAMPENING
 (1 << 0)

	)

469 
bgp_èbÀ
 *
	mrouã
[
AFI_MAX
][
SAFI_MAX
];

472 
bgp_èbÀ
 *
	maggªg©e
[
AFI_MAX
][
SAFI_MAX
];

475 
bgp_èbÀ
 *
	mrib
[
AFI_MAX
][
SAFI_MAX
];

478 
u_ch¨
 
	mªdi°
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

481 
u_ch¨
 
	mªdi°_mëric_Êag
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

482 
u_öt32_t
 
	mªdi°_mëric
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

487 *
	m«me
;

488 
rouã_m≠
 *
	mm≠
;

489 } 
	mrm≠
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

492 
u_ch¨
 
	mdi°™˚_ebgp
;

493 
u_ch¨
 
	mdi°™˚_ibgp
;

494 
u_ch¨
 
	mdi°™˚_loˇl
;

497 
u_öt32_t
 
	mdeÁu…_loˇl_¥ef
;

500 
u_öt32_t
 
	mdeÁu…_hﬁdtime
;

501 
u_öt32_t
 
	mdeÁu…_kì∑live
;

504 
u_öt32_t
 
	mª°¨t_time
;

505 
u_öt32_t
 
	m°Æï©h_time
;

508 
	sbgp_max∑ths_cfg
 {

509 
u_öt16_t
 
	mmax∑ths_ebgp
;

510 
u_öt16_t
 
	mmax∑ths_ibgp
;

511 } 
	mmax∑ths
[
AFI_MAX
][
SAFI_MAX
];

513 #ifde‡
USE_SRX


517 *
	m§x_ho°
;

518 
	m§x_p‹t
;

519 
	#SRX_HANDHAKE_TIMEOUT
 30

	)

520 
	#SRX_KEEP_WINDOW
 900

	)

523 
	m§x_h™dshakeTimeout
;

525 
	m§x_kìpWödow
;

526 
uöt32_t
 
	m§x_¥oxyID
;

528 
§x_loˇl_¥ef
 
	m§x_vÆ_loˇl_¥ef
[3];

529 
	#VAL_LOCPRF_VALID
 0

	)

530 
	#VAL_LOCPRF_NOTFOUND
 1

	)

531 
	#VAL_LOCPRF_INVALID
 2

	)

534 
uöt16_t
 
	m§x_vÆ_pﬁicy
;

535 
	#SRX_VAL_POLICY_PREFER_VALID
 (1 << 0)

	)

536 
	#SRX_VAL_POLICY_IGNORE_NOTFOUND
 (1 << 1)

	)

537 
	#SRX_VAL_POLICY_IGNORE_INVALID
 (1 << 2)

	)

538 
	#SRX_VAL_POLICY_IGNORE_UNDEFINED
 (1 << 3)

	)

540 
uöt16_t
 
	m§x_deÁu…_rﬂVÆ
;

541 
uöt16_t
 
	m§x_deÁu…_bgp£cVÆ
;

544 
SRxProxy
* 
	m§xProxy
;

546 
bgp_öfo_hash
* 
	möfo_uid_hash
;

548 
bgp_öfo_hash
* 
	möfo_lid_hash
;

551 
SRxCry±oAPI
* 
	m§xCAPI
;

554 
BGPSecKey
 
	m§x_bgp£c_key
[
SRX_MAX_PRIVKEYS
];

556 
u_öt8_t
 
	m§x_bgp£c_a˘ive_key
;

559 
	#SRX_BGP_FLAG_ECOMMUNITY
 (1 << 0)

	)

560 
	#SRX_BGP_FLAG_ECOMMUNITY_EBGP
 (1 << 1)

	)

561 
u_öt8_t
 
	m§x_ecommunôy_Êags
;

562 
u_öt8_t
 
	m§x_ecommunôy_subcode
;

567 
	s≥î_group


570 *
	m«me
;

573 
bgp
 *
	mbgp
;

576 
li°
 *
	m≥î
;

579 
≥î
 *
	mc⁄f
;

583 
	sbgp_nŸify


585 
u_ch¨
 
	mcode
;

586 
u_ch¨
 
	msubcode
;

587 *
	md©a
;

588 
bgp_size_t
 
	mÀngth
;

592 
	sbgp_√xth›


594 
öãrÁ˚
 *
	miÂ
;

595 
ö_addr
 
	mv4
;

596 #ifde‡
HAVE_IPV6


597 
ö6_addr
 
	mv6_globÆ
;

598 
ö6_addr
 
	mv6_loˇl
;

603 
	#BGP_RD_SIZE
 8

	)

605 
	sbgp_rd


607 
u_ch¨
 
	mvÆ
[
BGP_RD_SIZE
];

610 
	#RMAP_IN
 0

	)

611 
	#RMAP_OUT
 1

	)

612 
	#RMAP_IMPORT
 2

	)

613 
	#RMAP_EXPORT
 3

	)

614 
	#RMAP_MAX
 4

	)

617 
	sbgp_fûãr


622 *
	m«me
;

623 
ac˚ss_li°
 *
	mÆi°
;

624 } 
	mdli°
[
FILTER_MAX
];

629 *
	m«me
;

630 
¥efix_li°
 *
	m∂i°
;

631 } 
	m∂i°
[
FILTER_MAX
];

636 *
	m«me
;

637 
as_li°
 *
	ma¶i°
;

638 } 
	ma¶i°
[
FILTER_MAX
];

643 *
	m«me
;

644 
rouã_m≠
 *
	mm≠
;

645 } 
	mm≠
[
RMAP_MAX
];

650 *
	m«me
;

651 
rouã_m≠
 *
	mm≠
;

652 } 
	musm≠
;

659 
	mBGP_PEER_IBGP
 = 1,

660 
	mBGP_PEER_EBGP
,

661 
	mBGP_PEER_INTERNAL
,

662 
	mBGP_PEER_CONFED
,

663 } 
	tbgp_≥î_s‹t_t
;

666 
	s≥î


669 
bgp
 *
	mbgp
;

676 
	mlock
;

679 
≥î_group
 *
	mgroup
;

680 
u_ch¨
 
	maf_group
[
AFI_MAX
][
SAFI_MAX
];

683 
as_t
 
	mas
;

686 
as_t
 
	mloˇl_as
;

688 
bgp_≥î_s‹t_t
 
	ms‹t
;

691 
as_t
 
	mch™ge_loˇl_as
;

694 
ö_addr
 
	mªmŸe_id
;

697 
ö_addr
 
	mloˇl_id
;

700 
bgp_èbÀ
 *
	mrib
[
AFI_MAX
][
SAFI_MAX
];

703 
°ªam
 *
	mibuf
;

704 
°ªam_fifo
 *
	mobuf
;

705 
°ªam
 *
	mw‹k
;

708 
	m°©us
;

709 
	mo°©us
;

712 
uöt16_t
 
	mèbÀ_dump_ödex
;

715 
	mfd
;

716 
	mâl
;

717 
	mgtsm_h›s
;

718 *
	mdesc
;

719 
	mp‹t
;

720 *
	mho°
;

721 
sockuni⁄
 
	msu
;

722 
time_t
 
	mu±ime
;

723 
time_t
 
	mªadtime
;

724 
time_t
 
	mª£âime
;

726 
	mifödex
;

727 *
	mi‚ame
;

728 *
	mupd©e_if
;

729 
sockuni⁄
 *
	mupd©e_sour˚
;

730 
zlog
 *
	mlog
;

732 
sockuni⁄
 *
	msu_loˇl
;

733 
sockuni⁄
 *
	msu_ªmŸe
;

734 
	msh¨ed_√tw‹k
;

735 
bgp_√xth›
 
	m√xth›
;

738 
u_ch¨
 
	mafc
[
AFI_MAX
][
SAFI_MAX
];

739 
u_ch¨
 
	mafc_√go
[
AFI_MAX
][
SAFI_MAX
];

740 
u_ch¨
 
	mafc_adv
[
AFI_MAX
][
SAFI_MAX
];

741 
u_ch¨
 
	mafc_ªcv
[
AFI_MAX
][
SAFI_MAX
];

744 
u_öt16_t
 
	mˇp
;

745 
	#PEER_CAP_REFRESH_ADV
 (1 << 0Ë

	)

746 
	#PEER_CAP_REFRESH_OLD_RCV
 (1 << 1Ë

	)

747 
	#PEER_CAP_REFRESH_NEW_RCV
 (1 << 2Ë

	)

748 
	#PEER_CAP_DYNAMIC_ADV
 (1 << 3Ë

	)

749 
	#PEER_CAP_DYNAMIC_RCV
 (1 << 4Ë

	)

750 
	#PEER_CAP_RESTART_ADV
 (1 << 5Ë

	)

751 
	#PEER_CAP_RESTART_RCV
 (1 << 6Ë

	)

752 
	#PEER_CAP_AS4_ADV
 (1 << 7Ë

	)

753 
	#PEER_CAP_AS4_RCV
 (1 << 8Ë

	)

754 #ifde‡
USE_SRX


755 
	#PEER_CAP_EXTENDED_MSG_SUPPORT
 (1 << 13)

	)

756 
	#PEER_CAP_BGPSEC_ADV_SEND
 (1 << 14)

	)

757 
	#PEER_CAP_BGPSEC_ADV
 (1 << 15)

	)

761 
u_öt16_t
 
	maf_ˇp
[
AFI_MAX
][
SAFI_MAX
];

762 
	#PEER_CAP_ORF_PREFIX_SM_ADV
 (1 << 0Ë

	)

763 
	#PEER_CAP_ORF_PREFIX_RM_ADV
 (1 << 1Ë

	)

764 
	#PEER_CAP_ORF_PREFIX_SM_RCV
 (1 << 2Ë

	)

765 
	#PEER_CAP_ORF_PREFIX_RM_RCV
 (1 << 3Ë

	)

766 
	#PEER_CAP_ORF_PREFIX_SM_OLD_RCV
 (1 << 4Ë

	)

767 
	#PEER_CAP_ORF_PREFIX_RM_OLD_RCV
 (1 << 5Ë

	)

768 
	#PEER_CAP_RESTART_AF_RCV
 (1 << 6Ë

	)

769 
	#PEER_CAP_RESTART_AF_PRESERVE_RCV
 (1 << 7Ë

	)

772 
u_öt32_t
 
	mÊags
;

773 
	#PEER_FLAG_PASSIVE
 (1 << 0Ë

	)

774 
	#PEER_FLAG_SHUTDOWN
 (1 << 1Ë

	)

775 
	#PEER_FLAG_DONT_CAPABILITY
 (1 << 2Ë

	)

776 
	#PEER_FLAG_OVERRIDE_CAPABILITY
 (1 << 3Ë

	)

777 
	#PEER_FLAG_STRICT_CAP_MATCH
 (1 << 4Ë

	)

778 
	#PEER_FLAG_DYNAMIC_CAPABILITY
 (1 << 5Ë

	)

779 
	#PEER_FLAG_DISABLE_CONNECTED_CHECK
 (1 << 6Ë

	)

780 
	#PEER_FLAG_LOCAL_AS_NO_PREPEND
 (1 << 7Ë

	)

781 
	#PEER_FLAG_LOCAL_AS_REPLACE_AS
 (1 << 8Ë

	)

782 #ifde‡
USE_SRX


783 
	#PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
 (1 << 9Ë

	)

784 
	#PEER_FLAG_BGPSEC_MPE_IPV4
 (1 << 10Ë

	)

786 
	#PEER_FLAG_BGPSEC_MIGRATE
 (1 << 11Ë

	)

787 
	#PEER_FLAG_BGPSEC_ROUTE_SERVER
 (1 << 12Ë

	)

788 
	#PEER_FLAG_EXTENDED_MESSAGE_LIBERAL
 (1 << 13Ë

	)

789 
	#PEER_FLAG_BGPSEC_CAPABILITY_RECV
 (1 << 14)

	)

790 
	#PEER_FLAG_BGPSEC_CAPABILITY_SEND
 (1 << 15)

	)

791 
	#PEER_FLAG_BGPSEC_CAPABILITY
 (1 << 15)

	)

795 
u_ch¨
 
	mnsf
[
AFI_MAX
][
SAFI_MAX
];

798 
u_öt32_t
 
	maf_Êags
[
AFI_MAX
][
SAFI_MAX
];

799 
	#PEER_FLAG_SEND_COMMUNITY
 (1 << 0Ë

	)

800 
	#PEER_FLAG_SEND_EXT_COMMUNITY
 (1 << 1Ë

	)

801 
	#PEER_FLAG_NEXTHOP_SELF
 (1 << 2Ë

	)

802 
	#PEER_FLAG_REFLECTOR_CLIENT
 (1 << 3Ë

	)

803 
	#PEER_FLAG_RSERVER_CLIENT
 (1 << 4Ë

	)

804 
	#PEER_FLAG_SOFT_RECONFIG
 (1 << 5Ë

	)

805 
	#PEER_FLAG_AS_PATH_UNCHANGED
 (1 << 6Ë

	)

806 
	#PEER_FLAG_NEXTHOP_UNCHANGED
 (1 << 7Ë

	)

807 
	#PEER_FLAG_MED_UNCHANGED
 (1 << 8Ë

	)

808 
	#PEER_FLAG_DEFAULT_ORIGINATE
 (1 << 9Ë

	)

809 
	#PEER_FLAG_REMOVE_PRIVATE_AS
 (1 << 10Ë

	)

810 
	#PEER_FLAG_ALLOWAS_IN
 (1 << 11Ë

	)

811 
	#PEER_FLAG_ORF_PREFIX_SM
 (1 << 12Ë

	)

812 
	#PEER_FLAG_ORF_PREFIX_RM
 (1 << 13Ë

	)

813 
	#PEER_FLAG_MAX_PREFIX
 (1 << 14Ë

	)

814 
	#PEER_FLAG_MAX_PREFIX_WARNING
 (1 << 15Ë

	)

815 
	#PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
 (1 << 16Ë

	)

818 *
	m∑ssw‹d
;

823 *
	m«me
;

824 
rouã_m≠
 *
	mm≠
;

825 } 
	mdeÁu…_rm≠
[
AFI_MAX
][
SAFI_MAX
];

828 
u_öt16_t
 
	msÊags
;

829 
	#PEER_STATUS_ACCEPT_PEER
 (1 << 0Ë

	)

830 
	#PEER_STATUS_PREFIX_OVERFLOW
 (1 << 1Ë

	)

831 
	#PEER_STATUS_CAPABILITY_OPEN
 (1 << 2Ë

	)

832 
	#PEER_STATUS_HAVE_ACCEPT
 (1 << 3Ë

	)

833 
	#PEER_STATUS_GROUP
 (1 << 4Ë

	)

834 
	#PEER_STATUS_NSF_MODE
 (1 << 5Ë

	)

835 
	#PEER_STATUS_NSF_WAIT
 (1 << 6Ë

	)

838 
u_öt16_t
 
	maf_sÊags
[
AFI_MAX
][
SAFI_MAX
];

839 
	#PEER_STATUS_ORF_PREFIX_SEND
 (1 << 0Ë

	)

840 
	#PEER_STATUS_ORF_WAIT_REFRESH
 (1 << 1Ë

	)

841 
	#PEER_STATUS_DEFAULT_ORIGINATE
 (1 << 2Ë

	)

842 
	#PEER_STATUS_PREFIX_THRESHOLD
 (1 << 3Ë

	)

843 
	#PEER_STATUS_PREFIX_LIMIT
 (1 << 4Ë

	)

844 
	#PEER_STATUS_EOR_SEND
 (1 << 5Ë

	)

845 
	#PEER_STATUS_EOR_RECEIVED
 (1 << 6Ë

	)

848 
u_öt32_t
 
	mc⁄fig
;

849 
	#PEER_CONFIG_WEIGHT
 (1 << 0Ë

	)

850 
	#PEER_CONFIG_TIMER
 (1 << 1Ë

	)

851 
	#PEER_CONFIG_CONNECT
 (1 << 2Ë

	)

852 
	#PEER_CONFIG_ROUTEADV
 (1 << 3Ë

	)

853 
u_öt32_t
 
	mweight
;

854 
u_öt32_t
 
	mhﬁdtime
;

855 
u_öt32_t
 
	mkì∑live
;

856 
u_öt32_t
 
	mc⁄√˘
;

857 
u_öt32_t
 
	mrouãadv
;

860 
u_öt32_t
 
	mv_°¨t
;

861 
u_öt32_t
 
	mv_c⁄√˘
;

862 
u_öt32_t
 
	mv_hﬁdtime
;

863 
u_öt32_t
 
	mv_kì∑live
;

864 
u_öt32_t
 
	mv_as‹ig
;

865 
u_öt32_t
 
	mv_rouãadv
;

866 
u_öt32_t
 
	mv_pmax_ª°¨t
;

867 
u_öt32_t
 
	mv_gr_ª°¨t
;

870 
thªad
 *
	mt_ªad
;

871 
thªad
 *
	mt_wrôe
;

872 
thªad
 *
	mt_°¨t
;

873 
thªad
 *
	mt_c⁄√˘
;

874 
thªad
 *
	mt_hﬁdtime
;

875 
thªad
 *
	mt_kì∑live
;

876 
thªad
 *
	mt_as‹ig
;

877 
thªad
 *
	mt_rouãadv
;

878 
thªad
 *
	mt_pmax_ª°¨t
;

879 
thªad
 *
	mt_gr_ª°¨t
;

880 
thªad
 *
	mt_gr_°Æe
;

883 
w‹k_queue
 *
	m˛ór_node_queue
;

886 
u_öt32_t
 
	m›í_ö
;

887 
u_öt32_t
 
	m›í_out
;

888 
u_öt32_t
 
	mupd©e_ö
;

889 
u_öt32_t
 
	mupd©e_out
;

890 
time_t
 
	mupd©e_time
;

891 
u_öt32_t
 
	mkì∑live_ö
;

892 
u_öt32_t
 
	mkì∑live_out
;

893 
u_öt32_t
 
	mnŸify_ö
;

894 
u_öt32_t
 
	mnŸify_out
;

895 
u_öt32_t
 
	mª‰esh_ö
;

896 
u_öt32_t
 
	mª‰esh_out
;

897 
u_öt32_t
 
	mdy«mic_ˇp_ö
;

898 
u_öt32_t
 
	mdy«mic_ˇp_out
;

901 
u_öt32_t
 
	me°ablished
;

902 
u_öt32_t
 
	mdr›≥d
;

905 
bgp_synchr⁄ize
 *
	msync
[
AFI_MAX
][
SAFI_MAX
];

906 
time_t
 
	msyn˘ime
;

909 
	mscou¡
[
AFI_MAX
][
SAFI_MAX
];

912 
hash
 *
	mhash
[
AFI_MAX
][
SAFI_MAX
];

915 
bgp_nŸify
 
	mnŸify
;

918 
	m∑ckë_size
;

921 
bgp_fûãr
 
	mfûãr
[
AFI_MAX
][
SAFI_MAX
];

924 
¥efix_li°
 *
	m‹f_∂i°
[
AFI_MAX
][
SAFI_MAX
];

926 #ifde‡
USE_SRX


929 
boﬁ
 
	mbgp£c_migøã
;

933 
	mpcou¡
[
AFI_MAX
][
SAFI_MAX
];

936 
	mpmax
[
AFI_MAX
][
SAFI_MAX
];

937 
u_ch¨
 
	mpmax_thªshﬁd
[
AFI_MAX
][
SAFI_MAX
];

938 
u_öt16_t
 
	mpmax_ª°¨t
[
AFI_MAX
][
SAFI_MAX
];

939 
	#MAXIMUM_PREFIX_THRESHOLD_DEFAULT
 75

	)

942 
	mÆlowas_ö
[
AFI_MAX
][
SAFI_MAX
];

945 
	mœ°_ª£t
;

946 
	#PEER_DOWN_RID_CHANGE
 1

	)

947 
	#PEER_DOWN_REMOTE_AS_CHANGE
 2

	)

948 
	#PEER_DOWN_LOCAL_AS_CHANGE
 3

	)

949 
	#PEER_DOWN_CLID_CHANGE
 4

	)

950 
	#PEER_DOWN_CONFED_ID_CHANGE
 5

	)

951 
	#PEER_DOWN_CONFED_PEER_CHANGE
 6

	)

952 
	#PEER_DOWN_RR_CLIENT_CHANGE
 7

	)

953 
	#PEER_DOWN_RS_CLIENT_CHANGE
 8

	)

954 
	#PEER_DOWN_UPDATE_SOURCE_CHANGE
 9

	)

955 
	#PEER_DOWN_AF_ACTIVATE
 10

	)

956 
	#PEER_DOWN_USER_SHUTDOWN
 11

	)

957 
	#PEER_DOWN_USER_RESET
 12

	)

958 
	#PEER_DOWN_NOTIFY_RECEIVED
 13

	)

959 
	#PEER_DOWN_NOTIFY_SEND
 14

	)

960 
	#PEER_DOWN_CLOSE_SESSION
 15

	)

961 
	#PEER_DOWN_NEIGHBOR_DELETE
 16

	)

962 
	#PEER_DOWN_RMAP_BIND
 17

	)

963 
	#PEER_DOWN_RMAP_UNBIND
 18

	)

964 
	#PEER_DOWN_CAPABILITY_CHANGE
 19

	)

965 
	#PEER_DOWN_PASSIVE_CHANGE
 20

	)

966 
	#PEER_DOWN_MULTIHOP_CHANGE
 21

	)

967 
	#PEER_DOWN_NSF_CLOSE_SESSION
 22

	)

970 
u_ch¨
 
	mrm≠_ty≥
;

971 
	#PEER_RMAP_TYPE_IN
 (1 << 0Ë

	)

972 
	#PEER_RMAP_TYPE_OUT
 (1 << 1Ë

	)

973 
	#PEER_RMAP_TYPE_NETWORK
 (1 << 2Ë

	)

974 
	#PEER_RMAP_TYPE_REDISTRIBUTE
 (1 << 3Ë

	)

975 
	#PEER_RMAP_TYPE_DEFAULT
 (1 << 4Ë

	)

976 
	#PEER_RMAP_TYPE_NOSET
 (1 << 5Ë

	)

977 
	#PEER_RMAP_TYPE_IMPORT
 (1 << 6Ë

	)

978 
	#PEER_RMAP_TYPE_EXPORT
 (1 << 7Ë

	)

981 
	#PEER_PASSWORD_MINLEN
 (1)

	)

982 
	#PEER_PASSWORD_MAXLEN
 (80)

	)

986 
	sbgp_∆ri


989 
afi_t
 
	mafi
;

992 
ßfi_t
 
	mßfi
;

995 
u_ch¨
 *
	m∆ri
;

998 
bgp_size_t
 
	mÀngth
;

1002 
	#BGP_VERSION_4
 4

	)

1005 
	#BGP_PORT_DEFAULT
 179

	)

1008 
	#BGP_MARKER_SIZE
 16

	)

1009 
	#BGP_HEADER_SIZE
 19

	)

1010 
	#BGP_MAX_PACKET_SIZE
 4096

	)

1011 #ifde‡
USE_SRX


1012 
	#BGP_MAX_PACKET_SIZE_EXTENDED
 65535

	)

1016 
	#BGP_MSG_OPEN_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 10)

	)

1017 
	#BGP_MSG_UPDATE_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 4)

	)

1018 
	#BGP_MSG_NOTIFY_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 2)

	)

1019 
	#BGP_MSG_KEEPALIVE_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 0)

	)

1020 
	#BGP_MSG_ROUTE_REFRESH_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 4)

	)

1021 
	#BGP_MSG_CAPABILITY_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 3)

	)

1024 
	#BGP_MSG_OPEN
 1

	)

1025 
	#BGP_MSG_UPDATE
 2

	)

1026 
	#BGP_MSG_NOTIFY
 3

	)

1027 
	#BGP_MSG_KEEPALIVE
 4

	)

1028 
	#BGP_MSG_ROUTE_REFRESH_NEW
 5

	)

1029 
	#BGP_MSG_CAPABILITY
 6

	)

1030 
	#BGP_MSG_ROUTE_REFRESH_OLD
 128

	)

1033 
	#BGP_OPEN_OPT_AUTH
 1

	)

1034 
	#BGP_OPEN_OPT_CAP
 2

	)

1037 
	#BGP_ATTR_ORIGIN
 1

	)

1038 
	#BGP_ATTR_AS_PATH
 2

	)

1039 
	#BGP_ATTR_NEXT_HOP
 3

	)

1040 
	#BGP_ATTR_MULTI_EXIT_DISC
 4

	)

1041 
	#BGP_ATTR_LOCAL_PREF
 5

	)

1042 
	#BGP_ATTR_ATOMIC_AGGREGATE
 6

	)

1043 
	#BGP_ATTR_AGGREGATOR
 7

	)

1044 
	#BGP_ATTR_COMMUNITIES
 8

	)

1045 
	#BGP_ATTR_ORIGINATOR_ID
 9

	)

1046 
	#BGP_ATTR_CLUSTER_LIST
 10

	)

1047 
	#BGP_ATTR_DPA
 11

	)

1048 
	#BGP_ATTR_ADVERTISER
 12

	)

1049 
	#BGP_ATTR_RCID_PATH
 13

	)

1050 
	#BGP_ATTR_MP_REACH_NLRI
 14

	)

1051 
	#BGP_ATTR_MP_UNREACH_NLRI
 15

	)

1052 
	#BGP_ATTR_EXT_COMMUNITIES
 16

	)

1053 
	#BGP_ATTR_AS4_PATH
 17

	)

1054 
	#BGP_ATTR_AS4_AGGREGATOR
 18

	)

1055 
	#BGP_ATTR_AS_PATHLIMIT
 21

	)

1056 #i‡
deföed
(
USE_SRX
Ë&& !deföed(
BGP_ATTR_BGPSEC
)

1057 
	#BGP_ATTR_BGPSEC
 33

	)

1061 
	#BGP_ORIGIN_IGP
 0

	)

1062 
	#BGP_ORIGIN_EGP
 1

	)

1063 
	#BGP_ORIGIN_INCOMPLETE
 2

	)

1066 
	#BGP_NOTIFY_HEADER_ERR
 1

	)

1067 
	#BGP_NOTIFY_OPEN_ERR
 2

	)

1068 
	#BGP_NOTIFY_UPDATE_ERR
 3

	)

1069 
	#BGP_NOTIFY_HOLD_ERR
 4

	)

1070 
	#BGP_NOTIFY_FSM_ERR
 5

	)

1071 
	#BGP_NOTIFY_CEASE
 6

	)

1072 
	#BGP_NOTIFY_CAPABILITY_ERR
 7

	)

1073 
	#BGP_NOTIFY_MAX
 8

	)

1075 
	#BGP_NOTIFY_SUBCODE_UNSPECIFIC
 0

	)

1078 
	#BGP_NOTIFY_HEADER_NOT_SYNC
 1

	)

1079 
	#BGP_NOTIFY_HEADER_BAD_MESLEN
 2

	)

1080 
	#BGP_NOTIFY_HEADER_BAD_MESTYPE
 3

	)

1081 
	#BGP_NOTIFY_HEADER_MAX
 4

	)

1084 
	#BGP_NOTIFY_OPEN_UNSUP_VERSION
 1

	)

1085 
	#BGP_NOTIFY_OPEN_BAD_PEER_AS
 2

	)

1086 
	#BGP_NOTIFY_OPEN_BAD_BGP_IDENT
 3

	)

1087 
	#BGP_NOTIFY_OPEN_UNSUP_PARAM
 4

	)

1088 
	#BGP_NOTIFY_OPEN_AUTH_FAILURE
 5

	)

1089 
	#BGP_NOTIFY_OPEN_UNACEP_HOLDTIME
 6

	)

1090 
	#BGP_NOTIFY_OPEN_UNSUP_CAPBL
 7

	)

1091 #ifde‡
USE_SRX


1092 
	#BGP_NOTIFY_OPEN_UNSUP_BGPSEC
 8

	)

1094 
	#BGP_NOTIFY_OPEN_MAX
 9

	)

1097 
	#BGP_NOTIFY_UPDATE_MAL_ATTR
 1

	)

1098 
	#BGP_NOTIFY_UPDATE_UNREC_ATTR
 2

	)

1099 
	#BGP_NOTIFY_UPDATE_MISS_ATTR
 3

	)

1100 
	#BGP_NOTIFY_UPDATE_ATTR_FLAG_ERR
 4

	)

1101 
	#BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
 5

	)

1102 
	#BGP_NOTIFY_UPDATE_INVAL_ORIGIN
 6

	)

1103 
	#BGP_NOTIFY_UPDATE_AS_ROUTE_LOOP
 7

	)

1104 
	#BGP_NOTIFY_UPDATE_INVAL_NEXT_HOP
 8

	)

1105 
	#BGP_NOTIFY_UPDATE_OPT_ATTR_ERR
 9

	)

1106 
	#BGP_NOTIFY_UPDATE_INVAL_NETWORK
 10

	)

1107 
	#BGP_NOTIFY_UPDATE_MAL_AS_PATH
 11

	)

1108 
	#BGP_NOTIFY_UPDATE_MAX
 12

	)

1111 
	#BGP_NOTIFY_CEASE_MAX_PREFIX
 1

	)

1112 
	#BGP_NOTIFY_CEASE_ADMIN_SHUTDOWN
 2

	)

1113 
	#BGP_NOTIFY_CEASE_PEER_UNCONFIG
 3

	)

1114 
	#BGP_NOTIFY_CEASE_ADMIN_RESET
 4

	)

1115 
	#BGP_NOTIFY_CEASE_CONNECT_REJECT
 5

	)

1116 
	#BGP_NOTIFY_CEASE_CONFIG_CHANGE
 6

	)

1117 
	#BGP_NOTIFY_CEASE_COLLISION_RESOLUTION
 7

	)

1118 
	#BGP_NOTIFY_CEASE_OUT_OF_RESOURCE
 8

	)

1119 
	#BGP_NOTIFY_CEASE_MAX
 9

	)

1122 
	#BGP_NOTIFY_CAPABILITY_INVALID_ACTION
 1

	)

1123 
	#BGP_NOTIFY_CAPABILITY_INVALID_LENGTH
 2

	)

1124 
	#BGP_NOTIFY_CAPABILITY_MALFORMED_CODE
 3

	)

1125 
	#BGP_NOTIFY_CAPABILITY_MAX
 4

	)

1128 
	#IdÀ
 1

	)

1129 
	#C⁄√˘
 2

	)

1130 
	#A˘ive
 3

	)

1131 
	#O≥nSít
 4

	)

1132 
	#O≥nC⁄fúm
 5

	)

1133 
	#E°ablished
 6

	)

1134 
	#CÀ¨ög
 7

	)

1135 
	#Dñëed
 8

	)

1136 
	#BGP_STATUS_MAX
 9

	)

1139 
	#BGP_Sèπ
 1

	)

1140 
	#BGP_St›
 2

	)

1141 
	#TCP_c⁄√˘i⁄_›í
 3

	)

1142 
	#TCP_c⁄√˘i⁄_˛o£d
 4

	)

1143 
	#TCP_c⁄√˘i⁄_›í_Áûed
 5

	)

1144 
	#TCP_Áèl_îr‹
 6

	)

1145 
	#C⁄√˘Rëry_timî_expúed
 7

	)

1146 
	#Hﬁd_Timî_expúed
 8

	)

1147 
	#KìpAlive_timî_expúed
 9

	)

1148 
	#Re˚ive_OPEN_mesßge
 10

	)

1149 
	#Re˚ive_KEEPALIVE_mesßge
 11

	)

1150 
	#Re˚ive_UPDATE_mesßge
 12

	)

1151 
	#Re˚ive_NOTIFICATION_mesßge
 13

	)

1152 
	#CÀ¨ög_Com∂ëed
 14

	)

1153 
	#BGP_EVENTS_MAX
 15

	)

1156 
	#BGP_INIT_START_TIMER
 5

	)

1157 
	#BGP_ERROR_START_TIMER
 30

	)

1158 
	#BGP_DEFAULT_HOLDTIME
 180

	)

1159 
	#BGP_DEFAULT_KEEPALIVE
 60

	)

1160 
	#BGP_DEFAULT_ASORIGINATE
 15

	)

1161 
	#BGP_DEFAULT_EBGP_ROUTEADV
 30

	)

1162 
	#BGP_DEFAULT_IBGP_ROUTEADV
 5

	)

1163 
	#BGP_CLEAR_CONNECT_RETRY
 20

	)

1164 
	#BGP_DEFAULT_CONNECT_RETRY
 120

	)

1167 
	#BGP_DEFAULT_LOCAL_PREF
 100

	)

1170 
	#BGP_DEFAULT_RESTART_TIME
 120

	)

1171 
	#BGP_DEFAULT_STALEPATH_TIME
 360

	)

1174 
	#SAFI_MPLS_LABELED_VPN
 128

	)

1177 
	#TTL_MAX
 255

	)

1180 
	#BGP_UPTIME_LEN
 25

	)

1183 
	#BGP_VTY_PORT
 2605

	)

1184 
	#BGP_DEFAULT_CONFIG
 "bgpd.c⁄f"

	)

1190 
	ebgp_˛ór_ty≥


1192 
	mBGP_CLEAR_SOFT_NONE
,

1193 
	mBGP_CLEAR_SOFT_OUT
,

1194 
	mBGP_CLEAR_SOFT_IN
,

1195 
	mBGP_CLEAR_SOFT_BOTH
,

1196 
	mBGP_CLEAR_SOFT_IN_ORF_PREFIX
,

1197 
	mBGP_CLEAR_SOFT_RSCLIENT


1201 
	#BGP_INPUT
(
P
Ë((P)->
ibuf
)

	)

1202 
	#BGP_INPUT_PNT
(
P
Ë(
	`STREAM_PNT
(
	`BGP_INPUT
(P)))

	)

1205 
	#PSIZE
(
a
Ë((◊Ë+ 7Ë/ (8))

	)

1208 
	#BGP_SUCCESS
 0

	)

1209 
	#BGP_ERR_INVALID_VALUE
 -1

	)

1210 
	#BGP_ERR_INVALID_FLAG
 -2

	)

1211 
	#BGP_ERR_INVALID_AS
 -3

	)

1212 
	#BGP_ERR_INVALID_BGP
 -4

	)

1213 
	#BGP_ERR_PEER_GROUP_MEMBER
 -5

	)

1214 
	#BGP_ERR_MULTIPLE_INSTANCE_USED
 -6

	)

1215 
	#BGP_ERR_PEER_GROUP_MEMBER_EXISTS
 -7

	)

1216 
	#BGP_ERR_PEER_BELONGS_TO_GROUP
 -8

	)

1217 
	#BGP_ERR_PEER_GROUP_AF_UNCONFIGURED
 -9

	)

1218 
	#BGP_ERR_PEER_GROUP_NO_REMOTE_AS
 -10

	)

1219 
	#BGP_ERR_PEER_GROUP_CANT_CHANGE
 -11

	)

1220 
	#BGP_ERR_PEER_GROUP_MISMATCH
 -12

	)

1221 
	#BGP_ERR_PEER_GROUP_PEER_TYPE_DIFFERENT
 -13

	)

1222 
	#BGP_ERR_MULTIPLE_INSTANCE_NOT_SET
 -14

	)

1223 
	#BGP_ERR_AS_MISMATCH
 -15

	)

1224 
	#BGP_ERR_PEER_INACTIVE
 -16

	)

1225 
	#BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
 -17

	)

1226 
	#BGP_ERR_PEER_GROUP_HAS_THE_FLAG
 -18

	)

1227 
	#BGP_ERR_PEER_FLAG_CONFLICT
 -19

	)

1228 
	#BGP_ERR_PEER_GROUP_SHUTDOWN
 -20

	)

1229 
	#BGP_ERR_PEER_FILTER_CONFLICT
 -21

	)

1230 
	#BGP_ERR_NOT_INTERNAL_PEER
 -22

	)

1231 
	#BGP_ERR_REMOVE_PRIVATE_AS
 -23

	)

1232 
	#BGP_ERR_AF_UNCONFIGURED
 -24

	)

1233 
	#BGP_ERR_SOFT_RECONFIG_UNCONFIGURED
 -25

	)

1234 
	#BGP_ERR_INSTANCE_MISMATCH
 -26

	)

1235 
	#BGP_ERR_LOCAL_AS_ALLOWED_ONLY_FOR_EBGP
 -27

	)

1236 
	#BGP_ERR_CANNOT_HAVE_LOCAL_AS_SAME_AS
 -28

	)

1237 
	#BGP_ERR_TCPSIG_FAILED
 -29

	)

1238 
	#BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
 -30

	)

1239 
	#BGP_ERR_NO_IBGP_WITH_TTLHACK
 -31

	)

1240 
	#BGP_ERR_MAX
 -32

	)

1241 
	#BGP_ERR_CANNOT_HAVE_LOCAL_AS_SAME_AS_REMOTE_AS
 -33

	)

1243 
bgp_ma°î
 *
bm
;

1245 #i‡
deföed
 (
__TIME_MEASURE__
)

1246 
	gg_mósuªCou¡
;

1249 
thªad_ma°î
 *
ma°î
;

1252 
bgp_ãrmö©e
 ();

1253 
bgp_ª£t
 ();

1254 
time_t
 
bgp_˛ock
 ();

1255 
bgp_z˛õ¡_ª£t
 ();

1256 
bgp_√xth›_£t
 (
sockuni⁄
 *, sockunion *,

1257 
bgp_√xth›
 *, 
≥î
 *);

1258 
bgp
 *
bgp_gë_deÁu…
 ();

1259 
bgp
 *
bgp_lookup
 (
as_t
, const *);

1260 
bgp
 *
bgp_lookup_by_«me
 (const *);

1261 
≥î
 *
≥î_lookup
 (
bgp
 *, 
sockuni⁄
 *);

1262 
≥î_group
 *
≥î_group_lookup
 (
bgp
 *, const *);

1263 
≥î_group
 *
≥î_group_gë
 (
bgp
 *, const *);

1264 
≥î
 *
≥î_lookup_wôh_›í
 (
sockuni⁄
 *, 
as_t
, 
ö_addr
 *,

1266 
≥î
 *
≥î_lock
 (peer *);

1267 
≥î
 *
≥î_u∆ock
 (peer *);

1268 
bgp_≥î_s‹t_t
 
≥î_s‹t
 (
≥î
 *peer);

1269 
≥î_a˘ive
 (
≥î
 *);

1270 
≥î_a˘ive_√go
 (
≥î
 *);

1271 
≥î
 *
≥î_¸óã_ac˚±
 (
bgp
 *);

1272 *
≥î_u±ime
 (
time_t
, *, 
size_t
);

1273 
bgp_c⁄fig_wrôe
 (
vty
 *);

1274 
bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
 *, 
afi_t
, 
ßfi_t
, *);

1276 
bgp_ma°î_öô
 ();

1278 
bgp_öô
 ();

1279 
bgp_rouã_m≠_öô
 ();

1281 
bgp_›ti⁄_£t
 ();

1282 
bgp_›ti⁄_un£t
 ();

1283 
bgp_›ti⁄_check
 ();

1285 
bgp_gë
 (
bgp
 **, 
as_t
 *, const *);

1286 
bgp_dñëe
 (
bgp
 *);

1288 
bgp_Êag_£t
 (
bgp
 *, );

1289 
bgp_Êag_un£t
 (
bgp
 *, );

1290 
bgp_Êag_check
 (
bgp
 *, );

1292 
bgp_lock
 (
bgp
 *);

1293 
bgp_u∆ock
 (
bgp
 *);

1295 
bgp_rouãr_id_£t
 (
bgp
 *, 
ö_addr
 *);

1297 
bgp_˛u°î_id_£t
 (
bgp
 *, 
ö_addr
 *);

1298 
bgp_˛u°î_id_un£t
 (
bgp
 *);

1300 
bgp_c⁄„dî©i⁄_id_£t
 (
bgp
 *, 
as_t
);

1301 
bgp_c⁄„dî©i⁄_id_un£t
 (
bgp
 *);

1302 
bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
 *, 
as_t
);

1304 
bgp_c⁄„dî©i⁄_≥îs_add
 (
bgp
 *, 
as_t
);

1305 
bgp_c⁄„dî©i⁄_≥îs_ªmove
 (
bgp
 *, 
as_t
);

1307 
bgp_timîs_£t
 (
bgp
 *, 
u_öt32_t
, u_int32_t);

1308 
bgp_timîs_un£t
 (
bgp
 *);

1310 
bgp_deÁu…_loˇl_¥e„ªn˚_£t
 (
bgp
 *, 
u_öt32_t
);

1311 
bgp_deÁu…_loˇl_¥e„ªn˚_un£t
 (
bgp
 *);

1313 #ifde‡
USE_SRX


1314 
bgp_§x_£t
 (
bgp
 *, 
vty
 *, c⁄° *, , 
boﬁ
);

1315 
bgp_§x_un£t
 (
bgp
 *bgp);

1318 
bgp_§x_evÆu©i⁄
 (
bgp
 *, );

1319 
bgp_§x_di•œy
 (
bgp
 *bgp, );

1320 
bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
 *bgp, , );

1323 
§x_£t_¥oxyID
(
bgp
* , 
uöt32_t
);

1325 
§x_vÆ_loˇl_¥e„ªn˚_£t
 (
bgp
 *, , , 
uöt32_t
);

1326 
§x_vÆ_loˇl_¥e„ªn˚_un£t
 (
bgp
 *, );

1327 
§x_vÆ_pﬁicy_£t
 (
bgp
 *, 
uöt16_t
);

1328 
§x_vÆ_pﬁicy_un£t
 (
bgp
 *, 
uöt16_t
);

1330 
§x_extcommunôy_£t
 (
bgp
 *, 
uöt8_t
, const *);

1331 
§x_extcommunôy_un£t
 (
bgp
 *);

1333 
§x_c⁄fig_check
 (
bgp
 *, 
uöt16_t
);

1335 
§x_c⁄√˘_¥oxy
(
bgp
 *);

1336 
	#DEBUG_TEST


	)

1339 
≥î_rs˛õ¡_a˘ive
 (
≥î
 *);

1341 
≥î_ªmŸe_as
 (
bgp
 *, 
sockuni⁄
 *, 
as_t
 *, 
afi_t
, 
ßfi_t
);

1342 
≥î_group_ªmŸe_as
 (
bgp
 *, c⁄° *, 
as_t
 *);

1343 
≥î_dñëe
 (
≥î
 *peer);

1344 
≥î_group_dñëe
 (
≥î_group
 *);

1345 
≥î_group_ªmŸe_as_dñëe
 (
≥î_group
 *);

1347 
≥î_a˘iv©e
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1348 
≥î_dó˘iv©e
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1350 
≥î_group_böd
 (
bgp
 *, 
sockuni⁄
 *, 
≥î_group
 *,

1351 
afi_t
, 
ßfi_t
, 
as_t
 *);

1352 
≥î_group_unböd
 (
bgp
 *, 
≥î
 *, 
≥î_group
 *,

1353 
afi_t
, 
ßfi_t
);

1355 
≥î_Êag_£t
 (
≥î
 *, 
u_öt32_t
);

1356 
≥î_Êag_un£t
 (
≥î
 *, 
u_öt32_t
);

1358 
≥î_af_Êag_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
);

1359 
≥î_af_Êag_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
);

1360 
≥î_af_Êag_check
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
);

1362 
≥î_ebgp_mu…ih›_£t
 (
≥î
 *, );

1363 
≥î_ebgp_mu…ih›_un£t
 (
≥î
 *);

1365 
≥î_des¸ùti⁄_£t
 (
≥î
 *, *);

1366 
≥î_des¸ùti⁄_un£t
 (
≥î
 *);

1368 
≥î_upd©e_sour˚_if_£t
 (
≥î
 *, const *);

1369 
≥î_upd©e_sour˚_addr_£t
 (
≥î
 *, 
sockuni⁄
 *);

1370 
≥î_upd©e_sour˚_un£t
 (
≥î
 *);

1372 
≥î_deÁu…_‹igö©e_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, const *);

1373 
≥î_deÁu…_‹igö©e_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1375 
≥î_p‹t_£t
 (
≥î
 *, 
u_öt16_t
);

1376 
≥î_p‹t_un£t
 (
≥î
 *);

1378 
≥î_weight_£t
 (
≥î
 *, 
u_öt16_t
);

1379 
≥î_weight_un£t
 (
≥î
 *);

1381 
≥î_timîs_£t
 (
≥î
 *, 
u_öt32_t
, u_int32_t);

1382 
≥î_timîs_un£t
 (
≥î
 *);

1384 
≥î_timîs_c⁄√˘_£t
 (
≥î
 *, 
u_öt32_t
);

1385 
≥î_timîs_c⁄√˘_un£t
 (
≥î
 *);

1387 
≥î_advîti£_öãrvÆ_£t
 (
≥î
 *, 
u_öt32_t
);

1388 
≥î_advîti£_öãrvÆ_un£t
 (
≥î
 *);

1390 
≥î_öãrÁ˚_£t
 (
≥î
 *, const *);

1391 
≥î_öãrÁ˚_un£t
 (
≥î
 *);

1393 
≥î_di°ribuã_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1394 
≥î_di°ribuã_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1396 
≥î_Ælowas_ö_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1397 
≥î_Ælowas_ö_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1399 
≥î_loˇl_as_£t
 (
≥î
 *, 
as_t
, , );

1400 
≥î_loˇl_as_un£t
 (
≥î
 *);

1402 
≥î_¥efix_li°_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1403 
≥î_¥efix_li°_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1405 
≥î_a¶i°_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1406 
≥î_a¶i°_un£t
 (
≥î
 *,
afi_t
, 
ßfi_t
, );

1408 
≥î_rouã_m≠_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1409 
≥î_rouã_m≠_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1411 
≥î_unsuµªss_m≠_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, const *);

1413 
≥î_∑ssw‹d_£t
 (
≥î
 *, const *);

1414 
≥î_∑ssw‹d_un£t
 (
≥î
 *);

1416 
≥î_unsuµªss_m≠_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1418 
≥î_maximum_¥efix_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
, 
u_ch¨
, , 
u_öt16_t
);

1419 
≥î_maximum_¥efix_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1421 
≥î_˛ór
 (
≥î
 *);

1422 
≥î_˛ór_so·
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
bgp_˛ór_ty≥
);

1424 
≥î_âl_£curôy_h›s_£t
 (
≥î
 *, );

1425 
≥î_âl_£curôy_h›s_un£t
 (
≥î
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/config.h

8 
	#BABEL_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/babñd.vty"

	)

11 
	#BGP_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/bgpd.vty"

	)

17 
	#CONFIGFILE_MASK
 0644

	)

20 
	#CONSUMED_TIME_CHECK
 5000000

	)

23 
	#DAEMON_VTY_DIR
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc"

	)

26 
	#DISABLE_BGP_ANNOUNCE
 0

	)

32 
	#GNU_LINUX


	)

35 
	#HAVE_ALARM
 1

	)

38 
	#HAVE_ARPA_INET_H
 1

	)

41 
	#HAVE_ASM_TYPES_H
 1

	)

62 
	#HAVE_CHOWN
 1

	)

65 
	#HAVE_CLOCK_MONOTONIC


	)

68 
	#HAVE_DAEMON
 1

	)

72 
	#HAVE_DECL_TCP_MD5SIG
 1

	)

75 
	#HAVE_DLFCN_H
 1

	)

81 
	#HAVE_DUP2
 1

	)

84 
	#HAVE_FCNTL
 1

	)

87 
	#HAVE_FCNTL_H
 1

	)

90 
	#HAVE_FNMATCH
 1

	)

93 
	#HAVE_FORK
 1

	)

99 
	#HAVE_FTRUNCATE
 1

	)

102 
	#HAVE_GETADDRINFO
 1

	)

105 
	#HAVE_GETCWD
 1

	)

108 
	#HAVE_GETHOSTBYNAME
 1

	)

111 
	#HAVE_GETIFADDRS
 1

	)

114 
	#HAVE_GETPAGESIZE
 1

	)

117 
	#HAVE_GETTIMEOFDAY
 1

	)

120 
	#HAVE_GLIBC_BACKTRACE


	)

123 
	#HAVE_GNU_REGEX


	)

126 
	#HAVE_IF_INDEXTONAME
 1

	)

129 
	#HAVE_IF_NAMETOINDEX
 1

	)

132 
	#HAVE_INET_ATON
 1

	)

138 
	#HAVE_INET_NTOA
 1

	)

141 
	#HAVE_INET_NTOP


	)

144 
	#HAVE_INET_PTON


	)

147 
	#HAVE_INTTYPES_H
 1

	)

150 
	#HAVE_IPV6
 1

	)

153 
	#HAVE_IRDP


	)

162 
	#HAVE_LIBCRYPT
 1

	)

168 
	#HAVE_LIBM


	)

189 
	#HAVE_LIMITS_H
 1

	)

192 
	#HAVE_LINUX_VERSION_H
 1

	)

195 
	#HAVE_MALLINFO


	)

198 
	#HAVE_MEMCHR
 1

	)

201 
	#HAVE_MEMMOVE
 1

	)

204 
	#HAVE_MEMORY_H
 1

	)

207 
	#HAVE_MEMSET
 1

	)

210 
	#HAVE_NETDB_H
 1

	)

222 
	#HAVE_NETINET_ICMP6_H
 1

	)

228 
	#HAVE_NETINET_IN_H
 1

	)

231 
	#HAVE_NETINET_IN_SYSTM_H
 1

	)

237 
	#HAVE_NETINET_IP_ICMP_H
 1

	)

240 
	#HAVE_NETLINK


	)

246 
	#HAVE_NET_IF_H
 1

	)

255 
	#HAVE_NET_ROUTE_H
 1

	)

261 
	#HAVE_OPAQUE_LSA


	)

267 
	#HAVE_OSPF_TE


	)

273 
	#HAVE_POW
 1

	)

288 
	#HAVE_PR_SET_KEEPCAPS


	)

291 
	#HAVE_RFC3678
 1

	)

294 
	#HAVE_RTADV


	)

297 
	#HAVE_RUSAGE


	)

300 
	#HAVE_SELECT
 1

	)

306 
	#HAVE_SIGNAL_H
 1

	)

312 
	#HAVE_SNPRINTF
 1

	)

315 
	#HAVE_SOCKET
 1

	)

318 
	#HAVE_SOCKLEN_T
 1

	)

324 
	#HAVE_STACK_TRACE


	)

331 
	#HAVE_STDDEF_H
 1

	)

334 
	#HAVE_STDINT_H
 1

	)

337 
	#HAVE_STDLIB_H
 1

	)

340 
	#HAVE_STRCASECMP
 1

	)

343 
	#HAVE_STRCHR
 1

	)

346 
	#HAVE_STRCSPN
 1

	)

349 
	#HAVE_STRDUP
 1

	)

352 
	#HAVE_STRERROR
 1

	)

355 
	#HAVE_STRFTIME
 1

	)

358 
	#HAVE_STRINGS_H
 1

	)

361 
	#HAVE_STRING_H
 1

	)

370 
	#HAVE_STRNCASECMP
 1

	)

373 
	#HAVE_STRNDUP
 1

	)

376 
	#HAVE_STRNLEN
 1

	)

382 
	#HAVE_STRRCHR
 1

	)

385 
	#HAVE_STRSPN
 1

	)

388 
	#HAVE_STRSTR
 1

	)

391 
	#HAVE_STRTOL
 1

	)

394 
	#HAVE_STRTOUL
 1

	)

397 
	#HAVE_STRUCT_ICMPHDR
 1

	)

418 
	#HAVE_STRUCT_IN_PKTINFO
 1

	)

421 
	#HAVE_STRUCT_IP_MREQN_IMR_IFINDEX
 1

	)

424 
	#HAVE_STRUCT_ND_OPT_ADV_INTERVAL
 1

	)

437 
	#HAVE_STRUCT_SOCKADDR
 1

	)

446 
	#HAVE_STRUCT_SOCKADDR_IN
 1

	)

449 
	#HAVE_STRUCT_SOCKADDR_IN6
 1

	)

452 
	#HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID
 1

	)

461 
	#HAVE_STRUCT_SOCKADDR_UN
 1

	)

467 
	#HAVE_SYSLOG_H
 1

	)

476 
	#HAVE_SYS_IOCTL_H
 1

	)

482 
	#HAVE_SYS_PARAM_H
 1

	)

485 
	#HAVE_SYS_SELECT_H
 1

	)

488 
	#HAVE_SYS_SOCKET_H
 1

	)

494 
	#HAVE_SYS_STAT_H
 1

	)

497 
	#HAVE_SYS_SYSCTL_H
 1

	)

500 
	#HAVE_SYS_TIMES_H
 1

	)

503 
	#HAVE_SYS_TIME_H
 1

	)

506 
	#HAVE_SYS_TYPES_H
 1

	)

509 
	#HAVE_SYS_UN_H
 1

	)

512 
	#HAVE_SYS_WAIT_H
 1

	)

515 
	#HAVE_SYS_WEAK_ALIAS
 1

	)

518 
	#HAVE_SYS_WEAK_ALIAS_ATTRIBUTE
 1

	)

524 
	#HAVE_SYS_WEAK_ALIAS_CROSSFILE
 1

	)

531 
	#HAVE_SYS_WEAK_ALIAS_PRAGMA
 1

	)

540 
	#HAVE_TIME_H
 1

	)

543 
	#HAVE_UCONTEXT_H
 1

	)

546 
	#HAVE_UNAME
 1

	)

549 
	#HAVE_UNISTD_H
 1

	)

552 
	#HAVE_VFORK
 1

	)

558 
	#HAVE_VPRINTF
 1

	)

561 
	#HAVE_VSNPRINTF
 1

	)

564 
	#HAVE_WCHAR_H
 1

	)

567 
	#HAVE_WCTYPE_H
 1

	)

570 
	#HAVE_WORKING_FORK
 1

	)

573 
	#HAVE_WORKING_VFORK
 1

	)

582 
	#ISIS_METHOD
 
ISIS_METHOD_PFPACKET


	)

585 
	#ISIS_METHOD_BPF
 3

	)

588 
	#ISIS_METHOD_DLPI
 2

	)

591 
	#ISIS_METHOD_PFPACKET
 1

	)

594 
	#ISIS_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/isisd.vty"

	)

600 
	#LINUX_IPV6
 1

	)

603 
	#LOGFILE_MASK
 0644

	)

607 
	#LSTAT_FOLLOWS_SLASHED_SYMLINK
 1

	)

611 
	#LT_OBJDIR
 ".libs/"

	)

626 
	#OSPF6_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•f6d.vty"

	)

629 
	#OSPF_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•fd.vty"

	)

632 
	#PACKAGE
 "quagga§x"

	)

635 
	#PACKAGE_BUGREPORT
 "hâp://bgp§x.™td.ni°.gov"

	)

638 
	#PACKAGE_NAME
 "QuaggaSRx"

	)

641 
	#PACKAGE_STRING
 "QuaggaSRx 0.4.2.7"

	)

644 
	#PACKAGE_TARNAME
 "quagga§x"

	)

647 
	#PACKAGE_URL
 ""

	)

650 
	#PACKAGE_VERSION
 "0.4.2.7"

	)

656 
	#PATH_BABELD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/babñd.pid"

	)

659 
	#PATH_BGPD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/bgpd.pid"

	)

662 
	#PATH_ISISD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/isisd.pid"

	)

665 
	#PATH_OSPF6D_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•f6d.pid"

	)

668 
	#PATH_OSPFD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•fd.pid"

	)

671 
	#PATH_RIPD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùd.pid"

	)

674 
	#PATH_RIPNGD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùngd.pid"

	)

677 
	#PATH_WATCHQUAGGA_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/w©chquagga.pid"

	)

680 
	#PATH_ZEBRA_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/zebø.pid"

	)

683 
	#QUAGGA_GROUP
 "roŸ"

	)

686 
	#QUAGGA_NO_DEPRECATED_INTERFACES
 1

	)

689 
	#QUAGGA_USER
 "roŸ"

	)

692 
	#RETSIGTYPE
 

	)

695 
	#RIPNG_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùngd.vty"

	)

698 
	#RIP_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùd.vty"

	)

701 
	#SELECT_TYPE_ARG1
 

	)

704 
	#SELECT_TYPE_ARG234
 (
fd_£t
 *)

	)

707 
	#SELECT_TYPE_ARG5
 (
timevÆ
 *)

	)

719 
	#STDC_HEADERS
 1

	)

734 
	#TIME_WITH_SYS_TIME
 1

	)

743 
	#USE_GRPC


	)

749 
	#USE_SRX


	)

752 #i‚de‡
_ALL_SOURCE


753 
	#_ALL_SOURCE
 1

	)

756 #i‚de‡
_GNU_SOURCE


757 
	#_GNU_SOURCE
 1

	)

760 #i‚de‡
_POSIX_PTHREAD_SEMANTICS


761 
	#_POSIX_PTHREAD_SEMANTICS
 1

	)

764 #i‚de‡
_TANDEM_SOURCE


765 
	#_TANDEM_SOURCE
 1

	)

768 #i‚de‡
__EXTENSIONS__


769 
	#__EXTENSIONS__
 1

	)

774 
	#VERSION
 "0.4.2.7"

	)

784 #i‡
deföed
 
AC_APPLE_UNIVERSAL_BUILD


785 #i‡
deföed
 
__BIG_ENDIAN__


786 
	#WORDS_BIGENDIAN
 1

	)

789 #i‚de‡
WORDS_BIGENDIAN


795 
	#ZEBRA_SERV_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/z£rv.≠i"

	)

798 
	#ZEBRA_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/zebø.vty"

	)

801 #i‚de‡
_DARWIN_USE_64_BIT_INODE


802 
	#_DARWIN_USE_64_BIT_INODE
 1

	)

829 #i‚de‡
__˝lu•lus


842 
	#ª°ri˘
 
__ª°ri˘


	)

848 #i‡
deföed
 
__SUNPRO_CC
 && !deföed 
__RESTRICT


849 
	#_Re°ri˘


	)

850 
	#__ª°ri˘__


	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/fpm/fpm.h

53 #i‚de‡
_FPM_H


54 
	#_FPM_H


	)

90 
	#FPM_DEFAULT_PORT
 2620

	)

95 
	#FPM_MAX_MSG_LEN
 4096

	)

100 
	sÂm_msg_hdr_t_


105 
uöt8_t
 
	mvîsi⁄
;

110 
uöt8_t
 
	mmsg_ty≥
;

120 
uöt16_t
 
	mmsg_Àn
;

121 } 
	tÂm_msg_hdr_t
;

126 
	#FPM_PROTO_VERSION
 1

	)

128 
	eÂm_msg_ty≥_e_
 {

129 
	mFPM_MSG_TYPE_NONE
 = 0,

135 
	mFPM_MSG_TYPE_NETLINK
 = 1,

136 } 
	tÂm_msg_ty≥_e
;

143 
	#FPM_MSG_ALIGNTO
 4

	)

150 
ölöe
 
size_t


151 
	$Âm_msg_Æign
 (
size_t
 
Àn
)

153  (
Àn
 + 
FPM_MSG_ALIGNTO
 - 1) & ~(FPM_MSG_ALIGNTO - 1);

154 
	}
}

160 
	#FPM_MSG_HDR_LEN
 (
	`Âm_msg_Æign
 ( (
Âm_msg_hdr_t
)))

	)

168 
ölöe
 
size_t


169 
	$Âm_d©a_Àn_to_msg_Àn
 (
size_t
 
d©a_Àn
)

171  
	`Âm_msg_Æign
 (
d©a_Àn
Ë+ 
FPM_MSG_HDR_LEN
;

172 
	}
}

179 
ölöe
 *

180 
	$Âm_msg_d©a
 (
Âm_msg_hdr_t
 *
hdr
)

182  ((*Ë
hdr
Ë+ 
FPM_MSG_HDR_LEN
;

183 
	}
}

188 
ölöe
 
size_t


189 
	$Âm_msg_Àn
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
)

191  
	`¡ohs
 (
hdr
->
msg_Àn
);

192 
	}
}

197 
ölöe
 
size_t


198 
	$Âm_msg_d©a_Àn
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
)

200  (
	`Âm_msg_Àn
 (
hdr
Ë- 
FPM_MSG_HDR_LEN
);

201 
	}
}

208 
ölöe
 
Âm_msg_hdr_t
 *

209 
	$Âm_msg_√xt
 (
Âm_msg_hdr_t
 *
hdr
, 
size_t
 *
Àn
)

211 
size_t
 
msg_Àn
;

213 
msg_Àn
 = 
	`Âm_msg_Àn
 (
hdr
);

215 i‡(
Àn
) {

216 i‡(*
Àn
 < 
msg_Àn
)

218 
	`as£π
(0);

219  
NULL
;

221 *
Àn
 -
msg_Àn
;

224  (
Âm_msg_hdr_t
 *Ë(((*Ë
hdr
Ë+ 
msg_Àn
);

225 
	}
}

232 
ölöe
 

233 
	$Âm_msg_hdr_ok
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
)

235 
size_t
 
msg_Àn
;

237 i‡(
hdr
->
msg_ty≥
 =
FPM_MSG_TYPE_NONE
)

240 
msg_Àn
 = 
	`Âm_msg_Àn
 (
hdr
);

242 i‡(
msg_Àn
 < 
FPM_MSG_HDR_LEN
 || msg_À¿> 
FPM_MAX_MSG_LEN
)

245 i‡(
	`Âm_msg_Æign
 (
msg_Àn
) != msg_len)

249 
	}
}

258 
ölöe
 

259 
	$Âm_msg_ok
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
, 
size_t
 
Àn
)

261 i‡(
Àn
 < 
FPM_MSG_HDR_LEN
)

264 i‡(!
	`Âm_msg_hdr_ok
 (
hdr
))

267 i‡(
	`Âm_msg_Àn
 (
hdr
Ë> 
Àn
)

271 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/agentx.c

22 
	~<zebø.h
>

24 #i‡
deföed
 
HAVE_SNMP
 && deföed 
SNMP_AGENTX


25 
	~<√t-¢mp/√t-¢mp-c⁄fig.h
>

26 
	~<√t-¢mp/√t-¢mp-ö˛udes.h
>

28 
	~"comm™d.h
"

29 
	~"smux.h
"

31 
	gagítx_íabÀd
 = 0;

34 
cmd_node
 
	gagítx_node
 =

36 
SMUX_NODE
,

42 
	$agítx_log_ˇŒback
(
maj‹
, 
mö‹
,

43 *
£rvî¨g
, *
˛õ¡¨g
)

45 
¢mp_log_mesßge
 *
¶m
 = (¢mp_log_mesßgê*)
£rvî¨g
;

46 *
msg
 = 
	`°rdup
 (
¶m
->msg);

47 i‡(
msg
Ëmsg[
	`°æí
(msg)-1] = '\0';

48 
¶m
->
¥i‹ôy
)

50 
LOG_EMERG
: 
	`zlog_îr
 ("¢mp[emîg]: %s", 
msg
?msg:
¶m
->msg); ;

51 
LOG_ALERT
: 
	`zlog_îr
 ("¢mp[Æît]: %s", 
msg
?msg:
¶m
->msg); ;

52 
LOG_CRIT
: 
	`zlog_îr
 ("¢mp[¸ô]: %s", 
msg
?msg:
¶m
->msg); ;

53 
LOG_ERR
: 
	`zlog_îr
 ("¢mp[îr]: %s", 
msg
?msg:
¶m
->msg); ;

54 
LOG_WARNING
: 
	`zlog_w¨n
 ("¢mp[w¨nög]: %s", 
msg
?msg:
¶m
->msg); ;

55 
LOG_NOTICE
: 
	`zlog_nŸi˚
("¢mp[nŸi˚]: %s", 
msg
?msg:
¶m
->msg); ;

56 
LOG_INFO
: 
	`zlog_öfo
 ("¢mp[öfo]: %s", 
msg
?msg:
¶m
->msg); ;

57 
LOG_DEBUG
: 
	`zlog_debug
 ("¢mp[debug]: %s", 
msg
?msg:
¶m
->msg); ;

59 
	`‰ì
(
msg
);

60  
SNMP_ERR_NOERROR
;

61 
	}
}

64 
	$c⁄fig_wrôe_agítx
 (
vty
 *vty)

66 i‡(
agítx_íabÀd
)

67 
	`vty_out
 (
vty
, "agítx%s", 
VTY_NEWLINE
);

69 
	}
}

71 
DEFUN
 (
agítx_íabÀ
,

72 
agítx_íabÀ_cmd
,

77 i‡(!
	gagítx_íabÀd
)

79 
öô_¢mp
("quagga");

80 
	gagítx_íabÀd
 = 1;

81  
	gCMD_SUCCESS
;

83 
vty_out
 (
vty
, "SNMP AgítXáÃódyÉ«bÀd%s", 
VTY_NEWLINE
);

84  
	gCMD_WARNING
;

87 
DEFUN
 (
no_agítx
,

88 
no_agítx_cmd
,

90 
NO_STR


94 i‡(!
	gagítx_íabÀd
Ë 
	gCMD_SUCCESS
;

95 
vty_out
 (
vty
, "SNMP AgítX suµ‹àˇ¬Ÿ bêdißbÀd on˚É«bÀd%s", 
VTY_NEWLINE
);

96  
	gCMD_WARNING
;

100 
	$smux_öô
 (
thªad_ma°î
 *
tm
)

102 
	`√t¢mp_íabÀ_subagít
 ();

103 
	`¢mp_dißbÀ_log
 ();

104 
	`¢mp_íabÀ_ˇŒlog
 ();

105 
	`¢mp_ªgi°î_ˇŒback
 (
SNMP_CALLBACK_LIBRARY
,

106 
SNMP_CALLBACK_LOGGING
,

107 
agítx_log_ˇŒback
,

108 
NULL
);

109 
	`öô_agít
 ("quagga");

111 
	`ö°Æl_node
 (&
agítx_node
, 
c⁄fig_wrôe_agítx
);

112 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
agítx_íabÀ_cmd
);

113 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_agítx_cmd
);

114 
	}
}

117 
	$smux_ªgi°î_mib
 (c⁄° *
des¸
, 
v¨übÀ
 *
v¨
,

118 
size_t
 
width
, 
num
,

119 
oid
 
«me
[], 
size_t
 
«mñí
)

121 
	`ªgi°î_mib
 (
des¸
, 
v¨
, 
width
, 
num
, 
«me
, 
«mñí
);

122 
	}
}

125 
	$smux_å≠
 (
v¨übÀ
 *
vp
, 
size_t
 
vp_Àn
,

126 c⁄° 
oid
 *
íame
, 
size_t
 
íamñí
,

127 c⁄° 
oid
 *
«me
, 
size_t
 
«mñí
,

128 c⁄° 
oid
 *
öame
, 
size_t
 
öamñí
,

129 c⁄° 
å≠_obje˘
 *
å≠obj
, 
size_t
 
å≠objÀn
,

130 
u_ch¨
 
•å≠
)

132 
oid
 
objid_¢m±øp
[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };

133 
size_t
 
objid_¢m±øp_Àn
 =  
objid_¢m±øp
 /  (
oid
);

134 
oid
 
nŸifiˇti⁄_oid
[
MAX_OID_LEN
];

135 
size_t
 
nŸifiˇti⁄_oid_Àn
;

136 
i
;

138 
√t¢mp_v¨übÀ_li°
 *
nŸifiˇti⁄_v¨s
 = 
NULL
;

139 i‡(!
agítx_íabÀd
)  0;

142 
	`oid_c›y
 (
nŸifiˇti⁄_oid
, 
íame
, 
íamñí
);

143 
nŸifiˇti⁄_oid
[
íamñí
] = 
•å≠
;

144 
nŸifiˇti⁄_oid_Àn
 = 
íamñí
 + 1;

145 
	`¢mp_v¨li°_add_v¨übÀ
 (&
nŸifiˇti⁄_v¨s
,

146 
objid_¢m±øp
, 
objid_¢m±øp_Àn
,

147 
ASN_OBJECT_ID
,

148 (
u_ch¨
 *Ë
nŸifiˇti⁄_oid
,

149 
nŸifiˇti⁄_oid_Àn
 * (
oid
));

152 
i
 = 0; i < 
å≠objÀn
; i++)

154 
j
;

155 
oid
 oid[
MAX_OID_LEN
];

156 
size_t
 
oid_Àn
, 
⁄amñí
;

157 
u_ch¨
 *
vÆ
;

158 
size_t
 
vÆ_Àn
;

159 
WrôeMëhod
 *
wm
 = 
NULL
;

160 
v¨übÀ
 
cvp
;

163 i‡(
å≠obj
[
i
].
«mñí
 > 0)

166 
⁄amñí
 = 
å≠obj
[
i
].
«mñí
;

167 
	`oid_c›y
 (
oid
, 
«me
, 
«mñí
);

168 
	`oid_c›y
 (
oid
 + 
«mñí
, 
å≠obj
[
i
].
«me
, 
⁄amñí
);

169 
	`oid_c›y
 (
oid
 + 
«mñí
 + 
⁄amñí
, 
öame
, 
öamñí
);

170 
oid_Àn
 = 
«mñí
 + 
⁄amñí
 + 
öamñí
;

175 
⁄amñí
 = 
å≠obj
[
i
].
«mñí
 * (-1);

176 
	`oid_c›y
 (
oid
, 
«me
, 
«mñí
);

177 
	`oid_c›y
 (
oid
 + 
«mñí
, 
å≠obj
[
i
].
«me
, 
⁄amñí
);

178 
oid
[
⁄amñí
 + 
«mñí
] = 0;

179 
oid_Àn
 = 
«mñí
 + 
⁄amñí
 + 1;

183 
j
 = 0; j < 
vp_Àn
; j++)

185 i‡(
	`oid_com∑ª
 (
å≠obj
[
i
].
«me
, 
⁄amñí
, 
vp
[
j
].«me, vp[j].
«mñí
) != 0)

188 
	`oid_c›y
(
cvp
.
«me
,Çame, 
«mñí
);

189 
	`oid_c›y
(
cvp
.
«me
 + 
«mñí
, 
vp
[
j
].name, vp[j].namelen);

190 
cvp
.
«mñí
 =Çamñí + 
vp
[
j
].namelen;

191 
cvp
.
ty≥
 = 
vp
[
j
].type;

192 
cvp
.
magic
 = 
vp
[
j
].magic;

193 
cvp
.
a˛
 = 
vp
[
j
].acl;

194 
cvp
.
födV¨
 = 
vp
[
j
].findVar;

196 
vÆ
 = 
cvp
.
	`födV¨
 (&cvp, 
oid
, &
oid_Àn
, 1, &
vÆ_Àn
, &
wm
);

197 i‡(!
vÆ
) ;

198 
	`¢mp_v¨li°_add_v¨übÀ
 (&
nŸifiˇti⁄_v¨s
,

199 
oid
, 
oid_Àn
,

200 
vp
[
j
].
ty≥
,

201 
vÆ
,

202 
vÆ_Àn
);

208 
	`£nd_v2å≠
 (
nŸifiˇti⁄_v¨s
);

209 
	`¢mp_‰ì_v¨böd
 (
nŸifiˇti⁄_v¨s
);

211 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/buffer.c

23 
	~<zebø.h
>

25 
	~"mem‹y.h
"

26 
	~"buf„r.h
"

27 
	~"log.h
"

28 
	~"√tw‹k.h
"

29 
	~<°ddef.h
>

34 
	sbuf„r


37 
buf„r_d©a
 *
	mhód
;

38 
buf„r_d©a
 *
	mèû
;

41 
size_t
 
	msize
;

45 
	sbuf„r_d©a


47 
buf„r_d©a
 *
	m√xt
;

50 
size_t
 
	m˝
;

53 
size_t
 
	m•
;

56 
	md©a
[];

63 
	#BUFFER_SIZE_DEFAULT
 4096

	)

66 
	#BUFFER_DATA_FREE
(
D
Ë
	`XFREE
(
MTYPE_BUFFER_DATA
, (D))

	)

69 
buf„r
 *

70 
	$buf„r_√w
 (
size_t
 
size
)

72 
buf„r
 *
b
;

74 
b
 = 
	`XCALLOC
 (
MTYPE_BUFFER
,  (
buf„r
));

76 i‡(
size
)

77 
b
->
size
 = size;

80 
size_t
 
deÁu…_size
;

81 i‡(!
deÁu…_size
)

83 
pgsz
 = 
	`sysc⁄f
(
_SC_PAGESIZE
);

84 
deÁu…_size
 = ((((
BUFFER_SIZE_DEFAULT
-1)/
pgsz
)+1)*pgsz);

86 
b
->
size
 = 
deÁu…_size
;

89  
b
;

90 
	}
}

94 
	$buf„r_‰ì
 (
buf„r
 *
b
)

96 
	`buf„r_ª£t
(
b
);

97 
	`XFREE
 (
MTYPE_BUFFER
, 
b
);

98 
	}
}

102 
	$buf„r_gë°r
 (
buf„r
 *
b
)

104 
size_t
 
tŸÀn
 = 0;

105 
buf„r_d©a
 *
d©a
;

106 *
s
;

107 *
p
;

109 
d©a
 = 
b
->
hód
; d©a; d©®d©a->
√xt
)

110 
tŸÀn
 +
d©a
->
˝
 - d©a->
•
;

111 i‡(!(
s
 = 
	`XMALLOC
(
MTYPE_TMP
, 
tŸÀn
+1)))

112  
NULL
;

113 
p
 = 
s
;

114 
d©a
 = 
b
->
hód
; d©a; d©®d©a->
√xt
)

116 
	`mem˝y
(
p
, 
d©a
->d©®+ d©a->
•
, d©a->
˝
 - data->sp);

117 
p
 +
d©a
->
˝
 - d©a->
•
;

119 *
p
 = '\0';

120  
s
;

121 
	}
}

125 
	$buf„r_em±y
 (
buf„r
 *
b
)

127  (
b
->
hód
 =
NULL
);

128 
	}
}

132 
	$buf„r_ª£t
 (
buf„r
 *
b
)

134 
buf„r_d©a
 *
d©a
;

135 
buf„r_d©a
 *
√xt
;

137 
d©a
 = 
b
->
hód
; d©a; d©®
√xt
)

139 
√xt
 = 
d©a
->next;

140 
	`BUFFER_DATA_FREE
(
d©a
);

142 
b
->
hód
 = b->
èû
 = 
NULL
;

143 
	}
}

146 
buf„r_d©a
 *

147 
	$buf„r_add
 (
buf„r
 *
b
)

149 
buf„r_d©a
 *
d
;

151 
d
 = 
	`XMALLOC
(
MTYPE_BUFFER_DATA
, 
	`off£tof
(
buf„r_d©a
, 
d©a
[
b
->
size
]));

152 
d
->
˝
 = d->
•
 = 0;

153 
d
->
√xt
 = 
NULL
;

155 i‡(
b
->
èû
)

156 
b
->
èû
->
√xt
 = 
d
;

158 
b
->
hód
 = 
d
;

159 
b
->
èû
 = 
d
;

161  
d
;

162 
	}
}

166 
	$buf„r_put
(
buf„r
 *
b
, c⁄° *
p
, 
size_t
 
size
)

168 
buf„r_d©a
 *
d©a
 = 
b
->
èû
;

169 c⁄° *
±r
 = 
p
;

172 
size
)

174 
size_t
 
chunk
;

177 i‡(
d©a
 =
NULL
 || d©a->
˝
 =
b
->
size
)

178 
d©a
 = 
	`buf„r_add
 (
b
);

180 
chunk
 = ((
size
 <(
b
->sizê- 
d©a
->
˝
)) ? size : (b->size - data->cp));

181 
	`mem˝y
 ((
d©a
->d©®+ d©a->
˝
), 
±r
, 
chunk
);

182 
size
 -
chunk
;

183 
±r
 +
chunk
;

184 
d©a
->
˝
 +
chunk
;

186 
	}
}

190 
	$buf„r_putc
 (
buf„r
 *
b
, 
u_ch¨
 
c
)

192 
	`buf„r_put
(
b
, &
c
, 1);

193 
	}
}

197 
	$buf„r_put°r
 (
buf„r
 *
b
, c⁄° *
c
)

199 
	`buf„r_put
(
b
, 
c
, 
	`°æí
(c));

200 
	}
}

204 
buf„r_°©us_t


205 
	$buf„r_Êush_Æl
 (
buf„r
 *
b
, 
fd
)

207 
buf„r_°©us_t
 
ªt
;

208 
buf„r_d©a
 *
hód
;

209 
size_t
 
hód_•
;

211 i‡(!
b
->
hód
)

212  
BUFFER_EMPTY
;

213 
hód_•
 = (
hód
 = 
b
->hód)->
•
;

215 (
ªt
 = 
	`buf„r_Êush_avaûabÀ
(
b
, 
fd
)Ë=
BUFFER_PENDING
)

217 i‡((
b
->
hód
 =hódË&& (
hód_•
 =hód->
•
Ë&& (
î∫o
 !
EINTR
))

219  
ªt
;

220 
hód_•
 = (
hód
 = 
b
->hód)->
•
;

223  
ªt
;

224 
	}
}

228 
buf„r_°©us_t


229 
	$buf„r_Êush_wödow
 (
buf„r
 *
b
, 
fd
, 
width
, 
height
,

230 
îa£_Êag
, 
no_m‹e_Êag
)

232 
nbyãs
;

233 
iov_Æloc
;

234 
iov_ödex
;

235 
iovec
 *
iov
;

236 
iovec
 
smÆl_iov
[3];

237 
m‹e
[] = " --More-- ";

238 
îa£
[] = { 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,

241 
buf„r_d©a
 *
d©a
;

242 
cﬁumn
;

244 i‡(!
b
->
hód
)

245  
BUFFER_EMPTY
;

247 i‡(
height
 < 1)

249 
	`zlog_w¨n
("%s called withÇon-positive window height %d, forcingÅo 1",

250 
__func__
, 
height
);

251 
height
 = 1;

253 i‡(
height
 >= 2)

254 
height
--;

255 i‡(
width
 < 1)

257 
	`zlog_w¨n
("%s called withÇon-positive window width %d, forcingÅo 1",

258 
__func__
, 
width
);

259 
width
 = 1;

263 i‡(
b
->
hód
->
√xt
 =
NULL
)

265 
iov_Æloc
 = 
	`¨øy_size
(
smÆl_iov
);

266 
iov
 = 
smÆl_iov
;

270 
iov_Æloc
 = ((
height
*(
width
+2))/
b
->
size
)+10;

271 
iov
 = 
	`XMALLOC
(
MTYPE_TMP
, 
iov_Æloc
*(*iov));

273 
iov_ödex
 = 0;

276 i‡(
îa£_Êag
)

278 
iov
[
iov_ödex
].
iov_ba£
 = 
îa£
;

279 
iov
[
iov_ödex
].
iov_Àn
 =  
îa£
;

280 
iov_ödex
++;

284 
cﬁumn
 = 1;

285 
d©a
 = 
b
->
hód
; d©®&& (
height
 > 0); d©®d©a->
√xt
)

287 
size_t
 
˝
;

289 
˝
 = 
d©a
->
•
;

290 (
˝
 < 
d©a
->˝Ë&& (
height
 > 0))

294 i‡(
d©a
->d©a[
˝
] == '\r')

295 
cﬁumn
 = 1;

296 i‡((
d©a
->d©a[
˝
] ='\n'Ë|| (
cﬁumn
 =
width
))

298 
cﬁumn
 = 1;

299 
height
--;

302 
cﬁumn
++;

303 
˝
++;

305 
iov
[
iov_ödex
].
iov_ba£
 = (*)(
d©a
->d©®+ d©a->
•
);

306 
iov
[
iov_ödex
++].
iov_Àn
 = 
˝
-
d©a
->
•
;

307 
d©a
->
•
 = 
˝
;

309 i‡(
iov_ödex
 =
iov_Æloc
)

312 
iov_Æloc
 *= 2;

313 i‡(
iov
 !
smÆl_iov
)

315 
	`zlog_w¨n
("%s: growing iovárrayÅo %d; "

317 
__func__
, 
iov_Æloc
, 
width
, 
height
, (
u_l⁄g
)
b
->
size
);

318 
iov
 = 
	`XREALLOC
(
MTYPE_TMP
, iov, 
iov_Æloc
*(*iov));

323 
	`zlog_îr
("%s: corruption detected: iov_small overflowed; "

325 
__func__
, 
b
->
hód
, b->
èû
, b->hód->
√xt
);

326 
iov
 = 
	`XMALLOC
(
MTYPE_TMP
, 
iov_Æloc
*(*iov));

327 
	`mem˝y
(
iov
, 
smÆl_iov
, (small_iov));

333 i‡(
b
->
èû
 && (b->èû->
•
 < b->èû->
˝
Ë&& !
no_m‹e_Êag
)

335 
iov
[
iov_ödex
].
iov_ba£
 = 
m‹e
;

336 
iov
[
iov_ödex
].
iov_Àn
 =  
m‹e
;

337 
iov_ödex
++;

341 #ifde‡
IOV_MAX


345 
iovec
 *
c_iov
 = 
iov
;

346 
nbyãs
 = 0;

348 
iov_ödex
 > 0)

350 
iov_size
;

352 
iov_size
 = ((
iov_ödex
 > 
IOV_MAX
) ? IOV_MAX : iov_index);

353 i‡((
nbyãs
 = 
	`wrôev
(
fd
, 
c_iov
, 
iov_size
)) < 0)

355 
	`zlog_w¨n
("%s: writevÅo fd %d failed: %s",

356 
__func__
, 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

361 
c_iov
 +
iov_size
;

362 
iov_ödex
 -
iov_size
;

366 i‡((
nbyãs
 = 
	`wrôev
 (
fd
, 
iov
, 
iov_ödex
)) < 0)

367 
	`zlog_w¨n
("%s: writevÅo fd %d failed: %s",

368 
__func__
, 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

372 
b
->
hód
 && (b->hód->
•
 =b->hód->
˝
))

374 
buf„r_d©a
 *
dñ
;

375 i‡(!(
b
->
hód
 = (
dñ
 = b->hód)->
√xt
))

376 
b
->
èû
 = 
NULL
;

377 
	`BUFFER_DATA_FREE
(
dñ
);

380 i‡(
iov
 !
smÆl_iov
)

381 
	`XFREE
 (
MTYPE_TMP
, 
iov
);

383  (
nbyãs
 < 0Ë? 
BUFFER_ERROR
 :

384 (
b
->
hód
 ? 
BUFFER_PENDING
 : 
BUFFER_EMPTY
);

385 
	}
}

392 
buf„r_°©us_t


393 
	$buf„r_Êush_avaûabÀ
(
buf„r
 *
b
, 
fd
)

399 #ifde‡
IOV_MAX


400 
	#MAX_CHUNKS
 ((
IOV_MAX
 >16Ë? 16 : IOV_MAX)

	)

402 
	#MAX_CHUNKS
 16

	)

404 
	#MAX_FLUSH
 131072

	)

406 
buf„r_d©a
 *
d
;

407 
size_t
 
wrôãn
;

408 
iovec
 
iov
[
MAX_CHUNKS
];

409 
size_t
 
iov˙t
 = 0;

410 
size_t
 
nbyã
 = 0;

412 
d
 = 
b
->
hód
; d && (
iov˙t
 < 
MAX_CHUNKS
Ë&& (
nbyã
 < 
MAX_FLUSH
);

413 
d
 = d->
√xt
, 
iov˙t
++)

415 
iov
[
iov˙t
].
iov_ba£
 = 
d
->
d©a
+d->
•
;

416 
nbyã
 +(
iov
[
iov˙t
].
iov_Àn
 = 
d
->
˝
-d->
•
);

419 i‡(!
nbyã
)

421  
BUFFER_EMPTY
;

424 i‡((
ssize_t
)(
wrôãn
 = 
	`wrôev
(
fd
,
iov
,
iov˙t
)) < 0)

426 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

428  
BUFFER_PENDING
;

429 
	`zlog_w¨n
("%s: writeÉrror on fd %d: %s",

430 
__func__
, 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

431  
BUFFER_ERROR
;

435 
wrôãn
 > 0)

437 
buf„r_d©a
 *
d
;

438 i‡(!(
d
 = 
b
->
hód
))

440 
	`zlog_îr
("%s: corruption detected: buffer queueÉmpty, "

441 "buàwrôã¿i†%lu", 
__func__
, (
u_l⁄g
)
wrôãn
);

444 i‡(
wrôãn
 < 
d
->
˝
-d->
•
)

446 
d
->
•
 +
wrôãn
;

447  
BUFFER_PENDING
;

450 
wrôãn
 -(
d
->
˝
-d->
•
);

451 i‡(!(
b
->
hód
 = 
d
->
√xt
))

452 
b
->
èû
 = 
NULL
;

453 
	`BUFFER_DATA_FREE
(
d
);

456  
b
->
hód
 ? 
BUFFER_PENDING
 : 
BUFFER_EMPTY
;

458 #unde‡
MAX_CHUNKS


459 #unde‡
MAX_FLUSH


460 
	}
}

462 
buf„r_°©us_t


463 
	$buf„r_wrôe
(
buf„r
 *
b
, 
fd
, c⁄° *
p
, 
size_t
 
size
)

465 
ssize_t
 
nbyãs
;

472 i‡(
b
->
hód
 && (
	`buf„r_Êush_avaûabÀ
(b, 
fd
Ë=
BUFFER_ERROR
))

473  
BUFFER_ERROR
;

475 i‡(
b
->
hód
)

477 
nbyãs
 = 0;

478 i‡((
nbyãs
 = 
	`wrôe
(
fd
, 
p
, 
size
)) < 0)

480 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

481 
nbyãs
 = 0;

484 
	`zlog_w¨n
("%s: writeÉrror on fd %d: %s",

485 
__func__
, 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

486  
BUFFER_ERROR
;

491 
size_t
 
wrôãn
 = 
nbyãs
;

492 i‡(
wrôãn
 < 
size
)

493 
	`buf„r_put
(
b
, ((c⁄° *)
p
)+
wrôãn
, 
size
-written);

495  
b
->
hód
 ? 
BUFFER_PENDING
 : 
BUFFER_EMPTY
;

496 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/buffer.h

23 #i‚de‡
_ZEBRA_BUFFER_H


24 
	#_ZEBRA_BUFFER_H


	)

30 
buf„r
 *
buf„r_√w
 (
size_t
);

33 
buf„r_ª£t
 (
buf„r
 *);

37 
buf„r_‰ì
 (
buf„r
 *);

40 
buf„r_put
 (
buf„r
 *, c⁄° *, 
size_t
);

42 
buf„r_putc
 (
buf„r
 *, 
u_ch¨
);

44 
buf„r_put°r
 (
buf„r
 *, const *);

50 *
buf„r_gë°r
 (
buf„r
 *);

53 
buf„r_em±y
 (
buf„r
 *);

59 
	mBUFFER_ERROR
 = -1,

63 
	mBUFFER_EMPTY
 = 0,

68 
	mBUFFER_PENDING
 = 1

69 } 
	tbuf„r_°©us_t
;

73 
buf„r_°©us_t
 
buf„r_wrôe
(
buf„r
 *, 
fd
,

74 c⁄° *, 
size_t
);

78 
buf„r_°©us_t
 
buf„r_Êush_avaûabÀ
(
buf„r
 *, 
fd
);

86 
buf„r_°©us_t
 
buf„r_Êush_Æl
 (
buf„r
 *, 
fd
);

99 
buf„r_°©us_t
 
buf„r_Êush_wödow
 (
buf„r
 *, 
fd
, 
width
,

100 
height
, 
îa£
, 
no_m‹e
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/checksum.c

9 
	~<zebø.h
>

10 
	~"checksum.h
"

13 
	$ö_cksum
(*
∑rg
, 
nbyãs
)

15 
u_sh‹t
 *
±r
 = 
∑rg
;

16 
sum
;

17 
u_sh‹t
 
oddbyã
;

18 
u_sh‹t
 
™swî
;

26 
sum
 = 0;

27 
nbyãs
 > 1) {

28 
sum
 +*
±r
++;

29 
nbyãs
 -= 2;

33 i‡(
nbyãs
 == 1) {

34 
oddbyã
 = 0;

35 *((
u_ch¨
 *Ë&
oddbyã
Ë*(u_ch¨ *)
±r
;

36 
sum
 +
oddbyã
;

43 
sum
 = (sum >> 16) + (sum & 0xffff);

44 
sum
 += (sum >> 16);

45 
™swî
 = ~
sum
;

46 (
™swî
);

47 
	}
}

50 
	#MODX
 4102

	)

56 
u_öt16_t


57 
	$Êëchî_checksum
(
u_ch¨
 * 
buf„r
, c⁄° 
size_t
 
Àn
, c⁄° 
uöt16_t
 
off£t
)

59 
u_öt8_t
 *
p
;

60 
x
, 
y
, 
c0
, 
c1
;

61 
u_öt16_t
 
checksum
;

62 
u_öt16_t
 *
csum
;

63 
size_t
 
∑πül_Àn
, 
i
, 
À·
 = 
Àn
;

65 
checksum
 = 0;

68 i‡(
off£t
 !
FLETCHER_CHECKSUM_VALIDATE
)

71 
	`as£π
 (
off£t
 < (
Àn
 - 1));

72 
csum
 = (
u_öt16_t
 *Ë(
buf„r
 + 
off£t
);

73 *(
csum
) = 0;

76 
p
 = 
buf„r
;

77 
c0
 = 0;

78 
c1
 = 0;

80 
À·
 != 0)

82 
∑πül_Àn
 = 
	`MIN
(
À·
, 
MODX
);

84 
i
 = 0; i < 
∑πül_Àn
; i++)

86 
c0
 = c0 + *(
p
++);

87 
c1
 +
c0
;

90 
c0
 = c0 % 255;

91 
c1
 = c1 % 255;

93 
À·
 -
∑πül_Àn
;

97 
x
 = ()((
Àn
 - 
off£t
 - 1Ë* 
c0
 - 
c1
) % 255;

99 i‡(
x
 <= 0)

100 
x
 += 255;

101 
y
 = 510 - 
c0
 - 
x
;

102 i‡(
y
 > 255)

103 
y
 -= 255;

105 i‡(
off£t
 =
FLETCHER_CHECKSUM_VALIDATE
)

107 
checksum
 = (
c1
 << 8Ë+ 
c0
;

116 
buf„r
[
off£t
] = 
x
;

117 
buf„r
[
off£t
 + 1] = 
y
;

120 
checksum
 = 
	`ht⁄s
((
x
 << 8Ë| (
y
 & 0xFF));

123  
checksum
;

124 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/checksum.h

1 
ö_cksum
(*, );

2 
	#FLETCHER_CHECKSUM_VALIDATE
 0xffff

	)

3 
u_öt16_t
 
Êëchî_checksum
(
u_ch¨
 *, c⁄° 
size_t
 
Àn
, c⁄° 
uöt16_t
 
off£t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/command.c

22 
	~<zebø.h
>

25 
	~"mem‹y.h
"

26 
	~"log.h
"

27 
	~<lib/vîsi⁄.h
>

28 
	~"thªad.h
"

29 
	~"ve˘‹.h
"

30 
	~"vty.h
"

31 
	~"comm™d.h
"

32 
	~"w‹kqueue.h
"

36 
ve˘‹
 
	gcmdvec
 = 
NULL
;

38 
desc
 
	gdesc_¸
;

39 *
	gcomm™d_¸
 = 
NULL
;

42 
ho°
 
	gho°
;

45 
cmd_node
 
	gauth_node
 =

47 
AUTH_NODE
,

51 
cmd_node
 
	gvõw_node
 =

53 
VIEW_NODE
,

57 
cmd_node
 
	gª°ri˘ed_node
 =

59 
RESTRICTED_NODE
,

63 
cmd_node
 
	gauth_íabÀ_node
 =

65 
AUTH_ENABLE_NODE
,

69 
cmd_node
 
	gíabÀ_node
 =

71 
ENABLE_NODE
,

75 
cmd_node
 
	gc⁄fig_node
 =

77 
CONFIG_NODE
,

83 c⁄° *
	gdeÁu…_mŸd
 =

84 "\r\n\
,Åhi†i†" 
QUAGGA_PROGNAME
 " (vîsi⁄ " 
QUAGGA_VERSION
 ").\r\n\
" 
QUAGGA_COPYRIGHT
 "\r\n\
" 
GIT_INFO
 "\r\n";

90 c⁄° 
	sÁcûôy_m≠
 {

91 
	mÁcûôy
;

92 c⁄° *
	m«me
;

93 
size_t
 
	mm©ch
;

94 } 
	gsy¶og_Ácûôõs
[] =

96 { 
LOG_KERN
, "kern", 1 },

97 { 
LOG_USER
, "user", 2 },

98 { 
LOG_MAIL
, "mail", 1 },

99 { 
LOG_DAEMON
, "daemon", 1 },

100 { 
LOG_AUTH
, "auth", 1 },

101 { 
LOG_SYSLOG
, "syslog", 1 },

102 { 
LOG_LPR
, "lpr", 2 },

103 { 
LOG_NEWS
, "news", 1 },

104 { 
LOG_UUCP
, "uucp", 2 },

105 { 
LOG_CRON
, "cron", 1 },

106 #ifde‡
LOG_FTP


107 { 
LOG_FTP
, "ftp", 1 },

109 { 
LOG_LOCAL0
, "local0", 6 },

110 { 
LOG_LOCAL1
, "local1", 6 },

111 { 
LOG_LOCAL2
, "local2", 6 },

112 { 
LOG_LOCAL3
, "local3", 6 },

113 { 
LOG_LOCAL4
, "local4", 6 },

114 { 
LOG_LOCAL5
, "local5", 6 },

115 { 
LOG_LOCAL6
, "local6", 6 },

116 { 
LOG_LOCAL7
, "local7", 6 },

117 { 0, 
NULL
, 0 },

121 
	$Ácûôy_«me
(
Ácûôy
)

123 c⁄° 
Ácûôy_m≠
 *
fm
;

125 
fm
 = 
sy¶og_Ácûôõs
; fm->
«me
; fm++)

126 i‡(
fm
->
Ácûôy
 == facility)

127  
fm
->
«me
;

129 
	}
}

132 
	$Ácûôy_m©ch
(c⁄° *
°r
)

134 c⁄° 
Ácûôy_m≠
 *
fm
;

136 
fm
 = 
sy¶og_Ácûôõs
; fm->
«me
; fm++)

137 i‡(!
	`°∫cmp
(
°r
,
fm
->
«me
,fm->
m©ch
))

138  
fm
->
Ácûôy
;

140 
	}
}

143 
	$Àvñ_m©ch
(c⁄° *
s
)

145 
Àvñ
 ;

147  
Àvñ
 = 0 ; 
zlog_¥i‹ôy
 [Àvñ] !
NULL
 ;Üevel ++ )

148 i‡(!
	`°∫cmp
 (
s
, 
zlog_¥i‹ôy
[
Àvñ
], 2))

149  
Àvñ
;

150  
ZLOG_DISABLED
;

151 
	}
}

155 
	$¥öt_vîsi⁄
 (c⁄° *
¥og«me
)

157 
	`¥ötf
 ("%†vîsi⁄ %s\n", 
¥og«me
, 
QUAGGA_VERSION
);

158 
	`¥ötf
 ("%s\n", 
QUAGGA_COPYRIGHT
);

159 
	}
}

165 
	$¨gv_c⁄ˇt
 (c⁄° **
¨gv
, 
¨gc
, 
shi·
)

167 
i
;

168 
size_t
 
Àn
;

169 *
°r
;

170 *
p
;

172 
Àn
 = 0;

173 
i
 = 
shi·
; i < 
¨gc
; i++)

174 
Àn
 +
	`°æí
(
¨gv
[
i
])+1;

175 i‡(!
Àn
)

176  
NULL
;

177 
p
 = 
°r
 = 
	`XMALLOC
(
MTYPE_TMP
, 
Àn
);

178 
i
 = 
shi·
; i < 
¨gc
; i++)

180 
size_t
 
¨gÀn
;

181 
	`mem˝y
(
p
, 
¨gv
[
i
], (
¨gÀn
 = 
	`°æí
(argv[i])));

182 
p
 +
¨gÀn
;

183 *
p
++ = ' ';

185 *(
p
-1) = '\0';

186  
°r
;

187 
	}
}

191 
ö°Æl_node
 (
cmd_node
 *
node
,

192 (*
func
Ë(
vty
 *))

194 
	`ve˘‹_£t_ödex
 (
cmdvec
, 
node
->node,Çode);

195 
node
->
func
 = func;

196 
node
->
cmd_ve˘‹
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

197 
	}
}

201 
	$cmp_node
 (c⁄° *
p
, c⁄° *
q
)

203 c⁄° 
cmd_ñemít
 *
a
 = *(cmd_ñemíà* c⁄° *)
p
;

204 c⁄° 
cmd_ñemít
 *
b
 = *(cmd_ñemíà* c⁄° *)
q
;

206  
	`°rcmp
 (
a
->
°rög
, 
b
->string);

207 
	}
}

210 
	$cmp_desc
 (c⁄° *
p
, c⁄° *
q
)

212 c⁄° 
desc
 *
a
 = *(des¯* c⁄° *)
p
;

213 c⁄° 
desc
 *
b
 = *(des¯* c⁄° *)
q
;

215  
	`°rcmp
 (
a
->
cmd
, 
b
->cmd);

216 
	}
}

220 
	$s‹t_node
 ()

222 
i
, 
j
;

223 
cmd_node
 *
˙ode
;

224 
ve˘‹
 
descvec
;

225 
cmd_ñemít
 *cmd_element;

227 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
cmdvec
); i++)

228 i‡((
˙ode
 = 
	`ve˘‹_¶Ÿ
 (
cmdvec
, 
i
)Ë!
NULL
)

230 
ve˘‹
 
cmd_ve˘‹
 = 
˙ode
->cmd_vector;

231 
	`qs‹t
 (
cmd_ve˘‹
->
ödex
, 
	`ve˘‹_a˘ive
 (cmd_vector),

232  (*), 
cmp_node
);

234 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
cmd_ve˘‹
); j++)

235 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
j
)Ë!
NULL


236 && 
	`ve˘‹_a˘ive
 (
cmd_ñemít
->
°rvec
))

238 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ñemít
->
°rvec
,

239 
	`ve˘‹_a˘ive
 (
cmd_ñemít
->
°rvec
) - 1);

240 
	`qs‹t
 (
descvec
->
ödex
, 
	`ve˘‹_a˘ive
 (descvec),

241  (*), 
cmp_desc
);

244 
	}
}

249 
ve˘‹


250 
	$cmd_make_°rvec
 (c⁄° *
°rög
)

252 c⁄° *
˝
, *
°¨t
;

253 *
tokí
;

254 
°æí
;

255 
ve˘‹
 
°rvec
;

257 i‡(
°rög
 =
NULL
)

258  
NULL
;

260 
˝
 = 
°rög
;

263 
	`is•a˚
 ((Ë*
˝
) && *cp != '\0')

264 
˝
++;

267 i‡(*
˝
 == '\0')

268  
NULL
;

270 i‡(*
˝
 == '!' || *cp == '#')

271  
NULL
;

274 
°rvec
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

279 
°¨t
 = 
˝
;

280 !(
	`is•a˚
 ((Ë*
˝
) || *cp == '\r' || *cp == '\n') &&

281 *
˝
 != '\0')

282 
˝
++;

283 
°æí
 = 
˝
 - 
°¨t
;

284 
tokí
 = 
	`XMALLOC
 (
MTYPE_STRVEC
, 
°æí
 + 1);

285 
	`mem˝y
 (
tokí
, 
°¨t
, 
°æí
);

286 *(
tokí
 + 
°æí
) = '\0';

287 
	`ve˘‹_£t
 (
°rvec
, 
tokí
);

289 (
	`is•a˚
 ((Ë*
˝
) || *cp == '\n' || *cp == '\r') &&

290 *
˝
 != '\0')

291 
˝
++;

293 i‡(*
˝
 == '\0')

294  
°rvec
;

296 
	}
}

300 
	$cmd_‰ì_°rvec
 (
ve˘‹
 
v
)

302 
i
;

303 *
˝
;

305 i‡(!
v
)

308 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
v
); i++)

309 i‡((
˝
 = 
	`ve˘‹_¶Ÿ
 (
v
, 
i
)Ë!
NULL
)

310 
	`XFREE
 (
MTYPE_STRVEC
, 
˝
);

312 
	`ve˘‹_‰ì
 (
v
);

313 
	}
}

317 
	$cmd_desc_°r
 (c⁄° **
°rög
)

319 c⁄° *
˝
, *
°¨t
;

320 *
tokí
;

321 
°æí
;

323 
˝
 = *
°rög
;

325 i‡(
˝
 =
NULL
)

326  
NULL
;

329 
	`is•a˚
 ((Ë*
˝
) && *cp != '\0')

330 
˝
++;

333 i‡(*
˝
 == '\0')

334  
NULL
;

336 
°¨t
 = 
˝
;

338 !(*
˝
 == '\r' || *cp == '\n') && *cp != '\0')

339 
˝
++;

341 
°æí
 = 
˝
 - 
°¨t
;

342 
tokí
 = 
	`XMALLOC
 (
MTYPE_STRVEC
, 
°æí
 + 1);

343 
	`mem˝y
 (
tokí
, 
°¨t
, 
°æí
);

344 *(
tokí
 + 
°æí
) = '\0';

346 *
°rög
 = 
˝
;

348  
tokí
;

349 
	}
}

352 
ve˘‹


353 
	$cmd_make_descvec
 (c⁄° *
°rög
, c⁄° *
desc°r
)

355 
mu…ùÀ
 = 0;

356 c⁄° *
•
;

357 *
tokí
;

358 
Àn
;

359 c⁄° *
˝
;

360 c⁄° *
dp
;

361 
ve˘‹
 
Ælvec
;

362 
ve˘‹
 
°rvec
 = 
NULL
;

363 
desc
 *desc;

365 
˝
 = 
°rög
;

366 
dp
 = 
desc°r
;

368 i‡(
˝
 =
NULL
)

369  
NULL
;

371 
Ælvec
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

375 
	`is•a˚
 ((Ë*
˝
) && *cp != '\0')

376 
˝
++;

378 i‡(*
˝
 == '(')

380 
mu…ùÀ
 = 1;

381 
˝
++;

383 i‡(*
˝
 == ')')

385 
mu…ùÀ
 = 0;

386 
˝
++;

388 i‡(*
˝
 == '|')

390 i‡(! 
mu…ùÀ
)

392 
	`Ârötf
 (
°dîr
, "Comm™dÖ¨£Éº‹!: %s\n", 
°rög
);

393 
	`exô
 (1);

395 
˝
++;

398 
	`is•a˚
 ((Ë*
˝
) && *cp != '\0')

399 
˝
++;

401 i‡(*
˝
 == '(')

403 
mu…ùÀ
 = 1;

404 
˝
++;

407 i‡(*
˝
 == '\0')

408  
Ælvec
;

410 
•
 = 
˝
;

412 ! (
	`is•a˚
 ((Ë*
˝
) || *cp == '\r' || *cp == '\n' || *cp == ')' || *cp == '|') && *cp != '\0')

413 
˝
++;

415 
Àn
 = 
˝
 - 
•
;

417 
tokí
 = 
	`XMALLOC
 (
MTYPE_STRVEC
, 
Àn
 + 1);

418 
	`mem˝y
 (
tokí
, 
•
, 
Àn
);

419 *(
tokí
 + 
Àn
) = '\0';

421 
desc
 = 
	`XCALLOC
 (
MTYPE_DESC
,  (desc));

422 
desc
->
cmd
 = 
tokí
;

423 
desc
->
°r
 = 
	`cmd_desc_°r
 (&
dp
);

425 i‡(
mu…ùÀ
)

427 i‡(
mu…ùÀ
 == 1)

429 
°rvec
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

430 
	`ve˘‹_£t
 (
Ælvec
, 
°rvec
);

432 
mu…ùÀ
++;

436 
°rvec
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

437 
	`ve˘‹_£t
 (
Ælvec
, 
°rvec
);

439 
	`ve˘‹_£t
 (
°rvec
, 
desc
);

441 
	}
}

446 
	$cmd_cmdsize
 (
ve˘‹
 
°rvec
)

448 
i
;

449 
size
 = 0;

450 
ve˘‹
 
descvec
;

451 
desc
 *desc;

453 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
°rvec
); i++)

454 i‡((
descvec
 = 
	`ve˘‹_¶Ÿ
 (
°rvec
, 
i
)Ë!
NULL
)

456 i‡((
	`ve˘‹_a˘ive
 (
descvec
)) == 1

457 && (
desc
 = 
	`ve˘‹_¶Ÿ
 (
descvec
, 0)Ë!
NULL
)

459 i‡(
desc
->
cmd
 =
NULL
 || 
	`CMD_OPTION
 (desc->cmd))

460  
size
;

462 
size
++;

465 
size
++;

467  
size
;

468 
	}
}

472 
	$cmd_¥om±
 (
node_ty≥
 
node
)

474 
cmd_node
 *
˙ode
;

476 
˙ode
 = 
	`ve˘‹_¶Ÿ
 (
cmdvec
, 
node
);

477  
˙ode
->
¥om±
;

478 
	}
}

482 
	$ö°Æl_ñemít
 (
node_ty≥
 
¡y≥
, 
cmd_ñemít
 *
cmd
)

484 
cmd_node
 *
˙ode
;

487 i‡(!
cmdvec
)

490 
˙ode
 = 
	`ve˘‹_¶Ÿ
 (
cmdvec
, 
¡y≥
);

492 i‡(
˙ode
 =
NULL
)

494 
	`Ârötf
 (
°dîr
, "CommandÇode %d doesn'tÉxist,Ölease check it\n",

495 
¡y≥
);

496 
	`exô
 (1);

499 
	`ve˘‹_£t
 (
˙ode
->
cmd_ve˘‹
, 
cmd
);

501 i‡(
cmd
->
°rvec
 =
NULL
)

502 
cmd
->
°rvec
 = 
	`cmd_make_descvec
 (cmd->
°rög
, cmd->
doc
);

504 
cmd
->
cmdsize
 = 
	`cmd_cmdsize
 (cmd->
°rvec
);

505 
	}
}

507 c⁄° 
	gôﬂ64
[] =

511 
	$to64
(*
s
, 
v
, 
n
)

513 --
n
 >= 0)

515 *
s
++ = 
ôﬂ64
[
v
&0x3f];

516 
v
 >>= 6;

518 
	}
}

521 
	$zí¸y±
 (c⁄° *
∑sswd
)

523 
ß…
[6];

524 
timevÆ
 
tv
;

525 *
	`¸y±
 (const *, const *);

527 
	`gëtimeofday
(&
tv
,0);

529 
	`to64
(&
ß…
[0], 
	`øndom
(), 3);

530 
	`to64
(&
ß…
[3], 
tv
.
tv_u£c
, 3);

531 
ß…
[5] = '\0';

533  
	`¸y±
 (
∑sswd
, 
ß…
);

534 
	}
}

538 
	$c⁄fig_wrôe_ho°
 (
vty
 *vty)

540 i‡(
ho°
.
«me
)

541 
	`vty_out
 (
vty
, "ho°«mê%s%s", 
ho°
.
«me
, 
VTY_NEWLINE
);

543 i‡(
ho°
.
í¸y±
)

545 i‡(
ho°
.
∑ssw‹d_í¸y±
)

546 
	`vty_out
 (
vty
, "∑ssw‹d 8 %s%s", 
ho°
.
∑ssw‹d_í¸y±
, 
VTY_NEWLINE
);

547 i‡(
ho°
.
íabÀ_í¸y±
)

548 
	`vty_out
 (
vty
, "íabÀÖassw‹d 8 %s%s", 
ho°
.
íabÀ_í¸y±
, 
VTY_NEWLINE
);

552 i‡(
ho°
.
∑ssw‹d
)

553 
	`vty_out
 (
vty
, "∑ssw‹d %s%s", 
ho°
.
∑ssw‹d
, 
VTY_NEWLINE
);

554 i‡(
ho°
.
íabÀ
)

555 
	`vty_out
 (
vty
, "íabÀÖassw‹d %s%s", 
ho°
.
íabÀ
, 
VTY_NEWLINE
);

558 i‡(
zlog_deÁu…
->
deÁu…_lvl
 !
LOG_DEBUG
)

560 
	`vty_out
 (
vty
, "! N.B. The 'logÅrap' command is deprecated.%s",

561 
VTY_NEWLINE
);

562 
	`vty_out
 (
vty
, "logÅrap %s%s",

563 
zlog_¥i‹ôy
[
zlog_deÁu…
->
deÁu…_lvl
], 
VTY_NEWLINE
);

566 i‡(
ho°
.
logfûe
 && (
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_FILE
] !
ZLOG_DISABLED
))

568 
	`vty_out
 (
vty
, "log fûê%s", 
ho°
.
logfûe
);

569 i‡(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_FILE
] !zlog_deÁu…->
deÁu…_lvl
)

570 
	`vty_out
 (
vty
, " %s",

571 
zlog_¥i‹ôy
[
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_FILE
]]);

572 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

575 i‡(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_STDOUT
] !
ZLOG_DISABLED
)

577 
	`vty_out
 (
vty
, "log stdout");

578 i‡(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_STDOUT
] !zlog_deÁu…->
deÁu…_lvl
)

579 
	`vty_out
 (
vty
, " %s",

580 
zlog_¥i‹ôy
[
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_STDOUT
]]);

581 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

584 i‡(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_MONITOR
] =
ZLOG_DISABLED
)

585 
	`vty_out
(
vty
,"nÿlog m⁄ô‹%s",
VTY_NEWLINE
);

586 i‡(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_MONITOR
] !zlog_deÁu…->
deÁu…_lvl
)

587 
	`vty_out
(
vty
,"log monitor %s%s",

588 
zlog_¥i‹ôy
[
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_MONITOR
]],
VTY_NEWLINE
);

590 i‡(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_SYSLOG
] !
ZLOG_DISABLED
)

592 
	`vty_out
 (
vty
, "log syslog");

593 i‡(
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_SYSLOG
] !zlog_deÁu…->
deÁu…_lvl
)

594 
	`vty_out
 (
vty
, " %s",

595 
zlog_¥i‹ôy
[
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_SYSLOG
]]);

596 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

599 i‡(
zlog_deÁu…
->
Ácûôy
 !
LOG_DAEMON
)

600 
	`vty_out
 (
vty
, "log facility %s%s",

601 
	`Ácûôy_«me
(
zlog_deÁu…
->
Ácûôy
), 
VTY_NEWLINE
);

603 i‡(
zlog_deÁu…
->
ªc‹d_¥i‹ôy
 == 1)

604 
	`vty_out
 (
vty
, "logÑec‹d-¥i‹ôy%s", 
VTY_NEWLINE
);

606 i‡(
zlog_deÁu…
->
time°amp_¥ecisi⁄
 > 0)

607 
	`vty_out
 (
vty
, "logÅimestampÖrecision %d%s",

608 
zlog_deÁu…
->
time°amp_¥ecisi⁄
, 
VTY_NEWLINE
);

610 i‡(
ho°
.
adv™˚d
)

611 
	`vty_out
 (
vty
, "£rvi˚ádv™˚d-vty%s", 
VTY_NEWLINE
);

613 i‡(
ho°
.
í¸y±
)

614 
	`vty_out
 (
vty
, "£rvi˚Öassw‹d-í¸y±i⁄%s", 
VTY_NEWLINE
);

616 i‡(
ho°
.
löes
 >= 0)

617 
	`vty_out
 (
vty
, "£rvi˚ÅîmöÆ-Àngth %d%s", 
ho°
.
löes
,

618 
VTY_NEWLINE
);

620 i‡(
ho°
.
mŸdfûe
)

621 
	`vty_out
 (
vty
, "b™√∏mŸd fûê%s%s", 
ho°
.
mŸdfûe
, 
VTY_NEWLINE
);

622 i‡(! 
ho°
.
mŸd
)

623 
	`vty_out
 (
vty
, "nÿb™√∏mŸd%s", 
VTY_NEWLINE
);

626 
	}
}

629 
ve˘‹


630 
	$cmd_node_ve˘‹
 (
ve˘‹
 
v
, 
node_ty≥
 
¡y≥
)

632 
cmd_node
 *
˙ode
 = 
	`ve˘‹_¶Ÿ
 (
v
, 
¡y≥
);

633  
˙ode
->
cmd_ve˘‹
;

634 
	}
}

640 
	$cmd_fûãr_by_symbﬁ
 (*
comm™d
, *
symbﬁ
)

642 
i
, 
lim
;

644 i‡(
	`°rcmp
 (
symbﬁ
, "IPV4_ADDRESS") == 0)

646 
i
 = 0;

647 
lim
 = 
	`°æí
 (
comm™d
);

648 
i
 < 
lim
)

650 i‡(! (
	`isdigô
 ((Ë
comm™d
[
i
]) || command[i] == '.' || command[i] == '/'))

652 
i
++;

656 i‡(
	`°rcmp
 (
symbﬁ
, "STRING") == 0)

658 
i
 = 0;

659 
lim
 = 
	`°æí
 (
comm™d
);

660 
i
 < 
lim
)

662 i‡(! (
	`ißÕha
 ((Ë
comm™d
[
i
]) || command[i] == '_' || command[i] == '-'))

664 
i
++;

668 i‡(
	`°rcmp
 (
symbﬁ
, "IFNAME") == 0)

670 
i
 = 0;

671 
lim
 = 
	`°æí
 (
comm™d
);

672 
i
 < 
lim
)

674 i‡(! 
	`iß um
 ((Ë
comm™d
[
i
]))

676 
i
++;

681 
	}
}

685 
	em©ch_ty≥


687 
	mno_m©ch
,

688 
	mexãnd_m©ch
,

689 
	mùv4_¥efix_m©ch
,

690 
	mùv4_m©ch
,

691 
	mùv6_¥efix_m©ch
,

692 
	mùv6_m©ch
,

693 
	mønge_m©ch
,

694 
	mv¨¨g_m©ch
,

695 
	m∑πly_m©ch
,

696 
	mexa˘_m©ch


699 
m©ch_ty≥


700 
	$cmd_ùv4_m©ch
 (c⁄° *
°r
)

702 c⁄° *
•
;

703 
dŸs
 = 0, 
nums
 = 0;

704 
buf
[4];

706 i‡(
°r
 =
NULL
)

707  
∑πly_m©ch
;

711 
	`mem£t
 (
buf
, 0,  (buf));

712 
•
 = 
°r
;

713 *
°r
 != '\0')

715 i‡(*
°r
 == '.')

717 i‡(
dŸs
 >= 3)

718  
no_m©ch
;

720 i‡(*(
°r
 + 1) == '.')

721  
no_m©ch
;

723 i‡(*(
°r
 + 1) == '\0')

724  
∑πly_m©ch
;

726 
dŸs
++;

729 i‡(!
	`isdigô
 ((Ë*
°r
))

730  
no_m©ch
;

732 
°r
++;

735 i‡(
°r
 - 
•
 > 3)

736  
no_m©ch
;

738 
	`°∫˝y
 (
buf
, 
•
, 
°r
 - sp);

739 i‡(
	`©oi
 (
buf
) > 255)

740  
no_m©ch
;

742 
nums
++;

744 i‡(*
°r
 == '\0')

747 
°r
++;

750 i‡(
nums
 < 4)

751  
∑πly_m©ch
;

753  
exa˘_m©ch
;

754 
	}
}

756 
m©ch_ty≥


757 
	$cmd_ùv4_¥efix_m©ch
 (c⁄° *
°r
)

759 c⁄° *
•
;

760 
dŸs
 = 0;

761 
buf
[4];

763 i‡(
°r
 =
NULL
)

764  
∑πly_m©ch
;

768 
	`mem£t
 (
buf
, 0,  (buf));

769 
•
 = 
°r
;

770 *
°r
 != '\0' && *str != '/')

772 i‡(*
°r
 == '.')

774 i‡(
dŸs
 == 3)

775  
no_m©ch
;

777 i‡(*(
°r
 + 1) == '.' || *(str + 1) == '/')

778  
no_m©ch
;

780 i‡(*(
°r
 + 1) == '\0')

781  
∑πly_m©ch
;

783 
dŸs
++;

787 i‡(!
	`isdigô
 ((Ë*
°r
))

788  
no_m©ch
;

790 
°r
++;

793 i‡(
°r
 - 
•
 > 3)

794  
no_m©ch
;

796 
	`°∫˝y
 (
buf
, 
•
, 
°r
 - sp);

797 i‡(
	`©oi
 (
buf
) > 255)

798  
no_m©ch
;

800 i‡(
dŸs
 == 3)

802 i‡(*
°r
 == '/')

804 i‡(*(
°r
 + 1) == '\0')

805  
∑πly_m©ch
;

807 
°r
++;

810 i‡(*
°r
 == '\0')

811  
∑πly_m©ch
;

814 i‡(*
°r
 == '\0')

815  
∑πly_m©ch
;

817 
°r
++;

820 
•
 = 
°r
;

821 *
°r
 != '\0')

823 i‡(!
	`isdigô
 ((Ë*
°r
))

824  
no_m©ch
;

826 
°r
++;

829 i‡(
	`©oi
 (
•
) > 32)

830  
no_m©ch
;

832  
exa˘_m©ch
;

833 
	}
}

835 
	#IPV6_ADDR_STR
 "0123456789abcdefABCDEF:.%"

	)

836 
	#IPV6_PREFIX_STR
 "0123456789abcdefABCDEF:.%/"

	)

837 
	#STATE_START
 1

	)

838 
	#STATE_COLON
 2

	)

839 
	#STATE_DOUBLE
 3

	)

840 
	#STATE_ADDR
 4

	)

841 
	#STATE_DOT
 5

	)

842 
	#STATE_SLASH
 6

	)

843 
	#STATE_MASK
 7

	)

845 #ifde‡
HAVE_IPV6


847 
m©ch_ty≥


848 
	$cmd_ùv6_m©ch
 (c⁄° *
°r
)

850 
°©e
 = 
STATE_START
;

851 
cﬁ⁄s
 = 0, 
nums
 = 0, 
doubÀ_cﬁ⁄
 = 0;

852 c⁄° *
•
 = 
NULL
;

853 
sockaddr_ö6
 
sö6_dummy
;

854 
ªt
;

856 i‡(
°r
 =
NULL
)

857  
∑πly_m©ch
;

859 i‡(
	`°r•n
 (
°r
, 
IPV6_ADDR_STR
Ë!
	`°æí
 (str))

860  
no_m©ch
;

866 
ªt
 = 
	`öë_±⁄
(
AF_INET6
, 
°r
, &
sö6_dummy
.
sö6_addr
);

868 i‡(
ªt
 == 1)

869  
exa˘_m©ch
;

871  
no_m©ch
;

872 
	}
}

874 
m©ch_ty≥


875 
	$cmd_ùv6_¥efix_m©ch
 (c⁄° *
°r
)

877 
°©e
 = 
STATE_START
;

878 
cﬁ⁄s
 = 0, 
nums
 = 0, 
doubÀ_cﬁ⁄
 = 0;

879 
mask
;

880 c⁄° *
•
 = 
NULL
;

881 *
íd±r
 = 
NULL
;

883 i‡(
°r
 =
NULL
)

884  
∑πly_m©ch
;

886 i‡(
	`°r•n
 (
°r
, 
IPV6_PREFIX_STR
Ë!
	`°æí
 (str))

887  
no_m©ch
;

889 *
°r
 !'\0' && 
°©e
 !
STATE_MASK
)

891 
°©e
)

893 
STATE_START
:

894 i‡(*
°r
 == ':')

896 i‡(*(
°r
 + 1) != ':' && *(str + 1) != '\0')

897  
no_m©ch
;

898 
cﬁ⁄s
--;

899 
°©e
 = 
STATE_COLON
;

903 
•
 = 
°r
;

904 
°©e
 = 
STATE_ADDR
;

908 
STATE_COLON
:

909 
cﬁ⁄s
++;

910 i‡(*(
°r
 + 1) == '/')

911  
no_m©ch
;

912 i‡(*(
°r
 + 1) == ':')

913 
°©e
 = 
STATE_DOUBLE
;

916 
•
 = 
°r
 + 1;

917 
°©e
 = 
STATE_ADDR
;

920 
STATE_DOUBLE
:

921 i‡(
doubÀ_cﬁ⁄
)

922  
no_m©ch
;

924 i‡(*(
°r
 + 1) == ':')

925  
no_m©ch
;

928 i‡(*(
°r
 + 1) != '\0' && *(str + 1) != '/')

929 
cﬁ⁄s
++;

930 
•
 = 
°r
 + 1;

932 i‡(*(
°r
 + 1) == '/')

933 
°©e
 = 
STATE_SLASH
;

935 
°©e
 = 
STATE_ADDR
;

938 
doubÀ_cﬁ⁄
++;

939 
nums
 += 1;

941 
STATE_ADDR
:

942 i‡(*(
°r
 + 1) == ':' || *(str + 1) == '.'

943 || *(
°r
 + 1) == '\0' || *(str + 1) == '/')

945 i‡(
°r
 - 
•
 > 3)

946  
no_m©ch
;

948 ; 
•
 <
°r
; sp++)

949 i‡(*
•
 == '/')

950  
no_m©ch
;

952 
nums
++;

954 i‡(*(
°r
 + 1) == ':')

955 
°©e
 = 
STATE_COLON
;

956 i‡(*(
°r
 + 1) == '.')

958 i‡(
cﬁ⁄s
 || 
doubÀ_cﬁ⁄
)

959 
°©e
 = 
STATE_DOT
;

961  
no_m©ch
;

963 i‡(*(
°r
 + 1) == '/')

964 
°©e
 = 
STATE_SLASH
;

967 
STATE_DOT
:

968 
°©e
 = 
STATE_ADDR
;

970 
STATE_SLASH
:

971 i‡(*(
°r
 + 1) == '\0')

972  
∑πly_m©ch
;

974 
°©e
 = 
STATE_MASK
;

980 i‡(
nums
 > 11)

981  
no_m©ch
;

983 i‡(
cﬁ⁄s
 > 7)

984  
no_m©ch
;

986 
°r
++;

989 i‡(
°©e
 < 
STATE_MASK
)

990  
∑πly_m©ch
;

992 
mask
 = 
	`°πﬁ
 (
°r
, &
íd±r
, 10);

993 i‡(*
íd±r
 != '\0')

994  
no_m©ch
;

996 i‡(
mask
 < 0 || mask > 128)

997  
no_m©ch
;

1007  
exa˘_m©ch
;

1008 
	}
}

1012 
	#DECIMAL_STRLEN_MAX
 10

	)

1015 
	$cmd_ønge_m©ch
 (c⁄° *
ønge
, c⁄° *
°r
)

1017 *
p
;

1018 
buf
[
DECIMAL_STRLEN_MAX
 + 1];

1019 *
íd±r
 = 
NULL
;

1020 
mö
, 
max
, 
vÆ
;

1022 i‡(
°r
 =
NULL
)

1025 
vÆ
 = 
	`°πoul
 (
°r
, &
íd±r
, 10);

1026 i‡(*
íd±r
 != '\0')

1029 
ønge
++;

1030 
p
 = 
	`°rchr
 (
ønge
, '-');

1031 i‡(
p
 =
NULL
)

1033 i‡(
p
 - 
ønge
 > 
DECIMAL_STRLEN_MAX
)

1035 
	`°∫˝y
 (
buf
, 
ønge
, 
p
 -Ñange);

1036 
buf
[
p
 - 
ønge
] = '\0';

1037 
mö
 = 
	`°πoul
 (
buf
, &
íd±r
, 10);

1038 i‡(*
íd±r
 != '\0')

1041 
ønge
 = 
p
 + 1;

1042 
p
 = 
	`°rchr
 (
ønge
, '>');

1043 i‡(
p
 =
NULL
)

1045 i‡(
p
 - 
ønge
 > 
DECIMAL_STRLEN_MAX
)

1047 
	`°∫˝y
 (
buf
, 
ønge
, 
p
 -Ñange);

1048 
buf
[
p
 - 
ønge
] = '\0';

1049 
max
 = 
	`°πoul
 (
buf
, &
íd±r
, 10);

1050 i‡(*
íd±r
 != '\0')

1053 i‡(
vÆ
 < 
mö
 || vÆ > 
max
)

1057 
	}
}

1060 
m©ch_ty≥


1061 
	$cmd_fûãr_by_com∂ëi⁄
 (*
comm™d
, 
ve˘‹
 
v
, 
ödex
)

1063 
i
;

1064 c⁄° *
°r
;

1065 
cmd_ñemít
 *cmd_element;

1066 
m©ch_ty≥
 match_type;

1067 
ve˘‹
 
descvec
;

1068 
desc
 *desc;

1070 
m©ch_ty≥
 = 
no_m©ch
;

1073 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
v
); i++)

1074 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
v
, 
i
)Ë!
NULL
)

1076 i‡(
ödex
 >
	`ve˘‹_a˘ive
 (
cmd_ñemít
->
°rvec
))

1077 
	`ve˘‹_¶Ÿ
 (
v
, 
i
Ë
NULL
;

1080 
j
;

1081 
m©ched
 = 0;

1083 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ñemít
->
°rvec
, 
ödex
);

1085 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
descvec
); j++)

1086 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
descvec
, 
j
)))

1088 
°r
 = 
desc
->
cmd
;

1090 i‡(
	`CMD_VARARG
 (
°r
))

1092 i‡(
m©ch_ty≥
 < 
v¨¨g_m©ch
)

1093 
m©ch_ty≥
 = 
v¨¨g_m©ch
;

1094 
m©ched
++;

1096 i‡(
	`CMD_RANGE
 (
°r
))

1098 i‡(
	`cmd_ønge_m©ch
 (
°r
, 
comm™d
))

1100 i‡(
m©ch_ty≥
 < 
ønge_m©ch
)

1101 
m©ch_ty≥
 = 
ønge_m©ch
;

1103 
m©ched
++;

1106 #ifde‡
HAVE_IPV6


1107 i‡(
	`CMD_IPV6
 (
°r
))

1109 i‡(
	`cmd_ùv6_m©ch
 (
comm™d
))

1111 i‡(
m©ch_ty≥
 < 
ùv6_m©ch
)

1112 
m©ch_ty≥
 = 
ùv6_m©ch
;

1114 
m©ched
++;

1117 i‡(
	`CMD_IPV6_PREFIX
 (
°r
))

1119 i‡(
	`cmd_ùv6_¥efix_m©ch
 (
comm™d
))

1121 i‡(
m©ch_ty≥
 < 
ùv6_¥efix_m©ch
)

1122 
m©ch_ty≥
 = 
ùv6_¥efix_m©ch
;

1124 
m©ched
++;

1128 i‡(
	`CMD_IPV4
 (
°r
))

1130 i‡(
	`cmd_ùv4_m©ch
 (
comm™d
))

1132 i‡(
m©ch_ty≥
 < 
ùv4_m©ch
)

1133 
m©ch_ty≥
 = 
ùv4_m©ch
;

1135 
m©ched
++;

1138 i‡(
	`CMD_IPV4_PREFIX
 (
°r
))

1140 i‡(
	`cmd_ùv4_¥efix_m©ch
 (
comm™d
))

1142 i‡(
m©ch_ty≥
 < 
ùv4_¥efix_m©ch
)

1143 
m©ch_ty≥
 = 
ùv4_¥efix_m©ch
;

1144 
m©ched
++;

1149 i‡(
	`CMD_OPTION
 (
°r
Ë|| 
	`CMD_VARIABLE
 (str))

1151 i‡(
m©ch_ty≥
 < 
exãnd_m©ch
)

1152 
m©ch_ty≥
 = 
exãnd_m©ch
;

1153 
m©ched
++;

1155 i‡(
	`°∫cmp
 (
comm™d
, 
°r
, 
	`°æí
 (command)) == 0)

1157 i‡(
	`°rcmp
 (
comm™d
, 
°r
) == 0)

1158 
m©ch_ty≥
 = 
exa˘_m©ch
;

1161 i‡(
m©ch_ty≥
 < 
∑πly_m©ch
)

1162 
m©ch_ty≥
 = 
∑πly_m©ch
;

1164 
m©ched
++;

1167 i‡(!
m©ched
)

1168 
	`ve˘‹_¶Ÿ
 (
v
, 
i
Ë
NULL
;

1171  
m©ch_ty≥
;

1172 
	}
}

1175 
m©ch_ty≥


1176 
	$cmd_fûãr_by_°rög
 (*
comm™d
, 
ve˘‹
 
v
, 
ödex
)

1178 
i
;

1179 c⁄° *
°r
;

1180 
cmd_ñemít
 *cmd_element;

1181 
m©ch_ty≥
 match_type;

1182 
ve˘‹
 
descvec
;

1183 
desc
 *desc;

1185 
m©ch_ty≥
 = 
no_m©ch
;

1188 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
v
); i++)

1189 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
v
, 
i
)Ë!
NULL
)

1193 i‡(
ödex
 >
	`ve˘‹_a˘ive
 (
cmd_ñemít
->
°rvec
))

1194 
	`ve˘‹_¶Ÿ
 (
v
, 
i
Ë
NULL
;

1197 
j
;

1198 
m©ched
 = 0;

1200 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ñemít
->
°rvec
, 
ödex
);

1202 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
descvec
); j++)

1203 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
descvec
, 
j
)))

1205 
°r
 = 
desc
->
cmd
;

1207 i‡(
	`CMD_VARARG
 (
°r
))

1209 i‡(
m©ch_ty≥
 < 
v¨¨g_m©ch
)

1210 
m©ch_ty≥
 = 
v¨¨g_m©ch
;

1211 
m©ched
++;

1213 i‡(
	`CMD_RANGE
 (
°r
))

1215 i‡(
	`cmd_ønge_m©ch
 (
°r
, 
comm™d
))

1217 i‡(
m©ch_ty≥
 < 
ønge_m©ch
)

1218 
m©ch_ty≥
 = 
ønge_m©ch
;

1219 
m©ched
++;

1222 #ifde‡
HAVE_IPV6


1223 i‡(
	`CMD_IPV6
 (
°r
))

1225 i‡(
	`cmd_ùv6_m©ch
 (
comm™d
Ë=
exa˘_m©ch
)

1227 i‡(
m©ch_ty≥
 < 
ùv6_m©ch
)

1228 
m©ch_ty≥
 = 
ùv6_m©ch
;

1229 
m©ched
++;

1232 i‡(
	`CMD_IPV6_PREFIX
 (
°r
))

1234 i‡(
	`cmd_ùv6_¥efix_m©ch
 (
comm™d
Ë=
exa˘_m©ch
)

1236 i‡(
m©ch_ty≥
 < 
ùv6_¥efix_m©ch
)

1237 
m©ch_ty≥
 = 
ùv6_¥efix_m©ch
;

1238 
m©ched
++;

1242 i‡(
	`CMD_IPV4
 (
°r
))

1244 i‡(
	`cmd_ùv4_m©ch
 (
comm™d
Ë=
exa˘_m©ch
)

1246 i‡(
m©ch_ty≥
 < 
ùv4_m©ch
)

1247 
m©ch_ty≥
 = 
ùv4_m©ch
;

1248 
m©ched
++;

1251 i‡(
	`CMD_IPV4_PREFIX
 (
°r
))

1253 i‡(
	`cmd_ùv4_¥efix_m©ch
 (
comm™d
Ë=
exa˘_m©ch
)

1255 i‡(
m©ch_ty≥
 < 
ùv4_¥efix_m©ch
)

1256 
m©ch_ty≥
 = 
ùv4_¥efix_m©ch
;

1257 
m©ched
++;

1260 i‡(
	`CMD_OPTION
 (
°r
Ë|| 
	`CMD_VARIABLE
 (str))

1262 i‡(
m©ch_ty≥
 < 
exãnd_m©ch
)

1263 
m©ch_ty≥
 = 
exãnd_m©ch
;

1264 
m©ched
++;

1268 i‡(
	`°rcmp
 (
comm™d
, 
°r
) == 0)

1270 
m©ch_ty≥
 = 
exa˘_m©ch
;

1271 
m©ched
++;

1275 i‡(!
m©ched
)

1276 
	`ve˘‹_¶Ÿ
 (
v
, 
i
Ë
NULL
;

1279  
m©ch_ty≥
;

1280 
	}
}

1284 
	$is_cmd_ambiguous
 (*
comm™d
, 
ve˘‹
 
v
, 
ödex
, 
m©ch_ty≥
 
ty≥
)

1286 
i
;

1287 
j
;

1288 c⁄° *
°r
 = 
NULL
;

1289 
cmd_ñemít
 *cmd_element;

1290 c⁄° *
m©ched
 = 
NULL
;

1291 
ve˘‹
 
descvec
;

1292 
desc
 *desc;

1294 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
v
); i++)

1295 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
v
, 
i
)Ë!
NULL
)

1297 
m©ch
 = 0;

1299 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ñemít
->
°rvec
, 
ödex
);

1301 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
descvec
); j++)

1302 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
descvec
, 
j
)))

1304 
m©ch_ty≥
 
ªt
;

1306 
°r
 = 
desc
->
cmd
;

1308 
ty≥
)

1310 
exa˘_m©ch
:

1311 i‡(!(
	`CMD_OPTION
 (
°r
Ë|| 
	`CMD_VARIABLE
 (str))

1312 && 
	`°rcmp
 (
comm™d
, 
°r
) == 0)

1313 
m©ch
++;

1315 
∑πly_m©ch
:

1316 i‡(!(
	`CMD_OPTION
 (
°r
Ë|| 
	`CMD_VARIABLE
 (str))

1317 && 
	`°∫cmp
 (
comm™d
, 
°r
, 
	`°æí
 (command)) == 0)

1319 i‡(
m©ched
 && 
	`°rcmp
 (m©ched, 
°r
) != 0)

1322 
m©ched
 = 
°r
;

1323 
m©ch
++;

1326 
ønge_m©ch
:

1327 i‡(
	`cmd_ønge_m©ch
 (
°r
, 
comm™d
))

1329 i‡(
m©ched
 && 
	`°rcmp
 (m©ched, 
°r
) != 0)

1332 
m©ched
 = 
°r
;

1333 
m©ch
++;

1336 #ifde‡
HAVE_IPV6


1337 
ùv6_m©ch
:

1338 i‡(
	`CMD_IPV6
 (
°r
))

1339 
m©ch
++;

1341 
ùv6_¥efix_m©ch
:

1342 i‡((
ªt
 = 
	`cmd_ùv6_¥efix_m©ch
 (
comm™d
)Ë!
no_m©ch
)

1344 i‡(
ªt
 =
∑πly_m©ch
)

1347 
m©ch
++;

1351 
ùv4_m©ch
:

1352 i‡(
	`CMD_IPV4
 (
°r
))

1353 
m©ch
++;

1355 
ùv4_¥efix_m©ch
:

1356 i‡((
ªt
 = 
	`cmd_ùv4_¥efix_m©ch
 (
comm™d
)Ë!
no_m©ch
)

1358 i‡(
ªt
 =
∑πly_m©ch
)

1361 
m©ch
++;

1364 
exãnd_m©ch
:

1365 i‡(
	`CMD_OPTION
 (
°r
Ë|| 
	`CMD_VARIABLE
 (str))

1366 
m©ch
++;

1368 
no_m©ch
:

1373 i‡(!
m©ch
)

1374 
	`ve˘‹_¶Ÿ
 (
v
, 
i
Ë
NULL
;

1377 
	}
}

1381 
	$cmd_íåy_fun˘i⁄
 (c⁄° *
§c
, c⁄° *
d°
)

1384 i‡(
	`CMD_OPTION
 (
d°
Ë|| 
	`CMD_VARIABLE
 (d°Ë|| 
	`CMD_VARARG
 (dst) ||

1385 
	`CMD_IPV4
 (
d°
Ë|| 
	`CMD_IPV4_PREFIX
 (d°Ë|| 
	`CMD_RANGE
 (dst))

1386  
NULL
;

1389 i‡(
§c
 =
NULL
)

1390  
d°
;

1393 i‡(
	`°∫cmp
 (
§c
, 
d°
, 
	`°æí
 (src)) == 0)

1394  
d°
;

1396  
NULL
;

1397 
	}
}

1403 
	$cmd_íåy_fun˘i⁄_desc
 (c⁄° *
§c
, c⁄° *
d°
)

1405 i‡(
	`CMD_VARARG
 (
d°
))

1406  
d°
;

1408 i‡(
	`CMD_RANGE
 (
d°
))

1410 i‡(
	`cmd_ønge_m©ch
 (
d°
, 
§c
))

1411  
d°
;

1413  
NULL
;

1416 #ifde‡
HAVE_IPV6


1417 i‡(
	`CMD_IPV6
 (
d°
))

1419 i‡(
	`cmd_ùv6_m©ch
 (
§c
))

1420  
d°
;

1422  
NULL
;

1425 i‡(
	`CMD_IPV6_PREFIX
 (
d°
))

1427 i‡(
	`cmd_ùv6_¥efix_m©ch
 (
§c
))

1428  
d°
;

1430  
NULL
;

1434 i‡(
	`CMD_IPV4
 (
d°
))

1436 i‡(
	`cmd_ùv4_m©ch
 (
§c
))

1437  
d°
;

1439  
NULL
;

1442 i‡(
	`CMD_IPV4_PREFIX
 (
d°
))

1444 i‡(
	`cmd_ùv4_¥efix_m©ch
 (
§c
))

1445  
d°
;

1447  
NULL
;

1451 i‡(
	`CMD_OPTION
 (
d°
Ë|| 
	`CMD_VARIABLE
 (dst))

1452  
d°
;

1455 i‡(
§c
 =
NULL
)

1456  
d°
;

1458 i‡(
	`°∫cmp
 (
§c
, 
d°
, 
	`°æí
 (src)) == 0)

1459  
d°
;

1461  
NULL
;

1462 
	}
}

1467 
	$cmd_unique_°rög
 (
ve˘‹
 
v
, c⁄° *
°r
)

1469 
i
;

1470 *
m©ch
;

1472 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
v
); i++)

1473 i‡((
m©ch
 = 
	`ve˘‹_¶Ÿ
 (
v
, 
i
)Ë!
NULL
)

1474 i‡(
	`°rcmp
 (
m©ch
, 
°r
) == 0)

1477 
	}
}

1482 
	$desc_unique_°rög
 (
ve˘‹
 
v
, c⁄° *
°r
)

1484 
i
;

1485 
desc
 *desc;

1487 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
v
); i++)

1488 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
v
, 
i
)Ë!
NULL
)

1489 i‡(
	`°rcmp
 (
desc
->
cmd
, 
°r
) == 0)

1492 
	}
}

1495 
	$cmd_åy_do_sh‹tcut
 (
node_ty≥
 
node
, * 
fú°_w‹d
) {

1496 i‡–
fú°_w‹d
 !
NULL
 &&

1497 
node
 !
AUTH_NODE
 &&

1498 
node
 !
VIEW_NODE
 &&

1499 
node
 !
AUTH_ENABLE_NODE
 &&

1500 
node
 !
ENABLE_NODE
 &&

1501 
node
 !
RESTRICTED_NODE
 &&

1502 0 =
	`°rcmp
–"do", 
fú°_w‹d
 ) )

1505 
	}
}

1508 
ve˘‹


1509 
	$cmd_des¸ibe_comm™d_ªÆ
 (
ve˘‹
 
vlöe
, 
vty
 *vty, *
°©us
)

1511 
i
;

1512 
ve˘‹
 
cmd_ve˘‹
;

1513 
	#INIT_MATCHVEC_SIZE
 10

	)

1514 
ve˘‹
 
m©chvec
;

1515 
cmd_ñemít
 *cmd_element;

1516 
ödex
;

1517 
ªt
;

1518 
m©ch_ty≥
 
m©ch
;

1519 *
comm™d
;

1522 i‡(
	`ve˘‹_a˘ive
 (
vlöe
) == 0)

1524 *
°©us
 = 
CMD_ERR_NO_MATCH
;

1525  
NULL
;

1528 
ödex
 = 
	`ve˘‹_a˘ive
 (
vlöe
) - 1;

1531 
cmd_ve˘‹
 = 
	`ve˘‹_c›y
 (
	`cmd_node_ve˘‹
 (
cmdvec
, 
vty
->
node
));

1534 
m©chvec
 = 
	`ve˘‹_öô
 (
INIT_MATCHVEC_SIZE
);

1538 
i
 = 0; i < 
ödex
; i++)

1539 i‡((
comm™d
 = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
)))

1541 
m©ch
 = 
	`cmd_fûãr_by_com∂ëi⁄
 (
comm™d
, 
cmd_ve˘‹
, 
i
);

1543 i‡(
m©ch
 =
v¨¨g_m©ch
)

1545 
cmd_ñemít
 *cmd_element;

1546 
ve˘‹
 
descvec
;

1547 
j
, 
k
;

1549 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
cmd_ve˘‹
); j++)

1550 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
j
)Ë!
NULL


1551 && (
	`ve˘‹_a˘ive
 (
cmd_ñemít
->
°rvec
)))

1553 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ñemít
->
°rvec
,

1554 
	`ve˘‹_a˘ive
 (
cmd_ñemít
->
°rvec
) - 1);

1555 
k
 = 0; k < 
	`ve˘‹_a˘ive
 (
descvec
); k++)

1557 
desc
 *des¯
	`ve˘‹_¶Ÿ
 (
descvec
, 
k
);

1558 
	`ve˘‹_£t
 (
m©chvec
, 
desc
);

1562 
	`ve˘‹_£t
 (
m©chvec
, &
desc_¸
);

1563 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1565  
m©chvec
;

1568 i‡((
ªt
 = 
	`is_cmd_ambiguous
 (
comm™d
, 
cmd_ve˘‹
, 
i
, 
m©ch
)) == 1)

1570 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1571 
	`ve˘‹_‰ì
 (
m©chvec
);

1572 *
°©us
 = 
CMD_ERR_AMBIGUOUS
;

1573  
NULL
;

1575 i‡(
ªt
 == 2)

1577 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1578 
	`ve˘‹_‰ì
 (
m©chvec
);

1579 *
°©us
 = 
CMD_ERR_NO_MATCH
;

1580  
NULL
;

1588 
comm™d
 = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
);

1589 i‡(
comm™d
)

1590 
m©ch
 = 
	`cmd_fûãr_by_com∂ëi⁄
 (
comm™d
, 
cmd_ve˘‹
, 
ödex
);

1593 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
cmd_ve˘‹
); i++)

1594 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
i
)Ë!
NULL
)

1596 
ve˘‹
 
°rvec
 = 
cmd_ñemít
->strvec;

1599 i‡(
comm™d
 && 
ödex
 >
	`ve˘‹_a˘ive
 (
°rvec
))

1600 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
i
Ë
NULL
;

1604 i‡(
comm™d
 =
NULL
 && 
ödex
 =
	`ve˘‹_a˘ive
 (
°rvec
))

1606 i‡(!
	`desc_unique_°rög
 (
m©chvec
, 
comm™d_¸
))

1607 
	`ve˘‹_£t
 (
m©chvec
, &
desc_¸
);

1611 
j
;

1612 
ve˘‹
 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
°rvec
, 
ödex
);

1613 
desc
 *desc;

1615 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
descvec
); j++)

1616 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
descvec
, 
j
)))

1618 c⁄° *
°rög
;

1620 
°rög
 = 
	`cmd_íåy_fun˘i⁄_desc
 (
comm™d
, 
desc
->
cmd
);

1621 i‡(
°rög
)

1624 i‡(!
	`desc_unique_°rög
 (
m©chvec
, 
°rög
))

1625 
	`ve˘‹_£t
 (
m©chvec
, 
desc
);

1631 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1633 i‡(
	`ve˘‹_¶Ÿ
 (
m©chvec
, 0Ë=
NULL
)

1635 
	`ve˘‹_‰ì
 (
m©chvec
);

1636 *
°©us
 = 
CMD_ERR_NO_MATCH
;

1637  
NULL
;

1640 *
°©us
 = 
CMD_SUCCESS
;

1641  
m©chvec
;

1642 
	}
}

1644 
ve˘‹


1645 
	$cmd_des¸ibe_comm™d
 (
ve˘‹
 
vlöe
, 
vty
 *vty, *
°©us
)

1647 
ve˘‹
 
ªt
;

1649 i‡–
	`cmd_åy_do_sh‹tcut
(
vty
->
node
, 
	`ve˘‹_¶Ÿ
(
vlöe
, 0) ) )

1651 
node_ty≥
 
⁄ode
;

1652 
ve˘‹
 
shi·ed_vlöe
;

1653 
ödex
;

1655 
⁄ode
 = 
vty
->
node
;

1656 
vty
->
node
 = 
ENABLE_NODE
;

1659 
shi·ed_vlöe
 = 
	`ve˘‹_öô
 (
	`ve˘‹_cou¡
(
vlöe
));

1661 
ödex
 = 1; index < 
	`ve˘‹_a˘ive
 (
vlöe
); index++)

1663 
	`ve˘‹_£t_ödex
 (
shi·ed_vlöe
, 
ödex
-1, 
	`ve˘‹_lookup
(
vlöe
, index));

1666 
ªt
 = 
	`cmd_des¸ibe_comm™d_ªÆ
 (
shi·ed_vlöe
, 
vty
, 
°©us
);

1668 
	`ve˘‹_‰ì
(
shi·ed_vlöe
);

1669 
vty
->
node
 = 
⁄ode
;

1670  
ªt
;

1674  
	`cmd_des¸ibe_comm™d_ªÆ
 (
vlöe
, 
vty
, 
°©us
);

1675 
	}
}

1680 
	$cmd_lcd
 (**
m©ched
)

1682 
i
;

1683 
j
;

1684 
lcd
 = -1;

1685 *
s1
, *
s2
;

1686 
c1
, 
c2
;

1688 i‡(
m©ched
[0] =
NULL
 || matched[1] == NULL)

1691 
i
 = 1; 
m©ched
[i] !
NULL
; i++)

1693 
s1
 = 
m©ched
[
i
 - 1];

1694 
s2
 = 
m©ched
[
i
];

1696 
j
 = 0; (
c1
 = 
s1
[j]Ë&& (
c2
 = 
s2
[j]); j++)

1697 i‡(
c1
 !
c2
)

1700 i‡(
lcd
 < 0)

1701 
lcd
 = 
j
;

1704 i‡(
lcd
 > 
j
)

1705 
lcd
 = 
j
;

1708  
lcd
;

1709 
	}
}

1713 
	$cmd_com∂ëe_comm™d_ªÆ
 (
ve˘‹
 
vlöe
, 
vty
 *vty, *
°©us
)

1715 
i
;

1716 
ve˘‹
 
cmd_ve˘‹
 = 
	`ve˘‹_c›y
 (
	`cmd_node_ve˘‹
 (
cmdvec
, 
vty
->
node
));

1717 
	#INIT_MATCHVEC_SIZE
 10

	)

1718 
ve˘‹
 
m©chvec
;

1719 
cmd_ñemít
 *cmd_element;

1720 
ödex
;

1721 **
m©ch_°r
;

1722 
desc
 *desc;

1723 
ve˘‹
 
descvec
;

1724 *
comm™d
;

1725 
lcd
;

1727 i‡(
	`ve˘‹_a˘ive
 (
vlöe
) == 0)

1729 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1730 *
°©us
 = 
CMD_ERR_NO_MATCH
;

1731  
NULL
;

1734 
ödex
 = 
	`ve˘‹_a˘ive
 (
vlöe
) - 1;

1737 
i
 = 0; i < 
ödex
; i++)

1738 i‡((
comm™d
 = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
)))

1740 
m©ch_ty≥
 
m©ch
;

1741 
ªt
;

1744 
m©ch
 = 
	`cmd_fûãr_by_com∂ëi⁄
 (
comm™d
, 
cmd_ve˘‹
, 
i
);

1748 i‡((
ªt
 = 
	`is_cmd_ambiguous
 (
comm™d
, 
cmd_ve˘‹
, 
i
, 
m©ch
)) == 1)

1750 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1751 *
°©us
 = 
CMD_ERR_AMBIGUOUS
;

1752  
NULL
;

1765 
m©chvec
 = 
	`ve˘‹_öô
 (
INIT_MATCHVEC_SIZE
);

1768 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
cmd_ve˘‹
); i++)

1769 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
i
)))

1771 c⁄° *
°rög
;

1772 
ve˘‹
 
°rvec
 = 
cmd_ñemít
->strvec;

1775 i‡(
ödex
 >
	`ve˘‹_a˘ive
 (
°rvec
))

1776 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
i
Ë
NULL
;

1779 
j
;

1781 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
°rvec
, 
ödex
);

1782 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
descvec
); j++)

1783 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
descvec
, 
j
)))

1785 i‡((
°rög
 =

1786 
	`cmd_íåy_fun˘i⁄
 (
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
),

1787 
desc
->
cmd
)))

1788 i‡(
	`cmd_unique_°rög
 (
m©chvec
, 
°rög
))

1789 
	`ve˘‹_£t
 (
m©chvec
, 
	`XSTRDUP
 (
MTYPE_TMP
, 
°rög
));

1795 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1798 i‡(
	`ve˘‹_¶Ÿ
 (
m©chvec
, 0Ë=
NULL
)

1800 
	`ve˘‹_‰ì
 (
m©chvec
);

1804 i‡(
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
) == '\0')

1805 *
°©us
 = 
CMD_ERR_NOTHING_TODO
;

1807 *
°©us
 = 
CMD_ERR_NO_MATCH
;

1808  
NULL
;

1812 i‡(
	`ve˘‹_¶Ÿ
 (
m©chvec
, 1Ë=
NULL
)

1814 
m©ch_°r
 = (**Ë
m©chvec
->
ödex
;

1815 
	`ve˘‹_⁄ly_wøµî_‰ì
 (
m©chvec
);

1816 *
°©us
 = 
CMD_COMPLETE_FULL_MATCH
;

1817  
m©ch_°r
;

1820 
	`ve˘‹_£t
 (
m©chvec
, 
NULL
);

1823 i‡(
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
Ë!
NULL
)

1825 
lcd
 = 
	`cmd_lcd
 ((**Ë
m©chvec
->
ödex
);

1827 i‡(
lcd
)

1829 
Àn
 = 
	`°æí
 (
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
));

1831 i‡(
Àn
 < 
lcd
)

1833 *
lcd°r
;

1835 
lcd°r
 = 
	`XMALLOC
 (
MTYPE_STRVEC
, 
lcd
 + 1);

1836 
	`mem˝y
 (
lcd°r
, 
m©chvec
->
ödex
[0], 
lcd
);

1837 
lcd°r
[
lcd
] = '\0';

1842 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
m©chvec
); i++)

1844 i‡(
	`ve˘‹_¶Ÿ
 (
m©chvec
, 
i
))

1845 
	`XFREE
 (
MTYPE_STRVEC
, 
	`ve˘‹_¶Ÿ
 (
m©chvec
, 
i
));

1847 
	`ve˘‹_‰ì
 (
m©chvec
);

1850 
m©chvec
 = 
	`ve˘‹_öô
 (
INIT_MATCHVEC_SIZE
);

1851 
	`ve˘‹_£t
 (
m©chvec
, 
lcd°r
);

1852 
m©ch_°r
 = (**Ë
m©chvec
->
ödex
;

1853 
	`ve˘‹_⁄ly_wøµî_‰ì
 (
m©chvec
);

1855 *
°©us
 = 
CMD_COMPLETE_MATCH
;

1856  
m©ch_°r
;

1861 
m©ch_°r
 = (**Ë
m©chvec
->
ödex
;

1862 
	`ve˘‹_⁄ly_wøµî_‰ì
 (
m©chvec
);

1863 *
°©us
 = 
CMD_COMPLETE_LIST_MATCH
;

1864  
m©ch_°r
;

1865 
	}
}

1868 
	$cmd_com∂ëe_comm™d
 (
ve˘‹
 
vlöe
, 
vty
 *vty, *
°©us
)

1870 **
ªt
;

1872 i‡–
	`cmd_åy_do_sh‹tcut
(
vty
->
node
, 
	`ve˘‹_¶Ÿ
(
vlöe
, 0) ) )

1874 
node_ty≥
 
⁄ode
;

1875 
ve˘‹
 
shi·ed_vlöe
;

1876 
ödex
;

1878 
⁄ode
 = 
vty
->
node
;

1879 
vty
->
node
 = 
ENABLE_NODE
;

1882 
shi·ed_vlöe
 = 
	`ve˘‹_öô
 (
	`ve˘‹_cou¡
(
vlöe
));

1884 
ödex
 = 1; index < 
	`ve˘‹_a˘ive
 (
vlöe
); index++)

1886 
	`ve˘‹_£t_ödex
 (
shi·ed_vlöe
, 
ödex
-1, 
	`ve˘‹_lookup
(
vlöe
, index));

1889 
ªt
 = 
	`cmd_com∂ëe_comm™d_ªÆ
 (
shi·ed_vlöe
, 
vty
, 
°©us
);

1891 
	`ve˘‹_‰ì
(
shi·ed_vlöe
);

1892 
vty
->
node
 = 
⁄ode
;

1893  
ªt
;

1897  
	`cmd_com∂ëe_comm™d_ªÆ
 (
vlöe
, 
vty
, 
°©us
);

1898 
	}
}

1902 
node_ty≥


1903 
	$node_∑ª¡
 ( 
node_ty≥
 
node
 )

1905 
node_ty≥
 
ªt
;

1907 
	`as£π
 (
node
 > 
CONFIG_NODE
);

1909 
node
)

1911 
BGP_VPNV4_NODE
:

1912 
BGP_IPV4_NODE
:

1913 
BGP_IPV4M_NODE
:

1914 
BGP_IPV6_NODE
:

1915 
BGP_IPV6M_NODE
:

1916 
ªt
 = 
BGP_NODE
;

1918 
KEYCHAIN_KEY_NODE
:

1919 
ªt
 = 
KEYCHAIN_NODE
;

1922 
ªt
 = 
CONFIG_NODE
;

1925  
ªt
;

1926 
	}
}

1930 
	$cmd_execuã_comm™d_ªÆ
 (
ve˘‹
 
vlöe
, 
vty
 *vty,

1931 
cmd_ñemít
 **
cmd
)

1933 
i
;

1934 
ödex
;

1935 
ve˘‹
 
cmd_ve˘‹
;

1936 
cmd_ñemít
 *cmd_element;

1937 
cmd_ñemít
 *
m©ched_ñemít
;

1938 
m©ched_cou¡
, 
öcom∂ëe_cou¡
;

1939 
¨gc
;

1940 c⁄° *
¨gv
[
CMD_ARGC_MAX
];

1941 
m©ch_ty≥
 
m©ch
 = 0;

1942 
v¨Êag
;

1943 *
comm™d
;

1946 
cmd_ve˘‹
 = 
	`ve˘‹_c›y
 (
	`cmd_node_ve˘‹
 (
cmdvec
, 
vty
->
node
));

1948 
ödex
 = 0; index < 
	`ve˘‹_a˘ive
 (
vlöe
); index++)

1949 i‡((
comm™d
 = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
)))

1951 
ªt
;

1953 
m©ch
 = 
	`cmd_fûãr_by_com∂ëi⁄
 (
comm™d
, 
cmd_ve˘‹
, 
ödex
);

1955 i‡(
m©ch
 =
v¨¨g_m©ch
)

1958 
ªt
 = 
	`is_cmd_ambiguous
 (
comm™d
, 
cmd_ve˘‹
, 
ödex
, 
m©ch
);

1960 i‡(
ªt
 == 1)

1962 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1963  
CMD_ERR_AMBIGUOUS
;

1965 i‡(
ªt
 == 2)

1967 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1968  
CMD_ERR_NO_MATCH
;

1973 
m©ched_ñemít
 = 
NULL
;

1974 
m©ched_cou¡
 = 0;

1975 
öcom∂ëe_cou¡
 = 0;

1977 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
cmd_ve˘‹
); i++)

1978 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
i
)))

1980 i‡(
m©ch
 =
v¨¨g_m©ch
 || 
ödex
 >
cmd_ñemít
->
cmdsize
)

1982 
m©ched_ñemít
 = 
cmd_ñemít
;

1984 
	`¥ötf
 ("DEBUG: %s\n", 
cmd_ñemít
->
°rög
);

1986 
m©ched_cou¡
++;

1990 
öcom∂ëe_cou¡
++;

1995 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

1998 i‡(
m©ched_cou¡
 == 0)

2000 i‡(
öcom∂ëe_cou¡
)

2001  
CMD_ERR_INCOMPLETE
;

2003  
CMD_ERR_NO_MATCH
;

2006 i‡(
m©ched_cou¡
 > 1)

2007  
CMD_ERR_AMBIGUOUS
;

2010 
v¨Êag
 = 0;

2011 
¨gc
 = 0;

2013 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
vlöe
); i++)

2015 i‡(
v¨Êag
)

2016 
¨gv
[
¨gc
++] = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
);

2019 
ve˘‹
 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
m©ched_ñemít
->
°rvec
, 
i
);

2021 i‡(
	`ve˘‹_a˘ive
 (
descvec
) == 1)

2023 
desc
 *des¯
	`ve˘‹_¶Ÿ
 (
descvec
, 0);

2025 i‡(
	`CMD_VARARG
 (
desc
->
cmd
))

2026 
v¨Êag
 = 1;

2028 i‡(
v¨Êag
 || 
	`CMD_VARIABLE
 (
desc
->
cmd
Ë|| 
	`CMD_OPTION
 (desc->cmd))

2029 
¨gv
[
¨gc
++] = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
);

2032 
¨gv
[
¨gc
++] = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
);

2035 i‡(
¨gc
 >
CMD_ARGC_MAX
)

2036  
CMD_ERR_EXEED_ARGC_MAX
;

2040 i‡(
cmd
)

2041 *
cmd
 = 
m©ched_ñemít
;

2043 i‡(
m©ched_ñemít
->
d´m⁄
)

2044  
CMD_SUCCESS_DAEMON
;

2047  (*
m©ched_ñemít
->
func
Ë(m©ched_ñemít, 
vty
, 
¨gc
, 
¨gv
);

2048 
	}
}

2051 
	$cmd_execuã_comm™d
 (
ve˘‹
 
vlöe
, 
vty
 *vty, 
cmd_ñemít
 **
cmd
,

2052 
vtysh
) {

2053 
ªt
, 
ßved_ªt
, 
åõd
 = 0;

2054 
node_ty≥
 
⁄ode
, 
åy_node
;

2056 
⁄ode
 = 
åy_node
 = 
vty
->
node
;

2058 i‡–
	`cmd_åy_do_sh‹tcut
(
vty
->
node
, 
	`ve˘‹_¶Ÿ
(
vlöe
, 0) ) )

2060 
ve˘‹
 
shi·ed_vlöe
;

2061 
ödex
;

2063 
vty
->
node
 = 
ENABLE_NODE
;

2066 
shi·ed_vlöe
 = 
	`ve˘‹_öô
 (
	`ve˘‹_cou¡
(
vlöe
));

2068 
ödex
 = 1; index < 
	`ve˘‹_a˘ive
 (
vlöe
); index++)

2070 
	`ve˘‹_£t_ödex
 (
shi·ed_vlöe
, 
ödex
-1, 
	`ve˘‹_lookup
(
vlöe
, index));

2073 
ªt
 = 
	`cmd_execuã_comm™d_ªÆ
 (
shi·ed_vlöe
, 
vty
, 
cmd
);

2075 
	`ve˘‹_‰ì
(
shi·ed_vlöe
);

2076 
vty
->
node
 = 
⁄ode
;

2077  
ªt
;

2081 
ßved_ªt
 = 
ªt
 = 
	`cmd_execuã_comm™d_ªÆ
 (
vlöe
, 
vty
, 
cmd
);

2083 i‡(
vtysh
)

2084  
ßved_ªt
;

2087  
ªt
 !
CMD_SUCCESS
 &&Ñë !
CMD_WARNING


2088 && 
vty
->
node
 > 
CONFIG_NODE
 )

2090 
åy_node
 = 
	`node_∑ª¡
(try_node);

2091 
vty
->
node
 = 
åy_node
;

2092 
ªt
 = 
	`cmd_execuã_comm™d_ªÆ
 (
vlöe
, 
vty
, 
cmd
);

2093 
åõd
 = 1;

2094 i‡(
ªt
 =
CMD_SUCCESS
 ||Ñë =
CMD_WARNING
)

2097  
ªt
;

2102 i‡–
åõd
 )

2103 
vty
->
node
 = 
⁄ode
;

2104  
ßved_ªt
;

2105 
	}
}

2109 
	$cmd_execuã_comm™d_°ri˘
 (
ve˘‹
 
vlöe
, 
vty
 *vty,

2110 
cmd_ñemít
 **
cmd
)

2112 
i
;

2113 
ödex
;

2114 
ve˘‹
 
cmd_ve˘‹
;

2115 
cmd_ñemít
 *cmd_element;

2116 
cmd_ñemít
 *
m©ched_ñemít
;

2117 
m©ched_cou¡
, 
öcom∂ëe_cou¡
;

2118 
¨gc
;

2119 c⁄° *
¨gv
[
CMD_ARGC_MAX
];

2120 
v¨Êag
;

2121 
m©ch_ty≥
 
m©ch
 = 0;

2122 *
comm™d
;

2125 
cmd_ve˘‹
 = 
	`ve˘‹_c›y
 (
	`cmd_node_ve˘‹
 (
cmdvec
, 
vty
->
node
));

2127 
ödex
 = 0; index < 
	`ve˘‹_a˘ive
 (
vlöe
); index++)

2128 i‡((
comm™d
 = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
)))

2130 
ªt
;

2132 
m©ch
 = 
	`cmd_fûãr_by_°rög
 (
	`ve˘‹_¶Ÿ
 (
vlöe
, 
ödex
),

2133 
cmd_ve˘‹
, 
ödex
);

2136 i‡(
m©ch
 =
v¨¨g_m©ch
)

2139 
ªt
 = 
	`is_cmd_ambiguous
 (
comm™d
, 
cmd_ve˘‹
, 
ödex
, 
m©ch
);

2140 i‡(
ªt
 == 1)

2142 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

2143  
CMD_ERR_AMBIGUOUS
;

2145 i‡(
ªt
 == 2)

2147 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

2148  
CMD_ERR_NO_MATCH
;

2153 
m©ched_ñemít
 = 
NULL
;

2154 
m©ched_cou¡
 = 0;

2155 
öcom∂ëe_cou¡
 = 0;

2156 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
cmd_ve˘‹
); i++)

2157 i‡(
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
i
Ë!
NULL
)

2159 
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ve˘‹
, 
i
);

2161 i‡(
m©ch
 =
v¨¨g_m©ch
 || 
ödex
 >
cmd_ñemít
->
cmdsize
)

2163 
m©ched_ñemít
 = 
cmd_ñemít
;

2164 
m©ched_cou¡
++;

2167 
öcom∂ëe_cou¡
++;

2171 
	`ve˘‹_‰ì
 (
cmd_ve˘‹
);

2174 i‡(
m©ched_cou¡
 == 0)

2176 i‡(
öcom∂ëe_cou¡
)

2177  
CMD_ERR_INCOMPLETE
;

2179  
CMD_ERR_NO_MATCH
;

2182 i‡(
m©ched_cou¡
 > 1)

2183  
CMD_ERR_AMBIGUOUS
;

2186 
v¨Êag
 = 0;

2187 
¨gc
 = 0;

2189 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
vlöe
); i++)

2191 i‡(
v¨Êag
)

2192 
¨gv
[
¨gc
++] = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
);

2195 
ve˘‹
 
descvec
 = 
	`ve˘‹_¶Ÿ
 (
m©ched_ñemít
->
°rvec
, 
i
);

2197 i‡(
	`ve˘‹_a˘ive
 (
descvec
) == 1)

2199 
desc
 *des¯
	`ve˘‹_¶Ÿ
 (
descvec
, 0);

2201 i‡(
	`CMD_VARARG
 (
desc
->
cmd
))

2202 
v¨Êag
 = 1;

2204 i‡(
v¨Êag
 || 
	`CMD_VARIABLE
 (
desc
->
cmd
Ë|| 
	`CMD_OPTION
 (desc->cmd))

2205 
¨gv
[
¨gc
++] = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
);

2208 
¨gv
[
¨gc
++] = 
	`ve˘‹_¶Ÿ
 (
vlöe
, 
i
);

2211 i‡(
¨gc
 >
CMD_ARGC_MAX
)

2212  
CMD_ERR_EXEED_ARGC_MAX
;

2216 i‡(
cmd
)

2217 *
cmd
 = 
m©ched_ñemít
;

2219 i‡(
m©ched_ñemít
->
d´m⁄
)

2220  
CMD_SUCCESS_DAEMON
;

2223  (*
m©ched_ñemít
->
func
Ë(m©ched_ñemít, 
vty
, 
¨gc
, 
¨gv
);

2224 
	}
}

2228 
	$c⁄fig_‰om_fûe
 (
vty
 *vty, 
FILE
 *
Â
)

2230 
ªt
;

2231 
ve˘‹
 
vlöe
;

2233 
	`fgës
 (
vty
->
buf
, 
VTY_BUFSIZ
, 
Â
))

2235 
vlöe
 = 
	`cmd_make_°rvec
 (
vty
->
buf
);

2238 i‡(
vlöe
 =
NULL
)

2241 
ªt
 = 
	`cmd_execuã_comm™d_°ri˘
 (
vlöe
, 
vty
, 
NULL
);

2244 
ªt
 !
CMD_SUCCESS
 &&Ñë !
CMD_WARNING


2245 && 
ªt
 !
CMD_ERR_NOTHING_TODO
 && 
vty
->
node
 !
CONFIG_NODE
)

2247 
vty
->
node
 = 
	`node_∑ª¡
(vty->node);

2248 
ªt
 = 
	`cmd_execuã_comm™d_°ri˘
 (
vlöe
, 
vty
, 
NULL
);

2251 
	`cmd_‰ì_°rvec
 (
vlöe
);

2253 i‡(
ªt
 !
CMD_SUCCESS
 &&Ñë !
CMD_WARNING


2254 && 
ªt
 !
CMD_ERR_NOTHING_TODO
)

2255  
ªt
;

2257  
CMD_SUCCESS
;

2258 
	}
}

2261 
DEFUN
 (
c⁄fig_ãrmöÆ
,

2262 
c⁄fig_ãrmöÆ_cmd
,

2267 i‡(
vty_c⁄fig_lock
 (
vty
))

2268 
	gvty
->
	gnode
 = 
CONFIG_NODE
;

2271 
vty_out
 (
vty
, "VTY c⁄figuøti⁄ i†locked by othî VTY%s", 
VTY_NEWLINE
);

2272  
	gCMD_WARNING
;

2274  
	gCMD_SUCCESS
;

2278 
DEFUN
 (
íabÀ
,

2279 
c⁄fig_íabÀ_cmd
,

2284 i‡((
	gho°
.
	gíabÀ
 =
NULL
 && 
ho°
.
íabÀ_í¸y±
 == NULL) ||

2285 
vty
->
ty≥
 =
VTY_SHELL_SERV
)

2286 
vty
->
node
 = 
ENABLE_NODE
;

2288 
	gvty
->
	gnode
 = 
AUTH_ENABLE_NODE
;

2290  
	gCMD_SUCCESS
;

2294 
DEFUN
 (
dißbÀ
,

2295 
c⁄fig_dißbÀ_cmd
,

2299 i‡(
	gvty
->
	gnode
 =
ENABLE_NODE
)

2300 
vty
->
node
 = 
VIEW_NODE
;

2301  
	gCMD_SUCCESS
;

2305 
DEFUN
 (
c⁄fig_exô
,

2306 
c⁄fig_exô_cmd
,

2310 
	gvty
->
	gnode
)

2312 
	gVIEW_NODE
:

2313 
ENABLE_NODE
:

2314 
RESTRICTED_NODE
:

2315 i‡(
vty_shñl
 (
vty
))

2316 
exô
 (0);

2318 
	gvty
->
	g°©us
 = 
VTY_CLOSE
;

2320 
	gCONFIG_NODE
:

2321 
vty
->
node
 = 
ENABLE_NODE
;

2322 
vty_c⁄fig_u∆ock
 (
vty
);

2324 
	gINTERFACE_NODE
:

2325 
ZEBRA_NODE
:

2326 
BGP_NODE
:

2327 
RIP_NODE
:

2328 
RIPNG_NODE
:

2329 
BABEL_NODE
:

2330 
OSPF_NODE
:

2331 
OSPF6_NODE
:

2332 
ISIS_NODE
:

2333 
KEYCHAIN_NODE
:

2334 
MASC_NODE
:

2335 
RMAP_NODE
:

2336 
VTY_NODE
:

2337 
vty
->
node
 = 
CONFIG_NODE
;

2339 
	gBGP_VPNV4_NODE
:

2340 
BGP_IPV4_NODE
:

2341 
BGP_IPV4M_NODE
:

2342 
BGP_IPV6_NODE
:

2343 
BGP_IPV6M_NODE
:

2344 
vty
->
node
 = 
BGP_NODE
;

2346 
	gKEYCHAIN_KEY_NODE
:

2347 
vty
->
node
 = 
KEYCHAIN_NODE
;

2352  
	gCMD_SUCCESS
;

2356 
ALIAS
 (
c⁄fig_exô
,

2357 
c⁄fig_quô_cmd
,

2362 
DEFUN
 (
c⁄fig_íd
,

2363 
c⁄fig_íd_cmd
,

2367 
	gvty
->
	gnode
)

2369 
	gVIEW_NODE
:

2370 
ENABLE_NODE
:

2371 
RESTRICTED_NODE
:

2374 
	gCONFIG_NODE
:

2375 
INTERFACE_NODE
:

2376 
ZEBRA_NODE
:

2377 
RIP_NODE
:

2378 
RIPNG_NODE
:

2379 
BABEL_NODE
:

2380 
BGP_NODE
:

2381 
BGP_VPNV4_NODE
:

2382 
BGP_IPV4_NODE
:

2383 
BGP_IPV4M_NODE
:

2384 
BGP_IPV6_NODE
:

2385 
BGP_IPV6M_NODE
:

2386 
RMAP_NODE
:

2387 
OSPF_NODE
:

2388 
OSPF6_NODE
:

2389 
ISIS_NODE
:

2390 
KEYCHAIN_NODE
:

2391 
KEYCHAIN_KEY_NODE
:

2392 
MASC_NODE
:

2393 
VTY_NODE
:

2394 
vty_c⁄fig_u∆ock
 (
vty
);

2395 
	gvty
->
	gnode
 = 
ENABLE_NODE
;

2400  
	gCMD_SUCCESS
;

2404 
DEFUN
 (
show_vîsi⁄
,

2405 
show_vîsi⁄_cmd
,

2407 
SHOW_STR


2410 
vty_out
 (
vty
, "Quagg®%†(%s).%s", 
QUAGGA_VERSION
, 
ho°
.
«me
?host.name:"",

2411 
VTY_NEWLINE
);

2412 
vty_out
 (
vty
, "%s%s%s", 
QUAGGA_COPYRIGHT
, 
GIT_INFO
, 
VTY_NEWLINE
);

2414  
	gCMD_SUCCESS
;

2418 
DEFUN
 (
c⁄fig_hñp
,

2419 
c⁄fig_hñp_cmd
,

2423 
vty_out
 (
vty
,

2424 "Quagg®VTYÖrovide†adv™˚d hñ∞„©uª. Whí youÇìd hñp,%s\
áàthêcomm™dÜöê∂ó£Öªs†'?'.%s\
%s\
ÇŸhög m©ches,Åhêhñ∞li° wû»bêem±yánd you mu° backup%s\
É¡îögá '?' show†thêavaûabÀ o±i⁄s.%s\
 styÀ†o‡hñ∞¨ê¥ovided:%s\
1. FuŒ hñ∞i†avaûabÀ whí youáªÑódyÅÿíã∏a%s\
árgumíà”.g. 'show ?'Ë™d des¸ibe†óchÖossibÀ%s\
.%s\
2. P¨tü»hñ∞i†¥ovided whíá¿abbªvüãdárgumíài†íãªd%s\
 you w™àtÿknow wh©árgumít†m©chÅhêöput%s\
”.g. 'show me?'.)%s%s", 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE,

2436 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE, VTY_NEWLINE, VTY_NEWLINE,

2437 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE, VTY_NEWLINE, VTY_NEWLINE);

2438  
	gCMD_SUCCESS
;

2442 
DEFUN
 (
c⁄fig_li°
,

2443 
c⁄fig_li°_cmd
,

2447 
	gi
;

2448 
cmd_node
 *
	g˙ode
 = 
ve˘‹_¶Ÿ
 (
cmdvec
, 
vty
->
node
);

2449 
cmd_ñemít
 *
	gcmd
;

2451 
	gi
 = 0; i < 
ve˘‹_a˘ive
 (
˙ode
->
cmd_ve˘‹
); i++)

2452 i‡((
	gcmd
 = 
ve˘‹_¶Ÿ
 (
˙ode
->
cmd_ve˘‹
, 
i
)Ë!
NULL


2453 && !(
cmd
->
©å
 =
CMD_ATTR_DEPRECATED


2454 || 
cmd
->
©å
 =
CMD_ATTR_HIDDEN
))

2455 
vty_out
 (
vty
, " %s%s", 
cmd
->
°rög
,

2456 
VTY_NEWLINE
);

2457  
	gCMD_SUCCESS
;

2461 
DEFUN
 (
c⁄fig_wrôe_fûe
,

2462 
c⁄fig_wrôe_fûe_cmd
,

2467 
	gi
;

2468 
	gfd
;

2469 
cmd_node
 *
	gnode
;

2470 *
	gc⁄fig_fûe
;

2471 *
	gc⁄fig_fûe_tmp
 = 
NULL
;

2472 *
	gc⁄fig_fûe_ßv
 = 
NULL
;

2473 
	gªt
 = 
CMD_WARNING
;

2474 
vty
 *
	gfûe_vty
;

2477 i‡(
	gho°
.
	gc⁄fig
 =
NULL
)

2479 
vty_out
 (
vty
, "Can't saveÅo configuration file, using vtysh.%s",

2480 
VTY_NEWLINE
);

2481  
	gCMD_WARNING
;

2485 
	gc⁄fig_fûe
 = 
ho°
.
c⁄fig
;

2487 
	gc⁄fig_fûe_ßv
 =

2488 
XMALLOC
 (
MTYPE_TMP
, 
°æí
 (
c⁄fig_fûe
Ë+ såÀ¿(
CONF_BACKUP_EXT
) + 1);

2489 
°r˝y
 (
c⁄fig_fûe_ßv
, 
c⁄fig_fûe
);

2490 
°rˇt
 (
c⁄fig_fûe_ßv
, 
CONF_BACKUP_EXT
);

2493 
	gc⁄fig_fûe_tmp
 = 
XMALLOC
 (
MTYPE_TMP
, 
°æí
 (
c⁄fig_fûe
) + 8);

2494 
•rötf
 (
c⁄fig_fûe_tmp
, "%s.XXXXXX", 
c⁄fig_fûe
);

2497 
	gfd
 = 
mk°emp
 (
c⁄fig_fûe_tmp
);

2498 i‡(
	gfd
 < 0)

2500 
vty_out
 (
vty
, "C™'à›í c⁄figuøti⁄ fûê%s.%s", 
c⁄fig_fûe_tmp
,

2501 
VTY_NEWLINE
);

2502 
	gföished
;

2506 
	gfûe_vty
 = 
vty_√w
 ();

2507 
	gfûe_vty
->
	gfd
 = 
fd
;

2508 
	gfûe_vty
->
	gty≥
 = 
VTY_FILE
;

2511 
vty_out
 (
fûe_vty
, "!\n! Zebra configuration saved from vty\n! ");

2512 
vty_time_¥öt
 (
fûe_vty
, 1);

2513 
vty_out
 (
fûe_vty
, "!\n");

2515 
	gi
 = 0; i < 
ve˘‹_a˘ive
 (
cmdvec
); i++)

2516 i‡((
	gnode
 = 
ve˘‹_¶Ÿ
 (
cmdvec
, 
i
)Ë&&Çode->
	gfunc
)

2518 i‡((*
	gnode
->
	gfunc
Ë(
	gfûe_vty
))

2519 
vty_out
 (
fûe_vty
, "!\n");

2521 
vty_˛o£
 (
fûe_vty
);

2523 i‡(
u∆ök
 (
c⁄fig_fûe_ßv
) != 0)

2524 i‡(
î∫o
 !
ENOENT
)

2526 
vty_out
 (
vty
, "C™'àu∆ök backu∞c⁄figuøti⁄ fûê%s.%s", 
c⁄fig_fûe_ßv
,

2527 
VTY_NEWLINE
);

2528 
	gföished
;

2530 i‡(
lök
 (
c⁄fig_fûe
, 
c⁄fig_fûe_ßv
) != 0)

2532 
vty_out
 (
vty
, "C™'àbacku∞ﬁd c⁄figuøti⁄ fûê%s.%s", 
c⁄fig_fûe_ßv
,

2533 
VTY_NEWLINE
);

2534 
	gföished
;

2536 
sync
 ();

2537 i‡(
u∆ök
 (
c⁄fig_fûe
) != 0)

2539 
vty_out
 (
vty
, "C™'àu∆ök c⁄figuøti⁄ fûê%s.%s", 
c⁄fig_fûe
,

2540 
VTY_NEWLINE
);

2541 
	gföished
;

2543 i‡(
lök
 (
c⁄fig_fûe_tmp
, 
c⁄fig_fûe
) != 0)

2545 
vty_out
 (
vty
, "C™'àßvêc⁄figuøti⁄ fûê%s.%s", 
c⁄fig_fûe
,

2546 
VTY_NEWLINE
);

2547 
	gföished
;

2549 
sync
 ();

2551 i‡(
chmod
 (
c⁄fig_fûe
, 
CONFIGFILE_MASK
) != 0)

2553 
vty_out
 (
vty
, "Can't chmod configuration file %s: %s (%d).%s",

2554 
c⁄fig_fûe
, 
ß„_°ªº‹
(
î∫o
),Éºno, 
VTY_NEWLINE
);

2555 
	gföished
;

2558 
vty_out
 (
vty
, "C⁄figuøti⁄ savedÅÿ%s%s", 
c⁄fig_fûe
,

2559 
VTY_NEWLINE
);

2560 
	gªt
 = 
CMD_SUCCESS
;

2562 
	gföished
:

2563 
u∆ök
 (
c⁄fig_fûe_tmp
);

2564 
XFREE
 (
MTYPE_TMP
, 
c⁄fig_fûe_tmp
);

2565 
XFREE
 (
MTYPE_TMP
, 
c⁄fig_fûe_ßv
);

2566  
	gªt
;

2569 
ALIAS
 (
c⁄fig_wrôe_fûe
,

2570 
c⁄fig_wrôe_cmd
,

2574 
ALIAS
 (
c⁄fig_wrôe_fûe
,

2575 
c⁄fig_wrôe_mem‹y_cmd
,

2580 
ALIAS
 (
c⁄fig_wrôe_fûe
,

2581 
c›y_ru¬ögc⁄fig_°¨tupc⁄fig_cmd
,

2588 
DEFUN
 (
c⁄fig_wrôe_ãrmöÆ
,

2589 
c⁄fig_wrôe_ãrmöÆ_cmd
,

2594 
	gi
;

2595 
cmd_node
 *
	gnode
;

2597 i‡(
	gvty
->
	gty≥
 =
VTY_SHELL_SERV
)

2599 
i
 = 0; 
	gi
 < 
ve˘‹_a˘ive
 (
cmdvec
); i++)

2600 i‡((
	gnode
 = 
ve˘‹_¶Ÿ
 (
cmdvec
, 
i
)Ë&&Çode->
	gfunc
 &&Çode->
	gvtysh
)

2602 i‡((*
	gnode
->
	gfunc
Ë(
	gvty
))

2603 
vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

2608 
vty_out
 (
vty
, "%sCuºíàc⁄figuøti⁄:%s", 
VTY_NEWLINE
,

2609 
VTY_NEWLINE
);

2610 
vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

2612 
	gi
 = 0; i < 
ve˘‹_a˘ive
 (
cmdvec
); i++)

2613 i‡((
	gnode
 = 
ve˘‹_¶Ÿ
 (
cmdvec
, 
i
)Ë&&Çode->
	gfunc
)

2615 i‡((*
	gnode
->
	gfunc
Ë(
	gvty
))

2616 
vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

2618 
vty_out
 (
vty
, "íd%s",
VTY_NEWLINE
);

2620  
	gCMD_SUCCESS
;

2624 
ALIAS
 (
c⁄fig_wrôe_ãrmöÆ
,

2625 
show_ru¬ög_c⁄fig_cmd
,

2627 
SHOW_STR


2631 
DEFUN
 (
show_°¨tup_c⁄fig
,

2632 
show_°¨tup_c⁄fig_cmd
,

2634 
SHOW_STR


2637 
	gbuf
[
BUFSIZ
];

2638 
FILE
 *
	gc⁄Â
;

2640 
	gc⁄Â
 = 
f›í
 (
ho°
.
c⁄fig
, "r");

2641 i‡(
	gc⁄Â
 =
NULL
)

2643 
vty_out
 (
vty
, "Can't open configuration file [%s]%s",

2644 
ho°
.
c⁄fig
, 
VTY_NEWLINE
);

2645  
	gCMD_WARNING
;

2648 
fgës
 (
buf
, 
BUFSIZ
, 
c⁄Â
))

2650 *
	g˝
 = 
buf
;

2652 *
	g˝
 !'\r' && *
˝
 != '\n' && *cp != '\0')

2653 
˝
++;

2654 *
	g˝
 = '\0';

2656 
vty_out
 (
vty
, "%s%s", 
buf
, 
VTY_NEWLINE
);

2659 
f˛o£
 (
c⁄Â
);

2661  
	gCMD_SUCCESS
;

2665 
DEFUN
 (
c⁄fig_ho°«me
,

2666 
ho°«me_cmd
,

2671 i‡(!
ißÕha
((Ë*
¨gv
[0]))

2673 
vty_out
 (
vty
, "PÀa£ s≥cify såög sèπög wôháÕhabë%s", 
VTY_NEWLINE
);

2674  
	gCMD_WARNING
;

2677 i‡(
	gho°
.
	g«me
)

2678 
XFREE
 (
MTYPE_HOST
, 
ho°
.
«me
);

2680 
	gho°
.
	g«me
 = 
XSTRDUP
 (
MTYPE_HOST
, 
¨gv
[0]);

2681  
	gCMD_SUCCESS
;

2684 
DEFUN
 (
c⁄fig_no_ho°«me
,

2685 
no_ho°«me_cmd
,

2687 
NO_STR


2691 i‡(
	gho°
.
	g«me
)

2692 
XFREE
 (
MTYPE_HOST
, 
ho°
.
«me
);

2693 
	gho°
.
	g«me
 = 
NULL
;

2694  
	gCMD_SUCCESS
;

2698 
DEFUN
 (
c⁄fig_∑ssw‹d
, 
∑ssw‹d_cmd
,

2706 i‡(
	g¨gc
 == 0)

2708 
vty_out
 (
vty
, "PÀa£ s≥cifyÖassw‹d.%s", 
VTY_NEWLINE
);

2709  
	gCMD_WARNING
;

2712 i‡(
	g¨gc
 == 2)

2714 i‡(*
¨gv
[0] == '8')

2716 i‡(
ho°
.
∑ssw‹d
)

2717 
XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d
);

2718 
	gho°
.
	g∑ssw‹d
 = 
NULL
;

2719 i‡(
	gho°
.
	g∑ssw‹d_í¸y±
)

2720 
XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d_í¸y±
);

2721 
	gho°
.
	g∑ssw‹d_í¸y±
 = 
XSTRDUP
 (
MTYPE_HOST
, 
¨gv
[1]);

2722  
	gCMD_SUCCESS
;

2726 
vty_out
 (
vty
, "Unknow¿í¸y±i⁄Åy≥.%s", 
VTY_NEWLINE
);

2727  
	gCMD_WARNING
;

2731 i‡(!
iß um
 ((Ë*
¨gv
[0]))

2733 
vty_out
 (
vty
,

2734 "PÀa£ s≥cify såög sèπög wôháÕh™umîic%s", 
VTY_NEWLINE
);

2735  
	gCMD_WARNING
;

2738 i‡(
	gho°
.
	g∑ssw‹d
)

2739 
XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d
);

2740 
	gho°
.
	g∑ssw‹d
 = 
NULL
;

2742 i‡(
	gho°
.
	gí¸y±
)

2744 i‡(
	gho°
.
	g∑ssw‹d_í¸y±
)

2745 
XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d_í¸y±
);

2746 
	gho°
.
	g∑ssw‹d_í¸y±
 = 
XSTRDUP
 (
MTYPE_HOST
, 
zí¸y±
 (
¨gv
[0]));

2749 
	gho°
.
	g∑ssw‹d
 = 
XSTRDUP
 (
MTYPE_HOST
, 
¨gv
[0]);

2751  
	gCMD_SUCCESS
;

2754 
ALIAS
 (
c⁄fig_∑ssw‹d
, 
∑ssw‹d_ãxt_cmd
,

2760 
DEFUN
 (
c⁄fig_íabÀ_∑ssw‹d
, 
íabÀ_∑ssw‹d_cmd
,

2769 i‡(
	g¨gc
 == 0)

2771 
vty_out
 (
vty
, "PÀa£ s≥cifyÖassw‹d.%s", 
VTY_NEWLINE
);

2772  
	gCMD_WARNING
;

2776 i‡(
	g¨gc
 == 2)

2778 i‡(*
¨gv
[0] == '8')

2780 i‡(
ho°
.
íabÀ
)

2781 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ
);

2782 
	gho°
.
	gíabÀ
 = 
NULL
;

2784 i‡(
	gho°
.
	gíabÀ_í¸y±
)

2785 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ_í¸y±
);

2786 
	gho°
.
	gíabÀ_í¸y±
 = 
XSTRDUP
 (
MTYPE_HOST
, 
¨gv
[1]);

2788  
	gCMD_SUCCESS
;

2792 
vty_out
 (
vty
, "Unknow¿í¸y±i⁄Åy≥.%s", 
VTY_NEWLINE
);

2793  
	gCMD_WARNING
;

2797 i‡(!
iß um
 ((Ë*
¨gv
[0]))

2799 
vty_out
 (
vty
,

2800 "PÀa£ s≥cify såög sèπög wôháÕh™umîic%s", 
VTY_NEWLINE
);

2801  
	gCMD_WARNING
;

2804 i‡(
	gho°
.
	gíabÀ
)

2805 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ
);

2806 
	gho°
.
	gíabÀ
 = 
NULL
;

2809 i‡(
	gho°
.
	gí¸y±
)

2811 i‡(
	gho°
.
	gíabÀ_í¸y±
)

2812 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ_í¸y±
);

2813 
	gho°
.
	gíabÀ_í¸y±
 = 
XSTRDUP
 (
MTYPE_HOST
, 
zí¸y±
 (
¨gv
[0]));

2816 
	gho°
.
	gíabÀ
 = 
XSTRDUP
 (
MTYPE_HOST
, 
¨gv
[0]);

2818  
	gCMD_SUCCESS
;

2821 
ALIAS
 (
c⁄fig_íabÀ_∑ssw‹d
,

2822 
íabÀ_∑ssw‹d_ãxt_cmd
,

2829 
DEFUN
 (
no_c⁄fig_íabÀ_∑ssw‹d
, 
no_íabÀ_∑ssw‹d_cmd
,

2831 
NO_STR


2835 i‡(
	gho°
.
	gíabÀ
)

2836 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ
);

2837 
	gho°
.
	gíabÀ
 = 
NULL
;

2839 i‡(
	gho°
.
	gíabÀ_í¸y±
)

2840 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ_í¸y±
);

2841 
	gho°
.
	gíabÀ_í¸y±
 = 
NULL
;

2843  
	gCMD_SUCCESS
;

2846 
DEFUN
 (
£rvi˚_∑ssw‹d_í¸y±
,

2847 
£rvi˚_∑ssw‹d_í¸y±_cmd
,

2852 i‡(
	gho°
.
	gí¸y±
)

2853  
	gCMD_SUCCESS
;

2855 
	gho°
.
	gí¸y±
 = 1;

2857 i‡(
	gho°
.
	g∑ssw‹d
)

2859 i‡(
	gho°
.
	g∑ssw‹d_í¸y±
)

2860 
XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d_í¸y±
);

2861 
	gho°
.
	g∑ssw‹d_í¸y±
 = 
XSTRDUP
 (
MTYPE_HOST
, 
zí¸y±
 (
ho°
.
∑ssw‹d
));

2863 i‡(
	gho°
.
	gíabÀ
)

2865 i‡(
	gho°
.
	gíabÀ_í¸y±
)

2866 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ_í¸y±
);

2867 
	gho°
.
	gíabÀ_í¸y±
 = 
XSTRDUP
 (
MTYPE_HOST
, 
zí¸y±
 (
ho°
.
íabÀ
));

2870  
	gCMD_SUCCESS
;

2873 
DEFUN
 (
no_£rvi˚_∑ssw‹d_í¸y±
,

2874 
no_£rvi˚_∑ssw‹d_í¸y±_cmd
,

2876 
NO_STR


2880 i‡(! 
	gho°
.
	gí¸y±
)

2881  
	gCMD_SUCCESS
;

2883 
	gho°
.
	gí¸y±
 = 0;

2885 i‡(
	gho°
.
	g∑ssw‹d_í¸y±
)

2886 
XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d_í¸y±
);

2887 
	gho°
.
	g∑ssw‹d_í¸y±
 = 
NULL
;

2889 i‡(
	gho°
.
	gíabÀ_í¸y±
)

2890 
XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ_í¸y±
);

2891 
	gho°
.
	gíabÀ_í¸y±
 = 
NULL
;

2893  
	gCMD_SUCCESS
;

2896 
DEFUN
 (
c⁄fig_ãrmöÆ_Àngth
, 
c⁄fig_ãrmöÆ_Àngth_cmd
,

2902 
	glöes
;

2903 *
	gíd±r
 = 
NULL
;

2905 
	glöes
 = 
°πﬁ
 (
¨gv
[0], &
íd±r
, 10);

2906 i‡(
	glöes
 < 0 ||Üöe†> 512 || *
	gíd±r
 != '\0')

2908 
vty_out
 (
vty
, "Àngth i†mÆf‹med%s", 
VTY_NEWLINE
);

2909  
	gCMD_WARNING
;

2911 
	gvty
->
	glöes
 = 
löes
;

2913  
	gCMD_SUCCESS
;

2916 
DEFUN
 (
c⁄fig_ãrmöÆ_no_Àngth
, 
c⁄fig_ãrmöÆ_no_Àngth_cmd
,

2919 
NO_STR


2922 
	gvty
->
	glöes
 = -1;

2923  
	gCMD_SUCCESS
;

2926 
DEFUN
 (
£rvi˚_ãrmöÆ_Àngth
, 
£rvi˚_ãrmöÆ_Àngth_cmd
,

2932 
	glöes
;

2933 *
	gíd±r
 = 
NULL
;

2935 
	glöes
 = 
°πﬁ
 (
¨gv
[0], &
íd±r
, 10);

2936 i‡(
	glöes
 < 0 ||Üöe†> 512 || *
	gíd±r
 != '\0')

2938 
vty_out
 (
vty
, "Àngth i†mÆf‹med%s", 
VTY_NEWLINE
);

2939  
	gCMD_WARNING
;

2941 
	gho°
.
	glöes
 = 
löes
;

2943  
	gCMD_SUCCESS
;

2946 
DEFUN
 (
no_£rvi˚_ãrmöÆ_Àngth
, 
no_£rvi˚_ãrmöÆ_Àngth_cmd
,

2948 
NO_STR


2953 
	gho°
.
	glöes
 = -1;

2954  
	gCMD_SUCCESS
;

2957 
DEFUN_HIDDEN
 (
do_echo
,

2958 
echo_cmd
,

2963 *
	gmesßge
;

2965 
vty_out
 (
vty
, "%s%s", ((
mesßge
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 0)) ? message : ""),

2966 
VTY_NEWLINE
);

2967 i‡(
	gmesßge
)

2968 
XFREE
(
MTYPE_TMP
, 
mesßge
);

2969  
	gCMD_SUCCESS
;

2972 
DEFUN
 (
c⁄fig_logmsg
,

2973 
c⁄fig_logmsg_cmd
,

2974 "logmsg "
LOG_LEVELS
" .MESSAGE",

2976 
LOG_LEVEL_DESC


2979 
	gÀvñ
;

2980 *
	gmesßge
;

2982 i‡((
	gÀvñ
 = 
Àvñ_m©ch
(
¨gv
[0])Ë=
ZLOG_DISABLED
)

2983  
CMD_ERR_NO_MATCH
;

2985 
zlog
(
NULL
, 
Àvñ
, "%s", ((
mesßge
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 1)) ? message : ""));

2986 i‡(
	gmesßge
)

2987 
XFREE
(
MTYPE_TMP
, 
mesßge
);

2988  
	gCMD_SUCCESS
;

2991 
DEFUN
 (
show_loggög
,

2992 
show_loggög_cmd
,

2994 
SHOW_STR


2997 
zlog
 *
	gzl
 = 
zlog_deÁu…
;

2999 
vty_out
 (
vty
, "SyslogÜogging: ");

3000 i‡(
	gzl
->
	gmaxlvl
[
ZLOG_DEST_SYSLOG
] =
ZLOG_DISABLED
)

3001 
vty_out
 (
vty
, "disabled");

3003 
vty_out
 (
vty
, "level %s, facility %s, ident %s",

3004 
zlog_¥i‹ôy
[
zl
->
maxlvl
[
ZLOG_DEST_SYSLOG
]],

3005 
Ácûôy_«me
(
zl
->
Ácûôy
), zl->
idít
);

3006 
vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

3008 
vty_out
 (
vty
, "StdoutÜogging: ");

3009 i‡(
	gzl
->
	gmaxlvl
[
ZLOG_DEST_STDOUT
] =
ZLOG_DISABLED
)

3010 
vty_out
 (
vty
, "disabled");

3012 
vty_out
 (
vty
, "level %s",

3013 
zlog_¥i‹ôy
[
zl
->
maxlvl
[
ZLOG_DEST_STDOUT
]]);

3014 
vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

3016 
vty_out
 (
vty
, "MonitorÜogging: ");

3017 i‡(
	gzl
->
	gmaxlvl
[
ZLOG_DEST_MONITOR
] =
ZLOG_DISABLED
)

3018 
vty_out
 (
vty
, "disabled");

3020 
vty_out
 (
vty
, "level %s",

3021 
zlog_¥i‹ôy
[
zl
->
maxlvl
[
ZLOG_DEST_MONITOR
]]);

3022 
vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

3024 
vty_out
 (
vty
, "FileÜogging: ");

3025 i‡((
	gzl
->
	gmaxlvl
[
ZLOG_DEST_FILE
] =
ZLOG_DISABLED
) ||

3026 !
zl
->
Â
)

3027 
vty_out
 (
vty
, "disabled");

3029 
vty_out
 (
vty
, "level %s, filename %s",

3030 
zlog_¥i‹ôy
[
zl
->
maxlvl
[
ZLOG_DEST_FILE
]],

3031 
zl
->
fûíame
);

3032 
vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

3034 
vty_out
 (
vty
, "ProtocolÇame: %s%s",

3035 
zlog_¥Ÿo_«mes
[
zl
->
¥Ÿocﬁ
], 
VTY_NEWLINE
);

3036 
vty_out
 (
vty
, "RecordÖriority: %s%s",

3037 (
zl
->
ªc‹d_¥i‹ôy
 ? "íabÀd" : "dißbÀd"), 
VTY_NEWLINE
);

3038 
vty_out
 (
vty
, "TimestampÖrecision: %d%s",

3039 
zl
->
time°amp_¥ecisi⁄
, 
VTY_NEWLINE
);

3041  
	gCMD_SUCCESS
;

3044 
DEFUN
 (
c⁄fig_log_°dout
,

3045 
c⁄fig_log_°dout_cmd
,

3050 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_STDOUT
, 
zlog_deÁu…
->
deÁu…_lvl
);

3051  
	gCMD_SUCCESS
;

3054 
DEFUN
 (
c⁄fig_log_°dout_Àvñ
,

3055 
c⁄fig_log_°dout_Àvñ_cmd
,

3056 "log stdouà"
LOG_LEVELS
,

3059 
LOG_LEVEL_DESC
)

3061 
	gÀvñ
;

3063 i‡((
	gÀvñ
 = 
Àvñ_m©ch
(
¨gv
[0])Ë=
ZLOG_DISABLED
)

3064  
CMD_ERR_NO_MATCH
;

3065 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_STDOUT
, 
Àvñ
);

3066  
	gCMD_SUCCESS
;

3069 
DEFUN
 (
no_c⁄fig_log_°dout
,

3070 
no_c⁄fig_log_°dout_cmd
,

3072 
NO_STR


3077 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_STDOUT
, 
ZLOG_DISABLED
);

3078  
	gCMD_SUCCESS
;

3081 
DEFUN
 (
c⁄fig_log_m⁄ô‹
,

3082 
c⁄fig_log_m⁄ô‹_cmd
,

3087 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_MONITOR
, 
zlog_deÁu…
->
deÁu…_lvl
);

3088  
	gCMD_SUCCESS
;

3091 
DEFUN
 (
c⁄fig_log_m⁄ô‹_Àvñ
,

3092 
c⁄fig_log_m⁄ô‹_Àvñ_cmd
,

3093 "log m⁄ô‹ "
LOG_LEVELS
,

3096 
LOG_LEVEL_DESC
)

3098 
	gÀvñ
;

3100 i‡((
	gÀvñ
 = 
Àvñ_m©ch
(
¨gv
[0])Ë=
ZLOG_DISABLED
)

3101  
CMD_ERR_NO_MATCH
;

3102 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_MONITOR
, 
Àvñ
);

3103  
	gCMD_SUCCESS
;

3106 
DEFUN
 (
no_c⁄fig_log_m⁄ô‹
,

3107 
no_c⁄fig_log_m⁄ô‹_cmd
,

3109 
NO_STR


3114 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_MONITOR
, 
ZLOG_DISABLED
);

3115  
	gCMD_SUCCESS
;

3119 
	$£t_log_fûe
(
vty
 *vty, c⁄° *
‚ame
, 
logÀvñ
)

3121 
ªt
;

3122 *
p
 = 
NULL
;

3123 c⁄° *
fuŒ∑th
;

3126 i‡(! 
	`IS_DIRECTORY_SEP
 (*
‚ame
))

3128 
cwd
[
MAXPATHLEN
+1];

3129 
cwd
[
MAXPATHLEN
] = '\0';

3131 i‡(
	`gëcwd
 (
cwd
, 
MAXPATHLEN
Ë=
NULL
)

3133 
	`zlog_îr
 ("config_log_file: UnableÅoálloc mem!");

3134  
CMD_WARNING
;

3137 i‡–(
p
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
	`°æí
 (
cwd
Ë+ såÀ¿(
‚ame
) + 2))

3138 =
NULL
)

3140 
	`zlog_îr
 ("config_log_file: UnableÅoálloc mem!");

3141  
CMD_WARNING
;

3143 
	`•rötf
 (
p
, "%s/%s", 
cwd
, 
‚ame
);

3144 
fuŒ∑th
 = 
p
;

3147 
fuŒ∑th
 = 
‚ame
;

3149 
ªt
 = 
	`zlog_£t_fûe
 (
NULL
, 
fuŒ∑th
, 
logÀvñ
);

3151 i‡(
p
)

3152 
	`XFREE
 (
MTYPE_TMP
, 
p
);

3154 i‡(!
ªt
)

3156 
	`vty_out
 (
vty
, "ˇn'à›íÜogfûê%s\n", 
‚ame
);

3157  
CMD_WARNING
;

3160 i‡(
ho°
.
logfûe
)

3161 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
logfûe
);

3163 
ho°
.
logfûe
 = 
	`XSTRDUP
 (
MTYPE_HOST
, 
‚ame
);

3165  
CMD_SUCCESS
;

3166 
	}
}

3168 
DEFUN
 (
c⁄fig_log_fûe
,

3169 
c⁄fig_log_fûe_cmd
,

3175  
£t_log_fûe
(
vty
, 
¨gv
[0], 
zlog_deÁu…
->
deÁu…_lvl
);

3178 
DEFUN
 (
c⁄fig_log_fûe_Àvñ
,

3179 
c⁄fig_log_fûe_Àvñ_cmd
,

3180 "log fûêFILENAME "
LOG_LEVELS
,

3184 
LOG_LEVEL_DESC
)

3186 
	gÀvñ
;

3188 i‡((
	gÀvñ
 = 
Àvñ_m©ch
(
¨gv
[1])Ë=
ZLOG_DISABLED
)

3189  
CMD_ERR_NO_MATCH
;

3190  
£t_log_fûe
(
vty
, 
¨gv
[0], 
Àvñ
);

3193 
DEFUN
 (
no_c⁄fig_log_fûe
,

3194 
no_c⁄fig_log_fûe_cmd
,

3196 
NO_STR


3201 
zlog_ª£t_fûe
 (
NULL
);

3203 i‡(
	gho°
.
	glogfûe
)

3204 
XFREE
 (
MTYPE_HOST
, 
ho°
.
logfûe
);

3206 
	gho°
.
	glogfûe
 = 
NULL
;

3208  
	gCMD_SUCCESS
;

3211 
ALIAS
 (
no_c⁄fig_log_fûe
,

3212 
no_c⁄fig_log_fûe_Àvñ_cmd
,

3214 
NO_STR


3220 
DEFUN
 (
c⁄fig_log_sy¶og
,

3221 
c⁄fig_log_sy¶og_cmd
,

3226 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_SYSLOG
, 
zlog_deÁu…
->
deÁu…_lvl
);

3227  
	gCMD_SUCCESS
;

3230 
DEFUN
 (
c⁄fig_log_sy¶og_Àvñ
,

3231 
c⁄fig_log_sy¶og_Àvñ_cmd
,

3232 "log sy¶og "
LOG_LEVELS
,

3235 
LOG_LEVEL_DESC
)

3237 
	gÀvñ
;

3239 i‡((
	gÀvñ
 = 
Àvñ_m©ch
(
¨gv
[0])Ë=
ZLOG_DISABLED
)

3240  
CMD_ERR_NO_MATCH
;

3241 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_SYSLOG
, 
Àvñ
);

3242  
	gCMD_SUCCESS
;

3245 
DEFUN_DEPRECATED
 (
c⁄fig_log_sy¶og_Ácûôy
,

3246 
c⁄fig_log_sy¶og_Ácûôy_cmd
,

3247 "log sy¶og facûôy "
LOG_FACILITIES
,

3251 
LOG_FACILITY_DESC
)

3253 
	gÁcûôy
;

3255 i‡((
	gÁcûôy
 = 
Ácûôy_m©ch
(
¨gv
[0])) < 0)

3256  
CMD_ERR_NO_MATCH
;

3258 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_SYSLOG
, 
zlog_deÁu…
->
deÁu…_lvl
);

3259 
	gzlog_deÁu…
->
	gÁcûôy
 = 
Ácûôy
;

3260  
	gCMD_SUCCESS
;

3263 
DEFUN
 (
no_c⁄fig_log_sy¶og
,

3264 
no_c⁄fig_log_sy¶og_cmd
,

3266 
NO_STR


3271 
zlog_£t_Àvñ
 (
NULL
, 
ZLOG_DEST_SYSLOG
, 
ZLOG_DISABLED
);

3272  
	gCMD_SUCCESS
;

3275 
ALIAS
 (
no_c⁄fig_log_sy¶og
,

3276 
no_c⁄fig_log_sy¶og_Ácûôy_cmd
,

3277 "nÿlog sy¶og facûôy "
LOG_FACILITIES
,

3278 
NO_STR


3282 
LOG_FACILITY_DESC
)

3284 
DEFUN
 (
c⁄fig_log_Ácûôy
,

3285 
c⁄fig_log_Ácûôy_cmd
,

3286 "log facûôy "
LOG_FACILITIES
,

3289 
LOG_FACILITY_DESC
)

3291 
	gÁcûôy
;

3293 i‡((
	gÁcûôy
 = 
Ácûôy_m©ch
(
¨gv
[0])) < 0)

3294  
CMD_ERR_NO_MATCH
;

3295 
	gzlog_deÁu…
->
	gÁcûôy
 = 
Ácûôy
;

3296  
	gCMD_SUCCESS
;

3299 
DEFUN
 (
no_c⁄fig_log_Ácûôy
,

3300 
no_c⁄fig_log_Ácûôy_cmd
,

3302 
NO_STR


3307 
	gzlog_deÁu…
->
	gÁcûôy
 = 
LOG_DAEMON
;

3308  
	gCMD_SUCCESS
;

3311 
DEFUN_DEPRECATED
 (
c⁄fig_log_å≠
,

3312 
c⁄fig_log_å≠_cmd
,

3313 "logÅø∞"
LOG_LEVELS
,

3316 
LOG_LEVEL_DESC
)

3318 
	g√w_Àvñ
 ;

3319 
	gi
;

3321 i‡((
	g√w_Àvñ
 = 
Àvñ_m©ch
(
¨gv
[0])Ë=
ZLOG_DISABLED
)

3322  
CMD_ERR_NO_MATCH
;

3324 
	gzlog_deÁu…
->
	gdeÁu…_lvl
 = 
√w_Àvñ
;

3325 
	gi
 = 0; i < 
	gZLOG_NUM_DESTS
; i++)

3326 i‡(
	gzlog_deÁu…
->
	gmaxlvl
[
i
] !
ZLOG_DISABLED
)

3327 
zlog_deÁu…
->
maxlvl
[
i
] = 
√w_Àvñ
;

3328  
	gCMD_SUCCESS
;

3331 
DEFUN_DEPRECATED
 (
no_c⁄fig_log_å≠
,

3332 
no_c⁄fig_log_å≠_cmd
,

3334 
NO_STR


3339 
	gzlog_deÁu…
->
	gdeÁu…_lvl
 = 
LOG_DEBUG
;

3340  
	gCMD_SUCCESS
;

3343 
DEFUN
 (
c⁄fig_log_ªc‹d_¥i‹ôy
,

3344 
c⁄fig_log_ªc‹d_¥i‹ôy_cmd
,

3349 
	gzlog_deÁu…
->
	gªc‹d_¥i‹ôy
 = 1 ;

3350  
	gCMD_SUCCESS
;

3353 
DEFUN
 (
no_c⁄fig_log_ªc‹d_¥i‹ôy
,

3354 
no_c⁄fig_log_ªc‹d_¥i‹ôy_cmd
,

3356 
NO_STR


3360 
	gzlog_deÁu…
->
	gªc‹d_¥i‹ôy
 = 0 ;

3361  
	gCMD_SUCCESS
;

3364 
DEFUN
 (
c⁄fig_log_time°amp_¥ecisi⁄
,

3365 
c⁄fig_log_time°amp_¥ecisi⁄_cmd
,

3372 i‡(
	g¨gc
 != 1)

3374 
vty_out
 (
vty
, "Insufficõ¡árgumíts%s", 
VTY_NEWLINE
);

3375  
	gCMD_WARNING
;

3378 
VTY_GET_INTEGER_RANGE
("Timestamp Precision",

3379 
zlog_deÁu…
->
time°amp_¥ecisi⁄
, 
¨gv
[0], 0, 6);

3380  
	gCMD_SUCCESS
;

3383 
DEFUN
 (
no_c⁄fig_log_time°amp_¥ecisi⁄
,

3384 
no_c⁄fig_log_time°amp_¥ecisi⁄_cmd
,

3386 
NO_STR


3391 
	gzlog_deÁu…
->
	gtime°amp_¥ecisi⁄
 = 0 ;

3392  
	gCMD_SUCCESS
;

3395 
DEFUN
 (
b™√r_mŸd_fûe
,

3396 
b™√r_mŸd_fûe_cmd
,

3403 i‡(
	gho°
.
	gmŸdfûe
)

3404 
XFREE
 (
MTYPE_HOST
, 
ho°
.
mŸdfûe
);

3405 
	gho°
.
	gmŸdfûe
 = 
XSTRDUP
 (
MTYPE_HOST
, 
¨gv
[0]);

3407  
	gCMD_SUCCESS
;

3410 
DEFUN
 (
b™√r_mŸd_deÁu…
,

3411 
b™√r_mŸd_deÁu…_cmd
,

3417 
	gho°
.
	gmŸd
 = 
deÁu…_mŸd
;

3418  
	gCMD_SUCCESS
;

3421 
DEFUN
 (
no_b™√r_mŸd
,

3422 
no_b™√r_mŸd_cmd
,

3424 
NO_STR


3428 
	gho°
.
	gmŸd
 = 
NULL
;

3429 i‡(
	gho°
.
	gmŸdfûe
)

3430 
XFREE
 (
MTYPE_HOST
, 
ho°
.
mŸdfûe
);

3431 
	gho°
.
	gmŸdfûe
 = 
NULL
;

3432  
	gCMD_SUCCESS
;

3437 
	$ho°_c⁄fig_£t
 (*
fûíame
)

3439 i‡(
ho°
.
c⁄fig
)

3440 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
c⁄fig
);

3441 
ho°
.
c⁄fig
 = 
	`XSTRDUP
 (
MTYPE_HOST
, 
fûíame
);

3442 
	}
}

3445 
	$ö°Æl_deÁu…
 (
node_ty≥
 
node
)

3447 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_exô_cmd
);

3448 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_quô_cmd
);

3449 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_íd_cmd
);

3450 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_hñp_cmd
);

3451 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_li°_cmd
);

3453 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_wrôe_ãrmöÆ_cmd
);

3454 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_wrôe_fûe_cmd
);

3455 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_wrôe_mem‹y_cmd
);

3456 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_wrôe_cmd
);

3457 
	`ö°Æl_ñemít
 (
node
, &
show_ru¬ög_c⁄fig_cmd
);

3458 
	}
}

3462 
	$cmd_öô
 (
ãrmöÆ
)

3464 
comm™d_¸
 = 
	`XSTRDUP
(
MTYPE_STRVEC
, "<cr>");

3465 
desc_¸
.
cmd
 = 
comm™d_¸
;

3466 
desc_¸
.
°r
 = 
	`XSTRDUP
(
MTYPE_STRVEC
, "");

3469 
cmdvec
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

3472 
ho°
.
«me
 = 
NULL
;

3473 
ho°
.
∑ssw‹d
 = 
NULL
;

3474 
ho°
.
íabÀ
 = 
NULL
;

3475 
ho°
.
logfûe
 = 
NULL
;

3476 
ho°
.
c⁄fig
 = 
NULL
;

3477 
ho°
.
löes
 = -1;

3478 
ho°
.
mŸd
 = 
deÁu…_mŸd
;

3479 
ho°
.
mŸdfûe
 = 
NULL
;

3482 
	`ö°Æl_node
 (&
võw_node
, 
NULL
);

3483 
	`ö°Æl_node
 (&
íabÀ_node
, 
NULL
);

3484 
	`ö°Æl_node
 (&
auth_node
, 
NULL
);

3485 
	`ö°Æl_node
 (&
auth_íabÀ_node
, 
NULL
);

3486 
	`ö°Æl_node
 (&
ª°ri˘ed_node
, 
NULL
);

3487 
	`ö°Æl_node
 (&
c⁄fig_node
, 
c⁄fig_wrôe_ho°
);

3490 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_vîsi⁄_cmd
);

3491 i‡(
ãrmöÆ
)

3493 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_li°_cmd
);

3494 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_exô_cmd
);

3495 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_quô_cmd
);

3496 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_hñp_cmd
);

3497 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_íabÀ_cmd
);

3498 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_ãrmöÆ_Àngth_cmd
);

3499 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_ãrmöÆ_no_Àngth_cmd
);

3500 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_loggög_cmd
);

3501 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
echo_cmd
);

3503 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_li°_cmd
);

3504 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_exô_cmd
);

3505 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_quô_cmd
);

3506 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_hñp_cmd
);

3507 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_íabÀ_cmd
);

3508 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_ãrmöÆ_Àngth_cmd
);

3509 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_ãrmöÆ_no_Àngth_cmd
);

3510 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
echo_cmd
);

3513 i‡(
ãrmöÆ
)

3515 
	`ö°Æl_deÁu…
 (
ENABLE_NODE
);

3516 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
c⁄fig_dißbÀ_cmd
);

3517 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
c⁄fig_ãrmöÆ_cmd
);

3518 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
c›y_ru¬ögc⁄fig_°¨tupc⁄fig_cmd
);

3520 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_°¨tup_c⁄fig_cmd
);

3521 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_vîsi⁄_cmd
);

3523 i‡(
ãrmöÆ
)

3525 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
c⁄fig_ãrmöÆ_Àngth_cmd
);

3526 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
c⁄fig_ãrmöÆ_no_Àngth_cmd
);

3527 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_loggög_cmd
);

3528 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
echo_cmd
);

3529 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
c⁄fig_logmsg_cmd
);

3531 
	`ö°Æl_deÁu…
 (
CONFIG_NODE
);

3534 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ho°«me_cmd
);

3535 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ho°«me_cmd
);

3537 i‡(
ãrmöÆ
)

3539 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
∑ssw‹d_cmd
);

3540 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
∑ssw‹d_ãxt_cmd
);

3541 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
íabÀ_∑ssw‹d_cmd
);

3542 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
íabÀ_∑ssw‹d_ãxt_cmd
);

3543 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_íabÀ_∑ssw‹d_cmd
);

3545 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_°dout_cmd
);

3546 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_°dout_Àvñ_cmd
);

3547 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_°dout_cmd
);

3548 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_m⁄ô‹_cmd
);

3549 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_m⁄ô‹_Àvñ_cmd
);

3550 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_m⁄ô‹_cmd
);

3551 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_fûe_cmd
);

3552 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_fûe_Àvñ_cmd
);

3553 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_fûe_cmd
);

3554 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_fûe_Àvñ_cmd
);

3555 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_sy¶og_cmd
);

3556 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_sy¶og_Àvñ_cmd
);

3557 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_sy¶og_Ácûôy_cmd
);

3558 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_sy¶og_cmd
);

3559 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_sy¶og_Ácûôy_cmd
);

3560 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_Ácûôy_cmd
);

3561 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_Ácûôy_cmd
);

3562 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_å≠_cmd
);

3563 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_å≠_cmd
);

3564 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_ªc‹d_¥i‹ôy_cmd
);

3565 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_ªc‹d_¥i‹ôy_cmd
);

3566 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_log_time°amp_¥ecisi⁄_cmd
);

3567 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_c⁄fig_log_time°amp_¥ecisi⁄_cmd
);

3568 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
£rvi˚_∑ssw‹d_í¸y±_cmd
);

3569 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_£rvi˚_∑ssw‹d_í¸y±_cmd
);

3570 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
b™√r_mŸd_deÁu…_cmd
);

3571 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
b™√r_mŸd_fûe_cmd
);

3572 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_b™√r_mŸd_cmd
);

3573 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
£rvi˚_ãrmöÆ_Àngth_cmd
);

3574 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_£rvi˚_ãrmöÆ_Àngth_cmd
);

3576 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_thªad_˝u_cmd
);

3577 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_thªad_˝u_cmd
);

3578 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_thªad_˝u_cmd
);

3580 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_thªad_˝u_cmd
);

3581 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_w‹k_queues_cmd
);

3582 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_w‹k_queues_cmd
);

3584 
	`§™d
(
	`time
(
NULL
));

3585 
	}
}

3588 
	$cmd_ãrmö©e
 ()

3590 
i
, 
j
, 
k
, 
l
;

3591 
cmd_node
 *cmd_node;

3592 
cmd_ñemít
 *cmd_element;

3593 
desc
 *desc;

3594 
ve˘‹
 
cmd_node_v
, 
cmd_ñemít_v
, 
desc_v
;

3596 i‡(
cmdvec
)

3598 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
cmdvec
); i++)

3599 i‡((
cmd_node
 = 
	`ve˘‹_¶Ÿ
 (
cmdvec
, 
i
)Ë!
NULL
)

3601 
cmd_node_v
 = 
cmd_node
->
cmd_ve˘‹
;

3603 
j
 = 0; j < 
	`ve˘‹_a˘ive
 (
cmd_node_v
); j++)

3604 i‡((
cmd_ñemít
 = 
	`ve˘‹_¶Ÿ
 (
cmd_node_v
, 
j
)Ë!
NULL
 &&

3605 
cmd_ñemít
->
°rvec
 !
NULL
)

3607 
cmd_ñemít_v
 = 
cmd_ñemít
->
°rvec
;

3609 
k
 = 0; k < 
	`ve˘‹_a˘ive
 (
cmd_ñemít_v
); k++)

3610 i‡((
desc_v
 = 
	`ve˘‹_¶Ÿ
 (
cmd_ñemít_v
, 
k
)Ë!
NULL
)

3612 
l
 = 0;Ü < 
	`ve˘‹_a˘ive
 (
desc_v
);Ü++)

3613 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
desc_v
, 
l
)Ë!
NULL
)

3615 i‡(
desc
->
cmd
)

3616 
	`XFREE
 (
MTYPE_STRVEC
, 
desc
->
cmd
);

3617 i‡(
desc
->
°r
)

3618 
	`XFREE
 (
MTYPE_STRVEC
, 
desc
->
°r
);

3620 
	`XFREE
 (
MTYPE_DESC
, 
desc
);

3622 
	`ve˘‹_‰ì
 (
desc_v
);

3625 
cmd_ñemít
->
°rvec
 = 
NULL
;

3626 
	`ve˘‹_‰ì
 (
cmd_ñemít_v
);

3629 
	`ve˘‹_‰ì
 (
cmd_node_v
);

3632 
	`ve˘‹_‰ì
 (
cmdvec
);

3633 
cmdvec
 = 
NULL
;

3636 i‡(
comm™d_¸
)

3637 
	`XFREE
(
MTYPE_STRVEC
, 
comm™d_¸
);

3638 i‡(
desc_¸
.
°r
)

3639 
	`XFREE
(
MTYPE_STRVEC
, 
desc_¸
.
°r
);

3640 i‡(
ho°
.
«me
)

3641 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
«me
);

3642 i‡(
ho°
.
∑ssw‹d
)

3643 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d
);

3644 i‡(
ho°
.
∑ssw‹d_í¸y±
)

3645 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
∑ssw‹d_í¸y±
);

3646 i‡(
ho°
.
íabÀ
)

3647 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ
);

3648 i‡(
ho°
.
íabÀ_í¸y±
)

3649 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
íabÀ_í¸y±
);

3650 i‡(
ho°
.
logfûe
)

3651 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
logfûe
);

3652 i‡(
ho°
.
mŸdfûe
)

3653 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
mŸdfûe
);

3654 i‡(
ho°
.
c⁄fig
)

3655 
	`XFREE
 (
MTYPE_HOST
, 
ho°
.
c⁄fig
);

3656 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/command.h

23 #i‚de‡
_ZEBRA_COMMAND_H


24 
	#_ZEBRA_COMMAND_H


	)

26 
	~"ve˘‹.h
"

27 
	~"vty.h
"

28 
	~"lib/rouã_ty≥s.h
"

31 
	sho°


34 *
	m«me
;

37 *
	m∑ssw‹d
;

38 *
	m∑ssw‹d_í¸y±
;

41 *
	míabÀ
;

42 *
	míabÀ_í¸y±
;

45 
	mlöes
;

48 *
	mlogfûe
;

51 *
	mc⁄fig
;

54 
	madv™˚d
;

55 
	mí¸y±
;

58 c⁄° *
	mmŸd
;

59 *
	mmŸdfûe
;

63 
	enode_ty≥


65 
	mAUTH_NODE
,

66 
	mRESTRICTED_NODE
,

67 
	mVIEW_NODE
,

68 
	mAUTH_ENABLE_NODE
,

69 
	mENABLE_NODE
,

70 
	mCONFIG_NODE
,

71 
	mSERVICE_NODE
,

72 
	mDEBUG_NODE
,

73 
	mAAA_NODE
,

74 
	mKEYCHAIN_NODE
,

75 
	mKEYCHAIN_KEY_NODE
,

76 
	mINTERFACE_NODE
,

77 
	mZEBRA_NODE
,

78 
	mTABLE_NODE
,

79 
	mRIP_NODE
,

80 
	mRIPNG_NODE
,

81 
	mBABEL_NODE
,

82 
	mBGP_NODE
,

83 
	mBGP_VPNV4_NODE
,

84 
	mBGP_IPV4_NODE
,

85 
	mBGP_IPV4M_NODE
,

86 
	mBGP_IPV6_NODE
,

87 
	mBGP_IPV6M_NODE
,

88 
	mOSPF_NODE
,

89 
	mOSPF6_NODE
,

90 
	mISIS_NODE
,

91 
	mMASC_NODE
,

92 
	mIRDP_NODE
,

93 
	mIP_NODE
,

94 
	mACCESS_NODE
,

95 
	mPREFIX_NODE
,

96 
	mACCESS_IPV6_NODE
,

97 
	mPREFIX_IPV6_NODE
,

98 
	mAS_LIST_NODE
,

99 
	mCOMMUNITY_LIST_NODE
,

100 
	mRMAP_NODE
,

101 
	mSMUX_NODE
,

102 
	mDUMP_NODE
,

103 
	mFORWARDING_NODE
,

104 
	mPROTOCOL_NODE
,

105 
	mVTY_NODE
,

110 
	scmd_node


113 
node_ty≥
 
	mnode
;

116 c⁄° *
	m¥om±
;

119 
	mvtysh
;

122 (*
	mfunc
Ë(
	mvty
 *);

125 
ve˘‹
 
	mcmd_ve˘‹
;

130 
	mCMD_ATTR_DEPRECATED
 = 1,

131 
	mCMD_ATTR_HIDDEN
,

135 
	scmd_ñemít


137 c⁄° *
	m°rög
;

138 (*
	mfunc
Ë(
	mcmd_ñemít
 *, 
	mvty
 *, , const *[]);

139 c⁄° *
	mdoc
;

140 
	md´m⁄
;

141 
ve˘‹
 
	m°rvec
;

142 
	mcmdsize
;

143 *
	mc⁄fig
;

144 
ve˘‹
 
	msubc⁄fig
;

145 
u_ch¨
 
	m©å
;

149 
	sdesc


151 *
	mcmd
;

152 *
	m°r
;

156 
	#CMD_SUCCESS
 0

	)

157 
	#CMD_WARNING
 1

	)

158 
	#CMD_ERR_NO_MATCH
 2

	)

159 
	#CMD_ERR_AMBIGUOUS
 3

	)

160 
	#CMD_ERR_INCOMPLETE
 4

	)

161 
	#CMD_ERR_EXEED_ARGC_MAX
 5

	)

162 
	#CMD_ERR_NOTHING_TODO
 6

	)

163 
	#CMD_COMPLETE_FULL_MATCH
 7

	)

164 
	#CMD_COMPLETE_MATCH
 8

	)

165 
	#CMD_COMPLETE_LIST_MATCH
 9

	)

166 
	#CMD_SUCCESS_DAEMON
 10

	)

169 
	#CMD_ARGC_MAX
 25

	)

172 #i‚de‡
VTYSH_EXTRACT_PL


175 
	#DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
©ås
, 
dnum
) \

176 
cmd_ñemít
 
cmd«me
 = \

178 .
°rög
 = 
cmd°r
, \

179 .
func
 = 
fun˙ame
, \

180 .
doc
 = 
hñp°r
, \

181 .
©å
 = 
©ås
, \

182 .
d´m⁄
 = 
dnum
, \

183 };

	)

185 
	#DEFUN_CMD_FUNC_DECL
(
fun˙ame
) \

186 
	`fun˙ame
 (
cmd_ñemít
 *, 
vty
 *, , c⁄° *[]);

	)

188 
	#DEFUN_CMD_FUNC_TEXT
(
fun˙ame
) \

189 
fun˙ame
 \

190 (
cmd_ñemít
 *
£lf
 
	`__©åibuã__
 ((
unu£d
)), \

191 
vty
 *vty 
	`__©åibuã__
 ((
unu£d
)), \

192 
¨gc
 
	`__©åibuã__
 ((
unu£d
)), \

193 c⁄° *
¨gv
[] 
	`__©åibuã__
 ((
unu£d
)Ë)

	)

196 
	#DEFUN
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

197 
	`DEFUN_CMD_FUNC_DECL
(
fun˙ame
) \

198 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 0, 0) \

199 
	`DEFUN_CMD_FUNC_TEXT
(
fun˙ame
)

	)

201 
	#DEFUN_ATTR
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
©å
) \

202 
	`DEFUN_CMD_FUNC_DECL
(
fun˙ame
) \

203 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
©å
, 0) \

204 
	`DEFUN_CMD_FUNC_TEXT
(
fun˙ame
)

	)

206 
	#DEFUN_HIDDEN
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

207 
	`DEFUN_ATTR
 (
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_HIDDEN
)

	)

209 
	#DEFUN_DEPRECATED
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

210 
	`DEFUN_ATTR
 (
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_DEPRECATED
) \

211 

	)

213 
	#DEFUN_NOSH
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

214 
	`DEFUN
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
)

	)

217 
	#DEFSH
(
d´m⁄
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

218 
	`DEFUN_CMD_ELEMENT
(
NULL
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 0, 
d´m⁄
) \

219 

	)

221 
	#DEFUNSH
(
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

222 
	`DEFUN_CMD_FUNC_DECL
(
fun˙ame
) \

223 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 0, 
d´m⁄
) \

224 
	`DEFUN_CMD_FUNC_TEXT
(
fun˙ame
)

	)

227 
	#DEFUNSH_ATTR
(
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
©å
) \

228 
	`DEFUN_CMD_FUNC_DECL
(
fun˙ame
) \

229 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
©å
, 
d´m⁄
) \

230 
	`DEFUN_CMD_FUNC_TEXT
(
fun˙ame
)

	)

232 
	#DEFUNSH_HIDDEN
(
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

233 
	`DEFUNSH_ATTR
 (
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_HIDDEN
)

	)

235 
	#DEFUNSH_DEPRECATED
(
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

236 
	`DEFUNSH_ATTR
 (
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_DEPRECATED
)

	)

239 
	#ALIAS
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

240 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 0, 0)

	)

242 
	#ALIAS_ATTR
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
©å
) \

243 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
©å
, 0)

	)

245 
	#ALIAS_HIDDEN
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

246 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_HIDDEN
, 0)

	)

248 
	#ALIAS_DEPRECATED
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

249 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_DEPRECATED
, 0)

	)

251 
	#ALIAS_SH
(
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

252 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 0, 
d´m⁄
)

	)

254 
	#ALIAS_SH_HIDDEN
(
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

255 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_HIDDEN
, 
d´m⁄
)

	)

257 
	#ALIAS_SH_DEPRECATED
(
d´m⁄
, 
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
) \

258 
	`DEFUN_CMD_ELEMENT
(
fun˙ame
, 
cmd«me
, 
cmd°r
, 
hñp°r
, 
CMD_ATTR_DEPRECATED
, 
d´m⁄
)

	)

263 
	#CMD_OPTION
(
S
Ë((S[0]Ë='[')

	)

264 
	#CMD_VARIABLE
(
S
Ë(((S[0]Ë>'A' && (S[0]Ë<'Z'Ë|| ((S[0]Ë='<'))

	)

265 
	#CMD_VARARG
(
S
Ë((S[0]Ë='.')

	)

266 
	#CMD_RANGE
(
S
Ë((S[0] ='<'))

	)

268 
	#CMD_IPV4
(
S
Ë((
	`°rcmp
 ((S), "A.B.C.D"Ë=0))

	)

269 
	#CMD_IPV4_PREFIX
(
S
Ë((
	`°rcmp
 ((S), "A.B.C.D/M"Ë=0))

	)

270 
	#CMD_IPV6
(
S
Ë((
	`°rcmp
 ((S), "X:X::X:X"Ë=0))

	)

271 
	#CMD_IPV6_PREFIX
(
S
Ë((
	`°rcmp
 ((S), "X:X::X:X/M"Ë=0))

	)

274 
	#SHOW_STR
 "ShowÑu¬ög sy°em inf‹m©i⁄\n"

	)

275 
	#IP_STR
 "IP inf‹m©i⁄\n"

	)

276 
	#IPV6_STR
 "IPv6 inf‹m©i⁄\n"

	)

277 
	#NO_STR
 "Neg©ê®comm™d o∏£àô†deÁu…s\n"

	)

278 
	#REDIST_STR
 "Redi°ribuã inf‹m©i⁄ frománŸhîÑoutögÖrŸocﬁ\n"

	)

279 
	#CLEAR_STR
 "Re£àfun˘i⁄s\n"

	)

280 
	#RIP_STR
 "RIP inf‹m©i⁄\n"

	)

281 
	#BGP_STR
 "BGP inf‹m©i⁄\n"

	)

282 
	#OSPF_STR
 "OSPF inf‹m©i⁄\n"

	)

283 
	#NEIGHBOR_STR
 "S≥cifyÇeighb‹Ñouãr\n"

	)

284 
	#DEBUG_STR
 "Debuggög fun˘i⁄†(£êÆsÿ'undebug')\n"

	)

285 
	#UNDEBUG_STR
 "DißbÀ debuggög fun˘i⁄†(£êÆsÿ'debug')\n"

	)

286 
	#ROUTER_STR
 "E«bÀáÑoutögÖro˚ss\n"

	)

287 
	#AS_STR
 "ASÇumbî\n"

	)

288 
	#MBGP_STR
 "MBGP inf‹m©i⁄\n"

	)

289 
	#MATCH_STR
 "M©ch vÆue†‰omÑoutögÅabÀ\n"

	)

290 
	#SET_STR
 "Së vÆue†ö de°ö©i⁄ÑoutögÖrŸocﬁ\n"

	)

291 
	#OUT_STR
 "Fûã∏outgoögÑoutög upd©es\n"

	)

292 
	#IN_STR
 "Fûã∏öcomögÑoutög upd©es\n"

	)

293 
	#V4NOTATION_STR
 "•ecify by IPv4áddªs†nŸ©i⁄”.g. 0.0.0.0)\n"

	)

294 
	#OSPF6_NUMBER_STR
 "S≥cify byÇumbî\n"

	)

295 
	#INTERFACE_STR
 "I¡îÁ˚ infom©i⁄\n"

	)

296 
	#IFNAME_STR
 "I¡îÁ˚Çame”.g.Ép0)\n"

	)

297 
	#IP6_STR
 "IPv6 Inf‹m©i⁄\n"

	)

298 
	#OSPF6_STR
 "O≥¿Sh‹ã° P©h Fú° (OSPFËf‹ IPv6\n"

	)

299 
	#OSPF6_ROUTER_STR
 "E«bÀáÑoutögÖro˚ss\n"

	)

300 
	#OSPF6_INSTANCE_STR
 "<1-65535> In°™˚ ID\n"

	)

301 
	#SECONDS_STR
 "<1-65535> Sec⁄ds\n"

	)

302 
	#ROUTE_STR
 "Routög TabÀ\n"

	)

303 
	#PREFIX_LIST_STR
 "BuûdáÖªfixÜi°\n"

	)

304 
	#OSPF6_DUMP_TYPE_LIST
 \

305 "“eighb‹|öãrÁ˚|¨ó|lß|zebø|c⁄fig|dbex|•f|rouã|lsdb|ªdi°ribuã|hook|asbr|¥efix|abr)"

	)

306 
	#ISIS_STR
 "IS-IS inf‹m©i⁄\n"

	)

307 
	#AREA_TAG_STR
 "[¨óÅag]\n"

	)

309 
	#CONF_BACKUP_EXT
 ".ßv"

	)

313 #ifde‡
HAVE_IPV6


314 
	#NEIGHBOR_CMD
 "√ighb‹ (A.B.C.D|X:X::X:XË"

	)

315 
	#NO_NEIGHBOR_CMD
 "nÿ√ighb‹ (A.B.C.D|X:X::X:XË"

	)

316 
	#NEIGHBOR_ADDR_STR
 "Neighb‹áddªss\nIPv6áddªss\n"

	)

317 
	#NEIGHBOR_CMD2
 "√ighb‹ (A.B.C.D|X:X::X:X|WORDË"

	)

318 
	#NO_NEIGHBOR_CMD2
 "nÿ√ighb‹ (A.B.C.D|X:X::X:X|WORDË"

	)

319 
	#NEIGHBOR_ADDR_STR2
 "Neighb‹áddªss\nNeighb‹ IPv6áddªss\nNeighb‹Åag\n"

	)

321 
	#NEIGHBOR_CMD
 "√ighb‹ A.B.C.D "

	)

322 
	#NO_NEIGHBOR_CMD
 "nÿ√ighb‹ A.B.C.D "

	)

323 
	#NEIGHBOR_ADDR_STR
 "Neighb‹áddªss\n"

	)

324 
	#NEIGHBOR_CMD2
 "√ighb‹ (A.B.C.D|WORDË"

	)

325 
	#NO_NEIGHBOR_CMD2
 "nÿ√ighb‹ (A.B.C.D|WORDË"

	)

326 
	#NEIGHBOR_ADDR_STR2
 "Neighb‹áddªss\nNeighb‹Åag\n"

	)

330 
ö°Æl_node
 (
cmd_node
 *, (*Ë(
vty
 *));

331 
	`ö°Æl_deÁu…
 (
node_ty≥
);

332 
	`ö°Æl_ñemít
 (
node_ty≥
, 
cmd_ñemít
 *);

333 
	`s‹t_node
 ();

338 *
	`¨gv_c⁄ˇt
 (c⁄° **
¨gv
, 
¨gc
, 
shi·
);

340 
ve˘‹
 
	`cmd_make_°rvec
 (const *);

341 
	`cmd_‰ì_°rvec
 (
ve˘‹
);

342 
ve˘‹
 
	`cmd_des¸ibe_comm™d
 (ve˘‹, 
vty
 *, *
°©us
);

343 **
	`cmd_com∂ëe_comm™d
 (
ve˘‹
, 
vty
 *, *
°©us
);

344 c⁄° *
	`cmd_¥om±
 (
node_ty≥
);

345 
	`c⁄fig_‰om_fûe
 (
vty
 *, 
FILE
 *);

346 
node_ty≥
 
	`node_∑ª¡
 (node_type);

347 
	`cmd_execuã_comm™d
 (
ve˘‹
, 
vty
 *, 
cmd_ñemít
 **, );

348 
	`cmd_execuã_comm™d_°ri˘
 (
ve˘‹
, 
vty
 *, 
cmd_ñemít
 **);

349 
	`c⁄fig_ª∂a˚_°rög
 (
cmd_ñemít
 *, *, ...);

350 
	`cmd_öô
 ();

351 
	`cmd_ãrmö©e
 ();

354 
cmd_ñemít
 
c⁄fig_íd_cmd
;

355 
cmd_ñemít
 
c⁄fig_exô_cmd
;

356 
cmd_ñemít
 
c⁄fig_quô_cmd
;

357 
cmd_ñemít
 
c⁄fig_hñp_cmd
;

358 
cmd_ñemít
 
c⁄fig_li°_cmd
;

359 *
	`ho°_c⁄fig_fûe
 ();

360 
	`ho°_c⁄fig_£t
 (*);

362 
	`¥öt_vîsi⁄
 (const *);

365 
ho°
 host;

368 *
comm™d_¸
;

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/daemon.c

23 
	~<zebø.h
>

24 
	~<log.h
>

26 #i‚de‡
HAVE_DAEMON


30 
	$d´m⁄
 (
nochdú
, 
no˛o£
)

32 
pid_t
 
pid
;

34 
pid
 = 
	`f‹k
 ();

37 i‡(
pid
 < 0)

39 
	`zlog_îr
 ("f‹k faûed: %s", 
	`ß„_°ªº‹
(
î∫o
));

44 i‡(
pid
 != 0)

45 
	`exô
 (0);

48 
pid
 = 
	`£tsid
();

50 i‡(
pid
 == -1)

52 
	`zlog_îr
 ("£tsid faûed: %s", 
	`ß„_°ªº‹
(
î∫o
));

57 i‡(! 
nochdú
)

58 
	`chdú
 ("/");

61 i‡(! 
no˛o£
)

63 
fd
;

65 
fd
 = 
	`›í
 ("/dev/nuŒ", 
O_RDWR
, 0);

66 i‡(
fd
 != -1)

68 
	`dup2
 (
fd
, 
STDIN_FILENO
);

69 
	`dup2
 (
fd
, 
STDOUT_FILENO
);

70 
	`dup2
 (
fd
, 
STDERR_FILENO
);

71 i‡(
fd
 > 2)

72 
	`˛o£
 (
fd
);

76 
	`umask
 (0027);

79 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/distribute.c

22 
	~<zebø.h
>

24 
	~"hash.h
"

25 
	~"if.h
"

26 
	~"fûãr.h
"

27 
	~"comm™d.h
"

28 
	~"di°ribuã.h
"

29 
	~"mem‹y.h
"

32 
hash
 *
	gdi°hash
;

35 (*
di°ribuã_add_hook
Ë(
di°ribuã
 *);

36 (*
di°ribuã_dñëe_hook
Ë(
di°ribuã
 *);

38 
di°ribuã
 *

39 
	$di°ribuã_√w
 ()

41  
	`XCALLOC
 (
MTYPE_DISTRIBUTE
,  (
di°ribuã
));

42 
	}
}

46 
	$di°ribuã_‰ì
 (
di°ribuã
 *
di°
)

48 i‡(
di°
->
i‚ame
)

49 
	`XFREE
 (
MTYPE_DISTRIBUTE_IFNAME
, 
di°
->
i‚ame
);

51 i‡(
di°
->
li°
[
DISTRIBUTE_IN
])

52 
	`‰ì
 (
di°
->
li°
[
DISTRIBUTE_IN
]);

53 i‡(
di°
->
li°
[
DISTRIBUTE_OUT
])

54 
	`‰ì
 (
di°
->
li°
[
DISTRIBUTE_OUT
]);

56 i‡(
di°
->
¥efix
[
DISTRIBUTE_IN
])

57 
	`‰ì
 (
di°
->
¥efix
[
DISTRIBUTE_IN
]);

58 i‡(
di°
->
¥efix
[
DISTRIBUTE_OUT
])

59 
	`‰ì
 (
di°
->
¥efix
[
DISTRIBUTE_OUT
]);

61 
	`XFREE
 (
MTYPE_DISTRIBUTE
, 
di°
);

62 
	}
}

65 
di°ribuã
 *

66 
	$di°ribuã_lookup
 (c⁄° *
i‚ame
)

68 
di°ribuã
 
key
;

69 
di°ribuã
 *
di°
;

72 
key
.
i‚ame
 = (*)ifname;

74 
di°
 = 
	`hash_lookup
 (
di°hash
, &
key
);

76  
di°
;

77 
	}
}

80 
di°ribuã_li°_add_hook
 ((*
func
Ë(
di°ribuã
 *))

82 
di°ribuã_add_hook
 = 
func
;

83 
	}
}

86 
di°ribuã_li°_dñëe_hook
 ((*
func
Ë(
di°ribuã
 *))

88 
di°ribuã_dñëe_hook
 = 
func
;

89 
	}
}

92 
	$di°ribuã_hash_Æloc
 (
di°ribuã
 *
¨g
)

94 
di°ribuã
 *
di°
;

96 
di°
 = 
	`di°ribuã_√w
 ();

97 i‡(
¨g
->
i‚ame
)

98 
di°
->
i‚ame
 = 
	`XSTRDUP
 (
MTYPE_DISTRIBUTE_IFNAME
, 
¨g
->ifname);

100 
di°
->
i‚ame
 = 
NULL
;

101  
di°
;

102 
	}
}

105 
di°ribuã
 *

106 
	$di°ribuã_gë
 (c⁄° *
i‚ame
)

108 
di°ribuã
 
key
;

111 
key
.
i‚ame
 = (*)ifname;

113  
	`hash_gë
 (
di°hash
, &
key
, (* (*Ë(*))
di°ribuã_hash_Æloc
);

114 
	}
}

117 
	$di°ribuã_hash_make
 (*
¨g
)

119 c⁄° 
di°ribuã
 *
di°
 = 
¨g
;

121  
di°
->
i‚ame
 ? 
	`°rög_hash_make
 (dist->ifname) : 0;

122 
	}
}

127 
	$di°ribuã_cmp
 (c⁄° 
di°ribuã
 *
di°1
, c⁄° di°ribuã *
di°2
)

129 i‡(
di°1
->
i‚ame
 && 
di°2
->ifname)

130 i‡(
	`°rcmp
 (
di°1
->
i‚ame
, 
di°2
->ifname) == 0)

132 i‡(! 
di°1
->
i‚ame
 && ! 
di°2
->ifname)

135 
	}
}

138 
di°ribuã
 *

139 
	$di°ribuã_li°_£t
 (c⁄° *
i‚ame
, 
di°ribuã_ty≥
 
ty≥
,

140 c⁄° *
Æi°_«me
)

142 
di°ribuã
 *
di°
;

144 
di°
 = 
	`di°ribuã_gë
 (
i‚ame
);

146 i‡(
ty≥
 =
DISTRIBUTE_IN
)

148 i‡(
di°
->
li°
[
DISTRIBUTE_IN
])

149 
	`‰ì
 (
di°
->
li°
[
DISTRIBUTE_IN
]);

150 
di°
->
li°
[
DISTRIBUTE_IN
] = 
	`°rdup
 (
Æi°_«me
);

152 i‡(
ty≥
 =
DISTRIBUTE_OUT
)

154 i‡(
di°
->
li°
[
DISTRIBUTE_OUT
])

155 
	`‰ì
 (
di°
->
li°
[
DISTRIBUTE_OUT
]);

156 
di°
->
li°
[
DISTRIBUTE_OUT
] = 
	`°rdup
 (
Æi°_«me
);

160 (*
di°ribuã_add_hook
Ë(
di°
);

162  
di°
;

163 
	}
}

168 
	$di°ribuã_li°_un£t
 (c⁄° *
i‚ame
, 
di°ribuã_ty≥
 
ty≥
,

169 c⁄° *
Æi°_«me
)

171 
di°ribuã
 *
di°
;

173 
di°
 = 
	`di°ribuã_lookup
 (
i‚ame
);

174 i‡(!
di°
)

177 i‡(
ty≥
 =
DISTRIBUTE_IN
)

179 i‡(!
di°
->
li°
[
DISTRIBUTE_IN
])

181 i‡(
	`°rcmp
 (
di°
->
li°
[
DISTRIBUTE_IN
], 
Æi°_«me
) != 0)

184 
	`‰ì
 (
di°
->
li°
[
DISTRIBUTE_IN
]);

185 
di°
->
li°
[
DISTRIBUTE_IN
] = 
NULL
;

188 i‡(
ty≥
 =
DISTRIBUTE_OUT
)

190 i‡(!
di°
->
li°
[
DISTRIBUTE_OUT
])

192 i‡(
	`°rcmp
 (
di°
->
li°
[
DISTRIBUTE_OUT
], 
Æi°_«me
) != 0)

195 
	`‰ì
 (
di°
->
li°
[
DISTRIBUTE_OUT
]);

196 
di°
->
li°
[
DISTRIBUTE_OUT
] = 
NULL
;

200 (*
di°ribuã_dñëe_hook
Ë(
di°
);

203 i‡(
di°
->
li°
[
DISTRIBUTE_IN
] =
NULL
 &&

204 
di°
->
li°
[
DISTRIBUTE_OUT
] =
NULL
 &&

205 
di°
->
¥efix
[
DISTRIBUTE_IN
] =
NULL
 &&

206 
di°
->
¥efix
[
DISTRIBUTE_OUT
] =
NULL
)

208 
	`hash_ªÀa£
 (
di°hash
, 
di°
);

209 
	`di°ribuã_‰ì
 (
di°
);

213 
	}
}

216 
di°ribuã
 *

217 
	$di°ribuã_li°_¥efix_£t
 (c⁄° *
i‚ame
, 
di°ribuã_ty≥
 
ty≥
,

218 c⁄° *
∂i°_«me
)

220 
di°ribuã
 *
di°
;

222 
di°
 = 
	`di°ribuã_gë
 (
i‚ame
);

224 i‡(
ty≥
 =
DISTRIBUTE_IN
)

226 i‡(
di°
->
¥efix
[
DISTRIBUTE_IN
])

227 
	`‰ì
 (
di°
->
¥efix
[
DISTRIBUTE_IN
]);

228 
di°
->
¥efix
[
DISTRIBUTE_IN
] = 
	`°rdup
 (
∂i°_«me
);

230 i‡(
ty≥
 =
DISTRIBUTE_OUT
)

232 i‡(
di°
->
¥efix
[
DISTRIBUTE_OUT
])

233 
	`‰ì
 (
di°
->
¥efix
[
DISTRIBUTE_OUT
]);

234 
di°
->
¥efix
[
DISTRIBUTE_OUT
] = 
	`°rdup
 (
∂i°_«me
);

238 (*
di°ribuã_add_hook
Ë(
di°
);

240  
di°
;

241 
	}
}

246 
	$di°ribuã_li°_¥efix_un£t
 (c⁄° *
i‚ame
, 
di°ribuã_ty≥
 
ty≥
,

247 c⁄° *
∂i°_«me
)

249 
di°ribuã
 *
di°
;

251 
di°
 = 
	`di°ribuã_lookup
 (
i‚ame
);

252 i‡(!
di°
)

255 i‡(
ty≥
 =
DISTRIBUTE_IN
)

257 i‡(!
di°
->
¥efix
[
DISTRIBUTE_IN
])

259 i‡(
	`°rcmp
 (
di°
->
¥efix
[
DISTRIBUTE_IN
], 
∂i°_«me
) != 0)

262 
	`‰ì
 (
di°
->
¥efix
[
DISTRIBUTE_IN
]);

263 
di°
->
¥efix
[
DISTRIBUTE_IN
] = 
NULL
;

266 i‡(
ty≥
 =
DISTRIBUTE_OUT
)

268 i‡(!
di°
->
¥efix
[
DISTRIBUTE_OUT
])

270 i‡(
	`°rcmp
 (
di°
->
¥efix
[
DISTRIBUTE_OUT
], 
∂i°_«me
) != 0)

273 
	`‰ì
 (
di°
->
¥efix
[
DISTRIBUTE_OUT
]);

274 
di°
->
¥efix
[
DISTRIBUTE_OUT
] = 
NULL
;

278 (*
di°ribuã_dñëe_hook
Ë(
di°
);

281 i‡(
di°
->
li°
[
DISTRIBUTE_IN
] =
NULL
 &&

282 
di°
->
li°
[
DISTRIBUTE_OUT
] =
NULL
 &&

283 
di°
->
¥efix
[
DISTRIBUTE_IN
] =
NULL
 &&

284 
di°
->
¥efix
[
DISTRIBUTE_OUT
] =
NULL
)

286 
	`hash_ªÀa£
 (
di°hash
, 
di°
);

287 
	`di°ribuã_‰ì
 (
di°
);

291 
	}
}

293 
DEFUN
 (
di°ribuã_li°_Æl
,

294 
di°ribuã_li°_Æl_cmd
,

301 
di°ribuã_ty≥
 
	gty≥
;

304 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

305 
ty≥
 = 
DISTRIBUTE_IN
;

306 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

307 
ty≥
 = 
DISTRIBUTE_OUT
;

310 
vty_out
 (
vty
, "distributeÜist direction must be [in|out]%s",

311 
VTY_NEWLINE
);

312  
	gCMD_WARNING
;

316 
di°ribuã_li°_£t
 (
NULL
, 
ty≥
, 
¨gv
[0]);

318  
	gCMD_SUCCESS
;

321 
ALIAS
 (
di°ribuã_li°_Æl
,

322 
ùv6_di°ribuã_li°_Æl_cmd
,

329 
DEFUN
 (
no_di°ribuã_li°_Æl
,

330 
no_di°ribuã_li°_Æl_cmd
,

332 
NO_STR


338 
	gªt
;

339 
di°ribuã_ty≥
 
	gty≥
;

342 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

343 
ty≥
 = 
DISTRIBUTE_IN
;

344 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

345 
ty≥
 = 
DISTRIBUTE_OUT
;

348 
vty_out
 (
vty
, "distributeÜist direction must be [in|out]%s",

349 
VTY_NEWLINE
);

350  
	gCMD_WARNING
;

353 
	gªt
 = 
di°ribuã_li°_un£t
 (
NULL
, 
ty≥
, 
¨gv
[0]);

354 i‡(! 
	gªt
)

356 
vty_out
 (
vty
, "di°ribuãÜi° d€¢'àexi°%s", 
VTY_NEWLINE
);

357  
	gCMD_WARNING
;

359  
	gCMD_SUCCESS
;

362 
ALIAS
 (
no_di°ribuã_li°_Æl
,

363 
no_ùv6_di°ribuã_li°_Æl_cmd
,

365 
NO_STR


371 
DEFUN
 (
di°ribuã_li°
,

372 
di°ribuã_li°_cmd
,

380 
di°ribuã_ty≥
 
	gty≥
;

383 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

384 
ty≥
 = 
DISTRIBUTE_IN
;

385 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

386 
ty≥
 = 
DISTRIBUTE_OUT
;

389 
vty_out
 (
vty
, "di°ribuãÜi° dúe˘i⁄ mu° bê[ö|out]%s", 
VTY_NEWLINE
);

390  
	gCMD_WARNING
;

394 
di°ribuã_li°_£t
 (
¨gv
[2], 
ty≥
,árgv[0]);

396  
	gCMD_SUCCESS
;

399 
ALIAS
 (
di°ribuã_li°
,

400 
ùv6_di°ribuã_li°_cmd
,

408 
DEFUN
 (
no_di°ribuã_li°
, 
no_di°ribuã_li°_cmd
,

410 
NO_STR


417 
	gªt
;

418 
di°ribuã_ty≥
 
	gty≥
;

421 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

422 
ty≥
 = 
DISTRIBUTE_IN
;

423 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

424 
ty≥
 = 
DISTRIBUTE_OUT
;

427 
vty_out
 (
vty
, "di°ribuãÜi° dúe˘i⁄ mu° bê[ö|out]%s", 
VTY_NEWLINE
);

428  
	gCMD_WARNING
;

431 
	gªt
 = 
di°ribuã_li°_un£t
 (
¨gv
[2], 
ty≥
,árgv[0]);

432 i‡(! 
	gªt
)

434 
vty_out
 (
vty
, "di°ribuãÜi° d€¢'àexi°%s", 
VTY_NEWLINE
);

435  
	gCMD_WARNING
;

437  
	gCMD_SUCCESS
;

440 
ALIAS
 (
no_di°ribuã_li°
, 
no_ùv6_di°ribuã_li°_cmd
,

442 
NO_STR


449 
DEFUN
 (
di°ribuã_li°_¥efix_Æl
,

450 
di°ribuã_li°_¥efix_Æl_cmd
,

458 
di°ribuã_ty≥
 
	gty≥
;

461 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

462 
ty≥
 = 
DISTRIBUTE_IN
;

463 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

464 
ty≥
 = 
DISTRIBUTE_OUT
;

467 
vty_out
 (
vty
, "distributeÜist direction must be [in|out]%s",

468 
VTY_NEWLINE
);

469  
	gCMD_WARNING
;

473 
di°ribuã_li°_¥efix_£t
 (
NULL
, 
ty≥
, 
¨gv
[0]);

475  
	gCMD_SUCCESS
;

478 
ALIAS
 (
di°ribuã_li°_¥efix_Æl
,

479 
ùv6_di°ribuã_li°_¥efix_Æl_cmd
,

487 
DEFUN
 (
no_di°ribuã_li°_¥efix_Æl
,

488 
no_di°ribuã_li°_¥efix_Æl_cmd
,

490 
NO_STR


497 
	gªt
;

498 
di°ribuã_ty≥
 
	gty≥
;

501 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

502 
ty≥
 = 
DISTRIBUTE_IN
;

503 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

504 
ty≥
 = 
DISTRIBUTE_OUT
;

507 
vty_out
 (
vty
, "distributeÜist direction must be [in|out]%s",

508 
VTY_NEWLINE
);

509  
	gCMD_WARNING
;

512 
	gªt
 = 
di°ribuã_li°_¥efix_un£t
 (
NULL
, 
ty≥
, 
¨gv
[0]);

513 i‡(! 
	gªt
)

515 
vty_out
 (
vty
, "di°ribuãÜi° d€¢'àexi°%s", 
VTY_NEWLINE
);

516  
	gCMD_WARNING
;

518  
	gCMD_SUCCESS
;

521 
ALIAS
 (
no_di°ribuã_li°_¥efix_Æl
,

522 
no_ùv6_di°ribuã_li°_¥efix_Æl_cmd
,

524 
NO_STR


531 
DEFUN
 (
di°ribuã_li°_¥efix
, 
di°ribuã_li°_¥efix_cmd
,

540 
di°ribuã_ty≥
 
	gty≥
;

543 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

544 
ty≥
 = 
DISTRIBUTE_IN
;

545 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

546 
ty≥
 = 
DISTRIBUTE_OUT
;

549 
vty_out
 (
vty
, "distributeÜist direction must be [in|out]%s",

550 
VTY_NEWLINE
);

551  
	gCMD_WARNING
;

555 
di°ribuã_li°_¥efix_£t
 (
¨gv
[2], 
ty≥
,árgv[0]);

557  
	gCMD_SUCCESS
;

560 
ALIAS
 (
di°ribuã_li°_¥efix
, 
ùv6_di°ribuã_li°_¥efix_cmd
,

569 
DEFUN
 (
no_di°ribuã_li°_¥efix
, 
no_di°ribuã_li°_¥efix_cmd
,

571 
NO_STR


579 
	gªt
;

580 
di°ribuã_ty≥
 
	gty≥
;

583 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

584 
ty≥
 = 
DISTRIBUTE_IN
;

585 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

586 
ty≥
 = 
DISTRIBUTE_OUT
;

589 
vty_out
 (
vty
, "distributeÜist direction must be [in|out]%s",

590 
VTY_NEWLINE
);

591  
	gCMD_WARNING
;

594 
	gªt
 = 
di°ribuã_li°_¥efix_un£t
 (
¨gv
[2], 
ty≥
,árgv[0]);

595 i‡(! 
	gªt
)

597 
vty_out
 (
vty
, "di°ribuãÜi° d€¢'àexi°%s", 
VTY_NEWLINE
);

598  
	gCMD_WARNING
;

600  
	gCMD_SUCCESS
;

603 
ALIAS
 (
no_di°ribuã_li°_¥efix
, 
no_ùv6_di°ribuã_li°_¥efix_cmd
,

605 
NO_STR


614 
	$c⁄fig_show_di°ribuã
 (
vty
 *vty)

616 
i
;

617 
hash_backë
 *
mp
;

618 
di°ribuã
 *
di°
;

621 
di°
 = 
	`di°ribuã_lookup
 (
NULL
);

622 i‡(
di°
 && (di°->
li°
[
DISTRIBUTE_OUT
] || di°->
¥efix
[DISTRIBUTE_OUT]))

624 
	`vty_out
 (
vty
, " Outgoing update filterÜist foráll interface is");

625 i‡(
di°
->
li°
[
DISTRIBUTE_OUT
])

626 
	`vty_out
 (
vty
, " %s", 
di°
->
li°
[
DISTRIBUTE_OUT
]);

627 i‡(
di°
->
¥efix
[
DISTRIBUTE_OUT
])

628 
	`vty_out
 (
vty
, "%s (prefix-list) %s",

629 
di°
->
li°
[
DISTRIBUTE_OUT
] ? "," : "",

630 
di°
->
¥efix
[
DISTRIBUTE_OUT
]);

631 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

634 
	`vty_out
 (
vty
, " Outgoög upd©êfûã∏li° f‹áŒ i¡îÁ˚ i†nŸ së%s", 
VTY_NEWLINE
);

636 
i
 = 0; i < 
di°hash
->
size
; i++)

637 
mp
 = 
di°hash
->
ödex
[
i
]; mp; m∞mp->
√xt
)

639 
di°
 = 
mp
->
d©a
;

640 i‡(
di°
->
i‚ame
)

641 i‡(
di°
->
li°
[
DISTRIBUTE_OUT
] || di°->
¥efix
[DISTRIBUTE_OUT])

643 
	`vty_out
 (
vty
, " %†fûãªd by", 
di°
->
i‚ame
);

644 i‡(
di°
->
li°
[
DISTRIBUTE_OUT
])

645 
	`vty_out
 (
vty
, " %s", 
di°
->
li°
[
DISTRIBUTE_OUT
]);

646 i‡(
di°
->
¥efix
[
DISTRIBUTE_OUT
])

647 
	`vty_out
 (
vty
, "%s (prefix-list) %s",

648 
di°
->
li°
[
DISTRIBUTE_OUT
] ? "," : "",

649 
di°
->
¥efix
[
DISTRIBUTE_OUT
]);

650 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

656 
di°
 = 
	`di°ribuã_lookup
 (
NULL
);

657 i‡(
di°
 && (di°->
li°
[
DISTRIBUTE_IN
] || di°->
¥efix
[DISTRIBUTE_IN]))

659 
	`vty_out
 (
vty
, " Incoming update filterÜist foráll interface is");

660 i‡(
di°
->
li°
[
DISTRIBUTE_IN
])

661 
	`vty_out
 (
vty
, " %s", 
di°
->
li°
[
DISTRIBUTE_IN
]);

662 i‡(
di°
->
¥efix
[
DISTRIBUTE_IN
])

663 
	`vty_out
 (
vty
, "%s (prefix-list) %s",

664 
di°
->
li°
[
DISTRIBUTE_IN
] ? "," : "",

665 
di°
->
¥efix
[
DISTRIBUTE_IN
]);

666 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

669 
	`vty_out
 (
vty
, " Incomög upd©êfûã∏li° f‹áŒ i¡îÁ˚ i†nŸ së%s", 
VTY_NEWLINE
);

671 
i
 = 0; i < 
di°hash
->
size
; i++)

672 
mp
 = 
di°hash
->
ödex
[
i
]; mp; m∞mp->
√xt
)

674 
di°
 = 
mp
->
d©a
;

675 i‡(
di°
->
i‚ame
)

676 i‡(
di°
->
li°
[
DISTRIBUTE_IN
] || di°->
¥efix
[DISTRIBUTE_IN])

678 
	`vty_out
 (
vty
, " %†fûãªd by", 
di°
->
i‚ame
);

679 i‡(
di°
->
li°
[
DISTRIBUTE_IN
])

680 
	`vty_out
 (
vty
, " %s", 
di°
->
li°
[
DISTRIBUTE_IN
]);

681 i‡(
di°
->
¥efix
[
DISTRIBUTE_IN
])

682 
	`vty_out
 (
vty
, "%s (prefix-list) %s",

683 
di°
->
li°
[
DISTRIBUTE_IN
] ? "," : "",

684 
di°
->
¥efix
[
DISTRIBUTE_IN
]);

685 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

689 
	}
}

693 
	$c⁄fig_wrôe_di°ribuã
 (
vty
 *vty)

695 
i
;

696 
hash_backë
 *
mp
;

697 
wrôe
 = 0;

699 
i
 = 0; i < 
di°hash
->
size
; i++)

700 
mp
 = 
di°hash
->
ödex
[
i
]; mp; m∞mp->
√xt
)

702 
di°ribuã
 *
di°
;

704 
di°
 = 
mp
->
d©a
;

706 i‡(
di°
->
li°
[
DISTRIBUTE_IN
])

708 
	`vty_out
 (
vty
, " distribute-list %s in %s%s",

709 
di°
->
li°
[
DISTRIBUTE_IN
],

710 
di°
->
i‚ame
 ? dist->ifname : "",

711 
VTY_NEWLINE
);

712 
wrôe
++;

715 i‡(
di°
->
li°
[
DISTRIBUTE_OUT
])

717 
	`vty_out
 (
vty
, " distribute-list %s out %s%s",

719 
di°
->
li°
[
DISTRIBUTE_OUT
],

720 
di°
->
i‚ame
 ? dist->ifname : "",

721 
VTY_NEWLINE
);

722 
wrôe
++;

725 i‡(
di°
->
¥efix
[
DISTRIBUTE_IN
])

727 
	`vty_out
 (
vty
, " distribute-listÖrefix %s in %s%s",

728 
di°
->
¥efix
[
DISTRIBUTE_IN
],

729 
di°
->
i‚ame
 ? dist->ifname : "",

730 
VTY_NEWLINE
);

731 
wrôe
++;

734 i‡(
di°
->
¥efix
[
DISTRIBUTE_OUT
])

736 
	`vty_out
 (
vty
, " distribute-listÖrefix %s out %s%s",

737 
di°
->
¥efix
[
DISTRIBUTE_OUT
],

738 
di°
->
i‚ame
 ? dist->ifname : "",

739 
VTY_NEWLINE
);

740 
wrôe
++;

743  
wrôe
;

744 
	}
}

748 
	$di°ribuã_li°_ª£t
 ()

750 
	`hash_˛ón
 (
di°hash
, ((*Ë(*)Ë
di°ribuã_‰ì
);

751 
	}
}

755 
	$di°ribuã_li°_öô
 (
node
)

757 
di°hash
 = 
	`hash_¸óã
 (
di°ribuã_hash_make
,

758 ((*Ë(c⁄° *, c⁄° *)Ë
di°ribuã_cmp
);

760 if(
node
==
RIP_NODE
) {

761 
	`ö°Æl_ñemít
 (
node
, &
di°ribuã_li°_Æl_cmd
);

762 
	`ö°Æl_ñemít
 (
node
, &
no_di°ribuã_li°_Æl_cmd
);

763 
	`ö°Æl_ñemít
 (
node
, &
di°ribuã_li°_cmd
);

764 
	`ö°Æl_ñemít
 (
node
, &
no_di°ribuã_li°_cmd
);

765 
	`ö°Æl_ñemít
 (
node
, &
di°ribuã_li°_¥efix_Æl_cmd
);

766 
	`ö°Æl_ñemít
 (
node
, &
no_di°ribuã_li°_¥efix_Æl_cmd
);

767 
	`ö°Æl_ñemít
 (
node
, &
di°ribuã_li°_¥efix_cmd
);

768 
	`ö°Æl_ñemít
 (
node
, &
no_di°ribuã_li°_¥efix_cmd
);

769 } i‡(
node
 =
RIPNG_NODE
 ||Çodê=
BABEL_NODE
) {

773 
	`ö°Æl_ñemít
 (
node
, &
ùv6_di°ribuã_li°_Æl_cmd
);

774 
	`ö°Æl_ñemít
 (
node
, &
no_ùv6_di°ribuã_li°_Æl_cmd
);

775 
	`ö°Æl_ñemít
 (
node
, &
ùv6_di°ribuã_li°_cmd
);

776 
	`ö°Æl_ñemít
 (
node
, &
no_ùv6_di°ribuã_li°_cmd
);

777 
	`ö°Æl_ñemít
 (
node
, &
ùv6_di°ribuã_li°_¥efix_Æl_cmd
);

778 
	`ö°Æl_ñemít
 (
node
, &
no_ùv6_di°ribuã_li°_¥efix_Æl_cmd
);

779 
	`ö°Æl_ñemít
 (
node
, &
ùv6_di°ribuã_li°_¥efix_cmd
);

780 
	`ö°Æl_ñemít
 (
node
, &
no_ùv6_di°ribuã_li°_¥efix_cmd
);

782 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/distribute.h

22 #i‚de‡
_ZEBRA_DISTRIBUTE_H


23 
	#_ZEBRA_DISTRIBUTE_H


	)

25 
	~<zebø.h
>

26 
	~"if.h
"

29 
	edi°ribuã_ty≥


31 
	mDISTRIBUTE_IN
,

32 
	mDISTRIBUTE_OUT
,

33 
	mDISTRIBUTE_MAX


36 
	sdi°ribuã


39 *
	mi‚ame
;

42 *
	mli°
[
DISTRIBUTE_MAX
];

45 *
	m¥efix
[
DISTRIBUTE_MAX
];

49 
di°ribuã_li°_öô
 ();

50 
di°ribuã_li°_ª£t
 ();

51 
di°ribuã_li°_add_hook
 ((*Ë(
di°ribuã
 *));

52 
	`di°ribuã_li°_dñëe_hook
 ((*Ë(
di°ribuã
 *));

53 
di°ribuã
 *
	`di°ribuã_lookup
 (const *);

54 
	`c⁄fig_wrôe_di°ribuã
 (
vty
 *);

55 
	`c⁄fig_show_di°ribuã
 (
vty
 *);

57 
fûãr_ty≥
 
	`di°ribuã_≠∂y_ö
 (
öãrÁ˚
 *, 
¥efix
 *);

58 
fûãr_ty≥
 
	`di°ribuã_≠∂y_out
 (
öãrÁ˚
 *, 
¥efix
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/filter.c

22 
	~<zebø.h
>

24 
	~"¥efix.h
"

25 
	~"fûãr.h
"

26 
	~"mem‹y.h
"

27 
	~"comm™d.h
"

28 
	~"sockuni⁄.h
"

29 
	~"buf„r.h
"

30 
	~"log.h
"

32 
	sfûãr_cisco


35 
	mexãnded
;

36 
ö_addr
 
	maddr
;

37 
ö_addr
 
	maddr_mask
;

38 
ö_addr
 
	mmask
;

39 
ö_addr
 
	mmask_mask
;

42 
	sfûãr_zebø


45 
	mexa˘
;

48 
¥efix
 
	m¥efix
;

52 
	sfûãr


55 
fûãr
 *
	m√xt
;

56 
fûãr
 *
	m¥ev
;

59 
fûãr_ty≥
 
	mty≥
;

62 
	mcisco
;

66 
fûãr_cisco
 
	mcfûãr
;

67 
fûãr_zebø
 
	mzfûãr
;

68 } 
	mu
;

72 
	sac˚ss_li°_li°


74 
ac˚ss_li°
 *
	mhód
;

75 
ac˚ss_li°
 *
	mèû
;

79 
	sac˚ss_ma°î


82 
ac˚ss_li°_li°
 
	mnum
;

85 
ac˚ss_li°_li°
 
	m°r
;

88 (*
	madd_hook
Ë(
	mac˚ss_li°
 *);

91 (*
	mdñëe_hook
Ë(
	mac˚ss_li°
 *);

95 
ac˚ss_ma°î
 
	gac˚ss_ma°î_ùv4
 =

97 {
NULL
, NULL},

98 {
NULL
, NULL},

99 
NULL
,

100 
NULL
,

103 #ifde‡
HAVE_IPV6


105 
ac˚ss_ma°î
 
	gac˚ss_ma°î_ùv6
 =

107 {
NULL
, NULL},

108 {
NULL
, NULL},

109 
NULL
,

110 
NULL
,

114 
ac˚ss_ma°î
 *

115 
	$ac˚ss_ma°î_gë
 (
afi_t
 
afi
)

117 i‡(
afi
 =
AFI_IP
)

118  &
ac˚ss_ma°î_ùv4
;

119 #ifde‡
HAVE_IPV6


120 i‡(
afi
 =
AFI_IP6
)

121  &
ac˚ss_ma°î_ùv6
;

123  
NULL
;

124 
	}
}

127 
fûãr
 *

128 
	$fûãr_√w
 ()

130  (
fûãr
 *Ë
	`XCALLOC
 (
MTYPE_ACCESS_FILTER
,

131  (
fûãr
));

132 
	}
}

135 
	$fûãr_‰ì
 (
fûãr
 *filter)

137 
	`XFREE
 (
MTYPE_ACCESS_FILTER
, 
fûãr
);

138 
	}
}

142 
	$fûãr_ty≥_°r
 (
fûãr
 *filter)

144 
fûãr
->
ty≥
)

146 
FILTER_PERMIT
:

149 
FILTER_DENY
:

152 
FILTER_DYNAMIC
:

159 
	}
}

163 
	$fûãr_m©ch_cisco
 (
fûãr
 *
mfûãr
, 
¥efix
 *
p
)

165 
fûãr_cisco
 *
fûãr
;

166 
ö_addr
 
mask
;

167 
u_öt32_t
 
check_addr
;

168 
u_öt32_t
 
check_mask
;

170 
fûãr
 = &
mfûãr
->
u
.
cfûãr
;

171 
check_addr
 = 
p
->
u
.
¥efix4
.
s_addr
 & ~
fûãr
->
addr_mask
.s_addr;

173 i‡(
fûãr
->
exãnded
)

175 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
mask
);

176 
check_mask
 = 
mask
.
s_addr
 & ~
fûãr
->
mask_mask
.s_addr;

178 i‡(
	`memcmp
 (&
check_addr
, &
fûãr
->
addr
.
s_addr
, 4) == 0

179 && 
	`memcmp
 (&
check_mask
, &
fûãr
->
mask
.
s_addr
, 4) == 0)

182 i‡(
	`memcmp
 (&
check_addr
, &
fûãr
->
addr
.
s_addr
, 4) == 0)

186 
	}
}

190 
	$fûãr_m©ch_zebø
 (
fûãr
 *
mfûãr
, 
¥efix
 *
p
)

192 
fûãr_zebø
 *
fûãr
;

194 
fûãr
 = &
mfûãr
->
u
.
zfûãr
;

196 i‡(
fûãr
->
¥efix
.
Ámûy
 =
p
->family)

198 i‡(
fûãr
->
exa˘
)

200 i‡(
fûãr
->
¥efix
.
¥efixÀn
 =
p
->prefixlen)

201  
	`¥efix_m©ch
 (&
fûãr
->
¥efix
, 
p
);

206  
	`¥efix_m©ch
 (&
fûãr
->
¥efix
, 
p
);

210 
	}
}

213 
ac˚ss_li°
 *

214 
	$ac˚ss_li°_√w
 ()

216  (
ac˚ss_li°
 *Ë
	`XCALLOC
 (
MTYPE_ACCESS_LIST
,

217  (
ac˚ss_li°
));

218 
	}
}

222 
	$ac˚ss_li°_‰ì
 (
ac˚ss_li°
 *
ac˚ss
)

224 
	`XFREE
 (
MTYPE_ACCESS_LIST
, 
ac˚ss
);

225 
	}
}

229 
	$ac˚ss_li°_dñëe
 (
ac˚ss_li°
 *
ac˚ss
)

231 
fûãr
 *filter;

232 
fûãr
 *
√xt
;

233 
ac˚ss_li°_li°
 *
li°
;

234 
ac˚ss_ma°î
 *
ma°î
;

236 
fûãr
 = 
ac˚ss
->
hód
; fûãr; fûã∏
√xt
)

238 
√xt
 = 
fûãr
->next;

239 
	`fûãr_‰ì
 (
fûãr
);

242 
ma°î
 = 
ac˚ss
->master;

244 i‡(
ac˚ss
->
ty≥
 =
ACCESS_TYPE_NUMBER
)

245 
li°
 = &
ma°î
->
num
;

247 
li°
 = &
ma°î
->
°r
;

249 i‡(
ac˚ss
->
√xt
)

250 
ac˚ss
->
√xt
->
¥ev
 =áccess->prev;

252 
li°
->
èû
 = 
ac˚ss
->
¥ev
;

254 i‡(
ac˚ss
->
¥ev
)

255 
ac˚ss
->
¥ev
->
√xt
 =áccess->next;

257 
li°
->
hód
 = 
ac˚ss
->
√xt
;

259 i‡(
ac˚ss
->
«me
)

260 
	`XFREE
 (
MTYPE_ACCESS_LIST_STR
, 
ac˚ss
->
«me
);

262 i‡(
ac˚ss
->
ªm¨k
)

263 
	`XFREE
 (
MTYPE_TMP
, 
ac˚ss
->
ªm¨k
);

265 
	`ac˚ss_li°_‰ì
 (
ac˚ss
);

266 
	}
}

270 
ac˚ss_li°
 *

271 
	$ac˚ss_li°_ö£π
 (
afi_t
 
afi
, c⁄° *
«me
)

273 
i
;

274 
numbî
;

275 
ac˚ss_li°
 *
ac˚ss
;

276 
ac˚ss_li°
 *
poöt
;

277 
ac˚ss_li°_li°
 *
Æi°
;

278 
ac˚ss_ma°î
 *
ma°î
;

280 
ma°î
 = 
	`ac˚ss_ma°î_gë
 (
afi
);

281 i‡(
ma°î
 =
NULL
)

282  
NULL
;

285 
ac˚ss
 = 
	`ac˚ss_li°_√w
 ();

286 
ac˚ss
->
«me
 = 
	`XSTRDUP
 (
MTYPE_ACCESS_LIST_STR
,Çame);

287 
ac˚ss
->
ma°î
 = master;

291 
numbî
 = 0, 
i
 = 0; i < 
	`°æí
 (
«me
); i++)

293 i‡(
	`isdigô
 ((Ë
«me
[
i
]))

294 
numbî
 = (numbî * 10Ë+ (
«me
[
i
] - '0');

300 i‡(
i
 =
	`°æí
 (
«me
))

302 
ac˚ss
->
ty≥
 = 
ACCESS_TYPE_NUMBER
;

305 
Æi°
 = &
ma°î
->
num
;

307 
poöt
 = 
Æi°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

308 i‡(
	`©ﬁ
 (
poöt
->
«me
Ë>
numbî
)

313 
ac˚ss
->
ty≥
 = 
ACCESS_TYPE_STRING
;

316 
Æi°
 = &
ma°î
->
°r
;

319 
poöt
 = 
Æi°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

320 i‡(
	`°rcmp
 (
poöt
->
«me
,Çame) >= 0)

325 i‡(
Æi°
->
hód
 =
NULL
)

327 
Æi°
->
hód
 =áli°->
èû
 = 
ac˚ss
;

328  
ac˚ss
;

332 i‡(
poöt
 =
NULL
)

334 
ac˚ss
->
¥ev
 = 
Æi°
->
èû
;

335 
Æi°
->
èû
->
√xt
 = 
ac˚ss
;

336 
Æi°
->
èû
 = 
ac˚ss
;

337  
ac˚ss
;

341 i‡(
poöt
 =
Æi°
->
hód
)

343 
ac˚ss
->
√xt
 = 
Æi°
->
hód
;

344 
Æi°
->
hód
->
¥ev
 = 
ac˚ss
;

345 
Æi°
->
hód
 = 
ac˚ss
;

346  
ac˚ss
;

350 
ac˚ss
->
√xt
 = 
poöt
;

351 
ac˚ss
->
¥ev
 = 
poöt
->prev;

353 i‡(
poöt
->
¥ev
)

354 
poöt
->
¥ev
->
√xt
 = 
ac˚ss
;

355 
poöt
->
¥ev
 = 
ac˚ss
;

357  
ac˚ss
;

358 
	}
}

361 
ac˚ss_li°
 *

362 
	$ac˚ss_li°_lookup
 (
afi_t
 
afi
, c⁄° *
«me
)

364 
ac˚ss_li°
 *
ac˚ss
;

365 
ac˚ss_ma°î
 *
ma°î
;

367 i‡(
«me
 =
NULL
)

368  
NULL
;

370 
ma°î
 = 
	`ac˚ss_ma°î_gë
 (
afi
);

371 i‡(
ma°î
 =
NULL
)

372  
NULL
;

374 
ac˚ss
 = 
ma°î
->
num
.
hód
;ác˚ss;ác˚s†ac˚ss->
√xt
)

375 i‡(
	`°rcmp
 (
ac˚ss
->
«me
,Çame) == 0)

376  
ac˚ss
;

378 
ac˚ss
 = 
ma°î
->
°r
.
hód
;ác˚ss;ác˚s†ac˚ss->
√xt
)

379 i‡(
	`°rcmp
 (
ac˚ss
->
«me
,Çame) == 0)

380  
ac˚ss
;

382  
NULL
;

383 
	}
}

387 
ac˚ss_li°
 *

388 
	$ac˚ss_li°_gë
 (
afi_t
 
afi
, c⁄° *
«me
)

390 
ac˚ss_li°
 *
ac˚ss
;

392 
ac˚ss
 = 
	`ac˚ss_li°_lookup
 (
afi
, 
«me
);

393 i‡(
ac˚ss
 =
NULL
)

394 
ac˚ss
 = 
	`ac˚ss_li°_ö£π
 (
afi
, 
«me
);

395  
ac˚ss
;

396 
	}
}

399 
fûãr_ty≥


400 
	$ac˚ss_li°_≠∂y
 (
ac˚ss_li°
 *
ac˚ss
, *
obje˘
)

402 
fûãr
 *filter;

403 
¥efix
 *
p
;

405 
p
 = (
¥efix
 *Ë
obje˘
;

407 i‡(
ac˚ss
 =
NULL
)

408  
FILTER_DENY
;

410 
fûãr
 = 
ac˚ss
->
hód
; fûãr; fûã∏fûãr->
√xt
)

412 i‡(
fûãr
->
cisco
)

414 i‡(
	`fûãr_m©ch_cisco
 (
fûãr
, 
p
))

415  
fûãr
->
ty≥
;

419 i‡(
	`fûãr_m©ch_zebø
 (
fûãr
, 
p
))

420  
fûãr
->
ty≥
;

424  
FILTER_DENY
;

425 
	}
}

429 
ac˚ss_li°_add_hook
 ((*
func
Ë(
ac˚ss_li°
 *
ac˚ss
))

431 
ac˚ss_ma°î_ùv4
.
add_hook
 = 
func
;

432 #ifde‡
HAVE_IPV6


433 
ac˚ss_ma°î_ùv6
.
add_hook
 = 
func
;

435 
	}
}

439 
ac˚ss_li°_dñëe_hook
 ((*
func
Ë(
ac˚ss_li°
 *
ac˚ss
))

441 
ac˚ss_ma°î_ùv4
.
dñëe_hook
 = 
func
;

442 #ifde‡
HAVE_IPV6


443 
ac˚ss_ma°î_ùv6
.
dñëe_hook
 = 
func
;

445 
	}
}

449 
	$ac˚ss_li°_fûãr_add
 (
ac˚ss_li°
 *
ac˚ss
, 
fûãr
 *filter)

451 
fûãr
->
√xt
 = 
NULL
;

452 
fûãr
->
¥ev
 = 
ac˚ss
->
èû
;

454 i‡(
ac˚ss
->
èû
)

455 
ac˚ss
->
èû
->
√xt
 = 
fûãr
;

457 
ac˚ss
->
hód
 = 
fûãr
;

458 
ac˚ss
->
èû
 = 
fûãr
;

461 i‡(
ac˚ss
->
ma°î
->
add_hook
)

462 (*
ac˚ss
->
ma°î
->
add_hook
) (access);

463 
	}
}

467 
	$ac˚ss_li°_em±y
 (
ac˚ss_li°
 *
ac˚ss
)

469 i‡(
ac˚ss
->
hód
 =
NULL
 &&ác˚ss->
èû
 == NULL)

473 
	}
}

478 
	$ac˚ss_li°_fûãr_dñëe
 (
ac˚ss_li°
 *
ac˚ss
, 
fûãr
 *filter)

480 
ac˚ss_ma°î
 *
ma°î
;

482 
ma°î
 = 
ac˚ss
->master;

484 i‡(
fûãr
->
√xt
)

485 
fûãr
->
√xt
->
¥ev
 = filter->prev;

487 
ac˚ss
->
èû
 = 
fûãr
->
¥ev
;

489 i‡(
fûãr
->
¥ev
)

490 
fûãr
->
¥ev
->
√xt
 = filter->next;

492 
ac˚ss
->
hód
 = 
fûãr
->
√xt
;

494 
	`fûãr_‰ì
 (
fûãr
);

497 i‡(
	`ac˚ss_li°_em±y
 (
ac˚ss
))

498 
	`ac˚ss_li°_dñëe
 (
ac˚ss
);

501 i‡(
ma°î
->
dñëe_hook
)

502 (*
ma°î
->
dñëe_hook
Ë(
ac˚ss
);

503 
	}
}

517 
fûãr
 *

518 
	$fûãr_lookup_cisco
 (
ac˚ss_li°
 *
ac˚ss
, 
fûãr
 *
m√w
)

520 
fûãr
 *
mfûãr
;

521 
fûãr_cisco
 *
fûãr
;

522 
fûãr_cisco
 *
√w
;

524 
√w
 = &
m√w
->
u
.
cfûãr
;

526 
mfûãr
 = 
ac˚ss
->
hód
; mfûãr; mfûã∏mfûãr->
√xt
)

528 
fûãr
 = &
mfûãr
->
u
.
cfûãr
;

530 i‡(
fûãr
->
exãnded
)

532 i‡(
mfûãr
->
ty≥
 =
m√w
->type

533 && 
fûãr
->
addr
.
s_addr
 =
√w
->addr.s_addr

534 && 
fûãr
->
addr_mask
.
s_addr
 =
√w
->addr_mask.s_addr

535 && 
fûãr
->
mask
.
s_addr
 =
√w
->mask.s_addr

536 && 
fûãr
->
mask_mask
.
s_addr
 =
√w
->mask_mask.s_addr)

537  
mfûãr
;

541 i‡(
mfûãr
->
ty≥
 =
m√w
->type

542 && 
fûãr
->
addr
.
s_addr
 =
√w
->addr.s_addr

543 && 
fûãr
->
addr_mask
.
s_addr
 =
√w
->addr_mask.s_addr)

544  
mfûãr
;

548  
NULL
;

549 
	}
}

551 
fûãr
 *

552 
	$fûãr_lookup_zebø
 (
ac˚ss_li°
 *
ac˚ss
, 
fûãr
 *
m√w
)

554 
fûãr
 *
mfûãr
;

555 
fûãr_zebø
 *
fûãr
;

556 
fûãr_zebø
 *
√w
;

558 
√w
 = &
m√w
->
u
.
zfûãr
;

560 
mfûãr
 = 
ac˚ss
->
hód
; mfûãr; mfûã∏mfûãr->
√xt
)

562 
fûãr
 = &
mfûãr
->
u
.
zfûãr
;

564 i‡(
fûãr
->
exa˘
 =
√w
->exact

565 && 
mfûãr
->
ty≥
 =
m√w
->type

566 && 
	`¥efix_ßme
 (&
fûãr
->
¥efix
, &
√w
->prefix))

567  
mfûãr
;

569  
NULL
;

570 
	}
}

573 
	$vty_ac˚ss_li°_ªm¨k_un£t
 (
vty
 *vty, 
afi_t
 
afi
, c⁄° *
«me
)

575 
ac˚ss_li°
 *
ac˚ss
;

577 
ac˚ss
 = 
	`ac˚ss_li°_lookup
 (
afi
, 
«me
);

578 i‡(! 
ac˚ss
)

580 
	`vty_out
 (
vty
, "%%ác˚ss-li° %†d€¢'àexi°%s", 
«me
,

581 
VTY_NEWLINE
);

582  
CMD_WARNING
;

585 i‡(
ac˚ss
->
ªm¨k
)

587 
	`XFREE
 (
MTYPE_TMP
, 
ac˚ss
->
ªm¨k
);

588 
ac˚ss
->
ªm¨k
 = 
NULL
;

591 i‡(
ac˚ss
->
hód
 =
NULL
 &&ác˚ss->
èû
 =NULL &&ác˚ss->
ªm¨k
 == NULL)

592 
	`ac˚ss_li°_dñëe
 (
ac˚ss
);

594  
CMD_SUCCESS
;

595 
	}
}

598 
	$fûãr_£t_cisco
 (
vty
 *vty, c⁄° *
«me_°r
, c⁄° *
ty≥_°r
,

599 c⁄° *
addr_°r
, c⁄° *
addr_mask_°r
,

600 c⁄° *
mask_°r
, c⁄° *
mask_mask_°r
,

601 
exãnded
, 
£t
)

603 
ªt
;

604 
fûãr_ty≥
 
ty≥
;

605 
fûãr
 *
mfûãr
;

606 
fûãr_cisco
 *
fûãr
;

607 
ac˚ss_li°
 *
ac˚ss
;

608 
ö_addr
 
addr
;

609 
ö_addr
 
addr_mask
;

610 
ö_addr
 
mask
;

611 
ö_addr
 
mask_mask
;

614 i‡(
	`°∫cmp
 (
ty≥_°r
, "p", 1) == 0)

615 
ty≥
 = 
FILTER_PERMIT
;

616 i‡(
	`°∫cmp
 (
ty≥_°r
, "d", 1) == 0)

617 
ty≥
 = 
FILTER_DENY
;

620 
	`vty_out
 (
vty
, "%% fûã∏ty≥ mu° bê≥rmô o∏díy%s", 
VTY_NEWLINE
);

621  
CMD_WARNING
;

624 
ªt
 = 
	`öë_©⁄
 (
addr_°r
, &
addr
);

625 i‡(
ªt
 <= 0)

627 
	`vty_out
 (
vty
, "%%Inconsistentáddressánd mask%s",

628 
VTY_NEWLINE
);

629  
CMD_WARNING
;

632 
ªt
 = 
	`öë_©⁄
 (
addr_mask_°r
, &
addr_mask
);

633 i‡(
ªt
 <= 0)

635 
	`vty_out
 (
vty
, "%%Inconsistentáddressánd mask%s",

636 
VTY_NEWLINE
);

637  
CMD_WARNING
;

640 i‡(
exãnded
)

642 
ªt
 = 
	`öë_©⁄
 (
mask_°r
, &
mask
);

643 i‡(
ªt
 <= 0)

645 
	`vty_out
 (
vty
, "%%Inconsistentáddressánd mask%s",

646 
VTY_NEWLINE
);

647  
CMD_WARNING
;

650 
ªt
 = 
	`öë_©⁄
 (
mask_mask_°r
, &
mask_mask
);

651 i‡(
ªt
 <= 0)

653 
	`vty_out
 (
vty
, "%%Inconsistentáddressánd mask%s",

654 
VTY_NEWLINE
);

655  
CMD_WARNING
;

659 
mfûãr
 = 
	`fûãr_√w
();

660 
mfûãr
->
ty≥
 =Åype;

661 
mfûãr
->
cisco
 = 1;

662 
fûãr
 = &
mfûãr
->
u
.
cfûãr
;

663 
fûãr
->
exãnded
 =Éxtended;

664 
fûãr
->
addr
.
s_addr
 =áddr.s_add∏& ~
addr_mask
.s_addr;

665 
fûãr
->
addr_mask
.
s_addr
 =áddr_mask.s_addr;

667 i‡(
exãnded
)

669 
fûãr
->
mask
.
s_addr
 = mask.s_add∏& ~
mask_mask
.s_addr;

670 
fûãr
->
mask_mask
.
s_addr
 = mask_mask.s_addr;

674 
ac˚ss
 = 
	`ac˚ss_li°_gë
 (
AFI_IP
, 
«me_°r
);

676 i‡(
£t
)

678 i‡(
	`fûãr_lookup_cisco
 (
ac˚ss
, 
mfûãr
))

679 
	`fûãr_‰ì
 (
mfûãr
);

681 
	`ac˚ss_li°_fûãr_add
 (
ac˚ss
, 
mfûãr
);

685 
fûãr
 *
dñëe_fûãr
;

687 
dñëe_fûãr
 = 
	`fûãr_lookup_cisco
 (
ac˚ss
, 
mfûãr
);

688 i‡(
dñëe_fûãr
)

689 
	`ac˚ss_li°_fûãr_dñëe
 (
ac˚ss
, 
dñëe_fûãr
);

691 
	`fûãr_‰ì
 (
mfûãr
);

694  
CMD_SUCCESS
;

695 
	}
}

698 
DEFUN
 (
ac˚ss_li°_°™d¨d
,

699 
ac˚ss_li°_°™d¨d_cmd
,

709  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],árgv[3],

710 
NULL
, NULL, 0, 1);

713 
DEFUN
 (
ac˚ss_li°_°™d¨d_nomask
,

714 
ac˚ss_li°_°™d¨d_nomask_cmd
,

723  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2], "0.0.0.0",

724 
NULL
, NULL, 0, 1);

727 
DEFUN
 (
ac˚ss_li°_°™d¨d_ho°
,

728 
ac˚ss_li°_°™d¨d_ho°_cmd
,

738  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2], "0.0.0.0",

739 
NULL
, NULL, 0, 1);

742 
DEFUN
 (
ac˚ss_li°_°™d¨d_™y
,

743 
ac˚ss_li°_°™d¨d_™y_cmd
,

752  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

753 "255.255.255.255", 
NULL
, NULL, 0, 1);

756 
DEFUN
 (
no_ac˚ss_li°_°™d¨d
,

757 
no_ac˚ss_li°_°™d¨d_cmd
,

759 
NO_STR


768  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],árgv[3],

769 
NULL
, NULL, 0, 0);

772 
DEFUN
 (
no_ac˚ss_li°_°™d¨d_nomask
,

773 
no_ac˚ss_li°_°™d¨d_nomask_cmd
,

775 
NO_STR


783  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2], "0.0.0.0",

784 
NULL
, NULL, 0, 0);

787 
DEFUN
 (
no_ac˚ss_li°_°™d¨d_ho°
,

788 
no_ac˚ss_li°_°™d¨d_ho°_cmd
,

790 
NO_STR


799  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2], "0.0.0.0",

800 
NULL
, NULL, 0, 0);

803 
DEFUN
 (
no_ac˚ss_li°_°™d¨d_™y
,

804 
no_ac˚ss_li°_°™d¨d_™y_cmd
,

806 
NO_STR


814  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

815 "255.255.255.255", 
NULL
, NULL, 0, 0);

819 
DEFUN
 (
ac˚ss_li°_exãnded
,

820 
ac˚ss_li°_exãnded_cmd
,

833  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

834 
¨gv
[3],árgv[4],árgv[5], 1 ,1);

837 
DEFUN
 (
ac˚ss_li°_exãnded_mask_™y
,

838 
ac˚ss_li°_exãnded_mask_™y_cmd
,

850  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

851 
¨gv
[3], "0.0.0.0",

855 
DEFUN
 (
ac˚ss_li°_exãnded_™y_mask
,

856 
ac˚ss_li°_exãnded_™y_mask_cmd
,

868  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

869 "255.255.255.255", 
¨gv
[2],

870 
¨gv
[3], 1, 1);

873 
DEFUN
 (
ac˚ss_li°_exãnded_™y_™y
,

874 
ac˚ss_li°_exãnded_™y_™y_cmd
,

885  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

890 
DEFUN
 (
ac˚ss_li°_exãnded_mask_ho°
,

891 
ac˚ss_li°_exãnded_mask_ho°_cmd
,

904  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

905 
¨gv
[3],árgv[4],

909 
DEFUN
 (
ac˚ss_li°_exãnded_ho°_mask
,

910 
ac˚ss_li°_exãnded_ho°_mask_cmd
,

923  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

924 "0.0.0.0", 
¨gv
[3],

925 
¨gv
[4], 1, 1);

928 
DEFUN
 (
ac˚ss_li°_exãnded_ho°_ho°
,

929 
ac˚ss_li°_exãnded_ho°_ho°_cmd
,

942  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

943 "0.0.0.0", 
¨gv
[3],

947 
DEFUN
 (
ac˚ss_li°_exãnded_™y_ho°
,

948 
ac˚ss_li°_exãnded_™y_ho°_cmd
,

960  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

961 "255.255.255.255", 
¨gv
[2],

965 
DEFUN
 (
ac˚ss_li°_exãnded_ho°_™y
,

966 
ac˚ss_li°_exãnded_ho°_™y_cmd
,

978  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

983 
DEFUN
 (
no_ac˚ss_li°_exãnded
,

984 
no_ac˚ss_li°_exãnded_cmd
,

986 
NO_STR


998  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

999 
¨gv
[3],árgv[4],árgv[5], 1, 0);

1002 
DEFUN
 (
no_ac˚ss_li°_exãnded_mask_™y
,

1003 
no_ac˚ss_li°_exãnded_mask_™y_cmd
,

1005 
NO_STR


1016  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

1017 
¨gv
[3], "0.0.0.0",

1021 
DEFUN
 (
no_ac˚ss_li°_exãnded_™y_mask
,

1022 
no_ac˚ss_li°_exãnded_™y_mask_cmd
,

1024 
NO_STR


1035  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

1036 "255.255.255.255", 
¨gv
[2],

1037 
¨gv
[3], 1, 0);

1040 
DEFUN
 (
no_ac˚ss_li°_exãnded_™y_™y
,

1041 
no_ac˚ss_li°_exãnded_™y_™y_cmd
,

1043 
NO_STR


1053  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

1058 
DEFUN
 (
no_ac˚ss_li°_exãnded_mask_ho°
,

1059 
no_ac˚ss_li°_exãnded_mask_ho°_cmd
,

1061 
NO_STR


1073  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

1074 
¨gv
[3],árgv[4],

1078 
DEFUN
 (
no_ac˚ss_li°_exãnded_ho°_mask
,

1079 
no_ac˚ss_li°_exãnded_ho°_mask_cmd
,

1081 
NO_STR


1093  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

1094 "0.0.0.0", 
¨gv
[3],

1095 
¨gv
[4], 1, 0);

1098 
DEFUN
 (
no_ac˚ss_li°_exãnded_ho°_ho°
,

1099 
no_ac˚ss_li°_exãnded_ho°_ho°_cmd
,

1101 
NO_STR


1113  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

1114 "0.0.0.0", 
¨gv
[3],

1118 
DEFUN
 (
no_ac˚ss_li°_exãnded_™y_ho°
,

1119 
no_ac˚ss_li°_exãnded_™y_ho°_cmd
,

1121 
NO_STR


1132  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1], "0.0.0.0",

1133 "255.255.255.255", 
¨gv
[2],

1137 
DEFUN
 (
no_ac˚ss_li°_exãnded_ho°_™y
,

1138 
no_ac˚ss_li°_exãnded_ho°_™y_cmd
,

1140 
NO_STR


1151  
fûãr_£t_cisco
 (
vty
, 
¨gv
[0],árgv[1],árgv[2],

1157 
	$fûãr_£t_zebø
 (
vty
 *vty, c⁄° *
«me_°r
, c⁄° *
ty≥_°r
,

1158 
afi_t
 
afi
, c⁄° *
¥efix_°r
, 
exa˘
, 
£t
)

1160 
ªt
;

1161 
fûãr_ty≥
 
ty≥
;

1162 
fûãr
 *
mfûãr
;

1163 
fûãr_zebø
 *
fûãr
;

1164 
ac˚ss_li°
 *
ac˚ss
;

1165 
¥efix
 
p
;

1168 i‡(
	`°∫cmp
 (
ty≥_°r
, "p", 1) == 0)

1169 
ty≥
 = 
FILTER_PERMIT
;

1170 i‡(
	`°∫cmp
 (
ty≥_°r
, "d", 1) == 0)

1171 
ty≥
 = 
FILTER_DENY
;

1174 
	`vty_out
 (
vty
, "fûã∏ty≥ mu° bê[≥rmô|díy]%s", 
VTY_NEWLINE
);

1175  
CMD_WARNING
;

1179 i‡(
afi
 =
AFI_IP
)

1181 
ªt
 = 
	`°r2¥efix_ùv4
 (
¥efix_°r
, (
¥efix_ùv4
 *)&
p
);

1182 i‡(
ªt
 <= 0)

1184 
	`vty_out
 (
vty
, "IPáddressÖrefix/prefixlen is malformed%s",

1185 
VTY_NEWLINE
);

1186  
CMD_WARNING
;

1189 #ifde‡
HAVE_IPV6


1190 i‡(
afi
 =
AFI_IP6
)

1192 
ªt
 = 
	`°r2¥efix_ùv6
 (
¥efix_°r
, (
¥efix_ùv6
 *Ë&
p
);

1193 i‡(
ªt
 <= 0)

1195 
	`vty_out
 (
vty
, "IPv6áddressÖrefix/prefixlen is malformed%s",

1196 
VTY_NEWLINE
);

1197  
CMD_WARNING
;

1202  
CMD_WARNING
;

1204 
mfûãr
 = 
	`fûãr_√w
 ();

1205 
mfûãr
->
ty≥
 =Åype;

1206 
fûãr
 = &
mfûãr
->
u
.
zfûãr
;

1207 
	`¥efix_c›y
 (&
fûãr
->
¥efix
, &
p
);

1210 i‡(
exa˘
)

1211 
fûãr
->
exa˘
 = 1;

1214 
ac˚ss
 = 
	`ac˚ss_li°_gë
 (
afi
, 
«me_°r
);

1216 i‡(
£t
)

1218 i‡(
	`fûãr_lookup_zebø
 (
ac˚ss
, 
mfûãr
))

1219 
	`fûãr_‰ì
 (
mfûãr
);

1221 
	`ac˚ss_li°_fûãr_add
 (
ac˚ss
, 
mfûãr
);

1225 
fûãr
 *
dñëe_fûãr
;

1227 
dñëe_fûãr
 = 
	`fûãr_lookup_zebø
 (
ac˚ss
, 
mfûãr
);

1228 i‡(
dñëe_fûãr
)

1229 
	`ac˚ss_li°_fûãr_dñëe
 (
ac˚ss
, 
dñëe_fûãr
);

1231 
	`fûãr_‰ì
 (
mfûãr
);

1234  
CMD_SUCCESS
;

1235 
	}
}

1238 
DEFUN
 (
ac˚ss_li°
,

1239 
ac˚ss_li°_cmd
,

1247  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
,árgv[2], 0, 1);

1250 
DEFUN
 (
ac˚ss_li°_exa˘
,

1251 
ac˚ss_li°_exa˘_cmd
,

1260  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
,árgv[2], 1, 1);

1263 
DEFUN
 (
ac˚ss_li°_™y
,

1264 
ac˚ss_li°_™y_cmd
,

1272  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
, "0.0.0.0/0", 0, 1);

1275 
DEFUN
 (
no_ac˚ss_li°
,

1276 
no_ac˚ss_li°_cmd
,

1278 
NO_STR


1285  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
,árgv[2], 0, 0);

1288 
DEFUN
 (
no_ac˚ss_li°_exa˘
,

1289 
no_ac˚ss_li°_exa˘_cmd
,

1291 
NO_STR


1299  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
,árgv[2], 1, 0);

1302 
DEFUN
 (
no_ac˚ss_li°_™y
,

1303 
no_ac˚ss_li°_™y_cmd
,

1305 
NO_STR


1312  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP
, "0.0.0.0/0", 0, 0);

1315 
DEFUN
 (
no_ac˚ss_li°_Æl
,

1316 
no_ac˚ss_li°_Æl_cmd
,

1318 
NO_STR


1326 
ac˚ss_li°
 *
	gac˚ss
;

1327 
ac˚ss_ma°î
 *
	gma°î
;

1330 
	gac˚ss
 = 
ac˚ss_li°_lookup
 (
AFI_IP
, 
¨gv
[0]);

1331 i‡(
	gac˚ss
 =
NULL
)

1333 
vty_out
 (
vty
, "%%ác˚ss-li° %†d€¢'àexi°%s", 
¨gv
[0],

1334 
VTY_NEWLINE
);

1335  
	gCMD_WARNING
;

1338 
	gma°î
 = 
ac˚ss
->
ma°î
;

1341 i‡(
	gma°î
->
	gdñëe_hook
)

1342 (*
	gma°î
->
	gdñëe_hook
Ë(
	gac˚ss
);

1345 
ac˚ss_li°_dñëe
 (
ac˚ss
);

1347  
	gCMD_SUCCESS
;

1350 
DEFUN
 (
ac˚ss_li°_ªm¨k
,

1351 
ac˚ss_li°_ªm¨k_cmd
,

1362 
ac˚ss_li°
 *
	gac˚ss
;

1364 
	gac˚ss
 = 
ac˚ss_li°_gë
 (
AFI_IP
, 
¨gv
[0]);

1366 i‡(
	gac˚ss
->
	gªm¨k
)

1368 
XFREE
 (
MTYPE_TMP
, 
ac˚ss
->
ªm¨k
);

1369 
	gac˚ss
->
	gªm¨k
 = 
NULL
;

1371 
	gac˚ss
->
	gªm¨k
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 1);

1373  
	gCMD_SUCCESS
;

1376 
DEFUN
 (
no_ac˚ss_li°_ªm¨k
,

1377 
no_ac˚ss_li°_ªm¨k_cmd
,

1379 
NO_STR


1388  
vty_ac˚ss_li°_ªm¨k_un£t
 (
vty
, 
AFI_IP
, 
¨gv
[0]);

1391 
ALIAS
 (
no_ac˚ss_li°_ªm¨k
,

1392 
no_ac˚ss_li°_ªm¨k_¨g_cmd
,

1394 
NO_STR


1404 #ifde‡
HAVE_IPV6


1405 
DEFUN
 (
ùv6_ac˚ss_li°
,

1406 
ùv6_ac˚ss_li°_cmd
,

1408 
IPV6_STR


1415  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
,árgv[2], 0, 1);

1418 
DEFUN
 (
ùv6_ac˚ss_li°_exa˘
,

1419 
ùv6_ac˚ss_li°_exa˘_cmd
,

1421 
IPV6_STR


1429  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
,árgv[2], 1, 1);

1432 
DEFUN
 (
ùv6_ac˚ss_li°_™y
,

1433 
ùv6_ac˚ss_li°_™y_cmd
,

1435 
IPV6_STR


1442  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
, "::/0", 0, 1);

1445 
DEFUN
 (
no_ùv6_ac˚ss_li°
,

1446 
no_ùv6_ac˚ss_li°_cmd
,

1448 
NO_STR


1449 
IPV6_STR


1456  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
,árgv[2], 0, 0);

1459 
DEFUN
 (
no_ùv6_ac˚ss_li°_exa˘
,

1460 
no_ùv6_ac˚ss_li°_exa˘_cmd
,

1462 
NO_STR


1463 
IPV6_STR


1471  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
,árgv[2], 1, 0);

1474 
DEFUN
 (
no_ùv6_ac˚ss_li°_™y
,

1475 
no_ùv6_ac˚ss_li°_™y_cmd
,

1477 
NO_STR


1478 
IPV6_STR


1485  
fûãr_£t_zebø
 (
vty
, 
¨gv
[0],árgv[1], 
AFI_IP6
, "::/0", 0, 0);

1489 
DEFUN
 (
no_ùv6_ac˚ss_li°_Æl
,

1490 
no_ùv6_ac˚ss_li°_Æl_cmd
,

1492 
NO_STR


1493 
IPV6_STR


1497 
ac˚ss_li°
 *
	gac˚ss
;

1498 
ac˚ss_ma°î
 *
	gma°î
;

1501 
	gac˚ss
 = 
ac˚ss_li°_lookup
 (
AFI_IP6
, 
¨gv
[0]);

1502 i‡(
	gac˚ss
 =
NULL
)

1504 
vty_out
 (
vty
, "%%ác˚ss-li° %†d€¢'àexi°%s", 
¨gv
[0],

1505 
VTY_NEWLINE
);

1506  
	gCMD_WARNING
;

1509 
	gma°î
 = 
ac˚ss
->
ma°î
;

1512 i‡(
	gma°î
->
	gdñëe_hook
)

1513 (*
	gma°î
->
	gdñëe_hook
Ë(
	gac˚ss
);

1516 
ac˚ss_li°_dñëe
 (
ac˚ss
);

1518  
	gCMD_SUCCESS
;

1521 
DEFUN
 (
ùv6_ac˚ss_li°_ªm¨k
,

1522 
ùv6_ac˚ss_li°_ªm¨k_cmd
,

1524 
IPV6_STR


1530 
ac˚ss_li°
 *
	gac˚ss
;

1532 
	gac˚ss
 = 
ac˚ss_li°_gë
 (
AFI_IP6
, 
¨gv
[0]);

1534 i‡(
	gac˚ss
->
	gªm¨k
)

1536 
XFREE
 (
MTYPE_TMP
, 
ac˚ss
->
ªm¨k
);

1537 
	gac˚ss
->
	gªm¨k
 = 
NULL
;

1539 
	gac˚ss
->
	gªm¨k
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 1);

1541  
	gCMD_SUCCESS
;

1544 
DEFUN
 (
no_ùv6_ac˚ss_li°_ªm¨k
,

1545 
no_ùv6_ac˚ss_li°_ªm¨k_cmd
,

1547 
NO_STR


1548 
IPV6_STR


1553  
vty_ac˚ss_li°_ªm¨k_un£t
 (
vty
, 
AFI_IP6
, 
¨gv
[0]);

1556 
ALIAS
 (
no_ùv6_ac˚ss_li°_ªm¨k
,

1557 
no_ùv6_ac˚ss_li°_ªm¨k_¨g_cmd
,

1559 
NO_STR


1560 
IPV6_STR


1567 
c⁄fig_wrôe_ac˚ss_zebø
 (
vty
 *, 
fûãr
 *);

1568 
c⁄fig_wrôe_ac˚ss_cisco
 (
vty
 *, 
fûãr
 *);

1572 
	$fûãr_show
 (
vty
 *vty, c⁄° *
«me
, 
afi_t
 
afi
)

1574 
ac˚ss_li°
 *
ac˚ss
;

1575 
ac˚ss_ma°î
 *
ma°î
;

1576 
fûãr
 *
mfûãr
;

1577 
fûãr_cisco
 *
fûãr
;

1578 
wrôe
 = 0;

1580 
ma°î
 = 
	`ac˚ss_ma°î_gë
 (
afi
);

1581 i‡(
ma°î
 =
NULL
)

1585 i‡(
zlog_deÁu…
)

1586 
	`vty_out
 (
vty
, "%s:%s",

1587 
zlog_¥Ÿo_«mes
[
zlog_deÁu…
->
¥Ÿocﬁ
], 
VTY_NEWLINE
);

1589 
ac˚ss
 = 
ma°î
->
num
.
hód
;ác˚ss;ác˚s†ac˚ss->
√xt
)

1591 i‡(
«me
 && 
	`°rcmp
 (
ac˚ss
->name,Çame) != 0)

1594 
wrôe
 = 1;

1596 
mfûãr
 = 
ac˚ss
->
hód
; mfûãr; mfûã∏mfûãr->
√xt
)

1598 
fûãr
 = &
mfûãr
->
u
.
cfûãr
;

1600 i‡(
wrôe
)

1602 
	`vty_out
 (
vty
, "%s IP%sáccessÜist %s%s",

1603 
mfûãr
->
cisco
 ?

1604 (
fûãr
->
exãnded
 ? "Extended" : "Standard") : "Zebra",

1605 
afi
 =
AFI_IP6
 ? "v6" : "",

1606 
ac˚ss
->
«me
, 
VTY_NEWLINE
);

1607 
wrôe
 = 0;

1610 
	`vty_out
 (
vty
, " %s%s", 
	`fûãr_ty≥_°r
 (
mfûãr
),

1611 
mfûãr
->
ty≥
 =
FILTER_DENY
 ? " " : "");

1613 i‡(! 
mfûãr
->
cisco
)

1614 
	`c⁄fig_wrôe_ac˚ss_zebø
 (
vty
, 
mfûãr
);

1615 i‡(
fûãr
->
exãnded
)

1616 
	`c⁄fig_wrôe_ac˚ss_cisco
 (
vty
, 
mfûãr
);

1619 i‡(
fûãr
->
addr_mask
.
s_addr
 == 0xffffffff)

1620 
	`vty_out
 (
vty
, "ány%s", 
VTY_NEWLINE
);

1623 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
addr
));

1624 i‡(
fûãr
->
addr_mask
.
s_addr
 != 0)

1625 
	`vty_out
 (
vty
, ", wûdˇrd bô†%s", 
	`öë_¡ﬂ
 (
fûãr
->
addr_mask
));

1626 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1632 
ac˚ss
 = 
ma°î
->
°r
.
hód
;ác˚ss;ác˚s†ac˚ss->
√xt
)

1634 i‡(
«me
 && 
	`°rcmp
 (
ac˚ss
->name,Çame) != 0)

1637 
wrôe
 = 1;

1639 
mfûãr
 = 
ac˚ss
->
hód
; mfûãr; mfûã∏mfûãr->
√xt
)

1641 
fûãr
 = &
mfûãr
->
u
.
cfûãr
;

1643 i‡(
wrôe
)

1645 
	`vty_out
 (
vty
, "%s IP%sáccessÜist %s%s",

1646 
mfûãr
->
cisco
 ?

1647 (
fûãr
->
exãnded
 ? "Extended" : "Standard") : "Zebra",

1648 
afi
 =
AFI_IP6
 ? "v6" : "",

1649 
ac˚ss
->
«me
, 
VTY_NEWLINE
);

1650 
wrôe
 = 0;

1653 
	`vty_out
 (
vty
, " %s%s", 
	`fûãr_ty≥_°r
 (
mfûãr
),

1654 
mfûãr
->
ty≥
 =
FILTER_DENY
 ? " " : "");

1656 i‡(! 
mfûãr
->
cisco
)

1657 
	`c⁄fig_wrôe_ac˚ss_zebø
 (
vty
, 
mfûãr
);

1658 i‡(
fûãr
->
exãnded
)

1659 
	`c⁄fig_wrôe_ac˚ss_cisco
 (
vty
, 
mfûãr
);

1662 i‡(
fûãr
->
addr_mask
.
s_addr
 == 0xffffffff)

1663 
	`vty_out
 (
vty
, "ány%s", 
VTY_NEWLINE
);

1666 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
addr
));

1667 i‡(
fûãr
->
addr_mask
.
s_addr
 != 0)

1668 
	`vty_out
 (
vty
, ", wûdˇrd bô†%s", 
	`öë_¡ﬂ
 (
fûãr
->
addr_mask
));

1669 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1674  
CMD_SUCCESS
;

1675 
	}
}

1677 
DEFUN
 (
show_ù_ac˚ss_li°
,

1678 
show_ù_ac˚ss_li°_cmd
,

1680 
SHOW_STR


1681 
IP_STR


1684  
fûãr_show
 (
vty
, 
NULL
, 
AFI_IP
);

1687 
DEFUN
 (
show_ù_ac˚ss_li°_«me
,

1688 
show_ù_ac˚ss_li°_«me_cmd
,

1690 
SHOW_STR


1691 
IP_STR


1699  
fûãr_show
 (
vty
, 
¨gv
[0], 
AFI_IP
);

1702 #ifde‡
HAVE_IPV6


1703 
DEFUN
 (
show_ùv6_ac˚ss_li°
,

1704 
show_ùv6_ac˚ss_li°_cmd
,

1706 
SHOW_STR


1707 
IPV6_STR


1710  
fûãr_show
 (
vty
, 
NULL
, 
AFI_IP6
);

1713 
DEFUN
 (
show_ùv6_ac˚ss_li°_«me
,

1714 
show_ùv6_ac˚ss_li°_«me_cmd
,

1716 
SHOW_STR


1717 
IPV6_STR


1721  
fûãr_show
 (
vty
, 
¨gv
[0], 
AFI_IP6
);

1726 
	$c⁄fig_wrôe_ac˚ss_cisco
 (
vty
 *vty, 
fûãr
 *
mfûãr
)

1728 
fûãr_cisco
 *
fûãr
;

1730 
fûãr
 = &
mfûãr
->
u
.
cfûãr
;

1732 i‡(
fûãr
->
exãnded
)

1734 
	`vty_out
 (
vty
, " ip");

1735 i‡(
fûãr
->
addr_mask
.
s_addr
 == 0xffffffff)

1736 
	`vty_out
 (
vty
, "ány");

1737 i‡(
fûãr
->
addr_mask
.
s_addr
 == 0)

1738 
	`vty_out
 (
vty
, " ho° %s", 
	`öë_¡ﬂ
 (
fûãr
->
addr
));

1741 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
addr
));

1742 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
addr_mask
));

1745 i‡(
fûãr
->
mask_mask
.
s_addr
 == 0xffffffff)

1746 
	`vty_out
 (
vty
, "ány");

1747 i‡(
fûãr
->
mask_mask
.
s_addr
 == 0)

1748 
	`vty_out
 (
vty
, " ho° %s", 
	`öë_¡ﬂ
 (
fûãr
->
mask
));

1751 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
mask
));

1752 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
mask_mask
));

1754 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1758 i‡(
fûãr
->
addr_mask
.
s_addr
 == 0xffffffff)

1759 
	`vty_out
 (
vty
, "ány%s", 
VTY_NEWLINE
);

1762 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
addr
));

1763 i‡(
fûãr
->
addr_mask
.
s_addr
 != 0)

1764 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
fûãr
->
addr_mask
));

1765 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1768 
	}
}

1771 
	$c⁄fig_wrôe_ac˚ss_zebø
 (
vty
 *vty, 
fûãr
 *
mfûãr
)

1773 
fûãr_zebø
 *
fûãr
;

1774 
¥efix
 *
p
;

1775 
buf
[
BUFSIZ
];

1777 
fûãr
 = &
mfûãr
->
u
.
zfûãr
;

1778 
p
 = &
fûãr
->
¥efix
;

1780 i‡(
p
->
¥efixÀn
 =0 && ! 
fûãr
->
exa˘
)

1781 
	`vty_out
 (
vty
, "ány");

1783 
	`vty_out
 (
vty
, " %s/%d%s",

1784 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

1785 
p
->
¥efixÀn
,

1786 
fûãr
->
exa˘
 ? "Éxact-match" : "");

1788 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1789 
	}
}

1792 
	$c⁄fig_wrôe_ac˚ss
 (
vty
 *vty, 
afi_t
 
afi
)

1794 
ac˚ss_li°
 *
ac˚ss
;

1795 
ac˚ss_ma°î
 *
ma°î
;

1796 
fûãr
 *
mfûãr
;

1797 
wrôe
 = 0;

1799 
ma°î
 = 
	`ac˚ss_ma°î_gë
 (
afi
);

1800 i‡(
ma°î
 =
NULL
)

1803 
ac˚ss
 = 
ma°î
->
num
.
hód
;ác˚ss;ác˚s†ac˚ss->
√xt
)

1805 i‡(
ac˚ss
->
ªm¨k
)

1807 
	`vty_out
 (
vty
, "%saccess-list %sÑemark %s%s",

1808 
afi
 =
AFI_IP
 ? "" : "ipv6 ",

1809 
ac˚ss
->
«me
,ác˚ss->
ªm¨k
,

1810 
VTY_NEWLINE
);

1811 
wrôe
++;

1814 
mfûãr
 = 
ac˚ss
->
hód
; mfûãr; mfûã∏mfûãr->
√xt
)

1816 
	`vty_out
 (
vty
, "%saccess-list %s %s",

1817 
afi
 =
AFI_IP
 ? "" : "ipv6 ",

1818 
ac˚ss
->
«me
,

1819 
	`fûãr_ty≥_°r
 (
mfûãr
));

1821 i‡(
mfûãr
->
cisco
)

1822 
	`c⁄fig_wrôe_ac˚ss_cisco
 (
vty
, 
mfûãr
);

1824 
	`c⁄fig_wrôe_ac˚ss_zebø
 (
vty
, 
mfûãr
);

1826 
wrôe
++;

1830 
ac˚ss
 = 
ma°î
->
°r
.
hód
;ác˚ss;ác˚s†ac˚ss->
√xt
)

1832 i‡(
ac˚ss
->
ªm¨k
)

1834 
	`vty_out
 (
vty
, "%saccess-list %sÑemark %s%s",

1835 
afi
 =
AFI_IP
 ? "" : "ipv6 ",

1836 
ac˚ss
->
«me
,ác˚ss->
ªm¨k
,

1837 
VTY_NEWLINE
);

1838 
wrôe
++;

1841 
mfûãr
 = 
ac˚ss
->
hód
; mfûãr; mfûã∏mfûãr->
√xt
)

1843 
	`vty_out
 (
vty
, "%saccess-list %s %s",

1844 
afi
 =
AFI_IP
 ? "" : "ipv6 ",

1845 
ac˚ss
->
«me
,

1846 
	`fûãr_ty≥_°r
 (
mfûãr
));

1848 i‡(
mfûãr
->
cisco
)

1849 
	`c⁄fig_wrôe_ac˚ss_cisco
 (
vty
, 
mfûãr
);

1851 
	`c⁄fig_wrôe_ac˚ss_zebø
 (
vty
, 
mfûãr
);

1853 
wrôe
++;

1856  
wrôe
;

1857 
	}
}

1860 
cmd_node
 
	gac˚ss_node
 =

1862 
ACCESS_NODE
,

1868 
	$c⁄fig_wrôe_ac˚ss_ùv4
 (
vty
 *vty)

1870  
	`c⁄fig_wrôe_ac˚ss
 (
vty
, 
AFI_IP
);

1871 
	}
}

1874 
	$ac˚ss_li°_ª£t_ùv4
 ()

1876 
ac˚ss_li°
 *
ac˚ss
;

1877 
ac˚ss_li°
 *
√xt
;

1878 
ac˚ss_ma°î
 *
ma°î
;

1880 
ma°î
 = 
	`ac˚ss_ma°î_gë
 (
AFI_IP
);

1881 i‡(
ma°î
 =
NULL
)

1884 
ac˚ss
 = 
ma°î
->
num
.
hód
;ác˚ss;ác˚s†
√xt
)

1886 
√xt
 = 
ac˚ss
->next;

1887 
	`ac˚ss_li°_dñëe
 (
ac˚ss
);

1889 
ac˚ss
 = 
ma°î
->
°r
.
hód
;ác˚ss;ác˚s†
√xt
)

1891 
√xt
 = 
ac˚ss
->next;

1892 
	`ac˚ss_li°_dñëe
 (
ac˚ss
);

1895 
	`as£π
 (
ma°î
->
num
.
hód
 =
NULL
);

1896 
	`as£π
 (
ma°î
->
num
.
èû
 =
NULL
);

1898 
	`as£π
 (
ma°î
->
°r
.
hód
 =
NULL
);

1899 
	`as£π
 (
ma°î
->
°r
.
èû
 =
NULL
);

1900 
	}
}

1904 
	$ac˚ss_li°_öô_ùv4
 ()

1906 
	`ö°Æl_node
 (&
ac˚ss_node
, 
c⁄fig_wrôe_ac˚ss_ùv4
);

1908 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_ac˚ss_li°_cmd
);

1909 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_ac˚ss_li°_«me_cmd
);

1912 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_cmd
);

1913 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exa˘_cmd
);

1914 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_™y_cmd
);

1915 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_cmd
);

1916 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exa˘_cmd
);

1917 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_™y_cmd
);

1920 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_°™d¨d_cmd
);

1921 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_°™d¨d_nomask_cmd
);

1922 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_°™d¨d_ho°_cmd
);

1923 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_°™d¨d_™y_cmd
);

1924 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_°™d¨d_cmd
);

1925 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_°™d¨d_nomask_cmd
);

1926 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_°™d¨d_ho°_cmd
);

1927 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_°™d¨d_™y_cmd
);

1930 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_cmd
);

1931 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_™y_mask_cmd
);

1932 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_mask_™y_cmd
);

1933 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_™y_™y_cmd
);

1934 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_ho°_mask_cmd
);

1935 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_mask_ho°_cmd
);

1936 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_ho°_ho°_cmd
);

1937 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_™y_ho°_cmd
);

1938 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_exãnded_ho°_™y_cmd
);

1939 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_cmd
);

1940 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_™y_mask_cmd
);

1941 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_mask_™y_cmd
);

1942 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_™y_™y_cmd
);

1943 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_ho°_mask_cmd
);

1944 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_mask_ho°_cmd
);

1945 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_ho°_ho°_cmd
);

1946 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_™y_ho°_cmd
);

1947 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_exãnded_ho°_™y_cmd
);

1949 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ac˚ss_li°_ªm¨k_cmd
);

1950 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_Æl_cmd
);

1951 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_ªm¨k_cmd
);

1952 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ac˚ss_li°_ªm¨k_¨g_cmd
);

1953 
	}
}

1955 #ifde‡
HAVE_IPV6


1956 
cmd_node
 
	gac˚ss_ùv6_node
 =

1958 
ACCESS_IPV6_NODE
,

1964 
	$c⁄fig_wrôe_ac˚ss_ùv6
 (
vty
 *vty)

1966  
	`c⁄fig_wrôe_ac˚ss
 (
vty
, 
AFI_IP6
);

1967 
	}
}

1970 
	$ac˚ss_li°_ª£t_ùv6
 ()

1972 
ac˚ss_li°
 *
ac˚ss
;

1973 
ac˚ss_li°
 *
√xt
;

1974 
ac˚ss_ma°î
 *
ma°î
;

1976 
ma°î
 = 
	`ac˚ss_ma°î_gë
 (
AFI_IP6
);

1977 i‡(
ma°î
 =
NULL
)

1980 
ac˚ss
 = 
ma°î
->
num
.
hód
;ác˚ss;ác˚s†
√xt
)

1982 
√xt
 = 
ac˚ss
->next;

1983 
	`ac˚ss_li°_dñëe
 (
ac˚ss
);

1985 
ac˚ss
 = 
ma°î
->
°r
.
hód
;ác˚ss;ác˚s†
√xt
)

1987 
√xt
 = 
ac˚ss
->next;

1988 
	`ac˚ss_li°_dñëe
 (
ac˚ss
);

1991 
	`as£π
 (
ma°î
->
num
.
hód
 =
NULL
);

1992 
	`as£π
 (
ma°î
->
num
.
èû
 =
NULL
);

1994 
	`as£π
 (
ma°î
->
°r
.
hód
 =
NULL
);

1995 
	`as£π
 (
ma°î
->
°r
.
èû
 =
NULL
);

1996 
	}
}

1999 
	$ac˚ss_li°_öô_ùv6
 ()

2001 
	`ö°Æl_node
 (&
ac˚ss_ùv6_node
, 
c⁄fig_wrôe_ac˚ss_ùv6
);

2003 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_ac˚ss_li°_cmd
);

2004 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_ac˚ss_li°_«me_cmd
);

2006 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_ac˚ss_li°_cmd
);

2007 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_ac˚ss_li°_exa˘_cmd
);

2008 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_ac˚ss_li°_™y_cmd
);

2009 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_ac˚ss_li°_exa˘_cmd
);

2010 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_ac˚ss_li°_cmd
);

2011 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_ac˚ss_li°_™y_cmd
);

2013 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_ac˚ss_li°_Æl_cmd
);

2014 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_ac˚ss_li°_ªm¨k_cmd
);

2015 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_ac˚ss_li°_ªm¨k_cmd
);

2016 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_ac˚ss_li°_ªm¨k_¨g_cmd
);

2017 
	}
}

2021 
	$ac˚ss_li°_öô
 ()

2023 
	`ac˚ss_li°_öô_ùv4
 ();

2024 #ifde‡
HAVE_IPV6


2025 
	`ac˚ss_li°_öô_ùv6
();

2027 
	}
}

2030 
	$ac˚ss_li°_ª£t
 ()

2032 
	`ac˚ss_li°_ª£t_ùv4
 ();

2033 #ifde‡
HAVE_IPV6


2034 
	`ac˚ss_li°_ª£t_ùv6
();

2036 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/filter.h

23 #i‚de‡
_ZEBRA_FILTER_H


24 
	#_ZEBRA_FILTER_H


	)

26 
	~"if.h
"

29 
	efûãr_ty≥


31 
	mFILTER_DENY
,

32 
	mFILTER_PERMIT
,

33 
	mFILTER_DYNAMIC


36 
	eac˚ss_ty≥


38 
	mACCESS_TYPE_STRING
,

39 
	mACCESS_TYPE_NUMBER


43 
	sac˚ss_li°


45 *
	m«me
;

46 *
	mªm¨k
;

48 
ac˚ss_ma°î
 *
	mma°î
;

50 
ac˚ss_ty≥
 
	mty≥
;

52 
ac˚ss_li°
 *
	m√xt
;

53 
ac˚ss_li°
 *
	m¥ev
;

55 
fûãr
 *
	mhód
;

56 
fûãr
 *
	mèû
;

60 
ac˚ss_li°_öô
 ();

61 
ac˚ss_li°_ª£t
 ();

62 
ac˚ss_li°_add_hook
 ((*
func
)(
ac˚ss_li°
 *));

63 
	`ac˚ss_li°_dñëe_hook
 ((*
func
)(
ac˚ss_li°
 *));

64 
ac˚ss_li°
 *
	`ac˚ss_li°_lookup
 (
afi_t
, const *);

65 
fûãr_ty≥
 
	`ac˚ss_li°_≠∂y
 (
ac˚ss_li°
 *, *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/getopt.c

29 #i‚de‡
_NO_PROTO


30 
	#_NO_PROTO


	)

33 #ifde‡
HAVE_CONFIG_H


34 
	~<c⁄fig.h
>

37 
	~<zebø.h
>

39 #i‡!
deföed
 
__STDC__
 || !__STDC__

43 c⁄°

	)

47 
	~<°dio.h
>

57 
	#GETOPT_INTERFACE_VERSION
 2

	)

58 #i‡!
deföed
 
_LIBC
 && deföed 
__GLIBC__
 && __GLIBC__ >= 2

59 
	~<gnu-vîsi⁄s.h
>

60 #i‡
_GNU_GETOPT_INTERFACE_VERSION
 =
GETOPT_INTERFACE_VERSION


61 
	#ELIDE_CODE


	)

65 #i‚de‡
ELIDE_CODE


70 #ifdef 
__GNU_LIBRARY__


73 
	~<°dlib.h
>

74 
	~<uni°d.h
>

77 #ifde‡
VMS


78 
	~<unixlib.h
>

79 #i‡
HAVE_STRING_H
 - 0

80 
	~<°rög.h
>

84 #i‚de‡
_


87 #ifde‡
HAVE_LIBINTL_H


88 
	~<liböé.h
>

89 
	#_
(
msgid
Ë
	`gëãxt
 (msgid)

	)

91 
	#_
(
msgid
Ë(msgid)

	)

109 
	~"gë›t.h
"

117 *
	g›èrg
 = 
NULL
;

132 
	g›töd
 = 1;

138 
	g__gë›t_öôülized
 = 0;

147 *
	g√xtch¨
;

152 
	g›ãº
 = 1;

158 
	g›t›t
 = '?';

191 
	mREQUIRE_ORDER
, 
	mPERMUTE
, 
	mRETURN_IN_ORDER


192 } 
	g‹dîög
;

195 *
	gposixly_c‹ª˘
;

197 #ifdef 
__GNU_LIBRARY__


202 
	~<°rög.h
>

203 
	#my_ödex
 
°rchr


	)

206 #i‡
HAVE_STRING_H


207 
	~<°rög.h
>

209 
	~<°rögs.h
>

215 #i‚de‡
gëív


216 *
gëív
 ();

220 
	$my_ödex
 (
°r
, 
chr
)

221 c⁄° *
°r
;

222 
chr
;

224 *
°r
)

226 i‡(*
°r
 =
chr
)

227  (*Ë
°r
;

228 
°r
++;

231 
	}
}

235 #ifde‡
__GNUC__


238 #i‡(!
deföed
 
__STDC__
 || !__STDC__Ë&& !deföed 
°æí


241 
°æí
 (const *);

253 
	gfú°_n⁄›t
;

254 
	gœ°_n⁄›t
;

256 #ifde‡
_LIBC


261 *
__gë›t_n⁄›ti⁄_Êags
;

263 
	gn⁄›ti⁄_Êags_max_Àn
;

264 
	gn⁄›ti⁄_Êags_Àn
;

266 
	g‹igöÆ_¨gc
;

267 *c⁄° *
	g‹igöÆ_¨gv
;

273 
__©åibuã__
 ((
unu£d
))

274 
	$°‹e_¨gs_™d_ív
 (
¨gc
, *c⁄° *
¨gv
)

278 
‹igöÆ_¨gc
 = 
¨gc
;

279 
‹igöÆ_¨gv
 = 
¨gv
;

280 
	}
}

281 #ifde‡
ãxt_£t_ñemít


282 
ãxt_£t_ñemít
 (
__libc_suböô
, 
°‹e_¨gs_™d_ív
);

285 
	#SWAP_FLAGS
(
ch1
, 
ch2
) \

286 i‡(
n⁄›ti⁄_Êags_Àn
 > 0) \

288 
__tmp
 = 
__gë›t_n⁄›ti⁄_Êags
[
ch1
]; \

289 
__gë›t_n⁄›ti⁄_Êags
[
ch1
] = __gë›t_n⁄›ti⁄_Êags[
ch2
]; \

290 
__gë›t_n⁄›ti⁄_Êags
[
ch2
] = 
__tmp
; \

291 }

	)

293 
	#SWAP_FLAGS
(
ch1
, 
ch2
)

	)

305 #i‡
deföed
 
__STDC__
 && __STDC__

306 
exch™ge
 (**);

310 
	$exch™ge
 (
¨gv
)

311 **
¨gv
;

313 
bŸtom
 = 
fú°_n⁄›t
;

314 
middÀ
 = 
œ°_n⁄›t
;

315 
t›
 = 
›töd
;

316 *
ãm
;

323 #ifde‡
_LIBC


327 i‡(
n⁄›ti⁄_Êags_Àn
 > 0 && 
t›
 >
n⁄›ti⁄_Êags_max_Àn
)

331 *
√w_°r
 = 
	`mÆloc
 (
t›
 + 1);

332 i‡(
√w_°r
 =
NULL
)

333 
n⁄›ti⁄_Êags_Àn
 = 
n⁄›ti⁄_Êags_max_Àn
 = 0;

336 
	`mem£t
 (
	`__memp˝y
 (
√w_°r
, 
__gë›t_n⁄›ti⁄_Êags
,

337 
n⁄›ti⁄_Êags_max_Àn
),

338 '\0', 
t›
 + 1 - 
n⁄›ti⁄_Êags_max_Àn
);

339 
n⁄›ti⁄_Êags_max_Àn
 = 
t›
 + 1;

340 
__gë›t_n⁄›ti⁄_Êags
 = 
√w_°r
;

345 
t›
 > 
middÀ
 && middÀ > 
bŸtom
)

347 i‡(
t›
 - 
middÀ
 > middÀ - 
bŸtom
)

350 
Àn
 = 
middÀ
 - 
bŸtom
;

351 
i
;

354 
i
 = 0; i < 
Àn
; i++)

356 
ãm
 = 
¨gv
[
bŸtom
 + 
i
];

357 
¨gv
[
bŸtom
 + 
i
] =árgv[
t›
 - (
middÀ
 - bottom) + i];

358 
¨gv
[
t›
 - (
middÀ
 - 
bŸtom
Ë+ 
i
] = 
ãm
;

359 
	`SWAP_FLAGS
 (
bŸtom
 + 
i
, 
t›
 - (
middÀ
 - bottom) + i);

362 
t›
 -
Àn
;

367 
Àn
 = 
t›
 - 
middÀ
;

368 
i
;

371 
i
 = 0; i < 
Àn
; i++)

373 
ãm
 = 
¨gv
[
bŸtom
 + 
i
];

374 
¨gv
[
bŸtom
 + 
i
] =árgv[
middÀ
 + i];

375 
¨gv
[
middÀ
 + 
i
] = 
ãm
;

376 
	`SWAP_FLAGS
 (
bŸtom
 + 
i
, 
middÀ
 + i);

379 
bŸtom
 +
Àn
;

385 
fú°_n⁄›t
 +(
›töd
 - 
œ°_n⁄›t
);

386 
œ°_n⁄›t
 = 
›töd
;

387 
	}
}

391 #i‡
deföed
 
__STDC__
 && __STDC__

392 c⁄° *
_gë›t_öôülize
 (, *const *, const *);

395 
	$_gë›t_öôülize
 (
¨gc
, 
¨gv
, 
›t°rög
)

396 
¨gc
;

397 *c⁄° *
¨gv
;

398 c⁄° *
›t°rög
;

404 
fú°_n⁄›t
 = 
œ°_n⁄›t
 = 
›töd
;

406 
√xtch¨
 = 
NULL
;

408 
posixly_c‹ª˘
 = 
	`gëív
 ("POSIXLY_CORRECT");

412 i‡(
›t°rög
[0] == '-')

414 
‹dîög
 = 
RETURN_IN_ORDER
;

415 ++
›t°rög
;

417 i‡(
›t°rög
[0] == '+')

419 
‹dîög
 = 
REQUIRE_ORDER
;

420 ++
›t°rög
;

422 i‡(
posixly_c‹ª˘
 !
NULL
)

423 
‹dîög
 = 
REQUIRE_ORDER
;

425 
‹dîög
 = 
PERMUTE
;

427 #ifde‡
_LIBC


428 i‡(
posixly_c‹ª˘
 =
NULL


429 && 
¨gc
 =
‹igöÆ_¨gc
 && 
¨gv
 =
‹igöÆ_¨gv
)

431 i‡(
n⁄›ti⁄_Êags_max_Àn
 == 0)

433 i‡(
__gë›t_n⁄›ti⁄_Êags
 =
NULL


434 || 
__gë›t_n⁄›ti⁄_Êags
[0] == '\0')

435 
n⁄›ti⁄_Êags_max_Àn
 = -1;

438 c⁄° *
‹ig_°r
 = 
__gë›t_n⁄›ti⁄_Êags
;

439 
Àn
 = 
n⁄›ti⁄_Êags_max_Àn
 = 
	`°æí
 (
‹ig_°r
);

440 i‡(
n⁄›ti⁄_Êags_max_Àn
 < 
¨gc
)

441 
n⁄›ti⁄_Êags_max_Àn
 = 
¨gc
;

442 
__gë›t_n⁄›ti⁄_Êags
 =

443 (*Ë
	`mÆloc
 (
n⁄›ti⁄_Êags_max_Àn
);

444 i‡(
__gë›t_n⁄›ti⁄_Êags
 =
NULL
)

445 
n⁄›ti⁄_Êags_max_Àn
 = -1;

447 
	`mem£t
 (
	`__memp˝y
 (
__gë›t_n⁄›ti⁄_Êags
, 
‹ig_°r
, 
Àn
),

448 '\0', 
n⁄›ti⁄_Êags_max_Àn
 - 
Àn
);

451 
n⁄›ti⁄_Êags_Àn
 = 
n⁄›ti⁄_Êags_max_Àn
;

454 
n⁄›ti⁄_Êags_Àn
 = 0;

457  
›t°rög
;

458 
	}
}

517 
	$_gë›t_öã∫Æ
 (
¨gc
, 
¨gv
, 
›t°rög
, 
l⁄g›ts
, 
l⁄göd
, 
l⁄g_⁄ly
)

518 
¨gc
;

519 *c⁄° *
¨gv
;

520 c⁄° *
›t°rög
;

521 c⁄° 
›ti⁄
 *
l⁄g›ts
;

522 *
l⁄göd
;

523 
l⁄g_⁄ly
;

525 
›èrg
 = 
NULL
;

527 i‡(
›töd
 =0 || !
__gë›t_öôülized
)

529 i‡(
›töd
 == 0)

530 
›töd
 = 1;

531 
›t°rög
 = 
	`_gë›t_öôülize
 (
¨gc
, 
¨gv
, optstring);

532 
__gë›t_öôülized
 = 1;

539 #ifde‡
_LIBC


540 
	#NONOPTION_P
 (
¨gv
[
›töd
][0] != '-' ||árgv[optind][1] == '\0' \

541 || (
›töd
 < 
n⁄›ti⁄_Êags_Àn
 \

542 && 
__gë›t_n⁄›ti⁄_Êags
[
›töd
] ='1'))

	)

544 
	#NONOPTION_P
 (
¨gv
[
›töd
][0] !'-' ||árgv[›töd][1] ='\0')

	)

547 i‡(
√xtch¨
 =
NULL
 || *nextchar == '\0')

553 i‡(
œ°_n⁄›t
 > 
›töd
)

554 
œ°_n⁄›t
 = 
›töd
;

555 i‡(
fú°_n⁄›t
 > 
›töd
)

556 
fú°_n⁄›t
 = 
›töd
;

558 i‡(
‹dîög
 =
PERMUTE
)

563 i‡(
fú°_n⁄›t
 !
œ°_n⁄›t
 &&Üa°_n⁄›à!
›töd
)

564 
	`exch™ge
 ((**Ë
¨gv
);

565 i‡(
œ°_n⁄›t
 !
›töd
)

566 
fú°_n⁄›t
 = 
›töd
;

571 
›töd
 < 
¨gc
 && 
NONOPTION_P
)

572 
›töd
++;

573 
œ°_n⁄›t
 = 
›töd
;

581 i‡(
›töd
 !
¨gc
 && !
	`°rcmp
 (
¨gv
[optind], "--"))

583 
›töd
++;

585 i‡(
fú°_n⁄›t
 !
œ°_n⁄›t
 &&Üa°_n⁄›à!
›töd
)

586 
	`exch™ge
 ((**Ë
¨gv
);

587 i‡(
fú°_n⁄›t
 =
œ°_n⁄›t
)

588 
fú°_n⁄›t
 = 
›töd
;

589 
œ°_n⁄›t
 = 
¨gc
;

591 
›töd
 = 
¨gc
;

597 i‡(
›töd
 =
¨gc
)

601 i‡(
fú°_n⁄›t
 !
œ°_n⁄›t
)

602 
›töd
 = 
fú°_n⁄›t
;

609 i‡(
NONOPTION_P
)

611 i‡(
‹dîög
 =
REQUIRE_ORDER
)

613 
›èrg
 = 
¨gv
[
›töd
++];

620 
√xtch¨
 = (
¨gv
[
›töd
] + 1

621 + (
l⁄g›ts
 !
NULL
 && 
¨gv
[
›töd
][1] == '-'));

639 i‡(
l⁄g›ts
 !
NULL


640 && (
¨gv
[
›töd
][1] == '-'

641 || (
l⁄g_⁄ly
 && (
¨gv
[
›töd
][2] || !
	`my_ödex
 (
›t°rög
,árgv[optind][1])))))

643 *
«mìnd
;

644 c⁄° 
›ti⁄
 *
p
;

645 c⁄° 
›ti⁄
 *
pfound
 = 
NULL
;

646 
exa˘
 = 0;

647 
ambig
 = 0;

648 
ödfound
 = -1;

649 
›ti⁄_ödex
;

651 
«mìnd
 = 
√xtch¨
; *nameend && *nameend != '=';Çameend++)

656 
p
 = 
l⁄g›ts
, 
›ti⁄_ödex
 = 0;Ö->
«me
;Ö++, option_index++)

657 i‡(!
	`°∫cmp
 (
p
->
«me
, 
√xtch¨
, 
«mìnd
 -Çextchar))

659 i‡((Ë(
«mìnd
 - 
√xtch¨
)

660 =(Ë
	`°æí
 (
p
->
«me
))

663 
pfound
 = 
p
;

664 
ödfound
 = 
›ti⁄_ödex
;

665 
exa˘
 = 1;

668 i‡(
pfound
 =
NULL
)

671 
pfound
 = 
p
;

672 
ödfound
 = 
›ti⁄_ödex
;

676 
ambig
 = 1;

679 i‡(
ambig
 && !
exa˘
)

681 i‡(
›ãº
)

682 
	`Ârötf
 (
°dîr
, 
	`_
("%s: option `%s' isámbiguous\n"),

683 
¨gv
[0],árgv[
›töd
]);

684 
√xtch¨
 +
	`°æí
 (nextchar);

685 
›töd
++;

686 
›t›t
 = 0;

690 i‡(
pfound
 !
NULL
)

692 
›ti⁄_ödex
 = 
ödfound
;

693 
›töd
++;

694 i‡(*
«mìnd
)

698 i‡(
pfound
->
has_¨g
)

699 
›èrg
 = 
«mìnd
 + 1;

702 i‡(
›ãº
)

704 i‡(
¨gv
[
›töd
 - 1][1] == '-')

706 
	`Ârötf
 (
°dîr
,

707 
	`_
("%s: option `--%s' doesn'tállowánárgument\n"),

708 
¨gv
[0], 
pfound
->
«me
);

711 
	`Ârötf
 (
°dîr
,

712 
	`_
("%s: option `%c%s' doesn'tállowánárgument\n"),

713 
¨gv
[0],árgv[
›töd
 - 1][0], 
pfound
->
«me
);

716 
√xtch¨
 +
	`°æí
 (nextchar);

718 
›t›t
 = 
pfound
->
vÆ
;

722 i‡(
pfound
->
has_¨g
 == 1)

724 i‡(
›töd
 < 
¨gc
)

725 
›èrg
 = 
¨gv
[
›töd
++];

728 i‡(
›ãº
)

729 
	`Ârötf
 (
°dîr
,

730 
	`_
("%s: option `%s'Ñequiresánárgument\n"),

731 
¨gv
[0],árgv[
›töd
 - 1]);

732 
√xtch¨
 +
	`°æí
 (nextchar);

733 
›t›t
 = 
pfound
->
vÆ
;

734  
›t°rög
[0] == ':' ? ':' : '?';

737 
√xtch¨
 +
	`°æí
 (nextchar);

738 i‡(
l⁄göd
 !
NULL
)

739 *
l⁄göd
 = 
›ti⁄_ödex
;

740 i‡(
pfound
->
Êag
)

742 *(
pfound
->
Êag
Ëpfound->
vÆ
;

745  
pfound
->
vÆ
;

752 i‡(!
l⁄g_⁄ly
 || 
¨gv
[
›töd
][1] == '-'

753 || 
	`my_ödex
 (
›t°rög
, *
√xtch¨
Ë=
NULL
)

755 i‡(
›ãº
)

757 i‡(
¨gv
[
›töd
][1] == '-')

759 
	`Ârötf
 (
°dîr
, 
	`_
("%s: unrecognized option `--%s'\n"),

760 
¨gv
[0], 
√xtch¨
);

763 
	`Ârötf
 (
°dîr
, 
	`_
("%s: unrecognized option `%c%s'\n"),

764 
¨gv
[0],árgv[
›töd
][0], 
√xtch¨
);

766 
√xtch¨
 = (*) "";

767 
›töd
++;

768 
›t›t
 = 0;

776 
c
 = *
√xtch¨
++;

777 *
ãmp
 = 
	`my_ödex
 (
›t°rög
, 
c
);

780 i‡(*
√xtch¨
 == '\0')

781 ++
›töd
;

783 i‡(
ãmp
 =
NULL
 || 
c
 == ':')

785 i‡(
›ãº
)

787 i‡(
posixly_c‹ª˘
)

789 
	`Ârötf
 (
°dîr
, 
	`_
("%s: illegal option -- %c\n"),

790 
¨gv
[0], 
c
);

792 
	`Ârötf
 (
°dîr
, 
	`_
("%s: invalid option -- %c\n"),

793 
¨gv
[0], 
c
);

795 
›t›t
 = 
c
;

799 i‡(
ãmp
[0] == 'W' &&Åemp[1] == ';')

801 *
«mìnd
;

802 c⁄° 
›ti⁄
 *
p
;

803 c⁄° 
›ti⁄
 *
pfound
 = 
NULL
;

804 
exa˘
 = 0;

805 
ambig
 = 0;

806 
ödfound
 = 0;

807 
›ti⁄_ödex
;

810 i‡(*
√xtch¨
 != '\0')

812 
›èrg
 = 
√xtch¨
;

815 
›töd
++;

817 i‡(
›töd
 =
¨gc
)

819 i‡(
›ãº
)

822 
	`Ârötf
 (
°dîr
, 
	`_
("%s: optionÑequiresánárgument -- %c\n"),

823 
¨gv
[0], 
c
);

825 
›t›t
 = 
c
;

826 i‡(
›t°rög
[0] == ':')

827 
c
 = ':';

829 
c
 = '?';

830  
c
;

835 
›èrg
 = 
¨gv
[
›töd
++];

840 
√xtch¨
 = 
«mìnd
 = 
›èrg
; *nameend && *nameend != '=';Çameend++)

845 
p
 = 
l⁄g›ts
, 
›ti⁄_ödex
 = 0;Ö->
«me
;Ö++, option_index++)

846 i‡(!
	`°∫cmp
 (
p
->
«me
, 
√xtch¨
, 
«mìnd
 -Çextchar))

848 i‡((Ë(
«mìnd
 - 
√xtch¨
Ë=
	`°æí
 (
p
->
«me
))

851 
pfound
 = 
p
;

852 
ödfound
 = 
›ti⁄_ödex
;

853 
exa˘
 = 1;

856 i‡(
pfound
 =
NULL
)

859 
pfound
 = 
p
;

860 
ödfound
 = 
›ti⁄_ödex
;

864 
ambig
 = 1;

866 i‡(
ambig
 && !
exa˘
)

868 i‡(
›ãº
)

869 
	`Ârötf
 (
°dîr
, 
	`_
("%s: option `-W %s' isámbiguous\n"),

870 
¨gv
[0],árgv[
›töd
]);

871 
√xtch¨
 +
	`°æí
 (nextchar);

872 
›töd
++;

875 i‡(
pfound
 !
NULL
)

877 
›ti⁄_ödex
 = 
ödfound
;

878 i‡(*
«mìnd
)

882 i‡(
pfound
->
has_¨g
)

883 
›èrg
 = 
«mìnd
 + 1;

886 i‡(
›ãº
)

887 
	`Ârötf
 (
°dîr
, 
	`_
("\
%s: option `-W %s' doesn'tállowánárgument\n"),

889 
¨gv
[0], 
pfound
->
«me
);

891 
√xtch¨
 +
	`°æí
 (nextchar);

895 i‡(
pfound
->
has_¨g
 == 1)

897 i‡(
›töd
 < 
¨gc
)

898 
›èrg
 = 
¨gv
[
›töd
++];

901 i‡(
›ãº
)

902 
	`Ârötf
 (
°dîr
,

903 
	`_
("%s: option `%s'Ñequiresánárgument\n"),

904 
¨gv
[0],árgv[
›töd
 - 1]);

905 
√xtch¨
 +
	`°æí
 (nextchar);

906  
›t°rög
[0] == ':' ? ':' : '?';

909 
√xtch¨
 +
	`°æí
 (nextchar);

910 i‡(
l⁄göd
 !
NULL
)

911 *
l⁄göd
 = 
›ti⁄_ödex
;

912 i‡(
pfound
->
Êag
)

914 *(
pfound
->
Êag
Ëpfound->
vÆ
;

917  
pfound
->
vÆ
;

919 
√xtch¨
 = 
NULL
;

922 i‡(
ãmp
[1] == ':')

924 i‡(
ãmp
[2] == ':')

927 i‡(*
√xtch¨
 != '\0')

929 
›èrg
 = 
√xtch¨
;

930 
›töd
++;

933 
›èrg
 = 
NULL
;

934 
√xtch¨
 = 
NULL
;

939 i‡(*
√xtch¨
 != '\0')

941 
›èrg
 = 
√xtch¨
;

944 
›töd
++;

946 i‡(
›töd
 =
¨gc
)

948 i‡(
›ãº
)

951 
	`Ârötf
 (
°dîr
,

952 
	`_
("%s: optionÑequiresánárgument -- %c\n"),

953 
¨gv
[0], 
c
);

955 
›t›t
 = 
c
;

956 i‡(
›t°rög
[0] == ':')

957 
c
 = ':';

959 
c
 = '?';

964 
›èrg
 = 
¨gv
[
›töd
++];

965 
√xtch¨
 = 
NULL
;

968  
c
;

970 
	}
}

972 #ifde‡
REALLY_NEED_PLAIN_GETOPT


975 
	$gë›t
 (
¨gc
, 
¨gv
, 
›t°rög
)

976 
¨gc
;

977 *c⁄° *
¨gv
;

978 c⁄° *
›t°rög
;

980  
	`_gë›t_öã∫Æ
 (
¨gc
, 
¨gv
, 
›t°rög
,

981 (c⁄° 
›ti⁄
 *) 0,

984 
	}
}

990 #ifde‡
TEST


996 
	$maö
 (
¨gc
, 
¨gv
)

997 
¨gc
;

998 **
¨gv
;

1000 
c
;

1001 
digô_›töd
 = 0;

1005 
this_›ti⁄_›töd
 = 
›töd
 ? optind : 1;

1007 
c
 = 
	`gë›t
 (
¨gc
, 
¨gv
, "abc:d:0123456789");

1008 i‡(
c
 == -1)

1011 
c
)

1023 i‡(
digô_›töd
 !0 && digô_›töd !
this_›ti⁄_›töd
)

1024 
	`¥ötf
 ("digits occur inÅwo differentárgv-elements.\n");

1025 
digô_›töd
 = 
this_›ti⁄_›töd
;

1026 
	`¥ötf
 ("›ti⁄ %c\n", 
c
);

1030 
	`¥ötf
 ("optioná\n");

1034 
	`¥ötf
 ("option b\n");

1038 
	`¥ötf
 ("›ti⁄ c wôh vÆuê`%s'\n", 
›èrg
);

1045 
	`¥ötf
 ("?? gë›àªtu∫ed ch¨a˘î codê0%ÿ??\n", 
c
);

1049 i‡(
›töd
 < 
¨gc
)

1051 
	`¥ötf
 ("non-option ARGV-elements: ");

1052 
›töd
 < 
¨gc
)

1053 
	`¥ötf
 ("%†", 
¨gv
[
›töd
++]);

1054 
	`¥ötf
 ("\n");

1057 
	`exô
 (0);

1058 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/getopt.h

22 #i‚de‡
_GETOPT_H


23 
	#_GETOPT_H
 1

	)

37 #ifdef 
__˝lu•lus


47 *
›èrg
;

61 
›töd
;

66 
›ãº
;

70 
›t›t
;

93 
	s›ti⁄


95 #i‡
deföed
 (
__STDC__
) && __STDC__

96 c⁄° *
	g«me
;

98 *
	g«me
;

102 
	ghas_¨g
;

103 *
	gÊag
;

104 
	gvÆ
;

109 
	#no_¨gumít
 0

	)

110 
	#ªquúed_¨gumít
 1

	)

111 
	#›ti⁄Æ_¨gumít
 2

	)

113 #i‡
deföed
 (
__STDC__
) && __STDC__

115 #i‡
REALLY_NEED_PLAIN_GETOPT


122 #i‚de‡
NONPOSIX_GETOPT_DEFINITION


123 
gë›t
 (
¨gc
, *c⁄° *
¨gv
, c⁄° *
sh‹t›ts
);

125 
gë›t
 ();

131 
gë›t_l⁄g
 (
¨gc
, *c⁄° *
¨gv
, c⁄° *
sh‹t›ts
,

132 c⁄° 
›ti⁄
 *
l⁄g›ts
, *
l⁄göd
);

133 
gë›t_l⁄g_⁄ly
 (
¨gc
, *c⁄° *
¨gv
,

134 c⁄° *
sh‹t›ts
,

135 c⁄° 
›ti⁄
 *
l⁄g›ts
, *
l⁄göd
);

138 
_gë›t_öã∫Æ
 (
¨gc
, *c⁄° *
¨gv
,

139 c⁄° *
sh‹t›ts
,

140 c⁄° 
›ti⁄
 *
l⁄g›ts
, *
l⁄göd
,

141 
l⁄g_⁄ly
);

144 #ifde‡
REALLY_NEED_PLAIN_GETOPT


145 
gë›t
 ();

148 
gë›t_l⁄g
 ();

149 
gë›t_l⁄g_⁄ly
 ();

151 
_gë›t_öã∫Æ
 ();

155 #ifdef 
__˝lu•lus


	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/getopt1.c

23 #ifde‡
HAVE_CONFIG_H


24 
	~<c⁄fig.h
>

27 
	~<zebø.h
>

28 
	~"gë›t.h
"

30 #i‡!
deföed
 
__STDC__
 || !__STDC__

34 c⁄°

	)

38 
	~<°dio.h
>

48 
	#GETOPT_INTERFACE_VERSION
 2

	)

49 #i‡!
deföed
 
_LIBC
 && deföed 
__GLIBC__
 && __GLIBC__ >= 2

50 
	~<gnu-vîsi⁄s.h
>

51 #i‡
_GNU_GETOPT_INTERFACE_VERSION
 =
GETOPT_INTERFACE_VERSION


52 
	#ELIDE_CODE


	)

56 #i‚de‡
ELIDE_CODE


61 #ifde‡
__GNU_LIBRARY__


62 
	~<°dlib.h
>

65 #i‚def 
NULL


66 
	#NULL
 0

	)

70 
	$gë›t_l⁄g
 (
¨gc
, 
¨gv
, 
›ti⁄s
, 
l⁄g_›ti⁄s
, 
›t_ödex
)

71 
¨gc
;

72 *c⁄° *
¨gv
;

73 c⁄° *
›ti⁄s
;

74 c⁄° 
›ti⁄
 *
l⁄g_›ti⁄s
;

75 *
›t_ödex
;

77  
	`_gë›t_öã∫Æ
 (
¨gc
, 
¨gv
, 
›ti⁄s
, 
l⁄g_›ti⁄s
, 
›t_ödex
, 0);

78 
	}
}

86 
	$gë›t_l⁄g_⁄ly
 (
¨gc
, 
¨gv
, 
›ti⁄s
, 
l⁄g_›ti⁄s
, 
›t_ödex
)

87 
¨gc
;

88 *c⁄° *
¨gv
;

89 c⁄° *
›ti⁄s
;

90 c⁄° 
›ti⁄
 *
l⁄g_›ti⁄s
;

91 *
›t_ödex
;

93  
	`_gë›t_öã∫Æ
 (
¨gc
, 
¨gv
, 
›ti⁄s
, 
l⁄g_›ti⁄s
, 
›t_ödex
, 1);

94 
	}
}

99 #ifde‡
TEST


101 
	~<°dio.h
>

104 
	$maö
 (
¨gc
, 
¨gv
)

105 
¨gc
;

106 **
¨gv
;

108 
c
;

109 
digô_›töd
 = 0;

113 
this_›ti⁄_›töd
 = 
›töd
 ? optind : 1;

114 
›ti⁄_ödex
 = 0;

115 
›ti⁄
 
l⁄g_›ti⁄s
[] =

126 
c
 = 
	`gë›t_l⁄g
 (
¨gc
, 
¨gv
, "abc:d:0123456789",

127 
l⁄g_›ti⁄s
, &
›ti⁄_ödex
);

128 i‡(
c
 == -1)

131 
c
)

134 
	`¥ötf
 ("›ti⁄ %s", 
l⁄g_›ti⁄s
[
›ti⁄_ödex
].
«me
);

135 i‡(
›èrg
)

136 
	`¥ötf
 (" wôhárg %s", 
›èrg
);

137 
	`¥ötf
 ("\n");

150 i‡(
digô_›töd
 !0 && digô_›töd !
this_›ti⁄_›töd
)

151 
	`¥ötf
 ("digits occur inÅwo differentárgv-elements.\n");

152 
digô_›töd
 = 
this_›ti⁄_›töd
;

153 
	`¥ötf
 ("›ti⁄ %c\n", 
c
);

157 
	`¥ötf
 ("optioná\n");

161 
	`¥ötf
 ("option b\n");

165 
	`¥ötf
 ("›ti⁄ c wôh vÆuê`%s'\n", 
›èrg
);

169 
	`¥ötf
 ("›ti⁄ d wôh vÆuê`%s'\n", 
›èrg
);

176 
	`¥ötf
 ("?? gë›àªtu∫ed ch¨a˘î codê0%ÿ??\n", 
c
);

180 i‡(
›töd
 < 
¨gc
)

182 
	`¥ötf
 ("non-option ARGV-elements: ");

183 
›töd
 < 
¨gc
)

184 
	`¥ötf
 ("%†", 
¨gv
[
›töd
++]);

185 
	`¥ötf
 ("\n");

188 
	`exô
 (0);

189 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/hash.c

22 
	~<zebø.h
>

24 
	~"hash.h
"

25 
	~"mem‹y.h
"

28 
hash
 *

29 
hash_¸óã_size
 (
size
, (*
hash_key
) (*),

30 (*
hash_cmp
) (const *, const *))

32 
hash
 *hash;

34 
hash
 = 
	`XMALLOC
 (
MTYPE_HASH
,  (hash));

35 
hash
->
ödex
 = 
	`XCALLOC
 (
MTYPE_HASH_INDEX
,

36  (
hash_backë
 *Ë* 
size
);

37 
hash
->
size
 = size;

38 
hash
->
hash_key
 = hash_key;

39 
hash
->
hash_cmp
 = hash_cmp;

40 
hash
->
cou¡
 = 0;

42  
hash
;

43 
	}
}

46 
hash
 *

47 
hash_¸óã
 ((*
hash_key
) (*),

48 (*
hash_cmp
) (const *, const *))

50  
	`hash_¸óã_size
 (
HASHTABSIZE
, 
hash_key
, 
hash_cmp
);

51 
	}
}

57 
	$hash_Æloc_öã∫
 (*
¨g
)

59  
¨g
;

60 
	}
}

66 
hash_gë
 (
hash
 *hash, *
d©a
, * (*
Æloc_func
) (*))

68 
	gkey
;

69 
	gödex
;

70 *
	g√wd©a
;

71 
hash_backë
 *
	gbackë
;

73 
	gkey
 = (*
hash
->
hash_key
Ë(
d©a
);

74 
	gödex
 = 
key
 % 
hash
->
size
;

76 
	gbackë
 = 
hash
->
ödex
[ödex]; backë !
NULL
; backë = 
backë
->
√xt
)

77 i‡(
backë
->
key
 =key && (*
hash
->
hash_cmp
Ë(backë->
d©a
, 
	gd©a
))

78  
	gbackë
->
	gd©a
;

80 i‡(
	gÆloc_func
)

82 
	g√wd©a
 = (*
Æloc_func
Ë(
d©a
);

83 i‡(
	g√wd©a
 =
NULL
)

84  
NULL
;

86 
	gbackë
 = 
XMALLOC
 (
MTYPE_HASH_BACKET
,  (
hash_backë
));

87 
	gbackë
->
	gd©a
 = 
√wd©a
;

88 
	gbackë
->
	gkey
 = 
key
;

89 
	gbackë
->
	g√xt
 = 
hash
->
ödex
[index];

90 
	ghash
->
	gödex
[
ödex
] = 
backë
;

91 
	ghash
->
	gcou¡
++;

92  
	gbackë
->
	gd©a
;

94  
	gNULL
;

99 
	$hash_lookup
 (
hash
 *hash, *
d©a
)

101  
	`hash_gë
 (
hash
, 
d©a
, 
NULL
);

102 
	}
}

105 
	$°rög_hash_make
 (c⁄° *
°r
)

107 
hash
 = 0;

109 *
°r
)

110 
hash
 = (hash * 33Ë^ (Ë*
°r
++;

112  
hash
;

113 
	}
}

119 
	$hash_ªÀa£
 (
hash
 *hash, *
d©a
)

121 *
ªt
;

122 
key
;

123 
ödex
;

124 
hash_backë
 *
backë
;

125 
hash_backë
 *
µ
;

127 
key
 = (*
hash
->
hash_key
Ë(
d©a
);

128 
ödex
 = 
key
 % 
hash
->
size
;

130 
backë
 = 
µ
 = 
hash
->
ödex
[ödex]; backë; backë = backë->
√xt
)

132 i‡(
backë
->
key
 =key && (*
hash
->
hash_cmp
Ë(backë->
d©a
, data))

134 i‡(
backë
 =
µ
)

135 
hash
->
ödex
[ödex] = 
backë
->
√xt
;

137 
µ
->
√xt
 = 
backë
->next;

139 
ªt
 = 
backë
->
d©a
;

140 
	`XFREE
 (
MTYPE_HASH_BACKET
, 
backë
);

141 
hash
->
cou¡
--;

142  
ªt
;

144 
µ
 = 
backë
;

146  
NULL
;

147 
	}
}

151 
hash_ôî©e
 (
hash
 *hash,

152 (*
func
Ë(
hash_backë
 *, *), *
¨g
)

154 
i
;

155 
hash_backë
 *
hb
;

156 
hash_backë
 *
hb√xt
;

158 
i
 = 0; i < 
hash
->
size
; i++)

159 
hb
 = 
hash
->
ödex
[
i
]; hb; hb = 
hb√xt
)

164 
hb√xt
 = 
hb
->
√xt
;

165 (*
func
Ë(
hb
, 
¨g
);

167 
	}
}

171 
hash_˛ón
 (
hash
 *hash, (*
‰ì_func
) (*))

173 
i
;

174 
hash_backë
 *
hb
;

175 
hash_backë
 *
√xt
;

177 
i
 = 0; i < 
hash
->
size
; i++)

179 
hb
 = 
hash
->
ödex
[
i
]; hb; hb = 
√xt
)

181 
√xt
 = 
hb
->next;

183 i‡(
‰ì_func
)

184 (*
‰ì_func
Ë(
hb
->
d©a
);

186 
	`XFREE
 (
MTYPE_HASH_BACKET
, 
hb
);

187 
hash
->
cou¡
--;

189 
hash
->
ödex
[
i
] = 
NULL
;

191 
	}
}

196 
	$hash_‰ì
 (
hash
 *hash)

198 
	`XFREE
 (
MTYPE_HASH_INDEX
, 
hash
->
ödex
);

199 
	`XFREE
 (
MTYPE_HASH
, 
hash
);

200 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/hash.h

21 #i‚de‡
_ZEBRA_HASH_H


22 
	#_ZEBRA_HASH_H


	)

25 
	#HASHTABSIZE
 1024

	)

27 
	shash_backë


30 
hash_backë
 *
	m√xt
;

33 
	mkey
;

36 *
	md©a
;

39 
	shash


42 
hash_backë
 **
	mödex
;

45 
	msize
;

48 (*
	mhash_key
) (*);

51 (*
	mhash_cmp
) (const *, const *);

54 
	mcou¡
;

57 
hash
 *
hash_¸óã
 ((*) (*),

59 
hash
 *
	`hash_¸óã_size
 (, (*) (*),

62 *
	`hash_gë
 (
hash
 *, *, * (*) (*));

63 *
	`hash_Æloc_öã∫
 (*);

64 *
	`hash_lookup
 (
hash
 *, *);

65 *
	`hash_ªÀa£
 (
hash
 *, *);

67 
	`hash_ôî©e
 (
hash
 *,

68 (*Ë(
hash_backë
 *, *), *);

70 
	`hash_˛ón
 (
hash
 *, (*) (*));

71 
	`hash_‰ì
 (
hash
 *);

73 
	`°rög_hash_make
 (const *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if.c

24 
	~<zebø.h
>

26 
	~"lökli°.h
"

27 
	~"ve˘‹.h
"

28 
	~"vty.h
"

29 
	~"comm™d.h
"

30 
	~"if.h
"

31 
	~"sockuni⁄.h
"

32 
	~"¥efix.h
"

33 
	~"mem‹y.h
"

34 
	~"èbÀ.h
"

35 
	~"buf„r.h
"

36 
	~"°r.h
"

37 
	~"log.h
"

40 
li°
 *
	giÊi°
;

43 
	sif_ma°î


45 (*
	mif_√w_hook
Ë(
	möãrÁ˚
 *);

46 (*
	mif_dñëe_hook
Ë(
	möãrÁ˚
 *);

47 } 
	gif_ma°î
;

58 
	$if_cmp_func
 (
öãrÁ˚
 *
iÂ1
, öãrÁ˚ *
iÂ2
)

60 
l1
, 
l2
;

61 
x1
, 
x2
;

62 *
p1
, *
p2
;

63 
ªs
;

65 
p1
 = 
iÂ1
->
«me
;

66 
p2
 = 
iÂ2
->
«me
;

68 *
p1
 && *
p2
) {

70 
l1
 = 
	`°rc•n
(
p1
, "0123456789");

71 
l2
 = 
	`°rc•n
(
p2
, "0123456789");

74 i‡(
l1
 !
l2
)

75  (
	`°rcmp
(
p1
, 
p2
));

80 
ªs
 = 
	`°∫cmp
(
p1
, 
p2
, 
l1
);

83 i‡(
ªs
)

84  
ªs
;

87 
p1
 +
l1
;

88 
p2
 +
l1
;

90 i‡(!*
p1
)

92 i‡(!*
p2
)

95 
x1
 = 
	`°πﬁ
(
p1
, &p1, 10);

96 
x2
 = 
	`°πﬁ
(
p2
, &p2, 10);

99 i‡(
x1
 < 
x2
)

101 i‡(
x1
 > 
x2
)

107 i‡(*
p1
)

109 i‡(*
p2
)

112 
	}
}

115 
öãrÁ˚
 *

116 
	$if_¸óã
 (c⁄° *
«me
, 
«mñí
)

118 
öãrÁ˚
 *
iÂ
;

120 
iÂ
 = 
	`XCALLOC
 (
MTYPE_IF
,  (
öãrÁ˚
));

121 
iÂ
->
ifödex
 = 
IFINDEX_INTERNAL
;

123 
	`as£π
 (
«me
);

124 
	`as£π
 (
«mñí
 <
INTERFACE_NAMSIZ
);

125 
	`°∫˝y
 (
iÂ
->
«me
,Çame, 
«mñí
);

126 
iÂ
->
«me
[
«mñí
] = '\0';

127 i‡(
	`if_lookup_by_«me
(
iÂ
->
«me
Ë=
NULL
)

128 
	`li°node_add_s‹t
 (
iÊi°
, 
iÂ
);

130 
	`zlog_îr
("if_create(%s): corruption detected -- interface withÅhis "

131 "«mêexi°†Æªady!", 
iÂ
->
«me
);

132 
iÂ
->
c⁄√˘ed
 = 
	`li°_√w
 ();

133 
iÂ
->
c⁄√˘ed
->
dñ
 = ((*Ë(*)Ë
c⁄√˘ed_‰ì
;

135 i‡(
if_ma°î
.
if_√w_hook
)

136 (*
if_ma°î
.
if_√w_hook
Ë(
iÂ
);

138  
iÂ
;

139 
	}
}

143 
	$if_dñëe_ªèö
 (
öãrÁ˚
 *
iÂ
)

145 i‡(
if_ma°î
.
if_dñëe_hook
)

146 (*
if_ma°î
.
if_dñëe_hook
Ë(
iÂ
);

149 
	`li°_dñëe_Æl_node
 (
iÂ
->
c⁄√˘ed
);

150 
	}
}

154 
	$if_dñëe
 (
öãrÁ˚
 *
iÂ
)

156 
	`li°node_dñëe
 (
iÊi°
, 
iÂ
);

158 
	`if_dñëe_ªèö
(
iÂ
);

160 
	`li°_‰ì
 (
iÂ
->
c⁄√˘ed
);

162 
	`XFREE
 (
MTYPE_IF
, 
iÂ
);

163 
	}
}

167 
if_add_hook
 (
ty≥
, (*
func
)(
öãrÁ˚
 *
iÂ
))

169 
ty≥
) {

170 
IF_NEW_HOOK
:

171 
if_ma°î
.
if_√w_hook
 = 
func
;

173 
IF_DELETE_HOOK
:

174 
if_ma°î
.
if_dñëe_hook
 = 
func
;

179 
	}
}

182 
öãrÁ˚
 *

183 
	$if_lookup_by_ödex
 (
ödex
)

185 
li°node
 *
node
;

186 
öãrÁ˚
 *
iÂ
;

188 
	`ALL_LIST_ELEMENTS_RO
(
iÊi°
, 
node
, 
iÂ
))

190 i‡(
iÂ
->
ifödex
 =
ödex
)

191  
iÂ
;

193  
NULL
;

194 
	}
}

197 
	$ifödex2i‚ame
 (
ödex
)

199 
öãrÁ˚
 *
iÂ
;

201  ((
iÂ
 = 
	`if_lookup_by_ödex
(
ödex
)Ë!
NULL
) ?

202 
iÂ
->
«me
 : "unknown";

203 
	}
}

206 
	$i‚ame2ifödex
 (c⁄° *
«me
)

208 
öãrÁ˚
 *
iÂ
;

210  ((
iÂ
 = 
	`if_lookup_by_«me
(
«me
)Ë!
NULL
Ë? iÂ->
ifödex


211 : 
IFINDEX_INTERNAL
;

212 
	}
}

215 
öãrÁ˚
 *

216 
	$if_lookup_by_«me
 (c⁄° *
«me
)

218 
li°node
 *
node
;

219 
öãrÁ˚
 *
iÂ
;

221 i‡(
«me
)

222 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

224 i‡(
	`°rcmp
(
«me
, 
iÂ
->name) == 0)

225  
iÂ
;

227  
NULL
;

228 
	}
}

230 
öãrÁ˚
 *

231 
	$if_lookup_by_«me_Àn
(c⁄° *
«me
, 
size_t
 
«mñí
)

233 
li°node
 *
node
;

234 
öãrÁ˚
 *
iÂ
;

236 i‡(
«mñí
 > 
INTERFACE_NAMSIZ
)

237  
NULL
;

239 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

241 i‡(!
	`memcmp
(
«me
, 
iÂ
->«me, 
«mñí
) && (ifp->name[namelen] == '\0'))

242  
iÂ
;

244  
NULL
;

245 
	}
}

248 
öãrÁ˚
 *

249 
	$if_lookup_exa˘_addªss
 (
ö_addr
 
§c
)

251 
li°node
 *
node
;

252 
li°node
 *
˙ode
;

253 
öãrÁ˚
 *
iÂ
;

254 
¥efix
 *
p
;

255 
c⁄√˘ed
 *
c
;

257 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

259 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, 
c
))

261 
p
 = 
c
->
addªss
;

263 i‡(
p
 &&Ö->
Ámûy
 =
AF_INET
)

265 i‡(
	`IPV4_ADDR_SAME
 (&
p
->
u
.
¥efix4
, &
§c
))

266  
iÂ
;

270  
NULL
;

271 
	}
}

274 
öãrÁ˚
 *

275 
	$if_lookup_addªss
 (
ö_addr
 
§c
)

277 
li°node
 *
node
;

278 
¥efix
 
addr
;

279 
be°Àn
 = 0;

280 
li°node
 *
˙ode
;

281 
öãrÁ˚
 *
iÂ
;

282 
c⁄√˘ed
 *
c
;

283 
öãrÁ˚
 *
m©ch
;

285 
addr
.
Ámûy
 = 
AF_INET
;

286 
addr
.
u
.
¥efix4
 = 
§c
;

287 
addr
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

289 
m©ch
 = 
NULL
;

291 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

293 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, 
c
))

295 i‡(
c
->
addªss
 && (c->addªss->
Ámûy
 =
AF_INET
) &&

296 
	`¥efix_m©ch
(
	`CONNECTED_PREFIX
(
c
), &
addr
) &&

297 (
c
->
addªss
->
¥efixÀn
 > 
be°Àn
))

299 
be°Àn
 = 
c
->
addªss
->
¥efixÀn
;

300 
m©ch
 = 
iÂ
;

304  
m©ch
;

305 
	}
}

309 
öãrÁ˚
 *

310 
	$if_gë_by_«me
 (c⁄° *
«me
)

312 
öãrÁ˚
 *
iÂ
;

314  ((
iÂ
 = 
	`if_lookup_by_«me
(
«me
)Ë!
NULL
) ? ifp :

315 
	`if_¸óã
(
«me
, 
	`°æí
(name));

316 
	}
}

318 
öãrÁ˚
 *

319 
	$if_gë_by_«me_Àn
(c⁄° *
«me
, 
size_t
 
«mñí
)

321 
öãrÁ˚
 *
iÂ
;

323  ((
iÂ
 = 
	`if_lookup_by_«me_Àn
(
«me
, 
«mñí
)Ë!
NULL
) ? ifp :

324 
	`if_¸óã
(
«me
, 
«mñí
);

325 
	}
}

329 
	$if_is_up
 (
öãrÁ˚
 *
iÂ
)

331  
iÂ
->
Êags
 & 
IFF_UP
;

332 
	}
}

336 
	$if_is_ru¬ög
 (
öãrÁ˚
 *
iÂ
)

338  
iÂ
->
Êags
 & 
IFF_RUNNING
;

339 
	}
}

344 
	$if_is_›î©ive
 (
öãrÁ˚
 *
iÂ
)

346  ((
iÂ
->
Êags
 & 
IFF_UP
) &&

347 (
iÂ
->
Êags
 & 
IFF_RUNNING
 || !
	`CHECK_FLAG
(iÂ->
°©us
, 
ZEBRA_INTERFACE_LINKDETECTION
)));

348 
	}
}

352 
	$if_is_lo›back
 (
öãrÁ˚
 *
iÂ
)

357  (
iÂ
->
Êags
 & (
IFF_LOOPBACK
|
IFF_NOXMIT
|
IFF_VIRTUAL
));

358 
	}
}

362 
	$if_is_brﬂdˇ°
 (
öãrÁ˚
 *
iÂ
)

364  
iÂ
->
Êags
 & 
IFF_BROADCAST
;

365 
	}
}

369 
	$if_is_poöt›oöt
 (
öãrÁ˚
 *
iÂ
)

371  
iÂ
->
Êags
 & 
IFF_POINTOPOINT
;

372 
	}
}

376 
	$if_is_mu…iˇ°
 (
öãrÁ˚
 *
iÂ
)

378  
iÂ
->
Êags
 & 
IFF_MULTICAST
;

379 
	}
}

383 
	$if_Êag_dump
 (
Êag
)

385 
£∑øt‹
 = 0;

386 
logbuf
[
BUFSIZ
];

388 
	#IFF_OUT_LOG
(
X
,
STR
) \

389 i‡(
Êag
 & (
X
)) \

391 i‡(
£∑øt‹
) \

392 
	`°æˇt
 (
logbuf
, ",", 
BUFSIZ
); \

394 
£∑øt‹
 = 1; \

395 
	`°æˇt
 (
logbuf
, 
STR
, 
BUFSIZ
); \

396 }

	)

398 
	`°æ˝y
 (
logbuf
, "<", 
BUFSIZ
);

399 
	`IFF_OUT_LOG
 (
IFF_UP
, "UP");

400 
	`IFF_OUT_LOG
 (
IFF_BROADCAST
, "BROADCAST");

401 
	`IFF_OUT_LOG
 (
IFF_DEBUG
, "DEBUG");

402 
	`IFF_OUT_LOG
 (
IFF_LOOPBACK
, "LOOPBACK");

403 
	`IFF_OUT_LOG
 (
IFF_POINTOPOINT
, "POINTOPOINT");

404 
	`IFF_OUT_LOG
 (
IFF_NOTRAILERS
, "NOTRAILERS");

405 
	`IFF_OUT_LOG
 (
IFF_RUNNING
, "RUNNING");

406 
	`IFF_OUT_LOG
 (
IFF_NOARP
, "NOARP");

407 
	`IFF_OUT_LOG
 (
IFF_PROMISC
, "PROMISC");

408 
	`IFF_OUT_LOG
 (
IFF_ALLMULTI
, "ALLMULTI");

409 
	`IFF_OUT_LOG
 (
IFF_OACTIVE
, "OACTIVE");

410 
	`IFF_OUT_LOG
 (
IFF_SIMPLEX
, "SIMPLEX");

411 
	`IFF_OUT_LOG
 (
IFF_LINK0
, "LINK0");

412 
	`IFF_OUT_LOG
 (
IFF_LINK1
, "LINK1");

413 
	`IFF_OUT_LOG
 (
IFF_LINK2
, "LINK2");

414 
	`IFF_OUT_LOG
 (
IFF_MULTICAST
, "MULTICAST");

415 
	`IFF_OUT_LOG
 (
IFF_NOXMIT
, "NOXMIT");

416 
	`IFF_OUT_LOG
 (
IFF_NORTEXCH
, "NORTEXCH");

417 
	`IFF_OUT_LOG
 (
IFF_VIRTUAL
, "VIRTUAL");

418 
	`IFF_OUT_LOG
 (
IFF_IPV4
, "IPv4");

419 
	`IFF_OUT_LOG
 (
IFF_IPV6
, "IPv6");

421 
	`°æˇt
 (
logbuf
, ">", 
BUFSIZ
);

423  
logbuf
;

424 #unde‡
IFF_OUT_LOG


425 
	}
}

429 
	$if_dump
 (c⁄° 
öãrÁ˚
 *
iÂ
)

431 
li°node
 *
node
;

432 
c⁄√˘ed
 *
c
;

434 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
node
, 
c
))

435 
	`zlog_öfo
 ("Interface %s index %d metric %d mtu %d "

436 #ifde‡
HAVE_IPV6


440 
iÂ
->
«me
, iÂ->
ifödex
, iÂ->
mëric
, iÂ->
mtu
,

441 #ifde‡
HAVE_IPV6


442 
iÂ
->
mtu6
,

444 
	`if_Êag_dump
 (
iÂ
->
Êags
));

445 
	}
}

449 
	$if_dump_Æl
 ()

451 
li°node
 *
node
;

452 *
p
;

454 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
p
))

455 
	`if_dump
 (
p
);

456 
	}
}

458 
DEFUN
 (
öãrÁ˚_desc
,

459 
öãrÁ˚_desc_cmd
,

464 
öãrÁ˚
 *
	giÂ
;

466 i‡(
	g¨gc
 == 0)

467  
CMD_SUCCESS
;

469 
	giÂ
 = 
vty
->
ödex
;

470 i‡(
	giÂ
->
	gdesc
)

471 
XFREE
 (
MTYPE_TMP
, 
iÂ
->
desc
);

472 
	giÂ
->
	gdesc
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 0);

474  
	gCMD_SUCCESS
;

477 
DEFUN
 (
no_öãrÁ˚_desc
,

478 
no_öãrÁ˚_desc_cmd
,

480 
NO_STR


483 
öãrÁ˚
 *
	giÂ
;

485 
	giÂ
 = 
vty
->
ödex
;

486 i‡(
	giÂ
->
	gdesc
)

487 
XFREE
 (
MTYPE_TMP
, 
iÂ
->
desc
);

488 
	giÂ
->
	gdesc
 = 
NULL
;

490  
	gCMD_SUCCESS
;

493 #ifde‡
SUNOS_5


514 
öãrÁ˚
 *

515 
	$if_sunwzebø_gë
 (c⁄° *
«me
, 
size_t
 
∆í
)

517 
öãrÁ˚
 *
iÂ
;

518 
size_t
 
£µos
 = 0;

520 i‡–(
iÂ
 = 
	`if_lookup_by_«me_Àn
(
«me
, 
∆í
)Ë!
NULL
)

521  
iÂ
;

524 
£µos
 < 
∆í
 && 
«me
[seppos] != ':')

525 
£µos
++;

528 i‡(
£µos
 < 
∆í
)

529  
	`if_gë_by_«me_Àn
 (
«me
, 
£µos
);

531  
	`if_gë_by_«me_Àn
 (
«me
, 
∆í
);

532 
	}
}

535 
DEFUN
 (
öãrÁ˚
,

536 
öãrÁ˚_cmd
,

541 
öãrÁ˚
 *
	giÂ
;

542 
size_t
 
	g¶
;

544 i‡((
	g¶
 = 
°æí
(
¨gv
[0])Ë> 
INTERFACE_NAMSIZ
)

546 
vty_out
 (
vty
, "%% InterfaceÇame %s is invalid:ÜengthÉxceeds "

548 
¨gv
[0], 
INTERFACE_NAMSIZ
, 
VTY_NEWLINE
);

549  
	gCMD_WARNING
;

552 #ifde‡
SUNOS_5


553 
	giÂ
 = 
if_sunwzebø_gë
 (
¨gv
[0], 
¶
);

555 
	giÂ
 = 
if_gë_by_«me_Àn
(
¨gv
[0], 
¶
);

558 
	gvty
->
	gödex
 = 
iÂ
;

559 
	gvty
->
	gnode
 = 
INTERFACE_NODE
;

561  
	gCMD_SUCCESS
;

564 
DEFUN_NOSH
 (
no_öãrÁ˚
,

565 
no_öãrÁ˚_cmd
,

567 
NO_STR


572 
öãrÁ˚
 *
	giÂ
;

574 
	giÂ
 = 
if_lookup_by_«me
 (
¨gv
[0]);

576 i‡(
	giÂ
 =
NULL
)

578 
vty_out
 (
vty
, "%% I¡îÁ˚ %†d€†nŸÉxi°%s", 
¨gv
[0], 
VTY_NEWLINE
);

579  
	gCMD_WARNING
;

582 i‡(
CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

584 
vty_out
 (
vty
, "%% Only inactive interfaces can be deleted%s",

585 
VTY_NEWLINE
);

586  
	gCMD_WARNING
;

589 
if_dñëe
(
iÂ
);

591  
	gCMD_SUCCESS
;

595 
DEFUN
 (
show_addªss
,

596 
show_addªss_cmd
,

598 
SHOW_STR


601 
li°node
 *
	gnode
;

602 
li°node
 *
	gnode2
;

603 
öãrÁ˚
 *
	giÂ
;

604 
c⁄√˘ed
 *
	gifc
;

605 
¥efix
 *
	gp
;

607 
ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

609 
ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
node2
, 
ifc
))

611 
	gp
 = 
ifc
->
addªss
;

613 i‡(
	gp
->
	gÁmûy
 =
AF_INET
)

614 
vty_out
 (
vty
, "%s/%d%s", 
öë_¡ﬂ
 (
p
->
u
.
¥efix4
),Ö->
¥efixÀn
,

615 
VTY_NEWLINE
);

618  
	gCMD_SUCCESS
;

622 
c⁄√˘ed
 *

623 
	$c⁄√˘ed_√w
 ()

625  
	`XCALLOC
 (
MTYPE_CONNECTED
,  (
c⁄√˘ed
));

626 
	}
}

630 
	$c⁄√˘ed_‰ì
 (
c⁄√˘ed
 *connected)

632 i‡(
c⁄√˘ed
->
addªss
)

633 
	`¥efix_‰ì
 (
c⁄√˘ed
->
addªss
);

635 i‡(
c⁄√˘ed
->
de°ö©i⁄
)

636 
	`¥efix_‰ì
 (
c⁄√˘ed
->
de°ö©i⁄
);

638 i‡(
c⁄√˘ed
->
œbñ
)

639 
	`XFREE
 (
MTYPE_CONNECTED_LABEL
, 
c⁄√˘ed
->
œbñ
);

641 
	`XFREE
 (
MTYPE_CONNECTED
, 
c⁄√˘ed
);

642 
	}
}

645 
__©åibuã__
 ((
unu£d
))

646 
	$c⁄√˘ed_log
 (
c⁄√˘ed
 *c⁄√˘ed, *
°r
)

648 
¥efix
 *
p
;

649 
öãrÁ˚
 *
iÂ
;

650 
logbuf
[
BUFSIZ
];

651 
buf
[
BUFSIZ
];

653 
iÂ
 = 
c⁄√˘ed
->ifp;

654 
p
 = 
c⁄√˘ed
->
addªss
;

656 
	`¢¥ötf
 (
logbuf
, 
BUFSIZ
, "%s interface %s %s %s/%d ",

657 
°r
, 
iÂ
->
«me
, 
	`¥efix_Ámûy_°r
 (
p
),

658 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

659 
p
->
¥efixÀn
);

661 
p
 = 
c⁄√˘ed
->
de°ö©i⁄
;

662 i‡(
p
)

664 
	`°∫ˇt
 (
logbuf
, 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

665 
BUFSIZ
 - 
	`°æí
(
logbuf
));

667 
	`zlog
 (
NULL
, 
LOG_INFO
, "%s", 
logbuf
);

668 
	}
}

672 
	$c⁄√˘ed_ßme_¥efix
 (
¥efix
 *
p1
, ¥efix *
p2
)

674 i‡(
p1
->
Ámûy
 =
p2
->family)

676 i‡(
p1
->
Ámûy
 =
AF_INET
 &&

677 
	`IPV4_ADDR_SAME
 (&
p1
->
u
.
¥efix4
, &
p2
->u.prefix4))

679 #ifde‡
HAVE_IPV6


680 i‡(
p1
->
Ámûy
 =
AF_INET6
 &&

681 
	`IPV6_ADDR_SAME
 (&
p1
->
u
.
¥efix6
, &
p2
->u.prefix6))

686 
	}
}

688 
c⁄√˘ed
 *

689 
	$c⁄√˘ed_dñëe_by_¥efix
 (
öãrÁ˚
 *
iÂ
, 
¥efix
 *
p
)

691 
li°node
 *
node
;

692 
li°node
 *
√xt
;

693 
c⁄√˘ed
 *
ifc
;

696 
node
 = 
	`li°hód
 (
iÂ
->
c⁄√˘ed
);Çode;Çodê
√xt
)

698 
ifc
 = 
	`li°gëd©a
 (
node
);

699 
√xt
 = 
node
->next;

701 i‡(
	`c⁄√˘ed_ßme_¥efix
 (
ifc
->
addªss
, 
p
))

703 
	`li°node_dñëe
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

704  
ifc
;

707  
NULL
;

708 
	}
}

712 
c⁄√˘ed
 *

713 
	$c⁄√˘ed_lookup_addªss
 (
öãrÁ˚
 *
iÂ
, 
ö_addr
 
d°
)

715 
¥efix
 
addr
;

716 
li°node
 *
˙ode
;

717 
c⁄√˘ed
 *
c
;

718 
c⁄√˘ed
 *
m©ch
;

720 
addr
.
Ámûy
 = 
AF_INET
;

721 
addr
.
u
.
¥efix4
 = 
d°
;

722 
addr
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

724 
m©ch
 = 
NULL
;

726 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, 
c
))

728 i‡(
c
->
addªss
 && (c->addªss->
Ámûy
 =
AF_INET
) &&

729 
	`¥efix_m©ch
(
	`CONNECTED_PREFIX
(
c
), &
addr
) &&

730 (!
m©ch
 || (
c
->
addªss
->
¥efixÀn
 > match->address->prefixlen)))

731 
m©ch
 = 
c
;

733  
m©ch
;

734 
	}
}

736 
c⁄√˘ed
 *

737 
	$c⁄√˘ed_add_by_¥efix
 (
öãrÁ˚
 *
iÂ
, 
¥efix
 *
p
,

738 
¥efix
 *
de°ö©i⁄
)

740 
c⁄√˘ed
 *
ifc
;

743 
ifc
 = 
	`c⁄√˘ed_√w
 ();

744 
ifc
->
iÂ
 = ifp;

747 
ifc
->
addªss
 = 
	`¥efix_√w
();

748 
	`mem˝y
 (
ifc
->
addªss
, 
p
, (
¥efix
));

751 i‡(
de°ö©i⁄
)

753 
ifc
->
de°ö©i⁄
 = 
	`¥efix_√w
();

754 
	`mem˝y
 (
ifc
->
de°ö©i⁄
, de°ö©i⁄, (
¥efix
));

758 
	`li°node_add
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

759  
ifc
;

760 
	}
}

762 #i‚de‡
HAVE_IF_NAMETOINDEX


764 
	$if_«mëoödex
 (c⁄° *
«me
)

766 
öãrÁ˚
 *
iÂ
;

768  ((
iÂ
 = 
	`if_lookup_by_«me_Àn
(
«me
, 
	`°∫Àn
“ame, 
IFNAMSIZ
))Ë!
NULL
)

769 ? 
iÂ
->
ifödex
 : 0;

770 
	}
}

773 #i‚de‡
HAVE_IF_INDEXTONAME


775 
	$if_ödext⁄ame
 (
ifödex
, *
«me
)

777 
öãrÁ˚
 *
iÂ
;

779 i‡(!(
iÂ
 = 
	`if_lookup_by_ödex
(
ifödex
)))

780  
NULL
;

781 
	`°∫˝y
 (
«me
, 
iÂ
->«me, 
IFNAMSIZ
);

782  
iÂ
->
«me
;

783 
	}
}

792 
rouã_èbÀ
 *
	giÁddr_ùv4_èbÀ
;

796 
	$iÁddr_ùv4_add
 (
ö_addr
 *
iÁddr
, 
öãrÁ˚
 *
iÂ
)

798 
rouã_node
 *
∫
;

799 
¥efix_ùv4
 
p
;

801 
p
.
Ámûy
 = 
AF_INET
;

802 
p
.
¥efixÀn
 = 
IPV4_MAX_PREFIXLEN
;

803 
p
.
¥efix
 = *
iÁddr
;

805 
∫
 = 
	`rouã_node_gë
 (
iÁddr_ùv4_èbÀ
, (
¥efix
 *Ë&
p
);

806 i‡(
∫
)

808 
	`rouã_u∆ock_node
 (
∫
);

809 
	`zlog_öfo
 ("ifaddr_ipv4_add():áddress %s isálreadyádded",

810 
	`öë_¡ﬂ
 (*
iÁddr
));

813 
∫
->
öfo
 = 
iÂ
;

814 
	}
}

817 
	$iÁddr_ùv4_dñëe
 (
ö_addr
 *
iÁddr
, 
öãrÁ˚
 *
iÂ
)

819 
rouã_node
 *
∫
;

820 
¥efix_ùv4
 
p
;

822 
p
.
Ámûy
 = 
AF_INET
;

823 
p
.
¥efixÀn
 = 
IPV4_MAX_PREFIXLEN
;

824 
p
.
¥efix
 = *
iÁddr
;

826 
∫
 = 
	`rouã_node_lookup
 (
iÁddr_ùv4_èbÀ
, (
¥efix
 *Ë&
p
);

827 i‡(! 
∫
)

829 
	`zlog_öfo
 ("ifaddr_ipv4_delete(): can't findáddress %s",

830 
	`öë_¡ﬂ
 (*
iÁddr
));

833 
∫
->
öfo
 = 
NULL
;

834 
	`rouã_u∆ock_node
 (
∫
);

835 
	`rouã_u∆ock_node
 (
∫
);

836 
	}
}

839 
öãrÁ˚
 *

840 
	$iÁddr_ùv4_lookup
 (
ö_addr
 *
addr
, 
ifödex
)

842 
¥efix_ùv4
 
p
;

843 
rouã_node
 *
∫
;

844 
öãrÁ˚
 *
iÂ
;

846 i‡(
addr
)

848 
p
.
Ámûy
 = 
AF_INET
;

849 
p
.
¥efixÀn
 = 
IPV4_MAX_PREFIXLEN
;

850 
p
.
¥efix
 = *
addr
;

852 
∫
 = 
	`rouã_node_lookup
 (
iÁddr_ùv4_èbÀ
, (
¥efix
 *Ë&
p
);

853 i‡(! 
∫
)

854  
NULL
;

856 
iÂ
 = 
∫
->
öfo
;

857 
	`rouã_u∆ock_node
 (
∫
);

858  
iÂ
;

861  
	`if_lookup_by_ödex
(
ifödex
);

862 
	}
}

867 
	$if_öô
 ()

869 
iÊi°
 = 
	`li°_√w
 ();

871 
iÁddr_ùv4_èbÀ
 = 
	`rouã_èbÀ_öô
 ();

874 i‡(
iÊi°
) {

875 
iÊi°
->
cmp
 = ((*)(*, *))
if_cmp_func
;

879 
	`mem£t
 (&
if_ma°î
, 0,  if_master);

880 
	}
}

883 
	$if_ãrmö©e
 ()

887 
öãrÁ˚
 *
iÂ
;

889 
iÂ
 = 
	`li°node_hód
 (
iÊi°
);

890 i‡(
iÂ
 =
NULL
)

893 
	`if_dñëe
 (
iÂ
);

896 
	`li°_dñëe
 (
iÊi°
);

897 
iÊi°
 = 
NULL
;

898 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if.h

21 #i‚de‡
_ZEBRA_IF_H


22 
	#_ZEBRA_IF_H


	)

24 
	~"lökli°.h
"

36 
	#INTERFACE_NAMSIZ
 20

	)

37 
	#INTERFACE_HWADDR_MAX
 20

	)

39 #ifde‡
HAVE_PROC_NET_DEV


40 
	sif_°©s


42 
	mrx_∑ckës
;

43 
	mtx_∑ckës
;

44 
	mrx_byãs
;

45 
	mtx_byãs
;

46 
	mrx_îr‹s
;

47 
	mtx_îr‹s
;

48 
	mrx_dr›≥d
;

49 
	mtx_dr›≥d
;

50 
	mrx_mu…iˇ°
;

51 
	mrx_com¥es£d
;

52 
	mtx_com¥es£d
;

53 
	mcﬁlisi⁄s
;

56 
	mrx_Àngth_îr‹s
;

57 
	mrx_ovî_îr‹s
;

58 
	mrx_¸c_îr‹s
;

59 
	mrx_‰ame_îr‹s
;

60 
	mrx_fifo_îr‹s
;

61 
	mrx_mis£d_îr‹s
;

63 
	mtx_ab‹ãd_îr‹s
;

64 
	mtx_ˇºõr_îr‹s
;

65 
	mtx_fifo_îr‹s
;

66 
	mtx_hóπbót_îr‹s
;

67 
	mtx_wödow_îr‹s
;

72 
	söãrÁ˚


81 
	m«me
[
INTERFACE_NAMSIZ
 + 1];

85 
	mifödex
;

86 
	#IFINDEX_INTERNAL
 0

	)

89 
u_ch¨
 
	m°©us
;

90 
	#ZEBRA_INTERFACE_ACTIVE
 (1 << 0)

	)

91 
	#ZEBRA_INTERFACE_SUB
 (1 << 1)

	)

92 
	#ZEBRA_INTERFACE_LINKDETECTION
 (1 << 2)

	)

95 
uöt64_t
 
	mÊags
;

98 
	mmëric
;

101 
	mmtu
;

102 
	mmtu6
;

105 #ifde‡
HAVE_STRUCT_SOCKADDR_DL


110 
sockaddr_dl
 
	msdl
;

111 
sockaddr_°‹age
 
	msdl_°‹age
;

114 
	mhw_ty≥
;

115 
u_ch¨
 
	mhw_addr
[
INTERFACE_HWADDR_MAX
];

116 
	mhw_addr_Àn
;

120 
	mb™dwidth
;

123 *
	mdesc
;

126 *
	mdi°ribuã_ö
;

127 *
	mdi°ribuã_out
;

130 
li°
 *
	mc⁄√˘ed
;

133 *
	möfo
;

136 #ifde‡
HAVE_PROC_NET_DEV


137 
if_°©s
 
	m°©s
;

139 #ifde‡
HAVE_NET_RT_IFLIST


140 
if_d©a
 
	m°©s
;

145 
	sc⁄√˘ed


148 
öãrÁ˚
 *
	miÂ
;

151 
u_ch¨
 
	mc⁄f
;

152 
	#ZEBRA_IFC_REAL
 (1 << 0)

	)

153 
	#ZEBRA_IFC_CONFIGURED
 (1 << 1)

	)

162 
u_ch¨
 
	mÊags
;

163 
	#ZEBRA_IFA_SECONDARY
 (1 << 0)

	)

164 
	#ZEBRA_IFA_PEER
 (1 << 1)

	)

173 
¥efix
 *
	maddªss
;

177 
¥efix
 *
	mde°ö©i⁄
;

180 *
	mœbñ
;

184 
	#CONNECTED_PEER
(
C
Ë
	`CHECK_FLAG
((C)->
Êags
, 
ZEBRA_IFA_PEER
)

	)

187 
	#CONNECTED_PREFIX
(
C
) \

188 (
	`CONNECTED_PEER
(
C
Ë? (C)->
de°ö©i⁄
 : (C)->
addªss
)

	)

192 
	#CONNECTED_ID
(
C
) \

193 ((
	`CONNECTED_PEER
(
C
Ë&& !
	`¥efix_m©ch
((C)->
de°ö©i⁄
, (C)->
addªss
)) ?\

194 (
C
)->
de°ö©i⁄
 : (C)->
addªss
)

	)

197 
	#IF_NEW_HOOK
 0

	)

198 
	#IF_DELETE_HOOK
 1

	)

203 #i‚de‡
IFF_NOTRAILERS


204 
	#IFF_NOTRAILERS
 0x0

	)

206 #i‚de‡
IFF_OACTIVE


207 
	#IFF_OACTIVE
 0x0

	)

209 #i‚de‡
IFF_SIMPLEX


210 
	#IFF_SIMPLEX
 0x0

	)

212 #i‚de‡
IFF_LINK0


213 
	#IFF_LINK0
 0x0

	)

215 #i‚de‡
IFF_LINK1


216 
	#IFF_LINK1
 0x0

	)

218 #i‚de‡
IFF_LINK2


219 
	#IFF_LINK2
 0x0

	)

221 #i‚de‡
IFF_NOXMIT


222 
	#IFF_NOXMIT
 0x0

	)

224 #i‚de‡
IFF_NORTEXCH


225 
	#IFF_NORTEXCH
 0x0

	)

227 #i‚de‡
IFF_IPV4


228 
	#IFF_IPV4
 0x0

	)

230 #i‚de‡
IFF_IPV6


231 
	#IFF_IPV6
 0x0

	)

233 #i‚de‡
IFF_VIRTUAL


234 
	#IFF_VIRTUAL
 0x0

	)

238 
if_cmp_func
 (
öãrÁ˚
 *, interface *);

239 
öãrÁ˚
 *
if_¸óã
 (c⁄° *
«me
, 
«mñí
);

240 
öãrÁ˚
 *
if_lookup_by_ödex
 ();

241 
öãrÁ˚
 *
if_lookup_exa˘_addªss
 (
ö_addr
);

242 
öãrÁ˚
 *
if_lookup_addªss
 (
ö_addr
);

246 
öãrÁ˚
 *
if_lookup_by_«me
 (c⁄° *
i‚ame
);

247 
öãrÁ˚
 *
if_gë_by_«me
 (c⁄° *
i‚ame
);

252 
öãrÁ˚
 *
if_lookup_by_«me_Àn
(c⁄° *
i‚ame
,

253 
size_t
 
«mñí
);

254 
öãrÁ˚
 *
if_gë_by_«me_Àn
(c⁄° *
i‚ame
, 
size_t
 
«mñí
);

260 
if_dñëe_ªèö
 (
öãrÁ˚
 *);

264 
if_dñëe
 (
öãrÁ˚
 *);

266 
if_is_up
 (
öãrÁ˚
 *);

267 
if_is_ru¬ög
 (
öãrÁ˚
 *);

268 
if_is_›î©ive
 (
öãrÁ˚
 *);

269 
if_is_lo›back
 (
öãrÁ˚
 *);

270 
if_is_brﬂdˇ°
 (
öãrÁ˚
 *);

271 
if_is_poöt›oöt
 (
öãrÁ˚
 *);

272 
if_is_mu…iˇ°
 (
öãrÁ˚
 *);

273 
if_add_hook
 (, (*)(
öãrÁ˚
 *));

274 
	`if_öô
 ();

275 
	`if_ãrmö©e
 ();

276 
	`if_dump_Æl
 ();

277 c⁄° *
	`if_Êag_dump
();

282 c⁄° *
	`ifödex2i‚ame
 ();

287 
	`i‚ame2ifödex
(c⁄° *
i‚ame
);

290 
c⁄√˘ed
 *
	`c⁄√˘ed_√w
 ();

291 
	`c⁄√˘ed_‰ì
 (
c⁄√˘ed
 *);

292 
	`c⁄√˘ed_add
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

293 
c⁄√˘ed
 *
	`c⁄√˘ed_add_by_¥efix
 (
öãrÁ˚
 *,

294 
¥efix
 *,

295 
¥efix
 *);

296 
c⁄√˘ed
 *
	`c⁄√˘ed_dñëe_by_¥efix
 (
öãrÁ˚
 *,

297 
¥efix
 *);

298 
c⁄√˘ed
 *
	`c⁄√˘ed_lookup_addªss
 (
öãrÁ˚
 *,

299 
ö_addr
);

301 #i‚de‡
HAVE_IF_NAMETOINDEX


302 
	`if_«mëoödex
 (const *);

304 #i‚de‡
HAVE_IF_INDEXTONAME


305 *
	`if_ödext⁄ame
 (, *);

309 
li°
 *
iÊi°
;

310 
cmd_ñemít
 
öãrÁ˚_desc_cmd
;

311 
cmd_ñemít
 
no_öãrÁ˚_desc_cmd
;

312 
cmd_ñemít
 
öãrÁ˚_cmd
;

313 
cmd_ñemít
 
no_öãrÁ˚_cmd
;

314 
cmd_ñemít
 
öãrÁ˚_p£udo_cmd
;

315 
cmd_ñemít
 
no_öãrÁ˚_p£udo_cmd
;

316 
cmd_ñemít
 
show_addªss_cmd
;

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if_rmap.c

22 
	~<zebø.h
>

24 
	~"hash.h
"

25 
	~"comm™d.h
"

26 
	~"mem‹y.h
"

27 
	~"if.h
"

28 
	~"if_rm≠.h
"

30 
hash
 *
	gi‰m≠hash
;

33 (*
if_rm≠_add_hook
Ë(
if_rm≠
 *Ë
NULL
;

34 (*
if_rm≠_dñëe_hook
Ë(
if_rm≠
 *Ë
NULL
;

36 
if_rm≠
 *

37 
	$if_rm≠_√w
 ()

39 
if_rm≠
 *
√w
;

41 
√w
 = 
	`XCALLOC
 (
MTYPE_IF_RMAP
,  (
if_rm≠
));

43  
√w
;

44 
	}
}

47 
	$if_rm≠_‰ì
 (
if_rm≠
 *if_rmap)

49 i‡(
if_rm≠
->
i‚ame
)

50 
	`XFREE
 (
MTYPE_IF_RMAP_NAME
, 
if_rm≠
->
i‚ame
);

52 i‡(
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
])

53 
	`XFREE
 (
MTYPE_IF_RMAP_NAME
, 
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
]);

54 i‡(
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
])

55 
	`XFREE
 (
MTYPE_IF_RMAP_NAME
, 
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
]);

57 
	`XFREE
 (
MTYPE_IF_RMAP
, 
if_rm≠
);

58 
	}
}

60 
if_rm≠
 *

61 
	$if_rm≠_lookup
 (c⁄° *
i‚ame
)

63 
if_rm≠
 
key
;

64 
if_rm≠
 *if_rmap;

67 
key
.
i‚ame
 = (*)ifname;

69 
if_rm≠
 = 
	`hash_lookup
 (
i‰m≠hash
, &
key
);

71  
if_rm≠
;

72 
	}
}

75 
if_rm≠_hook_add
 ((*
func
Ë(
if_rm≠
 *))

77 
if_rm≠_add_hook
 = 
func
;

78 
	}
}

81 
if_rm≠_hook_dñëe
 ((*
func
Ë(
if_rm≠
 *))

83 
if_rm≠_dñëe_hook
 = 
func
;

84 
	}
}

87 
	$if_rm≠_hash_Æloc
 (*
¨g
)

89 
if_rm≠
 *
iÁrg
 = 
¨g
;

90 
if_rm≠
 *if_rmap;

92 
if_rm≠
 = 
	`if_rm≠_√w
 ();

93 
if_rm≠
->
i‚ame
 = 
	`XSTRDUP
 (
MTYPE_IF_RMAP_NAME
, 
iÁrg
->ifname);

95  
if_rm≠
;

96 
	}
}

98 
if_rm≠
 *

99 
	$if_rm≠_gë
 (c⁄° *
i‚ame
)

101 
if_rm≠
 
key
;

104 
key
.
i‚ame
 = (*)ifname;

106  (
if_rm≠
 *Ë
	`hash_gë
 (
i‰m≠hash
, &
key
, 
if_rm≠_hash_Æloc
);

107 
	}
}

110 
	$if_rm≠_hash_make
 (*
d©a
)

112 c⁄° 
if_rm≠
 *if_rm≠ = 
d©a
;

114  
	`°rög_hash_make
 (
if_rm≠
->
i‚ame
);

115 
	}
}

118 
	$if_rm≠_hash_cmp
 (c⁄° *
¨g1
, c⁄° * 
¨g2
)

120 c⁄° 
if_rm≠
 *
if_rm≠1
 = 
¨g1
;

121 c⁄° 
if_rm≠
 *
if_rm≠2
 = 
¨g2
;

123  
	`°rcmp
 (
if_rm≠1
->
i‚ame
, 
if_rm≠2
->ifname) == 0;

124 
	}
}

126 
if_rm≠
 *

127 
	$if_rm≠_£t
 (c⁄° *
i‚ame
, 
if_rm≠_ty≥
 
ty≥
,

128 c⁄° *
rouãm≠_«me
)

130 
if_rm≠
 *if_rmap;

132 
if_rm≠
 = 
	`if_rm≠_gë
 (
i‚ame
);

134 i‡(
ty≥
 =
IF_RMAP_IN
)

136 i‡(
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
])

137 
	`XFREE
 (
MTYPE_IF_RMAP_NAME
, 
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
]);

138 
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
]

139 
	`XSTRDUP
 (
MTYPE_IF_RMAP_NAME
, 
rouãm≠_«me
);

141 i‡(
ty≥
 =
IF_RMAP_OUT
)

143 i‡(
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
])

144 
	`XFREE
 (
MTYPE_IF_RMAP_NAME
, 
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
]);

145 
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
]

146 
	`XSTRDUP
 (
MTYPE_IF_RMAP_NAME
, 
rouãm≠_«me
);

149 i‡(
if_rm≠_add_hook
)

150 (*
if_rm≠_add_hook
Ë(
if_rm≠
);

152  
if_rm≠
;

153 
	}
}

156 
	$if_rm≠_un£t
 (c⁄° *
i‚ame
, 
if_rm≠_ty≥
 
ty≥
,

157 c⁄° *
rouãm≠_«me
)

159 
if_rm≠
 *if_rmap;

161 
if_rm≠
 = 
	`if_rm≠_lookup
 (
i‚ame
);

162 i‡(!
if_rm≠
)

165 i‡(
ty≥
 =
IF_RMAP_IN
)

167 i‡(!
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
])

169 i‡(
	`°rcmp
 (
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
], 
rouãm≠_«me
) != 0)

172 
	`XFREE
 (
MTYPE_IF_RMAP_NAME
, 
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
]);

173 
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
] = 
NULL
;

176 i‡(
ty≥
 =
IF_RMAP_OUT
)

178 i‡(!
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
])

180 i‡(
	`°rcmp
 (
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
], 
rouãm≠_«me
) != 0)

183 
	`XFREE
 (
MTYPE_IF_RMAP_NAME
, 
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
]);

184 
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
] = 
NULL
;

187 i‡(
if_rm≠_dñëe_hook
)

188 (*
if_rm≠_dñëe_hook
Ë(
if_rm≠
);

190 i‡(
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
] =
NULL
 &&

191 
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
] =
NULL
)

193 
	`hash_ªÀa£
 (
i‰m≠hash
, 
if_rm≠
);

194 
	`if_rm≠_‰ì
 (
if_rm≠
);

198 
	}
}

200 
DEFUN
 (
if_rm≠
,

201 
if_rm≠_cmd
,

209 
if_rm≠_ty≥
 
	gty≥
;

211 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

212 
ty≥
 = 
IF_RMAP_IN
;

213 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

214 
ty≥
 = 
IF_RMAP_OUT
;

217 
vty_out
 (
vty
, "rouã-m≠ dúe˘i⁄ mu° bê[ö|out]%s", 
VTY_NEWLINE
);

218  
	gCMD_WARNING
;

221 
if_rm≠_£t
 (
¨gv
[2], 
ty≥
,árgv[0]);

223  
	gCMD_SUCCESS
;

226 
ALIAS
 (
if_rm≠
,

227 
if_ùv6_rm≠_cmd
,

235 
DEFUN
 (
no_if_rm≠
,

236 
no_if_rm≠_cmd
,

238 
NO_STR


245 
	gªt
;

246 
if_rm≠_ty≥
 
	gty≥
;

248 i‡(
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

249 
ty≥
 = 
IF_RMAP_IN
;

250 i‡(
°∫cmp
 (
¨gv
[1], "o", 1) == 0)

251 
ty≥
 = 
IF_RMAP_OUT
;

254 
vty_out
 (
vty
, "rouã-m≠ dúe˘i⁄ mu° bê[ö|out]%s", 
VTY_NEWLINE
);

255  
	gCMD_WARNING
;

258 
	gªt
 = 
if_rm≠_un£t
 (
¨gv
[2], 
ty≥
,árgv[0]);

259 i‡(! 
	gªt
)

261 
vty_out
 (
vty
, "rouã-m≠ d€¢'àexi°%s", 
VTY_NEWLINE
);

262  
	gCMD_WARNING
;

264  
	gCMD_SUCCESS
;

267 
ALIAS
 (
no_if_rm≠
,

268 
no_if_ùv6_rm≠_cmd
,

270 
NO_STR


279 
	$c⁄fig_wrôe_if_rm≠
 (
vty
 *vty)

281 
i
;

282 
hash_backë
 *
mp
;

283 
wrôe
 = 0;

285 
i
 = 0; i < 
i‰m≠hash
->
size
; i++)

286 
mp
 = 
i‰m≠hash
->
ödex
[
i
]; mp; m∞mp->
√xt
)

288 
if_rm≠
 *if_rmap;

290 
if_rm≠
 = 
mp
->
d©a
;

292 i‡(
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
])

294 
	`vty_out
 (
vty
, "Ñoute-map %s in %s%s",

295 
if_rm≠
->
rouãm≠
[
IF_RMAP_IN
],

296 
if_rm≠
->
i‚ame
,

297 
VTY_NEWLINE
);

298 
wrôe
++;

301 i‡(
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
])

303 
	`vty_out
 (
vty
, "Ñoute-map %s out %s%s",

304 
if_rm≠
->
rouãm≠
[
IF_RMAP_OUT
],

305 
if_rm≠
->
i‚ame
,

306 
VTY_NEWLINE
);

307 
wrôe
++;

310  
wrôe
;

311 
	}
}

314 
	$if_rm≠_ª£t
 ()

316 
	`hash_˛ón
 (
i‰m≠hash
, ((*Ë(*)Ë
if_rm≠_‰ì
);

317 
	}
}

320 
	$if_rm≠_öô
 (
node
)

322 
i‰m≠hash
 = 
	`hash_¸óã
 (
if_rm≠_hash_make
, 
if_rm≠_hash_cmp
);

323 i‡(
node
 =
RIPNG_NODE
) {

324 
	`ö°Æl_ñemít
 (
RIPNG_NODE
, &
if_ùv6_rm≠_cmd
);

325 
	`ö°Æl_ñemít
 (
RIPNG_NODE
, &
no_if_ùv6_rm≠_cmd
);

326 } i‡(
node
 =
RIP_NODE
) {

327 
	`ö°Æl_ñemít
 (
RIP_NODE
, &
if_rm≠_cmd
);

328 
	`ö°Æl_ñemít
 (
RIP_NODE
, &
no_if_rm≠_cmd
);

330 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if_rmap.h

22 #i‚de‡
_ZEBRA_IF_RMAP_H


23 
	#_ZEBRA_IF_RMAP_H


	)

25 
	eif_rm≠_ty≥


27 
	mIF_RMAP_IN
,

28 
	mIF_RMAP_OUT
,

29 
	mIF_RMAP_MAX


32 
	sif_rm≠


35 *
	mi‚ame
;

37 *
	mrouãm≠
[
IF_RMAP_MAX
];

40 
if_rm≠_öô
 ();

41 
if_rm≠_ª£t
 ();

42 
if_rm≠_hook_add
 ((*Ë(
if_rm≠
 *));

43 
	`if_rm≠_hook_dñëe
 ((*Ë(
if_rm≠
 *));

44 
if_rm≠
 *
	`if_rm≠_lookup
 (const *);

45 
	`c⁄fig_wrôe_if_rm≠
 (
vty
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/jhash.c

20 
	~"zebø.h
"

21 
	~"jhash.h
"

24 
	#JHASH_GOLDEN_RATIO
 0x9e3779b9

	)

27 
	#__jhash_mix
(
a
, 
b
, 
c
) \

29 
a
 -
b
;á -
c
;á ^= (c>>13); \

30 
b
 -
c
; b -
a
; b ^= (a<<8); \

31 
c
 -
a
; c -
b
; c ^= (b>>13); \

32 
a
 -
b
;á -
c
;á ^= (c>>12); \

33 
b
 -
c
; b -
a
; b ^= (a<<16); \

34 
c
 -
a
; c -
b
; c ^= (b>>5); \

35 
a
 -
b
;á -
c
;á ^= (c>>3); \

36 
b
 -
c
; b -
a
; b ^= (a<<10); \

37 
c
 -
a
; c -
b
; c ^= (b>>15); \

38 }

	)

44 
u_öt32_t


45 
	$jhash
 (*
key
, 
u_öt32_t
 
Àngth
, u_öt32_à
öôvÆ
)

47 
u_öt32_t
 
a
, 
b
, 
c
, 
Àn
;

48 
u_öt8_t
 *
k
 = 
key
;

50 
Àn
 = 
Àngth
;

51 
a
 = 
b
 = 
JHASH_GOLDEN_RATIO
;

52 
c
 = 
öôvÆ
;

54 
Àn
 >= 12)

56 
a
 +=

57 (
k
[0] + ((
u_öt32_t
) k[1] << 8) + ((u_int32_t) k[2] << 16) +

58 ((
u_öt32_t
Ë
k
[3] << 24));

59 
b
 +=

60 (
k
[4] + ((
u_öt32_t
) k[5] << 8) + ((u_int32_t) k[6] << 16) +

61 ((
u_öt32_t
Ë
k
[7] << 24));

62 
c
 +=

63 (
k
[8] + ((
u_öt32_t
) k[9] << 8) + ((u_int32_t) k[10] << 16) +

64 ((
u_öt32_t
Ë
k
[11] << 24));

66 
	`__jhash_mix
 (
a
, 
b
, 
c
);

68 
k
 += 12;

69 
Àn
 -= 12;

72 
c
 +
Àngth
;

73 
Àn
)

76 
c
 +((
u_öt32_t
Ë
k
[10] << 24);

78 
c
 +((
u_öt32_t
Ë
k
[9] << 16);

80 
c
 +((
u_öt32_t
Ë
k
[8] << 8);

82 
b
 +((
u_öt32_t
Ë
k
[7] << 24);

84 
b
 +((
u_öt32_t
Ë
k
[6] << 16);

86 
b
 +((
u_öt32_t
Ë
k
[5] << 8);

88 
b
 +
k
[4];

90 
a
 +((
u_öt32_t
Ë
k
[3] << 24);

92 
a
 +((
u_öt32_t
Ë
k
[2] << 16);

94 
a
 +((
u_öt32_t
Ë
k
[1] << 8);

96 
a
 +
k
[0];

99 
	`__jhash_mix
 (
a
, 
b
, 
c
);

101  
c
;

102 
	}
}

107 
u_öt32_t


108 
	$jhash2
 (
u_öt32_t
 * 
k
, u_öt32_à
Àngth
, u_öt32_à
öôvÆ
)

110 
u_öt32_t
 
a
, 
b
, 
c
, 
Àn
;

112 
a
 = 
b
 = 
JHASH_GOLDEN_RATIO
;

113 
c
 = 
öôvÆ
;

114 
Àn
 = 
Àngth
;

116 
Àn
 >= 3)

118 
a
 +
k
[0];

119 
b
 +
k
[1];

120 
c
 +
k
[2];

121 
	`__jhash_mix
 (
a
, 
b
, 
c
);

122 
k
 += 3;

123 
Àn
 -= 3;

126 
c
 +
Àngth
 * 4;

128 
Àn
)

131 
b
 +
k
[1];

133 
a
 +
k
[0];

136 
	`__jhash_mix
 (
a
, 
b
, 
c
);

138  
c
;

139 
	}
}

148 
u_öt32_t


149 
	$jhash_3w‹ds
 (
u_öt32_t
 
a
, u_öt32_à
b
, u_öt32_à
c
, u_öt32_à
öôvÆ
)

151 
a
 +
JHASH_GOLDEN_RATIO
;

152 
b
 +
JHASH_GOLDEN_RATIO
;

153 
c
 +
öôvÆ
;

155 
	`__jhash_mix
 (
a
, 
b
, 
c
);

157  
c
;

158 
	}
}

160 
u_öt32_t


161 
	$jhash_2w‹ds
 (
u_öt32_t
 
a
, u_öt32_à
b
, u_öt32_à
öôvÆ
)

163  
	`jhash_3w‹ds
 (
a
, 
b
, 0, 
öôvÆ
);

164 
	}
}

166 
u_öt32_t


167 
	$jhash_1w‹d
 (
u_öt32_t
 
a
, u_öt32_à
öôvÆ
)

169  
	`jhash_3w‹ds
 (
a
, 0, 0, 
öôvÆ
);

170 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/jhash.h

20 #i‚de‡
_QUAGGA_JHASH_H


21 
	#_QUAGGA_JHASH_H


	)

27 
u_öt32_t
 
jhash
(*
key
, u_öt32_à
Àngth
, u_öt32_à
öôvÆ
);

32 
u_öt32_t
 
jhash2
(u_öt32_à*
k
, u_öt32_à
Àngth
, u_öt32_à
öôvÆ
);

40 
u_öt32_t
 
jhash_3w‹ds
(u_öt32_à
a
, u_öt32_à
b
, u_öt32_à
c
, u_öt32_à
öôvÆ
);

41 
u_öt32_t
 
jhash_2w‹ds
(u_öt32_à
a
, u_öt32_à
b
, u_öt32_à
öôvÆ
);

42 
u_öt32_t
 
jhash_1w‹d
(u_öt32_à
a
, u_öt32_à
öôvÆ
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/keychain.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"mem‹y.h
"

25 
	~"lökli°.h
"

26 
	~"keychaö.h
"

29 
li°
 *
	gkeychaö_li°
;

31 
keychaö
 *

32 
	$keychaö_√w
 ()

34  
	`XCALLOC
 (
MTYPE_KEYCHAIN
,  (
keychaö
));

35 
	}
}

38 
	$keychaö_‰ì
 (
keychaö
 *keychain)

40 
	`XFREE
 (
MTYPE_KEYCHAIN
, 
keychaö
);

41 
	}
}

43 
key
 *

44 
	$key_√w
 ()

46  
	`XCALLOC
 (
MTYPE_KEY
,  (
key
));

47 
	}
}

50 
	$key_‰ì
 (
key
 *key)

52 
	`XFREE
 (
MTYPE_KEY
, 
key
);

53 
	}
}

55 
keychaö
 *

56 
	$keychaö_lookup
 (c⁄° *
«me
)

58 
li°node
 *
node
;

59 
keychaö
 *keychain;

61 i‡(
«me
 =
NULL
)

62  
NULL
;

64 
	`ALL_LIST_ELEMENTS_RO
 (
keychaö_li°
, 
node
, 
keychaö
))

66 i‡(
	`°rcmp
 (
keychaö
->
«me
,Çame) == 0)

67  
keychaö
;

69  
NULL
;

70 
	}
}

73 
	$key_cmp_func
 (*
¨g1
, *
¨g2
)

75 c⁄° 
key
 *
k1
 = 
¨g1
;

76 c⁄° 
key
 *
k2
 = 
¨g2
;

78 i‡(
k1
->
ödex
 > 
k2
->index)

80 i‡(
k1
->
ödex
 < 
k2
->index)

83 
	}
}

86 
	$key_dñëe_func
 (
key
 *key)

88 i‡(
key
->
°rög
)

89 
	`‰ì
 (
key
->
°rög
);

90 
	`key_‰ì
 (
key
);

91 
	}
}

93 
keychaö
 *

94 
	$keychaö_gë
 (c⁄° *
«me
)

96 
keychaö
 *keychain;

98 
keychaö
 = 
	`keychaö_lookup
 (
«me
);

100 i‡(
keychaö
)

101  
keychaö
;

103 
keychaö
 = 
	`keychaö_√w
 ();

104 
keychaö
->
«me
 = 
	`°rdup
 (name);

105 
keychaö
->
key
 = 
	`li°_√w
 ();

106 
keychaö
->
key
->
cmp
 = ((*)(*, *)Ë
key_cmp_func
;

107 
keychaö
->
key
->
dñ
 = ((*)(*)Ë
key_dñëe_func
;

108 
	`li°node_add
 (
keychaö_li°
, 
keychaö
);

110  
keychaö
;

111 
	}
}

114 
	$keychaö_dñëe
 (
keychaö
 *keychain)

116 i‡(
keychaö
->
«me
)

117 
	`‰ì
 (
keychaö
->
«me
);

119 
	`li°_dñëe
 (
keychaö
->
key
);

120 
	`li°node_dñëe
 (
keychaö_li°
, 
keychaö
);

121 
	`keychaö_‰ì
 (
keychaö
);

122 
	}
}

124 
key
 *

125 
	$key_lookup
 (c⁄° 
keychaö
 *keychaö, 
u_öt32_t
 
ödex
)

127 
li°node
 *
node
;

128 
key
 *key;

130 
	`ALL_LIST_ELEMENTS_RO
 (
keychaö
->
key
, 
node
, key))

132 i‡(
key
->
ödex
 == index)

133  
key
;

135  
NULL
;

136 
	}
}

138 
key
 *

139 
	$key_lookup_f‹_ac˚±
 (c⁄° 
keychaö
 *keychaö, 
u_öt32_t
 
ödex
)

141 
li°node
 *
node
;

142 
key
 *key;

143 
time_t
 
now
;

145 
now
 = 
	`time
 (
NULL
);

147 
	`ALL_LIST_ELEMENTS_RO
 (
keychaö
->
key
, 
node
, key))

149 i‡(
key
->
ödex
 >= index)

151 i‡(
key
->
ac˚±
.
°¨t
 == 0)

152  
key
;

154 i‡(
key
->
ac˚±
.
°¨t
 <
now
)

155 i‡(
key
->
ac˚±
.
íd
 >
now
 || key->accept.end == -1)

156  
key
;

159  
NULL
;

160 
	}
}

162 
key
 *

163 
	$key_m©ch_f‹_ac˚±
 (c⁄° 
keychaö
 *keychaö, c⁄° *
auth_°r
)

165 
li°node
 *
node
;

166 
key
 *key;

167 
time_t
 
now
;

169 
now
 = 
	`time
 (
NULL
);

171 
	`ALL_LIST_ELEMENTS_RO
 (
keychaö
->
key
, 
node
, key))

173 i‡(
key
->
ac˚±
.
°¨t
 == 0 ||

174 (
key
->
ac˚±
.
°¨t
 <
now
 &&

175 (
key
->
ac˚±
.
íd
 >
now
 || key->accept.end == -1)))

176 i‡(
	`°∫cmp
 (
key
->
°rög
, 
auth_°r
, 16) == 0)

177  
key
;

179  
NULL
;

180 
	}
}

182 
key
 *

183 
	$key_lookup_f‹_£nd
 (c⁄° 
keychaö
 *keychain)

185 
li°node
 *
node
;

186 
key
 *key;

187 
time_t
 
now
;

189 
now
 = 
	`time
 (
NULL
);

191 
	`ALL_LIST_ELEMENTS_RO
 (
keychaö
->
key
, 
node
, key))

193 i‡(
key
->
£nd
.
°¨t
 == 0)

194  
key
;

196 i‡(
key
->
£nd
.
°¨t
 <
now
)

197 i‡(
key
->
£nd
.
íd
 >
now
 || key->send.end == -1)

198  
key
;

200  
NULL
;

201 
	}
}

203 
key
 *

204 
	$key_gë
 (c⁄° 
keychaö
 *keychaö, 
u_öt32_t
 
ödex
)

206 
key
 *key;

208 
key
 = 
	`key_lookup
 (
keychaö
, 
ödex
);

210 i‡(
key
)

211  
key
;

213 
key
 = 
	`key_√w
 ();

214 
key
->
ödex
 = index;

215 
	`li°node_add_s‹t
 (
keychaö
->
key
, key);

217  
key
;

218 
	}
}

221 
	$key_dñëe
 (
keychaö
 *keychaö, 
key
 *key)

223 
	`li°node_dñëe
 (
keychaö
->
key
, key);

225 i‡(
key
->
°rög
)

226 
	`‰ì
 (
key
->
°rög
);

227 
	`key_‰ì
 (
key
);

228 
	}
}

230 
DEFUN
 (
key_chaö
,

231 
key_chaö_cmd
,

237 
keychaö
 *
	gkeychaö
;

239 
	gkeychaö
 = 
keychaö_gë
 (
¨gv
[0]);

240 
	gvty
->
	gödex
 = 
keychaö
;

241 
	gvty
->
	gnode
 = 
KEYCHAIN_NODE
;

243  
	gCMD_SUCCESS
;

246 
DEFUN
 (
no_key_chaö
,

247 
no_key_chaö_cmd
,

249 
NO_STR


254 
keychaö
 *
	gkeychaö
;

256 
	gkeychaö
 = 
keychaö_lookup
 (
¨gv
[0]);

258 i‡(! 
	gkeychaö
)

260 
vty_out
 (
vty
, "C™'àföd keychaö %s%s", 
¨gv
[0], 
VTY_NEWLINE
);

261  
	gCMD_WARNING
;

264 
keychaö_dñëe
 (
keychaö
);

266  
	gCMD_SUCCESS
;

269 
DEFUN
 (
key
,

270 
key_cmd
,

275 
keychaö
 *
	gkeychaö
;

276 
key
 *
	gkey
;

277 
u_öt32_t
 
	gödex
;

279 
	gkeychaö
 = 
vty
->
ödex
;

281 
VTY_GET_INTEGER
 ("key idítifõr", 
ödex
, 
¨gv
[0]);

282 
	gkey
 = 
key_gë
 (
keychaö
, 
ödex
);

283 
	gvty
->
	gödex_sub
 = 
key
;

284 
	gvty
->
	gnode
 = 
KEYCHAIN_KEY_NODE
;

286  
	gCMD_SUCCESS
;

289 
DEFUN
 (
no_key
,

290 
no_key_cmd
,

292 
NO_STR


296 
keychaö
 *
	gkeychaö
;

297 
key
 *
	gkey
;

298 
u_öt32_t
 
	gödex
;

300 
	gkeychaö
 = 
vty
->
ödex
;

302 
VTY_GET_INTEGER
 ("key idítifõr", 
ödex
, 
¨gv
[0]);

303 
	gkey
 = 
key_lookup
 (
keychaö
, 
ödex
);

304 i‡(! 
	gkey
)

306 
vty_out
 (
vty
, "C™'àföd key %d%s", 
ödex
, 
VTY_NEWLINE
);

307  
	gCMD_WARNING
;

310 
key_dñëe
 (
keychaö
, 
key
);

312 
	gvty
->
	gnode
 = 
KEYCHAIN_NODE
;

314  
	gCMD_SUCCESS
;

317 
DEFUN
 (
key_°rög
,

318 
key_°rög_cmd
,

323 
key
 *
	gkey
;

325 
	gkey
 = 
vty
->
ödex_sub
;

327 i‡(
	gkey
->
	g°rög
)

328 
‰ì
 (
key
->
°rög
);

329 
	gkey
->
	g°rög
 = 
°rdup
 (
¨gv
[0]);

331  
	gCMD_SUCCESS
;

334 
DEFUN
 (
no_key_°rög
,

335 
no_key_°rög_cmd
,

337 
NO_STR


341 
key
 *
	gkey
;

343 
	gkey
 = 
vty
->
ödex_sub
;

345 i‡(
	gkey
->
	g°rög
)

347 
‰ì
 (
key
->
°rög
);

348 
	gkey
->
	g°rög
 = 
NULL
;

351  
	gCMD_SUCCESS
;

356 
time_t


357 
	$key_°r2time
 (c⁄° *
time_°r
, c⁄° *
day_°r
, c⁄° *
m⁄th_°r
,

358 c⁄° *
yór_°r
)

360 
i
 = 0;

361 *
cﬁ⁄
;

362 
tm
Åm;

363 
time_t
 
time
;

364 
£c
, 
mö
, 
hour
;

365 
day
, 
m⁄th
, 
yór
;

367 c⁄° *
m⁄th_«me
[] =

381 
NULL


384 
	#GET_LONG_RANGE
(
V
,
STR
,
MIN
,
MAX
) \

386 
tm∂
; \

387 *
íd±r
 = 
NULL
; \

388 
tm∂
 = 
	`°πoul
 ((
STR
), &
íd±r
, 10); \

389 i‡(*
íd±r
 !'\0' || 
tm∂
 =
ULONG_MAX
) \

391 i‡–
tm∂
 < (
MIN
Ë||Åm∂ > (
MAX
)) \

393 (
V
Ë
tm∂
; \

394 }

	)

397 
cﬁ⁄
 = 
	`°rchr
 (
time_°r
, ':');

398 i‡(
cﬁ⁄
 =
NULL
)

400 *
cﬁ⁄
 = '\0';

403 
	`GET_LONG_RANGE
 (
hour
, 
time_°r
, 0, 23);

406 
time_°r
 = 
cﬁ⁄
 + 1;

407 
cﬁ⁄
 = 
	`°rchr
 (
time_°r
, ':');

408 i‡(*
time_°r
 ='\0' || 
cﬁ⁄
 =
NULL
)

410 *
cﬁ⁄
 = '\0';

413 
	`GET_LONG_RANGE
 (
mö
, 
time_°r
, 0, 59);

416 
time_°r
 = 
cﬁ⁄
 + 1;

417 i‡(*
time_°r
 == '\0')

421 
	`GET_LONG_RANGE
 (
£c
, 
time_°r
, 0, 59);

424 
	`GET_LONG_RANGE
 (
day
, 
day_°r
, 1, 31);

427 
m⁄th
 = 0;

428 i‡(
	`°æí
 (
m⁄th_°r
) >= 3)

429 
i
 = 0; 
m⁄th_«me
[i]; i++)

430 i‡(
	`°∫cmp
 (
m⁄th_°r
, 
m⁄th_«me
[
i
], 
	`°æí
 (month_str)) == 0)

432 
m⁄th
 = 
i
;

435 i‡(! 
m⁄th_«me
[
i
])

439 
	`GET_LONG_RANGE
 (
yór
, 
yór_°r
, 1993, 2035);

441 
	`mem£t
 (&
tm
, 0,  (tm));

442 
tm
.
tm_£c
 = 
£c
;

443 
tm
.
tm_mö
 = 
mö
;

444 
tm
.
tm_hour
 = 
hour
;

445 
tm
.
tm_m⁄
 = 
m⁄th
;

446 
tm
.
tm_mday
 = 
day
;

447 
tm
.
tm_yór
 = 
yór
 - 1900;

449 
time
 = 
	`mktime
 (&
tm
);

451  
time
;

452 #unde‡
GET_LONG_RANGE


453 
	}
}

456 
	$key_li„time_£t
 (
vty
 *vty, 
key_ønge
 *
kønge
,

457 c⁄° *
°ime_°r
, c⁄° *
sday_°r
,

458 c⁄° *
sm⁄th_°r
, c⁄° *
syór_°r
,

459 c⁄° *
ëime_°r
, c⁄° *
eday_°r
,

460 c⁄° *
em⁄th_°r
, c⁄° *
eyór_°r
)

462 
time_t
 
time_°¨t
;

463 
time_t
 
time_íd
;

465 
time_°¨t
 = 
	`key_°r2time
 (
°ime_°r
, 
sday_°r
, 
sm⁄th_°r
, 
syór_°r
);

466 i‡(
time_°¨t
 < 0)

468 
	`vty_out
 (
vty
, "MÆf‹medÅimêvÆue%s", 
VTY_NEWLINE
);

469  
CMD_WARNING
;

471 
time_íd
 = 
	`key_°r2time
 (
ëime_°r
, 
eday_°r
, 
em⁄th_°r
, 
eyór_°r
);

473 i‡(
time_íd
 < 0)

475 
	`vty_out
 (
vty
, "MÆf‹medÅimêvÆue%s", 
VTY_NEWLINE
);

476  
CMD_WARNING
;

479 i‡(
time_íd
 <
time_°¨t
)

481 
	`vty_out
 (
vty
, "Expúêtimêi†nŸÜ©îÅh™ sèπÅime%s", 
VTY_NEWLINE
);

482  
CMD_WARNING
;

485 
kønge
->
°¨t
 = 
time_°¨t
;

486 
kønge
->
íd
 = 
time_íd
;

488  
CMD_SUCCESS
;

489 
	}
}

492 
	$key_li„time_duøti⁄_£t
 (
vty
 *vty, 
key_ønge
 *
kønge
,

493 c⁄° *
°ime_°r
, c⁄° *
sday_°r
,

494 c⁄° *
sm⁄th_°r
, c⁄° *
syór_°r
,

495 c⁄° *
duøti⁄_°r
)

497 
time_t
 
time_°¨t
;

498 
u_öt32_t
 
duøti⁄
;

500 
time_°¨t
 = 
	`key_°r2time
 (
°ime_°r
, 
sday_°r
, 
sm⁄th_°r
, 
syór_°r
);

501 i‡(
time_°¨t
 < 0)

503 
	`vty_out
 (
vty
, "MÆf‹medÅimêvÆue%s", 
VTY_NEWLINE
);

504  
CMD_WARNING
;

506 
kønge
->
°¨t
 = 
time_°¨t
;

508 
	`VTY_GET_INTEGER
 ("duøti⁄", 
duøti⁄
, 
duøti⁄_°r
);

509 
kønge
->
duøti⁄
 = 1;

510 
kønge
->
íd
 = 
time_°¨t
 + 
duøti⁄
;

512  
CMD_SUCCESS
;

513 
	}
}

516 
	$key_li„time_öföôe_£t
 (
vty
 *vty, 
key_ønge
 *
kønge
,

517 c⁄° *
°ime_°r
, c⁄° *
sday_°r
,

518 c⁄° *
sm⁄th_°r
, c⁄° *
syór_°r
)

520 
time_t
 
time_°¨t
;

522 
time_°¨t
 = 
	`key_°r2time
 (
°ime_°r
, 
sday_°r
, 
sm⁄th_°r
, 
syór_°r
);

523 i‡(
time_°¨t
 < 0)

525 
	`vty_out
 (
vty
, "MÆf‹medÅimêvÆue%s", 
VTY_NEWLINE
);

526  
CMD_WARNING
;

528 
kønge
->
°¨t
 = 
time_°¨t
;

530 
kønge
->
íd
 = -1;

532  
CMD_SUCCESS
;

533 
	}
}

535 
DEFUN
 (
ac˚±_li„time_day_m⁄th_day_m⁄th
,

536 
ac˚±_li„time_day_m⁄th_day_m⁄th_cmd
,

548 
key
 *
	gkey
;

550 
	gkey
 = 
vty
->
ödex_sub
;

552  
key_li„time_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[1],árgv[2],

553 
¨gv
[3],árgv[4],árgv[5],árgv[6],árgv[7]);

556 
DEFUN
 (
ac˚±_li„time_day_m⁄th_m⁄th_day
,

557 
ac˚±_li„time_day_m⁄th_m⁄th_day_cmd
,

569 
key
 *
	gkey
;

571 
	gkey
 = 
vty
->
ödex_sub
;

573  
key_li„time_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[1],árgv[2],

574 
¨gv
[3],árgv[4],árgv[6],árgv[5],árgv[7]);

577 
DEFUN
 (
ac˚±_li„time_m⁄th_day_day_m⁄th
,

578 
ac˚±_li„time_m⁄th_day_day_m⁄th_cmd
,

590 
key
 *
	gkey
;

592 
	gkey
 = 
vty
->
ödex_sub
;

594  
key_li„time_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[2],árgv[1],

595 
¨gv
[3],árgv[4],árgv[5],árgv[6],árgv[7]);

598 
DEFUN
 (
ac˚±_li„time_m⁄th_day_m⁄th_day
,

599 
ac˚±_li„time_m⁄th_day_m⁄th_day_cmd
,

611 
key
 *
	gkey
;

613 
	gkey
 = 
vty
->
ödex_sub
;

615  
key_li„time_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[2],árgv[1],

616 
¨gv
[3],árgv[4],árgv[6],árgv[5],árgv[7]);

619 
DEFUN
 (
ac˚±_li„time_öföôe_day_m⁄th
,

620 
ac˚±_li„time_öföôe_day_m⁄th_cmd
,

629 
key
 *
	gkey
;

631 
	gkey
 = 
vty
->
ödex_sub
;

633  
key_li„time_öföôe_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[1],

634 
¨gv
[2],árgv[3]);

637 
DEFUN
 (
ac˚±_li„time_öföôe_m⁄th_day
,

638 
ac˚±_li„time_öföôe_m⁄th_day_cmd
,

647 
key
 *
	gkey
;

649 
	gkey
 = 
vty
->
ödex_sub
;

651  
key_li„time_öföôe_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[2],

652 
¨gv
[1],árgv[3]);

655 
DEFUN
 (
ac˚±_li„time_duøti⁄_day_m⁄th
,

656 
ac˚±_li„time_duøti⁄_day_m⁄th_cmd
,

666 
key
 *
	gkey
;

668 
	gkey
 = 
vty
->
ödex_sub
;

670  
key_li„time_duøti⁄_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[1],

671 
¨gv
[2],árgv[3],árgv[4]);

674 
DEFUN
 (
ac˚±_li„time_duøti⁄_m⁄th_day
,

675 
ac˚±_li„time_duøti⁄_m⁄th_day_cmd
,

685 
key
 *
	gkey
;

687 
	gkey
 = 
vty
->
ödex_sub
;

689  
key_li„time_duøti⁄_£t
 (
vty
, &
key
->
ac˚±
, 
¨gv
[0],árgv[2],

690 
¨gv
[1],árgv[3],árgv[4]);

693 
DEFUN
 (
£nd_li„time_day_m⁄th_day_m⁄th
,

694 
£nd_li„time_day_m⁄th_day_m⁄th_cmd
,

706 
key
 *
	gkey
;

708 
	gkey
 = 
vty
->
ödex_sub
;

710  
key_li„time_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[1],árgv[2],árgv[3],

711 
¨gv
[4],árgv[5],árgv[6],árgv[7]);

714 
DEFUN
 (
£nd_li„time_day_m⁄th_m⁄th_day
,

715 
£nd_li„time_day_m⁄th_m⁄th_day_cmd
,

727 
key
 *
	gkey
;

729 
	gkey
 = 
vty
->
ödex_sub
;

731  
key_li„time_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[1],árgv[2],árgv[3],

732 
¨gv
[4],árgv[6],árgv[5],árgv[7]);

735 
DEFUN
 (
£nd_li„time_m⁄th_day_day_m⁄th
,

736 
£nd_li„time_m⁄th_day_day_m⁄th_cmd
,

748 
key
 *
	gkey
;

750 
	gkey
 = 
vty
->
ödex_sub
;

752  
key_li„time_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[2],árgv[1],árgv[3],

753 
¨gv
[4],árgv[5],árgv[6],árgv[7]);

756 
DEFUN
 (
£nd_li„time_m⁄th_day_m⁄th_day
,

757 
£nd_li„time_m⁄th_day_m⁄th_day_cmd
,

769 
key
 *
	gkey
;

771 
	gkey
 = 
vty
->
ödex_sub
;

773  
key_li„time_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[2],árgv[1],árgv[3],

774 
¨gv
[4],árgv[6],árgv[5],árgv[7]);

777 
DEFUN
 (
£nd_li„time_öföôe_day_m⁄th
,

778 
£nd_li„time_öföôe_day_m⁄th_cmd
,

787 
key
 *
	gkey
;

789 
	gkey
 = 
vty
->
ödex_sub
;

791  
key_li„time_öföôe_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[1],árgv[2],

792 
¨gv
[3]);

795 
DEFUN
 (
£nd_li„time_öföôe_m⁄th_day
,

796 
£nd_li„time_öföôe_m⁄th_day_cmd
,

805 
key
 *
	gkey
;

807 
	gkey
 = 
vty
->
ödex_sub
;

809  
key_li„time_öföôe_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[2],árgv[1],

810 
¨gv
[3]);

813 
DEFUN
 (
£nd_li„time_duøti⁄_day_m⁄th
,

814 
£nd_li„time_duøti⁄_day_m⁄th_cmd
,

824 
key
 *
	gkey
;

826 
	gkey
 = 
vty
->
ödex_sub
;

828  
key_li„time_duøti⁄_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[1],árgv[2],

829 
¨gv
[3],árgv[4]);

832 
DEFUN
 (
£nd_li„time_duøti⁄_m⁄th_day
,

833 
£nd_li„time_duøti⁄_m⁄th_day_cmd
,

843 
key
 *
	gkey
;

845 
	gkey
 = 
vty
->
ödex_sub
;

847  
key_li„time_duøti⁄_£t
 (
vty
, &
key
->
£nd
, 
¨gv
[0],árgv[2],árgv[1],

848 
¨gv
[3],árgv[4]);

851 
cmd_node
 
	gkeychaö_node
 =

853 
KEYCHAIN_NODE
,

858 
cmd_node
 
	gkeychaö_key_node
 =

860 
KEYCHAIN_KEY_NODE
,

866 
	$keychaö_°r·ime
 (*
buf
, 
bufsiz
, 
time_t
 *
time
)

868 
tm
 *tm;

869 
size_t
 
Àn
;

871 
tm
 = 
	`loˇ…ime
 (
time
);

873 
Àn
 = 
	`°r·ime
 (
buf
, 
bufsiz
, "%T %b %d %Y", 
tm
);

875  
Àn
;

876 
	}
}

879 
	$keychaö_c⁄fig_wrôe
 (
vty
 *vty)

881 
keychaö
 *keychain;

882 
key
 *key;

883 
li°node
 *
node
;

884 
li°node
 *
knode
;

885 
buf
[
BUFSIZ
];

887 
	`ALL_LIST_ELEMENTS_RO
 (
keychaö_li°
, 
node
, 
keychaö
))

889 
	`vty_out
 (
vty
, "key chaö %s%s", 
keychaö
->
«me
, 
VTY_NEWLINE
);

891 
	`ALL_LIST_ELEMENTS_RO
 (
keychaö
->
key
, 
knode
, key))

893 
	`vty_out
 (
vty
, " key %d%s", 
key
->
ödex
, 
VTY_NEWLINE
);

895 i‡(
key
->
°rög
)

896 
	`vty_out
 (
vty
, " key-°rög %s%s", 
key
->
°rög
, 
VTY_NEWLINE
);

898 i‡(
key
->
ac˚±
.
°¨t
)

900 
	`keychaö_°r·ime
 (
buf
, 
BUFSIZ
, &
key
->
ac˚±
.
°¨t
);

901 
	`vty_out
 (
vty
, "ác˚±-li„timê%s", 
buf
);

903 i‡(
key
->
ac˚±
.
íd
 == -1)

904 
	`vty_out
 (
vty
, " infinite");

905 i‡(
key
->
ac˚±
.
duøti⁄
)

906 
	`vty_out
 (
vty
, " duration %ld",

907 ()(
key
->
ac˚±
.
íd
 - key->ac˚±.
°¨t
));

910 
	`keychaö_°r·ime
 (
buf
, 
BUFSIZ
, &
key
->
ac˚±
.
íd
);

911 
	`vty_out
 (
vty
, " %s", 
buf
);

913 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

916 i‡(
key
->
£nd
.
°¨t
)

918 
	`keychaö_°r·ime
 (
buf
, 
BUFSIZ
, &
key
->
£nd
.
°¨t
);

919 
	`vty_out
 (
vty
, " síd-li„timê%s", 
buf
);

921 i‡(
key
->
£nd
.
íd
 == -1)

922 
	`vty_out
 (
vty
, " infinite");

923 i‡(
key
->
£nd
.
duøti⁄
)

924 
	`vty_out
 (
vty
, " duøti⁄ %ld", ()(
key
->
£nd
.
íd
 - key->£nd.
°¨t
));

927 
	`keychaö_°r·ime
 (
buf
, 
BUFSIZ
, &
key
->
£nd
.
íd
);

928 
	`vty_out
 (
vty
, " %s", 
buf
);

930 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

933 
	`vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

937 
	}
}

940 
	$keychaö_öô
 ()

942 
keychaö_li°
 = 
	`li°_√w
 ();

944 
	`ö°Æl_node
 (&
keychaö_node
, 
keychaö_c⁄fig_wrôe
);

945 
	`ö°Æl_node
 (&
keychaö_key_node
, 
NULL
);

947 
	`ö°Æl_deÁu…
 (
KEYCHAIN_NODE
);

948 
	`ö°Æl_deÁu…
 (
KEYCHAIN_KEY_NODE
);

950 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
key_chaö_cmd
);

951 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_key_chaö_cmd
);

952 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
key_cmd
);

953 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
no_key_cmd
);

955 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
key_chaö_cmd
);

956 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
no_key_chaö_cmd
);

958 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
key_°rög_cmd
);

959 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
no_key_°rög_cmd
);

961 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
key_chaö_cmd
);

962 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
no_key_chaö_cmd
);

964 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
key_cmd
);

965 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
no_key_cmd
);

967 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_day_m⁄th_day_m⁄th_cmd
);

968 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_day_m⁄th_m⁄th_day_cmd
);

969 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_m⁄th_day_day_m⁄th_cmd
);

970 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_m⁄th_day_m⁄th_day_cmd
);

971 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_öföôe_day_m⁄th_cmd
);

972 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_öföôe_m⁄th_day_cmd
);

973 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_duøti⁄_day_m⁄th_cmd
);

974 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
ac˚±_li„time_duøti⁄_m⁄th_day_cmd
);

976 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_day_m⁄th_day_m⁄th_cmd
);

977 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_day_m⁄th_m⁄th_day_cmd
);

978 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_m⁄th_day_day_m⁄th_cmd
);

979 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_m⁄th_day_m⁄th_day_cmd
);

980 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_öföôe_day_m⁄th_cmd
);

981 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_öföôe_m⁄th_day_cmd
);

982 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_duøti⁄_day_m⁄th_cmd
);

983 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
£nd_li„time_duøti⁄_m⁄th_day_cmd
);

984 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/keychain.h

22 #i‚de‡
_ZEBRA_KEYCHAIN_H


23 
	#_ZEBRA_KEYCHAIN_H


	)

25 
	skeychaö


27 *
	m«me
;

29 
li°
 *
	mkey
;

32 
	skey_ønge


34 
time_t
 
	m°¨t
;

35 
time_t
 
	míd
;

37 
u_ch¨
 
	mduøti⁄
;

40 
	skey


42 
u_öt32_t
 
	mödex
;

44 *
	m°rög
;

46 
key_ønge
 
	m£nd
;

47 
key_ønge
 
	mac˚±
;

50 
keychaö_öô
 ();

51 
keychaö
 *
keychaö_lookup
 (const *);

52 
key
 *
key_lookup_f‹_ac˚±
 (c⁄° 
keychaö
 *, 
u_öt32_t
);

53 
key
 *
key_m©ch_f‹_ac˚±
 (c⁄° 
keychaö
 *, const *);

54 
key
 *
key_lookup_f‹_£nd
 (c⁄° 
keychaö
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/linklist.c

22 
	~<zebø.h
>

24 
	~"lökli°.h
"

25 
	~"mem‹y.h
"

28 
li°
 *

29 
	$li°_√w
 ()

31  
	`XCALLOC
 (
MTYPE_LINK_LIST
,  (
li°
));

32 
	}
}

36 
	$li°_‰ì
 (
li°
 *
l
)

38 
	`XFREE
 (
MTYPE_LINK_LIST
, 
l
);

39 
	}
}

42 
li°node
 *

43 
	$li°node_√w
 ()

45  
	`XCALLOC
 (
MTYPE_LINK_NODE
,  (
li°node
));

46 
	}
}

50 
	$li°node_‰ì
 (
li°node
 *
node
)

52 
	`XFREE
 (
MTYPE_LINK_NODE
, 
node
);

53 
	}
}

57 
	$li°node_add
 (
li°
 *li°, *
vÆ
)

59 
li°node
 *
node
;

61 
	`as£π
 (
vÆ
 !
NULL
);

63 
node
 = 
	`li°node_√w
 ();

65 
node
->
¥ev
 = 
li°
->
èû
;

66 
node
->
d©a
 = 
vÆ
;

68 i‡(
li°
->
hód
 =
NULL
)

69 
li°
->
hód
 = 
node
;

71 
li°
->
èû
->
√xt
 = 
node
;

72 
li°
->
èû
 = 
node
;

74 
li°
->
cou¡
++;

75 
	}
}

84 
	$li°node_add_s‹t
 (
li°
 *li°, *
vÆ
)

86 
li°node
 *
n
;

87 
li°node
 *
√w
;

89 
	`as£π
 (
vÆ
 !
NULL
);

91 
√w
 = 
	`li°node_√w
 ();

92 
√w
->
d©a
 = 
vÆ
;

94 i‡(
li°
->
cmp
)

96 
n
 = 
li°
->
hód
;Ç;Ç =Ç->
√xt
)

98 i‡((*
li°
->
cmp
Ë(
vÆ
, 
n
->
d©a
) < 0)

100 
√w
->
√xt
 = 
n
;

101 
√w
->
¥ev
 = 
n
->prev;

103 i‡(
n
->
¥ev
)

104 
n
->
¥ev
->
√xt
 = 
√w
;

106 
li°
->
hód
 = 
√w
;

107 
n
->
¥ev
 = 
√w
;

108 
li°
->
cou¡
++;

114 
√w
->
¥ev
 = 
li°
->
èû
;

116 i‡(
li°
->
èû
)

117 
li°
->
èû
->
√xt
 = 
√w
;

119 
li°
->
hód
 = 
√w
;

121 
li°
->
èû
 = 
√w
;

122 
li°
->
cou¡
++;

123 
	}
}

126 
	$li°node_add_a·î
 (
li°
 *li°, 
li°node
 *
µ
, *
vÆ
)

128 
li°node
 *
¬
;

130 
	`as£π
 (
vÆ
 !
NULL
);

132 
¬
 = 
	`li°node_√w
 ();

133 
¬
->
d©a
 = 
vÆ
;

135 i‡(
µ
 =
NULL
)

137 i‡(
li°
->
hód
)

138 
li°
->
hód
->
¥ev
 = 
¬
;

140 
li°
->
èû
 = 
¬
;

142 
¬
->
√xt
 = 
li°
->
hód
;

143 
¬
->
¥ev
 = 
µ
;

145 
li°
->
hód
 = 
¬
;

149 i‡(
µ
->
√xt
)

150 
µ
->
√xt
->
¥ev
 = 
¬
;

152 
li°
->
èû
 = 
¬
;

154 
¬
->
√xt
 = 
µ
->next;

155 
¬
->
¥ev
 = 
µ
;

157 
µ
->
√xt
 = 
¬
;

159 
li°
->
cou¡
++;

160 
	}
}

165 
	$li°node_dñëe
 (
li°
 *li°, *
vÆ
)

167 
li°node
 *
node
;

169 
	`as£π
(
li°
);

170 
node
 = 
li°
->
hód
;Çode;Çodênode->
√xt
)

172 i‡(
node
->
d©a
 =
vÆ
)

174 i‡(
node
->
¥ev
)

175 
node
->
¥ev
->
√xt
 =Çode->next;

177 
li°
->
hód
 = 
node
->
√xt
;

179 i‡(
node
->
√xt
)

180 
node
->
√xt
->
¥ev
 =Çode->prev;

182 
li°
->
èû
 = 
node
->
¥ev
;

184 
li°
->
cou¡
--;

185 
	`li°node_‰ì
 (
node
);

189 
	}
}

193 
	$li°node_hód
 (
li°
 *list)

195 
li°node
 *
node
;

197 
	`as£π
(
li°
);

198 
node
 = 
li°
->
hód
;

200 i‡(
node
)

201  
node
->
d©a
;

202  
NULL
;

203 
	}
}

207 
	$li°_dñëe_Æl_node
 (
li°
 *list)

209 
li°node
 *
node
;

210 
li°node
 *
√xt
;

212 
	`as£π
(
li°
);

213 
node
 = 
li°
->
hód
;Çode;Çodê
√xt
)

215 
√xt
 = 
node
->next;

216 i‡(
li°
->
dñ
)

217 (*
li°
->
dñ
Ë(
node
->
d©a
);

218 
	`li°node_‰ì
 (
node
);

220 
li°
->
hód
 =Üi°->
èû
 = 
NULL
;

221 
li°
->
cou¡
 = 0;

222 
	}
}

226 
	$li°_dñëe
 (
li°
 *list)

228 
	`as£π
(
li°
);

229 
	`li°_dñëe_Æl_node
 (
li°
);

230 
	`li°_‰ì
 (
li°
);

231 
	}
}

234 
li°node
 *

235 
	$li°node_lookup
 (
li°
 *li°, *
d©a
)

237 
li°node
 *
node
;

239 
	`as£π
(
li°
);

240 
node
 = 
	`li°hód
(
li°
);Çode;Çodê
	`li°√xäode
 (node))

241 i‡(
d©a
 =
	`li°gëd©a
 (
node
))

242  
node
;

243  
NULL
;

244 
	}
}

248 
	$li°_dñëe_node
 (
li°
 *li°, 
li°node
 *
node
)

250 i‡(
node
->
¥ev
)

251 
node
->
¥ev
->
√xt
 =Çode->next;

253 
li°
->
hód
 = 
node
->
√xt
;

254 i‡(
node
->
√xt
)

255 
node
->
√xt
->
¥ev
 =Çode->prev;

257 
li°
->
èû
 = 
node
->
¥ev
;

258 
li°
->
cou¡
--;

259 
	`li°node_‰ì
 (
node
);

260 
	}
}

264 
	$li°_add_node_¥ev
 (
li°
 *li°, 
li°node
 *
cuºít
, *
vÆ
)

266 
li°node
 *
node
;

268 
	`as£π
 (
vÆ
 !
NULL
);

270 
node
 = 
	`li°node_√w
 ();

271 
node
->
√xt
 = 
cuºít
;

272 
node
->
d©a
 = 
vÆ
;

274 i‡(
cuºít
->
¥ev
 =
NULL
)

275 
li°
->
hód
 = 
node
;

277 
cuºít
->
¥ev
->
√xt
 = 
node
;

279 
node
->
¥ev
 = 
cuºít
->prev;

280 
cuºít
->
¥ev
 = 
node
;

282 
li°
->
cou¡
++;

283 
	}
}

287 
	$li°_add_node_√xt
 (
li°
 *li°, 
li°node
 *
cuºít
, *
vÆ
)

289 
li°node
 *
node
;

291 
	`as£π
 (
vÆ
 !
NULL
);

293 
node
 = 
	`li°node_√w
 ();

294 
node
->
¥ev
 = 
cuºít
;

295 
node
->
d©a
 = 
vÆ
;

297 i‡(
cuºít
->
√xt
 =
NULL
)

298 
li°
->
èû
 = 
node
;

300 
cuºít
->
√xt
->
¥ev
 = 
node
;

302 
node
->
√xt
 = 
cuºít
->next;

303 
cuºít
->
√xt
 = 
node
;

305 
li°
->
cou¡
++;

306 
	}
}

310 
	$li°_add_li°
 (
li°
 *
l
, li° *
m
)

312 
li°node
 *
n
;

314 
n
 = 
	`li°hód
 (
m
);Ç;Ç = 
	`li°√xäode
 (n))

315 
	`li°node_add
 (
l
, 
n
->
d©a
);

316 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/linklist.h

22 #i‚de‡
_ZEBRA_LINKLIST_H


23 
	#_ZEBRA_LINKLIST_H


	)

28 
	sli°node


30 
li°node
 *
	m√xt
;

31 
li°node
 *
	m¥ev
;

34 *
	md©a
;

37 
	sli°


39 
li°node
 *
	mhód
;

40 
li°node
 *
	mèû
;

43 
	mcou¡
;

49 (*
	mcmp
Ë(*
	mvÆ1
, *
	mvÆ2
);

54 (*
	mdñ
Ë(*
	mvÆ
);

57 
	#li°√xäode
(
X
Ë((XË? ((X)->
√xt
Ë: 
NULL
)

	)

58 
	#li°hód
(
X
Ë((XË? ((X)->
hód
Ë: 
NULL
)

	)

59 
	#li°èû
(
X
Ë((XË? ((X)->
èû
Ë: 
NULL
)

	)

60 
	#li°cou¡
(
X
Ë((X)->
cou¡
)

	)

61 
	#li°_i£m±y
(
X
Ë((X)->
hód
 =
NULL
 && (X)->
èû
 =NULL)

	)

62 
	#li°gëd©a
(
X
Ë(
	`as£π
((X)->
d©a
 !
NULL
), (X)->d©a)

	)

65 
li°
 *
li°_√w
();

66 
li°_‰ì
 (
li°
 *);

68 
li°node_add
 (
li°
 *, *);

69 
li°node_add_s‹t
 (
li°
 *, *);

70 
li°node_add_a·î
 (
li°
 *, 
li°node
 *, *);

71 
li°node_dñëe
 (
li°
 *, *);

72 
li°node
 *
li°node_lookup
 (
li°
 *, *);

73 *
li°node_hód
 (
li°
 *);

75 
li°_dñëe
 (
li°
 *);

76 
li°_dñëe_Æl_node
 (
li°
 *);

79 
li°_dñëe_node
 (
li°
 *, 
li°node
 *);

82 
li°_add_node_¥ev
 (
li°
 *, 
li°node
 *, *);

83 
li°_add_node_√xt
 (
li°
 *, 
li°node
 *, *);

84 
li°_add_li°
 (
li°
 *, list *);

90 
	#ALL_LIST_ELEMENTS
(
li°
,
node
,
√xäode
,
d©a
) \

91 (
node
Ë
	`li°hód
(
li°
), ((
d©a
Ë
NULL
); \

92 (
node
Ë!
NULL
 && \

93 ((
d©a
Ë
	`li°gëd©a
(
node
),(
√xäode
Ënode->
√xt
, 1); \

94 (
node
Ë(
√xäode
), ((
d©a
Ë
NULL
)

	)

102 
	#ALL_LIST_ELEMENTS_RO
(
li°
,
node
,
d©a
) \

103 (
node
Ë
	`li°hód
(
li°
), ((
d©a
Ë
NULL
);\

104 (
node
Ë!
NULL
 && ((
d©a
Ë
	`li°gëd©a
(node), 1); \

105 (
node
Ë
	`li°√xäode
“ode), ((
d©a
Ë
NULL
)

	)

112 
	#LISTNODE_ATTACH
(
L
,
N
) \

114 (
N
)->
¥ev
 = (
L
)->
èû
; \

115 i‡((
L
)->
hód
 =
NULL
) \

116 (
L
)->
hód
 = (
N
); \

118 (
L
)->
èû
->
√xt
 = (
N
); \

119 (
L
)->
èû
 = (
N
); \

120 (
L
)->
cou¡
++; \

121 } 0)

	)

124 
	#LISTNODE_DETACH
(
L
,
N
) \

126 i‡((
N
)->
¥ev
) \

127 (
N
)->
¥ev
->
√xt
 = (N)->next; \

129 (
L
)->
hód
 = (
N
)->
√xt
; \

130 i‡((
N
)->
√xt
) \

131 (
N
)->
√xt
->
¥ev
 = (N)->prev; \

133 (
L
)->
èû
 = (
N
)->
¥ev
; \

134 (
L
)->
cou¡
--; \

135 } 0)

	)

138 #i‡!
deföed
(
QUAGGA_NO_DEPRECATED_INTERFACES
)

140 
	#LISTNODE_ADD
(
L
,
N
Ë
	`LISTNODE_ATTACH
(L,N)

	)

141 
	#LISTNODE_DELETE
(
L
,
N
Ë
	`LISTNODE_DETACH
(L,N)

	)

142 
	#√xäode
(
X
Ë((XË(X)->
√xt
)

	)

143 
	#gëd©a
(
X
Ë
	`li°gëd©a
(X)

	)

144 
	#LIST_LOOP
(
L
,
V
,
N
) \

145 
	`ALL_LIST_ELEMENTS_RO
 (
L
,
N
,
V
))

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/log.c

23 
	#QUAGGA_DEFINE_DESC_TABLE


	)

25 
	~<zebø.h
>

27 
	~"log.h
"

28 
	~"mem‹y.h
"

29 
	~"comm™d.h
"

30 #i‚de‡
SUNOS_5


31 
	~<sys/un.h
>

34 #ifde‡
HAVE_UCONTEXT_H


35 
	~<uc⁄ãxt.h
>

38 
	glogfûe_fd
 = -1;

40 
zlog
 *
	gzlog_deÁu…
 = 
NULL
;

42 c⁄° *
	gzlog_¥Ÿo_«mes
[] =

55 
NULL
,

58 c⁄° *
	gzlog_¥i‹ôy
[] =

68 
NULL
,

75 
size_t


76 
	$quagga_time°amp
(
time°amp_¥ecisi⁄
, *
buf
, 
size_t
 
buÊí
)

79 
time_t
 
œ°
;

80 
size_t
 
Àn
;

81 
buf
[28];

82 } 
ˇche
;

83 
timevÆ
 
˛ock
;

86 
	`gëtimeofday
(&
˛ock
, 
NULL
);

89 i‡(
ˇche
.
œ°
 !
˛ock
.
tv_£c
)

91 
tm
 *tm;

92 
ˇche
.
œ°
 = 
˛ock
.
tv_£c
;

93 
tm
 = 
	`loˇ…ime
(&
ˇche
.
œ°
);

94 
ˇche
.
Àn
 = 
	`°r·ime
(ˇche.
buf
, (cache.buf),

95 "%Y/%m/%d %H:%M:%S", 
tm
);

101 i‡(
buÊí
 > 
ˇche
.
Àn
)

103 
	`mem˝y
(
buf
, 
ˇche
.buf, cache.
Àn
);

104 i‡((
time°amp_¥ecisi⁄
 > 0) &&

105 (
buÊí
 > 
ˇche
.
Àn
+1+
time°amp_¥ecisi⁄
))

108 c⁄° 
divis‹
[] = {0, 100000, 10000, 1000, 100, 10, 1};

109 
¥ec
;

110 *
p
 = 
buf
+
ˇche
.
Àn
+1+(
¥ec
 = 
time°amp_¥ecisi⁄
);

111 *
p
-- = '\0';

112 
¥ec
 > 6)

115 *
p
-- = '0';

116 
¥ec
--;

118 
˛ock
.
tv_u£c
 /
divis‹
[
¥ec
];

121 *
p
-- = '0'+(
˛ock
.
tv_u£c
 % 10);

122 
˛ock
.
tv_u£c
 /= 10;

124 --
¥ec
 > 0);

125 *
p
 = '.';

126  
ˇche
.
Àn
+1+
time°amp_¥ecisi⁄
;

128 
buf
[
ˇche
.
Àn
] = '\0';

129  
ˇche
.
Àn
;

131 i‡(
buÊí
 > 0)

132 
buf
[0] = '\0';

134 
	}
}

138 
	$time_¥öt
(
FILE
 *
Â
, 
time°amp_c⁄åﬁ
 *
˘l
)

140 i‡(!
˘l
->
Æªady_ªndîed
)

142 
˘l
->
Àn
 = 
	`quagga_time°amp
(˘l->
¥ecisi⁄
, cé->
buf
, (ctl->buf));

143 
˘l
->
Æªady_ªndîed
 = 1;

145 
	`Ârötf
(
Â
, "%†", 
˘l
->
buf
);

146 
	}
}

151 
	$vzlog
 (
zlog
 *
zl
, 
¥i‹ôy
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

153 
time°amp_c⁄åﬁ
 
ts˘l
;

154 
ts˘l
.
Æªady_ªndîed
 = 0;

157 i‡(
zl
 =
NULL
)

158 
zl
 = 
zlog_deÁu…
;

161 i‡(
zl
 =
NULL
)

163 
ts˘l
.
¥ecisi⁄
 = 0;

164 
	`time_¥öt
(
°dîr
, &
ts˘l
);

165 
	`Ârötf
 (
°dîr
, "%s: ", "unknown");

166 
	`vÂrötf
 (
°dîr
, 
f‹m©
, 
¨gs
);

167 
	`Ârötf
 (
°dîr
, "\n");

168 
	`fÊush
 (
°dîr
);

173 
ts˘l
.
¥ecisi⁄
 = 
zl
->
time°amp_¥ecisi⁄
;

176 i‡(
¥i‹ôy
 <
zl
->
maxlvl
[
ZLOG_DEST_SYSLOG
])

178 
va_li°
 
ac
;

179 
	`va_c›y
(
ac
, 
¨gs
);

180 
	`vsy¶og
 (
¥i‹ôy
|
zlog_deÁu…
->
Ácûôy
, 
f‹m©
, 
ac
);

181 
	`va_íd
(
ac
);

185 i‡((
¥i‹ôy
 <
zl
->
maxlvl
[
ZLOG_DEST_FILE
]Ë&& zl->
Â
)

187 
va_li°
 
ac
;

188 
	`time_¥öt
 (
zl
->
Â
, &
ts˘l
);

189 i‡(
zl
->
ªc‹d_¥i‹ôy
)

190 
	`Ârötf
 (
zl
->
Â
, "%s: ", 
zlog_¥i‹ôy
[
¥i‹ôy
]);

191 
	`Ârötf
 (
zl
->
Â
, "%s: ", 
zlog_¥Ÿo_«mes
[zl->
¥Ÿocﬁ
]);

192 
	`va_c›y
(
ac
, 
¨gs
);

193 
	`vÂrötf
 (
zl
->
Â
, 
f‹m©
, 
ac
);

194 
	`va_íd
(
ac
);

195 
	`Ârötf
 (
zl
->
Â
, "\n");

196 
	`fÊush
 (
zl
->
Â
);

200 i‡(
¥i‹ôy
 <
zl
->
maxlvl
[
ZLOG_DEST_STDOUT
])

202 
va_li°
 
ac
;

203 
	`time_¥öt
 (
°dout
, &
ts˘l
);

204 i‡(
zl
->
ªc‹d_¥i‹ôy
)

205 
	`Ârötf
 (
°dout
, "%s: ", 
zlog_¥i‹ôy
[
¥i‹ôy
]);

206 
	`Ârötf
 (
°dout
, "%s: ", 
zlog_¥Ÿo_«mes
[
zl
->
¥Ÿocﬁ
]);

207 
	`va_c›y
(
ac
, 
¨gs
);

208 
	`vÂrötf
 (
°dout
, 
f‹m©
, 
ac
);

209 
	`va_íd
(
ac
);

210 
	`Ârötf
 (
°dout
, "\n");

211 
	`fÊush
 (
°dout
);

215 i‡(
¥i‹ôy
 <
zl
->
maxlvl
[
ZLOG_DEST_MONITOR
])

216 
	`vty_log
 ((
zl
->
ªc‹d_¥i‹ôy
 ? 
zlog_¥i‹ôy
[
¥i‹ôy
] : 
NULL
),

217 
zlog_¥Ÿo_«mes
[
zl
->
¥Ÿocﬁ
], 
f‹m©
, &
ts˘l
, 
¨gs
);

218 
	}
}

221 
	$°r_≠≥nd
(*
d°
, 
Àn
, c⁄° *
§c
)

223 (
Àn
-- > 0Ë&& *
§c
)

224 *
d°
++ = *
§c
++;

225  
d°
;

226 
	}
}

229 
	$num_≠≥nd
(*
s
, 
Àn
, 
u_l⁄g
 
x
)

231 
buf
[30];

232 *
t
;

234 i‡(!
x
)

235  
	`°r_≠≥nd
(
s
,
Àn
,"0");

236 *(
t
 = &
buf
[(buf)-1]) = '\0';

237 
x
 && (
t
 > 
buf
))

239 *--
t
 = '0'+(
x
 % 10);

240 
x
 /= 10;

242  
	`°r_≠≥nd
(
s
,
Àn
,
t
);

243 
	}
}

245 #i‡
deföed
(
SA_SIGINFO
Ë|| deföed(
HAVE_STACK_TRACE
)

247 
	$hex_≠≥nd
(*
s
, 
Àn
, 
u_l⁄g
 
x
)

249 
buf
[30];

250 *
t
;

252 i‡(!
x
)

253  
	`°r_≠≥nd
(
s
,
Àn
,"0");

254 *(
t
 = &
buf
[(buf)-1]) = '\0';

255 
x
 && (
t
 > 
buf
))

257 
u_öt
 
cc
 = (
x
 % 16);

258 *--
t
 = ((
cc
 < 10) ? ('0'+cc) : ('a'+cc-10));

259 
x
 /= 16;

261  
	`°r_≠≥nd
(
s
,
Àn
,
t
);

262 
	}
}

267 
	$sy¶og_c⁄√˘
()

269 #ifde‡
SUNOS_5


272 
fd
;

273 *
s
;

274 
sockaddr_un
 
addr
;

276 i‡((
fd
 = 
	`sockë
(
AF_UNIX
,
SOCK_DGRAM
,0)) < 0)

278 
addr
.
sun_Ámûy
 = 
AF_UNIX
;

279 #ifde‡
_PATH_LOG


280 
	#SYSLOG_SOCKET_PATH
 
_PATH_LOG


	)

282 
	#SYSLOG_SOCKET_PATH
 "/dev/log"

	)

284 
s
 = 
	`°r_≠≥nd
(
addr
.
sun_∑th
,◊ddr.sun_∑th),
SYSLOG_SOCKET_PATH
);

285 #unde‡
SYSLOG_SOCKET_PATH


286 *
s
 = '\0';

287 i‡(
	`c⁄√˘
(
fd
,(
sockaddr
 *)&
addr
,(addr)) < 0)

289 
	`˛o£
(
fd
);

292  
fd
;

294 
	}
}

297 
	$sy¶og_sigß„
(
¥i‹ôy
, c⁄° *
msg
, 
size_t
 
msgÀn
)

299 
sy¶og_fd
 = -1;

300 
buf
[("<1234567890>rùngd[1234567890]: ")+
msgÀn
+50];

301 *
s
;

303 i‡((
sy¶og_fd
 < 0Ë&& ((sy¶og_fd = 
	`sy¶og_c⁄√˘
()) < 0))

306 
	#LOC
 
s
,
buf
+(buf)-
	)
s

307 
s
 = 
buf
;

308 
s
 = 
	`°r_≠≥nd
(
LOC
,"<");

309 
s
 = 
	`num_≠≥nd
(
LOC
,
¥i‹ôy
);

310 
s
 = 
	`°r_≠≥nd
(
LOC
,">");

312 
s
 = 
	`°r_≠≥nd
(
LOC
,
zlog_deÁu…
->
idít
);

313 i‡(
zlog_deÁu…
->
sy¶og_›ti⁄s
 & 
LOG_PID
)

315 
s
 = 
	`°r_≠≥nd
(
LOC
,"[");

316 
s
 = 
	`num_≠≥nd
(
LOC
,
	`gëpid
());

317 
s
 = 
	`°r_≠≥nd
(
LOC
,"]");

319 
s
 = 
	`°r_≠≥nd
(
LOC
,": ");

320 
s
 = 
	`°r_≠≥nd
(
LOC
,
msg
);

321 
	`wrôe
(
sy¶og_fd
,
buf
,
s
-buf);

322 #unde‡
LOC


323 
	}
}

326 
	$›í_¸ashlog
()

328 
	#CRASHLOG_PREFIX
 "/v¨/tmp/quagga."

	)

329 
	#CRASHLOG_SUFFIX
 "¸ashlog"

	)

330 i‡(
zlog_deÁu…
 && zlog_deÁu…->
idít
)

333 c⁄° *
p
;

334 
size_t
 
ûí
;

336 
p
 = 
zlog_deÁu…
->
idít
, 
ûí
 = 0; *p;Ö++)

337 
ûí
++;

339 
buf
[(
CRASHLOG_PREFIX
)+
ûí
+(
CRASHLOG_SUFFIX
)+3];

340 *
s
 = 
buf
;

341 
	#LOC
 
s
,
buf
+(buf)-
	)
s

342 
s
 = 
	`°r_≠≥nd
(
LOC
, 
CRASHLOG_PREFIX
);

343 
s
 = 
	`°r_≠≥nd
(
LOC
, 
zlog_deÁu…
->
idít
);

344 
s
 = 
	`°r_≠≥nd
(
LOC
, ".");

345 
s
 = 
	`°r_≠≥nd
(
LOC
, 
CRASHLOG_SUFFIX
);

346 #unde‡
LOC


347 *
s
 = '\0';

348  
	`›í
(
buf
, 
O_WRONLY
|
O_CREAT
|
O_EXCL
, 
LOGFILE_MASK
);

351  
	`›í
(
CRASHLOG_PREFIX
 
CRASHLOG_SUFFIX
, 
O_WRONLY
|
O_CREAT
|
O_EXCL
,

352 
LOGFILE_MASK
);

353 #unde‡
CRASHLOG_SUFFIX


354 #unde‡
CRASHLOG_PREFIX


355 
	}
}

359 
zlog_sig«l
(
signo
, c⁄° *
a˘i⁄


360 #ifde‡
SA_SIGINFO


361 , 
sigöfo_t
 *
sigöfo
, *
¥ogøm_cou¡î


365 
time_t
 
	gnow
;

366 
	gbuf
[("DEFAULT: Received signal Sát T (si_addr 0xP, PC 0xP);áborting...")+100];

367 *
	gs
 = 
buf
;

368 *
	gmsg°¨t
 = 
buf
;

369 
	#LOC
 
s
,
buf
+(buf)-
	)
s

371 
time
(&
now
);

372 i‡(
	gzlog_deÁu…
)

374 
	gs
 = 
°r_≠≥nd
(
LOC
,
zlog_¥Ÿo_«mes
[
zlog_deÁu…
->
¥Ÿocﬁ
]);

375 *
	gs
++ = ':';

376 *
	gs
++ = ' ';

377 
	gmsg°¨t
 = 
s
;

379 
	gs
 = 
°r_≠≥nd
(
LOC
,"Received signal ");

380 
	gs
 = 
num_≠≥nd
(
LOC
,
signo
);

381 
	gs
 = 
°r_≠≥nd
(
LOC
,"át ");

382 
	gs
 = 
num_≠≥nd
(
LOC
,
now
);

383 #ifde‡
SA_SIGINFO


384 
	gs
 = 
°r_≠≥nd
(
LOC
," (si_addr 0x");

385 
	gs
 = 
hex_≠≥nd
(
LOC
,(
u_l⁄g
)(
sigöfo
->
si_addr
));

386 i‡(
	g¥ogøm_cou¡î
)

388 
	gs
 = 
°r_≠≥nd
(
LOC
,", PC 0x");

389 
	gs
 = 
hex_≠≥nd
(
LOC
,(
u_l⁄g
)
¥ogøm_cou¡î
);

391 
	gs
 = 
°r_≠≥nd
(
LOC
,"); ");

393 
	gs
 = 
°r_≠≥nd
(
LOC
,"; ");

395 
	gs
 = 
°r_≠≥nd
(
LOC
,
a˘i⁄
);

396 i‡(
	gs
 < 
	gbuf
+(buf))

397 *
	gs
++ = '\n';

400 
	#PRI
 
LOG_CRIT


	)

402 
	#DUMP
(
FD
Ë
	`wrôe
(FD, 
buf
, 
s
-buf);

	)

404 i‡((
	glogfûe_fd
 >0Ë|| ((
logfûe_fd
 = 
›í_¸ashlog
()) >= 0))

405 
DUMP
(
logfûe_fd
)

406 i‡(!
zlog_deÁu…
)

407 
DUMP
(
STDERR_FILENO
)

410 i‡(
PRI
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_STDOUT
])

411 
DUMP
(
STDOUT_FILENO
)

413 *--
s
 = '\0';

414 i‡(
	gPRI
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_MONITOR
])

415 
vty_log_fixed
(
buf
,
s
-buf);

416 i‡(
	gPRI
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_SYSLOG
])

417 
sy¶og_sigß„
(
PRI
|
zlog_deÁu…
->
Ácûôy
,
msg°¨t
,
s
-msgstart);

419 #unde‡
DUMP


421 
zlog_backåa˚_sigß„
(
PRI
,

422 #ifde‡
SA_SIGINFO


423 
¥ogøm_cou¡î


425 
NULL


428 #unde‡
PRI


429 #unde‡
LOC


435 
	$zlog_backåa˚_sigß„
(
¥i‹ôy
, *
¥ogøm_cou¡î
)

437 #ifde‡
HAVE_STACK_TRACE


438 c⁄° 
p˛abñ
[] = "Program counter: ";

439 *
¨øy
[64];

440 
size
;

441 
buf
[100];

442 *
s
, **
bt
 = 
NULL
;

443 
	#LOC
 
s
,
buf
+(buf)-
	)
s

445 #ifde‡
HAVE_GLIBC_BACKTRACE


446 i‡(((
size
 = 
	`backåa˚
(
¨øy
,
	`¨øy_size
(array)) <= 0) ||

447 ((
size_t
)
size
 > 
	`¨øy_size
(
¨øy
))))

450 
	#DUMP
(
FD
) { \

451 i‡(
¥ogøm_cou¡î
) \

453 
	`wrôe
(
FD
, 
p˛abñ
, (pclabel)-1); \

454 
	`backåa˚_symbﬁs_fd
(&
¥ogøm_cou¡î
, 1, 
FD
); \

456 
	`wrôe
(
FD
, 
buf
, 
s
-buf); \

457 
	`backåa˚_symbﬁs_fd
(
¨øy
, 
size
, 
FD
); \

458 }

	)

459 #ñi‡
	`deföed
(
HAVE_PRINTSTACK
)

460 
	#DUMP
(
FD
) { \

461 i‡(
¥ogøm_cou¡î
) \

462 
	`wrôe
((
FD
), 
p˛abñ
, (pclabel)-1); \

463 
	`wrôe
((
FD
), 
buf
, 
s
-buf); \

464 
	`¥öt°ack
((
FD
)); \

465 }

	)

468 
s
 = 
buf
;

469 
s
 = 
	`°r_≠≥nd
(
LOC
,"Backtrace for ");

470 
s
 = 
	`num_≠≥nd
(
LOC
,
size
);

471 
s
 = 
	`°r_≠≥nd
(
LOC
," stack frames:\n");

473 i‡((
logfûe_fd
 >0Ë|| (÷ogfûe_fd = 
	`›í_¸ashlog
()) >= 0))

474 
	`DUMP
(
logfûe_fd
)

475 i‡(!
zlog_deÁu…
)

476 
	`DUMP
(
STDERR_FILENO
)

479 i‡(
¥i‹ôy
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_STDOUT
])

480 
	`DUMP
(
STDOUT_FILENO
)

482 *--
s
 = '\0';

483 i‡(
¥i‹ôy
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_MONITOR
])

484 
	`vty_log_fixed
(
buf
,
s
-buf);

485 i‡(
¥i‹ôy
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_SYSLOG
])

486 
	`sy¶og_sigß„
(
¥i‹ôy
|
zlog_deÁu…
->
Ácûôy
,
buf
,
s
-buf);

488 
i
;

489 #ifde‡
HAVE_GLIBC_BACKTRACE


490 
bt
 = 
	`backåa˚_symbﬁs
(
¨øy
, 
size
);

493 
i
 = 0; i < 
size
; i++)

495 
s
 = 
buf
;

496 i‡(
bt
)

497 
s
 = 
	`°r_≠≥nd
(
LOC
, 
bt
[
i
]);

499 
s
 = 
	`°r_≠≥nd
(
LOC
,"[bt ");

500 
s
 = 
	`num_≠≥nd
(
LOC
,
i
);

501 
s
 = 
	`°r_≠≥nd
(
LOC
,"] 0x");

502 
s
 = 
	`hex_≠≥nd
(
LOC
,(
u_l⁄g
)(
¨øy
[
i
]));

504 *
s
 = '\0';

505 i‡(
¥i‹ôy
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_MONITOR
])

506 
	`vty_log_fixed
(
buf
,
s
-buf);

507 i‡(
¥i‹ôy
 <
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_SYSLOG
])

508 
	`sy¶og_sigß„
(
¥i‹ôy
|
zlog_deÁu…
->
Ácûôy
,
buf
,
s
-buf);

510 i‡(
bt
)

511 
	`‰ì
(
bt
);

514 #unde‡
DUMP


515 #unde‡
LOC


517 
	}
}

520 
	$zlog_backåa˚
(
¥i‹ôy
)

522 #i‚de‡
HAVE_GLIBC_BACKTRACE


523 
	`zlog
(
NULL
, 
¥i‹ôy
, "No backtraceávailable onÅhisÖlatform.");

525 *
¨øy
[20];

526 
size
, 
i
;

527 **
°rögs
;

529 i‡(((
size
 = 
	`backåa˚
(
¨øy
,
	`¨øy_size
(array))) <= 0) ||

530 ((
size_t
)
size
 > 
	`¨øy_size
(
¨øy
)))

532 
	`zlog_îr
("Cannot get backtrace,Ñeturned invalid # of frames %d "

534 
size
, ()(
	`¨øy_size
(
¨øy
)));

537 
	`zlog
(
NULL
, 
¥i‹ôy
, "Backåa˚ f‹ %d sèck fømes:", 
size
);

538 i‡(!(
°rögs
 = 
	`backåa˚_symbﬁs
(
¨øy
, 
size
)))

540 
	`zlog_îr
("Cannot get backtrace symbols (out of memory?)");

541 
i
 = 0; i < 
size
; i++)

542 
	`zlog
(
NULL
, 
¥i‹ôy
, "[bà%d] %p",
i
,
¨øy
[i]);

546 
i
 = 0; i < 
size
; i++)

547 
	`zlog
(
NULL
, 
¥i‹ôy
, "[bà%d] %s",
i
,
°rögs
[i]);

548 
	`‰ì
(
°rögs
);

551 
	}
}

554 
	$zlog
 (
zlog
 *
zl
, 
¥i‹ôy
, c⁄° *
f‹m©
, ...)

556 
va_li°
 
¨gs
;

558 
	`va_°¨t
(
¨gs
, 
f‹m©
);

559 
	`vzlog
 (
zl
, 
¥i‹ôy
, 
f‹m©
, 
¨gs
);

560 
	`va_íd
 (
¨gs
);

561 
	}
}

563 
	#ZLOG_FUNC
(
FUNCNAME
,
PRIORITY
) \

565 
	`FUNCNAME
(c⁄° *
f‹m©
, ...) \

567 
va_li°
 
¨gs
; \

568 
	`va_°¨t
(
¨gs
, 
f‹m©
); \

569 
	`vzlog
 (
NULL
, 
PRIORITY
, 
f‹m©
, 
¨gs
); \

570 
	`va_íd
(
¨gs
); \

571 }

	)

573 
	$ZLOG_FUNC
(
zlog_îr
, 
LOG_ERR
)

575 
	$ZLOG_FUNC
(
zlog_w¨n
, 
LOG_WARNING
)

577 
	$ZLOG_FUNC
(
zlog_öfo
, 
LOG_INFO
)

579 
	$ZLOG_FUNC
(
zlog_nŸi˚
, 
LOG_NOTICE
)

581 
	$ZLOG_FUNC
(
zlog_debug
, 
LOG_DEBUG
)

583 #unde‡
ZLOG_FUNC


585 
	#PLOG_FUNC
(
FUNCNAME
,
PRIORITY
) \

587 
	`FUNCNAME
(
zlog
 *
zl
, c⁄° *
f‹m©
, ...) \

589 
va_li°
 
¨gs
; \

590 
	`va_°¨t
(
¨gs
, 
f‹m©
); \

591 
	`vzlog
 (
zl
, 
PRIORITY
, 
f‹m©
, 
¨gs
); \

592 
	`va_íd
(
¨gs
); \

593 
	}

	)
}

595 
	$PLOG_FUNC
(
∂og_îr
, 
LOG_ERR
)

597 
	$PLOG_FUNC
(
∂og_w¨n
, 
LOG_WARNING
)

599 
	$PLOG_FUNC
(
∂og_öfo
, 
LOG_INFO
)

601 
	$PLOG_FUNC
(
∂og_nŸi˚
, 
LOG_NOTICE
)

603 
	$PLOG_FUNC
(
∂og_debug
, 
LOG_DEBUG
)

605 #unde‡
PLOG_FUNC


608 
	$_zlog_as£π_Áûed
 (c⁄° *
as£πi⁄
, c⁄° *
fûe
,

609 
löe
, c⁄° *
fun˘i⁄
)

612 i‡(
zlog_deÁu…
 && !zlog_deÁu…->
Â
 &&

613 ((
logfûe_fd
 = 
	`›í_¸ashlog
()) >= 0) &&

614 ((
zlog_deÁu…
->
Â
 = 
	`fd›í
(
logfûe_fd
, "w")Ë!
NULL
))

615 
zlog_deÁu…
->
maxlvl
[
ZLOG_DEST_FILE
] = 
LOG_ERR
;

616 
	`zlog
(
NULL
, 
LOG_CRIT
, "Assertion `%s' failed in file %s,Üine %u, function %s",

617 
as£πi⁄
,
fûe
,
löe
,(
fun˘i⁄
 ? function : "?"));

618 
	`zlog_backåa˚
(
LOG_CRIT
);

619 
	`ab‹t
();

620 
	}
}

624 
zlog
 *

625 
	$›ízlog
 (c⁄° *
¥og«me
, 
zlog_¥Ÿo_t
 
¥Ÿocﬁ
,

626 
sy¶og_Êags
, 
sy¶og_Ácûôy
)

628 
zlog
 *
zl
;

629 
u_öt
 
i
;

631 
zl
 = 
	`XCALLOC
(
MTYPE_ZLOG
,  (
zlog
));

633 
zl
->
idít
 = 
¥og«me
;

634 
zl
->
¥Ÿocﬁ
 =Örotocol;

635 
zl
->
Ácûôy
 = 
sy¶og_Ácûôy
;

636 
zl
->
sy¶og_›ti⁄s
 = 
sy¶og_Êags
;

639 
i
 = 0; i < 
	`¨øy_size
(
zl
->
maxlvl
); i++)

640 
zl
->
maxlvl
[
i
] = 
ZLOG_DISABLED
;

641 
zl
->
maxlvl
[
ZLOG_DEST_MONITOR
] = 
LOG_DEBUG
;

642 
zl
->
deÁu…_lvl
 = 
LOG_DEBUG
;

644 
	`›ílog
 (
¥og«me
, 
sy¶og_Êags
, 
zl
->
Ácûôy
);

646  
zl
;

647 
	}
}

650 
	$˛o£zlog
 (
zlog
 *
zl
)

652 
	`˛o£log
();

654 i‡(
zl
->
Â
 !
NULL
)

655 
	`f˛o£
 (
zl
->
Â
);

657 i‡(
zl
->
fûíame
 !
NULL
)

658 
	`‰ì
 (
zl
->
fûíame
);

660 
	`XFREE
 (
MTYPE_ZLOG
, 
zl
);

661 
	}
}

665 
	$zlog_£t_Àvñ
 (
zlog
 *
zl
, 
zlog_de°_t
 
de°
, 
log_Àvñ
)

667 i‡(
zl
 =
NULL
)

668 
zl
 = 
zlog_deÁu…
;

670 
zl
->
maxlvl
[
de°
] = 
log_Àvñ
;

671 
	}
}

674 
	$zlog_£t_fûe
 (
zlog
 *
zl
, c⁄° *
fûíame
, 
log_Àvñ
)

676 
FILE
 *
Â
;

677 
mode_t
 
ﬁdumask
;

680 
	`zlog_ª£t_fûe
 (
zl
);

683 i‡(
zl
 =
NULL
)

684 
zl
 = 
zlog_deÁu…
;

687 
ﬁdumask
 = 
	`umask
 (0777 & ~
LOGFILE_MASK
);

688 
Â
 = 
	`f›í
 (
fûíame
, "a");

689 
	`umask
(
ﬁdumask
);

690 i‡(
Â
 =
NULL
)

694 
zl
->
fûíame
 = 
	`°rdup
 (filename);

695 
zl
->
maxlvl
[
ZLOG_DEST_FILE
] = 
log_Àvñ
;

696 
zl
->
Â
 = fp;

697 
logfûe_fd
 = 
	`fûío
(
Â
);

700 
	}
}

704 
	$zlog_ª£t_fûe
 (
zlog
 *
zl
)

706 i‡(
zl
 =
NULL
)

707 
zl
 = 
zlog_deÁu…
;

709 i‡(
zl
->
Â
)

710 
	`f˛o£
 (
zl
->
Â
);

711 
zl
->
Â
 = 
NULL
;

712 
logfûe_fd
 = -1;

713 
zl
->
maxlvl
[
ZLOG_DEST_FILE
] = 
ZLOG_DISABLED
;

715 i‡(
zl
->
fûíame
)

716 
	`‰ì
 (
zl
->
fûíame
);

717 
zl
->
fûíame
 = 
NULL
;

720 
	}
}

724 
	$zlog_rŸ©e
 (
zlog
 *
zl
)

726 
Àvñ
;

728 i‡(
zl
 =
NULL
)

729 
zl
 = 
zlog_deÁu…
;

731 i‡(
zl
->
Â
)

732 
	`f˛o£
 (
zl
->
Â
);

733 
zl
->
Â
 = 
NULL
;

734 
logfûe_fd
 = -1;

735 
Àvñ
 = 
zl
->
maxlvl
[
ZLOG_DEST_FILE
];

736 
zl
->
maxlvl
[
ZLOG_DEST_FILE
] = 
ZLOG_DISABLED
;

738 i‡(
zl
->
fûíame
)

740 
mode_t
 
ﬁdumask
;

741 
ßve_î∫o
;

743 
ﬁdumask
 = 
	`umask
 (0777 & ~
LOGFILE_MASK
);

744 
zl
->
Â
 = 
	`f›í
 (zl->
fûíame
, "a");

745 
ßve_î∫o
 = 
î∫o
;

746 
	`umask
(
ﬁdumask
);

747 i‡(
zl
->
Â
 =
NULL
)

749 
	`zlog_îr
("LogÑotate failed: cannot open file %s foráppend: %s",

750 
zl
->
fûíame
, 
	`ß„_°ªº‹
(
ßve_î∫o
));

753 
logfûe_fd
 = 
	`fûío
(
zl
->
Â
);

754 
zl
->
maxlvl
[
ZLOG_DEST_FILE
] = 
Àvñ
;

758 
	}
}

762 
	$lookup
 (c⁄° 
mesßge
 *
mes
, 
key
)

764 c⁄° 
mesßge
 *
≤t
;

766 
≤t
 = 
mes
;Ö¡->
key
 != 0;Önt++)

767 i‡(
≤t
->
key
 == key)

768  
≤t
->
°r
;

771 
	}
}

780 
	$mes_lookup
 (c⁄° 
mesßge
 *
me¶i°
, 
max
, 
ödex
,

781 c⁄° *
n⁄e
, c⁄° *
me¢ame
)

783 
pos
 = 
ödex
 - 
me¶i°
[0].
key
;

790 i‡((
pos
 >0Ë&& (po†< 
max
)

791 && (
me¶i°
[
pos
].
key
 =
ödex
))

792  
me¶i°
[
pos
].
°r
;

796 
i
;

798 
i
 = 0; i < 
max
; i++, 
me¶i°
++)

800 i‡(
me¶i°
->
key
 =
ödex
)

802 c⁄° *
°r
 = (
me¶i°
->°∏? me¶i°->°∏: 
n⁄e
);

804 
	`zlog_debug
 ("message index %d [%s] found in %sátÖosition %d (max is %d)",

805 
ödex
, 
°r
, 
me¢ame
, 
i
, 
max
);

806  
°r
;

810 
	`zlog_îr
("mesßgêödex %dÇŸ found i¿%†(max i†%d)", 
ödex
, 
me¢ame
, 
max
);

811 
	`as£π
 (
n⁄e
);

812  
n⁄e
;

813 
	}
}

817 
	$ß„_°ªº‹
(
î∫um
)

819 c⁄° *
s
 = 
	`°ªº‹
(
î∫um
);

820  (
s
 !
NULL
) ? s : "UnknownÉrror";

821 
	}
}

823 
	#DESC_ENTRY
(
T
Ë[(T)] = { (T), (#T), '\0' }

	)

824 c⁄° 
zebø_desc_èbÀ
 
	gcomm™d_ty≥s
[] = {

825 
DESC_ENTRY
 (
ZEBRA_INTERFACE_ADD
),

826 
DESC_ENTRY
 (
ZEBRA_INTERFACE_DELETE
),

827 
DESC_ENTRY
 (
ZEBRA_INTERFACE_ADDRESS_ADD
),

828 
DESC_ENTRY
 (
ZEBRA_INTERFACE_ADDRESS_DELETE
),

829 
DESC_ENTRY
 (
ZEBRA_INTERFACE_UP
),

830 
DESC_ENTRY
 (
ZEBRA_INTERFACE_DOWN
),

831 
DESC_ENTRY
 (
ZEBRA_IPV4_ROUTE_ADD
),

832 
DESC_ENTRY
 (
ZEBRA_IPV4_ROUTE_DELETE
),

833 
DESC_ENTRY
 (
ZEBRA_IPV6_ROUTE_ADD
),

834 
DESC_ENTRY
 (
ZEBRA_IPV6_ROUTE_DELETE
),

835 
DESC_ENTRY
 (
ZEBRA_REDISTRIBUTE_ADD
),

836 
DESC_ENTRY
 (
ZEBRA_REDISTRIBUTE_DELETE
),

837 
DESC_ENTRY
 (
ZEBRA_REDISTRIBUTE_DEFAULT_ADD
),

838 
DESC_ENTRY
 (
ZEBRA_REDISTRIBUTE_DEFAULT_DELETE
),

839 
DESC_ENTRY
 (
ZEBRA_IPV4_NEXTHOP_LOOKUP
),

840 
DESC_ENTRY
 (
ZEBRA_IPV6_NEXTHOP_LOOKUP
),

841 
DESC_ENTRY
 (
ZEBRA_IPV4_IMPORT_LOOKUP
),

842 
DESC_ENTRY
 (
ZEBRA_IPV6_IMPORT_LOOKUP
),

843 
DESC_ENTRY
 (
ZEBRA_INTERFACE_RENAME
),

844 
DESC_ENTRY
 (
ZEBRA_ROUTER_ID_ADD
),

845 
DESC_ENTRY
 (
ZEBRA_ROUTER_ID_DELETE
),

846 
DESC_ENTRY
 (
ZEBRA_ROUTER_ID_UPDATE
),

847 
DESC_ENTRY
 (
ZEBRA_HELLO
),

849 #unde‡
DESC_ENTRY


851 c⁄° 
zebø_desc_èbÀ
 
	gunknown
 = { 0, "unknown", '?' };

853 c⁄° 
zebø_desc_èbÀ
 *

854 
	$zrouã_lookup
(
u_öt
 
zrouã
)

856 
u_öt
 
i
;

858 i‡(
zrouã
 >
	`¨øy_size
(
rouã_ty≥s
))

860 
	`zlog_îr
("unknow¿zebøÑouãÅy≥: %u", 
zrouã
);

861  &
unknown
;

863 i‡(
zrouã
 =
rouã_ty≥s
[zrouã].
ty≥
)

864  &
rouã_ty≥s
[
zrouã
];

865 
i
 = 0; i < 
	`¨øy_size
(
rouã_ty≥s
); i++)

867 i‡(
zrouã
 =
rouã_ty≥s
[
i
].
ty≥
)

869 
	`zlog_w¨n
("internalÉrror:ÑouteÅypeÅable out of order "

870 "whûê£¨chög f‹ %u,ÖÀa£ÇŸify devñ›îs", 
zrouã
);

871  &
rouã_ty≥s
[
i
];

874 
	`zlog_îr
("öã∫ÆÉº‹: c™nŸ födÑouãÅy≥ %u i¿èbÀ!", 
zrouã
);

875  &
unknown
;

876 
	}
}

879 
	$zebø_rouã_°rög
(
u_öt
 
zrouã
)

881  
	`zrouã_lookup
(
zrouã
)->
°rög
;

882 
	}
}

885 
	$zebø_rouã_ch¨
(
u_öt
 
zrouã
)

887  
	`zrouã_lookup
(
zrouã
)->
chr
;

888 
	}
}

891 
	$z£rv_comm™d_°rög
 (
comm™d
)

893 i‡(
comm™d
 >
	`¨øy_size
(
comm™d_ty≥s
))

895 
	`zlog_îr
 ("unknow¿z£rv comm™dÅy≥: %u", 
comm™d
);

896  
unknown
.
°rög
;

898  
comm™d_ty≥s
[
comm™d
].
°rög
;

899 
	}
}

902 
	$¥Ÿo_«me2num
(c⁄° *
s
)

904 
i
;

906 
i
=0; i<
	`¨øy_size
(
rouã_ty≥s
); ++i)

907 i‡(
	`°rˇ£cmp
(
s
, 
rouã_ty≥s
[
i
].
°rög
) == 0)

908  
rouã_ty≥s
[
i
].
ty≥
;

910 
	}
}

913 
	$¥Ÿo_ªdi°num
(
afi
, c⁄° *
s
)

915 i‡(! 
s
)

918 i‡(
afi
 =
AFI_IP
)

920 i‡(
	`°∫cmp
 (
s
, "k", 1) == 0)

921  
ZEBRA_ROUTE_KERNEL
;

922 i‡(
	`°∫cmp
 (
s
, "c", 1) == 0)

923  
ZEBRA_ROUTE_CONNECT
;

924 i‡(
	`°∫cmp
 (
s
, "s", 1) == 0)

925  
ZEBRA_ROUTE_STATIC
;

926 i‡(
	`°∫cmp
 (
s
, "r", 1) == 0)

927  
ZEBRA_ROUTE_RIP
;

928 i‡(
	`°∫cmp
 (
s
, "o", 1) == 0)

929  
ZEBRA_ROUTE_OSPF
;

930 i‡(
	`°∫cmp
 (
s
, "i", 1) == 0)

931  
ZEBRA_ROUTE_ISIS
;

932 i‡(
	`°∫cmp
 (
s
, "bg", 2) == 0)

933  
ZEBRA_ROUTE_BGP
;

934 i‡(
	`°∫cmp
 (
s
, "ba", 2) == 0)

935  
ZEBRA_ROUTE_BABEL
;

937 i‡(
afi
 =
AFI_IP6
)

939 i‡(
	`°∫cmp
 (
s
, "k", 1) == 0)

940  
ZEBRA_ROUTE_KERNEL
;

941 i‡(
	`°∫cmp
 (
s
, "c", 1) == 0)

942  
ZEBRA_ROUTE_CONNECT
;

943 i‡(
	`°∫cmp
 (
s
, "s", 1) == 0)

944  
ZEBRA_ROUTE_STATIC
;

945 i‡(
	`°∫cmp
 (
s
, "r", 1) == 0)

946  
ZEBRA_ROUTE_RIPNG
;

947 i‡(
	`°∫cmp
 (
s
, "o", 1) == 0)

948  
ZEBRA_ROUTE_OSPF6
;

949 i‡(
	`°∫cmp
 (
s
, "i", 1) == 0)

950  
ZEBRA_ROUTE_ISIS
;

951 i‡(
	`°∫cmp
 (
s
, "bg", 2) == 0)

952  
ZEBRA_ROUTE_BGP
;

953 i‡(
	`°∫cmp
 (
s
, "ba", 2) == 0)

954  
ZEBRA_ROUTE_BABEL
;

957 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/log.h

23 #i‚de‡
_ZEBRA_LOG_H


24 
	#_ZEBRA_LOG_H


	)

26 
	~<sy¶og.h
>

46 
	mZLOG_NONE
,

47 
	mZLOG_DEFAULT
,

48 
	mZLOG_ZEBRA
,

49 
	mZLOG_RIP
,

50 
	mZLOG_BGP
,

51 
	mZLOG_OSPF
,

52 
	mZLOG_RIPNG
,

53 
	mZLOG_BABEL
,

54 
	mZLOG_OSPF6
,

55 
	mZLOG_ISIS
,

56 
	mZLOG_MASC


57 } 
	tzlog_¥Ÿo_t
;

61 
	#ZLOG_DISABLED
 (
LOG_EMERG
-1)

	)

65 
	mZLOG_DEST_SYSLOG
 = 0,

66 
	mZLOG_DEST_STDOUT
,

67 
	mZLOG_DEST_MONITOR
,

68 
	mZLOG_DEST_FILE


69 } 
	tzlog_de°_t
;

70 
	#ZLOG_NUM_DESTS
 (
ZLOG_DEST_FILE
+1)

	)

72 
	szlog


74 c⁄° *
	midít
;

75 
zlog_¥Ÿo_t
 
	m¥Ÿocﬁ
;

76 
	mmaxlvl
[
ZLOG_NUM_DESTS
];

78 
	mdeÁu…_lvl
;

79 
FILE
 *
	mÂ
;

80 *
	mfûíame
;

81 
	mÁcûôy
;

82 
	mªc‹d_¥i‹ôy
;

84 
	msy¶og_›ti⁄s
;

85 
	mtime°amp_¥ecisi⁄
;

89 
	smesßge


91 
	mkey
;

92 c⁄° *
	m°r
;

96 
zlog
 *
zlog_deÁu…
;

99 
zlog
 *
›ízlog
 (c⁄° *
¥og«me
, 
zlog_¥Ÿo_t
 
¥Ÿocﬁ
,

100 
sy¶og_›ti⁄s
, 
sy¶og_Ácûôy
);

103 
˛o£zlog
 (
zlog
 *
zl
);

106 #ifde‡
__GNUC__


107 
	#PRINTF_ATTRIBUTE
(
a
,
b
Ë
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
,á, b)))

	)

109 
	#PRINTF_ATTRIBUTE
(
a
,
b
)

	)

113 
	$zlog
 (
zlog
 *
zl
, 
¥i‹ôy
, c⁄° *
f‹m©
, ...)

114 
	`PRINTF_ATTRIBUTE
(3, 4);

117 
	$zlog_îr
 (c⁄° *
f‹m©
, ...Ë
	`PRINTF_ATTRIBUTE
(1, 2);

118 
	$zlog_w¨n
 (c⁄° *
f‹m©
, ...Ë
	`PRINTF_ATTRIBUTE
(1, 2);

119 
	$zlog_öfo
 (c⁄° *
f‹m©
, ...Ë
	`PRINTF_ATTRIBUTE
(1, 2);

120 
	$zlog_nŸi˚
 (c⁄° *
f‹m©
, ...Ë
	`PRINTF_ATTRIBUTE
(1, 2);

121 
	$zlog_debug
 (c⁄° *
f‹m©
, ...Ë
	`PRINTF_ATTRIBUTE
(1, 2);

124 
	$∂og_îr
 (
zlog
 *, c⁄° *
f‹m©
, ...)

125 
	`PRINTF_ATTRIBUTE
(2, 3);

126 
	$∂og_w¨n
 (
zlog
 *, c⁄° *
f‹m©
, ...)

127 
	`PRINTF_ATTRIBUTE
(2, 3);

128 
	$∂og_öfo
 (
zlog
 *, c⁄° *
f‹m©
, ...)

129 
	`PRINTF_ATTRIBUTE
(2, 3);

130 
	$∂og_nŸi˚
 (
zlog
 *, c⁄° *
f‹m©
, ...)

131 
	`PRINTF_ATTRIBUTE
(2, 3);

132 
	$∂og_debug
 (
zlog
 *, c⁄° *
f‹m©
, ...)

133 
	`PRINTF_ATTRIBUTE
(2, 3);

139 
	`zlog_£t_Àvñ
 (
zlog
 *
zl
, 
zlog_de°_t
, 
log_Àvñ
);

142 
	`zlog_£t_fûe
 (
zlog
 *
zl
, c⁄° *
fûíame
, 
log_Àvñ
);

144 
	`zlog_ª£t_fûe
 (
zlog
 *
zl
);

147 
	`zlog_rŸ©e
 (
zlog
 *);

150 
	#LOOKUP_DEF
(
x
, 
y
, 
def
Ë
	`mes_lookup
(x, x ## 
_max
, y, def, #x)

	)

151 
	#LOOKUP
(
x
, 
y
Ë
	`LOOKUP_DEF
(x, y, "“ÿôem found)")

	)

153 c⁄° *
	`lookup
 (c⁄° 
mesßge
 *, );

154 c⁄° *
	`mes_lookup
 (c⁄° 
mesßge
 *
me¶i°
,

155 
max
, 
ödex
,

156 c⁄° *
no_ôem
, c⁄° *
me¢ame
);

158 c⁄° *
zlog_¥i‹ôy
[];

159 c⁄° *
zlog_¥Ÿo_«mes
[];

162 c⁄° *
	`ß„_°ªº‹
(
î∫um
);

165 
	`zlog_sig«l
(
signo
, c⁄° *
a˘i⁄


166 #ifde‡
SA_SIGINFO


167 , 
sigöfo_t
 *
sigöfo
, *
¥ogøm_cou¡î


172 
	`zlog_backåa˚
(
¥i‹ôy
);

178 
	`zlog_backåa˚_sigß„
(
¥i‹ôy
, *
¥ogøm_cou¡î
);

186 
size_t
 
	`quagga_time°amp
(
time°amp_¥ecisi⁄
 ,

187 *
buf
, 
size_t
 
buÊí
);

190 
	stime°amp_c⁄åﬁ
 {

191 
size_t
 
Àn
;

192 
¥ecisi⁄
;

193 
Æªady_ªndîed
;

194 
buf
[40];

199 
	#LOG_LEVELS
 "”mîgícõs|Æîts|¸ôiˇl|îr‹s|w¨nögs|nŸifiˇti⁄s|öf‹m©i⁄Æ|debuggög)"

	)

201 
	#LOG_LEVEL_DESC
 \

209 "Debuggög mesßges\n"

	)

211 
	#LOG_FACILITIES
 "(kîn|u£r|maû|d´m⁄|auth|sy¶og|Õr|√ws|uu˝|¸⁄|loˇl0|loˇl1|loˇl2|loˇl3|loˇl4|loˇl5|loˇl6|loˇl7)"

	)

213 
	#LOG_FACILITY_DESC
 \

231 "Loˇ»u£\n"

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/md5.c

42 
	~<zebø.h
>

43 
	~"md5.h
"

45 
	#SHIFT
(
X
, 
s
Ë(((XË<< (s)Ë| ((XË>> (32 - (s))))

	)

47 
	#F
(
X
, 
Y
, 
Z
Ë(((XË& (Y)Ë| ((~XË& (Z)))

	)

48 
	#G
(
X
, 
Y
, 
Z
Ë(((XË& (Z)Ë| ((YË& (~Z)))

	)

49 
	#H
(
X
, 
Y
, 
Z
Ë((XË^ (YË^ (Z))

	)

50 
	#I
(
X
, 
Y
, 
Z
Ë((YË^ ((XË| (~Z)))

	)

52 
	#ROUND1
(
a
, 
b
, 
c
, 
d
, 
k
, 
s
, 
i
) { \

53 (
a
Ë◊Ë+ 
	`F
((
b
), (
c
), (
d
)Ë+ 
X
[(
k
)] + 
T
[(
i
)]; \

54 (
a
Ë
	`SHIFT
(◊), (
s
)); \

55 (
a
Ë(
b
) + (a); \

56 }

	)

58 
	#ROUND2
(
a
, 
b
, 
c
, 
d
, 
k
, 
s
, 
i
) { \

59 (
a
Ë◊Ë+ 
	`G
((
b
), (
c
), (
d
)Ë+ 
X
[(
k
)] + 
T
[(
i
)]; \

60 (
a
Ë
	`SHIFT
(◊), (
s
)); \

61 (
a
Ë(
b
) + (a); \

62 }

	)

64 
	#ROUND3
(
a
, 
b
, 
c
, 
d
, 
k
, 
s
, 
i
) { \

65 (
a
Ë◊Ë+ 
	`H
((
b
), (
c
), (
d
)Ë+ 
X
[(
k
)] + 
T
[(
i
)]; \

66 (
a
Ë
	`SHIFT
(◊), (
s
)); \

67 (
a
Ë(
b
) + (a); \

68 }

	)

70 
	#ROUND4
(
a
, 
b
, 
c
, 
d
, 
k
, 
s
, 
i
) { \

71 (
a
Ë◊Ë+ 
	`I
((
b
), (
c
), (
d
)Ë+ 
X
[(
k
)] + 
T
[(
i
)]; \

72 (
a
Ë
	`SHIFT
(◊), (
s
)); \

73 (
a
Ë(
b
) + (a); \

74 }

	)

76 
	#Sa
 7

	)

77 
	#Sb
 12

	)

78 
	#Sc
 17

	)

79 
	#Sd
 22

	)

81 
	#Se
 5

	)

82 
	#Sf
 9

	)

83 
	#Sg
 14

	)

84 
	#Sh
 20

	)

86 
	#Si
 4

	)

87 
	#Sj
 11

	)

88 
	#Sk
 16

	)

89 
	#Sl
 23

	)

91 
	#Sm
 6

	)

92 
	#Sn
 10

	)

93 
	#So
 15

	)

94 
	#Sp
 21

	)

96 
	#MD5_A0
 0x67452301

	)

97 
	#MD5_B0
 0xefcdab89

	)

98 
	#MD5_C0
 0x98badc„

	)

99 
	#MD5_D0
 0x10325476

	)

102 c⁄° 
uöt32_t
 
	gT
[65] = {

125 c⁄° 
uöt8_t
 
	gmd5_∑dd©
[
MD5_BUFLEN
] = {

136 
md5_ˇlc
 (c⁄° 
uöt8_t
 *, 
md5_˘xt
 *);

138 
	$md5_öô
(
md5_˘xt
 *
˘xt
)

140 
˘xt
->
md5_n
 = 0;

141 
˘xt
->
md5_i
 = 0;

142 
˘xt
->
md5_°a
 = 
MD5_A0
;

143 
˘xt
->
md5_°b
 = 
MD5_B0
;

144 
˘xt
->
md5_°c
 = 
MD5_C0
;

145 
˘xt
->
md5_°d
 = 
MD5_D0
;

146 
	`mem£t
 (
˘xt
->
md5_buf
, 0, (ctxt->md5_buf));

147 
	}
}

149 
	$md5_lo›
(
md5_˘xt
 *
˘xt
, c⁄° *
vöput
, 
uöt
 
Àn
)

151 
uöt
 
g≠
, 
i
;

152 c⁄° 
uöt8_t
 *
öput
 = 
vöput
;

154 
˘xt
->
md5_n
 +
Àn
 * 8;

155 
g≠
 = 
MD5_BUFLEN
 - 
˘xt
->
md5_i
;

157 i‡(
Àn
 >
g≠
) {

158 
	`mem˝y
 (
˘xt
->
md5_buf
 + ctxt->
md5_i
, 
öput
, 
g≠
);

159 
	`md5_ˇlc
(
˘xt
->
md5_buf
, ctxt);

161 
i
 = 
g≠
; i + 
MD5_BUFLEN
 <
Àn
; i += MD5_BUFLEN) {

162 
	`md5_ˇlc
((
öput
 + 
i
), 
˘xt
);

165 
˘xt
->
md5_i
 = 
Àn
 - 
i
;

166 
	`mem˝y
 (
˘xt
->
md5_buf
, (
öput
 + 
i
), ctxt->
md5_i
);

168 
	`mem˝y
 (
˘xt
->
md5_buf
 + ctxt->
md5_i
, 
öput
, 
Àn
);

169 
˘xt
->
md5_i
 +
Àn
;

171 
	}
}

173 
	$md5_∑d
(
md5_˘xt
 *
˘xt
)

175 
uöt
 
g≠
;

178 
g≠
 = 
MD5_BUFLEN
 - 
˘xt
->
md5_i
;

179 i‡(
g≠
 > 8) {

180 
	`mem˝y
 (
˘xt
->
md5_buf
 + ctxt->
md5_i
, 
md5_∑dd©
,

181 
g≠
 - (
˘xt
->
md5_n
));

184 
	`mem˝y
 (
˘xt
->
md5_buf
 + ctxt->
md5_i
, 
md5_∑dd©
, 
g≠
);

185 
	`md5_ˇlc
 (
˘xt
->
md5_buf
, ctxt);

186 
	`mem˝y
 (
˘xt
->
md5_buf
, 
md5_∑dd©
 + 
g≠
,

187 
MD5_BUFLEN
 - (
˘xt
->
md5_n
));

191 i‡(
BYTE_ORDER
 =
LITTLE_ENDIAN
)

192 
	`mem˝y
 (&
˘xt
->
md5_buf
[56], &˘xt->
md5_n8
[0], 8);

195 
˘xt
->
md5_buf
[56] = ctxt->
md5_n8
[7];

196 
˘xt
->
md5_buf
[57] = ctxt->
md5_n8
[6];

197 
˘xt
->
md5_buf
[58] = ctxt->
md5_n8
[5];

198 
˘xt
->
md5_buf
[59] = ctxt->
md5_n8
[4];

199 
˘xt
->
md5_buf
[60] = ctxt->
md5_n8
[3];

200 
˘xt
->
md5_buf
[61] = ctxt->
md5_n8
[2];

201 
˘xt
->
md5_buf
[62] = ctxt->
md5_n8
[1];

202 
˘xt
->
md5_buf
[63] = ctxt->
md5_n8
[0];

204 
	`md5_ˇlc
(
˘xt
->
md5_buf
, ctxt);

205 
	}
}

207 
	$md5_ªsu…
(
uöt8_t
 *
dige°
, 
md5_˘xt
 *
˘xt
)

210 i‡(
BYTE_ORDER
 =
LITTLE_ENDIAN
)

211 
	`mem˝y
 (
dige°
, &
˘xt
->
md5_°8
[0], 16);

212 i‡(
BYTE_ORDER
 =
BIG_ENDIAN
)

214 
dige°
[ 0] = 
˘xt
->
md5_°8
[ 3]; digest[ 1] = ctxt->md5_st8[ 2];

215 
dige°
[ 2] = 
˘xt
->
md5_°8
[ 1]; digest[ 3] = ctxt->md5_st8[ 0];

216 
dige°
[ 4] = 
˘xt
->
md5_°8
[ 7]; digest[ 5] = ctxt->md5_st8[ 6];

217 
dige°
[ 6] = 
˘xt
->
md5_°8
[ 5]; digest[ 7] = ctxt->md5_st8[ 4];

218 
dige°
[ 8] = 
˘xt
->
md5_°8
[11]; digest[ 9] = ctxt->md5_st8[10];

219 
dige°
[10] = 
˘xt
->
md5_°8
[ 9]; digest[11] = ctxt->md5_st8[ 8];

220 
dige°
[12] = 
˘xt
->
md5_°8
[15]; digest[13] = ctxt->md5_st8[14];

221 
dige°
[14] = 
˘xt
->
md5_°8
[13]; digest[15] = ctxt->md5_st8[12];

223 
	}
}

225 
	$md5_ˇlc
(c⁄° 
uöt8_t
 *
b64
, 
md5_˘xt
 * 
˘xt
)

227 
uöt32_t
 
A
 = 
˘xt
->
md5_°a
;

228 
uöt32_t
 
B
 = 
˘xt
->
md5_°b
;

229 
uöt32_t
 
C
 = 
˘xt
->
md5_°c
;

230 
uöt32_t
 
D
 = 
˘xt
->
md5_°d
;

231 #i‡(
BYTE_ORDER
 =
LITTLE_ENDIAN
)

232 c⁄° 
uöt32_t
 *
X
 = (c⁄° uöt32_à*)
b64
;

233 #ñi‡(
BYTE_ORDER
 =
BIG_ENDIAN
)

234 
uöt32_t
 
X
[16];

236 i‡(
BYTE_ORDER
 =
BIG_ENDIAN
)

240 
uöt8_t
 *
y
 = (uöt8_à*)
X
;

241 
y
[ 0] = 
b64
[ 3]; y[ 1] = b64[ 2]; y[ 2] = b64[ 1]; y[ 3] = b64[ 0];

242 
y
[ 4] = 
b64
[ 7]; y[ 5] = b64[ 6]; y[ 6] = b64[ 5]; y[ 7] = b64[ 4];

243 
y
[ 8] = 
b64
[11]; y[ 9] = b64[10]; y[10] = b64[ 9]; y[11] = b64[ 8];

244 
y
[12] = 
b64
[15]; y[13] = b64[14]; y[14] = b64[13]; y[15] = b64[12];

245 
y
[16] = 
b64
[19]; y[17] = b64[18]; y[18] = b64[17]; y[19] = b64[16];

246 
y
[20] = 
b64
[23]; y[21] = b64[22]; y[22] = b64[21]; y[23] = b64[20];

247 
y
[24] = 
b64
[27]; y[25] = b64[26]; y[26] = b64[25]; y[27] = b64[24];

248 
y
[28] = 
b64
[31]; y[29] = b64[30]; y[30] = b64[29]; y[31] = b64[28];

249 
y
[32] = 
b64
[35]; y[33] = b64[34]; y[34] = b64[33]; y[35] = b64[32];

250 
y
[36] = 
b64
[39]; y[37] = b64[38]; y[38] = b64[37]; y[39] = b64[36];

251 
y
[40] = 
b64
[43]; y[41] = b64[42]; y[42] = b64[41]; y[43] = b64[40];

252 
y
[44] = 
b64
[47]; y[45] = b64[46]; y[46] = b64[45]; y[47] = b64[44];

253 
y
[48] = 
b64
[51]; y[49] = b64[50]; y[50] = b64[49]; y[51] = b64[48];

254 
y
[52] = 
b64
[55]; y[53] = b64[54]; y[54] = b64[53]; y[55] = b64[52];

255 
y
[56] = 
b64
[59]; y[57] = b64[58]; y[58] = b64[57]; y[59] = b64[56];

256 
y
[60] = 
b64
[63]; y[61] = b64[62]; y[62] = b64[61]; y[63] = b64[60];

260 
	`ROUND1
(
A
, 
B
, 
C
, 
D
, 0, 
Sa
, 1); ROUND1(D, A, B, C, 1, 
Sb
, 2);

261 
	`ROUND1
(
C
, 
D
, 
A
, 
B
, 2, 
Sc
, 3); ROUND1(B, C, D, A, 3, 
Sd
, 4);

262 
	`ROUND1
(
A
, 
B
, 
C
, 
D
, 4, 
Sa
, 5); ROUND1(D, A, B, C, 5, 
Sb
, 6);

263 
	`ROUND1
(
C
, 
D
, 
A
, 
B
, 6, 
Sc
, 7); ROUND1(B, C, D, A, 7, 
Sd
, 8);

264 
	`ROUND1
(
A
, 
B
, 
C
, 
D
, 8, 
Sa
, 9); ROUND1(D, A, B, C, 9, 
Sb
, 10);

265 
	`ROUND1
(
C
, 
D
, 
A
, 
B
, 10, 
Sc
, 11); ROUND1(B, C, D, A, 11, 
Sd
, 12);

266 
	`ROUND1
(
A
, 
B
, 
C
, 
D
, 12, 
Sa
, 13); ROUND1(D, A, B, C, 13, 
Sb
, 14);

267 
	`ROUND1
(
C
, 
D
, 
A
, 
B
, 14, 
Sc
, 15); ROUND1(B, C, D, A, 15, 
Sd
, 16);

269 
	`ROUND2
(
A
, 
B
, 
C
, 
D
, 1, 
Se
, 17); ROUND2(D, A, B, C, 6, 
Sf
, 18);

270 
	`ROUND2
(
C
, 
D
, 
A
, 
B
, 11, 
Sg
, 19); ROUND2(B, C, D, A, 0, 
Sh
, 20);

271 
	`ROUND2
(
A
, 
B
, 
C
, 
D
, 5, 
Se
, 21); ROUND2(D, A, B, C, 10, 
Sf
, 22);

272 
	`ROUND2
(
C
, 
D
, 
A
, 
B
, 15, 
Sg
, 23); ROUND2(B, C, D, A, 4, 
Sh
, 24);

273 
	`ROUND2
(
A
, 
B
, 
C
, 
D
, 9, 
Se
, 25); ROUND2(D, A, B, C, 14, 
Sf
, 26);

274 
	`ROUND2
(
C
, 
D
, 
A
, 
B
, 3, 
Sg
, 27); ROUND2(B, C, D, A, 8, 
Sh
, 28);

275 
	`ROUND2
(
A
, 
B
, 
C
, 
D
, 13, 
Se
, 29); ROUND2(D, A, B, C, 2, 
Sf
, 30);

276 
	`ROUND2
(
C
, 
D
, 
A
, 
B
, 7, 
Sg
, 31); ROUND2(B, C, D, A, 12, 
Sh
, 32);

278 
	`ROUND3
(
A
, 
B
, 
C
, 
D
, 5, 
Si
, 33); ROUND3(D, A, B, C, 8, 
Sj
, 34);

279 
	`ROUND3
(
C
, 
D
, 
A
, 
B
, 11, 
Sk
, 35); ROUND3(B, C, D, A, 14, 
Sl
, 36);

280 
	`ROUND3
(
A
, 
B
, 
C
, 
D
, 1, 
Si
, 37); ROUND3(D, A, B, C, 4, 
Sj
, 38);

281 
	`ROUND3
(
C
, 
D
, 
A
, 
B
, 7, 
Sk
, 39); ROUND3(B, C, D, A, 10, 
Sl
, 40);

282 
	`ROUND3
(
A
, 
B
, 
C
, 
D
, 13, 
Si
, 41); ROUND3(D, A, B, C, 0, 
Sj
, 42);

283 
	`ROUND3
(
C
, 
D
, 
A
, 
B
, 3, 
Sk
, 43); ROUND3(B, C, D, A, 6, 
Sl
, 44);

284 
	`ROUND3
(
A
, 
B
, 
C
, 
D
, 9, 
Si
, 45); ROUND3(D, A, B, C, 12, 
Sj
, 46);

285 
	`ROUND3
(
C
, 
D
, 
A
, 
B
, 15, 
Sk
, 47); ROUND3(B, C, D, A, 2, 
Sl
, 48);

287 
	`ROUND4
(
A
, 
B
, 
C
, 
D
, 0, 
Sm
, 49); ROUND4(D, A, B, C, 7, 
Sn
, 50);

288 
	`ROUND4
(
C
, 
D
, 
A
, 
B
, 14, 
So
, 51); ROUND4(B, C, D, A, 5, 
Sp
, 52);

289 
	`ROUND4
(
A
, 
B
, 
C
, 
D
, 12, 
Sm
, 53); ROUND4(D, A, B, C, 3, 
Sn
, 54);

290 
	`ROUND4
(
C
, 
D
, 
A
, 
B
, 10, 
So
, 55); ROUND4(B, C, D, A, 1, 
Sp
, 56);

291 
	`ROUND4
(
A
, 
B
, 
C
, 
D
, 8, 
Sm
, 57); ROUND4(D, A, B, C, 15, 
Sn
, 58);

292 
	`ROUND4
(
C
, 
D
, 
A
, 
B
, 6, 
So
, 59); ROUND4(B, C, D, A, 13, 
Sp
, 60);

293 
	`ROUND4
(
A
, 
B
, 
C
, 
D
, 4, 
Sm
, 61); ROUND4(D, A, B, C, 11, 
Sn
, 62);

294 
	`ROUND4
(
C
, 
D
, 
A
, 
B
, 2, 
So
, 63); ROUND4(B, C, D, A, 9, 
Sp
, 64);

296 
˘xt
->
md5_°a
 +
A
;

297 
˘xt
->
md5_°b
 +
B
;

298 
˘xt
->
md5_°c
 +
C
;

299 
˘xt
->
md5_°d
 +
D
;

300 
	}
}

304 
	$hmac_md5
(
ãxt
, 
ãxt_Àn
, 
key
, 
key_Àn
, 
dige°
)

305 * 
ãxt
;

306 
ãxt_Àn
;

307 * 
key
;

308 
key_Àn
;

309 
ˇddr_t
 
dige°
;

312 
MD5_CTX
 
c⁄ãxt
;

313 
k_ùad
[65];

316 
k_›ad
[65];

319 
tk
[16];

320 
i
;

322 i‡(
key_Àn
 > 64) {

324 
MD5_CTX
 
t˘x
;

326 
	`MD5Inô
(&
t˘x
);

327 
	`MD5Upd©e
(&
t˘x
, 
key
, 
key_Àn
);

328 
	`MD5FöÆ
(
tk
, &
t˘x
);

330 
key
 = 
tk
;

331 
key_Àn
 = 16;

346 
	`bzîo
–
k_ùad
,  k_ipad);

347 
	`bzîo
–
k_›ad
,  k_opad);

348 
	`bc›y
–
key
, 
k_ùad
, 
key_Àn
);

349 
	`bc›y
–
key
, 
k_›ad
, 
key_Àn
);

352 
i
=0; i<64; i++) {

353 
k_ùad
[
i
] ^= 0x36;

354 
k_›ad
[
i
] ^= 0x5c;

359 
	`MD5Inô
(&
c⁄ãxt
);

361 
	`MD5Upd©e
(&
c⁄ãxt
, 
k_ùad
, 64);

362 
	`MD5Upd©e
(&
c⁄ãxt
, 
ãxt
, 
ãxt_Àn
);

363 
	`MD5FöÆ
(
dige°
, &
c⁄ãxt
);

367 
	`MD5Inô
(&
c⁄ãxt
);

369 
	`MD5Upd©e
(&
c⁄ãxt
, 
k_›ad
, 64);

370 
	`MD5Upd©e
(&
c⁄ãxt
, 
dige°
, 16);

372 
	`MD5FöÆ
(
dige°
, &
c⁄ãxt
);

373 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/md5.h

42 #i‚de‡
_LIBZEBRA_MD5_H_


43 
	#_LIBZEBRA_MD5_H_


	)

45 
	#MD5_BUFLEN
 64

	)

49 
uöt32_t
 
	mmd5_°©e32
[4];

50 
uöt8_t
 
	mmd5_°©e8
[16];

51 } 
	mmd5_°
;

53 
	#md5_°a
 
md5_°
.
md5_°©e32
[0]

	)

54 
	#md5_°b
 
md5_°
.
md5_°©e32
[1]

	)

55 
	#md5_°c
 
md5_°
.
md5_°©e32
[2]

	)

56 
	#md5_°d
 
md5_°
.
md5_°©e32
[3]

	)

57 
	#md5_°8
 
md5_°
.
md5_°©e8


	)

60 
uöt64_t
 
	mmd5_cou¡64
;

61 
uöt8_t
 
	mmd5_cou¡8
[8];

62 } 
	mmd5_cou¡
;

63 
	#md5_n
 
md5_cou¡
.
md5_cou¡64


	)

64 
	#md5_n8
 
md5_cou¡
.
md5_cou¡8


	)

66 
uöt
 
	mmd5_i
;

67 
uöt8_t
 
	mmd5_buf
[
MD5_BUFLEN
];

68 } 
	tmd5_˘xt
;

70 
md5_öô
 (
md5_˘xt
 *);

71 
md5_lo›
 (
md5_˘xt
 *, c⁄° *, 
u_öt
);

72 
md5_∑d
 (
md5_˘xt
 *);

73 
md5_ªsu…
 (
uöt8_t
 *, 
md5_˘xt
 *);

76 
	#MD5_CTX
 
md5_˘xt


	)

77 
	#MD5Inô
(
x
Ë
	`md5_öô
((x))

	)

78 
	#MD5Upd©e
(
x
, 
y
, 
z
Ë
	`md5_lo›
((x), (y), (z))

	)

79 
	#MD5FöÆ
(
x
, 
y
) \

81 
	`md5_∑d
((
y
)); \

82 
	`md5_ªsu…
((
x
), (
y
)); \

83 } 0)

	)

86 
hmac_md5
(* 
ãxt
, 
ãxt_Àn
, * 
key
,

87 
key_Àn
, 
ˇddr_t
 
dige°
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memory.c

23 
	~<zebø.h
>

25 #i‡!
deföed
(
HAVE_STDLIB_H
Ë|| (deföed(
GNU_LINUX
Ë&& deföed(
HAVE_MALLINFO
))

26 
	~<mÆloc.h
>

29 
	~"log.h
"

30 
	~"mem‹y.h
"

32 
Æloc_öc
 ();

33 
Æloc_dec
 ();

34 
log_mem°©s
(
log_¥i‹ôy
);

36 c⁄° 
mesßge
 
	gm°r
 [] =

38 { 
MTYPE_THREAD
, "thread" },

39 { 
MTYPE_THREAD_MASTER
, "thread_master" },

40 { 
MTYPE_VECTOR
, "vector" },

41 { 
MTYPE_VECTOR_INDEX
, "vector_index" },

42 { 
MTYPE_IF
, "interface" },

43 { 0, 
NULL
 },

47 
__©åibuã__
 ((
n‹ëu∫
))

48 
	$zîr‹
 (c⁄° *
‚ame
, 
ty≥
, 
size_t
 
size
)

50 
	`zlog_îr
 ("%s : can'tállocate memory for `%s' size %d: %s\n",

51 
‚ame
, 
	`lookup
 (
m°r
, 
ty≥
), (Ë
size
, 
	`ß„_°ªº‹
(
î∫o
));

52 
	`log_mem°©s
(
LOG_WARNING
);

57 
	`zlog_backåa˚
(
LOG_WARNING
);

58 
	`ab‹t
();

59 
	}
}

67 
	$zmÆloc
 (
ty≥
, 
size_t
 
size
)

69 *
mem‹y
;

71 
mem‹y
 = 
	`mÆloc
 (
size
);

73 i‡(
mem‹y
 =
NULL
)

74 
	`zîr‹
 ("mÆloc", 
ty≥
, 
size
);

76 
	`Æloc_öc
 (
ty≥
);

78  
mem‹y
;

79 
	}
}

85 
	$zˇŒoc
 (
ty≥
, 
size_t
 
size
)

87 *
mem‹y
;

89 
mem‹y
 = 
	`ˇŒoc
 (1, 
size
);

91 i‡(
mem‹y
 =
NULL
)

92 
	`zîr‹
 ("ˇŒoc", 
ty≥
, 
size
);

94 
	`Æloc_öc
 (
ty≥
);

96  
mem‹y
;

97 
	}
}

107 
	$zªÆloc
 (
ty≥
, *
±r
, 
size_t
 
size
)

109 *
mem‹y
;

111 
mem‹y
 = 
	`ªÆloc
 (
±r
, 
size
);

112 i‡(
mem‹y
 =
NULL
)

113 
	`zîr‹
 ("ªÆloc", 
ty≥
, 
size
);

114 i‡(
±r
 =
NULL
)

115 
	`Æloc_öc
 (
ty≥
);

117  
mem‹y
;

118 
	}
}

127 
	$z‰ì
 (
ty≥
, *
±r
)

129 i‡(
±r
 !
NULL
)

131 
	`Æloc_dec
 (
ty≥
);

132 
	`‰ì
 (
±r
);

134 
	}
}

143 
	$z°rdup
 (
ty≥
, c⁄° *
°r
)

145 *
dup
;

147 
dup
 = 
	`°rdup
 (
°r
);

148 i‡(
dup
 =
NULL
)

149 
	`zîr‹
 ("°rdup", 
ty≥
, 
	`°æí
 (
°r
));

150 
	`Æloc_öc
 (
ty≥
);

151  
dup
;

152 
	}
}

154 #ifde‡
MEMORY_LOG


157 c⁄° *
	m«me
;

158 
	mÆloc
;

159 
	mt_mÆloc
;

160 
	mc_mÆloc
;

161 
	mt_ˇŒoc
;

162 
	mc_ˇŒoc
;

163 
	mt_ªÆloc
;

164 
	mt_‰ì
;

165 
	mc_°rdup
;

166 } 
	gm°©
 [
MTYPE_MAX
];

169 
	$mty≥_log
 (*
func
, *
mem‹y
, c⁄° *
fûe
, 
löe
, 
ty≥
)

171 
	`zlog_debug
 ("%s: %†%∞%†%d", 
func
, 
	`lookup
 (
m°r
, 
ty≥
), 
mem‹y
, 
fûe
, 
löe
);

172 
	}
}

175 
	$mty≥_zmÆloc
 (c⁄° *
fûe
, 
löe
, 
ty≥
, 
size_t
 
size
)

177 *
mem‹y
;

179 
m°©
[
ty≥
].
c_mÆloc
++;

180 
m°©
[
ty≥
].
t_mÆloc
++;

182 
mem‹y
 = 
	`zmÆloc
 (
ty≥
, 
size
);

183 
	`mty≥_log
 ("zmÆloc", 
mem‹y
, 
fûe
, 
löe
, 
ty≥
);

185  
mem‹y
;

186 
	}
}

189 
	$mty≥_zˇŒoc
 (c⁄° *
fûe
, 
löe
, 
ty≥
, 
size_t
 
size
)

191 *
mem‹y
;

193 
m°©
[
ty≥
].
c_ˇŒoc
++;

194 
m°©
[
ty≥
].
t_ˇŒoc
++;

196 
mem‹y
 = 
	`zˇŒoc
 (
ty≥
, 
size
);

197 
	`mty≥_log
 ("xˇŒoc", 
mem‹y
, 
fûe
, 
löe
, 
ty≥
);

199  
mem‹y
;

200 
	}
}

203 
	$mty≥_zªÆloc
 (c⁄° *
fûe
, 
löe
, 
ty≥
, *
±r
, 
size_t
 
size
)

205 *
mem‹y
;

208 
m°©
[
ty≥
].
t_ªÆloc
++;

210 
mem‹y
 = 
	`zªÆloc
 (
ty≥
, 
±r
, 
size
);

212 
	`mty≥_log
 ("xªÆloc", 
mem‹y
, 
fûe
, 
löe
, 
ty≥
);

214  
mem‹y
;

215 
	}
}

219 
	$mty≥_z‰ì
 (c⁄° *
fûe
, 
löe
, 
ty≥
, *
±r
)

221 
m°©
[
ty≥
].
t_‰ì
++;

223 
	`mty≥_log
 ("x‰ì", 
±r
, 
fûe
, 
löe
, 
ty≥
);

225 
	`z‰ì
 (
ty≥
, 
±r
);

226 
	}
}

229 
	$mty≥_z°rdup
 (c⁄° *
fûe
, 
löe
, 
ty≥
, c⁄° *
°r
)

231 *
mem‹y
;

233 
m°©
[
ty≥
].
c_°rdup
++;

235 
mem‹y
 = 
	`z°rdup
 (
ty≥
, 
°r
);

237 
	`mty≥_log
 ("x°rdup", 
mem‹y
, 
fûe
, 
löe
, 
ty≥
);

239  
mem‹y
;

240 
	}
}

244 *
	m«me
;

245 
	mÆloc
;

246 } 
	gm°©
 [
MTYPE_MAX
];

251 
	$Æloc_öc
 (
ty≥
)

253 
m°©
[
ty≥
].
Æloc
++;

254 
	}
}

258 
	$Æloc_dec
 (
ty≥
)

260 
m°©
[
ty≥
].
Æloc
--;

261 
	}
}

264 
	~"ve˘‹.h
"

265 
	~"vty.h
"

266 
	~"comm™d.h
"

269 
	$log_mem°©s
(
¥i
)

271 
mli°
 *
ml
;

273 
ml
 = 
mli°s
; ml->
li°
; ml++)

275 
mem‹y_li°
 *
m
;

277 
	`zlog
 (
NULL
, 
¥i
, "Mem‹y utûiz©i⁄ i¿moduÀ %s:", 
ml
->
«me
);

278 
m
 = 
ml
->
li°
; m->
ödex
 >= 0; m++)

279 i‡(
m
->
ödex
 && 
m°©
[m->ödex].
Æloc
)

280 
	`zlog
 (
NULL
, 
¥i
, " %-30s: %10ld", 
m
->
f‹m©
, 
m°©
[m->
ödex
].
Æloc
);

282 
	}
}

285 
	$log_mem°©s_°dîr
 (c⁄° *
¥efix
)

287 
mli°
 *
ml
;

288 
mem‹y_li°
 *
m
;

289 
i
;

290 
j
 = 0;

292 
ml
 = 
mli°s
; ml->
li°
; ml++)

294 
i
 = 0;

296 
m
 = 
ml
->
li°
; m->
ödex
 >= 0; m++)

297 i‡(
m
->
ödex
 && 
m°©
[m->ödex].
Æloc
)

299 i‡(!
i
)

300 
	`Ârötf
 (
°dîr
,

302 
¥efix
,

303 
ml
->
«me
);

304 
	`Ârötf
 (
°dîr
,

306 
¥efix
,

307 
m
->
f‹m©
,

308 
m°©
[
m
->
ödex
].
Æloc
,

309 
m°©
[
m
->
ödex
].
Æloc
 < 0 ? " (REPORT THIS BUG!)" : "");

310 
i
 = 
j
 = 1;

314 i‡(
j
)

315 
	`Ârötf
 (
°dîr
,

318 
¥efix
);

320 
	`Ârötf
 (
°dîr
,

322 
¥efix
);

323 
	}
}

326 
	$show_£∑øt‹
(
vty
 *vty)

328 
	`vty_out
 (
vty
, "-----------------------------\r\n");

329 
	}
}

332 
	$show_mem‹y_vty
 (
vty
 *vty, 
mem‹y_li°
 *
li°
)

334 
mem‹y_li°
 *
m
;

335 
√ed£p
 = 0;

337 
m
 = 
li°
; m->
ödex
 >= 0; m++)

338 i‡(
m
->
ödex
 == 0)

340 i‡(
√ed£p
)

342 
	`show_£∑øt‹
 (
vty
);

343 
√ed£p
 = 0;

346 i‡(
m°©
[
m
->
ödex
].
Æloc
)

348 
	`vty_out
 (
vty
, "%-30s: %10ld\r\n", 
m
->
f‹m©
, 
m°©
[m->
ödex
].
Æloc
);

349 
√ed£p
 = 1;

351  
√ed£p
;

352 
	}
}

354 #ifde‡
HAVE_MALLINFO


356 
	$show_mem‹y_mÆlöfo
 (
vty
 *vty)

358 
mÆlöfo
 
möfo
 = 
	`mÆlöfo
();

359 
buf
[
MTYPE_MEMSTR_LEN
];

361 
	`vty_out
 (
vty
, "Sy°emáŒoˇt‹ sèti°ics:%s", 
VTY_NEWLINE
);

362 
	`vty_out
 (
vty
, " Total heapállocated: %s%s",

363 
	`mty≥_mem°r
 (
buf
, 
MTYPE_MEMSTR_LEN
, 
möfo
.
¨ía
),

364 
VTY_NEWLINE
);

365 
	`vty_out
 (
vty
, " Holding block headers: %s%s",

366 
	`mty≥_mem°r
 (
buf
, 
MTYPE_MEMSTR_LEN
, 
möfo
.
hblkhd
),

367 
VTY_NEWLINE
);

368 
	`vty_out
 (
vty
, " Used small blocks: %s%s",

369 
	`mty≥_mem°r
 (
buf
, 
MTYPE_MEMSTR_LEN
, 
möfo
.
usmblks
),

370 
VTY_NEWLINE
);

371 
	`vty_out
 (
vty
, " Used ordinary blocks: %s%s",

372 
	`mty≥_mem°r
 (
buf
, 
MTYPE_MEMSTR_LEN
, 
möfo
.
u‹dblks
),

373 
VTY_NEWLINE
);

374 
	`vty_out
 (
vty
, " Free small blocks: %s%s",

375 
	`mty≥_mem°r
 (
buf
, 
MTYPE_MEMSTR_LEN
, 
möfo
.
fsmblks
),

376 
VTY_NEWLINE
);

377 
	`vty_out
 (
vty
, " Free ordinary blocks: %s%s",

378 
	`mty≥_mem°r
 (
buf
, 
MTYPE_MEMSTR_LEN
, 
möfo
.
f‹dblks
),

379 
VTY_NEWLINE
);

380 
	`vty_out
 (
vty
, " Ordinary blocks: %ld%s",

381 ()
möfo
.
‹dblks
,

382 
VTY_NEWLINE
);

383 
	`vty_out
 (
vty
, " Small blocks: %ld%s",

384 ()
möfo
.
smblks
,

385 
VTY_NEWLINE
);

386 
	`vty_out
 (
vty
, " Holding blocks: %ld%s",

387 ()
möfo
.
hblks
,

388 
VTY_NEWLINE
);

389 
	`vty_out
 (
vty
, "(see system documentation for 'mallinfo' for meaning)%s",

390 
VTY_NEWLINE
);

392 
	}
}

395 
DEFUN
 (
show_mem‹y_Æl
,

396 
show_mem‹y_Æl_cmd
,

402 
mli°
 *
	gml
;

403 
	g√ed£p
 = 0;

405 #ifde‡
HAVE_MALLINFO


406 
	g√ed£p
 = 
show_mem‹y_mÆlöfo
 (
vty
);

409 
	gml
 = 
mli°s
; ml->
	gli°
; ml++)

411 i‡(
	g√ed£p
)

412 
show_£∑øt‹
 (
vty
);

413 
	g√ed£p
 = 
show_mem‹y_vty
 (
vty
, 
ml
->
li°
);

416  
	gCMD_SUCCESS
;

419 
ALIAS
 (
show_mem‹y_Æl
,

420 
show_mem‹y_cmd
,

425 
DEFUN
 (
show_mem‹y_lib
,

426 
show_mem‹y_lib_cmd
,

428 
SHOW_STR


432 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_lib
);

433  
	gCMD_SUCCESS
;

436 
DEFUN
 (
show_mem‹y_zebø
,

437 
show_mem‹y_zebø_cmd
,

439 
SHOW_STR


443 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_zebø
);

444  
	gCMD_SUCCESS
;

447 
DEFUN
 (
show_mem‹y_rù
,

448 
show_mem‹y_rù_cmd
,

450 
SHOW_STR


454 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_rù
);

455  
	gCMD_SUCCESS
;

458 
DEFUN
 (
show_mem‹y_rùng
,

459 
show_mem‹y_rùng_cmd
,

461 
SHOW_STR


465 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_rùng
);

466  
	gCMD_SUCCESS
;

469 
DEFUN
 (
show_mem‹y_babñ
,

470 
show_mem‹y_babñ_cmd
,

472 
SHOW_STR


476 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_babñ
);

477  
	gCMD_SUCCESS
;

480 
DEFUN
 (
show_mem‹y_bgp
,

481 
show_mem‹y_bgp_cmd
,

483 
SHOW_STR


487 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_bgp
);

488  
	gCMD_SUCCESS
;

491 
DEFUN
 (
show_mem‹y_o•f
,

492 
show_mem‹y_o•f_cmd
,

494 
SHOW_STR


498 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_o•f
);

499  
	gCMD_SUCCESS
;

502 
DEFUN
 (
show_mem‹y_o•f6
,

503 
show_mem‹y_o•f6_cmd
,

505 
SHOW_STR


509 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_o•f6
);

510  
	gCMD_SUCCESS
;

513 
DEFUN
 (
show_mem‹y_isis
,

514 
show_mem‹y_isis_cmd
,

516 
SHOW_STR


520 
show_mem‹y_vty
 (
vty
, 
mem‹y_li°_isis
);

521  
	gCMD_SUCCESS
;

525 
	$mem‹y_öô
 ()

527 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_cmd
);

528 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_Æl_cmd
);

529 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_lib_cmd
);

530 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_rù_cmd
);

531 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_rùng_cmd
);

532 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_babñ_cmd
);

533 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_bgp_cmd
);

534 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_o•f_cmd
);

535 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_o•f6_cmd
);

536 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_mem‹y_isis_cmd
);

538 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_cmd
);

539 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_Æl_cmd
);

540 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_lib_cmd
);

541 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_rù_cmd
);

542 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_rùng_cmd
);

543 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_babñ_cmd
);

544 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_bgp_cmd
);

545 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_o•f_cmd
);

546 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_o•f6_cmd
);

547 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_mem‹y_isis_cmd
);

549 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_cmd
);

550 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_Æl_cmd
);

551 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_lib_cmd
);

552 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_zebø_cmd
);

553 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_rù_cmd
);

554 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_rùng_cmd
);

555 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_babñ_cmd
);

556 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_bgp_cmd
);

557 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_o•f_cmd
);

558 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_o•f6_cmd
);

559 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_mem‹y_isis_cmd
);

560 
	}
}

571 
	$mty≥_mem°r
 (*
buf
, 
size_t
 
Àn
, 
byãs
)

573 
t
, 
g
, 
m
, 
k
;

576 i‡(!
byãs
)

578 i‡(
byãs
 == 1)

584 
t
 = 
byãs
 >> ( () >= 8 ? 40 : 0);

586 
t
 = 0;

587 
g
 = 
byãs
 >> 30;

588 
m
 = 
byãs
 >> 20;

589 
k
 = 
byãs
 >> 10;

591 i‡(
t
 > 10)

597 i‡(
byãs
 & (1UL << ( () >= 8 ? 39 : 0)))

598 
t
++;

599 
	`¢¥ötf
 (
buf
, 
Àn
, "%4d TiB", 
t
);

601 i‡(
g
 > 10)

603 i‡(
byãs
 & (1 << 29))

604 
g
++;

605 
	`¢¥ötf
 (
buf
, 
Àn
, "%d GiB", 
g
);

607 i‡(
m
 > 10)

609 i‡(
byãs
 & (1 << 19))

610 
m
++;

611 
	`¢¥ötf
 (
buf
, 
Àn
, "%d MiB", 
m
);

613 i‡(
k
 > 10)

615 i‡(
byãs
 & (1 << 9))

616 
k
++;

617 
	`¢¥ötf
 (
buf
, 
Àn
, "%d KiB", 
k
);

620 
	`¢¥ötf
 (
buf
, 
Àn
, "%ld byãs", 
byãs
);

622  
buf
;

623 
	}
}

626 
	$mty≥_°©s_Æloc
 (
ty≥
)

628  
m°©
[
ty≥
].
Æloc
;

629 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memory.h

21 #i‚de‡
_ZEBRA_MEMORY_H


22 
	#_ZEBRA_MEMORY_H


	)

24 
	#¨øy_size
(
¨
Ë(◊rË/ ◊r[0]))

	)

27 
	smem‹y_li°


29 
	mödex
;

30 c⁄° *
	mf‹m©
;

33 
	smli°
 {

34 
mem‹y_li°
 *
	mli°
;

35 c⁄° *
	m«me
;

38 
	~"lib/memty≥s.h
"

40 
mli°
 
mli°s
[];

43 #ifde‡
MEMORY_LOG


44 
	#XMALLOC
(
mty≥
, 
size
) \

45 
	`mty≥_zmÆloc
 (
__FILE__
, 
__LINE__
, (
mty≥
), (
size
))

	)

46 
	#XCALLOC
(
mty≥
, 
size
) \

47 
	`mty≥_zˇŒoc
 (
__FILE__
, 
__LINE__
, (
mty≥
), (
size
))

	)

48 
	#XREALLOC
(
mty≥
, 
±r
, 
size
) \

49 
	`mty≥_zªÆloc
 (
__FILE__
, 
__LINE__
, (
mty≥
), (
±r
), (
size
))

	)

50 
	#XFREE
(
mty≥
, 
±r
) \

52 
	`mty≥_z‰ì
 (
__FILE__
, 
__LINE__
, (
mty≥
), (
±r
)); \

53 
±r
 = 
NULL
; } \

54 0)

	)

55 
	#XSTRDUP
(
mty≥
, 
°r
) \

56 
	`mty≥_z°rdup
 (
__FILE__
, 
__LINE__
, (
mty≥
), (
°r
))

	)

58 
	#XMALLOC
(
mty≥
, 
size
Ë
	`zmÆloc
 ((mty≥), (size))

	)

59 
	#XCALLOC
(
mty≥
, 
size
Ë
	`zˇŒoc
 ((mty≥), (size))

	)

60 
	#XREALLOC
(
mty≥
, 
±r
, 
size
Ë
	`zªÆloc
 ((mty≥), (±r), (size))

	)

61 
	#XFREE
(
mty≥
, 
±r
) do { \

62 
	`z‰ì
 ((
mty≥
), (
±r
)); \

63 
±r
 = 
NULL
; } \

64 0)

	)

65 
	#XSTRDUP
(
mty≥
, 
°r
Ë
	`z°rdup
 ((mty≥), (°r))

	)

69 *
zmÆloc
 (
ty≥
, 
size_t
 
size
);

70 *
zˇŒoc
 (
ty≥
, 
size_t
 
size
);

71 *
zªÆloc
 (
ty≥
, *
±r
, 
size_t
 
size
);

72 
z‰ì
 (
ty≥
, *
±r
);

73 *
z°rdup
 (
ty≥
, c⁄° *
°r
);

75 *
mty≥_zmÆloc
 (c⁄° *
fûe
, 
löe
, 
ty≥
, 
size_t
 
size
);

77 *
mty≥_zˇŒoc
 (c⁄° *
fûe
, 
löe
, 
ty≥
, 
size_t
 
size
);

79 *
mty≥_zªÆloc
 (c⁄° *
fûe
, 
löe
, 
ty≥
, *
±r
,

80 
size_t
 
size
);

82 
mty≥_z‰ì
 (c⁄° *
fûe
, 
löe
, 
ty≥
,

83 *
±r
);

85 *
mty≥_z°rdup
 (c⁄° *
fûe
, 
löe
, 
ty≥
,

86 c⁄° *
°r
);

87 
mem‹y_öô
 ();

88 
log_mem°©s_°dîr
 (const *);

91 
mty≥_°©s_Æloc
 ();

94 
	#MTYPE_MEMSTR_LEN
 20

	)

95 c⁄° *
mty≥_mem°r
 (*, 
size_t
, );

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memtypes.c

10 
	~"zebø.h
"

11 
	~"mem‹y.h
"

13 
mem‹y_li°
 
	gmem‹y_li°_lib
[] =

15 { 
MTYPE_TMP
, "Temporary memory" },

16 { 
MTYPE_STRVEC
, "String vector" },

17 { 
MTYPE_VECTOR
, "Vector" },

18 { 
MTYPE_VECTOR_INDEX
, "Vector index" },

19 { 
MTYPE_LINK_LIST
, "Link List" },

20 { 
MTYPE_LINK_NODE
, "Link Node" },

21 { 
MTYPE_THREAD
, "Thread" },

22 { 
MTYPE_THREAD_MASTER
, "Thread master" },

23 { 
MTYPE_THREAD_STATS
, "Thread stats" },

24 { 
MTYPE_VTY
, "VTY" },

25 { 
MTYPE_VTY_OUT_BUF
, "VTY output buffer" },

26 { 
MTYPE_VTY_HIST
, "VTY history" },

27 { 
MTYPE_IF
, "Interface" },

28 { 
MTYPE_CONNECTED
, "Connected" },

29 { 
MTYPE_CONNECTED_LABEL
, "Connected interfaceÜabel" },

30 { 
MTYPE_BUFFER
, "Buffer" },

31 { 
MTYPE_BUFFER_DATA
, "Buffer data" },

32 { 
MTYPE_STREAM
, "Stream" },

33 { 
MTYPE_STREAM_DATA
, "Stream data" },

34 { 
MTYPE_STREAM_FIFO
, "Stream FIFO" },

35 { 
MTYPE_PREFIX
, "Prefix" },

36 { 
MTYPE_PREFIX_IPV4
, "Prefix IPv4" },

37 { 
MTYPE_PREFIX_IPV6
, "Prefix IPv6" },

38 { 
MTYPE_HASH
, "Hash" },

39 { 
MTYPE_HASH_BACKET
, "Hash Bucket" },

40 { 
MTYPE_HASH_INDEX
, "Hash Index" },

41 { 
MTYPE_ROUTE_TABLE
, "RouteÅable" },

42 { 
MTYPE_ROUTE_NODE
, "RouteÇode" },

43 { 
MTYPE_DISTRIBUTE
, "DistributeÜist" },

44 { 
MTYPE_DISTRIBUTE_IFNAME
, "Dist-list ifname" },

45 { 
MTYPE_ACCESS_LIST
, "Access List" },

46 { 
MTYPE_ACCESS_LIST_STR
, "Access List Str" },

47 { 
MTYPE_ACCESS_FILTER
, "Access Filter" },

48 { 
MTYPE_PREFIX_LIST
, "Prefix List" },

49 { 
MTYPE_PREFIX_LIST_ENTRY
, "Prefix List Entry" },

50 { 
MTYPE_PREFIX_LIST_STR
, "Prefix List Str" },

51 { 
MTYPE_ROUTE_MAP
, "Route map" },

52 { 
MTYPE_ROUTE_MAP_NAME
, "Route mapÇame" },

53 { 
MTYPE_ROUTE_MAP_INDEX
, "Route map index" },

54 { 
MTYPE_ROUTE_MAP_RULE
, "Route mapÑule" },

55 { 
MTYPE_ROUTE_MAP_RULE_STR
, "Route mapÑule str" },

56 { 
MTYPE_ROUTE_MAP_COMPILED
, "Route map compiled" },

57 { 
MTYPE_DESC
, "Command desc" },

58 { 
MTYPE_KEY
, "Key" },

59 { 
MTYPE_KEYCHAIN
, "Key chain" },

60 { 
MTYPE_IF_RMAP
, "InterfaceÑoute map" },

61 { 
MTYPE_IF_RMAP_NAME
, "I.f.Ñoute mapÇame", },

62 { 
MTYPE_SOCKUNION
, "Socket union" },

63 { 
MTYPE_PRIVS
, "Privilege information" },

64 { 
MTYPE_ZLOG
, "Logging" },

65 { 
MTYPE_ZCLIENT
, "Zclient" },

66 { 
MTYPE_WORK_QUEUE
, "Work queue" },

67 { 
MTYPE_WORK_QUEUE_ITEM
, "Work queue item" },

68 { 
MTYPE_WORK_QUEUE_NAME
, "Work queueÇame string" },

69 { 
MTYPE_PQUEUE
, "Priority queue" },

70 { 
MTYPE_PQUEUE_DATA
, "Priority queue data" },

71 { 
MTYPE_HOST
, "Host config" },

72 { -1, 
NULL
 },

75 
mem‹y_li°
 
	gmem‹y_li°_zebø
[] =

77 { 
MTYPE_RTADV_PREFIX
, "Router Advertisement Prefix" },

78 { 
MTYPE_VRF
, "VRF" },

79 { 
MTYPE_VRF_NAME
, "VRFÇame" },

80 { 
MTYPE_NEXTHOP
, "Nexthop" },

81 { 
MTYPE_RIB
, "RIB" },

82 { 
MTYPE_RIB_QUEUE
, "RIBÖrocess work queue" },

83 { 
MTYPE_STATIC_IPV4
, "Static IPv4Ñoute" },

84 { 
MTYPE_STATIC_IPV6
, "Static IPv6Ñoute" },

85 { 
MTYPE_RIB_DEST
, "RIB destination" },

86 { 
MTYPE_RIB_TABLE_INFO
, "RIBÅable info" },

87 { -1, 
NULL
 },

90 
mem‹y_li°
 
	gmem‹y_li°_bgp
[] =

92 { 
MTYPE_BGP
, "BGP instance" },

93 { 
MTYPE_BGP_LISTENER
, "BGPÜisten socket details" },

94 { 
MTYPE_BGP_PEER
, "BGPÖeer" },

95 { 
MTYPE_BGP_PEER_HOST
, "BGPÖeer hostname" },

96 { 
MTYPE_PEER_GROUP
, "Peer group" },

97 { 
MTYPE_PEER_DESC
, "Peer description" },

98 { 
MTYPE_PEER_PASSWORD
, "PeerÖassword string" },

99 { 
MTYPE_ATTR
, "BGPáttribute" },

100 { 
MTYPE_ATTR_EXTRA
, "BGPÉxtraáttributes" },

101 { 
MTYPE_AS_PATH
, "BGPáspath" },

102 { 
MTYPE_AS_SEG
, "BGPáspath seg" },

103 { 
MTYPE_AS_SEG_DATA
, "BGPáspath segment data" },

104 { 
MTYPE_AS_STR
, "BGPáspath str" },

105 { 0, 
NULL
 },

106 { 
MTYPE_BGP_TABLE
, "BGPÅable" },

107 { 
MTYPE_BGP_NODE
, "BGPÇode" },

108 { 
MTYPE_BGP_ROUTE
, "BGPÑoute" },

109 { 
MTYPE_BGP_ROUTE_EXTRA
, "BGPáncillaryÑoute info" },

110 { 
MTYPE_BGP_CONN
, "BGP connected" },

111 { 
MTYPE_BGP_STATIC
, "BGP static" },

112 { 
MTYPE_BGP_ADVERTISE_ATTR
, "BGPádváttr" },

113 { 
MTYPE_BGP_ADVERTISE
, "BGPádv" },

114 { 
MTYPE_BGP_SYNCHRONISE
, "BGP synchronise" },

115 { 
MTYPE_BGP_ADJ_IN
, "BGPádj in" },

116 { 
MTYPE_BGP_ADJ_OUT
, "BGPádj out" },

117 { 
MTYPE_BGP_MPATH_INFO
, "BGP multipath info" },

118 { 0, 
NULL
 },

119 { 
MTYPE_AS_LIST
, "BGP ASÜist" },

120 { 
MTYPE_AS_FILTER
, "BGP AS filter" },

121 { 
MTYPE_AS_FILTER_STR
, "BGP AS filter str" },

122 { 0, 
NULL
 },

123 { 
MTYPE_COMMUNITY
, "community" },

124 { 
MTYPE_COMMUNITY_VAL
, "community val" },

125 { 
MTYPE_COMMUNITY_STR
, "community str" },

126 { 0, 
NULL
 },

127 { 
MTYPE_ECOMMUNITY
, "extcommunity" },

128 { 
MTYPE_ECOMMUNITY_VAL
, "extcommunity val" },

129 { 
MTYPE_ECOMMUNITY_STR
, "extcommunity str" },

130 { 0, 
NULL
 },

131 { 
MTYPE_COMMUNITY_LIST
, "community-list" },

132 { 
MTYPE_COMMUNITY_LIST_NAME
, "community-listÇame" },

133 { 
MTYPE_COMMUNITY_LIST_ENTRY
, "community-listÉntry" },

134 { 
MTYPE_COMMUNITY_LIST_CONFIG
, "community-list config" },

135 { 
MTYPE_COMMUNITY_LIST_HANDLER
, "community-list handler" },

136 { 0, 
NULL
 },

137 { 
MTYPE_CLUSTER
, "ClusterÜist" },

138 { 
MTYPE_CLUSTER_VAL
, "ClusterÜist val" },

139 { 0, 
NULL
 },

140 { 
MTYPE_BGP_PROCESS_QUEUE
, "BGP Process queue" },

141 { 
MTYPE_BGP_CLEAR_NODE_QUEUE
, "BGPÇode clear queue" },

142 { 0, 
NULL
 },

143 { 
MTYPE_TRANSIT
, "BGPÅransitáttr" },

144 { 
MTYPE_TRANSIT_VAL
, "BGPÅransit val" },

145 { 0, 
NULL
 },

146 { 
MTYPE_BGP_DISTANCE
, "BGP distance" },

147 { 
MTYPE_BGP_NEXTHOP_CACHE
, "BGPÇexthop" },

148 { 
MTYPE_BGP_CONFED_LIST
, "BGP confedÜist" },

149 { 
MTYPE_PEER_UPDATE_SOURCE
, "BGPÖeer update interface" },

150 { 
MTYPE_BGP_DAMP_INFO
, "Dampening info" },

151 { 
MTYPE_BGP_DAMP_ARRAY
, "BGP Dampeningárray" },

152 { 
MTYPE_BGP_REGEXP
, "BGPÑegexp" },

153 { 
MTYPE_BGP_AGGREGATE
, "BGPággregate" },

154 { 
MTYPE_BGP_ADDR
, "BGP ownáddress" },

155 #ifde‡
USE_SRX


156 { 0, 
NULL
 },

157 { 
MTYPE_SRX_HOST
, "SRx hostÇame" },

158 { 
MTYPE_SRX_SCA_CAPI
, "SRx Crypto API" },

159 { 
MTYPE_SRX_SCA_CAPI
, "BGPSEC Signature" },

160 { 
MTYPE_BGP_INFO_HASH
, "BGP info hash" },

161 { 
MTYPE_BGP_INFO_HASH_ITEM
, "BGP info hash item" },

162 { 
MTYPE_BGP_INFO_HASH_MUTEX
, ""},

163 { 
MTYPE_BGPSEC_SIGNATURE
, "BGPSEC signature"},

164 { 
MTYPE_BGPSEC_PATH
, "BGPSEC PATH structure"},

165 { 
MTYPE_BGPSEC_PATH_SEG
, "BGPSEC PATH segment" },

166 { 
MTYPE_BGPSEC_SIG_SEG
, "Signal segment"},

167 { 
MTYPE_BGPSEC_SIG_BLK
, "Signal block"},

169 { -1, 
NULL
 }

172 
mem‹y_li°
 
	gmem‹y_li°_rù
[] =

174 { 
MTYPE_RIP
, "RIP structure" },

175 { 
MTYPE_RIP_INFO
, "RIPÑoute info" },

176 { 
MTYPE_RIP_INTERFACE
, "RIP interface" },

177 { 
MTYPE_RIP_PEER
, "RIPÖeer" },

178 { 
MTYPE_RIP_OFFSET_LIST
, "RIP offsetÜist" },

179 { 
MTYPE_RIP_DISTANCE
, "RIP distance" },

180 { -1, 
NULL
 }

183 
mem‹y_li°
 
	gmem‹y_li°_rùng
[] =

185 { 
MTYPE_RIPNG
, "RIPng structure" },

186 { 
MTYPE_RIPNG_ROUTE
, "RIPngÑoute info" },

187 { 
MTYPE_RIPNG_AGGREGATE
, "RIPngággregate" },

188 { 
MTYPE_RIPNG_PEER
, "RIPngÖeer" },

189 { 
MTYPE_RIPNG_OFFSET_LIST
, "RIPng offsetÜst" },

190 { 
MTYPE_RIPNG_RTE_DATA
, "RIPngÑte data" },

191 { -1, 
NULL
 }

194 
mem‹y_li°
 
	gmem‹y_li°_babñ
[] =

196 { 
MTYPE_BABEL
, "Babel structure" },

197 { 
MTYPE_BABEL_IF
, "Babel interface" },

198 { -1, 
NULL
 }

201 
mem‹y_li°
 
	gmem‹y_li°_o•f
[] =

203 { 
MTYPE_OSPF_TOP
, "OSPFÅop" },

204 { 
MTYPE_OSPF_AREA
, "OSPFárea" },

205 { 
MTYPE_OSPF_AREA_RANGE
, "OSPFáreaÑange" },

206 { 
MTYPE_OSPF_NETWORK
, "OSPFÇetwork" },

207 { 
MTYPE_OSPF_NEIGHBOR_STATIC
,"OSPF staticÇbr" },

208 { 
MTYPE_OSPF_IF
, "OSPF interface" },

209 { 
MTYPE_OSPF_NEIGHBOR
, "OSPFÇeighbor" },

210 { 
MTYPE_OSPF_ROUTE
, "OSPFÑoute" },

211 { 
MTYPE_OSPF_TMP
, "OSPFÅmp mem" },

212 { 
MTYPE_OSPF_LSA
, "OSPF LSA" },

213 { 
MTYPE_OSPF_LSA_DATA
, "OSPF LSA data" },

214 { 
MTYPE_OSPF_LSDB
, "OSPF LSDB" },

215 { 
MTYPE_OSPF_PACKET
, "OSPFÖacket" },

216 { 
MTYPE_OSPF_FIFO
, "OSPF FIFO queue" },

217 { 
MTYPE_OSPF_VERTEX
, "OSPF vertex" },

218 { 
MTYPE_OSPF_VERTEX_PARENT
, "OSPF vertexÖarent", },

219 { 
MTYPE_OSPF_NEXTHOP
, "OSPFÇexthop" },

220 { 
MTYPE_OSPF_PATH
, "OSPFÖath" },

221 { 
MTYPE_OSPF_VL_DATA
, "OSPF VL data" },

222 { 
MTYPE_OSPF_CRYPT_KEY
, "OSPF crypt key" },

223 { 
MTYPE_OSPF_EXTERNAL_INFO
, "OSPFÉxt. info" },

224 { 
MTYPE_OSPF_DISTANCE
, "OSPF distance" },

225 { 
MTYPE_OSPF_IF_INFO
, "OSPF if info" },

226 { 
MTYPE_OSPF_IF_PARAMS
, "OSPF ifÖarams" },

227 { 
MTYPE_OSPF_MESSAGE
, "OSPF message" },

228 { -1, 
NULL
 },

231 
mem‹y_li°
 
	gmem‹y_li°_o•f6
[] =

233 { 
MTYPE_OSPF6_TOP
, "OSPF6Åop" },

234 { 
MTYPE_OSPF6_AREA
, "OSPF6área" },

235 { 
MTYPE_OSPF6_IF
, "OSPF6 interface" },

236 { 
MTYPE_OSPF6_NEIGHBOR
, "OSPF6Çeighbor" },

237 { 
MTYPE_OSPF6_ROUTE
, "OSPF6Ñoute" },

238 { 
MTYPE_OSPF6_PREFIX
, "OSPF6Örefix" },

239 { 
MTYPE_OSPF6_MESSAGE
, "OSPF6 message" },

240 { 
MTYPE_OSPF6_LSA
, "OSPF6 LSA" },

241 { 
MTYPE_OSPF6_LSA_SUMMARY
, "OSPF6 LSA summary" },

242 { 
MTYPE_OSPF6_LSDB
, "OSPF6 LSA database" },

243 { 
MTYPE_OSPF6_VERTEX
, "OSPF6 vertex" },

244 { 
MTYPE_OSPF6_SPFTREE
, "OSPF6 SPFÅree" },

245 { 
MTYPE_OSPF6_NEXTHOP
, "OSPF6Çexthop" },

246 { 
MTYPE_OSPF6_EXTERNAL_INFO
,"OSPF6Éxt. info" },

247 { 
MTYPE_OSPF6_OTHER
, "OSPF6 other" },

248 { -1, 
NULL
 },

251 
mem‹y_li°
 
	gmem‹y_li°_isis
[] =

253 { 
MTYPE_ISIS
, "ISIS" },

254 { 
MTYPE_ISIS_TMP
, "ISIS TMP" },

255 { 
MTYPE_ISIS_CIRCUIT
, "ISIS circuit" },

256 { 
MTYPE_ISIS_LSP
, "ISIS LSP" },

257 { 
MTYPE_ISIS_ADJACENCY
, "ISISádjacency" },

258 { 
MTYPE_ISIS_AREA
, "ISISárea" },

259 { 
MTYPE_ISIS_AREA_ADDR
, "ISISáreaáddress" },

260 { 
MTYPE_ISIS_TLV
, "ISIS TLV" },

261 { 
MTYPE_ISIS_DYNHN
, "ISIS dyn hostname" },

262 { 
MTYPE_ISIS_SPFTREE
, "ISIS SPFtree" },

263 { 
MTYPE_ISIS_VERTEX
, "ISIS vertex" },

264 { 
MTYPE_ISIS_ROUTE_INFO
, "ISISÑoute info" },

265 { 
MTYPE_ISIS_NEXTHOP
, "ISISÇexthop" },

266 { 
MTYPE_ISIS_NEXTHOP6
, "ISISÇexthop6" },

267 { 
MTYPE_ISIS_DICT
, "ISIS dictionary" },

268 { 
MTYPE_ISIS_DICT_NODE
, "ISIS dictionaryÇode" },

269 { -1, 
NULL
 },

272 
mem‹y_li°
 
	gmem‹y_li°_vtysh
[] =

274 { 
MTYPE_VTYSH_CONFIG
, "Vtysh configuration", },

275 { 
MTYPE_VTYSH_CONFIG_LINE
, "Vtysh configurationÜine" },

276 { -1, 
NULL
 },

279 
mli°
 
	gmli°s
[] 
__©åibuã__
 ((
unu£d
)) = {

280 { 
mem‹y_li°_lib
, "LIB" },

281 { 
mem‹y_li°_zebø
, "ZEBRA" },

282 { 
mem‹y_li°_rù
, "RIP" },

283 { 
mem‹y_li°_rùng
, "RIPNG" },

284 { 
mem‹y_li°_o•f
, "OSPF" },

285 { 
mem‹y_li°_o•f6
, "OSPF6" },

286 { 
mem‹y_li°_isis
, "ISIS" },

287 { 
mem‹y_li°_bgp
, "BGP" },

288 { 
NULL
, NULL},

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memtypes.h

4 #i‚de‡
_QUAGGA_MEMTYPES_H


5 
	#_QUAGGA_MEMTYPES_H


	)

9 
	mMTYPE_TMP
 = 1,

10 
	mMTYPE_STRVEC
,

11 
	mMTYPE_VECTOR
,

12 
	mMTYPE_VECTOR_INDEX
,

13 
	mMTYPE_LINK_LIST
,

14 
	mMTYPE_LINK_NODE
,

15 
	mMTYPE_THREAD
,

16 
	mMTYPE_THREAD_MASTER
,

17 
	mMTYPE_THREAD_STATS
,

18 
	mMTYPE_VTY
,

19 
	mMTYPE_VTY_OUT_BUF
,

20 
	mMTYPE_VTY_HIST
,

21 
	mMTYPE_IF
,

22 
	mMTYPE_CONNECTED
,

23 
	mMTYPE_CONNECTED_LABEL
,

24 
	mMTYPE_BUFFER
,

25 
	mMTYPE_BUFFER_DATA
,

26 
	mMTYPE_STREAM
,

27 
	mMTYPE_STREAM_DATA
,

28 
	mMTYPE_STREAM_FIFO
,

29 
	mMTYPE_PREFIX
,

30 
	mMTYPE_PREFIX_IPV4
,

31 
	mMTYPE_PREFIX_IPV6
,

32 
	mMTYPE_HASH
,

33 
	mMTYPE_HASH_BACKET
,

34 
	mMTYPE_HASH_INDEX
,

35 
	mMTYPE_ROUTE_TABLE
,

36 
	mMTYPE_ROUTE_NODE
,

37 
	mMTYPE_DISTRIBUTE
,

38 
	mMTYPE_DISTRIBUTE_IFNAME
,

39 
	mMTYPE_ACCESS_LIST
,

40 
	mMTYPE_ACCESS_LIST_STR
,

41 
	mMTYPE_ACCESS_FILTER
,

42 
	mMTYPE_PREFIX_LIST
,

43 
	mMTYPE_PREFIX_LIST_ENTRY
,

44 
	mMTYPE_PREFIX_LIST_STR
,

45 
	mMTYPE_ROUTE_MAP
,

46 
	mMTYPE_ROUTE_MAP_NAME
,

47 
	mMTYPE_ROUTE_MAP_INDEX
,

48 
	mMTYPE_ROUTE_MAP_RULE
,

49 
	mMTYPE_ROUTE_MAP_RULE_STR
,

50 
	mMTYPE_ROUTE_MAP_COMPILED
,

51 
	mMTYPE_DESC
,

52 
	mMTYPE_KEY
,

53 
	mMTYPE_KEYCHAIN
,

54 
	mMTYPE_IF_RMAP
,

55 
	mMTYPE_IF_RMAP_NAME
,

56 
	mMTYPE_SOCKUNION
,

57 
	mMTYPE_PRIVS
,

58 
	mMTYPE_ZLOG
,

59 
	mMTYPE_ZCLIENT
,

60 
	mMTYPE_WORK_QUEUE
,

61 
	mMTYPE_WORK_QUEUE_ITEM
,

62 
	mMTYPE_WORK_QUEUE_NAME
,

63 
	mMTYPE_PQUEUE
,

64 
	mMTYPE_PQUEUE_DATA
,

65 
	mMTYPE_HOST
,

66 
	mMTYPE_RTADV_PREFIX
,

67 
	mMTYPE_VRF
,

68 
	mMTYPE_VRF_NAME
,

69 
	mMTYPE_NEXTHOP
,

70 
	mMTYPE_RIB
,

71 
	mMTYPE_RIB_QUEUE
,

72 
	mMTYPE_STATIC_IPV4
,

73 
	mMTYPE_STATIC_IPV6
,

74 
	mMTYPE_RIB_DEST
,

75 
	mMTYPE_RIB_TABLE_INFO
,

76 
	mMTYPE_BGP
,

77 
	mMTYPE_BGP_LISTENER
,

78 
	mMTYPE_BGP_PEER
,

79 
	mMTYPE_BGP_PEER_HOST
,

80 
	mMTYPE_PEER_GROUP
,

81 
	mMTYPE_PEER_DESC
,

82 
	mMTYPE_PEER_PASSWORD
,

83 
	mMTYPE_ATTR
,

84 
	mMTYPE_ATTR_EXTRA
,

85 
	mMTYPE_AS_PATH
,

86 
	mMTYPE_AS_SEG
,

87 
	mMTYPE_AS_SEG_DATA
,

88 
	mMTYPE_AS_STR
,

89 
	mMTYPE_BGP_TABLE
,

90 
	mMTYPE_BGP_NODE
,

91 
	mMTYPE_BGP_ROUTE
,

92 
	mMTYPE_BGP_ROUTE_EXTRA
,

93 
	mMTYPE_BGP_CONN
,

94 
	mMTYPE_BGP_STATIC
,

95 
	mMTYPE_BGP_ADVERTISE_ATTR
,

96 
	mMTYPE_BGP_ADVERTISE
,

97 
	mMTYPE_BGP_SYNCHRONISE
,

98 
	mMTYPE_BGP_ADJ_IN
,

99 
	mMTYPE_BGP_ADJ_OUT
,

100 
	mMTYPE_BGP_MPATH_INFO
,

101 
	mMTYPE_AS_LIST
,

102 
	mMTYPE_AS_FILTER
,

103 
	mMTYPE_AS_FILTER_STR
,

104 
	mMTYPE_COMMUNITY
,

105 
	mMTYPE_COMMUNITY_VAL
,

106 
	mMTYPE_COMMUNITY_STR
,

107 
	mMTYPE_ECOMMUNITY
,

108 
	mMTYPE_ECOMMUNITY_VAL
,

109 
	mMTYPE_ECOMMUNITY_STR
,

110 
	mMTYPE_COMMUNITY_LIST
,

111 
	mMTYPE_COMMUNITY_LIST_NAME
,

112 
	mMTYPE_COMMUNITY_LIST_ENTRY
,

113 
	mMTYPE_COMMUNITY_LIST_CONFIG
,

114 
	mMTYPE_COMMUNITY_LIST_HANDLER
,

115 
	mMTYPE_CLUSTER
,

116 
	mMTYPE_CLUSTER_VAL
,

117 
	mMTYPE_BGP_PROCESS_QUEUE
,

118 
	mMTYPE_BGP_CLEAR_NODE_QUEUE
,

119 
	mMTYPE_TRANSIT
,

120 
	mMTYPE_TRANSIT_VAL
,

121 
	mMTYPE_BGP_DISTANCE
,

122 
	mMTYPE_BGP_NEXTHOP_CACHE
,

123 
	mMTYPE_BGP_CONFED_LIST
,

124 
	mMTYPE_PEER_UPDATE_SOURCE
,

125 
	mMTYPE_BGP_DAMP_INFO
,

126 
	mMTYPE_BGP_DAMP_ARRAY
,

127 
	mMTYPE_BGP_REGEXP
,

128 
	mMTYPE_BGP_AGGREGATE
,

129 
	mMTYPE_BGP_ADDR
,

130 #ifde‡
USE_SRX


131 
	mMTYPE_SRX_HOST
,

132 
	mMTYPE_SRX_SCA_CAPI
,

133 
	mMTYPE_BGP_INFO_HASH
,

134 
	mMTYPE_BGP_INFO_HASH_ITEM
,

136 
	mMTYPE_BGP_INFO_HASH_MUTEX
,

137 
	mMTYPE_BGPSEC_PATH
,

138 
	mMTYPE_BGPSEC_SIGNATURE
,

139 
	mMTYPE_BGPSEC_PATH_SEG
,

140 
	mMTYPE_BGPSEC_SIG_SEG
,

141 
	mMTYPE_BGPSEC_SIG_BLK
,

143 
	mMTYPE_RIP
,

144 
	mMTYPE_RIP_INFO
,

145 
	mMTYPE_RIP_INTERFACE
,

146 
	mMTYPE_RIP_PEER
,

147 
	mMTYPE_RIP_OFFSET_LIST
,

148 
	mMTYPE_RIP_DISTANCE
,

149 
	mMTYPE_RIPNG
,

150 
	mMTYPE_RIPNG_ROUTE
,

151 
	mMTYPE_RIPNG_AGGREGATE
,

152 
	mMTYPE_RIPNG_PEER
,

153 
	mMTYPE_RIPNG_OFFSET_LIST
,

154 
	mMTYPE_RIPNG_RTE_DATA
,

155 
	mMTYPE_BABEL
,

156 
	mMTYPE_BABEL_IF
,

157 
	mMTYPE_OSPF_TOP
,

158 
	mMTYPE_OSPF_AREA
,

159 
	mMTYPE_OSPF_AREA_RANGE
,

160 
	mMTYPE_OSPF_NETWORK
,

161 
	mMTYPE_OSPF_NEIGHBOR_STATIC
,

162 
	mMTYPE_OSPF_IF
,

163 
	mMTYPE_OSPF_NEIGHBOR
,

164 
	mMTYPE_OSPF_ROUTE
,

165 
	mMTYPE_OSPF_TMP
,

166 
	mMTYPE_OSPF_LSA
,

167 
	mMTYPE_OSPF_LSA_DATA
,

168 
	mMTYPE_OSPF_LSDB
,

169 
	mMTYPE_OSPF_PACKET
,

170 
	mMTYPE_OSPF_FIFO
,

171 
	mMTYPE_OSPF_VERTEX
,

172 
	mMTYPE_OSPF_VERTEX_PARENT
,

173 
	mMTYPE_OSPF_NEXTHOP
,

174 
	mMTYPE_OSPF_PATH
,

175 
	mMTYPE_OSPF_VL_DATA
,

176 
	mMTYPE_OSPF_CRYPT_KEY
,

177 
	mMTYPE_OSPF_EXTERNAL_INFO
,

178 
	mMTYPE_OSPF_DISTANCE
,

179 
	mMTYPE_OSPF_IF_INFO
,

180 
	mMTYPE_OSPF_IF_PARAMS
,

181 
	mMTYPE_OSPF_MESSAGE
,

182 
	mMTYPE_OSPF6_TOP
,

183 
	mMTYPE_OSPF6_AREA
,

184 
	mMTYPE_OSPF6_IF
,

185 
	mMTYPE_OSPF6_NEIGHBOR
,

186 
	mMTYPE_OSPF6_ROUTE
,

187 
	mMTYPE_OSPF6_PREFIX
,

188 
	mMTYPE_OSPF6_MESSAGE
,

189 
	mMTYPE_OSPF6_LSA
,

190 
	mMTYPE_OSPF6_LSA_SUMMARY
,

191 
	mMTYPE_OSPF6_LSDB
,

192 
	mMTYPE_OSPF6_VERTEX
,

193 
	mMTYPE_OSPF6_SPFTREE
,

194 
	mMTYPE_OSPF6_NEXTHOP
,

195 
	mMTYPE_OSPF6_EXTERNAL_INFO
,

196 
	mMTYPE_OSPF6_OTHER
,

197 
	mMTYPE_ISIS
,

198 
	mMTYPE_ISIS_TMP
,

199 
	mMTYPE_ISIS_CIRCUIT
,

200 
	mMTYPE_ISIS_LSP
,

201 
	mMTYPE_ISIS_ADJACENCY
,

202 
	mMTYPE_ISIS_AREA
,

203 
	mMTYPE_ISIS_AREA_ADDR
,

204 
	mMTYPE_ISIS_TLV
,

205 
	mMTYPE_ISIS_DYNHN
,

206 
	mMTYPE_ISIS_SPFTREE
,

207 
	mMTYPE_ISIS_VERTEX
,

208 
	mMTYPE_ISIS_ROUTE_INFO
,

209 
	mMTYPE_ISIS_NEXTHOP
,

210 
	mMTYPE_ISIS_NEXTHOP6
,

211 
	mMTYPE_ISIS_DICT
,

212 
	mMTYPE_ISIS_DICT_NODE
,

213 
	mMTYPE_VTYSH_CONFIG
,

214 
	mMTYPE_VTYSH_CONFIG_LINE
,

215 
	mMTYPE_MAX
,

218 
mem‹y_li°
 
mem‹y_li°_lib
[];

219 
mem‹y_li°
 
mem‹y_li°_zebø
[];

220 
mem‹y_li°
 
mem‹y_li°_bgp
[];

221 
mem‹y_li°
 
mem‹y_li°_rù
[];

222 
mem‹y_li°
 
mem‹y_li°_rùng
[];

223 
mem‹y_li°
 
mem‹y_li°_babñ
[];

224 
mem‹y_li°
 
mem‹y_li°_o•f
[];

225 
mem‹y_li°
 
mem‹y_li°_o•f6
[];

226 
mem‹y_li°
 
mem‹y_li°_isis
[];

227 
mem‹y_li°
 
mem‹y_li°_vtysh
[];

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/network.c

23 
	~<zebø.h
>

24 
	~"log.h
"

25 
	~"√tw‹k.h
"

29 
	$ªadn
 (
fd
, 
u_ch¨
 *
±r
, 
nbyãs
)

31 
∆e·
;

32 
ƒód
;

34 
∆e·
 = 
nbyãs
;

36 
∆e·
 > 0)

38 
ƒód
 = 
	`ªad
 (
fd
, 
±r
, 
∆e·
);

40 i‡(
ƒód
 < 0)

41  (
ƒód
);

43 i‡(
ƒód
 == 0)

46 
∆e·
 -
ƒód
;

47 
±r
 +
ƒód
;

50  
nbyãs
 - 
∆e·
;

51 
	}
}

55 
	$wrôí
(
fd
, c⁄° 
u_ch¨
 *
±r
, 
nbyãs
)

57 
∆e·
;

58 
nwrôãn
;

60 
∆e·
 = 
nbyãs
;

62 
∆e·
 > 0)

64 
nwrôãn
 = 
	`wrôe
(
fd
, 
±r
, 
∆e·
);

66 i‡(
nwrôãn
 <= 0)

67  (
nwrôãn
);

69 
∆e·
 -
nwrôãn
;

70 
±r
 +
nwrôãn
;

72  
nbyãs
 - 
∆e·
;

73 
	}
}

76 
	$£t_n⁄blockög
(
fd
)

78 
Êags
;

82 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
)) < 0)

84 
	`zlog_w¨n
("fcntl(F_GETFL) failed for fd %d: %s",

85 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

88 i‡(
	`f˙é
(
fd
, 
F_SETFL
, (
Êags
 | 
O_NONBLOCK
)) < 0)

90 
	`zlog_w¨n
("fcntl failed setting fd %dÇon-blocking: %s",

91 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

95 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/network.h

23 #i‚de‡
_ZEBRA_NETWORK_H


24 
	#_ZEBRA_NETWORK_H


	)

29 
ªadn
 (, 
u_ch¨
 *, );

30 
wrôí
 (, c⁄° 
u_ch¨
 *, );

34 
£t_n⁄blockög
(
fd
);

37 
	#ERRNO_IO_RETRY
(
EN
) \

38 (((
EN
Ë=
EAGAIN
Ë|| ((ENË=
EWOULDBLOCK
Ë|| ((ENË=
EINTR
))

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/pid_output.c

23 
	~<zebø.h
>

24 
	~<f˙é.h
>

25 
	~<log.h
>

26 
	~"vîsi⁄.h
"

28 
	#PIDFILE_MASK
 0644

	)

29 #i‚de‡
HAVE_FCNTL


31 
pid_t


32 
	$pid_ouçut
 (c⁄° *
∑th
)

34 
FILE
 *
Â
;

35 
pid_t
 
pid
;

36 
mode_t
 
ﬁdumask
;

38 
pid
 = 
	`gëpid
();

40 
ﬁdumask
 = 
	`umask
(0777 & ~
PIDFILE_MASK
);

41 
Â
 = 
	`f›í
 (
∑th
, "w");

42 i‡(
Â
 !
NULL
)

44 
	`Ârötf
 (
Â
, "%d\n", (Ë
pid
);

45 
	`f˛o£
 (
Â
);

46 
	`umask
(
ﬁdumask
);

47  
pid
;

51 
	`zlog_w¨n
("Can't fopenÖidÜock file %s (%s), continuing",

52 
∑th
, 
	`ß„_°ªº‹
(
î∫o
));

53 
	`umask
(
ﬁdumask
);

55 
	}
}

59 
pid_t


60 
	$pid_ouçut
 (c⁄° *
∑th
)

62 
tmp
;

63 
fd
;

64 
pid_t
 
pid
;

65 
buf
[16];

66 
Êock
 
lock
;

67 
mode_t
 
ﬁdumask
;

69 
pid
 = 
	`gëpid
 ();

71 
ﬁdumask
 = 
	`umask
(0777 & ~
PIDFILE_MASK
);

72 
fd
 = 
	`›í
 (
∑th
, 
O_RDWR
 | 
O_CREAT
, 
PIDFILE_MASK
);

73 i‡(
fd
 < 0)

75 
	`zlog_îr
("Can't createÖidÜock file %s (%s),Éxiting",

76 
∑th
, 
	`ß„_°ªº‹
(
î∫o
));

77 
	`umask
(
ﬁdumask
);

78 
	`exô
(1);

82 
size_t
 
pidsize
;

84 
	`umask
(
ﬁdumask
);

85 
	`mem£t
 (&
lock
, 0, (lock));

87 
lock
.
l_ty≥
 = 
F_WRLCK
;

88 
lock
.
l_whí˚
 = 
SEEK_SET
;

90 i‡(
	`f˙é
(
fd
, 
F_SETLK
, &
lock
) < 0)

92 
	`zlog_îr
("CouldÇŸÜockÖid_fûê%s,Éxôög", 
∑th
);

93 
	`exô
(1);

96 
	`•rötf
 (
buf
, "%d\n", (Ë
pid
);

97 
pidsize
 = 
	`°æí
(
buf
);

98 i‡((
tmp
 = 
	`wrôe
 (
fd
, 
buf
, 
pidsize
)) != ()pidsize)

99 
	`zlog_îr
("CouldÇot writeÖid %dÅoÖid_file %s,Ñc was %d: %s",

100 ()
pid
,
∑th
,
tmp
,
	`ß„_°ªº‹
(
î∫o
));

101 i‡(
	`·runˇã
(
fd
, 
pidsize
) < 0)

102 
	`zlog_îr
("CouldÇotÅruncateÖid_file %sÅo %u bytes: %s",

103 
∑th
,(
u_öt
)
pidsize
,
	`ß„_°ªº‹
(
î∫o
));

105  
pid
;

106 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/plist.c

22 
	~<zebø.h
>

24 
	~"¥efix.h
"

25 
	~"comm™d.h
"

26 
	~"mem‹y.h
"

27 
	~"∂i°.h
"

28 
	~"sockuni⁄.h
"

29 
	~"buf„r.h
"

30 
	~"°ªam.h
"

31 
	~"log.h
"

34 
	s¥efix_li°_íåy


36 
	m£q
;

38 
	mÀ
;

39 
	mge
;

41 
¥efix_li°_ty≥
 
	mty≥
;

43 
	m™y
;

44 
¥efix
 
	m¥efix
;

46 
	mªf˙t
;

47 
	mhô˙t
;

49 
¥efix_li°_íåy
 *
	m√xt
;

50 
¥efix_li°_íåy
 *
	m¥ev
;

54 
	s¥efix_li°_li°


56 
¥efix_li°
 *
	mhód
;

57 
¥efix_li°
 *
	mèû
;

61 
	s¥efix_ma°î


64 
¥efix_li°_li°
 
	mnum
;

67 
¥efix_li°_li°
 
	m°r
;

70 
	m£qnum
;

73 
¥efix_li°
 *
	mª˚¡
;

76 (*
	madd_hook
Ë(
	m¥efix_li°
 *);

79 (*
	mdñëe_hook
Ë(
	m¥efix_li°
 *);

83 
¥efix_ma°î
 
	g¥efix_ma°î_ùv4
 =

85 {
NULL
, NULL},

86 {
NULL
, NULL},

88 
NULL
,

89 
NULL
,

92 #ifde‡
HAVE_IPV6


94 
¥efix_ma°î
 
	g¥efix_ma°î_ùv6
 =

96 {
NULL
, NULL},

97 {
NULL
, NULL},

99 
NULL
,

100 
NULL
,

105 
¥efix_ma°î
 
	g¥efix_ma°î_‹f
 =

107 {
NULL
, NULL},

108 {
NULL
, NULL},

110 
NULL
,

111 
NULL
,

114 
¥efix_ma°î
 *

115 
	$¥efix_ma°î_gë
 (
afi_t
 
afi
)

117 i‡(
afi
 =
AFI_IP
)

118  &
¥efix_ma°î_ùv4
;

119 #ifde‡
HAVE_IPV6


120 i‡(
afi
 =
AFI_IP6
)

121  &
¥efix_ma°î_ùv6
;

123 i‡(
afi
 =
AFI_ORF_PREFIX
)

124  &
¥efix_ma°î_‹f
;

125  
NULL
;

126 
	}
}

129 
¥efix_li°
 *

130 
	$¥efix_li°_lookup
 (
afi_t
 
afi
, c⁄° *
«me
)

132 
¥efix_li°
 *
∂i°
;

133 
¥efix_ma°î
 *
ma°î
;

135 i‡(
«me
 =
NULL
)

136  
NULL
;

138 
ma°î
 = 
	`¥efix_ma°î_gë
 (
afi
);

139 i‡(
ma°î
 =
NULL
)

140  
NULL
;

142 
∂i°
 = 
ma°î
->
num
.
hód
;Öli°;Öli° =Öli°->
√xt
)

143 i‡(
	`°rcmp
 (
∂i°
->
«me
,Çame) == 0)

144  
∂i°
;

146 
∂i°
 = 
ma°î
->
°r
.
hód
;Öli°;Öli° =Öli°->
√xt
)

147 i‡(
	`°rcmp
 (
∂i°
->
«me
,Çame) == 0)

148  
∂i°
;

150  
NULL
;

151 
	}
}

153 
¥efix_li°
 *

154 
	$¥efix_li°_√w
 ()

156 
¥efix_li°
 *
√w
;

158 
√w
 = 
	`XCALLOC
 (
MTYPE_PREFIX_LIST
,  (
¥efix_li°
));

159  
√w
;

160 
	}
}

163 
	$¥efix_li°_‰ì
 (
¥efix_li°
 *
∂i°
)

165 
	`XFREE
 (
MTYPE_PREFIX_LIST
, 
∂i°
);

166 
	}
}

168 
¥efix_li°_íåy
 *

169 
	$¥efix_li°_íåy_√w
 ()

171 
¥efix_li°_íåy
 *
√w
;

173 
√w
 = 
	`XCALLOC
 (
MTYPE_PREFIX_LIST_ENTRY
,  (
¥efix_li°_íåy
));

174  
√w
;

175 
	}
}

178 
	$¥efix_li°_íåy_‰ì
 (
¥efix_li°_íåy
 *
≥¡ry
)

180 
	`XFREE
 (
MTYPE_PREFIX_LIST_ENTRY
, 
≥¡ry
);

181 
	}
}

185 
¥efix_li°
 *

186 
	$¥efix_li°_ö£π
 (
afi_t
 
afi
, c⁄° *
«me
)

188 
i
;

189 
numbî
;

190 
¥efix_li°
 *
∂i°
;

191 
¥efix_li°
 *
poöt
;

192 
¥efix_li°_li°
 *
li°
;

193 
¥efix_ma°î
 *
ma°î
;

195 
ma°î
 = 
	`¥efix_ma°î_gë
 (
afi
);

196 i‡(
ma°î
 =
NULL
)

197  
NULL
;

200 
∂i°
 = 
	`¥efix_li°_√w
 ();

201 
∂i°
->
«me
 = 
	`XSTRDUP
 (
MTYPE_PREFIX_LIST_STR
,Çame);

202 
∂i°
->
ma°î
 = master;

206 
numbî
 = 0, 
i
 = 0; i < 
	`°æí
 (
«me
); i++)

208 i‡(
	`isdigô
 ((Ë
«me
[
i
]))

209 
numbî
 = (numbî * 10Ë+ (
«me
[
i
] - '0');

215 i‡(
i
 =
	`°æí
 (
«me
))

217 
∂i°
->
ty≥
 = 
PREFIX_TYPE_NUMBER
;

220 
li°
 = &
ma°î
->
num
;

222 
poöt
 = 
li°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

223 i‡(
	`©ﬁ
 (
poöt
->
«me
Ë>
numbî
)

228 
∂i°
->
ty≥
 = 
PREFIX_TYPE_STRING
;

231 
li°
 = &
ma°î
->
°r
;

234 
poöt
 = 
li°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

235 i‡(
	`°rcmp
 (
poöt
->
«me
,Çame) >= 0)

240 i‡(
li°
->
hód
 =
NULL
)

242 
li°
->
hód
 =Üi°->
èû
 = 
∂i°
;

243  
∂i°
;

247 i‡(
poöt
 =
NULL
)

249 
∂i°
->
¥ev
 = 
li°
->
èû
;

250 
li°
->
èû
->
√xt
 = 
∂i°
;

251 
li°
->
èû
 = 
∂i°
;

252  
∂i°
;

256 i‡(
poöt
 =
li°
->
hód
)

258 
∂i°
->
√xt
 = 
li°
->
hód
;

259 
li°
->
hód
->
¥ev
 = 
∂i°
;

260 
li°
->
hód
 = 
∂i°
;

261  
∂i°
;

265 
∂i°
->
√xt
 = 
poöt
;

266 
∂i°
->
¥ev
 = 
poöt
->prev;

268 i‡(
poöt
->
¥ev
)

269 
poöt
->
¥ev
->
√xt
 = 
∂i°
;

270 
poöt
->
¥ev
 = 
∂i°
;

272  
∂i°
;

273 
	}
}

275 
¥efix_li°
 *

276 
	$¥efix_li°_gë
 (
afi_t
 
afi
, c⁄° *
«me
)

278 
¥efix_li°
 *
∂i°
;

280 
∂i°
 = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

282 i‡(
∂i°
 =
NULL
)

283 
∂i°
 = 
	`¥efix_li°_ö£π
 (
afi
, 
«me
);

284  
∂i°
;

285 
	}
}

289 
	$¥efix_li°_dñëe
 (
¥efix_li°
 *
∂i°
)

291 
¥efix_li°_li°
 *
li°
;

292 
¥efix_ma°î
 *
ma°î
;

293 
¥efix_li°_íåy
 *
≥¡ry
;

294 
¥efix_li°_íåy
 *
√xt
;

297 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy = 
√xt
)

299 
√xt
 = 
≥¡ry
->next;

300 
	`¥efix_li°_íåy_‰ì
 (
≥¡ry
);

301 
∂i°
->
cou¡
--;

304 
ma°î
 = 
∂i°
->master;

306 i‡(
∂i°
->
ty≥
 =
PREFIX_TYPE_NUMBER
)

307 
li°
 = &
ma°î
->
num
;

309 
li°
 = &
ma°î
->
°r
;

311 i‡(
∂i°
->
√xt
)

312 
∂i°
->
√xt
->
¥ev
 =Ölist->prev;

314 
li°
->
èû
 = 
∂i°
->
¥ev
;

316 i‡(
∂i°
->
¥ev
)

317 
∂i°
->
¥ev
->
√xt
 =Ölist->next;

319 
li°
->
hód
 = 
∂i°
->
√xt
;

321 i‡(
∂i°
->
desc
)

322 
	`XFREE
 (
MTYPE_TMP
, 
∂i°
->
desc
);

326 
ma°î
->
ª˚¡
 = 
NULL
;

328 i‡(
∂i°
->
«me
)

329 
	`XFREE
 (
MTYPE_PREFIX_LIST_STR
, 
∂i°
->
«me
);

331 
	`¥efix_li°_‰ì
 (
∂i°
);

333 i‡(
ma°î
->
dñëe_hook
)

334 (*
ma°î
->
dñëe_hook
Ë(
NULL
);

335 
	}
}

337 
¥efix_li°_íåy
 *

338 
	$¥efix_li°_íåy_make
 (
¥efix
 *¥efix, 
¥efix_li°_ty≥
 
ty≥
,

339 
£q
, 
À
, 
ge
, 
™y
)

341 
¥efix_li°_íåy
 *
≥¡ry
;

343 
≥¡ry
 = 
	`¥efix_li°_íåy_√w
 ();

345 i‡(
™y
)

346 
≥¡ry
->
™y
 = 1;

348 
	`¥efix_c›y
 (&
≥¡ry
->
¥efix
,Örefix);

349 
≥¡ry
->
ty≥
 =Åype;

350 
≥¡ry
->
£q
 = seq;

351 
≥¡ry
->
À
 =Üe;

352 
≥¡ry
->
ge
 = ge;

354  
≥¡ry
;

355 
	}
}

359 
¥efix_li°_add_hook
 ((*
func
Ë(
¥efix_li°
 *
∂i°
))

361 
¥efix_ma°î_ùv4
.
add_hook
 = 
func
;

362 #ifde‡
HAVE_IPV6


363 
¥efix_ma°î_ùv6
.
add_hook
 = 
func
;

365 
	}
}

369 
¥efix_li°_dñëe_hook
 ((*
func
Ë(
¥efix_li°
 *
∂i°
))

371 
¥efix_ma°î_ùv4
.
dñëe_hook
 = 
func
;

372 #ifde‡
HAVE_IPV6


373 
¥efix_ma°î_ùv6
.
dñëe_hook
 = 
func
;

375 
	}
}

379 
	$¥efix_√w_£q_gë
 (
¥efix_li°
 *
∂i°
)

381 
max£q
;

382 
√w£q
;

383 
¥efix_li°_íåy
 *
≥¡ry
;

385 
max£q
 = 
√w£q
 = 0;

387 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

389 i‡(
max£q
 < 
≥¡ry
->
£q
)

390 
max£q
 = 
≥¡ry
->
£q
;

393 
√w£q
 = ((
max£q
 / 5) * 5) + 5;

395  
√w£q
;

396 
	}
}

399 
¥efix_li°_íåy
 *

400 
	$¥efix_£q_check
 (
¥efix_li°
 *
∂i°
, 
£q
)

402 
¥efix_li°_íåy
 *
≥¡ry
;

404 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

405 i‡(
≥¡ry
->
£q
 == seq)

406  
≥¡ry
;

407  
NULL
;

408 
	}
}

410 
¥efix_li°_íåy
 *

411 
	$¥efix_li°_íåy_lookup
 (
¥efix_li°
 *
∂i°
, 
¥efix
 *prefix,

412 
¥efix_li°_ty≥
 
ty≥
, 
£q
, 
À
, 
ge
)

414 
¥efix_li°_íåy
 *
≥¡ry
;

416 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

417 i‡(
	`¥efix_ßme
 (&
≥¡ry
->
¥efix
,ÖªfixË&&Öíåy->
ty≥
 ==Åype)

419 i‡(
£q
 >0 && 
≥¡ry
->seq != seq)

422 i‡(
≥¡ry
->
À
 !=Üe)

424 i‡(
≥¡ry
->
ge
 != ge)

427  
≥¡ry
;

430  
NULL
;

431 
	}
}

434 
	$¥efix_li°_íåy_dñëe
 (
¥efix_li°
 *
∂i°
,

435 
¥efix_li°_íåy
 *
≥¡ry
,

436 
upd©e_li°
)

438 i‡(
∂i°
 =
NULL
 || 
≥¡ry
 == NULL)

440 i‡(
≥¡ry
->
¥ev
)

441 
≥¡ry
->
¥ev
->
√xt
 =Öentry->next;

443 
∂i°
->
hód
 = 
≥¡ry
->
√xt
;

444 i‡(
≥¡ry
->
√xt
)

445 
≥¡ry
->
√xt
->
¥ev
 =Öentry->prev;

447 
∂i°
->
èû
 = 
≥¡ry
->
¥ev
;

449 
	`¥efix_li°_íåy_‰ì
 (
≥¡ry
);

451 
∂i°
->
cou¡
--;

453 i‡(
upd©e_li°
)

455 i‡(
∂i°
->
ma°î
->
dñëe_hook
)

456 (*
∂i°
->
ma°î
->
dñëe_hook
) (plist);

458 i‡(
∂i°
->
hód
 =
NULL
 &&Öli°->
èû
 =NULL &&Öli°->
desc
 == NULL)

459 
	`¥efix_li°_dñëe
 (
∂i°
);

461 
∂i°
->
ma°î
->
ª˚¡
 =Ölist;

463 
	}
}

466 
	$¥efix_li°_íåy_add
 (
¥efix_li°
 *
∂i°
,

467 
¥efix_li°_íåy
 *
≥¡ry
)

469 
¥efix_li°_íåy
 *
ª∂a˚
;

470 
¥efix_li°_íåy
 *
poöt
;

473 i‡(
≥¡ry
->
£q
 == -1)

474 
≥¡ry
->
£q
 = 
	`¥efix_√w_£q_gë
 (
∂i°
);

477 
ª∂a˚
 = 
	`¥efix_£q_check
 (
∂i°
, 
≥¡ry
->
£q
);

478 i‡(
ª∂a˚
)

479 
	`¥efix_li°_íåy_dñëe
 (
∂i°
, 
ª∂a˚
, 0);

482 
poöt
 = 
∂i°
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

483 i‡(
poöt
->
£q
 >
≥¡ry
->seq)

487 
≥¡ry
->
√xt
 = 
poöt
;

489 i‡(
poöt
)

491 i‡(
poöt
->
¥ev
)

492 
poöt
->
¥ev
->
√xt
 = 
≥¡ry
;

494 
∂i°
->
hód
 = 
≥¡ry
;

496 
≥¡ry
->
¥ev
 = 
poöt
->prev;

497 
poöt
->
¥ev
 = 
≥¡ry
;

501 i‡(
∂i°
->
èû
)

502 
∂i°
->
èû
->
√xt
 = 
≥¡ry
;

504 
∂i°
->
hód
 = 
≥¡ry
;

506 
≥¡ry
->
¥ev
 = 
∂i°
->
èû
;

507 
∂i°
->
èû
 = 
≥¡ry
;

511 
∂i°
->
cou¡
++;

514 i‡(
∂i°
->
ma°î
->
add_hook
)

515 (*
∂i°
->
ma°î
->
add_hook
) (plist);

517 
∂i°
->
ma°î
->
ª˚¡
 =Ölist;

518 
	}
}

522 
	$¥efix_li°_ty≥_°r
 (
¥efix_li°_íåy
 *
≥¡ry
)

524 
≥¡ry
->
ty≥
)

526 
PREFIX_PERMIT
:

528 
PREFIX_DENY
:

533 
	}
}

536 
	$¥efix_li°_íåy_m©ch
 (
¥efix_li°_íåy
 *
≥¡ry
, 
¥efix
 *
p
)

538 
ªt
;

540 
ªt
 = 
	`¥efix_m©ch
 (&
≥¡ry
->
¥efix
, 
p
);

541 i‡(! 
ªt
)

545 i‡(! 
≥¡ry
->
À
 && !Öíåy->
ge
)

547 i‡(
≥¡ry
->
¥efix
.
¥efixÀn
 !
p
->prefixlen)

552 i‡(
≥¡ry
->
À
)

553 i‡(
p
->
¥efixÀn
 > 
≥¡ry
->
À
)

556 i‡(
≥¡ry
->
ge
)

557 i‡(
p
->
¥efixÀn
 < 
≥¡ry
->
ge
)

561 
	}
}

563 
¥efix_li°_ty≥


564 
	$¥efix_li°_≠∂y
 (
¥efix_li°
 *
∂i°
, *
obje˘
)

566 
¥efix_li°_íåy
 *
≥¡ry
;

567 
¥efix
 *
p
;

569 
p
 = (
¥efix
 *Ë
obje˘
;

571 i‡(
∂i°
 =
NULL
)

572  
PREFIX_DENY
;

574 i‡(
∂i°
->
cou¡
 == 0)

575  
PREFIX_PERMIT
;

577 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

579 
≥¡ry
->
ªf˙t
++;

580 i‡(
	`¥efix_li°_íåy_m©ch
 (
≥¡ry
, 
p
))

582 
≥¡ry
->
hô˙t
++;

583  
≥¡ry
->
ty≥
;

587  
PREFIX_DENY
;

588 
	}
}

590 
__©åibuã__
 ((
unu£d
))

591 
	$¥efix_li°_¥öt
 (
¥efix_li°
 *
∂i°
)

593 
¥efix_li°_íåy
 *
≥¡ry
;

595 i‡(
∂i°
 =
NULL
)

598 
	`¥ötf
 ("ùÖªfix-li° %s: %dÉ¡rõs\n", 
∂i°
->
«me
,Öli°->
cou¡
);

600 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

602 i‡(
≥¡ry
->
™y
)

603 
	`¥ötf
 ("™y %s\n", 
	`¥efix_li°_ty≥_°r
 (
≥¡ry
));

606 
¥efix
 *
p
;

607 
buf
[
BUFSIZ
];

609 
p
 = &
≥¡ry
->
¥efix
;

611 
	`¥ötf
 (" seq %d %s %s/%d",

612 
≥¡ry
->
£q
,

613 
	`¥efix_li°_ty≥_°r
 (
≥¡ry
),

614 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

615 
p
->
¥efixÀn
);

616 i‡(
≥¡ry
->
ge
)

617 
	`¥ötf
 (" gê%d", 
≥¡ry
->
ge
);

618 i‡(
≥¡ry
->
À
)

619 
	`¥ötf
 ("Üê%d", 
≥¡ry
->
À
);

620 
	`¥ötf
 ("\n");

623 
	}
}

626 
¥efix_li°_íåy
 *

627 
	$¥efix_íåy_dup_check
 (
¥efix_li°
 *
∂i°
,

628 
¥efix_li°_íåy
 *
√w
)

630 
¥efix_li°_íåy
 *
≥¡ry
;

631 
£q
 = 0;

633 i‡(
√w
->
£q
 == -1)

634 
£q
 = 
	`¥efix_√w_£q_gë
 (
∂i°
);

636 
£q
 = 
√w
->seq;

638 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

640 i‡(
	`¥efix_ßme
 (&
≥¡ry
->
¥efix
, &
√w
->prefix)

641 && 
≥¡ry
->
ty≥
 =
√w
->type

642 && 
≥¡ry
->
À
 =
√w
->le

643 && 
≥¡ry
->
ge
 =
√w
->ge

644 && 
≥¡ry
->
£q
 != seq)

645  
≥¡ry
;

647  
NULL
;

648 
	}
}

651 
	$vty_övÆid_¥efix_ønge
 (
vty
 *vty, c⁄° *
¥efix
)

653 
	`vty_out
 (
vty
, "%% InvalidÖrefixÑange for %s, make sure:Üen < ge-value <=Üe-value%s",

654 
¥efix
, 
VTY_NEWLINE
);

655  
CMD_WARNING
;

656 
	}
}

659 
	$vty_¥efix_li°_ö°Æl
 (
vty
 *vty, 
afi_t
 
afi
, c⁄° *
«me
,

660 c⁄° *
£q
, c⁄° *
ty≥°r
,

661 c⁄° *
¥efix
, c⁄° *
ge
, c⁄° *
À
)

663 
ªt
;

664 
¥efix_li°_ty≥
 
ty≥
;

665 
¥efix_li°
 *
∂i°
;

666 
¥efix_li°_íåy
 *
≥¡ry
;

667 
¥efix_li°_íåy
 *
dup
;

668 
¥efix
 
p
;

669 
™y
 = 0;

670 
£qnum
 = -1;

671 
Ànum
 = 0;

672 
gíum
 = 0;

675 i‡(
£q
)

676 
£qnum
 = 
	`©oi
 (
£q
);

679 i‡(
ge
)

680 
gíum
 = 
	`©oi
 (
ge
);

681 i‡(
À
)

682 
Ànum
 = 
	`©oi
 (
À
);

685 i‡(
	`°∫cmp
 ("≥rmô", 
ty≥°r
, 1) == 0)

686 
ty≥
 = 
PREFIX_PERMIT
;

687 i‡(
	`°∫cmp
 ("díy", 
ty≥°r
, 1) == 0)

688 
ty≥
 = 
PREFIX_DENY
;

691 
	`vty_out
 (
vty
, "%%ÖªfixÅy≥ mu° bê≥rmô o∏díy%s", 
VTY_NEWLINE
);

692  
CMD_WARNING
;

696 i‡(
afi
 =
AFI_IP
)

698 i‡(
	`°∫cmp
 ("™y", 
¥efix
, 
	`°æí
 (prefix)) == 0)

700 
ªt
 = 
	`°r2¥efix_ùv4
 ("0.0.0.0/0", (
¥efix_ùv4
 *Ë&
p
);

701 
gíum
 = 0;

702 
Ànum
 = 
IPV4_MAX_BITLEN
;

703 
™y
 = 1;

706 
ªt
 = 
	`°r2¥efix_ùv4
 (
¥efix
, (
¥efix_ùv4
 *Ë&
p
);

708 i‡(
ªt
 <= 0)

710 
	`vty_out
 (
vty
, "%% MÆf‹med IPv4Öªfix%s", 
VTY_NEWLINE
);

711  
CMD_WARNING
;

714 #ifde‡
HAVE_IPV6


715 i‡(
afi
 =
AFI_IP6
)

717 i‡(
	`°∫cmp
 ("™y", 
¥efix
, 
	`°æí
 (prefix)) == 0)

719 
ªt
 = 
	`°r2¥efix_ùv6
 ("::/0", (
¥efix_ùv6
 *Ë&
p
);

720 
gíum
 = 0;

721 
Ànum
 = 
IPV6_MAX_BITLEN
;

722 
™y
 = 1;

725 
ªt
 = 
	`°r2¥efix_ùv6
 (
¥efix
, (
¥efix_ùv6
 *Ë&
p
);

727 i‡(
ªt
 <= 0)

729 
	`vty_out
 (
vty
, "%% MÆf‹med IPv6Öªfix%s", 
VTY_NEWLINE
);

730  
CMD_WARNING
;

736 i‡(
gíum
 && gíum <
p
.
¥efixÀn
)

737  
	`vty_övÆid_¥efix_ønge
 (
vty
, 
¥efix
);

739 i‡(
Ànum
 &&Üíum <
p
.
¥efixÀn
)

740  
	`vty_övÆid_¥efix_ønge
 (
vty
, 
¥efix
);

742 i‡(
Ànum
 && 
gíum
 >Üenum)

743  
	`vty_övÆid_¥efix_ønge
 (
vty
, 
¥efix
);

745 i‡(
gíum
 && 
Ànum
 =(
afi
 =
AFI_IP
 ? 32 : 128))

746 
Ànum
 = 0;

749 
∂i°
 = 
	`¥efix_li°_gë
 (
afi
, 
«me
);

752 
≥¡ry
 = 
	`¥efix_li°_íåy_make
 (&
p
, 
ty≥
, 
£qnum
, 
Ànum
, 
gíum
, 
™y
);

755 
dup
 = 
	`¥efix_íåy_dup_check
 (
∂i°
, 
≥¡ry
);

757 i‡(
dup
)

759 
	`¥efix_li°_íåy_‰ì
 (
≥¡ry
);

760 
	`vty_out
 (
vty
, "%% Insertion failed -Örefix-listÉntryÉxists:%s",

761 
VTY_NEWLINE
);

762 
	`vty_out
 (
vty
, " seq %d %†%s", 
dup
->
£q
, 
ty≥°r
, 
¥efix
);

763 i‡(! 
™y
 && 
gíum
)

764 
	`vty_out
 (
vty
, " gê%d", 
gíum
);

765 i‡(! 
™y
 && 
Ànum
)

766 
	`vty_out
 (
vty
, "Üê%d", 
Ànum
);

767 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

768  
CMD_WARNING
;

772 
	`¥efix_li°_íåy_add
 (
∂i°
, 
≥¡ry
);

774  
CMD_SUCCESS
;

775 
	}
}

778 
	$vty_¥efix_li°_unö°Æl
 (
vty
 *vty, 
afi_t
 
afi
, c⁄° *
«me
,

779 c⁄° *
£q
, c⁄° *
ty≥°r
,

780 c⁄° *
¥efix
, c⁄° *
ge
, c⁄° *
À
)

782 
ªt
;

783 
¥efix_li°_ty≥
 
ty≥
;

784 
¥efix_li°
 *
∂i°
;

785 
¥efix_li°_íåy
 *
≥¡ry
;

786 
¥efix
 
p
;

787 
£qnum
 = -1;

788 
Ànum
 = 0;

789 
gíum
 = 0;

792 
∂i°
 = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

793 i‡(! 
∂i°
)

795 
	`vty_out
 (
vty
, "%% C™'àföd s≥cifõdÖªfix-li°%s", 
VTY_NEWLINE
);

796  
CMD_WARNING
;

800 i‡(
£q
 =
NULL
 && 
ty≥°r
 =NULL && 
¥efix
 == NULL &&

801 
ge
 =
NULL
 && 
À
 == NULL)

803 
	`¥efix_li°_dñëe
 (
∂i°
);

804  
CMD_SUCCESS
;

808 i‡((
ty≥°r
 =
NULL
Ë|| (
¥efix
 == NULL))

810 
	`vty_out
 (
vty
, "%% BŸhÖªfixándÅy≥Ñequúed%s", 
VTY_NEWLINE
);

811  
CMD_WARNING
;

815 i‡(
£q
)

816 
£qnum
 = 
	`©oi
 (
£q
);

819 i‡(
ge
)

820 
gíum
 = 
	`©oi
 (
ge
);

821 i‡(
À
)

822 
Ànum
 = 
	`©oi
 (
À
);

825 i‡(
	`°∫cmp
 ("≥rmô", 
ty≥°r
, 1) == 0)

826 
ty≥
 = 
PREFIX_PERMIT
;

827 i‡(
	`°∫cmp
 ("díy", 
ty≥°r
, 1) == 0)

828 
ty≥
 = 
PREFIX_DENY
;

831 
	`vty_out
 (
vty
, "%%ÖªfixÅy≥ mu° bê≥rmô o∏díy%s", 
VTY_NEWLINE
);

832  
CMD_WARNING
;

836 i‡(
afi
 =
AFI_IP
)

838 i‡(
	`°∫cmp
 ("™y", 
¥efix
, 
	`°æí
 (prefix)) == 0)

840 
ªt
 = 
	`°r2¥efix_ùv4
 ("0.0.0.0/0", (
¥efix_ùv4
 *Ë&
p
);

841 
gíum
 = 0;

842 
Ànum
 = 
IPV4_MAX_BITLEN
;

845 
ªt
 = 
	`°r2¥efix_ùv4
 (
¥efix
, (
¥efix_ùv4
 *Ë&
p
);

847 i‡(
ªt
 <= 0)

849 
	`vty_out
 (
vty
, "%% MÆf‹med IPv4Öªfix%s", 
VTY_NEWLINE
);

850  
CMD_WARNING
;

853 #ifde‡
HAVE_IPV6


854 i‡(
afi
 =
AFI_IP6
)

856 i‡(
	`°∫cmp
 ("™y", 
¥efix
, 
	`°æí
 (prefix)) == 0)

858 
ªt
 = 
	`°r2¥efix_ùv6
 ("::/0", (
¥efix_ùv6
 *Ë&
p
);

859 
gíum
 = 0;

860 
Ànum
 = 
IPV6_MAX_BITLEN
;

863 
ªt
 = 
	`°r2¥efix_ùv6
 (
¥efix
, (
¥efix_ùv6
 *Ë&
p
);

865 i‡(
ªt
 <= 0)

867 
	`vty_out
 (
vty
, "%% MÆf‹med IPv6Öªfix%s", 
VTY_NEWLINE
);

868  
CMD_WARNING
;

874 
≥¡ry
 = 
	`¥efix_li°_íåy_lookup
(
∂i°
, &
p
, 
ty≥
, 
£qnum
, 
Ànum
, 
gíum
);

876 i‡(
≥¡ry
 =
NULL
)

878 
	`vty_out
 (
vty
, "%% C™'àföd s≥cifõdÖªfix-li°%s", 
VTY_NEWLINE
);

879  
CMD_WARNING
;

883 
	`¥efix_li°_íåy_dñëe
 (
∂i°
, 
≥¡ry
, 1);

885  
CMD_SUCCESS
;

886 
	}
}

889 
	$vty_¥efix_li°_desc_un£t
 (
vty
 *vty, 
afi_t
 
afi
, c⁄° *
«me
)

891 
¥efix_li°
 *
∂i°
;

893 
∂i°
 = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

894 i‡(! 
∂i°
)

896 
	`vty_out
 (
vty
, "%% C™'àföd s≥cifõdÖªfix-li°%s", 
VTY_NEWLINE
);

897  
CMD_WARNING
;

900 i‡(
∂i°
->
desc
)

902 
	`XFREE
 (
MTYPE_TMP
, 
∂i°
->
desc
);

903 
∂i°
->
desc
 = 
NULL
;

906 i‡(
∂i°
->
hód
 =
NULL
 &&Öli°->
èû
 =NULL &&Öli°->
desc
 == NULL)

907 
	`¥efix_li°_dñëe
 (
∂i°
);

909  
CMD_SUCCESS
;

910 
	}
}

912 
	edi•œy_ty≥


914 
	mn‹mÆ_di•œy
,

915 
	msumm¨y_di•œy
,

916 
	mdëaû_di•œy
,

917 
	m£quítül_di•œy
,

918 
	ml⁄gî_di•œy
,

919 
	mfú°_m©ch_di•œy


923 
	$vty_show_¥efix_íåy
 (
vty
 *vty, 
afi_t
 
afi
, 
¥efix_li°
 *
∂i°
,

924 
¥efix_ma°î
 *
ma°î
, 
di•œy_ty≥
 
dty≥
,

925 
£qnum
)

927 
¥efix_li°_íåy
 *
≥¡ry
;

930 i‡(
zlog_deÁu…
)

931 
	`vty_out
 (
vty
, "%s: ", 
zlog_¥Ÿo_«mes
[
zlog_deÁu…
->
¥Ÿocﬁ
]);

933 i‡(
dty≥
 =
n‹mÆ_di•œy
)

935 
	`vty_out
 (
vty
, "ip%sÖrefix-list %s: %dÉntries%s",

936 
afi
 =
AFI_IP
 ? "" : "v6",

937 
∂i°
->
«me
,Öli°->
cou¡
, 
VTY_NEWLINE
);

938 i‡(
∂i°
->
desc
)

939 
	`vty_out
 (
vty
, " Des¸ùti⁄: %s%s", 
∂i°
->
desc
, 
VTY_NEWLINE
);

941 i‡(
dty≥
 =
summ¨y_di•œy
 || dty≥ =
dëaû_di•œy
)

943 
	`vty_out
 (
vty
, "ip%sÖrefix-list %s:%s",

944 
afi
 =
AFI_IP
 ? "" : "v6", 
∂i°
->
«me
, 
VTY_NEWLINE
);

946 i‡(
∂i°
->
desc
)

947 
	`vty_out
 (
vty
, " Des¸ùti⁄: %s%s", 
∂i°
->
desc
, 
VTY_NEWLINE
);

949 
	`vty_out
 (
vty
, " count: %d,ÑangeÉntries: %d, sequences: %d - %d%s",

950 
∂i°
->
cou¡
,Öli°->
øngecou¡
,

951 
∂i°
->
hód
 ?Öli°->hód->
£q
 : 0,

952 
∂i°
->
èû
 ?Öli°->èû->
£q
 : 0,

953 
VTY_NEWLINE
);

956 i‡(
dty≥
 !
summ¨y_di•œy
)

958 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

960 i‡(
dty≥
 =
£quítül_di•œy
 && 
≥¡ry
->
£q
 !
£qnum
)

963 
	`vty_out
 (
vty
, " ");

965 i‡(
ma°î
->
£qnum
)

966 
	`vty_out
 (
vty
, "£q %d ", 
≥¡ry
->
£q
);

968 
	`vty_out
 (
vty
, "%†", 
	`¥efix_li°_ty≥_°r
 (
≥¡ry
));

970 i‡(
≥¡ry
->
™y
)

971 
	`vty_out
 (
vty
, "any");

974 
¥efix
 *
p
 = &
≥¡ry
->prefix;

975 
buf
[
BUFSIZ
];

977 
	`vty_out
 (
vty
, "%s/%d",

978 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

979 
p
->
¥efixÀn
);

981 i‡(
≥¡ry
->
ge
)

982 
	`vty_out
 (
vty
, " gê%d", 
≥¡ry
->
ge
);

983 i‡(
≥¡ry
->
À
)

984 
	`vty_out
 (
vty
, "Üê%d", 
≥¡ry
->
À
);

987 i‡(
dty≥
 =
dëaû_di•œy
 || dty≥ =
£quítül_di•œy
)

988 
	`vty_out
 (
vty
, " (hit count: %ld,Ñefcount: %ld)",

989 
≥¡ry
->
hô˙t
,Öíåy->
ªf˙t
);

991 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

994 
	}
}

997 
	$vty_show_¥efix_li°
 (
vty
 *vty, 
afi_t
 
afi
, c⁄° *
«me
,

998 c⁄° *
£q
, 
di•œy_ty≥
 
dty≥
)

1000 
¥efix_li°
 *
∂i°
;

1001 
¥efix_ma°î
 *
ma°î
;

1002 
£qnum
 = 0;

1004 
ma°î
 = 
	`¥efix_ma°î_gë
 (
afi
);

1005 i‡(
ma°î
 =
NULL
)

1006  
CMD_WARNING
;

1008 i‡(
£q
)

1009 
£qnum
 = 
	`©oi
 (
£q
);

1011 i‡(
«me
)

1013 
∂i°
 = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

1014 i‡(! 
∂i°
)

1016 
	`vty_out
 (
vty
, "%% C™'àföd s≥cifõdÖªfix-li°%s", 
VTY_NEWLINE
);

1017  
CMD_WARNING
;

1019 
	`vty_show_¥efix_íåy
 (
vty
, 
afi
, 
∂i°
, 
ma°î
, 
dty≥
, 
£qnum
);

1023 i‡(
dty≥
 =
dëaû_di•œy
 || dty≥ =
summ¨y_di•œy
)

1025 i‡(
ma°î
->
ª˚¡
)

1026 
	`vty_out
 (
vty
, "Prefix-list withÅheÜast deletion/insertion: %s%s",

1027 
ma°î
->
ª˚¡
->
«me
, 
VTY_NEWLINE
);

1030 
∂i°
 = 
ma°î
->
num
.
hód
;Öli°;Öli° =Öli°->
√xt
)

1031 
	`vty_show_¥efix_íåy
 (
vty
, 
afi
, 
∂i°
, 
ma°î
, 
dty≥
, 
£qnum
);

1033 
∂i°
 = 
ma°î
->
°r
.
hód
;Öli°;Öli° =Öli°->
√xt
)

1034 
	`vty_show_¥efix_íåy
 (
vty
, 
afi
, 
∂i°
, 
ma°î
, 
dty≥
, 
£qnum
);

1037  
CMD_SUCCESS
;

1038 
	}
}

1041 
	$vty_show_¥efix_li°_¥efix
 (
vty
 *vty, 
afi_t
 
afi
, c⁄° *
«me
,

1042 c⁄° *
¥efix
, 
di•œy_ty≥
 
ty≥
)

1044 
¥efix_li°
 *
∂i°
;

1045 
¥efix_li°_íåy
 *
≥¡ry
;

1046 
¥efix
 
p
;

1047 
ªt
;

1048 
m©ch
;

1050 
∂i°
 = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

1051 i‡(! 
∂i°
)

1053 
	`vty_out
 (
vty
, "%% C™'àföd s≥cifõdÖªfix-li°%s", 
VTY_NEWLINE
);

1054  
CMD_WARNING
;

1057 
ªt
 = 
	`°r2¥efix
 (
¥efix
, &
p
);

1058 i‡(
ªt
 <= 0)

1060 
	`vty_out
 (
vty
, "%%Öªfix i†mÆf‹med%s", 
VTY_NEWLINE
);

1061  
CMD_WARNING
;

1064 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

1066 
m©ch
 = 0;

1068 i‡(
ty≥
 =
n‹mÆ_di•œy
 ||Åy≥ =
fú°_m©ch_di•œy
)

1069 i‡(
	`¥efix_ßme
 (&
p
, &
≥¡ry
->
¥efix
))

1070 
m©ch
 = 1;

1072 i‡(
ty≥
 =
l⁄gî_di•œy
)

1073 i‡(
	`¥efix_m©ch
 (&
p
, &
≥¡ry
->
¥efix
))

1074 
m©ch
 = 1;

1076 i‡(
m©ch
)

1078 
	`vty_out
 (
vty
, " seq %d %s ",

1079 
≥¡ry
->
£q
,

1080 
	`¥efix_li°_ty≥_°r
 (
≥¡ry
));

1082 i‡(
≥¡ry
->
™y
)

1083 
	`vty_out
 (
vty
, "any");

1086 
¥efix
 *
p
 = &
≥¡ry
->prefix;

1087 
buf
[
BUFSIZ
];

1089 
	`vty_out
 (
vty
, "%s/%d",

1090 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

1091 
p
->
¥efixÀn
);

1093 i‡(
≥¡ry
->
ge
)

1094 
	`vty_out
 (
vty
, " gê%d", 
≥¡ry
->
ge
);

1095 i‡(
≥¡ry
->
À
)

1096 
	`vty_out
 (
vty
, "Üê%d", 
≥¡ry
->
À
);

1099 i‡(
ty≥
 =
n‹mÆ_di•œy
 ||Åy≥ =
fú°_m©ch_di•œy
)

1100 
	`vty_out
 (
vty
, " (hit count: %ld,Ñefcount: %ld)",

1101 
≥¡ry
->
hô˙t
,Öíåy->
ªf˙t
);

1103 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1105 i‡(
ty≥
 =
fú°_m©ch_di•œy
)

1106  
CMD_SUCCESS
;

1109  
CMD_SUCCESS
;

1110 
	}
}

1113 
	$vty_˛ór_¥efix_li°
 (
vty
 *vty, 
afi_t
 
afi
, c⁄° *
«me
,

1114 c⁄° *
¥efix
)

1116 
¥efix_ma°î
 *
ma°î
;

1117 
¥efix_li°
 *
∂i°
;

1118 
¥efix_li°_íåy
 *
≥¡ry
;

1119 
ªt
;

1120 
¥efix
 
p
;

1122 
ma°î
 = 
	`¥efix_ma°î_gë
 (
afi
);

1123 i‡(
ma°î
 =
NULL
)

1124  
CMD_WARNING
;

1126 i‡(
«me
 =
NULL
 && 
¥efix
 == NULL)

1128 
∂i°
 = 
ma°î
->
num
.
hód
;Öli°;Öli° =Öli°->
√xt
)

1129 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

1130 
≥¡ry
->
hô˙t
 = 0;

1132 
∂i°
 = 
ma°î
->
°r
.
hód
;Öli°;Öli° =Öli°->
√xt
)

1133 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

1134 
≥¡ry
->
hô˙t
 = 0;

1138 
∂i°
 = 
	`¥efix_li°_lookup
 (
afi
, 
«me
);

1139 i‡(! 
∂i°
)

1141 
	`vty_out
 (
vty
, "%% C™'àföd s≥cifõdÖªfix-li°%s", 
VTY_NEWLINE
);

1142  
CMD_WARNING
;

1145 i‡(
¥efix
)

1147 
ªt
 = 
	`°r2¥efix
 (
¥efix
, &
p
);

1148 i‡(
ªt
 <= 0)

1150 
	`vty_out
 (
vty
, "%%Öªfix i†mÆf‹med%s", 
VTY_NEWLINE
);

1151  
CMD_WARNING
;

1155 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

1157 i‡(
¥efix
)

1159 i‡(
	`¥efix_m©ch
 (&
≥¡ry
->
¥efix
, &
p
))

1160 
≥¡ry
->
hô˙t
 = 0;

1163 
≥¡ry
->
hô˙t
 = 0;

1166  
CMD_SUCCESS
;

1167 
	}
}

1169 
DEFUN
 (
ù_¥efix_li°
,

1170 
ù_¥efix_li°_cmd
,

1172 
IP_STR


1173 
PREFIX_LIST_STR


1180  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,

1181 
¨gv
[1],árgv[2], 
NULL
, NULL);

1184 
DEFUN
 (
ù_¥efix_li°_ge
,

1185 
ù_¥efix_li°_ge_cmd
,

1187 
IP_STR


1188 
PREFIX_LIST_STR


1196  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1197 
¨gv
[2],árgv[3], 
NULL
);

1200 
DEFUN
 (
ù_¥efix_li°_ge_À
,

1201 
ù_¥efix_li°_ge_À_cmd
,

1203 
IP_STR


1204 
PREFIX_LIST_STR


1214  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1215 
¨gv
[2],árgv[3],árgv[4]);

1218 
DEFUN
 (
ù_¥efix_li°_À
,

1219 
ù_¥efix_li°_À_cmd
,

1221 
IP_STR


1222 
PREFIX_LIST_STR


1230  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1231 
¨gv
[2], 
NULL
,árgv[3]);

1234 
DEFUN
 (
ù_¥efix_li°_À_ge
,

1235 
ù_¥efix_li°_À_ge_cmd
,

1237 
IP_STR


1238 
PREFIX_LIST_STR


1248  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1249 
¨gv
[2],árgv[4],árgv[3]);

1252 
DEFUN
 (
ù_¥efix_li°_£q
,

1253 
ù_¥efix_li°_£q_cmd
,

1255 
IP_STR


1256 
PREFIX_LIST_STR


1265  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1266 
¨gv
[3], 
NULL
, NULL);

1269 
DEFUN
 (
ù_¥efix_li°_£q_ge
,

1270 
ù_¥efix_li°_£q_ge_cmd
,

1272 
IP_STR


1273 
PREFIX_LIST_STR


1283  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1284 
¨gv
[3],árgv[4], 
NULL
);

1287 
DEFUN
 (
ù_¥efix_li°_£q_ge_À
,

1288 
ù_¥efix_li°_£q_ge_À_cmd
,

1290 
IP_STR


1291 
PREFIX_LIST_STR


1303  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1304 
¨gv
[3],árgv[4],árgv[5]);

1307 
DEFUN
 (
ù_¥efix_li°_£q_À
,

1308 
ù_¥efix_li°_£q_À_cmd
,

1310 
IP_STR


1311 
PREFIX_LIST_STR


1321  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1322 
¨gv
[3], 
NULL
,árgv[4]);

1325 
DEFUN
 (
ù_¥efix_li°_£q_À_ge
,

1326 
ù_¥efix_li°_£q_À_ge_cmd
,

1328 
IP_STR


1329 
PREFIX_LIST_STR


1341  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1342 
¨gv
[3],árgv[5],árgv[4]);

1345 
DEFUN
 (
no_ù_¥efix_li°
,

1346 
no_ù_¥efix_li°_cmd
,

1348 
NO_STR


1349 
IP_STR


1350 
PREFIX_LIST_STR


1353  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
, NULL,

1354 
NULL
, NULL, NULL);

1357 
DEFUN
 (
no_ù_¥efix_li°_¥efix
,

1358 
no_ù_¥efix_li°_¥efix_cmd
,

1360 
NO_STR


1361 
IP_STR


1362 
PREFIX_LIST_STR


1369  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1370 
¨gv
[2], 
NULL
, NULL);

1373 
DEFUN
 (
no_ù_¥efix_li°_ge
,

1374 
no_ù_¥efix_li°_ge_cmd
,

1376 
NO_STR


1377 
IP_STR


1378 
PREFIX_LIST_STR


1386  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1387 
¨gv
[2],árgv[3], 
NULL
);

1390 
DEFUN
 (
no_ù_¥efix_li°_ge_À
,

1391 
no_ù_¥efix_li°_ge_À_cmd
,

1393 
NO_STR


1394 
IP_STR


1395 
PREFIX_LIST_STR


1405  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1406 
¨gv
[2],árgv[3],árgv[4]);

1409 
DEFUN
 (
no_ù_¥efix_li°_À
,

1410 
no_ù_¥efix_li°_À_cmd
,

1412 
NO_STR


1413 
IP_STR


1414 
PREFIX_LIST_STR


1422  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1423 
¨gv
[2], 
NULL
,árgv[3]);

1426 
DEFUN
 (
no_ù_¥efix_li°_À_ge
,

1427 
no_ù_¥efix_li°_À_ge_cmd
,

1429 
NO_STR


1430 
IP_STR


1431 
PREFIX_LIST_STR


1441  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
,árgv[1],

1442 
¨gv
[2],árgv[4],árgv[3]);

1445 
DEFUN
 (
no_ù_¥efix_li°_£q
,

1446 
no_ù_¥efix_li°_£q_cmd
,

1448 
NO_STR


1449 
IP_STR


1450 
PREFIX_LIST_STR


1459  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1460 
¨gv
[3], 
NULL
, NULL);

1463 
DEFUN
 (
no_ù_¥efix_li°_£q_ge
,

1464 
no_ù_¥efix_li°_£q_ge_cmd
,

1466 
NO_STR


1467 
IP_STR


1468 
PREFIX_LIST_STR


1478  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1479 
¨gv
[3],árgv[4], 
NULL
);

1482 
DEFUN
 (
no_ù_¥efix_li°_£q_ge_À
,

1483 
no_ù_¥efix_li°_£q_ge_À_cmd
,

1485 
NO_STR


1486 
IP_STR


1487 
PREFIX_LIST_STR


1499  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1500 
¨gv
[3],árgv[4],árgv[5]);

1503 
DEFUN
 (
no_ù_¥efix_li°_£q_À
,

1504 
no_ù_¥efix_li°_£q_À_cmd
,

1506 
NO_STR


1507 
IP_STR


1508 
PREFIX_LIST_STR


1518  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1519 
¨gv
[3], 
NULL
,árgv[4]);

1522 
DEFUN
 (
no_ù_¥efix_li°_£q_À_ge
,

1523 
no_ù_¥efix_li°_£q_À_ge_cmd
,

1525 
NO_STR


1526 
IP_STR


1527 
PREFIX_LIST_STR


1539  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1],árgv[2],

1540 
¨gv
[3],árgv[5],árgv[4]);

1543 
DEFUN
 (
ù_¥efix_li°_£quí˚_numbî
,

1544 
ù_¥efix_li°_£quí˚_numbî_cmd
,

1546 
IP_STR


1547 
PREFIX_LIST_STR


1550 
	g¥efix_ma°î_ùv4
.
	g£qnum
 = 1;

1551  
	gCMD_SUCCESS
;

1554 
DEFUN
 (
no_ù_¥efix_li°_£quí˚_numbî
,

1555 
no_ù_¥efix_li°_£quí˚_numbî_cmd
,

1557 
NO_STR


1558 
IP_STR


1559 
PREFIX_LIST_STR


1562 
	g¥efix_ma°î_ùv4
.
	g£qnum
 = 0;

1563  
	gCMD_SUCCESS
;

1566 
DEFUN
 (
ù_¥efix_li°_des¸ùti⁄
,

1567 
ù_¥efix_li°_des¸ùti⁄_cmd
,

1569 
IP_STR


1570 
PREFIX_LIST_STR


1575 
¥efix_li°
 *
	g∂i°
;

1577 
	g∂i°
 = 
¥efix_li°_gë
 (
AFI_IP
, 
¨gv
[0]);

1579 i‡(
	g∂i°
->
	gdesc
)

1581 
XFREE
 (
MTYPE_TMP
, 
∂i°
->
desc
);

1582 
	g∂i°
->
	gdesc
 = 
NULL
;

1584 
	g∂i°
->
	gdesc
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 1);

1586  
	gCMD_SUCCESS
;

1589 
DEFUN
 (
no_ù_¥efix_li°_des¸ùti⁄
,

1590 
no_ù_¥efix_li°_des¸ùti⁄_cmd
,

1592 
NO_STR


1593 
IP_STR


1594 
PREFIX_LIST_STR


1598  
vty_¥efix_li°_desc_un£t
 (
vty
, 
AFI_IP
, 
¨gv
[0]);

1601 
ALIAS
 (
no_ù_¥efix_li°_des¸ùti⁄
,

1602 
no_ù_¥efix_li°_des¸ùti⁄_¨g_cmd
,

1604 
NO_STR


1605 
IP_STR


1606 
PREFIX_LIST_STR


1611 
DEFUN
 (
show_ù_¥efix_li°
,

1612 
show_ù_¥efix_li°_cmd
,

1614 
SHOW_STR


1615 
IP_STR


1616 
PREFIX_LIST_STR
)

1618  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
NULL
, NULL, 
n‹mÆ_di•œy
);

1621 
DEFUN
 (
show_ù_¥efix_li°_«me
,

1622 
show_ù_¥efix_li°_«me_cmd
,

1624 
SHOW_STR


1625 
IP_STR


1626 
PREFIX_LIST_STR


1629  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
, 
n‹mÆ_di•œy
);

1632 
DEFUN
 (
show_ù_¥efix_li°_«me_£q
,

1633 
show_ù_¥efix_li°_«me_£q_cmd
,

1635 
SHOW_STR


1636 
IP_STR


1637 
PREFIX_LIST_STR


1642  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1], 
£quítül_di•œy
);

1645 
DEFUN
 (
show_ù_¥efix_li°_¥efix
,

1646 
show_ù_¥efix_li°_¥efix_cmd
,

1648 
SHOW_STR


1649 
IP_STR


1650 
PREFIX_LIST_STR


1654  
vty_show_¥efix_li°_¥efix
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1], 
n‹mÆ_di•œy
);

1657 
DEFUN
 (
show_ù_¥efix_li°_¥efix_l⁄gî
,

1658 
show_ù_¥efix_li°_¥efix_l⁄gî_cmd
,

1660 
SHOW_STR


1661 
IP_STR


1662 
PREFIX_LIST_STR


1667  
vty_show_¥efix_li°_¥efix
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1], 
l⁄gî_di•œy
);

1670 
DEFUN
 (
show_ù_¥efix_li°_¥efix_fú°_m©ch
,

1671 
show_ù_¥efix_li°_¥efix_fú°_m©ch_cmd
,

1673 
SHOW_STR


1674 
IP_STR


1675 
PREFIX_LIST_STR


1680  
vty_show_¥efix_li°_¥efix
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1], 
fú°_m©ch_di•œy
);

1683 
DEFUN
 (
show_ù_¥efix_li°_summ¨y
,

1684 
show_ù_¥efix_li°_summ¨y_cmd
,

1686 
SHOW_STR


1687 
IP_STR


1688 
PREFIX_LIST_STR


1691  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
NULL
, NULL, 
summ¨y_di•œy
);

1694 
DEFUN
 (
show_ù_¥efix_li°_summ¨y_«me
,

1695 
show_ù_¥efix_li°_summ¨y_«me_cmd
,

1697 
SHOW_STR


1698 
IP_STR


1699 
PREFIX_LIST_STR


1703  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
, 
summ¨y_di•œy
);

1707 
DEFUN
 (
show_ù_¥efix_li°_dëaû
,

1708 
show_ù_¥efix_li°_dëaû_cmd
,

1710 
SHOW_STR


1711 
IP_STR


1712 
PREFIX_LIST_STR


1715  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
NULL
, NULL, 
dëaû_di•œy
);

1718 
DEFUN
 (
show_ù_¥efix_li°_dëaû_«me
,

1719 
show_ù_¥efix_li°_dëaû_«me_cmd
,

1721 
SHOW_STR


1722 
IP_STR


1723 
PREFIX_LIST_STR


1727  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
, 
dëaû_di•œy
);

1730 
DEFUN
 (
˛ór_ù_¥efix_li°
,

1731 
˛ór_ù_¥efix_li°_cmd
,

1733 
CLEAR_STR


1734 
IP_STR


1735 
PREFIX_LIST_STR
)

1737  
vty_˛ór_¥efix_li°
 (
vty
, 
AFI_IP
, 
NULL
, NULL);

1740 
DEFUN
 (
˛ór_ù_¥efix_li°_«me
,

1741 
˛ór_ù_¥efix_li°_«me_cmd
,

1743 
CLEAR_STR


1744 
IP_STR


1745 
PREFIX_LIST_STR


1748  
vty_˛ór_¥efix_li°
 (
vty
, 
AFI_IP
, 
¨gv
[0], 
NULL
);

1751 
DEFUN
 (
˛ór_ù_¥efix_li°_«me_¥efix
,

1752 
˛ór_ù_¥efix_li°_«me_¥efix_cmd
,

1754 
CLEAR_STR


1755 
IP_STR


1756 
PREFIX_LIST_STR


1760  
vty_˛ór_¥efix_li°
 (
vty
, 
AFI_IP
, 
¨gv
[0],árgv[1]);

1763 #ifde‡
HAVE_IPV6


1764 
DEFUN
 (
ùv6_¥efix_li°
,

1765 
ùv6_¥efix_li°_cmd
,

1767 
IPV6_STR


1768 
PREFIX_LIST_STR


1775  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,

1776 
¨gv
[1],árgv[2], 
NULL
, NULL);

1779 
DEFUN
 (
ùv6_¥efix_li°_ge
,

1780 
ùv6_¥efix_li°_ge_cmd
,

1782 
IPV6_STR


1783 
PREFIX_LIST_STR


1791  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

1792 
¨gv
[2],árgv[3], 
NULL
);

1795 
DEFUN
 (
ùv6_¥efix_li°_ge_À
,

1796 
ùv6_¥efix_li°_ge_À_cmd
,

1798 
IPV6_STR


1799 
PREFIX_LIST_STR


1810  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

1811 
¨gv
[2],árgv[3],árgv[4]);

1814 
DEFUN
 (
ùv6_¥efix_li°_À
,

1815 
ùv6_¥efix_li°_À_cmd
,

1817 
IPV6_STR


1818 
PREFIX_LIST_STR


1826  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

1827 
¨gv
[2], 
NULL
,árgv[3]);

1830 
DEFUN
 (
ùv6_¥efix_li°_À_ge
,

1831 
ùv6_¥efix_li°_À_ge_cmd
,

1833 
IPV6_STR


1834 
PREFIX_LIST_STR


1844  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

1845 
¨gv
[2],árgv[4],árgv[3]);

1848 
DEFUN
 (
ùv6_¥efix_li°_£q
,

1849 
ùv6_¥efix_li°_£q_cmd
,

1851 
IPV6_STR


1852 
PREFIX_LIST_STR


1861  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

1862 
¨gv
[3], 
NULL
, NULL);

1865 
DEFUN
 (
ùv6_¥efix_li°_£q_ge
,

1866 
ùv6_¥efix_li°_£q_ge_cmd
,

1868 
IPV6_STR


1869 
PREFIX_LIST_STR


1879  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

1880 
¨gv
[3],árgv[4], 
NULL
);

1883 
DEFUN
 (
ùv6_¥efix_li°_£q_ge_À
,

1884 
ùv6_¥efix_li°_£q_ge_À_cmd
,

1886 
IPV6_STR


1887 
PREFIX_LIST_STR


1899  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

1900 
¨gv
[3],árgv[4],árgv[5]);

1903 
DEFUN
 (
ùv6_¥efix_li°_£q_À
,

1904 
ùv6_¥efix_li°_£q_À_cmd
,

1906 
IPV6_STR


1907 
PREFIX_LIST_STR


1917  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

1918 
¨gv
[3], 
NULL
,árgv[4]);

1921 
DEFUN
 (
ùv6_¥efix_li°_£q_À_ge
,

1922 
ùv6_¥efix_li°_£q_À_ge_cmd
,

1924 
IPV6_STR


1925 
PREFIX_LIST_STR


1937  
vty_¥efix_li°_ö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

1938 
¨gv
[3],árgv[5],árgv[4]);

1941 
DEFUN
 (
no_ùv6_¥efix_li°
,

1942 
no_ùv6_¥efix_li°_cmd
,

1944 
NO_STR


1945 
IPV6_STR


1946 
PREFIX_LIST_STR


1949  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
, NULL,

1950 
NULL
, NULL, NULL);

1953 
DEFUN
 (
no_ùv6_¥efix_li°_¥efix
,

1954 
no_ùv6_¥efix_li°_¥efix_cmd
,

1956 
NO_STR


1957 
IPV6_STR


1958 
PREFIX_LIST_STR


1965  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

1966 
¨gv
[2], 
NULL
, NULL);

1969 
DEFUN
 (
no_ùv6_¥efix_li°_ge
,

1970 
no_ùv6_¥efix_li°_ge_cmd
,

1972 
NO_STR


1973 
IPV6_STR


1974 
PREFIX_LIST_STR


1982  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

1983 
¨gv
[2],árgv[3], 
NULL
);

1986 
DEFUN
 (
no_ùv6_¥efix_li°_ge_À
,

1987 
no_ùv6_¥efix_li°_ge_À_cmd
,

1989 
NO_STR


1990 
IPV6_STR


1991 
PREFIX_LIST_STR


2001  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

2002 
¨gv
[2],árgv[3],árgv[4]);

2005 
DEFUN
 (
no_ùv6_¥efix_li°_À
,

2006 
no_ùv6_¥efix_li°_À_cmd
,

2008 
NO_STR


2009 
IPV6_STR


2010 
PREFIX_LIST_STR


2018  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

2019 
¨gv
[2], 
NULL
,árgv[3]);

2022 
DEFUN
 (
no_ùv6_¥efix_li°_À_ge
,

2023 
no_ùv6_¥efix_li°_À_ge_cmd
,

2025 
NO_STR


2026 
IPV6_STR


2027 
PREFIX_LIST_STR


2037  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
,árgv[1],

2038 
¨gv
[2],árgv[4],árgv[3]);

2041 
DEFUN
 (
no_ùv6_¥efix_li°_£q
,

2042 
no_ùv6_¥efix_li°_£q_cmd
,

2044 
NO_STR


2045 
IPV6_STR


2046 
PREFIX_LIST_STR


2055  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

2056 
¨gv
[3], 
NULL
, NULL);

2059 
DEFUN
 (
no_ùv6_¥efix_li°_£q_ge
,

2060 
no_ùv6_¥efix_li°_£q_ge_cmd
,

2062 
NO_STR


2063 
IPV6_STR


2064 
PREFIX_LIST_STR


2074  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

2075 
¨gv
[3],árgv[4], 
NULL
);

2078 
DEFUN
 (
no_ùv6_¥efix_li°_£q_ge_À
,

2079 
no_ùv6_¥efix_li°_£q_ge_À_cmd
,

2081 
NO_STR


2082 
IPV6_STR


2083 
PREFIX_LIST_STR


2095  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

2096 
¨gv
[3],árgv[4],árgv[5]);

2099 
DEFUN
 (
no_ùv6_¥efix_li°_£q_À
,

2100 
no_ùv6_¥efix_li°_£q_À_cmd
,

2102 
NO_STR


2103 
IPV6_STR


2104 
PREFIX_LIST_STR


2114  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

2115 
¨gv
[3], 
NULL
,árgv[4]);

2118 
DEFUN
 (
no_ùv6_¥efix_li°_£q_À_ge
,

2119 
no_ùv6_¥efix_li°_£q_À_ge_cmd
,

2121 
NO_STR


2122 
IPV6_STR


2123 
PREFIX_LIST_STR


2135  
vty_¥efix_li°_unö°Æl
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1],árgv[2],

2136 
¨gv
[3],árgv[5],árgv[4]);

2139 
DEFUN
 (
ùv6_¥efix_li°_£quí˚_numbî
,

2140 
ùv6_¥efix_li°_£quí˚_numbî_cmd
,

2142 
IPV6_STR


2143 
PREFIX_LIST_STR


2146 
	g¥efix_ma°î_ùv6
.
	g£qnum
 = 1;

2147  
	gCMD_SUCCESS
;

2150 
DEFUN
 (
no_ùv6_¥efix_li°_£quí˚_numbî
,

2151 
no_ùv6_¥efix_li°_£quí˚_numbî_cmd
,

2153 
NO_STR


2154 
IPV6_STR


2155 
PREFIX_LIST_STR


2158 
	g¥efix_ma°î_ùv6
.
	g£qnum
 = 0;

2159  
	gCMD_SUCCESS
;

2162 
DEFUN
 (
ùv6_¥efix_li°_des¸ùti⁄
,

2163 
ùv6_¥efix_li°_des¸ùti⁄_cmd
,

2165 
IPV6_STR


2166 
PREFIX_LIST_STR


2171 
¥efix_li°
 *
	g∂i°
;

2173 
	g∂i°
 = 
¥efix_li°_gë
 (
AFI_IP6
, 
¨gv
[0]);

2175 i‡(
	g∂i°
->
	gdesc
)

2177 
XFREE
 (
MTYPE_TMP
, 
∂i°
->
desc
);

2178 
	g∂i°
->
	gdesc
 = 
NULL
;

2180 
	g∂i°
->
	gdesc
 = 
¨gv_c⁄ˇt
(
¨gv
, 
¨gc
, 1);

2182  
	gCMD_SUCCESS
;

2185 
DEFUN
 (
no_ùv6_¥efix_li°_des¸ùti⁄
,

2186 
no_ùv6_¥efix_li°_des¸ùti⁄_cmd
,

2188 
NO_STR


2189 
IPV6_STR


2190 
PREFIX_LIST_STR


2194  
vty_¥efix_li°_desc_un£t
 (
vty
, 
AFI_IP6
, 
¨gv
[0]);

2197 
ALIAS
 (
no_ùv6_¥efix_li°_des¸ùti⁄
,

2198 
no_ùv6_¥efix_li°_des¸ùti⁄_¨g_cmd
,

2200 
NO_STR


2201 
IPV6_STR


2202 
PREFIX_LIST_STR


2207 
DEFUN
 (
show_ùv6_¥efix_li°
,

2208 
show_ùv6_¥efix_li°_cmd
,

2210 
SHOW_STR


2211 
IPV6_STR


2212 
PREFIX_LIST_STR
)

2214  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
NULL
, NULL, 
n‹mÆ_di•œy
);

2217 
DEFUN
 (
show_ùv6_¥efix_li°_«me
,

2218 
show_ùv6_¥efix_li°_«me_cmd
,

2220 
SHOW_STR


2221 
IPV6_STR


2222 
PREFIX_LIST_STR


2225  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
, 
n‹mÆ_di•œy
);

2228 
DEFUN
 (
show_ùv6_¥efix_li°_«me_£q
,

2229 
show_ùv6_¥efix_li°_«me_£q_cmd
,

2231 
SHOW_STR


2232 
IPV6_STR


2233 
PREFIX_LIST_STR


2238  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1], 
£quítül_di•œy
);

2241 
DEFUN
 (
show_ùv6_¥efix_li°_¥efix
,

2242 
show_ùv6_¥efix_li°_¥efix_cmd
,

2244 
SHOW_STR


2245 
IPV6_STR


2246 
PREFIX_LIST_STR


2250  
vty_show_¥efix_li°_¥efix
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1], 
n‹mÆ_di•œy
);

2253 
DEFUN
 (
show_ùv6_¥efix_li°_¥efix_l⁄gî
,

2254 
show_ùv6_¥efix_li°_¥efix_l⁄gî_cmd
,

2256 
SHOW_STR


2257 
IPV6_STR


2258 
PREFIX_LIST_STR


2263  
vty_show_¥efix_li°_¥efix
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1], 
l⁄gî_di•œy
);

2266 
DEFUN
 (
show_ùv6_¥efix_li°_¥efix_fú°_m©ch
,

2267 
show_ùv6_¥efix_li°_¥efix_fú°_m©ch_cmd
,

2269 
SHOW_STR


2270 
IPV6_STR


2271 
PREFIX_LIST_STR


2276  
vty_show_¥efix_li°_¥efix
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1], 
fú°_m©ch_di•œy
);

2279 
DEFUN
 (
show_ùv6_¥efix_li°_summ¨y
,

2280 
show_ùv6_¥efix_li°_summ¨y_cmd
,

2282 
SHOW_STR


2283 
IPV6_STR


2284 
PREFIX_LIST_STR


2287  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
NULL
, NULL, 
summ¨y_di•œy
);

2290 
DEFUN
 (
show_ùv6_¥efix_li°_summ¨y_«me
,

2291 
show_ùv6_¥efix_li°_summ¨y_«me_cmd
,

2293 
SHOW_STR


2294 
IPV6_STR


2295 
PREFIX_LIST_STR


2299  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
, 
summ¨y_di•œy
);

2302 
DEFUN
 (
show_ùv6_¥efix_li°_dëaû
,

2303 
show_ùv6_¥efix_li°_dëaû_cmd
,

2305 
SHOW_STR


2306 
IPV6_STR


2307 
PREFIX_LIST_STR


2310  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
NULL
, NULL, 
dëaû_di•œy
);

2313 
DEFUN
 (
show_ùv6_¥efix_li°_dëaû_«me
,

2314 
show_ùv6_¥efix_li°_dëaû_«me_cmd
,

2316 
SHOW_STR


2317 
IPV6_STR


2318 
PREFIX_LIST_STR


2322  
vty_show_¥efix_li°
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
, 
dëaû_di•œy
);

2325 
DEFUN
 (
˛ór_ùv6_¥efix_li°
,

2326 
˛ór_ùv6_¥efix_li°_cmd
,

2328 
CLEAR_STR


2329 
IPV6_STR


2330 
PREFIX_LIST_STR
)

2332  
vty_˛ór_¥efix_li°
 (
vty
, 
AFI_IP6
, 
NULL
, NULL);

2335 
DEFUN
 (
˛ór_ùv6_¥efix_li°_«me
,

2336 
˛ór_ùv6_¥efix_li°_«me_cmd
,

2338 
CLEAR_STR


2339 
IPV6_STR


2340 
PREFIX_LIST_STR


2343  
vty_˛ór_¥efix_li°
 (
vty
, 
AFI_IP6
, 
¨gv
[0], 
NULL
);

2346 
DEFUN
 (
˛ór_ùv6_¥efix_li°_«me_¥efix
,

2347 
˛ór_ùv6_¥efix_li°_«me_¥efix_cmd
,

2349 
CLEAR_STR


2350 
IPV6_STR


2351 
PREFIX_LIST_STR


2355  
vty_˛ór_¥efix_li°
 (
vty
, 
AFI_IP6
, 
¨gv
[0],árgv[1]);

2361 
	$c⁄fig_wrôe_¥efix_afi
 (
afi_t
 
afi
, 
vty
 *vty)

2363 
¥efix_li°
 *
∂i°
;

2364 
¥efix_li°_íåy
 *
≥¡ry
;

2365 
¥efix_ma°î
 *
ma°î
;

2366 
wrôe
 = 0;

2368 
ma°î
 = 
	`¥efix_ma°î_gë
 (
afi
);

2369 i‡(
ma°î
 =
NULL
)

2372 i‡(! 
ma°î
->
£qnum
)

2374 
	`vty_out
 (
vty
, "no ip%sÖrefix-list sequence-number%s",

2375 
afi
 =
AFI_IP
 ? "" : "v6", 
VTY_NEWLINE
);

2376 
	`vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

2379 
∂i°
 = 
ma°î
->
num
.
hód
;Öli°;Öli° =Öli°->
√xt
)

2381 i‡(
∂i°
->
desc
)

2383 
	`vty_out
 (
vty
, "ip%sÖrefix-list %s description %s%s",

2384 
afi
 =
AFI_IP
 ? "" : "v6",

2385 
∂i°
->
«me
,Öli°->
desc
, 
VTY_NEWLINE
);

2386 
wrôe
++;

2389 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

2391 
	`vty_out
 (
vty
, "ip%sÖrefix-list %s ",

2392 
afi
 =
AFI_IP
 ? "" : "v6",

2393 
∂i°
->
«me
);

2395 i‡(
ma°î
->
£qnum
)

2396 
	`vty_out
 (
vty
, "£q %d ", 
≥¡ry
->
£q
);

2398 
	`vty_out
 (
vty
, "%†", 
	`¥efix_li°_ty≥_°r
 (
≥¡ry
));

2400 i‡(
≥¡ry
->
™y
)

2401 
	`vty_out
 (
vty
, "any");

2404 
¥efix
 *
p
 = &
≥¡ry
->prefix;

2405 
buf
[
BUFSIZ
];

2407 
	`vty_out
 (
vty
, "%s/%d",

2408 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

2409 
p
->
¥efixÀn
);

2411 i‡(
≥¡ry
->
ge
)

2412 
	`vty_out
 (
vty
, " gê%d", 
≥¡ry
->
ge
);

2413 i‡(
≥¡ry
->
À
)

2414 
	`vty_out
 (
vty
, "Üê%d", 
≥¡ry
->
À
);

2416 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

2417 
wrôe
++;

2422 
∂i°
 = 
ma°î
->
°r
.
hód
;Öli°;Öli° =Öli°->
√xt
)

2424 i‡(
∂i°
->
desc
)

2426 
	`vty_out
 (
vty
, "ip%sÖrefix-list %s description %s%s",

2427 
afi
 =
AFI_IP
 ? "" : "v6",

2428 
∂i°
->
«me
,Öli°->
desc
, 
VTY_NEWLINE
);

2429 
wrôe
++;

2432 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

2434 
	`vty_out
 (
vty
, "ip%sÖrefix-list %s ",

2435 
afi
 =
AFI_IP
 ? "" : "v6",

2436 
∂i°
->
«me
);

2438 i‡(
ma°î
->
£qnum
)

2439 
	`vty_out
 (
vty
, "£q %d ", 
≥¡ry
->
£q
);

2441 
	`vty_out
 (
vty
, "%s", 
	`¥efix_li°_ty≥_°r
 (
≥¡ry
));

2443 i‡(
≥¡ry
->
™y
)

2444 
	`vty_out
 (
vty
, "ány");

2447 
¥efix
 *
p
 = &
≥¡ry
->prefix;

2448 
buf
[
BUFSIZ
];

2450 
	`vty_out
 (
vty
, " %s/%d",

2451 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

2452 
p
->
¥efixÀn
);

2454 i‡(
≥¡ry
->
ge
)

2455 
	`vty_out
 (
vty
, " gê%d", 
≥¡ry
->
ge
);

2456 i‡(
≥¡ry
->
À
)

2457 
	`vty_out
 (
vty
, "Üê%d", 
≥¡ry
->
À
);

2459 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

2460 
wrôe
++;

2464  
wrôe
;

2465 
	}
}

2467 
°ªam
 *

2468 
	$¥efix_bgp_‹f_íåy
 (
°ªam
 *
s
, 
¥efix_li°
 *
∂i°
,

2469 
u_ch¨
 
öô_Êag
, u_ch¨ 
≥rmô_Êag
, u_ch¨ 
díy_Êag
)

2471 
¥efix_li°_íåy
 *
≥¡ry
;

2473 i‡(! 
∂i°
)

2474  
s
;

2476 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

2478 
u_ch¨
 
Êag
 = 
öô_Êag
;

2479 
¥efix
 *
p
 = &
≥¡ry
->prefix;

2481 
Êag
 |(
≥¡ry
->
ty≥
 =
PREFIX_PERMIT
 ?

2482 
≥rmô_Êag
 : 
díy_Êag
);

2483 
	`°ªam_putc
 (
s
, 
Êag
);

2484 
	`°ªam_pué
 (
s
, (
u_öt32_t
)
≥¡ry
->
£q
);

2485 
	`°ªam_putc
 (
s
, (
u_ch¨
)
≥¡ry
->
ge
);

2486 
	`°ªam_putc
 (
s
, (
u_ch¨
)
≥¡ry
->
À
);

2487 
	`°ªam_put_¥efix
 (
s
, 
p
);

2490  
s
;

2491 
	}
}

2494 
	$¥efix_bgp_‹f_£t
 (*
«me
, 
afi_t
 
afi
, 
‹f_¥efix
 *
‹Â
,

2495 
≥rmô
, 
£t
)

2497 
¥efix_li°
 *
∂i°
;

2498 
¥efix_li°_íåy
 *
≥¡ry
;

2501 i‡(
‹Â
->
ge
 && orÂ->gê<‹Â->
p
.
¥efixÀn
)

2502  
CMD_WARNING
;

2503 i‡(
‹Â
->
À
 && orÂ->À <‹Â->
p
.
¥efixÀn
)

2504  
CMD_WARNING
;

2505 i‡(
‹Â
->
À
 && orÂ->
ge
 > orfp->le)

2506  
CMD_WARNING
;

2508 i‡(
‹Â
->
ge
 && orÂ->
À
 =(
afi
 =
AFI_IP
 ? 32 : 128))

2509 
‹Â
->
À
 = 0;

2511 
∂i°
 = 
	`¥efix_li°_gë
 (
AFI_ORF_PREFIX
, 
«me
);

2512 i‡(! 
∂i°
)

2513  
CMD_WARNING
;

2515 i‡(
£t
)

2517 
≥¡ry
 = 
	`¥efix_li°_íåy_make
 (&
‹Â
->
p
,

2518 (
≥rmô
 ? 
PREFIX_PERMIT
 : 
PREFIX_DENY
),

2519 
‹Â
->
£q
, orÂ->
À
, orÂ->
ge
, 0);

2521 i‡(
	`¥efix_íåy_dup_check
 (
∂i°
, 
≥¡ry
))

2523 
	`¥efix_li°_íåy_‰ì
 (
≥¡ry
);

2524  
CMD_WARNING
;

2527 
	`¥efix_li°_íåy_add
 (
∂i°
, 
≥¡ry
);

2531 
≥¡ry
 = 
	`¥efix_li°_íåy_lookup
 (
∂i°
, &
‹Â
->
p
,

2532 (
≥rmô
 ? 
PREFIX_PERMIT
 : 
PREFIX_DENY
),

2533 
‹Â
->
£q
, orÂ->
À
, orÂ->
ge
);

2535 i‡(! 
≥¡ry
)

2536  
CMD_WARNING
;

2538 
	`¥efix_li°_íåy_dñëe
 (
∂i°
, 
≥¡ry
, 1);

2541  
CMD_SUCCESS
;

2542 
	}
}

2545 
	$¥efix_bgp_‹f_ªmove_Æl
 (*
«me
)

2547 
¥efix_li°
 *
∂i°
;

2549 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_ORF_PREFIX
, 
«me
);

2550 i‡(
∂i°
)

2551 
	`¥efix_li°_dñëe
 (
∂i°
);

2552 
	}
}

2556 
	$¥efix_bgp_show_¥efix_li°
 (
vty
 *vty, 
afi_t
 
afi
, *
«me
)

2558 
¥efix_li°
 *
∂i°
;

2559 
¥efix_li°_íåy
 *
≥¡ry
;

2561 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_ORF_PREFIX
, 
«me
);

2562 i‡(! 
∂i°
)

2565 i‡(! 
vty
)

2566  
∂i°
->
cou¡
;

2568 
	`vty_out
 (
vty
, "ip%sÖrefix-list %s: %dÉntries%s",

2569 
afi
 =
AFI_IP
 ? "" : "v6",

2570 
∂i°
->
«me
,Öli°->
cou¡
, 
VTY_NEWLINE
);

2572 
≥¡ry
 = 
∂i°
->
hód
;Öíåy;Öíåy =Öíåy->
√xt
)

2574 
¥efix
 *
p
 = &
≥¡ry
->prefix;

2575 
buf
[
BUFSIZ
];

2577 
	`vty_out
 (
vty
, " seq %d %†%s/%d", 
≥¡ry
->
£q
,

2578 
	`¥efix_li°_ty≥_°r
 (
≥¡ry
),

2579 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
),

2580 
p
->
¥efixÀn
);

2582 i‡(
≥¡ry
->
ge
)

2583 
	`vty_out
 (
vty
, " gê%d", 
≥¡ry
->
ge
);

2584 i‡(
≥¡ry
->
À
)

2585 
	`vty_out
 (
vty
, "Üê%d", 
≥¡ry
->
À
);

2587 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

2589  
∂i°
->
cou¡
;

2590 
	}
}

2593 
	$¥efix_li°_ª£t_‹f
 ()

2595 
¥efix_li°
 *
∂i°
;

2596 
¥efix_li°
 *
√xt
;

2597 
¥efix_ma°î
 *
ma°î
;

2599 
ma°î
 = 
	`¥efix_ma°î_gë
 (
AFI_ORF_PREFIX
);

2600 i‡(
ma°î
 =
NULL
)

2603 
∂i°
 = 
ma°î
->
num
.
hód
;Öli°;Öli° = 
√xt
)

2605 
√xt
 = 
∂i°
->next;

2606 
	`¥efix_li°_dñëe
 (
∂i°
);

2608 
∂i°
 = 
ma°î
->
°r
.
hód
;Öli°;Öli° = 
√xt
)

2610 
√xt
 = 
∂i°
->next;

2611 
	`¥efix_li°_dñëe
 (
∂i°
);

2614 
	`as£π
 (
ma°î
->
num
.
hód
 =
NULL
);

2615 
	`as£π
 (
ma°î
->
num
.
èû
 =
NULL
);

2617 
	`as£π
 (
ma°î
->
°r
.
hód
 =
NULL
);

2618 
	`as£π
 (
ma°î
->
°r
.
èû
 =
NULL
);

2620 
ma°î
->
£qnum
 = 1;

2621 
ma°î
->
ª˚¡
 = 
NULL
;

2622 
	}
}

2626 
cmd_node
 
	g¥efix_node
 =

2628 
PREFIX_NODE
,

2634 
	$c⁄fig_wrôe_¥efix_ùv4
 (
vty
 *vty)

2636  
	`c⁄fig_wrôe_¥efix_afi
 (
AFI_IP
, 
vty
);

2637 
	}
}

2640 
	$¥efix_li°_ª£t_ùv4
 ()

2642 
¥efix_li°
 *
∂i°
;

2643 
¥efix_li°
 *
√xt
;

2644 
¥efix_ma°î
 *
ma°î
;

2646 
ma°î
 = 
	`¥efix_ma°î_gë
 (
AFI_IP
);

2647 i‡(
ma°î
 =
NULL
)

2650 
∂i°
 = 
ma°î
->
num
.
hód
;Öli°;Öli° = 
√xt
)

2652 
√xt
 = 
∂i°
->next;

2653 
	`¥efix_li°_dñëe
 (
∂i°
);

2655 
∂i°
 = 
ma°î
->
°r
.
hód
;Öli°;Öli° = 
√xt
)

2657 
√xt
 = 
∂i°
->next;

2658 
	`¥efix_li°_dñëe
 (
∂i°
);

2661 
	`as£π
 (
ma°î
->
num
.
hód
 =
NULL
);

2662 
	`as£π
 (
ma°î
->
num
.
èû
 =
NULL
);

2664 
	`as£π
 (
ma°î
->
°r
.
hód
 =
NULL
);

2665 
	`as£π
 (
ma°î
->
°r
.
èû
 =
NULL
);

2667 
ma°î
->
£qnum
 = 1;

2668 
ma°î
->
ª˚¡
 = 
NULL
;

2669 
	}
}

2672 
	$¥efix_li°_öô_ùv4
 ()

2674 
	`ö°Æl_node
 (&
¥efix_node
, 
c⁄fig_wrôe_¥efix_ùv4
);

2676 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_cmd
);

2677 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_ge_cmd
);

2678 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_ge_À_cmd
);

2679 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_À_cmd
);

2680 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_À_ge_cmd
);

2681 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_£q_cmd
);

2682 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_£q_ge_cmd
);

2683 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_£q_ge_À_cmd
);

2684 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_£q_À_cmd
);

2685 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_£q_À_ge_cmd
);

2687 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_cmd
);

2688 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_¥efix_cmd
);

2689 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_ge_cmd
);

2690 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_ge_À_cmd
);

2691 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_À_cmd
);

2692 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_À_ge_cmd
);

2693 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_£q_cmd
);

2694 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_£q_ge_cmd
);

2695 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_£q_ge_À_cmd
);

2696 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_£q_À_cmd
);

2697 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_£q_À_ge_cmd
);

2699 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_des¸ùti⁄_cmd
);

2700 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_des¸ùti⁄_cmd
);

2701 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_des¸ùti⁄_¨g_cmd
);

2703 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥efix_li°_£quí˚_numbî_cmd
);

2704 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥efix_li°_£quí˚_numbî_cmd
);

2706 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_cmd
);

2707 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_«me_cmd
);

2708 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_«me_£q_cmd
);

2709 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_¥efix_cmd
);

2710 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_¥efix_l⁄gî_cmd
);

2711 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_¥efix_fú°_m©ch_cmd
);

2712 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_summ¨y_cmd
);

2713 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_summ¨y_«me_cmd
);

2714 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_dëaû_cmd
);

2715 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥efix_li°_dëaû_«me_cmd
);

2717 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_cmd
);

2718 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_«me_cmd
);

2719 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_«me_£q_cmd
);

2720 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_¥efix_cmd
);

2721 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_¥efix_l⁄gî_cmd
);

2722 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_¥efix_fú°_m©ch_cmd
);

2723 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_summ¨y_cmd
);

2724 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_summ¨y_«me_cmd
);

2725 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_dëaû_cmd
);

2726 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥efix_li°_dëaû_«me_cmd
);

2728 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_¥efix_li°_cmd
);

2729 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_¥efix_li°_«me_cmd
);

2730 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ù_¥efix_li°_«me_¥efix_cmd
);

2731 
	}
}

2733 #ifde‡
HAVE_IPV6


2735 
cmd_node
 
	g¥efix_ùv6_node
 =

2737 
PREFIX_IPV6_NODE
,

2743 
	$c⁄fig_wrôe_¥efix_ùv6
 (
vty
 *vty)

2745  
	`c⁄fig_wrôe_¥efix_afi
 (
AFI_IP6
, 
vty
);

2746 
	}
}

2749 
	$¥efix_li°_ª£t_ùv6
 ()

2751 
¥efix_li°
 *
∂i°
;

2752 
¥efix_li°
 *
√xt
;

2753 
¥efix_ma°î
 *
ma°î
;

2755 
ma°î
 = 
	`¥efix_ma°î_gë
 (
AFI_IP6
);

2756 i‡(
ma°î
 =
NULL
)

2759 
∂i°
 = 
ma°î
->
num
.
hód
;Öli°;Öli° = 
√xt
)

2761 
√xt
 = 
∂i°
->next;

2762 
	`¥efix_li°_dñëe
 (
∂i°
);

2764 
∂i°
 = 
ma°î
->
°r
.
hód
;Öli°;Öli° = 
√xt
)

2766 
√xt
 = 
∂i°
->next;

2767 
	`¥efix_li°_dñëe
 (
∂i°
);

2770 
	`as£π
 (
ma°î
->
num
.
hód
 =
NULL
);

2771 
	`as£π
 (
ma°î
->
num
.
èû
 =
NULL
);

2773 
	`as£π
 (
ma°î
->
°r
.
hód
 =
NULL
);

2774 
	`as£π
 (
ma°î
->
°r
.
èû
 =
NULL
);

2776 
ma°î
->
£qnum
 = 1;

2777 
ma°î
->
ª˚¡
 = 
NULL
;

2778 
	}
}

2781 
	$¥efix_li°_öô_ùv6
 ()

2783 
	`ö°Æl_node
 (&
¥efix_ùv6_node
, 
c⁄fig_wrôe_¥efix_ùv6
);

2785 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_cmd
);

2786 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_ge_cmd
);

2787 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_ge_À_cmd
);

2788 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_À_cmd
);

2789 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_À_ge_cmd
);

2790 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_£q_cmd
);

2791 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_£q_ge_cmd
);

2792 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_£q_ge_À_cmd
);

2793 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_£q_À_cmd
);

2794 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_£q_À_ge_cmd
);

2796 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_cmd
);

2797 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_¥efix_cmd
);

2798 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_ge_cmd
);

2799 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_ge_À_cmd
);

2800 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_À_cmd
);

2801 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_À_ge_cmd
);

2802 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_£q_cmd
);

2803 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_£q_ge_cmd
);

2804 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_£q_ge_À_cmd
);

2805 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_£q_À_cmd
);

2806 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_£q_À_ge_cmd
);

2808 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_des¸ùti⁄_cmd
);

2809 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_des¸ùti⁄_cmd
);

2810 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_des¸ùti⁄_¨g_cmd
);

2812 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_¥efix_li°_£quí˚_numbî_cmd
);

2813 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_¥efix_li°_£quí˚_numbî_cmd
);

2815 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_cmd
);

2816 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_«me_cmd
);

2817 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_«me_£q_cmd
);

2818 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_¥efix_cmd
);

2819 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_¥efix_l⁄gî_cmd
);

2820 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_¥efix_fú°_m©ch_cmd
);

2821 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_summ¨y_cmd
);

2822 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_summ¨y_«me_cmd
);

2823 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_dëaû_cmd
);

2824 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_¥efix_li°_dëaû_«me_cmd
);

2826 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_cmd
);

2827 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_«me_cmd
);

2828 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_«me_£q_cmd
);

2829 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_¥efix_cmd
);

2830 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_¥efix_l⁄gî_cmd
);

2831 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_¥efix_fú°_m©ch_cmd
);

2832 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_summ¨y_cmd
);

2833 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_summ¨y_«me_cmd
);

2834 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_dëaû_cmd
);

2835 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_¥efix_li°_dëaû_«me_cmd
);

2837 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ùv6_¥efix_li°_cmd
);

2838 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ùv6_¥efix_li°_«me_cmd
);

2839 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_ùv6_¥efix_li°_«me_¥efix_cmd
);

2840 
	}
}

2844 
	$¥efix_li°_öô
 ()

2846 
	`¥efix_li°_öô_ùv4
 ();

2847 #ifde‡
HAVE_IPV6


2848 
	`¥efix_li°_öô_ùv6
 ();

2850 
	}
}

2853 
	$¥efix_li°_ª£t
 ()

2855 
	`¥efix_li°_ª£t_ùv4
 ();

2856 #ifde‡
HAVE_IPV6


2857 
	`¥efix_li°_ª£t_ùv6
 ();

2859 
	`¥efix_li°_ª£t_‹f
 ();

2860 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/plist.h

23 #i‚de‡
_QUAGGA_PLIST_H


24 
	#_QUAGGA_PLIST_H


	)

26 
	#AFI_ORF_PREFIX
 65535

	)

28 
	e¥efix_li°_ty≥


30 
	mPREFIX_DENY
,

31 
	mPREFIX_PERMIT
,

34 
	e¥efix_«me_ty≥


36 
	mPREFIX_TYPE_STRING
,

37 
	mPREFIX_TYPE_NUMBER


40 
	s¥efix_li°


42 *
	m«me
;

43 *
	mdesc
;

45 
¥efix_ma°î
 *
	mma°î
;

47 
¥efix_«me_ty≥
 
	mty≥
;

49 
	mcou¡
;

50 
	møngecou¡
;

52 
¥efix_li°_íåy
 *
	mhód
;

53 
¥efix_li°_íåy
 *
	mèû
;

55 
¥efix_li°
 *
	m√xt
;

56 
¥efix_li°
 *
	m¥ev
;

59 
	s‹f_¥efix


61 
u_öt32_t
 
	m£q
;

62 
u_ch¨
 
	mge
;

63 
u_ch¨
 
	mÀ
;

64 
¥efix
 
	mp
;

68 
¥efix_li°_öô
 ();

69 
¥efix_li°_ª£t
 ();

70 
¥efix_li°_add_hook
 ((*
func
Ë(
¥efix_li°
 *));

71 
	`¥efix_li°_dñëe_hook
 ((*
func
Ë(
¥efix_li°
 *));

73 
¥efix_li°
 *
	`¥efix_li°_lookup
 (
afi_t
, const *);

74 
¥efix_li°_ty≥
 
	`¥efix_li°_≠∂y
 (
¥efix_li°
 *, *);

76 
°ªam
 * 
	`¥efix_bgp_‹f_íåy
 (stream *,

77 
¥efix_li°
 *,

78 
u_ch¨
, u_char, u_char);

79 
	`¥efix_bgp_‹f_£t
 (*, 
afi_t
, 
‹f_¥efix
 *, , );

80 
	`¥efix_bgp_‹f_ªmove_Æl
 (*);

81 
	`¥efix_bgp_show_¥efix_li°
 (
vty
 *, 
afi_t
, *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/pqueue.c

21 
	~<zebø.h
>

23 
	~"mem‹y.h
"

24 
	~"pqueue.h
"

39 
	#DATA_SIZE
 ( (*))

	)

40 
	#PARENT_OF
(
x
Ë((x - 1Ë/ 2)

	)

41 
	#LEFT_OF
(
x
Ë(2 * x + 1)

	)

42 
	#RIGHT_OF
(
x
Ë(2 * x + 2)

	)

43 
	#HAVE_CHILD
(
x
,
q
Ë(x < (q)->
size
 / 2)

	)

46 
	$åickÀ_up
 (
ödex
, 
pqueue
 *
queue
)

48 *
tmp
;

51 
tmp
 = 
queue
->
¨øy
[
ödex
];

55 
ödex
 > 0 &&

56 (*
queue
->
cmp
Ë(
tmp
, queue->
¨øy
[
	`PARENT_OF
 (
ödex
)]) < 0)

59 
queue
->
¨øy
[
ödex
] = queue->¨øy[
	`PARENT_OF
 (index)];

60 i‡(
queue
->
upd©e
 !
NULL
)

61 (*
queue
->
upd©e
Ë(queue->
¨øy
[
ödex
], index);

62 
ödex
 = 
	`PARENT_OF
 (index);

66 
queue
->
¨øy
[
ödex
] = 
tmp
;

67 i‡(
queue
->
upd©e
 !
NULL
)

68 (*
queue
->
upd©e
Ë(
tmp
, 
ödex
);

69 
	}
}

72 
	$åickÀ_down
 (
ödex
, 
pqueue
 *
queue
)

74 *
tmp
;

75 
which
;

78 
tmp
 = 
queue
->
¨øy
[
ödex
];

81 
	`HAVE_CHILD
 (
ödex
, 
queue
))

85 i‡(
	`RIGHT_OF
 (
ödex
Ë< 
queue
->
size
 &&

86 (*
queue
->
cmp
Ë(queue->
¨øy
[
	`LEFT_OF
 (
ödex
)],

87 
queue
->
¨øy
[
	`RIGHT_OF
 (
ödex
)]) > 0)

88 
which
 = 
	`RIGHT_OF
 (
ödex
);

90 
which
 = 
	`LEFT_OF
 (
ödex
);

93 i‡((*
queue
->
cmp
Ë(queue->
¨øy
[
which
], 
tmp
) > 0)

97 
queue
->
¨øy
[
ödex
] = queue->¨øy[
which
];

98 i‡(
queue
->
upd©e
 !
NULL
)

99 (*
queue
->
upd©e
Ë(queue->
¨øy
[
ödex
], index);

100 
ödex
 = 
which
;

104 
queue
->
¨øy
[
ödex
] = 
tmp
;

105 i‡(
queue
->
upd©e
 !
NULL
)

106 (*
queue
->
upd©e
Ë(
tmp
, 
ödex
);

107 
	}
}

109 
pqueue
 *

110 
	$pqueue_¸óã
 ()

112 
pqueue
 *
queue
;

114 
queue
 = 
	`XCALLOC
 (
MTYPE_PQUEUE
,  (
pqueue
));

116 
queue
->
¨øy
 = 
	`XCALLOC
 (
MTYPE_PQUEUE_DATA
,

117 
DATA_SIZE
 * 
PQUEUE_INIT_ARRAYSIZE
);

118 
queue
->
¨øy_size
 = 
PQUEUE_INIT_ARRAYSIZE
;

121 
queue
->
upd©e
 = 
NULL
;

122  
queue
;

123 
	}
}

126 
	$pqueue_dñëe
 (
pqueue
 *
queue
)

128 
	`XFREE
 (
MTYPE_PQUEUE_DATA
, 
queue
->
¨øy
);

129 
	`XFREE
 (
MTYPE_PQUEUE
, 
queue
);

130 
	}
}

133 
	$pqueue_ex∑nd
 (
pqueue
 *
queue
)

135 **
√w¨øy
;

137 
√w¨øy
 = 
	`XCALLOC
 (
MTYPE_PQUEUE_DATA
, 
queue
->
¨øy_size
 * 
DATA_SIZE
 * 2);

138 i‡(
√w¨øy
 =
NULL
)

141 
	`mem˝y
 (
√w¨øy
, 
queue
->
¨øy
, queue->
¨øy_size
 * 
DATA_SIZE
);

143 
	`XFREE
 (
MTYPE_PQUEUE_DATA
, 
queue
->
¨øy
);

144 
queue
->
¨øy
 = 
√w¨øy
;

145 
queue
->
¨øy_size
 *= 2;

148 
	}
}

151 
	$pqueue_íqueue
 (*
d©a
, 
pqueue
 *
queue
)

153 i‡(
queue
->
size
 + 2 >queue->
¨øy_size
 && ! 
	`pqueue_ex∑nd
 (queue))

156 
queue
->
¨øy
[queue->
size
] = 
d©a
;

157 i‡(
queue
->
upd©e
 !
NULL
)

158 (*
queue
->
upd©e
Ë(
d©a
, queue->
size
);

159 
	`åickÀ_up
 (
queue
->
size
, queue);

160 
queue
->
size
 ++;

161 
	}
}

164 
	$pqueue_dequeue
 (
pqueue
 *
queue
)

166 *
d©a
 = 
queue
->
¨øy
[0];

167 
queue
->
¨øy
[0] = queue->¨øy[--queue->
size
];

168 
	`åickÀ_down
 (0, 
queue
);

169  
d©a
;

170 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/pqueue.h

21 #i‚de‡
_ZEBRA_PQUEUE_H


22 
	#_ZEBRA_PQUEUE_H


	)

24 
	spqueue


26 **
	m¨øy
;

27 
	m¨øy_size
;

28 
	msize
;

30 (*
	mcmp
) (*, *);

31 (*
	mupd©e
Ë(* 
	mnode
, 
	ma˘uÆ_posôi⁄
);

34 
	#PQUEUE_INIT_ARRAYSIZE
 32

	)

36 
pqueue
 *
pqueue_¸óã
 ();

37 
pqueue_dñëe
 (
pqueue
 *
queue
);

39 
pqueue_íqueue
 (*
d©a
, 
pqueue
 *
queue
);

40 *
pqueue_dequeue
 (
pqueue
 *
queue
);

42 
åickÀ_down
 (
ödex
, 
pqueue
 *
queue
);

43 
åickÀ_up
 (
ödex
, 
pqueue
 *
queue
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/prefix.c

23 
	~<zebø.h
>

25 
	~"¥efix.h
"

26 
	~"vty.h
"

27 
	~"sockuni⁄.h
"

28 
	~"mem‹y.h
"

29 
	~"log.h
"

32 c⁄° 
u_ch¨
 
	gmaskbô
[] = {0x00, 0x80, 0xc0, 0xe0, 0xf0,

35 c⁄° 
ö6_addr
 
	gmaskbyãs6
[] =

169 #i‚de‡
PNBBY


170 
	#PNBBY
 8

	)

173 
	#MASKBIT
(
off£t
Ë((0xf‡<< (
PNBBY
 - (off£t))Ë& 0xff)

	)

176 
	$¥efix_bô
 (c⁄° 
u_ch¨
 *
¥efix
, c⁄° u_ch¨ 
¥efixÀn
)

178 
off£t
 = 
¥efixÀn
 / 8;

179 
shi·
 = 7 - (
¥efixÀn
 % 8);

181  (
¥efix
[
off£t
] >> 
shi·
) & 1;

182 
	}
}

185 
	$¥efix6_bô
 (c⁄° 
ö6_addr
 *
¥efix
, c⁄° 
u_ch¨
 
¥efixÀn
)

187  
	`¥efix_bô
((c⁄° 
u_ch¨
 *Ë&
¥efix
->
s6_addr
, 
¥efixÀn
);

188 
	}
}

192 
	$afi2Ámûy
 (
afi_t
 
afi
)

194 i‡(
afi
 =
AFI_IP
)

195  
AF_INET
;

196 #ifde‡
HAVE_IPV6


197 i‡(
afi
 =
AFI_IP6
)

198  
AF_INET6
;

201 
	}
}

203 
afi_t


204 
	$Ámûy2afi
 (
Ámûy
)

206 i‡(
Ámûy
 =
AF_INET
)

207  
AFI_IP
;

208 #ifde‡
HAVE_IPV6


209 i‡(
Ámûy
 =
AF_INET6
)

210  
AFI_IP6
;

213 
	}
}

217 
	$¥efix_m©ch
 (c⁄° 
¥efix
 *
n
, c⁄° ¥efix *
p
)

219 
off£t
;

220 
shi·
;

221 c⁄° 
u_ch¨
 *
≈
, *
µ
;

224 i‡(
n
->
¥efixÀn
 > 
p
->prefixlen)

228 
≈
 = (c⁄° 
u_ch¨
 *)&
n
->
u
.
¥efix
;

229 
µ
 = (c⁄° 
u_ch¨
 *)&
p
->
u
.
¥efix
;

231 
off£t
 = 
n
->
¥efixÀn
 / 
PNBBY
;

232 
shi·
 = 
n
->
¥efixÀn
 % 
PNBBY
;

234 i‡(
shi·
)

235 i‡(
maskbô
[
shi·
] & (
≈
[
off£t
] ^ 
µ
[offset]))

238 
off£t
--)

239 i‡(
≈
[
off£t
] !
µ
[offset])

242 
	}
}

246 
	$¥efix_c›y
 (
¥efix
 *
de°
, c⁄° ¥efix *
§c
)

248 
de°
->
Ámûy
 = 
§c
->family;

249 
de°
->
¥efixÀn
 = 
§c
->prefixlen;

251 i‡(
§c
->
Ámûy
 =
AF_INET
)

252 
de°
->
u
.
¥efix4
 = 
§c
->u.prefix4;

253 #ifde‡
HAVE_IPV6


254 i‡(
§c
->
Ámûy
 =
AF_INET6
)

255 
de°
->
u
.
¥efix6
 = 
§c
->u.prefix6;

257 i‡(
§c
->
Ámûy
 =
AF_UNSPEC
)

259 
de°
->
u
.
Õ
.
id
 = 
§c
->u.lp.id;

260 
de°
->
u
.
Õ
.
adv_rouãr
 = 
§c
->u.lp.adv_router;

264 
	`zlog
 (
NULL
, 
LOG_ERR
, "prefix_copy(): Unknownáddress family %d",

265 
§c
->
Ámûy
);

266 
	`as£π
 (0);

268 
	}
}

279 
	$¥efix_ßme
 (c⁄° 
¥efix
 *
p1
, c⁄° ¥efix *
p2
)

281 i‡(
p1
->
Ámûy
 =
p2
->Ámûy &&Ö1->
¥efixÀn
 ==Ö2->prefixlen)

283 i‡(
p1
->
Ámûy
 =
AF_INET
)

284 i‡(
	`IPV4_ADDR_SAME
 (&
p1
->
u
.
¥efix4
.
s_addr
, &
p2
->u.prefix4.s_addr))

286 #ifde‡
HAVE_IPV6


287 i‡(
p1
->
Ámûy
 =
AF_INET6
 )

288 i‡(
	`IPV6_ADDR_SAME
 (&
p1
->
u
.
¥efix6
.
s6_addr
, &
p2
->u.prefix6.s6_addr))

293 
	}
}

306 
	$¥efix_cmp
 (c⁄° 
¥efix
 *
p1
, c⁄° ¥efix *
p2
)

308 
off£t
;

309 
shi·
;

312 c⁄° 
u_ch¨
 *
µ1
 = (c⁄° u_ch¨ *)&
p1
->
u
.
¥efix
;

313 c⁄° 
u_ch¨
 *
µ2
 = (c⁄° u_ch¨ *)&
p2
->
u
.
¥efix
;

315 i‡(
p1
->
Ámûy
 !
p2
->Ámûy ||Ö1->
¥efixÀn
 !=Ö2->prefixlen)

318 
off£t
 = 
p1
->
¥efixÀn
 / 
PNBBY
;

319 
shi·
 = 
p1
->
¥efixÀn
 % 
PNBBY
;

321 i‡(
shi·
)

322 i‡(
maskbô
[
shi·
] & (
µ1
[
off£t
] ^ 
µ2
[offset]))

325 
off£t
--)

326 i‡(
µ1
[
off£t
] !
µ2
[offset])

330 
	}
}

339 
	$¥efix_comm⁄_bôs
 (c⁄° 
¥efix
 *
p1
, c⁄° ¥efix *
p2
)

341 
pos
, 
bô
;

342 
Àngth
 = 0;

343 
u_ch¨
 
x‹
;

346 c⁄° 
u_ch¨
 *
µ1
 = (c⁄° u_ch¨ *)&
p1
->
u
.
¥efix
;

347 c⁄° 
u_ch¨
 *
µ2
 = (c⁄° u_ch¨ *)&
p2
->
u
.
¥efix
;

349 i‡(
p1
->
Ámûy
 =
AF_INET
)

350 
Àngth
 = 
IPV4_MAX_BYTELEN
;

351 #ifde‡
HAVE_IPV6


352 i‡(
p1
->
Ámûy
 =
AF_INET6
)

353 
Àngth
 = 
IPV6_MAX_BYTELEN
;

355 i‡(
p1
->
Ámûy
 !
p2
->Ámûy || !
Àngth
)

358 
pos
 = 0;Öo†< 
Àngth
;Öos++)

359 i‡(
µ1
[
pos
] !
µ2
[pos])

361 i‡(
pos
 =
Àngth
)

362  
pos
 * 8;

364 
x‹
 = 
µ1
[
pos
] ^ 
µ2
[pos];

365 
bô
 = 0; bit < 8; bit++)

366 i‡(
x‹
 & (1 << (7 - 
bô
)))

369  
pos
 * 8 + 
bô
;

370 
	}
}

374 
	$¥efix_Ámûy_°r
 (c⁄° 
¥efix
 *
p
)

376 i‡(
p
->
Ámûy
 =
AF_INET
)

378 #ifde‡
HAVE_IPV6


379 i‡(
p
->
Ámûy
 =
AF_INET6
)

383 
	}
}

386 
¥efix_ùv4
 *

387 
	$¥efix_ùv4_√w
 ()

389 
¥efix_ùv4
 *
p
;

394 
p
 = (
¥efix_ùv4
 *)
	`¥efix_√w
();

395 
p
->
Ámûy
 = 
AF_INET
;

396  
p
;

397 
	}
}

401 
	$¥efix_ùv4_‰ì
 (
¥efix_ùv4
 *
p
)

403 
	`¥efix_‰ì
((
¥efix
 *)
p
);

404 
	}
}

408 
	$°r2¥efix_ùv4
 (c⁄° *
°r
, 
¥efix_ùv4
 *
p
)

410 
ªt
;

411 
∂í
;

412 *
≤t
;

413 *
˝
;

416 
≤t
 = 
	`°rchr
 (
°r
, '/');

419 i‡(
≤t
 =
NULL
)

422 
ªt
 = 
	`öë_©⁄
 (
°r
, &
p
->
¥efix
);

423 i‡(
ªt
 == 0)

427 
p
->
Ámûy
 = 
AF_INET
;

428 
p
->
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

430  
ªt
;

434 
˝
 = 
	`XMALLOC
 (
MTYPE_TMP
, (
≤t
 - 
°r
) + 1);

435 
	`°∫˝y
 (
˝
, 
°r
, 
≤t
 - str);

436 *(
˝
 + (
≤t
 - 
°r
)) = '\0';

437 
ªt
 = 
	`öë_©⁄
 (
˝
, &
p
->
¥efix
);

438 
	`XFREE
 (
MTYPE_TMP
, 
˝
);

441 
∂í
 = (
u_ch¨
Ë
	`©oi
 (++
≤t
);

442 i‡(
∂í
 > 
IPV4_MAX_PREFIXLEN
)

445 
p
->
Ámûy
 = 
AF_INET
;

446 
p
->
¥efixÀn
 = 
∂í
;

449  
ªt
;

450 
	}
}

454 
	$maskÀn2ù
 (c⁄° 
maskÀn
, 
ö_addr
 *
√tmask
)

456 
	`as£π
 (
maskÀn
 >0 && maskÀ¿<
IPV4_MAX_BITLEN
);

463 
√tmask
->
s_addr
 = 
	`ht⁄l
(0xffffffffULL << (32 - 
maskÀn
));

465 
√tmask
->
s_addr
 = 
	`ht⁄l
(
maskÀn
 ? 0xffffffffU << (32 - masklen) : 0);

466 
	}
}

470 
u_ch¨


471 
	$ù_maskÀn
 (
ö_addr
 
√tmask
)

473 
uöt32_t
 
tmp
 = ~
	`¡ohl
(
√tmask
.
s_addr
);

474 i‡(
tmp
)

477  
	`__buûtö_˛z
(
tmp
);

480 
	}
}

484 
	$≠∂y_mask_ùv4
 (
¥efix_ùv4
 *
p
)

486 
ö_addr
 
mask
;

487 
	`maskÀn2ù
(
p
->
¥efixÀn
, &
mask
);

488 
p
->
¥efix
.
s_addr
 &
mask
.s_addr;

489 
	}
}

493 
	$¥efix_ùv4_™y
 (c⁄° 
¥efix_ùv4
 *
p
)

495  (
p
->
¥efix
.
s_addr
 =0 &&Ö->
¥efixÀn
 == 0);

496 
	}
}

498 #ifde‡
HAVE_IPV6


501 
¥efix_ùv6
 *

502 
	$¥efix_ùv6_√w
 ()

504 
¥efix_ùv6
 *
p
;

508 
p
 = (
¥efix_ùv6
 *)
	`¥efix_√w
();

509 
p
->
Ámûy
 = 
AF_INET6
;

510  
p
;

511 
	}
}

515 
	$¥efix_ùv6_‰ì
 (
¥efix_ùv6
 *
p
)

517 
	`¥efix_‰ì
((
¥efix
 *)
p
);

518 
	}
}

522 
	$°r2¥efix_ùv6
 (c⁄° *
°r
, 
¥efix_ùv6
 *
p
)

524 *
≤t
;

525 *
˝
;

526 
ªt
;

528 
≤t
 = 
	`°rchr
 (
°r
, '/');

531 i‡(
≤t
 =
NULL
)

533 
ªt
 = 
	`öë_±⁄
 (
AF_INET6
, 
°r
, &
p
->
¥efix
);

534 i‡(
ªt
 == 0)

536 
p
->
¥efixÀn
 = 
IPV6_MAX_BITLEN
;

540 
∂í
;

542 
˝
 = 
	`XMALLOC
 (0, (
≤t
 - 
°r
) + 1);

543 
	`°∫˝y
 (
˝
, 
°r
, 
≤t
 - str);

544 *(
˝
 + (
≤t
 - 
°r
)) = '\0';

545 
ªt
 = 
	`öë_±⁄
 (
AF_INET6
, 
˝
, &
p
->
¥efix
);

546 
	`‰ì
 (
˝
);

547 i‡(
ªt
 == 0)

549 
∂í
 = (
u_ch¨
Ë
	`©oi
 (++
≤t
);

550 i‡(
∂í
 > 
IPV6_MAX_BITLEN
)

552 
p
->
¥efixÀn
 = 
∂í
;

554 
p
->
Ámûy
 = 
AF_INET6
;

556  
ªt
;

557 
	}
}

562 
	$ù6_maskÀn
 (
ö6_addr
 
√tmask
)

564 
Àn
 = 0;

565 
vÆ
;

566 *
≤t
;

568 
≤t
 = (*Ë& 
√tmask
;

570 (*
≤t
 =0xffË&& 
Àn
 < 
IPV6_MAX_BITLEN
)

572 
Àn
 += 8;

573 
≤t
++;

576 i‡(
Àn
 < 
IPV6_MAX_BITLEN
)

578 
vÆ
 = *
≤t
;

579 
vÆ
)

581 
Àn
++;

582 
vÆ
 <<= 1;

585  
Àn
;

586 
	}
}

589 
	$maskÀn2ù6
 (c⁄° 
maskÀn
, 
ö6_addr
 *
√tmask
)

591 
	`as£π
 (
maskÀn
 >0 && maskÀ¿<
IPV6_MAX_BITLEN
);

592 
	`mem˝y
 (
√tmask
, 
maskbyãs6
 + 
maskÀn
,  (
ö6_addr
));

593 
	}
}

596 
	$≠∂y_mask_ùv6
 (
¥efix_ùv6
 *
p
)

598 
u_ch¨
 *
≤t
;

599 
ödex
;

600 
off£t
;

602 
ödex
 = 
p
->
¥efixÀn
 / 8;

604 i‡(
ödex
 < 16)

606 
≤t
 = (
u_ch¨
 *Ë&
p
->
¥efix
;

607 
off£t
 = 
p
->
¥efixÀn
 % 8;

609 
≤t
[
ödex
] &
maskbô
[
off£t
];

610 
ödex
++;

612 
ödex
 < 16)

613 
≤t
[
ödex
++] = 0;

615 
	}
}

618 
	$°r2ö6_addr
 (c⁄° *
°r
, 
ö6_addr
 *
addr
)

620 
i
;

621 
x
;

624 
i
 = 0; i < 16; i++)

626 
	`ssˇnf
 (
°r
 + (
i
 * 2), "%02x", &
x
);

627 
addr
->
s6_addr
[
i
] = 
x
 & 0xff;

629 
	}
}

633 
	$≠∂y_mask
 (
¥efix
 *
p
)

635 
p
->
Ámûy
)

637 
AF_INET
:

638 
	`≠∂y_mask_ùv4
 ((
¥efix_ùv4
 *)
p
);

640 #ifde‡
HAVE_IPV6


641 
AF_INET6
:

642 
	`≠∂y_mask_ùv6
 ((
¥efix_ùv6
 *)
p
);

649 
	}
}

653 
¥efix
 *

654 
	$sockuni⁄2¥efix
 (c⁄° 
sockuni⁄
 *
de°
,

655 c⁄° 
sockuni⁄
 *
mask
)

657 i‡(
de°
->
ß
.
ß_Ámûy
 =
AF_INET
)

659 
¥efix_ùv4
 *
p
;

661 
p
 = 
	`¥efix_ùv4_√w
 ();

662 
p
->
Ámûy
 = 
AF_INET
;

663 
p
->
¥efix
 = 
de°
->
sö
.
sö_addr
;

664 
p
->
¥efixÀn
 = 
	`ù_maskÀn
 (
mask
->
sö
.
sö_addr
);

665  (
¥efix
 *Ë
p
;

667 #ifde‡
HAVE_IPV6


668 i‡(
de°
->
ß
.
ß_Ámûy
 =
AF_INET6
)

670 
¥efix_ùv6
 *
p
;

672 
p
 = 
	`¥efix_ùv6_√w
 ();

673 
p
->
Ámûy
 = 
AF_INET6
;

674 
p
->
¥efixÀn
 = 
	`ù6_maskÀn
 (
mask
->
sö6
.
sö6_addr
);

675 
	`mem˝y
 (&
p
->
¥efix
, &
de°
->
sö6
.
sö6_addr
,  (
ö6_addr
));

676  (
¥efix
 *Ë
p
;

679  
NULL
;

680 
	}
}

683 
¥efix
 *

684 
	$sockuni⁄2ho°¥efix
 (c⁄° 
sockuni⁄
 *
su
)

686 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET
)

688 
¥efix_ùv4
 *
p
;

690 
p
 = 
	`¥efix_ùv4_√w
 ();

691 
p
->
Ámûy
 = 
AF_INET
;

692 
p
->
¥efix
 = 
su
->
sö
.
sö_addr
;

693 
p
->
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

694  (
¥efix
 *Ë
p
;

696 #ifde‡
HAVE_IPV6


697 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET6
)

699 
¥efix_ùv6
 *
p
;

701 
p
 = 
	`¥efix_ùv6_√w
 ();

702 
p
->
Ámûy
 = 
AF_INET6
;

703 
p
->
¥efixÀn
 = 
IPV6_MAX_BITLEN
;

704 
	`mem˝y
 (&
p
->
¥efix
, &
su
->
sö6
.
sö6_addr
,  (
ö6_addr
));

705  (
¥efix
 *Ë
p
;

708  
NULL
;

709 
	}
}

712 
	$¥efix2sockuni⁄
 (c⁄° 
¥efix
 *
p
, 
sockuni⁄
 *
su
)

714 
	`mem£t
 (
su
, 0,  (*su));

716 
su
->
ß
.
ß_Ámûy
 = 
p
->
Ámûy
;

717 i‡(
p
->
Ámûy
 =
AF_INET
)

718 
su
->
sö
.
sö_addr
 = 
p
->
u
.
¥efix4
;

719 #ifde‡
HAVE_IPV6


720 i‡(
p
->
Ámûy
 =
AF_INET6
)

721 
	`mem˝y
 (&
su
->
sö6
.
sö6_addr
, &
p
->
u
.
¥efix6
,  (
ö6_addr
));

723 
	}
}

726 
	$¥efix_bÀn
 (c⁄° 
¥efix
 *
p
)

728 
p
->
Ámûy
)

730 
AF_INET
:

731  
IPV4_MAX_BYTELEN
;

733 #ifde‡
HAVE_IPV6


734 
AF_INET6
:

735  
IPV6_MAX_BYTELEN
;

740 
	}
}

744 
	$°r2¥efix
 (c⁄° *
°r
, 
¥efix
 *
p
)

746 
ªt
;

749 
ªt
 = 
	`°r2¥efix_ùv4
 (
°r
, (
¥efix_ùv4
 *Ë
p
);

750 i‡(
ªt
)

751  
ªt
;

753 #ifde‡
HAVE_IPV6


755 
ªt
 = 
	`°r2¥efix_ùv6
 (
°r
, (
¥efix_ùv6
 *Ë
p
);

756 i‡(
ªt
)

757  
ªt
;

761 
	}
}

764 
	$¥efix2°r
 (c⁄° 
¥efix
 *
p
, *
°r
, 
size
)

766 
buf
[
BUFSIZ
];

768 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
BUFSIZ
);

769 
	`¢¥ötf
 (
°r
, 
size
, "%s/%d", 
buf
, 
p
->
¥efixÀn
);

771 
	}
}

773 
¥efix
 *

774 
	$¥efix_√w
 ()

776 
¥efix
 *
p
;

778 
p
 = 
	`XCALLOC
 (
MTYPE_PREFIX
,  *p);

779  
p
;

780 
	}
}

784 
	$¥efix_‰ì
 (
¥efix
 *
p
)

786 
	`XFREE
 (
MTYPE_PREFIX
, 
p
);

787 
	}
}

793 
	$Æl_digô
 (c⁄° *
°r
)

795 ; *
°r
 != '\0'; str++)

796 i‡(!
	`isdigô
 ((Ë*
°r
))

799 
	}
}

802 
	$≠∂y_˛assful_mask_ùv4
 (
¥efix_ùv4
 *
p
)

805 
u_öt32_t
 
de°ö©i⁄
;

807 
de°ö©i⁄
 = 
	`¡ohl
 (
p
->
¥efix
.
s_addr
);

809 i‡(
p
->
¥efixÀn
 =
IPV4_MAX_PREFIXLEN
);

811 i‡(
	`IN_CLASSC
 (
de°ö©i⁄
))

813 
p
->
¥efixÀn
=24;

814 
	`≠∂y_mask_ùv4
(
p
);

816 i‡(
	`IN_CLASSB
(
de°ö©i⁄
))

818 
p
->
¥efixÀn
=16;

819 
	`≠∂y_mask_ùv4
(
p
);

823 
p
->
¥efixÀn
=8;

824 
	`≠∂y_mask_ùv4
(
p
);

826 
	}
}

828 
ö_addr_t


829 
	$ùv4_√tw‹k_addr
 (
ö_addr_t
 
ho°addr
, 
maskÀn
)

831 
ö_addr
 
mask
;

833 
	`maskÀn2ù
 (
maskÀn
, &
mask
);

834  
ho°addr
 & 
mask
.
s_addr
;

835 
	}
}

837 
ö_addr_t


838 
	$ùv4_brﬂdˇ°_addr
 (
ö_addr_t
 
ho°addr
, 
maskÀn
)

840 
ö_addr
 
mask
;

842 
	`maskÀn2ù
 (
maskÀn
, &
mask
);

843  (
maskÀn
 !
IPV4_MAX_PREFIXLEN
-1) ?

845 (
ho°addr
 | ~
mask
.
s_addr
) :

847 (
ho°addr
 ^ ~
mask
.
s_addr
);

848 
	}
}

854 
	$√tmask_°r2¥efix_°r
 (c⁄° *
√t_°r
, c⁄° *
mask_°r
,

855 *
¥efix_°r
)

857 
ö_addr
 
√tw‹k
;

858 
ö_addr
 
mask
;

859 
u_ch¨
 
¥efixÀn
;

860 
u_öt32_t
 
de°ö©i⁄
;

861 
ªt
;

863 
ªt
 = 
	`öë_©⁄
 (
√t_°r
, &
√tw‹k
);

864 i‡(! 
ªt
)

867 i‡(
mask_°r
)

869 
ªt
 = 
	`öë_©⁄
 (
mask_°r
, &
mask
);

870 i‡(! 
ªt
)

873 
¥efixÀn
 = 
	`ù_maskÀn
 (
mask
);

877 
de°ö©i⁄
 = 
	`¡ohl
 (
√tw‹k
.
s_addr
);

879 i‡(
√tw‹k
.
s_addr
 == 0)

880 
¥efixÀn
 = 0;

881 i‡(
	`IN_CLASSC
 (
de°ö©i⁄
))

882 
¥efixÀn
 = 24;

883 i‡(
	`IN_CLASSB
 (
de°ö©i⁄
))

884 
¥efixÀn
 = 16;

885 i‡(
	`IN_CLASSA
 (
de°ö©i⁄
))

886 
¥efixÀn
 = 8;

891 
	`•rötf
 (
¥efix_°r
, "%s/%d", 
√t_°r
, 
¥efixÀn
);

894 
	}
}

896 #ifde‡
HAVE_IPV6


899 
	$öë6_¡ﬂ
 (
ö6_addr
 
addr
)

901 
buf
[
INET6_ADDRSTRLEN
];

903 
	`öë_¡›
 (
AF_INET6
, &
addr
, 
buf
, 
INET6_ADDRSTRLEN
);

904  
buf
;

905 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/prefix.h

23 #i‚de‡
_ZEBRA_PREFIX_H


24 
	#_ZEBRA_PREFIX_H


	)

26 
	~"sockuni⁄.h
"

38 
	s¥efix


40 
u_ch¨
 
	mÁmûy
;

41 
u_ch¨
 
	m¥efixÀn
;

44 
u_ch¨
 
	m¥efix
;

45 
ö_addr
 
	m¥efix4
;

46 #ifde‡
HAVE_IPV6


47 
ö6_addr
 
	m¥efix6
;

51 
ö_addr
 
	mid
;

52 
ö_addr
 
	madv_rouãr
;

53 } 
	mÕ
;

54 
u_ch¨
 
	mvÆ
[8];

55 } 
u
 
__©åibuã__
 ((
Æig√d
 (8)));

59 
	s¥efix_ùv4


61 
u_ch¨
 
	mÁmûy
;

62 
u_ch¨
 
	m¥efixÀn
;

63 
ö_addr
 
¥efix
 
__©åibuã__
 ((
Æig√d
 (8)));

67 #ifde‡
HAVE_IPV6


68 
	s¥efix_ùv6


70 
u_ch¨
 
	mÁmûy
;

71 
u_ch¨
 
	m¥efixÀn
;

72 
ö6_addr
 
¥efix
 
__©åibuã__
 ((
Æig√d
 (8)));

76 
	s¥efix_ls


78 
u_ch¨
 
	mÁmûy
;

79 
u_ch¨
 
	m¥efixÀn
;

80 
ö_addr
 
id
 
__©åibuã__
 ((
Æig√d
 (8)));

81 
ö_addr
 
	madv_rouãr
;

85 
	s¥efix_rd


87 
u_ch¨
 
	mÁmûy
;

88 
u_ch¨
 
	m¥efixÀn
;

89 
u_ch¨
 
	mvÆ
[8] 
__©åibuã__
 ((
Æig√d
 (8)));

92 #i‚de‡
INET_ADDRSTRLEN


93 
	#INET_ADDRSTRLEN
 16

	)

96 #i‚de‡
INET6_ADDRSTRLEN


97 
	#INET6_ADDRSTRLEN
 46

	)

100 #i‚de‡
INET6_BUFSIZ


101 
	#INET6_BUFSIZ
 51

	)

105 
	#IPV4_MAX_BYTELEN
 4

	)

106 
	#IPV4_MAX_BITLEN
 32

	)

107 
	#IPV4_MAX_PREFIXLEN
 32

	)

108 
	#IPV4_ADDR_CMP
(
D
,
S
Ë
	`memcmp
 ((D), (S), 
IPV4_MAX_BYTELEN
)

	)

109 
	#IPV4_ADDR_SAME
(
D
,
S
Ë(
	`memcmp
 ((D), (S), 
IPV4_MAX_BYTELEN
Ë=0)

	)

110 
	#IPV4_ADDR_COPY
(
D
,
S
Ë
	`mem˝y
 ((D), (S), 
IPV4_MAX_BYTELEN
)

	)

112 
	#IPV4_NET0
(
a
Ë((((
u_öt32_t
Ë◊)Ë& 0xff000000Ë=0x00000000)

	)

113 
	#IPV4_NET127
(
a
Ë((((
u_öt32_t
Ë◊)Ë& 0xff000000Ë=0x7f000000)

	)

114 
	#IPV4_LINKLOCAL
(
a
Ë((((
u_öt32_t
Ë◊)Ë& 0xffff0000Ë=0xa9„0000)

	)

115 
	#IPV4_CLASS_DE
(
a
Ë((((
u_öt32_t
Ë◊)Ë& 0xe0000000Ë=0xe0000000)

	)

118 
	#IPV6_MAX_BYTELEN
 16

	)

119 
	#IPV6_MAX_BITLEN
 128

	)

120 
	#IPV6_MAX_PREFIXLEN
 128

	)

121 
	#IPV6_ADDR_CMP
(
D
,
S
Ë
	`memcmp
 ((D), (S), 
IPV6_MAX_BYTELEN
)

	)

122 
	#IPV6_ADDR_SAME
(
D
,
S
Ë(
	`memcmp
 ((D), (S), 
IPV6_MAX_BYTELEN
Ë=0)

	)

123 
	#IPV6_ADDR_COPY
(
D
,
S
Ë
	`mem˝y
 ((D), (S), 
IPV6_MAX_BYTELEN
)

	)

126 
	#PSIZE
(
a
Ë((◊Ë+ 7Ë/ (8))

	)

129 
	#PREFIX_FAMILY
(
p
Ë(’)->
Ámûy
)

	)

132 
afi2Ámûy
 (
afi_t
);

133 
afi_t
 
Ámûy2afi
 ();

136 
¥efix_bô
 (c⁄° 
u_ch¨
 *
¥efix
, c⁄° u_ch¨ 
¥efixÀn
);

137 
¥efix6_bô
 (c⁄° 
ö6_addr
 *
¥efix
, c⁄° 
u_ch¨
 
¥efixÀn
);

139 
¥efix
 *
¥efix_√w
 ();

140 
¥efix_‰ì
 (
¥efix
 *);

141 c⁄° *
¥efix_Ámûy_°r
 (c⁄° 
¥efix
 *);

142 
¥efix_bÀn
 (c⁄° 
¥efix
 *);

143 
°r2¥efix
 (c⁄° *, 
¥efix
 *);

144 
¥efix2°r
 (c⁄° 
¥efix
 *, *, );

145 
¥efix_m©ch
 (c⁄° 
¥efix
 *, const prefix *);

146 
¥efix_ßme
 (c⁄° 
¥efix
 *, const prefix *);

147 
¥efix_cmp
 (c⁄° 
¥efix
 *, const prefix *);

148 
¥efix_comm⁄_bôs
 (c⁄° 
¥efix
 *, const prefix *);

149 
¥efix_c›y
 (
¥efix
 *
de°
, c⁄° ¥efix *
§c
);

150 
≠∂y_mask
 (
¥efix
 *);

152 
¥efix
 *
sockuni⁄2¥efix
 (c⁄° 
sockuni⁄
 *
de°
,

153 c⁄° 
sockuni⁄
 *
mask
);

154 
¥efix
 *
sockuni⁄2ho°¥efix
 (c⁄° 
sockuni⁄
 *);

155 
¥efix2sockuni⁄
 (c⁄° 
¥efix
 *, 
sockuni⁄
 *);

157 
¥efix_ùv4
 *
¥efix_ùv4_√w
 ();

158 
¥efix_ùv4_‰ì
 (
¥efix_ùv4
 *);

159 
°r2¥efix_ùv4
 (c⁄° *, 
¥efix_ùv4
 *);

160 
≠∂y_mask_ùv4
 (
¥efix_ùv4
 *);

162 
	#PREFIX_COPY_IPV4
(
DST
, 
SRC
) \

163 *((
¥efix_ùv4
 *)(
DST
)Ë*((c⁄° ¥efix_ùv4 *)(
SRC
));

	)

165 
¥efix_ùv4_™y
 (c⁄° 
¥efix_ùv4
 *);

166 
≠∂y_˛assful_mask_ùv4
 (
¥efix_ùv4
 *);

168 
u_ch¨
 
ù_maskÀn
 (
ö_addr
);

169 
maskÀn2ù
 (c⁄° , 
ö_addr
 *);

171 
ö_addr_t
 
ùv4_√tw‹k_addr
 (ö_addr_à
ho°addr
, 
maskÀn
);

176 
ö_addr_t
 
ùv4_brﬂdˇ°_addr
 (ö_addr_à
ho°addr
, 
maskÀn
);

178 
√tmask_°r2¥efix_°r
 (const *, const *, *);

180 #ifde‡
HAVE_IPV6


181 
¥efix_ùv6
 *
¥efix_ùv6_√w
 ();

182 
¥efix_ùv6_‰ì
 (
¥efix_ùv6
 *);

183 
°r2¥efix_ùv6
 (c⁄° *, 
¥efix_ùv6
 *);

184 
≠∂y_mask_ùv6
 (
¥efix_ùv6
 *);

186 
	#PREFIX_COPY_IPV6
(
DST
, 
SRC
) \

187 *((
¥efix_ùv6
 *)(
DST
)Ë*((c⁄° ¥efix_ùv6 *)(
SRC
));

	)

189 
ù6_maskÀn
 (
ö6_addr
);

190 
maskÀn2ù6
 (c⁄° , 
ö6_addr
 *);

192 
°r2ö6_addr
 (c⁄° *, 
ö6_addr
 *);

193 c⁄° *
öë6_¡ﬂ
 (
ö6_addr
);

197 
Æl_digô
 (const *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/privs.c

24 
	~<zebø.h
>

25 
	~"log.h
"

26 
	~"¥ivs.h
"

27 
	~"mem‹y.h
"

29 #ifde‡
HAVE_CAPABILITIES


41 #ifde‡
HAVE_LCAPS


43 
	s_p£t
 {

44 
	mnum
;

45 
ˇp_vÆue_t
 *
	mˇps
;

47 
ˇp_vÆue_t
 
	tpvÆue_t
;

48 
_p£t
 
	tp£t_t
;

49 
ˇp_t
 
	tp°‹age_t
;

51 #ñi‡
deföed
 (
HAVE_SOLARIS_CAPABILITIES
)

52 
¥iv_t
 
	tpvÆue_t
;

53 
¥iv_£t_t
 
	tp£t_t
;

54 
¥iv_£t_t
 *
	tp°‹age_t
;

63 
zebø_¥ivs_cuºít_t
 
	gz¥ivs_nuŒ_°©e
 = 
ZPRIVS_RAISED
;

66 
	s_z¥ivs_t


68 #ifde‡
HAVE_CAPABILITIES


69 
p°‹age_t
 
	mˇps
;

70 
p£t_t
 *
	msysˇps_p
;

71 
p£t_t
 *
	msysˇps_i
;

73 
uid_t
 
	mzuid
,

74 
	mzsuid
;

75 
gid_t
 
	mzgid
;

76 
gid_t
 
	mvtygΩ
;

77 } 
	gz¥ivs_°©e
;

80 #ifde‡
HAVE_CAPABILITIES


81 
z¥ivs_ch™ge_ˇps
 (
zebø_¥ivs_›s_t
);

82 
zebø_¥ivs_cuºít_t
 
z¥ivs_°©e_ˇps
 ();

84 
z¥ivs_ch™ge_uid
 (
zebø_¥ivs_›s_t
);

85 
zebø_¥ivs_cuºít_t
 
z¥ivs_°©e_uid
 ();

86 
z¥ivs_ch™ge_nuŒ
 (
zebø_¥ivs_›s_t
);

87 
zebø_¥ivs_cuºít_t
 
z¥ivs_°©e_nuŒ
 ();

89 #ifde‡
HAVE_CAPABILITIES


91 
p£t_t
 *
zˇps2sys
 (
zebø_ˇ∑bûôõs_t
 *, );

92 
z¥ivs_ˇps_öô
 (
zebø_¥ivs_t
 *);

93 
z¥ivs_ˇps_ãrmö©e
 ();

98 
	mnum
;

99 
pvÆue_t
 *
	msy°em_ˇps
;

100 } 
	gˇp_m≠
 [
ZCAP_MAX
] =

102 #ifde‡
HAVE_LCAPS


103 [
ZCAP_SETID
] = { 2, (
pvÆue_t
 []Ë{ 
CAP_SETGID
,

104 
CAP_SETUID
 }, },

105 [
ZCAP_BIND
] = { 2, (
pvÆue_t
 []Ë{ 
CAP_NET_BIND_SERVICE
,

106 
CAP_NET_BROADCAST
 }, },

107 [
ZCAP_NET_ADMIN
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_NET_ADMIN
 }, },

108 [
ZCAP_NET_RAW
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_NET_RAW
 }, },

109 [
ZCAP_CHROOT
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_SYS_CHROOT
, }, },

110 [
ZCAP_NICE
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_SYS_NICE
 }, },

111 [
ZCAP_PTRACE
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_SYS_PTRACE
 }, },

112 [
ZCAP_DAC_OVERRIDE
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_DAC_OVERRIDE
 }, },

113 [
ZCAP_READ_SEARCH
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_DAC_READ_SEARCH
 }, },

114 [
ZCAP_SYS_ADMIN
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_SYS_ADMIN
 }, },

115 [
ZCAP_FOWNER
] = { 1, (
pvÆue_t
 []Ë{ 
CAP_FOWNER
 }, },

116 #ñi‡
deföed
(
HAVE_SOLARIS_CAPABILITIES
)

118 [
ZCAP_SETID
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_PROC_SETID
 }, },

119 [
ZCAP_BIND
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_NET_PRIVADDR
 }, },

121 #ifde‡
PRIV_SYS_IP_CONFIG


122 [
ZCAP_NET_ADMIN
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_SYS_IP_CONFIG
 }, },

124 [
ZCAP_NET_ADMIN
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_SYS_NET_CONFIG
 }, },

126 [
ZCAP_NET_RAW
] = { 2, (
pvÆue_t
 []Ë{ 
PRIV_NET_RAWACCESS
,

127 
PRIV_NET_ICMPACCESS
 }, },

128 [
ZCAP_CHROOT
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_PROC_CHROOT
 }, },

129 [
ZCAP_NICE
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_PROC_PRIOCNTL
 }, },

130 [
ZCAP_PTRACE
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_PROC_SESSION
 }, },

131 [
ZCAP_DAC_OVERRIDE
] = { 2, (
pvÆue_t
 []Ë{ 
PRIV_FILE_DAC_EXECUTE
,

132 
PRIV_FILE_DAC_READ
,

133 
PRIV_FILE_DAC_SEARCH
,

134 
PRIV_FILE_DAC_WRITE
,

135 
PRIV_FILE_DAC_SEARCH
 }, },

136 [
ZCAP_READ_SEARCH
] = { 2, (
pvÆue_t
 []Ë{ 
PRIV_FILE_DAC_SEARCH
,

137 
PRIV_FILE_DAC_READ
 }, },

138 [
ZCAP_SYS_ADMIN
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_SYS_ADMIN
 }, },

139 [
ZCAP_FOWNER
] = { 1, (
pvÆue_t
 []Ë{ 
PRIV_FILE_OWNER
 }, },

143 #ifde‡
HAVE_LCAPS


146 
p£t_t
 *

147 
	$zˇps2sys
 (
zebø_ˇ∑bûôõs_t
 *
zˇps
, 
num
)

149 
p£t_t
 *
sysˇps
;

150 
i
, 
j
 = 0, 
cou¡
 = 0;

152 i‡(!
num
)

153  
NULL
;

156 
i
0; i < 
num
; i++)

157 
cou¡
 +
ˇp_m≠
[
zˇps
[
i
]].
num
;

159 i‡–(
sysˇps
 = 
	`XCALLOC
 (
MTYPE_PRIVS
, ((
p£t_t
Ë* 
num
))Ë=
NULL
)

161 
	`Ârötf
 (
°dîr
, "%s: couldÇŸáŒoˇã sysˇps!", 
__func__
);

162  
NULL
;

165 
sysˇps
->
ˇps
 = 
	`XCALLOC
 (
MTYPE_PRIVS
, ( (
pvÆue_t
Ë* 
cou¡
));

167 i‡(!
sysˇps
->
ˇps
)

169 
	`Ârötf
 (
°dîr
, "%s: couldÇŸ XCALLOC c≠s!", 
__func__
);

170  
NULL
;

174 
cou¡
 = 0;

175 
i
=0; i < 
num
; i++)

176 
j
 = 0; j < 
ˇp_m≠
[
zˇps
[
i
]].
num
; j++)

177 
sysˇps
->
ˇps
[
cou¡
++] = 
ˇp_m≠
[
zˇps
[
i
]].
sy°em_ˇps
[
j
];

180 
sysˇps
->
num
 = 
cou¡
;

182  
sysˇps
;

183 
	}
}

187 
	$z¥ivs_ch™ge_ˇps
 (
zebø_¥ivs_›s_t
 
›
)

189 
ˇp_Êag_vÆue_t
 
cÊag
;

192 
	`as£π
 (
z¥ivs_°©e
.
sysˇps_p
 && z¥ivs_°©e.
ˇps
);

193 i‡(! (
z¥ivs_°©e
.
sysˇps_p
 && z¥ivs_°©e.
ˇps
))

194 
	`exô
 (1);

196 i‡(
›
 =
ZPRIVS_RAISE
)

197 
cÊag
 = 
CAP_SET
;

198 i‡(
›
 =
ZPRIVS_LOWER
)

199 
cÊag
 = 
CAP_CLEAR
;

203 i‡–!
	`ˇp_£t_Êag
 (
z¥ivs_°©e
.
ˇps
, 
CAP_EFFECTIVE
,

204 
z¥ivs_°©e
.
sysˇps_p
->
num
,

205 
z¥ivs_°©e
.
sysˇps_p
->
ˇps
,

206 
cÊag
))

207  
	`ˇp_£t_¥oc
 (
z¥ivs_°©e
.
ˇps
);

209 
	}
}

211 
zebø_¥ivs_cuºít_t


212 
	$z¥ivs_°©e_ˇps
 ()

214 
i
;

215 
ˇp_Êag_vÆue_t
 
vÆ
;

218 
	`as£π
 (
z¥ivs_°©e
.
sysˇps_p
 && z¥ivs_°©e.
ˇps
);

219 i‡(! (
z¥ivs_°©e
.
sysˇps_p
 && z¥ivs_°©e.
ˇps
))

220 
	`exô
 (1);

222 
i
=0; i < 
z¥ivs_°©e
.
sysˇps_p
->
num
; i++)

224 i‡–
	`ˇp_gë_Êag
 (
z¥ivs_°©e
.
ˇps
, z¥ivs_°©e.
sysˇps_p
->ˇps[
i
],

225 
CAP_EFFECTIVE
, &
vÆ
) )

227 
	`zlog_w¨n
 ("zprivs_state_caps: couldÇot cap_get_flag, %s",

228 
	`ß„_°ªº‹
 (
î∫o
) );

229  
ZPRIVS_UNKNOWN
;

231 i‡(
vÆ
 =
CAP_SET
)

232  
ZPRIVS_RAISED
;

234  
ZPRIVS_LOWERED
;

235 
	}
}

238 
	$z¥ivs_ˇps_öô
 (
zebø_¥ivs_t
 *
z¥ivs
)

240 
z¥ivs_°©e
.
sysˇps_p
 = 
	`zˇps2sys
 (
z¥ivs
->
ˇps_p
, z¥ivs->
ˇp_num_p
);

241 
z¥ivs_°©e
.
sysˇps_i
 = 
	`zˇps2sys
 (
z¥ivs
->
ˇps_i
, z¥ivs->
ˇp_num_i
);

244 i‡–
	`¥˘l
(
PR_SET_KEEPCAPS
, 1, 0, 0, 0) == -1 )

246 
	`Ârötf
 (
°dîr
, "privs_init: couldÇot set PR_SET_KEEPCAPS, %s\n",

247 
	`ß„_°ªº‹
 (
î∫o
) );

248 
	`exô
(1);

251 i‡–!
z¥ivs_°©e
.
sysˇps_p
 )

253 
	`Ârötf
 (
°dîr
, "privs_init: capabilitiesÉnabled, "

258 i‡(
z¥ivs_°©e
.
zuid
)

260 i‡–
	`£åeuid
 (
z¥ivs_°©e
.
zuid
, zprivs_state.zuid) )

262 
	`Ârötf
 (
°dîr
, "zprivs_init (cap): couldÇot setreuid, %s\n",

263 
	`ß„_°ªº‹
 (
î∫o
));

264 
	`exô
 (1);

268 i‡–!(
z¥ivs_°©e
.
ˇps
 = 
	`ˇp_öô
()) )

270 
	`Ârötf
 (
°dîr
, "privs_init: failedÅo cap_init, %s\n",

271 
	`ß„_°ªº‹
 (
î∫o
));

272 
	`exô
 (1);

275 i‡–
	`ˇp_˛ór
 (
z¥ivs_°©e
.
ˇps
) )

277 
	`Ârötf
 (
°dîr
, "privs_init: failedÅo cap_clear, %s\n",

278 
	`ß„_°ªº‹
 (
î∫o
));

279 
	`exô
 (1);

283 
	`ˇp_£t_Êag
(
z¥ivs_°©e
.
ˇps
, 
CAP_PERMITTED
,

284 
z¥ivs_°©e
.
sysˇps_p
->
num
,

285 
z¥ivs_°©e
.
sysˇps_p
->
ˇps
,

286 
CAP_SET
);

289 i‡(
z¥ivs_°©e
.
sysˇps_i
 && z¥ivs_°©e.sysˇps_i->
num
)

291 
	`ˇp_£t_Êag
(
z¥ivs_°©e
.
ˇps
, 
CAP_INHERITABLE
,

292 
z¥ivs_°©e
.
sysˇps_i
->
num
,

293 
z¥ivs_°©e
.
sysˇps_i
->
ˇps
,

294 
CAP_SET
);

300 i‡–
	`ˇp_£t_¥oc
 (
z¥ivs_°©e
.
ˇps
) )

302 
	`Ârötf
 (
°dîr
, "privs_init: initial cap_set_proc failed\n");

303 
	`exô
 (1);

307 
z¥ivs
->
ch™ge
 = 
z¥ivs_ch™ge_ˇps
;

308 
z¥ivs
->
cuºít_°©e
 = 
z¥ivs_°©e_ˇps
;

309 
	}
}

312 
	$z¥ivs_ˇps_ãrmö©e
 ()

315 i‡(
z¥ivs_°©e
.
ˇps
)

316 
	`ˇp_˛ór
 (
z¥ivs_°©e
.
ˇps
);

319 i‡–
	`ˇp_£t_¥oc
 (
z¥ivs_°©e
.
ˇps
) )

321 
	`Ârötf
 (
°dîr
, "privs_terminate: cap_set_proc failed, %s",

322 
	`ß„_°ªº‹
 (
î∫o
) );

323 
	`exô
 (1);

327 i‡(
z¥ivs_°©e
.
sysˇps_p
->
num
)

329 
	`XFREE
 (
MTYPE_PRIVS
, 
z¥ivs_°©e
.
sysˇps_p
->
ˇps
);

330 
	`XFREE
 (
MTYPE_PRIVS
, 
z¥ivs_°©e
.
sysˇps_p
);

333 i‡(
z¥ivs_°©e
.
sysˇps_i
 && z¥ivs_°©e.sysˇps_i->
num
)

335 
	`XFREE
 (
MTYPE_PRIVS
, 
z¥ivs_°©e
.
sysˇps_i
->
ˇps
);

336 
	`XFREE
 (
MTYPE_PRIVS
, 
z¥ivs_°©e
.
sysˇps_i
);

339 
	`ˇp_‰ì
 (
z¥ivs_°©e
.
ˇps
);

340 
	}
}

341 #ñi‡
deföed
 (
HAVE_SOLARIS_CAPABILITIES
)

352 
p£t_t
 *

353 
	$zˇps2sys
 (
zebø_ˇ∑bûôõs_t
 *
zˇps
, 
num
)

355 
p£t_t
 *
sysˇps
;

356 
i
, 
j
 = 0;

358 i‡((
sysˇps
 = 
	`¥iv_Æloc£t
()Ë=
NULL
)

360 
	`Ârötf
 (
°dîr
, "%s: couldÇŸáŒoˇã sysˇps!\n", 
__func__
);

361 
	`exô
 (1);

364 
	`¥iv_em±y£t
 (
sysˇps
);

366 
i
=0; i < 
num
; i++)

367 
j
 = 0; j < 
ˇp_m≠
[
zˇps
[
i
]].
num
; j++)

368 
	`¥iv_add£t
 (
sysˇps
, 
ˇp_m≠
[
zˇps
[
i
]].
sy°em_ˇps
[
j
]);

370  
sysˇps
;

371 
	}
}

377 
	$z¥ivs_ch™ge_ˇps
 (
zebø_¥ivs_›s_t
 
›
)

381 
	`as£π
 (
z¥ivs_°©e
.
sysˇps_p
);

382 i‡(!
z¥ivs_°©e
.
sysˇps_p
)

384 
	`Ârötf
 (
°dîr
, "%s: Eek, missög c≠s!", 
__func__
);

385 
	`exô
 (1);

391 i‡(
›
 =
ZPRIVS_RAISE
)

392 
	`¥iv_c›y£t
 (
z¥ivs_°©e
.
sysˇps_p
, z¥ivs_°©e.
ˇps
);

393 i‡(
›
 =
ZPRIVS_LOWER
)

394 
	`¥iv_em±y£t
 (
z¥ivs_°©e
.
ˇps
);

398 i‡(
	`£ç¥iv
 (
PRIV_SET
, 
PRIV_EFFECTIVE
, 
z¥ivs_°©e
.
ˇps
) != 0)

402 
	}
}

405 
zebø_¥ivs_cuºít_t


406 
	$z¥ivs_°©e_ˇps
 ()

408 
zebø_¥ivs_cuºít_t
 
ªsu…
;

409 
p£t_t
 *
ef„˘ive
;

411 i‡–(
ef„˘ive
 = 
	`¥iv_Æloc£t
()Ë=
NULL
)

413 
	`Ârötf
 (
°dîr
, "%s: faûedÅÿgëÖriv_Æloc£t! %s\n", 
__func__
,

414 
	`ß„_°ªº‹
 (
î∫o
));

415  
ZPRIVS_UNKNOWN
;

418 i‡(
	`gëµriv
 (
PRIV_EFFECTIVE
, 
ef„˘ive
))

420 
	`Ârötf
 (
°dîr
, "%s: faûedÅÿgë sèã! %s\n", 
__func__
,

421 
	`ß„_°ªº‹
 (
î∫o
));

422 
ªsu…
 = 
ZPRIVS_UNKNOWN
;

426 i‡(
	`¥iv_i£m±y£t
 (
ef„˘ive
Ë=
B_TRUE
)

427 
ªsu…
 = 
ZPRIVS_LOWERED
;

429 
ªsu…
 = 
ZPRIVS_RAISED
;

432 i‡(
ef„˘ive
)

433 
	`¥iv_‰ì£t
 (
ef„˘ive
);

435  
ªsu…
;

436 
	}
}

439 
	$z¥ivs_ˇps_öô
 (
zebø_¥ivs_t
 *
z¥ivs
)

441 
p£t_t
 *
basic
;

442 
p£t_t
 *
em±y
;

445 
z¥ivs_°©e
.
sysˇps_p
 = 
	`zˇps2sys
 (
z¥ivs
->
ˇps_p
, z¥ivs->
ˇp_num_p
);

446 
z¥ivs_°©e
.
sysˇps_i
 = 
	`zˇps2sys
 (
z¥ivs
->
ˇps_i
, z¥ivs->
ˇp_num_i
);

449 i‡(!
z¥ivs_°©e
.
sysˇps_p
)

451 
	`Ârötf
 (
°dîr
, "%s: capabilitiesÉnabled, "

453 
__func__
);

460 i‡((
basic
 = 
	`¥iv_°r_to_£t
("basic", ",", 
NULL
)) == NULL)

462 
	`Ârötf
 (
°dîr
, "%s: couldn'àgë basi¯£t!\n", 
__func__
);

463 
	`exô
 (1);

467 
	`¥iv_uni⁄
 (
basic
, 
z¥ivs_°©e
.
sysˇps_p
);

468 
	`¥iv_‰ì£t
 (
basic
);

471 i‡–(
em±y
 = 
	`¥iv_Æloc£t
()Ë=
NULL
)

473 
	`Ârötf
 (
°dîr
, "%s: couldn'àgëÉm±y së!\n", 
__func__
);

474 
	`exô
 (1);

476 
	`¥iv_em±y£t
 (
em±y
);

481 i‡(
	`£çÊags
 (
PRIV_AWARE
, 1))

483 
	`Ârötf
 (
°dîr
, "%s:Éº‹ sëtög PRIV_AWARE!, %s\n", 
__func__
,

484 
	`ß„_°ªº‹
 (
î∫o
) );

485 
	`exô
 (1);

489 
	`as£π
 (
z¥ivs_°©e
.
sysˇps_i
 && z¥ivs_°©e.
sysˇps_p
);

494 i‡(
z¥ivs_°©e
.
zuid
)

496 i‡–
	`£åeuid
 (
z¥ivs_°©e
.
zuid
, zprivs_state.zuid) )

498 
	`Ârötf
 (
°dîr
, "%s: couldÇot setreuid, %s\n",

499 
__func__
, 
	`ß„_°ªº‹
 (
î∫o
));

500 
	`exô
 (1);

505 i‡(
	`£ç¥iv
 (
PRIV_SET
, 
PRIV_PERMITTED
, 
z¥ivs_°©e
.
sysˇps_p
))

507 
	`Ârötf
 (
°dîr
, "%s:Éº‹ sëtögÖîmôãd së!, %s\n", 
__func__
,

508 
	`ß„_°ªº‹
 (
î∫o
) );

509 
	`exô
 (1);

513 i‡(
	`£ç¥iv
 (
PRIV_SET
, 
PRIV_INHERITABLE
, 
z¥ivs_°©e
.
sysˇps_i
))

515 
	`Ârötf
 (
°dîr
, "%s:Éº‹ sëtög inhîôabÀ së!, %s\n", 
__func__
,

516 
	`ß„_°ªº‹
 (
î∫o
) );

517 
	`exô
 (1);

521 i‡(
	`£ç¥iv
 (
PRIV_SET
, 
PRIV_EFFECTIVE
, 
em±y
))

523 
	`Ârötf
 (
°dîr
, "%s:Éº‹ sëtögÉf„˘ivê£t!, %s\n", 
__func__
,

524 
	`ß„_°ªº‹
 (
î∫o
) );

525 
	`exô
 (1);

529 
z¥ivs_°©e
.
ˇps
 = 
em±y
;

532 
z¥ivs
->
ch™ge
 = 
z¥ivs_ch™ge_ˇps
;

533 
z¥ivs
->
cuºít_°©e
 = 
z¥ivs_°©e_ˇps
;

534 
	}
}

537 
	$z¥ivs_ˇps_ãrmö©e
 ()

539 
	`as£π
 (
z¥ivs_°©e
.
ˇps
);

542 
	`¥iv_em±y£t
 (
z¥ivs_°©e
.
ˇps
);

543 
	`£ç¥iv
 (
PRIV_SET
, 
PRIV_EFFECTIVE
, 
z¥ivs_°©e
.
ˇps
);

544 
	`£ç¥iv
 (
PRIV_SET
, 
PRIV_PERMITTED
, 
z¥ivs_°©e
.
ˇps
);

545 
	`£ç¥iv
 (
PRIV_SET
, 
PRIV_INHERITABLE
, 
z¥ivs_°©e
.
ˇps
);

548 i‡(
z¥ivs_°©e
.
sysˇps_p
)

549 
	`¥iv_‰ì£t
 (
z¥ivs_°©e
.
sysˇps_p
);

550 i‡(
z¥ivs_°©e
.
sysˇps_i
)

551 
	`¥iv_‰ì£t
 (
z¥ivs_°©e
.
sysˇps_i
);

553 
	`¥iv_‰ì£t
 (
z¥ivs_°©e
.
ˇps
);

554 
	}
}

561 
	$z¥ivs_ch™ge_uid
 (
zebø_¥ivs_›s_t
 
›
)

564 i‡(
›
 =
ZPRIVS_RAISE
)

565  
	`£ãuid
 (
z¥ivs_°©e
.
zsuid
);

566 i‡(
›
 =
ZPRIVS_LOWER
)

567  
	`£ãuid
 (
z¥ivs_°©e
.
zuid
);

570 
	}
}

572 
zebø_¥ivs_cuºít_t


573 
	$z¥ivs_°©e_uid
 ()

575  ( (
z¥ivs_°©e
.
zuid
 =
	`gëeuid
()Ë? 
ZPRIVS_LOWERED
 : 
ZPRIVS_RAISED
);

576 
	}
}

579 
	$z¥ivs_ch™ge_nuŒ
 (
zebø_¥ivs_›s_t
 
›
)

582 
	}
}

584 
zebø_¥ivs_cuºít_t


585 
	$z¥ivs_°©e_nuŒ
 ()

587  
z¥ivs_nuŒ_°©e
;

588 
	}
}

591 
	$z¥ivs_öô
(
zebø_¥ivs_t
 *
z¥ivs
)

593 
∑sswd
 *
pwíåy
 = 
NULL
;

594 
group
 *
gª¡ry
 = 
NULL
;

596 i‡(!
z¥ivs
)

598 
	`Ârötf
 (
°dîr
, "zprivs_init: called with NULLárg!\n");

599 
	`exô
 (1);

603 i‡(! (
z¥ivs
->
u£r
 || z¥ivs->
group


604 || 
z¥ivs
->
ˇp_num_p
 || z¥ivs->
ˇp_num_i
) )

606 
z¥ivs
->
ch™ge
 = 
z¥ivs_ch™ge_nuŒ
;

607 
z¥ivs
->
cuºít_°©e
 = 
z¥ivs_°©e_nuŒ
;

611 i‡(
z¥ivs
->
u£r
)

613 i‡–(
pwíåy
 = 
	`gëpw«m
 (
z¥ivs
->
u£r
)) )

615 
z¥ivs_°©e
.
zuid
 = 
pwíåy
->
pw_uid
;

620 
	`Ârötf
 (
°dîr
, "privs_init: couldÇotÜookup user %s\n",

621 
z¥ivs
->
u£r
);

622 
	`exô
 (1);

626 
gª¡ry
 = 
NULL
;

628 i‡(
z¥ivs
->
vty_group
)

631 i‡–(
gª¡ry
 = 
	`gëg∫am
 (
z¥ivs
->
vty_group
)) )

633 
z¥ivs_°©e
.
vtygΩ
 = 
gª¡ry
->
gr_gid
;

634 i‡–
	`£tgroups
 (1, &
z¥ivs_°©e
.
vtygΩ
) )

636 
	`Ârötf
 (
°dîr
, "privs_init: couldÇot setgroups, %s\n",

637 
	`ß„_°ªº‹
 (
î∫o
) );

638 
	`exô
 (1);

643 
	`Ârötf
 (
°dîr
, "privs_init: couldÇotÜookup vty group %s\n",

644 
z¥ivs
->
vty_group
);

645 
	`exô
 (1);

649 i‡(
z¥ivs
->
group
)

651 i‡–(
gª¡ry
 = 
	`gëg∫am
 (
z¥ivs
->
group
)) )

653 
z¥ivs_°©e
.
zgid
 = 
gª¡ry
->
gr_gid
;

657 
	`Ârötf
 (
°dîr
, "privs_init: couldÇotÜookup group %s\n",

658 
z¥ivs
->
group
);

659 
	`exô
 (1);

662 i‡–
	`£åegid
 (
z¥ivs_°©e
.
zgid
, zprivs_state.zgid) )

664 
	`Ârötf
 (
°dîr
, "zprivs_init: couldÇot setregid, %s\n",

665 
	`ß„_°ªº‹
 (
î∫o
) );

666 
	`exô
 (1);

670 #ifde‡
HAVE_CAPABILITIES


671 
	`z¥ivs_ˇps_öô
 (
z¥ivs
);

679 
z¥ivs_°©e
.
zsuid
 = 
	`gëeuid
();

680 i‡–
z¥ivs_°©e
.
zuid
 )

682 i‡–
	`£åeuid
 (-1, 
z¥ivs_°©e
.
zuid
) )

684 
	`Ârötf
 (
°dîr
, "privs_init (uid): couldÇot setreuid, %s\n",

685 
	`ß„_°ªº‹
 (
î∫o
));

686 
	`exô
 (1);

690 
z¥ivs
->
ch™ge
 = 
z¥ivs_ch™ge_uid
;

691 
z¥ivs
->
cuºít_°©e
 = 
z¥ivs_°©e_uid
;

693 
	}
}

696 
	$z¥ivs_ãrmö©e
 (
zebø_¥ivs_t
 *
z¥ivs
)

698 i‡(!
z¥ivs
)

700 
	`Ârötf
 (
°dîr
, "%s:Çÿ¥iv†°ru˘ giví,Åîmö©ög", 
__func__
);

701 
	`exô
 (0);

704 #ifde‡
HAVE_CAPABILITIES


705 
	`z¥ivs_ˇps_ãrmö©e
();

707 i‡(
z¥ivs_°©e
.
zuid
)

709 i‡–
	`£åeuid
 (
z¥ivs_°©e
.
zuid
, zprivs_state.zuid) )

711 
	`Ârötf
 (
°dîr
, "privs_terminate: couldÇot setreuid, %s",

712 
	`ß„_°ªº‹
 (
î∫o
) );

713 
	`exô
 (1);

718 
z¥ivs
->
ch™ge
 = 
z¥ivs_ch™ge_nuŒ
;

719 
z¥ivs
->
cuºít_°©e
 = 
z¥ivs_°©e_nuŒ
;

720 
z¥ivs_nuŒ_°©e
 = 
ZPRIVS_LOWERED
;

722 
	}
}

725 
	$z¥ivs_gë_ids
(
z¥ivs_ids_t
 *
ids
)

728 
ids
->
uid_¥iv
 = 
	`gëuid
();

729 (
z¥ivs_°©e
.
zuid
Ë? (
ids
->
uid_n‹mÆ
 = zprivs_state.zuid)

730 : (
ids
->
uid_n‹mÆ
 = -1);

731 (
z¥ivs_°©e
.
zgid
Ë? (
ids
->
gid_n‹mÆ
 = zprivs_state.zgid)

732 : (
ids
->
gid_n‹mÆ
 = -1);

733 (
z¥ivs_°©e
.
vtygΩ
Ë? (
ids
->
gid_vty
 = zprivs_state.vtygrp)

734 : (
ids
->
gid_vty
 = -1);

737 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/privs.h

24 #i‚de‡
_ZEBRA_PRIVS_H


25 
	#_ZEBRA_PRIVS_H


	)

30 
	mZCAP_SETID
,

31 
	mZCAP_BIND
,

32 
	mZCAP_NET_ADMIN
,

33 
	mZCAP_SYS_ADMIN
,

34 
	mZCAP_NET_RAW
,

35 
	mZCAP_CHROOT
,

36 
	mZCAP_NICE
,

37 
	mZCAP_PTRACE
,

38 
	mZCAP_DAC_OVERRIDE
,

39 
	mZCAP_READ_SEARCH
,

40 
	mZCAP_FOWNER
,

41 
	mZCAP_MAX


42 } 
	tzebø_ˇ∑bûôõs_t
;

46 
	mZPRIVS_LOWERED
,

47 
	mZPRIVS_RAISED
,

48 
	mZPRIVS_UNKNOWN
,

49 } 
	tzebø_¥ivs_cuºít_t
;

53 
	mZPRIVS_RAISE
,

54 
	mZPRIVS_LOWER
,

55 } 
	tzebø_¥ivs_›s_t
;

57 
	szebø_¥ivs_t


59 
zebø_ˇ∑bûôõs_t
 *
	mˇps_p
;

60 
zebø_ˇ∑bûôõs_t
 *
	mˇps_i
;

61 
	mˇp_num_p
;

62 
	mˇp_num_i
;

63 c⁄° *
	mu£r
;

64 c⁄° *
	mgroup
;

65 c⁄° *
	mvty_group
;

68 (*
	mch™ge
Ë(
	mzebø_¥ivs_›s_t
);

69 
	mzebø_¥ivs_cuºít_t


70 (*
	mcuºít_°©e
) ();

73 
	sz¥ivs_ids_t


76 
uid_t
 
	muid_¥iv
;

77 
uid_t
 
	muid_n‹mÆ
;

78 
gid_t
 
	mgid_¥iv
;

79 
gid_t
 
	mgid_n‹mÆ
;

80 
gid_t
 
	mgid_vty
;

84 
z¥ivs_öô
 (
zebø_¥ivs_t
 *
z¥ivs
);

86 
z¥ivs_ãrmö©e
 (
zebø_¥ivs_t
 *);

88 
z¥ivs_gë_ids
(
z¥ivs_ids_t
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/queue.h

33 #i‚de‡
_SYS_QUEUE_H_


34 
	#_SYS_QUEUE_H_


	)

36 
	~<sys/cdefs.h
>

105 #ifde‡
QUEUE_MACRO_DEBUG


107 
	sqm_åa˚
 {

108 * 
	mœ°fûe
;

109 
	mœ°löe
;

110 * 
	m¥evfûe
;

111 
	m¥evlöe
;

114 
	#TRACEBUF
 
qm_åa˚
 
åa˚
;

	)

115 
	#TRASHIT
(
x
Ëdÿ{(xË(*)-1;} 0)

	)

116 
	#QMD_SAVELINK
(
«me
, 
lök
Ë**«mê(*)&÷ök)

	)

118 
	#QMD_TRACE_HEAD
(
hód
) do { \

119 (
hód
)->
åa˚
.
¥evlöe
 = (hód)->åa˚.
œ°löe
; \

120 (
hód
)->
åa˚
.
¥evfûe
 = (hód)->åa˚.
œ°fûe
; \

121 (
hód
)->
åa˚
.
œ°löe
 = 
__LINE__
; \

122 (
hód
)->
åa˚
.
œ°fûe
 = 
__FILE__
; \

123 } 0)

	)

125 
	#QMD_TRACE_ELEM
(
ñem
) do { \

126 (
ñem
)->
åa˚
.
¥evlöe
 = (ñem)->åa˚.
œ°löe
; \

127 (
ñem
)->
åa˚
.
¥evfûe
 = (ñem)->åa˚.
œ°fûe
; \

128 (
ñem
)->
åa˚
.
œ°löe
 = 
__LINE__
; \

129 (
ñem
)->
åa˚
.
œ°fûe
 = 
__FILE__
; \

130 } 0)

	)

133 
	#QMD_TRACE_ELEM
(
ñem
)

	)

134 
	#QMD_TRACE_HEAD
(
hód
)

	)

135 
	#QMD_SAVELINK
(
«me
, 
lök
)

	)

136 
	#TRACEBUF


	)

137 
	#TRASHIT
(
x
)

	)

143 
	#SLIST_HEAD
(
«me
, 
ty≥
) \

144 
	s«me
 { \

145 
ty≥
 *
¶h_fú°
; \

146 }

	)

148 
	#SLIST_HEAD_INITIALIZER
(
hód
) \

149 { 
NULL
 }

	)

151 
	#SLIST_ENTRY
(
ty≥
) \

153 
ty≥
 *
¶e_√xt
; \

154 }

	)

159 
	#SLIST_EMPTY
(
hód
Ë((hód)->
¶h_fú°
 =
NULL
)

	)

161 
	#SLIST_FIRST
(
hód
Ë((hód)->
¶h_fú°
)

	)

163 
	#SLIST_FOREACH
(
v¨
, 
hód
, 
fõld
) \

164 (
v¨
Ë
	`SLIST_FIRST
((
hód
)); \

165 (
v¨
); \

166 (
v¨
Ë
	`SLIST_NEXT
((v¨), 
fõld
))

	)

168 
	#SLIST_FOREACH_SAFE
(
v¨
, 
hód
, 
fõld
, 
tv¨
) \

169 (
v¨
Ë
	`SLIST_FIRST
((
hód
)); \

170 (
v¨
Ë&& ((
tv¨
Ë
	`SLIST_NEXT
((v¨), 
fõld
), 1); \

171 (
v¨
Ë(
tv¨
))

	)

173 
	#SLIST_FOREACH_PREVPTR
(
v¨
, 
v¨p
, 
hód
, 
fõld
) \

174 (
v¨p
Ë&
	`SLIST_FIRST
((
hód
)); \

175 ((
v¨
Ë*(
v¨p
)Ë!
NULL
; \

176 (
v¨p
Ë&
	`SLIST_NEXT
((
v¨
), 
fõld
))

	)

178 
	#SLIST_INIT
(
hód
) do { \

179 
	`SLIST_FIRST
((
hód
)Ë
NULL
; \

180 } 0)

	)

182 
	#SLIST_INSERT_AFTER
(
¶i°ñm
, 
ñm
, 
fõld
) do { \

183 
	`SLIST_NEXT
((
ñm
), 
fõld
ËSLIST_NEXT((
¶i°ñm
), field); \

184 
	`SLIST_NEXT
((
¶i°ñm
), 
fõld
Ë(
ñm
); \

185 } 0)

	)

187 
	#SLIST_INSERT_HEAD
(
hód
, 
ñm
, 
fõld
) do { \

188 
	`SLIST_NEXT
((
ñm
), 
fõld
Ë
	`SLIST_FIRST
((
hód
)); \

189 
	`SLIST_FIRST
((
hód
)Ë(
ñm
); \

190 } 0)

	)

192 
	#SLIST_NEXT
(
ñm
, 
fõld
Ë(”lm)->fõld.
¶e_√xt
)

	)

194 
	#SLIST_REMOVE
(
hód
, 
ñm
, 
ty≥
, 
fõld
) do { \

195 
	`QMD_SAVELINK
(
ﬁd√xt
, (
ñm
)->
fõld
.
¶e_√xt
); \

196 i‡(
	`SLIST_FIRST
((
hód
)Ë=(
ñm
)) { \

197 
	`SLIST_REMOVE_HEAD
((
hód
), 
fõld
); \

200 
ty≥
 *
cuªlm
 = 
	`SLIST_FIRST
((
hód
)); \

201 
	`SLIST_NEXT
(
cuªlm
, 
fõld
Ë!(
ñm
)) \

202 
cuªlm
 = 
	`SLIST_NEXT
(cuªlm, 
fõld
); \

203 
	`SLIST_REMOVE_AFTER
(
cuªlm
, 
fõld
); \

205 
	`TRASHIT
(*
ﬁd√xt
); \

206 } 0)

	)

208 
	#SLIST_REMOVE_AFTER
(
ñm
, 
fõld
) do { \

209 
	`SLIST_NEXT
(
ñm
, 
fõld
) = \

210 
	`SLIST_NEXT
(SLIST_NEXT(
ñm
, 
fõld
), field); \

211 } 0)

	)

213 
	#SLIST_REMOVE_HEAD
(
hód
, 
fõld
) do { \

214 
	`SLIST_FIRST
((
hód
)Ë
	`SLIST_NEXT
(SLIST_FIRST((hód)), 
fõld
); \

215 } 0)

	)

217 
	#SLIST_SWAP
(
hód1
, 
hód2
, 
ty≥
) do { \

218 
ty≥
 *
sw≠_fú°
 = 
	`SLIST_FIRST
(
hód1
); \

219 
	`SLIST_FIRST
(
hód1
ËSLIST_FIRST(
hód2
); \

220 
	`SLIST_FIRST
(
hód2
Ë
sw≠_fú°
; \

221 } 0)

	)

226 
	#STAILQ_HEAD
(
«me
, 
ty≥
) \

227 
	s«me
 { \

228 
ty≥
 *
°qh_fú°
; \

229 
ty≥
 **
°qh_œ°
; \

230 }

	)

232 
	#STAILQ_HEAD_INITIALIZER
(
hód
) \

233 { 
NULL
, &(
hód
).
°qh_fú°
 }

	)

235 
	#STAILQ_ENTRY
(
ty≥
) \

237 
ty≥
 *
°qe_√xt
; \

238 }

	)

243 
	#STAILQ_CONCAT
(
hód1
, 
hód2
) do { \

244 i‡(!
	`STAILQ_EMPTY
((
hód2
))) { \

245 *(
hód1
)->
°qh_œ°
 = (
hód2
)->
°qh_fú°
; \

246 (
hód1
)->
°qh_œ°
 = (
hód2
)->stqh_last; \

247 
	`STAILQ_INIT
((
hód2
)); \

249 } 0)

	)

251 
	#STAILQ_EMPTY
(
hód
Ë((hód)->
°qh_fú°
 =
NULL
)

	)

253 
	#STAILQ_FIRST
(
hód
Ë((hód)->
°qh_fú°
)

	)

255 
	#STAILQ_FOREACH
(
v¨
, 
hód
, 
fõld
) \

256 (
v¨
Ë
	`STAILQ_FIRST
((
hód
)); \

257 (
v¨
); \

258 (
v¨
Ë
	`STAILQ_NEXT
((v¨), 
fõld
))

	)

261 
	#STAILQ_FOREACH_SAFE
(
v¨
, 
hód
, 
fõld
, 
tv¨
) \

262 (
v¨
Ë
	`STAILQ_FIRST
((
hód
)); \

263 (
v¨
Ë&& ((
tv¨
Ë
	`STAILQ_NEXT
((v¨), 
fõld
), 1); \

264 (
v¨
Ë(
tv¨
))

	)

266 
	#STAILQ_INIT
(
hód
) do { \

267 
	`STAILQ_FIRST
((
hód
)Ë
NULL
; \

268 (
hód
)->
°qh_œ°
 = &
	`STAILQ_FIRST
((head)); \

269 } 0)

	)

271 
	#STAILQ_INSERT_AFTER
(
hód
, 
tqñm
, 
ñm
, 
fõld
) do { \

272 i‡((
	`STAILQ_NEXT
((
ñm
), 
fõld
ËSTAILQ_NEXT((
tqñm
), fõld)Ë=
NULL
)\

273 (
hód
)->
°qh_œ°
 = &
	`STAILQ_NEXT
((
ñm
), 
fõld
); \

274 
	`STAILQ_NEXT
((
tqñm
), 
fõld
Ë(
ñm
); \

275 } 0)

	)

277 
	#STAILQ_INSERT_HEAD
(
hód
, 
ñm
, 
fõld
) do { \

278 i‡((
	`STAILQ_NEXT
((
ñm
), 
fõld
Ë
	`STAILQ_FIRST
((
hód
))Ë=
NULL
) \

279 (
hód
)->
°qh_œ°
 = &
	`STAILQ_NEXT
((
ñm
), 
fõld
); \

280 
	`STAILQ_FIRST
((
hód
)Ë(
ñm
); \

281 } 0)

	)

283 
	#STAILQ_INSERT_TAIL
(
hód
, 
ñm
, 
fõld
) do { \

284 
	`STAILQ_NEXT
((
ñm
), 
fõld
Ë
NULL
; \

285 *(
hód
)->
°qh_œ°
 = (
ñm
); \

286 (
hód
)->
°qh_œ°
 = &
	`STAILQ_NEXT
((
ñm
), 
fõld
); \

287 } 0)

	)

289 
	#STAILQ_LAST
(
hód
, 
ty≥
, 
fõld
) \

290 (
	`STAILQ_EMPTY
((
hód
)) ? \

291 
NULL
 : \

292 ((
ty≥
 *)(*) \

293 ((*)((
hód
)->
°qh_œ°
Ë- 
	`__off£tof
(
ty≥
, 
fõld
))))

	)

295 
	#STAILQ_NEXT
(
ñm
, 
fõld
Ë(”lm)->fõld.
°qe_√xt
)

	)

297 
	#STAILQ_REMOVE
(
hód
, 
ñm
, 
ty≥
, 
fõld
) do { \

298 
	`QMD_SAVELINK
(
ﬁd√xt
, (
ñm
)->
fõld
.
°qe_√xt
); \

299 i‡(
	`STAILQ_FIRST
((
hód
)Ë=(
ñm
)) { \

300 
	`STAILQ_REMOVE_HEAD
((
hód
), 
fõld
); \

303 
ty≥
 *
cuªlm
 = 
	`STAILQ_FIRST
((
hód
)); \

304 
	`STAILQ_NEXT
(
cuªlm
, 
fõld
Ë!(
ñm
)) \

305 
cuªlm
 = 
	`STAILQ_NEXT
(cuªlm, 
fõld
); \

306 
	`STAILQ_REMOVE_AFTER
(
hód
, 
cuªlm
, 
fõld
); \

308 
	`TRASHIT
(*
ﬁd√xt
); \

309 } 0)

	)

311 
	#STAILQ_REMOVE_AFTER
(
hód
, 
ñm
, 
fõld
) do { \

312 i‡((
	`STAILQ_NEXT
(
ñm
, 
fõld
) = \

313 
	`STAILQ_NEXT
(STAILQ_NEXT(
ñm
, 
fõld
), fõld)Ë=
NULL
) \

314 (
hód
)->
°qh_œ°
 = &
	`STAILQ_NEXT
((
ñm
), 
fõld
); \

315 } 0)

	)

317 
	#STAILQ_REMOVE_HEAD
(
hód
, 
fõld
) do { \

318 i‡((
	`STAILQ_FIRST
((
hód
)) = \

319 
	`STAILQ_NEXT
(
	`STAILQ_FIRST
((
hód
)), 
fõld
)Ë=
NULL
) \

320 (
hód
)->
°qh_œ°
 = &
	`STAILQ_FIRST
((head)); \

321 } 0)

	)

323 
	#STAILQ_SWAP
(
hód1
, 
hód2
, 
ty≥
) do { \

324 
ty≥
 *
sw≠_fú°
 = 
	`STAILQ_FIRST
(
hód1
); \

325 
ty≥
 **
sw≠_œ°
 = (
hód1
)->
°qh_œ°
; \

326 
	`STAILQ_FIRST
(
hód1
ËSTAILQ_FIRST(
hód2
); \

327 (
hód1
)->
°qh_œ°
 = (
hód2
)->stqh_last; \

328 
	`STAILQ_FIRST
(
hód2
Ë
sw≠_fú°
; \

329 (
hód2
)->
°qh_œ°
 = 
sw≠_œ°
; \

330 i‡(
	`STAILQ_EMPTY
(
hód1
)) \

331 (
hód1
)->
°qh_œ°
 = &
	`STAILQ_FIRST
(head1); \

332 i‡(
	`STAILQ_EMPTY
(
hód2
)) \

333 (
hód2
)->
°qh_œ°
 = &
	`STAILQ_FIRST
(head2); \

334 } 0)

	)

340 
	#LIST_HEAD
(
«me
, 
ty≥
) \

341 
	s«me
 { \

342 
ty≥
 *
lh_fú°
; \

343 }

	)

345 
	#LIST_HEAD_INITIALIZER
(
hód
) \

346 { 
NULL
 }

	)

348 
	#LIST_ENTRY
(
ty≥
) \

350 
ty≥
 *
À_√xt
; \

351 
ty≥
 **
À_¥ev
; \

352 }

	)

358 #i‡(
deföed
(
_KERNEL
Ë&& deföed(
INVARIANTS
))

359 
	#QMD_LIST_CHECK_HEAD
(
hód
, 
fõld
) do { \

360 i‡(
	`LIST_FIRST
((
hód
)Ë!
NULL
 && \

361 
	`LIST_FIRST
((
hód
))->
fõld
.
À_¥ev
 != \

362 &
	`LIST_FIRST
((
hód
))) \

363 
	`∑nic
("BadÜi° hód %∞fú°->¥ev !hód", (
hód
)); \

364 } 0)

	)

366 
	#QMD_LIST_CHECK_NEXT
(
ñm
, 
fõld
) do { \

367 i‡(
	`LIST_NEXT
((
ñm
), 
fõld
Ë!
NULL
 && \

368 
	`LIST_NEXT
((
ñm
), 
fõld
)->fõld.
À_¥ev
 != \

369 &((
ñm
)->
fõld
.
À_√xt
)) \

370 
	`∑nic
("BadÜökÉlm %∞√xt->¥ev !ñm", (
ñm
)); \

371 } 0)

	)

373 
	#QMD_LIST_CHECK_PREV
(
ñm
, 
fõld
) do { \

374 i‡(*(
ñm
)->
fõld
.
À_¥ev
 != (elm)) \

375 
	`∑nic
("BadÜökÉlm %∞¥ev->√xà!ñm", (
ñm
)); \

376 } 0)

	)

378 
	#QMD_LIST_CHECK_HEAD
(
hód
, 
fõld
)

	)

379 
	#QMD_LIST_CHECK_NEXT
(
ñm
, 
fõld
)

	)

380 
	#QMD_LIST_CHECK_PREV
(
ñm
, 
fõld
)

	)

383 
	#LIST_EMPTY
(
hód
Ë((hód)->
lh_fú°
 =
NULL
)

	)

385 
	#LIST_FIRST
(
hód
Ë((hód)->
lh_fú°
)

	)

387 
	#LIST_FOREACH
(
v¨
, 
hód
, 
fõld
) \

388 (
v¨
Ë
	`LIST_FIRST
((
hód
)); \

389 (
v¨
); \

390 (
v¨
Ë
	`LIST_NEXT
((v¨), 
fõld
))

	)

392 
	#LIST_FOREACH_SAFE
(
v¨
, 
hód
, 
fõld
, 
tv¨
) \

393 (
v¨
Ë
	`LIST_FIRST
((
hód
)); \

394 (
v¨
Ë&& ((
tv¨
Ë
	`LIST_NEXT
((v¨), 
fõld
), 1); \

395 (
v¨
Ë(
tv¨
))

	)

397 
	#LIST_INIT
(
hód
) do { \

398 
	`LIST_FIRST
((
hód
)Ë
NULL
; \

399 } 0)

	)

401 
	#LIST_INSERT_AFTER
(
li°ñm
, 
ñm
, 
fõld
) do { \

402 
	`QMD_LIST_CHECK_NEXT
(
li°ñm
, 
fõld
); \

403 i‡((
	`LIST_NEXT
((
ñm
), 
fõld
ËLIST_NEXT((
li°ñm
), fõld)Ë!
NULL
)\

404 
	`LIST_NEXT
((
li°ñm
), 
fõld
)->fõld.
À_¥ev
 = \

405 &
	`LIST_NEXT
((
ñm
), 
fõld
); \

406 
	`LIST_NEXT
((
li°ñm
), 
fõld
Ë(
ñm
); \

407 (
ñm
)->
fõld
.
À_¥ev
 = &
	`LIST_NEXT
((
li°ñm
), field); \

408 } 0)

	)

410 
	#LIST_INSERT_BEFORE
(
li°ñm
, 
ñm
, 
fõld
) do { \

411 
	`QMD_LIST_CHECK_PREV
(
li°ñm
, 
fõld
); \

412 (
ñm
)->
fõld
.
À_¥ev
 = (
li°ñm
)->field.le_prev; \

413 
	`LIST_NEXT
((
ñm
), 
fõld
Ë(
li°ñm
); \

414 *(
li°ñm
)->
fõld
.
À_¥ev
 = (
ñm
); \

415 (
li°ñm
)->
fõld
.
À_¥ev
 = &
	`LIST_NEXT
((
ñm
), field); \

416 } 0)

	)

418 
	#LIST_INSERT_HEAD
(
hód
, 
ñm
, 
fõld
) do { \

419 
	`QMD_LIST_CHECK_HEAD
((
hód
), 
fõld
); \

420 i‡((
	`LIST_NEXT
((
ñm
), 
fõld
Ë
	`LIST_FIRST
((
hód
))Ë!
NULL
) \

421 
	`LIST_FIRST
((
hód
))->
fõld
.
À_¥ev
 = &
	`LIST_NEXT
((
ñm
), field);\

422 
	`LIST_FIRST
((
hód
)Ë(
ñm
); \

423 (
ñm
)->
fõld
.
À_¥ev
 = &
	`LIST_FIRST
((
hód
)); \

424 } 0)

	)

426 
	#LIST_NEXT
(
ñm
, 
fõld
Ë(”lm)->fõld.
À_√xt
)

	)

428 
	#LIST_REMOVE
(
ñm
, 
fõld
) do { \

429 
	`QMD_SAVELINK
(
ﬁd√xt
, (
ñm
)->
fõld
.
À_√xt
); \

430 
	`QMD_SAVELINK
(
ﬁd¥ev
, (
ñm
)->
fõld
.
À_¥ev
); \

431 
	`QMD_LIST_CHECK_NEXT
(
ñm
, 
fõld
); \

432 
	`QMD_LIST_CHECK_PREV
(
ñm
, 
fõld
); \

433 i‡(
	`LIST_NEXT
((
ñm
), 
fõld
Ë!
NULL
) \

434 
	`LIST_NEXT
((
ñm
), 
fõld
)->fõld.
À_¥ev
 = \

435 (
ñm
)->
fõld
.
À_¥ev
; \

436 *(
ñm
)->
fõld
.
À_¥ev
 = 
	`LIST_NEXT
((elm), field); \

437 
	`TRASHIT
(*
ﬁd√xt
); \

438 
	`TRASHIT
(*
ﬁd¥ev
); \

439 } 0)

	)

441 
	#LIST_SWAP
(
hód1
, 
hód2
, 
ty≥
, 
fõld
) do { \

442 
ty≥
 *
sw≠_tmp
 = 
	`LIST_FIRST
((
hód1
)); \

443 
	`LIST_FIRST
((
hód1
)ËLIST_FIRST((
hód2
)); \

444 
	`LIST_FIRST
((
hód2
)Ë
sw≠_tmp
; \

445 i‡((
sw≠_tmp
 = 
	`LIST_FIRST
((
hód1
))Ë!
NULL
) \

446 
sw≠_tmp
->
fõld
.
À_¥ev
 = &
	`LIST_FIRST
((
hód1
)); \

447 i‡((
sw≠_tmp
 = 
	`LIST_FIRST
((
hód2
))Ë!
NULL
) \

448 
sw≠_tmp
->
fõld
.
À_¥ev
 = &
	`LIST_FIRST
((
hód2
)); \

449 } 0)

	)

454 
	#TAILQ_HEAD
(
«me
, 
ty≥
) \

455 
	s«me
 { \

456 
ty≥
 *
tqh_fú°
; \

457 
ty≥
 **
tqh_œ°
; \

458 
TRACEBUF
 \

459 }

	)

461 
	#TAILQ_HEAD_INITIALIZER
(
hód
) \

462 { 
NULL
, &(
hód
).
tqh_fú°
 }

	)

464 
	#TAILQ_ENTRY
(
ty≥
) \

466 
ty≥
 *
tqe_√xt
; \

467 
ty≥
 **
tqe_¥ev
; \

468 
TRACEBUF
 \

469 }

	)

474 #i‡(
deföed
(
_KERNEL
Ë&& deföed(
INVARIANTS
))

475 
	#QMD_TAILQ_CHECK_HEAD
(
hód
, 
fõld
) do { \

476 i‡(!
	`TAILQ_EMPTY
(
hód
) && \

477 
	`TAILQ_FIRST
((
hód
))->
fõld
.
tqe_¥ev
 != \

478 &
	`TAILQ_FIRST
((
hód
))) \

479 
	`∑nic
("BadÅaûq hód %∞fú°->¥ev !hód", (
hód
)); \

480 } 0)

	)

482 
	#QMD_TAILQ_CHECK_TAIL
(
hód
, 
fõld
) do { \

483 i‡(*(
hód
)->
tqh_œ°
 !
NULL
) \

484 
	`∑nic
("BadÅaûq NEXT(%p->tqh_œ°Ë!NULL", (
hód
)); \

485 } 0)

	)

487 
	#QMD_TAILQ_CHECK_NEXT
(
ñm
, 
fõld
) do { \

488 i‡(
	`TAILQ_NEXT
((
ñm
), 
fõld
Ë!
NULL
 && \

489 
	`TAILQ_NEXT
((
ñm
), 
fõld
)->fõld.
tqe_¥ev
 != \

490 &((
ñm
)->
fõld
.
tqe_√xt
)) \

491 
	`∑nic
("BadÜökÉlm %∞√xt->¥ev !ñm", (
ñm
)); \

492 } 0)

	)

494 
	#QMD_TAILQ_CHECK_PREV
(
ñm
, 
fõld
) do { \

495 i‡(*(
ñm
)->
fõld
.
tqe_¥ev
 != (elm)) \

496 
	`∑nic
("BadÜökÉlm %∞¥ev->√xà!ñm", (
ñm
)); \

497 } 0)

	)

499 
	#QMD_TAILQ_CHECK_HEAD
(
hód
, 
fõld
)

	)

500 
	#QMD_TAILQ_CHECK_TAIL
(
hód
, 
hód«me
)

	)

501 
	#QMD_TAILQ_CHECK_NEXT
(
ñm
, 
fõld
)

	)

502 
	#QMD_TAILQ_CHECK_PREV
(
ñm
, 
fõld
)

	)

505 
	#TAILQ_CONCAT
(
hód1
, 
hód2
, 
fõld
) do { \

506 i‡(!
	`TAILQ_EMPTY
(
hód2
)) { \

507 *(
hód1
)->
tqh_œ°
 = (
hód2
)->
tqh_fú°
; \

508 (
hód2
)->
tqh_fú°
->
fõld
.
tqe_¥ev
 = (
hód1
)->
tqh_œ°
; \

509 (
hód1
)->
tqh_œ°
 = (
hód2
)->tqh_last; \

510 
	`TAILQ_INIT
((
hód2
)); \

511 
	`QMD_TRACE_HEAD
(
hód1
); \

512 
	`QMD_TRACE_HEAD
(
hód2
); \

514 } 0)

	)

516 
	#TAILQ_EMPTY
(
hód
Ë((hód)->
tqh_fú°
 =
NULL
)

	)

518 
	#TAILQ_FIRST
(
hód
Ë((hód)->
tqh_fú°
)

	)

520 
	#TAILQ_FOREACH
(
v¨
, 
hód
, 
fõld
) \

521 (
v¨
Ë
	`TAILQ_FIRST
((
hód
)); \

522 (
v¨
); \

523 (
v¨
Ë
	`TAILQ_NEXT
((v¨), 
fõld
))

	)

525 
	#TAILQ_FOREACH_SAFE
(
v¨
, 
hód
, 
fõld
, 
tv¨
) \

526 (
v¨
Ë
	`TAILQ_FIRST
((
hód
)); \

527 (
v¨
Ë&& ((
tv¨
Ë
	`TAILQ_NEXT
((v¨), 
fõld
), 1); \

528 (
v¨
Ë(
tv¨
))

	)

530 
	#TAILQ_FOREACH_REVERSE
(
v¨
, 
hód
, 
hód«me
, 
fõld
) \

531 (
v¨
Ë
	`TAILQ_LAST
((
hód
), 
hód«me
); \

532 (
v¨
); \

533 (
v¨
Ë
	`TAILQ_PREV
((v¨), 
hód«me
, 
fõld
))

	)

535 
	#TAILQ_FOREACH_REVERSE_SAFE
(
v¨
, 
hód
, 
hód«me
, 
fõld
, 
tv¨
) \

536 (
v¨
Ë
	`TAILQ_LAST
((
hód
), 
hód«me
); \

537 (
v¨
Ë&& ((
tv¨
Ë
	`TAILQ_PREV
((v¨), 
hód«me
, 
fõld
), 1); \

538 (
v¨
Ë(
tv¨
))

	)

540 
	#TAILQ_INIT
(
hód
) do { \

541 
	`TAILQ_FIRST
((
hód
)Ë
NULL
; \

542 (
hód
)->
tqh_œ°
 = &
	`TAILQ_FIRST
((head)); \

543 
	`QMD_TRACE_HEAD
(
hód
); \

544 } 0)

	)

546 
	#TAILQ_INSERT_AFTER
(
hód
, 
li°ñm
, 
ñm
, 
fõld
) do { \

547 
	`QMD_TAILQ_CHECK_NEXT
(
li°ñm
, 
fõld
); \

548 i‡((
	`TAILQ_NEXT
((
ñm
), 
fõld
ËTAILQ_NEXT((
li°ñm
), fõld)Ë!
NULL
)\

549 
	`TAILQ_NEXT
((
ñm
), 
fõld
)->fõld.
tqe_¥ev
 = \

550 &
	`TAILQ_NEXT
((
ñm
), 
fõld
); \

552 (
hód
)->
tqh_œ°
 = &
	`TAILQ_NEXT
((
ñm
), 
fõld
); \

553 
	`QMD_TRACE_HEAD
(
hód
); \

555 
	`TAILQ_NEXT
((
li°ñm
), 
fõld
Ë(
ñm
); \

556 (
ñm
)->
fõld
.
tqe_¥ev
 = &
	`TAILQ_NEXT
((
li°ñm
), field); \

557 
	`QMD_TRACE_ELEM
(&(
ñm
)->
fõld
); \

558 
	`QMD_TRACE_ELEM
(&
li°ñm
->
fõld
); \

559 } 0)

	)

561 
	#TAILQ_INSERT_BEFORE
(
li°ñm
, 
ñm
, 
fõld
) do { \

562 
	`QMD_TAILQ_CHECK_PREV
(
li°ñm
, 
fõld
); \

563 (
ñm
)->
fõld
.
tqe_¥ev
 = (
li°ñm
)->field.tqe_prev; \

564 
	`TAILQ_NEXT
((
ñm
), 
fõld
Ë(
li°ñm
); \

565 *(
li°ñm
)->
fõld
.
tqe_¥ev
 = (
ñm
); \

566 (
li°ñm
)->
fõld
.
tqe_¥ev
 = &
	`TAILQ_NEXT
((
ñm
), field); \

567 
	`QMD_TRACE_ELEM
(&(
ñm
)->
fõld
); \

568 
	`QMD_TRACE_ELEM
(&
li°ñm
->
fõld
); \

569 } 0)

	)

571 
	#TAILQ_INSERT_HEAD
(
hód
, 
ñm
, 
fõld
) do { \

572 
	`QMD_TAILQ_CHECK_HEAD
(
hód
, 
fõld
); \

573 i‡((
	`TAILQ_NEXT
((
ñm
), 
fõld
Ë
	`TAILQ_FIRST
((
hód
))Ë!
NULL
) \

574 
	`TAILQ_FIRST
((
hód
))->
fõld
.
tqe_¥ev
 = \

575 &
	`TAILQ_NEXT
((
ñm
), 
fõld
); \

577 (
hód
)->
tqh_œ°
 = &
	`TAILQ_NEXT
((
ñm
), 
fõld
); \

578 
	`TAILQ_FIRST
((
hód
)Ë(
ñm
); \

579 (
ñm
)->
fõld
.
tqe_¥ev
 = &
	`TAILQ_FIRST
((
hód
)); \

580 
	`QMD_TRACE_HEAD
(
hód
); \

581 
	`QMD_TRACE_ELEM
(&(
ñm
)->
fõld
); \

582 } 0)

	)

584 
	#TAILQ_INSERT_TAIL
(
hód
, 
ñm
, 
fõld
) do { \

585 
	`QMD_TAILQ_CHECK_TAIL
(
hód
, 
fõld
); \

586 
	`TAILQ_NEXT
((
ñm
), 
fõld
Ë
NULL
; \

587 (
ñm
)->
fõld
.
tqe_¥ev
 = (
hód
)->
tqh_œ°
; \

588 *(
hód
)->
tqh_œ°
 = (
ñm
); \

589 (
hód
)->
tqh_œ°
 = &
	`TAILQ_NEXT
((
ñm
), 
fõld
); \

590 
	`QMD_TRACE_HEAD
(
hód
); \

591 
	`QMD_TRACE_ELEM
(&(
ñm
)->
fõld
); \

592 } 0)

	)

594 
	#TAILQ_LAST
(
hód
, 
hód«me
) \

595 (*(((
hód«me
 *)((
hód
)->
tqh_œ°
))->tqh_œ°))

	)

597 
	#TAILQ_NEXT
(
ñm
, 
fõld
Ë(”lm)->fõld.
tqe_√xt
)

	)

599 
	#TAILQ_PREV
(
ñm
, 
hód«me
, 
fõld
) \

600 (*(((
hód«me
 *)((
ñm
)->
fõld
.
tqe_¥ev
))->
tqh_œ°
))

	)

602 
	#TAILQ_REMOVE
(
hód
, 
ñm
, 
fõld
) do { \

603 
	`QMD_SAVELINK
(
ﬁd√xt
, (
ñm
)->
fõld
.
tqe_√xt
); \

604 
	`QMD_SAVELINK
(
ﬁd¥ev
, (
ñm
)->
fõld
.
tqe_¥ev
); \

605 
	`QMD_TAILQ_CHECK_NEXT
(
ñm
, 
fõld
); \

606 
	`QMD_TAILQ_CHECK_PREV
(
ñm
, 
fõld
); \

607 i‡((
	`TAILQ_NEXT
((
ñm
), 
fõld
)Ë!
NULL
) \

608 
	`TAILQ_NEXT
((
ñm
), 
fõld
)->fõld.
tqe_¥ev
 = \

609 (
ñm
)->
fõld
.
tqe_¥ev
; \

611 (
hód
)->
tqh_œ°
 = (
ñm
)->
fõld
.
tqe_¥ev
; \

612 
	`QMD_TRACE_HEAD
(
hód
); \

614 *(
ñm
)->
fõld
.
tqe_¥ev
 = 
	`TAILQ_NEXT
((elm), field); \

615 
	`TRASHIT
(*
ﬁd√xt
); \

616 
	`TRASHIT
(*
ﬁd¥ev
); \

617 
	`QMD_TRACE_ELEM
(&(
ñm
)->
fõld
); \

618 } 0)

	)

620 
	#TAILQ_SWAP
(
hód1
, 
hód2
, 
ty≥
, 
fõld
) do { \

621 
ty≥
 *
sw≠_fú°
 = (
hód1
)->
tqh_fú°
; \

622 
ty≥
 **
sw≠_œ°
 = (
hód1
)->
tqh_œ°
; \

623 (
hód1
)->
tqh_fú°
 = (
hód2
)->tqh_first; \

624 (
hód1
)->
tqh_œ°
 = (
hód2
)->tqh_last; \

625 (
hód2
)->
tqh_fú°
 = 
sw≠_fú°
; \

626 (
hód2
)->
tqh_œ°
 = 
sw≠_œ°
; \

627 i‡((
sw≠_fú°
 = (
hód1
)->
tqh_fú°
Ë!
NULL
) \

628 
sw≠_fú°
->
fõld
.
tqe_¥ev
 = &(
hód1
)->
tqh_fú°
; \

630 (
hód1
)->
tqh_œ°
 = &(hód1)->
tqh_fú°
; \

631 i‡((
sw≠_fú°
 = (
hód2
)->
tqh_fú°
Ë!
NULL
) \

632 
sw≠_fú°
->
fõld
.
tqe_¥ev
 = &(
hód2
)->
tqh_fú°
; \

634 (
hód2
)->
tqh_œ°
 = &(hód2)->
tqh_fú°
; \

635 } 0)

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/regex-gnu.h

23 #i‚de‡
_REGEX_H


24 
	#_REGEX_H
 1

	)

27 #ifde‡
__˝lu•lus


34 #i‡!
deföed
 
_POSIX_C_SOURCE
 && !deföed 
_POSIX_SOURCE
 && deföed 
VMS


37 
	~<°ddef.h
>

44 
	ts_ªg_t
;

45 
	ta˘ive_ªg_t
;

52 
	tªg_sy¡ax_t
;

56 
	#RE_BACKSLASH_ESCAPE_IN_LISTS
 ((Ë1)

	)

61 
	#RE_BK_PLUS_QM
 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 << 1)

	)

67 
	#RE_CHAR_CLASSES
 (
RE_BK_PLUS_QM
 << 1)

	)

81 
	#RE_CONTEXT_INDEP_ANCHORS
 (
RE_CHAR_CLASSES
 << 1)

	)

89 
	#RE_CONTEXT_INDEP_OPS
 (
RE_CONTEXT_INDEP_ANCHORS
 << 1)

	)

93 
	#RE_CONTEXT_INVALID_OPS
 (
RE_CONTEXT_INDEP_OPS
 << 1)

	)

97 
	#RE_DOT_NEWLINE
 (
RE_CONTEXT_INVALID_OPS
 << 1)

	)

101 
	#RE_DOT_NOT_NULL
 (
RE_DOT_NEWLINE
 << 1)

	)

105 
	#RE_HAT_LISTS_NOT_NEWLINE
 (
RE_DOT_NOT_NULL
 << 1)

	)

110 
	#RE_INTERVALS
 (
RE_HAT_LISTS_NOT_NEWLINE
 << 1)

	)

114 
	#RE_LIMITED_OPS
 (
RE_INTERVALS
 << 1)

	)

118 
	#RE_NEWLINE_ALT
 (
RE_LIMITED_OPS
 << 1)

	)

123 
	#RE_NO_BK_BRACES
 (
RE_NEWLINE_ALT
 << 1)

	)

127 
	#RE_NO_BK_PARENS
 (
RE_NO_BK_BRACES
 << 1)

	)

131 
	#RE_NO_BK_REFS
 (
RE_NO_BK_PARENS
 << 1)

	)

135 
	#RE_NO_BK_VBAR
 (
RE_NO_BK_REFS
 << 1)

	)

141 
	#RE_NO_EMPTY_RANGES
 (
RE_NO_BK_VBAR
 << 1)

	)

145 
	#RE_UNMATCHED_RIGHT_PAREN_ORD
 (
RE_NO_EMPTY_RANGES
 << 1)

	)

149 
	#RE_NO_POSIX_BACKTRACKING
 (
RE_UNMATCHED_RIGHT_PAREN_ORD
 << 1)

	)

153 
	#RE_NO_GNU_OPS
 (
RE_NO_POSIX_BACKTRACKING
 << 1)

	)

161 
	#RE_DEBUG
 (
RE_NO_GNU_OPS
 << 1)

	)

167 
ªg_sy¡ax_t
 
ª_sy¡ax_›ti⁄s
;

173 
	#RE_SYNTAX_EMACS
 0

	)

175 
	#RE_SYNTAX_AWK
 \

176 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 | 
RE_DOT_NOT_NULL
 \

177 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

178 | 
RE_NO_BK_VBAR
 | 
RE_NO_EMPTY_RANGES
 \

179 | 
RE_DOT_NEWLINE
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

180 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
 | 
RE_NO_GNU_OPS
)

	)

182 
	#RE_SYNTAX_GNU_AWK
 \

183 ((
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 | 
RE_DEBUG
) \

184 & ~(
RE_DOT_NOT_NULL
 | 
RE_INTERVALS
 | 
RE_CONTEXT_INDEP_OPS
))

	)

186 
	#RE_SYNTAX_POSIX_AWK
 \

187 (
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

188 | 
RE_INTERVALS
 | 
RE_NO_GNU_OPS
)

	)

190 
	#RE_SYNTAX_GREP
 \

191 (
RE_BK_PLUS_QM
 | 
RE_CHAR_CLASSES
 \

192 | 
RE_HAT_LISTS_NOT_NEWLINE
 | 
RE_INTERVALS
 \

193 | 
RE_NEWLINE_ALT
)

	)

195 
	#RE_SYNTAX_EGREP
 \

196 (
RE_CHAR_CLASSES
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

197 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_HAT_LISTS_NOT_NEWLINE
 \

198 | 
RE_NEWLINE_ALT
 | 
RE_NO_BK_PARENS
 \

199 | 
RE_NO_BK_VBAR
)

	)

201 
	#RE_SYNTAX_POSIX_EGREP
 \

202 (
RE_SYNTAX_EGREP
 | 
RE_INTERVALS
 | 
RE_NO_BK_BRACES
)

	)

205 
	#RE_SYNTAX_ED
 
RE_SYNTAX_POSIX_BASIC


	)

207 
	#RE_SYNTAX_SED
 
RE_SYNTAX_POSIX_BASIC


	)

210 
	#_RE_SYNTAX_POSIX_COMMON
 \

211 (
RE_CHAR_CLASSES
 | 
RE_DOT_NEWLINE
 | 
RE_DOT_NOT_NULL
 \

212 | 
RE_INTERVALS
 | 
RE_NO_EMPTY_RANGES
)

	)

214 
	#RE_SYNTAX_POSIX_BASIC
 \

215 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
)

	)

220 
	#RE_SYNTAX_POSIX_MINIMAL_BASIC
 \

221 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_LIMITED_OPS
)

	)

223 
	#RE_SYNTAX_POSIX_EXTENDED
 \

224 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

225 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_NO_BK_BRACES
 \

226 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_VBAR
 \

227 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

231 
	#RE_SYNTAX_POSIX_MINIMAL_EXTENDED
 \

232 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

233 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_NO_BK_BRACES
 \

234 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

235 | 
RE_NO_BK_VBAR
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

241 #ifde‡
RE_DUP_MAX


242 #unde‡
RE_DUP_MAX


245 
	#RE_DUP_MAX
 (0x7fff)

	)

252 
	#REG_EXTENDED
 1

	)

256 
	#REG_ICASE
 (
REG_EXTENDED
 << 1)

	)

261 
	#REG_NEWLINE
 (
REG_ICASE
 << 1)

	)

265 
	#REG_NOSUB
 (
REG_NEWLINE
 << 1)

	)

275 
	#REG_NOTBOL
 1

	)

278 
	#REG_NOTEOL
 (1 << 1)

	)

285 #ifde‡
_XOPEN_SOURCE


286 
	gREG_ENOSYS
 = -1,

289 
	gREG_NOERROR
 = 0,

290 
	gREG_NOMATCH
,

294 
	gREG_BADPAT
,

295 
	gREG_ECOLLATE
,

296 
	gREG_ECTYPE
,

297 
	gREG_EESCAPE
,

298 
	gREG_ESUBREG
,

299 
	gREG_EBRACK
,

300 
	gREG_EPAREN
,

301 
	gREG_EBRACE
,

302 
	gREG_BADBR
,

303 
	gREG_ERANGE
,

304 
	gREG_ESPACE
,

305 
	gREG_BADRPT
,

308 
	gREG_EEND
,

309 
	gREG_ESIZE
,

310 
	gREG_ERPAREN


311 } 
	tªg_îrcode_t
;

319 #i‚de‡
RE_TRANSLATE_TYPE


320 
	#RE_TRANSLATE_TYPE
 *

	)

323 
	sª_∑âîn_buf„r


329 *
	gbuf„r
;

332 
	gÆloˇãd
;

335 
	gu£d
;

338 
ªg_sy¡ax_t
 
	gsy¡ax
;

343 *
	gÁ°m≠
;

349 
RE_TRANSLATE_TYPE
 
	gå™¶©e
;

352 
size_t
 
	gª_nsub
;

359 
	gˇn_be_nuŒ
 : 1;

365 
	#REGS_UNALLOCATED
 0

	)

366 
	#REGS_REALLOCATE
 1

	)

367 
	#REGS_FIXED
 2

	)

368 
	gªgs_Æloˇãd
 : 2;

372 
	gÁ°m≠_accuøã
 : 1;

376 
	gno_sub
 : 1;

380 
	gnŸ_bﬁ
 : 1;

383 
	gnŸ_eﬁ
 : 1;

386 
	g√wlöe_™ch‹
 : 1;

391 
ª_∑âîn_buf„r
 
	tªgex_t
;

394 
	tªgoff_t
;

399 
	sª_ªgi°îs


401 
	gnum_ªgs
;

402 
ªgoff_t
 *
	g°¨t
;

403 
ªgoff_t
 *
	gíd
;

410 #i‚de‡
RE_NREGS


411 
	#RE_NREGS
 30

	)

420 
ªgoff_t
 
	grm_so
;

421 
ªgoff_t
 
	grm_eo
;

422 } 
	tªgm©ch_t
;

432 #i‡
__STDC__


434 
	#_RE_ARGS
(
¨gs
Ë
	)
¨gs

438 
	#_RE_ARGS
(
¨gs
Ë()

	)

444 
ªg_sy¡ax_t
 
ª_£t_sy¡ax
 
_RE_ARGS
 (‘eg_sy¡ax_à
sy¡ax
));

449 c⁄° *
ª_compûe_∑âîn


450 
_RE_ARGS
 ((c⁄° *
∑âîn
, 
size_t
 
Àngth
,

451 
ª_∑âîn_buf„r
 *
buf„r
));

457 
ª_compûe_Á°m≠
 
_RE_ARGS
 ((
ª_∑âîn_buf„r
 *
buf„r
));

465 
ª_£¨ch


466 
_RE_ARGS
 ((
ª_∑âîn_buf„r
 *
buf„r
, c⁄° *
°rög
,

467 
Àngth
, 
°¨t
, 
ønge
, 
ª_ªgi°îs
 *
ªgs
));

472 
ª_£¨ch_2


473 
_RE_ARGS
 ((
ª_∑âîn_buf„r
 *
buf„r
, c⁄° *
°rög1
,

474 
Àngth1
, c⁄° *
°rög2
, 
Àngth2
,

475 
°¨t
, 
ønge
, 
ª_ªgi°îs
 *
ªgs
, 
°›
));

480 
ª_m©ch


481 
_RE_ARGS
 ((
ª_∑âîn_buf„r
 *
buf„r
, c⁄° *
°rög
,

482 
Àngth
, 
°¨t
, 
ª_ªgi°îs
 *
ªgs
));

486 
ª_m©ch_2


487 
_RE_ARGS
 ((
ª_∑âîn_buf„r
 *
buf„r
, c⁄° *
°rög1
,

488 
Àngth1
, c⁄° *
°rög2
, 
Àngth2
,

489 
°¨t
, 
ª_ªgi°îs
 *
ªgs
, 
°›
));

504 
ª_£t_ªgi°îs


505 
_RE_ARGS
 ((
ª_∑âîn_buf„r
 *
buf„r
, 
ª_ªgi°îs
 *
ªgs
,

506 
num_ªgs
, 
ªgoff_t
 *
°¨ts
,Ñegoff_à*
íds
));

508 #i‡
deföed
 
_REGEX_RE_COMP
 || deföed 
_LIBC


509 #i‚de‡
_CRAY


511 *
ª_comp
 
_RE_ARGS
 ((const *));

512 
ª_exec
 
_RE_ARGS
 ((const *));

517 
ªgcomp
 
_RE_ARGS
 ((
ªgex_t
 *
__¥eg
, c⁄° *
__∑âîn
,

518 
__cÊags
));

520 
ªgexec
 
_RE_ARGS
 ((c⁄° 
ªgex_t
 *
__¥eg
,

521 c⁄° *
__°rög
, 
size_t
 
__nm©ch
,

522 
ªgm©ch_t
 
__pm©ch
[], 
__eÊags
));

524 
size_t
 
ªgîr‹
 
_RE_ARGS
 ((
__îrcode
, c⁄° 
ªgex_t
 *
__¥eg
,

525 *
__îrbuf
, 
size_t
 
__îrbuf_size
));

527 
ªg‰ì
 
_RE_ARGS
 ((
ªgex_t
 *
__¥eg
));

530 #ifde‡
__˝lu•lus


	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/regex.c

23 #i‡
deföed
 
_AIX
 && !deföed 
REGEX_MALLOC


24 #¥agm®
Æloˇ


27 #unde‡
_GNU_SOURCE


28 
	#_GNU_SOURCE


	)

30 #ifde‡
HAVE_CONFIG_H


31 
	~<c⁄fig.h
>

33 #ifde‡
_WIN32


35 
	~<¥o˚ss.h
>

38 #i‚de‡
PARAMS


39 #i‡
deföed
 
__GNUC__
 || (deföed 
__STDC__
 && __STDC__)

40 
	#PARAMS
(
¨gs
Ë
	)
¨gs

42 
	#PARAMS
(
¨gs
Ë()

	)

46 #i‡
deföed
 
STDC_HEADERS
 && !deföed 
emacs


47 
	~<°ddef.h
>

50 
	~<sys/ty≥s.h
>

53 
	#WIDE_CHAR_SUPPORT
 (
HAVE_WCTYPE_H
 && 
HAVE_WCHAR_H
 && 
HAVE_BTOWC
)

	)

57 #i‡
deföed
 
_LIBC
 || 
WIDE_CHAR_SUPPORT


59 
	~<wch¨.h
>

60 
	~<w˘y≥.h
>

63 #ifde‡
_LIBC


65 
	#ªg‰ì
(
¥eg
Ë
	`__ªg‰ì
 (¥eg)

	)

66 
	#ªgexec
(
¥
, 
°
, 
nm
, 
pm
, 
ef
Ë
	`__ªgexec
 (¥, st,Çm,Öm,Éf)

	)

67 
	#ªgcomp
(
¥eg
, 
∑âîn
, 
cÊags
Ë
	`__ªgcomp
 (¥eg,Ö©ã∫, cÊags)

	)

68 
	#ªgîr‹
(
îrcode
, 
¥eg
, 
îrbuf
, 
îrbuf_size
) \

69 
	`__ªgîr‹
(
îrcode
, 
¥eg
, 
îrbuf
, 
îrbuf_size
)

	)

70 
	#ª_£t_ªgi°îs
(
bu
, 
ª
, 
nu
, 
°
, 
í
) \

71 
	`__ª_£t_ªgi°îs
 (
bu
, 
ª
, 
nu
, 
°
, 
í
)

	)

72 
	#ª_m©ch_2
(
buÂ
, 
°rög1
, 
size1
, 
°rög2
, 
size2
, 
pos
, 
ªgs
, 
°›
) \

73 
	`__ª_m©ch_2
 (
buÂ
, 
°rög1
, 
size1
, 
°rög2
, 
size2
, 
pos
, 
ªgs
, 
°›
)

	)

74 
	#ª_m©ch
(
buÂ
, 
°rög
, 
size
, 
pos
, 
ªgs
) \

75 
	`__ª_m©ch
 (
buÂ
, 
°rög
, 
size
, 
pos
, 
ªgs
)

	)

76 
	#ª_£¨ch
(
buÂ
, 
°rög
, 
size
, 
°¨ços
, 
ønge
, 
ªgs
) \

77 
	`__ª_£¨ch
 (
buÂ
, 
°rög
, 
size
, 
°¨ços
, 
ønge
, 
ªgs
)

	)

78 
	#ª_compûe_∑âîn
(
∑âîn
, 
Àngth
, 
buÂ
) \

79 
	`__ª_compûe_∑âîn
 (
∑âîn
, 
Àngth
, 
buÂ
)

	)

80 
	#ª_£t_sy¡ax
(
sy¡ax
Ë
	`__ª_£t_sy¡ax
 (sy¡ax)

	)

81 
	#ª_£¨ch_2
(
buÂ
, 
°1
, 
s1
, 
°2
, 
s2
, 
°¨ços
, 
ønge
, 
ªgs
, 
°›
) \

82 
	`__ª_£¨ch_2
 (
buÂ
, 
°1
, 
s1
, 
°2
, 
s2
, 
°¨ços
, 
ønge
, 
ªgs
, 
°›
)

	)

83 
	#ª_compûe_Á°m≠
(
buÂ
Ë
	`__ª_compûe_Á°m≠
 (buÂ)

	)

85 
	#btowc
 
__btowc


	)

89 #i‡
HAVE_LIBINTL_H
 || 
deföed
 
_LIBC


90 
	~<liböé.h
>

92 
	#gëãxt
(
msgid
Ë(msgid)

	)

95 #i‚de‡
gëãxt_no›


98 
	#gëãxt_no›
(
Såög
Ë
	)
Såög

103 #ifde‡
emacs


105 
	~"li•.h
"

106 
	~"buf„r.h
"

107 
	~"sy¡ax.h
"

114 #unde‡
REL_ALLOC


116 #i‡
deföed
 
STDC_HEADERS
 || deföed 
_LIBC


117 
	~<°dlib.h
>

119 *
mÆloc
 ();

120 *
ªÆloc
 ();

125 #ifde‡
INHIBIT_STRING_HEADER


126 #i‡!(
deföed
 
HAVE_BZERO
 && deföed 
HAVE_BCOPY
)

127 #i‡!
deföed
 
bzîo
 && !deföed 
bc›y


128 #unde‡
INHIBIT_STRING_HEADER


136 #i‚de‡
INHIBIT_STRING_HEADER


137 #i‡
deföed
 
HAVE_STRING_H
 || deföed 
STDC_HEADERS
 || deföed 
_LIBC


138 
	~<°rög.h
>

139 #i‚de‡
bzîo


140 #i‚de‡
_LIBC


141 
	#bzîo
(
s
, 
n
Ë(
	`mem£t
 (s, '\0',Ç), (s))

	)

143 
	#bzîo
(
s
, 
n
Ë
	`__bzîo
 (s,Ç)

	)

147 
	~<°rögs.h
>

148 #i‚de‡
memcmp


149 
	#memcmp
(
s1
, 
s2
, 
n
Ë
	`bcmp
 (s1, s2,Ç)

	)

151 #i‚de‡
mem˝y


152 
	#mem˝y
(
d
, 
s
, 
n
Ë(
	`bc›y
 (s, d,Ç), (d))

	)

161 #i‚de‡
Sw‹d


162 
	#Sw‹d
 1

	)

165 #ifde‡
SWITCH_ENUM_BUG


166 
	#SWITCH_ENUM_CAST
(
x
Ë(()(x))

	)

168 
	#SWITCH_ENUM_CAST
(
x
Ë(x)

	)

172 
	#CHAR_SET_SIZE
 256

	)

174 #ifde‡
SYNTAX_TABLE


176 *
ª_sy¡ax_èbÀ
;

180 
	gª_sy¡ax_èbÀ
[
CHAR_SET_SIZE
];

183 
	$öô_sy¡ax_⁄˚
 ()

185 
c
;

186 
d⁄e
;

188 i‡(
d⁄e
)

191 
	`mem£t
 (
ª_sy¡ax_èbÀ
, 0, Ñe_syntax_table);

193 
c
 = 'a'; c <= 'z'; c++)

194 
ª_sy¡ax_èbÀ
[
c
] = 
Sw‹d
;

196 
c
 = 'A'; c <= 'Z'; c++)

197 
ª_sy¡ax_èbÀ
[
c
] = 
Sw‹d
;

199 
c
 = '0'; c <= '9'; c++)

200 
ª_sy¡ax_èbÀ
[
c
] = 
Sw‹d
;

202 
ª_sy¡ax_èbÀ
['_'] = 
Sw‹d
;

204 
d⁄e
 = 1;

205 
	}
}

209 
	#SYNTAX
(
c
Ë
ª_sy¡ax_èbÀ
[c]

	)

214 
	~<ªgex-gnu.h
>

217 
	~<˘y≥.h
>

231 #unde‡
ISASCII


232 #i‡
deföed
 
STDC_HEADERS
 || (!deföed 
ißscii
 && !deföed 
HAVE_ISASCII
)

233 
	#ISASCII
(
c
Ë1

	)

235 
	#ISASCII
(
c
Ë
	`ißscii
(c)

	)

238 #ifde‡
isbœnk


239 
	#ISBLANK
(
c
Ë(
	`ISASCII
 (cË&& 
	`isbœnk
 (c))

	)

241 
	#ISBLANK
(
c
Ë((cË=' ' || (cË='\t')

	)

243 #ifde‡
isgøph


244 
	#ISGRAPH
(
c
Ë(
	`ISASCII
 (cË&& 
	`isgøph
 (c))

	)

246 
	#ISGRAPH
(
c
Ë(
	`ISASCII
 (cË&& 
	`i•röt
 (cË&& !
	`is•a˚
 (c))

	)

249 #unde‡
ISPRINT


250 
	#ISPRINT
(
c
Ë(
	`ISASCII
 (cË&& 
	`i•röt
 (c))

	)

251 
	#ISDIGIT
(
c
Ë(
	`ISASCII
 (cË&& 
	`isdigô
 (c))

	)

252 
	#ISALNUM
(
c
Ë(
	`ISASCII
 (cË&& 
	`iß um
 (c))

	)

253 
	#ISALPHA
(
c
Ë(
	`ISASCII
 (cË&& 
	`ißÕha
 (c))

	)

254 
	#ISCNTRL
(
c
Ë(
	`ISASCII
 (cË&& 
	`is˙ål
 (c))

	)

255 
	#ISLOWER
(
c
Ë(
	`ISASCII
 (cË&& 
	`i¶owî
 (c))

	)

256 
	#ISPUNCT
(
c
Ë(
	`ISASCII
 (cË&& 
	`i•un˘
 (c))

	)

257 
	#ISSPACE
(
c
Ë(
	`ISASCII
 (cË&& 
	`is•a˚
 (c))

	)

258 
	#ISUPPER
(
c
Ë(
	`ISASCII
 (cË&& 
	`isuµî
 (c))

	)

259 
	#ISXDIGIT
(
c
Ë(
	`ISASCII
 (cË&& 
	`isxdigô
 (c))

	)

261 #ifde‡
_tﬁowî


262 
	#TOLOWER
(
c
Ë
	`_tﬁowî
(c)

	)

264 
	#TOLOWER
(
c
Ë
	`tﬁowî
(c)

	)

267 #i‚de‡
NULL


268 
	#NULL
 (*)0

	)

275 #unde‡
SIGN_EXTEND_CHAR


276 #i‡
__STDC__


277 
	#SIGN_EXTEND_CHAR
(
c
Ë((sig√d Ë(c))

	)

280 
	#SIGN_EXTEND_CHAR
(
c
Ë((((Ë(c)Ë^ 128Ë- 128)

	)

293 #ifde‡
REGEX_MALLOC


295 
	#REGEX_ALLOCATE
 
mÆloc


	)

296 
	#REGEX_REALLOCATE
(
sour˚
, 
osize
, 
nsize
Ë
	`ªÆloc
 (sour˚,Çsize)

	)

297 
	#REGEX_FREE
 
‰ì


	)

302 #i‚de‡
Æloˇ


305 #ifde‡
__GNUC__


306 
	#Æloˇ
 
__buûtö_Æloˇ


	)

308 #i‡
HAVE_ALLOCA_H


309 
	~<Æloˇ.h
>

315 
	#REGEX_ALLOCATE
 
Æloˇ


	)

318 
	#REGEX_REALLOCATE
(
sour˚
, 
osize
, 
nsize
) \

319 (
de°ö©i⁄
 = (*Ë
	`Æloˇ
 (
nsize
), \

320 
	`mem˝y
 (
de°ö©i⁄
, 
sour˚
, 
osize
))

	)

323 
	#REGEX_FREE
(
¨g
Ë(()0Ë

	)

329 #i‡
deföed
 
REL_ALLOC
 && deföed 
REGEX_MALLOC


331 
	#REGEX_ALLOCATE_STACK
(
size
) \

332 
	`r_Æloc
 (&
Áûuª_°ack_±r
, (
size
))

	)

333 
	#REGEX_REALLOCATE_STACK
(
sour˚
, 
osize
, 
nsize
) \

334 
	`r_ª_Æloc
 (&
Áûuª_°ack_±r
, (
nsize
))

	)

335 
	#REGEX_FREE_STACK
(
±r
) \

336 
	`r_Æloc_‰ì
 (&
Áûuª_°ack_±r
)

	)

340 #ifde‡
REGEX_MALLOC


342 
	#REGEX_ALLOCATE_STACK
 
mÆloc


	)

343 
	#REGEX_REALLOCATE_STACK
(
sour˚
, 
osize
, 
nsize
Ë
	`ªÆloc
 (sour˚,Çsize)

	)

344 
	#REGEX_FREE_STACK
 
‰ì


	)

348 
	#REGEX_ALLOCATE_STACK
 
Æloˇ


	)

350 
	#REGEX_REALLOCATE_STACK
(
sour˚
, 
osize
, 
nsize
) \

351 
	`REGEX_REALLOCATE
 (
sour˚
, 
osize
, 
nsize
)

	)

353 
	#REGEX_FREE_STACK
(
¨g
)

	)

362 
	#FIRST_STRING_P
(
±r
) \

363 (
size1
 && 
°rög1
 <(
±r
Ë&& (±rË<°rög1 + size1)

	)

366 
	#TALLOC
(
n
, 
t
Ë(— *Ë
	`mÆloc
 (“Ë*  (t)))

	)

367 
	#RETALLOC
(
addr
, 
n
, 
t
Ë(◊ddrË— *Ë
	`ªÆloc
 (addr, (nË*  (t)))

	)

368 
	#RETALLOC_IF
(
addr
, 
n
, 
t
) \

369 i‡(
addr
Ë
	`RETALLOC
(◊ddr), (
n
), 
t
); ◊ddrË
	`TALLOC
 (“),Å)

	)

370 
	#REGEX_TALLOC
(
n
, 
t
Ë(— *Ë
	`REGEX_ALLOCATE
 (“Ë*  (t)))

	)

372 
	#BYTEWIDTH
 8

	)

374 
	#STREQ
(
s1
, 
s2
Ë((
	`°rcmp
 (s1, s2Ë=0))

	)

376 #unde‡
MAX


377 #unde‡
MIN


378 
	#MAX
(
a
, 
b
Ë(◊Ë> (bË? (aË: (b))

	)

379 
	#MIN
(
a
, 
b
Ë(◊Ë< (bË? (aË: (b))

	)

381 
	tboﬁón
;

382 
	#Ál£
 0

	)

383 
	#åue
 1

	)

385 
ª_m©ch_2_öã∫Æ
 
PARAMS
 ((
ª_∑âîn_buf„r
 *
buÂ
,

386 c⁄° *
°rög1
, 
size1
,

387 c⁄° *
°rög2
, 
size2
,

388 
pos
,

389 
ª_ªgi°îs
 *
ªgs
,

390 
°›
));

399 
	mno_›
 = 0,

402 
	msuc˚ed
,

405 
	mexa˘n
,

408 
	m™ych¨
,

416 
	mch¨£t
,

420 
	mch¨£t_nŸ
,

429 
	m°¨t_mem‹y
,

438 
	m°›_mem‹y
,

442 
	mdu∂iˇã
,

445 
	mbeglöe
,

448 
	mídlöe
,

452 
	mbegbuf
,

455 
	mídbuf
,

458 
	mjump
,

461 
	mjump_∑°_Æt
,

465 
	m⁄_Áûuª_jump
,

469 
	m⁄_Áûuª_kìp_°rög_jump
,

473 
	mp›_Áûuª_jump
,

482 
	mmaybe_p›_jump
,

489 
	mdummy_Áûuª_jump
,

493 
	mpush_dummy_Áûuª
,

497 
	msuc˚ed_n
,

501 
	mjump_n
,

506 
	m£t_numbî_©
,

508 
	mw‹dch¨
,

509 
	mnŸw‹dch¨
,

511 
	mw‹dbeg
,

512 
	mw‹díd
,

514 
	mw‹dbound
,

515 
	mnŸw‹dbound


517 #ifde‡
emacs


518 ,
	mbef‹e_dŸ
,

519 
	m©_dŸ
,

520 
	ma·î_dŸ
,

524 
	msy¡ax•ec
,

527 
	mnŸsy¡ax•ec


529 } 
	tª_›code_t
;

535 
	#STORE_NUMBER
(
de°ö©i⁄
, 
numbî
) \

537 (
de°ö©i⁄
)[0] = (
numbî
) & 0377; \

538 (
de°ö©i⁄
)[1] = (
numbî
) >> 8; \

539 } 0)

	)

545 
	#STORE_NUMBER_AND_INCR
(
de°ö©i⁄
, 
numbî
) \

547 
	`STORE_NUMBER
 (
de°ö©i⁄
, 
numbî
); \

548 (
de°ö©i⁄
) += 2; \

549 } 0)

	)

554 
	#EXTRACT_NUMBER
(
de°ö©i⁄
, 
sour˚
) \

556 (
de°ö©i⁄
Ë*(
sour˚
) & 0377; \

557 (
de°ö©i⁄
Ë+
	`SIGN_EXTEND_CHAR
 (*((
sour˚
) + 1)) << 8; \

558 } 0)

	)

560 #ifde‡
DEBUG


561 
exåa˘_numbî
 
_RE_ARGS
 ((*
de°
, *
sour˚
));

563 
	$exåa˘_numbî
 (
de°
, 
sour˚
)

564 *
de°
;

565 *
sour˚
;

567 
ãmp
 = 
	`SIGN_EXTEND_CHAR
 (*(
sour˚
 + 1));

568 *
de°
 = *
sour˚
 & 0377;

569 *
de°
 +
ãmp
 << 8;

570 
	}
}

572 #i‚de‡
EXTRACT_MACROS


573 #unde‡
EXTRACT_NUMBER


574 
	#EXTRACT_NUMBER
(
de°
, 
§c
Ë
	`exåa˘_numbî
 (&de°, src)

	)

582 
	#EXTRACT_NUMBER_AND_INCR
(
de°ö©i⁄
, 
sour˚
) \

584 
	`EXTRACT_NUMBER
 (
de°ö©i⁄
, 
sour˚
); \

585 (
sour˚
) += 2; \

586 } 0)

	)

588 #ifde‡
DEBUG


589 
exåa˘_numbî_™d_ö¸
 
_RE_ARGS
 ((*
de°ö©i⁄
,

590 **
sour˚
));

592 
	$exåa˘_numbî_™d_ö¸
 (
de°ö©i⁄
, 
sour˚
)

593 *
de°ö©i⁄
;

594 **
sour˚
;

596 
	`exåa˘_numbî
 (
de°ö©i⁄
, *
sour˚
);

597 *
sour˚
 += 2;

598 
	}
}

600 #i‚de‡
EXTRACT_MACROS


601 #unde‡
EXTRACT_NUMBER_AND_INCR


602 
	#EXTRACT_NUMBER_AND_INCR
(
de°
, 
§c
) \

603 
	`exåa˘_numbî_™d_ö¸
 (&
de°
, &
§c
)

	)

614 #ifde‡
DEBUG


617 
	~<°dio.h
>

620 
	~"zas£π.h
"

622 
	gdebug
;

624 
	#DEBUG_STATEMENT
(
e
Ë
	)
e

625 
	#DEBUG_PRINT1
(
x
Ëi‡(
debug
Ë
	`¥ötf
 (x)

	)

626 
	#DEBUG_PRINT2
(
x1
, 
x2
Ëi‡(
debug
Ë
	`¥ötf
 (x1, x2)

	)

627 
	#DEBUG_PRINT3
(
x1
, 
x2
, 
x3
Ëi‡(
debug
Ë
	`¥ötf
 (x1, x2, x3)

	)

628 
	#DEBUG_PRINT4
(
x1
, 
x2
, 
x3
, 
x4
Ëi‡(
debug
Ë
	`¥ötf
 (x1, x2, x3, x4)

	)

629 
	#DEBUG_PRINT_COMPILED_PATTERN
(
p
, 
s
, 
e
) \

630 i‡(
debug
Ë
	`¥öt_∑πül_compûed_∑âîn
 (
s
, 
e
)

	)

631 
	#DEBUG_PRINT_DOUBLE_STRING
(
w
, 
s1
, 
sz1
, 
s2
, 
sz2
) \

632 i‡(
debug
Ë
	`¥öt_doubÀ_°rög
 (
w
, 
s1
, 
sz1
, 
s2
, 
sz2
)

	)

638 
	$¥öt_Á°m≠
 (
Á°m≠
)

639 *
Á°m≠
;

641 
was_a_ønge
 = 0;

642 
i
 = 0;

644 
i
 < (1 << 
BYTEWIDTH
))

646 i‡(
Á°m≠
[
i
++])

648 
was_a_ønge
 = 0;

649 
	`putch¨
 (
i
 - 1);

650 
i
 < (1 << 
BYTEWIDTH
Ë&& 
Á°m≠
[i])

652 
was_a_ønge
 = 1;

653 
i
++;

655 i‡(
was_a_ønge
)

657 
	`¥ötf
 ("-");

658 
	`putch¨
 (
i
 - 1);

662 
	`putch¨
 ('\n');

663 
	}
}

670 
	$¥öt_∑πül_compûed_∑âîn
 (
°¨t
, 
íd
)

671 *
°¨t
;

672 *
íd
;

674 
m˙t
, 
m˙t2
;

675 *
p1
;

676 *
p
 = 
°¨t
;

677 *
≥nd
 = 
íd
;

679 i‡(
°¨t
 =
NULL
)

681 
	`¥ötf
 ("(null)\n");

686 
p
 < 
≥nd
)

688 
	`¥ötf
 ("%d:\t", 
p
 - 
°¨t
);

690 (
ª_›code_t
Ë*
p
++)

692 
no_›
:

693 
	`¥ötf
 ("/no_op");

696 
exa˘n
:

697 
m˙t
 = *
p
++;

698 
	`¥ötf
 ("/exa˘n/%d", 
m˙t
);

701 
	`putch¨
 ('/');

702 
	`putch¨
 (*
p
++);

704 --
m˙t
);

707 
°¨t_mem‹y
:

708 
m˙t
 = *
p
++;

709 
	`¥ötf
 ("/°¨t_mem‹y/%d/%d", 
m˙t
, *
p
++);

712 
°›_mem‹y
:

713 
m˙t
 = *
p
++;

714 
	`¥ötf
 ("/°›_mem‹y/%d/%d", 
m˙t
, *
p
++);

717 
du∂iˇã
:

718 
	`¥ötf
 ("/du∂iˇã/%d", *
p
++);

721 
™ych¨
:

722 
	`¥ötf
 ("/anychar");

725 
ch¨£t
:

726 
ch¨£t_nŸ
:

728 
c
, 
œ°
 = -100;

729 
ö_ønge
 = 0;

731 
	`¥ötf
 ("/charset [%s",

732 (
ª_›code_t
Ë*(
p
 - 1Ë=
ch¨£t_nŸ
 ? "^" : "");

734 
	`as£π
 (
p
 + *∞< 
≥nd
);

736 
c
 = 0; c < 256; c++)

737 i‡(
c
 / 8 < *
p


738 && (
p
[1 + (
c
/8)] & (1 << (c % 8))))

741 i‡(
œ°
 + 1 =
c
 && ! 
ö_ønge
)

743 
	`putch¨
 ('-');

744 
ö_ønge
 = 1;

747 i‡(
œ°
 + 1 !
c
 && 
ö_ønge
)

749 
	`putch¨
 (
œ°
);

750 
ö_ønge
 = 0;

753 i‡(! 
ö_ønge
)

754 
	`putch¨
 (
c
);

756 
œ°
 = 
c
;

759 i‡(
ö_ønge
)

760 
	`putch¨
 (
œ°
);

762 
	`putch¨
 (']');

764 
p
 += 1 + *p;

768 
beglöe
:

769 
	`¥ötf
 ("/begline");

772 
ídlöe
:

773 
	`¥ötf
 ("/endline");

776 
⁄_Áûuª_jump
:

777 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

778 
	`¥ötf
 ("/⁄_Áûuª_jum∞tÿ%d", 
p
 + 
m˙t
 - 
°¨t
);

781 
⁄_Áûuª_kìp_°rög_jump
:

782 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

783 
	`¥ötf
 ("/⁄_Áûuª_kìp_°rög_jum∞tÿ%d", 
p
 + 
m˙t
 - 
°¨t
);

786 
dummy_Áûuª_jump
:

787 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

788 
	`¥ötf
 ("/dummy_Áûuª_jum∞tÿ%d", 
p
 + 
m˙t
 - 
°¨t
);

791 
push_dummy_Áûuª
:

792 
	`¥ötf
 ("/push_dummy_failure");

795 
maybe_p›_jump
:

796 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

797 
	`¥ötf
 ("/maybe_p›_jum∞tÿ%d", 
p
 + 
m˙t
 - 
°¨t
);

800 
p›_Áûuª_jump
:

801 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

802 
	`¥ötf
 ("/p›_Áûuª_jum∞tÿ%d", 
p
 + 
m˙t
 - 
°¨t
);

805 
jump_∑°_Æt
:

806 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

807 
	`¥ötf
 ("/jump_∑°_Æàtÿ%d", 
p
 + 
m˙t
 - 
°¨t
);

810 
jump
:

811 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

812 
	`¥ötf
 ("/jum∞tÿ%d", 
p
 + 
m˙t
 - 
°¨t
);

815 
suc˚ed_n
:

816 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

817 
p1
 = 
p
 + 
m˙t
;

818 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t2
, &
p
);

819 
	`¥ötf
 ("/suc˚ed_¿tÿ%d, %dÅimes", 
p1
 - 
°¨t
, 
m˙t2
);

822 
jump_n
:

823 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

824 
p1
 = 
p
 + 
m˙t
;

825 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t2
, &
p
);

826 
	`¥ötf
 ("/jump_¿tÿ%d, %dÅimes", 
p1
 - 
°¨t
, 
m˙t2
);

829 
£t_numbî_©
:

830 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t
, &
p
);

831 
p1
 = 
p
 + 
m˙t
;

832 
	`exåa˘_numbî_™d_ö¸
 (&
m˙t2
, &
p
);

833 
	`¥ötf
 ("/£t_numbî_©Üoˇti⁄ %dÅÿ%d", 
p1
 - 
°¨t
, 
m˙t2
);

836 
w‹dbound
:

837 
	`¥ötf
 ("/wordbound");

840 
nŸw‹dbound
:

841 
	`¥ötf
 ("/notwordbound");

844 
w‹dbeg
:

845 
	`¥ötf
 ("/wordbeg");

848 
w‹díd
:

849 
	`¥ötf
 ("/wordend");

851 #ifde‡
emacs


852 
bef‹e_dŸ
:

853 
	`¥ötf
 ("/before_dot");

856 
©_dŸ
:

857 
	`¥ötf
 ("/at_dot");

860 
a·î_dŸ
:

861 
	`¥ötf
 ("/after_dot");

864 
sy¡ax•ec
:

865 
	`¥ötf
 ("/syntaxspec");

866 
m˙t
 = *
p
++;

867 
	`¥ötf
 ("/%d", 
m˙t
);

870 
nŸsy¡ax•ec
:

871 
	`¥ötf
 ("/notsyntaxspec");

872 
m˙t
 = *
p
++;

873 
	`¥ötf
 ("/%d", 
m˙t
);

877 
w‹dch¨
:

878 
	`¥ötf
 ("/wordchar");

881 
nŸw‹dch¨
:

882 
	`¥ötf
 ("/notwordchar");

885 
begbuf
:

886 
	`¥ötf
 ("/begbuf");

889 
ídbuf
:

890 
	`¥ötf
 ("/endbuf");

894 
	`¥ötf
 ("?%d", *(
p
-1));

897 
	`putch¨
 ('\n');

900 
	`¥ötf
 ("%d:\ãnd o‡∑âîn.\n", 
p
 - 
°¨t
);

901 
	}
}

905 
	$¥öt_compûed_∑âîn
 (
buÂ
)

906 
ª_∑âîn_buf„r
 *
buÂ
;

908 *
buf„r
 = 
buÂ
->buffer;

910 
	`¥öt_∑πül_compûed_∑âîn
 (
buf„r
, buf„∏+ 
buÂ
->
u£d
);

911 
	`¥ötf
 ("%ld bytes used/%ld bytesállocated.\n",

912 
buÂ
->
u£d
, buÂ->
Æloˇãd
);

914 i‡(
buÂ
->
Á°m≠_accuøã
 && buÂ->
Á°m≠
)

916 
	`¥ötf
 ("fastmap: ");

917 
	`¥öt_Á°m≠
 (
buÂ
->
Á°m≠
);

920 
	`¥ötf
 ("ª_nsub: %d\t", 
buÂ
->
ª_nsub
);

921 
	`¥ötf
 ("ªgs_Æloc: %d\t", 
buÂ
->
ªgs_Æloˇãd
);

922 
	`¥ötf
 ("ˇn_be_nuŒ: %d\t", 
buÂ
->
ˇn_be_nuŒ
);

923 
	`¥ötf
 ("√wlöe_™ch‹: %d\n", 
buÂ
->
√wlöe_™ch‹
);

924 
	`¥ötf
 ("no_sub: %d\t", 
buÂ
->
no_sub
);

925 
	`¥ötf
 ("nŸ_bﬁ: %d\t", 
buÂ
->
nŸ_bﬁ
);

926 
	`¥ötf
 ("nŸ_eﬁ: %d\t", 
buÂ
->
nŸ_eﬁ
);

927 
	`¥ötf
 ("sy¡ax: %lx\n", 
buÂ
->
sy¡ax
);

929 
	}
}

933 
	$¥öt_doubÀ_°rög
 (
whîe
, 
°rög1
, 
size1
, 
°rög2
, 
size2
)

934 c⁄° *
whîe
;

935 c⁄° *
°rög1
;

936 c⁄° *
°rög2
;

937 
size1
;

938 
size2
;

940 
this_ch¨
;

942 i‡(
whîe
 =
NULL
)

943 
	`¥ötf
 ("(null)");

946 i‡(
	`FIRST_STRING_P
 (
whîe
))

948 
this_ch¨
 = 
whîe
 - 
°rög1
;Åhis_ch¨ < 
size1
;Åhis_char++)

949 
	`putch¨
 (
°rög1
[
this_ch¨
]);

951 
whîe
 = 
°rög2
;

954 
this_ch¨
 = 
whîe
 - 
°rög2
;Åhis_ch¨ < 
size2
;Åhis_char++)

955 
	`putch¨
 (
°rög2
[
this_ch¨
]);

957 
	}
}

960 
	$¥ötch¨
 (
c
)

961 
c
;

963 
	`putc
 (
c
, 
°dîr
);

964 
	}
}

968 #unde‡
as£π


969 
	#as£π
(
e
)

	)

971 
	#DEBUG_STATEMENT
(
e
)

	)

972 
	#DEBUG_PRINT1
(
x
)

	)

973 
	#DEBUG_PRINT2
(
x1
, 
x2
)

	)

974 
	#DEBUG_PRINT3
(
x1
, 
x2
, 
x3
)

	)

975 
	#DEBUG_PRINT4
(
x1
, 
x2
, 
x3
, 
x4
)

	)

976 
	#DEBUG_PRINT_COMPILED_PATTERN
(
p
, 
s
, 
e
)

	)

977 
	#DEBUG_PRINT_DOUBLE_STRING
(
w
, 
s1
, 
sz1
, 
s2
, 
sz2
)

	)

986 
ªg_sy¡ax_t
 
	gª_sy¡ax_›ti⁄s
;

996 
ªg_sy¡ax_t


997 
	$ª_£t_sy¡ax
 (
sy¡ax
)

998 
ªg_sy¡ax_t
 
sy¡ax
;

1000 
ªg_sy¡ax_t
 
ªt
 = 
ª_sy¡ax_›ti⁄s
;

1002 
ª_sy¡ax_›ti⁄s
 = 
sy¡ax
;

1003 #ifde‡
DEBUG


1004 i‡(
sy¡ax
 & 
RE_DEBUG
)

1005 
debug
 = 1;

1006 i‡(
debug
)

1007 
debug
 = 0;

1009  
ªt
;

1010 
	}
}

1011 #ifde‡
_LIBC


1012 
	$wók_Æüs
 (
__ª_£t_sy¡ax
, 
ª_£t_sy¡ax
)

1020 c⁄° 
ª_îr‹_msgid
[] =

1022 
	#REG_NOERROR_IDX
 0

	)

1023 
	`gëãxt_no›
 ("Success")

1025 
	#REG_NOMATCH_IDX
 (
REG_NOERROR_IDX
 +  "Suc˚ss")

	)

1026 
	`gëãxt_no›
 ("No match")

1028 
	#REG_BADPAT_IDX
 (
REG_NOMATCH_IDX
 +  "Nÿm©ch")

	)

1029 
	`gëãxt_no›
 ("InvalidÑegularÉxpression")

1031 
	#REG_ECOLLATE_IDX
 (
REG_BADPAT_IDX
 +  "InvÆidÑeguœ∏ex¥essi⁄")

	)

1032 
	`gëãxt_no›
 ("Invalid collation character")

1034 
	#REG_ECTYPE_IDX
 (
REG_ECOLLATE_IDX
 +  "InvÆid cﬁœti⁄ ch¨a˘î")

	)

1035 
	`gëãxt_no›
 ("Invalid character classÇame")

1037 
	#REG_EESCAPE_IDX
 (
REG_ECTYPE_IDX
 +  "InvÆid ch¨a˘î cœs†«me")

	)

1038 
	`gëãxt_no›
 ("Trailing backslash")

1040 
	#REG_ESUBREG_IDX
 (
REG_EESCAPE_IDX
 +  "Tøûög back¶ash")

	)

1041 
	`gëãxt_no›
 ("Invalid backÑeference")

1043 
	#REG_EBRACK_IDX
 (
REG_ESUBREG_IDX
 +  "InvÆid backÑe„ªn˚")

	)

1044 
	`gëãxt_no›
 ("Unmatched [ or [^")

1046 
	#REG_EPAREN_IDX
 (
REG_EBRACK_IDX
 +  "Unm©ched [ o∏[^")

	)

1047 
	`gëãxt_no›
 ("Unmatched ( or \\(")

1049 
	#REG_EBRACE_IDX
 (
REG_EPAREN_IDX
 +  "Unm©ched ( o∏\\(")

	)

1050 
	`gëãxt_no›
 ("Unmatched \\{")

1052 
	#REG_BADBR_IDX
 (
REG_EBRACE_IDX
 +  "Unm©ched \\{")

	)

1053 
	`gëãxt_no›
 ("Invalid content of \\{\\}")

1055 
	#REG_ERANGE_IDX
 (
REG_BADBR_IDX
 +  "InvÆid c⁄ã¡ o‡\\{\\}")

	)

1056 
	`gëãxt_no›
 ("InvalidÑangeÉnd")

1058 
	#REG_ESPACE_IDX
 (
REG_ERANGE_IDX
 +  "InvÆidÑ™gêíd")

	)

1059 
	`gëãxt_no›
 ("MemoryÉxhausted")

1061 
	#REG_BADRPT_IDX
 (
REG_ESPACE_IDX
 +  "Mem‹yÉxhau°ed")

	)

1062 
	`gëãxt_no›
 ("InvalidÖrecedingÑegularÉxpression")

1064 
	#REG_EEND_IDX
 (
REG_BADRPT_IDX
 +  "InvÆidÖª˚dögÑeguœ∏ex¥essi⁄")

	)

1065 
	`gëãxt_no›
 ("PrematureÉnd ofÑegularÉxpression")

1067 
	#REG_ESIZE_IDX
 (
REG_EEND_IDX
 +  "Pªm©uªÉnd o‡ªguœ∏ex¥essi⁄")

	)

1068 
	`gëãxt_no›
 ("RegularÉxpressionÅoo big")

1070 
	#REG_ERPAREN_IDX
 (
REG_ESIZE_IDX
 +  "Reguœ∏ex¥essi⁄Åoÿbig")

	)

1071 
	`gëãxt_no›
 ("Unmatched ) or \\)"),

1072 
	}
};

1074 c⁄° 
size_t
 
	gª_îr‹_msgid_idx
[] =

1076 
REG_NOERROR_IDX
,

1077 
REG_NOMATCH_IDX
,

1078 
REG_BADPAT_IDX
,

1079 
REG_ECOLLATE_IDX
,

1080 
REG_ECTYPE_IDX
,

1081 
REG_EESCAPE_IDX
,

1082 
REG_ESUBREG_IDX
,

1083 
REG_EBRACK_IDX
,

1084 
REG_EPAREN_IDX
,

1085 
REG_EBRACE_IDX
,

1086 
REG_BADBR_IDX
,

1087 
REG_ERANGE_IDX
,

1088 
REG_ESPACE_IDX
,

1089 
REG_BADRPT_IDX
,

1090 
REG_EEND_IDX
,

1091 
REG_ESIZE_IDX
,

1092 
REG_ERPAREN_IDX


1115 
	#MATCH_MAY_ALLOCATE


	)

1119 #ifde‡
__GNUC__


1120 #unde‡
C_ALLOCA


1128 #i‡(
deföed
 
C_ALLOCA
 || deföed 
REGEX_MALLOC
Ë&& deföed 
emacs


1129 #unde‡
MATCH_MAY_ALLOCATE


1141 #i‚de‡
INIT_FAILURE_ALLOC


1142 
	#INIT_FAILURE_ALLOC
 5

	)

1150 #ifde‡
INT_IS_16BIT


1152 #i‡
deföed
 
MATCH_MAY_ALLOCATE


1155 
	gª_max_Áûuªs
 = 4000;

1157 
	gª_max_Áûuªs
 = 2000;

1160 
	uÁû_°ack_ñt


1162 *
	mpoöãr
;

1163 
	möãgî
;

1166 
Áû_°ack_ñt
 
	tÁû_°ack_ñt_t
;

1170 
Áû_°ack_ñt_t
 *
	m°ack
;

1171 
	msize
;

1172 
	mavaû
;

1173 } 
	tÁû_°ack_ty≥
;

1177 #i‡
deföed
 
MATCH_MAY_ALLOCATE


1180 
	gª_max_Áûuªs
 = 20000;

1182 
	gª_max_Áûuªs
 = 2000;

1185 
	uÁû_°ack_ñt


1187 *
	mpoöãr
;

1188 
	möãgî
;

1191 
Áû_°ack_ñt
 
	tÁû_°ack_ñt_t
;

1195 
Áû_°ack_ñt_t
 *
	m°ack
;

1196 
	msize
;

1197 
	mavaû
;

1198 } 
	tÁû_°ack_ty≥
;

1202 
	#FAIL_STACK_EMPTY
(Ë(
Áû_°ack
.
avaû
 =0)

	)

1203 
	#FAIL_STACK_PTR_EMPTY
(Ë(
Áû_°ack_±r
->
avaû
 =0)

	)

1204 
	#FAIL_STACK_FULL
(Ë(
Áû_°ack
.
avaû
 =Áû_°ack.
size
)

	)

1210 #ifde‡
MATCH_MAY_ALLOCATE


1211 
	#INIT_FAIL_STACK
() \

1213 
Áû_°ack
.
°ack
 = (
Áû_°ack_ñt_t
 *) \

1214 
	`REGEX_ALLOCATE_STACK
 (
INIT_FAILURE_ALLOC
 *  (
Áû_°ack_ñt_t
)); \

1216 i‡(
Áû_°ack
.
°ack
 =
NULL
) \

1219 
Áû_°ack
.
size
 = 
INIT_FAILURE_ALLOC
; \

1220 
Áû_°ack
.
avaû
 = 0; \

1221 } 0)

	)

1223 
	#RESET_FAIL_STACK
(Ë
	`REGEX_FREE_STACK
 (
Áû_°ack
.
°ack
)

	)

1225 
	#INIT_FAIL_STACK
() \

1227 
Áû_°ack
.
avaû
 = 0; \

1228 } 0)

	)

1230 
	#RESET_FAIL_STACK
()

	)

1241 
	#DOUBLE_FAIL_STACK
(
Áû_°ack
) \

1242 ((
Áû_°ack
).
size
 > (Ë(
ª_max_Áûuªs
 * 
MAX_FAILURE_ITEMS
) \

1244 : ((
Áû_°ack
).
°ack
 = (
Áû_°ack_ñt_t
 *) \

1245 
	`REGEX_REALLOCATE_STACK
 ((
Áû_°ack
).
°ack
, \

1246 (
Áû_°ack
).
size
 *  (
Áû_°ack_ñt_t
), \

1247 ((
Áû_°ack
).
size
 << 1Ë*  (
Áû_°ack_ñt_t
)), \

1249 (
Áû_°ack
).
°ack
 =
NULL
 \

1251 : ((
Áû_°ack
).
size
 <<= 1, \

1252 1)))

	)

1258 
	#PUSH_PATTERN_OP
(
POINTER
, 
FAIL_STACK
) \

1259 ((
	`FAIL_STACK_FULL
 () \

1260 && !
	`DOUBLE_FAIL_STACK
 (
FAIL_STACK
)) \

1262 : ((
FAIL_STACK
).
°ack
[(FAIL_STACK).
avaû
++].
poöãr
 = 
POINTER
, \

1263 1))

	)

1268 
	#PUSH_FAILURE_POINTER
(
ôem
) \

1269 
Áû_°ack
.
°ack
[Áû_°ack.
avaû
++].
poöãr
 = (*Ë(
ôem
)

	)

1274 
	#PUSH_FAILURE_INT
(
ôem
) \

1275 
Áû_°ack
.
°ack
[Áû_°ack.
avaû
++].
öãgî
 = (
ôem
)

	)

1280 
	#PUSH_FAILURE_ELT
(
ôem
) \

1281 
Áû_°ack
.
°ack
[Áû_°ack.
avaû
++] = (
ôem
)

	)

1285 
	#POP_FAILURE_POINTER
(Ë
Áû_°ack
.
°ack
[--Áû_°ack.
avaû
].
poöãr


	)

1286 
	#POP_FAILURE_INT
(Ë
Áû_°ack
.
°ack
[--Áû_°ack.
avaû
].
öãgî


	)

1287 
	#POP_FAILURE_ELT
(Ë
Áû_°ack
.
°ack
[--Áû_°ack.
avaû
]

	)

1290 #ifde‡
DEBUG


1291 
	#DEBUG_PUSH
 
PUSH_FAILURE_INT


	)

1292 
	#DEBUG_POP
(
ôem_addr
Ë*(ôem_addrË
	`POP_FAILURE_INT
 ()

	)

1294 
	#DEBUG_PUSH
(
ôem
)

	)

1295 
	#DEBUG_POP
(
ôem_addr
)

	)

1308 
	#PUSH_FAILURE_POINT
(
∑âîn_∂a˚
, 
°rög_∂a˚
, 
Áûuª_code
) \

1310 *
de°ö©i⁄
; \

1316 
a˘ive_ªg_t
 
this_ªg
; \

1318 
	`DEBUG_STATEMENT
 (
Áûuª_id
++); \

1319 
	`DEBUG_STATEMENT
 (
nÁûuª_poöts_pushed
++); \

1320 
	`DEBUG_PRINT2
 ("\nPUSH_FAILURE_POINT #%u:\n", 
Áûuª_id
); \

1321 
	`DEBUG_PRINT2
 (" Bef‹êpush,Çexàavaû: %d\n", (
Áû_°ack
).
avaû
);\

1322 
	`DEBUG_PRINT2
 (" size: %d\n", (
Áû_°ack
).
size
);\

1324 
	`DEBUG_PRINT2
 (" slŸ†√eded: %ld\n", 
NUM_FAILURE_ITEMS
); \

1325 
	`DEBUG_PRINT2
 ("ávaûabÀ: %d\n", 
REMAINING_AVAIL_SLOTS
); \

1328 
REMAINING_AVAIL_SLOTS
 < 
NUM_FAILURE_ITEMS
) \

1330 i‡(!
	`DOUBLE_FAIL_STACK
 (
Áû_°ack
)) \

1331  
Áûuª_code
; \

1333 
	`DEBUG_PRINT2
 ("\n Doubled stack; sizeÇow: %d\n", \

1334 (
Áû_°ack
).
size
); \

1335 
	`DEBUG_PRINT2
 (" slŸ†avaûabÀ: %d\n", 
REMAINING_AVAIL_SLOTS
);\

1339 
	`DEBUG_PRINT1
 ("\n"); \

1342 
this_ªg
 = 
lowe°_a˘ive_ªg
;Åhis_ªg <
highe°_a˘ive_ªg
; \

1343 
this_ªg
++) \

1345 
	`DEBUG_PRINT2
 (" PushögÑeg: %lu\n", 
this_ªg
); \

1346 
	`DEBUG_STATEMENT
 (
num_ªgs_pushed
++); \

1348 
	`DEBUG_PRINT2
 (" sèπ: %p\n", 
ªg°¨t
[
this_ªg
]); \

1349 
	`PUSH_FAILURE_POINTER
 (
ªg°¨t
[
this_ªg
]); \

1351 
	`DEBUG_PRINT2
 ("Énd: %p\n", 
ªgíd
[
this_ªg
]); \

1352 
	`PUSH_FAILURE_POINTER
 (
ªgíd
[
this_ªg
]); \

1354 
	`DEBUG_PRINT2
 (" info: %p\n ", \

1355 
ªg_öfo
[
this_ªg
].
w‹d
.
poöãr
); \

1356 
	`DEBUG_PRINT2
 (" match_null=%d", \

1357 
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[
this_ªg
])); \

1358 
	`DEBUG_PRINT2
 ("á˘ive=%d", 
	`IS_ACTIVE
 (
ªg_öfo
[
this_ªg
])); \

1359 
	`DEBUG_PRINT2
 (" matched_something=%d", \

1360 
	`MATCHED_SOMETHING
 (
ªg_öfo
[
this_ªg
])); \

1361 
	`DEBUG_PRINT2
 ("Éver_matched=%d", \

1362 
	`EVER_MATCHED_SOMETHING
 (
ªg_öfo
[
this_ªg
])); \

1363 
	`DEBUG_PRINT1
 ("\n"); \

1364 
	`PUSH_FAILURE_ELT
 (
ªg_öfo
[
this_ªg
].
w‹d
); \

1367 
	`DEBUG_PRINT2
 (" PushögÜowá˘ivêªg: %ld\n", 
lowe°_a˘ive_ªg
);\

1368 
	`PUSH_FAILURE_INT
 (
lowe°_a˘ive_ªg
); \

1370 
	`DEBUG_PRINT2
 (" Pushög highá˘ivêªg: %ld\n", 
highe°_a˘ive_ªg
);\

1371 
	`PUSH_FAILURE_INT
 (
highe°_a˘ive_ªg
); \

1373 
	`DEBUG_PRINT2
 (" PushögÖ©ã∫ %p:\n", 
∑âîn_∂a˚
); \

1374 
	`DEBUG_PRINT_COMPILED_PATTERN
 (
buÂ
, 
∑âîn_∂a˚
, 
≥nd
); \

1375 
	`PUSH_FAILURE_POINTER
 (
∑âîn_∂a˚
); \

1377 
	`DEBUG_PRINT2
 (" Pushög såög %p: `", 
°rög_∂a˚
); \

1378 
	`DEBUG_PRINT_DOUBLE_STRING
 (
°rög_∂a˚
, 
°rög1
, 
size1
, 
°rög2
, \

1379 
size2
); \

1380 
	`DEBUG_PRINT1
 ("'\n"); \

1381 
	`PUSH_FAILURE_POINTER
 (
°rög_∂a˚
); \

1383 
	`DEBUG_PRINT2
 (" Pushög faûuª id: %u\n", 
Áûuª_id
); \

1384 
	`DEBUG_PUSH
 (
Áûuª_id
); \

1385 } 0)

	)

1389 
	#NUM_REG_ITEMS
 3

	)

1392 #ifde‡
DEBUG


1393 
	#NUM_NONREG_ITEMS
 5

	)

1395 
	#NUM_NONREG_ITEMS
 4

	)

1402 
	#MAX_FAILURE_ITEMS
 (5 * 
NUM_REG_ITEMS
 + 
NUM_NONREG_ITEMS
)

	)

1405 
	#NUM_FAILURE_ITEMS
 \

1407 ? 0 : 
highe°_a˘ive_ªg
 - 
lowe°_a˘ive_ªg
 + 1) \

1408 * 
NUM_REG_ITEMS
) \

1409 + 
NUM_NONREG_ITEMS
)

	)

1412 
	#REMAINING_AVAIL_SLOTS
 ((
Áû_°ack
).
size
 - (Áû_°ack).
avaû
)

	)

1427 
	#POP_FAILURE_POINT
(
°r
, 
∑t
, 
low_ªg
, 
high_ªg
, 
ªg°¨t
, 
ªgíd
, 
ªg_öfo
)\

1429 
	`DEBUG_STATEMENT
 (
Áûuª_id
;) \

1430 
a˘ive_ªg_t
 
this_ªg
; \

1431 c⁄° *
°rög_ãmp
; \

1433 
	`as£π
 (!
	`FAIL_STACK_EMPTY
 ()); \

1436 
	`DEBUG_PRINT1
 ("POP_FAILURE_POINT:\n"); \

1437 
	`DEBUG_PRINT2
 (" Bef‹êp›,Çexàavaû: %d\n", 
Áû_°ack
.
avaû
); \

1438 
	`DEBUG_PRINT2
 (" size: %d\n", 
Áû_°ack
.
size
); \

1440 
	`as£π
 (
Áû_°ack
.
avaû
 >
NUM_NONREG_ITEMS
); \

1442 
	`DEBUG_POP
 (&
Áûuª_id
); \

1443 
	`DEBUG_PRINT2
 (" P›pög faûuª id: %u\n", 
Áûuª_id
); \

1448 
°rög_ãmp
 = 
	`POP_FAILURE_POINTER
 (); \

1449 i‡(
°rög_ãmp
 !
NULL
) \

1450 
°r
 = (c⁄° *Ë
°rög_ãmp
; \

1452 
	`DEBUG_PRINT2
 (" P›pög såög %p: `", 
°r
); \

1453 
	`DEBUG_PRINT_DOUBLE_STRING
 (
°r
, 
°rög1
, 
size1
, 
°rög2
, 
size2
); \

1454 
	`DEBUG_PRINT1
 ("'\n"); \

1456 
∑t
 = (*Ë
	`POP_FAILURE_POINTER
 (); \

1457 
	`DEBUG_PRINT2
 (" P›pögÖ©ã∫ %p:\n", 
∑t
); \

1458 
	`DEBUG_PRINT_COMPILED_PATTERN
 (
buÂ
, 
∑t
, 
≥nd
); \

1461 
high_ªg
 = (
a˘ive_ªg_t
Ë
	`POP_FAILURE_INT
 (); \

1462 
	`DEBUG_PRINT2
 (" P›pög highá˘ivêªg: %ld\n", 
high_ªg
); \

1464 
low_ªg
 = (
a˘ive_ªg_t
Ë
	`POP_FAILURE_INT
 (); \

1465 
	`DEBUG_PRINT2
 (" P›pögÜowá˘ivêªg: %ld\n", 
low_ªg
); \

1468 
this_ªg
 = 
high_ªg
;Åhis_ªg >
low_ªg
;Åhis_reg--) \

1470 
	`DEBUG_PRINT2
 (" P›pögÑeg: %ld\n", 
this_ªg
); \

1472 
ªg_öfo
[
this_ªg
].
w‹d
 = 
	`POP_FAILURE_ELT
 (); \

1473 
	`DEBUG_PRINT2
 (" info: %p\n", \

1474 
ªg_öfo
[
this_ªg
].
w‹d
.
poöãr
); \

1476 
ªgíd
[
this_ªg
] = (c⁄° *Ë
	`POP_FAILURE_POINTER
 (); \

1477 
	`DEBUG_PRINT2
 ("Énd: %p\n", 
ªgíd
[
this_ªg
]); \

1479 
ªg°¨t
[
this_ªg
] = (c⁄° *Ë
	`POP_FAILURE_POINTER
 (); \

1480 
	`DEBUG_PRINT2
 (" sèπ: %p\n", 
ªg°¨t
[
this_ªg
]); \

1484 
this_ªg
 = 
highe°_a˘ive_ªg
;Åhis_ªg > 
high_ªg
;Åhis_reg--) \

1486 
ªg_öfo
[
this_ªg
].
w‹d
.
öãgî
 = 0; \

1487 
ªgíd
[
this_ªg
] = 0; \

1488 
ªg°¨t
[
this_ªg
] = 0; \

1490 
highe°_a˘ive_ªg
 = 
high_ªg
; \

1493 
£t_ªgs_m©ched_d⁄e
 = 0; \

1494 
	`DEBUG_STATEMENT
 (
nÁûuª_poöts_p›≥d
++); \

1495 }

	)

1515 
Áû_°ack_ñt_t
 
	mw‹d
;

1520 
	#MATCH_NULL_UNSET_VALUE
 3

	)

1521 
	mm©ch_nuŒ_°rög_p
 : 2;

1522 
	mis_a˘ive
 : 1;

1523 
	mm©ched_somëhög
 : 1;

1524 
	mevî_m©ched_somëhög
 : 1;

1525 } 
	mbôs
;

1526 } 
	tªgi°î_öfo_ty≥
;

1528 
	#REG_MATCH_NULL_STRING_P
(
R
Ë((R).
bôs
.
m©ch_nuŒ_°rög_p
)

	)

1529 
	#IS_ACTIVE
(
R
Ë((R).
bôs
.
is_a˘ive
)

	)

1530 
	#MATCHED_SOMETHING
(
R
Ë((R).
bôs
.
m©ched_somëhög
)

	)

1531 
	#EVER_MATCHED_SOMETHING
(
R
Ë((R).
bôs
.
evî_m©ched_somëhög
)

	)

1537 
	#SET_REGS_MATCHED
() \

1540 i‡(!
£t_ªgs_m©ched_d⁄e
) \

1542 
a˘ive_ªg_t
 
r
; \

1543 
£t_ªgs_m©ched_d⁄e
 = 1; \

1544 
r
 = 
lowe°_a˘ive_ªg
;Ñ <
highe°_a˘ive_ªg
;Ñ++) \

1546 
	`MATCHED_SOMETHING
 (
ªg_öfo
[
r
]) \

1547 
	`EVER_MATCHED_SOMETHING
 (
ªg_öfo
[
r
]) \

1552 0)

	)

1555 
	gªg_un£t_dummy
;

1556 
	#REG_UNSET_VALUE
 (&
ªg_un£t_dummy
)

	)

1557 
	#REG_UNSET
(
e
Ë(”Ë=
REG_UNSET_VALUE
)

	)

1561 
ªg_îrcode_t
 
ªgex_compûe
 
_RE_ARGS
 ((c⁄° *
∑âîn
, 
size_t
 
size
,

1562 
ªg_sy¡ax_t
 
sy¡ax
,

1563 
ª_∑âîn_buf„r
 *
buÂ
));

1564 
°‹e_›1
 
_RE_ARGS
 ((
ª_›code_t
 
›
, *
loc
, 
¨g
));

1565 
°‹e_›2
 
_RE_ARGS
 ((
ª_›code_t
 
›
, *
loc
,

1566 
¨g1
, 
¨g2
));

1567 
ö£π_›1
 
_RE_ARGS
 ((
ª_›code_t
 
›
, *
loc
,

1568 
¨g
, *
íd
));

1569 
ö£π_›2
 
_RE_ARGS
 ((
ª_›code_t
 
›
, *
loc
,

1570 
¨g1
, 
¨g2
, *
íd
));

1571 
boﬁón
 
©_beglöe_loc_p
 
_RE_ARGS
 ((c⁄° *
∑âîn
, c⁄° *
p
,

1572 
ªg_sy¡ax_t
 
sy¡ax
));

1573 
boﬁón
 
©_ídlöe_loc_p
 
_RE_ARGS
 ((c⁄° *
p
, c⁄° *
≥nd
,

1574 
ªg_sy¡ax_t
 
sy¡ax
));

1575 
ªg_îrcode_t
 
compûe_ønge
 
_RE_ARGS
 ((c⁄° **
p_±r
,

1576 c⁄° *
≥nd
,

1577 *
å™¶©e
,

1578 
ªg_sy¡ax_t
 
sy¡ax
,

1579 *
b
));

1585 #i‚de‡
PATFETCH


1586 
	#PATFETCH
(
c
) \

1587 dÿ{i‡(
p
 =
≥nd
Ë 
REG_EEND
; \

1588 
c
 = (Ë*
p
++; \

1589 i‡(
å™¶©e
Ë
c
 = ()Åranslate[c]; \

1590 } 0)

	)

1595 
	#PATFETCH_RAW
(
c
) \

1596 dÿ{i‡(
p
 =
≥nd
Ë 
REG_EEND
; \

1597 
c
 = (Ë*
p
++; \

1598 } 0)

	)

1601 
	#PATUNFETCH
 
p
--

	)

1608 #i‚de‡
TRANSLATE


1609 
	#TRANSLATE
(
d
) \

1610 (
å™¶©e
 ? (Ëå™¶©e[(Ë(
d
)] : (d))

	)

1617 
	#INIT_BUF_SIZE
 32

	)

1620 
	#GET_BUFFER_SPACE
(
n
) \

1621 (Ë(
b
 - 
buÂ
->
buf„r
 + (
n
)Ë> buÂ->
Æloˇãd
) \

1622 
	`EXTEND_BUFFER
 ()

	)

1625 
	#BUF_PUSH
(
c
) \

1627 
	`GET_BUFFER_SPACE
 (1); \

1628 *
b
++ = (Ë(
c
); \

1629 } 0)

	)

1633 
	#BUF_PUSH_2
(
c1
, 
c2
) \

1635 
	`GET_BUFFER_SPACE
 (2); \

1636 *
b
++ = (Ë(
c1
); \

1637 *
b
++ = (Ë(
c2
); \

1638 } 0)

	)

1642 
	#BUF_PUSH_3
(
c1
, 
c2
, 
c3
) \

1644 
	`GET_BUFFER_SPACE
 (3); \

1645 *
b
++ = (Ë(
c1
); \

1646 *
b
++ = (Ë(
c2
); \

1647 *
b
++ = (Ë(
c3
); \

1648 } 0)

	)

1653 
	#STORE_JUMP
(
›
, 
loc
, 
to
) \

1654 
	`°‹e_›1
 (
›
, 
loc
, (Ë((
to
Ë- (locË- 3))

	)

1657 
	#STORE_JUMP2
(
›
, 
loc
, 
to
, 
¨g
) \

1658 
	`°‹e_›2
 (
›
, 
loc
, (Ë((
to
Ë- (locË- 3), 
¨g
)

	)

1661 
	#INSERT_JUMP
(
›
, 
loc
, 
to
) \

1662 
	`ö£π_›1
 (
›
, 
loc
, (Ë((
to
Ë- (locË- 3), 
b
)

	)

1665 
	#INSERT_JUMP2
(
›
, 
loc
, 
to
, 
¨g
) \

1666 
	`ö£π_›2
 (
›
, 
loc
, (Ë((
to
Ë- (locË- 3), 
¨g
, 
b
)

	)

1677 #i‡
deföed
 
_MSC_VER
 && !deföed 
_WIN32


1681 
	#MAX_BUF_SIZE
 65500L

	)

1682 
	#REALLOC
(
p
,
s
Ë
	`ªÆloc
 (’), (
size_t
Ë(s))

	)

1684 
	#MAX_BUF_SIZE
 (1L << 16)

	)

1685 
	#REALLOC
(
p
,
s
Ë
	`ªÆloc
 (’), (s))

	)

1692 
	#EXTEND_BUFFER
() \

1694 *
ﬁd_buf„r
 = 
buÂ
->
buf„r
; \

1695 i‡(
buÂ
->
Æloˇãd
 =
MAX_BUF_SIZE
) \

1696  
REG_ESIZE
; \

1697 
buÂ
->
Æloˇãd
 <<= 1; \

1698 i‡(
buÂ
->
Æloˇãd
 > 
MAX_BUF_SIZE
) \

1699 
buÂ
->
Æloˇãd
 = 
MAX_BUF_SIZE
; \

1700 
buÂ
->
buf„r
 = (*Ë
	`REALLOC
 (buÂ->buf„r, buÂ->
Æloˇãd
);\

1701 i‡(
buÂ
->
buf„r
 =
NULL
) \

1702  
REG_ESPACE
; \

1704 i‡(
ﬁd_buf„r
 !
buÂ
->
buf„r
) \

1706 
b
 = (b - 
ﬁd_buf„r
Ë+ 
buÂ
->
buf„r
; \

1707 
begÆt
 = (begÆà- 
ﬁd_buf„r
Ë+ 
buÂ
->
buf„r
; \

1708 i‡(
fixup_Æt_jump
) \

1709 
fixup_Æt_jump
 = (fixup_Æt_jum∞- 
ﬁd_buf„r
Ë+ 
buÂ
->
buf„r
;\

1710 i‡(
œ°°¨t
) \

1711 
œ°°¨t
 = (œ°°¨à- 
ﬁd_buf„r
Ë+ 
buÂ
->
buf„r
; \

1712 i‡(
≥ndög_exa˘
) \

1713 
≥ndög_exa˘
 = (≥ndög_exa˘ - 
ﬁd_buf„r
Ë+ 
buÂ
->
buf„r
; \

1715 } 0)

	)

1721 
	#MAX_REGNUM
 255

	)

1725 
	tªgnum_t
;

1733 
	t∑âîn_off£t_t
;

1737 
∑âîn_off£t_t
 
	mbegÆt_off£t
;

1738 
∑âîn_off£t_t
 
	mfixup_Æt_jump
;

1739 
∑âîn_off£t_t
 
	mö√r_group_off£t
;

1740 
∑âîn_off£t_t
 
	mœ°°¨t_off£t
;

1741 
ªgnum_t
 
	mªgnum
;

1742 } 
	tcompûe_°ack_ñt_t
;

1747 
compûe_°ack_ñt_t
 *
	m°ack
;

1748 
	msize
;

1749 
	mavaû
;

1750 } 
	tcompûe_°ack_ty≥
;

1753 
	#INIT_COMPILE_STACK_SIZE
 32

	)

1755 
	#COMPILE_STACK_EMPTY
 (
compûe_°ack
.
avaû
 =0)

	)

1756 
	#COMPILE_STACK_FULL
 (
compûe_°ack
.
avaû
 =compûe_°ack.
size
)

	)

1759 
	#COMPILE_STACK_TOP
 (
compûe_°ack
.
°ack
[compûe_°ack.
avaû
])

	)

1763 
	#SET_LIST_BIT
(
c
) \

1764 (
b
[((Ë(
c
)Ë/ 
BYTEWIDTH
] \

1765 |1 << (((Ë
c
Ë% 
BYTEWIDTH
))

	)

1769 
	#GET_UNSIGNED_NUMBER
(
num
) \

1770 { i‡(
p
 !
≥nd
) \

1772 
	`PATFETCH
 (
c
); \

1773 
	`ISDIGIT
 (
c
)) \

1775 i‡(
num
 < 0) \

1776 
num
 = 0; \

1777 
num
 =Çum * 10 + 
c
 - '0'; \

1778 i‡(
p
 =
≥nd
) \

1780 
	`PATFETCH
 (
c
); \

1783 }

	)

1785 #i‡
deföed
 
_LIBC
 || 
WIDE_CHAR_SUPPORT


1788 #ifde‡
CHARCLASS_NAME_MAX


1789 
	#CHAR_CLASS_MAX_LENGTH
 
CHARCLASS_NAME_MAX


	)

1793 
	#CHAR_CLASS_MAX_LENGTH
 256

	)

1796 #ifde‡
_LIBC


1797 
	#IS_CHAR_CLASS
(
°rög
Ë
	`__w˘y≥
 (°rög)

	)

1799 
	#IS_CHAR_CLASS
(
°rög
Ë
	`w˘y≥
 (°rög)

	)

1802 
	#CHAR_CLASS_MAX_LENGTH
 6

	)

1804 
	#IS_CHAR_CLASS
(
°rög
) \

1805 (
	`STREQ
 (
°rög
, "alpha") || STREQ (string, "upper") \

1806 || 
	`STREQ
 (
°rög
, "lower") || STREQ (string, "digit") \

1807 || 
	`STREQ
 (
°rög
, "alnum") || STREQ (string, "xdigit") \

1808 || 
	`STREQ
 (
°rög
, "space") || STREQ (string, "print") \

1809 || 
	`STREQ
 (
°rög
, "punct") || STREQ (string, "graph") \

1810 || 
	`STREQ
 (
°rög
, "˙ål"Ë|| STREQ (°rög, "bœnk"))

	)

1813 #i‚de‡
MATCH_MAY_ALLOCATE


1822 
Áû_°ack_ty≥
 
	gÁû_°ack
;

1827 
	gªgs_Æloˇãd_size
;

1829 c⁄° ** 
	gªg°¨t
, ** 
	gªgíd
;

1830 c⁄° ** 
	gﬁd_ªg°¨t
, ** 
	gﬁd_ªgíd
;

1831 c⁄° **
	gbe°_ªg°¨t
, **
	gbe°_ªgíd
;

1832 
ªgi°î_öfo_ty≥
 *
	gªg_öfo
;

1833 c⁄° **
	gªg_dummy
;

1834 
ªgi°î_öfo_ty≥
 *
	gªg_öfo_dummy
;

1840 
	$ªgex_grow_ªgi°îs
 (
num_ªgs
)

1841 
num_ªgs
;

1843 i‡(
num_ªgs
 > 
ªgs_Æloˇãd_size
)

1845 
	`RETALLOC_IF
 (
ªg°¨t
, 
num_ªgs
, const *);

1846 
	`RETALLOC_IF
 (
ªgíd
, 
num_ªgs
, const *);

1847 
	`RETALLOC_IF
 (
ﬁd_ªg°¨t
, 
num_ªgs
, const *);

1848 
	`RETALLOC_IF
 (
ﬁd_ªgíd
, 
num_ªgs
, const *);

1849 
	`RETALLOC_IF
 (
be°_ªg°¨t
, 
num_ªgs
, const *);

1850 
	`RETALLOC_IF
 (
be°_ªgíd
, 
num_ªgs
, const *);

1851 
	`RETALLOC_IF
 (
ªg_öfo
, 
num_ªgs
, 
ªgi°î_öfo_ty≥
);

1852 
	`RETALLOC_IF
 (
ªg_dummy
, 
num_ªgs
, const *);

1853 
	`RETALLOC_IF
 (
ªg_öfo_dummy
, 
num_ªgs
, 
ªgi°î_öfo_ty≥
);

1855 
ªgs_Æloˇãd_size
 = 
num_ªgs
;

1857 
	}
}

1861 
boﬁón
 
group_ö_compûe_°ack
 
_RE_ARGS
 ((
compûe_°ack_ty≥


1862 
compûe_°ack
,

1863 
ªgnum_t
 
ªgnum
));

1884 
	#FREE_STACK_RETURN
(
vÆue
) \

1885  (
	`‰ì
 (
compûe_°ack
.
°ack
), 
vÆue
)

	)

1887 
ªg_îrcode_t


1888 
	$ªgex_compûe
 (
∑âîn
, 
size
, 
sy¡ax
, 
buÂ
)

1889 c⁄° *
∑âîn
;

1890 
size_t
 
size
;

1891 
ªg_sy¡ax_t
 
sy¡ax
;

1892 
ª_∑âîn_buf„r
 *
buÂ
;

1897 
c
, 
c1
;

1900 c⁄° *
p1
;

1903 *
b
;

1906 
compûe_°ack_ty≥
 
compûe_°ack
;

1909 c⁄° *
p
 = 
∑âîn
;

1910 c⁄° *
≥nd
 = 
∑âîn
 + 
size
;

1913 
RE_TRANSLATE_TYPE
 
å™¶©e
 = 
buÂ
->translate;

1919 *
≥ndög_exa˘
 = 0;

1924 *
œ°°¨t
 = 0;

1927 *
begÆt
;

1931 c⁄° *
beg_öãrvÆ
;

1936 *
fixup_Æt_jump
 = 0;

1941 
ªgnum_t
 
ªgnum
 = 0;

1943 #ifde‡
DEBUG


1944 
	`DEBUG_PRINT1
 ("\nCompilingÖattern: ");

1945 i‡(
debug
)

1947 
debug_cou¡
;

1949 
debug_cou¡
 = 0; debug_cou¡ < 
size
; debug_count++)

1950 
	`putch¨
 (
∑âîn
[
debug_cou¡
]);

1951 
	`putch¨
 ('\n');

1956 
compûe_°ack
.
°ack
 = 
	`TALLOC
 (
INIT_COMPILE_STACK_SIZE
, 
compûe_°ack_ñt_t
);

1957 i‡(
compûe_°ack
.
°ack
 =
NULL
)

1958  
REG_ESPACE
;

1960 
compûe_°ack
.
size
 = 
INIT_COMPILE_STACK_SIZE
;

1961 
compûe_°ack
.
avaû
 = 0;

1964 
buÂ
->
sy¡ax
 = syntax;

1965 
buÂ
->
Á°m≠_accuøã
 = 0;

1966 
buÂ
->
nŸ_bﬁ
 = buÂ->
nŸ_eﬁ
 = 0;

1971 
buÂ
->
u£d
 = 0;

1974 
buÂ
->
ª_nsub
 = 0;

1976 #i‡!
deföed
 
emacs
 && !deföed 
SYNTAX_TABLE


1978 
	`öô_sy¡ax_⁄˚
 ();

1981 i‡(
buÂ
->
Æloˇãd
 == 0)

1983 i‡(
buÂ
->
buf„r
)

1987 
	`RETALLOC
 (
buÂ
->
buf„r
, 
INIT_BUF_SIZE
, );

1991 
buÂ
->
buf„r
 = 
	`TALLOC
 (
INIT_BUF_SIZE
, );

1993 i‡(!
buÂ
->
buf„r
Ë
	`FREE_STACK_RETURN
 (
REG_ESPACE
);

1995 
buÂ
->
Æloˇãd
 = 
INIT_BUF_SIZE
;

1998 
begÆt
 = 
b
 = 
buÂ
->
buf„r
;

2001 
p
 !
≥nd
)

2003 
	`PATFETCH
 (
c
);

2005 
c
)

2010 
p
 =
∑âîn
 + 1

2012 || 
sy¡ax
 & 
RE_CONTEXT_INDEP_ANCHORS


2014 || 
	`©_beglöe_loc_p
 (
∑âîn
, 
p
, 
sy¡ax
))

2015 
	`BUF_PUSH
 (
beglöe
);

2017 
n‹mÆ_ch¨
;

2025 
p
 =
≥nd


2027 || 
sy¡ax
 & 
RE_CONTEXT_INDEP_ANCHORS


2029 || 
	`©_ídlöe_loc_p
 (
p
, 
≥nd
, 
sy¡ax
))

2030 
	`BUF_PUSH
 (
ídlöe
);

2032 
n‹mÆ_ch¨
;

2039 i‡((
sy¡ax
 & 
RE_BK_PLUS_QM
)

2040 || (
sy¡ax
 & 
RE_LIMITED_OPS
))

2041 
n‹mÆ_ch¨
;

2042 
h™dÀ_∂us
:

2045 i‡(!
œ°°¨t
)

2047 i‡(
sy¡ax
 & 
RE_CONTEXT_INVALID_OPS
)

2048 
	`FREE_STACK_RETURN
 (
REG_BADRPT
);

2049 i‡(!(
sy¡ax
 & 
RE_CONTEXT_INDEP_OPS
))

2050 
n‹mÆ_ch¨
;

2055 
boﬁón
 
kìp_°rög_p
 = 
Ál£
;

2058 
zîo_times_ok
 = 0, 
m™y_times_ok
 = 0;

2067 
zîo_times_ok
 |
c
 != '+';

2068 
m™y_times_ok
 |
c
 != '?';

2070 i‡(
p
 =
≥nd
)

2073 
	`PATFETCH
 (
c
);

2075 i‡(
c
 == '*'

2076 || (!(
sy¡ax
 & 
RE_BK_PLUS_QM
Ë&& (
c
 == '+' || c == '?')))

2079 i‡(
sy¡ax
 & 
RE_BK_PLUS_QM
 && 
c
 == '\\')

2081 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EESCAPE
);

2083 
	`PATFETCH
 (
c1
);

2084 i‡(!(
c1
 == '+' || c1 == '?'))

2086 
PATUNFETCH
;

2087 
PATUNFETCH
;

2091 
c
 = 
c1
;

2095 
PATUNFETCH
;

2104 i‡(!
œ°°¨t
)

2109 i‡(
m™y_times_ok
)

2120 
	`as£π
 (
p
 - 1 > 
∑âîn
);

2123 
	`GET_BUFFER_SPACE
 (3);

2130 i‡(
	`TRANSLATE
 (*(
p
 - 2)) == TRANSLATE ('.')

2131 && 
zîo_times_ok


2132 && 
p
 < 
≥nd
 && 
	`TRANSLATE
 (*p) == TRANSLATE ('\n')

2133 && !(
sy¡ax
 & 
RE_DOT_NEWLINE
))

2135 
	`STORE_JUMP
 (
jump
, 
b
, 
œ°°¨t
);

2136 
kìp_°rög_p
 = 
åue
;

2140 
	`STORE_JUMP
 (
maybe_p›_jump
, 
b
, 
œ°°¨t
 - 3);

2143 
b
 += 3;

2148 
	`GET_BUFFER_SPACE
 (3);

2149 
	`INSERT_JUMP
 (
kìp_°rög_p
 ? 
⁄_Áûuª_kìp_°rög_jump


2150 : 
⁄_Áûuª_jump
,

2151 
œ°°¨t
, 
b
 + 3);

2152 
≥ndög_exa˘
 = 0;

2153 
b
 += 3;

2155 i‡(!
zîo_times_ok
)

2162 
	`GET_BUFFER_SPACE
 (3);

2163 
	`INSERT_JUMP
 (
dummy_Áûuª_jump
, 
œ°°¨t
,Üaststart + 6);

2164 
b
 += 3;

2171 
œ°°¨t
 = 
b
;

2172 
	`BUF_PUSH
 (
™ych¨
);

2178 
boﬁón
 
had_ch¨_˛ass
 = 
Ál£
;

2180 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EBRACK
);

2184 
	`GET_BUFFER_SPACE
 (34);

2186 
œ°°¨t
 = 
b
;

2190 
	`BUF_PUSH
 (*
p
 ='^' ? 
ch¨£t_nŸ
 : 
ch¨£t
);

2191 i‡(*
p
 == '^')

2192 
p
++;

2195 
p1
 = 
p
;

2198 
	`BUF_PUSH
 ((1 << 
BYTEWIDTH
) / BYTEWIDTH);

2201 
	`mem£t
 (
b
, 0, (1 << 
BYTEWIDTH
) / BYTEWIDTH);

2204 i‡((
ª_›code_t
Ë
b
[-2] =
ch¨£t_nŸ


2205 && (
sy¡ax
 & 
RE_HAT_LISTS_NOT_NEWLINE
))

2206 
	`SET_LIST_BIT
 ('\n');

2211 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EBRACK
);

2213 
	`PATFETCH
 (
c
);

2216 i‡((
sy¡ax
 & 
RE_BACKSLASH_ESCAPE_IN_LISTS
Ë&& 
c
 == '\\')

2218 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EESCAPE
);

2220 
	`PATFETCH
 (
c1
);

2221 
	`SET_LIST_BIT
 (
c1
);

2228 i‡(
c
 =']' && 
p
 !
p1
 + 1)

2233 i‡(
had_ch¨_˛ass
 && 
c
 ='-' && *
p
 != ']')

2234 
	`FREE_STACK_RETURN
 (
REG_ERANGE
);

2240 i‡(
c
 == '-'

2241 && !(
p
 - 2 >
∑âîn
 &&Ö[-2] == '[')

2242 && !(
p
 - 3 >
∑âîn
 &&Ö[-3] == '[' &&Ö[-2] == '^')

2243 && *
p
 != ']')

2245 
ªg_îrcode_t
 
ªt


2246 
	`compûe_ønge
 (&
p
, 
≥nd
, 
å™¶©e
, 
sy¡ax
, 
b
);

2247 i‡(
ªt
 !
REG_NOERROR
Ë
	`FREE_STACK_RETURN
 (ret);

2250 i‡(
p
[0] == '-' &&Ö[1] != ']')

2252 
ªg_îrcode_t
 
ªt
;

2255 
	`PATFETCH
 (
c1
);

2257 
ªt
 = 
	`compûe_ønge
 (&
p
, 
≥nd
, 
å™¶©e
, 
sy¡ax
, 
b
);

2258 i‡(
ªt
 !
REG_NOERROR
Ë
	`FREE_STACK_RETURN
 (ret);

2264 i‡(
sy¡ax
 & 
RE_CHAR_CLASSES
 && 
c
 ='[' && *
p
 == ':')

2266 
°r
[
CHAR_CLASS_MAX_LENGTH
 + 1];

2268 
	`PATFETCH
 (
c
);

2269 
c1
 = 0;

2272 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EBRACK
);

2276 
	`PATFETCH
 (
c
);

2277 i‡((
c
 =':' && *
p
 =']'Ë||Ö =
≥nd
)

2279 i‡(
c1
 < 
CHAR_CLASS_MAX_LENGTH
)

2280 
°r
[
c1
++] = 
c
;

2283 
°r
[0] = '\0';

2285 
°r
[
c1
] = '\0';

2290 i‡(
c
 =':' && *
p
 == ']')

2292 #i‡
deföed
 
_LIBC
 || 
WIDE_CHAR_SUPPORT


2293 
boﬁón
 
is_lowî
 = 
	`STREQ
 (
°r
, "lower");

2294 
boﬁón
 
is_uµî
 = 
	`STREQ
 (
°r
, "upper");

2295 
w˘y≥_t
 
wt
;

2296 
ch
;

2298 
wt
 = 
	`IS_CHAR_CLASS
 (
°r
);

2299 i‡(
wt
 == 0)

2300 
	`FREE_STACK_RETURN
 (
REG_ECTYPE
);

2304 
	`PATFETCH
 (
c
);

2306 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EBRACK
);

2308 
ch
 = 0; ch < 1 << 
BYTEWIDTH
; ++ch)

2310 #ifde‡
_LIBC


2311 i‡(
	`__isw˘y≥
 (
	`__btowc
 (
ch
), 
wt
))

2312 
	`SET_LIST_BIT
 (
ch
);

2314 i‡(
	`isw˘y≥
 (
	`btowc
 (
ch
), 
wt
))

2315 
	`SET_LIST_BIT
 (
ch
);

2318 i‡(
å™¶©e
 && (
is_uµî
 || 
is_lowî
)

2319 && (
	`ISUPPER
 (
ch
Ë|| 
	`ISLOWER
 (ch)))

2320 
	`SET_LIST_BIT
 (
ch
);

2323 
had_ch¨_˛ass
 = 
åue
;

2325 
ch
;

2326 
boﬁón
 
is_Ænum
 = 
	`STREQ
 (
°r
, "alnum");

2327 
boﬁón
 
is_Æpha
 = 
	`STREQ
 (
°r
, "alpha");

2328 
boﬁón
 
is_bœnk
 = 
	`STREQ
 (
°r
, "blank");

2329 
boﬁón
 
is_˙ål
 = 
	`STREQ
 (
°r
, "cntrl");

2330 
boﬁón
 
is_digô
 = 
	`STREQ
 (
°r
, "digit");

2331 
boﬁón
 
is_gøph
 = 
	`STREQ
 (
°r
, "graph");

2332 
boﬁón
 
is_lowî
 = 
	`STREQ
 (
°r
, "lower");

2333 
boﬁón
 
is_¥öt
 = 
	`STREQ
 (
°r
, "print");

2334 
boﬁón
 
is_pun˘
 = 
	`STREQ
 (
°r
, "punct");

2335 
boﬁón
 
is_•a˚
 = 
	`STREQ
 (
°r
, "space");

2336 
boﬁón
 
is_uµî
 = 
	`STREQ
 (
°r
, "upper");

2337 
boﬁón
 
is_xdigô
 = 
	`STREQ
 (
°r
, "xdigit");

2339 i‡(!
	`IS_CHAR_CLASS
 (
°r
))

2340 
	`FREE_STACK_RETURN
 (
REG_ECTYPE
);

2344 
	`PATFETCH
 (
c
);

2346 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EBRACK
);

2348 
ch
 = 0; ch < 1 << 
BYTEWIDTH
; ch++)

2352 i‡–(
is_Ænum
 && 
	`ISALNUM
 (
ch
))

2353 || (
is_Æpha
 && 
	`ISALPHA
 (
ch
))

2354 || (
is_bœnk
 && 
	`ISBLANK
 (
ch
))

2355 || (
is_˙ål
 && 
	`ISCNTRL
 (
ch
)))

2356 
	`SET_LIST_BIT
 (
ch
);

2357 i‡–(
is_digô
 && 
	`ISDIGIT
 (
ch
))

2358 || (
is_gøph
 && 
	`ISGRAPH
 (
ch
))

2359 || (
is_lowî
 && 
	`ISLOWER
 (
ch
))

2360 || (
is_¥öt
 && 
	`ISPRINT
 (
ch
)))

2361 
	`SET_LIST_BIT
 (
ch
);

2362 i‡–(
is_pun˘
 && 
	`ISPUNCT
 (
ch
))

2363 || (
is_•a˚
 && 
	`ISSPACE
 (
ch
))

2364 || (
is_uµî
 && 
	`ISUPPER
 (
ch
))

2365 || (
is_xdigô
 && 
	`ISXDIGIT
 (
ch
)))

2366 
	`SET_LIST_BIT
 (
ch
);

2367 i‡–
å™¶©e
 && (
is_uµî
 || 
is_lowî
)

2368 && (
	`ISUPPER
 (
ch
Ë|| 
	`ISLOWER
 (ch)))

2369 
	`SET_LIST_BIT
 (
ch
);

2371 
had_ch¨_˛ass
 = 
åue
;

2376 
c1
++;

2377 
c1
--)

2378 
PATUNFETCH
;

2379 
	`SET_LIST_BIT
 ('[');

2380 
	`SET_LIST_BIT
 (':');

2381 
had_ch¨_˛ass
 = 
Ál£
;

2386 
had_ch¨_˛ass
 = 
Ál£
;

2387 
	`SET_LIST_BIT
 (
c
);

2393 (Ë
b
[-1] > 0 && b[b[-1] - 1] == 0)

2394 
b
[-1]--;

2395 
b
 += b[-1];

2401 i‡(
sy¡ax
 & 
RE_NO_BK_PARENS
)

2402 
h™dÀ_›í
;

2404 
n‹mÆ_ch¨
;

2408 i‡(
sy¡ax
 & 
RE_NO_BK_PARENS
)

2409 
h™dÀ_˛o£
;

2411 
n‹mÆ_ch¨
;

2415 i‡(
sy¡ax
 & 
RE_NEWLINE_ALT
)

2416 
h™dÀ_Æt
;

2418 
n‹mÆ_ch¨
;

2422 i‡(
sy¡ax
 & 
RE_NO_BK_VBAR
)

2423 
h™dÀ_Æt
;

2425 
n‹mÆ_ch¨
;

2429 i‡(
sy¡ax
 & 
RE_INTERVALS
 && sy¡ax & 
RE_NO_BK_BRACES
)

2430 
h™dÀ_öãrvÆ
;

2432 
n‹mÆ_ch¨
;

2436 i‡(
p
 =
≥nd
Ë
	`FREE_STACK_RETURN
 (
REG_EESCAPE
);

2441 
	`PATFETCH_RAW
 (
c
);

2443 
c
)

2446 i‡(
sy¡ax
 & 
RE_NO_BK_PARENS
)

2447 
n‹mÆ_back¶ash
;

2449 
h™dÀ_›í
:

2450 
buÂ
->
ª_nsub
++;

2451 
ªgnum
++;

2453 i‡(
COMPILE_STACK_FULL
)

2455 
	`RETALLOC
 (
compûe_°ack
.
°ack
, compûe_°ack.
size
 << 1,

2456 
compûe_°ack_ñt_t
);

2457 i‡(
compûe_°ack
.
°ack
 =
NULL
Ë 
REG_ESPACE
;

2459 
compûe_°ack
.
size
 <<= 1;

2466 
COMPILE_STACK_TOP
.
begÆt_off£t
 = 
begÆt
 - 
buÂ
->
buf„r
;

2467 
COMPILE_STACK_TOP
.
fixup_Æt_jump


2468 
fixup_Æt_jump
 ? fixup_Æt_jum∞- 
buÂ
->
buf„r
 + 1 : 0;

2469 
COMPILE_STACK_TOP
.
œ°°¨t_off£t
 = 
b
 - 
buÂ
->
buf„r
;

2470 
COMPILE_STACK_TOP
.
ªgnum
 =Ñegnum;

2476 i‡(
ªgnum
 <
MAX_REGNUM
)

2478 
COMPILE_STACK_TOP
.
ö√r_group_off£t
 = 
b
 - 
buÂ
->
buf„r
 + 2;

2479 
	`BUF_PUSH_3
 (
°¨t_mem‹y
, 
ªgnum
, 0);

2482 
compûe_°ack
.
avaû
++;

2484 
fixup_Æt_jump
 = 0;

2485 
œ°°¨t
 = 0;

2486 
begÆt
 = 
b
;

2490 
≥ndög_exa˘
 = 0;

2495 i‡(
sy¡ax
 & 
RE_NO_BK_PARENS
Ë
n‹mÆ_back¶ash
;

2497 i‡(
COMPILE_STACK_EMPTY
)

2499 i‡(
sy¡ax
 & 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

2500 
n‹mÆ_back¶ash
;

2502 
	`FREE_STACK_RETURN
 (
REG_ERPAREN
);

2505 
h™dÀ_˛o£
:

2506 i‡(
fixup_Æt_jump
)

2511 
	`BUF_PUSH
 (
push_dummy_Áûuª
);

2515 
	`STORE_JUMP
 (
jump_∑°_Æt
, 
fixup_Æt_jump
, 
b
 - 1);

2519 i‡(
COMPILE_STACK_EMPTY
)

2521 i‡(
sy¡ax
 & 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

2522 
n‹mÆ_ch¨
;

2524 
	`FREE_STACK_RETURN
 (
REG_ERPAREN
);

2529 
	`as£π
 (
compûe_°ack
.
avaû
 != 0);

2534 
ªgnum_t
 
this_group_ªgnum
;

2536 
compûe_°ack
.
avaû
--;

2537 
begÆt
 = 
buÂ
->
buf„r
 + 
COMPILE_STACK_TOP
.
begÆt_off£t
;

2538 
fixup_Æt_jump


2539 
COMPILE_STACK_TOP
.
fixup_Æt_jump


2540 ? 
buÂ
->
buf„r
 + 
COMPILE_STACK_TOP
.
fixup_Æt_jump
 - 1

2542 
œ°°¨t
 = 
buÂ
->
buf„r
 + 
COMPILE_STACK_TOP
.
œ°°¨t_off£t
;

2543 
this_group_ªgnum
 = 
COMPILE_STACK_TOP
.
ªgnum
;

2547 
≥ndög_exa˘
 = 0;

2551 i‡(
this_group_ªgnum
 <
MAX_REGNUM
)

2553 *
ö√r_group_loc


2554 
buÂ
->
buf„r
 + 
COMPILE_STACK_TOP
.
ö√r_group_off£t
;

2556 *
ö√r_group_loc
 = 
ªgnum
 - 
this_group_ªgnum
;

2557 
	`BUF_PUSH_3
 (
°›_mem‹y
, 
this_group_ªgnum
,

2558 
ªgnum
 - 
this_group_ªgnum
);

2565 i‡(
sy¡ax
 & 
RE_LIMITED_OPS
 || sy¡ax & 
RE_NO_BK_VBAR
)

2566 
n‹mÆ_back¶ash
;

2567 
h™dÀ_Æt
:

2568 i‡(
sy¡ax
 & 
RE_LIMITED_OPS
)

2569 
n‹mÆ_ch¨
;

2573 
	`GET_BUFFER_SPACE
 (3);

2574 
	`INSERT_JUMP
 (
⁄_Áûuª_jump
, 
begÆt
, 
b
 + 6);

2575 
≥ndög_exa˘
 = 0;

2576 
b
 += 3;

2594 i‡(
fixup_Æt_jump
)

2595 
	`STORE_JUMP
 (
jump_∑°_Æt
, 
fixup_Æt_jump
, 
b
);

2600 
fixup_Æt_jump
 = 
b
;

2601 
	`GET_BUFFER_SPACE
 (3);

2602 
b
 += 3;

2604 
œ°°¨t
 = 0;

2605 
begÆt
 = 
b
;

2611 i‡(!(
sy¡ax
 & 
RE_INTERVALS
)

2614 || ((
sy¡ax
 & 
RE_INTERVALS
Ë&& (sy¡ax & 
RE_NO_BK_BRACES
))

2615 || (
p
 - 2 =
∑âîn
 &&Ö =
≥nd
))

2616 
n‹mÆ_back¶ash
;

2618 
h™dÀ_öãrvÆ
:

2623 
lowî_bound
 = -1, 
uµî_bound
 = -1;

2625 
beg_öãrvÆ
 = 
p
 - 1;

2627 i‡(
p
 =
≥nd
)

2629 i‡(
sy¡ax
 & 
RE_NO_BK_BRACES
)

2630 
un„tch_öãrvÆ
;

2632 
	`FREE_STACK_RETURN
 (
REG_EBRACE
);

2635 
	`GET_UNSIGNED_NUMBER
 (
lowî_bound
);

2637 i‡(
c
 == ',')

2639 
	`GET_UNSIGNED_NUMBER
 (
uµî_bound
);

2640 i‡(
uµî_bound
 < 0Ëuµî_bound = 
RE_DUP_MAX
;

2644 
uµî_bound
 = 
lowî_bound
;

2646 i‡(
lowî_bound
 < 0 || 
uµî_bound
 > 
RE_DUP_MAX


2647 || 
lowî_bound
 > 
uµî_bound
)

2649 i‡(
sy¡ax
 & 
RE_NO_BK_BRACES
)

2650 
un„tch_öãrvÆ
;

2652 
	`FREE_STACK_RETURN
 (
REG_BADBR
);

2655 i‡(!(
sy¡ax
 & 
RE_NO_BK_BRACES
))

2657 i‡(
c
 !'\\'Ë
	`FREE_STACK_RETURN
 (
REG_EBRACE
);

2659 
	`PATFETCH
 (
c
);

2662 i‡(
c
 != '}')

2664 i‡(
sy¡ax
 & 
RE_NO_BK_BRACES
)

2665 
un„tch_öãrvÆ
;

2667 
	`FREE_STACK_RETURN
 (
REG_BADBR
);

2673 i‡(!
œ°°¨t
)

2675 i‡(
sy¡ax
 & 
RE_CONTEXT_INVALID_OPS
)

2676 
	`FREE_STACK_RETURN
 (
REG_BADRPT
);

2677 i‡(
sy¡ax
 & 
RE_CONTEXT_INDEP_OPS
)

2678 
œ°°¨t
 = 
b
;

2680 
un„tch_öãrvÆ
;

2686 i‡(
uµî_bound
 == 0)

2688 
	`GET_BUFFER_SPACE
 (3);

2689 
	`INSERT_JUMP
 (
jump
, 
œ°°¨t
, 
b
 + 3);

2690 
b
 += 3;

2705 
nbyãs
 = 10 + (
uµî_bound
 > 1) * 10;

2707 
	`GET_BUFFER_SPACE
 (
nbyãs
);

2714 
	`INSERT_JUMP2
 (
suc˚ed_n
, 
œ°°¨t
,

2715 
b
 + 5 + (
uµî_bound
 > 1) * 5,

2716 
lowî_bound
);

2717 
b
 += 5;

2723 
	`ö£π_›2
 (
£t_numbî_©
, 
œ°°¨t
, 5, 
lowî_bound
, 
b
);

2724 
b
 += 5;

2726 i‡(
uµî_bound
 > 1)

2734 
	`STORE_JUMP2
 (
jump_n
, 
b
, 
œ°°¨t
 + 5,

2735 
uµî_bound
 - 1);

2736 
b
 += 5;

2752 
	`ö£π_›2
 (
£t_numbî_©
, 
œ°°¨t
, 
b
 -Üaststart,

2753 
uµî_bound
 - 1, 
b
);

2754 
b
 += 5;

2757 
≥ndög_exa˘
 = 0;

2758 
beg_öãrvÆ
 = 
NULL
;

2762 
un„tch_öãrvÆ
:

2764 
	`as£π
 (
beg_öãrvÆ
);

2765 
p
 = 
beg_öãrvÆ
;

2766 
beg_öãrvÆ
 = 
NULL
;

2769 
	`PATFETCH
 (
c
);

2771 i‡(!(
sy¡ax
 & 
RE_NO_BK_BRACES
))

2773 i‡(
p
 > 
∑âîn
 &&Ö[-1] == '\\')

2774 
n‹mÆ_back¶ash
;

2776 
n‹mÆ_ch¨
;

2778 #ifde‡
emacs


2782 
	`BUF_PUSH
 (
©_dŸ
);

2786 
œ°°¨t
 = 
b
;

2787 
	`PATFETCH
 (
c
);

2788 
	`BUF_PUSH_2
 (
sy¡ax•ec
, 
sy¡ax_•ec_code
[
c
]);

2792 
œ°°¨t
 = 
b
;

2793 
	`PATFETCH
 (
c
);

2794 
	`BUF_PUSH_2
 (
nŸsy¡ax•ec
, 
sy¡ax_•ec_code
[
c
]);

2800 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2801 
n‹mÆ_ch¨
;

2802 
œ°°¨t
 = 
b
;

2803 
	`BUF_PUSH
 (
w‹dch¨
);

2808 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2809 
n‹mÆ_ch¨
;

2810 
œ°°¨t
 = 
b
;

2811 
	`BUF_PUSH
 (
nŸw‹dch¨
);

2816 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2817 
n‹mÆ_ch¨
;

2818 
	`BUF_PUSH
 (
w‹dbeg
);

2822 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2823 
n‹mÆ_ch¨
;

2824 
	`BUF_PUSH
 (
w‹díd
);

2828 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2829 
n‹mÆ_ch¨
;

2830 
	`BUF_PUSH
 (
w‹dbound
);

2834 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2835 
n‹mÆ_ch¨
;

2836 
	`BUF_PUSH
 (
nŸw‹dbound
);

2840 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2841 
n‹mÆ_ch¨
;

2842 
	`BUF_PUSH
 (
begbuf
);

2846 i‡(
sy¡ax
 & 
RE_NO_GNU_OPS
)

2847 
n‹mÆ_ch¨
;

2848 
	`BUF_PUSH
 (
ídbuf
);

2853 i‡(
sy¡ax
 & 
RE_NO_BK_REFS
)

2854 
n‹mÆ_ch¨
;

2856 
c1
 = 
c
 - '0';

2858 i‡(
c1
 > 
ªgnum
)

2859 
	`FREE_STACK_RETURN
 (
REG_ESUBREG
);

2862 i‡(
	`group_ö_compûe_°ack
 (
compûe_°ack
, (
ªgnum_t
Ë
c1
))

2863 
n‹mÆ_ch¨
;

2865 
œ°°¨t
 = 
b
;

2866 
	`BUF_PUSH_2
 (
du∂iˇã
, 
c1
);

2872 i‡(
sy¡ax
 & 
RE_BK_PLUS_QM
)

2873 
h™dÀ_∂us
;

2875 
n‹mÆ_back¶ash
;

2878 
n‹mÆ_back¶ash
:

2882 
c
 = 
	`TRANSLATE
 (c);

2883 
n‹mÆ_ch¨
;

2890 
n‹mÆ_ch¨
:

2892 i‡(!
≥ndög_exa˘


2895 || 
≥ndög_exa˘
 + *≥ndög_exa˘ + 1 !
b


2898 || *
≥ndög_exa˘
 =(1 << 
BYTEWIDTH
) - 1

2901 || *
p
 == '*' || *p == '^'

2902 || ((
sy¡ax
 & 
RE_BK_PLUS_QM
)

2903 ? *
p
 == '\\' && (p[1] == '+' ||Ö[1] == '?')

2904 : (*
p
 == '+' || *p == '?'))

2905 || ((
sy¡ax
 & 
RE_INTERVALS
)

2906 && ((
sy¡ax
 & 
RE_NO_BK_BRACES
)

2907 ? *
p
 == '{'

2908 : (
p
[0] == '\\' &&Ö[1] == '{'))))

2912 
œ°°¨t
 = 
b
;

2914 
	`BUF_PUSH_2
 (
exa˘n
, 0);

2915 
≥ndög_exa˘
 = 
b
 - 1;

2918 
	`BUF_PUSH
 (
c
);

2919 (*
≥ndög_exa˘
)++;

2927 i‡(
fixup_Æt_jump
)

2928 
	`STORE_JUMP
 (
jump_∑°_Æt
, 
fixup_Æt_jump
, 
b
);

2930 i‡(!
COMPILE_STACK_EMPTY
)

2931 
	`FREE_STACK_RETURN
 (
REG_EPAREN
);

2935 i‡(
sy¡ax
 & 
RE_NO_POSIX_BACKTRACKING
)

2936 
	`BUF_PUSH
 (
suc˚ed
);

2938 
	`‰ì
 (
compûe_°ack
.
°ack
);

2941 
buÂ
->
u£d
 = 
b
 - buÂ->
buf„r
;

2943 #ifde‡
DEBUG


2944 i‡(
debug
)

2946 
	`DEBUG_PRINT1
 ("\nCompiledÖattern: \n");

2947 
	`¥öt_compûed_∑âîn
 (
buÂ
);

2951 #i‚de‡
MATCH_MAY_ALLOCATE


2956 
num_ªgs
 = 
buÂ
->
ª_nsub
 + 1;

2961 i‡(
Áû_°ack
.
size
 < (2 * 
ª_max_Áûuªs
 * 
MAX_FAILURE_ITEMS
))

2963 
Áû_°ack
.
size
 = (2 * 
ª_max_Áûuªs
 * 
MAX_FAILURE_ITEMS
);

2965 #ifde‡
emacs


2966 i‡(! 
Áû_°ack
.
°ack
)

2967 
Áû_°ack
.
°ack


2968 (
Áû_°ack_ñt_t
 *Ë
	`xmÆloc
 (
Áû_°ack
.
size


2969 *  (
Áû_°ack_ñt_t
));

2971 
Áû_°ack
.
°ack


2972 (
Áû_°ack_ñt_t
 *Ë
	`xªÆloc
 (
Áû_°ack
.
°ack
,

2973 (
Áû_°ack
.
size


2974 *  (
Áû_°ack_ñt_t
)));

2976 i‡(! 
Áû_°ack
.
°ack
)

2977 
Áû_°ack
.
°ack


2978 (
Áû_°ack_ñt_t
 *Ë
	`mÆloc
 (
Áû_°ack
.
size


2979 *  (
Áû_°ack_ñt_t
));

2981 
Áû_°ack
.
°ack


2982 (
Áû_°ack_ñt_t
 *Ë
	`ªÆloc
 (
Áû_°ack
.
°ack
,

2983 (
Áû_°ack
.
size


2984 *  (
Áû_°ack_ñt_t
)));

2988 
	`ªgex_grow_ªgi°îs
 (
num_ªgs
);

2992  
REG_NOERROR
;

2993 
	}
}

3000 
	$°‹e_›1
 (
›
, 
loc
, 
¨g
)

3001 
ª_›code_t
 
›
;

3002 *
loc
;

3003 
¨g
;

3005 *
loc
 = (Ë
›
;

3006 
	`STORE_NUMBER
 (
loc
 + 1, 
¨g
);

3007 
	}
}

3013 
	$°‹e_›2
 (
›
, 
loc
, 
¨g1
, 
¨g2
)

3014 
ª_›code_t
 
›
;

3015 *
loc
;

3016 
¨g1
, 
¨g2
;

3018 *
loc
 = (Ë
›
;

3019 
	`STORE_NUMBER
 (
loc
 + 1, 
¨g1
);

3020 
	`STORE_NUMBER
 (
loc
 + 3, 
¨g2
);

3021 
	}
}

3028 
	$ö£π_›1
 (
›
, 
loc
, 
¨g
, 
íd
)

3029 
ª_›code_t
 
›
;

3030 *
loc
;

3031 
¨g
;

3032 *
íd
;

3034 *
p‰om
 = 
íd
;

3035 *
±o
 = 
íd
 + 3;

3037 
p‰om
 !
loc
)

3038 *--
±o
 = *--
p‰om
;

3040 
	`°‹e_›1
 (
›
, 
loc
, 
¨g
);

3041 
	}
}

3047 
	$ö£π_›2
 (
›
, 
loc
, 
¨g1
, 
¨g2
, 
íd
)

3048 
ª_›code_t
 
›
;

3049 *
loc
;

3050 
¨g1
, 
¨g2
;

3051 *
íd
;

3053 *
p‰om
 = 
íd
;

3054 *
±o
 = 
íd
 + 5;

3056 
p‰om
 !
loc
)

3057 *--
±o
 = *--
p‰om
;

3059 
	`°‹e_›2
 (
›
, 
loc
, 
¨g1
, 
¨g2
);

3060 
	}
}

3067 
boﬁón


3068 
	$©_beglöe_loc_p
 (
∑âîn
, 
p
, 
sy¡ax
)

3069 c⁄° *
∑âîn
, *
p
;

3070 
ªg_sy¡ax_t
 
sy¡ax
;

3072 c⁄° *
¥ev
 = 
p
 - 2;

3073 
boﬁón
 
¥ev_¥ev_back¶ash
 = 
¥ev
 > 
∑âîn
 &&Örev[-1] == '\\';

3077 (*
¥ev
 ='(' && (
sy¡ax
 & 
RE_NO_BK_PARENS
 || 
¥ev_¥ev_back¶ash
))

3079 || (*
¥ev
 ='|' && (
sy¡ax
 & 
RE_NO_BK_VBAR
 || 
¥ev_¥ev_back¶ash
));

3080 
	}
}

3086 
boﬁón


3087 
	$©_ídlöe_loc_p
 (
p
, 
≥nd
, 
sy¡ax
)

3088 c⁄° *
p
, *
≥nd
;

3089 
ªg_sy¡ax_t
 
sy¡ax
;

3091 c⁄° *
√xt
 = 
p
;

3092 
boﬁón
 
√xt_back¶ash
 = *
√xt
 == '\\';

3093 c⁄° *
√xt_√xt
 = 
p
 + 1 < 
≥nd
 ?Ö + 1 : 0;

3097 (
sy¡ax
 & 
RE_NO_BK_PARENS
 ? *
√xt
 == ')'

3098 : 
√xt_back¶ash
 && 
√xt_√xt
 && *next_next == ')')

3100 || (
sy¡ax
 & 
RE_NO_BK_VBAR
 ? *
√xt
 == '|'

3101 : 
√xt_back¶ash
 && 
√xt_√xt
 && *next_next == '|');

3102 
	}
}

3108 
boﬁón


3109 
	$group_ö_compûe_°ack
 (
compûe_°ack
, 
ªgnum
)

3110 
compûe_°ack_ty≥
 
compûe_°ack
;

3111 
ªgnum_t
 
ªgnum
;

3113 
this_ñemít
;

3115 
this_ñemít
 = 
compûe_°ack
.
avaû
 - 1;

3116 
this_ñemít
 >= 0;

3117 
this_ñemít
--)

3118 i‡(
compûe_°ack
.
°ack
[
this_ñemít
].
ªgnum
 ==Ñegnum)

3119  
åue
;

3121  
Ál£
;

3122 
	}
}

3136 
ªg_îrcode_t


3137 
	$compûe_ønge
 (
p_±r
, 
≥nd
, 
å™¶©e
, 
sy¡ax
, 
b
)

3138 c⁄° **
p_±r
, *
≥nd
;

3139 
RE_TRANSLATE_TYPE
 
å™¶©e
;

3140 
ªg_sy¡ax_t
 
sy¡ax
;

3141 *
b
;

3143 
this_ch¨
;

3145 c⁄° *
p
 = *
p_±r
;

3146 
ønge_°¨t
, 
ønge_íd
;

3148 i‡(
p
 =
≥nd
)

3149  
REG_ERANGE
;

3159 
ønge_°¨t
 = ((c⁄° *Ë
p
)[-2];

3160 
ønge_íd
 = ((c⁄° *Ë
p
)[0];

3164 (*
p_±r
)++;

3167 i‡(
ønge_°¨t
 > 
ønge_íd
)

3168  
sy¡ax
 & 
RE_NO_EMPTY_RANGES
 ? 
REG_ERANGE
 : 
REG_NOERROR
;

3174 
this_ch¨
 = 
ønge_°¨t
;Åhis_ch¨ <
ønge_íd
;Åhis_char++)

3176 
	`SET_LIST_BIT
 (
	`TRANSLATE
 (
this_ch¨
));

3179  
REG_NOERROR
;

3180 
	}
}

3196 
	$ª_compûe_Á°m≠
 (
buÂ
)

3197 
ª_∑âîn_buf„r
 *
buÂ
;

3199 
j
, 
k
;

3200 #ifde‡
MATCH_MAY_ALLOCATE


3201 
Áû_°ack_ty≥
 
Áû_°ack
;

3203 #i‚de‡
REGEX_MALLOC


3204 *
de°ö©i⁄
;

3207 *
Á°m≠
 = 
buÂ
->fastmap;

3208 *
∑âîn
 = 
buÂ
->
buf„r
;

3209 *
p
 = 
∑âîn
;

3210 *
≥nd
 = 
∑âîn
 + 
buÂ
->
u£d
;

3212 #ifde‡
REL_ALLOC


3215 
Áû_°ack_ñt_t
 *
Áûuª_°ack_±r
;

3222 
boﬁón
 
∑th_ˇn_be_nuŒ
 = 
åue
;

3225 
boﬁón
 
suc˚ed_n_p
 = 
Ál£
;

3227 
	`as£π
 (
Á°m≠
 !
NULL
 && 
p
 != NULL);

3229 
	`INIT_FAIL_STACK
 ();

3230 
	`mem£t
 (
Á°m≠
, 0, 1 << 
BYTEWIDTH
);

3231 
buÂ
->
Á°m≠_accuøã
 = 1;

3232 
buÂ
->
ˇn_be_nuŒ
 = 0;

3236 i‡(
p
 =
≥nd
 || *∞=
suc˚ed
)

3239 i‡(!
	`FAIL_STACK_EMPTY
 ())

3241 
buÂ
->
ˇn_be_nuŒ
 |
∑th_ˇn_be_nuŒ
;

3244 
∑th_ˇn_be_nuŒ
 = 
åue
;

3246 
p
 = 
Áû_°ack
.
°ack
[--Áû_°ack.
avaû
].
poöãr
;

3255 
	`as£π
 (
p
 < 
≥nd
);

3257 
	`SWITCH_ENUM_CAST
 ((
ª_›code_t
Ë*
p
++))

3265 
du∂iˇã
:

3266 
buÂ
->
ˇn_be_nuŒ
 = 1;

3267 
d⁄e
;

3273 
exa˘n
:

3274 
Á°m≠
[
p
[1]] = 1;

3278 
ch¨£t
:

3279 
j
 = *
p
++ * 
BYTEWIDTH
 - 1; j >= 0; j--)

3280 i‡(
p
[
j
 / 
BYTEWIDTH
] & (1 << (j % BYTEWIDTH)))

3281 
Á°m≠
[
j
] = 1;

3285 
ch¨£t_nŸ
:

3287 
j
 = *
p
 * 
BYTEWIDTH
; j < (1 << BYTEWIDTH); j++)

3288 
Á°m≠
[
j
] = 1;

3290 
j
 = *
p
++ * 
BYTEWIDTH
 - 1; j >= 0; j--)

3291 i‡(!(
p
[
j
 / 
BYTEWIDTH
] & (1 << (j % BYTEWIDTH))))

3292 
Á°m≠
[
j
] = 1;

3296 
w‹dch¨
:

3297 
j
 = 0; j < (1 << 
BYTEWIDTH
); j++)

3298 i‡(
	`SYNTAX
 (
j
Ë=
Sw‹d
)

3299 
Á°m≠
[
j
] = 1;

3303 
nŸw‹dch¨
:

3304 
j
 = 0; j < (1 << 
BYTEWIDTH
); j++)

3305 i‡(
	`SYNTAX
 (
j
Ë!
Sw‹d
)

3306 
Á°m≠
[
j
] = 1;

3310 
™ych¨
:

3312 
Á°m≠_√wlöe
 = 
Á°m≠
['\n'];

3315 
j
 = 0; j < (1 << 
BYTEWIDTH
); j++)

3316 
Á°m≠
[
j
] = 1;

3319 i‡(!(
buÂ
->
sy¡ax
 & 
RE_DOT_NEWLINE
))

3320 
Á°m≠
['\n'] = 
Á°m≠_√wlöe
;

3324 i‡(
buÂ
->
ˇn_be_nuŒ
)

3325 
d⁄e
;

3331 #ifde‡
emacs


3332 
sy¡ax•ec
:

3333 
k
 = *
p
++;

3334 
j
 = 0; j < (1 << 
BYTEWIDTH
); j++)

3335 i‡(
	`SYNTAX
 (
j
Ë=(
sy¡axcode
Ë
k
)

3336 
Á°m≠
[
j
] = 1;

3340 
nŸsy¡ax•ec
:

3341 
k
 = *
p
++;

3342 
j
 = 0; j < (1 << 
BYTEWIDTH
); j++)

3343 i‡(
	`SYNTAX
 (
j
Ë!(
sy¡axcode
Ë
k
)

3344 
Á°m≠
[
j
] = 1;

3352 
bef‹e_dŸ
:

3353 
©_dŸ
:

3354 
a·î_dŸ
:

3359 
no_›
:

3360 
beglöe
:

3361 
ídlöe
:

3362 
begbuf
:

3363 
ídbuf
:

3364 
w‹dbound
:

3365 
nŸw‹dbound
:

3366 
w‹dbeg
:

3367 
w‹díd
:

3368 
push_dummy_Áûuª
:

3372 
jump_n
:

3373 
p›_Áûuª_jump
:

3374 
maybe_p›_jump
:

3375 
jump
:

3376 
jump_∑°_Æt
:

3377 
dummy_Áûuª_jump
:

3378 
	`EXTRACT_NUMBER_AND_INCR
 (
j
, 
p
);

3379 
p
 +
j
;

3380 i‡(
j
 > 0)

3388 i‡((
ª_›code_t
Ë*
p
 !
⁄_Áûuª_jump


3389 && (
ª_›code_t
Ë*
p
 !
suc˚ed_n
)

3392 
p
++;

3393 
	`EXTRACT_NUMBER_AND_INCR
 (
j
, 
p
);

3394 
p
 +
j
;

3397 i‡(!
	`FAIL_STACK_EMPTY
 ()

3398 && 
Áû_°ack
.
°ack
[Áû_°ack.
avaû
 - 1].
poöãr
 =
p
)

3399 
Áû_°ack
.
avaû
--;

3404 
⁄_Áûuª_jump
:

3405 
⁄_Áûuª_kìp_°rög_jump
:

3406 
h™dÀ_⁄_Áûuª_jump
:

3407 
	`EXTRACT_NUMBER_AND_INCR
 (
j
, 
p
);

3416 i‡(
p
 + 
j
 < 
≥nd
)

3418 i‡(!
	`PUSH_PATTERN_OP
 (
p
 + 
j
, 
Áû_°ack
))

3420 
	`RESET_FAIL_STACK
 ();

3425 
buÂ
->
ˇn_be_nuŒ
 = 1;

3427 i‡(
suc˚ed_n_p
)

3429 
	`EXTRACT_NUMBER_AND_INCR
 (
k
, 
p
);

3430 
suc˚ed_n_p
 = 
Ál£
;

3436 
suc˚ed_n
:

3438 
p
 += 2;

3441 
	`EXTRACT_NUMBER_AND_INCR
 (
k
, 
p
);

3442 i‡(
k
 == 0)

3444 
p
 -= 4;

3445 
suc˚ed_n_p
 = 
åue
;

3446 
h™dÀ_⁄_Áûuª_jump
;

3451 
£t_numbî_©
:

3452 
p
 += 4;

3456 
°¨t_mem‹y
:

3457 
°›_mem‹y
:

3458 
p
 += 2;

3463 
	`ab‹t
 ();

3472 
∑th_ˇn_be_nuŒ
 = 
Ál£
;

3473 
p
 = 
≥nd
;

3478 
buÂ
->
ˇn_be_nuŒ
 |
∑th_ˇn_be_nuŒ
;

3480 
d⁄e
:

3481 
	`RESET_FAIL_STACK
 ();

3483 
	}
}

3484 #ifde‡
_LIBC


3485 
	$wók_Æüs
 (
__ª_compûe_Á°m≠
, 
ª_compûe_Á°m≠
)

3502 
	$ª_£t_ªgi°îs
 (
buÂ
, 
ªgs
, 
num_ªgs
, 
°¨ts
, 
íds
)

3503 
ª_∑âîn_buf„r
 *
buÂ
;

3504 
ª_ªgi°îs
 *
ªgs
;

3505 
num_ªgs
;

3506 
ªgoff_t
 *
°¨ts
, *
íds
;

3508 i‡(
num_ªgs
)

3510 
buÂ
->
ªgs_Æloˇãd
 = 
REGS_REALLOCATE
;

3511 
ªgs
->
num_ªgs
 =Çum_regs;

3512 
ªgs
->
°¨t
 = 
°¨ts
;

3513 
ªgs
->
íd
 = 
íds
;

3517 
buÂ
->
ªgs_Æloˇãd
 = 
REGS_UNALLOCATED
;

3518 
ªgs
->
num_ªgs
 = 0;

3519 
ªgs
->
°¨t
 =Ñegs->
íd
 = (
ªgoff_t
 *) 0;

3521 
	}
}

3522 #ifde‡
_LIBC


3523 
	$wók_Æüs
 (
__ª_£t_ªgi°îs
, 
ª_£t_ªgi°îs
)

3532 
	$ª_£¨ch
 (
buÂ
, 
°rög
, 
size
, 
°¨ços
, 
ønge
, 
ªgs
)

3533 
ª_∑âîn_buf„r
 *
buÂ
;

3534 c⁄° *
°rög
;

3535 
size
, 
°¨ços
, 
ønge
;

3536 
ª_ªgi°îs
 *
ªgs
;

3538  
	`ª_£¨ch_2
 (
buÂ
, 
NULL
, 0, 
°rög
, 
size
, 
°¨ços
, 
ønge
,

3539 
ªgs
, 
size
);

3540 
	}
}

3541 #ifde‡
_LIBC


3542 
	$wók_Æüs
 (
__ª_£¨ch
, 
ª_£¨ch
)

3568 
	$ª_£¨ch_2
 (
buÂ
, 
°rög1
, 
size1
, 
°rög2
, 
size2
, 
°¨ços
, 
ønge
, 
ªgs
, 
°›
)

3569 
ª_∑âîn_buf„r
 *
buÂ
;

3570 c⁄° *
°rög1
, *
°rög2
;

3571 
size1
, 
size2
;

3572 
°¨ços
;

3573 
ønge
;

3574 
ª_ªgi°îs
 *
ªgs
;

3575 
°›
;

3577 
vÆ
;

3578 *
Á°m≠
 = 
buÂ
->fastmap;

3579 
RE_TRANSLATE_TYPE
 
å™¶©e
 = 
buÂ
->translate;

3580 
tŸÆ_size
 = 
size1
 + 
size2
;

3581 
ídpos
 = 
°¨ços
 + 
ønge
;

3584 i‡(
°¨ços
 < 0 || sèπpo†> 
tŸÆ_size
)

3590 i‡(
ídpos
 < 0)

3591 
ønge
 = 0 - 
°¨ços
;

3592 i‡(
ídpos
 > 
tŸÆ_size
)

3593 
ønge
 = 
tŸÆ_size
 - 
°¨ços
;

3597 i‡(
buÂ
->
u£d
 > 0 && 
ønge
 > 0

3598 && ((
ª_›code_t
Ë
buÂ
->
buf„r
[0] =
begbuf


3600 || ((
ª_›code_t
Ë
buÂ
->
buf„r
[0] =
beglöe


3601 && !
buÂ
->
√wlöe_™ch‹
)))

3603 i‡(
°¨ços
 > 0)

3606 
ønge
 = 1;

3609 #ifde‡
emacs


3612 i‡(
buÂ
->
u£d
 > 0 && (
ª_›code_t
ËbuÂ->
buf„r
[0] =
©_dŸ
 && 
ønge
 > 0)

3614 
ønge
 = 
PT
 - 
°¨ços
;

3615 i‡(
ønge
 <= 0)

3621 i‡(
Á°m≠
 && !
buÂ
->
Á°m≠_accuøã
)

3622 i‡(
	`ª_compûe_Á°m≠
 (
buÂ
) == -2)

3632 i‡(
Á°m≠
 && 
°¨ços
 < 
tŸÆ_size
 && !
buÂ
->
ˇn_be_nuŒ
)

3634 i‡(
ønge
 > 0)

3636 c⁄° *
d
;

3637 
lim
 = 0;

3638 
ú™ge
 = 
ønge
;

3640 i‡(
°¨ços
 < 
size1
 && sèπpo†+ 
ønge
 >= size1)

3641 
lim
 = 
ønge
 - (
size1
 - 
°¨ços
);

3643 
d
 = (
°¨ços
 >
size1
 ? 
°rög2
 - size1 : 
°rög1
) + startpos;

3647 i‡(
å™¶©e
)

3648 
ønge
 > 
lim


3649 && !
Á°m≠
[()

3650 
å™¶©e
[(Ë*
d
++]])

3651 
ønge
--;

3653 
ønge
 > 
lim
 && !
Á°m≠
[(Ë*
d
++])

3654 
ønge
--;

3656 
°¨ços
 +
ú™ge
 - 
ønge
;

3660 
c
 = (
size1
 =0 || 
°¨ços
 >= size1

3661 ? 
°rög2
[
°¨ços
 - 
size1
]

3662 : 
°rög1
[
°¨ços
]);

3664 i‡(!
Á°m≠
[(Ë
	`TRANSLATE
 (
c
)])

3665 
adv™˚
;

3670 i‡(
ønge
 >0 && 
°¨ços
 =
tŸÆ_size
 && 
Á°m≠


3671 && !
buÂ
->
ˇn_be_nuŒ
)

3674 
vÆ
 = 
	`ª_m©ch_2_öã∫Æ
 (
buÂ
, 
°rög1
, 
size1
, 
°rög2
, 
size2
,

3675 
°¨ços
, 
ªgs
, 
°›
);

3676 #i‚de‡
REGEX_MALLOC


3677 #ifde‡
C_ALLOCA


3678 
	`Æloˇ
 (0);

3682 i‡(
vÆ
 >= 0)

3683  
°¨ços
;

3685 i‡(
vÆ
 == -2)

3688 
adv™˚
:

3689 i‡(!
ønge
)

3691 i‡(
ønge
 > 0)

3693 
ønge
--;

3694 
°¨ços
++;

3698 
ønge
++;

3699 
°¨ços
--;

3703 
	}
}

3704 #ifde‡
_LIBC


3705 
	$wók_Æüs
 (
__ª_£¨ch_2
, 
ª_£¨ch_2
)

3710 
	#POINTER_TO_OFFSET
(
±r
) \

3711 (
	`FIRST_STRING_P
 (
±r
) \

3712 ? ((
ªgoff_t
Ë((
±r
Ë- 
°rög1
)) \

3713 : ((
ªgoff_t
Ë((
±r
Ë- 
°rög2
 + 
size1
)))

	)

3717 
	#MATCHING_IN_FIRST_STRING
 (
díd
 =
íd_m©ch_1
)

	)

3721 
	#PREFETCH
() \

3722 
d
 =
díd
) \

3725 i‡(
díd
 =
íd_m©ch_2
) \

3726 
Áû
; \

3728 
d
 = 
°rög2
; \

3729 
díd
 = 
íd_m©ch_2
; \

3730 
	}

	)
}

3735 
	#AT_STRINGS_BEG
(
d
Ë((dË=(
size1
 ? 
°rög1
 : 
°rög2
Ë|| !
size2
)

	)

3736 
	#AT_STRINGS_END
(
d
Ë((dË=
íd2
)

	)

3743 
	#WORDCHAR_P
(
d
) \

3744 (
	`SYNTAX
 ((
d
Ë=
íd1
 ? *
°rög2
 \

3745 : (
d
Ë=
°rög2
 - 1 ? *(
íd1
 - 1) : *(d)) \

3746 =
Sw‹d
)

	)

3752 
	#AT_WORD_BOUNDARY
(
d
) \

3753 (
	`AT_STRINGS_BEG
 (
d
Ë|| 
	`AT_STRINGS_END
 (d) \

3754 || 
	`WORDCHAR_P
 (
d
 - 1Ë!WORDCHAR_P (d))

	)

3758 #ifde‡
MATCH_MAY_ALLOCATE


3759 
	#FREE_VAR
(
v¨
Ëi‡(v¨Ë
	`REGEX_FREE
 (v¨); v¨ = 
NULL


	)

3760 
	#FREE_VARIABLES
() \

3762 
	`REGEX_FREE_STACK
 (
Áû_°ack
.
°ack
); \

3763 
	`FREE_VAR
 (
ªg°¨t
); \

3764 
	`FREE_VAR
 (
ªgíd
); \

3765 
	`FREE_VAR
 (
ﬁd_ªg°¨t
); \

3766 
	`FREE_VAR
 (
ﬁd_ªgíd
); \

3767 
	`FREE_VAR
 (
be°_ªg°¨t
); \

3768 
	`FREE_VAR
 (
be°_ªgíd
); \

3769 
	`FREE_VAR
 (
ªg_öfo
); \

3770 
	`FREE_VAR
 (
ªg_dummy
); \

3771 
	`FREE_VAR
 (
ªg_öfo_dummy
); \

3772 } 0)

	)

3774 
	#FREE_VARIABLES
(Ë(()0Ë

	)

3784 
	#NO_HIGHEST_ACTIVE_REG
 (1 << 
BYTEWIDTH
)

	)

3785 
	#NO_LOWEST_ACTIVE_REG
 (
NO_HIGHEST_ACTIVE_REG
 + 1)

	)

3789 #i‚de‡
emacs


3793 
	$ª_m©ch
 (
buÂ
, 
°rög
, 
size
, 
pos
, 
ªgs
)

3794 
ª_∑âîn_buf„r
 *
buÂ
;

3795 c⁄° *
°rög
;

3796 
size
, 
pos
;

3797 
ª_ªgi°îs
 *
ªgs
;

3799 
ªsu…
 = 
	`ª_m©ch_2_öã∫Æ
 (
buÂ
, 
NULL
, 0, 
°rög
, 
size
,

3800 
pos
, 
ªgs
, 
size
);

3801 #i‚de‡
REGEX_MALLOC


3802 #ifde‡
C_ALLOCA


3803 
	`Æloˇ
 (0);

3806  
ªsu…
;

3807 
	}
}

3808 #ifde‡
_LIBC


3809 
	$wók_Æüs
 (
__ª_m©ch
, 
ª_m©ch
)

3813 
boﬁón
 
group_m©ch_nuŒ_°rög_p
 
	`_RE_ARGS
 ((**
p
,

3814 *
íd
,

3815 
ªgi°î_öfo_ty≥
 *
ªg_öfo
));

3816 
boﬁón
 
Æt_m©ch_nuŒ_°rög_p
 
	`_RE_ARGS
 ((*
p
,

3817 *
íd
,

3818 
ªgi°î_öfo_ty≥
 *
ªg_öfo
));

3819 
boﬁón
 
comm⁄_›_m©ch_nuŒ_°rög_p
 
	`_RE_ARGS
 ((**
p
,

3820 *
íd
,

3821 
ªgi°î_öfo_ty≥
 *
ªg_öfo
));

3822 
bcmp_å™¶©e
 
	`_RE_ARGS
 ((c⁄° *
s1
, c⁄° *
s2
,

3823 
Àn
, *
å™¶©e
));

3839 
	$ª_m©ch_2
 (
buÂ
, 
°rög1
, 
size1
, 
°rög2
, 
size2
, 
pos
, 
ªgs
, 
°›
)

3840 
ª_∑âîn_buf„r
 *
buÂ
;

3841 c⁄° *
°rög1
, *
°rög2
;

3842 
size1
, 
size2
;

3843 
pos
;

3844 
ª_ªgi°îs
 *
ªgs
;

3845 
°›
;

3847 
ªsu…
 = 
	`ª_m©ch_2_öã∫Æ
 (
buÂ
, 
°rög1
, 
size1
, 
°rög2
, 
size2
,

3848 
pos
, 
ªgs
, 
°›
);

3849 #i‚de‡
REGEX_MALLOC


3850 #ifde‡
C_ALLOCA


3851 
	`Æloˇ
 (0);

3854  
ªsu…
;

3855 
	}
}

3856 #ifde‡
_LIBC


3857 
	$wók_Æüs
 (
__ª_m©ch_2
, 
ª_m©ch_2
)

3863 
	$ª_m©ch_2_öã∫Æ
 (
buÂ
, 
°rög1
, 
size1
, 
°rög2
, 
size2
, 
pos
, 
ªgs
, 
°›
)

3864 
ª_∑âîn_buf„r
 *
buÂ
;

3865 c⁄° *
°rög1
, *
°rög2
;

3866 
size1
, 
size2
;

3867 
pos
;

3868 
ª_ªgi°îs
 *
ªgs
;

3869 
°›
;

3872 
m˙t
;

3873 *
p1
;

3876 c⁄° *
íd1
, *
íd2
;

3880 c⁄° *
íd_m©ch_1
, *
íd_m©ch_2
;

3883 c⁄° *
d
, *
díd
;

3886 *
p
 = 
buÂ
->
buf„r
;

3887 *
≥nd
 = 
p
 + 
buÂ
->
u£d
;

3891 *
ju°_∑°_°¨t_mem
 = 0;

3894 
RE_TRANSLATE_TYPE
 
å™¶©e
 = 
buÂ
->translate;

3905 #ifde‡
MATCH_MAY_ALLOCATE


3906 
Áû_°ack_ty≥
 
Áû_°ack
;

3908 #ifde‡
DEBUG


3909 
Áûuª_id
;

3910 
nÁûuª_poöts_pushed
 = 0, 
nÁûuª_poöts_p›≥d
 = 0;

3913 #ifde‡
REL_ALLOC


3916 
Áû_°ack_ñt_t
 *
Áûuª_°ack_±r
;

3922 
size_t
 
num_ªgs
 = 
buÂ
->
ª_nsub
 + 1;

3925 
a˘ive_ªg_t
 
lowe°_a˘ive_ªg
 = 
NO_LOWEST_ACTIVE_REG
;

3926 
a˘ive_ªg_t
 
highe°_a˘ive_ªg
 = 
NO_HIGHEST_ACTIVE_REG
;

3935 #ifde‡
MATCH_MAY_ALLOCATE


3936 c⁄° **
ªg°¨t
, **
ªgíd
;

3944 #ifde‡
MATCH_MAY_ALLOCATE


3945 c⁄° **
ﬁd_ªg°¨t
, **
ﬁd_ªgíd
;

3954 #ifde‡
MATCH_MAY_ALLOCATE


3955 
ªgi°î_öfo_ty≥
 *
ªg_öfo
;

3962 
be°_ªgs_£t
 = 
Ál£
;

3963 #ifde‡
MATCH_MAY_ALLOCATE


3964 c⁄° **
be°_ªg°¨t
, **
be°_ªgíd
;

3975 c⁄° *
m©ch_íd
 = 
NULL
;

3978 
£t_ªgs_m©ched_d⁄e
 = 0;

3981 #ifde‡
MATCH_MAY_ALLOCATE


3982 c⁄° **
ªg_dummy
;

3983 
ªgi°î_öfo_ty≥
 *
ªg_öfo_dummy
;

3986 #ifde‡
DEBUG


3988 
num_ªgs_pushed
 = 0;

3991 
	`DEBUG_PRINT1
 ("\n\nEnteringÑe_match_2.\n");

3993 
	`INIT_FAIL_STACK
 ();

3995 #ifde‡
MATCH_MAY_ALLOCATE


4001 i‡(
buÂ
->
ª_nsub
)

4003 
ªg°¨t
 = 
	`REGEX_TALLOC
 (
num_ªgs
, const *);

4004 
ªgíd
 = 
	`REGEX_TALLOC
 (
num_ªgs
, const *);

4005 
ﬁd_ªg°¨t
 = 
	`REGEX_TALLOC
 (
num_ªgs
, const *);

4006 
ﬁd_ªgíd
 = 
	`REGEX_TALLOC
 (
num_ªgs
, const *);

4007 
be°_ªg°¨t
 = 
	`REGEX_TALLOC
 (
num_ªgs
, const *);

4008 
be°_ªgíd
 = 
	`REGEX_TALLOC
 (
num_ªgs
, const *);

4009 
ªg_öfo
 = 
	`REGEX_TALLOC
 (
num_ªgs
, 
ªgi°î_öfo_ty≥
);

4010 
ªg_dummy
 = 
	`REGEX_TALLOC
 (
num_ªgs
, const *);

4011 
ªg_öfo_dummy
 = 
	`REGEX_TALLOC
 (
num_ªgs
, 
ªgi°î_öfo_ty≥
);

4013 i‡(!(
ªg°¨t
 && 
ªgíd
 && 
ﬁd_ªg°¨t
 && 
ﬁd_ªgíd
 && 
ªg_öfo


4014 && 
be°_ªg°¨t
 && 
be°_ªgíd
 && 
ªg_dummy
 && 
ªg_öfo_dummy
))

4016 
	`FREE_VARIABLES
 ();

4024 
ªg°¨t
 = 
ªgíd
 = 
ﬁd_ªg°¨t
 = 
ﬁd_ªgíd
 = 
be°_ªg°¨t


4025 
be°_ªgíd
 = 
ªg_dummy
 = 
NULL
;

4026 
ªg_öfo
 = 
ªg_öfo_dummy
 = (
ªgi°î_öfo_ty≥
 *Ë
NULL
;

4031 i‡(
pos
 < 0 ||Öo†> 
size1
 + 
size2
)

4033 
	`FREE_VARIABLES
 ();

4040 
m˙t
 = 1; (Ëm˙à< 
num_ªgs
; mcnt++)

4042 
ªg°¨t
[
m˙t
] = 
ªgíd
[mcnt]

4043 
ﬁd_ªg°¨t
[
m˙t
] = 
ﬁd_ªgíd
[m˙t] = 
REG_UNSET_VALUE
;

4045 
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[
m˙t
]Ë
MATCH_NULL_UNSET_VALUE
;

4046 
	`IS_ACTIVE
 (
ªg_öfo
[
m˙t
]) = 0;

4047 
	`MATCHED_SOMETHING
 (
ªg_öfo
[
m˙t
]) = 0;

4048 
	`EVER_MATCHED_SOMETHING
 (
ªg_öfo
[
m˙t
]) = 0;

4053 i‡(
size2
 =0 && 
°rög1
 !
NULL
)

4055 
°rög2
 = 
°rög1
;

4056 
size2
 = 
size1
;

4057 
°rög1
 = 0;

4058 
size1
 = 0;

4060 
íd1
 = 
°rög1
 + 
size1
;

4061 
íd2
 = 
°rög2
 + 
size2
;

4064 i‡(
°›
 <
size1
)

4066 
íd_m©ch_1
 = 
°rög1
 + 
°›
;

4067 
íd_m©ch_2
 = 
°rög2
;

4071 
íd_m©ch_1
 = 
íd1
;

4072 
íd_m©ch_2
 = 
°rög2
 + 
°›
 - 
size1
;

4081 i‡(
size1
 > 0 && 
pos
 <= size1)

4083 
d
 = 
°rög1
 + 
pos
;

4084 
díd
 = 
íd_m©ch_1
;

4088 
d
 = 
°rög2
 + 
pos
 - 
size1
;

4089 
díd
 = 
íd_m©ch_2
;

4092 
	`DEBUG_PRINT1
 ("The compiledÖattern is:\n");

4093 
	`DEBUG_PRINT_COMPILED_PATTERN
 (
buÂ
, 
p
, 
≥nd
);

4094 
	`DEBUG_PRINT1
 ("The stringÅo match is: `");

4095 
	`DEBUG_PRINT_DOUBLE_STRING
 (
d
, 
°rög1
, 
size1
, 
°rög2
, 
size2
);

4096 
	`DEBUG_PRINT1
 ("'\n");

4103 #ifde‡
_LIBC


4104 
	`DEBUG_PRINT2
 ("\n%p: ", 
p
);

4106 
	`DEBUG_PRINT2
 ("\n0x%x: ", 
p
);

4109 i‡(
p
 =
≥nd
)

4111 
	`DEBUG_PRINT1
 ("end ofÖattern ... ");

4115 i‡(
d
 !
íd_m©ch_2
)

4119 
boﬁón
 
ßme_°r_p
 = (
	`FIRST_STRING_P
 (
m©ch_íd
)

4120 =
MATCHING_IN_FIRST_STRING
);

4122 
boﬁón
 
be°_m©ch_p
;

4126 i‡(
ßme_°r_p
)

4127 
be°_m©ch_p
 = 
d
 > 
m©ch_íd
;

4129 
be°_m©ch_p
 = !
MATCHING_IN_FIRST_STRING
;

4131 
	`DEBUG_PRINT1
 ("backtracking.\n");

4133 i‡(!
	`FAIL_STACK_EMPTY
 ())

4137 i‡(!
be°_ªgs_£t
 || 
be°_m©ch_p
)

4139 
be°_ªgs_£t
 = 
åue
;

4140 
m©ch_íd
 = 
d
;

4142 
	`DEBUG_PRINT1
 ("\nSAVING matchás best so far.\n");

4144 
m˙t
 = 1; (Ëm˙à< 
num_ªgs
; mcnt++)

4146 
be°_ªg°¨t
[
m˙t
] = 
ªg°¨t
[mcnt];

4147 
be°_ªgíd
[
m˙t
] = 
ªgíd
[mcnt];

4150 
Áû
;

4156 i‡(
be°_ªgs_£t
 && !
be°_m©ch_p
)

4158 
ª°‹e_be°_ªgs
:

4164 
	`DEBUG_PRINT1
 ("Restoring bestÑegisters.\n");

4166 
d
 = 
m©ch_íd
;

4167 
díd
 = ((
d
 >
°rög1
 && d <
íd1
)

4168 ? 
íd_m©ch_1
 : 
íd_m©ch_2
);

4170 
m˙t
 = 1; (Ëm˙à< 
num_ªgs
; mcnt++)

4172 
ªg°¨t
[
m˙t
] = 
be°_ªg°¨t
[mcnt];

4173 
ªgíd
[
m˙t
] = 
be°_ªgíd
[mcnt];

4178 
suc˚ed_œbñ
:

4179 
	`DEBUG_PRINT1
 ("Accepting match.\n");

4182 i‡(
ªgs
 && !
buÂ
->
no_sub
)

4185 i‡(
buÂ
->
ªgs_Æloˇãd
 =
REGS_UNALLOCATED
)

4189 
ªgs
->
num_ªgs
 = 
	`MAX
 (
RE_NREGS
,Çum_regs + 1);

4190 
ªgs
->
°¨t
 = 
	`TALLOC
 (ªgs->
num_ªgs
, 
ªgoff_t
);

4191 
ªgs
->
íd
 = 
	`TALLOC
 (ªgs->
num_ªgs
, 
ªgoff_t
);

4192 i‡(
ªgs
->
°¨t
 =
NULL
 ||Ñegs->
íd
 == NULL)

4194 
	`FREE_VARIABLES
 ();

4197 
buÂ
->
ªgs_Æloˇãd
 = 
REGS_REALLOCATE
;

4199 i‡(
buÂ
->
ªgs_Æloˇãd
 =
REGS_REALLOCATE
)

4203 i‡(
ªgs
->
num_ªgs
 <Çum_regs + 1)

4205 
ªgs
->
num_ªgs
 =Çum_regs + 1;

4206 
	`RETALLOC
 (
ªgs
->
°¨t
,Ñegs->
num_ªgs
, 
ªgoff_t
);

4207 
	`RETALLOC
 (
ªgs
->
íd
,Ñegs->
num_ªgs
, 
ªgoff_t
);

4208 i‡(
ªgs
->
°¨t
 =
NULL
 ||Ñegs->
íd
 == NULL)

4210 
	`FREE_VARIABLES
 ();

4219 
	`as£π
 (
buÂ
->
ªgs_Æloˇãd
 =
REGS_FIXED
);

4225 i‡(
ªgs
->
num_ªgs
 > 0)

4227 
ªgs
->
°¨t
[0] = 
pos
;

4228 
ªgs
->
íd
[0] = (
MATCHING_IN_FIRST_STRING


4229 ? ((
ªgoff_t
Ë(
d
 - 
°rög1
))

4230 : ((
ªgoff_t
Ë(
d
 - 
°rög2
 + 
size1
)));

4235 
m˙t
 = 1; (Ëm˙à< 
	`MIN
 (
num_ªgs
, 
ªgs
->num_regs);

4236 
m˙t
++)

4238 i‡(
	`REG_UNSET
 (
ªg°¨t
[
m˙t
]Ë|| REG_UNSET (
ªgíd
[mcnt]))

4239 
ªgs
->
°¨t
[
m˙t
] =Ñegs->
íd
[mcnt] = -1;

4242 
ªgs
->
°¨t
[
m˙t
]

4243 (
ªgoff_t
Ë
	`POINTER_TO_OFFSET
 (
ªg°¨t
[
m˙t
]);

4244 
ªgs
->
íd
[
m˙t
]

4245 (
ªgoff_t
Ë
	`POINTER_TO_OFFSET
 (
ªgíd
[
m˙t
]);

4254 
m˙t
 = 
num_ªgs
; (Ëm˙à< 
ªgs
->num_regs; mcnt++)

4255 
ªgs
->
°¨t
[
m˙t
] =Ñegs->
íd
[mcnt] = -1;

4258 
	`DEBUG_PRINT4
 ("%u failureÖointsÖushed, %uÖopped (%uÑemain).\n",

4259 
nÁûuª_poöts_pushed
, 
nÁûuª_poöts_p›≥d
,

4260 
nÁûuª_poöts_pushed
 - 
nÁûuª_poöts_p›≥d
);

4261 
	`DEBUG_PRINT2
 ("%uÑegi°î†pushed.\n", 
num_ªgs_pushed
);

4263 
m˙t
 = 
d
 - 
pos
 - (
MATCHING_IN_FIRST_STRING


4264 ? 
°rög1


4265 : 
°rög2
 - 
size1
);

4267 
	`DEBUG_PRINT2
 ("Rëu∫ög %d fromÑe_m©ch_2.\n", 
m˙t
);

4269 
	`FREE_VARIABLES
 ();

4270  
m˙t
;

4274 
	`SWITCH_ENUM_CAST
 ((
ª_›code_t
Ë*
p
++))

4278 
no_›
:

4279 
	`DEBUG_PRINT1
 ("EXECUTINGÇo_op.\n");

4282 
suc˚ed
:

4283 
	`DEBUG_PRINT1
 ("EXECUTING succeed.\n");

4284 
suc˚ed_œbñ
;

4289 
exa˘n
:

4290 
m˙t
 = *
p
++;

4291 
	`DEBUG_PRINT2
 ("EXECUTINGÉxa˘¿%d.\n", 
m˙t
);

4295 i‡(
å™¶©e
)

4299 
	`PREFETCH
 ();

4300 i‡((Ë
å™¶©e
[(Ë*
d
++]

4301 !(Ë*
p
++)

4302 
Áû
;

4304 --
m˙t
);

4310 
	`PREFETCH
 ();

4311 i‡(*
d
++ !(Ë*
p
++Ë
Áû
;

4313 --
m˙t
);

4315 
	`SET_REGS_MATCHED
 ();

4320 
™ych¨
:

4321 
	`DEBUG_PRINT1
 ("EXECUTINGánychar.\n");

4323 
	`PREFETCH
 ();

4325 i‡((!(
buÂ
->
sy¡ax
 & 
RE_DOT_NEWLINE
Ë&& 
	`TRANSLATE
 (*
d
) == '\n')

4326 || (
buÂ
->
sy¡ax
 & 
RE_DOT_NOT_NULL
 && 
	`TRANSLATE
 (*
d
) == '\000'))

4327 
Áû
;

4329 
	`SET_REGS_MATCHED
 ();

4330 
	`DEBUG_PRINT2
 (" M©ched `%d'.\n", *
d
);

4331 
d
++;

4335 
ch¨£t
:

4336 
ch¨£t_nŸ
:

4338 
c
;

4339 
boﬁón
 
nŸ
 = (
ª_›code_t
Ë*(
p
 - 1Ë=
ch¨£t_nŸ
;

4341 
	`DEBUG_PRINT2
 ("EXECUTING ch¨£t%s.\n", 
nŸ
 ? "_not" : "");

4343 
	`PREFETCH
 ();

4344 
c
 = 
	`TRANSLATE
 (*
d
);

4348 i‡(
c
 < (Ë(*
p
 * 
BYTEWIDTH
)

4349 && 
p
[1 + 
c
 / 
BYTEWIDTH
] & (1 << (c % BYTEWIDTH)))

4350 
nŸ
 = !not;

4352 
p
 += 1 + *p;

4354 i‡(!
nŸ
Ë
Áû
;

4356 
	`SET_REGS_MATCHED
 ();

4357 
d
++;

4367 
°¨t_mem‹y
:

4368 
	`DEBUG_PRINT3
 ("EXECUTING sèπ_mem‹y %d (%d):\n", *
p
,Ö[1]);

4371 
p1
 = 
p
;

4373 i‡(
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[*
p
]Ë=
MATCH_NULL_UNSET_VALUE
)

4374 
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[*
p
])

4375 
	`group_m©ch_nuŒ_°rög_p
 (&
p1
, 
≥nd
, 
ªg_öfo
);

4382 
ﬁd_ªg°¨t
[*
p
] = 
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[*p])

4383 ? 
	`REG_UNSET
 (
ªg°¨t
[*
p
]Ë? 
d
 :Ñegstart[*p]

4384 : 
ªg°¨t
[*
p
];

4385 
	`DEBUG_PRINT2
 (" old_regstart: %d\n",

4386 
	`POINTER_TO_OFFSET
 (
ﬁd_ªg°¨t
[*
p
]));

4388 
ªg°¨t
[*
p
] = 
d
;

4389 
	`DEBUG_PRINT2
 ("Ñeg°¨t: %d\n", 
	`POINTER_TO_OFFSET
 (
ªg°¨t
[*
p
]));

4391 
	`IS_ACTIVE
 (
ªg_öfo
[*
p
]) = 1;

4392 
	`MATCHED_SOMETHING
 (
ªg_öfo
[*
p
]) = 0;

4395 
£t_ªgs_m©ched_d⁄e
 = 0;

4398 
highe°_a˘ive_ªg
 = *
p
;

4402 i‡(
lowe°_a˘ive_ªg
 =
NO_LOWEST_ACTIVE_REG
)

4403 
lowe°_a˘ive_ªg
 = *
p
;

4406 
p
 += 2;

4407 
ju°_∑°_°¨t_mem
 = 
p
;

4415 
°›_mem‹y
:

4416 
	`DEBUG_PRINT3
 ("EXECUTING st›_mem‹y %d (%d):\n", *
p
,Ö[1]);

4423 
ﬁd_ªgíd
[*
p
] = 
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[*p])

4424 ? 
	`REG_UNSET
 (
ªgíd
[*
p
]Ë? 
d
 :Ñegend[*p]

4425 : 
ªgíd
[*
p
];

4426 
	`DEBUG_PRINT2
 (" old_regend: %d\n",

4427 
	`POINTER_TO_OFFSET
 (
ﬁd_ªgíd
[*
p
]));

4429 
ªgíd
[*
p
] = 
d
;

4430 
	`DEBUG_PRINT2
 ("Ñegíd: %d\n", 
	`POINTER_TO_OFFSET
 (
ªgíd
[*
p
]));

4433 
	`IS_ACTIVE
 (
ªg_öfo
[*
p
]) = 0;

4436 
£t_ªgs_m©ched_d⁄e
 = 0;

4440 i‡(
lowe°_a˘ive_ªg
 =
highe°_a˘ive_ªg
)

4442 
lowe°_a˘ive_ªg
 = 
NO_LOWEST_ACTIVE_REG
;

4443 
highe°_a˘ive_ªg
 = 
NO_HIGHEST_ACTIVE_REG
;

4450 
r
 = *
p
 - 1;

4451 
r
 > 0 && !
	`IS_ACTIVE
 (
ªg_öfo
[r]))

4452 
r
--;

4461 i‡(
r
 == 0)

4463 
lowe°_a˘ive_ªg
 = 
NO_LOWEST_ACTIVE_REG
;

4464 
highe°_a˘ive_ªg
 = 
NO_HIGHEST_ACTIVE_REG
;

4467 
highe°_a˘ive_ªg
 = 
r
;

4475 i‡((!
	`MATCHED_SOMETHING
 (
ªg_öfo
[*
p
])

4476 || 
ju°_∑°_°¨t_mem
 =
p
 - 1)

4477 && (
p
 + 2Ë< 
≥nd
)

4479 
boﬁón
 
is_a_jump_n
 = 
Ál£
;

4481 
p1
 = 
p
 + 2;

4482 
m˙t
 = 0;

4483 (
ª_›code_t
Ë*
p1
++)

4485 
jump_n
:

4486 
is_a_jump_n
 = 
åue
;

4487 
p›_Áûuª_jump
:

4488 
maybe_p›_jump
:

4489 
jump
:

4490 
dummy_Áûuª_jump
:

4491 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

4492 i‡(
is_a_jump_n
)

4493 
p1
 += 2;

4499 
p1
 +
m˙t
;

4506 i‡(
m˙t
 < 0 && (
ª_›code_t
Ë*
p1
 =
⁄_Áûuª_jump


4507 && (
ª_›code_t
Ë
p1
[3] =
°¨t_mem‹y
 &&Ö1[4] =*
p
)

4519 i‡(
	`EVER_MATCHED_SOMETHING
 (
ªg_öfo
[*
p
]))

4521 
r
;

4523 
	`EVER_MATCHED_SOMETHING
 (
ªg_öfo
[*
p
]) = 0;

4526 
r
 = *
p
;Ñ < () *p + () *(p + 1);

4527 
r
++)

4529 
ªg°¨t
[
r
] = 
ﬁd_ªg°¨t
[r];

4532 i‡(
ﬁd_ªgíd
[
r
] >
ªg°¨t
[r])

4533 
ªgíd
[
r
] = 
ﬁd_ªgíd
[r];

4536 
p1
++;

4537 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

4538 
	`PUSH_FAILURE_POINT
 (
p1
 + 
m˙t
, 
d
, -2);

4540 
Áû
;

4545 
p
 += 2;

4551 
du∂iˇã
:

4553 c⁄° *
d2
, *
díd2
;

4554 
ªgno
 = *
p
++;

4555 
	`DEBUG_PRINT2
 ("EXECUTING du∂iˇã %d.\n", 
ªgno
);

4558 i‡(
	`REG_UNSET
 (
ªg°¨t
[
ªgno
]Ë|| REG_UNSET (
ªgíd
[regno]))

4559 
Áû
;

4562 
d2
 = 
ªg°¨t
[
ªgno
];

4569 
díd2
 = ((
	`FIRST_STRING_P
 (
ªg°¨t
[
ªgno
])

4570 =
	`FIRST_STRING_P
 (
ªgíd
[
ªgno
]))

4571 ? 
ªgíd
[
ªgno
] : 
íd_m©ch_1
);

4576 
d2
 =
díd2
)

4578 i‡(
díd2
 =
íd_m©ch_2
) ;

4579 i‡(
díd2
 =
ªgíd
[
ªgno
]) ;

4582 
d2
 = 
°rög2
;

4583 
díd2
 = 
ªgíd
[
ªgno
];

4586 i‡(
d2
 =
díd2
) ;

4589 
	`PREFETCH
 ();

4592 
m˙t
 = 
díd
 - 
d
;

4596 i‡(
m˙t
 > 
díd2
 - 
d2
)

4597 
m˙t
 = 
díd2
 - 
d2
;

4601 i‡(
å™¶©e


4602 ? 
	`bcmp_å™¶©e
 (
d
, 
d2
, 
m˙t
, 
å™¶©e
)

4603 : 
	`memcmp
 (
d
, 
d2
, 
m˙t
))

4604 
Áû
;

4605 
d
 +
m˙t
, 
d2
 += mcnt;

4608 
	`SET_REGS_MATCHED
 ();

4617 
beglöe
:

4618 
	`DEBUG_PRINT1
 ("EXECUTING begline.\n");

4620 i‡(
	`AT_STRINGS_BEG
 (
d
))

4622 i‡(!
buÂ
->
nŸ_bﬁ
) ;

4624 i‡(
d
[-1] ='\n' && 
buÂ
->
√wlöe_™ch‹
)

4629 
Áû
;

4633 
ídlöe
:

4634 
	`DEBUG_PRINT1
 ("EXECUTINGÉndline.\n");

4636 i‡(
	`AT_STRINGS_END
 (
d
))

4638 i‡(!
buÂ
->
nŸ_eﬁ
) ;

4642 i‡((
d
 =
íd1
 ? *
°rög2
 : *d) == '\n'

4643 && 
buÂ
->
√wlöe_™ch‹
)

4647 
Áû
;

4651 
begbuf
:

4652 
	`DEBUG_PRINT1
 ("EXECUTING begbuf.\n");

4653 i‡(
	`AT_STRINGS_BEG
 (
d
))

4655 
Áû
;

4659 
ídbuf
:

4660 
	`DEBUG_PRINT1
 ("EXECUTINGÉndbuf.\n");

4661 i‡(
	`AT_STRINGS_END
 (
d
))

4663 
Áû
;

4682 
⁄_Áûuª_kìp_°rög_jump
:

4683 
	`DEBUG_PRINT1
 ("EXECUTING on_failure_keep_string_jump");

4685 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p
);

4686 #ifde‡
_LIBC


4687 
	`DEBUG_PRINT3
 (" %d (tÿ%p):\n", 
m˙t
, 
p
 + mcnt);

4689 
	`DEBUG_PRINT3
 (" %d (tÿ0x%x):\n", 
m˙t
, 
p
 + mcnt);

4692 
	`PUSH_FAILURE_POINT
 (
p
 + 
m˙t
, 
NULL
, -2);

4708 
⁄_Áûuª_jump
:

4709 
⁄_Áûuª
:

4710 
	`DEBUG_PRINT1
 ("EXECUTING on_failure_jump");

4712 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p
);

4713 #ifde‡
_LIBC


4714 
	`DEBUG_PRINT3
 (" %d (tÿ%p)", 
m˙t
, 
p
 + mcnt);

4716 
	`DEBUG_PRINT3
 (" %d (tÿ0x%x)", 
m˙t
, 
p
 + mcnt);

4728 
p1
 = 
p
;

4734 
p1
 < 
≥nd
 && (
ª_›code_t
Ë*p1 =
no_›
)

4735 
p1
++;

4737 i‡(
p1
 < 
≥nd
 && (
ª_›code_t
Ë*p1 =
°¨t_mem‹y
)

4743 
highe°_a˘ive_ªg
 = *(
p1
 + 1) + *(p1 + 2);

4744 i‡(
lowe°_a˘ive_ªg
 =
NO_LOWEST_ACTIVE_REG
)

4745 
lowe°_a˘ive_ªg
 = *(
p1
 + 1);

4748 
	`DEBUG_PRINT1
 (":\n");

4749 
	`PUSH_FAILURE_POINT
 (
p
 + 
m˙t
, 
d
, -2);

4755 
maybe_p›_jump
:

4756 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p
);

4757 
	`DEBUG_PRINT2
 ("EXECUTING maybe_p›_jum∞%d.\n", 
m˙t
);

4759 *
p2
 = 
p
;

4780 i‡(
p2
 + 2 < 
≥nd


4781 && ((
ª_›code_t
Ë*
p2
 =
°›_mem‹y


4782 || (
ª_›code_t
Ë*
p2
 =
°¨t_mem‹y
))

4783 
p2
 += 3;

4784 i‡(
p2
 + 6 < 
≥nd


4785 && (
ª_›code_t
Ë*
p2
 =
dummy_Áûuª_jump
)

4786 
p2
 += 6;

4791 
p1
 = 
p
 + 
m˙t
;

4797 i‡(
p2
 =
≥nd
)

4802 
p
[-3] = (Ë
p›_Áûuª_jump
;

4803 
DEBUG_PRINT1


4807 i‡((
ª_›code_t
Ë*
p2
 =
exa˘n


4808 || (
buÂ
->
√wlöe_™ch‹
 && (
ª_›code_t
Ë*
p2
 =
ídlöe
))

4810 
c


4811 *
p2
 =(Ë
ídlöe
 ? '\n' :Ö2[2];

4813 i‡((
ª_›code_t
Ë
p1
[3] =
exa˘n
 &&Ö1[5] !
c
)

4815 
p
[-3] = (Ë
p›_Áûuª_jump
;

4816 
	`DEBUG_PRINT3
 (" %c != %c =>Öop_failure_jump.\n",

4817 
c
, 
p1
[5]);

4820 i‡((
ª_›code_t
Ë
p1
[3] =
ch¨£t


4821 || (
ª_›code_t
Ë
p1
[3] =
ch¨£t_nŸ
)

4823 
nŸ
 = (
ª_›code_t
Ë
p1
[3] =
ch¨£t_nŸ
;

4825 i‡(
c
 < (Ë(
p1
[4] * 
BYTEWIDTH
)

4826 && 
p1
[5 + 
c
 / 
BYTEWIDTH
] & (1 << (c % BYTEWIDTH)))

4827 
nŸ
 = !not;

4831 i‡(!
nŸ
)

4833 
p
[-3] = (Ë
p›_Áûuª_jump
;

4834 
	`DEBUG_PRINT1
 (" No match =>Öop_failure_jump.\n");

4838 i‡((
ª_›code_t
Ë*
p2
 =
ch¨£t
)

4840 #ifde‡
DEBUG


4841 
c


4842 *
p2
 =(Ë
ídlöe
 ? '\n' :Ö2[2];

4846 i‡((
ª_›code_t
Ë
p1
[3] =
exa˘n


4847 && ! ((Ë
p2
[1] * 
BYTEWIDTH
 > (Ë
p1
[5]

4848 && (
p2
[2 + 
p1
[5] / 
BYTEWIDTH
]

4849 & (1 << (
p1
[5] % 
BYTEWIDTH
)))))

4851 i‡((
ª_›code_t
Ë
p1
[3] =
exa˘n


4852 && ! ((Ë
p2
[1] * 
BYTEWIDTH
 > (Ë
p1
[4]

4853 && (
p2
[2 + 
p1
[4] / 
BYTEWIDTH
]

4854 & (1 << (
p1
[4] % 
BYTEWIDTH
)))))

4857 
p
[-3] = (Ë
p›_Áûuª_jump
;

4858 
	`DEBUG_PRINT3
 (" %c != %c =>Öop_failure_jump.\n",

4859 
c
, 
p1
[5]);

4862 i‡((
ª_›code_t
Ë
p1
[3] =
ch¨£t_nŸ
)

4864 
idx
;

4867 
idx
 = 0; idx < (Ë
p2
[1]; idx++)

4868 i‡(! (
p2
[2 + 
idx
] == 0

4869 || (
idx
 < (Ë
p1
[4]

4870 && ((
p2
[2 + 
idx
] & ~ 
p1
[5 + idx]) == 0))))

4873 i‡(
idx
 =
p2
[1])

4875 
p
[-3] = (Ë
p›_Áûuª_jump
;

4876 
	`DEBUG_PRINT1
 (" No match =>Öop_failure_jump.\n");

4879 i‡((
ª_›code_t
Ë
p1
[3] =
ch¨£t
)

4881 
idx
;

4884 
idx
 = 0;

4885 
idx
 < (Ë
p2
[1] && idx < (Ë
p1
[4];

4886 
idx
++)

4887 i‡((
p2
[2 + 
idx
] & 
p1
[5 + idx]) != 0)

4890 i‡(
idx
 =
p2
[1] || idx =
p1
[4])

4892 
p
[-3] = (Ë
p›_Áûuª_jump
;

4893 
	`DEBUG_PRINT1
 (" No match =>Öop_failure_jump.\n");

4898 
p
 -= 2;

4899 i‡((
ª_›code_t
Ë
p
[-1] !
p›_Áûuª_jump
)

4901 
p
[-1] = (Ë
jump
;

4902 
	`DEBUG_PRINT1
 (" Match => jump.\n");

4903 
unc⁄dôi⁄Æ_jump
;

4914 
p›_Áûuª_jump
:

4921 
a˘ive_ªg_t
 
dummy_low_ªg
, 
dummy_high_ªg
;

4922 *
pdummy
;

4923 c⁄° *
sdummy
;

4925 
	`DEBUG_PRINT1
 ("EXECUTINGÖop_failure_jump.\n");

4926 
	`POP_FAILURE_POINT
 (
sdummy
, 
pdummy
,

4927 
dummy_low_ªg
, 
dummy_high_ªg
,

4928 
ªg_dummy
,Ñeg_dummy, 
ªg_öfo_dummy
);

4932 
unc⁄dôi⁄Æ_jump
:

4933 #ifde‡
_LIBC


4934 
	`DEBUG_PRINT2
 ("\n%p: ", 
p
);

4936 
	`DEBUG_PRINT2
 ("\n0x%x: ", 
p
);

4941 
jump
:

4942 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p
);

4943 
	`DEBUG_PRINT2
 ("EXECUTING jum∞%d ", 
m˙t
);

4944 
p
 +
m˙t
;

4945 #ifde‡
_LIBC


4946 
	`DEBUG_PRINT2
 ("—ÿ%p).\n", 
p
);

4948 
	`DEBUG_PRINT2
 ("—ÿ0x%x).\n", 
p
);

4955 
jump_∑°_Æt
:

4956 
	`DEBUG_PRINT1
 ("EXECUTING jump_past_alt.\n");

4957 
unc⁄dôi⁄Æ_jump
;

4965 
dummy_Áûuª_jump
:

4966 
	`DEBUG_PRINT1
 ("EXECUTING dummy_failure_jump.\n");

4969 
	`PUSH_FAILURE_POINT
 (
NULL
, NULL, -2);

4970 
unc⁄dôi⁄Æ_jump
;

4978 
push_dummy_Áûuª
:

4979 
	`DEBUG_PRINT1
 ("EXECUTINGÖush_dummy_failure.\n");

4982 
	`PUSH_FAILURE_POINT
 (
NULL
, NULL, -2);

4987 
suc˚ed_n
:

4988 
	`EXTRACT_NUMBER
 (
m˙t
, 
p
 + 2);

4989 
	`DEBUG_PRINT2
 ("EXECUTING suc˚ed_¿%d.\n", 
m˙t
);

4991 
	`as£π
 (
m˙t
 >= 0);

4993 i‡(
m˙t
 > 0)

4995 
m˙t
--;

4996 
p
 += 2;

4997 
	`STORE_NUMBER_AND_INCR
 (
p
, 
m˙t
);

4998 #ifde‡
_LIBC


4999 
	`DEBUG_PRINT3
 (" Sëtög %∞tÿ%d.\n", 
p
 - 2, 
m˙t
);

5001 
	`DEBUG_PRINT3
 (" Sëtög 0x%xÅÿ%d.\n", 
p
 - 2, 
m˙t
);

5004 i‡(
m˙t
 == 0)

5006 #ifde‡
_LIBC


5007 
	`DEBUG_PRINT2
 (" SëtögÅwÿbyã†‰om %∞tÿno_›.\n", 
p
+2);

5009 
	`DEBUG_PRINT2
 (" SëtögÅwÿbyã†‰om 0x%xÅÿno_›.\n", 
p
+2);

5011 
p
[2] = (Ë
no_›
;

5012 
p
[3] = (Ë
no_›
;

5013 
⁄_Áûuª
;

5017 
jump_n
:

5018 
	`EXTRACT_NUMBER
 (
m˙t
, 
p
 + 2);

5019 
	`DEBUG_PRINT2
 ("EXECUTING jump_¿%d.\n", 
m˙t
);

5022 i‡(
m˙t
)

5024 
m˙t
--;

5025 
	`STORE_NUMBER
 (
p
 + 2, 
m˙t
);

5026 #ifde‡
_LIBC


5027 
	`DEBUG_PRINT3
 (" Sëtög %∞tÿ%d.\n", 
p
 + 2, 
m˙t
);

5029 
	`DEBUG_PRINT3
 (" Sëtög 0x%xÅÿ%d.\n", 
p
 + 2, 
m˙t
);

5031 
unc⁄dôi⁄Æ_jump
;

5035 
p
 += 4;

5038 
£t_numbî_©
:

5040 
	`DEBUG_PRINT1
 ("EXECUTING set_number_at.\n");

5042 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p
);

5043 
p1
 = 
p
 + 
m˙t
;

5044 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p
);

5045 #ifde‡
_LIBC


5046 
	`DEBUG_PRINT3
 (" Sëtög %∞tÿ%d.\n", 
p1
, 
m˙t
);

5048 
	`DEBUG_PRINT3
 (" Sëtög 0x%xÅÿ%d.\n", 
p1
, 
m˙t
);

5050 
	`STORE_NUMBER
 (
p1
, 
m˙t
);

5060 
w‹dbound
:

5061 
	`DEBUG_PRINT1
 ("EXECUTING wordbound.\n");

5062 i‡(
	`AT_WORD_BOUNDARY
 (
d
))

5064 
Áû
;

5066 
nŸw‹dbound
:

5067 
	`DEBUG_PRINT1
 ("EXECUTINGÇotwordbound.\n");

5068 i‡(
	`AT_WORD_BOUNDARY
 (
d
))

5069 
Áû
;

5072 
w‹dbound
:

5074 
boﬁón
 
¥evch¨
, 
thisch¨
;

5076 
	`DEBUG_PRINT1
 ("EXECUTING wordbound.\n");

5077 i‡(
	`AT_STRINGS_BEG
 (
d
Ë|| 
	`AT_STRINGS_END
 (d))

5080 
¥evch¨
 = 
	`WORDCHAR_P
 (
d
 - 1);

5081 
thisch¨
 = 
	`WORDCHAR_P
 (
d
);

5082 i‡(
¥evch¨
 !
thisch¨
)

5084 
Áû
;

5087 
nŸw‹dbound
:

5089 
boﬁón
 
¥evch¨
, 
thisch¨
;

5091 
	`DEBUG_PRINT1
 ("EXECUTINGÇotwordbound.\n");

5092 i‡(
	`AT_STRINGS_BEG
 (
d
Ë|| 
	`AT_STRINGS_END
 (d))

5093 
Áû
;

5095 
¥evch¨
 = 
	`WORDCHAR_P
 (
d
 - 1);

5096 
thisch¨
 = 
	`WORDCHAR_P
 (
d
);

5097 i‡(
¥evch¨
 !
thisch¨
)

5098 
Áû
;

5103 
w‹dbeg
:

5104 
	`DEBUG_PRINT1
 ("EXECUTING wordbeg.\n");

5105 i‡(
	`WORDCHAR_P
 (
d
Ë&& (
	`AT_STRINGS_BEG
 (d) || !WORDCHAR_P (d - 1)))

5107 
Áû
;

5109 
w‹díd
:

5110 
	`DEBUG_PRINT1
 ("EXECUTING wordend.\n");

5111 i‡(!
	`AT_STRINGS_BEG
 (
d
Ë&& 
	`WORDCHAR_P
 (d - 1)

5112 && (!
	`WORDCHAR_P
 (
d
Ë|| 
	`AT_STRINGS_END
 (d)))

5114 
Áû
;

5116 #ifde‡
emacs


5117 
bef‹e_dŸ
:

5118 
	`DEBUG_PRINT1
 ("EXECUTING before_dot.\n");

5119 i‡(
	`PTR_CHAR_POS
 ((*Ë
d
Ë>
poöt
)

5120 
Áû
;

5123 
©_dŸ
:

5124 
	`DEBUG_PRINT1
 ("EXECUTINGát_dot.\n");

5125 i‡(
	`PTR_CHAR_POS
 ((*Ë
d
Ë!
poöt
)

5126 
Áû
;

5129 
a·î_dŸ
:

5130 
	`DEBUG_PRINT1
 ("EXECUTINGáfter_dot.\n");

5131 i‡(
	`PTR_CHAR_POS
 ((*Ë
d
Ë<
poöt
)

5132 
Áû
;

5135 
sy¡ax•ec
:

5136 
	`DEBUG_PRINT2
 ("EXECUTING sy¡ax•e¯%d.\n", 
m˙t
);

5137 
m˙t
 = *
p
++;

5138 
m©chsy¡ax
;

5140 
w‹dch¨
:

5141 
	`DEBUG_PRINT1
 ("EXECUTING Emacs wordchar.\n");

5142 
m˙t
 = (Ë
Sw‹d
;

5143 
m©chsy¡ax
:

5144 
	`PREFETCH
 ();

5146 
d
++;

5147 i‡(
	`SYNTAX
 (
d
[-1]Ë!(
sy¡axcode
Ë
m˙t
)

5148 
Áû
;

5149 
	`SET_REGS_MATCHED
 ();

5152 
nŸsy¡ax•ec
:

5153 
	`DEBUG_PRINT2
 ("EXECUTINGÇŸsy¡ax•e¯%d.\n", 
m˙t
);

5154 
m˙t
 = *
p
++;

5155 
m©chnŸsy¡ax
;

5157 
nŸw‹dch¨
:

5158 
	`DEBUG_PRINT1
 ("EXECUTING EmacsÇotwordchar.\n");

5159 
m˙t
 = (Ë
Sw‹d
;

5160 
m©chnŸsy¡ax
:

5161 
	`PREFETCH
 ();

5163 
d
++;

5164 i‡(
	`SYNTAX
 (
d
[-1]Ë=(
sy¡axcode
Ë
m˙t
)

5165 
Áû
;

5166 
	`SET_REGS_MATCHED
 ();

5170 
w‹dch¨
:

5171 
	`DEBUG_PRINT1
 ("EXECUTINGÇon-Emacs wordchar.\n");

5172 
	`PREFETCH
 ();

5173 i‡(!
	`WORDCHAR_P
 (
d
))

5174 
Áû
;

5175 
	`SET_REGS_MATCHED
 ();

5176 
d
++;

5179 
nŸw‹dch¨
:

5180 
	`DEBUG_PRINT1
 ("EXECUTINGÇon-EmacsÇotwordchar.\n");

5181 
	`PREFETCH
 ();

5182 i‡(
	`WORDCHAR_P
 (
d
))

5183 
Áû
;

5184 
	`SET_REGS_MATCHED
 ();

5185 
d
++;

5190 
	`ab‹t
 ();

5196 
Áû
:

5197 i‡(!
	`FAIL_STACK_EMPTY
 ())

5199 
	`DEBUG_PRINT1
 ("\nFAIL:\n");

5200 
	`POP_FAILURE_POINT
 (
d
, 
p
,

5201 
lowe°_a˘ive_ªg
, 
highe°_a˘ive_ªg
,

5202 
ªg°¨t
, 
ªgíd
, 
ªg_öfo
);

5205 i‡(!
p
)

5206 
Áû
;

5209 
	`as£π
 (
p
 <
≥nd
);

5210 i‡(
p
 < 
≥nd
)

5212 
boﬁón
 
is_a_jump_n
 = 
Ál£
;

5216 (
ª_›code_t
Ë*
p
)

5218 
jump_n
:

5219 
is_a_jump_n
 = 
åue
;

5220 
maybe_p›_jump
:

5221 
p›_Áûuª_jump
:

5222 
jump
:

5223 
p1
 = 
p
 + 1;

5224 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

5225 
p1
 +
m˙t
;

5227 i‡((
is_a_jump_n
 && (
ª_›code_t
Ë*
p1
 =
suc˚ed_n
)

5228 || (!
is_a_jump_n


5229 && (
ª_›code_t
Ë*
p1
 =
⁄_Áûuª_jump
))

5230 
Áû
;

5237 i‡(
d
 >
°rög1
 && d <
íd1
)

5238 
díd
 = 
íd_m©ch_1
;

5244 i‡(
be°_ªgs_£t
)

5245 
ª°‹e_be°_ªgs
;

5247 
	`FREE_VARIABLES
 ();

5250 
	}
}

5265 
boﬁón


5266 
	$group_m©ch_nuŒ_°rög_p
 (
p
, 
íd
, 
ªg_öfo
)

5267 **
p
, *
íd
;

5268 
ªgi°î_öfo_ty≥
 *
ªg_öfo
;

5270 
m˙t
;

5272 *
p1
 = *
p
 + 2;

5274 
p1
 < 
íd
)

5280 (
ª_›code_t
Ë*
p1
)

5283 
⁄_Áûuª_jump
:

5284 
p1
++;

5285 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

5290 i‡(
m˙t
 >= 0)

5310 (
ª_›code_t
Ë
p1
[
m˙t
-3] =
jump_∑°_Æt
)

5316 i‡(!
	`Æt_m©ch_nuŒ_°rög_p
 (
p1
,Ö1 + 
m˙t
 - 3,

5317 
ªg_öfo
))

5318  
Ál£
;

5322 
p1
 +
m˙t
;

5326 i‡((
ª_›code_t
Ë*
p1
 !
⁄_Áûuª_jump
)

5331 
p1
++;

5332 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

5333 i‡((
ª_›code_t
Ë
p1
[
m˙t
-3] !
jump_∑°_Æt
)

5336 
p1
 -= 3;

5344 
	`EXTRACT_NUMBER
 (
m˙t
, 
p1
 - 2);

5346 i‡(!
	`Æt_m©ch_nuŒ_°rög_p
 (
p1
,Ö1 + 
m˙t
, 
ªg_öfo
))

5347  
Ál£
;

5349 
p1
 +
m˙t
;

5354 
°›_mem‹y
:

5355 
	`as£π
 (
p1
[1] =**
p
);

5356 *
p
 = 
p1
 + 2;

5357  
åue
;

5361 i‡(!
	`comm⁄_›_m©ch_nuŒ_°rög_p
 (&
p1
, 
íd
, 
ªg_öfo
))

5362  
Ál£
;

5366  
Ál£
;

5367 
	}
}

5374 
boﬁón


5375 
	$Æt_m©ch_nuŒ_°rög_p
 (
p
, 
íd
, 
ªg_öfo
)

5376 *
p
, *
íd
;

5377 
ªgi°î_öfo_ty≥
 *
ªg_öfo
;

5379 
m˙t
;

5380 *
p1
 = 
p
;

5382 
p1
 < 
íd
)

5387 (
ª_›code_t
Ë*
p1
)

5390 
⁄_Áûuª_jump
:

5391 
p1
++;

5392 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

5393 
p1
 +
m˙t
;

5397 i‡(!
	`comm⁄_›_m©ch_nuŒ_°rög_p
 (&
p1
, 
íd
, 
ªg_öfo
))

5398  
Ál£
;

5402  
åue
;

5403 
	}
}

5411 
boﬁón


5412 
	$comm⁄_›_m©ch_nuŒ_°rög_p
 (
p
, 
íd
, 
ªg_öfo
)

5413 **
p
, *
íd
;

5414 
ªgi°î_öfo_ty≥
 *
ªg_öfo
;

5416 
m˙t
;

5417 
boﬁón
 
ªt
;

5418 
ªg_no
;

5419 *
p1
 = *
p
;

5421 (
ª_›code_t
Ë*
p1
++)

5423 
no_›
:

5424 
beglöe
:

5425 
ídlöe
:

5426 
begbuf
:

5427 
ídbuf
:

5428 
w‹dbeg
:

5429 
w‹díd
:

5430 
w‹dbound
:

5431 
nŸw‹dbound
:

5432 #ifde‡
emacs


5433 
bef‹e_dŸ
:

5434 
©_dŸ
:

5435 
a·î_dŸ
:

5439 
°¨t_mem‹y
:

5440 
ªg_no
 = *
p1
;

5441 
	`as£π
 (
ªg_no
 > 0 &&Ñeg_nÿ<
MAX_REGNUM
);

5442 
ªt
 = 
	`group_m©ch_nuŒ_°rög_p
 (&
p1
, 
íd
, 
ªg_öfo
);

5447 i‡(
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[
ªg_no
]Ë=
MATCH_NULL_UNSET_VALUE
)

5448 
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[
ªg_no
]Ë
ªt
;

5450 i‡(!
ªt
)

5451  
Ál£
;

5455 
jump
:

5456 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

5457 i‡(
m˙t
 >= 0)

5458 
p1
 +
m˙t
;

5460  
Ál£
;

5463 
suc˚ed_n
:

5465 
p1
 += 2;

5466 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

5468 i‡(
m˙t
 == 0)

5470 
p1
 -= 4;

5471 
	`EXTRACT_NUMBER_AND_INCR
 (
m˙t
, 
p1
);

5472 
p1
 +
m˙t
;

5475  
Ál£
;

5478 
du∂iˇã
:

5479 i‡(!
	`REG_MATCH_NULL_STRING_P
 (
ªg_öfo
[*
p1
]))

5480  
Ál£
;

5483 
£t_numbî_©
:

5484 
p1
 += 4;

5488  
Ál£
;

5491 *
p
 = 
p1
;

5492  
åue
;

5493 
	}
}

5500 
	$bcmp_å™¶©e
 (
s1
, 
s2
, 
Àn
, 
å™¶©e
)

5501 c⁄° *
s1
, *
s2
;

5502 
Àn
;

5503 
RE_TRANSLATE_TYPE
 
å™¶©e
;

5505 c⁄° *
p1
 = (c⁄° *Ë
s1
;

5506 c⁄° *
p2
 = (c⁄° *Ë
s2
;

5507 
Àn
)

5509 i‡(
å™¶©e
[*
p1
++] !å™¶©e[*
p2
++])  1;

5510 
Àn
--;

5513 
	}
}

5527 
	$ª_compûe_∑âîn
 (
∑âîn
, 
Àngth
, 
buÂ
)

5528 c⁄° *
∑âîn
;

5529 
size_t
 
Àngth
;

5530 
ª_∑âîn_buf„r
 *
buÂ
;

5532 
ªg_îrcode_t
 
ªt
;

5536 
buÂ
->
ªgs_Æloˇãd
 = 
REGS_UNALLOCATED
;

5541 
buÂ
->
no_sub
 = 0;

5544 
buÂ
->
√wlöe_™ch‹
 = 1;

5546 
ªt
 = 
	`ªgex_compûe
 (
∑âîn
, 
Àngth
, 
ª_sy¡ax_›ti⁄s
, 
buÂ
);

5548 i‡(!
ªt
)

5549  
NULL
;

5550  
	`gëãxt
 (
ª_îr‹_msgid
 + 
ª_îr‹_msgid_idx
[(Ë
ªt
]);

5551 
	}
}

5552 #ifde‡
_LIBC


5553 
	$wók_Æüs
 (
__ª_compûe_∑âîn
, 
ª_compûe_∑âîn
)

5559 #i‡
deföed
 
_REGEX_RE_COMP
 || deföed 
_LIBC


5562 
ª_∑âîn_buf„r
 
ª_comp_buf
;

5565 #ifde‡
_LIBC


5569 
wók_fun˘i⁄


5571 
	$ª_comp
 (
s
)

5572 c⁄° *
s
;

5574 
ªg_îrcode_t
 
ªt
;

5576 i‡(!
s
)

5578 i‡(!
ª_comp_buf
.
buf„r
)

5579  
	`gëãxt
 ("NoÖreviousÑegularÉxpression");

5583 i‡(!
ª_comp_buf
.
buf„r
)

5585 
ª_comp_buf
.
buf„r
 = (*Ë
	`mÆloc
 (200);

5586 i‡(
ª_comp_buf
.
buf„r
 =
NULL
)

5587  (*Ë
	`gëãxt
 (
ª_îr‹_msgid


5588 + 
ª_îr‹_msgid_idx
[(Ë
REG_ESPACE
]);

5589 
ª_comp_buf
.
Æloˇãd
 = 200;

5591 
ª_comp_buf
.
Á°m≠
 = (*Ë
	`mÆloc
 (1 << 
BYTEWIDTH
);

5592 i‡(
ª_comp_buf
.
Á°m≠
 =
NULL
)

5593  (*Ë
	`gëãxt
 (
ª_îr‹_msgid


5594 + 
ª_îr‹_msgid_idx
[(Ë
REG_ESPACE
]);

5601 
ª_comp_buf
.
√wlöe_™ch‹
 = 1;

5603 
ªt
 = 
	`ªgex_compûe
 (
s
, 
	`°æí
 (s), 
ª_sy¡ax_›ti⁄s
, &
ª_comp_buf
);

5605 i‡(!
ªt
)

5606  
NULL
;

5609  (*Ë
	`gëãxt
 (
ª_îr‹_msgid
 + 
ª_îr‹_msgid_idx
[(Ë
ªt
]);

5610 
	}
}

5614 #ifde‡
_LIBC


5615 
	gwók_fun˘i⁄


5617 
	$ª_exec
 (
s
)

5618 c⁄° *
s
;

5620 c⁄° 
Àn
 = 
	`°æí
 (
s
);

5622 0 <
	`ª_£¨ch
 (&
ª_comp_buf
, 
s
, 
Àn
, 0,Üí, (
ª_ªgi°îs
 *) 0);

5623 
	}
}

5629 #i‚de‡
emacs


5667 
	$ªgcomp
 (
¥eg
, 
∑âîn
, 
cÊags
)

5668 
ªgex_t
 *
¥eg
;

5669 c⁄° *
∑âîn
;

5670 
cÊags
;

5672 
ªg_îrcode_t
 
ªt
;

5673 
ªg_sy¡ax_t
 
sy¡ax


5674 (
cÊags
 & 
REG_EXTENDED
) ?

5675 
RE_SYNTAX_POSIX_EXTENDED
 : 
RE_SYNTAX_POSIX_BASIC
;

5678 
¥eg
->
buf„r
 = 0;

5679 
¥eg
->
Æloˇãd
 = 0;

5680 
¥eg
->
u£d
 = 0;

5683 
¥eg
->
Á°m≠
 = (*Ë
	`mÆloc
 (1 << 
BYTEWIDTH
);

5685 i‡(
cÊags
 & 
REG_ICASE
)

5687 
i
;

5689 
¥eg
->
å™¶©e


5690 (
RE_TRANSLATE_TYPE
Ë
	`mÆloc
 (
CHAR_SET_SIZE


5691 *  (*(
RE_TRANSLATE_TYPE
)0));

5692 i‡(
¥eg
->
å™¶©e
 =
NULL
)

5693  (Ë
REG_ESPACE
;

5696 
i
 = 0; i < 
CHAR_SET_SIZE
; i++)

5697 
¥eg
->
å™¶©e
[
i
] = 
	`ISUPPER
 (iË? 
	`TOLOWER
 (i) : i;

5700 
¥eg
->
å™¶©e
 = 
NULL
;

5703 i‡(
cÊags
 & 
REG_NEWLINE
)

5705 
sy¡ax
 &~
RE_DOT_NEWLINE
;

5706 
sy¡ax
 |
RE_HAT_LISTS_NOT_NEWLINE
;

5708 
¥eg
->
√wlöe_™ch‹
 = 1;

5711 
¥eg
->
√wlöe_™ch‹
 = 0;

5713 
¥eg
->
no_sub
 = !!(
cÊags
 & 
REG_NOSUB
);

5717 
ªt
 = 
	`ªgex_compûe
 (
∑âîn
, 
	`°æí
 (∑âîn), 
sy¡ax
, 
¥eg
);

5721 i‡(
ªt
 =
REG_ERPAREN
Ëªà
REG_EPAREN
;

5723 i‡(
ªt
 =
REG_NOERROR
 && 
¥eg
->
Á°m≠
)

5727 i‡(
	`ª_compûe_Á°m≠
 (
¥eg
) == -2)

5731 
	`‰ì
 (
¥eg
->
Á°m≠
);

5732 
¥eg
->
Á°m≠
 = 
NULL
;

5736  (Ë
ªt
;

5737 
	}
}

5738 #ifde‡
_LIBC


5739 
	$wók_Æüs
 (
__ªgcomp
, 
ªgcomp
)

5758 
	$ªgexec
 (
¥eg
, 
°rög
, 
nm©ch
, 
pm©ch
, 
eÊags
)

5759 c⁄° 
ªgex_t
 *
¥eg
;

5760 c⁄° *
°rög
;

5761 
size_t
 
nm©ch
;

5762 
ªgm©ch_t
 
pm©ch
[];

5763 
eÊags
;

5765 
ªt
;

5766 
ª_ªgi°îs
 
ªgs
;

5767 
ªgex_t
 
¥iv©e_¥eg
;

5768 
Àn
 = 
	`°æí
 (
°rög
);

5769 
boﬁón
 
w™t_ªg_öfo
 = !
¥eg
->
no_sub
 && 
nm©ch
 > 0;

5771 
¥iv©e_¥eg
 = *
¥eg
;

5773 
¥iv©e_¥eg
.
nŸ_bﬁ
 = !!(
eÊags
 & 
REG_NOTBOL
);

5774 
¥iv©e_¥eg
.
nŸ_eﬁ
 = !!(
eÊags
 & 
REG_NOTEOL
);

5779 
¥iv©e_¥eg
.
ªgs_Æloˇãd
 = 
REGS_FIXED
;

5781 i‡(
w™t_ªg_öfo
)

5783 
ªgs
.
num_ªgs
 = 
nm©ch
;

5784 
ªgs
.
°¨t
 = 
	`TALLOC
 (
nm©ch
 * 2, 
ªgoff_t
);

5785 i‡(
ªgs
.
°¨t
 =
NULL
)

5786  (Ë
REG_NOMATCH
;

5787 
ªgs
.
íd
 =Ñegs.
°¨t
 + 
nm©ch
;

5791 
ªt
 = 
	`ª_£¨ch
 (&
¥iv©e_¥eg
, 
°rög
, 
Àn
,

5792  0, 
Àn
,

5793 
w™t_ªg_öfo
 ? &
ªgs
 : (
ª_ªgi°îs
 *) 0);

5796 i‡(
w™t_ªg_öfo
)

5798 i‡(
ªt
 >= 0)

5800 
r
;

5802 
r
 = 0;Ñ < 
nm©ch
;Ñ++)

5804 
pm©ch
[
r
].
rm_so
 = 
ªgs
.
°¨t
[r];

5805 
pm©ch
[
r
].
rm_eo
 = 
ªgs
.
íd
[r];

5810 
	`‰ì
 (
ªgs
.
°¨t
);

5814  
ªt
 >0 ? (Ë
REG_NOERROR
 : (Ë
REG_NOMATCH
;

5815 
	}
}

5816 #ifde‡
_LIBC


5817 
	$wók_Æüs
 (
__ªgexec
, 
ªgexec
)

5824 
size_t


5825 
	$ªgîr‹
 (
îr
, 
¥eg
, 
îrbuf
, 
îrbuf_size
)

5826 
îr
;

5827 c⁄° 
ªgex_t
 *
¥eg
;

5828 *
îrbuf
;

5829 
size_t
 
îrbuf_size
;

5831 c⁄° *
msg
;

5832 
size_t
 
msg_size
;

5834 i‡(
îr
 < 0

5835 || 
îr
 >(Ë( (
ª_îr‹_msgid_idx
)

5836 /  (
ª_îr‹_msgid_idx
[0])))

5841 
	`ab‹t
 ();

5843 
msg
 = 
	`gëãxt
 (
ª_îr‹_msgid
 + 
ª_îr‹_msgid_idx
[
îr
]);

5845 
msg_size
 = 
	`°æí
 (
msg
) + 1;

5847 i‡(
îrbuf_size
 != 0)

5849 i‡(
msg_size
 > 
îrbuf_size
)

5851 #i‡
deföed
 
HAVE_MEMPCPY
 || deföed 
_LIBC


5852 *((*Ë
	`__memp˝y
 (
îrbuf
, 
msg
, 
îrbuf_size
 - 1)) = '\0';

5854 
	`mem˝y
 (
îrbuf
, 
msg
, 
îrbuf_size
 - 1);

5855 
îrbuf
[
îrbuf_size
 - 1] = 0;

5859 
	`mem˝y
 (
îrbuf
, 
msg
, 
msg_size
);

5862  
msg_size
;

5863 
	}
}

5864 #ifde‡
_LIBC


5865 
	$wók_Æüs
 (
__ªgîr‹
, 
ªgîr‹
)

5872 
	$ªg‰ì
 (
¥eg
)

5873 
ªgex_t
 *
¥eg
;

5875 i‡(
¥eg
->
buf„r
 !
NULL
)

5876 
	`‰ì
 (
¥eg
->
buf„r
);

5877 
¥eg
->
buf„r
 = 
NULL
;

5879 
¥eg
->
Æloˇãd
 = 0;

5880 
¥eg
->
u£d
 = 0;

5882 i‡(
¥eg
->
Á°m≠
 !
NULL
)

5883 
	`‰ì
 (
¥eg
->
Á°m≠
);

5884 
¥eg
->
Á°m≠
 = 
NULL
;

5885 
¥eg
->
Á°m≠_accuøã
 = 0;

5887 i‡(
¥eg
->
å™¶©e
 !
NULL
)

5888 
	`‰ì
 (
¥eg
->
å™¶©e
);

5889 
¥eg
->
å™¶©e
 = 
NULL
;

5890 
	}
}

5891 #ifde‡
_LIBC


5892 
	$wók_Æüs
 (
__ªg‰ì
, 
ªg‰ì
)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/route_types.h

4 #i‚de‡
_QUAGGA_ROUTE_TYPES_H


5 
	#_QUAGGA_ROUTE_TYPES_H


	)

8 
	#ZEBRA_ROUTE_SYSTEM
 0

	)

9 
	#ZEBRA_ROUTE_KERNEL
 1

	)

10 
	#ZEBRA_ROUTE_CONNECT
 2

	)

11 
	#ZEBRA_ROUTE_STATIC
 3

	)

12 
	#ZEBRA_ROUTE_RIP
 4

	)

13 
	#ZEBRA_ROUTE_RIPNG
 5

	)

14 
	#ZEBRA_ROUTE_OSPF
 6

	)

15 
	#ZEBRA_ROUTE_OSPF6
 7

	)

16 
	#ZEBRA_ROUTE_ISIS
 8

	)

17 
	#ZEBRA_ROUTE_BGP
 9

	)

18 
	#ZEBRA_ROUTE_HSLS
 10

	)

19 
	#ZEBRA_ROUTE_OLSR
 11

	)

20 
	#ZEBRA_ROUTE_BABEL
 12

	)

21 
	#ZEBRA_ROUTE_MAX
 13

	)

23 
	#SHOW_ROUTE_V4_HEADER
 \

27 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE, 
	)
VTY_NEWLINE

28 
	#SHOW_ROUTE_V6_HEADER
 \

32 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE, 
	)
VTY_NEWLINE

35 
	#QUAGGA_REDIST_STR_BABELD
 \

36 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|isis|bgp)"

	)

37 
	#QUAGGA_REDIST_HELP_STR_BABELD
 \

46 "B‹dî G©eway PrŸocﬁ (BGP)\n"

	)

47 
	#QUAGGA_IP_REDIST_STR_BABELD
 \

48 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|isis|bgp)"

	)

49 
	#QUAGGA_IP_REDIST_HELP_STR_BABELD
 \

56 "B‹dî G©eway PrŸocﬁ (BGP)\n"

	)

57 
	#QUAGGA_IP6_REDIST_STR_BABELD
 \

58 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|isis|bgp)"

	)

59 
	#QUAGGA_IP6_REDIST_HELP_STR_BABELD
 \

66 "B‹dî G©eway PrŸocﬁ (BGP)\n"

	)

69 
	#QUAGGA_REDIST_STR_BGPD
 \

70 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|isis|babñ)"

	)

71 
	#QUAGGA_REDIST_HELP_STR_BGPD
 \

80 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

81 
	#QUAGGA_IP_REDIST_STR_BGPD
 \

82 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|isis|babñ)"

	)

83 
	#QUAGGA_IP_REDIST_HELP_STR_BGPD
 \

90 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

91 
	#QUAGGA_IP6_REDIST_STR_BGPD
 \

92 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|isis|babñ)"

	)

93 
	#QUAGGA_IP6_REDIST_HELP_STR_BGPD
 \

100 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

103 
	#QUAGGA_REDIST_STR_ISISD
 \

104 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|bgp|babñ)"

	)

105 
	#QUAGGA_REDIST_HELP_STR_ISISD
 \

114 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

115 
	#QUAGGA_IP_REDIST_STR_ISISD
 \

116 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|bgp|babñ)"

	)

117 
	#QUAGGA_IP_REDIST_HELP_STR_ISISD
 \

124 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

125 
	#QUAGGA_IP6_REDIST_STR_ISISD
 \

126 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|bgp|babñ)"

	)

127 
	#QUAGGA_IP6_REDIST_HELP_STR_ISISD
 \

134 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

137 
	#QUAGGA_REDIST_STR_OSPF6D
 \

138 "(kî√l|c⁄√˘ed|°©ic|rùng|isis|bgp|babñ)"

	)

139 
	#QUAGGA_REDIST_HELP_STR_OSPF6D
 \

146 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

149 
	#QUAGGA_REDIST_STR_OSPFD
 \

150 "(kî√l|c⁄√˘ed|°©ic|rù|isis|bgp|babñ)"

	)

151 
	#QUAGGA_REDIST_HELP_STR_OSPFD
 \

158 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

161 
	#QUAGGA_REDIST_STR_RIPD
 \

162 "(kî√l|c⁄√˘ed|°©ic|o•f|isis|bgp|babñ)"

	)

163 
	#QUAGGA_REDIST_HELP_STR_RIPD
 \

170 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

173 
	#QUAGGA_REDIST_STR_RIPNGD
 \

174 "(kî√l|c⁄√˘ed|°©ic|o•f6|isis|bgp|babñ)"

	)

175 
	#QUAGGA_REDIST_HELP_STR_RIPNGD
 \

182 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

185 
	#QUAGGA_REDIST_STR_ZEBRA
 \

186 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|isis|bgp|babñ)"

	)

187 
	#QUAGGA_REDIST_HELP_STR_ZEBRA
 \

197 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

198 
	#QUAGGA_IP_REDIST_STR_ZEBRA
 \

199 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|isis|bgp|babñ)"

	)

200 
	#QUAGGA_IP_REDIST_HELP_STR_ZEBRA
 \

208 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

209 
	#QUAGGA_IP6_REDIST_STR_ZEBRA
 \

210 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|isis|bgp|babñ)"

	)

211 
	#QUAGGA_IP6_REDIST_HELP_STR_ZEBRA
 \

219 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

222 #ifde‡
QUAGGA_DEFINE_DESC_TABLE


224 
	szebø_desc_èbÀ


226 
	mty≥
;

227 c⁄° *
	m°rög
;

228 
	mchr
;

231 
	#DESC_ENTRY
(
T
,
S
,
C
Ë[(T)] = { (T), (S), (CË}

	)

232 c⁄° 
zebø_desc_èbÀ
 
	grouã_ty≥s
[] = {

233 
DESC_ENTRY
 (
ZEBRA_ROUTE_SYSTEM
, "system", 'X' ),

234 
DESC_ENTRY
 (
ZEBRA_ROUTE_KERNEL
, "kernel", 'K' ),

235 
DESC_ENTRY
 (
ZEBRA_ROUTE_CONNECT
, "connected", 'C' ),

236 
DESC_ENTRY
 (
ZEBRA_ROUTE_STATIC
, "static", 'S' ),

237 
DESC_ENTRY
 (
ZEBRA_ROUTE_RIP
, "rip", 'R' ),

238 
DESC_ENTRY
 (
ZEBRA_ROUTE_RIPNG
, "ripng", 'R' ),

239 
DESC_ENTRY
 (
ZEBRA_ROUTE_OSPF
, "ospf", 'O' ),

240 
DESC_ENTRY
 (
ZEBRA_ROUTE_OSPF6
, "ospf6", 'O' ),

241 
DESC_ENTRY
 (
ZEBRA_ROUTE_ISIS
, "isis", 'I' ),

242 
DESC_ENTRY
 (
ZEBRA_ROUTE_BGP
, "bgp", 'B' ),

243 
DESC_ENTRY
 (
ZEBRA_ROUTE_HSLS
, "hsls", 'H' ),

244 
DESC_ENTRY
 (
ZEBRA_ROUTE_OLSR
, "olsr", 'o' ),

245 
DESC_ENTRY
 (
ZEBRA_ROUTE_BABEL
, "babel", 'A' ),

247 #unde‡
DESC_ENTRY


	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/routemap.c

21 
	~<zebø.h
>

23 
	~"lökli°.h
"

24 
	~"mem‹y.h
"

25 
	~"ve˘‹.h
"

26 
	~"¥efix.h
"

27 
	~"rouãm≠.h
"

28 
	~"comm™d.h
"

29 
	~"vty.h
"

30 
	~"log.h
"

33 
ve˘‹
 
	grouã_m©ch_vec
;

36 
ve˘‹
 
	grouã_£t_vec
;

39 
	srouã_m≠_ruÀ


42 
rouã_m≠_ruÀ_cmd
 *
	mcmd
;

45 *
	mruÀ_°r
;

48 *
	mvÆue
;

51 
rouã_m≠_ruÀ
 *
	m√xt
;

52 
rouã_m≠_ruÀ
 *
	m¥ev
;

56 
	srouã_m≠_li°


58 
rouã_m≠
 *
	mhód
;

59 
rouã_m≠
 *
	mèû
;

61 (*
	madd_hook
) (const *);

62 (*
	mdñëe_hook
) (const *);

63 (*
	mevít_hook
Ë(
	mrouã_m≠_evít_t
, const *);

67 
rouã_m≠_li°
 
	grouã_m≠_ma°î
 = { 
NULL
, NULL, NULL, NULL };

70 
rouã_m≠_ruÀ_dñëe
 (
rouã_m≠_ruÀ_li°
 *,

71 
rouã_m≠_ruÀ
 *);

74 
rouã_m≠_ödex_dñëe
 (
rouã_m≠_ödex
 *, );

78 
rouã_m≠
 *

79 
	$rouã_m≠_√w
 (c⁄° *
«me
)

81 
rouã_m≠
 *
√w
;

83 
√w
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP
,  (
rouã_m≠
));

84 
√w
->
«me
 = 
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_NAME
,Çame);

85  
√w
;

86 
	}
}

89 
rouã_m≠
 *

90 
	$rouã_m≠_add
 (c⁄° *
«me
)

92 
rouã_m≠
 *
m≠
;

93 
rouã_m≠_li°
 *
li°
;

95 
m≠
 = 
	`rouã_m≠_√w
 (
«me
);

96 
li°
 = &
rouã_m≠_ma°î
;

98 
m≠
->
√xt
 = 
NULL
;

99 
m≠
->
¥ev
 = 
li°
->
èû
;

100 i‡(
li°
->
èû
)

101 
li°
->
èû
->
√xt
 = 
m≠
;

103 
li°
->
hód
 = 
m≠
;

104 
li°
->
èû
 = 
m≠
;

107 i‡(
rouã_m≠_ma°î
.
add_hook
)

108 (*
rouã_m≠_ma°î
.
add_hook
Ë(
«me
);

110  
m≠
;

111 
	}
}

115 
	$rouã_m≠_dñëe
 (
rouã_m≠
 *
m≠
)

117 
rouã_m≠_li°
 *
li°
;

118 
rouã_m≠_ödex
 *
ödex
;

119 *
«me
;

121 (
ödex
 = 
m≠
->
hód
Ë!
NULL
)

122 
	`rouã_m≠_ödex_dñëe
 (
ödex
, 0);

124 
«me
 = 
m≠
->name;

126 
li°
 = &
rouã_m≠_ma°î
;

128 i‡(
m≠
->
√xt
)

129 
m≠
->
√xt
->
¥ev
 = map->prev;

131 
li°
->
èû
 = 
m≠
->
¥ev
;

133 i‡(
m≠
->
¥ev
)

134 
m≠
->
¥ev
->
√xt
 = map->next;

136 
li°
->
hód
 = 
m≠
->
√xt
;

138 
	`XFREE
 (
MTYPE_ROUTE_MAP
, 
m≠
);

141 i‡(
rouã_m≠_ma°î
.
dñëe_hook
)

142 (*
rouã_m≠_ma°î
.
dñëe_hook
Ë(
«me
);

144 i‡(
«me
)

145 
	`XFREE
 (
MTYPE_ROUTE_MAP_NAME
, 
«me
);

147 
	}
}

150 
rouã_m≠
 *

151 
	$rouã_m≠_lookup_by_«me
 (c⁄° *
«me
)

153 
rouã_m≠
 *
m≠
;

155 
m≠
 = 
rouã_m≠_ma°î
.
hód
; m≠; m≠ = m≠->
√xt
)

156 i‡(
	`°rcmp
 (
m≠
->
«me
,Çame) == 0)

157  
m≠
;

158  
NULL
;

159 
	}
}

163 
rouã_m≠
 *

164 
	$rouã_m≠_gë
 (c⁄° *
«me
)

166 
rouã_m≠
 *
m≠
;

168 
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (
«me
);

169 i‡(
m≠
 =
NULL
)

170 
m≠
 = 
	`rouã_m≠_add
 (
«me
);

171  
m≠
;

172 
	}
}

176 
	$rouã_m≠_ty≥_°r
 (
rouã_m≠_ty≥
 
ty≥
)

178 
ty≥
)

180 
RMAP_PERMIT
:

183 
RMAP_DENY
:

190 
	}
}

193 
	$rouã_m≠_em±y
 (
rouã_m≠
 *
m≠
)

195 i‡(
m≠
->
hód
 =
NULL
 && m≠->
èû
 == NULL)

199 
	}
}

203 
	$vty_show_rouã_m≠_íåy
 (
vty
 *vty, 
rouã_m≠
 *
m≠
)

205 
rouã_m≠_ödex
 *
ödex
;

206 
rouã_m≠_ruÀ
 *
ruÀ
;

209 i‡(
zlog_deÁu…
)

210 
	`vty_out
 (
vty
, "%s:%s", 
zlog_¥Ÿo_«mes
[
zlog_deÁu…
->
¥Ÿocﬁ
],

211 
VTY_NEWLINE
);

213 
ödex
 = 
m≠
->
hód
; index; index = index->
√xt
)

215 
	`vty_out
 (
vty
, "route-map %s, %s, sequence %d%s",

216 
m≠
->
«me
, 
	`rouã_m≠_ty≥_°r
 (
ödex
->
ty≥
),

217 
ödex
->
¥ef
, 
VTY_NEWLINE
);

220 i‡(
ödex
->
des¸ùti⁄
)

221 
	`vty_out
 (
vty
, " Des¸ùti⁄:%† %s%s", 
VTY_NEWLINE
,

222 
ödex
->
des¸ùti⁄
, 
VTY_NEWLINE
);

225 
	`vty_out
 (
vty
, " M©ch cœu£s:%s", 
VTY_NEWLINE
);

226 
ruÀ
 = 
ödex
->
m©ch_li°
.
hód
;ÑuÀ;ÑuÀ =ÑuÀ->
√xt
)

227 
	`vty_out
 (
vty
, " %s %s%s",

228 
ruÀ
->
cmd
->
°r
,ÑuÀ->
ruÀ_°r
, 
VTY_NEWLINE
);

230 
	`vty_out
 (
vty
, " Së cœu£s:%s", 
VTY_NEWLINE
);

231 
ruÀ
 = 
ödex
->
£t_li°
.
hód
;ÑuÀ;ÑuÀ =ÑuÀ->
√xt
)

232 
	`vty_out
 (
vty
, " %s %s%s",

233 
ruÀ
->
cmd
->
°r
,ÑuÀ->
ruÀ_°r
, 
VTY_NEWLINE
);

236 
	`vty_out
 (
vty
, " CÆ»˛au£:%s", 
VTY_NEWLINE
);

237 i‡(
ödex
->
√xåm
)

238 
	`vty_out
 (
vty
, " CÆ»%s%s", 
ödex
->
√xåm
, 
VTY_NEWLINE
);

241 
	`vty_out
 (
vty
, " A˘i⁄:%s", 
VTY_NEWLINE
);

242 i‡(
ödex
->
exôpﬁicy
 =
RMAP_GOTO
)

243 
	`vty_out
 (
vty
, " GŸÿ%d%s", 
ödex
->
√xçªf
, 
VTY_NEWLINE
);

244 i‡(
ödex
->
exôpﬁicy
 =
RMAP_NEXT
)

245 
	`vty_out
 (
vty
, " C⁄töuêtÿ√xàíåy%s", 
VTY_NEWLINE
);

246 i‡(
ödex
->
exôpﬁicy
 =
RMAP_EXIT
)

247 
	`vty_out
 (
vty
, " ExôÑouãm≠%s", 
VTY_NEWLINE
);

249 
	}
}

252 
	$vty_show_rouã_m≠
 (
vty
 *vty, c⁄° *
«me
)

254 
rouã_m≠
 *
m≠
;

256 i‡(
«me
)

258 
m≠
 = 
	`rouã_m≠_lookup_by_«me
 (
«me
);

260 i‡(
m≠
)

262 
	`vty_show_rouã_m≠_íåy
 (
vty
, 
m≠
);

263  
CMD_SUCCESS
;

267 
	`vty_out
 (
vty
, "%%rouã-m≠ %†nŸ found%s", 
«me
, 
VTY_NEWLINE
);

268  
CMD_WARNING
;

273 
m≠
 = 
rouã_m≠_ma°î
.
hód
; m≠; m≠ = m≠->
√xt
)

274 
	`vty_show_rouã_m≠_íåy
 (
vty
, 
m≠
);

276  
CMD_SUCCESS
;

277 
	}
}

282 
rouã_m≠_ödex
 *

283 
	$rouã_m≠_ödex_√w
 ()

285 
rouã_m≠_ödex
 *
√w
;

287 
√w
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_INDEX
,  (
rouã_m≠_ödex
));

288 
√w
->
exôpﬁicy
 = 
RMAP_EXIT
;

289  
√w
;

290 
	}
}

294 
	$rouã_m≠_ödex_dñëe
 (
rouã_m≠_ödex
 *
ödex
, 
nŸify
)

296 
rouã_m≠_ruÀ
 *
ruÀ
;

299 (
ruÀ
 = 
ödex
->
m©ch_li°
.
hód
Ë!
NULL
)

300 
	`rouã_m≠_ruÀ_dñëe
 (&
ödex
->
m©ch_li°
, 
ruÀ
);

303 (
ruÀ
 = 
ödex
->
£t_li°
.
hód
Ë!
NULL
)

304 
	`rouã_m≠_ruÀ_dñëe
 (&
ödex
->
£t_li°
, 
ruÀ
);

307 i‡(
ödex
->
√xt
)

308 
ödex
->
√xt
->
¥ev
 = index->prev;

310 
ödex
->
m≠
->
èû
 = index->
¥ev
;

312 i‡(
ödex
->
¥ev
)

313 
ödex
->
¥ev
->
√xt
 = index->next;

315 
ödex
->
m≠
->
hód
 = index->
√xt
;

318 i‡(
ödex
->
√xåm
)

319 
	`XFREE
 (
MTYPE_ROUTE_MAP_NAME
, 
ödex
->
√xåm
);

322 i‡(
rouã_m≠_ma°î
.
evít_hook
 && 
nŸify
)

323 (*
rouã_m≠_ma°î
.
evít_hook
Ë(
RMAP_EVENT_INDEX_DELETED
,

324 
ödex
->
m≠
->
«me
);

326 
	`XFREE
 (
MTYPE_ROUTE_MAP_INDEX
, 
ödex
);

327 
	}
}

330 
rouã_m≠_ödex
 *

331 
	$rouã_m≠_ödex_lookup
 (
rouã_m≠
 *
m≠
, 
rouã_m≠_ty≥
 
ty≥
,

332 
¥ef
)

334 
rouã_m≠_ödex
 *
ödex
;

336 
ödex
 = 
m≠
->
hód
; index; index = index->
√xt
)

337 i‡((
ödex
->
ty≥
 =ty≥ ||Åy≥ =
RMAP_ANY
)

338 && 
ödex
->
¥ef
 ==Öref)

339  
ödex
;

340  
NULL
;

341 
	}
}

344 
rouã_m≠_ödex
 *

345 
	$rouã_m≠_ödex_add
 (
rouã_m≠
 *
m≠
, 
rouã_m≠_ty≥
 
ty≥
,

346 
¥ef
)

348 
rouã_m≠_ödex
 *
ödex
;

349 
rouã_m≠_ödex
 *
poöt
;

352 
ödex
 = 
	`rouã_m≠_ödex_√w
 ();

353 
ödex
->
m≠
 = map;

354 
ödex
->
ty≥
 =Åype;

355 
ödex
->
¥ef
 =Öref;

358 
poöt
 = 
m≠
->
hód
;Öoöt;Öoöàpoöt->
√xt
)

359 i‡(
poöt
->
¥ef
 >=Öref)

362 i‡(
m≠
->
hód
 =
NULL
)

364 
m≠
->
hód
 = m≠->
èû
 = 
ödex
;

366 i‡(
poöt
 =
NULL
)

368 
ödex
->
¥ev
 = 
m≠
->
èû
;

369 
m≠
->
èû
->
√xt
 = 
ödex
;

370 
m≠
->
èû
 = 
ödex
;

372 i‡(
poöt
 =
m≠
->
hód
)

374 
ödex
->
√xt
 = 
m≠
->
hód
;

375 
m≠
->
hód
->
¥ev
 = 
ödex
;

376 
m≠
->
hód
 = 
ödex
;

380 
ödex
->
√xt
 = 
poöt
;

381 
ödex
->
¥ev
 = 
poöt
->prev;

382 i‡(
poöt
->
¥ev
)

383 
poöt
->
¥ev
->
√xt
 = 
ödex
;

384 
poöt
->
¥ev
 = 
ödex
;

388 i‡(
rouã_m≠_ma°î
.
evít_hook
)

389 (*
rouã_m≠_ma°î
.
evít_hook
Ë(
RMAP_EVENT_INDEX_ADDED
,

390 
m≠
->
«me
);

392  
ödex
;

393 
	}
}

396 
rouã_m≠_ödex
 *

397 
	$rouã_m≠_ödex_gë
 (
rouã_m≠
 *
m≠
, 
rouã_m≠_ty≥
 
ty≥
,

398 
¥ef
)

400 
rouã_m≠_ödex
 *
ödex
;

402 
ödex
 = 
	`rouã_m≠_ödex_lookup
 (
m≠
, 
RMAP_ANY
, 
¥ef
);

403 i‡(
ödex
 && index->
ty≥
 !=Åype)

406 
	`rouã_m≠_ödex_dñëe
 (
ödex
, 1);

407 
ödex
 = 
NULL
;

409 i‡(
ödex
 =
NULL
)

410 
ödex
 = 
	`rouã_m≠_ödex_add
 (
m≠
, 
ty≥
, 
¥ef
);

411  
ödex
;

412 
	}
}

415 
rouã_m≠_ruÀ
 *

416 
	$rouã_m≠_ruÀ_√w
 ()

418 
rouã_m≠_ruÀ
 *
√w
;

420 
√w
 = 
	`XCALLOC
 (
MTYPE_ROUTE_MAP_RULE
,  (
rouã_m≠_ruÀ
));

421  
√w
;

422 
	}
}

426 
	$rouã_m≠_ö°Æl_m©ch
 (
rouã_m≠_ruÀ_cmd
 *
cmd
)

428 
	`ve˘‹_£t
 (
rouã_m©ch_vec
, 
cmd
);

429 
	}
}

433 
	$rouã_m≠_ö°Æl_£t
 (
rouã_m≠_ruÀ_cmd
 *
cmd
)

435 
	`ve˘‹_£t
 (
rouã_£t_vec
, 
cmd
);

436 
	}
}

439 
rouã_m≠_ruÀ_cmd
 *

440 
	$rouã_m≠_lookup_m©ch
 (c⁄° *
«me
)

442 
i
;

443 
rouã_m≠_ruÀ_cmd
 *
ruÀ
;

445 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
rouã_m©ch_vec
); i++)

446 i‡((
ruÀ
 = 
	`ve˘‹_¶Ÿ
 (
rouã_m©ch_vec
, 
i
)Ë!
NULL
)

447 i‡(
	`°rcmp
 (
ruÀ
->
°r
, 
«me
) == 0)

448  
ruÀ
;

449  
NULL
;

450 
	}
}

453 
rouã_m≠_ruÀ_cmd
 *

454 
	$rouã_m≠_lookup_£t
 (c⁄° *
«me
)

456 
i
;

457 
rouã_m≠_ruÀ_cmd
 *
ruÀ
;

459 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
rouã_£t_vec
); i++)

460 i‡((
ruÀ
 = 
	`ve˘‹_¶Ÿ
 (
rouã_£t_vec
, 
i
)Ë!
NULL
)

461 i‡(
	`°rcmp
 (
ruÀ
->
°r
, 
«me
) == 0)

462  
ruÀ
;

463  
NULL
;

464 
	}
}

468 
	$rouã_m≠_ruÀ_add
 (
rouã_m≠_ruÀ_li°
 *
li°
,

469 
rouã_m≠_ruÀ
 *
ruÀ
)

471 
ruÀ
->
√xt
 = 
NULL
;

472 
ruÀ
->
¥ev
 = 
li°
->
èû
;

473 i‡(
li°
->
èû
)

474 
li°
->
èû
->
√xt
 = 
ruÀ
;

476 
li°
->
hód
 = 
ruÀ
;

477 
li°
->
èû
 = 
ruÀ
;

478 
	}
}

482 
	$rouã_m≠_ruÀ_dñëe
 (
rouã_m≠_ruÀ_li°
 *
li°
,

483 
rouã_m≠_ruÀ
 *
ruÀ
)

485 i‡(
ruÀ
->
cmd
->
func_‰ì
)

486 (*
ruÀ
->
cmd
->
func_‰ì
Ë‘uÀ->
vÆue
);

488 i‡(
ruÀ
->
ruÀ_°r
)

489 
	`XFREE
 (
MTYPE_ROUTE_MAP_RULE_STR
, 
ruÀ
->
ruÀ_°r
);

491 i‡(
ruÀ
->
√xt
)

492 
ruÀ
->
√xt
->
¥ev
 =Ñule->prev;

494 
li°
->
èû
 = 
ruÀ
->
¥ev
;

495 i‡(
ruÀ
->
¥ev
)

496 
ruÀ
->
¥ev
->
√xt
 =Ñule->next;

498 
li°
->
hód
 = 
ruÀ
->
√xt
;

500 
	`XFREE
 (
MTYPE_ROUTE_MAP_RULE
, 
ruÀ
);

501 
	}
}

505 
	$ruÀcmp
 (c⁄° *
d°
, c⁄° *
§c
)

507 i‡(
d°
 =
NULL
)

509 i‡(
§c
 =
NULL
)

516 i‡(
§c
 =
NULL
)

519  
	`°rcmp
 (
d°
, 
§c
);

522 
	}
}

526 
	$rouã_m≠_add_m©ch
 (
rouã_m≠_ödex
 *
ödex
, c⁄° *
m©ch_«me
,

527 c⁄° *
m©ch_¨g
)

529 
rouã_m≠_ruÀ
 *
ruÀ
;

530 
rouã_m≠_ruÀ
 *
√xt
;

531 
rouã_m≠_ruÀ_cmd
 *
cmd
;

532 *
compûe
;

533 
ª∂a˚d
 = 0;

536 
cmd
 = 
	`rouã_m≠_lookup_m©ch
 (
m©ch_«me
);

537 i‡(
cmd
 =
NULL
)

538  
RMAP_RULE_MISSING
;

541 i‡(
cmd
->
func_compûe
)

543 
compûe
(*
cmd
->
func_compûe
)(
m©ch_¨g
);

544 i‡(
compûe
 =
NULL
)

545  
RMAP_COMPILE_ERROR
;

548 
compûe
 = 
NULL
;

551 
ruÀ
 = 
ödex
->
m©ch_li°
.
hód
;ÑuÀ;ÑuÀ = 
√xt
)

553 
√xt
 = 
ruÀ
->next;

554 i‡(
ruÀ
->
cmd
 == cmd)

556 
	`rouã_m≠_ruÀ_dñëe
 (&
ödex
->
m©ch_li°
, 
ruÀ
);

557 
ª∂a˚d
 = 1;

562 
ruÀ
 = 
	`rouã_m≠_ruÀ_√w
 ();

563 
ruÀ
->
cmd
 = cmd;

564 
ruÀ
->
vÆue
 = 
compûe
;

565 i‡(
m©ch_¨g
)

566 
ruÀ
->
ruÀ_°r
 = 
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_RULE_STR
, 
m©ch_¨g
);

568 
ruÀ
->
ruÀ_°r
 = 
NULL
;

571 
	`rouã_m≠_ruÀ_add
 (&
ödex
->
m©ch_li°
, 
ruÀ
);

574 i‡(
rouã_m≠_ma°î
.
evít_hook
)

575 (*
rouã_m≠_ma°î
.
evít_hook
Ë(
ª∂a˚d
 ?

576 
RMAP_EVENT_MATCH_REPLACED
:

577 
RMAP_EVENT_MATCH_ADDED
,

578 
ödex
->
m≠
->
«me
);

581 
	}
}

585 
	$rouã_m≠_dñëe_m©ch
 (
rouã_m≠_ödex
 *
ödex
, c⁄° *
m©ch_«me
,

586 c⁄° *
m©ch_¨g
)

588 
rouã_m≠_ruÀ
 *
ruÀ
;

589 
rouã_m≠_ruÀ_cmd
 *
cmd
;

591 
cmd
 = 
	`rouã_m≠_lookup_m©ch
 (
m©ch_«me
);

592 i‡(
cmd
 =
NULL
)

595 
ruÀ
 = 
ödex
->
m©ch_li°
.
hód
;ÑuÀ;ÑuÀ =ÑuÀ->
√xt
)

596 i‡(
ruÀ
->
cmd
 == cmd &&

597 (
	`ruÀcmp
 (
ruÀ
->
ruÀ_°r
, 
m©ch_¨g
Ë=0 || m©ch_¨g =
NULL
))

599 
	`rouã_m≠_ruÀ_dñëe
 (&
ödex
->
m©ch_li°
, 
ruÀ
);

601 i‡(
rouã_m≠_ma°î
.
evít_hook
)

602 (*
rouã_m≠_ma°î
.
evít_hook
Ë(
RMAP_EVENT_MATCH_DELETED
,

603 
ödex
->
m≠
->
«me
);

608 
	}
}

612 
	$rouã_m≠_add_£t
 (
rouã_m≠_ödex
 *
ödex
, c⁄° *
£t_«me
,

613 c⁄° *
£t_¨g
)

615 
rouã_m≠_ruÀ
 *
ruÀ
;

616 
rouã_m≠_ruÀ
 *
√xt
;

617 
rouã_m≠_ruÀ_cmd
 *
cmd
;

618 *
compûe
;

619 
ª∂a˚d
 = 0;

621 
cmd
 = 
	`rouã_m≠_lookup_£t
 (
£t_«me
);

622 i‡(
cmd
 =
NULL
)

623  
RMAP_RULE_MISSING
;

626 i‡(
cmd
->
func_compûe
)

628 
compûe
(*
cmd
->
func_compûe
)(
£t_¨g
);

629 i‡(
compûe
 =
NULL
)

630  
RMAP_COMPILE_ERROR
;

633 
compûe
 = 
NULL
;

638 
ruÀ
 = 
ödex
->
£t_li°
.
hód
;ÑuÀ;ÑuÀ = 
√xt
)

640 
√xt
 = 
ruÀ
->next;

641 i‡(
ruÀ
->
cmd
 == cmd)

643 
	`rouã_m≠_ruÀ_dñëe
 (&
ödex
->
£t_li°
, 
ruÀ
);

644 
ª∂a˚d
 = 1;

649 
ruÀ
 = 
	`rouã_m≠_ruÀ_√w
 ();

650 
ruÀ
->
cmd
 = cmd;

651 
ruÀ
->
vÆue
 = 
compûe
;

652 i‡(
£t_¨g
)

653 
ruÀ
->
ruÀ_°r
 = 
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_RULE_STR
, 
£t_¨g
);

655 
ruÀ
->
ruÀ_°r
 = 
NULL
;

658 
	`rouã_m≠_ruÀ_add
 (&
ödex
->
£t_li°
, 
ruÀ
);

661 i‡(
rouã_m≠_ma°î
.
evít_hook
)

662 (*
rouã_m≠_ma°î
.
evít_hook
Ë(
ª∂a˚d
 ?

663 
RMAP_EVENT_SET_REPLACED
:

664 
RMAP_EVENT_SET_ADDED
,

665 
ödex
->
m≠
->
«me
);

667 
	}
}

671 
	$rouã_m≠_dñëe_£t
 (
rouã_m≠_ödex
 *
ödex
, c⁄° *
£t_«me
,

672 c⁄° *
£t_¨g
)

674 
rouã_m≠_ruÀ
 *
ruÀ
;

675 
rouã_m≠_ruÀ_cmd
 *
cmd
;

677 
cmd
 = 
	`rouã_m≠_lookup_£t
 (
£t_«me
);

678 i‡(
cmd
 =
NULL
)

681 
ruÀ
 = 
ödex
->
£t_li°
.
hód
;ÑuÀ;ÑuÀ =ÑuÀ->
√xt
)

682 i‡((
ruÀ
->
cmd
 == cmd) &&

683 (
	`ruÀcmp
 (
ruÀ
->
ruÀ_°r
, 
£t_¨g
Ë=0 || së_¨g =
NULL
))

685 
	`rouã_m≠_ruÀ_dñëe
 (&
ödex
->
£t_li°
, 
ruÀ
);

687 i‡(
rouã_m≠_ma°î
.
evít_hook
)

688 (*
rouã_m≠_ma°î
.
evít_hook
Ë(
RMAP_EVENT_SET_DELETED
,

689 
ödex
->
m≠
->
«me
);

694 
	}
}

742 
rouã_m≠_ªsu…_t


743 
	$rouã_m≠_≠∂y_m©ch
 (
rouã_m≠_ruÀ_li°
 *
m©ch_li°
,

744 
¥efix
 *¥efix, 
rouã_m≠_obje˘_t
 
ty≥
,

745 *
obje˘
)

747 
rouã_m≠_ªsu…_t
 
ªt
 = 
RMAP_NOMATCH
;

748 
rouã_m≠_ruÀ
 *
m©ch
;

753 i‡(!
m©ch_li°
->
hód
)

754 
ªt
 = 
RMAP_MATCH
;

757 
m©ch
 = 
m©ch_li°
->
hód
; m©ch; m©ch = m©ch->
√xt
)

763 
ªt
 = (*
m©ch
->
cmd
->
func_≠∂y
Ë(m©ch->
vÆue
, 
¥efix
,

764 
ty≥
, 
obje˘
);

765 i‡(
ªt
 !
RMAP_MATCH
)

766  
ªt
;

769  
ªt
;

770 
	}
}

773 
rouã_m≠_ªsu…_t


774 
	$rouã_m≠_≠∂y
 (
rouã_m≠
 *
m≠
, 
¥efix
 *prefix,

775 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

777 
ªcursi⁄
 = 0;

778 
ªt
 = 0;

779 
rouã_m≠_ödex
 *
ödex
;

780 
rouã_m≠_ruÀ
 *
£t
;

782 i‡(
ªcursi⁄
 > 
RMAP_RECURSION_LIMIT
)

784 
	`zlog
 (
NULL
, 
LOG_WARNING
,

786 
RMAP_RECURSION_LIMIT
);

787 
ªcursi⁄
 = 0;

788  
RMAP_DENYMATCH
;

791 i‡(
m≠
 =
NULL
)

792  
RMAP_DENYMATCH
;

794 
ödex
 = 
m≠
->
hód
; index; index = index->
√xt
)

797 
ªt
 = 
	`rouã_m≠_≠∂y_m©ch
 (&
ödex
->
m©ch_li°
, 
¥efix
, 
ty≥
, 
obje˘
);

800 i‡(
ªt
 =
RMAP_NOMATCH
)

803 i‡(
ªt
 =
RMAP_MATCH
)

805 i‡(
ödex
->
ty≥
 =
RMAP_PERMIT
)

809 
£t
 = 
ödex
->
£t_li°
.
hód
; së; së = së->
√xt
)

810 
ªt
 = (*
£t
->
cmd
->
func_≠∂y
Ë(£t->
vÆue
, 
¥efix
,

811 
ty≥
, 
obje˘
);

814 i‡(
ödex
->
√xåm
)

816 
rouã_m≠
 *
√xåm
 =

817 
	`rouã_m≠_lookup_by_«me
 (
ödex
->
√xåm
);

819 i‡(
√xåm
)

821 
ªcursi⁄
++;

822 
ªt
 = 
	`rouã_m≠_≠∂y
 (
√xåm
, 
¥efix
, 
ty≥
, 
obje˘
);

823 
ªcursi⁄
--;

827 i‡(
ªt
 =
RMAP_DENYMATCH
)

828  
ªt
;

831 
ödex
->
exôpﬁicy
)

833 
RMAP_EXIT
:

834  
ªt
;

835 
RMAP_NEXT
:

837 
RMAP_GOTO
:

840 
rouã_m≠_ödex
 *
√xt
 = 
ödex
->next;

841 
√xçªf
 = 
ödex
->nextpref;

843 
√xt
 &&Çext->
¥ef
 < 
√xçªf
)

845 
ödex
 = 
√xt
;

846 
√xt
 =Çext->next;

848 i‡(
√xt
 =
NULL
)

851  
ªt
;

856 i‡(
ödex
->
ty≥
 =
RMAP_DENY
)

859  
RMAP_DENYMATCH
;

864  
RMAP_DENYMATCH
;

865 
	}
}

868 
rouã_m≠_add_hook
 ((*
func
) (const *))

870 
rouã_m≠_ma°î
.
add_hook
 = 
func
;

871 
	}
}

874 
rouã_m≠_dñëe_hook
 ((*
func
) (const *))

876 
rouã_m≠_ma°î
.
dñëe_hook
 = 
func
;

877 
	}
}

880 
rouã_m≠_evít_hook
 ((*
func
Ë(
rouã_m≠_evít_t
, const *))

882 
rouã_m≠_ma°î
.
evít_hook
 = 
func
;

883 
	}
}

886 
	$rouã_m≠_öô
 ()

889 
rouã_m©ch_vec
 = 
	`ve˘‹_öô
 (1);

890 
rouã_£t_vec
 = 
	`ve˘‹_öô
 (1);

891 
	}
}

894 
	$rouã_m≠_föish
 ()

896 
	`ve˘‹_‰ì
 (
rouã_m©ch_vec
);

897 
rouã_m©ch_vec
 = 
NULL
;

898 
	`ve˘‹_‰ì
 (
rouã_£t_vec
);

899 
rouã_£t_vec
 = 
NULL
;

900 
	}
}

903 
DEFUN
 (
rouã_m≠
,

904 
rouã_m≠_cmd
,

912 
	g≥rmô
;

913 
	g¥ef
;

914 
rouã_m≠
 *
	gm≠
;

915 
rouã_m≠_ödex
 *
	gödex
;

916 *
	gíd±r
 = 
NULL
;

919 i‡(
°∫cmp
 (
¨gv
[1], "≥rmô", 
°æí
 (argv[1])) == 0)

920 
≥rmô
 = 
RMAP_PERMIT
;

921 i‡(
°∫cmp
 (
¨gv
[1], "díy", 
°æí
 (argv[1])) == 0)

922 
≥rmô
 = 
RMAP_DENY
;

925 
vty_out
 (
vty
, "thêthúd fõld mu° bê[≥rmô|díy]%s", 
VTY_NEWLINE
);

926  
	gCMD_WARNING
;

930 
	g¥ef
 = 
°πoul
 (
¨gv
[2], &
íd±r
, 10);

931 i‡(
	g¥ef
 =
ULONG_MAX
 || *
íd±r
 != '\0')

933 
vty_out
 (
vty
, "the fourth field must beÖositive integer%s",

934 
VTY_NEWLINE
);

935  
	gCMD_WARNING
;

937 i‡(
	g¥ef
 =0 || 
¥ef
 > 65535)

939 
vty_out
 (
vty
, "thêfouπh fõld mu° bê<1-65535>%s", 
VTY_NEWLINE
);

940  
	gCMD_WARNING
;

944 
	gm≠
 = 
rouã_m≠_gë
 (
¨gv
[0]);

945 
	gödex
 = 
rouã_m≠_ödex_gë
 (
m≠
, 
≥rmô
, 
¥ef
);

947 
	gvty
->
	gödex
 = 
ödex
;

948 
	gvty
->
	gnode
 = 
RMAP_NODE
;

949  
	gCMD_SUCCESS
;

952 
DEFUN
 (
no_rouã_m≠_Æl
,

953 
no_rouã_m≠_Æl_cmd
,

955 
NO_STR


959 
rouã_m≠
 *
	gm≠
;

961 
	gm≠
 = 
rouã_m≠_lookup_by_«me
 (
¨gv
[0]);

962 i‡(
	gm≠
 =
NULL
)

964 
vty_out
 (
vty
, "%% CouldÇot findÑoute-map %s%s",

965 
¨gv
[0], 
VTY_NEWLINE
);

966  
	gCMD_WARNING
;

969 
rouã_m≠_dñëe
 (
m≠
);

971  
	gCMD_SUCCESS
;

974 
DEFUN
 (
no_rouã_m≠
,

975 
no_rouã_m≠_cmd
,

977 
NO_STR


984 
	g≥rmô
;

985 
	g¥ef
;

986 
rouã_m≠
 *
	gm≠
;

987 
rouã_m≠_ödex
 *
	gödex
;

988 *
	gíd±r
 = 
NULL
;

991 i‡(
°∫cmp
 (
¨gv
[1], "≥rmô", 
°æí
 (argv[1])) == 0)

992 
≥rmô
 = 
RMAP_PERMIT
;

993 i‡(
°∫cmp
 (
¨gv
[1], "díy", 
°æí
 (argv[1])) == 0)

994 
≥rmô
 = 
RMAP_DENY
;

997 
vty_out
 (
vty
, "thêthúd fõld mu° bê[≥rmô|díy]%s", 
VTY_NEWLINE
);

998  
	gCMD_WARNING
;

1002 
	g¥ef
 = 
°πoul
 (
¨gv
[2], &
íd±r
, 10);

1003 i‡(
	g¥ef
 =
ULONG_MAX
 || *
íd±r
 != '\0')

1005 
vty_out
 (
vty
, "the fourth field must beÖositive integer%s",

1006 
VTY_NEWLINE
);

1007  
	gCMD_WARNING
;

1009 i‡(
	g¥ef
 =0 || 
¥ef
 > 65535)

1011 
vty_out
 (
vty
, "thêfouπh fõld mu° bê<1-65535>%s", 
VTY_NEWLINE
);

1012  
	gCMD_WARNING
;

1016 
	gm≠
 = 
rouã_m≠_lookup_by_«me
 (
¨gv
[0]);

1017 i‡(
	gm≠
 =
NULL
)

1019 
vty_out
 (
vty
, "%% CouldÇot findÑoute-map %s%s",

1020 
¨gv
[0], 
VTY_NEWLINE
);

1021  
	gCMD_WARNING
;

1025 
	gödex
 = 
rouã_m≠_ödex_lookup
 (
m≠
, 
≥rmô
, 
¥ef
);

1026 i‡(
	gödex
 =
NULL
)

1028 
vty_out
 (
vty
, "%% CouldÇot findÑoute-mapÉntry %s %s%s",

1029 
¨gv
[0],árgv[2], 
VTY_NEWLINE
);

1030  
	gCMD_WARNING
;

1034 
rouã_m≠_ödex_dñëe
 (
ödex
, 1);

1037 i‡(
rouã_m≠_em±y
 (
m≠
))

1038 
rouã_m≠_dñëe
 (
m≠
);

1040  
	gCMD_SUCCESS
;

1043 
DEFUN
 (
rm≠_⁄m©ch_√xt
,

1044 
rm≠_⁄m©ch_√xt_cmd
,

1049 
rouã_m≠_ödex
 *
	gödex
;

1051 
	gödex
 = 
vty
->
ödex
;

1053 i‡(
	gödex
)

1054 
	gödex
->
	gexôpﬁicy
 = 
RMAP_NEXT
;

1056  
	gCMD_SUCCESS
;

1059 
DEFUN
 (
no_rm≠_⁄m©ch_√xt
,

1060 
no_rm≠_⁄m©ch_√xt_cmd
,

1062 
NO_STR


1066 
rouã_m≠_ödex
 *
	gödex
;

1068 
	gödex
 = 
vty
->
ödex
;

1070 i‡(
	gödex
)

1071 
	gödex
->
	gexôpﬁicy
 = 
RMAP_EXIT
;

1073  
	gCMD_SUCCESS
;

1076 
DEFUN
 (
rm≠_⁄m©ch_gŸo
,

1077 
rm≠_⁄m©ch_gŸo_cmd
,

1083 
rouã_m≠_ödex
 *
	gödex
 = 
vty
->
ödex
;

1084 
	gd
 = 0;

1086 i‡(
	gödex
)

1088 i‡(
	g¨gc
 =1 && 
¨gv
[0])

1089 
VTY_GET_INTEGER_RANGE
("rouã-m≠ index", 
d
, 
¨gv
[0], 1, 65536);

1091 
	gd
 = 
ödex
->
¥ef
 + 1;

1093 i‡(
	gd
 <
ödex
->
¥ef
)

1096 
vty_out
 (
vty
, "can't jump backwards inÑoute-maps%s",

1097 
VTY_NEWLINE
);

1098  
	gCMD_WARNING
;

1102 
	gödex
->
	gexôpﬁicy
 = 
RMAP_GOTO
;

1103 
	gödex
->
	g√xçªf
 = 
d
;

1106  
	gCMD_SUCCESS
;

1109 
DEFUN
 (
no_rm≠_⁄m©ch_gŸo
,

1110 
no_rm≠_⁄m©ch_gŸo_cmd
,

1112 
NO_STR


1116 
rouã_m≠_ödex
 *
	gödex
;

1118 
	gödex
 = 
vty
->
ödex
;

1120 i‡(
	gödex
)

1121 
	gödex
->
	gexôpﬁicy
 = 
RMAP_EXIT
;

1123  
	gCMD_SUCCESS
;

1127 
ALIAS
 (
rm≠_⁄m©ch_gŸo
,

1128 
rm≠_c⁄töue_cmd
,

1132 
ALIAS
 (
no_rm≠_⁄m©ch_gŸo
,

1133 
no_rm≠_c⁄töue_cmd
,

1135 
NO_STR


1139 
ALIAS
 (
rm≠_⁄m©ch_gŸo
,

1140 
rm≠_c⁄töue_£q_cmd
,

1145 
ALIAS
 (
no_rm≠_⁄m©ch_gŸo
,

1146 
no_rm≠_c⁄töue_£q
,

1148 
NO_STR


1152 
DEFUN
 (
rm≠_show_«me
,

1153 
rm≠_show_«me_cmd
,

1155 
SHOW_STR


1159 c⁄° *
	g«me
 = 
NULL
;

1160 i‡(
	g¨gc
)

1161 
	g«me
 = 
¨gv
[0];

1162  
vty_show_rouã_m≠
 (
vty
, 
«me
);

1165 
ALIAS
 (
rm≠_⁄m©ch_gŸo
,

1166 
rm≠_c⁄töue_ödex_cmd
,

1171 
DEFUN
 (
rm≠_ˇŒ
,

1172 
rm≠_ˇŒ_cmd
,

1177 
rouã_m≠_ödex
 *
	gödex
;

1179 
	gödex
 = 
vty
->
ödex
;

1180 i‡(
	gödex
)

1182 i‡(
	gödex
->
	g√xåm
)

1183 
XFREE
 (
MTYPE_ROUTE_MAP_NAME
, 
ödex
->
√xåm
);

1184 
	gödex
->
	g√xåm
 = 
XSTRDUP
 (
MTYPE_ROUTE_MAP_NAME
, 
¨gv
[0]);

1186  
	gCMD_SUCCESS
;

1189 
DEFUN
 (
no_rm≠_ˇŒ
,

1190 
no_rm≠_ˇŒ_cmd
,

1192 
NO_STR


1195 
rouã_m≠_ödex
 *
	gödex
;

1197 
	gödex
 = 
vty
->
ödex
;

1199 i‡(
	gödex
->
	g√xåm
)

1201 
XFREE
 (
MTYPE_ROUTE_MAP_NAME
, 
ödex
->
√xåm
);

1202 
	gödex
->
	g√xåm
 = 
NULL
;

1205  
	gCMD_SUCCESS
;

1208 
DEFUN
 (
rm≠_des¸ùti⁄
,

1209 
rm≠_des¸ùti⁄_cmd
,

1214 
rouã_m≠_ödex
 *
	gödex
;

1216 
	gödex
 = 
vty
->
ödex
;

1217 i‡(
	gödex
)

1219 i‡(
	gödex
->
	gdes¸ùti⁄
)

1220 
XFREE
 (
MTYPE_TMP
, 
ödex
->
des¸ùti⁄
);

1221 
	gödex
->
	gdes¸ùti⁄
 = 
¨gv_c⁄ˇt
 (
¨gv
, 
¨gc
, 0);

1223  
	gCMD_SUCCESS
;

1226 
DEFUN
 (
no_rm≠_des¸ùti⁄
,

1227 
no_rm≠_des¸ùti⁄_cmd
,

1229 
NO_STR


1232 
rouã_m≠_ödex
 *
	gödex
;

1234 
	gödex
 = 
vty
->
ödex
;

1235 i‡(
	gödex
)

1237 i‡(
	gödex
->
	gdes¸ùti⁄
)

1238 
XFREE
 (
MTYPE_TMP
, 
ödex
->
des¸ùti⁄
);

1239 
	gödex
->
	gdes¸ùti⁄
 = 
NULL
;

1241  
	gCMD_SUCCESS
;

1246 
	$rouã_m≠_c⁄fig_wrôe
 (
vty
 *vty)

1248 
rouã_m≠
 *
m≠
;

1249 
rouã_m≠_ödex
 *
ödex
;

1250 
rouã_m≠_ruÀ
 *
ruÀ
;

1251 
fú°
 = 1;

1252 
wrôe
 = 0;

1254 
m≠
 = 
rouã_m≠_ma°î
.
hód
; m≠; m≠ = m≠->
√xt
)

1255 
ödex
 = 
m≠
->
hód
; index; index = index->
√xt
)

1257 i‡(!
fú°
)

1258 
	`vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

1260 
fú°
 = 0;

1262 
	`vty_out
 (
vty
, "route-map %s %s %d%s",

1263 
m≠
->
«me
,

1264 
	`rouã_m≠_ty≥_°r
 (
ödex
->
ty≥
),

1265 
ödex
->
¥ef
, 
VTY_NEWLINE
);

1267 i‡(
ödex
->
des¸ùti⁄
)

1268 
	`vty_out
 (
vty
, " des¸ùti⁄ %s%s", 
ödex
->
des¸ùti⁄
, 
VTY_NEWLINE
);

1270 
ruÀ
 = 
ödex
->
m©ch_li°
.
hód
;ÑuÀ;ÑuÀ =ÑuÀ->
√xt
)

1271 
	`vty_out
 (
vty
, " m©ch %†%s%s", 
ruÀ
->
cmd
->
°r
,

1272 
ruÀ
->
ruÀ_°r
 ?Ñule->rule_str : "",

1273 
VTY_NEWLINE
);

1275 
ruÀ
 = 
ödex
->
£t_li°
.
hód
;ÑuÀ;ÑuÀ =ÑuÀ->
√xt
)

1276 
	`vty_out
 (
vty
, " së %†%s%s", 
ruÀ
->
cmd
->
°r
,

1277 
ruÀ
->
ruÀ_°r
 ?Ñule->rule_str : "",

1278 
VTY_NEWLINE
);

1279 i‡(
ödex
->
√xåm
)

1280 
	`vty_out
 (
vty
, " cÆ»%s%s", 
ödex
->
√xåm
, 
VTY_NEWLINE
);

1281 i‡(
ödex
->
exôpﬁicy
 =
RMAP_GOTO
)

1282 
	`vty_out
 (
vty
, " on-m©ch gŸÿ%d%s", 
ödex
->
√xçªf
, 
VTY_NEWLINE
);

1283 i‡(
ödex
->
exôpﬁicy
 =
RMAP_NEXT
)

1284 
	`vty_out
 (
vty
," on-m©chÇext%s", 
VTY_NEWLINE
);

1286 
wrôe
++;

1288  
wrôe
;

1289 
	}
}

1292 
cmd_node
 
	grm≠_node
 =

1294 
RMAP_NODE
,

1301 
	$rouã_m≠_öô_vty
 ()

1304 
	`ö°Æl_node
 (&
rm≠_node
, 
rouã_m≠_c⁄fig_wrôe
);

1307 
	`ö°Æl_deÁu…
 (
RMAP_NODE
);

1308 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouã_m≠_cmd
);

1309 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_rouã_m≠_cmd
);

1310 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_rouã_m≠_Æl_cmd
);

1313 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
rouã_m≠_cmd
);

1314 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
rm≠_⁄m©ch_√xt_cmd
);

1315 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_rm≠_⁄m©ch_√xt_cmd
);

1316 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
rm≠_⁄m©ch_gŸo_cmd
);

1317 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_rm≠_⁄m©ch_gŸo_cmd
);

1320 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
rm≠_c⁄töue_cmd
);

1321 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_rm≠_c⁄töue_cmd
);

1322 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
rm≠_c⁄töue_ödex_cmd
);

1325 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
rm≠_ˇŒ_cmd
);

1326 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_rm≠_ˇŒ_cmd
);

1329 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
rm≠_des¸ùti⁄_cmd
);

1330 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_rm≠_des¸ùti⁄_cmd
);

1333 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
rm≠_show_«me_cmd
);

1334 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/routemap.h

22 #i‚de‡
_ZEBRA_ROUTEMAP_H


23 
	#_ZEBRA_ROUTEMAP_H


	)

26 
	erouã_m≠_ty≥


28 
	mRMAP_PERMIT
,

29 
	mRMAP_DENY
,

30 
	mRMAP_ANY


35 
	mRMAP_MATCH
,

36 
	mRMAP_DENYMATCH
,

37 
	mRMAP_NOMATCH
,

38 
	mRMAP_ERROR
,

39 
	mRMAP_OKAY


40 } 
	trouã_m≠_ªsu…_t
;

44 
	mRMAP_RIP
,

45 
	mRMAP_RIPNG
,

46 
	mRMAP_BABEL
,

47 
	mRMAP_OSPF
,

48 
	mRMAP_OSPF6
,

49 
	mRMAP_BGP
,

50 
	mRMAP_ZEBRA


51 } 
	trouã_m≠_obje˘_t
;

55 
	mRMAP_EXIT
,

56 
	mRMAP_GOTO
,

57 
	mRMAP_NEXT


58 } 
	trouã_m≠_íd_t
;

62 
	mRMAP_EVENT_SET_ADDED
,

63 
	mRMAP_EVENT_SET_DELETED
,

64 
	mRMAP_EVENT_SET_REPLACED
,

65 
	mRMAP_EVENT_MATCH_ADDED
,

66 
	mRMAP_EVENT_MATCH_DELETED
,

67 
	mRMAP_EVENT_MATCH_REPLACED
,

68 
	mRMAP_EVENT_INDEX_ADDED
,

69 
	mRMAP_EVENT_INDEX_DELETED


70 } 
	trouã_m≠_evít_t
;

73 
	#RMAP_RECURSION_LIMIT
 10

	)

76 
	srouã_m≠_ruÀ_cmd


79 c⁄° *
	m°r
;

82 
rouã_m≠_ªsu…_t
 (*
func_≠∂y
)(*, 
	m¥efix
 *,

83 
	mrouã_m≠_obje˘_t
, *);

86 *(*
	mfunc_compûe
)(const *);

89 (*
	mfunc_‰ì
)(*);

96 
	mRMAP_RULE_MISSING
 = 1,

99 
	mRMAP_COMPILE_ERROR


103 
	srouã_m≠_ruÀ_li°


105 
rouã_m≠_ruÀ
 *
	mhód
;

106 
rouã_m≠_ruÀ
 *
	mèû
;

110 
	srouã_m≠_ödex


112 
rouã_m≠
 *
	mm≠
;

113 *
	mdes¸ùti⁄
;

116 
	m¥ef
;

119 
rouã_m≠_ty≥
 
	mty≥
;

122 
rouã_m≠_íd_t
 
	mexôpﬁicy
;

125 
	m√xçªf
;

128 *
	m√xåm
;

131 
rouã_m≠_ruÀ_li°
 
	mm©ch_li°
;

132 
rouã_m≠_ruÀ_li°
 
	m£t_li°
;

135 
rouã_m≠_ödex
 *
	m√xt
;

136 
rouã_m≠_ödex
 *
	m¥ev
;

140 
	srouã_m≠


143 *
	m«me
;

146 
rouã_m≠_ödex
 *
	mhód
;

147 
rouã_m≠_ödex
 *
	mèû
;

150 
rouã_m≠
 *
	m√xt
;

151 
rouã_m≠
 *
	m¥ev
;

155 
rouã_m≠_öô
 ();

156 
rouã_m≠_öô_vty
 ();

157 
rouã_m≠_föish
 ();

160 
rouã_m≠_add_m©ch
 (
rouã_m≠_ödex
 *
ödex
,

161 c⁄° *
m©ch_«me
,

162 c⁄° *
m©ch_¨g
);

165 
rouã_m≠_dñëe_m©ch
 (
rouã_m≠_ödex
 *
ödex
,

166 c⁄° *
m©ch_«me
,

167 c⁄° *
m©ch_¨g
);

170 
rouã_m≠_add_£t
 (
rouã_m≠_ödex
 *
ödex
,

171 c⁄° *
£t_«me
,

172 c⁄° *
£t_¨g
);

175 
rouã_m≠_dñëe_£t
 (
rouã_m≠_ödex
 *
ödex
,

176 c⁄° *
£t_«me
,

177 c⁄° *
£t_¨g
);

180 
rouã_m≠_ö°Æl_m©ch
 (
rouã_m≠_ruÀ_cmd
 *
cmd
);

183 
rouã_m≠_ö°Æl_£t
 (
rouã_m≠_ruÀ_cmd
 *
cmd
);

186 
rouã_m≠
 * 
rouã_m≠_lookup_by_«me
 (c⁄° *
«me
);

189 
rouã_m≠_ªsu…_t
 
rouã_m≠_≠∂y
 (
rouã_m≠
 *
m≠
,

190 
¥efix
 *,

191 
rouã_m≠_obje˘_t
 
obje˘_ty≥
,

192 *
obje˘
);

194 
rouã_m≠_add_hook
 ((*
func
) (const *));

195 
	`rouã_m≠_dñëe_hook
 ((*
func
) (const *));

196 
	`rouã_m≠_evít_hook
 ((*
func
Ë(
rouã_m≠_evít_t
, const *));

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sigevent.c

22 
	~<zebø.h
>

23 
	~<sigevít.h
>

24 
	~<log.h
>

25 
	~<mem‹y.h
>

27 #ifde‡
SA_SIGINFO


28 #ifde‡
HAVE_UCONTEXT_H


29 #ifde‡
GNU_LINUX


31 #i‚de‡
__USE_GNU


32 
	#__USE_GNU


	)

35 
	~<uc⁄ãxt.h
>

41 
	squagga_sigevít_ma°î_t


43 
thªad
 *
	mt
;

45 
quagga_sig«l_t
 *
	msig«ls
;

46 
	msigc
;

48 vﬁ©ûê
sig_©omic_t
 
	mˇught
;

49 } 
	gsigma°î
;

55 
	$quagga_sig«l_h™dÀr
 (
signo
)

57 
i
;

58 
quagga_sig«l_t
 *
sig
;

60 
i
 = 0; i < 
sigma°î
.
sigc
; i++)

62 
sig
 = &(
sigma°î
.
sig«ls
[
i
]);

64 i‡(
sig
->
sig«l
 =
signo
)

65 
sig
->
ˇught
 = 1;

68 
sigma°î
.
ˇught
 = 1;

69 
	}
}

73 
	$quagga_sigevít_¥o˚ss
 ()

75 
quagga_sig«l_t
 *
sig
;

76 
i
;

77 #ifde‡
SIGEVENT_BLOCK_SIGNALS


79 
sig£t_t
 
√wmask
, 
ﬁdmask
;

86 
	`sigfûl£t
 (&
√wmask
);

87 
	`sigdñ£t
 (&
√wmask
, 
SIGTRAP
);

88 
	`sigdñ£t
 (&
√wmask
, 
SIGKILL
);

90 i‡–(
	`sig¥ocmask
 (
SIG_BLOCK
, &
√wmask
, &
ﬁdmask
)) < 0)

92 
	`zlog_îr
 ("quagga_signal_timer: couldnt block signals!");

97 i‡(
sigma°î
.
ˇught
 > 0)

99 
sigma°î
.
ˇught
 = 0;

104 
i
 = 0; i < 
sigma°î
.
sigc
; i++)

106 
sig
 = &(
sigma°î
.
sig«ls
[
i
]);

108 i‡(
sig
->
ˇught
 > 0)

110 
sig
->
ˇught
 = 0;

111 
sig
->
	`h™dÀr
 ();

116 #ifde‡
SIGEVENT_BLOCK_SIGNALS


117 i‡–
	`sig¥ocmask
 (
SIG_UNBLOCK
, &
ﬁdmask
, 
NULL
) < 0 );

122 
	}
}

124 #ifde‡
SIGEVENT_SCHEDULE_THREAD


127 
	$quagga_sig«l_timî
 (
thªad
 *
t
)

129 
quagga_sigevít_ma°î_t
 *
sigm
;

130 
quagga_sig«l_t
 *
sig
;

131 
i
;

133 
sigm
 = 
	`THREAD_ARG
 (
t
);

134 
sigm
->
t
 = 
	`thªad_add_timî
 (sigm->t->
ma°î
, 
quagga_sig«l_timî
, &
sigma°î
,

135 
QUAGGA_SIGNAL_TIMER_INTERVAL
);

136  
	`quagga_sigevít_¥o˚ss
 ();

137 
	}
}

143 
	$sig«l_£t
 (
signo
)

145 
ªt
;

146 
siga˘i⁄
 
sig
;

147 
siga˘i⁄
 
osig
;

149 
sig
.
ß_h™dÀr
 = &
quagga_sig«l_h™dÀr
;

150 
	`sigfûl£t
 (&
sig
.
ß_mask
);

151 
sig
.
ß_Êags
 = 0;

152 i‡(
signo
 =
SIGALRM
) {

153 #ifde‡
SA_INTERRUPT


154 
sig
.
ß_Êags
 |
SA_INTERRUPT
;

157 #ifde‡
SA_RESTART


158 
sig
.
ß_Êags
 |
SA_RESTART
;

162 
ªt
 = 
	`siga˘i⁄
 (
signo
, &
sig
, &
osig
);

163 i‡(
ªt
 < 0)

164  
ªt
;

167 
	}
}

169 #ifde‡
SA_SIGINFO


174 
	$¥ogøm_cou¡î
(*
c⁄ãxt
)

176 #ifde‡
HAVE_UCONTEXT_H


177 #ifde‡
GNU_LINUX


178 #ifde‡
REG_EIP


179 i‡(
c⁄ãxt
)

180  (*)(((
uc⁄ãxt_t
 *)
c⁄ãxt
)->
uc_mc⁄ãxt
.
gªgs
[
REG_EIP
]);

184  
NULL
;

185 
	}
}

189 
__©åibuã__
 ((
n‹ëu∫
))

190 
exô_h™dÀr
(
signo


191 #ifde‡
SA_SIGINFO


192 , 
sigöfo_t
 *
sigöfo
, *
c⁄ãxt


196 
zlog_sig«l
(
signo
, "exiting..."

197 #ifde‡
SA_SIGINFO


198 , 
sigöfo
, 
¥ogøm_cou¡î
(
c⁄ãxt
)

201 
_exô
(128+
signo
);

204 
__©åibuã__
 ((
n‹ëu∫
))

205 
c‹e_h™dÀr
(
signo


206 #ifde‡
SA_SIGINFO


207 , 
sigöfo_t
 *
sigöfo
, *
c⁄ãxt


211 
zlog_sig«l
(
signo
, "aborting..."

212 #ifde‡
SA_SIGINFO


213 , 
sigöfo
, 
¥ogøm_cou¡î
(
c⁄ãxt
)

216 
ab‹t
();

220 
	$å≠_deÁu…_sig«ls
()

222 c⁄° 
c‹e_sig«ls
[] = {

223 
SIGQUIT
,

224 
SIGILL
,

225 #ifde‡
SIGEMT


226 
SIGEMT
,

228 
SIGFPE
,

229 
SIGBUS
,

230 
SIGSEGV
,

231 #ifde‡
SIGSYS


232 
SIGSYS
,

234 #ifde‡
SIGXCPU


235 
SIGXCPU
,

237 #ifde‡
SIGXFSZ


238 
SIGXFSZ
,

241 c⁄° 
exô_sig«ls
[] = {

242 
SIGHUP
,

243 
SIGINT
,

244 
SIGALRM
,

245 
SIGTERM
,

246 
SIGUSR1
,

247 
SIGUSR2
,

248 #ifde‡
SIGPOLL


249 
SIGPOLL
,

251 #ifde‡
SIGVTALRM


252 
SIGVTALRM
,

254 #ifde‡
SIGSTKFLT


255 
SIGSTKFLT
,

258 c⁄° 
ign‹e_sig«ls
[] = {

259 
SIGPIPE
,

262 c⁄° *
sigs
;

263 
u_öt
 
nsigs
;

264 (*
h™dÀr
)(
signo


265 #ifde‡
SA_SIGINFO


266 , 
sigöfo_t
 *
öfo
, *
c⁄ãxt


269 } 
sigm≠
[] = {

270 { 
c‹e_sig«ls
, 
	`¨øy_size
(c‹e_sig«ls), 
c‹e_h™dÀr
},

271 { 
exô_sig«ls
, 
	`¨øy_size
”xô_sig«ls), 
exô_h™dÀr
},

272 { 
ign‹e_sig«ls
, 
	`¨øy_size
(ign‹e_sig«ls), 
NULL
},

274 
u_öt
 
i
;

276 
i
 = 0; i < 
	`¨øy_size
(
sigm≠
); i++)

278 
u_öt
 
j
;

280 
j
 = 0; j < 
sigm≠
[
i
].
nsigs
; j++)

282 
siga˘i⁄
 
ﬂ˘
;

283 i‡((
	`siga˘i⁄
(
sigm≠
[
i
].
sigs
[
j
],
NULL
,&
ﬂ˘
) == 0) &&

284 (
ﬂ˘
.
ß_h™dÀr
 =
SIG_DFL
))

286 
siga˘i⁄
 
a˘
;

287 
	`sigfûl£t
 (&
a˘
.
ß_mask
);

288 i‡(
sigm≠
[
i
].
h™dÀr
 =
NULL
)

290 
a˘
.
ß_h™dÀr
 = 
SIG_IGN
;

291 
a˘
.
ß_Êags
 = 0;

295 #ifde‡
SA_SIGINFO


297 
a˘
.
ß_siga˘i⁄
 = 
sigm≠
[
i
].
h™dÀr
;

298 
a˘
.
ß_Êags
 = 
SA_SIGINFO
;

300 
a˘
.
ß_h™dÀr
 = 
sigm≠
[
i
].
h™dÀr
;

301 
a˘
.
ß_Êags
 = 0;

304 i‡(
	`siga˘i⁄
(
sigm≠
[
i
].
sigs
[
j
],&
a˘
,
NULL
) < 0)

305 
	`zlog_w¨n
("UnableÅo set signal handler for signal %d: %s",

306 
sigm≠
[
i
].
sigs
[
j
],
	`ß„_°ªº‹
(
î∫o
));

311 
	}
}

314 
	$sig«l_öô
 (
thªad_ma°î
 *
m
, 
sigc
,

315 
quagga_sig«l_t
 
sig«ls
[])

318 
i
 = 0;

319 
quagga_sig«l_t
 *
sig
;

323 
	`å≠_deÁu…_sig«ls
();

325 
i
 < 
sigc
)

327 
sig
 = &
sig«ls
[
i
];

328 i‡–
	`sig«l_£t
 (
sig
->
sig«l
) < 0 )

329 
	`exô
 (-1);

330 
i
++;

333 
sigma°î
.
sigc
 = sigc;

334 
sigma°î
.
sig«ls
 = signals;

336 #ifde‡
SIGEVENT_SCHEDULE_THREAD


337 
sigma°î
.
t
 =

338 
	`thªad_add_timî
 (
m
, 
quagga_sig«l_timî
, &
sigma°î
,

339 
QUAGGA_SIGNAL_TIMER_INTERVAL
);

341 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sigevent.h

24 #i‚de‡
_QUAGGA_SIGNAL_H


25 
	#_QUAGGA_SIGNAL_H


	)

27 
	~<thªad.h
>

29 
	#QUAGGA_SIGNAL_TIMER_INTERVAL
 2L

	)

31 
	squagga_sig«l_t


33 
	msig«l
;

34 (*
	mh™dÀr
) ();

36 vﬁ©ûê
sig_©omic_t
 
	mˇught
;

46 
sig«l_öô
 (
thªad_ma°î
 *
m
, 
sigc
,

47 
quagga_sig«l_t
 *
sig«ls
);

50 
quagga_sigevít_¥o˚ss
 ();

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/smux.c

22 
	~<zebø.h
>

24 #i‡
deföed
 
HAVE_SNMP
 && deföed 
SNMP_SMUX


25 
	~<√t-¢mp/√t-¢mp-c⁄fig.h
>

26 
	~<√t-¢mp/√t-¢mp-ö˛udes.h
>

28 
	~"log.h
"

29 
	~"thªad.h
"

30 
	~"lökli°.h
"

31 
	~"comm™d.h
"

32 
	~<lib/vîsi⁄.h
>

33 
	~"mem‹y.h
"

34 
	~"sockuni⁄.h
"

35 
	~"smux.h
"

37 
	#SMUX_PORT_DEFAULT
 199

	)

39 
	#SMUXMAXPKTSIZE
 1500

	)

40 
	#SMUXMAXSTRLEN
 256

	)

42 
	#SMUX_OPEN
 (
ASN_APPLICATION
 | 
ASN_CONSTRUCTOR
 | 0)

	)

43 
	#SMUX_CLOSE
 (
ASN_APPLICATION
 | 
ASN_PRIMITIVE
 | 1)

	)

44 
	#SMUX_RREQ
 (
ASN_APPLICATION
 | 
ASN_CONSTRUCTOR
 | 2)

	)

45 
	#SMUX_RRSP
 (
ASN_APPLICATION
 | 
ASN_PRIMITIVE
 | 3)

	)

46 
	#SMUX_SOUT
 (
ASN_APPLICATION
 | 
ASN_PRIMITIVE
 | 4)

	)

48 
	#SMUX_GET
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0)

	)

49 
	#SMUX_GETNEXT
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 1)

	)

50 
	#SMUX_GETRSP
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 2)

	)

51 
	#SMUX_SET
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 3)

	)

52 
	#SMUX_TRAP
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 4)

	)

54 
	#SMUX_MAX_FAILURE
 3

	)

57 
	ssubåì


60 
oid
 
	m«me
[
MAX_OID_LEN
];

61 
u_ch¨
 
	m«me_Àn
;

64 
v¨übÀ
 *
	mv¨übÀs
;

67 
	mv¨übÀs_num
;

70 
	mv¨übÀs_width
;

73 
	mªgi°îed
;

76 
	#mö
(
A
,
B
Ë((AË< (BË? (AË: (B))

	)

78 
	esmux_evít
 {
	mSMUX_SCHEDULE
, 
	mSMUX_CONNECT
, 
	mSMUX_READ
};

80 
smux_evít
 (smux_event, );

84 
	gsmux_sock
 = -1;

87 
li°
 *
	gåìli°
;

90 
oid
 *
	gsmux_oid
 = 
NULL
;

91 
size_t
 
	gsmux_oid_Àn
;

94 *
	gsmux_∑sswd
 = 
NULL
;

97 
thªad
 *
	gsmux_ªad_thªad
;

100 
thªad
 *
	gsmux_c⁄√˘_thªad
;

103 
	gdebug_smux
 = 0;

106 
	gÁû
 = 0;

109 
cmd_node
 
	gsmux_node
 =

111 
SMUX_NODE
,

116 
thªad_ma°î
 *
	gma°î
;

119 
	$oid_com∑ª_∑π
 (
oid
 *
o1
, 
o1_Àn
, oid *
o2
, 
o2_Àn
)

121 
i
;

123 
i
 = 0; i < 
	`mö
 (
o1_Àn
, 
o2_Àn
); i++)

125 i‡(
o1
[
i
] < 
o2
[i])

127 i‡(
o1
[
i
] > 
o2
[i])

130 i‡(
o1_Àn
 < 
o2_Àn
)

134 
	}
}

137 
	$smux_oid_dump
 (c⁄° *
¥efix
, c⁄° 
oid
 *oid, 
size_t
 
oid_Àn
)

139 
i
;

140 
fú°
 = 1;

141 
buf
[
MAX_OID_LEN
 * 3];

143 
buf
[0] = '\0';

145 
i
 = 0; i < 
oid_Àn
; i++)

147 
	`•rötf
 (
buf
 + 
	`°æí
 (buf), "%s%d", 
fú°
 ? "" : ".", (Ë
oid
[
i
]);

148 
fú°
 = 0;

150 
	`zlog_debug
 ("%s: %s", 
¥efix
, 
buf
);

151 
	}
}

154 
	$smux_sockë
 ()

156 
ªt
;

157 #ifde‡
HAVE_IPV6


158 
addröfo
 
höts
, *
ªs0
, *
ªs
;

159 
gai
;

161 
sockaddr_ö
 
£rv
;

162 
£rvít
 *
•
;

164 
sock
 = 0;

166 #ifde‡
HAVE_IPV6


167 
	`mem£t
(&
höts
, 0, (hints));

168 
höts
.
ai_Ámûy
 = 
PF_UNSPEC
;

169 
höts
.
ai_sockty≥
 = 
SOCK_STREAM
;

170 
gai
 = 
	`gëaddröfo
(
NULL
, "smux", &
höts
, &
ªs0
);

171 i‡(
gai
 =
EAI_SERVICE
)

173 
£rvbuf
[
NI_MAXSERV
];

174 
	`•rötf
(
£rvbuf
,"%d",
SMUX_PORT_DEFAULT
);

175 
£rvbuf
[ (servbuf) - 1] = '\0';

176 
gai
 = 
	`gëaddröfo
(
NULL
, 
£rvbuf
, &
höts
, &
ªs0
);

178 i‡(
gai
)

180 
	`zlog_w¨n
("CannotÜocateÜoopback service smux");

183 
ªs
=
ªs0
;Ñes;ÑesÙes->
ai_√xt
)

185 i‡(
ªs
->
ai_Ámûy
 !
AF_INET


186 #ifde‡
HAVE_IPV6


187 && 
ªs
->
ai_Ámûy
 !
AF_INET6


192 
sock
 = 
	`sockë
(
ªs
->
ai_Ámûy
,Ñes->
ai_sockty≥
,Ñes->
ai_¥Ÿocﬁ
);

193 i‡(
sock
 < 0)

195 
	`sock›t_ªu£addr
 (
sock
);

196 
	`sock›t_ªu£p‹t
 (
sock
);

197 
ªt
 = 
	`c⁄√˘
 (
sock
, 
ªs
->
ai_addr
,Ñes->
ai_addæí
);

198 i‡(
ªt
 < 0)

200 
	`˛o£
(
sock
);

201 
sock
 = -1;

206 
	`‰ìaddröfo
(
ªs0
);

207 i‡(
sock
 < 0)

208 
	`zlog_w¨n
 ("Can't connectÅo SNMPágent with SMUX");

210 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_STREAM
, 0);

211 i‡(
sock
 < 0)

213 
	`zlog_w¨n
 ("Can't make socket for SNMP");

217 
	`mem£t
 (&
£rv
, 0,  (
sockaddr_ö
));

218 
£rv
.
sö_Ámûy
 = 
AF_INET
;

219 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


220 
£rv
.
sö_Àn
 =  (
sockaddr_ö
);

223 
•
 = 
	`gë£rvby«me
 ("smux", "tcp");

224 i‡(
•
 !
NULL
)

225 
£rv
.
sö_p‹t
 = 
•
->
s_p‹t
;

227 
£rv
.
sö_p‹t
 = 
	`ht⁄s
 (
SMUX_PORT_DEFAULT
);

229 
£rv
.
sö_addr
.
s_addr
 = 
	`ht⁄l
 (
INADDR_LOOPBACK
);

231 
	`sock›t_ªu£addr
 (
sock
);

232 
	`sock›t_ªu£p‹t
 (
sock
);

234 
ªt
 = 
	`c⁄√˘
 (
sock
, (
sockaddr
 *Ë&
£rv
,  (
sockaddr_ö
));

235 i‡(
ªt
 < 0)

237 
	`˛o£
 (
sock
);

238 
smux_sock
 = -1;

239 
	`zlog_w¨n
 ("Can't connectÅo SNMPágent with SMUX");

243  
sock
;

244 
	}
}

247 
	$smux_gëª•_£nd
 (
oid
 
objid
[], 
size_t
 
objid_Àn
, 
ªqid
, 
îr°©
,

248 
îrödex
, 
u_ch¨
 
vÆ_ty≥
, *
¨g
, 
size_t
 
¨g_Àn
)

250 
u_ch¨
 
buf
[
BUFSIZ
];

251 
u_ch¨
 *
±r
, *
h1
, *
h1e
, *
h2
, *
h2e
;

252 
size_t
 
Àn
, 
Àngth
;

254 
±r
 = 
buf
;

255 
Àn
 = 
BUFSIZ
;

256 
Àngth
 = 
Àn
;

258 i‡(
debug_smux
)

260 
	`zlog_debug
 ("SMUX GETRSP send");

261 
	`zlog_debug
 ("SMUX GETRSPÑeqid: %ld", 
ªqid
);

264 
h1
 = 
±r
;

266 
±r
 = 
	`a¢_buûd_£quí˚
 (±r, &
Àn
, (
u_ch¨
Ë
SMUX_GETRSP
, 0);

267 
h1e
 = 
±r
;

269 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

270 (
u_ch¨
Ë(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

271 &
ªqid
,  (reqid));

273 i‡(
debug_smux
)

274 
	`zlog_debug
 ("SMUX GETRSPÉº°©: %ld", 
îr°©
);

276 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

277 (
u_ch¨
Ë(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

278 &
îr°©
,  (errstat));

279 i‡(
debug_smux
)

280 
	`zlog_debug
 ("SMUX GETRSPÉºödex: %ld", 
îrödex
);

282 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

283 (
u_ch¨
Ë(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

284 &
îrödex
,  (errindex));

286 
h2
 = 
±r
;

288 
±r
 = 
	`a¢_buûd_£quí˚
 (±r, &
Àn
,

289 (
u_ch¨
)(
ASN_SEQUENCE
 | 
ASN_CONSTRUCTOR
),

291 
h2e
 = 
±r
;

293 
±r
 = 
	`¢mp_buûd_v¨_›
 (±r, 
objid
, &
objid_Àn
,

294 
vÆ_ty≥
, 
¨g_Àn
, 
¨g
, &
Àn
);

297 
	`a¢_buûd_£quí˚
(
h2
,&
Àngth
,(
u_ch¨
)(
ASN_SEQUENCE
|
ASN_CONSTRUCTOR
),
±r
-
h2e
);

300 
	`a¢_buûd_£quí˚
(
h1
,&
Àngth
,(
u_ch¨
)
SMUX_GETRSP
,
±r
-
h1e
);

302 i‡(
debug_smux
)

303 
	`zlog_debug
 ("SMUX gëª• síd: %td", (
±r
 - 
buf
));

305 
	`£nd
 (
smux_sock
, 
buf
, (
±r
 - buf), 0);

306 
	}
}

308 
u_ch¨
 *

309 
	$smux_v¨
 (
u_ch¨
 *
±r
, 
size_t
 
Àn
, 
oid
 
objid
[], size_à*
objid_Àn
,

310 
size_t
 *
v¨_vÆ_Àn
,

311 
u_ch¨
 *
v¨_vÆ_ty≥
,

312 **
v¨_vÆue
)

314 
u_ch¨
 
ty≥
;

315 
u_ch¨
 
vÆ_ty≥
;

316 
size_t
 
vÆ_Àn
;

317 
u_ch¨
 *
vÆ
;

319 i‡(
debug_smux
)

320 
	`zlog_debug
 ("SMUX v¨Ö¨£:Üí %zd", 
Àn
);

323 
±r
 = 
	`a¢_∑r£_hódî
 (±r, &
Àn
, &
ty≥
);

325 i‡(
debug_smux
)

327 
	`zlog_debug
 ("SMUX v¨Ö¨£:Åy≥ %dÜí %zd", 
ty≥
, 
Àn
);

328 
	`zlog_debug
 ("SMUX varÖarse:Åype must be %d",

329 (
ASN_SEQUENCE
 | 
ASN_CONSTRUCTOR
));

333 *
objid_Àn
 = 
MAX_OID_LEN
;

334 
±r
 = 
	`¢mp_∑r£_v¨_›
’å, 
objid
, 
objid_Àn
, &
vÆ_ty≥
,

335 &
vÆ_Àn
, &
vÆ
, &
Àn
);

337 i‡(
v¨_vÆ_Àn
)

338 *
v¨_vÆ_Àn
 = 
vÆ_Àn
;

340 i‡(
v¨_vÆue
)

341 *
v¨_vÆue
 = (*Ë
vÆ
;

343 i‡(
v¨_vÆ_ty≥
)

344 *
v¨_vÆ_ty≥
 = 
vÆ_ty≥
;

347 i‡(
debug_smux
)

348 
	`smux_oid_dump
 ("Reque° OID", 
objid
, *
objid_Àn
);

350 i‡(
debug_smux
)

351 
	`zlog_debug
 ("SMUX vÆ_ty≥: %d", 
vÆ_ty≥
);

354 i‡(
debug_smux
)

355 
vÆ_ty≥
)

357 
ASN_NULL
:

360 
	`zlog_debug
 ("ASN_NULL");

363 
ASN_INTEGER
:

364 
	`zlog_debug
 ("ASN_INTEGER");

366 
ASN_COUNTER
:

367 
ASN_GAUGE
:

368 
ASN_TIMETICKS
:

369 
ASN_UINTEGER
:

370 
	`zlog_debug
 ("ASN_COUNTER");

372 
ASN_COUNTER64
:

373 
	`zlog_debug
 ("ASN_COUNTER64");

375 
ASN_IPADDRESS
:

376 
	`zlog_debug
 ("ASN_IPADDRESS");

378 
ASN_OCTET_STR
:

379 
	`zlog_debug
 ("ASN_OCTET_STR");

381 
ASN_OPAQUE
:

382 
ASN_NSAP
:

383 
ASN_OBJECT_ID
:

384 
	`zlog_debug
 ("ASN_OPAQUE");

386 
SNMP_NOSUCHOBJECT
:

387 
	`zlog_debug
 ("SNMP_NOSUCHOBJECT");

389 
SNMP_NOSUCHINSTANCE
:

390 
	`zlog_debug
 ("SNMP_NOSUCHINSTANCE");

392 
SNMP_ENDOFMIBVIEW
:

393 
	`zlog_debug
 ("SNMP_ENDOFMIBVIEW");

395 
ASN_BIT_STR
:

396 
	`zlog_debug
 ("ASN_BIT_STR");

399 
	`zlog_debug
 ("UnknownÅype");

402  
±r
;

403 
	}
}

410 
	$smux_£t
 (
oid
 *
ªqid
, 
size_t
 *
ªqid_Àn
,

411 
u_ch¨
 
vÆ_ty≥
, *
vÆ
, 
size_t
 
vÆ_Àn
, 
a˘i⁄
)

413 
j
;

414 
subåì
 *subtree;

415 
v¨übÀ
 *
v
;

416 
subªsu…
;

417 
oid
 *
suffix
;

418 
size_t
 
suffix_Àn
;

419 
ªsu…
;

420 
u_ch¨
 *
°©P
 = 
NULL
;

421 
WrôeMëhod
 *
wrôe_mëhod
 = 
NULL
;

422 
li°node
 *
node
, *
¬ode
;

425 
	`ALL_LIST_ELEMENTS
 (
åìli°
, 
node
, 
¬ode
, 
subåì
))

427 
subªsu…
 = 
	`oid_com∑ª_∑π
 (
ªqid
, *
ªqid_Àn
,

428 
subåì
->
«me
, subåì->
«me_Àn
);

431 i‡(
subªsu…
 == 0)

434 
suffix
 = 
ªqid
 + 
subåì
->
«me_Àn
;

435 
suffix_Àn
 = *
ªqid_Àn
 - 
subåì
->
«me_Àn
;

436 
ªsu…
 = 
subªsu…
;

439 
j
 = 0; j < 
subåì
->
v¨übÀs_num
; j++)

441 
v
 = &
subåì
->
v¨übÀs
[
j
];

444 
ªsu…
 = 
	`oid_com∑ª_∑π
 (
suffix
, 
suffix_Àn
,

445 
v
->
«me
, v->
«mñí
);

448 i‡(
ªsu…
 == 0)

450 i‡(
debug_smux
)

451 
	`zlog_debug
 ("SMUX fun˘i⁄ cÆ»ödex i†%d", 
v
->
magic
);

453 
°©P
 = (*
v
->
födV¨
Ë(v, 
suffix
, &
suffix_Àn
, 1,

454 &
vÆ_Àn
, &
wrôe_mëhod
);

456 i‡(
wrôe_mëhod
)

458  (*
wrôe_mëhod
)(
a˘i⁄
, 
vÆ
, 
vÆ_ty≥
, 
vÆ_Àn
,

459 
°©P
, 
suffix
, 
suffix_Àn
);

463  
SNMP_ERR_READONLY
;

469 i‡(
ªsu…
 < 0)

470  
SNMP_ERR_NOSUCHNAME
;

474  
SNMP_ERR_NOSUCHNAME
;

475 
	}
}

478 
	$smux_gë
 (
oid
 *
ªqid
, 
size_t
 *
ªqid_Àn
, 
exa˘
,

479 
u_ch¨
 *
vÆ_ty≥
,**
vÆ
, 
size_t
 *
vÆ_Àn
)

481 
j
;

482 
subåì
 *subtree;

483 
v¨übÀ
 *
v
;

484 
subªsu…
;

485 
oid
 *
suffix
;

486 
size_t
 
suffix_Àn
;

487 
ªsu…
;

488 
WrôeMëhod
 *
wrôe_mëhod
=
NULL
;

489 
li°node
 *
node
, *
¬ode
;

492 
	`ALL_LIST_ELEMENTS
 (
åìli°
, 
node
, 
¬ode
,
subåì
))

494 
subªsu…
 = 
	`oid_com∑ª_∑π
 (
ªqid
, *
ªqid_Àn
,

495 
subåì
->
«me
, subåì->
«me_Àn
);

498 i‡(
subªsu…
 == 0)

501 
suffix
 = 
ªqid
 + 
subåì
->
«me_Àn
;

502 
suffix_Àn
 = *
ªqid_Àn
 - 
subåì
->
«me_Àn
;

503 
ªsu…
 = 
subªsu…
;

506 
j
 = 0; j < 
subåì
->
v¨übÀs_num
; j++)

508 
v
 = &
subåì
->
v¨übÀs
[
j
];

511 
ªsu…
 = 
	`oid_com∑ª_∑π
 (
suffix
, 
suffix_Àn
,

512 
v
->
«me
, v->
«mñí
);

515 i‡(
ªsu…
 == 0)

517 i‡(
debug_smux
)

518 
	`zlog_debug
 ("SMUX fun˘i⁄ cÆ»ödex i†%d", 
v
->
magic
);

520 *
vÆ
 = (*
v
->
födV¨
Ë(v, 
suffix
, &
suffix_Àn
, 
exa˘
,

521 
vÆ_Àn
, &
wrôe_mëhod
);

524 i‡(*
vÆ
 =
NULL
)

525  
SNMP_NOSUCHINSTANCE
;

528 *
vÆ_ty≥
 = 
v
->
ty≥
;

535 i‡(
ªsu…
 < 0)

536  
SNMP_ERR_NOSUCHNAME
;

540  
SNMP_ERR_NOSUCHNAME
;

541 
	}
}

544 
	$smux_gë√xt
 (
oid
 *
ªqid
, 
size_t
 *
ªqid_Àn
, 
exa˘
,

545 
u_ch¨
 *
vÆ_ty≥
,**
vÆ
, 
size_t
 *
vÆ_Àn
)

547 
j
;

548 
oid
 
ßve
[
MAX_OID_LEN
];

549 
ßvñí
 = 0;

550 
subåì
 *subtree;

551 
v¨übÀ
 *
v
;

552 
subªsu…
;

553 
oid
 *
suffix
;

554 
size_t
 
suffix_Àn
;

555 
ªsu…
;

556 
WrôeMëhod
 *
wrôe_mëhod
=
NULL
;

557 
li°node
 *
node
, *
¬ode
;

561 
	`oid_c›y
 (
ßve
, 
ªqid
, *
ªqid_Àn
);

562 
ßvñí
 = *
ªqid_Àn
;

565 
	`ALL_LIST_ELEMENTS
 (
åìli°
, 
node
, 
¬ode
, 
subåì
))

567 
subªsu…
 = 
	`oid_com∑ª_∑π
 (
ªqid
, *
ªqid_Àn
,

568 
subåì
->
«me
, subåì->
«me_Àn
);

581 i‡(
subªsu…
 <= 0)

584 
suffix
 = 
ªqid
 + 
subåì
->
«me_Àn
;

585 
suffix_Àn
 = *
ªqid_Àn
 - 
subåì
->
«me_Àn
;

586 i‡(
subªsu…
 < 0)

588 
	`oid_c›y
(
ªqid
, 
subåì
->
«me
, subåì->
«me_Àn
);

589 *
ªqid_Àn
 = 
subåì
->
«me_Àn
;

591 
j
 = 0; j < 
subåì
->
v¨übÀs_num
; j++)

593 
ªsu…
 = 
subªsu…
;

594 
v
 = &
subåì
->
v¨übÀs
[
j
];

597 i‡(
ªsu…
 == 0)

598 
ªsu…
 = 
	`oid_com∑ª_∑π
 (
suffix
, 
suffix_Àn
,

599 
v
->
«me
, v->
«mñí
);

601 i‡(
ªsu…
 <= 0)

603 i‡(
debug_smux
)

604 
	`zlog_debug
 ("SMUX fun˘i⁄ cÆ»ödex i†%d", 
v
->
magic
);

605 if(
ªsu…
<0)

607 
	`oid_c›y
(
suffix
, 
v
->
«me
, v->
«mñí
);

608 
suffix_Àn
 = 
v
->
«mñí
;

610 *
vÆ
 = (*
v
->
födV¨
Ë(v, 
suffix
, &
suffix_Àn
, 
exa˘
,

611 
vÆ_Àn
, &
wrôe_mëhod
);

612 *
ªqid_Àn
 = 
suffix_Àn
 + 
subåì
->
«me_Àn
;

613 i‡(*
vÆ
)

615 *
vÆ_ty≥
 = 
v
->
ty≥
;

622 
	`mem˝y
 (
ªqid
, 
ßve
, 
ßvñí
 * (
oid
));

623 *
ªqid_Àn
 = 
ßvñí
;

625  
SNMP_ERR_NOSUCHNAME
;

626 
	}
}

629 
u_ch¨
 *

630 
	$smux_∑r£_gë_hódî
 (
u_ch¨
 *
±r
, 
size_t
 *
Àn
, *
ªqid
)

632 
u_ch¨
 
ty≥
;

633 
îr°©
;

634 
îrödex
;

637 
±r
 = 
	`a¢_∑r£_öt
 (±r, 
Àn
, &
ty≥
, 
ªqid
,  (*reqid));

639 i‡(
debug_smux
)

640 
	`zlog_debug
 ("SMUX GETÑeqid: %dÜí: %d", (Ë*
ªqid
, (Ë*
Àn
);

643 
±r
 = 
	`a¢_∑r£_öt
 (±r, 
Àn
, &
ty≥
, &
îr°©
,  (errstat));

645 i‡(
debug_smux
)

646 
	`zlog_debug
 ("SMUX GETÉº°© %ldÜí: %zd", 
îr°©
, *
Àn
);

649 
±r
 = 
	`a¢_∑r£_öt
 (±r, 
Àn
, &
ty≥
, &
îrödex
,  (errindex));

651 i‡(
debug_smux
)

652 
	`zlog_debug
 ("SMUX GETÉºödex %ldÜí: %zd", 
îrödex
, *
Àn
);

654  
±r
;

655 
	}
}

658 
	$smux_∑r£_£t
 (
u_ch¨
 *
±r
, 
size_t
 
Àn
, 
a˘i⁄
)

660 
ªqid
;

661 
oid
 oid[
MAX_OID_LEN
];

662 
size_t
 
oid_Àn
;

663 
u_ch¨
 
vÆ_ty≥
;

664 *
vÆ
;

665 
size_t
 
vÆ_Àn
;

666 
ªt
;

668 i‡(
debug_smux
)

669 
	`zlog_debug
 ("SMUX SET(%s) messageÖarse:Üen %zd",

670 (
RESERVE1
 =
a˘i⁄
Ë? "RESERVE1" : ((
FREE
 ==áction) ? "FREE" : "COMMIT"),

671 
Àn
);

674 
±r
 = 
	`smux_∑r£_gë_hódî
 (±r, &
Àn
, &
ªqid
);

677 
±r
 = 
	`smux_v¨
 (±r, 
Àn
, 
oid
, &
oid_Àn
, &
vÆ_Àn
, &
vÆ_ty≥
, &
vÆ
);

679 
ªt
 = 
	`smux_£t
 (
oid
, &
oid_Àn
, 
vÆ_ty≥
, 
vÆ
, 
vÆ_Àn
, 
a˘i⁄
);

680 i‡(
debug_smux
)

681 
	`zlog_debug
 ("SMUX SETÑë %d", 
ªt
);

684 i‡(
RESERVE1
 =
a˘i⁄
)

685 
	`smux_gëª•_£nd
 (
oid
, 
oid_Àn
, 
ªqid
, 
ªt
, 3, 
ASN_NULL
, 
NULL
, 0);

686 
	}
}

689 
	$smux_∑r£_gë
 (
u_ch¨
 *
±r
, 
size_t
 
Àn
, 
exa˘
)

691 
ªqid
;

692 
oid
 oid[
MAX_OID_LEN
];

693 
size_t
 
oid_Àn
;

694 
u_ch¨
 
vÆ_ty≥
;

695 *
vÆ
;

696 
size_t
 
vÆ_Àn
;

697 
ªt
;

699 i‡(
debug_smux
)

700 
	`zlog_debug
 ("SMUX GET mesßgê∑r£:Üí %zd", 
Àn
);

703 
±r
 = 
	`smux_∑r£_gë_hódî
 (±r, &
Àn
, &
ªqid
);

706 
±r
 = 
	`smux_v¨
 (±r, 
Àn
, 
oid
, &
oid_Àn
, 
NULL
, NULL, NULL);

709 i‡(
exa˘
)

710 
ªt
 = 
	`smux_gë
 (
oid
, &
oid_Àn
, 
exa˘
, &
vÆ_ty≥
, &
vÆ
, &
vÆ_Àn
);

712 
ªt
 = 
	`smux_gë√xt
 (
oid
, &
oid_Àn
, 
exa˘
, &
vÆ_ty≥
, &
vÆ
, &
vÆ_Àn
);

715 i‡(
ªt
 == 0)

716 
	`smux_gëª•_£nd
 (
oid
, 
oid_Àn
, 
ªqid
, 0, 0, 
vÆ_ty≥
, 
vÆ
, 
vÆ_Àn
);

718 
	`smux_gëª•_£nd
 (
oid
, 
oid_Àn
, 
ªqid
, 
ªt
, 3, 
ASN_NULL
, 
NULL
, 0);

719 
	}
}

723 
	$smux_∑r£_˛o£
 (
u_ch¨
 *
±r
, 
Àn
)

725 
ªas⁄
 = 0;

727 
Àn
--)

729 
ªas⁄
 = (ªas⁄ << 8Ë| (Ë*
±r
;

730 
±r
++;

732 
	`zlog_öfo
 ("SMUX_CLOSE wôhÑós⁄: %ld", 
ªas⁄
);

733 
	}
}

737 
	$smux_∑r£_º•
 (
u_ch¨
 *
±r
, 
size_t
 
Àn
)

739 
u_ch¨
 
vÆ
;

740 
îr°©
;

742 
±r
 = 
	`a¢_∑r£_öt
 (±r, &
Àn
, &
vÆ
, &
îr°©
,  (errstat));

744 i‡(
debug_smux
)

745 
	`zlog_debug
 ("SMUX_RRSP vÆue: %dÉº°©: %ld", 
vÆ
, 
îr°©
);

746 
	}
}

750 
	$smux_∑r£
 (
u_ch¨
 *
±r
, 
size_t
 
Àn
)

755 
u_ch¨
 
sout_ßve_buff
[
SMUXMAXPKTSIZE
];

756 
sout_ßve_Àn
 = 0;

758 
Àn_öcome
 = 
Àn
;

759 
u_ch¨
 
ty≥
;

760 
u_ch¨
 
rﬁlback
;

762 
rﬁlback
 = 
±r
[2];

764 
¥o˚ss_ª°
:

767 
±r
 = 
	`a¢_∑r£_hódî
 (±r, &
Àn
, &
ty≥
);

769 i‡(
debug_smux
)

770 
	`zlog_debug
 ("SMUX mesßgêª˚ivedÅy≥: %dÑe°Üí: %zd", 
ty≥
, 
Àn
);

772 
ty≥
)

774 
SMUX_OPEN
:

776 
	`zlog_w¨n
 ("SMUX_OPENÑeceived:Ñesetting connection.");

779 
SMUX_RREQ
:

781 
	`zlog_w¨n
 ("SMUX_RREQÑeceived:Ñesetting connection.");

784 
SMUX_SOUT
:

786 i‡(
debug_smux
)

787 
	`zlog_debug
 ("SMUX_SOUT(%s)", 
rﬁlback
 ? "rollback" : "commit");

789 i‡(
sout_ßve_Àn
 > 0)

791 
	`smux_∑r£_£t
 (
sout_ßve_buff
, 
sout_ßve_Àn
, 
rﬁlback
 ? 
FREE
 : 
COMMIT
);

792 
sout_ßve_Àn
 = 0;

795 
	`zlog_w¨n
 ("SMUX_SOUT sout_ßve_Àn=%d - invÆid", (Ë
sout_ßve_Àn
);

797 i‡(
Àn_öcome
 > 3)

809 
±r
++;

810 
Àn
 = 
Àn_öcome
 - 3;

811 
¥o˚ss_ª°
;

814 
SMUX_GETRSP
:

816 
	`zlog_w¨n
 ("SMUX_GETRSPÑeceived:Ñesetting connection.");

819 
SMUX_CLOSE
:

821 i‡(
debug_smux
)

822 
	`zlog_debug
 ("SMUX_CLOSE");

823 
	`smux_∑r£_˛o£
 (
±r
, 
Àn
);

826 
SMUX_RRSP
:

828 i‡(
debug_smux
)

829 
	`zlog_debug
 ("SMUX_RRSP");

830 
	`smux_∑r£_º•
 (
±r
, 
Àn
);

832 
SMUX_GET
:

834 i‡(
debug_smux
)

835 
	`zlog_debug
 ("SMUX_GET");

836 
	`smux_∑r£_gë
 (
±r
, 
Àn
, 1);

838 
SMUX_GETNEXT
:

840 i‡(
debug_smux
)

841 
	`zlog_debug
 ("SMUX_GETNEXT");

842 
	`smux_∑r£_gë
 (
±r
, 
Àn
, 0);

844 
SMUX_SET
:

846 i‡(
debug_smux
)

847 
	`zlog_debug
 ("SMUX_SET");

850 
	`mem˝y
 (
sout_ßve_buff
, 
±r
, 
Àn
);

851 
sout_ßve_Àn
 = 
Àn
;

852 
	`smux_∑r£_£t
 (
±r
, 
Àn
, 
RESERVE1
);

855 
	`zlog_öfo
 ("Unknow¿ty≥: %d", 
ty≥
);

859 
	}
}

863 
	$smux_ªad
 (
thªad
 *
t
)

865 
sock
;

866 
Àn
;

867 
u_ch¨
 
buf
[
SMUXMAXPKTSIZE
];

868 
ªt
;

871 
sock
 = 
	`THREAD_FD
 (
t
);

872 
smux_ªad_thªad
 = 
NULL
;

874 i‡(
debug_smux
)

875 
	`zlog_debug
 ("SMUXÑead start");

878 
Àn
 = 
	`ªcv
 (
sock
, 
buf
, 
SMUXMAXPKTSIZE
, 0);

880 i‡(
Àn
 < 0)

882 
	`zlog_w¨n
 ("C™'àªadáŒ SMUXÖackë: %s", 
	`ß„_°ªº‹
 (
î∫o
));

883 
	`˛o£
 (
sock
);

884 
smux_sock
 = -1;

885 
	`smux_evít
 (
SMUX_CONNECT
, 0);

889 i‡(
Àn
 == 0)

891 
	`zlog_w¨n
 ("SMUX c⁄√˘i⁄ clo£d: %d", 
sock
);

892 
	`˛o£
 (
sock
);

893 
smux_sock
 = -1;

894 
	`smux_evít
 (
SMUX_CONNECT
, 0);

898 i‡(
debug_smux
)

899 
	`zlog_debug
 ("SMUXÑódÜí: %d", 
Àn
);

902 
ªt
 = 
	`smux_∑r£
 (
buf
, 
Àn
);

904 i‡(
ªt
 < 0)

906 
	`˛o£
 (
sock
);

907 
smux_sock
 = -1;

908 
	`smux_evít
 (
SMUX_CONNECT
, 0);

913 
	`smux_evít
 (
SMUX_READ
, 
sock
);

916 
	}
}

919 
	$smux_›í
 (
sock
)

921 
u_ch¨
 
buf
[
BUFSIZ
];

922 
u_ch¨
 *
±r
;

923 
size_t
 
Àn
;

924 
vîsi⁄
;

925 c⁄° 
¥og«me
[] = 
QUAGGA_PROGNAME
 "-" 
QUAGGA_VERSION
;

927 i‡(
debug_smux
)

929 
	`smux_oid_dump
 ("SMUX o≥¿oid", 
smux_oid
, 
smux_oid_Àn
);

930 
	`zlog_debug
 ("SMUX o≥¿¥og«me: %s", 
¥og«me
);

931 
	`zlog_debug
 ("SMUX o≥¿∑ssw‹d: %s", 
smux_∑sswd
);

934 
±r
 = 
buf
;

935 
Àn
 = 
BUFSIZ
;

938 
±r
 = 
	`a¢_buûd_hódî
 (±r, &
Àn
, (
u_ch¨
Ë
SMUX_OPEN
, 0);

941 
vîsi⁄
 = 0;

942 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

943 (
u_ch¨
)(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

944 &
vîsi⁄
,  (version));

947 
±r
 = 
	`a¢_buûd_objid
 (±r, &
Àn
,

948 (
u_ch¨
)

949 (
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_OBJECT_ID
),

950 
smux_oid
, 
smux_oid_Àn
);

953 
±r
 = 
	`a¢_buûd_°rög
 (±r, &
Àn
,

954 (
u_ch¨
)

955 (
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_OCTET_STR
),

956 (c⁄° 
u_ch¨
 *Ë
¥og«me
, 
	`°æí
 (progname));

959 
±r
 = 
	`a¢_buûd_°rög
 (±r, &
Àn
,

960 (
u_ch¨
)

961 (
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_OCTET_STR
),

962 (
u_ch¨
 *)
smux_∑sswd
, 
	`°æí
 (smux_passwd));

965 
Àn
 = 
BUFSIZ
;

966 
	`a¢_buûd_hódî
 (
buf
, &
Àn
, (
u_ch¨
Ë
SMUX_OPEN
, (
±r
 - buf) - 2);

968  
	`£nd
 (
sock
, 
buf
, (
±r
 - buf), 0);

969 
	}
}

977 
	$smux_å≠
 (
v¨übÀ
 *
vp
, 
size_t
 
vp_Àn
,

978 c⁄° 
oid
 *
íame
, 
size_t
 
íamñí
,

979 c⁄° 
oid
 *
«me
, 
size_t
 
«mñí
,

980 c⁄° 
oid
 *
öame
, 
size_t
 
öamñí
,

981 c⁄° 
å≠_obje˘
 *
å≠obj
, 
size_t
 
å≠objÀn
,

982 
u_ch¨
 
•å≠
)

984 
i
;

985 
u_ch¨
 
buf
[
BUFSIZ
];

986 
u_ch¨
 *
±r
;

987 
size_t
 
Àn
, 
Àngth
;

988 
ö_addr
 
addr
;

989 
vÆ
;

990 
u_ch¨
 *
h1
, *
h1e
;

992 
±r
 = 
buf
;

993 
Àn
 = 
BUFSIZ
;

994 
Àngth
 = 
Àn
;

997 i‡(
smux_sock
 < 0)

1001 
±r
 = 
	`a¢_buûd_hódî
 (±r, &
Àn
, (
u_ch¨
Ë
SMUX_TRAP
, 0);

1004 
±r
 = 
	`a¢_buûd_objid
 (±r, &
Àn
,

1005 (
u_ch¨
)

1006 (
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_OBJECT_ID
),

1007 
smux_oid
, 
smux_oid_Àn
);

1010 
addr
.
s_addr
 = 0;

1011 
±r
 = 
	`a¢_buûd_°rög
 (±r, &
Àn
,

1012 (
u_ch¨
)

1013 (
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_IPADDRESS
),

1014 (
u_ch¨
 *)&
addr
,  (addr));

1017 
vÆ
 = 
SNMP_TRAP_ENTERPRISESPECIFIC
;

1018 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

1019 (
u_ch¨
)(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

1020 (*)&
vÆ
,  (val));

1023 
vÆ
 = 
•å≠
;

1024 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

1025 (
u_ch¨
)(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

1026 (*)&
vÆ
,  (val));

1029 
vÆ
 = 0;

1030 
±r
 = 
	`a¢_buûd_unsig√d_öt
 (±r, &
Àn
,

1031 (
u_ch¨
)(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_TIMETICKS
),

1032 &
vÆ
,  (val));

1035 
h1
 = 
±r
;

1036 
±r
 = 
	`a¢_buûd_£quí˚
 (±r, &
Àn
,

1037 (
u_ch¨
Ë(
ASN_SEQUENCE
 | 
ASN_CONSTRUCTOR
),

1042 
h1e
 = 
±r
;

1043 
i
 = 0; i < 
å≠objÀn
; i++)

1045 
ªt
;

1046 
oid
 oid[
MAX_OID_LEN
];

1047 
size_t
 
oid_Àn
;

1048 *
vÆ
;

1049 
size_t
 
vÆ_Àn
;

1050 
u_ch¨
 
vÆ_ty≥
;

1053 i‡(
å≠obj
[
i
].
«mñí
 > 0)

1055 
	`oid_c›y
 (
oid
, 
«me
, 
«mñí
);

1056 
	`oid_c›y
 (
oid
 + 
«mñí
, 
å≠obj
[
i
].
«me
,Årapobj[i].namelen);

1057 
	`oid_c›y
 (
oid
 + 
«mñí
 + 
å≠obj
[
i
].«mñí, 
öame
, 
öamñí
);

1058 
oid_Àn
 = 
«mñí
 + 
å≠obj
[
i
].«mñí + 
öamñí
;

1062 
	`oid_c›y
 (
oid
, 
«me
, 
«mñí
);

1063 
	`oid_c›y
 (
oid
 + 
«mñí
, 
å≠obj
[
i
].
«me
,Årapobj[i].namelen * (-1));

1064 
oid_Àn
 = 
«mñí
 + 
å≠obj
[
i
].namelen * (-1) ;

1067 i‡(
debug_smux
)

1069 
	`smux_oid_dump
 ("Tøp", 
«me
, 
«mñí
);

1070 i‡(
å≠obj
[
i
].
«mñí
 < 0)

1071 
	`smux_oid_dump
 ("Trap",

1072 
å≠obj
[
i
].
«me
, (- 1Ë* (å≠obj[i].
«mñí
));

1075 
	`smux_oid_dump
 ("Tøp", 
å≠obj
[
i
].
«me
, (å≠obj[i].
«mñí
));

1076 
	`smux_oid_dump
 ("Tøp", 
öame
, 
öamñí
);

1078 
	`smux_oid_dump
 ("Tøp", 
oid
, 
oid_Àn
);

1079 
	`zlog_öfo
 ("BUFSIZ: %d // oid_Àn: %lu", 
BUFSIZ
, (
u_l⁄g
)
oid_Àn
);

1082 
ªt
 = 
	`smux_gë
 (
oid
, &
oid_Àn
, 1, &
vÆ_ty≥
, &
vÆ
, &
vÆ_Àn
);

1084 i‡(
debug_smux
)

1085 
	`zlog_debug
 ("smux_gëÑesu… %d", 
ªt
);

1087 i‡(
ªt
 == 0)

1088 
±r
 = 
	`¢mp_buûd_v¨_›
 (±r, 
oid
, &
oid_Àn
,

1089 
vÆ_ty≥
, 
vÆ_Àn
, 
vÆ
, &
Àn
);

1093 
	`a¢_buûd_£quí˚
(
h1
, &
Àngth
,

1094 (
u_ch¨
Ë(
ASN_SEQUENCE
 | 
ASN_CONSTRUCTOR
),

1095 
±r
 - 
h1e
);

1098 
Àn
 = 
BUFSIZ
;

1099 
	`a¢_buûd_hódî
 (
buf
, &
Àn
, (
u_ch¨
Ë
SMUX_TRAP
, (
±r
 - buf) - 2);

1101  
	`£nd
 (
smux_sock
, 
buf
, (
±r
 - buf), 0);

1102 
	}
}

1105 
	$smux_ªgi°î
 (
sock
)

1107 
u_ch¨
 
buf
[
BUFSIZ
];

1108 
u_ch¨
 *
±r
;

1109 
ªt
;

1110 
size_t
 
Àn
;

1111 
¥i‹ôy
;

1112 
›î©i⁄
;

1113 
subåì
 *subtree;

1114 
li°node
 *
node
, *
¬ode
;

1116 
ªt
 = 0;

1118 
	`ALL_LIST_ELEMENTS
 (
åìli°
, 
node
, 
¬ode
, 
subåì
))

1120 
±r
 = 
buf
;

1121 
Àn
 = 
BUFSIZ
;

1124 
±r
 = 
	`a¢_buûd_hódî
 (±r, &
Àn
, (
u_ch¨
Ë
SMUX_RREQ
, 0);

1127 
±r
 = 
	`a¢_buûd_objid
 (±r, &
Àn
,

1128 (
u_ch¨
)

1129 (
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_OBJECT_ID
),

1130 
subåì
->
«me
, subåì->
«me_Àn
);

1133 
¥i‹ôy
 = -1;

1134 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

1135 (
u_ch¨
)(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

1136 &
¥i‹ôy
,  (priority));

1139 
›î©i⁄
 = 2;

1140 
±r
 = 
	`a¢_buûd_öt
 (±r, &
Àn
,

1141 (
u_ch¨
)(
ASN_UNIVERSAL
 | 
ASN_PRIMITIVE
 | 
ASN_INTEGER
),

1142 &
›î©i⁄
,  (operation));

1144 i‡(
debug_smux
)

1146 
	`smux_oid_dump
 ("SMUXÑegi°î oid", 
subåì
->
«me
, subåì->
«me_Àn
);

1147 
	`zlog_debug
 ("SMUXÑegi°îÖri‹ôy: %ld", 
¥i‹ôy
);

1148 
	`zlog_debug
 ("SMUXÑegi°î o≥øti⁄: %ld", 
›î©i⁄
);

1151 
Àn
 = 
BUFSIZ
;

1152 
	`a¢_buûd_hódî
 (
buf
, &
Àn
, (
u_ch¨
Ë
SMUX_RREQ
, (
±r
 - buf) - 2);

1153 
ªt
 = 
	`£nd
 (
sock
, 
buf
, (
±r
 - buf), 0);

1154 i‡(
ªt
 < 0)

1155  
ªt
;

1157  
ªt
;

1158 
	}
}

1162 
	$smux_c⁄√˘
 (
thªad
 *
t
)

1164 
ªt
;

1166 i‡(
debug_smux
)

1167 
	`zlog_debug
 ("SMUX c⁄√˘Åry %d", 
Áû
 + 1);

1170 
smux_c⁄√˘_thªad
 = 
NULL
;

1173 
smux_sock
 = 
	`smux_sockë
 ();

1174 i‡(
smux_sock
 < 0)

1176 i‡(++
Áû
 < 
SMUX_MAX_FAILURE
)

1177 
	`smux_evít
 (
SMUX_CONNECT
, 0);

1182 
ªt
 = 
	`smux_›í
 (
smux_sock
);

1183 i‡(
ªt
 < 0)

1185 
	`zlog_w¨n
 ("SMUX o≥¿mesßgê£nd faûed: %s", 
	`ß„_°ªº‹
 (
î∫o
));

1186 
	`˛o£
 (
smux_sock
);

1187 
smux_sock
 = -1;

1188 i‡(++
Áû
 < 
SMUX_MAX_FAILURE
)

1189 
	`smux_evít
 (
SMUX_CONNECT
, 0);

1194 
ªt
 = 
	`smux_ªgi°î
 (
smux_sock
);

1195 i‡(
ªt
 < 0)

1197 
	`zlog_w¨n
 ("SMUXÑegi°î mesßgê£nd faûed: %s", 
	`ß„_°ªº‹
 (
î∫o
));

1198 
	`˛o£
 (
smux_sock
);

1199 
smux_sock
 = -1;

1200 i‡(++
Áû
 < 
SMUX_MAX_FAILURE
)

1201 
	`smux_evít
 (
SMUX_CONNECT
, 0);

1206 
	`smux_evít
 (
SMUX_READ
, 
smux_sock
);

1209 
	}
}

1213 
	$smux_°›
 ()

1215 i‡(
smux_ªad_thªad
)

1217 
	`thªad_ˇn˚l
 (
smux_ªad_thªad
);

1218 
smux_ªad_thªad
 = 
NULL
;

1221 i‡(
smux_c⁄√˘_thªad
)

1223 
	`thªad_ˇn˚l
 (
smux_c⁄√˘_thªad
);

1224 
smux_c⁄√˘_thªad
 = 
NULL
;

1227 i‡(
smux_sock
 >= 0)

1229 
	`˛o£
 (
smux_sock
);

1230 
smux_sock
 = -1;

1232 
	}
}

1237 
	$smux_evít
 (
smux_evít
 
evít
, 
sock
)

1239 
evít
)

1241 
SMUX_SCHEDULE
:

1242 
smux_c⁄√˘_thªad
 = 
	`thªad_add_evít
 (
ma°î
, 
smux_c⁄√˘
, 
NULL
, 0);

1244 
SMUX_CONNECT
:

1245 
smux_c⁄√˘_thªad
 = 
	`thªad_add_timî
 (
ma°î
, 
smux_c⁄√˘
, 
NULL
, 10);

1247 
SMUX_READ
:

1248 
smux_ªad_thªad
 = 
	`thªad_add_ªad
 (
ma°î
, 
smux_ªad
, 
NULL
, 
sock
);

1253 
	}
}

1256 
	$smux_°r2oid
 (c⁄° *
°r
, 
oid
 *oid, 
size_t
 *
oid_Àn
)

1258 
Àn
;

1259 
vÆ
;

1261 
Àn
 = 0;

1262 
vÆ
 = 0;

1263 *
oid_Àn
 = 0;

1265 i‡(*
°r
 == '.')

1266 
°r
++;

1267 i‡(*
°r
 == '\0')

1272 i‡(! 
	`isdigô
 (*
°r
))

1275 
	`isdigô
 (*
°r
))

1277 
vÆ
 *= 10;

1278 
vÆ
 +(*
°r
 - '0');

1279 
°r
++;

1282 i‡(*
°r
 == '\0')

1284 i‡(*
°r
 != '.')

1287 
oid
[
Àn
++] = 
vÆ
;

1288 
vÆ
 = 0;

1289 
°r
++;

1292 
oid
[
Àn
++] = 
vÆ
;

1293 *
oid_Àn
 = 
Àn
;

1296 
	}
}

1298 
oid
 *

1299 
	$smux_oid_dup
 (
oid
 *
objid
, 
size_t
 
objid_Àn
)

1301 
oid
 *
√w
;

1303 
√w
 = 
	`XMALLOC
 (
MTYPE_TMP
,  (
oid
Ë* 
objid_Àn
);

1304 
	`oid_c›y
 (
√w
, 
objid
, 
objid_Àn
);

1306  
√w
;

1307 
	}
}

1310 
	$smux_≥î_oid
 (
vty
 *vty, c⁄° *
oid_°r
, c⁄° *
∑sswd_°r
)

1312 
ªt
;

1313 
oid
 oid[
MAX_OID_LEN
];

1314 
size_t
 
oid_Àn
;

1316 
ªt
 = 
	`smux_°r2oid
 (
oid_°r
, 
oid
, &
oid_Àn
);

1317 i‡(
ªt
 != 0)

1319 
	`vty_out
 (
vty
, "obje˘ ID mÆf‹med%s", 
VTY_NEWLINE
);

1320  
CMD_WARNING
;

1323 i‡(
smux_oid
)

1325 
	`‰ì
 (
smux_oid
);

1326 
smux_oid
 = 
NULL
;

1330 i‡(
smux_∑sswd
)

1332 
	`‰ì
 (
smux_∑sswd
);

1333 
smux_∑sswd
 = 
NULL
;

1336 
smux_oid
 = 
	`smux_oid_dup
 (
oid
, 
oid_Àn
);

1337 
smux_oid_Àn
 = 
oid_Àn
;

1339 i‡(
∑sswd_°r
)

1340 
smux_∑sswd
 = 
	`°rdup
 (
∑sswd_°r
);

1342 
smux_∑sswd
 = 
	`°rdup
 ("");

1345 
	}
}

1348 
	$smux_≥î_deÁu…
 ()

1350 i‡(
smux_oid
)

1352 
	`‰ì
 (
smux_oid
);

1353 
smux_oid
 = 
NULL
;

1357 i‡(
smux_∑sswd
)

1359 
	`‰ì
 (
smux_∑sswd
);

1360 
smux_∑sswd
 = 
NULL
;

1363  
CMD_SUCCESS
;

1364 
	}
}

1366 
DEFUN
 (
smux_≥î
,

1367 
smux_≥î_cmd
,

1373 i‡(
smux_≥î_oid
 (
vty
, 
¨gv
[0], 
NULL
) == 0)

1375 
smux_°¨t
();

1376  
	gCMD_SUCCESS
;

1379  
	gCMD_WARNING
;

1382 
DEFUN
 (
smux_≥î_∑ssw‹d
,

1383 
smux_≥î_∑ssw‹d_cmd
,

1390 i‡(
smux_≥î_oid
 (
vty
, 
¨gv
[0],árgv[1]) == 0)

1392 
smux_°¨t
();

1393  
	gCMD_SUCCESS
;

1396  
	gCMD_WARNING
;

1399 
DEFUN
 (
no_smux_≥î
,

1400 
no_smux_≥î_cmd
,

1402 
NO_STR


1406 
smux_°›
();

1407  
smux_≥î_deÁu…
 ();

1410 
ALIAS
 (
no_smux_≥î
,

1411 
no_smux_≥î_oid_cmd
,

1413 
NO_STR


1418 
ALIAS
 (
no_smux_≥î
,

1419 
no_smux_≥î_oid_∑ssw‹d_cmd
,

1421 
NO_STR


1428 
	$c⁄fig_wrôe_smux
 (
vty
 *vty)

1430 
fú°
 = 1;

1431 
i
;

1433 i‡(
smux_oid
)

1435 
	`vty_out
 (
vty
, "smuxÖeer ");

1436 
i
 = 0; i < 
smux_oid_Àn
; i++)

1438 
	`vty_out
 (
vty
, "%s%d", 
fú°
 ? "" : ".", (Ë
smux_oid
[
i
]);

1439 
fú°
 = 0;

1441 
	`vty_out
 (
vty
, " %s%s", 
smux_∑sswd
, 
VTY_NEWLINE
);

1444 
	}
}

1448 
	$smux_ªgi°î_mib
 (c⁄° *
des¸
, 
v¨übÀ
 *
v¨
,

1449 
size_t
 
width
, 
num
,

1450 
oid
 
«me
[], 
size_t
 
«mñí
)

1452 
subåì
 *
åì
;

1454 
åì
 = (
subåì
 *)
	`mÆloc
((subtree));

1455 
	`oid_c›y
 (
åì
->
«me
,Çame, 
«mñí
);

1456 
åì
->
«me_Àn
 = 
«mñí
;

1457 
åì
->
v¨übÀs
 = 
v¨
;

1458 
åì
->
v¨übÀs_num
 = 
num
;

1459 
åì
->
v¨übÀs_width
 = 
width
;

1460 
åì
->
ªgi°îed
 = 0;

1461 
	`li°node_add_s‹t
(
åìli°
, 
åì
);

1462 
	}
}

1466 
	$smux_åì_cmp
(
subåì
 *
åì1
, subåì *
åì2
)

1468  
	`oid_com∑ª
(
åì1
->
«me
,Åªe1->
«me_Àn
,

1469 
åì2
->
«me
,Åªe2->
«me_Àn
);

1470 
	}
}

1474 
	$smux_öô
 (
thªad_ma°î
 *
tm
)

1477 
ma°î
 = 
tm
;

1480 
åìli°
 = 
	`li°_√w
();

1481 
åìli°
->
cmp
 = ((*)(*, *))
smux_åì_cmp
;

1484 
	`ö°Æl_node
 (&
smux_node
, 
c⁄fig_wrôe_smux
);

1486 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
smux_≥î_cmd
);

1487 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
smux_≥î_∑ssw‹d_cmd
);

1488 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_smux_≥î_cmd
);

1489 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_smux_≥î_oid_cmd
);

1490 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_smux_≥î_oid_∑ssw‹d_cmd
);

1491 
	}
}

1494 
	$smux_°¨t
()

1497 
	`smux_°›
();

1500 
	`smux_evít
 (
SMUX_SCHEDULE
, 0);

1501 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/smux.h

22 #i‚de‡
_ZEBRA_SNMP_H


23 
	#_ZEBRA_SNMP_H


	)

25 
	~<√t-¢mp/agít/√t-¢mp-agít-ö˛udes.h
>

26 
	~<√t-¢mp/agít/¢mp_v¨s.h
>

29 
	#MATCH_FAILED
 (-1)

	)

30 
	#MATCH_SUCCEEDED
 0

	)

33 
	#SNMP_TRUE
 1

	)

34 
	#SNMP_FALSE
 2

	)

37 
	#SNMP_VALID
 1

	)

38 
	#SNMP_INVALID
 2

	)

40 
	#IN_ADDR_SIZE
 (
ö_addr
)

	)

42 #unde‡
REGISTER_MIB


43 
	#REGISTER_MIB
(
des¸
, 
v¨
, 
v¨ty≥
, 
theoid
) \

44 
	`smux_ªgi°î_mib
(
des¸
, (
v¨übÀ
 *)
v¨
, (
v¨ty≥
), \

45 (
v¨
)/(
v¨ty≥
), \

46 
theoid
, —heoid)/(
oid
))

	)

48 
	så≠_obje˘


50 
	m«mñí
;

51 
oid
 
	m«me
[
MAX_OID_LEN
];

55 
	#SNMP_LOCAL_VARIABLES
 \

56 
¢mp_öt_vÆ
; \

57 
ö_addr
 
¢mp_ö_addr_vÆ
;

	)

59 
	#SNMP_INTEGER
(
V
) \

61 *
v¨_Àn
 =  (
¢mp_öt_vÆ
), \

62 
¢mp_öt_vÆ
 = 
V
, \

63 (
u_ch¨
 *Ë&
¢mp_öt_vÆ
 \

64 )

	)

66 
	#SNMP_IPADDRESS
(
V
) \

68 *
v¨_Àn
 =  (
ö_addr
), \

69 
¢mp_ö_addr_vÆ
 = 
V
, \

70 (
u_ch¨
 *Ë&
¢mp_ö_addr_vÆ
 \

71 )

	)

73 
smux_öô
 (
thªad_ma°î
 *
tm
);

74 
smux_ªgi°î_mib
(c⁄° *, 
v¨übÀ
 *,

75 
size_t
, , 
oid
 [], size_t);

76 
smux_hódî_gíîic
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

77 , 
size_t
 *, 
WrôeMëhod
 **);

78 
smux_hódî_èbÀ
 (
v¨übÀ
 *, 
oid
 *, 
size_t
 *,

79 , 
size_t
 *, 
WrôeMëhod
 **);

102 
smux_å≠
 (
v¨übÀ
 *, 
size_t
,

103 c⁄° 
oid
 *, 
size_t
,

104 c⁄° 
oid
 *, 
size_t
,

105 c⁄° 
oid
 *, 
size_t
,

106 c⁄° 
å≠_obje˘
 *, 
size_t
,

107 
u_ch¨
);

109 
oid_com∑ª
 (
oid
 *, , oid *, );

110 
oid2ö_addr
 (
oid
 [], , 
ö_addr
 *);

111 *
oid_c›y
 (*, c⁄° *, 
size_t
);

112 
oid_c›y_addr
 (
oid
 [], 
ö_addr
 *, );

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/snmp.c

22 
	~<zebø.h
>

24 #ifde‡
HAVE_SNMP


25 
	~<√t-¢mp/√t-¢mp-c⁄fig.h
>

26 
	~<√t-¢mp/√t-¢mp-ö˛udes.h
>

28 
	~"smux.h
"

30 
	#mö
(
A
,
B
Ë((AË< (BË? (AË: (B))

	)

33 
	$oid_com∑ª
 (
oid
 *
o1
, 
o1_Àn
, oid *
o2
, 
o2_Àn
)

35 
i
;

37 
i
 = 0; i < 
	`mö
 (
o1_Àn
, 
o2_Àn
); i++)

39 i‡(
o1
[
i
] < 
o2
[i])

41 i‡(
o1
[
i
] > 
o2
[i])

44 i‡(
o1_Àn
 < 
o2_Àn
)

46 i‡(
o1_Àn
 > 
o2_Àn
)

50 
	}
}

53 
	$oid_c›y
 (*
de°
, c⁄° *
§c
, 
size_t
 
size
)

55  
	`mem˝y
 (
de°
, 
§c
, 
size
 *  (
oid
));

56 
	}
}

59 
	$oid2ö_addr
 (
oid
 oid[], 
Àn
, 
ö_addr
 *
addr
)

61 
i
;

62 
u_ch¨
 *
≤t
;

64 i‡(
Àn
 == 0)

67 
≤t
 = (
u_ch¨
 *Ë
addr
;

69 
i
 = 0; i < 
Àn
; i++)

70 *
≤t
++ = 
oid
[
i
];

71 
	}
}

74 
	$oid_c›y_addr
 (
oid
 oid[], 
ö_addr
 *
addr
, 
Àn
)

76 
i
;

77 
u_ch¨
 *
≤t
;

79 i‡(
Àn
 == 0)

82 
≤t
 = (
u_ch¨
 *Ë
addr
;

84 
i
 = 0; i < 
Àn
; i++)

85 
oid
[
i
] = *
≤t
++;

86 
	}
}

89 
	$smux_hódî_gíîic
 (
v¨übÀ
 *
v
, 
oid
 *
«me
, 
size_t
 *
Àngth
, 
exa˘
,

90 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

92 
oid
 
fuŒoid
[
MAX_OID_LEN
];

93 
ªt
;

95 
	`oid_c›y
 (
fuŒoid
, 
v
->
«me
, v->
«mñí
);

96 
fuŒoid
[
v
->
«mñí
] = 0;

98 
ªt
 = 
	`oid_com∑ª
 (
«me
, *
Àngth
, 
fuŒoid
, 
v
->
«mñí
 + 1);

101 i‡((
exa˘
 && (
ªt
 != 0)) || (!exact && (ret >= 0)))

102  
MATCH_FAILED
;

105 
	`mem˝y
 (
«me
, 
fuŒoid
, (
v
->
«mñí
 + 1Ë*  (
oid
));

106 *
Àngth
 = 
v
->
«mñí
 + 1;

108 *
wrôe_mëhod
 = 0;

109 *
v¨_Àn
 = ();

111  
MATCH_SUCCEEDED
;

112 
	}
}

115 
	$smux_hódî_èbÀ
 (
v¨übÀ
 *
v
, 
oid
 *
«me
, 
size_t
 *
Àngth
, 
exa˘
,

116 
size_t
 *
v¨_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

120 i‡((
	`oid_com∑ª
 (
«me
, *
Àngth
, 
v
->«me, v->
«mñí
)) < 0)

122 i‡(
exa˘
)

123  
MATCH_FAILED
;

124 
	`oid_c›y
(
«me
, 
v
->«me, v->
«mñí
);

125 *
Àngth
 = 
v
->
«mñí
;

128 *
wrôe_mëhod
 = 0;

129 *
v¨_Àn
 = ();

131  
MATCH_SUCCEEDED
;

132 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockopt.c

22 
	~<zebø.h
>

23 
	~"log.h
"

24 
	~"sock›t.h
"

25 
	~"sockuni⁄.h
"

28 
	$£tsock›t_so_ªcvbuf
 (
sock
, 
size
)

30 
ªt
;

32 i‡–(
ªt
 = 
	`£tsock›t
 (
sock
, 
SOL_SOCKET
, 
SO_RCVBUF
, (*)

33 &
size
,  ())) < 0)

34 
	`zlog_îr
 ("fd %d: can't setsockopt SO_RCVBUFÅo %d: %s",

35 
sock
,
size
,
	`ß„_°ªº‹
(
î∫o
));

37  
ªt
;

38 
	}
}

41 
	$£tsock›t_so_£ndbuf
 (c⁄° 
sock
, 
size
)

43 
ªt
 = 
	`£tsock›t
 (
sock
, 
SOL_SOCKET
, 
SO_SNDBUF
,

44 (*)&
size
,  ());

46 i‡(
ªt
 < 0)

47 
	`zlog_îr
 ("fd %d: can't setsockopt SO_SNDBUFÅo %d: %s",

48 
sock
, 
size
, 
	`ß„_°ªº‹
 (
î∫o
));

50  
ªt
;

51 
	}
}

54 
	$gësock›t_so_£ndbuf
 (c⁄° 
sock
)

56 
u_öt32_t
 
›tvÆ
;

57 
sockÀn_t
 
›éí
 =  (
›tvÆ
);

58 
ªt
 = 
	`gësock›t
 (
sock
, 
SOL_SOCKET
, 
SO_SNDBUF
,

59 (*)&
›tvÆ
, &
›éí
);

60 i‡(
ªt
 < 0)

62 
	`zlog_îr
 ("fd %d: can't getsockopt SO_SNDBUF: %d (%s)",

63 
sock
, 
î∫o
, 
	`ß„_°ªº‹
 (errno));

64  
ªt
;

66  
›tvÆ
;

67 
	}
}

70 
	$gësock›t_cmsg_d©a
 (
msghdr
 *
msgh
, 
Àvñ
, 
ty≥
)

72 
cmsghdr
 *
cmsg
;

73 *
±r
 = 
NULL
;

75 
cmsg
 = 
	`ZCMSG_FIRSTHDR
(
msgh
);

76 
cmsg
 !
NULL
;

77 
cmsg
 = 
	`CMSG_NXTHDR
(
msgh
, cmsg))

78 i‡(
cmsg
->
cmsg_Àvñ
 =
Àvñ
 && cmsg->
cmsg_ty≥
)

79  (
±r
 = 
	`CMSG_DATA
(
cmsg
));

81  
NULL
;

82 
	}
}

84 #ifde‡
HAVE_IPV6


87 
	$£tsock›t_ùv6_pktöfo
 (
sock
, 
vÆ
)

89 
ªt
;

91 #ifde‡
IPV6_RECVPKTINFO


92 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IPV6
, 
IPV6_RECVPKTINFO
, &
vÆ
, (val));

93 i‡(
ªt
 < 0)

94 
	`zlog_w¨n
 ("ˇn'à£tsock›àIPV6_RECVPKTINFO : %s", 
	`ß„_°ªº‹
 (
î∫o
));

96 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IPV6
, 
IPV6_PKTINFO
, &
vÆ
, (val));

97 i‡(
ªt
 < 0)

98 
	`zlog_w¨n
 ("ˇn'à£tsock›àIPV6_PKTINFO : %s", 
	`ß„_°ªº‹
 (
î∫o
));

100  
ªt
;

101 
	}
}

105 
	$£tsock›t_ùv6_checksum
 (
sock
, 
vÆ
)

107 
ªt
;

109 #ifde‡
GNU_LINUX


110 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_RAW
, 
IPV6_CHECKSUM
, &
vÆ
, (val));

112 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IPV6
, 
IPV6_CHECKSUM
, &
vÆ
, (val));

114 i‡(
ªt
 < 0)

115 
	`zlog_w¨n
 ("can't setsockopt IPV6_CHECKSUM");

116  
ªt
;

117 
	}
}

121 
	$£tsock›t_ùv6_mu…iˇ°_h›s
 (
sock
, 
vÆ
)

123 
ªt
;

125 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IPV6
, 
IPV6_MULTICAST_HOPS
, &
vÆ
, (val));

126 i‡(
ªt
 < 0)

127 
	`zlog_w¨n
 ("can't setsockopt IPV6_MULTICAST_HOPS");

128  
ªt
;

129 
	}
}

133 
	$£tsock›t_ùv6_uniˇ°_h›s
 (
sock
, 
vÆ
)

135 
ªt
;

137 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IPV6
, 
IPV6_UNICAST_HOPS
, &
vÆ
, (val));

138 i‡(
ªt
 < 0)

139 
	`zlog_w¨n
 ("can't setsockopt IPV6_UNICAST_HOPS");

140  
ªt
;

141 
	}
}

144 
	$£tsock›t_ùv6_h›limô
 (
sock
, 
vÆ
)

146 
ªt
;

148 #ifde‡
IPV6_RECVHOPLIMIT


149 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_RECVHOPLIMIT
, &
vÆ
, (val));

150 i‡(
ªt
 < 0)

151 
	`zlog_w¨n
 ("can't setsockopt IPV6_RECVHOPLIMIT");

153 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_HOPLIMIT
, &
vÆ
, (val));

154 i‡(
ªt
 < 0)

155 
	`zlog_w¨n
 ("can't setsockopt IPV6_HOPLIMIT");

157  
ªt
;

158 
	}
}

162 
	$£tsock›t_ùv6_mu…iˇ°_lo›
 (
sock
, 
vÆ
)

164 
ªt
;

166 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_MULTICAST_LOOP
, &
vÆ
,

167  (
vÆ
));

168 i‡(
ªt
 < 0)

169 
	`zlog_w¨n
 ("can't setsockopt IPV6_MULTICAST_LOOP");

170  
ªt
;

171 
	}
}

174 
	$gësock›t_ùv6_ifödex
 (
msghdr
 *
msgh
)

176 
ö6_pktöfo
 *
pktöfo
;

178 
pktöfo
 = 
	`gësock›t_cmsg_d©a
 (
msgh
, 
IPPROTO_IPV6
, 
IPV6_PKTINFO
);

180  
pktöfo
->
ùi6_ifödex
;

181 
	}
}

184 
	$£tsock›t_ùv6_t˛ass
(
sock
, 
t˛ass
)

186 
ªt
 = 0;

188 #ifde‡
IPV6_TCLASS


189 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_TCLASS
, &
t˛ass
,  (tclass));

190 i‡(
ªt
 < 0)

191 
	`zlog_w¨n
 ("Can't set IPV6_TCLASS option for fd %dÅo %#x: %s",

192 
sock
, 
t˛ass
, 
	`ß„_°ªº‹
(
î∫o
));

194  
ªt
;

195 
	}
}

220 
	$£tsock›t_ùv4_mu…iˇ°
(
sock
,

221 
›äame
,

222 
mˇ°_addr
,

223 
ifödex
)

225 #ifde‡
HAVE_RFC3678


226 
group_ªq
 
gr
;

227 
sockaddr_ö
 *
si
;

228 
ªt
;

229 
	`mem£t
 (&
gr
, 0, (gr));

230 
si
 = (
sockaddr_ö
 *)&
gr
.
gr_group
;

231 
gr
.
gr_öãrÁ˚
 = 
ifödex
;

232 
si
->
sö_Ámûy
 = 
AF_INET
;

233 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


234 
si
->
sö_Àn
 = (
sockaddr_ö
);

236 
si
->
sö_addr
.
s_addr
 = 
mˇ°_addr
;

237 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IP
, (
›äame
 =
IP_ADD_MEMBERSHIP
) ?

238 
MCAST_JOIN_GROUP
 : 
MCAST_LEAVE_GROUP
, (*)&
gr
, (gr));

239 i‡((
ªt
 < 0Ë&& (
›äame
 =
IP_ADD_MEMBERSHIP
Ë&& (
î∫o
 =
EADDRINUSE
))

241 
	`£tsock›t
(
sock
, 
IPPROTO_IP
, 
MCAST_LEAVE_GROUP
, (*)&
gr
, (gr));

242 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IP
, 
MCAST_JOIN_GROUP
, (*)&
gr
, (gr));

244  
ªt
;

246 #ñi‡
	`deföed
(
HAVE_STRUCT_IP_MREQN_IMR_IFINDEX
Ë&& !deföed(
__FªeBSD__
)

247 
ù_mªqn
 
mªqn
;

248 
ªt
;

250 
	`as£π
(
›äame
 =
IP_ADD_MEMBERSHIP
 || o±«mê=
IP_DROP_MEMBERSHIP
);

251 
	`mem£t
 (&
mªqn
, 0, (mreqn));

253 
mªqn
.
imr_mu…üddr
.
s_addr
 = 
mˇ°_addr
;

254 
mªqn
.
imr_ifödex
 = 
ifödex
;

256 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IP
, 
›äame
,

257 (*)&
mªqn
, (mreqn));

258 i‡((
ªt
 < 0Ë&& (
›äame
 =
IP_ADD_MEMBERSHIP
Ë&& (
î∫o
 =
EADDRINUSE
))

261 
buf
[1][
INET_ADDRSTRLEN
];

262 
	`zlog_öfo
("setsockopt_ipv4_multicastáttemptingÅo dropánd "

264 
sock
,

265 
	`öë_¡›
(
AF_INET
, &
mªqn
.
imr_mu…üddr
,

266 
buf
[0], (buf[0])), 
ifödex
);

267 
	`£tsock›t
(
sock
, 
IPPROTO_IP
, 
IP_DROP_MEMBERSHIP
,

268 (*)&
mªqn
, (mreqn));

269 
ªt
 = 
	`£tsock›t
(
sock
, 
IPPROTO_IP
, 
IP_ADD_MEMBERSHIP
,

270 (*)&
mªqn
, (mreqn));

272  
ªt
;

279 #ñi‡
	`deföed
(
HAVE_BSD_STRUCT_IP_MREQ_HACK
)

282 
ö_addr
 
m
;

283 
ù_mªq
 
mªq
;

284 
ªt
;

286 
	`as£π
(
›äame
 =
IP_ADD_MEMBERSHIP
 || o±«mê=
IP_DROP_MEMBERSHIP
);

288 
m
.
s_addr
 = 
	`ht⁄l
(
ifödex
);

290 
	`mem£t
 (&
mªq
, 0, (mreq));

291 
mªq
.
imr_mu…üddr
.
s_addr
 = 
mˇ°_addr
;

292 
mªq
.
imr_öãrÁ˚
 = 
m
;

294 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
›äame
, (*)&
mªq
, (mreq));

295 i‡((
ªt
 < 0Ë&& (
›äame
 =
IP_ADD_MEMBERSHIP
Ë&& (
î∫o
 =
EADDRINUSE
))

298 
buf
[1][
INET_ADDRSTRLEN
];

299 
	`zlog_öfo
("setsockopt_ipv4_multicastáttemptingÅo dropánd "

301 
sock
,

302 
	`öë_¡›
(
AF_INET
, &
mªq
.
imr_mu…üddr
,

303 
buf
[0], (buf[0])), 
ifödex
);

304 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_DROP_MEMBERSHIP
,

305 (*)&
mªq
, (mreq));

306 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_ADD_MEMBERSHIP
,

307 (*)&
mªq
, (mreq));

309  
ªt
;

315 
	}
}

321 
	$£tsock›t_ùv4_mu…iˇ°_if
(
sock
,

322 
ifödex
)

325 #ifde‡
HAVE_STRUCT_IP_MREQN_IMR_IFINDEX


326 
ù_mªqn
 
mªqn
;

327 
	`mem£t
 (&
mªqn
, 0, (mreqn));

329 
mªqn
.
imr_ifödex
 = 
ifödex
;

330  
	`£tsock›t
(
sock
, 
IPPROTO_IP
, 
IP_MULTICAST_IF
, (*)&
mªqn
, (mreqn));

336 #ñi‡
	`deföed
(
HAVE_BSD_STRUCT_IP_MREQ_HACK
)

337 
ö_addr
 
m
;

339 
m
.
s_addr
 = 
	`ht⁄l
(
ifödex
);

341  
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_MULTICAST_IF
, (*)&
m
, (m));

345 
	}
}

348 
	$£tsock›t_ùv4_ifödex
 (
sock
, 
vÆ
)

350 
ªt
;

352 #i‡
	`deföed
 (
IP_PKTINFO
)

353 i‡((
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_PKTINFO
, &
vÆ
,  (val))) < 0)

354 
	`zlog_w¨n
 ("Can't set IP_PKTINFO option for fd %dÅo %d: %s",

355 
sock
,
vÆ
,
	`ß„_°ªº‹
(
î∫o
));

356 #ñi‡
	`deföed
 (
IP_RECVIF
)

357 i‡((
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_RECVIF
, &
vÆ
,  (val))) < 0)

358 
	`zlog_w¨n
 ("Can't set IP_RECVIF option for fd %dÅo %d: %s",

359 
sock
,
vÆ
,
	`ß„_°ªº‹
(
î∫o
));

365 
ªt
 = -1;

367  
ªt
;

368 
	}
}

371 
	$£tsock›t_ùv4_tos
(
sock
, 
tos
)

373 
ªt
;

375 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_TOS
, &
tos
,  (tos));

376 i‡(
ªt
 < 0)

377 
	`zlog_w¨n
 ("Can't set IP_TOS option for fd %dÅo %#x: %s",

378 
sock
, 
tos
, 
	`ß„_°ªº‹
(
î∫o
));

379  
ªt
;

380 
	}
}

384 
	$£tsock›t_ifödex
 (
af
, 
sock
, 
vÆ
)

386 
ªt
 = -1;

388 
af
)

390 
AF_INET
:

391 
ªt
 = 
	`£tsock›t_ùv4_ifödex
 (
sock
, 
vÆ
);

393 #ifde‡
HAVE_IPV6


394 
AF_INET6
:

395 
ªt
 = 
	`£tsock›t_ùv6_pktöfo
 (
sock
, 
vÆ
);

399 
	`zlog_w¨n
 ("£tsock›t_ifödex: unknow¿addªs†Ámûy %d", 
af
);

401  
ªt
;

402 
	}
}

412 
	$gësock›t_ùv4_ifödex
 (
msghdr
 *
msgh
)

415 
ifödex
 = -1;

417 #i‡
	`deföed
(
IP_PKTINFO
)

419 
ö_pktöfo
 *
pktöfo
;

421 
pktöfo
 =

422 (
ö_pktöfo
 *)
	`gësock›t_cmsg_d©a
 (
msgh
, 
IPPROTO_IP
, 
IP_PKTINFO
);

424 
ifödex
 = 
pktöfo
->
ùi_ifödex
;

426 #ñi‡
	`deföed
(
IP_RECVIF
)

430 #i‚de‡
SUNOS_5


432 
sockaddr_dl
 *
sdl
;

435 *
ifödex_p
;

438 #i‚de‡
SUNOS_5


440 
sdl
 =

441 (
sockaddr_dl
 *)
	`gësock›t_cmsg_d©a
 (
msgh
, 
IPPROTO_IP
, 
IP_RECVIF
);

442 i‡(
sdl
 !
NULL
)

443 
ifödex
 = 
sdl
->
sdl_ödex
;

445 
ifödex
 = 0;

452 
ifödex_p
 = (
uöt_t
 *)
	`gësock›t_cmsg_d©a
 (
msgh
, 
IPPROTO_IP
, 
IP_RECVIF
);

453 i‡(
ifödex_p
 !
NULL
)

454 
ifödex
 = *
ifödex_p
;

456 
ifödex
 = 0;

468 
ifödex
 = 0;

472  
ifödex
;

473 
	}
}

477 
	$gësock›t_ifödex
 (
af
, 
msghdr
 *
msgh
)

479 
af
)

481 
AF_INET
:

482  (
	`gësock›t_ùv4_ifödex
 (
msgh
));

484 #ifde‡
HAVE_IPV6


485 
AF_INET6
:

486  (
	`gësock›t_ùv6_ifödex
 (
msgh
));

490 
	`zlog_w¨n
 ("gësock›t_ifödex: unknow¿addªs†Ámûy %d", 
af
);

493 
	}
}

497 
	$sock›t_ùhdrö˛_swab_htosys
 (
ù
 *
ùh
)

502 #i‚de‡
HAVE_IP_HDRINCL_BSD_ORDER


503 
ùh
->
ù_Àn
 = 
	`ht⁄s
(iph->ip_len);

504 
ùh
->
ù_off
 = 
	`ht⁄s
(iph->ip_off);

507 
ùh
->
ù_id
 = 
	`ht⁄s
(iph->ip_id);

508 
	}
}

511 
	$sock›t_ùhdrö˛_swab_sy°oh
 (
ù
 *
ùh
)

513 #i‚de‡
HAVE_IP_HDRINCL_BSD_ORDER


514 
ùh
->
ù_Àn
 = 
	`¡ohs
(iph->ip_len);

515 
ùh
->
ù_off
 = 
	`¡ohs
(iph->ip_off);

518 
ùh
->
ù_id
 = 
	`¡ohs
(iph->ip_id);

519 
	}
}

522 
	$sock›t_t˝_sig«tuª
 (
sock
, 
sockuni⁄
 *
su
, c⁄° *
∑ssw‹d
)

524 #i‡
	`deföed
(
HAVE_TCP_MD5_LINUX24
Ë&& deföed(
GNU_LINUX
)

529 
	#TCP_MD5_AUTH
 13

	)

530 
	#TCP_MD5_AUTH_ADD
 1

	)

531 
	#TCP_MD5_AUTH_DEL
 2

	)

532 
	st˝_rfc2385_cmd
 {

533 
u_öt8_t
 
comm™d
;

534 
u_öt32_t
 
addªss
;

535 
u_öt8_t
 
keyÀn
;

536 *
key
;

537 } 
cmd
;

538 
ö_addr
 *
addr
 = &
su
->
sö
.
sö_addr
;

540 
cmd
.
comm™d
 = (
∑ssw‹d
 !
NULL
 ? 
TCP_MD5_AUTH_ADD
 : 
TCP_MD5_AUTH_DEL
);

541 
cmd
.
addªss
 = 
addr
->
s_addr
;

542 
cmd
.
keyÀn
 = (
∑ssw‹d
 !
NULL
 ? 
	`°æí
 (password) : 0);

543 
cmd
.
key
 = 
∑ssw‹d
;

545  
	`£tsock›t
 (
sock
, 
IPPROTO_TCP
, 
TCP_MD5_AUTH
, &
cmd
,  cmd);

547 #ñi‡
HAVE_DECL_TCP_MD5SIG


548 
ªt
;

549 #i‚de‡
GNU_LINUX


554 
md5sig
 = 
∑ssw‹d
 && *password ? 1 : 0;

556 
keyÀn
 = 
∑ssw‹d
 ? 
	`°æí
 (password) : 0;

557 
t˝_md5sig
 
md5sig
;

558 
sockuni⁄
 *
su2
, *
susock
;

563 i‡(!(
susock
 = 
	`sockuni⁄_gësock«me
 (
sock
)))

566 i‡(
susock
->
ß
.
ß_Ámûy
 =
su
->sa.sa_family)

567 
su2
 = 
su
;

571 
su2
 = 
susock
;

573 i‡(
su2
->
ß
.
ß_Ámûy
 =
AF_INET
)

575 
	`sockuni⁄_‰ì
 (
susock
);

579 #ifde‡
HAVE_IPV6


587 i‡(
su2
->
ß
.
ß_Ámûy
 =
AF_INET6


588 && 
su
->
ß
.
ß_Ámûy
 =
AF_INET
)

590 
su2
->
sö6
.
sö6_Ámûy
 = 
AF_INET6
;

592 
	`mem£t
 (&
su2
->
sö6
.
sö6_addr
, 0,  (
ö6_addr
));

593 
su2
->
sö6
.
sö6_addr
.
s6_addr32
[2] = 
	`ht⁄l
(0xffff);

594 
	`mem˝y
 (&
su2
->
sö6
.
sö6_addr
.
s6_addr32
[3], &
su
->
sö
.
sö_addr
, 4);

599 
	`mem£t
 (&
md5sig
, 0,  (md5sig));

600 
	`mem˝y
 (&
md5sig
.
t˝m_addr
, 
su2
,  (*su2));

601 
md5sig
.
t˝m_keyÀn
 = 
keyÀn
;

602 i‡(
keyÀn
)

603 
	`mem˝y
 (
md5sig
.
t˝m_key
, 
∑ssw‹d
, 
keyÀn
);

604 
	`sockuni⁄_‰ì
 (
susock
);

606 i‡((
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_TCP
, 
TCP_MD5SIG
, &
md5sig
,  md5sig)) < 0)

610 i‡(
ENOENT
 =
î∫o
)

611 
ªt
 = 0;

613 
	`zlog_îr
 ("sockopt_tcp_signature: setsockopt(%d): %s",

614 
sock
, 
	`ß„_°ªº‹
(
î∫o
));

616  
ªt
;

620 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockopt.h

22 #i‚de‡
_ZEBRA_SOCKOPT_H


23 
	#_ZEBRA_SOCKOPT_H


	)

25 
	~"sockuni⁄.h
"

27 
£tsock›t_so_ªcvbuf
 (
sock
, 
size
);

28 
£tsock›t_so_£ndbuf
 (c⁄° 
sock
, 
size
);

29 
gësock›t_so_£ndbuf
 (c⁄° 
sock
);

31 #ifde‡
HAVE_IPV6


32 
£tsock›t_ùv6_pktöfo
 (, );

33 
£tsock›t_ùv6_checksum
 (, );

34 
£tsock›t_ùv6_mu…iˇ°_h›s
 (, );

35 
£tsock›t_ùv6_uniˇ°_h›s
 (, );

36 
£tsock›t_ùv6_h›limô
 (, );

37 
£tsock›t_ùv6_mu…iˇ°_lo›
 (, );

38 
£tsock›t_ùv6_t˛ass
 (, );

46 
	#SOPT_SIZE_CMSG_PKTINFO_IPV6
(Ë( (
ö6_pktöfo
));

	)

54 #i‡
deföed
 (
IP_PKTINFO
)

56 
	#SOPT_SIZE_CMSG_PKTINFO_IPV4
(Ë(
	`CMSG_SPACE
( (
ö_pktöfo
)))

	)

58 
	#SOPT_SIZE_CMSG_PKTINFO
(
af
) \

59 ((
af
 =
AF_INET
Ë? 
	`SOPT_SIZE_CMSG_PKTINFO_IPV4
() \

60 : 
	`SOPT_SIZE_CMSG_PKTINFO_IPV6
()

	)

63 #i‡
deföed
 (
IP_RECVIF
)

66 #i‡
deföed
 (
SUNOS_5
)

67 
	#SOPT_SIZE_CMSG_RECVIF_IPV4
(Ë( (
uöt_t
))

	)

69 
	#SOPT_SIZE_CMSG_RECVIF_IPV4
(Ë( (
sockaddr_dl
))

	)

74 #i‡
deföed
 (
SOPT_SIZE_CMSG_PKTINFO
)

75 
	#SOPT_SIZE_CMSG_IFINDEX_IPV4
(Ë
	`SOPT_SIZE_CMSG_PKTINFO_IPV4
()

	)

76 #ñi‡
deföed
 (
SOPT_SIZE_CMSG_RECVIF_IPV4
)

77 
	#SOPT_SIZE_CMSG_IFINDEX_IPV4
(Ë
	`SOPT_SIZE_CMSG_RECVIF_IPV4
()

	)

79 
	#SOPT_SIZE_CMSG_IFINDEX_IPV4
(Ë( (*))

	)

82 
	#SOPT_SIZE_CMSG_IFINDEX
(
af
) \

83 (((
af
Ë=
AF_INET
Ë: 
	`SOPT_SIZE_CMSG_IFINDEX_IPV4
() \

84 ? 
	`SOPT_SIZE_CMSG_PKTINFO_IPV6
())

	)

86 
£tsock›t_ùv4_mu…iˇ°_if
(
sock
,

87 
ifödex
);

88 
£tsock›t_ùv4_mu…iˇ°
(
sock
, 
›äame
,

89 
mˇ°_addr
,

90 
ifödex
);

91 
£tsock›t_ùv4_tos
(
sock
, 
tos
);

94 
£tsock›t_ifödex
 (, , );

95 
gësock›t_ifödex
 (, 
msghdr
 *);

100 
sock›t_ùhdrö˛_swab_htosys
 (
ù
 *
ùh
);

101 
sock›t_ùhdrö˛_swab_sy°oh
 (
ù
 *
ùh
);

103 
sock›t_t˝_sig«tuª
(
sock
, 
sockuni⁄
 *
su
,

104 c⁄° *
∑ssw‹d
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockunion.c

22 
	~<zebø.h
>

24 
	~"¥efix.h
"

25 
	~"vty.h
"

26 
	~"sockuni⁄.h
"

27 
	~"mem‹y.h
"

28 
	~"°r.h
"

29 
	~"log.h
"

31 #i‚de‡
HAVE_INET_ATON


33 
	$öë_©⁄
 (c⁄° *
˝
, 
ö_addr
 *
öaddr
)

35 
dŸs
 = 0;

36 
u_l⁄g
 
addr
 = 0;

37 
u_l⁄g
 
vÆ
 = 0, 
ba£
 = 10;

41 
c
 = *
˝
;

43 
c
)

47 
vÆ
 = (vÆ * 
ba£
Ë+ (
c
 - '0');

50 i‡(++
dŸs
 > 3)

53 i‡(
vÆ
 > 255)

55 
addr
 =ádd∏<< 8 | 
vÆ
;

56 
vÆ
 = 0;

61 } *
˝
++) ;

63 i‡(
dŸs
 < 3)

64 
addr
 <<8 * (3 - 
dŸs
);

65 i‡(
öaddr
)

66 
öaddr
->
s_addr
 = 
	`ht⁄l
 (
addr
);

68 
	}
}

72 #i‚de‡
HAVE_INET_PTON


74 
	$öë_±⁄
 (
Ámûy
, c⁄° *
°Ωå
, *
addΩå
)

76 i‡(
Ámûy
 =
AF_INET
)

78 
ö_addr
 
ö_vÆ
;

80 i‡(
	`öë_©⁄
 (
°Ωå
, &
ö_vÆ
))

82 
	`mem˝y
 (
addΩå
, &
ö_vÆ
,  (
ö_addr
));

87 
î∫o
 = 
EAFNOSUPPORT
;

89 
	}
}

92 #i‚de‡
HAVE_INET_NTOP


94 
	$öë_¡›
 (
Ámûy
, c⁄° *
addΩå
, *
°Ωå
, 
size_t
 
Àn
)

96 *
p
 = (*Ë
addΩå
;

98 i‡(
Ámûy
 =
AF_INET
)

100 
ãmp
[
INET_ADDRSTRLEN
];

102 
	`¢¥ötf
(
ãmp
, —emp), "%d.%d.%d.%d", 
p
[0],Ö[1],Ö[2],Ö[3]);

104 i‡(
	`°æí
(
ãmp
Ë>
Àn
)

106 
î∫o
 = 
ENOSPC
;

107  
NULL
;

109 
	`°r˝y
(
°Ωå
, 
ãmp
);

110  
°Ωå
;

113 
î∫o
 = 
EAFNOSUPPORT
;

114  
NULL
;

115 
	}
}

119 
	$öë_sut›
 (
sockuni⁄
 *
su
, *
°r
)

121 
su
->
ß
.
ß_Ámûy
)

123 
AF_INET
:

124 
	`öë_¡›
 (
AF_INET
, &
su
->
sö
.
sö_addr
, 
°r
, 
INET_ADDRSTRLEN
);

126 #ifde‡
HAVE_IPV6


127 
AF_INET6
:

128 
	`öë_¡›
 (
AF_INET6
, &
su
->
sö6
.
sö6_addr
, 
°r
, 
INET6_ADDRSTRLEN
);

132  
°r
;

133 
	}
}

136 
	$°r2sockuni⁄
 (c⁄° *
°r
, 
sockuni⁄
 *
su
)

138 
ªt
;

140 
	`mem£t
 (
su
, 0,  (
sockuni⁄
));

142 
ªt
 = 
	`öë_±⁄
 (
AF_INET
, 
°r
, &
su
->
sö
.
sö_addr
);

143 i‡(
ªt
 > 0)

145 
su
->
sö
.
sö_Ámûy
 = 
AF_INET
;

146 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


147 
su
->
sö
.
sö_Àn
 = (
sockaddr_ö
);

151 #ifde‡
HAVE_IPV6


152 
ªt
 = 
	`öë_±⁄
 (
AF_INET6
, 
°r
, &
su
->
sö6
.
sö6_addr
);

153 i‡(
ªt
 > 0)

155 
su
->
sö6
.
sö6_Ámûy
 = 
AF_INET6
;

156 #ifde‡
SIN6_LEN


157 
su
->
sö6
.
sö6_Àn
 = (
sockaddr_ö6
);

163 
	}
}

166 
	$sockuni⁄2°r
 (
sockuni⁄
 *
su
, *
buf
, 
size_t
 
Àn
)

168 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET
)

169  
	`öë_¡›
 (
AF_INET
, &
su
->
sö
.
sö_addr
, 
buf
, 
Àn
);

170 #ifde‡
HAVE_IPV6


171 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET6
)

172  
	`öë_¡›
 (
AF_INET6
, &
su
->
sö6
.
sö6_addr
, 
buf
, 
Àn
);

174  
NULL
;

175 
	}
}

177 
sockuni⁄
 *

178 
	$sockuni⁄_°r2su
 (c⁄° *
°r
)

180 
sockuni⁄
 *
su
 = 
	`XCALLOC
 (
MTYPE_SOCKUNION
,  (sockunion));

182 i‡(!
	`°r2sockuni⁄
 (
°r
, 
su
))

183  
su
;

185 
	`XFREE
 (
MTYPE_SOCKUNION
, 
su
);

186  
NULL
;

187 
	}
}

191 
	$sockuni⁄_n‹mÆi£_m≠≥d
 (
sockuni⁄
 *
su
)

193 
sockaddr_ö
 
sö
;

195 #ifde‡
HAVE_IPV6


196 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET6


197 && 
	`IN6_IS_ADDR_V4MAPPED
 (&
su
->
sö6
.
sö6_addr
))

199 
	`mem£t
 (&
sö
, 0,  (
sockaddr_ö
));

200 
sö
.
sö_Ámûy
 = 
AF_INET
;

201 
sö
.
sö_p‹t
 = 
su
->
sö6
.
sö6_p‹t
;

202 
	`mem˝y
 (&
sö
.
sö_addr
, ((*)&
su
->
sö6
.
sö6_addr
) + 12, 4);

203 
	`mem˝y
 (
su
, &
sö
,  (
sockaddr_ö
));

206 
	}
}

210 
	$sockuni⁄_sockë
 (
sockuni⁄
 *
su
)

212 
sock
;

214 
sock
 = 
	`sockë
 (
su
->
ß
.
ß_Ámûy
, 
SOCK_STREAM
, 0);

215 i‡(
sock
 < 0)

217 
	`zlog
 (
NULL
, 
LOG_WARNING
, "C™'àmakêsockë : %s", 
	`ß„_°ªº‹
 (
î∫o
));

221  
sock
;

222 
	}
}

226 
	$sockuni⁄_ac˚±
 (
sock
, 
sockuni⁄
 *
su
)

228 
sockÀn_t
 
Àn
;

229 
˛õ¡_sock
;

231 
Àn
 =  (
sockuni⁄
);

232 
˛õ¡_sock
 = 
	`ac˚±
 (
sock
, (
sockaddr
 *Ë
su
, &
Àn
);

234 
	`sockuni⁄_n‹mÆi£_m≠≥d
 (
su
);

235  
˛õ¡_sock
;

236 
	}
}

240 
	$sockuni⁄_sizeof
 (
sockuni⁄
 *
su
)

242 
ªt
;

244 
ªt
 = 0;

245 
su
->
ß
.
ß_Ámûy
)

247 
AF_INET
:

248 
ªt
 =  (
sockaddr_ö
);

250 #ifde‡
HAVE_IPV6


251 
AF_INET6
:

252 
ªt
 =  (
sockaddr_ö6
);

256  
ªt
;

257 
	}
}

261 
	$sockuni⁄_log
 (
sockuni⁄
 *
su
, *
buf
, 
size_t
 
Àn
)

263 
su
->
ß
.
ß_Ámûy
)

265 
AF_INET
:

266  
	`öë_¡›
(
AF_INET
, &
su
->
sö
.
sö_addr
, 
buf
, 
Àn
);

268 #ifde‡
HAVE_IPV6


269 
AF_INET6
:

270  
	`öë_¡›
(
AF_INET6
, &(
su
->
sö6
.
sö6_addr
), 
buf
, 
Àn
);

275 
	`¢¥ötf
 (
buf
, 
Àn
, "af_unknow¿%d ", 
su
->
ß
.
ß_Ámûy
);

276  
buf
;

278 
	}
}

284 
c⁄√˘_ªsu…


285 
	$sockuni⁄_c⁄√˘
 (
fd
, 
sockuni⁄
 *
≥îsu
, 
p‹t
,

286 
ifödex
)

288 
ªt
;

289 
vÆ
;

290 
sockuni⁄
 
su
;

292 
	`mem˝y
 (&
su
, 
≥îsu
,  (
sockuni⁄
));

294 
su
.
ß
.
ß_Ámûy
)

296 
AF_INET
:

297 
su
.
sö
.
sö_p‹t
 = 
p‹t
;

299 #ifde‡
HAVE_IPV6


300 
AF_INET6
:

301 
su
.
sö6
.
sö6_p‹t
 = 
p‹t
;

302 #ifde‡
KAME


303 i‡(
	`IN6_IS_ADDR_LINKLOCAL
(&
su
.
sö6
.
sö6_addr
Ë&& 
ifödex
)

305 #ifde‡
HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID


307 #ifde‡
MUSICA


308 
su
.
sö6
.
sö6_sc›e_id
 = 
ifödex
;

311 #i‚de‡
MUSICA


312 
	`SET_IN6_LINKLOCAL_IFINDEX
 (
su
.
sö6
.
sö6_addr
, 
ifödex
);

321 
vÆ
 = 
	`f˙é
 (
fd
, 
F_GETFL
, 0);

322 
	`f˙é
 (
fd
, 
F_SETFL
, 
vÆ
|
O_NONBLOCK
);

325 
ªt
 = 
	`c⁄√˘
 (
fd
, (
sockaddr
 *Ë&
su
, 
	`sockuni⁄_sizeof
 (&su));

328 i‡(
ªt
 == 0)

330 
	`f˙é
 (
fd
, 
F_SETFL
, 
vÆ
);

331  
c⁄√˘_suc˚ss
;

335 i‡(
ªt
 < 0)

337 i‡(
î∫o
 !
EINPROGRESS
)

339 
°r
[
SU_ADDRSTRLEN
];

340 
	`zlog_öfo
 ("can't connectÅo %s fd %d : %s",

341 
	`sockuni⁄_log
 (&
su
, 
°r
,  str),

342 
fd
, 
	`ß„_°ªº‹
 (
î∫o
));

343  
c⁄√˘_îr‹
;

347 
	`f˙é
 (
fd
, 
F_SETFL
, 
vÆ
);

349  
c⁄√˘_ö_¥ogªss
;

350 
	}
}

354 
	$sockuni⁄_°ªam_sockë
 (
sockuni⁄
 *
su
)

356 
sock
;

358 i‡(
su
->
ß
.
ß_Ámûy
 == 0)

359 
su
->
ß
.
ß_Ámûy
 = 
AF_INET_UNION
;

361 
sock
 = 
	`sockë
 (
su
->
ß
.
ß_Ámûy
, 
SOCK_STREAM
, 0);

363 i‡(
sock
 < 0)

364 
	`zlog
 (
NULL
, 
LOG_WARNING
, "can't make socket sockunion_stream_socket");

366  
sock
;

367 
	}
}

371 
	$sockuni⁄_böd
 (
sock
, 
sockuni⁄
 *
su
, 
p‹t
,

372 
sockuni⁄
 *
su_addr
)

374 
size
 = 0;

375 
ªt
;

377 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET
)

379 
size
 =  (
sockaddr_ö
);

380 
su
->
sö
.
sö_p‹t
 = 
	`ht⁄s
 (
p‹t
);

381 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


382 
su
->
sö
.
sö_Àn
 = 
size
;

384 i‡(
su_addr
 =
NULL
)

385 
	`sockuni⁄2ù
 (
su
Ë
	`ht⁄l
 (
INADDR_ANY
);

387 #ifde‡
HAVE_IPV6


388 i‡(
su
->
ß
.
ß_Ámûy
 =
AF_INET6
)

390 
size
 =  (
sockaddr_ö6
);

391 
su
->
sö6
.
sö6_p‹t
 = 
	`ht⁄s
 (
p‹t
);

392 #ifde‡
SIN6_LEN


393 
su
->
sö6
.
sö6_Àn
 = 
size
;

395 i‡(
su_addr
 =
NULL
)

397 #i‡
	`deföed
(
LINUX_IPV6
Ë|| deföed(
NRL
)

398 
	`mem£t
 (&
su
->
sö6
.
sö6_addr
, 0,  (
ö6_addr
));

400 
su
->
sö6
.
sö6_addr
 = 
ö6addr_™y
;

407 
ªt
 = 
	`böd
 (
sock
, (
sockaddr
 *)
su
, 
size
);

408 i‡(
ªt
 < 0)

409 
	`zlog
 (
NULL
, 
LOG_WARNING
, "ˇn'àböd sockë : %s", 
	`ß„_°ªº‹
 (
î∫o
));

411  
ªt
;

412 
	}
}

415 
	$sock›t_ªu£addr
 (
sock
)

417 
ªt
;

418 
⁄
 = 1;

420 
ªt
 = 
	`£tsock›t
 (
sock
, 
SOL_SOCKET
, 
SO_REUSEADDR
,

421 (*Ë&
⁄
,  (on));

422 i‡(
ªt
 < 0)

424 
	`zlog
 (
NULL
, 
LOG_WARNING
, "ˇn'à£àsock›àSO_REUSEADDRÅÿsockë %d", 
sock
);

428 
	}
}

430 #ifde‡
SO_REUSEPORT


432 
	$sock›t_ªu£p‹t
 (
sock
)

434 
ªt
;

435 
⁄
 = 1;

437 
ªt
 = 
	`£tsock›t
 (
sock
, 
SOL_SOCKET
, 
SO_REUSEPORT
,

438 (*Ë&
⁄
,  (on));

439 i‡(
ªt
 < 0)

441 
	`zlog
 (
NULL
, 
LOG_WARNING
, "ˇn'à£àsock›àSO_REUSEPORTÅÿsockë %d", 
sock
);

445 
	}
}

448 
	$sock›t_ªu£p‹t
 (
sock
)

451 
	}
}

455 
	$sock›t_âl
 (
Ámûy
, 
sock
, 
âl
)

457 
ªt
;

459 #ifde‡
IP_TTL


460 i‡(
Ámûy
 =
AF_INET
)

462 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_TTL
,

463 (*Ë&
âl
,  ());

464 i‡(
ªt
 < 0)

466 
	`zlog
 (
NULL
, 
LOG_WARNING
, "ˇn'à£àsock›àIP_TTL %dÅÿsockë %d", 
âl
, 
sock
);

472 #ifde‡
HAVE_IPV6


473 i‡(
Ámûy
 =
AF_INET6
)

475 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_UNICAST_HOPS
,

476 (*Ë&
âl
,  ());

477 i‡(
ªt
 < 0)

479 
	`zlog
 (
NULL
, 
LOG_WARNING
, "can't set sockopt IPV6_UNICAST_HOPS %dÅo socket %d",

480 
âl
, 
sock
);

487 
	}
}

490 
	$sock›t_c‹k
 (
sock
, 
⁄off
)

492 #ifde‡
TCP_CORK


493  
	`£tsock›t
 (
sock
, 
IPPROTO_TCP
, 
TCP_CORK
, &
⁄off
, (onoff));

497 
	}
}

500 
	$sock›t_möâl
 (
Ámûy
, 
sock
, 
möâl
)

502 #ifde‡
IP_MINTTL


503 i‡(
Ámûy
 =
AF_INET
)

505 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_MINTTL
, &
möâl
, (minttl));

506 i‡(
ªt
 < 0)

507 
	`zlog
 (
NULL
, 
LOG_WARNING
,

509 
möâl
, 
sock
, 
	`ß„_°ªº‹
 (
î∫o
));

510  
ªt
;

513 #ifde‡
IPV6_MINHOPCNT


514 i‡(
Ámûy
 =
AF_INET6
)

516 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_MINHOPCNT
, &
möâl
, (minttl));

517 i‡(
ªt
 < 0)

518 
	`zlog
 (
NULL
, 
LOG_WARNING
,

520 
möâl
, 
sock
, 
	`ß„_°ªº‹
 (
î∫o
));

521  
ªt
;

525 
î∫o
 = 
EOPNOTSUPP
;

527 
	}
}

530 
	$sock›t_v6⁄ly
 (
Ámûy
, 
sock
)

532 
ªt
, 
⁄
 = 1;

534 #ifde‡
HAVE_IPV6


535 #ifde‡
IPV6_V6ONLY


536 i‡(
Ámûy
 =
AF_INET6
)

538 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_V6ONLY
,

539 (*Ë&
⁄
,  ());

540 i‡(
ªt
 < 0)

542 
	`zlog
 (
NULL
, 
LOG_WARNING
, "can't set sockopt IPV6_V6ONLY "

543 "tÿsockë %d", 
sock
);

551 
	}
}

555 
	$sockuni⁄_ßme
 (
sockuni⁄
 *
su1
, sockuni⁄ *
su2
)

557 
ªt
 = 0;

559 i‡(
su1
->
ß
.
ß_Ámûy
 !
su2
->sa.sa_family)

562 
su1
->
ß
.
ß_Ámûy
)

564 
AF_INET
:

565 
ªt
 = 
	`memcmp
 (&
su1
->
sö
.
sö_addr
, &
su2
->sin.sin_addr,

566  (
ö_addr
));

568 #ifde‡
HAVE_IPV6


569 
AF_INET6
:

570 
ªt
 = 
	`memcmp
 (&
su1
->
sö6
.
sö6_addr
, &
su2
->sin6.sin6_addr,

571  (
ö6_addr
));

575 i‡(
ªt
 == 0)

579 
	}
}

582 
sockuni⁄
 *

583 
	$sockuni⁄_gësock«me
 (
fd
)

585 
ªt
;

586 
sockÀn_t
 
Àn
;

589 
sockaddr
 
ß
;

590 
sockaddr_ö
 
sö
;

591 #ifde‡
HAVE_IPV6


592 
sockaddr_ö6
 
sö6
;

594 
tmp_buf„r
[128];

595 } 
«me
;

596 
sockuni⁄
 *
su
;

598 
	`mem£t
 (&
«me
, 0, Çame);

599 
Àn
 =  
«me
;

601 
ªt
 = 
	`gësock«me
 (
fd
, (
sockaddr
 *)&
«me
, &
Àn
);

602 i‡(
ªt
 < 0)

604 
	`zlog_w¨n
 ("Can't getÜocaláddressándÖort by getsockname: %s",

605 
	`ß„_°ªº‹
 (
î∫o
));

606  
NULL
;

609 i‡(
«me
.
ß
.
ß_Ámûy
 =
AF_INET
)

611 
su
 = 
	`XCALLOC
 (
MTYPE_SOCKUNION
,  (
sockuni⁄
));

612 
	`mem˝y
 (
su
, &
«me
,  (
sockaddr_ö
));

613  
su
;

615 #ifde‡
HAVE_IPV6


616 i‡(
«me
.
ß
.
ß_Ámûy
 =
AF_INET6
)

618 
su
 = 
	`XCALLOC
 (
MTYPE_SOCKUNION
,  (
sockuni⁄
));

619 
	`mem˝y
 (
su
, &
«me
,  (
sockaddr_ö6
));

620 
	`sockuni⁄_n‹mÆi£_m≠≥d
 (
su
);

621  
su
;

624  
NULL
;

625 
	}
}

628 
sockuni⁄
 *

629 
	$sockuni⁄_gë≥î«me
 (
fd
)

631 
ªt
;

632 
sockÀn_t
 
Àn
;

635 
sockaddr
 
ß
;

636 
sockaddr_ö
 
sö
;

637 #ifde‡
HAVE_IPV6


638 
sockaddr_ö6
 
sö6
;

640 
tmp_buf„r
[128];

641 } 
«me
;

642 
sockuni⁄
 *
su
;

644 
	`mem£t
 (&
«me
, 0, Çame);

645 
Àn
 =  
«me
;

646 
ªt
 = 
	`gë≥î«me
 (
fd
, (
sockaddr
 *)&
«me
, &
Àn
);

647 i‡(
ªt
 < 0)

649 
	`zlog
 (
NULL
, 
LOG_WARNING
, "Can't getÑemoteáddressándÖort: %s",

650 
	`ß„_°ªº‹
 (
î∫o
));

651  
NULL
;

654 i‡(
«me
.
ß
.
ß_Ámûy
 =
AF_INET
)

656 
su
 = 
	`XCALLOC
 (
MTYPE_SOCKUNION
,  (
sockuni⁄
));

657 
	`mem˝y
 (
su
, &
«me
,  (
sockaddr_ö
));

658  
su
;

660 #ifde‡
HAVE_IPV6


661 i‡(
«me
.
ß
.
ß_Ámûy
 =
AF_INET6
)

663 
su
 = 
	`XCALLOC
 (
MTYPE_SOCKUNION
,  (
sockuni⁄
));

664 
	`mem˝y
 (
su
, &
«me
,  (
sockaddr_ö6
));

665 
	`sockuni⁄_n‹mÆi£_m≠≥d
 (
su
);

666  
su
;

669  
NULL
;

670 
	}
}

673 
__©åibuã__
 ((
unu£d
))

674 
	$sockuni⁄_¥öt
 (
sockuni⁄
 *
su
)

676 i‡(
su
 =
NULL
)

679 
su
->
ß
.
ß_Ámûy
)

681 
AF_INET
:

682 
	`¥ötf
 ("%s\n", 
	`öë_¡ﬂ
 (
su
->
sö
.
sö_addr
));

684 #ifde‡
HAVE_IPV6


685 
AF_INET6
:

687 
buf
 [
SU_ADDRSTRLEN
];

689 
	`¥ötf
 ("%s\n", 
	`öë_¡›
 (
AF_INET6
, &(
su
->
sö6
.
sö6_addr
),

690 
buf
,  (buf)));

695 #ifde‡
AF_LINK


696 
AF_LINK
:

698 
sockaddr_dl
 *
sdl
;

700 
sdl
 = (
sockaddr_dl
 *)&(
su
->
ß
);

701 
	`¥ötf
 ("lök#%d\n", 
sdl
->
sdl_ödex
);

706 
	`¥ötf
 ("af_unknow¿%d\n", 
su
->
ß
.
ß_Ámûy
);

709 
	}
}

711 #ifde‡
HAVE_IPV6


713 
	$ö6addr_cmp
 (
ö6_addr
 *
addr1
, ö6_add∏*
addr2
)

715 
i
;

716 
u_ch¨
 *
p1
, *
p2
;

718 
p1
 = (
u_ch¨
 *)
addr1
;

719 
p2
 = (
u_ch¨
 *)
addr2
;

721 
i
 = 0; i <  (
ö6_addr
); i++)

723 i‡(
p1
[
i
] > 
p2
[i])

725 i‡(
p1
[
i
] < 
p2
[i])

729 
	}
}

733 
	$sockuni⁄_cmp
 (
sockuni⁄
 *
su1
, sockuni⁄ *
su2
)

735 i‡(
su1
->
ß
.
ß_Ámûy
 > 
su2
->sa.sa_family)

737 i‡(
su1
->
ß
.
ß_Ámûy
 < 
su2
->sa.sa_family)

740 i‡(
su1
->
ß
.
ß_Ámûy
 =
AF_INET
)

742 i‡(
	`¡ohl
 (
	`sockuni⁄2ù
 (
su1
)Ë=¡oh»(sockuni⁄2ù (
su2
)))

744 i‡(
	`¡ohl
 (
	`sockuni⁄2ù
 (
su1
)Ë>Çtoh»(sockuni⁄2ù (
su2
)))

749 #ifde‡
HAVE_IPV6


750 i‡(
su1
->
ß
.
ß_Ámûy
 =
AF_INET6
)

751  
	`ö6addr_cmp
 (&
su1
->
sö6
.
sö6_addr
, &
su2
->sin6.sin6_addr);

754 
	}
}

757 
sockuni⁄
 *

758 
	$sockuni⁄_dup
 (
sockuni⁄
 *
su
)

760 
sockuni⁄
 *
dup
 = 
	`XCALLOC
 (
MTYPE_SOCKUNION
,  (sockunion));

761 
	`mem˝y
 (
dup
, 
su
,  (
sockuni⁄
));

762  
dup
;

763 
	}
}

766 
	$sockuni⁄_‰ì
 (
sockuni⁄
 *
su
)

768 
	`XFREE
 (
MTYPE_SOCKUNION
, 
su
);

769 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockunion.h

23 #i‚de‡
_ZEBRA_SOCKUNION_H


24 
	#_ZEBRA_SOCKUNION_H


	)

27 
	usockuni⁄
 {

28 
	ssocköë
 {

29 
u_ch¨
 
	msi_Àn
;

30 
u_ch¨
 
	msi_Ámûy
;

31 
u_sh‹t
 
	msi_p‹t
;

32 } 
	msu_si
;

33 
sockaddr_ö
 
	msu_sö
;

34 
sockaddr_ö6
 
	msu_sö6
;

36 
	#su_Àn
 
su_si
.
si_Àn


	)

37 
	#su_Ámûy
 
su_si
.
si_Ámûy


	)

38 
	#su_p‹t
 
su_si
.
si_p‹t


	)

41 
	usockuni⁄


43 
sockaddr
 
	mß
;

44 
sockaddr_ö
 
	msö
;

45 #ifde‡
HAVE_IPV6


46 
sockaddr_ö6
 
	msö6
;

50 
	ec⁄√˘_ªsu…


52 
	mc⁄√˘_îr‹
,

53 
	mc⁄√˘_suc˚ss
,

54 
	mc⁄√˘_ö_¥ogªss


58 #ifde‡
HAVE_IPV6


59 
	#AF_INET_UNION
 
AF_INET6


	)

61 
	#AF_INET_UNION
 
AF_INET


	)

65 
	#SU_ADDRSTRLEN
 46

	)

69 #ifde‡
KAME


70 
	#IN6_LINKLOCAL_IFINDEX
(
a
Ë(◊).
s6_addr
[2] << 8 | (a).s6_addr[3])

	)

71 
	#SET_IN6_LINKLOCAL_IFINDEX
(
a
, 
i
) \

73 (
a
).
s6_addr
[2] = ((
i
) >> 8) & 0xff; \

74 (
a
).
s6_addr
[3] = (
i
) & 0xff; \

75 } 0)

	)

77 
	#IN6_LINKLOCAL_IFINDEX
(
a
)

	)

78 
	#SET_IN6_LINKLOCAL_IFINDEX
(
a
, 
i
)

	)

81 
	#sockuni⁄_Ámûy
(
X
Ë(X)->
ß
.
ß_Ámûy


	)

83 
	#sockuni⁄2ù
(
X
Ë(X)->
sö
.
sö_addr
.
s_addr


	)

86 
°r2sockuni⁄
 (c⁄° *, 
sockuni⁄
 *);

87 c⁄° *
sockuni⁄2°r
 (
sockuni⁄
 *, *, 
size_t
);

88 
sockuni⁄_cmp
 (
sockuni⁄
 *, sockunion *);

89 
sockuni⁄_ßme
 (
sockuni⁄
 *, sockunion *);

91 
sockuni⁄
 *
sockuni⁄_°r2su
 (c⁄° *
°r
);

92 
sockuni⁄_ac˚±
 (
sock
, 
sockuni⁄
 *);

93 
sockuni⁄_°ªam_sockë
 (
sockuni⁄
 *);

94 
sock›t_ªu£addr
 ();

95 
sock›t_ªu£p‹t
 ();

96 
sock›t_v6⁄ly
 (
Ámûy
, 
sock
);

97 
sockuni⁄_böd
 (
sock
, 
sockuni⁄
 *,

98 , 
sockuni⁄
 *);

99 
sock›t_âl
 (
Ámûy
, 
sock
, 
âl
);

100 
sock›t_möâl
 (
Ámûy
, 
sock
, 
möâl
);

101 
sock›t_c‹k
 (
sock
, 
⁄off
);

102 
sockuni⁄_sockë
 (
sockuni⁄
 *
su
);

103 c⁄° *
öë_sut›
 (
sockuni⁄
 *
su
, *
°r
);

104 
c⁄√˘_ªsu…
 
sockuni⁄_c⁄√˘
 (
fd
, 
sockuni⁄
 *
su
,

105 
p‹t
,

107 
sockuni⁄
 *
sockuni⁄_gësock«me
 ();

108 
sockuni⁄
 *
sockuni⁄_gë≥î«me
 ();

109 
sockuni⁄
 *
sockuni⁄_dup
 (sockunion *);

110 
sockuni⁄_‰ì
 (
sockuni⁄
 *);

112 #i‚de‡
HAVE_INET_NTOP


113 c⁄° * 
öë_¡›
 (
Ámûy
, c⁄° *
addΩå
,

114 *
°Ωå
, 
size_t
 
Àn
);

117 #i‚de‡
HAVE_INET_PTON


118 
öë_±⁄
 (
Ámûy
, c⁄° *
°Ωå
, *
addΩå
);

121 #i‚de‡
HAVE_INET_ATON


122 
öë_©⁄
 (c⁄° *
˝
, 
ö_addr
 *
öaddr
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/str.c

20 
	~<zebø.h
>

22 #i‚de‡
HAVE_SNPRINTF


28 
	$¢¥ötf
(*
°r
, 
size_t
 
size
, c⁄° *
f‹m©
, ...)

30 
va_li°
 
¨gs
;

32 
	`va_°¨t
 (
¨gs
, 
f‹m©
);

34  
	`v•rötf
 (
°r
, 
f‹m©
, 
¨gs
);

35 
	}
}

38 #i‚de‡
HAVE_STRLCPY


47 
size_t


48 
	$°æ˝y
(*
d
, c⁄° *
s
, 
size_t
 
bufsize
)

50 
size_t
 
Àn
 = 
	`°æí
(
s
);

51 
size_t
 
ªt
 = 
Àn
;

52 i‡(
bufsize
 > 0) {

53 i‡(
Àn
 >
bufsize
)

54 
Àn
 = 
bufsize
-1;

55 
	`mem˝y
(
d
, 
s
, 
Àn
);

56 
d
[
Àn
] = 0;

58  
ªt
;

59 
	}
}

62 #i‚de‡
HAVE_STRLCAT


70 
size_t


71 
	$°æˇt
(*
d
, c⁄° *
s
, 
size_t
 
bufsize
)

73 
size_t
 
Àn1
 = 
	`°æí
(
d
);

74 
size_t
 
Àn2
 = 
	`°æí
(
s
);

75 
size_t
 
ªt
 = 
Àn1
 + 
Àn2
;

77 i‡(
Àn1
 < 
bufsize
 - 1) {

78 i‡(
Àn2
 >
bufsize
 - 
Àn1
)

79 
Àn2
 = 
bufsize
 - 
Àn1
 - 1;

80 
	`mem˝y
(
d
+
Àn1
, 
s
, 
Àn2
);

81 
d
[
Àn1
+
Àn2
] = 0;

83  
ªt
;

84 
	}
}

87 #i‚de‡
HAVE_STRNLEN


88 
size_t


89 
	$°∫Àn
(c⁄° *
s
, 
size_t
 
maxÀn
)

91 c⁄° *
p
;

92  (
p
 = (c⁄° *)
	`memchr
(
s
, '\0', 
maxÀn
)Ë? (
size_t
)(p-s) : maxlen;

93 
	}
}

96 #i‚de‡
HAVE_STRNDUP


98 
	$°∫dup
 (c⁄° *
s
, 
size_t
 
maxÀn
)

100 
size_t
 
Àn
 = 
	`°∫Àn
 (
s
, 
maxÀn
);

101 *
√w
 = (*Ë
	`mÆloc
 (
Àn
 + 1);

103 i‡(
√w
 =
NULL
)

104  
NULL
;

106 
√w
[
Àn
] = '\0';

107  (*Ë
	`mem˝y
 (
√w
, 
s
, 
Àn
);

108 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/str.h

5 #i‚de‡
_ZEBRA_STR_H


6 
	#_ZEBRA_STR_H


	)

8 #i‚de‡
HAVE_SNPRINTF


9 
¢¥ötf
(*, 
size_t
, const *, ...);

12 #i‚de‡
HAVE_VSNPRINTF


13 
	#v¢¥ötf
(
buf
, 
size
, 
f‹m©
, 
¨gs
Ë
	`v•rötf
(buf, f‹m©,árgs)

	)

16 #i‚de‡
HAVE_STRLCPY


17 
size_t
 
°æ˝y
(*, const *, size_t);

20 #i‚de‡
HAVE_STRLCAT


21 
size_t
 
°æˇt
(*, const *, size_t);

24 #i‚de‡
HAVE_STRNLEN


25 
size_t
 
°∫Àn
(c⁄° *
s
, size_à
maxÀn
);

28 #i‚de‡
HAVE_STRNDUP


29 * 
°∫dup
 (c⁄° *, 
size_t
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/stream.c

23 
	~<°ddef.h
>

24 
	~<zebø.h
>

26 
	~"°ªam.h
"

27 
	~"mem‹y.h
"

28 
	~"√tw‹k.h
"

29 
	~"¥efix.h
"

30 
	~"log.h
"

33 
	#GETP_VALID
(
S
,
G
) \

34 ((
G
Ë<(
S
)->
ídp
)

	)

35 
	#PUT_AT_VALID
(
S
,
G
Ë
	`GETP_VALID
(S,G)

	)

36 
	#ENDP_VALID
(
S
,
E
) \

37 ((
E
Ë<(
S
)->
size
)

	)

54 
	#STREAM_WARN_OFFSETS
(
S
) \

55 
	`zlog_w¨n
 ("&(struct stream): %p, size: %lu, getp: %lu,Éndp: %lu\n", \

56 (
S
), \

57 (Ë(
S
)->
size
, \

58 (Ë(
S
)->
gëp
, \

59 (Ë(
S
)->
ídp
)\

60 

	)

61 
	#STREAM_VERIFY_SANE
(
S
) \

63 i‡–!(
	`GETP_VALID
(
S
, (S)->
gëp
)Ë&& 
	`ENDP_VALID
(S, (S)->
ídp
) ) \

64 
	`STREAM_WARN_OFFSETS
(
S
); \

65 
	`as£π
 ( 
	`GETP_VALID
(
S
, (S)->
gëp
) ); \

66 
	`as£π
 ( 
	`ENDP_VALID
(
S
, (S)->
ídp
) ); \

67 } 0)

	)

69 
	#STREAM_BOUND_WARN
(
S
, 
WHAT
) \

71 
	`zlog_w¨n
 ("%s: Aâem±Åÿ%†ouào‡bounds", 
__func__
, (
WHAT
)); \

72 
	`STREAM_WARN_OFFSETS
(
S
); \

73 
	`as£π
 (0); \

74 } 0)

	)

77 
	#CHECK_SIZE
(
S
, 
Z
) \

79 i‡(((
S
)->
ídp
 + (
Z
)Ë> (S)->
size
) \

81 
	`zlog_w¨n
 ("CHECK_SIZE:ÅruncatingÑequested size %lu\n", \

82 (Ë(
Z
)); \

83 
	`STREAM_WARN_OFFSETS
(
S
); \

84 (
Z
Ë(
S
)->
size
 - (S)->
ídp
; \

86 } 0);

	)

89 
°ªam
 *

90 
	$°ªam_√w
 (
size_t
 
size
)

92 
°ªam
 *
s
;

94 
	`as£π
 (
size
 > 0);

96 i‡(
size
 == 0)

98 
	`zlog_w¨n
 ("stream_new(): called with 0 size!");

99  
NULL
;

102 
s
 = 
	`XCALLOC
 (
MTYPE_STREAM
,  (
°ªam
));

104 i‡(
s
 =
NULL
)

105  
s
;

107 i‡–(
s
->
d©a
 = 
	`XMALLOC
 (
MTYPE_STREAM_DATA
, 
size
)Ë=
NULL
)

109 
	`XFREE
 (
MTYPE_STREAM
, 
s
);

110  
NULL
;

113 
s
->
size
 = size;

114  
s
;

115 
	}
}

119 
	$°ªam_‰ì
 (
°ªam
 *
s
)

121 i‡(!
s
)

124 
	`XFREE
 (
MTYPE_STREAM_DATA
, 
s
->
d©a
);

125 
	`XFREE
 (
MTYPE_STREAM
, 
s
);

126 
	}
}

128 
°ªam
 *

129 
	$°ªam_c›y
 (
°ªam
 *
√w
, °ªam *
§c
)

131 
	`STREAM_VERIFY_SANE
 (
§c
);

133 
	`as£π
 (
√w
 !
NULL
);

134 
	`as£π
 (
	`STREAM_SIZE
(
√w
Ë>
§c
->
ídp
);

136 
√w
->
ídp
 = 
§c
->endp;

137 
√w
->
gëp
 = 
§c
->getp;

139 
	`mem˝y
 (
√w
->
d©a
, 
§c
->d©a, src->
ídp
);

141  
√w
;

142 
	}
}

144 
°ªam
 *

145 
	$°ªam_dup
 (
°ªam
 *
s
)

147 
°ªam
 *
√w
;

149 
	`STREAM_VERIFY_SANE
 (
s
);

151 i‡–(
√w
 = 
	`°ªam_√w
 (
s
->
ídp
)Ë=
NULL
)

152  
NULL
;

154  (
	`°ªam_c›y
 (
√w
, 
s
));

155 
	}
}

157 
size_t


158 
	$°ªam_ªsize
 (
°ªam
 *
s
, 
size_t
 
√wsize
)

160 
u_ch¨
 *
√wd©a
;

161 
	`STREAM_VERIFY_SANE
 (
s
);

163 
√wd©a
 = 
	`XREALLOC
 (
MTYPE_STREAM_DATA
, 
s
->
d©a
, 
√wsize
);

165 i‡(
√wd©a
 =
NULL
)

166  
s
->
size
;

168 
s
->
d©a
 = 
√wd©a
;

169 
s
->
size
 = 
√wsize
;

171 i‡(
s
->
ídp
 > s->
size
)

172 
s
->
ídp
 = s->
size
;

173 i‡(
s
->
gëp
 > s->
ídp
)

174 
s
->
gëp
 = s->
ídp
;

176 
	`STREAM_VERIFY_SANE
 (
s
);

178  
s
->
size
;

179 
	}
}

181 
size_t


182 
	$°ªam_gë_gëp
 (
°ªam
 *
s
)

184 
	`STREAM_VERIFY_SANE
(
s
);

185  
s
->
gëp
;

186 
	}
}

188 
size_t


189 
	$°ªam_gë_ídp
 (
°ªam
 *
s
)

191 
	`STREAM_VERIFY_SANE
(
s
);

192  
s
->
ídp
;

193 
	}
}

195 
size_t


196 
	$°ªam_gë_size
 (
°ªam
 *
s
)

198 
	`STREAM_VERIFY_SANE
(
s
);

199  
s
->
size
;

200 
	}
}

204 
	$°ªam_£t_gëp
 (
°ªam
 *
s
, 
size_t
 
pos
)

206 
	`STREAM_VERIFY_SANE
(
s
);

208 i‡(!
	`GETP_VALID
 (
s
, 
pos
))

210 
	`STREAM_BOUND_WARN
 (
s
, "set getp");

211 
pos
 = 
s
->
ídp
;

214 
s
->
gëp
 = 
pos
;

215 
	}
}

218 
	$°ªam_£t_ídp
 (
°ªam
 *
s
, 
size_t
 
pos
)

220 
	`STREAM_VERIFY_SANE
(
s
);

222 i‡(!
	`ENDP_VALID
(
s
, 
pos
))

224 
	`STREAM_BOUND_WARN
 (
s
, "setÉndp");

231 i‡(
s
->
gëp
 > 
pos
)

233 
	`STREAM_BOUND_WARN
(
s
, "setÉndp");

237 
s
->
ídp
 = 
pos
;

238 
	`STREAM_VERIFY_SANE
(
s
);

239 
	}
}

243 
	$°ªam_f‹w¨d_gëp
 (
°ªam
 *
s
, 
size_t
 
size
)

245 
	`STREAM_VERIFY_SANE
(
s
);

247 i‡(!
	`GETP_VALID
 (
s
, s->
gëp
 + 
size
))

249 
	`STREAM_BOUND_WARN
 (
s
, "seek getp");

253 
s
->
gëp
 +
size
;

254 
	}
}

257 
	$°ªam_f‹w¨d_ídp
 (
°ªam
 *
s
, 
size_t
 
size
)

259 
	`STREAM_VERIFY_SANE
(
s
);

261 i‡(!
	`ENDP_VALID
 (
s
, s->
ídp
 + 
size
))

263 
	`STREAM_BOUND_WARN
 (
s
, "seekÉndp");

267 
s
->
ídp
 +
size
;

268 
	}
}

272 
	$°ªam_gë
 (*
d°
, 
°ªam
 *
s
, 
size_t
 
size
)

274 
	`STREAM_VERIFY_SANE
(
s
);

276 i‡(
	`STREAM_READABLE
(
s
Ë< 
size
)

278 
	`STREAM_BOUND_WARN
 (
s
, "get");

282 
	`mem˝y
 (
d°
, 
s
->
d©a
 + s->
gëp
, 
size
);

283 
s
->
gëp
 +
size
;

284 
	}
}

287 
u_ch¨


288 
	$°ªam_gëc
 (
°ªam
 *
s
)

290 
u_ch¨
 
c
;

292 
	`STREAM_VERIFY_SANE
 (
s
);

294 i‡(
	`STREAM_READABLE
(
s
Ë<  (
u_ch¨
))

296 
	`STREAM_BOUND_WARN
 (
s
, "get char");

299 
c
 = 
s
->
d©a
[s->
gëp
++];

301  
c
;

302 
	}
}

305 
u_ch¨


306 
	$°ªam_gëc_‰om
 (
°ªam
 *
s
, 
size_t
 
‰om
)

308 
u_ch¨
 
c
;

310 
	`STREAM_VERIFY_SANE
(
s
);

312 i‡(!
	`GETP_VALID
 (
s
, 
‰om
 +  (
u_ch¨
)))

314 
	`STREAM_BOUND_WARN
 (
s
, "get char");

318 
c
 = 
s
->
d©a
[
‰om
];

320  
c
;

321 
	}
}

324 
u_öt16_t


325 
	$°ªam_gëw
 (
°ªam
 *
s
)

327 
u_öt16_t
 
w
;

329 
	`STREAM_VERIFY_SANE
 (
s
);

331 i‡(
	`STREAM_READABLE
 (
s
Ë<  (
u_öt16_t
))

333 
	`STREAM_BOUND_WARN
 (
s
, "get ");

337 
w
 = 
s
->
d©a
[s->
gëp
++] << 8;

338 
w
 |
s
->
d©a
[s->
gëp
++];

340  
w
;

341 
	}
}

344 
u_öt16_t


345 
	$°ªam_gëw_‰om
 (
°ªam
 *
s
, 
size_t
 
‰om
)

347 
u_öt16_t
 
w
;

349 
	`STREAM_VERIFY_SANE
(
s
);

351 i‡(!
	`GETP_VALID
 (
s
, 
‰om
 +  (
u_öt16_t
)))

353 
	`STREAM_BOUND_WARN
 (
s
, "get ");

357 
w
 = 
s
->
d©a
[
‰om
++] << 8;

358 
w
 |
s
->
d©a
[
‰om
];

360  
w
;

361 
	}
}

364 
u_öt32_t


365 
	$°ªam_gël_‰om
 (
°ªam
 *
s
, 
size_t
 
‰om
)

367 
u_öt32_t
 
l
;

369 
	`STREAM_VERIFY_SANE
(
s
);

371 i‡(!
	`GETP_VALID
 (
s
, 
‰om
 +  (
u_öt32_t
)))

373 
	`STREAM_BOUND_WARN
 (
s
, "getÜong");

377 
l
 = 
s
->
d©a
[
‰om
++] << 24;

378 
l
 |
s
->
d©a
[
‰om
++] << 16;

379 
l
 |
s
->
d©a
[
‰om
++] << 8;

380 
l
 |
s
->
d©a
[
‰om
];

382  
l
;

383 
	}
}

385 
u_öt32_t


386 
	$°ªam_gël
 (
°ªam
 *
s
)

388 
u_öt32_t
 
l
;

390 
	`STREAM_VERIFY_SANE
(
s
);

392 i‡(
	`STREAM_READABLE
 (
s
Ë<  (
u_öt32_t
))

394 
	`STREAM_BOUND_WARN
 (
s
, "getÜong");

398 
l
 = 
s
->
d©a
[s->
gëp
++] << 24;

399 
l
 |
s
->
d©a
[s->
gëp
++] << 16;

400 
l
 |
s
->
d©a
[s->
gëp
++] << 8;

401 
l
 |
s
->
d©a
[s->
gëp
++];

403  
l
;

404 
	}
}

407 
uöt64_t


408 
	$°ªam_gëq_‰om
 (
°ªam
 *
s
, 
size_t
 
‰om
)

410 
uöt64_t
 
q
;

412 
	`STREAM_VERIFY_SANE
(
s
);

414 i‡(!
	`GETP_VALID
 (
s
, 
‰om
 +  (
uöt64_t
)))

416 
	`STREAM_BOUND_WARN
 (
s
, "get quad");

420 
q
 = ((
uöt64_t
Ë
s
->
d©a
[
‰om
++]) << 56;

421 
q
 |((
uöt64_t
Ë
s
->
d©a
[
‰om
++]) << 48;

422 
q
 |((
uöt64_t
Ë
s
->
d©a
[
‰om
++]) << 40;

423 
q
 |((
uöt64_t
Ë
s
->
d©a
[
‰om
++]) << 32;

424 
q
 |((
uöt64_t
Ë
s
->
d©a
[
‰om
++]) << 24;

425 
q
 |((
uöt64_t
Ë
s
->
d©a
[
‰om
++]) << 16;

426 
q
 |((
uöt64_t
Ë
s
->
d©a
[
‰om
++]) << 8;

427 
q
 |((
uöt64_t
Ë
s
->
d©a
[
‰om
++]);

429  
q
;

430 
	}
}

432 
uöt64_t


433 
	$°ªam_gëq
 (
°ªam
 *
s
)

435 
uöt64_t
 
q
;

437 
	`STREAM_VERIFY_SANE
(
s
);

439 i‡(
	`STREAM_READABLE
 (
s
Ë<  (
uöt64_t
))

441 
	`STREAM_BOUND_WARN
 (
s
, "get quad");

445 
q
 = ((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]) << 56;

446 
q
 |((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]) << 48;

447 
q
 |((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]) << 40;

448 
q
 |((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]) << 32;

449 
q
 |((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]) << 24;

450 
q
 |((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]) << 16;

451 
q
 |((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]) << 8;

452 
q
 |((
uöt64_t
Ë
s
->
d©a
[s->
gëp
++]);

454  
q
;

455 
	}
}

458 
u_öt32_t


459 
	$°ªam_gë_ùv4
 (
°ªam
 *
s
)

461 
u_öt32_t
 
l
;

463 
	`STREAM_VERIFY_SANE
(
s
);

465 i‡(
	`STREAM_READABLE
 (
s
Ë< (
u_öt32_t
))

467 
	`STREAM_BOUND_WARN
 (
s
, "get ipv4");

471 
	`mem˝y
 (&
l
, 
s
->
d©a
 + s->
gëp
, (
u_öt32_t
));

472 
s
->
gëp
 +(
u_öt32_t
);

474  
l
;

475 
	}
}

485 
	$°ªam_put
 (
°ªam
 *
s
, c⁄° *
§c
, 
size_t
 
size
)

489 
	`CHECK_SIZE
(
s
, 
size
);

491 
	`STREAM_VERIFY_SANE
(
s
);

493 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< 
size
)

495 
	`STREAM_BOUND_WARN
 (
s
, "put");

499 i‡(
§c
)

500 
	`mem˝y
 (
s
->
d©a
 + s->
ídp
, 
§c
, 
size
);

502 
	`mem£t
 (
s
->
d©a
 + s->
ídp
, 0, 
size
);

504 
s
->
ídp
 +
size
;

505 
	}
}

509 
	$°ªam_putc
 (
°ªam
 *
s
, 
u_ch¨
 
c
)

511 
	`STREAM_VERIFY_SANE
(
s
);

513 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< (
u_ch¨
))

515 
	`STREAM_BOUND_WARN
 (
s
, "put");

519 
s
->
d©a
[s->
ídp
++] = 
c
;

520   (
u_ch¨
);

521 
	}
}

525 
	$°ªam_putw
 (
°ªam
 *
s
, 
u_öt16_t
 
w
)

527 
	`STREAM_VERIFY_SANE
 (
s
);

529 i‡(
	`STREAM_WRITEABLE
 (
s
Ë<  (
u_öt16_t
))

531 
	`STREAM_BOUND_WARN
 (
s
, "put");

535 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
w
 >> 8);

536 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
Ë
w
;

539 
	}
}

543 
	$°ªam_pué
 (
°ªam
 *
s
, 
u_öt32_t
 
l
)

545 
	`STREAM_VERIFY_SANE
 (
s
);

547 i‡(
	`STREAM_WRITEABLE
 (
s
Ë<  (
u_öt32_t
))

549 
	`STREAM_BOUND_WARN
 (
s
, "put");

553 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
l
 >> 24);

554 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
l
 >> 16);

555 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
l
 >> 8);

556 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)
l
;

559 
	}
}

563 
	$°ªam_putq
 (
°ªam
 *
s
, 
uöt64_t
 
q
)

565 
	`STREAM_VERIFY_SANE
 (
s
);

567 i‡(
	`STREAM_WRITEABLE
 (
s
Ë<  (
uöt64_t
))

569 
	`STREAM_BOUND_WARN
 (
s
, "put quad");

573 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
q
 >> 56);

574 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
q
 >> 48);

575 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
q
 >> 40);

576 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
q
 >> 32);

577 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
q
 >> 24);

578 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
q
 >> 16);

579 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)(
q
 >> 8);

580 
s
->
d©a
[s->
ídp
++] = (
u_ch¨
)
q
;

583 
	}
}

586 
	$°ªam_putc_©
 (
°ªam
 *
s
, 
size_t
 
puç
, 
u_ch¨
 
c
)

588 
	`STREAM_VERIFY_SANE
(
s
);

590 i‡(!
	`PUT_AT_VALID
 (
s
, 
puç
 +  (
u_ch¨
)))

592 
	`STREAM_BOUND_WARN
 (
s
, "put");

596 
s
->
d©a
[
puç
] = 
c
;

599 
	}
}

602 
	$°ªam_putw_©
 (
°ªam
 *
s
, 
size_t
 
puç
, 
u_öt16_t
 
w
)

604 
	`STREAM_VERIFY_SANE
(
s
);

606 i‡(!
	`PUT_AT_VALID
 (
s
, 
puç
 +  (
u_öt16_t
)))

608 
	`STREAM_BOUND_WARN
 (
s
, "put");

612 
s
->
d©a
[
puç
] = (
u_ch¨
)(
w
 >> 8);

613 
s
->
d©a
[
puç
 + 1] = (
u_ch¨
Ë
w
;

616 
	}
}

619 
	$°ªam_pué_©
 (
°ªam
 *
s
, 
size_t
 
puç
, 
u_öt32_t
 
l
)

621 
	`STREAM_VERIFY_SANE
(
s
);

623 i‡(!
	`PUT_AT_VALID
 (
s
, 
puç
 +  (
u_öt32_t
)))

625 
	`STREAM_BOUND_WARN
 (
s
, "put");

628 
s
->
d©a
[
puç
] = (
u_ch¨
)(
l
 >> 24);

629 
s
->
d©a
[
puç
 + 1] = (
u_ch¨
)(
l
 >> 16);

630 
s
->
d©a
[
puç
 + 2] = (
u_ch¨
)(
l
 >> 8);

631 
s
->
d©a
[
puç
 + 3] = (
u_ch¨
)
l
;

634 
	}
}

637 
	$°ªam_putq_©
 (
°ªam
 *
s
, 
size_t
 
puç
, 
uöt64_t
 
q
)

639 
	`STREAM_VERIFY_SANE
(
s
);

641 i‡(!
	`PUT_AT_VALID
 (
s
, 
puç
 +  (
uöt64_t
)))

643 
	`STREAM_BOUND_WARN
 (
s
, "put");

646 
s
->
d©a
[
puç
] = (
u_ch¨
)(
q
 >> 56);

647 
s
->
d©a
[
puç
 + 1] = (
u_ch¨
)(
q
 >> 48);

648 
s
->
d©a
[
puç
 + 2] = (
u_ch¨
)(
q
 >> 40);

649 
s
->
d©a
[
puç
 + 3] = (
u_ch¨
)(
q
 >> 32);

650 
s
->
d©a
[
puç
 + 4] = (
u_ch¨
)(
q
 >> 24);

651 
s
->
d©a
[
puç
 + 5] = (
u_ch¨
)(
q
 >> 16);

652 
s
->
d©a
[
puç
 + 6] = (
u_ch¨
)(
q
 >> 8);

653 
s
->
d©a
[
puç
 + 7] = (
u_ch¨
)
q
;

656 
	}
}

660 
	$°ªam_put_ùv4
 (
°ªam
 *
s
, 
u_öt32_t
 
l
)

662 
	`STREAM_VERIFY_SANE
(
s
);

664 i‡(
	`STREAM_WRITEABLE
 (
s
Ë<  (
u_öt32_t
))

666 
	`STREAM_BOUND_WARN
 (
s
, "put");

669 
	`mem˝y
 (
s
->
d©a
 + s->
ídp
, &
l
,  (
u_öt32_t
));

670 
s
->
ídp
 + (
u_öt32_t
);

672   (
u_öt32_t
);

673 
	}
}

677 
	$°ªam_put_ö_addr
 (
°ªam
 *
s
, 
ö_addr
 *
addr
)

679 
	`STREAM_VERIFY_SANE
(
s
);

681 i‡(
	`STREAM_WRITEABLE
 (
s
Ë<  (
u_öt32_t
))

683 
	`STREAM_BOUND_WARN
 (
s
, "put");

687 
	`mem˝y
 (
s
->
d©a
 + s->
ídp
, 
addr
,  (
u_öt32_t
));

688 
s
->
ídp
 + (
u_öt32_t
);

690   (
u_öt32_t
);

691 
	}
}

695 
	$°ªam_put_¥efix
 (
°ªam
 *
s
, 
¥efix
 *
p
)

697 
size_t
 
psize
;

699 
	`STREAM_VERIFY_SANE
(
s
);

701 
psize
 = 
	`PSIZE
 (
p
->
¥efixÀn
);

703 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< 
psize
)

705 
	`STREAM_BOUND_WARN
 (
s
, "put");

709 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
);

710 
	`mem˝y
 (
s
->
d©a
 + s->
ídp
, &
p
->
u
.
¥efix
, 
psize
);

711 
s
->
ídp
 +
psize
;

713  
psize
;

714 
	}
}

718 
	$°ªam_ªad
 (
°ªam
 *
s
, 
fd
, 
size_t
 
size
)

720 
nbyãs
;

722 
	`STREAM_VERIFY_SANE
(
s
);

724 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< 
size
)

726 
	`STREAM_BOUND_WARN
 (
s
, "put");

730 
nbyãs
 = 
	`ªadn
 (
fd
, 
s
->
d©a
 + s->
ídp
, 
size
);

732 i‡(
nbyãs
 > 0)

733 
s
->
ídp
 +
nbyãs
;

735  
nbyãs
;

736 
	}
}

740 
	$°ªam_ªad_unblock
 (
°ªam
 *
s
, 
fd
, 
size_t
 
size
)

742 
nbyãs
;

743 
vÆ
;

745 
	`STREAM_VERIFY_SANE
(
s
);

747 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< 
size
)

749 
	`STREAM_BOUND_WARN
 (
s
, "put");

753 
vÆ
 = 
	`f˙é
 (
fd
, 
F_GETFL
, 0);

754 
	`f˙é
 (
fd
, 
F_SETFL
, 
vÆ
|
O_NONBLOCK
);

755 
nbyãs
 = 
	`ªad
 (
fd
, 
s
->
d©a
 + s->
ídp
, 
size
);

756 
	`f˙é
 (
fd
, 
F_SETFL
, 
vÆ
);

758 i‡(
nbyãs
 > 0)

759 
s
->
ídp
 +
nbyãs
;

761  
nbyãs
;

762 
	}
}

764 
ssize_t


765 
	$°ªam_ªad_åy
(
°ªam
 *
s
, 
fd
, 
size_t
 
size
)

767 
ssize_t
 
nbyãs
;

769 
	`STREAM_VERIFY_SANE
(
s
);

771 i‡(
	`STREAM_WRITEABLE
(
s
Ë< 
size
)

773 
	`STREAM_BOUND_WARN
 (
s
, "put");

779 i‡((
nbyãs
 = 
	`ªad
(
fd
, 
s
->
d©a
 + s->
ídp
, 
size
)) >= 0)

781 
s
->
ídp
 +
nbyãs
;

782  
nbyãs
;

785 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

787 
	`zlog_w¨n
("%s:Ñód faûed o¿fd %d: %s", 
__func__
, 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

789 
	}
}

794 
ssize_t


795 
	$°ªam_ªcv‰om
 (
°ªam
 *
s
, 
fd
, 
size_t
 
size
, 
Êags
,

796 
sockaddr
 *
‰om
, 
sockÀn_t
 *
‰omÀn
)

798 
ssize_t
 
nbyãs
;

800 
	`STREAM_VERIFY_SANE
(
s
);

802 i‡(
	`STREAM_WRITEABLE
(
s
Ë< 
size
)

804 
	`STREAM_BOUND_WARN
 (
s
, "put");

810 i‡((
nbyãs
 = 
	`ªcv‰om
 (
fd
, 
s
->
d©a
 + s->
ídp
, 
size
,

811 
Êags
, 
‰om
, 
‰omÀn
)) >= 0)

813 
s
->
ídp
 +
nbyãs
;

814  
nbyãs
;

817 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

819 
	`zlog_w¨n
("%s:Ñód faûed o¿fd %d: %s", 
__func__
, 
fd
, 
	`ß„_°ªº‹
(
î∫o
));

821 
	}
}

828 
ssize_t


829 
	$°ªam_ªcvmsg
 (
°ªam
 *
s
, 
fd
, 
msghdr
 *
msgh
, 
Êags
,

830 
size_t
 
size
)

832 
nbyãs
;

833 
iovec
 *
iov
;

835 
	`STREAM_VERIFY_SANE
(
s
);

836 
	`as£π
 (
msgh
->
msg_iovÀn
 > 0);

838 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< 
size
)

840 
	`STREAM_BOUND_WARN
 (
s
, "put");

846 
iov
 = &(
msgh
->
msg_iov
[0]);

847 
iov
->
iov_ba£
 = (
s
->
d©a
 + s->
ídp
);

848 
iov
->
iov_Àn
 = 
size
;

850 
nbyãs
 = 
	`ªcvmsg
 (
fd
, 
msgh
, 
Êags
);

852 i‡(
nbyãs
 > 0)

853 
s
->
ídp
 +
nbyãs
;

855  
nbyãs
;

856 
	}
}

859 
size_t


860 
	$°ªam_wrôe
 (
°ªam
 *
s
, c⁄° *
±r
, 
size_t
 
size
)

863 
	`CHECK_SIZE
(
s
, 
size
);

865 
	`STREAM_VERIFY_SANE
(
s
);

867 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< 
size
)

869 
	`STREAM_BOUND_WARN
 (
s
, "put");

873 
	`mem˝y
 (
s
->
d©a
 + s->
ídp
, 
±r
, 
size
);

874 
s
->
ídp
 +
size
;

876  
size
;

877 
	}
}

884 
u_ch¨
 *

885 
	$°ªam_≤t
 (
°ªam
 *
s
)

887 
	`STREAM_VERIFY_SANE
(
s
);

888  
s
->
d©a
 + s->
gëp
;

889 
	}
}

893 
	$°ªam_em±y
 (
°ªam
 *
s
)

895 
	`STREAM_VERIFY_SANE
(
s
);

897  (
s
->
ídp
 == 0);

898 
	}
}

902 
	$°ªam_ª£t
 (
°ªam
 *
s
)

904 
	`STREAM_VERIFY_SANE
 (
s
);

906 
s
->
gëp
 = s->
ídp
 = 0;

907 
	}
}

911 
	$°ªam_Êush
 (
°ªam
 *
s
, 
fd
)

913 
nbyãs
;

915 
	`STREAM_VERIFY_SANE
(
s
);

917 
nbyãs
 = 
	`wrôe
 (
fd
, 
s
->
d©a
 + s->
gëp
, s->
ídp
 - s->getp);

919  
nbyãs
;

920 
	}
}

924 
°ªam_fifo
 *

925 
	$°ªam_fifo_√w
 ()

927 
°ªam_fifo
 *
√w
;

929 
√w
 = 
	`XCALLOC
 (
MTYPE_STREAM_FIFO
,  (
°ªam_fifo
));

930  
√w
;

931 
	}
}

935 
	$°ªam_fifo_push
 (
°ªam_fifo
 *
fifo
, 
°ªam
 *
s
)

937 i‡(
fifo
->
èû
)

938 
fifo
->
èû
->
√xt
 = 
s
;

940 
fifo
->
hód
 = 
s
;

942 
fifo
->
èû
 = 
s
;

944 
fifo
->
cou¡
++;

945 
	}
}

948 
°ªam
 *

949 
	$°ªam_fifo_p›
 (
°ªam_fifo
 *
fifo
)

951 
°ªam
 *
s
;

953 
s
 = 
fifo
->
hód
;

955 i‡(
s
)

957 
fifo
->
hód
 = 
s
->
√xt
;

959 i‡(
fifo
->
hód
 =
NULL
)

960 
fifo
->
èû
 = 
NULL
;

962 
fifo
->
cou¡
--;

965  
s
;

966 
	}
}

969 
°ªam
 *

970 
	$°ªam_fifo_hód
 (
°ªam_fifo
 *
fifo
)

972  
fifo
->
hód
;

973 
	}
}

976 
	$°ªam_fifo_˛ón
 (
°ªam_fifo
 *
fifo
)

978 
°ªam
 *
s
;

979 
°ªam
 *
√xt
;

981 
s
 = 
fifo
->
hód
; s; s = 
√xt
)

983 
√xt
 = 
s
->next;

984 
	`°ªam_‰ì
 (
s
);

986 
fifo
->
hód
 = fifo->
èû
 = 
NULL
;

987 
fifo
->
cou¡
 = 0;

988 
	}
}

991 
	$°ªam_fifo_‰ì
 (
°ªam_fifo
 *
fifo
)

993 
	`°ªam_fifo_˛ón
 (
fifo
);

994 
	`XFREE
 (
MTYPE_STREAM_FIFO
, 
fifo
);

995 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/stream.h

23 #i‚de‡
_ZEBRA_STREAM_H


24 
	#_ZEBRA_STREAM_H


	)

26 
	~"¥efix.h
"

95 
	s°ªam


97 
°ªam
 *
	m√xt
;

103 
size_t
 
	mgëp
;

104 
size_t
 
	mídp
;

105 
size_t
 
	msize
;

106 *
	md©a
;

110 
	s°ªam_fifo


112 
size_t
 
	mcou¡
;

114 
°ªam
 *
	mhód
;

115 
°ªam
 *
	mèû
;

119 
	#STREAM_SIZE
(
S
Ë((S)->
size
)

	)

121 
	#STREAM_WRITEABLE
(
S
Ë((S)->
size
 - (S)->
ídp
)

	)

123 
	#STREAM_READABLE
(
S
Ë((S)->
ídp
 - (S)->
gëp
)

	)

126 
	#STREAM_PNT
(
S
Ë
	`°ªam_≤t
((S))

	)

127 
	#STREAM_DATA
(
S
Ë((S)->
d©a
)

	)

128 
	#STREAM_REMAIN
(
S
Ë
	`STREAM_WRITEABLE
((S))

	)

138 
°ªam
 *
°ªam_√w
 (
size_t
);

139 
°ªam_‰ì
 (
°ªam
 *);

140 
°ªam
 * 
°ªam_c›y
 (°ªam *, °ªam *
§c
);

141 
°ªam
 *
°ªam_dup
 (stream *);

142 
size_t
 
°ªam_ªsize
 (
°ªam
 *, size_t);

143 
size_t
 
°ªam_gë_gëp
 (
°ªam
 *);

144 
size_t
 
°ªam_gë_ídp
 (
°ªam
 *);

145 
size_t
 
°ªam_gë_size
 (
°ªam
 *);

146 
u_ch¨
 *
°ªam_gë_d©a
 (
°ªam
 *);

148 
°ªam_£t_gëp
 (
°ªam
 *, 
size_t
);

149 
°ªam_£t_ídp
 (
°ªam
 *, 
size_t
);

150 
°ªam_f‹w¨d_gëp
 (
°ªam
 *, 
size_t
);

151 
°ªam_f‹w¨d_ídp
 (
°ªam
 *, 
size_t
);

154 
°ªam_put
 (
°ªam
 *, c⁄° *, 
size_t
);

155 
°ªam_putc
 (
°ªam
 *, 
u_ch¨
);

156 
°ªam_putc_©
 (
°ªam
 *, 
size_t
, 
u_ch¨
);

157 
°ªam_putw
 (
°ªam
 *, 
u_öt16_t
);

158 
°ªam_putw_©
 (
°ªam
 *, 
size_t
, 
u_öt16_t
);

159 
°ªam_pué
 (
°ªam
 *, 
u_öt32_t
);

160 
°ªam_pué_©
 (
°ªam
 *, 
size_t
, 
u_öt32_t
);

161 
°ªam_putq
 (
°ªam
 *, 
uöt64_t
);

162 
°ªam_putq_©
 (
°ªam
 *, 
size_t
, 
uöt64_t
);

163 
°ªam_put_ùv4
 (
°ªam
 *, 
u_öt32_t
);

164 
°ªam_put_ö_addr
 (
°ªam
 *, 
ö_addr
 *);

165 
°ªam_put_¥efix
 (
°ªam
 *, 
¥efix
 *);

167 
°ªam_gë
 (*, 
°ªam
 *, 
size_t
);

168 
u_ch¨
 
°ªam_gëc
 (
°ªam
 *);

169 
u_ch¨
 
°ªam_gëc_‰om
 (
°ªam
 *, 
size_t
);

170 
u_öt16_t
 
°ªam_gëw
 (
°ªam
 *);

171 
u_öt16_t
 
°ªam_gëw_‰om
 (
°ªam
 *, 
size_t
);

172 
u_öt32_t
 
°ªam_gël
 (
°ªam
 *);

173 
u_öt32_t
 
°ªam_gël_‰om
 (
°ªam
 *, 
size_t
);

174 
uöt64_t
 
°ªam_gëq
 (
°ªam
 *);

175 
uöt64_t
 
°ªam_gëq_‰om
 (
°ªam
 *, 
size_t
);

176 
u_öt32_t
 
°ªam_gë_ùv4
 (
°ªam
 *);

178 #unde‡
°ªam_ªad


179 #unde‡
°ªam_wrôe


183 
°ªam_ªad
 (
°ªam
 *, , 
size_t
);

187 
°ªam_ªad_unblock
 (
°ªam
 *, , 
size_t
);

197 
ssize_t
 
°ªam_ªad_åy
(
°ªam
 *
s
, 
fd
, 
size_t
 
size
);

199 
ssize_t
 
°ªam_ªcvmsg
 (
°ªam
 *
s
, 
fd
, 
msghdr
 *,

200 
Êags
, 
size_t
 
size
);

201 
ssize_t
 
°ªam_ªcv‰om
 (
°ªam
 *
s
, 
fd
, 
size_t
 
Àn
,

202 
Êags
, 
sockaddr
 *
‰om
,

203 
sockÀn_t
 *
‰omÀn
);

204 
size_t
 
°ªam_wrôe
 (
°ªam
 *, const *, size_t);

207 
°ªam_ª£t
 (
°ªam
 *);

208 
°ªam_Êush
 (
°ªam
 *, );

209 
°ªam_em±y
 (
°ªam
 *);

212 
u_ch¨
 *
°ªam_≤t
 (
°ªam
 *);

215 
°ªam_fifo
 *
°ªam_fifo_√w
 ();

216 
°ªam_fifo_push
 (
°ªam_fifo
 *
fifo
, 
°ªam
 *
s
);

217 
°ªam
 *
°ªam_fifo_p›
 (
°ªam_fifo
 *
fifo
);

218 
°ªam
 *
°ªam_fifo_hód
 (
°ªam_fifo
 *
fifo
);

219 
°ªam_fifo_˛ón
 (
°ªam_fifo
 *
fifo
);

220 
°ªam_fifo_‰ì
 (
°ªam_fifo
 *
fifo
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/table.c

23 
	~<zebø.h
>

25 
	~"¥efix.h
"

26 
	~"èbÀ.h
"

27 
	~"mem‹y.h
"

28 
	~"sockuni⁄.h
"

30 
rouã_node_dñëe
 (
rouã_node
 *);

31 
rouã_èbÀ_‰ì
 (
rouã_èbÀ
 *);

37 
rouã_èbÀ
 *

38 
	$rouã_èbÀ_öô_wôh_dñeg©e
 (
rouã_èbÀ_dñeg©e_t
 *
dñeg©e
)

40 
rouã_èbÀ
 *
π
;

42 
π
 = 
	`XCALLOC
 (
MTYPE_ROUTE_TABLE
,  (
rouã_èbÀ
));

43 
π
->
dñeg©e
 = delegate;

44  
π
;

45 
	}
}

48 
	$rouã_èbÀ_föish
 (
rouã_èbÀ
 *
π
)

50 
	`rouã_èbÀ_‰ì
 (
π
);

51 
	}
}

54 
rouã_node
 *

55 
	$rouã_node_√w
 (
rouã_èbÀ
 *
èbÀ
)

57  
èbÀ
->
dñeg©e
->
	`¸óã_node
 (table->delegate,Åable);

58 
	}
}

61 
rouã_node
 *

62 
	$rouã_node_£t
 (
rouã_èbÀ
 *
èbÀ
, 
¥efix
 *prefix)

64 
rouã_node
 *
node
;

66 
node
 = 
	`rouã_node_√w
 (
èbÀ
);

68 
	`¥efix_c›y
 (&
node
->
p
, 
¥efix
);

69 
node
->
èbÀ
 =Åable;

71  
node
;

72 
	}
}

76 
	$rouã_node_‰ì
 (
rouã_èbÀ
 *
èbÀ
, 
rouã_node
 *
node
)

78 
èbÀ
->
dñeg©e
->
	`de°roy_node
 (èbÀ->dñeg©e,ÅabÀ, 
node
);

79 
	}
}

83 
	$rouã_èbÀ_‰ì
 (
rouã_èbÀ
 *
π
)

85 
rouã_node
 *
tmp_node
;

86 
rouã_node
 *
node
;

88 i‡(
π
 =
NULL
)

91 
node
 = 
π
->
t›
;

96 
node
)

98 i‡(
node
->
l_À·
)

100 
node
 =Çode->
l_À·
;

104 i‡(
node
->
l_right
)

106 
node
 =Çode->
l_right
;

110 
tmp_node
 = 
node
;

111 
node
 =Çode->
∑ª¡
;

113 
tmp_node
->
èbÀ
->
cou¡
--;

114 
tmp_node
->
lock
 = 0;

115 
	`rouã_node_‰ì
 (
π
, 
tmp_node
);

117 i‡(
node
 !
NULL
)

119 i‡(
node
->
l_À·
 =
tmp_node
)

120 
node
->
l_À·
 = 
NULL
;

122 
node
->
l_right
 = 
NULL
;

130 
	`as£π
 (
π
->
cou¡
 == 0);

132 
	`XFREE
 (
MTYPE_ROUTE_TABLE
, 
π
);

134 
	}
}

137 c⁄° 
u_ch¨
 
	gmaskbô
[] =

144 
	$rouã_comm⁄
 (
¥efix
 *
n
, ¥efix *
p
, ¥efix *
√w
)

146 
i
;

147 
u_ch¨
 
diff
;

148 
u_ch¨
 
mask
;

150 
u_ch¨
 *
≈
 = (u_ch¨ *)&
n
->
u
.
¥efix
;

151 
u_ch¨
 *
µ
 = (u_ch¨ *)&
p
->
u
.
¥efix
;

152 
u_ch¨
 *
√wp
 = (u_ch¨ *)&
√w
->
u
.
¥efix
;

154 
i
 = 0; i < 
p
->
¥efixÀn
 / 8; i++)

156 i‡(
≈
[
i
] =
µ
[i])

157 
√wp
[
i
] = 
≈
[i];

162 
√w
->
¥efixÀn
 = 
i
 * 8;

164 i‡(
√w
->
¥efixÀn
 !
p
->prefixlen)

166 
diff
 = 
≈
[
i
] ^ 
µ
[i];

167 
mask
 = 0x80;

168 
√w
->
¥efixÀn
 < 
p
->¥efixÀ¿&& !(
mask
 & 
diff
))

170 
mask
 >>= 1;

171 
√w
->
¥efixÀn
++;

173 
√wp
[
i
] = 
≈
[i] & 
maskbô
[
√w
->
¥efixÀn
 % 8];

175 
	}
}

178 
	$£t_lök
 (
rouã_node
 *
node
, rouã_nodê*
√w
)

180 
bô
 = 
	`¥efix_bô
 (&
√w
->
p
.
u
.
¥efix
, 
node
->p.
¥efixÀn
);

182 
node
->
lök
[
bô
] = 
√w
;

183 
√w
->
∑ª¡
 = 
node
;

184 
	}
}

187 
rouã_node
 *

188 
	$rouã_lock_node
 (
rouã_node
 *
node
)

190 
node
->
lock
++;

191  
node
;

192 
	}
}

196 
	$rouã_u∆ock_node
 (
rouã_node
 *
node
)

198 
	`as£π
 (
node
->
lock
 > 0);

199 
node
->
lock
--;

201 i‡(
node
->
lock
 == 0)

202 
	`rouã_node_dñëe
 (
node
);

203 
	}
}

206 
rouã_node
 *

207 
	$rouã_node_m©ch
 (c⁄° 
rouã_èbÀ
 *
èbÀ
, c⁄° 
¥efix
 *
p
)

209 
rouã_node
 *
node
;

210 
rouã_node
 *
m©ched
;

212 
m©ched
 = 
NULL
;

213 
node
 = 
èbÀ
->
t›
;

217 
node
 &&Çode->
p
.
¥efixÀn
 <=Ö->prefixlen &&

218 
	`¥efix_m©ch
 (&
node
->
p
,Ö))

220 i‡(
node
->
öfo
)

221 
m©ched
 = 
node
;

223 i‡(
node
->
p
.
¥efixÀn
 ==Ö->prefixlen)

226 
node
 =Çode->
lök
[
	`¥efix_bô
(&
p
->
u
.
¥efix
,Çode->p.
¥efixÀn
)];

230 i‡(
m©ched
)

231  
	`rouã_lock_node
 (
m©ched
);

233  
NULL
;

234 
	}
}

236 
rouã_node
 *

237 
	$rouã_node_m©ch_ùv4
 (c⁄° 
rouã_èbÀ
 *
èbÀ
,

238 c⁄° 
ö_addr
 *
addr
)

240 
¥efix_ùv4
 
p
;

242 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

243 
p
.
Ámûy
 = 
AF_INET
;

244 
p
.
¥efixÀn
 = 
IPV4_MAX_PREFIXLEN
;

245 
p
.
¥efix
 = *
addr
;

247  
	`rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

248 
	}
}

250 #ifde‡
HAVE_IPV6


251 
rouã_node
 *

252 
	$rouã_node_m©ch_ùv6
 (c⁄° 
rouã_èbÀ
 *
èbÀ
,

253 c⁄° 
ö6_addr
 *
addr
)

255 
¥efix_ùv6
 
p
;

257 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv6
));

258 
p
.
Ámûy
 = 
AF_INET6
;

259 
p
.
¥efixÀn
 = 
IPV6_MAX_PREFIXLEN
;

260 
p
.
¥efix
 = *
addr
;

262  
	`rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

263 
	}
}

267 
rouã_node
 *

268 
	$rouã_node_lookup
 (c⁄° 
rouã_èbÀ
 *
èbÀ
, 
¥efix
 *
p
)

270 
rouã_node
 *
node
;

271 
u_ch¨
 
¥efixÀn
 = 
p
->prefixlen;

272 c⁄° 
u_ch¨
 *
¥efix
 = &
p
->
u
.prefix;

274 
node
 = 
èbÀ
->
t›
;

276 
node
 &&Çode->
p
.
¥efixÀn
 <=Örefixlen &&

277 
	`¥efix_m©ch
 (&
node
->
p
,Ö))

279 i‡(
node
->
p
.
¥efixÀn
 ==Örefixlen)

280  
node
->
öfo
 ? 
	`rouã_lock_node
 (nodeË: 
NULL
;

282 
node
 =Çode->
lök
[
	`¥efix_bô
(
¥efix
,Çode->
p
.
¥efixÀn
)];

285  
NULL
;

286 
	}
}

289 
rouã_node
 *

290 
	$rouã_node_gë
 (
rouã_èbÀ
 *c⁄° 
èbÀ
, 
¥efix
 *
p
)

292 
rouã_node
 *
√w
;

293 
rouã_node
 *
node
;

294 
rouã_node
 *
m©ch
;

295 
u_ch¨
 
¥efixÀn
 = 
p
->prefixlen;

296 c⁄° 
u_ch¨
 *
¥efix
 = &
p
->
u
.prefix;

298 
m©ch
 = 
NULL
;

299 
node
 = 
èbÀ
->
t›
;

300 
node
 &&Çode->
p
.
¥efixÀn
 <=Örefixlen &&

301 
	`¥efix_m©ch
 (&
node
->
p
,Ö))

303 i‡(
node
->
p
.
¥efixÀn
 ==Örefixlen)

304  
	`rouã_lock_node
 (
node
);

306 
m©ch
 = 
node
;

307 
node
 =Çode->
lök
[
	`¥efix_bô
(
¥efix
,Çode->
p
.
¥efixÀn
)];

310 i‡(
node
 =
NULL
)

312 
√w
 = 
	`rouã_node_£t
 (
èbÀ
, 
p
);

313 i‡(
m©ch
)

314 
	`£t_lök
 (
m©ch
, 
√w
);

316 
èbÀ
->
t›
 = 
√w
;

320 
√w
 = 
	`rouã_node_√w
 (
èbÀ
);

321 
	`rouã_comm⁄
 (&
node
->
p
,Ö, &
√w
->p);

322 
√w
->
p
.
Ámûy
 =Ö->family;

323 
√w
->
èbÀ
 =Åable;

324 
	`£t_lök
 (
√w
, 
node
);

326 i‡(
m©ch
)

327 
	`£t_lök
 (
m©ch
, 
√w
);

329 
èbÀ
->
t›
 = 
√w
;

331 i‡(
√w
->
p
.
¥efixÀn
 !=Ö->prefixlen)

333 
m©ch
 = 
√w
;

334 
√w
 = 
	`rouã_node_£t
 (
èbÀ
, 
p
);

335 
	`£t_lök
 (
m©ch
, 
√w
);

336 
èbÀ
->
cou¡
++;

339 
èbÀ
->
cou¡
++;

340 
	`rouã_lock_node
 (
√w
);

342  
√w
;

343 
	}
}

347 
	$rouã_node_dñëe
 (
rouã_node
 *
node
)

349 
rouã_node
 *
chûd
;

350 
rouã_node
 *
∑ª¡
;

352 
	`as£π
 (
node
->
lock
 == 0);

353 
	`as£π
 (
node
->
öfo
 =
NULL
);

355 i‡(
node
->
l_À·
 &&Çode->
l_right
)

358 i‡(
node
->
l_À·
)

359 
chûd
 = 
node
->
l_À·
;

361 
chûd
 = 
node
->
l_right
;

363 
∑ª¡
 = 
node
->parent;

365 i‡(
chûd
)

366 
chûd
->
∑ª¡
 =Öarent;

368 i‡(
∑ª¡
)

370 i‡(
∑ª¡
->
l_À·
 =
node
)

371 
∑ª¡
->
l_À·
 = 
chûd
;

373 
∑ª¡
->
l_right
 = 
chûd
;

376 
node
->
èbÀ
->
t›
 = 
chûd
;

378 
node
->
èbÀ
->
cou¡
--;

380 
	`rouã_node_‰ì
 (
node
->
èbÀ
,Çode);

383 i‡(
∑ª¡
 &&Ö¨ít->
lock
 == 0)

384 
	`rouã_node_dñëe
 (
∑ª¡
);

385 
	}
}

389 
rouã_node
 *

390 
	$rouã_t›
 (
rouã_èbÀ
 *
èbÀ
)

393 i‡(
èbÀ
->
t›
 =
NULL
)

394  
NULL
;

397 
	`rouã_lock_node
 (
èbÀ
->
t›
);

398  
èbÀ
->
t›
;

399 
	}
}

402 
rouã_node
 *

403 
	$rouã_√xt
 (
rouã_node
 *
node
)

405 
rouã_node
 *
√xt
;

406 
rouã_node
 *
°¨t
;

411 i‡(
node
->
l_À·
)

413 
√xt
 = 
node
->
l_À·
;

414 
	`rouã_lock_node
 (
√xt
);

415 
	`rouã_u∆ock_node
 (
node
);

416  
√xt
;

418 i‡(
node
->
l_right
)

420 
√xt
 = 
node
->
l_right
;

421 
	`rouã_lock_node
 (
√xt
);

422 
	`rouã_u∆ock_node
 (
node
);

423  
√xt
;

426 
°¨t
 = 
node
;

427 
node
->
∑ª¡
)

429 i‡(
node
->
∑ª¡
->
l_À·
 =nodê&&Çode->∑ª¡->
l_right
)

431 
√xt
 = 
node
->
∑ª¡
->
l_right
;

432 
	`rouã_lock_node
 (
√xt
);

433 
	`rouã_u∆ock_node
 (
°¨t
);

434  
√xt
;

436 
node
 =Çode->
∑ª¡
;

438 
	`rouã_u∆ock_node
 (
°¨t
);

439  
NULL
;

440 
	}
}

443 
rouã_node
 *

444 
	$rouã_√xt_u¡û
 (
rouã_node
 *
node
, rouã_nodê*
limô
)

446 
rouã_node
 *
√xt
;

447 
rouã_node
 *
°¨t
;

452 i‡(
node
->
l_À·
)

454 
√xt
 = 
node
->
l_À·
;

455 
	`rouã_lock_node
 (
√xt
);

456 
	`rouã_u∆ock_node
 (
node
);

457  
√xt
;

459 i‡(
node
->
l_right
)

461 
√xt
 = 
node
->
l_right
;

462 
	`rouã_lock_node
 (
√xt
);

463 
	`rouã_u∆ock_node
 (
node
);

464  
√xt
;

467 
°¨t
 = 
node
;

468 
node
->
∑ª¡
 &&Çodê!
limô
)

470 i‡(
node
->
∑ª¡
->
l_À·
 =nodê&&Çode->∑ª¡->
l_right
)

472 
√xt
 = 
node
->
∑ª¡
->
l_right
;

473 
	`rouã_lock_node
 (
√xt
);

474 
	`rouã_u∆ock_node
 (
°¨t
);

475  
√xt
;

477 
node
 =Çode->
∑ª¡
;

479 
	`rouã_u∆ock_node
 (
°¨t
);

480  
NULL
;

481 
	}
}

484 
	$rouã_èbÀ_cou¡
 (c⁄° 
rouã_èbÀ
 *
èbÀ
)

486  
èbÀ
->
cou¡
;

487 
	}
}

494 
rouã_node
 *

495 
	$rouã_node_¸óã
 (
rouã_èbÀ_dñeg©e_t
 *
dñeg©e
,

496 
rouã_èbÀ
 *
èbÀ
)

498 
rouã_node
 *
node
;

499 
node
 = 
	`XCALLOC
 (
MTYPE_ROUTE_NODE
,  (
rouã_node
));

500  
node
;

501 
	}
}

509 
	$rouã_node_de°roy
 (
rouã_èbÀ_dñeg©e_t
 *
dñeg©e
,

510 
rouã_èbÀ
 *
èbÀ
, 
rouã_node
 *
node
)

512 
	`XFREE
 (
MTYPE_ROUTE_NODE
, 
node
);

513 
	}
}

518 
rouã_èbÀ_dñeg©e_t
 
	gdeÁu…_dñeg©e
 = {

519 .
¸óã_node
 = 
rouã_node_¸óã
,

520 .
	gde°roy_node
 = 
rouã_node_de°roy


526 
rouã_èbÀ
 *

527 
	$rouã_èbÀ_öô
 ()

529  
	`rouã_èbÀ_öô_wôh_dñeg©e
 (&
deÁu…_dñeg©e
);

530 
	}
}

543 
	$rouã_èbÀ_¥efix_ôî_cmp
 (
¥efix
 *
p1
, ¥efix *
p2
)

545 
¥efix
 
comm⁄_•a˚
;

546 
¥efix
 *
comm⁄
 = &
comm⁄_•a˚
;

548 i‡(
p1
->
¥efixÀn
 <
p2
->prefixlen)

550 i‡(
	`¥efix_m©ch
 (
p1
, 
p2
))

556  (
p1
->
¥efixÀn
 =
p2
->prefixlen) ? 0 : -1;

565 i‡(
	`¥efix_m©ch
 (
p2
, 
p1
))

569 
	`rouã_comm⁄
 (
p1
, 
p2
, 
comm⁄
);

570 
	`as£π
 (
comm⁄
->
¥efixÀn
 < 
p1
->prefixlen);

571 
	`as£π
 (
comm⁄
->
¥efixÀn
 < 
p2
->prefixlen);

579 i‡(
	`¥efix_bô
 (&
p1
->
u
.
¥efix
, 
comm⁄
->
¥efixÀn
))

585 
	`as£π
 (!
	`¥efix_bô
 (&
p2
->
u
.
¥efix
, 
comm⁄
->
¥efixÀn
));

592 
	`as£π
 (
	`¥efix_bô
 (&
p2
->
u
.
¥efix
, 
comm⁄
->
¥efixÀn
));

594 
	}
}

602 
rouã_node
 *

603 
	$rouã_gë_subåì_√xt
 (
rouã_node
 *
node
)

605 
node
->
∑ª¡
)

607 i‡(
node
->
∑ª¡
->
l_À·
 =nodê&&Çode->∑ª¡->
l_right
)

608  
node
->
∑ª¡
->
l_right
;

610 
node
 =Çode->
∑ª¡
;

613  
NULL
;

614 
	}
}

624 
rouã_node
 *

625 
	$rouã_èbÀ_gë_√xt_öã∫Æ
 (c⁄° 
rouã_èbÀ
 *
èbÀ
,

626 
¥efix
 *
p
)

628 
rouã_node
 *
node
, *
tmp_node
;

629 
u_ch¨
 
¥efixÀn
;

630 
cmp
;

632 
¥efixÀn
 = 
p
->prefixlen;

634 
node
 = 
èbÀ
->
t›
;

636 
node
)

638 
m©ch
;

640 i‡(
node
->
p
.
¥efixÀn
 <Ö->prefixlen)

641 
m©ch
 = 
	`¥efix_m©ch
 (&
node
->
p
,Ö);

643 
m©ch
 = 
	`¥efix_m©ch
 (
p
, &
node
->p);

645 i‡(
m©ch
)

647 i‡(
node
->
p
.
¥efixÀn
 ==Ö->prefixlen)

654 
	`rouã_lock_node
 (
node
);

655 
node
 = 
	`rouã_√xt
 (node);

656 i‡(
node
)

657 
	`rouã_u∆ock_node
 (
node
);

659  (
node
);

662 i‡(
node
->
p
.
¥efixÀn
 >Ö->prefixlen)

668  
node
;

674 
tmp_node
 = 
node
->
lök
[
	`¥efix_bô
 (&
p
->
u
.
¥efix
,Çode->p.
¥efixÀn
)];

676 i‡(
tmp_node
)

678 
node
 = 
tmp_node
;

686 i‡(
node
->
l_right
)

687  
node
->
l_right
;

693  
	`rouã_gë_subåì_√xt
 (
node
);

699 
cmp
 = 
	`rouã_èbÀ_¥efix_ôî_cmp
 (&
node
->
p
,Ö);

700 i‡(
cmp
 > 0)

706  
node
;

709 
	`as£π
 (
cmp
 < 0);

717  
	`rouã_gë_subåì_√xt
 (
node
);

720  
NULL
;

721 
	}
}

729 
rouã_node
 *

730 
	$rouã_èbÀ_gë_√xt
 (c⁄° 
rouã_èbÀ
 *
èbÀ
, 
¥efix
 *
p
)

732 
rouã_node
 *
node
;

734 
node
 = 
	`rouã_èbÀ_gë_√xt_öã∫Æ
 (
èbÀ
, 
p
);

735 i‡(
node
)

737 
	`as£π
 (
	`rouã_èbÀ_¥efix_ôî_cmp
 (&
node
->
p
,Ö) > 0);

738 
	`rouã_lock_node
 (
node
);

740  
node
;

741 
	}
}

747 
	$rouã_èbÀ_ôî_öô
 (
rouã_èbÀ_ôî_t
 * 
ôî
, 
rouã_èbÀ
 *
èbÀ
)

749 
	`mem£t
 (
ôî
, 0,  (*iter));

750 
ôî
->
°©e
 = 
RT_ITER_STATE_INIT
;

751 
ôî
->
èbÀ
 =Åable;

752 
	}
}

763 
	$rouã_èbÀ_ôî_∑u£
 (
rouã_èbÀ_ôî_t
 * 
ôî
)

765 
ôî
->
°©e
)

768 
RT_ITER_STATE_INIT
:

769 
RT_ITER_STATE_PAUSED
:

770 
RT_ITER_STATE_DONE
:

773 
RT_ITER_STATE_ITERATING
:

780 
	`¥efix_c›y
 (&
ôî
->
∑u£_¥efix
, &ôî->
cuºít
->
p
);

781 
	`rouã_u∆ock_node
 (
ôî
->
cuºít
);

782 
ôî
->
cuºít
 = 
NULL
;

783 
ôî
->
°©e
 = 
RT_ITER_STATE_PAUSED
;

787 
	`as£π
 (0);

790 
	}
}

798 
	$rouã_èbÀ_ôî_˛ónup
 (
rouã_èbÀ_ôî_t
 * 
ôî
)

800 i‡(
ôî
->
°©e
 =
RT_ITER_STATE_ITERATING
)

802 
	`rouã_u∆ock_node
 (
ôî
->
cuºít
);

803 
ôî
->
cuºít
 = 
NULL
;

805 
	`as£π
 (!
ôî
->
cuºít
);

811 
ôî
->
°©e
 = 
RT_ITER_STATE_DONE
;

812 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/table.h

23 #i‚de‡
_ZEBRA_TABLE_H


24 
	#_ZEBRA_TABLE_H


	)

29 
	grouã_node
;

30 
	grouã_èbÀ
;

38 
rouã_èbÀ_dñeg©e_t_
 
	trouã_èbÀ_dñeg©e_t
;

40 
	grouã_node
 * (*
	trouã_èbÀ_¸óã_node_func_t
)

41 (
	trouã_èbÀ_dñeg©e_t
 *, 
	trouã_èbÀ
 *);

43 (*
	trouã_èbÀ_de°roy_node_func_t
)

44 (
	trouã_èbÀ_dñeg©e_t
 *, 
	trouã_èbÀ
 *, 
	trouã_node
 *);

46 
	srouã_èbÀ_dñeg©e_t_


48 
rouã_èbÀ_¸óã_node_func_t
 
¸óã_node
;

49 
rouã_èbÀ_de°roy_node_func_t
 
de°roy_node
;

53 
	srouã_èbÀ


55 
rouã_node
 *
t›
;

60 
rouã_èbÀ_dñeg©e_t
 *
dñeg©e
;

62 
cou¡
;

67 *
öfo
;

73 
	#ROUTE_NODE_FIELDS
 \

75 
¥efix
 
p
; \

78 
rouã_èbÀ
 *
èbÀ
; \

79 
rouã_node
 *
∑ª¡
; \

80 
rouã_node
 *
lök
[2]; \

83 
lock
; \

86 *
öfo
; \

89 *
aggªg©e
;

	)

93 
	srouã_node


95 
ROUTE_NODE_FIELDS
;

97 
	#l_À·
 
lök
[0]

	)

98 
	#l_right
 
lök
[1]

	)

101 
rouã_èbÀ_ôî_t_
 
	trouã_èbÀ_ôî_t
;

105 
RT_ITER_STATE_INIT
,

106 
RT_ITER_STATE_ITERATING
,

107 
RT_ITER_STATE_PAUSED
,

108 
RT_ITER_STATE_DONE


109 } 
	trouã_èbÀ_ôî_°©e_t
;

116 
	srouã_èbÀ_ôî_t_


119 
rouã_èbÀ_ôî_°©e_t
 
°©e
;

125 
rouã_èbÀ
 *
èbÀ
;

130 
rouã_node
 *
cuºít
;

135 
¥efix
 
∑u£_¥efix
;

139 
rouã_èbÀ
 *
	`rouã_èbÀ_öô
 ();

141 
rouã_èbÀ
 *

142 
	`rouã_èbÀ_öô_wôh_dñeg©e
 (
rouã_èbÀ_dñeg©e_t
 *);

144 
	`rouã_èbÀ_föish
 (
rouã_èbÀ
 *);

145 
	`rouã_u∆ock_node
 (
rouã_node
 *
node
);

146 
rouã_node
 *
	`rouã_t›
 (
rouã_èbÀ
 *);

147 
rouã_node
 *
	`rouã_√xt
 (route_node *);

148 
rouã_node
 *
	`rouã_√xt_u¡û
 (route_node *,

149 
rouã_node
 *);

150 
rouã_node
 *
	`rouã_node_gë
 (
rouã_èbÀ
 *const,

151 
¥efix
 *);

152 
rouã_node
 *
	`rouã_node_lookup
 (c⁄° 
rouã_èbÀ
 *,

153 
¥efix
 *);

154 
rouã_node
 *
	`rouã_lock_node
 (rouã_nodê*
node
);

155 
rouã_node
 *
	`rouã_node_m©ch
 (c⁄° 
rouã_èbÀ
 *,

156 c⁄° 
¥efix
 *);

157 
rouã_node
 *
	`rouã_node_m©ch_ùv4
 (c⁄° 
rouã_èbÀ
 *,

158 c⁄° 
ö_addr
 *);

159 #ifde‡
HAVE_IPV6


160 
rouã_node
 *
	`rouã_node_m©ch_ùv6
 (c⁄° 
rouã_èbÀ
 *,

161 c⁄° 
ö6_addr
 *);

164 
	`rouã_èbÀ_cou¡
 (c⁄° 
rouã_èbÀ
 *);

166 
rouã_node
 *

167 
	`rouã_èbÀ_gë_√xt
 (c⁄° 
rouã_èbÀ
 *
èbÀ
, 
¥efix
 *
p
);

169 
	`rouã_èbÀ_¥efix_ôî_cmp
 (
¥efix
 *
p1
, ¥efix *
p2
);

174 
	`rouã_èbÀ_ôî_öô
 (
rouã_èbÀ_ôî_t
 *
ôî
,

175 
rouã_èbÀ
 *
èbÀ
);

176 
	`rouã_èbÀ_ôî_∑u£
 (
rouã_èbÀ_ôî_t
 *
ôî
);

177 
	`rouã_èbÀ_ôî_˛ónup
 (
rouã_èbÀ_ôî_t
 *
ôî
);

188 
ölöe
 
rouã_node
 *

189 
	$rouã_èbÀ_ôî_√xt
 (
rouã_èbÀ_ôî_t
 * 
ôî
)

191 
rouã_node
 *
node
;

193 
ôî
->
°©e
)

196 
RT_ITER_STATE_INIT
:

201 
node
 = 
	`rouã_t›
 (
ôî
->
èbÀ
);

204 
RT_ITER_STATE_ITERATING
:

205 
node
 = 
	`rouã_√xt
 (
ôî
->
cuºít
);

208 
RT_ITER_STATE_PAUSED
:

213 
node
 = 
	`rouã_èbÀ_gë_√xt
 (
ôî
->
èbÀ
, &ôî->
∑u£_¥efix
);

216 
RT_ITER_STATE_DONE
:

217  
NULL
;

220 
	`as£π
 (0);

223 
ôî
->
cuºít
 = 
node
;

224 i‡(
node
)

225 
ôî
->
°©e
 = 
RT_ITER_STATE_ITERATING
;

227 
ôî
->
°©e
 = 
RT_ITER_STATE_DONE
;

229  
node
;

230 
	}
}

237 
ölöe
 

238 
	$rouã_èbÀ_ôî_is_d⁄e
 (
rouã_èbÀ_ôî_t
 *
ôî
)

240  
ôî
->
°©e
 =
RT_ITER_STATE_DONE
;

241 
	}
}

248 
ölöe
 

249 
	$rouã_èbÀ_ôî_°¨ãd
 (
rouã_èbÀ_ôî_t
 *
ôî
)

251  
ôî
->
°©e
 !
RT_ITER_STATE_INIT
;

252 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/thread.c

24 
	~<zebø.h
>

26 
	~"thªad.h
"

27 
	~"mem‹y.h
"

28 
	~"log.h
"

29 
	~"hash.h
"

30 
	~"comm™d.h
"

31 
	~"sigevít.h
"

33 #i‡
deföed
 
HAVE_SNMP
 && deföed 
SNMP_AGENTX


34 
	~<√t-¢mp/√t-¢mp-c⁄fig.h
>

35 
	~<√t-¢mp/√t-¢mp-ö˛udes.h
>

36 
	~<√t-¢mp/agít/√t-¢mp-agít-ö˛udes.h
>

37 
	~<√t-¢mp/agít/¢mp_v¨s.h
>

39 
agítx_íabÀd
;

42 #i‡
deföed
(
__APPLE__
)

43 
	~<mach/mach.h
>

44 
	~<mach/mach_time.h
>

49 
timevÆ
 
	gª˚¡_time
;

50 
timevÆ
 
	gœ°_ª˚¡_time
;

52 
timevÆ
 
	gªœtive_time
;

53 
timevÆ
 
	gªœtive_time_ba£
;

55 
	gtimîs_öôed
;

57 
hash
 *
	g˝u_ªc‹d
 = 
NULL
;

60 
	#TIMER_SECOND_MICRO
 1000000L

	)

64 
timevÆ


65 
	$timevÆ_adju°
 (
timevÆ
 
a
)

67 
a
.
tv_u£c
 >
TIMER_SECOND_MICRO
)

69 
a
.
tv_u£c
 -
TIMER_SECOND_MICRO
;

70 
a
.
tv_£c
++;

73 
a
.
tv_u£c
 < 0)

75 
a
.
tv_u£c
 +
TIMER_SECOND_MICRO
;

76 
a
.
tv_£c
--;

79 i‡(
a
.
tv_£c
 < 0)

81 
a
.
tv_£c
 =á.
tv_u£c
 = 0;

83  
a
;

84 
	}
}

86 
timevÆ


87 
	$timevÆ_subåa˘
 (
timevÆ
 
a
, timevÆ 
b
)

89 
timevÆ
 
ªt
;

91 
ªt
.
tv_u£c
 = 
a
.tv_u£¯- 
b
.tv_usec;

92 
ªt
.
tv_£c
 = 
a
.tv_£¯- 
b
.tv_sec;

94  
	`timevÆ_adju°
 (
ªt
);

95 
	}
}

98 
	$timevÆ_cmp
 (
timevÆ
 
a
, timevÆ 
b
)

100  (
a
.
tv_£c
 =
b
.tv_sec

101 ? 
a
.
tv_u£c
 - 
b
.tv_u£¯:á.
tv_£c
 - b.tv_sec);

102 
	}
}

105 
	$timevÆ_ñ≠£d
 (
timevÆ
 
a
, timevÆ 
b
)

107  (((
a
.
tv_£c
 - 
b
.tv_£cË* 
TIMER_SECOND_MICRO
)

108 + (
a
.
tv_u£c
 - 
b
.tv_usec));

109 
	}
}

111 #i‡!
deföed
(
HAVE_CLOCK_MONOTONIC
Ë&& !deföed(
__APPLE__
)

113 
	$quagga_gëtimeofday_ªœtive_adju°
 ()

115 
timevÆ
 
diff
;

116 i‡(
	`timevÆ_cmp
 (
ª˚¡_time
, 
œ°_ª˚¡_time
) < 0)

118 
ªœtive_time
.
tv_£c
++;

119 
ªœtive_time
.
tv_u£c
 = 0;

123 
diff
 = 
	`timevÆ_subåa˘
 (
ª˚¡_time
, 
œ°_ª˚¡_time
);

124 
ªœtive_time
.
tv_£c
 +
diff
.tv_sec;

125 
ªœtive_time
.
tv_u£c
 +
diff
.tv_usec;

126 
ªœtive_time
 = 
	`timevÆ_adju°
 (relative_time);

128 
œ°_ª˚¡_time
 = 
ª˚¡_time
;

129 
	}
}

134 
	$quagga_gëtimeofday
 (
timevÆ
 *
tv
)

136 
ªt
;

138 
	`as£π
 (
tv
);

140 i‡(!(
ªt
 = 
	`gëtimeofday
 (&
ª˚¡_time
, 
NULL
)))

143 i‡(!
timîs_öôed
)

145 
ªœtive_time_ba£
 = 
œ°_ª˚¡_time
 = 
ª˚¡_time
;

146 
timîs_öôed
 = 1;

149 i‡(
tv
 !&
ª˚¡_time
)

150 *
tv
 = 
ª˚¡_time
;

153  
ªt
;

154 
	}
}

157 
	$quagga_gë_ªœtive
 (
timevÆ
 *
tv
)

159 
ªt
;

161 #ifde‡
HAVE_CLOCK_MONOTONIC


163 
time•ec
 
ç
;

164 i‡(!(
ªt
 = 
	`˛ock_gëtime
 (
CLOCK_MONOTONIC
, &
ç
)))

166 
ªœtive_time
.
tv_£c
 = 
ç
.tv_sec;

167 
ªœtive_time
.
tv_u£c
 = 
ç
.
tv_n£c
 / 1000;

170 #ñi‡
	`deföed
(
__APPLE__
)

172 
uöt64_t
 
ticks
;

173 
uöt64_t
 
u£c⁄ds
;

174 
mach_timeba£_öfo_d©a_t
 
timeba£_öfo
;

176 
ticks
 = 
	`mach_absﬁuã_time
();

177 i‡(
timeba£_öfo
.
díom
 == 0)

178 
	`mach_timeba£_öfo
(&
timeba£_öfo
);

180 
u£c⁄ds
 = 
ticks
 * 
timeba£_öfo
.
numî
 /Åimeba£_öfo.
díom
 / 1000;

181 
ªœtive_time
.
tv_£c
 = 
u£c⁄ds
 / 1000000;

182 
ªœtive_time
.
tv_u£c
 = 
u£c⁄ds
 % 1000000;

187 i‡(!(
ªt
 = 
	`quagga_gëtimeofday
 (&
ª˚¡_time
)))

188 
	`quagga_gëtimeofday_ªœtive_adju°
();

191 i‡(
tv
)

192 *
tv
 = 
ªœtive_time
;

194  
ªt
;

195 
	}
}

201 
	$quagga_ªÆ_°abûi£d
 (
timevÆ
 *
tv
)

203 *
tv
 = 
ªœtive_time_ba£
;

204 
tv
->
tv_£c
 +
ªœtive_time
.tv_sec;

205 
tv
->
tv_u£c
 +
ªœtive_time
.tv_usec;

206 *
tv
 = 
	`timevÆ_adju°
 (*tv);

207 
	}
}

213 
	$quagga_gëtime
 (
quagga_˛kid
 
˛kid
, 
timevÆ
 *
tv
)

215 
˛kid
)

217 
QUAGGA_CLK_REALTIME
:

218  
	`quagga_gëtimeofday
 (
tv
);

219 
QUAGGA_CLK_MONOTONIC
:

220  
	`quagga_gë_ªœtive
 (
tv
);

221 
QUAGGA_CLK_REALTIME_STABILISED
:

222 
	`quagga_ªÆ_°abûi£d
 (
tv
);

225 
î∫o
 = 
EINVAL
;

228 
	}
}

233 
time_t


234 
	$quagga_time
 (
time_t
 *
t
)

236 
timevÆ
 
tv
;

237 
	`quagga_ªÆ_°abûi£d
 (&
tv
);

238 i‡(
t
)

239 *
t
 = 
tv
.
tv_£c
;

240  
tv
.
tv_£c
;

241 
	}
}

244 
timevÆ


245 
	$ª˚¡_ªœtive_time
 ()

247  
ªœtive_time
;

248 
	}
}

251 
	$˝u_ªc‹d_hash_key
 (
˝u_thªad_hi°‹y
 *
a
)

253  (
uöçå_t
Ë
a
->
func
;

254 
	}
}

257 
	$˝u_ªc‹d_hash_cmp
 (c⁄° 
˝u_thªad_hi°‹y
 *
a
,

258 c⁄° 
˝u_thªad_hi°‹y
 *
b
)

260  
a
->
func
 =
b
->func;

261 
	}
}

264 
	$˝u_ªc‹d_hash_Æloc
 (
˝u_thªad_hi°‹y
 *
a
)

266 
˝u_thªad_hi°‹y
 *
√w
;

267 
√w
 = 
	`XCALLOC
 (
MTYPE_THREAD_STATS
,  (
˝u_thªad_hi°‹y
));

268 
√w
->
func
 = 
a
->func;

269 
	`°r˝y
(
√w
->
fun˙ame
, 
a
->funcname);

270  
√w
;

271 
	}
}

274 
	$˝u_ªc‹d_hash_‰ì
 (*
a
)

276 
˝u_thªad_hi°‹y
 *
hi°
 = 
a
;

278 
	`XFREE
 (
MTYPE_THREAD_STATS
, 
hi°
);

279 
	}
}

282 
	$vty_out_˝u_thªad_hi°‹y
(
vty
* vty,

283 
˝u_thªad_hi°‹y
 *
a
)

285 #ifde‡
HAVE_RUSAGE


286 
	`vty_out
(
vty
, "%7ld.%03ld %9d %8ld %9ld %8ld %9ld",

287 
a
->
˝u
.
tŸÆ
/1000,á->˝u.tŸÆ%1000,á->
tŸÆ_ˇŒs
,

288 
a
->
˝u
.
tŸÆ
/a->
tŸÆ_ˇŒs
,á->˝u.
max
,

289 
a
->
ªÆ
.
tŸÆ
/a->
tŸÆ_ˇŒs
,á->ªÆ.
max
);

291 
	`vty_out
(
vty
, "%7ld.%03ld %9d %8ld %9ld",

292 
a
->
ªÆ
.
tŸÆ
/1000,á->ªÆ.tŸÆ%1000,á->
tŸÆ_ˇŒs
,

293 
a
->
ªÆ
.
tŸÆ
/a->
tŸÆ_ˇŒs
,á->ªÆ.
max
);

295 
	`vty_out
(
vty
, " %c%c%c%c%c%c %s%s",

296 
a
->
ty≥s
 & (1 << 
THREAD_READ
) ? 'R':' ',

297 
a
->
ty≥s
 & (1 << 
THREAD_WRITE
) ? 'W':' ',

298 
a
->
ty≥s
 & (1 << 
THREAD_TIMER
) ? 'T':' ',

299 
a
->
ty≥s
 & (1 << 
THREAD_EVENT
) ? 'E':' ',

300 
a
->
ty≥s
 & (1 << 
THREAD_EXECUTE
) ? 'X':' ',

301 
a
->
ty≥s
 & (1 << 
THREAD_BACKGROUND
) ? 'B' : ' ',

302 
a
->
fun˙ame
, 
VTY_NEWLINE
);

303 
	}
}

306 
	$˝u_ªc‹d_hash_¥öt
(
hash_backë
 *
buckë
,

307 *
¨gs
[])

309 
˝u_thªad_hi°‹y
 *
tŸÆs
 = 
¨gs
[0];

310 
vty
 *vty = 
¨gs
[1];

311 
thªad_ty≥
 *
fûãr
 = 
¨gs
[2];

312 
˝u_thªad_hi°‹y
 *
a
 = 
buckë
->
d©a
;

314 
a
 = 
buckë
->
d©a
;

315 i‡–!(
a
->
ty≥s
 & *
fûãr
) )

317 
	`vty_out_˝u_thªad_hi°‹y
(
vty
,
a
);

318 
tŸÆs
->
tŸÆ_ˇŒs
 +
a
->total_calls;

319 
tŸÆs
->
ªÆ
.
tŸÆ
 +
a
->real.total;

320 i‡(
tŸÆs
->
ªÆ
.
max
 < 
a
->real.max)

321 
tŸÆs
->
ªÆ
.
max
 = 
a
->real.max;

322 #ifde‡
HAVE_RUSAGE


323 
tŸÆs
->
˝u
.
tŸÆ
 +
a
->cpu.total;

324 i‡(
tŸÆs
->
˝u
.
max
 < 
a
->cpu.max)

325 
tŸÆs
->
˝u
.
max
 = 
a
->cpu.max;

327 
	}
}

330 
	$˝u_ªc‹d_¥öt
(
vty
 *vty, 
thªad_ty≥
 
fûãr
)

332 
˝u_thªad_hi°‹y
 
tmp
;

333 *
¨gs
[3] = {&
tmp
, 
vty
, &
fûãr
};

335 
	`mem£t
(&
tmp
, 0, Åmp);

336 
	`°r˝y
(
tmp
.
fun˙ame
, "TOTAL");

337 
tmp
.
ty≥s
 = 
fûãr
;

339 #ifde‡
HAVE_RUSAGE


340 
	`vty_out
(
vty
, "%21s %18s %18s%s",

341 "", "CPU (u£r+sy°em):", "Ró»(wÆl-˛ock):", 
VTY_NEWLINE
);

343 
	`vty_out
(
vty
, "Runtime(ms) Invoked Avg uSec Max uSecs");

344 #ifde‡
HAVE_RUSAGE


345 
	`vty_out
(
vty
, " Avg uSec Max uSecs");

347 
	`vty_out
(
vty
, " Ty≥ Thªad%s", 
VTY_NEWLINE
);

348 
	`hash_ôî©e
(
˝u_ªc‹d
,

349 ((*)(
hash_backë
*,*))
˝u_ªc‹d_hash_¥öt
,

350 
¨gs
);

352 i‡(
tmp
.
tŸÆ_ˇŒs
 > 0)

353 
	`vty_out_˝u_thªad_hi°‹y
(
vty
, &
tmp
);

354 
	}
}

356 
DEFUN
(
show_thªad_˝u
,

357 
show_thªad_˝u_cmd
,

359 
SHOW_STR


364 
	gi
 = 0;

365 
thªad_ty≥
 
	gfûãr
 = (thread_type) -1U;

367 i‡(
	g¨gc
 > 0)

369 
	gfûãr
 = 0;

370 
	g¨gv
[0][
i
] != '\0')

372  
¨gv
[0][
i
] )

376 
fûãr
 |(1 << 
THREAD_READ
);

380 
fûãr
 |(1 << 
THREAD_WRITE
);

384 
fûãr
 |(1 << 
THREAD_TIMER
);

388 
fûãr
 |(1 << 
THREAD_EVENT
);

392 
fûãr
 |(1 << 
THREAD_EXECUTE
);

396 
fûãr
 |(1 << 
THREAD_BACKGROUND
);

401 ++
	gi
;

403 i‡(
	gfûãr
 == 0)

405 
vty_out
(
vty
, "Invalid filter \"%s\" specified,"

407 
¨gv
[0], 
VTY_NEWLINE
);

408  
	gCMD_WARNING
;

412 
˝u_ªc‹d_¥öt
(
vty
, 
fûãr
);

413  
	gCMD_SUCCESS
;

417 
	$˝u_ªc‹d_hash_˛ór
 (
hash_backë
 *
buckë
,

418 *
¨gs
)

420 
thªad_ty≥
 *
fûãr
 = 
¨gs
;

421 
˝u_thªad_hi°‹y
 *
a
 = 
buckë
->
d©a
;

423 
a
 = 
buckë
->
d©a
;

424 i‡–!(
a
->
ty≥s
 & *
fûãr
) )

427 
	`hash_ªÀa£
 (
˝u_ªc‹d
, 
buckë
->
d©a
);

428 
	}
}

431 
	$˝u_ªc‹d_˛ór
 (
thªad_ty≥
 
fûãr
)

433 
thªad_ty≥
 *
tmp
 = &
fûãr
;

434 
	`hash_ôî©e
 (
˝u_ªc‹d
,

435 ((*Ë(
hash_backë
*,*)Ë
˝u_ªc‹d_hash_˛ór
,

436 
tmp
);

437 
	}
}

439 
DEFUN
(
˛ór_thªad_˝u
,

440 
˛ór_thªad_˝u_cmd
,

447 
	gi
 = 0;

448 
thªad_ty≥
 
	gfûãr
 = (thread_type) -1U;

450 i‡(
	g¨gc
 > 0)

452 
	gfûãr
 = 0;

453 
	g¨gv
[0][
i
] != '\0')

455  
¨gv
[0][
i
] )

459 
fûãr
 |(1 << 
THREAD_READ
);

463 
fûãr
 |(1 << 
THREAD_WRITE
);

467 
fûãr
 |(1 << 
THREAD_TIMER
);

471 
fûãr
 |(1 << 
THREAD_EVENT
);

475 
fûãr
 |(1 << 
THREAD_EXECUTE
);

479 
fûãr
 |(1 << 
THREAD_BACKGROUND
);

484 ++
	gi
;

486 i‡(
	gfûãr
 == 0)

488 
vty_out
(
vty
, "Invalid filter \"%s\" specified,"

490 
¨gv
[0], 
VTY_NEWLINE
);

491  
	gCMD_WARNING
;

495 
˝u_ªc‹d_˛ór
 (
fûãr
);

496  
	gCMD_SUCCESS
;

501 
	$thªad_li°_debug
 (
thªad_li°
 *
li°
)

503 
	`¥ötf
 ("count [%d] head [%p]Åail [%p]\n",

504 
li°
->
cou¡
,Üi°->
hód
,Üi°->
èû
);

505 
	}
}

508 
__©åibuã__
 ((
unu£d
))

509 
	$thªad_ma°î_debug
 (
thªad_ma°î
 *
m
)

511 
	`¥ötf
 ("-----------\n");

512 
	`¥ötf
 ("readlist : ");

513 
	`thªad_li°_debug
 (&
m
->
ªad
);

514 
	`¥ötf
 ("writelist : ");

515 
	`thªad_li°_debug
 (&
m
->
wrôe
);

516 
	`¥ötf
 ("timerlist : ");

517 
	`thªad_li°_debug
 (&
m
->
timî
);

518 
	`¥ötf
 ("eventlist : ");

519 
	`thªad_li°_debug
 (&
m
->
evít
);

520 
	`¥ötf
 ("unuselist : ");

521 
	`thªad_li°_debug
 (&
m
->
unu£
);

522 
	`¥ötf
 ("bgndlist : ");

523 
	`thªad_li°_debug
 (&
m
->
background
);

524 
	`¥ötf
 ("tŸÆáŒoc: [%ld]\n", 
m
->
Æloc
);

525 
	`¥ötf
 ("-----------\n");

526 
	}
}

529 
thªad_ma°î
 *

530 
	$thªad_ma°î_¸óã
 ()

532 i‡(
˝u_ªc‹d
 =
NULL
)

533 
˝u_ªc‹d


534 
	`hash_¸óã_size
 (1011, ((*Ë(*))
˝u_ªc‹d_hash_key
,

535 ((*Ë(c⁄° *, c⁄° *))
˝u_ªc‹d_hash_cmp
);

537  (
thªad_ma°î
 *Ë
	`XCALLOC
 (
MTYPE_THREAD_MASTER
,

538  (
thªad_ma°î
));

539 
	}
}

543 
	$thªad_li°_add
 (
thªad_li°
 *
li°
, 
thªad
 *thread)

545 
thªad
->
√xt
 = 
NULL
;

546 
thªad
->
¥ev
 = 
li°
->
èû
;

547 i‡(
li°
->
èû
)

548 
li°
->
èû
->
√xt
 = 
thªad
;

550 
li°
->
hód
 = 
thªad
;

551 
li°
->
èû
 = 
thªad
;

552 
li°
->
cou¡
++;

553 
	}
}

557 
	$thªad_li°_add_bef‹e
 (
thªad_li°
 *
li°
,

558 
thªad
 *
poöt
,

559 
thªad
 *thread)

561 
thªad
->
√xt
 = 
poöt
;

562 
thªad
->
¥ev
 = 
poöt
->prev;

563 i‡(
poöt
->
¥ev
)

564 
poöt
->
¥ev
->
√xt
 = 
thªad
;

566 
li°
->
hód
 = 
thªad
;

567 
poöt
->
¥ev
 = 
thªad
;

568 
li°
->
cou¡
++;

569 
	}
}

572 
thªad
 *

573 
	$thªad_li°_dñëe
 (
thªad_li°
 *
li°
, 
thªad
 *thread)

575 i‡(
thªad
->
√xt
)

576 
thªad
->
√xt
->
¥ev
 =Åhread->prev;

578 
li°
->
èû
 = 
thªad
->
¥ev
;

579 i‡(
thªad
->
¥ev
)

580 
thªad
->
¥ev
->
√xt
 =Åhread->next;

582 
li°
->
hód
 = 
thªad
->
√xt
;

583 
thªad
->
√xt
 =Åhªad->
¥ev
 = 
NULL
;

584 
li°
->
cou¡
--;

585  
thªad
;

586 
	}
}

590 
	$thªad_add_unu£
 (
thªad_ma°î
 *
m
, 
thªad
 *thread)

592 
	`as£π
 (
m
 !
NULL
 && 
thªad
 != NULL);

593 
	`as£π
 (
thªad
->
√xt
 =
NULL
);

594 
	`as£π
 (
thªad
->
¥ev
 =
NULL
);

595 
	`as£π
 (
thªad
->
ty≥
 =
THREAD_UNUSED
);

596 
	`thªad_li°_add
 (&
m
->
unu£
, 
thªad
);

598 
	}
}

602 
	$thªad_li°_‰ì
 (
thªad_ma°î
 *
m
, 
thªad_li°
 *
li°
)

604 
thªad
 *
t
;

605 
thªad
 *
√xt
;

607 
t
 = 
li°
->
hód
;Å;Å = 
√xt
)

609 
√xt
 = 
t
->next;

610 
	`XFREE
 (
MTYPE_THREAD
, 
t
);

611 
li°
->
cou¡
--;

612 
m
->
Æloc
--;

614 
	}
}

618 
	$thªad_ma°î_‰ì
 (
thªad_ma°î
 *
m
)

620 
	`thªad_li°_‰ì
 (
m
, &m->
ªad
);

621 
	`thªad_li°_‰ì
 (
m
, &m->
wrôe
);

622 
	`thªad_li°_‰ì
 (
m
, &m->
timî
);

623 
	`thªad_li°_‰ì
 (
m
, &m->
evít
);

624 
	`thªad_li°_‰ì
 (
m
, &m->
ªady
);

625 
	`thªad_li°_‰ì
 (
m
, &m->
unu£
);

626 
	`thªad_li°_‰ì
 (
m
, &m->
background
);

628 
	`XFREE
 (
MTYPE_THREAD_MASTER
, 
m
);

630 i‡(
˝u_ªc‹d
)

632 
	`hash_˛ón
 (
˝u_ªc‹d
, 
˝u_ªc‹d_hash_‰ì
);

633 
	`hash_‰ì
 (
˝u_ªc‹d
);

634 
˝u_ªc‹d
 = 
NULL
;

636 
	}
}

640 
	$thªad_em±y
 (
thªad_li°
 *
li°
)

642  
li°
->
hód
 ? 0 : 1;

643 
	}
}

646 
thªad
 *

647 
	$thªad_åim_hód
 (
thªad_li°
 *
li°
)

649 i‡(!
	`thªad_em±y
 (
li°
))

650  
	`thªad_li°_dñëe
 (
li°
,Üi°->
hód
);

651  
NULL
;

652 
	}
}

656 
	$thªad_timî_ªmaö_£c⁄d
 (
thªad
 *thread)

658 
	`quagga_gë_ªœtive
 (
NULL
);

660 i‡(
thªad
->
u
.
ßnds
.
tv_£c
 - 
ªœtive_time
.tv_sec > 0)

661  
thªad
->
u
.
ßnds
.
tv_£c
 - 
ªœtive_time
.tv_sec;

664 
	}
}

668 
	$°rù_fun˙ame
 (*
de°
, c⁄° *
fun˙ame
)

670 
buff
[
FUNCNAME_LEN
];

671 
tmp
, *
e
, *
b
 = 
buff
;

673 
	`°∫˝y
(
buff
, 
fun˙ame
, (buff));

674 
buff
[ (buff) -1] = '\0';

675 
e
 = 
buff
 +
	`°æí
(buff) -1;

679 *
b
 == ' ' || *b == '(')

680 ++
b
;

681 *
e
 == ' ' || *e == ')')

682 --
e
;

683 
e
++;

685 
tmp
 = *
e
;

686 *
e
 = '\0';

687 
	`°r˝y
 (
de°
, 
b
);

688 *
e
 = 
tmp
;

689 
	}
}

692 
thªad
 *

693 
thªad_gë
 (
thªad_ma°î
 *
m
, 
u_ch¨
 
ty≥
,

694 (*
func
Ë(
thªad
 *), *
¨g
, c⁄° * 
fun˙ame
)

696 
thªad
 *thªad = 
	`thªad_åim_hód
 (&
m
->
unu£
);

698 i‡(! 
thªad
)

700 
thªad
 = 
	`XCALLOC
 (
MTYPE_THREAD
,  (thread));

701 
m
->
Æloc
++;

703 
thªad
->
ty≥
 =Åype;

704 
thªad
->
add_ty≥
 = 
ty≥
;

705 
thªad
->
ma°î
 = 
m
;

706 
thªad
->
func
 = func;

707 
thªad
->
¨g
 =árg;

709 
	`°rù_fun˙ame
 (
thªad
->
fun˙ame
, funcname);

711  
thªad
;

712 
	}
}

715 
thªad
 *

716 
fun˙ame_thªad_add_ªad
 (
thªad_ma°î
 *
m
,

717 (*
func
Ë(
thªad
 *), *
¨g
, 
fd
, c⁄° * 
fun˙ame
)

719 
thªad
 *thread;

721 
	`as£π
 (
m
 !
NULL
);

723 i‡(
	`FD_ISSET
 (
fd
, &
m
->
ªadfd
))

725 
	`zlog
 (
NULL
, 
LOG_WARNING
, "Thîêi†ÆªadyÑód fd [%d]", 
fd
);

726  
NULL
;

729 
thªad
 = 
	`thªad_gë
 (
m
, 
THREAD_READ
, 
func
, 
¨g
, 
fun˙ame
);

730 
	`FD_SET
 (
fd
, &
m
->
ªadfd
);

731 
thªad
->
u
.
fd
 = fd;

732 
	`thªad_li°_add
 (&
m
->
ªad
, 
thªad
);

734  
thªad
;

735 
	}
}

738 
thªad
 *

739 
fun˙ame_thªad_add_wrôe
 (
thªad_ma°î
 *
m
,

740 (*
func
Ë(
thªad
 *), *
¨g
, 
fd
, c⁄° * 
fun˙ame
)

742 
thªad
 *thread;

744 
	`as£π
 (
m
 !
NULL
);

746 i‡(
	`FD_ISSET
 (
fd
, &
m
->
wrôefd
))

748 
	`zlog
 (
NULL
, 
LOG_WARNING
, "Thîêi†Æªady wrôêfd [%d]", 
fd
);

749  
NULL
;

752 
thªad
 = 
	`thªad_gë
 (
m
, 
THREAD_WRITE
, 
func
, 
¨g
, 
fun˙ame
);

753 
	`FD_SET
 (
fd
, &
m
->
wrôefd
);

754 
thªad
->
u
.
fd
 = fd;

755 
	`thªad_li°_add
 (&
m
->
wrôe
, 
thªad
);

757  
thªad
;

758 
	}
}

760 
thªad
 *

761 
fun˙ame_thªad_add_timî_timevÆ
 (
thªad_ma°î
 *
m
,

762 (*
func
Ë(
thªad
 *),

763 
ty≥
,

764 *
¨g
,

765 
timevÆ
 *
time_ªœtive
,

766 c⁄° * 
fun˙ame
)

768 
thªad
 *thread;

769 
thªad_li°
 *
li°
;

770 
timevÆ
 
Æ¨m_time
;

771 
thªad
 *
â
;

773 
	`as£π
 (
m
 !
NULL
);

775 
	`as£π
 (
ty≥
 =
THREAD_TIMER
 ||Åy≥ =
THREAD_BACKGROUND
);

776 
	`as£π
 (
time_ªœtive
);

778 
li°
 = ((
ty≥
 =
THREAD_TIMER
Ë? &
m
->
timî
 : &m->
background
);

779 
thªad
 = 
	`thªad_gë
 (
m
, 
ty≥
, 
func
, 
¨g
, 
fun˙ame
);

782 
	`quagga_gë_ªœtive
 (
NULL
);

783 
Æ¨m_time
.
tv_£c
 = 
ªœtive_time
.tv_£¯+ 
time_ªœtive
->tv_sec;

784 
Æ¨m_time
.
tv_u£c
 = 
ªœtive_time
.tv_u£¯+ 
time_ªœtive
->tv_usec;

785 
thªad
->
u
.
ßnds
 = 
	`timevÆ_adju°
(
Æ¨m_time
);

788 
â
 = 
li°
->
hód
;Åt;Åàâ->
√xt
)

789 i‡(
	`timevÆ_cmp
 (
thªad
->
u
.
ßnds
, 
â
->u.sands) <= 0)

792 i‡(
â
)

793 
	`thªad_li°_add_bef‹e
 (
li°
, 
â
, 
thªad
);

795 
	`thªad_li°_add
 (
li°
, 
thªad
);

797  
thªad
;

798 
	}
}

802 
thªad
 *

803 
fun˙ame_thªad_add_timî
 (
thªad_ma°î
 *
m
,

804 (*
func
Ë(
thªad
 *),

805 *
¨g
, 
timî
, c⁄° * 
fun˙ame
)

807 
timevÆ
 
åñ
;

809 
	`as£π
 (
m
 !
NULL
);

811 
åñ
.
tv_£c
 = 
timî
;

812 
åñ
.
tv_u£c
 = 0;

814  
	`fun˙ame_thªad_add_timî_timevÆ
 (
m
, 
func
, 
THREAD_TIMER
, 
¨g
,

815 &
åñ
, 
fun˙ame
);

816 
	}
}

819 
thªad
 *

820 
fun˙ame_thªad_add_timî_m£c
 (
thªad_ma°î
 *
m
,

821 (*
func
Ë(
thªad
 *),

822 *
¨g
, 
timî
, c⁄° * 
fun˙ame
)

824 
timevÆ
 
åñ
;

826 
	`as£π
 (
m
 !
NULL
);

828 
åñ
.
tv_£c
 = 
timî
 / 1000;

829 
åñ
.
tv_u£c
 = 1000*(
timî
 % 1000);

831  
	`fun˙ame_thªad_add_timî_timevÆ
 (
m
, 
func
, 
THREAD_TIMER
,

832 
¨g
, &
åñ
, 
fun˙ame
);

833 
	}
}

836 
thªad
 *

837 
fun˙ame_thªad_add_background
 (
thªad_ma°î
 *
m
,

838 (*
func
Ë(
thªad
 *),

839 *
¨g
, 
dñay
,

840 c⁄° *
fun˙ame
)

842 
timevÆ
 
åñ
;

844 
	`as£π
 (
m
 !
NULL
);

846 i‡(
dñay
)

848 
åñ
.
tv_£c
 = 
dñay
 / 1000;

849 
åñ
.
tv_u£c
 = 1000*(
dñay
 % 1000);

853 
åñ
.
tv_£c
 = 0;

854 
åñ
.
tv_u£c
 = 0;

857  
	`fun˙ame_thªad_add_timî_timevÆ
 (
m
, 
func
, 
THREAD_BACKGROUND
,

858 
¨g
, &
åñ
, 
fun˙ame
);

859 
	}
}

862 
thªad
 *

863 
fun˙ame_thªad_add_evít
 (
thªad_ma°î
 *
m
,

864 (*
func
Ë(
thªad
 *), *
¨g
, 
vÆ
, c⁄° * 
fun˙ame
)

866 
thªad
 *thread;

868 
	`as£π
 (
m
 !
NULL
);

870 
thªad
 = 
	`thªad_gë
 (
m
, 
THREAD_EVENT
, 
func
, 
¨g
, 
fun˙ame
);

871 
thªad
->
u
.
vÆ
 = val;

872 
	`thªad_li°_add
 (&
m
->
evít
, 
thªad
);

874  
thªad
;

875 
	}
}

879 
	$thªad_ˇn˚l
 (
thªad
 *thread)

881 
thªad_li°
 *
li°
;

883 
thªad
->
ty≥
)

885 
THREAD_READ
:

886 
	`as£π
 (
	`FD_ISSET
 (
thªad
->
u
.
fd
, &thªad->
ma°î
->
ªadfd
));

887 
	`FD_CLR
 (
thªad
->
u
.
fd
, &thªad->
ma°î
->
ªadfd
);

888 
li°
 = &
thªad
->
ma°î
->
ªad
;

890 
THREAD_WRITE
:

891 
	`as£π
 (
	`FD_ISSET
 (
thªad
->
u
.
fd
, &thªad->
ma°î
->
wrôefd
));

892 
	`FD_CLR
 (
thªad
->
u
.
fd
, &thªad->
ma°î
->
wrôefd
);

893 
li°
 = &
thªad
->
ma°î
->
wrôe
;

895 
THREAD_TIMER
:

896 
li°
 = &
thªad
->
ma°î
->
timî
;

898 
THREAD_EVENT
:

899 
li°
 = &
thªad
->
ma°î
->
evít
;

901 
THREAD_READY
:

902 
li°
 = &
thªad
->
ma°î
->
ªady
;

904 
THREAD_BACKGROUND
:

905 
li°
 = &
thªad
->
ma°î
->
background
;

911 
	`thªad_li°_dñëe
 (
li°
, 
thªad
);

912 
thªad
->
ty≥
 = 
THREAD_UNUSED
;

913 
	`thªad_add_unu£
 (
thªad
->
ma°î
,Åhread);

914 
	}
}

918 
	$thªad_ˇn˚l_evít
 (
thªad_ma°î
 *
m
, *
¨g
)

920 
ªt
 = 0;

921 
thªad
 *thread;

923 
thªad
 = 
m
->
evít
.
hód
;

924 
thªad
)

926 
thªad
 *
t
;

928 
t
 = 
thªad
;

929 
thªad
 = 
t
->
√xt
;

931 i‡(
t
->
¨g
 ==árg)

933 
ªt
++;

934 
	`thªad_li°_dñëe
 (&
m
->
evít
, 
t
);

935 
t
->
ty≥
 = 
THREAD_UNUSED
;

936 
	`thªad_add_unu£
 (
m
, 
t
);

941 
thªad
 = 
m
->
ªady
.
hód
;

942 
thªad
)

944 
thªad
 *
t
;

946 
t
 = 
thªad
;

947 
thªad
 = 
t
->
√xt
;

949 i‡(
t
->
¨g
 ==árg)

951 
ªt
++;

952 
	`thªad_li°_dñëe
 (&
m
->
ªady
, 
t
);

953 
t
->
ty≥
 = 
THREAD_UNUSED
;

954 
	`thªad_add_unu£
 (
m
, 
t
);

957  
ªt
;

958 
	}
}

960 
timevÆ
 *

961 
	$thªad_timî_waô
 (
thªad_li°
 *
éi°
, 
timevÆ
 *
timî_vÆ
)

963 i‡(!
	`thªad_em±y
 (
éi°
))

965 *
timî_vÆ
 = 
	`timevÆ_subåa˘
 (
éi°
->
hód
->
u
.
ßnds
, 
ªœtive_time
);

966  
timî_vÆ
;

968  
NULL
;

969 
	}
}

971 
thªad
 *

972 
	$thªad_run
 (
thªad_ma°î
 *
m
, 
thªad
 *thread,

973 
thªad
 *
„tch
)

975 *
„tch
 = *
thªad
;

976 
thªad
->
ty≥
 = 
THREAD_UNUSED
;

977 
	`thªad_add_unu£
 (
m
, 
thªad
);

978  
„tch
;

979 
	}
}

982 
	$thªad_¥o˚ss_fd
 (
thªad_li°
 *
li°
, 
fd_£t
 *
fd£t
, fd_£à*
mfd£t
)

984 
thªad
 *thread;

985 
thªad
 *
√xt
;

986 
ªady
 = 0;

988 
	`as£π
 (
li°
);

990 
thªad
 = 
li°
->
hód
;Åhªad;Åhªad = 
√xt
)

992 
√xt
 = 
thªad
->next;

994 i‡(
	`FD_ISSET
 (
	`THREAD_FD
 (
thªad
), 
fd£t
))

996 
	`as£π
 (
	`FD_ISSET
 (
	`THREAD_FD
 (
thªad
), 
mfd£t
));

997 
	`FD_CLR
(
	`THREAD_FD
 (
thªad
), 
mfd£t
);

998 
	`thªad_li°_dñëe
 (
li°
, 
thªad
);

999 
	`thªad_li°_add
 (&
thªad
->
ma°î
->
ªady
,Åhread);

1000 
thªad
->
ty≥
 = 
THREAD_READY
;

1001 
ªady
++;

1004  
ªady
;

1005 
	}
}

1009 
	$thªad_timî_¥o˚ss
 (
thªad_li°
 *
li°
, 
timevÆ
 *
timíow
)

1011 
thªad
 *thread;

1012 
thªad
 *
√xt
;

1013 
ªady
 = 0;

1015 
thªad
 = 
li°
->
hód
;Åhªad;Åhªad = 
√xt
)

1017 
√xt
 = 
thªad
->next;

1018 i‡(
	`timevÆ_cmp
 (*
timíow
, 
thªad
->
u
.
ßnds
) < 0)

1019  
ªady
;

1020 
	`thªad_li°_dñëe
 (
li°
, 
thªad
);

1021 
thªad
->
ty≥
 = 
THREAD_READY
;

1022 
	`thªad_li°_add
 (&
thªad
->
ma°î
->
ªady
,Åhread);

1023 
ªady
++;

1025  
ªady
;

1026 
	}
}

1030 
	$thªad_¥o˚ss
 (
thªad_li°
 *
li°
)

1032 
thªad
 *thread;

1033 
thªad
 *
√xt
;

1034 
ªady
 = 0;

1036 
thªad
 = 
li°
->
hód
;Åhªad;Åhªad = 
√xt
)

1038 
√xt
 = 
thªad
->next;

1039 
	`thªad_li°_dñëe
 (
li°
, 
thªad
);

1040 
thªad
->
ty≥
 = 
THREAD_READY
;

1041 
	`thªad_li°_add
 (&
thªad
->
ma°î
->
ªady
,Åhread);

1042 
ªady
++;

1044  
ªady
;

1045 
	}
}

1049 
thªad
 *

1050 
	$thªad_„tch
 (
thªad_ma°î
 *
m
, 
thªad
 *
„tch
)

1052 
thªad
 *thread;

1053 
fd_£t
 
ªadfd
;

1054 
fd_£t
 
wrôefd
;

1055 
fd_£t
 
ex˚±fd
;

1056 
timevÆ
 
timî_vÆ
 = { .
tv_£c
 = 0, .
tv_u£c
 = 0 };

1057 
timevÆ
 
timî_vÆ_bg
;

1058 
timevÆ
 *
timî_waô
 = &
timî_vÆ
;

1059 
timevÆ
 *
timî_waô_bg
;

1063 
num
 = 0;

1064 #i‡
deföed
 
HAVE_SNMP
 && deföed 
SNMP_AGENTX


1065 
timevÆ
 
¢mp_timî_waô
;

1066 
¢mpblock
 = 0;

1067 
fd£tsize
;

1071 
	`quagga_sigevít_¥o˚ss
 ();

1076 i‡((
thªad
 = 
	`thªad_åim_hód
 (&
m
->
ªady
)Ë!
NULL
)

1077  
	`thªad_run
 (
m
, 
thªad
, 
„tch
);

1085 
	`thªad_¥o˚ss
 (&
m
->
evít
);

1088 
ªadfd
 = 
m
->readfd;

1089 
wrôefd
 = 
m
->writefd;

1090 
ex˚±fd
 = 
m
->exceptfd;

1093 i‡(
m
->
ªady
.
cou¡
 == 0)

1095 
	`quagga_gë_ªœtive
 (
NULL
);

1096 
timî_waô
 = 
	`thªad_timî_waô
 (&
m
->
timî
, &
timî_vÆ
);

1097 
timî_waô_bg
 = 
	`thªad_timî_waô
 (&
m
->
background
, &
timî_vÆ_bg
);

1099 i‡(
timî_waô_bg
 &&

1100 (!
timî_waô
 || (
	`timevÆ_cmp
 (*timî_waô, *
timî_waô_bg
) > 0)))

1101 
timî_waô
 = 
timî_waô_bg
;

1104 #i‡
deföed
 
HAVE_SNMP
 && deföed 
SNMP_AGENTX


1110 i‡(
agítx_íabÀd
)

1112 
fd£tsize
 = 
FD_SETSIZE
;

1113 
¢mpblock
 = 1;

1114 i‡(
timî_waô
)

1116 
¢mpblock
 = 0;

1117 
	`mem˝y
(&
¢mp_timî_waô
, 
timî_waô
, (
timevÆ
));

1119 
	`¢mp_£À˘_öfo
(&
fd£tsize
, &
ªadfd
, &
¢mp_timî_waô
, &
¢mpblock
);

1120 i‡(
¢mpblock
 == 0)

1121 
timî_waô
 = &
¢mp_timî_waô
;

1124 
num
 = 
	`£À˘
 (
FD_SETSIZE
, &
ªadfd
, &
wrôefd
, &
ex˚±fd
, 
timî_waô
);

1127 i‡(
num
 < 0)

1129 i‡(
î∫o
 =
EINTR
)

1131 
	`zlog_w¨n
 ("£À˘(Ëîr‹: %s", 
	`ß„_°ªº‹
 (
î∫o
));

1132  
NULL
;

1135 #i‡
deföed
 
HAVE_SNMP
 && deföed 
SNMP_AGENTX


1136 i‡(
agítx_íabÀd
)

1138 i‡(
num
 > 0)

1139 
	`¢mp_ªad
(&
ªadfd
);

1140 i‡(
num
 == 0)

1142 
	`¢mp_timeout
();

1143 
	`run_Æ¨ms
();

1145 
	`√t¢mp_check_out°™dög_agít_ªque°s
();

1152 
	`quagga_gë_ªœtive
 (
NULL
);

1153 
	`thªad_timî_¥o˚ss
 (&
m
->
timî
, &
ªœtive_time
);

1156 i‡(
num
 > 0)

1159 
	`thªad_¥o˚ss_fd
 (&
m
->
ªad
, &
ªadfd
, &m->readfd);

1161 
	`thªad_¥o˚ss_fd
 (&
m
->
wrôe
, &
wrôefd
, &m->writefd);

1169 i‡((
thªad
 = 
	`thªad_åim_hód
 (&
m
->
ªady
)Ë!
NULL
)

1170  
	`thªad_run
 (
m
, 
thªad
, 
„tch
);

1174 
	`thªad_timî_¥o˚ss
 (&
m
->
background
, &
ªœtive_time
);

1176 i‡((
thªad
 = 
	`thªad_åim_hód
 (&
m
->
ªady
)Ë!
NULL
)

1177  
	`thªad_run
 (
m
, 
thªad
, 
„tch
);

1179 
	}
}

1182 
	$thªad_c⁄sumed_time
 (
RUSAGE_T
 *
now
, RUSAGE_T *
°¨t
, *
˝utime
)

1184 #ifde‡
HAVE_RUSAGE


1186 *
˝utime
 = 
	`timevÆ_ñ≠£d
 (
now
->
˝u
.
ru_utime
, 
°¨t
->cpu.ru_utime) +

1187 
	`timevÆ_ñ≠£d
 (
now
->
˝u
.
ru_°ime
, 
°¨t
->cpu.ru_stime);

1189 *
˝utime
 = 0;

1191  
	`timevÆ_ñ≠£d
 (
now
->
ªÆ
, 
°¨t
->real);

1192 
	}
}

1204 
	$thªad_should_yõld
 (
thªad
 *thread)

1206 
	`quagga_gë_ªœtive
 (
NULL
);

1207  (
	`timevÆ_ñ≠£d
(
ªœtive_time
, 
thªad
->
ªÆ
) >

1208 
THREAD_YIELD_TIME_SLOT
);

1209 
	}
}

1212 
	$thªad_gërußge
 (
RUSAGE_T
 *
r
)

1214 
	`quagga_gë_ªœtive
 (
NULL
);

1215 #ifde‡
HAVE_RUSAGE


1216 
	`gërußge
(
RUSAGE_SELF
, &(
r
->
˝u
));

1218 
r
->
ªÆ
 = 
ªœtive_time
;

1220 #ifde‡
HAVE_CLOCK_MONOTONIC


1225 
	`quagga_gëtimeofday
(&
ª˚¡_time
);

1227 
	}
}

1233 
	$thªad_ˇŒ
 (
thªad
 *thread)

1235 
ªÆtime
, 
˝utime
;

1236 
RUSAGE_T
 
bef‹e
, 
a·î
;

1244 i‡(!
thªad
->
hi°
)

1246 
˝u_thªad_hi°‹y
 
tmp
;

1248 
tmp
.
func
 = 
thªad
->func;

1249 
	`°r˝y
(
tmp
.
fun˙ame
, 
thªad
->funcname);

1251 
thªad
->
hi°
 = 
	`hash_gë
 (
˝u_ªc‹d
, &
tmp
,

1252 (* (*Ë(*))
˝u_ªc‹d_hash_Æloc
);

1255 
	`GETRUSAGE
 (&
bef‹e
);

1256 
thªad
->
ªÆ
 = 
bef‹e
.real;

1258 (*
thªad
->
func
) (thread);

1260 
	`GETRUSAGE
 (&
a·î
);

1262 
ªÆtime
 = 
	`thªad_c⁄sumed_time
 (&
a·î
, &
bef‹e
, &
˝utime
);

1263 
thªad
->
hi°
->
ªÆ
.
tŸÆ
 +
ªÆtime
;

1264 i‡(
thªad
->
hi°
->
ªÆ
.
max
 < 
ªÆtime
)

1265 
thªad
->
hi°
->
ªÆ
.
max
 = 
ªÆtime
;

1266 #ifde‡
HAVE_RUSAGE


1267 
thªad
->
hi°
->
˝u
.
tŸÆ
 +
˝utime
;

1268 i‡(
thªad
->
hi°
->
˝u
.
max
 < 
˝utime
)

1269 
thªad
->
hi°
->
˝u
.
max
 = 
˝utime
;

1272 ++(
thªad
->
hi°
->
tŸÆ_ˇŒs
);

1273 
thªad
->
hi°
->
ty≥s
 |(1 <<Åhªad->
add_ty≥
);

1275 #ifde‡
CONSUMED_TIME_CHECK


1276 i‡(
ªÆtime
 > 
CONSUMED_TIME_CHECK
)

1283 
	`zlog_w¨n
 ("SLOW THREAD:Åask %s (%lx)Ñan for %lums (cpuÅime %lums)",

1284 
thªad
->
fun˙ame
,

1285 (Ë
thªad
->
func
,

1286 
ªÆtime
/1000, 
˝utime
/1000);

1289 
	}
}

1292 
thªad
 *

1293 
fun˙ame_thªad_execuã
 (
thªad_ma°î
 *
m
,

1294 (*
func
)(
thªad
 *),

1295 *
¨g
,

1296 
vÆ
,

1297 c⁄° * 
fun˙ame
)

1299 
thªad
 
dummy
;

1301 
	`mem£t
 (&
dummy
, 0,  (
thªad
));

1303 
dummy
.
ty≥
 = 
THREAD_EVENT
;

1304 
dummy
.
add_ty≥
 = 
THREAD_EXECUTE
;

1305 
dummy
.
ma°î
 = 
NULL
;

1306 
dummy
.
func
 = func;

1307 
dummy
.
¨g
 =árg;

1308 
dummy
.
u
.
vÆ
 = val;

1309 
	`°rù_fun˙ame
 (
dummy
.
fun˙ame
, funcname);

1310 
	`thªad_ˇŒ
 (&
dummy
);

1312  
NULL
;

1313 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/thread.h

23 #i‚de‡
_ZEBRA_THREAD_H


24 
	#_ZEBRA_THREAD_H


	)

26 
	~<zebø.h
>

28 
	srußge_t


30 #ifde‡
HAVE_RUSAGE


31 
rußge
 
	m˝u
;

33 
timevÆ
 
	mªÆ
;

35 
	#RUSAGE_T
 
rußge_t


	)

37 
	#GETRUSAGE
(
X
Ë
	`thªad_gërußge
(X)

	)

40 
	sthªad_li°


42 
thªad
 *
	mhód
;

43 
thªad
 *
	mèû
;

44 
	mcou¡
;

48 
	sthªad_ma°î


50 
thªad_li°
 
	mªad
;

51 
thªad_li°
 
	mwrôe
;

52 
thªad_li°
 
	mtimî
;

53 
thªad_li°
 
	mevít
;

54 
thªad_li°
 
	mªady
;

55 
thªad_li°
 
	munu£
;

56 
thªad_li°
 
	mbackground
;

57 
fd_£t
 
	mªadfd
;

58 
fd_£t
 
	mwrôefd
;

59 
fd_£t
 
	mex˚±fd
;

60 
	mÆloc
;

63 
	tthªad_ty≥
;

66 
	#FUNCNAME_LEN
 64

	)

69 
	sthªad


71 
thªad_ty≥
 
	mty≥
;

72 
thªad_ty≥
 
	madd_ty≥
;

73 
thªad
 *
	m√xt
;

74 
thªad
 *
	m¥ev
;

75 
thªad_ma°î
 *
	mma°î
;

76 (*
	mfunc
Ë(
	mthªad
 *);

77 *
	m¨g
;

79 
	mvÆ
;

80 
	mfd
;

81 
timevÆ
 
	mßnds
;

82 } 
	mu
;

83 
timevÆ
 
	mªÆ
;

84 
˝u_thªad_hi°‹y
 *
	mhi°
;

85 
	mfun˙ame
[
FUNCNAME_LEN
];

88 
	s˝u_thªad_hi°‹y


90 (*
	mfunc
)(
	mthªad
 *);

91 
	mtŸÆ_ˇŒs
;

92 
	stime_°©s


94 
	mtŸÆ
, 
	mmax
;

95 } 
	mªÆ
;

96 #ifde‡
HAVE_RUSAGE


97 
time_°©s
 
	m˝u
;

99 
thªad_ty≥
 
	mty≥s
;

100 
	mfun˙ame
[
FUNCNAME_LEN
];

104 
	equagga_˛kid
 {

105 
	mQUAGGA_CLK_REALTIME
 = 0,

106 
	mQUAGGA_CLK_MONOTONIC
,

107 
	mQUAGGA_CLK_REALTIME_STABILISED
,

111 
	#THREAD_READ
 0

	)

112 
	#THREAD_WRITE
 1

	)

113 
	#THREAD_TIMER
 2

	)

114 
	#THREAD_EVENT
 3

	)

115 
	#THREAD_READY
 4

	)

116 
	#THREAD_BACKGROUND
 5

	)

117 
	#THREAD_UNUSED
 6

	)

118 
	#THREAD_EXECUTE
 7

	)

121 
	#THREAD_YIELD_TIME_SLOT
 10 * 1000L

	)

124 
	#THREAD_ARG
(
X
Ë((X)->
¨g
)

	)

125 
	#THREAD_FD
(
X
Ë((X)->
u
.
fd
)

	)

126 
	#THREAD_VAL
(
X
Ë((X)->
u
.
vÆ
)

	)

128 
	#THREAD_READ_ON
(
ma°î
,
thªad
,
func
,
¨g
,
sock
) \

130 i‡(! 
thªad
) \

131 
thªad
 = 
	`thªad_add_ªad
 (
ma°î
, 
func
, 
¨g
, 
sock
); \

132 } 0)

	)

134 
	#THREAD_WRITE_ON
(
ma°î
,
thªad
,
func
,
¨g
,
sock
) \

136 i‡(! 
thªad
) \

137 
thªad
 = 
	`thªad_add_wrôe
 (
ma°î
, 
func
, 
¨g
, 
sock
); \

138 } 0)

	)

140 
	#THREAD_TIMER_ON
(
ma°î
,
thªad
,
func
,
¨g
,
time
) \

142 i‡(! 
thªad
) \

143 
thªad
 = 
	`thªad_add_timî
 (
ma°î
, 
func
, 
¨g
, 
time
); \

144 } 0)

	)

146 
	#THREAD_TIMER_MSEC_ON
(
ma°î
,
thªad
,
func
,
¨g
,
time
) \

148 i‡(! 
thªad
) \

149 
thªad
 = 
	`thªad_add_timî_m£c
 (
ma°î
, 
func
, 
¨g
, 
time
); \

150 } 0)

	)

152 
	#THREAD_OFF
(
thªad
) \

154 i‡(
thªad
) \

156 
	`thªad_ˇn˚l
 (
thªad
); \

157 
thªad
 = 
NULL
; \

159 } 0)

	)

161 
	#THREAD_READ_OFF
(
thªad
Ë
	`THREAD_OFF
—hªad)

	)

162 
	#THREAD_WRITE_OFF
(
thªad
Ë
	`THREAD_OFF
—hªad)

	)

163 
	#THREAD_TIMER_OFF
(
thªad
Ë
	`THREAD_OFF
—hªad)

	)

165 
	#thªad_add_ªad
(
m
,
f
,
a
,
v
Ë
	`fun˙ame_thªad_add_ªad
(m,f,a,v,#f)

	)

166 
	#thªad_add_wrôe
(
m
,
f
,
a
,
v
Ë
	`fun˙ame_thªad_add_wrôe
(m,f,a,v,#f)

	)

167 
	#thªad_add_timî
(
m
,
f
,
a
,
v
Ë
	`fun˙ame_thªad_add_timî
(m,f,a,v,#f)

	)

168 
	#thªad_add_timî_m£c
(
m
,
f
,
a
,
v
Ë
	`fun˙ame_thªad_add_timî_m£c
(m,f,a,v,#f)

	)

169 
	#thªad_add_evít
(
m
,
f
,
a
,
v
Ë
	`fun˙ame_thªad_add_evít
(m,f,a,v,#f)

	)

170 
	#thªad_execuã
(
m
,
f
,
a
,
v
Ë
	`fun˙ame_thªad_execuã
(m,f,a,v,#f)

	)

173 
	#thªad_add_background
(
m
,
f
,
a
,
v
Ë
	`fun˙ame_thªad_add_background
(m,f,a,v,#f)

	)

176 
thªad_ma°î
 *
thªad_ma°î_¸óã
 ();

177 
thªad_ma°î_‰ì
 (
thªad_ma°î
 *);

179 
thªad
 *
fun˙ame_thªad_add_ªad
 (
thªad_ma°î
 *,

180 (*)(
thªad
 *),

182 
thªad
 *
	`fun˙ame_thªad_add_wrôe
 (
thªad_ma°î
 *,

183 (*)(
thªad
 *),

185 
thªad
 *
	`fun˙ame_thªad_add_timî
 (
thªad_ma°î
 *,

186 (*)(
thªad
 *),

188 
thªad
 *
	`fun˙ame_thªad_add_timî_m£c
 (
thªad_ma°î
 *,

189 (*)(
thªad
 *),

191 
thªad
 *
	`fun˙ame_thªad_add_evít
 (
thªad_ma°î
 *,

192 (*)(
thªad
 *),

194 
thªad
 *
	`fun˙ame_thªad_add_background
 (
thªad_ma°î
 *,

195 (*
func
)(
thªad
 *),

196 *
¨g
,

197 
mûli£c⁄ds_to_dñay
,

198 c⁄° *
fun˙ame
);

199 
thªad
 *
	`fun˙ame_thªad_execuã
 (
thªad_ma°î
 *,

200 (*)(
thªad
 *),

202 
	`thªad_ˇn˚l
 (
thªad
 *);

203 
	`thªad_ˇn˚l_evít
 (
thªad_ma°î
 *, *);

204 
thªad
 *
	`thªad_„tch
 (
thªad_ma°î
 *, thread *);

205 
	`thªad_ˇŒ
 (
thªad
 *);

206 
	`thªad_timî_ªmaö_£c⁄d
 (
thªad
 *);

207 
	`thªad_should_yõld
 (
thªad
 *);

210 
	`thªad_gërußge
 (
RUSAGE_T
 *);

211 
cmd_ñemít
 
show_thªad_˝u_cmd
;

212 
cmd_ñemít
 
˛ór_thªad_˝u_cmd
;

218 
	`quagga_gëtime
 (
quagga_˛kid
, 
timevÆ
 *);

219 
time_t
 
	`quagga_time
 (time_t *);

222 
	`thªad_c⁄sumed_time
(
RUSAGE_T
 *
a·î
, RUSAGE_T *
bef‹e
,

223 *
˝u_time_ñ≠£d
);

228 
timevÆ
 
ª˚¡_time
;

230 
timevÆ
 
	`ª˚¡_ªœtive_time
 ();

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vector.c

22 
	~<zebø.h
>

24 
	~"ve˘‹.h
"

25 
	~"mem‹y.h
"

28 
ve˘‹


29 
	$ve˘‹_öô
 (
size
)

31 
ve˘‹
 
v
 = 
	`XCALLOC
 (
MTYPE_VECTOR
,  (
_ve˘‹
));

34 i‡(
size
 == 0)

35 
size
 = 1;

37 
v
->
Ælo˚d
 = 
size
;

38 
v
->
a˘ive
 = 0;

39 
v
->
ödex
 = 
	`XCALLOC
 (
MTYPE_VECTOR_INDEX
,  (*Ë* 
size
);

40  
v
;

41 
	}
}

44 
	$ve˘‹_⁄ly_wøµî_‰ì
 (
ve˘‹
 
v
)

46 
	`XFREE
 (
MTYPE_VECTOR
, 
v
);

47 
	}
}

50 
	$ve˘‹_⁄ly_ödex_‰ì
 (*
ödex
)

52 
	`XFREE
 (
MTYPE_VECTOR_INDEX
, 
ödex
);

53 
	}
}

56 
	$ve˘‹_‰ì
 (
ve˘‹
 
v
)

58 
	`XFREE
 (
MTYPE_VECTOR_INDEX
, 
v
->
ödex
);

59 
	`XFREE
 (
MTYPE_VECTOR
, 
v
);

60 
	}
}

62 
ve˘‹


63 
	$ve˘‹_c›y
 (
ve˘‹
 
v
)

65 
size
;

66 
ve˘‹
 
√w
 = 
	`XCALLOC
 (
MTYPE_VECTOR
,  (
_ve˘‹
));

68 
√w
->
a˘ive
 = 
v
->active;

69 
√w
->
Ælo˚d
 = 
v
->alloced;

71 
size
 =  (*Ë* (
v
->
Ælo˚d
);

72 
√w
->
ödex
 = 
	`XCALLOC
 (
MTYPE_VECTOR_INDEX
, 
size
);

73 
	`mem˝y
 (
√w
->
ödex
, 
v
->ödex, 
size
);

75  
√w
;

76 
	}
}

80 
	$ve˘‹_ísuª
 (
ve˘‹
 
v
, 
num
)

82 i‡(
v
->
Ælo˚d
 > 
num
)

85 
v
->
ödex
 = 
	`XREALLOC
 (
MTYPE_VECTOR_INDEX
,

86 
v
->
ödex
,  (*Ë* (v->
Ælo˚d
 * 2));

87 
	`mem£t
 (&
v
->
ödex
[v->
Ælo˚d
], 0,  (*) * v->alloced);

88 
v
->
Ælo˚d
 *= 2;

90 i‡(
v
->
Ælo˚d
 <
num
)

91 
	`ve˘‹_ísuª
 (
v
, 
num
);

92 
	}
}

98 
	$ve˘‹_em±y_¶Ÿ
 (
ve˘‹
 
v
)

100 
i
;

102 i‡(
v
->
a˘ive
 == 0)

105 
i
 = 0; i < 
v
->
a˘ive
; i++)

106 i‡(
v
->
ödex
[
i
] == 0)

107  
i
;

109  
i
;

110 
	}
}

114 
	$ve˘‹_£t
 (
ve˘‹
 
v
, *
vÆ
)

116 
i
;

118 
i
 = 
	`ve˘‹_em±y_¶Ÿ
 (
v
);

119 
	`ve˘‹_ísuª
 (
v
, 
i
);

121 
v
->
ödex
[
i
] = 
vÆ
;

123 i‡(
v
->
a˘ive
 <
i
)

124 
v
->
a˘ive
 = 
i
 + 1;

126  
i
;

127 
	}
}

131 
	$ve˘‹_£t_ödex
 (
ve˘‹
 
v
, 
i
, *
vÆ
)

133 
	`ve˘‹_ísuª
 (
v
, 
i
);

135 
v
->
ödex
[
i
] = 
vÆ
;

137 i‡(
v
->
a˘ive
 <
i
)

138 
v
->
a˘ive
 = 
i
 + 1;

140  
i
;

141 
	}
}

145 
	$ve˘‹_lookup
 (
ve˘‹
 
v
, 
i
)

147 i‡(
i
 >
v
->
a˘ive
)

148  
NULL
;

149  
v
->
ödex
[
i
];

150 
	}
}

154 
	$ve˘‹_lookup_ísuª
 (
ve˘‹
 
v
, 
i
)

156 
	`ve˘‹_ísuª
 (
v
, 
i
);

157  
v
->
ödex
[
i
];

158 
	}
}

162 
	$ve˘‹_un£t
 (
ve˘‹
 
v
, 
i
)

164 i‡(
i
 >
v
->
Ælo˚d
)

167 
v
->
ödex
[
i
] = 
NULL
;

169 i‡(
i
 + 1 =
v
->
a˘ive
)

171 
v
->
a˘ive
--;

172 
i
 && 
v
->
ödex
[--i] =
NULL
 && v->
a˘ive
--)

175 
	}
}

179 
	$ve˘‹_cou¡
 (
ve˘‹
 
v
)

181 
i
;

182 
cou¡
 = 0;

184 
i
 = 0; i < 
v
->
a˘ive
; i++)

185 i‡(
v
->
ödex
[
i
] !
NULL
)

186 
cou¡
++;

188  
cou¡
;

189 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vector.h

23 #i‚de‡
_ZEBRA_VECTOR_H


24 
	#_ZEBRA_VECTOR_H


	)

27 
	s_ve˘‹


29 
	ma˘ive
;

30 
	mÆlo˚d
;

31 **
	mödex
;

33 
_ve˘‹
 *
	tve˘‹
;

35 
	#VECTOR_MIN_SIZE
 1

	)

40 
	#ve˘‹_¶Ÿ
(
V
,
I
Ë((V)->
ödex
[(I)])

	)

45 
	#ve˘‹_a˘ive
(
V
Ë((V)->
a˘ive
)

	)

48 
ve˘‹
 
ve˘‹_öô
 (
size
);

49 
ve˘‹_ísuª
 (
ve˘‹
 
v
, 
num
);

50 
ve˘‹_em±y_¶Ÿ
 (
ve˘‹
 
v
);

51 
ve˘‹_£t
 (
ve˘‹
 
v
, *
vÆ
);

52 
ve˘‹_£t_ödex
 (
ve˘‹
 
v
, 
i
, *
vÆ
);

53 
ve˘‹_un£t
 (
ve˘‹
 
v
, 
i
);

54 
ve˘‹_cou¡
 (
ve˘‹
 
v
);

55 
ve˘‹_⁄ly_wøµî_‰ì
 (
ve˘‹
 
v
);

56 
ve˘‹_⁄ly_ödex_‰ì
 (*
ödex
);

57 
ve˘‹_‰ì
 (
ve˘‹
 
v
);

58 
ve˘‹
 
ve˘‹_c›y
 (ve˘‹ 
v
);

60 *
ve˘‹_lookup
 (
ve˘‹
, );

61 *
ve˘‹_lookup_ísuª
 (
ve˘‹
, );

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/version.h

24 #i‚de‡
_ZEBRA_VERSION_H


25 
	#_ZEBRA_VERSION_H


	)

27 #ifde‡
GIT_VERSION


28 
	~"gôvîsi⁄.h
"

31 #i‚de‡
GIT_SUFFIX


32 
	#GIT_SUFFIX
 ""

	)

34 #i‚de‡
GIT_INFO


35 
	#GIT_INFO
 ""

	)

38 
	#QUAGGA_PROGNAME
 "QuaggaSRx"

	)

40 
	#QUAGGA_VERSION
 "0.4.2.7" 
GIT_SUFFIX


	)

42 
	#ZEBRA_BUG_ADDRESS
 "hâp://bgp§x.™td.ni°.gov"

	)

44 
	#QUAGGA_URL
 "hâp://www.quagga.√t"

	)

46 
	#QUAGGA_COPYRIGHT
 "C›yrighà1996-2005 KunihúÿIshiguro,ÉàÆ."

	)

48 
pid_t
 
pid_ouçut
 (const *);

50 #i‚de‡
HAVE_DAEMON


51 
d´m⁄
(, );

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vty.c

23 
	~<zebø.h
>

25 
	~"lökli°.h
"

26 
	~"thªad.h
"

27 
	~"buf„r.h
"

28 
	~<lib/vîsi⁄.h
>

29 
	~"comm™d.h
"

30 
	~"sockuni⁄.h
"

31 
	~"mem‹y.h
"

32 
	~"°r.h
"

33 
	~"log.h
"

34 
	~"¥efix.h
"

35 
	~"fûãr.h
"

36 
	~"vty.h
"

37 
	~"¥ivs.h
"

38 
	~"√tw‹k.h
"

40 
	~<¨∑/ã ë.h
>

43 
	eevít


45 
	mVTY_SERV
,

46 
	mVTY_READ
,

47 
	mVTY_WRITE
,

48 
	mVTY_TIMEOUT_RESET
,

49 #ifde‡
VTYSH


50 
	mVTYSH_SERV
,

51 
	mVTYSH_READ
,

52 
	mVTYSH_WRITE


56 
vty_evít
 (
evít
, , 
vty
 *);

59 
ho°
 host;

62 
ve˘‹
 
	gvtyvec
;

65 
	gvty_timeout_vÆ
 = 
VTY_TIMEOUT_DEFAULT
;

68 *
	gvty_ac˚s¶i°_«me
 = 
NULL
;

71 *
	gvty_ùv6_ac˚s¶i°_«me
 = 
NULL
;

74 
ve˘‹
 
	gVvty_£rv_thªad
;

77 *
	gvty_cwd
 = 
NULL
;

80 
	gvty_c⁄fig
;

83 
	gno_∑ssw‹d_check
 = 0;

86 c⁄° 
u_ch¨
 
	gª°ri˘ed_mode_deÁu…
 = 0;

87 
u_ch¨
 
	gª°ri˘ed_mode
 = 0;

90 
	göãgøã_deÁu…
[] = 
SYSCONFDIR
 
INTEGRATE_DEFAULT_CONFIG
;

95 
	$vty_out
 (
vty
 *vty, c⁄° *
f‹m©
, ...)

97 
va_li°
 
¨gs
;

98 
Àn
 = 0;

99 
size
 = 1024;

100 
buf
[1024];

101 *
p
 = 
NULL
;

103 i‡(
	`vty_shñl
 (
vty
))

105 
	`va_°¨t
 (
¨gs
, 
f‹m©
);

106 
	`v¥ötf
 (
f‹m©
, 
¨gs
);

107 
	`va_íd
 (
¨gs
);

112 
	`va_°¨t
 (
¨gs
, 
f‹m©
);

113 
Àn
 = 
	`v¢¥ötf
 (
buf
,  buf, 
f‹m©
, 
¨gs
);

114 
	`va_íd
 (
¨gs
);

117 i‡(
Àn
 < 0 ||Üí >
size
)

121 i‡(
Àn
 > -1)

122 
size
 = 
Àn
 + 1;

124 
size
 = size * 2;

126 
p
 = 
	`XREALLOC
 (
MTYPE_VTY_OUT_BUF
,Ö, 
size
);

127 i‡(! 
p
)

130 
	`va_°¨t
 (
¨gs
, 
f‹m©
);

131 
Àn
 = 
	`v¢¥ötf
 (
p
, 
size
, 
f‹m©
, 
¨gs
);

132 
	`va_íd
 (
¨gs
);

134 i‡(
Àn
 > -1 &&Üí < 
size
)

140 i‡(! 
p
)

141 
p
 = 
buf
;

144 
	`buf„r_put
 (
vty
->
obuf
, (
u_ch¨
 *Ë
p
, 
Àn
);

147 i‡(
p
 !
buf
)

148 
	`XFREE
 (
MTYPE_VTY_OUT_BUF
, 
p
);

151  
Àn
;

152 
	}
}

155 
	$vty_log_out
 (
vty
 *vty, c⁄° *
Àvñ
, c⁄° *
¥Ÿo_°r
,

156 c⁄° *
f‹m©
, 
time°amp_c⁄åﬁ
 *
˘l
, 
va_li°
 
va
)

158 
ªt
;

159 
Àn
;

160 
buf
[1024];

162 i‡(!
˘l
->
Æªady_ªndîed
)

164 
˘l
->
Àn
 = 
	`quagga_time°amp
(˘l->
¥ecisi⁄
, cé->
buf
, (ctl->buf));

165 
˘l
->
Æªady_ªndîed
 = 1;

167 i‡(
˘l
->
Àn
+1 >(
buf
))

169 
	`mem˝y
(
buf
, 
˘l
->buf, 
Àn
 = ctl->len);

170 
buf
[
Àn
++] = ' ';

171 
buf
[
Àn
] = '\0';

173 i‡(
Àvñ
)

174 
ªt
 = 
	`¢¥ötf
(
buf
+
Àn
, (buf)-Àn, "%s: %s: ", 
Àvñ
, 
¥Ÿo_°r
);

176 
ªt
 = 
	`¢¥ötf
(
buf
+
Àn
, (buf)-Àn, "%s: ", 
¥Ÿo_°r
);

177 i‡((
ªt
 < 0Ë|| ((
size_t
)(
Àn
 +ªtË>(
buf
)))

180 i‡(((
ªt
 = 
	`v¢¥ötf
(
buf
+
Àn
, (buf)-Àn, 
f‹m©
, 
va
)) < 0) ||

181 ((
size_t
)((
Àn
 +
ªt
)+2Ë> (
buf
)))

184 
buf
[
Àn
++] = '\r';

185 
buf
[
Àn
++] = '\n';

187 i‡(
	`wrôe
(
vty
->
fd
, 
buf
, 
Àn
) < 0)

189 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

194 
vty
->
m⁄ô‹
 = 0;

195 
	`zlog_w¨n
("%s: write failedÅo vty client fd %d, closing: %s",

196 
__func__
, 
vty
->
fd
, 
	`ß„_°ªº‹
(
î∫o
));

197 
	`buf„r_ª£t
(
vty
->
obuf
);

200 
vty
->
°©us
 = 
VTY_CLOSE
;

201 
	`shutdown
(
vty
->
fd
, 
SHUT_RDWR
);

205 
	}
}

209 
	$vty_time_¥öt
 (
vty
 *vty, 
¸
)

211 
buf
 [25];

213 i‡(
	`quagga_time°amp
(0, 
buf
, (buf)) == 0)

215 
	`zlog
 (
NULL
, 
LOG_INFO
, "quagga_timestampÉrror");

218 i‡(
¸
)

219 
	`vty_out
 (
vty
, "%s\n", 
buf
);

221 
	`vty_out
 (
vty
, "%†", 
buf
);

224 
	}
}

228 
	$vty_hñlo
 (
vty
 *vty)

230 i‡(
ho°
.
mŸdfûe
)

232 
FILE
 *
f
;

233 
buf
[4096];

235 
f
 = 
	`f›í
 (
ho°
.
mŸdfûe
, "r");

236 i‡(
f
)

238 
	`fgës
 (
buf
,  (buf), 
f
))

240 *
s
;

242 
s
 = 
buf
 + 
	`°æí
 (buf); (†> bufË&& 
	`is•a˚
 (()*(s - 1));

243 
s
--);

244 *
s
 = '\0';

245 
	`vty_out
 (
vty
, "%s%s", 
buf
, 
VTY_NEWLINE
);

247 
	`f˛o£
 (
f
);

250 
	`vty_out
 (
vty
, "MOTD fûênŸ found%s", 
VTY_NEWLINE
);

252 i‡(
ho°
.
mŸd
)

253 
	`vty_out
 (
vty
, "%s", 
ho°
.
mŸd
);

254 
	}
}

258 
	$vty_¥om±
 (
vty
 *vty)

260 
ut¢ame
 
«mes
;

261 c⁄° *
ho°«me
;

263 i‡(
vty
->
ty≥
 =
VTY_TERM
)

265 
ho°«me
 = 
ho°
.
«me
;

266 i‡(!
ho°«me
)

268 
	`u«me
 (&
«mes
);

269 
ho°«me
 = 
«mes
.
nodíame
;

271 
	`vty_out
 (
vty
, 
	`cmd_¥om±
 (vty->
node
), 
ho°«me
);

273 
	}
}

277 
	$vty_wûl_echo
 (
vty
 *vty)

279 
cmd
[] = { 
IAC
, 
WILL
, 
TELOPT_ECHO
, '\0' };

280 
	`vty_out
 (
vty
, "%s", 
cmd
);

281 
	}
}

285 
	$vty_wûl_suµªss_go_ahód
 (
vty
 *vty)

287 
cmd
[] = { 
IAC
, 
WILL
, 
TELOPT_SGA
, '\0' };

288 
	`vty_out
 (
vty
, "%s", 
cmd
);

289 
	}
}

293 
	$vty_d⁄t_löemode
 (
vty
 *vty)

295 
cmd
[] = { 
IAC
, 
DONT
, 
TELOPT_LINEMODE
, '\0' };

296 
	`vty_out
 (
vty
, "%s", 
cmd
);

297 
	}
}

301 
	$vty_do_wödow_size
 (
vty
 *vty)

303 
cmd
[] = { 
IAC
, 
DO
, 
TELOPT_NAWS
, '\0' };

304 
	`vty_out
 (
vty
, "%s", 
cmd
);

305 
	}
}

310 
	$vty_d⁄t_lÊow_ahód
 (
vty
 *vty)

312 
cmd
[] = { 
IAC
, 
DONT
, 
TELOPT_LFLOW
, '\0' };

313 
	`vty_out
 (
vty
, "%s", 
cmd
);

314 
	}
}

318 
vty
 *

319 
	$vty_√w
 ()

321 
vty
 *
√w
 = 
	`XCALLOC
 (
MTYPE_VTY
,  (vty));

323 
√w
->
obuf
 = 
	`buf„r_√w
(0);

324 
√w
->
buf
 = 
	`XCALLOC
 (
MTYPE_VTY
, 
VTY_BUFSIZ
);

325 
√w
->
max
 = 
VTY_BUFSIZ
;

327  
√w
;

328 
	}
}

332 
	$vty_auth
 (
vty
 *vty, *
buf
)

334 *
∑sswd
 = 
NULL
;

335 
node_ty≥
 
√xt_node
 = 0;

336 
Áû
;

337 *
	`¸y±
 (const *, const *);

339 
vty
->
node
)

341 
AUTH_NODE
:

342 i‡(
ho°
.
í¸y±
)

343 
∑sswd
 = 
ho°
.
∑ssw‹d_í¸y±
;

345 
∑sswd
 = 
ho°
.
∑ssw‹d
;

346 i‡(
ho°
.
adv™˚d
)

347 
√xt_node
 = 
ho°
.
íabÀ
 ? 
VIEW_NODE
 : 
ENABLE_NODE
;

349 
√xt_node
 = 
VIEW_NODE
;

351 
AUTH_ENABLE_NODE
:

352 i‡(
ho°
.
í¸y±
)

353 
∑sswd
 = 
ho°
.
íabÀ_í¸y±
;

355 
∑sswd
 = 
ho°
.
íabÀ
;

356 
√xt_node
 = 
ENABLE_NODE
;

360 i‡(
∑sswd
)

362 i‡(
ho°
.
í¸y±
)

363 
Áû
 = 
	`°rcmp
 (
	`¸y±
(
buf
, 
∑sswd
),Öasswd);

365 
Áû
 = 
	`°rcmp
 (
buf
, 
∑sswd
);

368 
Áû
 = 1;

370 i‡(! 
Áû
)

372 
vty
->
Áû
 = 0;

373 
vty
->
node
 = 
√xt_node
;

377 
vty
->
Áû
++;

378 i‡(
vty
->
Áû
 >= 3)

380 i‡(
vty
->
node
 =
AUTH_NODE
)

382 
	`vty_out
 (
vty
, "%% BadÖassw‹ds,Åoÿm™y faûuªs!%s", 
VTY_NEWLINE
);

383 
vty
->
°©us
 = 
VTY_CLOSE
;

388 
vty
->
Áû
 = 0;

389 
	`vty_out
 (
vty
, "%% BadÉ«bÀÖassw‹ds,Åoÿm™y faûuªs!%s", 
VTY_NEWLINE
);

390 
vty
->
node
 = 
ª°ri˘ed_mode
 ? 
RESTRICTED_NODE
 : 
VIEW_NODE
;

394 
	}
}

398 
	$vty_comm™d
 (
vty
 *vty, *
buf
)

400 
ªt
;

401 
ve˘‹
 
vlöe
;

402 c⁄° *
¥Ÿocﬁ«me
;

405 
vlöe
 = 
	`cmd_make_°rvec
 (
buf
);

407 i‡(
vlöe
 =
NULL
)

408  
CMD_SUCCESS
;

410 #ifde‡
CONSUMED_TIME_CHECK


412 
RUSAGE_T
 
bef‹e
;

413 
RUSAGE_T
 
a·î
;

414 
ªÆtime
, 
˝utime
;

416 
	`GETRUSAGE
(&
bef‹e
);

419 
ªt
 = 
	`cmd_execuã_comm™d
 (
vlöe
, 
vty
, 
NULL
, 0);

422 i‡(
zlog_deÁu…
)

423 
¥Ÿocﬁ«me
 = 
zlog_¥Ÿo_«mes
[
zlog_deÁu…
->
¥Ÿocﬁ
];

425 
¥Ÿocﬁ«me
 = 
zlog_¥Ÿo_«mes
[
ZLOG_NONE
];

427 #ifde‡
CONSUMED_TIME_CHECK


428 
	`GETRUSAGE
(&
a·î
);

429 i‡((
ªÆtime
 = 
	`thªad_c⁄sumed_time
(&
a·î
, &
bef‹e
, &
˝utime
)) >

430 
CONSUMED_TIME_CHECK
)

432 
	`zlog_w¨n
("SLOW COMMAND: commandÅook %lums (cpuÅime %lums): %s",

433 
ªÆtime
/1000, 
˝utime
/1000, 
buf
);

437 i‡(
ªt
 !
CMD_SUCCESS
)

438 
ªt
)

440 
CMD_WARNING
:

441 i‡(
vty
->
ty≥
 =
VTY_FILE
)

442 
	`vty_out
 (
vty
, "W¨nög...%s", 
VTY_NEWLINE
);

444 
CMD_ERR_AMBIGUOUS
:

445 
	`vty_out
 (
vty
, "%% Ambiguou†comm™d.%s", 
VTY_NEWLINE
);

447 
CMD_ERR_NO_MATCH
:

448 
	`vty_out
 (
vty
, "%% [%s] Unknow¿comm™d: %s%s", 
¥Ÿocﬁ«me
, 
buf
, 
VTY_NEWLINE
);

450 
CMD_ERR_INCOMPLETE
:

451 
	`vty_out
 (
vty
, "%% Comm™d incom∂ëe.%s", 
VTY_NEWLINE
);

454 
	`cmd_‰ì_°rvec
 (
vlöe
);

456  
ªt
;

457 
	}
}

459 c⁄° 
	gã ë_backw¨d_ch¨
 = 0x08;

460 c⁄° 
	gã ë_•a˚_ch¨
 = ' ';

464 
	$vty_wrôe
 (
vty
 *vty, c⁄° *
buf
, 
size_t
 
nbyãs
)

466 i‡((
vty
->
node
 =
AUTH_NODE
Ë|| (vty->nodê=
AUTH_ENABLE_NODE
))

470 
	`buf„r_put
 (
vty
->
obuf
, 
buf
, 
nbyãs
);

471 
	}
}

475 
	$vty_ísuª
 (
vty
 *vty, 
Àngth
)

477 i‡(
vty
->
max
 <
Àngth
)

479 
vty
->
max
 *= 2;

480 
vty
->
buf
 = 
	`XREALLOC
 (
MTYPE_VTY
, vty->buf, vty->
max
);

482 
	}
}

486 
	$vty_£lf_ö£π
 (
vty
 *vty, 
c
)

488 
i
;

489 
Àngth
;

491 
	`vty_ísuª
 (
vty
, vty->
Àngth
 + 1);

492 
Àngth
 = 
vty
->Àngth - vty->
˝
;

493 
	`memmove
 (&
vty
->
buf
[vty->
˝
 + 1], &vty->buf[vty->˝], 
Àngth
);

494 
vty
->
buf
[vty->
˝
] = 
c
;

496 
	`vty_wrôe
 (
vty
, &vty->
buf
[vty->
˝
], 
Àngth
 + 1);

497 
i
 = 0; i < 
Àngth
; i++)

498 
	`vty_wrôe
 (
vty
, &
ã ë_backw¨d_ch¨
, 1);

500 
vty
->
˝
++;

501 
vty
->
Àngth
++;

502 
	}
}

506 
	$vty_£lf_ö£π_ovîwrôe
 (
vty
 *vty, 
c
)

508 
	`vty_ísuª
 (
vty
, vty->
Àngth
 + 1);

509 
vty
->
buf
[vty->
˝
++] = 
c
;

511 i‡(
vty
->
˝
 > vty->
Àngth
)

512 
vty
->
Àngth
++;

514 i‡((
vty
->
node
 =
AUTH_NODE
Ë|| (vty->nodê=
AUTH_ENABLE_NODE
))

517 
	`vty_wrôe
 (
vty
, &
c
, 1);

518 
	}
}

522 
	$vty_ö£π_w‹d_ovîwrôe
 (
vty
 *vty, *
°r
)

524 
Àn
 = 
	`°æí
 (
°r
);

525 
	`vty_wrôe
 (
vty
, 
°r
, 
Àn
);

526 
	`°r˝y
 (&
vty
->
buf
[vty->
˝
], 
°r
);

527 
vty
->
˝
 +
Àn
;

528 
vty
->
Àngth
 = vty->
˝
;

529 
	}
}

533 
	$vty_f‹w¨d_ch¨
 (
vty
 *vty)

535 i‡(
vty
->
˝
 < vty->
Àngth
)

537 
	`vty_wrôe
 (
vty
, &vty->
buf
[vty->
˝
], 1);

538 
vty
->
˝
++;

540 
	}
}

544 
	$vty_backw¨d_ch¨
 (
vty
 *vty)

546 i‡(
vty
->
˝
 > 0)

548 
vty
->
˝
--;

549 
	`vty_wrôe
 (
vty
, &
ã ë_backw¨d_ch¨
, 1);

551 
	}
}

555 
	$vty_begönög_of_löe
 (
vty
 *vty)

557 
vty
->
˝
)

558 
	`vty_backw¨d_ch¨
 (
vty
);

559 
	}
}

563 
	$vty_íd_of_löe
 (
vty
 *vty)

565 
vty
->
˝
 < vty->
Àngth
)

566 
	`vty_f‹w¨d_ch¨
 (
vty
);

567 
	}
}

569 
vty_kûl_löe_‰om_begönög
 (
vty
 *);

570 
vty_ªdøw_löe
 (
vty
 *);

575 
	$vty_hi°‹y_¥öt
 (
vty
 *vty)

577 
Àngth
;

579 
	`vty_kûl_löe_‰om_begönög
 (
vty
);

582 
Àngth
 = 
	`°æí
 (
vty
->
hi°
[vty->
hp
]);

583 
	`mem˝y
 (
vty
->
buf
, vty->
hi°
[vty->
hp
], 
Àngth
);

584 
vty
->
˝
 = vty->
Àngth
 =Üength;

587 
	`vty_ªdøw_löe
 (
vty
);

588 
	}
}

592 
	$vty_√xt_löe
 (
vty
 *vty)

594 
åy_ödex
;

596 i‡(
vty
->
hp
 =vty->
hödex
)

600 
åy_ödex
 = 
vty
->
hp
;

601 i‡(
åy_ödex
 =(
VTY_MAXHIST
 - 1))

602 
åy_ödex
 = 0;

604 
åy_ödex
++;

607 i‡(
vty
->
hi°
[
åy_ödex
] =
NULL
)

610 
vty
->
hp
 = 
åy_ödex
;

612 
	`vty_hi°‹y_¥öt
 (
vty
);

613 
	}
}

617 
	$vty_¥evious_löe
 (
vty
 *vty)

619 
åy_ödex
;

621 
åy_ödex
 = 
vty
->
hp
;

622 i‡(
åy_ödex
 == 0)

623 
åy_ödex
 = 
VTY_MAXHIST
 - 1;

625 
åy_ödex
--;

627 i‡(
vty
->
hi°
[
åy_ödex
] =
NULL
)

630 
vty
->
hp
 = 
åy_ödex
;

632 
	`vty_hi°‹y_¥öt
 (
vty
);

633 
	}
}

637 
	$vty_ªdøw_löe
 (
vty
 *vty)

639 
	`vty_wrôe
 (
vty
, vty->
buf
, vty->
Àngth
);

640 
vty
->
˝
 = vty->
Àngth
;

641 
	}
}

645 
	$vty_f‹w¨d_w‹d
 (
vty
 *vty)

647 
vty
->
˝
 !vty->
Àngth
 && vty->
buf
[vty->cp] != ' ')

648 
	`vty_f‹w¨d_ch¨
 (
vty
);

650 
vty
->
˝
 !vty->
Àngth
 && vty->
buf
[vty->cp] == ' ')

651 
	`vty_f‹w¨d_ch¨
 (
vty
);

652 
	}
}

656 
	$vty_backw¨d_puª_w‹d
 (
vty
 *vty)

658 
vty
->
˝
 > 0 && vty->
buf
[vty->cp - 1] != ' ')

659 
	`vty_backw¨d_ch¨
 (
vty
);

660 
	}
}

664 
	$vty_backw¨d_w‹d
 (
vty
 *vty)

666 
vty
->
˝
 > 0 && vty->
buf
[vty->cp - 1] == ' ')

667 
	`vty_backw¨d_ch¨
 (
vty
);

669 
vty
->
˝
 > 0 && vty->
buf
[vty->cp - 1] != ' ')

670 
	`vty_backw¨d_ch¨
 (
vty
);

671 
	}
}

676 
	$vty_down_Àvñ
 (
vty
 *vty)

678 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

679 (*
c⁄fig_exô_cmd
.
func
)(
NULL
, 
vty
, 0, NULL);

680 
	`vty_¥om±
 (
vty
);

681 
vty
->
˝
 = 0;

682 
	}
}

686 
	$vty_íd_c⁄fig
 (
vty
 *vty)

688 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

690 
vty
->
node
)

692 
VIEW_NODE
:

693 
ENABLE_NODE
:

694 
RESTRICTED_NODE
:

697 
CONFIG_NODE
:

698 
INTERFACE_NODE
:

699 
ZEBRA_NODE
:

700 
RIP_NODE
:

701 
RIPNG_NODE
:

702 
BABEL_NODE
:

703 
BGP_NODE
:

704 
BGP_VPNV4_NODE
:

705 
BGP_IPV4_NODE
:

706 
BGP_IPV4M_NODE
:

707 
BGP_IPV6_NODE
:

708 
BGP_IPV6M_NODE
:

709 
RMAP_NODE
:

710 
OSPF_NODE
:

711 
OSPF6_NODE
:

712 
ISIS_NODE
:

713 
KEYCHAIN_NODE
:

714 
KEYCHAIN_KEY_NODE
:

715 
MASC_NODE
:

716 
VTY_NODE
:

717 
	`vty_c⁄fig_u∆ock
 (
vty
);

718 
vty
->
node
 = 
ENABLE_NODE
;

725 
	`vty_¥om±
 (
vty
);

726 
vty
->
˝
 = 0;

727 
	}
}

731 
	$vty_dñëe_ch¨
 (
vty
 *vty)

733 
i
;

734 
size
;

736 i‡(
vty
->
Àngth
 == 0)

738 
	`vty_down_Àvñ
 (
vty
);

742 i‡(
vty
->
˝
 =vty->
Àngth
)

745 
size
 = 
vty
->
Àngth
 - vty->
˝
;

747 
vty
->
Àngth
--;

748 
	`memmove
 (&
vty
->
buf
[vty->
˝
], &vty->buf[vty->˝ + 1], 
size
 - 1);

749 
vty
->
buf
[vty->
Àngth
] = '\0';

751 i‡(
vty
->
node
 =
AUTH_NODE
 || vty->nodê=
AUTH_ENABLE_NODE
)

754 
	`vty_wrôe
 (
vty
, &vty->
buf
[vty->
˝
], 
size
 - 1);

755 
	`vty_wrôe
 (
vty
, &
ã ë_•a˚_ch¨
, 1);

757 
i
 = 0; i < 
size
; i++)

758 
	`vty_wrôe
 (
vty
, &
ã ë_backw¨d_ch¨
, 1);

759 
	}
}

763 
	$vty_dñëe_backw¨d_ch¨
 (
vty
 *vty)

765 i‡(
vty
->
˝
 == 0)

768 
	`vty_backw¨d_ch¨
 (
vty
);

769 
	`vty_dñëe_ch¨
 (
vty
);

770 
	}
}

774 
	$vty_kûl_löe
 (
vty
 *vty)

776 
i
;

777 
size
;

779 
size
 = 
vty
->
Àngth
 - vty->
˝
;

781 i‡(
size
 == 0)

784 
i
 = 0; i < 
size
; i++)

785 
	`vty_wrôe
 (
vty
, &
ã ë_•a˚_ch¨
, 1);

786 
i
 = 0; i < 
size
; i++)

787 
	`vty_wrôe
 (
vty
, &
ã ë_backw¨d_ch¨
, 1);

789 
	`mem£t
 (&
vty
->
buf
[vty->
˝
], 0, 
size
);

790 
vty
->
Àngth
 = vty->
˝
;

791 
	}
}

795 
	$vty_kûl_löe_‰om_begönög
 (
vty
 *vty)

797 
	`vty_begönög_of_löe
 (
vty
);

798 
	`vty_kûl_löe
 (
vty
);

799 
	}
}

803 
	$vty_f‹w¨d_kûl_w‹d
 (
vty
 *vty)

805 
vty
->
˝
 !vty->
Àngth
 && vty->
buf
[vty->cp] == ' ')

806 
	`vty_dñëe_ch¨
 (
vty
);

807 
vty
->
˝
 !vty->
Àngth
 && vty->
buf
[vty->cp] != ' ')

808 
	`vty_dñëe_ch¨
 (
vty
);

809 
	}
}

813 
	$vty_backw¨d_kûl_w‹d
 (
vty
 *vty)

815 
vty
->
˝
 > 0 && vty->
buf
[vty->cp - 1] == ' ')

816 
	`vty_dñëe_backw¨d_ch¨
 (
vty
);

817 
vty
->
˝
 > 0 && vty->
buf
[vty->cp - 1] != ' ')

818 
	`vty_dñëe_backw¨d_ch¨
 (
vty
);

819 
	}
}

823 
	$vty_å™•o£_ch¨s
 (
vty
 *vty)

825 
c1
, 
c2
;

829 i‡(
vty
->
Àngth
 < 2 || vty->
˝
 < 1)

833 i‡(
vty
->
˝
 =vty->
Àngth
)

835 
c1
 = 
vty
->
buf
[vty->
˝
 - 1];

836 
c2
 = 
vty
->
buf
[vty->
˝
 - 2];

838 
	`vty_backw¨d_ch¨
 (
vty
);

839 
	`vty_backw¨d_ch¨
 (
vty
);

840 
	`vty_£lf_ö£π_ovîwrôe
 (
vty
, 
c1
);

841 
	`vty_£lf_ö£π_ovîwrôe
 (
vty
, 
c2
);

845 
c1
 = 
vty
->
buf
[vty->
˝
];

846 
c2
 = 
vty
->
buf
[vty->
˝
 - 1];

848 
	`vty_backw¨d_ch¨
 (
vty
);

849 
	`vty_£lf_ö£π_ovîwrôe
 (
vty
, 
c1
);

850 
	`vty_£lf_ö£π_ovîwrôe
 (
vty
, 
c2
);

852 
	}
}

856 
	$vty_com∂ëe_comm™d
 (
vty
 *vty)

858 
i
;

859 
ªt
;

860 **
m©ched
 = 
NULL
;

861 
ve˘‹
 
vlöe
;

863 i‡(
vty
->
node
 =
AUTH_NODE
 || vty->nodê=
AUTH_ENABLE_NODE
)

866 
vlöe
 = 
	`cmd_make_°rvec
 (
vty
->
buf
);

867 i‡(
vlöe
 =
NULL
)

871 i‡(
	`is•a˚
 ((Ë
vty
->
buf
[vty->
Àngth
 - 1]))

872 
	`ve˘‹_£t
 (
vlöe
, '\0');

874 
m©ched
 = 
	`cmd_com∂ëe_comm™d
 (
vlöe
, 
vty
, &
ªt
);

876 
	`cmd_‰ì_°rvec
 (
vlöe
);

878 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

879 
ªt
)

881 
CMD_ERR_AMBIGUOUS
:

882 
	`vty_out
 (
vty
, "%% Ambiguou†comm™d.%s", 
VTY_NEWLINE
);

883 
	`vty_¥om±
 (
vty
);

884 
	`vty_ªdøw_löe
 (
vty
);

886 
CMD_ERR_NO_MATCH
:

888 
	`vty_¥om±
 (
vty
);

889 
	`vty_ªdøw_löe
 (
vty
);

891 
CMD_COMPLETE_FULL_MATCH
:

892 
	`vty_¥om±
 (
vty
);

893 
	`vty_ªdøw_löe
 (
vty
);

894 
	`vty_backw¨d_puª_w‹d
 (
vty
);

895 
	`vty_ö£π_w‹d_ovîwrôe
 (
vty
, 
m©ched
[0]);

896 
	`vty_£lf_ö£π
 (
vty
, ' ');

897 
	`XFREE
 (
MTYPE_TMP
, 
m©ched
[0]);

899 
CMD_COMPLETE_MATCH
:

900 
	`vty_¥om±
 (
vty
);

901 
	`vty_ªdøw_löe
 (
vty
);

902 
	`vty_backw¨d_puª_w‹d
 (
vty
);

903 
	`vty_ö£π_w‹d_ovîwrôe
 (
vty
, 
m©ched
[0]);

904 
	`XFREE
 (
MTYPE_TMP
, 
m©ched
[0]);

905 
	`ve˘‹_⁄ly_ödex_‰ì
 (
m©ched
);

908 
CMD_COMPLETE_LIST_MATCH
:

909 
i
 = 0; 
m©ched
[i] !
NULL
; i++)

911 i‡(
i
 != 0 && ((i % 6) == 0))

912 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

913 
	`vty_out
 (
vty
, "%-10†", 
m©ched
[
i
]);

914 
	`XFREE
 (
MTYPE_TMP
, 
m©ched
[
i
]);

916 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

918 
	`vty_¥om±
 (
vty
);

919 
	`vty_ªdøw_löe
 (
vty
);

921 
CMD_ERR_NOTHING_TODO
:

922 
	`vty_¥om±
 (
vty
);

923 
	`vty_ªdøw_löe
 (
vty
);

928 i‡(
m©ched
)

929 
	`ve˘‹_⁄ly_ödex_‰ì
 (
m©ched
);

930 
	}
}

933 
	$vty_des¸ibe_fﬁd
 (
vty
 *vty, 
cmd_width
,

934 
desc_width
, 
desc
 *desc)

936 *
buf
;

937 c⁄° *
cmd
, *
p
;

938 
pos
;

940 
cmd
 = 
desc
->cmd[0] == '.' ? desc->cmd + 1 : desc->cmd;

942 i‡(
desc_width
 <= 0)

944 
	`vty_out
 (
vty
, " %-*† %s%s", 
cmd_width
, 
cmd
, 
desc
->
°r
, 
VTY_NEWLINE
);

948 
buf
 = 
	`XCALLOC
 (
MTYPE_TMP
, 
	`°æí
 (
desc
->
°r
) + 1);

950 
p
 = 
desc
->
°r
; 
	`°æí
 (pË> 
desc_width
;Ö +
pos
 + 1)

952 
pos
 = 
desc_width
;Öos > 0;Öos--)

953 i‡(*(
p
 + 
pos
) == ' ')

956 i‡(
pos
 == 0)

959 
	`°∫˝y
 (
buf
, 
p
, 
pos
);

960 
buf
[
pos
] = '\0';

961 
	`vty_out
 (
vty
, " %-*† %s%s", 
cmd_width
, 
cmd
, 
buf
, 
VTY_NEWLINE
);

963 
cmd
 = "";

966 
	`vty_out
 (
vty
, " %-*† %s%s", 
cmd_width
, 
cmd
, 
p
, 
VTY_NEWLINE
);

968 
	`XFREE
 (
MTYPE_TMP
, 
buf
);

969 
	}
}

973 
	$vty_des¸ibe_comm™d
 (
vty
 *vty)

975 
ªt
;

976 
ve˘‹
 
vlöe
;

977 
ve˘‹
 
des¸ibe
;

978 
i
, 
width
, 
desc_width
;

979 
desc
 *desc, *
desc_¸
 = 
NULL
;

981 
vlöe
 = 
	`cmd_make_°rvec
 (
vty
->
buf
);

984 i‡(
vlöe
 =
NULL
)

986 
vlöe
 = 
	`ve˘‹_öô
 (1);

987 
	`ve˘‹_£t
 (
vlöe
, '\0');

990 i‡(
	`is•a˚
 ((Ë
vty
->
buf
[vty->
Àngth
 - 1]))

991 
	`ve˘‹_£t
 (
vlöe
, '\0');

993 
des¸ibe
 = 
	`cmd_des¸ibe_comm™d
 (
vlöe
, 
vty
, &
ªt
);

995 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

998 
ªt
)

1000 
CMD_ERR_AMBIGUOUS
:

1001 
	`vty_out
 (
vty
, "%% Ambiguou†comm™d.%s", 
VTY_NEWLINE
);

1002 
out
;

1004 
CMD_ERR_NO_MATCH
:

1005 
	`vty_out
 (
vty
, "%% Thîêi†nÿm©ched comm™d.%s", 
VTY_NEWLINE
);

1006 
out
;

1011 
width
 = 0;

1012 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
des¸ibe
); i++)

1013 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
des¸ibe
, 
i
)Ë!
NULL
)

1015 
Àn
;

1017 i‡(
desc
->
cmd
[0] == '\0')

1020 
Àn
 = 
	`°æí
 (
desc
->
cmd
);

1021 i‡(
desc
->
cmd
[0] == '.')

1022 
Àn
--;

1024 i‡(
width
 < 
Àn
)

1025 
width
 = 
Àn
;

1029 
desc_width
 = 
vty
->
width
 - (width + 6);

1032 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
des¸ibe
); i++)

1033 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
des¸ibe
, 
i
)Ë!
NULL
)

1035 i‡(
desc
->
cmd
[0] == '\0')

1038 i‡(
	`°rcmp
 (
desc
->
cmd
, 
comm™d_¸
) == 0)

1040 
desc_¸
 = 
desc
;

1044 i‡(!
desc
->
°r
)

1045 
	`vty_out
 (
vty
, " %-s%s",

1046 
desc
->
cmd
[0] == '.' ? desc->cmd + 1 : desc->cmd,

1047 
VTY_NEWLINE
);

1048 i‡(
desc_width
 >
	`°æí
 (
desc
->
°r
))

1049 
	`vty_out
 (
vty
, " %-*† %s%s", 
width
,

1050 
desc
->
cmd
[0] == '.' ? desc->cmd + 1 : desc->cmd,

1051 
desc
->
°r
, 
VTY_NEWLINE
);

1053 
	`vty_des¸ibe_fﬁd
 (
vty
, 
width
, 
desc_width
, 
desc
);

1056 
	`vty_out
 (
vty
, " %-*†%s%s", 
width


1057 
desc
->
cmd
[0] == '.' ? desc->cmd + 1 : desc->cmd,

1058 
desc
->
°r
 ? desc->°∏: "", 
VTY_NEWLINE
);

1062 i‡((
desc
 = 
desc_¸
))

1064 i‡(!
desc
->
°r
)

1065 
	`vty_out
 (
vty
, " %-s%s",

1066 
desc
->
cmd
[0] == '.' ? desc->cmd + 1 : desc->cmd,

1067 
VTY_NEWLINE
);

1068 i‡(
desc_width
 >
	`°æí
 (
desc
->
°r
))

1069 
	`vty_out
 (
vty
, " %-*† %s%s", 
width
,

1070 
desc
->
cmd
[0] == '.' ? desc->cmd + 1 : desc->cmd,

1071 
desc
->
°r
, 
VTY_NEWLINE
);

1073 
	`vty_des¸ibe_fﬁd
 (
vty
, 
width
, 
desc_width
, 
desc
);

1076 
out
:

1077 
	`cmd_‰ì_°rvec
 (
vlöe
);

1078 i‡(
des¸ibe
)

1079 
	`ve˘‹_‰ì
 (
des¸ibe
);

1081 
	`vty_¥om±
 (
vty
);

1082 
	`vty_ªdøw_löe
 (
vty
);

1083 
	}
}

1086 
	$vty_˛ór_buf
 (
vty
 *vty)

1088 
	`mem£t
 (
vty
->
buf
, 0, vty->
max
);

1089 
	}
}

1093 
	$vty_°›_öput
 (
vty
 *vty)

1095 
vty
->
˝
 = vty->
Àngth
 = 0;

1096 
	`vty_˛ór_buf
 (
vty
);

1097 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1099 
vty
->
node
)

1101 
VIEW_NODE
:

1102 
ENABLE_NODE
:

1103 
RESTRICTED_NODE
:

1106 
CONFIG_NODE
:

1107 
INTERFACE_NODE
:

1108 
ZEBRA_NODE
:

1109 
RIP_NODE
:

1110 
RIPNG_NODE
:

1111 
BABEL_NODE
:

1112 
BGP_NODE
:

1113 
RMAP_NODE
:

1114 
OSPF_NODE
:

1115 
OSPF6_NODE
:

1116 
ISIS_NODE
:

1117 
KEYCHAIN_NODE
:

1118 
KEYCHAIN_KEY_NODE
:

1119 
MASC_NODE
:

1120 
VTY_NODE
:

1121 
	`vty_c⁄fig_u∆ock
 (
vty
);

1122 
vty
->
node
 = 
ENABLE_NODE
;

1128 
	`vty_¥om±
 (
vty
);

1131 
vty
->
hp
 = vty->
hödex
;

1132 
	}
}

1136 
	$vty_hi°_add
 (
vty
 *vty)

1138 
ödex
;

1140 i‡(
vty
->
Àngth
 == 0)

1143 
ödex
 = 
vty
->
hödex
 ? vty->hödex - 1 : 
VTY_MAXHIST
 - 1;

1146 i‡(
vty
->
hi°
[
ödex
])

1147 i‡(
	`°rcmp
 (
vty
->
buf
, vty->
hi°
[
ödex
]) == 0)

1149 
vty
->
hp
 = vty->
hödex
;

1154 i‡(
vty
->
hi°
[vty->
hödex
])

1155 
	`XFREE
 (
MTYPE_VTY_HIST
, 
vty
->
hi°
[vty->
hödex
]);

1156 
vty
->
hi°
[vty->
hödex
] = 
	`XSTRDUP
 (
MTYPE_VTY_HIST
, vty->
buf
);

1159 
vty
->
hödex
++;

1160 i‡(
vty
->
hödex
 =
VTY_MAXHIST
)

1161 
vty
->
hödex
 = 0;

1163 
vty
->
hp
 = vty->
hödex
;

1164 
	}
}

1170 
	$vty_ã ë_›ti⁄
 (
vty
 *vty, *
buf
, 
nbyãs
)

1172 #ifde‡
TELNET_OPTION_DEBUG


1173 
i
;

1175 
i
 = 0; i < 
nbyãs
; i++)

1177 
buf
[
i
])

1179 
IAC
:

1180 
	`vty_out
 (
vty
, "IAC ");

1182 
WILL
:

1183 
	`vty_out
 (
vty
, "WILL ");

1185 
WONT
:

1186 
	`vty_out
 (
vty
, "WONT ");

1188 
DO
:

1189 
	`vty_out
 (
vty
, "DO ");

1191 
DONT
:

1192 
	`vty_out
 (
vty
, "DONT ");

1194 
SB
:

1195 
	`vty_out
 (
vty
, "SB ");

1197 
SE
:

1198 
	`vty_out
 (
vty
, "SE ");

1200 
TELOPT_ECHO
:

1201 
	`vty_out
 (
vty
, "TELOPT_ECHO %s", 
VTY_NEWLINE
);

1203 
TELOPT_SGA
:

1204 
	`vty_out
 (
vty
, "TELOPT_SGA %s", 
VTY_NEWLINE
);

1206 
TELOPT_NAWS
:

1207 
	`vty_out
 (
vty
, "TELOPT_NAWS %s", 
VTY_NEWLINE
);

1210 
	`vty_out
 (
vty
, "%x ", 
buf
[
i
]);

1214 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1218 
buf
[0])

1220 
SB
:

1221 
vty
->
sb_Àn
 = 0;

1222 
vty
->
üc_sb_ö_¥ogªss
 = 1;

1225 
SE
:

1227 i‡(!
vty
->
üc_sb_ö_¥ogªss
)

1230 i‡((
vty
->
sb_Àn
 =0Ë|| (vty->
sb_buf
[0] == '\0'))

1232 
vty
->
üc_sb_ö_¥ogªss
 = 0;

1235 
vty
->
sb_buf
[0])

1237 
TELOPT_NAWS
:

1238 i‡(
vty
->
sb_Àn
 !
TELNET_NAWS_SB_LEN
)

1239 
	`zlog_w¨n
("RFC 1073 violation detected:Åelnet NAWS option "

1241 
TELNET_NAWS_SB_LEN
, (
u_l⁄g
)
vty
->
sb_Àn
);

1242 i‡((
vty
->
sb_buf
Ë< 
TELNET_NAWS_SB_LEN
)

1243 
	`zlog_îr
("Bug detected: sizeof(vty->sb_buf) %lu < %d, "

1245 (
u_l⁄g
)(
vty
->
sb_buf
), 
TELNET_NAWS_SB_LEN
);

1248 
vty
->
width
 = ((vty->
sb_buf
[1] << 8)|vty->sb_buf[2]);

1249 
vty
->
height
 = ((vty->
sb_buf
[3] << 8)|vty->sb_buf[4]);

1250 #ifde‡
TELNET_OPTION_DEBUG


1251 
	`vty_out
(
vty
, "TELNET NAWS window sizeÇegotiation completed: "

1253 
vty
->
width
, vty->
height
, 
VTY_NEWLINE
);

1258 
vty
->
üc_sb_ö_¥ogªss
 = 0;

1266 
	}
}

1270 
	$vty_execuã
 (
vty
 *vty)

1272 
ªt
;

1274 
ªt
 = 
CMD_SUCCESS
;

1276 
vty
->
node
)

1278 
AUTH_NODE
:

1279 
AUTH_ENABLE_NODE
:

1280 
	`vty_auth
 (
vty
, vty->
buf
);

1283 
ªt
 = 
	`vty_comm™d
 (
vty
, vty->
buf
);

1284 i‡(
vty
->
ty≥
 =
VTY_TERM
)

1285 
	`vty_hi°_add
 (
vty
);

1290 
vty
->
˝
 = vty->
Àngth
 = 0;

1291 
	`vty_˛ór_buf
 (
vty
);

1293 i‡(
vty
->
°©us
 !
VTY_CLOSE
 )

1294 
	`vty_¥om±
 (
vty
);

1296  
ªt
;

1297 
	}
}

1299 
	#CONTROL
(
X
Ë((XË- '@')

	)

1300 
	#VTY_NORMAL
 0

	)

1301 
	#VTY_PRE_ESCAPE
 1

	)

1302 
	#VTY_ESCAPE
 2

	)

1306 
	$vty_esˇ≥_m≠
 (
c
, 
vty
 *vty)

1308 
c
)

1311 
	`vty_¥evious_löe
 (
vty
);

1314 
	`vty_√xt_löe
 (
vty
);

1317 
	`vty_f‹w¨d_ch¨
 (
vty
);

1320 
	`vty_backw¨d_ch¨
 (
vty
);

1327 
vty
->
esˇ≥
 = 
VTY_NORMAL
;

1328 
	}
}

1332 
	$vty_buf„r_ª£t
 (
vty
 *vty)

1334 
	`buf„r_ª£t
 (
vty
->
obuf
);

1335 
	`vty_¥om±
 (
vty
);

1336 
	`vty_ªdøw_löe
 (
vty
);

1337 
	}
}

1341 
	$vty_ªad
 (
thªad
 *thread)

1343 
i
;

1344 
nbyãs
;

1345 
buf
[
VTY_READ_BUFSIZ
];

1347 
vty_sock
 = 
	`THREAD_FD
 (
thªad
);

1348 
vty
 *vty = 
	`THREAD_ARG
 (
thªad
);

1349 
vty
->
t_ªad
 = 
NULL
;

1352 i‡((
nbyãs
 = 
	`ªad
 (
vty
->
fd
, 
buf
, 
VTY_READ_BUFSIZ
)) <= 0)

1354 i‡(
nbyãs
 < 0)

1356 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

1358 
	`vty_evít
 (
VTY_READ
, 
vty_sock
, 
vty
);

1361 
vty
->
m⁄ô‹
 = 0;

1362 
	`zlog_w¨n
("%s:ÑeadÉrror on vty client fd %d, closing: %s",

1363 
__func__
, 
vty
->
fd
, 
	`ß„_°ªº‹
(
î∫o
));

1365 
	`buf„r_ª£t
(
vty
->
obuf
);

1366 
vty
->
°©us
 = 
VTY_CLOSE
;

1369 
i
 = 0; i < 
nbyãs
; i++)

1371 i‡(
buf
[
i
] =
IAC
)

1373 i‡(!
vty
->
üc
)

1375 
vty
->
üc
 = 1;

1380 
vty
->
üc
 = 0;

1384 i‡(
vty
->
üc_sb_ö_¥ogªss
 && !vty->
üc
)

1386 i‡(
vty
->
sb_Àn
 < (vty->
sb_buf
))

1387 
vty
->
sb_buf
[vty->
sb_Àn
] = 
buf
[
i
];

1388 
vty
->
sb_Àn
++;

1392 i‡(
vty
->
üc
)

1395 
ªt
 = 0;

1396 
ªt
 = 
	`vty_ã ë_›ti⁄
 (
vty
, 
buf
 + 
i
, 
nbyãs
 - i);

1397 
vty
->
üc
 = 0;

1398 
i
 +
ªt
;

1403 i‡(
vty
->
°©us
 =
VTY_MORE
)

1405 
buf
[
i
])

1407 
	`CONTROL
('C'):

1410 
	`vty_buf„r_ª£t
 (
vty
);

1415 
vty
->
°©us
 = 
VTY_MORELINE
;

1425 i‡(
vty
->
esˇ≥
 =
VTY_ESCAPE
)

1427 
	`vty_esˇ≥_m≠
 (
buf
[
i
], 
vty
);

1432 i‡(
vty
->
esˇ≥
 =
VTY_PRE_ESCAPE
)

1434 
buf
[
i
])

1437 
vty
->
esˇ≥
 = 
VTY_ESCAPE
;

1440 
	`vty_backw¨d_w‹d
 (
vty
);

1441 
vty
->
esˇ≥
 = 
VTY_NORMAL
;

1444 
	`vty_f‹w¨d_w‹d
 (
vty
);

1445 
vty
->
esˇ≥
 = 
VTY_NORMAL
;

1448 
	`vty_f‹w¨d_kûl_w‹d
 (
vty
);

1449 
vty
->
esˇ≥
 = 
VTY_NORMAL
;

1451 
	`CONTROL
('H'):

1453 
	`vty_backw¨d_kûl_w‹d
 (
vty
);

1454 
vty
->
esˇ≥
 = 
VTY_NORMAL
;

1457 
vty
->
esˇ≥
 = 
VTY_NORMAL
;

1463 
buf
[
i
])

1465 
	`CONTROL
('A'):

1466 
	`vty_begönög_of_löe
 (
vty
);

1468 
	`CONTROL
('B'):

1469 
	`vty_backw¨d_ch¨
 (
vty
);

1471 
	`CONTROL
('C'):

1472 
	`vty_°›_öput
 (
vty
);

1474 
	`CONTROL
('D'):

1475 
	`vty_dñëe_ch¨
 (
vty
);

1477 
	`CONTROL
('E'):

1478 
	`vty_íd_of_löe
 (
vty
);

1480 
	`CONTROL
('F'):

1481 
	`vty_f‹w¨d_ch¨
 (
vty
);

1483 
	`CONTROL
('H'):

1485 
	`vty_dñëe_backw¨d_ch¨
 (
vty
);

1487 
	`CONTROL
('K'):

1488 
	`vty_kûl_löe
 (
vty
);

1490 
	`CONTROL
('N'):

1491 
	`vty_√xt_löe
 (
vty
);

1493 
	`CONTROL
('P'):

1494 
	`vty_¥evious_löe
 (
vty
);

1496 
	`CONTROL
('T'):

1497 
	`vty_å™•o£_ch¨s
 (
vty
);

1499 
	`CONTROL
('U'):

1500 
	`vty_kûl_löe_‰om_begönög
 (
vty
);

1502 
	`CONTROL
('W'):

1503 
	`vty_backw¨d_kûl_w‹d
 (
vty
);

1505 
	`CONTROL
('Z'):

1506 
	`vty_íd_c⁄fig
 (
vty
);

1510 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1511 
	`vty_execuã
 (
vty
);

1514 
	`vty_com∂ëe_comm™d
 (
vty
);

1517 i‡(
vty
->
node
 =
AUTH_NODE
 || vty->nodê=
AUTH_ENABLE_NODE
)

1518 
	`vty_£lf_ö£π
 (
vty
, 
buf
[
i
]);

1520 
	`vty_des¸ibe_comm™d
 (
vty
);

1523 i‡(
i
 + 1 < 
nbyãs
 && 
buf
[i + 1] == '[')

1525 
vty
->
esˇ≥
 = 
VTY_ESCAPE
;

1526 
i
++;

1529 
vty
->
esˇ≥
 = 
VTY_PRE_ESCAPE
;

1532 i‡(
buf
[
i
] > 31 && buf[i] < 127)

1533 
	`vty_£lf_ö£π
 (
vty
, 
buf
[
i
]);

1539 i‡(
vty
->
°©us
 =
VTY_CLOSE
)

1540 
	`vty_˛o£
 (
vty
);

1543 
	`vty_evít
 (
VTY_WRITE
, 
vty_sock
, 
vty
);

1544 
	`vty_evít
 (
VTY_READ
, 
vty_sock
, 
vty
);

1547 
	}
}

1551 
	$vty_Êush
 (
thªad
 *thread)

1553 
îa£
;

1554 
buf„r_°©us_t
 
Êushrc
;

1555 
vty_sock
 = 
	`THREAD_FD
 (
thªad
);

1556 
vty
 *vty = 
	`THREAD_ARG
 (
thªad
);

1558 
vty
->
t_wrôe
 = 
NULL
;

1561 i‡((
vty
->
löes
 =0Ë&& vty->
t_ªad
)

1563 
	`thªad_ˇn˚l
 (
vty
->
t_ªad
);

1564 
vty
->
t_ªad
 = 
NULL
;

1568 
îa£
 = ((
vty
->
°©us
 =
VTY_MORE
 || vty->°©u†=
VTY_MORELINE
));

1571 i‡((
vty
->
löes
 =0Ë|| (vty->
width
 == 0))

1572 
Êushrc
 = 
	`buf„r_Êush_avaûabÀ
(
vty
->
obuf
, vty->
fd
);

1573 i‡(
vty
->
°©us
 =
VTY_MORELINE
)

1574 
Êushrc
 = 
	`buf„r_Êush_wödow
(
vty
->
obuf
, vty->
fd
, vty->
width
,

1575 1, 
îa£
, 0);

1577 
Êushrc
 = 
	`buf„r_Êush_wödow
(
vty
->
obuf
, vty->
fd
, vty->
width
,

1578 
vty
->
löes
 >= 0 ? vty->lines :

1579 
vty
->
height
,

1580 
îa£
, 0);

1581 
Êushrc
)

1583 
BUFFER_ERROR
:

1584 
vty
->
m⁄ô‹
 = 0;

1585 
	`zlog_w¨n
("buffer_flush failed on vty client fd %d, closing",

1586 
vty
->
fd
);

1587 
	`buf„r_ª£t
(
vty
->
obuf
);

1588 
	`vty_˛o£
(
vty
);

1590 
BUFFER_EMPTY
:

1591 i‡(
vty
->
°©us
 =
VTY_CLOSE
)

1592 
	`vty_˛o£
 (
vty
);

1595 
vty
->
°©us
 = 
VTY_NORMAL
;

1596 i‡(
vty
->
löes
 == 0)

1597 
	`vty_evít
 (
VTY_READ
, 
vty_sock
, 
vty
);

1600 
BUFFER_PENDING
:

1602 
vty
->
°©us
 = 
VTY_MORE
;

1603 i‡(
vty
->
löes
 == 0)

1604 
	`vty_evít
 (
VTY_WRITE
, 
vty_sock
, 
vty
);

1609 
	}
}

1612 
vty
 *

1613 
	$vty_¸óã
 (
vty_sock
, 
sockuni⁄
 *
su
)

1615 
buf
[
SU_ADDRSTRLEN
];

1616 
vty
 *vty;

1618 
	`sockuni⁄2°r
(
su
, 
buf
, 
SU_ADDRSTRLEN
);

1621 
vty
 = 
	`vty_√w
 ();

1622 
vty
->
fd
 = 
vty_sock
;

1623 
vty
->
ty≥
 = 
VTY_TERM
;

1624 
	`°r˝y
 (
vty
->
addªss
, 
buf
);

1625 i‡(
no_∑ssw‹d_check
)

1627 i‡(
ª°ri˘ed_mode
)

1628 
vty
->
node
 = 
RESTRICTED_NODE
;

1629 i‡(
ho°
.
adv™˚d
)

1630 
vty
->
node
 = 
ENABLE_NODE
;

1632 
vty
->
node
 = 
VIEW_NODE
;

1635 
vty
->
node
 = 
AUTH_NODE
;

1636 
vty
->
Áû
 = 0;

1637 
vty
->
˝
 = 0;

1638 
	`vty_˛ór_buf
 (
vty
);

1639 
vty
->
Àngth
 = 0;

1640 
	`mem£t
 (
vty
->
hi°
, 0,  (vty->hist));

1641 
vty
->
hp
 = 0;

1642 
vty
->
hödex
 = 0;

1643 
	`ve˘‹_£t_ödex
 (
vtyvec
, 
vty_sock
, 
vty
);

1644 
vty
->
°©us
 = 
VTY_NORMAL
;

1645 
vty
->
v_timeout
 = 
vty_timeout_vÆ
;

1646 i‡(
ho°
.
löes
 >= 0)

1647 
vty
->
löes
 = 
ho°
.lines;

1649 
vty
->
löes
 = -1;

1650 
vty
->
üc
 = 0;

1651 
vty
->
üc_sb_ö_¥ogªss
 = 0;

1652 
vty
->
sb_Àn
 = 0;

1654 i‡(! 
no_∑ssw‹d_check
)

1657 i‡(
ho°
.
∑ssw‹d
 =
NULL
 && ho°.
∑ssw‹d_í¸y±
 == NULL)

1659 
	`vty_out
 (
vty
, "VtyÖassw‹d i†nŸ së.%s", 
VTY_NEWLINE
);

1660 
vty
->
°©us
 = 
VTY_CLOSE
;

1661 
	`vty_˛o£
 (
vty
);

1662  
NULL
;

1667 
	`vty_hñlo
 (
vty
);

1668 i‡(! 
no_∑ssw‹d_check
)

1669 
	`vty_out
 (
vty
, "%sU£∏Ac˚s†Vîifiˇti⁄%s%s", 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE);

1672 
	`vty_wûl_echo
 (
vty
);

1673 
	`vty_wûl_suµªss_go_ahód
 (
vty
);

1675 
	`vty_d⁄t_löemode
 (
vty
);

1676 
	`vty_do_wödow_size
 (
vty
);

1679 
	`vty_¥om±
 (
vty
);

1682 
	`vty_evít
 (
VTY_WRITE
, 
vty_sock
, 
vty
);

1683 
	`vty_evít
 (
VTY_READ
, 
vty_sock
, 
vty
);

1685  
vty
;

1686 
	}
}

1690 
	$vty_ac˚±
 (
thªad
 *thread)

1692 
vty_sock
;

1693 
sockuni⁄
 
su
;

1694 
ªt
;

1695 
⁄
;

1696 
ac˚±_sock
;

1697 
¥efix
 *
p
 = 
NULL
;

1698 
ac˚ss_li°
 *
a˛
 = 
NULL
;

1699 
buf
[
SU_ADDRSTRLEN
];

1701 
ac˚±_sock
 = 
	`THREAD_FD
 (
thªad
);

1704 
	`vty_evít
 (
VTY_SERV
, 
ac˚±_sock
, 
NULL
);

1706 
	`mem£t
 (&
su
, 0,  (
sockuni⁄
));

1709 
vty_sock
 = 
	`sockuni⁄_ac˚±
 (
ac˚±_sock
, &
su
);

1710 i‡(
vty_sock
 < 0)

1712 
	`zlog_w¨n
 ("ˇn'àac˚± vty sockë : %s", 
	`ß„_°ªº‹
 (
î∫o
));

1715 
	`£t_n⁄blockög
(
vty_sock
);

1717 
p
 = 
	`sockuni⁄2ho°¥efix
 (&
su
);

1720 i‡(
p
->
Ámûy
 =
AF_INET
 && 
vty_ac˚s¶i°_«me
)

1722 i‡((
a˛
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP
, 
vty_ac˚s¶i°_«me
)) &&

1723 (
	`ac˚ss_li°_≠∂y
 (
a˛
, 
p
Ë=
FILTER_DENY
))

1725 
	`zlog
 (
NULL
, 
LOG_INFO
, "Vty connectionÑefused from %s",

1726 
	`sockuni⁄2°r
 (&
su
, 
buf
, 
SU_ADDRSTRLEN
));

1727 
	`˛o£
 (
vty_sock
);

1730 
	`vty_evít
 (
VTY_SERV
, 
ac˚±_sock
, 
NULL
);

1732 
	`¥efix_‰ì
 (
p
);

1738 #ifde‡
HAVE_IPV6


1740 i‡(
p
->
Ámûy
 =
AF_INET6
 && 
vty_ùv6_ac˚s¶i°_«me
)

1742 i‡((
a˛
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP6
, 
vty_ùv6_ac˚s¶i°_«me
)) &&

1743 (
	`ac˚ss_li°_≠∂y
 (
a˛
, 
p
Ë=
FILTER_DENY
))

1745 
	`zlog
 (
NULL
, 
LOG_INFO
, "Vty connectionÑefused from %s",

1746 
	`sockuni⁄2°r
 (&
su
, 
buf
, 
SU_ADDRSTRLEN
));

1747 
	`˛o£
 (
vty_sock
);

1750 
	`vty_evít
 (
VTY_SERV
, 
ac˚±_sock
, 
NULL
);

1752 
	`¥efix_‰ì
 (
p
);

1759 
	`¥efix_‰ì
 (
p
);

1761 
⁄
 = 1;

1762 
ªt
 = 
	`£tsock›t
 (
vty_sock
, 
IPPROTO_TCP
, 
TCP_NODELAY
,

1763 (*Ë&
⁄
,  (on));

1764 i‡(
ªt
 < 0)

1765 
	`zlog
 (
NULL
, 
LOG_INFO
, "can't set sockoptÅo vty_sock : %s",

1766 
	`ß„_°ªº‹
 (
î∫o
));

1768 
	`zlog
 (
NULL
, 
LOG_INFO
, "Vty connection from %s",

1769 
	`sockuni⁄2°r
 (&
su
, 
buf
, 
SU_ADDRSTRLEN
));

1771 
	`vty_¸óã
 (
vty_sock
, &
su
);

1774 
	}
}

1776 #i‡
deföed
(
HAVE_IPV6
Ë&& !deföed(
NRL
)

1778 
	$vty_£rv_sock_addröfo
 (c⁄° *
ho°«me
, 
p‹t
)

1780 
ªt
;

1781 
addröfo
 
ªq
;

1782 
addröfo
 *
aöfo
;

1783 
addröfo
 *
aöfo_ßve
;

1784 
sock
;

1785 
p‹t_°r
[
BUFSIZ
];

1787 
	`mem£t
 (&
ªq
, 0,  (
addröfo
));

1788 
ªq
.
ai_Êags
 = 
AI_PASSIVE
;

1789 
ªq
.
ai_Ámûy
 = 
AF_UNSPEC
;

1790 
ªq
.
ai_sockty≥
 = 
SOCK_STREAM
;

1791 
	`•rötf
 (
p‹t_°r
, "%d", 
p‹t
);

1792 
p‹t_°r
[ (port_str) - 1] = '\0';

1794 
ªt
 = 
	`gëaddröfo
 (
ho°«me
, 
p‹t_°r
, &
ªq
, &
aöfo
);

1796 i‡(
ªt
 != 0)

1798 
	`Ârötf
 (
°dîr
, "gëaddröfÿÁûed: %s\n", 
	`gai_°ªº‹
 (
ªt
));

1799 
	`exô
 (1);

1802 
aöfo_ßve
 = 
aöfo
;

1806 i‡(
aöfo
->
ai_Ámûy
 !
AF_INET


1807 #ifde‡
HAVE_IPV6


1808 && 
aöfo
->
ai_Ámûy
 !
AF_INET6


1813 
sock
 = 
	`sockë
 (
aöfo
->
ai_Ámûy
,áöfo->
ai_sockty≥
,áöfo->
ai_¥Ÿocﬁ
);

1814 i‡(
sock
 < 0)

1817 
	`sock›t_v6⁄ly
 (
aöfo
->
ai_Ámûy
, 
sock
);

1818 
	`sock›t_ªu£addr
 (
sock
);

1819 
	`sock›t_ªu£p‹t
 (
sock
);

1821 
ªt
 = 
	`böd
 (
sock
, 
aöfo
->
ai_addr
,áöfo->
ai_addæí
);

1822 i‡(
ªt
 < 0)

1824 
	`˛o£
 (
sock
);

1828 
ªt
 = 
	`li°í
 (
sock
, 3);

1829 i‡(
ªt
 < 0)

1831 
	`˛o£
 (
sock
);

1835 
	`vty_evít
 (
VTY_SERV
, 
sock
, 
NULL
);

1837 (
aöfo
 =áöfo->
ai_√xt
Ë!
NULL
);

1839 
	`‰ìaddröfo
 (
aöfo_ßve
);

1840 
	}
}

1845 
	$vty_£rv_sock_Ámûy
 (c⁄° * 
addr
, 
p‹t
, 
Ámûy
)

1847 
ªt
;

1848 
sockuni⁄
 
su
;

1849 
ac˚±_sock
;

1850 * 
«ddr
=
NULL
;

1852 
	`mem£t
 (&
su
, 0,  (
sockuni⁄
));

1853 
su
.
ß
.
ß_Ámûy
 = 
Ámûy
;

1854 if(
addr
)

1855 
Ámûy
)

1857 
AF_INET
:

1858 
«ddr
=&
su
.
sö
.
sö_addr
;

1859 #ifde‡
HAVE_IPV6


1860 
AF_INET6
:

1861 
«ddr
=&
su
.
sö6
.
sö6_addr
;

1865 if(
«ddr
)

1866 
	`öë_±⁄
(
Ámûy
,
addr
,
«ddr
))

1869 
	`zlog_îr
("badáddªs†%s",
addr
);

1870 
«ddr
=
NULL
;

1873 
	`zlog_îr
("îr‹Åøn¶©ögáddªs†%s: %s",
addr
,
	`ß„_°ªº‹
(
î∫o
));

1874 
«ddr
=
NULL
;

1878 
ac˚±_sock
 = 
	`sockuni⁄_°ªam_sockë
 (&
su
);

1879 i‡(
ac˚±_sock
 < 0)

1883 
	`sock›t_ªu£addr
 (
ac˚±_sock
);

1884 
	`sock›t_ªu£p‹t
 (
ac˚±_sock
);

1887 
ªt
 = 
	`sockuni⁄_böd
 (
ac˚±_sock
, &
su
, 
p‹t
, 
«ddr
);

1888 i‡(
ªt
 < 0)

1890 
	`zlog_w¨n
("can't bind socket");

1891 
	`˛o£
 (
ac˚±_sock
);

1896 
ªt
 = 
	`li°í
 (
ac˚±_sock
, 3);

1897 i‡(
ªt
 < 0)

1899 
	`zlog
 (
NULL
, 
LOG_WARNING
, "can'tÜisten socket");

1900 
	`˛o£
 (
ac˚±_sock
);

1905 
	`vty_evít
 (
VTY_SERV
, 
ac˚±_sock
, 
NULL
);

1906 
	}
}

1909 #ifde‡
VTYSH


1911 
	~<sys/un.h
>

1915 
	$vty_£rv_un
 (c⁄° *
∑th
)

1917 
ªt
;

1918 
sock
, 
Àn
;

1919 
sockaddr_un
 
£rv
;

1920 
mode_t
 
ﬁd_mask
;

1921 
z¥ivs_ids_t
 
ids
;

1924 
	`u∆ök
 (
∑th
);

1927 
ﬁd_mask
 = 
	`umask
 (0007);

1930 
sock
 = 
	`sockë
 (
AF_UNIX
, 
SOCK_STREAM
, 0);

1931 i‡(
sock
 < 0)

1933 
	`zlog_îr
("C™nŸ cª©êunix såóm sockë: %s", 
	`ß„_°ªº‹
(
î∫o
));

1938 
	`mem£t
 (&
£rv
, 0,  (
sockaddr_un
));

1939 
£rv
.
sun_Ámûy
 = 
AF_UNIX
;

1940 
	`°∫˝y
 (
£rv
.
sun_∑th
, 
∑th
, 
	`°æí
 (path));

1941 #ifde‡
HAVE_STRUCT_SOCKADDR_UN_SUN_LEN


1942 
Àn
 = 
£rv
.
sun_Àn
 = 
	`SUN_LEN
(&serv);

1944 
Àn
 =  (
£rv
.
sun_Ámûy
Ë+ 
	`°æí
 (£rv.
sun_∑th
);

1947 
ªt
 = 
	`böd
 (
sock
, (
sockaddr
 *Ë&
£rv
, 
Àn
);

1948 i‡(
ªt
 < 0)

1950 
	`zlog_îr
("C™nŸ bödÖ©h %s: %s", 
∑th
, 
	`ß„_°ªº‹
(
î∫o
));

1951 
	`˛o£
 (
sock
);

1955 
ªt
 = 
	`li°í
 (
sock
, 5);

1956 i‡(
ªt
 < 0)

1958 
	`zlog_îr
("li°í(fd %dËÁûed: %s", 
sock
, 
	`ß„_°ªº‹
(
î∫o
));

1959 
	`˛o£
 (
sock
);

1963 
	`umask
 (
ﬁd_mask
);

1965 
	`z¥ivs_gë_ids
(&
ids
);

1967 i‡(
ids
.
gid_vty
 > 0)

1970 i‡–
	`chown
 (
∑th
, -1, 
ids
.
gid_vty
) )

1972 
	`zlog_îr
 ("vty_serv_un: could chown socket, %s",

1973 
	`ß„_°ªº‹
 (
î∫o
) );

1977 
	`vty_evít
 (
VTYSH_SERV
, 
sock
, 
NULL
);

1978 
	}
}

1983 
	$vtysh_ac˚±
 (
thªad
 *thread)

1985 
ac˚±_sock
;

1986 
sock
;

1987 
˛õ¡_Àn
;

1988 
sockaddr_un
 
˛õ¡
;

1989 
vty
 *vty;

1991 
ac˚±_sock
 = 
	`THREAD_FD
 (
thªad
);

1993 
	`vty_evít
 (
VTYSH_SERV
, 
ac˚±_sock
, 
NULL
);

1995 
	`mem£t
 (&
˛õ¡
, 0,  (
sockaddr_un
));

1996 
˛õ¡_Àn
 =  (
sockaddr_un
);

1998 
sock
 = 
	`ac˚±
 (
ac˚±_sock
, (
sockaddr
 *Ë&
˛õ¡
,

1999 (
sockÀn_t
 *Ë&
˛õ¡_Àn
);

2001 i‡(
sock
 < 0)

2003 
	`zlog_w¨n
 ("ˇn'àac˚± vty sockë : %s", 
	`ß„_°ªº‹
 (
î∫o
));

2007 i‡(
	`£t_n⁄blockög
(
sock
) < 0)

2009 
	`zlog_w¨n
 ("vtysh_accept: couldÇot set vty socket %dÅoÇon-blocking,"

2010 " %s, closög", 
sock
, 
	`ß„_°ªº‹
 (
î∫o
));

2011 
	`˛o£
 (
sock
);

2015 #ifde‡
VTYSH_DEBUG


2016 
	`¥ötf
 ("VTY shelláccept\n");

2019 
vty
 = 
	`vty_√w
 ();

2020 
vty
->
fd
 = 
sock
;

2021 
vty
->
ty≥
 = 
VTY_SHELL_SERV
;

2022 
vty
->
node
 = 
VIEW_NODE
;

2024 
	`vty_evít
 (
VTYSH_READ
, 
sock
, 
vty
);

2027 
	}
}

2030 
	$vtysh_Êush
(
vty
 *vty)

2032 
	`buf„r_Êush_avaûabÀ
(
vty
->
obuf
, vty->
fd
))

2034 
BUFFER_PENDING
:

2035 
	`vty_evít
(
VTYSH_WRITE
, 
vty
->
fd
, vty);

2037 
BUFFER_ERROR
:

2038 
vty
->
m⁄ô‹
 = 0;

2039 
	`zlog_w¨n
("%s: wrôêîr‹Åÿfd %d, closög", 
__func__
, 
vty
->
fd
);

2040 
	`buf„r_ª£t
(
vty
->
obuf
);

2041 
	`vty_˛o£
(
vty
);

2044 
BUFFER_EMPTY
:

2048 
	}
}

2051 
	$vtysh_ªad
 (
thªad
 *thread)

2053 
ªt
;

2054 
sock
;

2055 
nbyãs
;

2056 
vty
 *vty;

2057 
buf
[
VTY_READ_BUFSIZ
];

2058 *
p
;

2059 
u_ch¨
 
hódî
[4] = {0, 0, 0, 0};

2061 
sock
 = 
	`THREAD_FD
 (
thªad
);

2062 
vty
 = 
	`THREAD_ARG
 (
thªad
);

2063 
vty
->
t_ªad
 = 
NULL
;

2065 i‡((
nbyãs
 = 
	`ªad
 (
sock
, 
buf
, 
VTY_READ_BUFSIZ
)) <= 0)

2067 i‡(
nbyãs
 < 0)

2069 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

2071 
	`vty_evít
 (
VTYSH_READ
, 
sock
, 
vty
);

2074 
vty
->
m⁄ô‹
 = 0;

2075 
	`zlog_w¨n
("%s:Ñead failed on vtysh client fd %d, closing: %s",

2076 
__func__
, 
sock
, 
	`ß„_°ªº‹
(
î∫o
));

2078 
	`buf„r_ª£t
(
vty
->
obuf
);

2079 
	`vty_˛o£
 (
vty
);

2080 #ifde‡
VTYSH_DEBUG


2081 
	`¥ötf
 ("close vtysh\n");

2086 #ifde‡
VTYSH_DEBUG


2087 
	`¥ötf
 ("löe: %.*s\n", 
nbyãs
, 
buf
);

2090 
p
 = 
buf
;Ö < buf+
nbyãs
;Ö++)

2092 
	`vty_ísuª
(
vty
, vty->
Àngth
+1);

2093 
vty
->
buf
[vty->
Àngth
++] = *
p
;

2094 i‡(*
p
 == '\0')

2097 
ªt
 = 
	`vty_execuã
 (
vty
);

2102 #ifde‡
VTYSH_DEBUG


2103 
	`¥ötf
 ("ªsu…: %d\n", 
ªt
);

2104 
	`¥ötf
 ("vtyshÇode: %d\n", 
vty
->
node
);

2107 
hódî
[3] = 
ªt
;

2108 
	`buf„r_put
(
vty
->
obuf
, 
hódî
, 4);

2110 i‡(!
vty
->
t_wrôe
 && (
	`vtysh_Êush
(vty) < 0))

2116 
	`vty_evít
 (
VTYSH_READ
, 
sock
, 
vty
);

2119 
	}
}

2122 
	$vtysh_wrôe
 (
thªad
 *thread)

2124 
vty
 *vty = 
	`THREAD_ARG
 (
thªad
);

2126 
vty
->
t_wrôe
 = 
NULL
;

2127 
	`vtysh_Êush
(
vty
);

2129 
	}
}

2135 
	$vty_£rv_sock
 (c⁄° *
addr
, 
p‹t
, c⁄° *
∑th
)

2138 i‡(
p‹t
)

2141 #ifde‡
HAVE_IPV6


2142 #ifde‡
NRL


2143 
	`vty_£rv_sock_Ámûy
 (
addr
, 
p‹t
, 
AF_INET
);

2144 
	`vty_£rv_sock_Ámûy
 (
addr
, 
p‹t
, 
AF_INET6
);

2146 
	`vty_£rv_sock_addröfo
 (
addr
, 
p‹t
);

2149 
	`vty_£rv_sock_Ámûy
 (
addr
,
p‹t
, 
AF_INET
);

2153 #ifde‡
VTYSH


2154 
	`vty_£rv_un
 (
∑th
);

2156 
	}
}

2163 
	$vty_˛o£
 (
vty
 *vty)

2165 
i
;

2168 i‡(
vty
->
t_ªad
)

2169 
	`thªad_ˇn˚l
 (
vty
->
t_ªad
);

2170 i‡(
vty
->
t_wrôe
)

2171 
	`thªad_ˇn˚l
 (
vty
->
t_wrôe
);

2172 i‡(
vty
->
t_timeout
)

2173 
	`thªad_ˇn˚l
 (
vty
->
t_timeout
);

2176 
	`buf„r_Êush_Æl
 (
vty
->
obuf
, vty->
fd
);

2179 
	`buf„r_‰ì
 (
vty
->
obuf
);

2182 
i
 = 0; i < 
VTY_MAXHIST
; i++)

2183 i‡(
vty
->
hi°
[
i
])

2184 
	`XFREE
 (
MTYPE_VTY_HIST
, 
vty
->
hi°
[
i
]);

2187 
	`ve˘‹_un£t
 (
vtyvec
, 
vty
->
fd
);

2190 i‡(
vty
->
fd
 > 0)

2191 
	`˛o£
 (
vty
->
fd
);

2193 i‡(
vty
->
buf
)

2194 
	`XFREE
 (
MTYPE_VTY
, 
vty
->
buf
);

2197 
	`vty_c⁄fig_u∆ock
 (
vty
);

2200 
	`XFREE
 (
MTYPE_VTY
, 
vty
);

2201 
	}
}

2205 
	$vty_timeout
 (
thªad
 *thread)

2207 
vty
 *vty;

2209 
vty
 = 
	`THREAD_ARG
 (
thªad
);

2210 
vty
->
t_timeout
 = 
NULL
;

2211 
vty
->
v_timeout
 = 0;

2214 
	`buf„r_ª£t
 (
vty
->
obuf
);

2215 
	`vty_out
 (
vty
, "%sVty c⁄√˘i⁄ i†timed out.%s", 
VTY_NEWLINE
, VTY_NEWLINE);

2218 
vty
->
°©us
 = 
VTY_CLOSE
;

2219 
	`vty_˛o£
 (
vty
);

2222 
	}
}

2226 
	$vty_ªad_fûe
 (
FILE
 *
c⁄Â
)

2228 
ªt
;

2229 
vty
 *vty;

2231 
vty
 = 
	`vty_√w
 ();

2232 
vty
->
fd
 = 0;

2233 
vty
->
ty≥
 = 
VTY_TERM
;

2234 
vty
->
node
 = 
CONFIG_NODE
;

2237 
ªt
 = 
	`c⁄fig_‰om_fûe
 (
vty
, 
c⁄Â
);

2239 i‡–!((
ªt
 =
CMD_SUCCESS
Ë|| (ªà=
CMD_ERR_NOTHING_TODO
)) )

2241 
ªt
)

2243 
CMD_ERR_AMBIGUOUS
:

2244 
	`Ârötf
 (
°dîr
, "Ambiguous command.\n");

2246 
CMD_ERR_NO_MATCH
:

2247 
	`Ârötf
 (
°dîr
, "There isÇo such command.\n");

2250 
	`Ârötf
 (
°dîr
, "Error occured duringÑeading belowÜine.\n%s\n",

2251 
vty
->
buf
);

2252 
	`vty_˛o£
 (
vty
);

2253 
	`exô
 (1);

2256 
	`vty_˛o£
 (
vty
);

2257 
	}
}

2259 
FILE
 *

2260 
	$vty_u£_backup_c⁄fig
 (*
fuŒ∑th
)

2262 *
fuŒ∑th_ßv
, *
fuŒ∑th_tmp
;

2263 
FILE
 *
ªt
 = 
NULL
;

2264 
°©
 
buf
;

2265 
tmp
, 
ßv
;

2266 
c
;

2267 
buf„r
[512];

2269 
fuŒ∑th_ßv
 = 
	`mÆloc
 (
	`°æí
 (
fuŒ∑th
Ë+ såÀ¿(
CONF_BACKUP_EXT
) + 1);

2270 
	`°r˝y
 (
fuŒ∑th_ßv
, 
fuŒ∑th
);

2271 
	`°rˇt
 (
fuŒ∑th_ßv
, 
CONF_BACKUP_EXT
);

2272 i‡(
	`°©
 (
fuŒ∑th_ßv
, &
buf
) == -1)

2274 
	`‰ì
 (
fuŒ∑th_ßv
);

2275  
NULL
;

2278 
fuŒ∑th_tmp
 = 
	`mÆloc
 (
	`°æí
 (
fuŒ∑th
) + 8);

2279 
	`•rötf
 (
fuŒ∑th_tmp
, "%s.XXXXXX", 
fuŒ∑th
);

2282 
tmp
 = 
	`mk°emp
 (
fuŒ∑th_tmp
);

2283 i‡(
tmp
 < 0)

2285 
	`‰ì
 (
fuŒ∑th_ßv
);

2286 
	`‰ì
 (
fuŒ∑th_tmp
);

2287  
NULL
;

2290 
ßv
 = 
	`›í
 (
fuŒ∑th_ßv
, 
O_RDONLY
);

2291 i‡(
ßv
 < 0)

2293 
	`u∆ök
 (
fuŒ∑th_tmp
);

2294 
	`‰ì
 (
fuŒ∑th_ßv
);

2295 
	`‰ì
 (
fuŒ∑th_tmp
);

2296  
NULL
;

2299 (
c
 = 
	`ªad
 (
ßv
, 
buf„r
, 512)) > 0)

2300 
	`wrôe
 (
tmp
, 
buf„r
, 
c
);

2302 
	`˛o£
 (
ßv
);

2303 
	`˛o£
 (
tmp
);

2305 i‡(
	`chmod
(
fuŒ∑th_tmp
, 
CONFIGFILE_MASK
) != 0)

2307 
	`u∆ök
 (
fuŒ∑th_tmp
);

2308 
	`‰ì
 (
fuŒ∑th_ßv
);

2309 
	`‰ì
 (
fuŒ∑th_tmp
);

2310  
NULL
;

2313 i‡(
	`lök
 (
fuŒ∑th_tmp
, 
fuŒ∑th
) == 0)

2314 
ªt
 = 
	`f›í
 (
fuŒ∑th
, "r");

2316 
	`u∆ök
 (
fuŒ∑th_tmp
);

2318 
	`‰ì
 (
fuŒ∑th_ßv
);

2319 
	`‰ì
 (
fuŒ∑th_tmp
);

2320  
ªt
;

2321 
	}
}

2325 
	$vty_ªad_c⁄fig
 (*
c⁄fig_fûe
,

2326 *
c⁄fig_deÁu…_dú
)

2328 
cwd
[
MAXPATHLEN
];

2329 
FILE
 *
c⁄Â
 = 
NULL
;

2330 *
fuŒ∑th
;

2331 *
tmp
 = 
NULL
;

2334 i‡(
c⁄fig_fûe
 !
NULL
)

2336 i‡(! 
	`IS_DIRECTORY_SEP
 (
c⁄fig_fûe
[0]))

2338 
	`gëcwd
 (
cwd
, 
MAXPATHLEN
);

2339 
tmp
 = 
	`XMALLOC
 (
MTYPE_TMP
,

2340 
	`°æí
 (
cwd
Ë+ såÀ¿(
c⁄fig_fûe
) + 2);

2341 
	`•rötf
 (
tmp
, "%s/%s", 
cwd
, 
c⁄fig_fûe
);

2342 
fuŒ∑th
 = 
tmp
;

2345 
fuŒ∑th
 = 
c⁄fig_fûe
;

2347 
c⁄Â
 = 
	`f›í
 (
fuŒ∑th
, "r");

2349 i‡(
c⁄Â
 =
NULL
)

2351 
	`Ârötf
 (
°dîr
, "%s: failedÅo open configuration file %s: %s\n",

2352 
__func__
, 
fuŒ∑th
, 
	`ß„_°ªº‹
 (
î∫o
));

2354 
c⁄Â
 = 
	`vty_u£_backup_c⁄fig
 (
fuŒ∑th
);

2355 i‡(
c⁄Â
)

2356 
	`Ârötf
 (
°dîr
, "WARNING: using backup configuration file!\n");

2359 
	`Ârötf
 (
°dîr
, "can't open configuration file [%s]\n",

2360 
c⁄fig_fûe
);

2361 
	`exô
(1);

2367 #ifde‡
VTYSH


2368 
ªt
;

2369 
°©
 
c⁄f_°©
;

2385 i‡–
	`°r°r
(
c⁄fig_deÁu…_dú
, "vtysh"Ë=
NULL
)

2387 
ªt
 = 
	`°©
 (
öãgøã_deÁu…
, &
c⁄f_°©
);

2388 i‡(
ªt
 >= 0)

2393 
c⁄Â
 = 
	`f›í
 (
c⁄fig_deÁu…_dú
, "r");

2394 i‡(
c⁄Â
 =
NULL
)

2396 
	`Ârötf
 (
°dîr
, "%s: failedÅo open configuration file %s: %s\n",

2397 
__func__
, 
c⁄fig_deÁu…_dú
, 
	`ß„_°ªº‹
 (
î∫o
));

2399 
c⁄Â
 = 
	`vty_u£_backup_c⁄fig
 (
c⁄fig_deÁu…_dú
);

2400 i‡(
c⁄Â
)

2402 
	`Ârötf
 (
°dîr
, "WARNING: using backup configuration file!\n");

2403 
fuŒ∑th
 = 
c⁄fig_deÁu…_dú
;

2407 
	`Ârötf
 (
°dîr
, "can't open configuration file [%s]\n",

2408 
c⁄fig_deÁu…_dú
);

2409 
	`exô
 (1);

2413 
fuŒ∑th
 = 
c⁄fig_deÁu…_dú
;

2416 
	`vty_ªad_fûe
 (
c⁄Â
);

2418 
	`f˛o£
 (
c⁄Â
);

2420 
	`ho°_c⁄fig_£t
 (
fuŒ∑th
);

2422 i‡(
tmp
)

2423 
	`XFREE
 (
MTYPE_TMP
, 
fuŒ∑th
);

2424 
	}
}

2428 
	$vty_log
 (c⁄° *
Àvñ
, c⁄° *
¥Ÿo_°r
,

2429 c⁄° *
f‹m©
, 
time°amp_c⁄åﬁ
 *
˘l
, 
va_li°
 
va
)

2431 
i
;

2432 
vty
 *vty;

2434 i‡(!
vtyvec
)

2437 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
vtyvec
); i++)

2438 i‡((
vty
 = 
	`ve˘‹_¶Ÿ
 (
vtyvec
, 
i
)Ë!
NULL
)

2439 i‡(
vty
->
m⁄ô‹
)

2441 
va_li°
 
ac
;

2442 
	`va_c›y
(
ac
, 
va
);

2443 
	`vty_log_out
 (
vty
, 
Àvñ
, 
¥Ÿo_°r
, 
f‹m©
, 
˘l
, 
ac
);

2444 
	`va_íd
(
ac
);

2446 
	}
}

2450 
	$vty_log_fixed
 (c⁄° *
buf
, 
size_t
 
Àn
)

2452 
i
;

2453 
iovec
 
iov
[2];

2456 i‡(!
vtyvec
)

2459 
iov
[0].
iov_ba£
 = (*)
buf
;

2460 
iov
[0].
iov_Àn
 = 
Àn
;

2461 
iov
[1].
iov_ba£
 = (*)"\r\n";

2462 
iov
[1].
iov_Àn
 = 2;

2464 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
vtyvec
); i++)

2466 
vty
 *vty;

2467 i‡(((
vty
 = 
	`ve˘‹_¶Ÿ
 (
vtyvec
, 
i
)Ë!
NULL
Ë&& vty->
m⁄ô‹
)

2470 
	`wrôev
(
vty
->
fd
, 
iov
, 2);

2472 
	}
}

2475 
	$vty_c⁄fig_lock
 (
vty
 *vty)

2477 i‡(
vty_c⁄fig
 == 0)

2479 
vty
->
c⁄fig
 = 1;

2480 
vty_c⁄fig
 = 1;

2482  
vty
->
c⁄fig
;

2483 
	}
}

2486 
	$vty_c⁄fig_u∆ock
 (
vty
 *vty)

2488 i‡(
vty_c⁄fig
 =1 && 
vty
->
c⁄fig
 == 1)

2490 
vty
->
c⁄fig
 = 0;

2491 
vty_c⁄fig
 = 0;

2493  
vty
->
c⁄fig
;

2494 
	}
}

2497 
thªad_ma°î
 *
	gma°î
;

2500 
	$vty_evít
 (
evít
Évít, 
sock
, 
vty
 *vty)

2502 
thªad
 *
vty_£rv_thªad
;

2504 
evít
)

2506 
VTY_SERV
:

2507 
vty_£rv_thªad
 = 
	`thªad_add_ªad
 (
ma°î
, 
vty_ac˚±
, 
vty
, 
sock
);

2508 
	`ve˘‹_£t_ödex
 (
Vvty_£rv_thªad
, 
sock
, 
vty_£rv_thªad
);

2510 #ifde‡
VTYSH


2511 
VTYSH_SERV
:

2512 
	`thªad_add_ªad
 (
ma°î
, 
vtysh_ac˚±
, 
vty
, 
sock
);

2514 
VTYSH_READ
:

2515 
vty
->
t_ªad
 = 
	`thªad_add_ªad
 (
ma°î
, 
vtysh_ªad
, vty, 
sock
);

2517 
VTYSH_WRITE
:

2518 
vty
->
t_wrôe
 = 
	`thªad_add_wrôe
 (
ma°î
, 
vtysh_wrôe
, vty, 
sock
);

2521 
VTY_READ
:

2522 
vty
->
t_ªad
 = 
	`thªad_add_ªad
 (
ma°î
, 
vty_ªad
, vty, 
sock
);

2525 i‡(
vty
->
v_timeout
)

2527 i‡(
vty
->
t_timeout
)

2528 
	`thªad_ˇn˚l
 (
vty
->
t_timeout
);

2529 
vty
->
t_timeout
 =

2530 
	`thªad_add_timî
 (
ma°î
, 
vty_timeout
, 
vty
, vty->
v_timeout
);

2533 
VTY_WRITE
:

2534 i‡(! 
vty
->
t_wrôe
)

2535 
vty
->
t_wrôe
 = 
	`thªad_add_wrôe
 (
ma°î
, 
vty_Êush
, vty, 
sock
);

2537 
VTY_TIMEOUT_RESET
:

2538 i‡(
vty
->
t_timeout
)

2540 
	`thªad_ˇn˚l
 (
vty
->
t_timeout
);

2541 
vty
->
t_timeout
 = 
NULL
;

2543 i‡(
vty
->
v_timeout
)

2545 
vty
->
t_timeout
 =

2546 
	`thªad_add_timî
 (
ma°î
, 
vty_timeout
, 
vty
, vty->
v_timeout
);

2550 
	}
}

2552 
DEFUN
 (
c⁄fig_who
,

2553 
c⁄fig_who_cmd
,

2557 
	gi
;

2558 
vty
 *
	gv
;

2560 
	gi
 = 0; i < 
ve˘‹_a˘ive
 (
vtyvec
); i++)

2561 i‡((
	gv
 = 
ve˘‹_¶Ÿ
 (
vtyvec
, 
i
)Ë!
NULL
)

2562 
vty_out
 (
vty
, "%svty[%d] connected from %s.%s",

2563 
v
->
c⁄fig
 ? "*" : " ",

2564 
i
, 
v
->
addªss
, 
VTY_NEWLINE
);

2565  
	gCMD_SUCCESS
;

2569 
DEFUN
 (
löe_vty
,

2570 
löe_vty_cmd
,

2575 
	gvty
->
	gnode
 = 
VTY_NODE
;

2576  
	gCMD_SUCCESS
;

2581 
	$exec_timeout
 (
vty
 *vty, c⁄° *
mö_°r
, c⁄° *
£c_°r
)

2583 
timeout
 = 0;

2587 i‡(
mö_°r
)

2589 
timeout
 = 
	`°πﬁ
 (
mö_°r
, 
NULL
, 10);

2590 
timeout
 *= 60;

2592 i‡(
£c_°r
)

2593 
timeout
 +
	`°πﬁ
 (
£c_°r
, 
NULL
, 10);

2595 
vty_timeout_vÆ
 = 
timeout
;

2596 
vty
->
v_timeout
 = 
timeout
;

2597 
	`vty_evít
 (
VTY_TIMEOUT_RESET
, 0, 
vty
);

2600  
CMD_SUCCESS
;

2601 
	}
}

2603 
DEFUN
 (
exec_timeout_mö
,

2604 
exec_timeout_mö_cmd
,

2609  
exec_timeout
 (
vty
, 
¨gv
[0], 
NULL
);

2612 
DEFUN
 (
exec_timeout_£c
,

2613 
exec_timeout_£c_cmd
,

2619  
exec_timeout
 (
vty
, 
¨gv
[0],árgv[1]);

2622 
DEFUN
 (
no_exec_timeout
,

2623 
no_exec_timeout_cmd
,

2625 
NO_STR


2628  
exec_timeout
 (
vty
, 
NULL
, NULL);

2632 
DEFUN
 (
vty_ac˚ss_˛ass
,

2633 
vty_ac˚ss_˛ass_cmd
,

2638 i‡(
	gvty_ac˚s¶i°_«me
)

2639 
XFREE
(
MTYPE_VTY
, 
vty_ac˚s¶i°_«me
);

2641 
	gvty_ac˚s¶i°_«me
 = 
XSTRDUP
(
MTYPE_VTY
, 
¨gv
[0]);

2643  
	gCMD_SUCCESS
;

2647 
DEFUN
 (
no_vty_ac˚ss_˛ass
,

2648 
no_vty_ac˚ss_˛ass_cmd
,

2650 
NO_STR


2654 i‡(! 
	gvty_ac˚s¶i°_«me
 || (
	g¨gc
 && 
°rcmp
(
vty_ac˚s¶i°_«me
, 
¨gv
[0])))

2656 
vty_out
 (
vty
, "Access-class isÇot currentlyáppliedÅo vty%s",

2657 
VTY_NEWLINE
);

2658  
	gCMD_WARNING
;

2661 
XFREE
(
MTYPE_VTY
, 
vty_ac˚s¶i°_«me
);

2663 
	gvty_ac˚s¶i°_«me
 = 
NULL
;

2665  
	gCMD_SUCCESS
;

2668 #ifde‡
HAVE_IPV6


2670 
DEFUN
 (
vty_ùv6_ac˚ss_˛ass
,

2671 
vty_ùv6_ac˚ss_˛ass_cmd
,

2673 
IPV6_STR


2677 i‡(
	gvty_ùv6_ac˚s¶i°_«me
)

2678 
XFREE
(
MTYPE_VTY
, 
vty_ùv6_ac˚s¶i°_«me
);

2680 
	gvty_ùv6_ac˚s¶i°_«me
 = 
XSTRDUP
(
MTYPE_VTY
, 
¨gv
[0]);

2682  
	gCMD_SUCCESS
;

2686 
DEFUN
 (
no_vty_ùv6_ac˚ss_˛ass
,

2687 
no_vty_ùv6_ac˚ss_˛ass_cmd
,

2689 
NO_STR


2690 
IPV6_STR


2694 i‡(! 
	gvty_ùv6_ac˚s¶i°_«me
 ||

2695 (
	g¨gc
 && 
°rcmp
(
vty_ùv6_ac˚s¶i°_«me
, 
¨gv
[0])))

2697 
vty_out
 (
vty
, "IPv6áccess-class isÇot currentlyáppliedÅo vty%s",

2698 
VTY_NEWLINE
);

2699  
	gCMD_WARNING
;

2702 
XFREE
(
MTYPE_VTY
, 
vty_ùv6_ac˚s¶i°_«me
);

2704 
	gvty_ùv6_ac˚s¶i°_«me
 = 
NULL
;

2706  
	gCMD_SUCCESS
;

2711 
DEFUN
 (
vty_logö
,

2712 
vty_logö_cmd
,

2716 
	gno_∑ssw‹d_check
 = 0;

2717  
	gCMD_SUCCESS
;

2720 
DEFUN
 (
no_vty_logö
,

2721 
no_vty_logö_cmd
,

2723 
NO_STR


2726 
	gno_∑ssw‹d_check
 = 1;

2727  
	gCMD_SUCCESS
;

2731 
DEFUN
 (
vty_ª°ri˘ed_mode
,

2732 
vty_ª°ri˘ed_mode_cmd
,

2736 
	gª°ri˘ed_mode
 = 1;

2737  
	gCMD_SUCCESS
;

2740 
DEFUN
 (
vty_no_ª°ri˘ed_mode
,

2741 
vty_no_ª°ri˘ed_mode_cmd
,

2743 
NO_STR


2746 
	gª°ri˘ed_mode
 = 0;

2747  
	gCMD_SUCCESS
;

2750 
DEFUN
 (
£rvi˚_adv™˚d_vty
,

2751 
£rvi˚_adv™˚d_vty_cmd
,

2756 
	gho°
.
	gadv™˚d
 = 1;

2757  
	gCMD_SUCCESS
;

2760 
DEFUN
 (
no_£rvi˚_adv™˚d_vty
,

2761 
no_£rvi˚_adv™˚d_vty_cmd
,

2763 
NO_STR


2767 
	gho°
.
	gadv™˚d
 = 0;

2768  
	gCMD_SUCCESS
;

2771 
DEFUN
 (
ãrmöÆ_m⁄ô‹
,

2772 
ãrmöÆ_m⁄ô‹_cmd
,

2777 
	gvty
->
	gm⁄ô‹
 = 1;

2778  
	gCMD_SUCCESS
;

2781 
DEFUN
 (
ãrmöÆ_no_m⁄ô‹
,

2782 
ãrmöÆ_no_m⁄ô‹_cmd
,

2785 
NO_STR


2788 
	gvty
->
	gm⁄ô‹
 = 0;

2789  
	gCMD_SUCCESS
;

2792 
ALIAS
 (
ãrmöÆ_no_m⁄ô‹
,

2793 
no_ãrmöÆ_m⁄ô‹_cmd
,

2795 
NO_STR


2799 
DEFUN
 (
show_hi°‹y
,

2800 
show_hi°‹y_cmd
,

2802 
SHOW_STR


2805 
	gödex
;

2807 
	gödex
 = 
vty
->
hödex
 + 1; index != vty->hindex;)

2809 i‡(
	gödex
 =
VTY_MAXHIST
)

2811 
ödex
 = 0;

2815 i‡(
	gvty
->
	ghi°
[
ödex
] !
NULL
)

2816 
vty_out
 (
vty
, " %s%s", vty->
hi°
[
ödex
], 
VTY_NEWLINE
);

2818 
	gödex
++;

2821  
	gCMD_SUCCESS
;

2826 
	$vty_c⁄fig_wrôe
 (
vty
 *vty)

2828 
	`vty_out
 (
vty
, "löêvty%s", 
VTY_NEWLINE
);

2830 i‡(
vty_ac˚s¶i°_«me
)

2831 
	`vty_out
 (
vty
, "áccess-class %s%s",

2832 
vty_ac˚s¶i°_«me
, 
VTY_NEWLINE
);

2834 i‡(
vty_ùv6_ac˚s¶i°_«me
)

2835 
	`vty_out
 (
vty
, " ipv6áccess-class %s%s",

2836 
vty_ùv6_ac˚s¶i°_«me
, 
VTY_NEWLINE
);

2839 i‡(
vty_timeout_vÆ
 !
VTY_TIMEOUT_DEFAULT
)

2840 
	`vty_out
 (
vty
, "Éxec-timeout %ld %ld%s",

2841 
vty_timeout_vÆ
 / 60,

2842 
vty_timeout_vÆ
 % 60, 
VTY_NEWLINE
);

2845 i‡(
no_∑ssw‹d_check
)

2846 
	`vty_out
 (
vty
, "Çÿlogö%s", 
VTY_NEWLINE
);

2848 i‡(
ª°ri˘ed_mode
 !
ª°ri˘ed_mode_deÁu…
)

2850 i‡(
ª°ri˘ed_mode_deÁu…
)

2851 
	`vty_out
 (
vty
, "Çÿ™⁄ymou†ª°ri˘ed%s", 
VTY_NEWLINE
);

2853 
	`vty_out
 (
vty
, "án⁄ymou†ª°ri˘ed%s", 
VTY_NEWLINE
);

2856 
	`vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

2858  
CMD_SUCCESS
;

2859 
	}
}

2861 
cmd_node
 
	gvty_node
 =

2863 
VTY_NODE
,

2870 
	$vty_ª£t
 ()

2872 
i
;

2873 
vty
 *vty;

2874 
thªad
 *
vty_£rv_thªad
;

2876 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
vtyvec
); i++)

2877 i‡((
vty
 = 
	`ve˘‹_¶Ÿ
 (
vtyvec
, 
i
)Ë!
NULL
)

2879 
	`buf„r_ª£t
 (
vty
->
obuf
);

2880 
vty
->
°©us
 = 
VTY_CLOSE
;

2881 
	`vty_˛o£
 (
vty
);

2884 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
Vvty_£rv_thªad
); i++)

2885 i‡((
vty_£rv_thªad
 = 
	`ve˘‹_¶Ÿ
 (
Vvty_£rv_thªad
, 
i
)Ë!
NULL
)

2887 
	`thªad_ˇn˚l
 (
vty_£rv_thªad
);

2888 
	`ve˘‹_¶Ÿ
 (
Vvty_£rv_thªad
, 
i
Ë
NULL
;

2889 
	`˛o£
 (
i
);

2892 
vty_timeout_vÆ
 = 
VTY_TIMEOUT_DEFAULT
;

2894 i‡(
vty_ac˚s¶i°_«me
)

2896 
	`XFREE
(
MTYPE_VTY
, 
vty_ac˚s¶i°_«me
);

2897 
vty_ac˚s¶i°_«me
 = 
NULL
;

2900 i‡(
vty_ùv6_ac˚s¶i°_«me
)

2902 
	`XFREE
(
MTYPE_VTY
, 
vty_ùv6_ac˚s¶i°_«me
);

2903 
vty_ùv6_ac˚s¶i°_«me
 = 
NULL
;

2905 
	}
}

2908 
	$vty_ßve_cwd
 ()

2910 
cwd
[
MAXPATHLEN
];

2911 *
c
;

2913 
c
 = 
	`gëcwd
 (
cwd
, 
MAXPATHLEN
);

2915 i‡(!
c
)

2917 
	`chdú
 (
SYSCONFDIR
);

2918 
	`gëcwd
 (
cwd
, 
MAXPATHLEN
);

2921 
vty_cwd
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
	`°æí
 (
cwd
) + 1);

2922 
	`°r˝y
 (
vty_cwd
, 
cwd
);

2923 
	}
}

2926 
	$vty_gë_cwd
 ()

2928  
vty_cwd
;

2929 
	}
}

2932 
	$vty_shñl
 (
vty
 *vty)

2934  
vty
->
ty≥
 =
VTY_SHELL
 ? 1 : 0;

2935 
	}
}

2938 
	$vty_shñl_£rv
 (
vty
 *vty)

2940  
vty
->
ty≥
 =
VTY_SHELL_SERV
 ? 1 : 0;

2941 
	}
}

2944 
	$vty_öô_vtysh
 ()

2946 
vtyvec
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

2947 
	}
}

2951 
	$vty_öô
 (
thªad_ma°î
 *
ma°î_thªad
)

2954 
	`vty_ßve_cwd
 ();

2956 
vtyvec
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

2958 
ma°î
 = 
ma°î_thªad
;

2961 
Vvty_£rv_thªad
 = 
	`ve˘‹_öô
 (
VECTOR_MIN_SIZE
);

2964 
	`ö°Æl_node
 (&
vty_node
, 
vty_c⁄fig_wrôe
);

2966 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
c⁄fig_who_cmd
);

2967 
	`ö°Æl_ñemít
 (
RESTRICTED_NODE
, &
show_hi°‹y_cmd
);

2968 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
c⁄fig_who_cmd
);

2969 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_hi°‹y_cmd
);

2970 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
c⁄fig_who_cmd
);

2971 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
löe_vty_cmd
);

2972 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
£rvi˚_adv™˚d_vty_cmd
);

2973 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_£rvi˚_adv™˚d_vty_cmd
);

2974 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
show_hi°‹y_cmd
);

2975 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ãrmöÆ_m⁄ô‹_cmd
);

2976 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
ãrmöÆ_no_m⁄ô‹_cmd
);

2977 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_ãrmöÆ_m⁄ô‹_cmd
);

2978 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_hi°‹y_cmd
);

2980 
	`ö°Æl_deÁu…
 (
VTY_NODE
);

2981 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
exec_timeout_mö_cmd
);

2982 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
exec_timeout_£c_cmd
);

2983 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
no_exec_timeout_cmd
);

2984 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vty_ac˚ss_˛ass_cmd
);

2985 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
no_vty_ac˚ss_˛ass_cmd
);

2986 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vty_logö_cmd
);

2987 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
no_vty_logö_cmd
);

2988 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vty_ª°ri˘ed_mode_cmd
);

2989 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vty_no_ª°ri˘ed_mode_cmd
);

2990 #ifde‡
HAVE_IPV6


2991 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vty_ùv6_ac˚ss_˛ass_cmd
);

2992 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
no_vty_ùv6_ac˚ss_˛ass_cmd
);

2994 
	}
}

2997 
	$vty_ãrmö©e
 ()

2999 i‡(
vty_cwd
)

3000 
	`XFREE
 (
MTYPE_TMP
, 
vty_cwd
);

3002 i‡(
vtyvec
 && 
Vvty_£rv_thªad
)

3004 
	`vty_ª£t
 ();

3005 
	`ve˘‹_‰ì
 (
vtyvec
);

3006 
	`ve˘‹_‰ì
 (
Vvty_£rv_thªad
);

3008 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vty.h

21 #i‚de‡
_ZEBRA_VTY_H


22 
	#_ZEBRA_VTY_H


	)

24 
	~"thªad.h
"

25 
	~"log.h
"

26 
	~"sockuni⁄.h
"

28 
	#VTY_BUFSIZ
 512

	)

29 
	#VTY_MAXHIST
 20

	)

32 
	svty


35 
	mfd
;

38 íum {
	mVTY_TERM
, 
	mVTY_FILE
, 
	mVTY_SHELL
, 
	mVTY_SHELL_SERV
} 
	mty≥
;

41 
	mnode
;

44 
	mÁû
;

47 
buf„r
 *
	mobuf
;

50 *
	mbuf
;

53 
	m˝
;

56 
	mÀngth
;

59 
	mmax
;

62 *
	mhi°
[
VTY_MAXHIST
];

65 
	mhp
;

68 
	mhödex
;

72 *
	mödex
;

75 *
	mödex_sub
;

78 
	mesˇ≥
;

81 íum {
	mVTY_NORMAL
, 
	mVTY_CLOSE
, 
	mVTY_MORE
, 
	mVTY_MORELINE
} 
	m°©us
;

86 
	müc
;

89 
	müc_sb_ö_¥ogªss
;

93 
	#TELNET_NAWS_SB_LEN
 5

	)

94 
	msb_buf
[
TELNET_NAWS_SB_LEN
];

97 
size_t
 
	msb_Àn
;

100 
	mwidth
;

101 
	mheight
;

104 
	mlöes
;

107 
	mm⁄ô‹
;

110 
	mc⁄fig
;

113 
thªad
 *
	mt_ªad
;

114 
thªad
 *
	mt_wrôe
;

117 
	mv_timeout
;

118 
thªad
 *
	mt_timeout
;

121 
	maddªss
[
SU_ADDRSTRLEN
];

125 
	#INTEGRATE_DEFAULT_CONFIG
 "Quagga.c⁄f"

	)

128 
	#VTY_NEWLINE
 ((
vty
->
ty≥
 =
VTY_TERM
Ë? "\r\n" : "\n")

	)

131 
	#VTY_TIMEOUT_DEFAULT
 600

	)

134 
	#VTY_READ_BUFSIZ
 512

	)

137 #i‚de‡
DIRECTORY_SEP


138 
	#DIRECTORY_SEP
 '/'

	)

141 #i‚de‡
IS_DIRECTORY_SEP


142 
	#IS_DIRECTORY_SEP
(
c
Ë((cË=
DIRECTORY_SEP
)

	)

146 #ifde‡
__GNUC__


147 
	#PRINTF_ATTRIBUTE
(
a
,
b
Ë
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
,á, b)))

	)

149 
	#PRINTF_ATTRIBUTE
(
a
,
b
)

	)

153 
	#VTY_GET_ULONG
(
NAME
,
V
,
STR
) \

155 *
íd±r
 = 
NULL
; \

156 
î∫o
 = 0; \

157 (
V
Ë
	`°πoul
 ((
STR
), &
íd±r
, 10); \

158 i‡(*(
STR
Ë='-' || *
íd±r
 !'\0' || 
î∫o
) \

160 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
); \

161  
CMD_WARNING
; \

163 } 0)

	)

172 
	#VTY_GET_INTEGER_RANGE_HEART
(
NAME
,
TMPL
,
STR
,
MIN
,
MAX
) \

174 
	`VTY_GET_ULONG
(
NAME
, (
TMPL
), 
STR
); \

175 i‡–((
TMPL
Ë<(
MIN
Ë&& (TMPLË!(MIN)Ë|| (TMPLË> (
MAX
) ) \

177 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
);\

178  
CMD_WARNING
; \

180 } 0)

	)

182 
	#VTY_GET_INTEGER_RANGE
(
NAME
,
V
,
STR
,
MIN
,
MAX
) \

184 
tm∂
; \

185 
	`VTY_GET_INTEGER_RANGE_HEART
(
NAME
,
tm∂
,
STR
,
MIN
,
MAX
); \

186 (
V
Ë
tm∂
; \

187 } 0)

	)

189 
	#VTY_CHECK_INTEGER_RANGE
(
NAME
,
STR
,
MIN
,
MAX
) \

191 
tm∂
; \

192 
	`VTY_GET_INTEGER_RANGE_HEART
(
NAME
,
tm∂
,
STR
,
MIN
,
MAX
); \

193 } 0)

	)

195 
	#VTY_GET_INTEGER
(
NAME
,
V
,
STR
) \

196 
	`VTY_GET_INTEGER_RANGE
(
NAME
,
V
,
STR
,0U,
UINT32_MAX
)

	)

198 
	#VTY_GET_IPV4_ADDRESS
(
NAME
,
V
,
STR
) \

200 
ªtv
; \

201 
ªtv
 = 
	`öë_©⁄
 ((
STR
), &(
V
)); \

202 i‡(!
ªtv
) \

204 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
); \

205  
CMD_WARNING
; \

207 } 0)

	)

209 
	#VTY_GET_IPV4_PREFIX
(
NAME
,
V
,
STR
) \

211 
ªtv
; \

212 
ªtv
 = 
	`°r2¥efix_ùv4
 ((
STR
), &(
V
)); \

213 i‡(
ªtv
 <= 0) \

215 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
); \

216  
CMD_WARNING
; \

218 } 0)

	)

221 
öãgøã_deÁu…
[];

224 
vty_öô
 (
thªad_ma°î
 *);

225 
vty_öô_vtysh
 ();

226 
vty_ãrmö©e
 ();

227 
vty_ª£t
 ();

228 
vty
 *
vty_√w
 ();

229 
	$vty_out
 (
vty
 *, c⁄° *, ...Ë
	`PRINTF_ATTRIBUTE
(2, 3);

230 
	`vty_ªad_c⁄fig
 (*, *);

231 
	`vty_time_¥öt
 (
vty
 *, );

232 
	`vty_£rv_sock
 (const *, , const *);

233 
	`vty_˛o£
 (
vty
 *);

234 *
	`vty_gë_cwd
 ();

235 
	`vty_log
 (c⁄° *
Àvñ
, c⁄° *
¥Ÿo
,

236 c⁄° *
fmt
, 
time°amp_c⁄åﬁ
 *, 
va_li°
);

237 
	`vty_c⁄fig_lock
 (
vty
 *);

238 
	`vty_c⁄fig_u∆ock
 (
vty
 *);

239 
	`vty_shñl
 (
vty
 *);

240 
	`vty_shñl_£rv
 (
vty
 *);

241 
	`vty_hñlo
 (
vty
 *);

245 
	`vty_log_fixed
 (c⁄° *
buf
, 
size_t
 
Àn
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/workqueue.c

24 
	~<lib/zebø.h
>

25 
	~"thªad.h
"

26 
	~"mem‹y.h
"

27 
	~"w‹kqueue.h
"

28 
	~"lökli°.h
"

29 
	~"comm™d.h
"

30 
	~"log.h
"

33 
li°
 
	gw‹k_queues
;

35 
	#WORK_QUEUE_MIN_GRANULARITY
 1

	)

37 
w‹k_queue_ôem
 *

38 
	$w‹k_queue_ôem_√w
 (
w‹k_queue
 *
wq
)

40 
w‹k_queue_ôem
 *
ôem
;

41 
	`as£π
 (
wq
);

43 
ôem
 = 
	`XCALLOC
 (
MTYPE_WORK_QUEUE_ITEM
,

44  (
w‹k_queue_ôem
));

46  
ôem
;

47 
	}
}

50 
	$w‹k_queue_ôem_‰ì
 (
w‹k_queue_ôem
 *
ôem
)

52 
	`XFREE
 (
MTYPE_WORK_QUEUE_ITEM
, 
ôem
);

54 
	}
}

57 
w‹k_queue
 *

58 
	$w‹k_queue_√w
 (
thªad_ma°î
 *
m
, c⁄° *
queue_«me
)

60 
w‹k_queue
 *
√w
;

62 
√w
 = 
	`XCALLOC
 (
MTYPE_WORK_QUEUE
,  (
w‹k_queue
));

64 i‡(
√w
 =
NULL
)

65  
√w
;

67 
√w
->
«me
 = 
	`XSTRDUP
 (
MTYPE_WORK_QUEUE_NAME
, 
queue_«me
);

68 
√w
->
ma°î
 = 
m
;

69 
	`SET_FLAG
 (
√w
->
Êags
, 
WQ_UNPLUGGED
);

71 i‡–(
√w
->
ôems
 = 
	`li°_√w
 ()Ë=
NULL
)

73 
	`XFREE
 (
MTYPE_WORK_QUEUE_NAME
, 
√w
->
«me
);

74 
	`XFREE
 (
MTYPE_WORK_QUEUE
, 
√w
);

76  
NULL
;

79 
√w
->
ôems
->
dñ
 = ((*)(*)Ë
w‹k_queue_ôem_‰ì
;

81 
	`li°node_add
 (&
w‹k_queues
, 
√w
);

83 
√w
->
cy˛es
.
gønuœrôy
 = 
WORK_QUEUE_MIN_GRANULARITY
;

86 
√w
->
•ec
.
hﬁd
 = 
WORK_QUEUE_DEFAULT_HOLD
;

88  
√w
;

89 
	}
}

92 
	$w‹k_queue_‰ì
 (
w‹k_queue
 *
wq
)

94 i‡(
wq
->
thªad
 !
NULL
)

95 
	`thªad_ˇn˚l
(
wq
->
thªad
);

98 
	`li°_dñëe
 (
wq
->
ôems
);

99 
	`li°node_dñëe
 (&
w‹k_queues
, 
wq
);

101 
	`XFREE
 (
MTYPE_WORK_QUEUE_NAME
, 
wq
->
«me
);

102 
	`XFREE
 (
MTYPE_WORK_QUEUE
, 
wq
);

104 
	}
}

107 
	$w‹k_queue_scheduÀ
 (
w‹k_queue
 *
wq
, 
dñay
)

110 i‡–
	`CHECK_FLAG
 (
wq
->
Êags
, 
WQ_UNPLUGGED
)

111 && (
wq
->
thªad
 =
NULL
)

112 && (
	`li°cou¡
 (
wq
->
ôems
) > 0) )

114 
wq
->
thªad
 = 
	`thªad_add_background
 (wq->
ma°î
, 
w‹k_queue_run
,

115 
wq
, 
dñay
);

120 
	}
}

123 
	$w‹k_queue_add
 (
w‹k_queue
 *
wq
, *
d©a
)

125 
w‹k_queue_ôem
 *
ôem
;

127 
	`as£π
 (
wq
);

129 i‡(!(
ôem
 = 
	`w‹k_queue_ôem_√w
 (
wq
)))

131 
	`zlog_îr
 ("%s: u«bÀÅÿgëÇew queuêôem", 
__func__
);

135 
ôem
->
d©a
 = data;

136 
	`li°node_add
 (
wq
->
ôems
, 
ôem
);

138 
	`w‹k_queue_scheduÀ
 (
wq
, wq->
•ec
.
hﬁd
);

141 
	}
}

144 
	$w‹k_queue_ôem_ªmove
 (
w‹k_queue
 *
wq
, 
li°node
 *
 
)

146 
w‹k_queue_ôem
 *
ôem
 = 
	`li°gëd©a
 (
 
);

148 
	`as£π
 (
ôem
 && iãm->
d©a
);

151 i‡(
wq
->
•ec
.
dñ_ôem_d©a
)

152 
wq
->
•ec
.
	`dñ_ôem_d©a
 (wq, 
ôem
->
d©a
);

154 
	`li°_dñëe_node
 (
wq
->
ôems
, 
 
);

155 
	`w‹k_queue_ôem_‰ì
 (
ôem
);

158 
	}
}

161 
	$w‹k_queue_ôem_ªqueue
 (
w‹k_queue
 *
wq
, 
li°node
 *
 
)

163 
	`LISTNODE_DETACH
 (
wq
->
ôems
, 
 
);

164 
	`LISTNODE_ATTACH
 (
wq
->
ôems
, 
 
);

165 
	}
}

167 
DEFUN
(
show_w‹k_queues
,

168 
show_w‹k_queues_cmd
,

170 
SHOW_STR


173 
li°node
 *
	gnode
;

174 
w‹k_queue
 *
	gwq
;

176 
vty_out
 (
vty
,

179 
VTY_NEWLINE
);

180 
vty_out
 (
vty
,

188 
VTY_NEWLINE
);

190 
ALL_LIST_ELEMENTS_RO
 ((&
w‹k_queues
), 
node
, 
wq
))

192 
vty_out
 (
vty
,"%c %8d %5d %8ld %7d %6d %6u %s%s",

193 (
CHECK_FLAG
 (
wq
->
Êags
, 
WQ_UNPLUGGED
) ? ' ' : 'P'),

194 
li°cou¡
 (
wq
->
ôems
),

195 
wq
->
•ec
.
hﬁd
,

196 
wq
->
runs
,

197 
wq
->
cy˛es
.
be°
, wq->cy˛es.
gønuœrôy
,

198 (
wq
->
runs
) ?

199 (Ë(
wq
->
cy˛es
.
tŸÆ
 / wq->
runs
) : 0,

200 
wq
->
«me
,

201 
VTY_NEWLINE
);

204  
	gCMD_SUCCESS
;

211 
	$w‹k_queue_∂ug
 (
w‹k_queue
 *
wq
)

213 i‡(
wq
->
thªad
)

214 
	`thªad_ˇn˚l
 (
wq
->
thªad
);

216 
wq
->
thªad
 = 
NULL
;

218 
	`UNSET_FLAG
 (
wq
->
Êags
, 
WQ_UNPLUGGED
);

219 
	}
}

225 
	$w‹k_queue_u≈lug
 (
w‹k_queue
 *
wq
)

227 
	`SET_FLAG
 (
wq
->
Êags
, 
WQ_UNPLUGGED
);

230 
	`w‹k_queue_scheduÀ
 (
wq
, wq->
•ec
.
hﬁd
);

231 
	}
}

238 
	$w‹k_queue_run
 (
thªad
 *thread)

240 
w‹k_queue
 *
wq
;

241 
w‹k_queue_ôem
 *
ôem
;

242 
wq_ôem_°©us
 
ªt
;

243 
cy˛es
 = 0;

244 
li°node
 *
node
, *
¬ode
;

245 
yõlded
 = 0;

247 
wq
 = 
	`THREAD_ARG
 (
thªad
);

248 
wq
->
thªad
 = 
NULL
;

250 
	`as£π
 (
wq
 && wq->
ôems
);

269 i‡(
wq
->
cy˛es
.
gønuœrôy
 == 0)

270 
wq
->
cy˛es
.
gønuœrôy
 = 
WORK_QUEUE_MIN_GRANULARITY
;

272 
	`ALL_LIST_ELEMENTS
 (
wq
->
ôems
, 
node
, 
¬ode
, 
ôem
))

274 
	`as£π
 (
ôem
 && iãm->
d©a
);

277 i‡(
ôem
->
øn
 > 
wq
->
•ec
.
max_ªåõs
)

280 i‡(
wq
->
•ec
.
îr‹func
)

281 
wq
->
•ec
.
	`îr‹func
 (wq, 
ôem
->
d©a
);

282 
	`w‹k_queue_ôem_ªmove
 (
wq
, 
node
);

289 
ªt
 = 
wq
->
•ec
.
	`w‹kfunc
 (wq, 
ôem
->
d©a
);

290 
ôem
->
øn
++;

292 (
ªt
 =
WQ_RETRY_NOW
)

293 && (
ôem
->
øn
 < 
wq
->
•ec
.
max_ªåõs
));

295 
ªt
)

297 
WQ_QUEUE_BLOCKED
:

302 
ôem
->
øn
--;

304 
WQ_RETRY_LATER
:

306 
°©s
;

308 
WQ_REQUEUE
:

310 
ôem
->
øn
--;

311 
	`w‹k_queue_ôem_ªqueue
 (
wq
, 
node
);

314 
WQ_RETRY_NOW
:

316 
WQ_ERROR
:

318 i‡(
wq
->
•ec
.
îr‹func
)

319 
wq
->
•ec
.
	`îr‹func
 (wq, 
ôem
);

322 
WQ_SUCCESS
:

325 
	`w‹k_queue_ôem_ªmove
 (
wq
, 
node
);

331 
cy˛es
++;

334 i‡–!(
cy˛es
 % 
wq
->cy˛es.
gønuœrôy
)

335 && 
	`thªad_should_yõld
 (
thªad
))

337 
yõlded
 = 1;

338 
°©s
;

342 
°©s
:

344 
	#WQ_HYSTERESIS_FACTOR
 4

	)

347 i‡(
yõlded
 && (
cy˛es
 < 
wq
->cy˛es.
gønuœrôy
))

349 
wq
->
cy˛es
.
gønuœrôy
 = ((cycles > 0) ? cycles

350 : 
WORK_QUEUE_MIN_GRANULARITY
);

353 i‡(
cy˛es
 >(
wq
->cy˛es.
gønuœrôy
))

355 i‡(
cy˛es
 > 
wq
->cy˛es.
be°
)

356 
wq
->
cy˛es
.
be°
 = cycles;

359 i‡(
cy˛es
 > (
wq
->cy˛es.
gønuœrôy
 * 
WQ_HYSTERESIS_FACTOR


360 * 
WQ_HYSTERESIS_FACTOR
))

361 
wq
->
cy˛es
.
gønuœrôy
 *
WQ_HYSTERESIS_FACTOR
;

362 i‡(
cy˛es
 > (
wq
->cy˛es.
gønuœrôy
 * 
WQ_HYSTERESIS_FACTOR
))

363 
wq
->
cy˛es
.
gønuœrôy
 +
WQ_HYSTERESIS_FACTOR
;

365 #unde‡
WQ_HYSTERIS_FACTOR


367 
wq
->
runs
++;

368 
wq
->
cy˛es
.
tŸÆ
 += cycles;

371 
	`¥ötf
 ("%s: cycles %d,Çew: best %d, worst %d\n",

372 
__func__
, 
cy˛es
, 
wq
->cy˛es.
be°
, wq->cy˛es.
gønuœrôy
);

376 i‡(
	`li°cou¡
 (
wq
->
ôems
) > 0)

377 
	`w‹k_queue_scheduÀ
 (
wq
, 0);

378 i‡(
wq
->
•ec
.
com∂ëi⁄_func
)

379 
wq
->
•ec
.
	`com∂ëi⁄_func
 (wq);

382 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/workqueue.h

24 #i‚de‡
_QUAGGA_WORK_QUEUE_H


25 
	#_QUAGGA_WORK_QUEUE_H


	)

28 
	#WORK_QUEUE_DEFAULT_HOLD
 50

	)

33 
	mWQ_SUCCESS
 = 0,

34 
	mWQ_ERROR
,

35 
	mWQ_RETRY_NOW
,

36 
	mWQ_RETRY_LATER
,

37 
	mWQ_REQUEUE
,

38 
	mWQ_QUEUE_BLOCKED
,

41 } 
	twq_ôem_°©us
;

44 
	sw‹k_queue_ôem


46 *
	md©a
;

47 
	møn
;

50 
	#WQ_UNPLUGGED
 (1 << 0Ë

	)

52 
	sw‹k_queue


57 
thªad_ma°î
 *
	mma°î
;

58 
thªad
 *
	mthªad
;

59 *
	m«me
;

66 *
	md©a
;

72 
wq_ôem_°©us
 (*
w‹kfunc
Ë(
	mw‹k_queue
 *, *);

75 (*
	mîr‹func
Ë(
	mw‹k_queue
 *, 
	mw‹k_queue_ôem
 *);

78 (*
	mdñ_ôem_d©a
Ë(
	mw‹k_queue
 *, *);

81 (*
	mcom∂ëi⁄_func
Ë(
	mw‹k_queue
 *);

84 
	mmax_ªåõs
;

86 
	mhﬁd
;

87 } 
	m•ec
;

90 
li°
 *
	môems
;

91 
	mruns
;

94 
	mbe°
;

95 
	mgønuœrôy
;

96 
	mtŸÆ
;

97 } 
	mcy˛es
;

100 
u_öt16_t
 
	mÊags
;

109 
w‹k_queue
 *
w‹k_queue_√w
 (
thªad_ma°î
 *,

112 
w‹k_queue_‰ì
 (
w‹k_queue
 *);

115 
w‹k_queue_add
 (
w‹k_queue
 *, *);

118 
w‹k_queue_∂ug
 (
w‹k_queue
 *
wq
);

120 
w‹k_queue_u≈lug
 (
w‹k_queue
 *
wq
);

123 
w‹k_queue_run
 (
thªad
 *);

124 
cmd_ñemít
 
show_w‹k_queues_cmd
;

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zassert.h

5 #i‚de‡
_QUAGGA_ASSERT_H


6 
	#_QUAGGA_ASSERT_H


	)

8 
	$_zlog_as£π_Áûed
 (c⁄° *
as£πi⁄
, c⁄° *
fûe
,

9 
löe
, c⁄° *
fun˘i⁄
)

10 
	`__©åibuã__
 ((
n‹ëu∫
));

12 #i‡
	`deföed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

13 
	#__ASSERT_FUNCTION
 
__func__


	)

14 #ñi‡
	`deföed
(
__GNUC__
)

15 
	#__ASSERT_FUNCTION
 
__FUNCTION__


	)

17 
	#__ASSERT_FUNCTION
 
NULL


	)

20 
	#zas£π
(
EX
) (()((EX) ? 0 : \

21 (
	`_zlog_as£π_Áûed
(#EX, 
__FILE__
, 
__LINE__
, \

22 
__ASSERT_FUNCTION
), 0)))

	)

24 #unde‡
as£π


25 
	#as£π
(
EX
Ë
	`zas£π
(EX)

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zclient.c

23 
	~<zebø.h
>

25 
	~"¥efix.h
"

26 
	~"°ªam.h
"

27 
	~"buf„r.h
"

28 
	~"√tw‹k.h
"

29 
	~"if.h
"

30 
	~"log.h
"

31 
	~"thªad.h
"

32 
	~"z˛õ¡.h
"

33 
	~"mem‹y.h
"

34 
	~"èbÀ.h
"

37 
	eevít
 {
	mZCLIENT_SCHEDULE
, 
	mZCLIENT_READ
, 
	mZCLIENT_CONNECT
};

40 
z˛õ¡_evít
 (
evít
, 
z˛õ¡
 *);

42 
thªad_ma°î
 *
ma°î
;

44 *
	gz˛õ¡_£rv_∑th
 = 
NULL
;

47 
	gz˛õ¡_debug
 = 0;

50 
z˛õ¡
 *

51 
	$z˛õ¡_√w
 ()

53 
z˛õ¡
 *zclient;

54 
z˛õ¡
 = 
	`XCALLOC
 (
MTYPE_ZCLIENT
,  (zclient));

56 
z˛õ¡
->
ibuf
 = 
	`°ªam_√w
 (
ZEBRA_MAX_PACKET_SIZ
);

57 
z˛õ¡
->
obuf
 = 
	`°ªam_√w
 (
ZEBRA_MAX_PACKET_SIZ
);

58 
z˛õ¡
->
wb
 = 
	`buf„r_√w
(0);

60  
z˛õ¡
;

61 
	}
}

69 
	$z˛õ¡_‰ì
 (
z˛õ¡
 *zclient)

71 i‡(
z˛õ¡
->
ibuf
)

72 
	`°ªam_‰ì
(
z˛õ¡
->
ibuf
);

73 i‡(
z˛õ¡
->
obuf
)

74 
	`°ªam_‰ì
(
z˛õ¡
->
obuf
);

75 i‡(
z˛õ¡
->
wb
)

76 
	`buf„r_‰ì
(
z˛õ¡
->
wb
);

78 
	`XFREE
 (
MTYPE_ZCLIENT
, 
z˛õ¡
);

79 
	}
}

84 
	$z˛õ¡_öô
 (
z˛õ¡
 *z˛õ¡, 
ªdi°_deÁu…
)

86 
i
;

89 
z˛õ¡
->
íabÀ
 = 1;

92 
z˛õ¡
->
sock
 = -1;

95 
i
 = 0; i < 
ZEBRA_ROUTE_MAX
; i++)

96 
z˛õ¡
->
ªdi°
[
i
] = 0;

100 
z˛õ¡
->
ªdi°_deÁu…
 =Ñedist_default;

101 
z˛õ¡
->
ªdi°
[
ªdi°_deÁu…
] = 1;

104 
z˛õ¡
->
deÁu…_öf‹m©i⁄
 = 0;

107 i‡(
z˛õ¡_debug
)

108 
	`zlog_debug
 ("zclient start scheduled");

110 
	`z˛õ¡_evít
 (
ZCLIENT_SCHEDULE
, 
z˛õ¡
);

111 
	}
}

115 
	$z˛õ¡_°›
 (
z˛õ¡
 *zclient)

117 i‡(
z˛õ¡_debug
)

118 
	`zlog_debug
 ("zclient stopped");

121 
	`THREAD_OFF
(
z˛õ¡
->
t_ªad
);

122 
	`THREAD_OFF
(
z˛õ¡
->
t_c⁄√˘
);

123 
	`THREAD_OFF
(
z˛õ¡
->
t_wrôe
);

126 
	`°ªam_ª£t
(
z˛õ¡
->
ibuf
);

127 
	`°ªam_ª£t
(
z˛õ¡
->
obuf
);

130 
	`buf„r_ª£t
(
z˛õ¡
->
wb
);

133 i‡(
z˛õ¡
->
sock
 >= 0)

135 
	`˛o£
 (
z˛õ¡
->
sock
);

136 
z˛õ¡
->
sock
 = -1;

138 
z˛õ¡
->
Áû
 = 0;

139 
	}
}

142 
	$z˛õ¡_ª£t
 (
z˛õ¡
 *zclient)

144 
	`z˛õ¡_°›
 (
z˛õ¡
);

145 
	`z˛õ¡_öô
 (
z˛õ¡
, z˛õ¡->
ªdi°_deÁu…
);

146 
	}
}

148 #ifde‡
HAVE_TCP_ZEBRA


152 
	$z˛õ¡_sockë
()

154 
sock
;

155 
ªt
;

156 
sockaddr_ö
 
£rv
;

159 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_STREAM
, 0);

160 i‡(
sock
 < 0)

164 
	`mem£t
 (&
£rv
, 0,  (
sockaddr_ö
));

165 
£rv
.
sö_Ámûy
 = 
AF_INET
;

166 
£rv
.
sö_p‹t
 = 
	`ht⁄s
 (
ZEBRA_PORT
);

167 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


168 
£rv
.
sö_Àn
 =  (
sockaddr_ö
);

170 
£rv
.
sö_addr
.
s_addr
 = 
	`ht⁄l
 (
INADDR_LOOPBACK
);

173 
ªt
 = 
	`c⁄√˘
 (
sock
, (
sockaddr
 *Ë&
£rv
,  (serv));

174 i‡(
ªt
 < 0)

176 
	`˛o£
 (
sock
);

179  
sock
;

180 
	}
}

185 
	~<sys/un.h
>

188 
	$z˛õ¡_sockë_un
 (c⁄° *
∑th
)

190 
ªt
;

191 
sock
, 
Àn
;

192 
sockaddr_un
 
addr
;

194 
sock
 = 
	`sockë
 (
AF_UNIX
, 
SOCK_STREAM
, 0);

195 i‡(
sock
 < 0)

199 
	`mem£t
 (&
addr
, 0,  (
sockaddr_un
));

200 
addr
.
sun_Ámûy
 = 
AF_UNIX
;

201 
	`°∫˝y
 (
addr
.
sun_∑th
, 
∑th
, 
	`°æí
 (path));

202 #ifde‡
HAVE_STRUCT_SOCKADDR_UN_SUN_LEN


203 
Àn
 = 
addr
.
sun_Àn
 = 
	`SUN_LEN
(&addr);

205 
Àn
 =  (
addr
.
sun_Ámûy
Ë+ 
	`°æí
 (addr.
sun_∑th
);

208 
ªt
 = 
	`c⁄√˘
 (
sock
, (
sockaddr
 *Ë&
addr
, 
Àn
);

209 i‡(
ªt
 < 0)

211 
	`˛o£
 (
sock
);

214  
sock
;

215 
	}
}

227 
	$z˛õ¡_sockë_c⁄√˘
 (
z˛õ¡
 *zclient)

229 #ifde‡
HAVE_TCP_ZEBRA


230 
z˛õ¡
->
sock
 = 
	`z˛õ¡_sockë
 ();

232 
z˛õ¡
->
sock
 = 
	`z˛õ¡_sockë_un
 (
z˛õ¡_£rv_∑th
 ? z˛õ¡_£rv_∑th : 
ZEBRA_SERV_PATH
);

234  
z˛õ¡
->
sock
;

235 
	}
}

238 
	$z˛õ¡_Áûed
(
z˛õ¡
 *zclient)

240 
z˛õ¡
->
Áû
++;

241 
	`z˛õ¡_°›
(
z˛õ¡
);

242 
	`z˛õ¡_evít
(
ZCLIENT_CONNECT
, 
z˛õ¡
);

244 
	}
}

247 
	$z˛õ¡_Êush_d©a
(
thªad
 *thread)

249 
z˛õ¡
 *z˛õ¡ = 
	`THREAD_ARG
(
thªad
);

251 
z˛õ¡
->
t_wrôe
 = 
NULL
;

252 i‡(
z˛õ¡
->
sock
 < 0)

254 
	`buf„r_Êush_avaûabÀ
(
z˛õ¡
->
wb
, z˛õ¡->
sock
))

256 
BUFFER_ERROR
:

257 
	`zlog_w¨n
("%s: buffer_flush_available failed on zclient fd %d, closing",

258 
__func__
, 
z˛õ¡
->
sock
);

259  
	`z˛õ¡_Áûed
(
z˛õ¡
);

261 
BUFFER_PENDING
:

262 
z˛õ¡
->
t_wrôe
 = 
	`thªad_add_wrôe
(
ma°î
, 
z˛õ¡_Êush_d©a
,

263 
z˛õ¡
, z˛õ¡->
sock
);

265 
BUFFER_EMPTY
:

269 
	}
}

272 
	$z˛õ¡_£nd_mesßge
(
z˛õ¡
 *zclient)

274 i‡(
z˛õ¡
->
sock
 < 0)

276 
	`buf„r_wrôe
(
z˛õ¡
->
wb
, z˛õ¡->
sock
, 
	`STREAM_DATA
(z˛õ¡->
obuf
),

277 
	`°ªam_gë_ídp
(
z˛õ¡
->
obuf
)))

279 
BUFFER_ERROR
:

280 
	`zlog_w¨n
("%s: buffer_write failedÅo zclient fd %d, closing",

281 
__func__
, 
z˛õ¡
->
sock
);

282  
	`z˛õ¡_Áûed
(
z˛õ¡
);

284 
BUFFER_EMPTY
:

285 
	`THREAD_OFF
(
z˛õ¡
->
t_wrôe
);

287 
BUFFER_PENDING
:

288 
	`THREAD_WRITE_ON
(
ma°î
, 
z˛õ¡
->
t_wrôe
,

289 
z˛õ¡_Êush_d©a
, 
z˛õ¡
, z˛õ¡->
sock
);

293 
	}
}

296 
	$z˛õ¡_¸óã_hódî
 (
°ªam
 *
s
, 
uöt16_t
 
comm™d
)

299 
	`°ªam_putw
 (
s
, 
ZEBRA_HEADER_SIZE
);

300 
	`°ªam_putc
 (
s
, 
ZEBRA_HEADER_MARKER
);

301 
	`°ªam_putc
 (
s
, 
ZSERV_VERSION
);

302 
	`°ªam_putw
 (
s
, 
comm™d
);

303 
	}
}

307 
	$zebø_mesßge_£nd
 (
z˛õ¡
 *z˛õ¡, 
comm™d
)

309 
°ªam
 *
s
;

312 
s
 = 
z˛õ¡
->
obuf
;

313 
	`°ªam_ª£t
 (
s
);

316 
	`z˛õ¡_¸óã_hódî
 (
s
, 
comm™d
);

318  
	`z˛õ¡_£nd_mesßge
(
z˛õ¡
);

319 
	}
}

322 
	$zebø_hñlo_£nd
 (
z˛õ¡
 *zclient)

324 
°ªam
 *
s
;

326 i‡(
z˛õ¡
->
ªdi°_deÁu…
)

328 
s
 = 
z˛õ¡
->
obuf
;

329 
	`°ªam_ª£t
 (
s
);

331 
	`z˛õ¡_¸óã_hódî
 (
s
, 
ZEBRA_HELLO
);

332 
	`°ªam_putc
 (
s
, 
z˛õ¡
->
ªdi°_deÁu…
);

333 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

334  
	`z˛õ¡_£nd_mesßge
(
z˛õ¡
);

338 
	}
}

342 
	$z˛õ¡_°¨t
 (
z˛õ¡
 *zclient)

344 
i
;

346 i‡(
z˛õ¡_debug
)

347 
	`zlog_debug
 ("zclient_start is called");

350 i‡(! 
z˛õ¡
->
íabÀ
)

354 i‡(
z˛õ¡
->
sock
 >= 0)

358 i‡(
z˛õ¡
->
t_c⁄√˘
)

361 i‡(
	`z˛õ¡_sockë_c⁄√˘
(
z˛õ¡
) < 0)

363 i‡(
z˛õ¡_debug
)

364 
	`zlog_debug
 ("zclient connection fail");

365 
z˛õ¡
->
Áû
++;

366 
	`z˛õ¡_evít
 (
ZCLIENT_CONNECT
, 
z˛õ¡
);

370 i‡(
	`£t_n⁄blockög
(
z˛õ¡
->
sock
) < 0)

371 
	`zlog_w¨n
("%s: së_n⁄blockög(%dËÁûed", 
__func__
, 
z˛õ¡
->
sock
);

374 
z˛õ¡
->
Áû
 = 0;

375 i‡(
z˛õ¡_debug
)

376 
	`zlog_debug
 ("z˛õ¡ c⁄√˘ suc˚s†wôh sockë [%d]", 
z˛õ¡
->
sock
);

379 
	`z˛õ¡_evít
 (
ZCLIENT_READ
, 
z˛õ¡
);

381 
	`zebø_hñlo_£nd
 (
z˛õ¡
);

384 
	`zebø_mesßge_£nd
 (
z˛õ¡
, 
ZEBRA_ROUTER_ID_ADD
);

387 
	`zebø_mesßge_£nd
 (
z˛õ¡
, 
ZEBRA_INTERFACE_ADD
);

390 
i
 = 0; i < 
ZEBRA_ROUTE_MAX
; i++)

391 i‡(
i
 !
z˛õ¡
->
ªdi°_deÁu…
 && z˛õ¡->
ªdi°
[i])

392 
	`zebø_ªdi°ribuã_£nd
 (
ZEBRA_REDISTRIBUTE_ADD
, 
z˛õ¡
, 
i
);

395 i‡(
z˛õ¡
->
deÁu…_öf‹m©i⁄
)

396 
	`zebø_mesßge_£nd
 (
z˛õ¡
, 
ZEBRA_REDISTRIBUTE_DEFAULT_ADD
);

399 
	}
}

404 
	$z˛õ¡_c⁄√˘
 (
thªad
 *
t
)

406 
z˛õ¡
 *zclient;

408 
z˛õ¡
 = 
	`THREAD_ARG
 (
t
);

409 
z˛õ¡
->
t_c⁄√˘
 = 
NULL
;

411 i‡(
z˛õ¡_debug
)

412 
	`zlog_debug
 ("zclient_connect is called");

414  
	`z˛õ¡_°¨t
 (
z˛õ¡
);

415 
	}
}

462 
	$z≠i_ùv4_rouã
 (
u_ch¨
 
cmd
, 
z˛õ¡
 *z˛õ¡, 
¥efix_ùv4
 *
p
,

463 
z≠i_ùv4
 *
≠i
)

465 
i
;

466 
psize
;

467 
°ªam
 *
s
;

470 
s
 = 
z˛õ¡
->
obuf
;

471 
	`°ªam_ª£t
 (
s
);

473 
	`z˛õ¡_¸óã_hódî
 (
s
, 
cmd
);

476 
	`°ªam_putc
 (
s
, 
≠i
->
ty≥
);

477 
	`°ªam_putc
 (
s
, 
≠i
->
Êags
);

478 
	`°ªam_putc
 (
s
, 
≠i
->
mesßge
);

479 
	`°ªam_putw
 (
s
, 
≠i
->
ßfi
);

482 
psize
 = 
	`PSIZE
 (
p
->
¥efixÀn
);

483 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
);

484 
	`°ªam_wrôe
 (
s
, (
u_ch¨
 *Ë& 
p
->
¥efix
, 
psize
);

487 i‡(
	`CHECK_FLAG
 (
≠i
->
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

489 i‡(
	`CHECK_FLAG
 (
≠i
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

491 
	`°ªam_putc
 (
s
, 1);

492 
	`°ªam_putc
 (
s
, 
ZEBRA_NEXTHOP_BLACKHOLE
);

497 
	`°ªam_putc
 (
s
, 
≠i
->
√xth›_num
 +ápi->
ifödex_num
);

499 
i
 = 0; i < 
≠i
->
√xth›_num
; i++)

501 
	`°ªam_putc
 (
s
, 
ZEBRA_NEXTHOP_IPV4
);

502 
	`°ªam_put_ö_addr
 (
s
, 
≠i
->
√xth›
[
i
]);

504 
i
 = 0; i < 
≠i
->
ifödex_num
; i++)

506 
	`°ªam_putc
 (
s
, 
ZEBRA_NEXTHOP_IFINDEX
);

507 
	`°ªam_pué
 (
s
, 
≠i
->
ifödex
[
i
]);

511 i‡(
	`CHECK_FLAG
 (
≠i
->
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

512 
	`°ªam_putc
 (
s
, 
≠i
->
di°™˚
);

513 i‡(
	`CHECK_FLAG
 (
≠i
->
mesßge
, 
ZAPI_MESSAGE_METRIC
))

514 
	`°ªam_pué
 (
s
, 
≠i
->
mëric
);

517 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

519  
	`z˛õ¡_£nd_mesßge
(
z˛õ¡
);

520 
	}
}

522 #ifde‡
HAVE_IPV6


524 
	$z≠i_ùv6_rouã
 (
u_ch¨
 
cmd
, 
z˛õ¡
 *z˛õ¡, 
¥efix_ùv6
 *
p
,

525 
z≠i_ùv6
 *
≠i
)

527 
i
;

528 
psize
;

529 
°ªam
 *
s
;

532 
s
 = 
z˛õ¡
->
obuf
;

533 
	`°ªam_ª£t
 (
s
);

535 
	`z˛õ¡_¸óã_hódî
 (
s
, 
cmd
);

538 
	`°ªam_putc
 (
s
, 
≠i
->
ty≥
);

539 
	`°ªam_putc
 (
s
, 
≠i
->
Êags
);

540 
	`°ªam_putc
 (
s
, 
≠i
->
mesßge
);

541 
	`°ªam_putw
 (
s
, 
≠i
->
ßfi
);

544 
psize
 = 
	`PSIZE
 (
p
->
¥efixÀn
);

545 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
);

546 
	`°ªam_wrôe
 (
s
, (
u_ch¨
 *)&
p
->
¥efix
, 
psize
);

549 i‡(
	`CHECK_FLAG
 (
≠i
->
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

551 
	`°ªam_putc
 (
s
, 
≠i
->
√xth›_num
 +ápi->
ifödex_num
);

553 
i
 = 0; i < 
≠i
->
√xth›_num
; i++)

555 
	`°ªam_putc
 (
s
, 
ZEBRA_NEXTHOP_IPV6
);

556 
	`°ªam_wrôe
 (
s
, (
u_ch¨
 *)
≠i
->
√xth›
[
i
], 16);

558 
i
 = 0; i < 
≠i
->
ifödex_num
; i++)

560 
	`°ªam_putc
 (
s
, 
ZEBRA_NEXTHOP_IFINDEX
);

561 
	`°ªam_pué
 (
s
, 
≠i
->
ifödex
[
i
]);

565 i‡(
	`CHECK_FLAG
 (
≠i
->
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

566 
	`°ªam_putc
 (
s
, 
≠i
->
di°™˚
);

567 i‡(
	`CHECK_FLAG
 (
≠i
->
mesßge
, 
ZAPI_MESSAGE_METRIC
))

568 
	`°ªam_pué
 (
s
, 
≠i
->
mëric
);

571 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

573  
	`z˛õ¡_£nd_mesßge
(
z˛õ¡
);

574 
	}
}

584 
	$zebø_ªdi°ribuã_£nd
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
ty≥
)

586 
°ªam
 *
s
;

588 
s
 = 
z˛õ¡
->
obuf
;

589 
	`°ªam_ª£t
(
s
);

591 
	`z˛õ¡_¸óã_hódî
 (
s
, 
comm™d
);

592 
	`°ªam_putc
 (
s
, 
ty≥
);

594 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

596  
	`z˛õ¡_£nd_mesßge
(
z˛õ¡
);

597 
	}
}

601 
	$zebø_rouãr_id_upd©e_ªad
 (
°ªam
 *
s
, 
¥efix
 *
rid
)

603 
∂í
;

606 
rid
->
Ámûy
 = 
	`°ªam_gëc
 (
s
);

608 
∂í
 = 
	`¥efix_bÀn
 (
rid
);

609 
	`°ªam_gë
 (&
rid
->
u
.
¥efix
, 
s
, 
∂í
);

610 
rid
->
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

611 
	}
}

645 
öãrÁ˚
 *

646 
	$zebø_öãrÁ˚_add_ªad
 (
°ªam
 *
s
)

648 
öãrÁ˚
 *
iÂ
;

649 
i‚ame_tmp
[
INTERFACE_NAMSIZ
];

652 
	`°ªam_gë
 (
i‚ame_tmp
, 
s
, 
INTERFACE_NAMSIZ
);

655 
iÂ
 = 
	`if_gë_by_«me_Àn
 (
i‚ame_tmp
, 
	`°∫Àn
(i‚ame_tmp, 
INTERFACE_NAMSIZ
));

657 
	`zebø_öãrÁ˚_if_£t_vÆue
 (
s
, 
iÂ
);

659  
iÂ
;

660 
	}
}

669 
öãrÁ˚
 *

670 
	$zebø_öãrÁ˚_°©e_ªad
 (
°ªam
 *
s
)

672 
öãrÁ˚
 *
iÂ
;

673 
i‚ame_tmp
[
INTERFACE_NAMSIZ
];

676 
	`°ªam_gë
 (
i‚ame_tmp
, 
s
, 
INTERFACE_NAMSIZ
);

679 
iÂ
 = 
	`if_lookup_by_«me_Àn
 (
i‚ame_tmp
,

680 
	`°∫Àn
(
i‚ame_tmp
, 
INTERFACE_NAMSIZ
));

683 i‡(! 
iÂ
)

684  
NULL
;

686 
	`zebø_öãrÁ˚_if_£t_vÆue
 (
s
, 
iÂ
);

688  
iÂ
;

689 
	}
}

724 
	$zebø_öãrÁ˚_if_£t_vÆue
 (
°ªam
 *
s
, 
öãrÁ˚
 *
iÂ
)

727 
iÂ
->
ifödex
 = 
	`°ªam_gël
 (
s
);

728 
iÂ
->
°©us
 = 
	`°ªam_gëc
 (
s
);

731 
iÂ
->
Êags
 = 
	`°ªam_gëq
 (
s
);

732 
iÂ
->
mëric
 = 
	`°ªam_gël
 (
s
);

733 
iÂ
->
mtu
 = 
	`°ªam_gël
 (
s
);

734 
iÂ
->
mtu6
 = 
	`°ªam_gël
 (
s
);

735 
iÂ
->
b™dwidth
 = 
	`°ªam_gël
 (
s
);

736 #ifde‡
HAVE_STRUCT_SOCKADDR_DL


737 
	`°ªam_gë
 (&
iÂ
->
sdl
, 
s
,  (iÂ->
sdl_°‹age
));

739 
iÂ
->
hw_addr_Àn
 = 
	`°ªam_gël
 (
s
);

740 i‡(
iÂ
->
hw_addr_Àn
)

741 
	`°ªam_gë
 (
iÂ
->
hw_addr
, 
s
, iÂ->
hw_addr_Àn
);

743 
	}
}

746 
	$memc⁄°™t
(c⁄° *
s
, 
c
, 
size_t
 
n
)

748 c⁄° 
u_ch¨
 *
p
 = 
s
;

750 
n
-- > 0)

751 i‡(*
p
++ !
c
)

754 
	}
}

756 
c⁄√˘ed
 *

757 
	$zebø_öãrÁ˚_addªss_ªad
 (
ty≥
, 
°ªam
 *
s
)

759 
ifödex
;

760 
öãrÁ˚
 *
iÂ
;

761 
c⁄√˘ed
 *
ifc
;

762 
¥efix
 
p
, 
d
;

763 
Ámûy
;

764 
∂í
;

765 
u_ch¨
 
ifc_Êags
;

767 
	`mem£t
 (&
p
, 0, (p));

768 
	`mem£t
 (&
d
, 0, (d));

771 
ifödex
 = 
	`°ªam_gël
 (
s
);

774 
iÂ
 = 
	`if_lookup_by_ödex
 (
ifödex
);

775 i‡(
iÂ
 =
NULL
)

777 
	`zlog_w¨n
 ("zebra_interface_address_read(%s): "

779 (
ty≥
 =
ZEBRA_INTERFACE_ADDRESS_ADD
? "ADD" : "DELETE"),

780 
ifödex
);

781  
NULL
;

785 
ifc_Êags
 = 
	`°ªam_gëc
 (
s
);

788 
Ámûy
 = 
p
.Ámûy = 
	`°ªam_gëc
 (
s
);

790 
∂í
 = 
	`¥efix_bÀn
 (&
p
);

791 
	`°ªam_gë
 (&
p
.
u
.
¥efix
, 
s
, 
∂í
);

792 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

795 
	`°ªam_gë
 (&
d
.
u
.
¥efix
, 
s
, 
∂í
);

796 
d
.
Ámûy
 = family;

798 i‡(
ty≥
 =
ZEBRA_INTERFACE_ADDRESS_ADD
)

801 
ifc
 = 
	`c⁄√˘ed_add_by_¥efix
(
iÂ
, &
p
,(
	`memc⁄°™t
(&
d
.
u
.
¥efix
,0,
∂í
) ?

802 
NULL
 : &
d
));

803 i‡(
ifc
 !
NULL
)

805 
ifc
->
Êags
 = 
ifc_Êags
;

806 i‡(
ifc
->
de°ö©i⁄
)

807 
ifc
->
de°ö©i⁄
->
¥efixÀn
 = ifc->
addªss
->prefixlen;

812 
	`as£π
 (
ty≥
 =
ZEBRA_INTERFACE_ADDRESS_DELETE
);

813 
ifc
 = 
	`c⁄√˘ed_dñëe_by_¥efix
(
iÂ
, &
p
);

816  
ifc
;

817 
	}
}

822 
	$z˛õ¡_ªad
 (
thªad
 *thread)

824 
size_t
 
Æªady
;

825 
uöt16_t
 
Àngth
, 
comm™d
;

826 
uöt8_t
 
m¨kî
, 
vîsi⁄
;

827 
z˛õ¡
 *zclient;

830 
z˛õ¡
 = 
	`THREAD_ARG
 (
thªad
);

831 
z˛õ¡
->
t_ªad
 = 
NULL
;

834 i‡((
Æªady
 = 
	`°ªam_gë_ídp
(
z˛õ¡
->
ibuf
)Ë< 
ZEBRA_HEADER_SIZE
)

836 
ssize_t
 
nbyã
;

837 i‡(((
nbyã
 = 
	`°ªam_ªad_åy
(
z˛õ¡
->
ibuf
, z˛õ¡->
sock
,

838 
ZEBRA_HEADER_SIZE
-
Æªady
)) == 0) ||

839 (
nbyã
 == -1))

841 i‡(
z˛õ¡_debug
)

842 
	`zlog_debug
 ("z˛õ¡ c⁄√˘i⁄ clo£d sockë [%d].", 
z˛õ¡
->
sock
);

843  
	`z˛õ¡_Áûed
(
z˛õ¡
);

845 i‡(
nbyã
 !(
ssize_t
)(
ZEBRA_HEADER_SIZE
-
Æªady
))

848 
	`z˛õ¡_evít
 (
ZCLIENT_READ
, 
z˛õ¡
);

851 
Æªady
 = 
ZEBRA_HEADER_SIZE
;

855 
	`°ªam_£t_gëp
(
z˛õ¡
->
ibuf
, 0);

858 
Àngth
 = 
	`°ªam_gëw
 (
z˛õ¡
->
ibuf
);

859 
m¨kî
 = 
	`°ªam_gëc
 (
z˛õ¡
->
ibuf
);

860 
vîsi⁄
 = 
	`°ªam_gëc
 (
z˛õ¡
->
ibuf
);

861 
comm™d
 = 
	`°ªam_gëw
 (
z˛õ¡
->
ibuf
);

863 i‡(
m¨kî
 !
ZEBRA_HEADER_MARKER
 || 
vîsi⁄
 !
ZSERV_VERSION
)

865 
	`zlog_îr
("%s: socket %d version mismatch, marker %d, version %d",

866 
__func__
, 
z˛õ¡
->
sock
, 
m¨kî
, 
vîsi⁄
);

867  
	`z˛õ¡_Áûed
(
z˛õ¡
);

870 i‡(
Àngth
 < 
ZEBRA_HEADER_SIZE
)

872 
	`zlog_îr
("%s: socket %d messageÜength %u isÜessÅhan %d ",

873 
__func__
, 
z˛õ¡
->
sock
, 
Àngth
, 
ZEBRA_HEADER_SIZE
);

874  
	`z˛õ¡_Áûed
(
z˛õ¡
);

878 i‡(
Àngth
 > 
	`STREAM_SIZE
(
z˛õ¡
->
ibuf
))

880 
°ªam
 *
ns
;

881 
	`zlog_w¨n
("%s: message size %uÉxceeds buffer size %lu,Éxpanding...",

882 
__func__
, 
Àngth
, (
u_l⁄g
)
	`STREAM_SIZE
(
z˛õ¡
->
ibuf
));

883 
ns
 = 
	`°ªam_√w
(
Àngth
);

884 
	`°ªam_c›y
(
ns
, 
z˛õ¡
->
ibuf
);

885 
	`°ªam_‰ì
 (
z˛õ¡
->
ibuf
);

886 
z˛õ¡
->
ibuf
 = 
ns
;

890 i‡(
Æªady
 < 
Àngth
)

892 
ssize_t
 
nbyã
;

893 i‡(((
nbyã
 = 
	`°ªam_ªad_åy
(
z˛õ¡
->
ibuf
, z˛õ¡->
sock
,

894 
Àngth
-
Æªady
)) == 0) ||

895 (
nbyã
 == -1))

897 i‡(
z˛õ¡_debug
)

898 
	`zlog_debug
("z˛õ¡ c⁄√˘i⁄ clo£d sockë [%d].", 
z˛õ¡
->
sock
);

899  
	`z˛õ¡_Áûed
(
z˛õ¡
);

901 i‡(
nbyã
 !(
ssize_t
)(
Àngth
-
Æªady
))

904 
	`z˛õ¡_evít
 (
ZCLIENT_READ
, 
z˛õ¡
);

909 
Àngth
 -
ZEBRA_HEADER_SIZE
;

911 i‡(
z˛õ¡_debug
)

912 
	`zlog_debug
("z˛õ¡ 0x%∞comm™d 0x%x \n", 
z˛õ¡
, 
comm™d
);

914 
comm™d
)

916 
ZEBRA_ROUTER_ID_UPDATE
:

917 i‡(
z˛õ¡
->
rouãr_id_upd©e
)

918 (*
z˛õ¡
->
rouãr_id_upd©e
Ë(
comm™d
, z˛õ¡, 
Àngth
);

920 
ZEBRA_INTERFACE_ADD
:

921 i‡(
z˛õ¡
->
öãrÁ˚_add
)

922 (*
z˛õ¡
->
öãrÁ˚_add
Ë(
comm™d
, z˛õ¡, 
Àngth
);

924 
ZEBRA_INTERFACE_DELETE
:

925 i‡(
z˛õ¡
->
öãrÁ˚_dñëe
)

926 (*
z˛õ¡
->
öãrÁ˚_dñëe
Ë(
comm™d
, z˛õ¡, 
Àngth
);

928 
ZEBRA_INTERFACE_ADDRESS_ADD
:

929 i‡(
z˛õ¡
->
öãrÁ˚_addªss_add
)

930 (*
z˛õ¡
->
öãrÁ˚_addªss_add
Ë(
comm™d
, z˛õ¡, 
Àngth
);

932 
ZEBRA_INTERFACE_ADDRESS_DELETE
:

933 i‡(
z˛õ¡
->
öãrÁ˚_addªss_dñëe
)

934 (*
z˛õ¡
->
öãrÁ˚_addªss_dñëe
Ë(
comm™d
, z˛õ¡, 
Àngth
);

936 
ZEBRA_INTERFACE_UP
:

937 i‡(
z˛õ¡
->
öãrÁ˚_up
)

938 (*
z˛õ¡
->
öãrÁ˚_up
Ë(
comm™d
, z˛õ¡, 
Àngth
);

940 
ZEBRA_INTERFACE_DOWN
:

941 i‡(
z˛õ¡
->
öãrÁ˚_down
)

942 (*
z˛õ¡
->
öãrÁ˚_down
Ë(
comm™d
, z˛õ¡, 
Àngth
);

944 
ZEBRA_IPV4_ROUTE_ADD
:

945 i‡(
z˛õ¡
->
ùv4_rouã_add
)

946 (*
z˛õ¡
->
ùv4_rouã_add
Ë(
comm™d
, z˛õ¡, 
Àngth
);

948 
ZEBRA_IPV4_ROUTE_DELETE
:

949 i‡(
z˛õ¡
->
ùv4_rouã_dñëe
)

950 (*
z˛õ¡
->
ùv4_rouã_dñëe
Ë(
comm™d
, z˛õ¡, 
Àngth
);

952 
ZEBRA_IPV6_ROUTE_ADD
:

953 i‡(
z˛õ¡
->
ùv6_rouã_add
)

954 (*
z˛õ¡
->
ùv6_rouã_add
Ë(
comm™d
, z˛õ¡, 
Àngth
);

956 
ZEBRA_IPV6_ROUTE_DELETE
:

957 i‡(
z˛õ¡
->
ùv6_rouã_dñëe
)

958 (*
z˛õ¡
->
ùv6_rouã_dñëe
Ë(
comm™d
, z˛õ¡, 
Àngth
);

964 i‡(
z˛õ¡
->
sock
 < 0)

969 
	`°ªam_ª£t
(
z˛õ¡
->
ibuf
);

970 
	`z˛õ¡_evít
 (
ZCLIENT_READ
, 
z˛õ¡
);

973 
	}
}

976 
	$z˛õ¡_ªdi°ribuã
 (
comm™d
, 
z˛õ¡
 *z˛õ¡, 
ty≥
)

979 i‡(
comm™d
 =
ZEBRA_REDISTRIBUTE_ADD
)

981 i‡(
z˛õ¡
->
ªdi°
[
ty≥
])

983 
z˛õ¡
->
ªdi°
[
ty≥
] = 1;

987 i‡(!
z˛õ¡
->
ªdi°
[
ty≥
])

989 
z˛õ¡
->
ªdi°
[
ty≥
] = 0;

992 i‡(
z˛õ¡
->
sock
 > 0)

993 
	`zebø_ªdi°ribuã_£nd
 (
comm™d
, 
z˛õ¡
, 
ty≥
);

994 
	}
}

998 
	$z˛õ¡_ªdi°ribuã_deÁu…
 (
comm™d
, 
z˛õ¡
 *zclient)

1001 i‡(
comm™d
 =
ZEBRA_REDISTRIBUTE_DEFAULT_ADD
)

1003 i‡(
z˛õ¡
->
deÁu…_öf‹m©i⁄
)

1005 
z˛õ¡
->
deÁu…_öf‹m©i⁄
 = 1;

1009 i‡(!
z˛õ¡
->
deÁu…_öf‹m©i⁄
)

1011 
z˛õ¡
->
deÁu…_öf‹m©i⁄
 = 0;

1014 i‡(
z˛õ¡
->
sock
 > 0)

1015 
	`zebø_mesßge_£nd
 (
z˛õ¡
, 
comm™d
);

1016 
	}
}

1019 
	$z˛õ¡_evít
 (
evít
Évít, 
z˛õ¡
 *zclient)

1021 
evít
)

1023 
ZCLIENT_SCHEDULE
:

1024 i‡(! 
z˛õ¡
->
t_c⁄√˘
)

1025 
z˛õ¡
->
t_c⁄√˘
 =

1026 
	`thªad_add_evít
 (
ma°î
, 
z˛õ¡_c⁄√˘
, 
z˛õ¡
, 0);

1028 
ZCLIENT_CONNECT
:

1029 i‡(
z˛õ¡
->
Áû
 >= 10)

1031 i‡(
z˛õ¡_debug
)

1032 
	`zlog_debug
 ("zclient connect schedule interval is %d",

1033 
z˛õ¡
->
Áû
 < 3 ? 10 : 60);

1034 i‡(! 
z˛õ¡
->
t_c⁄√˘
)

1035 
z˛õ¡
->
t_c⁄√˘
 =

1036 
	`thªad_add_timî
 (
ma°î
, 
z˛õ¡_c⁄√˘
, 
z˛õ¡
,

1037 
z˛õ¡
->
Áû
 < 3 ? 10 : 60);

1039 
ZCLIENT_READ
:

1040 
z˛õ¡
->
t_ªad
 =

1041 
	`thªad_add_ªad
 (
ma°î
, 
z˛õ¡_ªad
, 
z˛õ¡
, z˛õ¡->
sock
);

1044 
	}
}

1047 
	$z˛õ¡_£rv_∑th_£t
 (*
∑th
)

1049 
°©
 
sb
;

1052 
z˛õ¡_£rv_∑th
 = 
NULL
;

1055 i‡(
	`°©
(
∑th
, &
sb
) == -1)

1057 
	`zlog_w¨n
 ("%s: zebø sockë `%s' d€†nŸÉxi°", 
__func__
, 
∑th
);

1061 i‡((
sb
.
°_mode
 & 
S_IFMT
Ë!
S_IFSOCK
)

1063 
	`zlog_w¨n
 ("%s: `%s' i†nŸ unix sockë, sú", 
__func__
, 
∑th
);

1068 
z˛õ¡_£rv_∑th
 = 
∑th
;

1069 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zclient.h

22 #i‚de‡
_ZEBRA_ZCLIENT_H


23 
	#_ZEBRA_ZCLIENT_H


	)

26 
	~"¥efix.h
"

29 
	~"if.h
"

32 
	#ZEBRA_MAX_PACKET_SIZ
 4096

	)

35 
	#ZEBRA_HEADER_SIZE
 6

	)

38 
	sz˛õ¡


41 
	msock
;

45 
	míabÀ
;

48 
	mÁû
;

51 
°ªam
 *
	mibuf
;

54 
°ªam
 *
	mobuf
;

57 
buf„r
 *
	mwb
;

60 
thªad
 *
	mt_ªad
;

61 
thªad
 *
	mt_c⁄√˘
;

64 
thªad
 *
	mt_wrôe
;

67 
u_ch¨
 
	mªdi°_deÁu…
;

68 
u_ch¨
 
	mªdi°
[
ZEBRA_ROUTE_MAX
];

71 
u_ch¨
 
	mdeÁu…_öf‹m©i⁄
;

74 (*
	mrouãr_id_upd©e
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

75 (*
	möãrÁ˚_add
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

76 (*
	möãrÁ˚_dñëe
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

77 (*
	möãrÁ˚_up
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

78 (*
	möãrÁ˚_down
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

79 (*
	möãrÁ˚_addªss_add
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

80 (*
	möãrÁ˚_addªss_dñëe
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

81 (*
	mùv4_rouã_add
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

82 (*
	mùv4_rouã_dñëe
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

83 (*
	mùv6_rouã_add
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

84 (*
	mùv6_rouã_dñëe
Ë(, 
	mz˛õ¡
 *, 
	muöt16_t
);

88 
	#ZAPI_MESSAGE_NEXTHOP
 0x01

	)

89 
	#ZAPI_MESSAGE_IFINDEX
 0x02

	)

90 
	#ZAPI_MESSAGE_DISTANCE
 0x04

	)

91 
	#ZAPI_MESSAGE_METRIC
 0x08

	)

94 
	sz£rv_hódî


96 
uöt16_t
 
	mÀngth
;

97 
uöt8_t
 
	mm¨kî
;

100 
uöt8_t
 
	mvîsi⁄
;

101 
	#ZSERV_VERSION
 2

	)

102 
uöt16_t
 
	mcomm™d
;

106 
	sz≠i_ùv4


108 
u_ch¨
 
	mty≥
;

110 
u_ch¨
 
	mÊags
;

112 
u_ch¨
 
	mmesßge
;

114 
ßfi_t
 
	mßfi
;

116 
u_ch¨
 
	m√xth›_num
;

117 
ö_addr
 **
	m√xth›
;

119 
u_ch¨
 
	mifödex_num
;

120 *
	mifödex
;

122 
u_ch¨
 
	mdi°™˚
;

124 
u_öt32_t
 
	mmëric
;

128 
z˛õ¡
 *
z˛õ¡_√w
 ();

129 
z˛õ¡_öô
 (
z˛õ¡
 *, );

130 
z˛õ¡_°¨t
 (
z˛õ¡
 *);

131 
z˛õ¡_°›
 (
z˛õ¡
 *);

132 
z˛õ¡_ª£t
 (
z˛õ¡
 *);

133 
z˛õ¡_‰ì
 (
z˛õ¡
 *);

135 
z˛õ¡_sockë_c⁄√˘
 (
z˛õ¡
 *);

136 
z˛õ¡_£rv_∑th_£t
 (*
∑th
);

139 
zebø_ªdi°ribuã_£nd
 (
comm™d
, 
z˛õ¡
 *, 
ty≥
);

142 
z˛õ¡_ªdi°ribuã
 (
comm™d
, 
z˛õ¡
 *, 
ty≥
);

145 
z˛õ¡_ªdi°ribuã_deÁu…
 (
comm™d
, 
z˛õ¡
 *);

149 
z˛õ¡_£nd_mesßge
(
z˛õ¡
 *);

152 
z˛õ¡_¸óã_hódî
 (
°ªam
 *, 
uöt16_t
);

154 
öãrÁ˚
 *
zebø_öãrÁ˚_add_ªad
 (
°ªam
 *);

155 
öãrÁ˚
 *
zebø_öãrÁ˚_°©e_ªad
 (
°ªam
 *
s
);

156 
c⁄√˘ed
 *
zebø_öãrÁ˚_addªss_ªad
 (, 
°ªam
 *);

157 
zebø_öãrÁ˚_if_£t_vÆue
 (
°ªam
 *, 
öãrÁ˚
 *);

158 
zebø_rouãr_id_upd©e_ªad
 (
°ªam
 *
s
, 
¥efix
 *
rid
);

159 
z≠i_ùv4_rouã
 (
u_ch¨
, 
z˛õ¡
 *, 
¥efix_ùv4
 *,

160 
z≠i_ùv4
 *);

162 #ifde‡
HAVE_IPV6


165 
	sz≠i_ùv6


167 
u_ch¨
 
	mty≥
;

169 
u_ch¨
 
	mÊags
;

171 
u_ch¨
 
	mmesßge
;

173 
ßfi_t
 
	mßfi
;

175 
u_ch¨
 
	m√xth›_num
;

176 
ö6_addr
 **
	m√xth›
;

178 
u_ch¨
 
	mifödex_num
;

179 *
	mifödex
;

181 
u_ch¨
 
	mdi°™˚
;

183 
u_öt32_t
 
	mmëric
;

186 
z≠i_ùv6_rouã
 (
u_ch¨
 
cmd
, 
z˛õ¡
 *zclient,

187 
¥efix_ùv6
 *
p
, 
z≠i_ùv6
 *
≠i
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zebra.h

21 #i‚de‡
_ZEBRA_H


22 
	#_ZEBRA_H


	)

24 #ifde‡
HAVE_CONFIG_H


25 
	~"c⁄fig.h
"

28 #ifde‡
SUNOS_5


29 
	#_XPG4_2


	)

30 
	#__EXTENSIONS__


	)

31 
	tu_öt32_t
;

32 
	tu_öt16_t
;

33 
	tu_öt8_t
;

36 #i‚de‡
HAVE_SOCKLEN_T


37 
	tsockÀn_t
;

40 
	~<uni°d.h
>

41 
	~<°dio.h
>

42 
	~<°dlib.h
>

43 
	~<˘y≥.h
>

44 
	~<î∫o.h
>

45 
	~<f˙é.h
>

46 
	~<sig«l.h
>

47 
	~<°rög.h
>

48 
	~<pwd.h
>

49 
	~<gΩ.h
>

50 #ifde‡
HAVE_STROPTS_H


51 
	~<°r›ts.h
>

53 
	~<sys/f˙é.h
>

54 #ifde‡
HAVE_SYS_SELECT_H


55 
	~<sys/£À˘.h
>

57 
	~<sys/°©.h
>

58 
	~<sys/ty≥s.h
>

59 
	~<sys/∑øm.h
>

60 #ifde‡
HAVE_SYS_SYSCTL_H


61 #ifde‡
GNU_LINUX


62 
	~<löux/ty≥s.h
>

64 
	~<sys/sys˘l.h
>

66 
	~<sys/io˘l.h
>

67 #ifde‡
HAVE_SYS_CONF_H


68 
	~<sys/c⁄f.h
>

70 #ifde‡
HAVE_SYS_KSYM_H


71 
	~<sys/ksym.h
>

73 
	~<sy¶og.h
>

74 #ifde‡
TIME_WITH_SYS_TIME


75 
	~<sys/time.h
>

76 
	~<time.h
>

78 #ifde‡
HAVE_SYS_TIME_H


79 
	~<sys/time.h
>

81 
	~<time.h
>

84 
	~<sys/uio.h
>

85 
	~<sys/ut¢ame.h
>

86 #ifde‡
HAVE_RUSAGE


87 
	~<sys/ªsour˚.h
>

89 #ifde‡
HAVE_LIMITS_H


90 
	~<limôs.h
>

92 #ifde‡
HAVE_INTTYPES_H


93 
	~<öây≥s.h
>

97 #ifde‡
SUNOS_5


98 
	~<°rögs.h
>

102 #ifde‡
HAVE_LINUX_VERSION_H


103 
	~<löux/vîsi⁄.h
>

106 #ifde‡
HAVE_ASM_TYPES_H


107 
	~<asm/ty≥s.h
>

111 
	~<°d¨g.h
>

112 #i‡!(
deföed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L)

114 #i‚de‡
va_c›y


115 #ifde‡
__va_c›y


116 
	#va_c›y
(
DST
,
SRC
Ë
	`__va_c›y
(DST,SRC)

	)

121 
	#va_c›y
(
DST
,
SRC
Ë
	`mem˝y
(&(DST), &(SRC), (
va_li°
))

	)

128 #ifde‡
HAVE_LCAPS


129 
	~<sys/ˇ∑bûôy.h
>

130 
	~<sys/¥˘l.h
>

133 #ifde‡
HAVE_SOLARIS_CAPABILITIES


134 
	~<¥iv.h
>

139 
	~<sys/sockë.h
>

141 #ifde‡
HAVE_SYS_SOCKIO_H


142 
	~<sys/sockio.h
>

145 #ifde‡
__APPLE__


146 
	#__APPLE_USE_RFC_3542


	)

149 #ifde‡
HAVE_NETINET_IN_H


150 
	~<√töë/ö.h
>

152 
	~<√töë/ö_sy°m.h
>

153 
	~<√töë/ù.h
>

154 
	~<√töë/t˝.h
>

156 #ifde‡
HAVE_NET_NETOPT_H


157 
	~<√t/√t›t.h
>

160 
	~<√t/if.h
>

162 #ifde‡
HAVE_NET_IF_DL_H


163 
	~<√t/if_dl.h
>

166 #ifde‡
HAVE_NET_IF_VAR_H


167 
	~<√t/if_v¨.h
>

170 #ifde‡
HAVE_NET_ROUTE_H


171 
	~<√t/rouã.h
>

174 #ifde‡
HAVE_NETLINK


175 
	~<löux/√éök.h
>

176 
	~<löux/π√éök.h
>

177 
	~<löux/fûãr.h
>

178 
	~<°ddef.h
>

180 
	#RT_TABLE_MAIN
 0

	)

183 #ifde‡
HAVE_NETDB_H


184 
	~<√tdb.h
>

187 
	~<¨∑/öë.h
>

189 #ifde‡
HAVE_INET_ND_H


190 
	~<öë/nd.h
>

193 #ifde‡
HAVE_NETINET_IN_VAR_H


194 
	~<√töë/ö_v¨.h
>

197 #ifde‡
HAVE_NETINET6_IN6_VAR_H


198 
	~<√töë6/ö6_v¨.h
>

201 #ifde‡
HAVE_NETINET_IN6_VAR_H


202 
	~<√töë/ö6_v¨.h
>

205 #ifde‡
HAVE_NETINET6_IN_H


206 
	~<√töë6/ö.h
>

210 #ifde‡
HAVE_NETINET6_IP6_H


211 
	~<√töë6/ù6.h
>

214 #ifde‡
HAVE_NETINET_ICMP6_H


215 
	~<√töë/icmp6.h
>

218 #ifde‡
HAVE_NETINET6_ND6_H


219 
	~<√töë6/nd6.h
>

225 #i‚de‡
INT8_MAX


226 
	#INT8_MAX
 (127)

	)

228 #i‚de‡
INT16_MAX


229 
	#INT16_MAX
 (32767)

	)

231 #i‚de‡
INT32_MAX


232 
	#INT32_MAX
 (2147483647)

	)

234 #i‚de‡
UINT8_MAX


235 
	#UINT8_MAX
 (255U)

	)

237 #i‚de‡
UINT16_MAX


238 
	#UINT16_MAX
 (65535U)

	)

240 #i‚de‡
UINT32_MAX


241 
	#UINT32_MAX
 (4294967295U)

	)

244 #ifde‡
HAVE_GLIBC_BACKTRACE


245 
	~<execöfo.h
>

248 #ifde‡
BSDI_NRL


250 #ifde‡
HAVE_NETINET6_IN6_H


251 
	~<√töë6/ö6.h
>

254 #ifde‡
NRL


255 
	~<√töë6/ö6.h
>

258 
	#IN6_ARE_ADDR_EQUAL
 
IN6_IS_ADDR_EQUAL


	)

263 #i‡!(
deföed
(
__GNUC__
Ë|| deföed(
VTYSH_EXTRACT_PL
))

264 
	#__©åibuã__
(
x
)

	)

267 
	~"zas£π.h
"

268 
	~"°r.h
"

271 #ifde‡
HAVE_BROKEN_CMSG_FIRSTHDR


276 
	#ZCMSG_FIRSTHDR
(
mhdr
) \

277 (((
size_t
)((
mhdr
)->
msg_c⁄åﬁÀn
Ë>(
cmsghdr
)) ? \

278 
	`CMSG_FIRSTHDR
(
mhdr
Ë: (
cmsghdr
 *)
NULL
)

	)

283 
	#ZCMSG_FIRSTHDR
(
M
Ë
	`CMSG_FIRSTHDR
(M)

	)

297 #i‚de‡
_CMSG_DATA_ALIGN


298 
	#_CMSG_DATA_ALIGN
(
n
Ë((“Ë+ 3Ë& ~3)

	)

301 #i‚de‡
_CMSG_HDR_ALIGN


302 
	#_CMSG_HDR_ALIGN
(
n
Ë((“Ë+ 3Ë& ~3)

	)

309 #i‚de‡
CMSG_SPACE


310 
	#CMSG_SPACE
(
l
Ë(
	`_CMSG_DATA_ALIGN
((
cmsghdr
)) + \

311 
	`_CMSG_HDR_ALIGN
(
l
))

	)

316 #i‚de‡
CMSG_LEN


317 
	#CMSG_LEN
(
l
Ë(
	`_CMSG_DATA_ALIGN
((
cmsghdr
)Ë+ (l))

	)

324 #i‡
deföed
 (
GNU_LINUX
Ë&& ! deföed (
HAVE_STRUCT_IN_PKTINFO
)

325 
	sö_pktöfo


327 
	mùi_ifödex
;

328 
ö_addr
 
	mùi_•ec_d°
;

329 
ö_addr
 
	mùi_addr
;

349 #ifde‡
GNU_LINUX


350 
	#WANT_OSPF_WRITE_FRAGMENT


	)

362 #i‡
deföed
(
__NëBSD__
Ë|| deföed(
__FªeBSD__
) \

363 || (
deföed
(
__O≥nBSD__
Ë&& (
	gO≥nBSD
 < 200311)) \

364 || (
deföed
(
__APPLE__
)) \

365 || (
deföed
(
SUNOS_5
Ë&& 
	$deföed
(
WORDS_BIGENDIAN
))

366 
	#HAVE_IP_HDRINCL_BSD_ORDER


	)

373 #i‚de‡
BYTE_ORDER


374 
	#BIG_ENDIAN
 4321

	)

375 
	#LITTLE_ENDIAN
 1234

	)

376 
	#PDP_ENDIAN
 3412

	)

378 #i‡
	`deföed
(
WORDS_BIGENDIAN
)

379 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

381 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

387 #i‚de‡
MAX


388 
	#MAX
(
a
, 
b
Ë(◊Ë> (bË? (aË: (b))

	)

390 #i‚de‡
MIN


391 
	#MIN
(
a
, 
b
Ë(◊Ë< (bË? (aË: (b))

	)

394 
	#ZEBRA_NUM_OF
(
x
Ë( (xË/  (x[0]))

	)

397 #i‚de‡
IN6_ARE_ADDR_EQUAL


398 
	#IN6_ARE_ADDR_EQUAL
 
IN6_IS_ADDR_EQUAL


	)

402 
	#ZEBRA_PORT
 2600

	)

405 
	#ZEBRA_INTERFACE_ADD
 1

	)

406 
	#ZEBRA_INTERFACE_DELETE
 2

	)

407 
	#ZEBRA_INTERFACE_ADDRESS_ADD
 3

	)

408 
	#ZEBRA_INTERFACE_ADDRESS_DELETE
 4

	)

409 
	#ZEBRA_INTERFACE_UP
 5

	)

410 
	#ZEBRA_INTERFACE_DOWN
 6

	)

411 
	#ZEBRA_IPV4_ROUTE_ADD
 7

	)

412 
	#ZEBRA_IPV4_ROUTE_DELETE
 8

	)

413 
	#ZEBRA_IPV6_ROUTE_ADD
 9

	)

414 
	#ZEBRA_IPV6_ROUTE_DELETE
 10

	)

415 
	#ZEBRA_REDISTRIBUTE_ADD
 11

	)

416 
	#ZEBRA_REDISTRIBUTE_DELETE
 12

	)

417 
	#ZEBRA_REDISTRIBUTE_DEFAULT_ADD
 13

	)

418 
	#ZEBRA_REDISTRIBUTE_DEFAULT_DELETE
 14

	)

419 
	#ZEBRA_IPV4_NEXTHOP_LOOKUP
 15

	)

420 
	#ZEBRA_IPV6_NEXTHOP_LOOKUP
 16

	)

421 
	#ZEBRA_IPV4_IMPORT_LOOKUP
 17

	)

422 
	#ZEBRA_IPV6_IMPORT_LOOKUP
 18

	)

423 
	#ZEBRA_INTERFACE_RENAME
 19

	)

424 
	#ZEBRA_ROUTER_ID_ADD
 20

	)

425 
	#ZEBRA_ROUTER_ID_DELETE
 21

	)

426 
	#ZEBRA_ROUTER_ID_UPDATE
 22

	)

427 
	#ZEBRA_HELLO
 23

	)

428 
	#ZEBRA_MESSAGE_MAX
 24

	)

434 
	#ZEBRA_HEADER_MARKER
 255

	)

437 
	~"rouã_ty≥s.h
"

444 c⁄° *
	`zebø_rouã_°rög
(
rouã_ty≥
);

446 
	`zebø_rouã_ch¨
(
rouã_ty≥
);

450 
	`¥Ÿo_«me2num
(c⁄° *
s
);

454 
	`¥Ÿo_ªdi°num
(
afi
, c⁄° *
s
);

456 c⁄° *
	`z£rv_comm™d_°rög
 (
comm™d
);

459 
	#ZEBRA_FAMILY_IPV4
 1

	)

460 
	#ZEBRA_FAMILY_IPV6
 2

	)

461 
	#ZEBRA_FAMILY_MAX
 3

	)

464 
	#ZEBRA_ERR_NOERROR
 0

	)

465 
	#ZEBRA_ERR_RTEXIST
 -1

	)

466 
	#ZEBRA_ERR_RTUNREACH
 -2

	)

467 
	#ZEBRA_ERR_EPERM
 -3

	)

468 
	#ZEBRA_ERR_RTNOEXIST
 -4

	)

469 
	#ZEBRA_ERR_KERNEL
 -5

	)

472 
	#ZEBRA_FLAG_INTERNAL
 0x01

	)

473 
	#ZEBRA_FLAG_SELFROUTE
 0x02

	)

474 
	#ZEBRA_FLAG_BLACKHOLE
 0x04

	)

475 
	#ZEBRA_FLAG_IBGP
 0x08

	)

476 
	#ZEBRA_FLAG_SELECTED
 0x10

	)

477 
	#ZEBRA_FLAG_CHANGED
 0x20

	)

478 
	#ZEBRA_FLAG_STATIC
 0x40

	)

479 
	#ZEBRA_FLAG_REJECT
 0x80

	)

482 
	#ZEBRA_NEXTHOP_IFINDEX
 1

	)

483 
	#ZEBRA_NEXTHOP_IFNAME
 2

	)

484 
	#ZEBRA_NEXTHOP_IPV4
 3

	)

485 
	#ZEBRA_NEXTHOP_IPV4_IFINDEX
 4

	)

486 
	#ZEBRA_NEXTHOP_IPV4_IFNAME
 5

	)

487 
	#ZEBRA_NEXTHOP_IPV6
 6

	)

488 
	#ZEBRA_NEXTHOP_IPV6_IFINDEX
 7

	)

489 
	#ZEBRA_NEXTHOP_IPV6_IFNAME
 8

	)

490 
	#ZEBRA_NEXTHOP_BLACKHOLE
 9

	)

492 #i‚de‡
INADDR_LOOPBACK


493 
	#INADDR_LOOPBACK
 0x7f000001

	)

497 
	#AFI_IP
 1

	)

498 
	#AFI_IP6
 2

	)

499 
	#AFI_MAX
 3

	)

502 
	#SAFI_UNICAST
 1

	)

503 
	#SAFI_MULTICAST
 2

	)

504 
	#SAFI_RESERVED_3
 3

	)

505 
	#SAFI_MPLS_VPN
 4

	)

506 
	#SAFI_MAX
 5

	)

509 
	#FILTER_IN
 0

	)

510 
	#FILTER_OUT
 1

	)

511 
	#FILTER_MAX
 2

	)

514 
	#ZEBRA_KERNEL_DISTANCE_DEFAULT
 0

	)

515 
	#ZEBRA_CONNECT_DISTANCE_DEFAULT
 0

	)

516 
	#ZEBRA_STATIC_DISTANCE_DEFAULT
 1

	)

517 
	#ZEBRA_RIP_DISTANCE_DEFAULT
 120

	)

518 
	#ZEBRA_RIPNG_DISTANCE_DEFAULT
 120

	)

519 
	#ZEBRA_OSPF_DISTANCE_DEFAULT
 110

	)

520 
	#ZEBRA_OSPF6_DISTANCE_DEFAULT
 110

	)

521 
	#ZEBRA_ISIS_DISTANCE_DEFAULT
 115

	)

522 
	#ZEBRA_IBGP_DISTANCE_DEFAULT
 200

	)

523 
	#ZEBRA_EBGP_DISTANCE_DEFAULT
 20

	)

526 
	#CHECK_FLAG
(
V
,
F
Ë((VË& (F))

	)

527 
	#SET_FLAG
(
V
,
F
Ë(VË|(F)

	)

528 
	#UNSET_FLAG
(
V
,
F
Ë(VË&~(F)

	)

531 
u_öt16_t
 
	tafi_t
;

532 
u_öt8_t
 
	tßfi_t
;

535 
u_öt16_t
 
	tzebø_size_t
;

536 
u_öt16_t
 
	tzebø_comm™d_t
;

539 
	sfifo


541 
fifo
 *
√xt
;

542 
fifo
 *
¥ev
;

545 
	#FIFO_INIT
(
F
) \

547 
fifo
 *
Xfifo
 = (fifÿ*)(
F
); \

548 
Xfifo
->
√xt
 = Xfifo->
¥ev
 = Xfifo; \

549 
	}
} 0)

	)

551 
	#FIFO_ADD
(
F
,
N
) \

553 
fifo
 *
Xfifo
 = (fifÿ*)(
F
); \

554 
fifo
 *
Xnode
 = (fifÿ*)(
N
); \

555 
Xnode
->
√xt
 = 
Xfifo
; \

556 
Xnode
->
¥ev
 = 
Xfifo
->prev; \

557 
Xfifo
->
¥ev
 = Xfifo->¥ev->
√xt
 = 
Xnode
; \

558 } 0)

	)

560 
	#FIFO_DEL
(
N
) \

562 
fifo
 *
Xnode
 = (fifÿ*)(
N
); \

563 
Xnode
->
¥ev
->
√xt
 = Xnode->next; \

564 
Xnode
->
√xt
->
¥ev
 = Xnode->prev; \

565 } 0)

	)

567 
	#FIFO_HEAD
(
F
) \

568 ((((
fifo
 *)(
F
))->
√xt
 == (fifo *)(F)) \

569 ? 
NULL
 : (
F
)->
√xt
)

	)

571 
	#FIFO_EMPTY
(
F
) \

572 (((
fifo
 *)(
F
))->
√xt
 =(fifÿ*)(F))

	)

574 
	#FIFO_TOP
(
F
) \

575 (
	`FIFO_EMPTY
(
F
Ë? 
NULL
 : ((
fifo
 *)(F))->
√xt
)

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh.c

22 
	~<zebø.h
>

24 
	~<sys/un.h
>

25 
	~<£tjmp.h
>

26 
	~<sys/waô.h
>

27 
	~<sys/ªsour˚.h
>

28 
	~<sys/°©.h
>

30 
	~<ªadlöe/ªadlöe.h
>

31 
	~<ªadlöe/hi°‹y.h
>

33 
	~"comm™d.h
"

34 
	~"mem‹y.h
"

35 
	~"vtysh/vtysh.h
"

36 
	~"log.h
"

37 
	~"bgpd/bgp_vty.h
"

40 
vty
 *
	gvty
;

43 *
	gvtysh_∑gî_«me
 = 
NULL
;

46 
	svtysh_˛õ¡


48 
	mfd
;

49 c⁄° *
	m«me
;

50 
	mÊag
;

51 c⁄° *
	m∑th
;

52 } 
	gvtysh_˛õ¡
[] =

54 { .
fd
 = -1, .
	g«me
 = "zebø", .
	gÊag
 = 
VTYSH_ZEBRA
, .
	g∑th
 = 
ZEBRA_VTYSH_PATH
},

55 { .
	gfd
 = -1, .
	g«me
 = "rùd", .
	gÊag
 = 
VTYSH_RIPD
, .
	g∑th
 = 
RIP_VTYSH_PATH
},

56 { .
	gfd
 = -1, .
	g«me
 = "rùngd", .
	gÊag
 = 
VTYSH_RIPNGD
, .
	g∑th
 = 
RIPNG_VTYSH_PATH
},

57 { .
	gfd
 = -1, .
	g«me
 = "o•fd", .
	gÊag
 = 
VTYSH_OSPFD
, .
	g∑th
 = 
OSPF_VTYSH_PATH
},

58 { .
	gfd
 = -1, .
	g«me
 = "o•f6d", .
	gÊag
 = 
VTYSH_OSPF6D
, .
	g∑th
 = 
OSPF6_VTYSH_PATH
},

59 { .
	gfd
 = -1, .
	g«me
 = "bgpd", .
	gÊag
 = 
VTYSH_BGPD
, .
	g∑th
 = 
BGP_VTYSH_PATH
},

60 { .
	gfd
 = -1, .
	g«me
 = "isisd", .
	gÊag
 = 
VTYSH_ISISD
, .
	g∑th
 = 
ISIS_VTYSH_PATH
},

61 { .
	gfd
 = -1, .
	g«me
 = "babñd", .
	gÊag
 = 
VTYSH_BABELD
, .
	g∑th
 = 
BABEL_VTYSH_PATH
},

66 
vtysh_˛õ¡
 *
	grùd_˛õ¡
 = 
NULL
;

70 
	gvtysh_wrôec⁄fig_öãgøãd
 = 0;

72 
c⁄fig_deÁu…
[];

75 
	$v˛õ¡_˛o£
 (
vtysh_˛õ¡
 *
v˛õ¡
)

77 i‡(
v˛õ¡
->
fd
 >= 0)

79 
	`Ârötf
(
°dîr
,

81 
v˛õ¡
->
«me
);

82 
	`˛o£
 (
v˛õ¡
->
fd
);

83 
v˛õ¡
->
fd
 = -1;

85 
	}
}

89 
	#ERR_WHERE_STRING
 "vtysh(): vtysh_˛õ¡_c⁄fig(): "

	)

91 
	$vtysh_˛õ¡_c⁄fig
 (
vtysh_˛õ¡
 *
v˛õ¡
, *
löe
)

93 
ªt
;

94 *
buf
;

95 
size_t
 
bufsz
;

96 *
pbuf
;

97 
size_t
 
À·
;

98 *
eﬁn
;

99 
nbyãs
;

100 
i
;

101 
ªad 
;

103 i‡(
v˛õ¡
->
fd
 < 0)

104  
CMD_SUCCESS
;

106 
ªt
 = 
	`wrôe
 (
v˛õ¡
->
fd
, 
löe
, 
	`°æí
 (line) + 1);

107 i‡(
ªt
 <= 0)

109 
	`v˛õ¡_˛o£
 (
v˛õ¡
);

110  
CMD_SUCCESS
;

114 
bufsz
 = 5 * 
	`gë∑gesize
() + 1;

115 
buf
 = 
	`XMALLOC
(
MTYPE_TMP
, 
bufsz
);

116 
	`mem£t
(
buf
, 0, 
bufsz
);

117 
pbuf
 = 
buf
;

121 i‡(
pbuf
 >((
buf
 + 
bufsz
) -1))

123 
	`Ârötf
 (
°dîr
, 
ERR_WHERE_STRING
 \

125  
CMD_WARNING
;

128 
ªad 
 = (
buf
 + 
bufsz
Ë- 
pbuf
 - 1;

129 
nbyãs
 = 
	`ªad
 (
v˛õ¡
->
fd
, 
pbuf
, 
ªad 
);

131 i‡(
nbyãs
 <= 0)

134 i‡(
î∫o
 =
EINTR
)

137 
	`Ârötf
(
°dîr
, 
ERR_WHERE_STRING
 "(%u)", 
î∫o
);

138 
	`≥º‹
("");

140 i‡(
î∫o
 =
EAGAIN
 ||Éºnÿ=
EIO
)

143 
	`v˛õ¡_˛o£
 (
v˛õ¡
);

144 
	`XFREE
(
MTYPE_TMP
, 
buf
);

145  
CMD_SUCCESS
;

148 
pbuf
[
nbyãs
] = '\0';

150 i‡(
nbyãs
 >= 4)

152 
i
 = 
nbyãs
 - 4;

153 i‡(
pbuf
[
i
] == '\0' &&Öbuf[i + 1] == '\0' &&Öbuf[i + 2] == '\0')

155 
ªt
 = 
pbuf
[
i
 + 3];

159 
pbuf
 +
nbyãs
;

163 i‡((
eﬁn
 = 
	`°ºchr
(
buf
, '\n')Ë=
NULL
)

166 i‡(
eﬁn
 >((
buf
 + 
bufsz
) - 1))

168 
	`Ârötf
 (
°dîr
, 
ERR_WHERE_STRING
 \

171 
	`vtysh_c⁄fig_∑r£
(
buf
);

173 
eﬁn
++;

174 
À·
 = (
size_t
)(
buf
 + 
bufsz
 - 
eﬁn
);

175 
	`memmove
(
buf
, 
eﬁn
, 
À·
);

176 
buf
[
bufsz
-1] = '\0';

177 
pbuf
 = 
buf
 + 
	`°æí
(buf);

182 
	`vtysh_c⁄fig_∑r£
 (
buf
);

184 
	`XFREE
(
MTYPE_TMP
, 
buf
);

185  
ªt
;

186 
	}
}

189 
	$vtysh_˛õ¡_execuã
 (
vtysh_˛õ¡
 *
v˛õ¡
, c⁄° *
löe
, 
FILE
 *
Â
)

191 
ªt
;

192 
buf
[1001];

193 
nbyãs
;

194 
i
;

195 
numnuŒs
 = 0;

197 i‡(
v˛õ¡
->
fd
 < 0)

198  
CMD_SUCCESS
;

200 
ªt
 = 
	`wrôe
 (
v˛õ¡
->
fd
, 
löe
, 
	`°æí
 (line) + 1);

201 i‡(
ªt
 <= 0)

203 
	`v˛õ¡_˛o£
 (
v˛õ¡
);

204  
CMD_SUCCESS
;

209 
nbyãs
 = 
	`ªad
 (
v˛õ¡
->
fd
, 
buf
, (buf)-1);

211 i‡(
nbyãs
 <0 && 
î∫o
 !
EINTR
)

213 
	`v˛õ¡_˛o£
 (
v˛õ¡
);

214  
CMD_SUCCESS
;

217 i‡(
nbyãs
 > 0)

219 i‡((
numnuŒs
 =3Ë&& (
nbyãs
 == 1))

220  
buf
[0];

222 
buf
[
nbyãs
] = '\0';

223 
	`Âuts
 (
buf
, 
Â
);

224 
	`fÊush
 (
Â
);

230 i‡(
nbyãs
 >= 4)

232 
i
 = 
nbyãs
-4;

233 
numnuŒs
 = 0;

236 
i
 = 0;

238 
i
 < 
nbyãs
 && 
numnuŒs
 < 3)

240 i‡(
buf
[
i
++] == '\0')

241 
numnuŒs
++;

243 
numnuŒs
 = 0;

247 i‡((
numnuŒs
 >3Ë&& (
i
 < 
nbyãs
))

248  (
buf
[
nbyãs
-1]);

251 
	}
}

254 
	$vtysh_exô_rùd_⁄ly
 ()

256 i‡(
rùd_˛õ¡
)

257 
	`vtysh_˛õ¡_execuã
 (
rùd_˛õ¡
, "exô", 
°dout
);

258 
	}
}

262 
	$vtysh_∑gî_öô
 ()

264 *
∑gî_deföed
;

266 
∑gî_deföed
 = 
	`gëív
 ("VTYSH_PAGER");

268 i‡(
∑gî_deföed
)

269 
vtysh_∑gî_«me
 = 
	`°rdup
 (
∑gî_deföed
);

271 
vtysh_∑gî_«me
 = 
	`°rdup
 ("more");

272 
	}
}

276 
	$vtysh_execuã_func
 (c⁄° *
löe
, 
∑gî
)

278 
ªt
, 
cmd_°©
;

279 
u_öt
 
i
;

280 
ve˘‹
 
vlöe
;

281 
cmd_ñemít
 *
cmd
;

282 
FILE
 *
Â
 = 
NULL
;

283 
˛o£∑gî
 = 0;

284 
åõd
 = 0;

285 
ßved_ªt
, 
ßved_node
;

288 
vlöe
 = 
	`cmd_make_°rvec
 (
löe
);

290 i‡(
vlöe
 =
NULL
)

291  
CMD_SUCCESS
;

293 
ßved_ªt
 = 
ªt
 = 
	`cmd_execuã_comm™d
 (
vlöe
, 
vty
, &
cmd
, 1);

294 
ßved_node
 = 
vty
->
node
;

299 
ªt
 !
CMD_SUCCESS
 &&Ñë !
CMD_SUCCESS_DAEMON
 &&Ñë !
CMD_WARNING


300 && 
vty
->
node
 > 
CONFIG_NODE
)

302 
vty
->
node
 = 
	`node_∑ª¡
(vty->node);

303 
ªt
 = 
	`cmd_execuã_comm™d
 (
vlöe
, 
vty
, &
cmd
, 1);

304 
åõd
++;

307 
vty
->
node
 = 
ßved_node
;

311 i‡(
ªt
 =
CMD_SUCCESS
 ||Ñë =
CMD_SUCCESS_DAEMON
 ||Ñë =
CMD_WARNING
)

313 i‡((
ßved_node
 =
BGP_VPNV4_NODE
 || saved_nodê=
BGP_IPV4_NODE


314 || 
ßved_node
 =
BGP_IPV6_NODE
 || saved_nodê=
BGP_IPV4M_NODE


315 || 
ßved_node
 =
BGP_IPV6M_NODE
)

316 && (
åõd
 == 1))

318 
	`vtysh_execuã
("exit-address-family");

320 i‡((
ßved_node
 =
KEYCHAIN_KEY_NODE
Ë&& (
åõd
 == 1))

322 
	`vtysh_execuã
("exit");

324 i‡(
åõd
)

326 
	`vtysh_execuã
 ("end");

327 
	`vtysh_execuã
 ("configureÅerminal");

332 i‡(
åõd
)

334 
ªt
 = 
ßved_ªt
;

337 
	`cmd_‰ì_°rvec
 (
vlöe
);

339 
cmd_°©
 = 
ªt
;

340 
ªt
)

342 
CMD_WARNING
:

343 i‡(
vty
->
ty≥
 =
VTY_FILE
)

344 
	`Ârötf
 (
°dout
,"Warning...\n");

346 
CMD_ERR_AMBIGUOUS
:

347 
	`Ârötf
 (
°dout
,"%% Ambiguous command.\n");

349 
CMD_ERR_NO_MATCH
:

350 
	`Ârötf
 (
°dout
,"%% Unknown command.\n");

352 
CMD_ERR_INCOMPLETE
:

353 
	`Ârötf
 (
°dout
,"%% Command incomplete.\n");

355 
CMD_SUCCESS_DAEMON
:

360 i‡(
∑gî
 && 
vtysh_∑gî_«me
 && (
	`°∫cmp
(
löe
, "exit", 4) != 0))

362 
Â
 = 
	`p›í
 (
vtysh_∑gî_«me
, "w");

363 i‡(
Â
 =
NULL
)

365 
	`≥º‹
 ("popen failed forÖager");

366 
Â
 = 
°dout
;

369 
˛o£∑gî
=1;

372 
Â
 = 
°dout
;

374 i‡(! 
	`°rcmp
(
cmd
->
°rög
,"configureÅerminal"))

376 
i
 = 0; i < 
	`¨øy_size
(
vtysh_˛õ¡
); i++)

378 
cmd_°©
 = 
	`vtysh_˛õ¡_execuã
(&
vtysh_˛õ¡
[
i
], 
löe
, 
Â
);

379 i‡(
cmd_°©
 =
CMD_WARNING
)

383 i‡(
cmd_°©
)

385 
löe
 = "end";

386 
vlöe
 = 
	`cmd_make_°rvec
 (
löe
);

388 i‡(
vlöe
 =
NULL
)

390 i‡(
∑gî
 && 
vtysh_∑gî_«me
 && 
Â
 && 
˛o£∑gî
)

392 i‡(
	`p˛o£
 (
Â
) == -1)

394 
	`≥º‹
 ("pclose failed forÖager");

396 
Â
 = 
NULL
;

398  
CMD_SUCCESS
;

401 
ªt
 = 
	`cmd_execuã_comm™d
 (
vlöe
, 
vty
, &
cmd
, 1);

402 
	`cmd_‰ì_°rvec
 (
vlöe
);

403 i‡(
ªt
 !
CMD_SUCCESS_DAEMON
)

407 i‡(
cmd
->
func
)

409 (*
cmd
->
func
Ë(cmd, 
vty
, 0, 
NULL
);

414 
cmd_°©
 = 
CMD_SUCCESS
;

415 
i
 = 0; i < 
	`¨øy_size
(
vtysh_˛õ¡
); i++)

417 i‡(
cmd
->
d´m⁄
 & 
vtysh_˛õ¡
[
i
].
Êag
)

419 
cmd_°©
 = 
	`vtysh_˛õ¡_execuã
(&
vtysh_˛õ¡
[
i
], 
löe
, 
Â
);

420 i‡(
cmd_°©
 !
CMD_SUCCESS
)

424 i‡(
cmd_°©
 !
CMD_SUCCESS
)

427 i‡(
cmd
->
func
)

428 (*
cmd
->
func
Ë(cmd, 
vty
, 0, 
NULL
);

431 i‡(
∑gî
 && 
vtysh_∑gî_«me
 && 
Â
 && 
˛o£∑gî
)

433 i‡(
	`p˛o£
 (
Â
) == -1)

435 
	`≥º‹
 ("pclose failed forÖager");

437 
Â
 = 
NULL
;

439  
cmd_°©
;

440 
	}
}

443 
	$vtysh_execuã_no_∑gî
 (c⁄° *
löe
)

445  
	`vtysh_execuã_func
 (
löe
, 0);

446 
	}
}

449 
	$vtysh_execuã
 (c⁄° *
löe
)

451  
	`vtysh_execuã_func
 (
löe
, 1);

452 
	}
}

456 
	$vtysh_c⁄fig_‰om_fûe
 (
vty
 *vty, 
FILE
 *
Â
)

458 
ªt
;

459 
ve˘‹
 
vlöe
;

460 
cmd_ñemít
 *
cmd
;

462 
	`fgës
 (
vty
->
buf
, 
VTY_BUFSIZ
, 
Â
))

464 i‡(
vty
->
buf
[0] == '!' || vty->buf[1] == '#')

467 
vlöe
 = 
	`cmd_make_°rvec
 (
vty
->
buf
);

470 i‡(
vlöe
 =
NULL
)

474 
ªt
 = 
	`cmd_execuã_comm™d_°ri˘
 (
vlöe
, 
vty
, &
cmd
);

477 i‡(
ªt
 !
CMD_SUCCESS


478 && 
ªt
 !
CMD_SUCCESS_DAEMON


479 && 
ªt
 !
CMD_WARNING
)

481 i‡(
vty
->
node
 =
KEYCHAIN_KEY_NODE
)

483 
vty
->
node
 = 
KEYCHAIN_NODE
;

484 
	`vtysh_exô_rùd_⁄ly
 ();

485 
ªt
 = 
	`cmd_execuã_comm™d_°ri˘
 (
vlöe
, 
vty
, &
cmd
);

487 i‡(
ªt
 !
CMD_SUCCESS


488 && 
ªt
 !
CMD_SUCCESS_DAEMON


489 && 
ªt
 !
CMD_WARNING
)

491 
	`vtysh_exô_rùd_⁄ly
 ();

492 
vty
->
node
 = 
CONFIG_NODE
;

493 
ªt
 = 
	`cmd_execuã_comm™d_°ri˘
 (
vlöe
, 
vty
, &
cmd
);

498 
	`vtysh_execuã
 ("end");

499 
	`vtysh_execuã
 ("configureÅerminal");

500 
vty
->
node
 = 
CONFIG_NODE
;

501 
ªt
 = 
	`cmd_execuã_comm™d_°ri˘
 (
vlöe
, 
vty
, &
cmd
);

505 
	`cmd_‰ì_°rvec
 (
vlöe
);

507 
ªt
)

509 
CMD_WARNING
:

510 i‡(
vty
->
ty≥
 =
VTY_FILE
)

511 
	`Ârötf
 (
°dout
,"Warning...\n");

513 
CMD_ERR_AMBIGUOUS
:

514 
	`Ârötf
 (
°dout
,"%% Ambiguous command.\n");

516 
CMD_ERR_NO_MATCH
:

517 
	`Ârötf
 (
°dout
,"%% Unknow¿comm™d: %s", 
vty
->
buf
);

519 
CMD_ERR_INCOMPLETE
:

520 
	`Ârötf
 (
°dout
,"%% Command incomplete.\n");

522 
CMD_SUCCESS_DAEMON
:

524 
u_öt
 
i
;

525 
cmd_°©
 = 
CMD_SUCCESS
;

527 
i
 = 0; i < 
	`¨øy_size
(
vtysh_˛õ¡
); i++)

529 i‡(
cmd
->
d´m⁄
 & 
vtysh_˛õ¡
[
i
].
Êag
)

531 
cmd_°©
 = 
	`vtysh_˛õ¡_execuã
 (&
vtysh_˛õ¡
[
i
],

532 
vty
->
buf
, 
°dout
);

533 i‡(
cmd_°©
 !
CMD_SUCCESS
)

537 i‡(
cmd_°©
 !
CMD_SUCCESS
)

540 i‡(
cmd
->
func
)

541 (*
cmd
->
func
Ë(cmd, 
vty
, 0, 
NULL
);

545  
CMD_SUCCESS
;

546 
	}
}

550 
	$vtysh_æ_des¸ibe
 ()

552 
ªt
;

553 
i
;

554 
ve˘‹
 
vlöe
;

555 
ve˘‹
 
des¸ibe
;

556 
width
;

557 
desc
 *desc;

559 
vlöe
 = 
	`cmd_make_°rvec
 (
æ_löe_buf„r
);

562 i‡(
vlöe
 =
NULL
)

564 
vlöe
 = 
	`ve˘‹_öô
 (1);

565 
	`ve˘‹_£t
 (
vlöe
, '\0');

568 i‡(
æ_íd
 && 
	`is•a˚
 ((Ë
æ_löe_buf„r
[rl_end - 1]))

569 
	`ve˘‹_£t
 (
vlöe
, '\0');

571 
des¸ibe
 = 
	`cmd_des¸ibe_comm™d
 (
vlöe
, 
vty
, &
ªt
);

573 
	`Ârötf
 (
°dout
,"\n");

576 
ªt
)

578 
CMD_ERR_AMBIGUOUS
:

579 
	`cmd_‰ì_°rvec
 (
vlöe
);

580 
	`Ârötf
 (
°dout
,"%% Ambiguous command.\n");

581 
	`æ_⁄_√w_löe
 ();

584 
CMD_ERR_NO_MATCH
:

585 
	`cmd_‰ì_°rvec
 (
vlöe
);

586 
	`Ârötf
 (
°dout
,"%% There isÇo matched command.\n");

587 
	`æ_⁄_√w_löe
 ();

593 
width
 = 0;

594 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
des¸ibe
); i++)

595 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
des¸ibe
, 
i
)Ë!
NULL
)

597 
Àn
;

599 i‡(
desc
->
cmd
[0] == '\0')

602 
Àn
 = 
	`°æí
 (
desc
->
cmd
);

603 i‡(
desc
->
cmd
[0] == '.')

604 
Àn
--;

606 i‡(
width
 < 
Àn
)

607 
width
 = 
Àn
;

610 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
des¸ibe
); i++)

611 i‡((
desc
 = 
	`ve˘‹_¶Ÿ
 (
des¸ibe
, 
i
)Ë!
NULL
)

613 i‡(
desc
->
cmd
[0] == '\0')

616 i‡(! 
desc
->
°r
)

617 
	`Ârötf
 (
°dout
," %-s\n",

618 
desc
->
cmd
[0] == '.' ? desc->cmd + 1 : desc->cmd);

620 
	`Ârötf
 (
°dout
," %-*s %s\n",

621 
width
,

622 
desc
->
cmd
[0] == '.' ? desc->cmd + 1 : desc->cmd,

623 
desc
->
°r
);

626 
	`cmd_‰ì_°rvec
 (
vlöe
);

627 
	`ve˘‹_‰ì
 (
des¸ibe
);

629 
	`æ_⁄_√w_löe
();

632 
	}
}

637 
	gcom∂ëe_°©us
;

640 
	$comm™d_gíî©‹
 (c⁄° *
ãxt
, 
°©e
)

642 
ve˘‹
 
vlöe
;

643 **
m©ched
 = 
NULL
;

644 
ödex
 = 0;

647 i‡(! 
°©e
)

649 
ödex
 = 0;

651 i‡(
vty
->
node
 =
AUTH_NODE
 || vty->nodê=
AUTH_ENABLE_NODE
)

652  
NULL
;

654 
vlöe
 = 
	`cmd_make_°rvec
 (
æ_löe_buf„r
);

655 i‡(
vlöe
 =
NULL
)

656  
NULL
;

658 i‡(
æ_íd
 && 
	`is•a˚
 ((Ë
æ_löe_buf„r
[rl_end - 1]))

659 
	`ve˘‹_£t
 (
vlöe
, '\0');

661 
m©ched
 = 
	`cmd_com∂ëe_comm™d
 (
vlöe
, 
vty
, &
com∂ëe_°©us
);

664 i‡(
m©ched
 && m©ched[
ödex
])

665  
m©ched
[
ödex
++];

667  
NULL
;

668 
	}
}

671 
	$√w_com∂ëi⁄
 (*
ãxt
, 
°¨t
, 
íd
)

673 **
m©ches
;

675 
m©ches
 = 
	`æ_com∂ëi⁄_m©ches
 (
ãxt
, 
comm™d_gíî©‹
);

677 i‡(
m©ches
)

679 
æ_poöt
 = 
æ_íd
;

680 i‡(
com∂ëe_°©us
 =
CMD_COMPLETE_FULL_MATCH
)

681 
æ_≥ndög_öput
 = ' ';

684  
m©ches
;

685 
	}
}

690 
	$vtysh_com∂ëi⁄
 (*
ãxt
, 
°¨t
, 
íd
)

692 
ªt
;

693 
ve˘‹
 
vlöe
;

694 **
m©ched
 = 
NULL
;

696 i‡(
vty
->
node
 =
AUTH_NODE
 || vty->nodê=
AUTH_ENABLE_NODE
)

697  
NULL
;

699 
vlöe
 = 
	`cmd_make_°rvec
 (
æ_löe_buf„r
);

700 i‡(
vlöe
 =
NULL
)

701  
NULL
;

704 i‡(
æ_íd
 && 
	`is•a˚
 ((Ë
æ_löe_buf„r
[rl_end - 1]))

705 
	`ve˘‹_£t
 (
vlöe
, '\0');

707 
m©ched
 = 
	`cmd_com∂ëe_comm™d
 (
vlöe
, 
vty
, &
ªt
);

709 
	`cmd_‰ì_°rvec
 (
vlöe
);

711  (**Ë
m©ched
;

712 
	}
}

716 
cmd_node
 
	gbgp_node
 =

718 
BGP_NODE
,

722 
cmd_node
 
	grù_node
 =

724 
RIP_NODE
,

728 
cmd_node
 
	gisis_node
 =

730 
ISIS_NODE
,

734 
cmd_node
 
	göãrÁ˚_node
 =

736 
INTERFACE_NODE
,

740 
cmd_node
 
	grm≠_node
 =

742 
RMAP_NODE
,

746 
cmd_node
 
	gzebø_node
 =

748 
ZEBRA_NODE
,

752 
cmd_node
 
	gbgp_v≤v4_node
 =

754 
BGP_VPNV4_NODE
,

758 
cmd_node
 
	gbgp_ùv4_node
 =

760 
BGP_IPV4_NODE
,

764 
cmd_node
 
	gbgp_ùv4m_node
 =

766 
BGP_IPV4M_NODE
,

770 
cmd_node
 
	gbgp_ùv6_node
 =

772 
BGP_IPV6_NODE
,

776 
cmd_node
 
	gbgp_ùv6m_node
 =

778 
BGP_IPV6M_NODE
,

782 
cmd_node
 
	go•f_node
 =

784 
OSPF_NODE
,

788 
cmd_node
 
	grùng_node
 =

790 
RIPNG_NODE
,

794 
cmd_node
 
	go•f6_node
 =

796 
OSPF6_NODE
,

800 
cmd_node
 
	gbabñ_node
 =

802 
BABEL_NODE
,

806 
cmd_node
 
	gkeychaö_node
 =

808 
KEYCHAIN_NODE
,

812 
cmd_node
 
	gkeychaö_key_node
 =

814 
KEYCHAIN_KEY_NODE
,

819 
cmd_node
 
vty_node
;

823 
	$vtysh_íd
 ()

825 
vty
->
node
)

827 
VIEW_NODE
:

828 
ENABLE_NODE
:

832 
vty
->
node
 = 
ENABLE_NODE
;

835  
CMD_SUCCESS
;

836 
	}
}

838 
DEFUNSH
 (
VTYSH_ALL
,

839 
vtysh_íd_Æl
,

840 
vtysh_íd_Æl_cmd
,

844  
vtysh_íd
 ();

847 
DEFUNSH
 (
VTYSH_BGPD
,

848 
rouãr_bgp
,

849 
rouãr_bgp_cmd
,

850 "rouã∏bg∞" 
CMD_AS_RANGE
,

851 
ROUTER_STR


852 
BGP_STR


853 
AS_STR
)

855 
	gvty
->
	gnode
 = 
BGP_NODE
;

856  
	gCMD_SUCCESS
;

859 
ALIAS_SH
 (
VTYSH_BGPD
,

860 
rouãr_bgp
,

861 
rouãr_bgp_võw_cmd
,

862 "rouã∏bg∞" 
CMD_AS_RANGE
 " view WORD",

863 
ROUTER_STR


864 
BGP_STR


865 
AS_STR


869 
DEFUNSH
 (
VTYSH_BGPD
,

870 
addªss_Ámûy_v≤v4
,

871 
addªss_Ámûy_v≤v4_cmd
,

876 
	gvty
->
	gnode
 = 
BGP_VPNV4_NODE
;

877  
	gCMD_SUCCESS
;

880 
DEFUNSH
 (
VTYSH_BGPD
,

881 
addªss_Ámûy_v≤v4_uniˇ°
,

882 
addªss_Ámûy_v≤v4_uniˇ°_cmd
,

888 
	gvty
->
	gnode
 = 
BGP_VPNV4_NODE
;

889  
	gCMD_SUCCESS
;

892 
DEFUNSH
 (
VTYSH_BGPD
,

893 
addªss_Ámûy_ùv4_uniˇ°
,

894 
addªss_Ámûy_ùv4_uniˇ°_cmd
,

900 
	gvty
->
	gnode
 = 
BGP_IPV4_NODE
;

901  
	gCMD_SUCCESS
;

904 
DEFUNSH
 (
VTYSH_BGPD
,

905 
addªss_Ámûy_ùv4_mu…iˇ°
,

906 
addªss_Ámûy_ùv4_mu…iˇ°_cmd
,

912 
	gvty
->
	gnode
 = 
BGP_IPV4M_NODE
;

913  
	gCMD_SUCCESS
;

916 
DEFUNSH
 (
VTYSH_BGPD
,

917 
addªss_Ámûy_ùv6
,

918 
addªss_Ámûy_ùv6_cmd
,

923 
	gvty
->
	gnode
 = 
BGP_IPV6_NODE
;

924  
	gCMD_SUCCESS
;

927 
DEFUNSH
 (
VTYSH_BGPD
,

928 
addªss_Ámûy_ùv6_uniˇ°
,

929 
addªss_Ámûy_ùv6_uniˇ°_cmd
,

935 
	gvty
->
	gnode
 = 
BGP_IPV6_NODE
;

936  
	gCMD_SUCCESS
;

939 
DEFUNSH
 (
VTYSH_BGPD
,

940 
addªss_Ámûy_ùv6_mu…iˇ°
,

941 
addªss_Ámûy_ùv6_mu…iˇ°_cmd
,

947 
	gvty
->
	gnode
 = 
BGP_IPV6M_NODE
;

948  
	gCMD_SUCCESS
;

951 
DEFUNSH
 (
VTYSH_RIPD
,

952 
key_chaö
,

953 
key_chaö_cmd
,

959 
	gvty
->
	gnode
 = 
KEYCHAIN_NODE
;

960  
	gCMD_SUCCESS
;

963 
DEFUNSH
 (
VTYSH_RIPD
,

964 
key
,

965 
key_cmd
,

970 
	gvty
->
	gnode
 = 
KEYCHAIN_KEY_NODE
;

971  
	gCMD_SUCCESS
;

974 
DEFUNSH
 (
VTYSH_RIPD
,

975 
rouãr_rù
,

976 
rouãr_rù_cmd
,

978 
ROUTER_STR


981 
	gvty
->
	gnode
 = 
RIP_NODE
;

982  
	gCMD_SUCCESS
;

985 
DEFUNSH
 (
VTYSH_RIPNGD
,

986 
rouãr_rùng
,

987 
rouãr_rùng_cmd
,

989 
ROUTER_STR


992 
	gvty
->
	gnode
 = 
RIPNG_NODE
;

993  
	gCMD_SUCCESS
;

996 
DEFUNSH
 (
VTYSH_OSPFD
,

997 
rouãr_o•f
,

998 
rouãr_o•f_cmd
,

1003 
	gvty
->
	gnode
 = 
OSPF_NODE
;

1004  
	gCMD_SUCCESS
;

1007 
DEFUNSH
 (
VTYSH_OSPF6D
,

1008 
rouãr_o•f6
,

1009 
rouãr_o•f6_cmd
,

1011 
OSPF6_ROUTER_STR


1012 
OSPF6_STR
)

1014 
	gvty
->
	gnode
 = 
OSPF6_NODE
;

1015  
	gCMD_SUCCESS
;

1018 
DEFUNSH
 (
VTYSH_BABELD
,

1019 
rouãr_babñ
,

1020 
rouãr_babñ_cmd
,

1022 
ROUTER_STR


1025 
	gvty
->
	gnode
 = 
BABEL_NODE
;

1026  
	gCMD_SUCCESS
;

1029 
DEFUNSH
 (
VTYSH_ISISD
,

1030 
rouãr_isis
,

1031 
rouãr_isis_cmd
,

1033 
ROUTER_STR


1037 
	gvty
->
	gnode
 = 
ISIS_NODE
;

1038  
	gCMD_SUCCESS
;

1041 
DEFUNSH
 (
VTYSH_RMAP
,

1042 
rouã_m≠
,

1043 
rouã_m≠_cmd
,

1051 
	gvty
->
	gnode
 = 
RMAP_NODE
;

1052  
	gCMD_SUCCESS
;

1055 
DEFUNSH
 (
VTYSH_ALL
,

1056 
vtysh_löe_vty
,

1057 
vtysh_löe_vty_cmd
,

1062 
	gvty
->
	gnode
 = 
VTY_NODE
;

1063  
	gCMD_SUCCESS
;

1066 
DEFUNSH
 (
VTYSH_ALL
,

1067 
vtysh_íabÀ
,

1068 
vtysh_íabÀ_cmd
,

1072 
	gvty
->
	gnode
 = 
ENABLE_NODE
;

1073  
	gCMD_SUCCESS
;

1076 
DEFUNSH
 (
VTYSH_ALL
,

1077 
vtysh_dißbÀ
,

1078 
vtysh_dißbÀ_cmd
,

1082 i‡(
	gvty
->
	gnode
 =
ENABLE_NODE
)

1083 
vty
->
node
 = 
VIEW_NODE
;

1084  
	gCMD_SUCCESS
;

1087 
DEFUNSH
 (
VTYSH_ALL
,

1088 
vtysh_c⁄fig_ãrmöÆ
,

1089 
vtysh_c⁄fig_ãrmöÆ_cmd
,

1094 
	gvty
->
	gnode
 = 
CONFIG_NODE
;

1095  
	gCMD_SUCCESS
;

1099 
	$vtysh_exô
 (
vty
 *vty)

1101 
vty
->
node
)

1103 
VIEW_NODE
:

1104 
ENABLE_NODE
:

1105 
	`exô
 (0);

1107 
CONFIG_NODE
:

1108 
vty
->
node
 = 
ENABLE_NODE
;

1110 
INTERFACE_NODE
:

1111 
ZEBRA_NODE
:

1112 
BGP_NODE
:

1113 
RIP_NODE
:

1114 
RIPNG_NODE
:

1115 
OSPF_NODE
:

1116 
OSPF6_NODE
:

1117 
BABEL_NODE
:

1118 
ISIS_NODE
:

1119 
MASC_NODE
:

1120 
RMAP_NODE
:

1121 
VTY_NODE
:

1122 
KEYCHAIN_NODE
:

1123 
	`vtysh_execuã
("end");

1124 
	`vtysh_execuã
("configureÅerminal");

1125 
vty
->
node
 = 
CONFIG_NODE
;

1127 
BGP_VPNV4_NODE
:

1128 
BGP_IPV4_NODE
:

1129 
BGP_IPV4M_NODE
:

1130 
BGP_IPV6_NODE
:

1131 
BGP_IPV6M_NODE
:

1132 
vty
->
node
 = 
BGP_NODE
;

1134 
KEYCHAIN_KEY_NODE
:

1135 
vty
->
node
 = 
KEYCHAIN_NODE
;

1140  
CMD_SUCCESS
;

1141 
	}
}

1143 
DEFUNSH
 (
VTYSH_ALL
,

1144 
vtysh_exô_Æl
,

1145 
vtysh_exô_Æl_cmd
,

1149  
vtysh_exô
 (
vty
);

1152 
ALIAS
 (
vtysh_exô_Æl
,

1153 
vtysh_quô_Æl_cmd
,

1157 
DEFUNSH
 (
VTYSH_BGPD
,

1158 
exô_addªss_Ámûy
,

1159 
exô_addªss_Ámûy_cmd
,

1163 i‡(
	gvty
->
	gnode
 =
BGP_IPV4_NODE


1164 || 
vty
->
node
 =
BGP_IPV4M_NODE


1165 || 
vty
->
node
 =
BGP_VPNV4_NODE


1166 || 
vty
->
node
 =
BGP_IPV6_NODE


1167 || 
vty
->
node
 =
BGP_IPV6M_NODE
)

1168 
vty
->
node
 = 
BGP_NODE
;

1169  
	gCMD_SUCCESS
;

1172 
DEFUNSH
 (
VTYSH_ZEBRA
,

1173 
vtysh_exô_zebø
,

1174 
vtysh_exô_zebø_cmd
,

1178  
vtysh_exô
 (
vty
);

1181 
ALIAS
 (
vtysh_exô_zebø
,

1182 
vtysh_quô_zebø_cmd
,

1186 
DEFUNSH
 (
VTYSH_RIPD
,

1187 
vtysh_exô_rùd
,

1188 
vtysh_exô_rùd_cmd
,

1192  
vtysh_exô
 (
vty
);

1195 
ALIAS
 (
vtysh_exô_rùd
,

1196 
vtysh_quô_rùd_cmd
,

1200 
DEFUNSH
 (
VTYSH_RIPNGD
,

1201 
vtysh_exô_rùngd
,

1202 
vtysh_exô_rùngd_cmd
,

1206  
vtysh_exô
 (
vty
);

1209 
ALIAS
 (
vtysh_exô_rùngd
,

1210 
vtysh_quô_rùngd_cmd
,

1214 
DEFUNSH
 (
VTYSH_RMAP
,

1215 
vtysh_exô_rm≠
,

1216 
vtysh_exô_rm≠_cmd
,

1220  
vtysh_exô
 (
vty
);

1223 
ALIAS
 (
vtysh_exô_rm≠
,

1224 
vtysh_quô_rm≠_cmd
,

1228 
DEFUNSH
 (
VTYSH_BGPD
,

1229 
vtysh_exô_bgpd
,

1230 
vtysh_exô_bgpd_cmd
,

1234  
vtysh_exô
 (
vty
);

1237 
ALIAS
 (
vtysh_exô_bgpd
,

1238 
vtysh_quô_bgpd_cmd
,

1242 
DEFUNSH
 (
VTYSH_OSPFD
,

1243 
vtysh_exô_o•fd
,

1244 
vtysh_exô_o•fd_cmd
,

1248  
vtysh_exô
 (
vty
);

1251 
ALIAS
 (
vtysh_exô_o•fd
,

1252 
vtysh_quô_o•fd_cmd
,

1256 
DEFUNSH
 (
VTYSH_OSPF6D
,

1257 
vtysh_exô_o•f6d
,

1258 
vtysh_exô_o•f6d_cmd
,

1262  
vtysh_exô
 (
vty
);

1265 
ALIAS
 (
vtysh_exô_o•f6d
,

1266 
vtysh_quô_o•f6d_cmd
,

1270 
DEFUNSH
 (
VTYSH_ISISD
,

1271 
vtysh_exô_isisd
,

1272 
vtysh_exô_isisd_cmd
,

1276  
vtysh_exô
 (
vty
);

1279 
ALIAS
 (
vtysh_exô_isisd
,

1280 
vtysh_quô_isisd_cmd
,

1284 
DEFUNSH
 (
VTYSH_ALL
,

1285 
vtysh_exô_löe_vty
,

1286 
vtysh_exô_löe_vty_cmd
,

1290  
vtysh_exô
 (
vty
);

1293 
ALIAS
 (
vtysh_exô_löe_vty
,

1294 
vtysh_quô_löe_vty_cmd
,

1298 
DEFUNSH
 (
VTYSH_INTERFACE
,

1299 
vtysh_öãrÁ˚
,

1300 
vtysh_öãrÁ˚_cmd
,

1305 
	gvty
->
	gnode
 = 
INTERFACE_NODE
;

1306  
	gCMD_SUCCESS
;

1310 
DEFSH
 (
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_RIPNGD
|
VTYSH_OSPFD
|
VTYSH_OSPF6D
,

1311 
vtysh_no_öãrÁ˚_cmd
,

1313 
NO_STR


1319 
DEFSH
 (
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_OSPFD
,

1320 
öãrÁ˚_desc_cmd
,

1325 
DEFSH
 (
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_OSPFD
,

1326 
no_öãrÁ˚_desc_cmd
,

1328 
NO_STR


1331 
DEFUNSH
 (
VTYSH_INTERFACE
,

1332 
vtysh_exô_öãrÁ˚
,

1333 
vtysh_exô_öãrÁ˚_cmd
,

1337  
vtysh_exô
 (
vty
);

1340 
ALIAS
 (
vtysh_exô_öãrÁ˚
,

1341 
vtysh_quô_öãrÁ˚_cmd
,

1346 
DEFUN
 (
vtysh_show_mem‹y
,

1347 
vtysh_show_mem‹y_cmd
,

1349 
SHOW_STR


1352 
	gi
;

1353 
	gªt
 = 
CMD_SUCCESS
;

1354 
	glöe
[] = "show memory\n";

1356 
	gi
 = 0; i < 
¨øy_size
(
vtysh_˛õ¡
); i++)

1357 i‡–
	gvtysh_˛õ¡
[
i
].
	gfd
 >= 0 )

1359 
Ârötf
 (
°dout
, "Memory statistics for %s:\n",

1360 
vtysh_˛õ¡
[
i
].
«me
);

1361 
	gªt
 = 
vtysh_˛õ¡_execuã
 (&
vtysh_˛õ¡
[
i
], 
löe
, 
°dout
);

1362 
Ârötf
 (
°dout
,"\n");

1365  
	gªt
;

1369 
DEFUN
 (
vtysh_show_loggög
,

1370 
vtysh_show_loggög_cmd
,

1372 
SHOW_STR


1375 
	gi
;

1376 
	gªt
 = 
CMD_SUCCESS
;

1377 
	glöe
[] = "showÜogging\n";

1379 
	gi
 = 0; i < 
¨øy_size
(
vtysh_˛õ¡
); i++)

1380 i‡–
	gvtysh_˛õ¡
[
i
].
	gfd
 >= 0 )

1382 
Ârötf
 (
°dout
,"Logging configuration for %s:\n",

1383 
vtysh_˛õ¡
[
i
].
«me
);

1384 
	gªt
 = 
vtysh_˛õ¡_execuã
 (&
vtysh_˛õ¡
[
i
], 
löe
, 
°dout
);

1385 
Ârötf
 (
°dout
,"\n");

1388  
	gªt
;

1391 
DEFUNSH
 (
VTYSH_ALL
,

1392 
vtysh_log_°dout
,

1393 
vtysh_log_°dout_cmd
,

1398  
	gCMD_SUCCESS
;

1401 
DEFUNSH
 (
VTYSH_ALL
,

1402 
vtysh_log_°dout_Àvñ
,

1403 
vtysh_log_°dout_Àvñ_cmd
,

1404 "log stdouà"
LOG_LEVELS
,

1407 
LOG_LEVEL_DESC
)

1409  
	gCMD_SUCCESS
;

1412 
DEFUNSH
 (
VTYSH_ALL
,

1413 
no_vtysh_log_°dout
,

1414 
no_vtysh_log_°dout_cmd
,

1416 
NO_STR


1421  
	gCMD_SUCCESS
;

1424 
DEFUNSH
 (
VTYSH_ALL
,

1425 
vtysh_log_fûe
,

1426 
vtysh_log_fûe_cmd
,

1432  
	gCMD_SUCCESS
;

1435 
DEFUNSH
 (
VTYSH_ALL
,

1436 
vtysh_log_fûe_Àvñ
,

1437 
vtysh_log_fûe_Àvñ_cmd
,

1438 "log fûêFILENAME "
LOG_LEVELS
,

1442 
LOG_LEVEL_DESC
)

1444  
	gCMD_SUCCESS
;

1447 
DEFUNSH
 (
VTYSH_ALL
,

1448 
no_vtysh_log_fûe
,

1449 
no_vtysh_log_fûe_cmd
,

1451 
NO_STR


1456  
	gCMD_SUCCESS
;

1459 
ALIAS_SH
 (
VTYSH_ALL
,

1460 
no_vtysh_log_fûe
,

1461 
no_vtysh_log_fûe_Àvñ_cmd
,

1463 
NO_STR


1469 
DEFUNSH
 (
VTYSH_ALL
,

1470 
vtysh_log_m⁄ô‹
,

1471 
vtysh_log_m⁄ô‹_cmd
,

1476  
	gCMD_SUCCESS
;

1479 
DEFUNSH
 (
VTYSH_ALL
,

1480 
vtysh_log_m⁄ô‹_Àvñ
,

1481 
vtysh_log_m⁄ô‹_Àvñ_cmd
,

1482 "log m⁄ô‹ "
LOG_LEVELS
,

1485 
LOG_LEVEL_DESC
)

1487  
	gCMD_SUCCESS
;

1490 
DEFUNSH
 (
VTYSH_ALL
,

1491 
no_vtysh_log_m⁄ô‹
,

1492 
no_vtysh_log_m⁄ô‹_cmd
,

1494 
NO_STR


1499  
	gCMD_SUCCESS
;

1502 
DEFUNSH
 (
VTYSH_ALL
,

1503 
vtysh_log_sy¶og
,

1504 
vtysh_log_sy¶og_cmd
,

1509  
	gCMD_SUCCESS
;

1512 
DEFUNSH
 (
VTYSH_ALL
,

1513 
vtysh_log_sy¶og_Àvñ
,

1514 
vtysh_log_sy¶og_Àvñ_cmd
,

1515 "log sy¶og "
LOG_LEVELS
,

1518 
LOG_LEVEL_DESC
)

1520  
	gCMD_SUCCESS
;

1523 
DEFUNSH
 (
VTYSH_ALL
,

1524 
no_vtysh_log_sy¶og
,

1525 
no_vtysh_log_sy¶og_cmd
,

1527 
NO_STR


1532  
	gCMD_SUCCESS
;

1535 
DEFUNSH
 (
VTYSH_ALL
,

1536 
vtysh_log_Ácûôy
,

1537 
vtysh_log_Ácûôy_cmd
,

1538 "log facûôy "
LOG_FACILITIES
,

1541 
LOG_FACILITY_DESC
)

1544  
	gCMD_SUCCESS
;

1547 
DEFUNSH
 (
VTYSH_ALL
,

1548 
no_vtysh_log_Ácûôy
,

1549 
no_vtysh_log_Ácûôy_cmd
,

1551 
NO_STR


1557  
	gCMD_SUCCESS
;

1560 
DEFUNSH_DEPRECATED
 (
VTYSH_ALL
,

1561 
vtysh_log_å≠
,

1562 
vtysh_log_å≠_cmd
,

1563 "logÅø∞"
LOG_LEVELS
,

1566 
LOG_LEVEL_DESC
)

1569  
	gCMD_SUCCESS
;

1572 
DEFUNSH_DEPRECATED
 (
VTYSH_ALL
,

1573 
no_vtysh_log_å≠
,

1574 
no_vtysh_log_å≠_cmd
,

1576 
NO_STR


1581  
	gCMD_SUCCESS
;

1584 
DEFUNSH
 (
VTYSH_ALL
,

1585 
vtysh_log_ªc‹d_¥i‹ôy
,

1586 
vtysh_log_ªc‹d_¥i‹ôy_cmd
,

1591  
	gCMD_SUCCESS
;

1594 
DEFUNSH
 (
VTYSH_ALL
,

1595 
no_vtysh_log_ªc‹d_¥i‹ôy
,

1596 
no_vtysh_log_ªc‹d_¥i‹ôy_cmd
,

1598 
NO_STR


1602  
	gCMD_SUCCESS
;

1605 
DEFUNSH
 (
VTYSH_ALL
,

1606 
vtysh_log_time°amp_¥ecisi⁄
,

1607 
vtysh_log_time°amp_¥ecisi⁄_cmd
,

1614  
	gCMD_SUCCESS
;

1617 
DEFUNSH
 (
VTYSH_ALL
,

1618 
no_vtysh_log_time°amp_¥ecisi⁄
,

1619 
no_vtysh_log_time°amp_¥ecisi⁄_cmd
,

1621 
NO_STR


1626  
	gCMD_SUCCESS
;

1629 
DEFUNSH
 (
VTYSH_ALL
,

1630 
vtysh_£rvi˚_∑ssw‹d_í¸y±
,

1631 
vtysh_£rvi˚_∑ssw‹d_í¸y±_cmd
,

1636  
	gCMD_SUCCESS
;

1639 
DEFUNSH
 (
VTYSH_ALL
,

1640 
no_vtysh_£rvi˚_∑ssw‹d_í¸y±
,

1641 
no_vtysh_£rvi˚_∑ssw‹d_í¸y±_cmd
,

1643 
NO_STR


1647  
	gCMD_SUCCESS
;

1650 
DEFUNSH
 (
VTYSH_ALL
,

1651 
vtysh_c⁄fig_∑ssw‹d
,

1652 
vtysh_∑ssw‹d_cmd
,

1659  
	gCMD_SUCCESS
;

1662 
DEFUNSH
 (
VTYSH_ALL
,

1663 
vtysh_∑ssw‹d_ãxt
,

1664 
vtysh_∑ssw‹d_ãxt_cmd
,

1669  
	gCMD_SUCCESS
;

1672 
DEFUNSH
 (
VTYSH_ALL
,

1673 
vtysh_c⁄fig_íabÀ_∑ssw‹d
,

1674 
vtysh_íabÀ_∑ssw‹d_cmd
,

1682  
	gCMD_SUCCESS
;

1685 
DEFUNSH
 (
VTYSH_ALL
,

1686 
vtysh_íabÀ_∑ssw‹d_ãxt
,

1687 
vtysh_íabÀ_∑ssw‹d_ãxt_cmd
,

1693  
	gCMD_SUCCESS
;

1696 
DEFUNSH
 (
VTYSH_ALL
,

1697 
no_vtysh_c⁄fig_íabÀ_∑ssw‹d
,

1698 
no_vtysh_íabÀ_∑ssw‹d_cmd
,

1700 
NO_STR


1704  
	gCMD_SUCCESS
;

1707 
DEFUN
 (
vtysh_wrôe_ãrmöÆ
,

1708 
vtysh_wrôe_ãrmöÆ_cmd
,

1713 
u_öt
 
	gi
;

1714 
	gªt
;

1715 
	glöe
[] = "writeÅerminal\n";

1716 
FILE
 *
	gÂ
 = 
NULL
;

1718 i‡(
	gvtysh_∑gî_«me
)

1720 
	gÂ
 = 
p›í
 (
vtysh_∑gî_«me
, "w");

1721 i‡(
	gÂ
 =
NULL
)

1723 
≥º‹
 ("popen");

1724 
exô
 (1);

1728 
	gÂ
 = 
°dout
;

1730 
vty_out
 (
vty
, "Buûdög c⁄figuøti⁄...%s", 
VTY_NEWLINE
);

1731 
vty_out
 (
vty
, "%sCuºíàc⁄figuøti⁄:%s", 
VTY_NEWLINE
,

1732 
VTY_NEWLINE
);

1733 
vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

1735 
	gi
 = 0; i < 
¨øy_size
(
vtysh_˛õ¡
); i++)

1736 
	gªt
 = 
vtysh_˛õ¡_c⁄fig
 (&
vtysh_˛õ¡
[
i
], 
löe
);

1739 
vtysh_c⁄fig_wrôe
 ();

1741 
vtysh_c⁄fig_dump
 (
Â
);

1743 i‡(
	gvtysh_∑gî_«me
 && 
	gÂ
)

1745 
fÊush
 (
Â
);

1746 i‡(
p˛o£
 (
Â
) == -1)

1748 
≥º‹
 ("pclose");

1749 
exô
 (1);

1751 
	gÂ
 = 
NULL
;

1754 
vty_out
 (
vty
, "íd%s", 
VTY_NEWLINE
);

1756  
	gCMD_SUCCESS
;

1759 
DEFUN
 (
vtysh_öãgøãd_c⁄fig
,

1760 
vtysh_öãgøãd_c⁄fig_cmd
,

1765 
	gvtysh_wrôec⁄fig_öãgøãd
 = 1;

1766  
	gCMD_SUCCESS
;

1769 
DEFUN
 (
no_vtysh_öãgøãd_c⁄fig
,

1770 
no_vtysh_öãgøãd_c⁄fig_cmd
,

1772 
NO_STR


1776 
	gvtysh_wrôec⁄fig_öãgøãd
 = 0;

1777  
	gCMD_SUCCESS
;

1781 
	$wrôe_c⁄fig_öãgøãd
()

1783 
u_öt
 
i
;

1784 
ªt
;

1785 
löe
[] = "writeÅerminal\n";

1786 
FILE
 *
Â
;

1787 *
öãgøã_ßv
 = 
NULL
;

1789 
öãgøã_ßv
 = 
	`mÆloc
 (
	`°æí
 (
öãgøã_deÁu…
) +

1790 
	`°æí
 (
CONF_BACKUP_EXT
) + 1);

1791 
	`°r˝y
 (
öãgøã_ßv
, 
öãgøã_deÁu…
);

1792 
	`°rˇt
 (
öãgøã_ßv
, 
CONF_BACKUP_EXT
);

1794 
	`Ârötf
 (
°dout
,"Building Configuration...\n");

1797 
	`u∆ök
 (
öãgøã_ßv
);

1798 
	`ª«me
 (
öãgøã_deÁu…
, 
öãgøã_ßv
);

1799 
	`‰ì
 (
öãgøã_ßv
);

1801 
Â
 = 
	`f›í
 (
öãgøã_deÁu…
, "w");

1802 i‡(
Â
 =
NULL
)

1804 
	`Ârötf
 (
°dout
,"%% Can't open configuration file %s.\n",

1805 
öãgøã_deÁu…
);

1806  
CMD_SUCCESS
;

1809 
i
 = 0; i < 
	`¨øy_size
(
vtysh_˛õ¡
); i++)

1810 
ªt
 = 
	`vtysh_˛õ¡_c⁄fig
 (&
vtysh_˛õ¡
[
i
], 
löe
);

1812 
	`vtysh_c⁄fig_dump
 (
Â
);

1814 
	`f˛o£
 (
Â
);

1816 i‡(
	`chmod
 (
öãgøã_deÁu…
, 
CONFIGFILE_MASK
) != 0)

1818 
	`Ârötf
 (
°dout
,"%% Can't chmod configuration file %s: %s (%d)\n",

1819 
öãgøã_deÁu…
, 
	`ß„_°ªº‹
(
î∫o
),Érrno);

1820  
CMD_WARNING
;

1823 
	`Ârötf
(
°dout
,"I¡egøãd c⁄figuøti⁄ savedÅÿ%s\n",
öãgøã_deÁu…
);

1825 
	`Ârötf
 (
°dout
,"[OK]\n");

1827  
CMD_SUCCESS
;

1828 
	}
}

1830 
DEFUN
 (
vtysh_wrôe_mem‹y
,

1831 
vtysh_wrôe_mem‹y_cmd
,

1836 
	gªt
 = 
CMD_SUCCESS
;

1837 
	glöe
[] = "write memory\n";

1838 
u_öt
 
	gi
;

1841 i‡(
	gvtysh_wrôec⁄fig_öãgøãd
)

1842  
wrôe_c⁄fig_öãgøãd
();

1844 
Ârötf
 (
°dout
,"Building Configuration...\n");

1846 
	gi
 = 0; i < 
¨øy_size
(
vtysh_˛õ¡
); i++)

1847 
	gªt
 = 
vtysh_˛õ¡_execuã
 (&
vtysh_˛õ¡
[
i
], 
löe
, 
°dout
);

1849 
Ârötf
 (
°dout
,"[OK]\n");

1851  
	gªt
;

1854 
ALIAS
 (
vtysh_wrôe_mem‹y
,

1855 
vtysh_c›y_ru¬ögc⁄fig_°¨tupc⁄fig_cmd
,

1861 
ALIAS
 (
vtysh_wrôe_mem‹y
,

1862 
vtysh_wrôe_fûe_cmd
,

1867 
ALIAS
 (
vtysh_wrôe_mem‹y
,

1868 
vtysh_wrôe_cmd
,

1872 
ALIAS
 (
vtysh_wrôe_ãrmöÆ
,

1873 
vtysh_show_ru¬ög_c⁄fig_cmd
,

1875 
SHOW_STR


1878 
DEFUN
 (
vtysh_ãrmöÆ_Àngth
,

1879 
vtysh_ãrmöÆ_Àngth_cmd
,

1885 
	glöes
;

1886 *
	gíd±r
 = 
NULL
;

1887 
	gdeÁu…_∑gî
[10];

1889 
	glöes
 = 
°πﬁ
 (
¨gv
[0], &
íd±r
, 10);

1890 i‡(
	glöes
 < 0 ||Üöe†> 512 || *
	gíd±r
 != '\0')

1892 
vty_out
 (
vty
, "Àngth i†mÆf‹med%s", 
VTY_NEWLINE
);

1893  
	gCMD_WARNING
;

1896 i‡(
	gvtysh_∑gî_«me
)

1898 
‰ì
 (
vtysh_∑gî_«me
);

1899 
	gvtysh_∑gî_«me
 = 
NULL
;

1902 i‡(
	glöes
 != 0)

1904 
¢¥ötf
(
deÁu…_∑gî
, 10, "m‹ê-%i", 
löes
);

1905 
	gvtysh_∑gî_«me
 = 
°rdup
 (
deÁu…_∑gî
);

1908  
	gCMD_SUCCESS
;

1911 
DEFUN
 (
vtysh_ãrmöÆ_no_Àngth
,

1912 
vtysh_ãrmöÆ_no_Àngth_cmd
,

1915 
NO_STR


1918 i‡(
	gvtysh_∑gî_«me
)

1920 
‰ì
 (
vtysh_∑gî_«me
);

1921 
	gvtysh_∑gî_«me
 = 
NULL
;

1924 
vtysh_∑gî_öô
();

1925  
	gCMD_SUCCESS
;

1928 
DEFUN
 (
vtysh_show_d´m⁄s
,

1929 
vtysh_show_d´m⁄s_cmd
,

1931 
SHOW_STR


1934 
u_öt
 
	gi
;

1936 
	gi
 = 0; i < 
¨øy_size
(
vtysh_˛õ¡
); i++)

1937 i‡–
	gvtysh_˛õ¡
[
i
].
	gfd
 >= 0 )

1938 
vty_out
(
vty
, " %s", 
vtysh_˛õ¡
[
i
].
«me
);

1939 
vty_out
(
vty
, "%s", 
VTY_NEWLINE
);

1941  
	gCMD_SUCCESS
;

1946 
	$execuã_comm™d
 (c⁄° *
comm™d
, 
¨gc
, c⁄° *
¨g1
,

1947 c⁄° *
¨g2
)

1949 
ªt
;

1950 
pid_t
 
pid
;

1951 
°©us
;

1954 
pid
 = 
	`f‹k
 ();

1956 i‡(
pid
 < 0)

1959 
	`Ârötf
 (
°dîr
, "C™'àf‹k: %s\n", 
	`ß„_°ªº‹
 (
î∫o
));

1960 
	`exô
 (1);

1962 i‡(
pid
 == 0)

1965 
¨gc
)

1968 
ªt
 = 
	`exe˛p
 (
comm™d
, comm™d, (c⁄° *)
NULL
);

1971 
ªt
 = 
	`exe˛p
 (
comm™d
, comm™d, 
¨g1
, (c⁄° *)
NULL
);

1974 
ªt
 = 
	`exe˛p
 (
comm™d
, comm™d, 
¨g1
, 
¨g2
, (c⁄° *)
NULL
);

1979 
	`Ârötf
 (
°dîr
, "C™'àexecuã %s: %s\n", 
comm™d
, 
	`ß„_°ªº‹
 (
î∫o
));

1980 
	`exô
 (1);

1985 
execuã_Êag
 = 1;

1986 
ªt
 = 
	`waô4
 (
pid
, &
°©us
, 0, 
NULL
);

1987 
execuã_Êag
 = 0;

1990 
	}
}

1992 
DEFUN
 (
vtysh_pög
,

1993 
vtysh_pög_cmd
,

1998 
execuã_comm™d
 ("pög", 1, 
¨gv
[0], 
NULL
);

1999  
	gCMD_SUCCESS
;

2002 
ALIAS
 (
vtysh_pög
,

2003 
vtysh_pög_ù_cmd
,

2009 
DEFUN
 (
vtysh_åa˚rouã
,

2010 
vtysh_åa˚rouã_cmd
,

2015 
execuã_comm™d
 ("åa˚rouã", 1, 
¨gv
[0], 
NULL
);

2016  
	gCMD_SUCCESS
;

2019 
ALIAS
 (
vtysh_åa˚rouã
,

2020 
vtysh_åa˚rouã_ù_cmd
,

2026 #ifde‡
HAVE_IPV6


2027 
DEFUN
 (
vtysh_pög6
,

2028 
vtysh_pög6_cmd
,

2034 
execuã_comm™d
 ("pög6", 1, 
¨gv
[0], 
NULL
);

2035  
	gCMD_SUCCESS
;

2038 
DEFUN
 (
vtysh_åa˚rouã6
,

2039 
vtysh_åa˚rouã6_cmd
,

2045 
execuã_comm™d
 ("åa˚rouã6", 1, 
¨gv
[0], 
NULL
);

2046  
	gCMD_SUCCESS
;

2050 
DEFUN
 (
vtysh_ã ë
,

2051 
vtysh_ã ë_cmd
,

2056 
execuã_comm™d
 ("ã ë", 1, 
¨gv
[0], 
NULL
);

2057  
	gCMD_SUCCESS
;

2060 
DEFUN
 (
vtysh_ã ë_p‹t
,

2061 
vtysh_ã ë_p‹t_cmd
,

2067 
execuã_comm™d
 ("ã ë", 2, 
¨gv
[0],árgv[1]);

2068  
	gCMD_SUCCESS
;

2071 
DEFUN
 (
vtysh_ssh
,

2072 
vtysh_ssh_cmd
,

2077 
execuã_comm™d
 ("ssh", 1, 
¨gv
[0], 
NULL
);

2078  
	gCMD_SUCCESS
;

2081 
DEFUN
 (
vtysh_°¨t_shñl
,

2082 
vtysh_°¨t_shñl_cmd
,

2086 
execuã_comm™d
 ("sh", 0, 
NULL
, NULL);

2087  
	gCMD_SUCCESS
;

2090 
DEFUN
 (
vtysh_°¨t_bash
,

2091 
vtysh_°¨t_bash_cmd
,

2096 
execuã_comm™d
 ("bash", 0, 
NULL
, NULL);

2097  
	gCMD_SUCCESS
;

2100 
DEFUN
 (
vtysh_°¨t_zsh
,

2101 
vtysh_°¨t_zsh_cmd
,

2106 
execuã_comm™d
 ("zsh", 0, 
NULL
, NULL);

2107  
	gCMD_SUCCESS
;

2111 
	$vtysh_ö°Æl_deÁu…
 (
node_ty≥
 
node
)

2113 
	`ö°Æl_ñemít
 (
node
, &
c⁄fig_li°_cmd
);

2114 
	}
}

2118 
	$vtysh_c⁄√˘
 (
vtysh_˛õ¡
 *
v˛õ¡
)

2120 
ªt
;

2121 
sock
, 
Àn
;

2122 
sockaddr_un
 
addr
;

2123 
°©
 
s_°©
;

2126 
ªt
 = 
	`°©
 (
v˛õ¡
->
∑th
, &
s_°©
);

2127 i‡(
ªt
 < 0 && 
î∫o
 !
ENOENT
)

2129 
	`Ârötf
 (
°dîr
, "vtysh_connect(%s): stat = %s\n",

2130 
v˛õ¡
->
∑th
, 
	`ß„_°ªº‹
(
î∫o
));

2131 
	`exô
(1);

2134 i‡(
ªt
 >= 0)

2136 i‡(! 
	`S_ISSOCK
(
s_°©
.
°_mode
))

2138 
	`Ârötf
 (
°dîr
, "vtysh_connect(%s): Notá socket\n",

2139 
v˛õ¡
->
∑th
);

2140 
	`exô
 (1);

2145 
sock
 = 
	`sockë
 (
AF_UNIX
, 
SOCK_STREAM
, 0);

2146 i‡(
sock
 < 0)

2148 #ifde‡
DEBUG


2149 
	`Ârötf
(
°dîr
, "vtysh_c⁄√˘(%s): sockë = %s\n", 
v˛õ¡
->
∑th
,

2150 
	`ß„_°ªº‹
(
î∫o
));

2155 
	`mem£t
 (&
addr
, 0,  (
sockaddr_un
));

2156 
addr
.
sun_Ámûy
 = 
AF_UNIX
;

2157 
	`°∫˝y
 (
addr
.
sun_∑th
, 
v˛õ¡
->
∑th
, 
	`°æí
 (vclient->path));

2158 #ifde‡
HAVE_STRUCT_SOCKADDR_UN_SUN_LEN


2159 
Àn
 = 
addr
.
sun_Àn
 = 
	`SUN_LEN
(&addr);

2161 
Àn
 =  (
addr
.
sun_Ámûy
Ë+ 
	`°æí
 (addr.
sun_∑th
);

2164 
ªt
 = 
	`c⁄√˘
 (
sock
, (
sockaddr
 *Ë&
addr
, 
Àn
);

2165 i‡(
ªt
 < 0)

2167 #ifde‡
DEBUG


2168 
	`Ârötf
(
°dîr
, "vtysh_c⁄√˘(%s): c⁄√˘ = %s\n", 
v˛õ¡
->
∑th
,

2169 
	`ß„_°ªº‹
(
î∫o
));

2171 
	`˛o£
 (
sock
);

2174 
v˛õ¡
->
fd
 = 
sock
;

2177 
	}
}

2180 
	$vtysh_c⁄√˘_Æl
(c⁄° *
d´m⁄_«me
)

2182 
u_öt
 
i
;

2183 
rc
 = 0;

2184 
m©ches
 = 0;

2186 
i
 = 0; i < 
	`¨øy_size
(
vtysh_˛õ¡
); i++)

2188 i‡(!
d´m⁄_«me
 || !
	`°rcmp
(d´m⁄_«me, 
vtysh_˛õ¡
[
i
].
«me
))

2190 
m©ches
++;

2191 i‡(
	`vtysh_c⁄√˘
(&
vtysh_˛õ¡
[
i
]) == 0)

2192 
rc
++;

2194 i‡(
vtysh_˛õ¡
[
i
].
Êag
 =
VTYSH_RIPD
)

2195 
rùd_˛õ¡
 = &
vtysh_˛õ¡
[
i
];

2198 i‡(!
m©ches
)

2199 
	`Ârötf
(
°dîr
, "Eº‹:Çÿd´m⁄†m©chÇamê%s!\n", 
d´m⁄_«me
);

2200  
rc
;

2201 
	}
}

2205 
	$vtysh_com∂ëi⁄_íåy_fun˘i⁄
 (c⁄° *
ign‹e
, 
övokög_key
)

2207  
NULL
;

2208 
	}
}

2211 
	$vtysh_ªadlöe_öô
 ()

2214 
	`æ_böd_key
 ('?', (
Fun˘i⁄
 *Ë
vtysh_æ_des¸ibe
);

2215 
æ_com∂ëi⁄_íåy_fun˘i⁄
 = 
vtysh_com∂ëi⁄_íåy_fun˘i⁄
;

2216 
æ_©ãm±ed_com∂ëi⁄_fun˘i⁄
 = (
CPPFun˘i⁄
 *)
√w_com∂ëi⁄
;

2219 
æ_com∂ëi⁄_≠≥nd_ch¨a˘î
 = '\0';

2220 
	}
}

2223 
	$vtysh_¥om±
 ()

2225 
ut¢ame
 
«mes
;

2226 
buf
[100];

2227 c⁄° *
ho°«me
;

2228 
ho°
 host;

2230 
ho°«me
 = 
ho°
.
«me
;

2232 i‡(!
ho°«me
)

2234 i‡(!
«mes
.
nodíame
[0])

2235 
	`u«me
 (&
«mes
);

2236 
ho°«me
 = 
«mes
.
nodíame
;

2239 
	`¢¥ötf
 (
buf
,  buf, 
	`cmd_¥om±
 (
vty
->
node
), 
ho°«me
);

2241  
buf
;

2242 
	}
}

2245 
	$vtysh_öô_vty
 ()

2248 
vty
 = 
	`vty_√w
 ();

2249 
vty
->
ty≥
 = 
VTY_SHELL
;

2250 
vty
->
node
 = 
VIEW_NODE
;

2253 
	`cmd_öô
 (0);

2256 
	`ö°Æl_node
 (&
bgp_node
, 
NULL
);

2257 
	`ö°Æl_node
 (&
rù_node
, 
NULL
);

2258 
	`ö°Æl_node
 (&
öãrÁ˚_node
, 
NULL
);

2259 
	`ö°Æl_node
 (&
rm≠_node
, 
NULL
);

2260 
	`ö°Æl_node
 (&
zebø_node
, 
NULL
);

2261 
	`ö°Æl_node
 (&
bgp_v≤v4_node
, 
NULL
);

2262 
	`ö°Æl_node
 (&
bgp_ùv4_node
, 
NULL
);

2263 
	`ö°Æl_node
 (&
bgp_ùv4m_node
, 
NULL
);

2265 
	`ö°Æl_node
 (&
bgp_ùv6_node
, 
NULL
);

2266 
	`ö°Æl_node
 (&
bgp_ùv6m_node
, 
NULL
);

2268 
	`ö°Æl_node
 (&
o•f_node
, 
NULL
);

2270 
	`ö°Æl_node
 (&
rùng_node
, 
NULL
);

2271 
	`ö°Æl_node
 (&
o•f6_node
, 
NULL
);

2273 
	`ö°Æl_node
 (&
babñ_node
, 
NULL
);

2274 
	`ö°Æl_node
 (&
keychaö_node
, 
NULL
);

2275 
	`ö°Æl_node
 (&
keychaö_key_node
, 
NULL
);

2276 
	`ö°Æl_node
 (&
isis_node
, 
NULL
);

2277 
	`ö°Æl_node
 (&
vty_node
, 
NULL
);

2279 
	`vtysh_ö°Æl_deÁu…
 (
VIEW_NODE
);

2280 
	`vtysh_ö°Æl_deÁu…
 (
ENABLE_NODE
);

2281 
	`vtysh_ö°Æl_deÁu…
 (
CONFIG_NODE
);

2282 
	`vtysh_ö°Æl_deÁu…
 (
BGP_NODE
);

2283 
	`vtysh_ö°Æl_deÁu…
 (
RIP_NODE
);

2284 
	`vtysh_ö°Æl_deÁu…
 (
INTERFACE_NODE
);

2285 
	`vtysh_ö°Æl_deÁu…
 (
RMAP_NODE
);

2286 
	`vtysh_ö°Æl_deÁu…
 (
ZEBRA_NODE
);

2287 
	`vtysh_ö°Æl_deÁu…
 (
BGP_VPNV4_NODE
);

2288 
	`vtysh_ö°Æl_deÁu…
 (
BGP_IPV4_NODE
);

2289 
	`vtysh_ö°Æl_deÁu…
 (
BGP_IPV4M_NODE
);

2290 
	`vtysh_ö°Æl_deÁu…
 (
BGP_IPV6_NODE
);

2291 
	`vtysh_ö°Æl_deÁu…
 (
BGP_IPV6M_NODE
);

2292 
	`vtysh_ö°Æl_deÁu…
 (
OSPF_NODE
);

2293 
	`vtysh_ö°Æl_deÁu…
 (
RIPNG_NODE
);

2294 
	`vtysh_ö°Æl_deÁu…
 (
OSPF6_NODE
);

2295 
	`vtysh_ö°Æl_deÁu…
 (
BABEL_NODE
);

2296 
	`vtysh_ö°Æl_deÁu…
 (
ISIS_NODE
);

2297 
	`vtysh_ö°Æl_deÁu…
 (
KEYCHAIN_NODE
);

2298 
	`vtysh_ö°Æl_deÁu…
 (
KEYCHAIN_KEY_NODE
);

2299 
	`vtysh_ö°Æl_deÁu…
 (
VTY_NODE
);

2301 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_íabÀ_cmd
);

2302 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_c⁄fig_ãrmöÆ_cmd
);

2303 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_dißbÀ_cmd
);

2306 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_exô_Æl_cmd
);

2307 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_quô_Æl_cmd
);

2308 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_exô_Æl_cmd
);

2310 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_exô_Æl_cmd
);

2311 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_quô_Æl_cmd
);

2312 
	`ö°Æl_ñemít
 (
RIP_NODE
, &
vtysh_exô_rùd_cmd
);

2313 
	`ö°Æl_ñemít
 (
RIP_NODE
, &
vtysh_quô_rùd_cmd
);

2314 
	`ö°Æl_ñemít
 (
RIPNG_NODE
, &
vtysh_exô_rùngd_cmd
);

2315 
	`ö°Æl_ñemít
 (
RIPNG_NODE
, &
vtysh_quô_rùngd_cmd
);

2316 
	`ö°Æl_ñemít
 (
OSPF_NODE
, &
vtysh_exô_o•fd_cmd
);

2317 
	`ö°Æl_ñemít
 (
OSPF_NODE
, &
vtysh_quô_o•fd_cmd
);

2318 
	`ö°Æl_ñemít
 (
OSPF6_NODE
, &
vtysh_exô_o•f6d_cmd
);

2319 
	`ö°Æl_ñemít
 (
OSPF6_NODE
, &
vtysh_quô_o•f6d_cmd
);

2320 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
vtysh_exô_bgpd_cmd
);

2321 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
vtysh_quô_bgpd_cmd
);

2322 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
vtysh_exô_bgpd_cmd
);

2323 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
vtysh_quô_bgpd_cmd
);

2324 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
vtysh_exô_bgpd_cmd
);

2325 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
vtysh_quô_bgpd_cmd
);

2326 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
vtysh_exô_bgpd_cmd
);

2327 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
vtysh_quô_bgpd_cmd
);

2328 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
vtysh_exô_bgpd_cmd
);

2329 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
vtysh_quô_bgpd_cmd
);

2330 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
vtysh_exô_bgpd_cmd
);

2331 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
vtysh_quô_bgpd_cmd
);

2332 
	`ö°Æl_ñemít
 (
ISIS_NODE
, &
vtysh_exô_isisd_cmd
);

2333 
	`ö°Æl_ñemít
 (
ISIS_NODE
, &
vtysh_quô_isisd_cmd
);

2334 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
vtysh_exô_rùd_cmd
);

2335 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
vtysh_quô_rùd_cmd
);

2336 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
vtysh_exô_rùd_cmd
);

2337 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
vtysh_quô_rùd_cmd
);

2338 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
vtysh_exô_rm≠_cmd
);

2339 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
vtysh_quô_rm≠_cmd
);

2340 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vtysh_exô_löe_vty_cmd
);

2341 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vtysh_quô_löe_vty_cmd
);

2344 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_íd_Æl_cmd
);

2345 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_íd_Æl_cmd
);

2346 
	`ö°Æl_ñemít
 (
RIP_NODE
, &
vtysh_íd_Æl_cmd
);

2347 
	`ö°Æl_ñemít
 (
RIPNG_NODE
, &
vtysh_íd_Æl_cmd
);

2348 
	`ö°Æl_ñemít
 (
OSPF_NODE
, &
vtysh_íd_Æl_cmd
);

2349 
	`ö°Æl_ñemít
 (
OSPF6_NODE
, &
vtysh_íd_Æl_cmd
);

2350 
	`ö°Æl_ñemít
 (
BABEL_NODE
, &
vtysh_íd_Æl_cmd
);

2351 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
vtysh_íd_Æl_cmd
);

2352 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
vtysh_íd_Æl_cmd
);

2353 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
vtysh_íd_Æl_cmd
);

2354 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
vtysh_íd_Æl_cmd
);

2355 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
vtysh_íd_Æl_cmd
);

2356 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
vtysh_íd_Æl_cmd
);

2357 
	`ö°Æl_ñemít
 (
ISIS_NODE
, &
vtysh_íd_Æl_cmd
);

2358 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
vtysh_íd_Æl_cmd
);

2359 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
vtysh_íd_Æl_cmd
);

2360 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
vtysh_íd_Æl_cmd
);

2361 
	`ö°Æl_ñemít
 (
VTY_NODE
, &
vtysh_íd_Æl_cmd
);

2363 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
öãrÁ˚_desc_cmd
);

2364 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_öãrÁ˚_desc_cmd
);

2365 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
vtysh_íd_Æl_cmd
);

2366 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
vtysh_exô_öãrÁ˚_cmd
);

2367 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
vtysh_quô_öãrÁ˚_cmd
);

2368 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_rù_cmd
);

2369 #ifde‡
HAVE_IPV6


2370 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_rùng_cmd
);

2372 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_o•f_cmd
);

2373 #ifde‡
HAVE_IPV6


2374 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_o•f6_cmd
);

2376 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_babñ_cmd
);

2377 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_isis_cmd
);

2378 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_bgp_cmd
);

2379 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_bgp_võw_cmd
);

2380 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_v≤v4_cmd
);

2381 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_v≤v4_uniˇ°_cmd
);

2382 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv4_uniˇ°_cmd
);

2383 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv4_mu…iˇ°_cmd
);

2384 #ifde‡
HAVE_IPV6


2385 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv6_cmd
);

2386 
	`ö°Æl_ñemít
 (
BGP_NODE
, &
addªss_Ámûy_ùv6_uniˇ°_cmd
);

2388 
	`ö°Æl_ñemít
 (
BGP_VPNV4_NODE
, &
exô_addªss_Ámûy_cmd
);

2389 
	`ö°Æl_ñemít
 (
BGP_IPV4_NODE
, &
exô_addªss_Ámûy_cmd
);

2390 
	`ö°Æl_ñemít
 (
BGP_IPV4M_NODE
, &
exô_addªss_Ámûy_cmd
);

2391 
	`ö°Æl_ñemít
 (
BGP_IPV6_NODE
, &
exô_addªss_Ámûy_cmd
);

2392 
	`ö°Æl_ñemít
 (
BGP_IPV6M_NODE
, &
exô_addªss_Ámûy_cmd
);

2393 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
key_chaö_cmd
);

2394 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouã_m≠_cmd
);

2395 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_löe_vty_cmd
);

2396 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
key_cmd
);

2397 
	`ö°Æl_ñemít
 (
KEYCHAIN_NODE
, &
key_chaö_cmd
);

2398 
	`ö°Æl_ñemít
 (
KEYCHAIN_KEY_NODE
, &
key_chaö_cmd
);

2399 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_öãrÁ˚_cmd
);

2400 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_no_öãrÁ˚_cmd
);

2401 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_show_ru¬ög_c⁄fig_cmd
);

2402 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_c›y_ru¬ögc⁄fig_°¨tupc⁄fig_cmd
);

2403 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_wrôe_fûe_cmd
);

2404 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_wrôe_cmd
);

2407 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_wrôe_ãrmöÆ_cmd
);

2409 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_öãgøãd_c⁄fig_cmd
);

2410 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_öãgøãd_c⁄fig_cmd
);

2413 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_wrôe_mem‹y_cmd
);

2415 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_ãrmöÆ_Àngth_cmd
);

2416 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_ãrmöÆ_Àngth_cmd
);

2417 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_ãrmöÆ_no_Àngth_cmd
);

2418 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_ãrmöÆ_no_Àngth_cmd
);

2419 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_show_d´m⁄s_cmd
);

2420 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_show_d´m⁄s_cmd
);

2422 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_pög_cmd
);

2423 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_pög_ù_cmd
);

2424 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_åa˚rouã_cmd
);

2425 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_åa˚rouã_ù_cmd
);

2426 #ifde‡
HAVE_IPV6


2427 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_pög6_cmd
);

2428 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_åa˚rouã6_cmd
);

2430 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_ã ë_cmd
);

2431 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_ã ë_p‹t_cmd
);

2432 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_ssh_cmd
);

2433 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_pög_cmd
);

2434 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_pög_ù_cmd
);

2435 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_åa˚rouã_cmd
);

2436 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_åa˚rouã_ù_cmd
);

2437 #ifde‡
HAVE_IPV6


2438 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_pög6_cmd
);

2439 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_åa˚rouã6_cmd
);

2441 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_ã ë_cmd
);

2442 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_ã ë_p‹t_cmd
);

2443 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_ssh_cmd
);

2444 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_°¨t_shñl_cmd
);

2445 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_°¨t_bash_cmd
);

2446 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_°¨t_zsh_cmd
);

2448 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_show_mem‹y_cmd
);

2449 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_show_mem‹y_cmd
);

2452 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
vtysh_show_loggög_cmd
);

2453 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
vtysh_show_loggög_cmd
);

2454 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_°dout_cmd
);

2455 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_°dout_Àvñ_cmd
);

2456 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_°dout_cmd
);

2457 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_fûe_cmd
);

2458 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_fûe_Àvñ_cmd
);

2459 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_fûe_cmd
);

2460 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_fûe_Àvñ_cmd
);

2461 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_m⁄ô‹_cmd
);

2462 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_m⁄ô‹_Àvñ_cmd
);

2463 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_m⁄ô‹_cmd
);

2464 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_sy¶og_cmd
);

2465 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_sy¶og_Àvñ_cmd
);

2466 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_sy¶og_cmd
);

2467 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_å≠_cmd
);

2468 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_å≠_cmd
);

2469 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_Ácûôy_cmd
);

2470 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_Ácûôy_cmd
);

2471 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_ªc‹d_¥i‹ôy_cmd
);

2472 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_ªc‹d_¥i‹ôy_cmd
);

2473 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_log_time°amp_¥ecisi⁄_cmd
);

2474 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_log_time°amp_¥ecisi⁄_cmd
);

2476 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_£rvi˚_∑ssw‹d_í¸y±_cmd
);

2477 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_£rvi˚_∑ssw‹d_í¸y±_cmd
);

2479 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_∑ssw‹d_cmd
);

2480 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_∑ssw‹d_ãxt_cmd
);

2481 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_íabÀ_∑ssw‹d_cmd
);

2482 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
vtysh_íabÀ_∑ssw‹d_ãxt_cmd
);

2483 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_vtysh_íabÀ_∑ssw‹d_cmd
);

2485 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh.h

22 #i‚de‡
VTYSH_H


23 
	#VTYSH_H


	)

25 
	#VTYSH_ZEBRA
 0x01

	)

26 
	#VTYSH_RIPD
 0x02

	)

27 
	#VTYSH_RIPNGD
 0x04

	)

28 
	#VTYSH_OSPFD
 0x08

	)

29 
	#VTYSH_OSPF6D
 0x10

	)

30 
	#VTYSH_BGPD
 0x20

	)

31 
	#VTYSH_ISISD
 0x40

	)

32 
	#VTYSH_BABELD
 0x80

	)

33 
	#VTYSH_ALL
 
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_RIPNGD
|
VTYSH_OSPFD
|
VTYSH_OSPF6D
|
VTYSH_BGPD
|
VTYSH_ISISD
|
VTYSH_BABELD


	)

34 
	#VTYSH_RMAP
 
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_RIPNGD
|
VTYSH_OSPFD
|
VTYSH_OSPF6D
|
VTYSH_BGPD
|
VTYSH_BABELD


	)

35 
	#VTYSH_INTERFACE
 
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_RIPNGD
|
VTYSH_OSPFD
|
VTYSH_OSPF6D
|
VTYSH_ISISD
|
VTYSH_BABELD


	)

38 
	#VTYSH_DEFAULT_CONFIG
 "vtysh.c⁄f"

	)

40 
vtysh_öô_vty
 ();

41 
vtysh_öô_cmd
 ();

42 
vtysh_c⁄√˘_Æl
 (c⁄° *
›ti⁄Æ_d´m⁄_«me
);

43 
vtysh_ªadlöe_öô
 ();

44 
vtysh_u£r_öô
 ();

46 
vtysh_execuã
 (const *);

47 
vtysh_execuã_no_∑gî
 (const *);

49 *
vtysh_¥om±
 ();

51 
vtysh_c⁄fig_wrôe
 ();

53 
vtysh_c⁄fig_‰om_fûe
 (
vty
 *, 
FILE
 *);

55 
vtysh_ªad_c⁄fig
 (*);

57 
vtysh_c⁄fig_∑r£
 (*);

59 
vtysh_c⁄fig_dump
 (
FILE
 *);

61 
vtysh_c⁄fig_öô
 ();

63 
vtysh_∑gî_öô
 ();

66 
execuã_Êag
;

68 
vty
 *vty;

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_config.c

21 
	~<zebø.h
>

23 
	~"comm™d.h
"

24 
	~"lökli°.h
"

25 
	~"mem‹y.h
"

27 
	~"vtysh/vtysh.h
"

29 
ve˘‹
 
	gc⁄figvec
;

31 
vtysh_wrôec⁄fig_öãgøãd
;

33 
	sc⁄fig


36 *
	m«me
;

39 
li°
 *
	mlöe
;

42 
c⁄fig
 *
	mc⁄fig
;

45 
u_öt32_t
 
	mödex
;

48 
li°
 *
	gc⁄fig_t›
;

51 
	$löe_cmp
 (*
c1
, *
c2
)

53  
	`°rcmp
 (
c1
, 
c2
);

54 
	}
}

57 
	$löe_dñ
 (*
löe
)

59 
	`XFREE
 (
MTYPE_VTYSH_CONFIG_LINE
, 
löe
);

60 
	}
}

62 
c⁄fig
 *

63 
	$c⁄fig_√w
 ()

65 
c⁄fig
 *config;

66 
c⁄fig
 = 
	`XCALLOC
 (
MTYPE_VTYSH_CONFIG
,  (config));

67  
c⁄fig
;

68 
	}
}

71 
	$c⁄fig_cmp
 (
c⁄fig
 *
c1
, c⁄fig *
c2
)

73  
	`°rcmp
 (
c1
->
«me
, 
c2
->name);

74 
	}
}

77 
	$c⁄fig_dñ
 (
c⁄fig
* config)

79 
	`li°_dñëe
 (
c⁄fig
->
löe
);

80 i‡(
c⁄fig
->
«me
)

81 
	`XFREE
 (
MTYPE_VTYSH_CONFIG_LINE
, 
c⁄fig
->
«me
);

82 
	`XFREE
 (
MTYPE_VTYSH_CONFIG
, 
c⁄fig
);

83 
	}
}

85 
c⁄fig
 *

86 
	$c⁄fig_gë
 (
ödex
, c⁄° *
löe
)

88 
c⁄fig
 *config;

89 
c⁄fig
 *
c⁄fig_lo›
;

90 
li°
 *
ma°î
;

91 
li°node
 *
node
, *
¬ode
;

93 
c⁄fig
 = 
c⁄fig_lo›
 = 
NULL
;

95 
ma°î
 = 
	`ve˘‹_lookup_ísuª
 (
c⁄figvec
, 
ödex
);

97 i‡(! 
ma°î
)

99 
ma°î
 = 
	`li°_√w
 ();

100 
ma°î
->
dñ
 = ((*Ë(*))
c⁄fig_dñ
;

101 
ma°î
->
cmp
 = ((*)(*, *)Ë
c⁄fig_cmp
;

102 
	`ve˘‹_£t_ödex
 (
c⁄figvec
, 
ödex
, 
ma°î
);

105 
	`ALL_LIST_ELEMENTS
 (
ma°î
, 
node
, 
¬ode
, 
c⁄fig_lo›
))

107 i‡(
	`°rcmp
 (
c⁄fig_lo›
->
«me
, 
löe
) == 0)

108 
c⁄fig
 = 
c⁄fig_lo›
;

111 i‡(! 
c⁄fig
)

113 
c⁄fig
 = 
	`c⁄fig_√w
 ();

114 
c⁄fig
->
löe
 = 
	`li°_√w
 ();

115 
c⁄fig
->
löe
->
dñ
 = ((*Ë(*))
löe_dñ
;

116 
c⁄fig
->
löe
->
cmp
 = ((*)(*, *)Ë
löe_cmp
;

117 
c⁄fig
->
«me
 = 
	`XSTRDUP
 (
MTYPE_VTYSH_CONFIG_LINE
, 
löe
);

118 
c⁄fig
->
ödex
 = index;

119 
	`li°node_add
 (
ma°î
, 
c⁄fig
);

121  
c⁄fig
;

122 
	}
}

125 
	$c⁄fig_add_löe
 (
li°
 *
c⁄fig
, c⁄° *
löe
)

127 
	`li°node_add
 (
c⁄fig
, 
	`XSTRDUP
 (
MTYPE_VTYSH_CONFIG_LINE
, 
löe
));

128 
	}
}

131 
	$c⁄fig_add_löe_uniq
 (
li°
 *
c⁄fig
, c⁄° *
löe
)

133 
li°node
 *
node
, *
¬ode
;

134 *
≤t
;

136 
	`ALL_LIST_ELEMENTS
 (
c⁄fig
, 
node
, 
¬ode
, 
≤t
))

138 i‡(
	`°rcmp
 (
≤t
, 
löe
) == 0)

141 
	`li°node_add_s‹t
 (
c⁄fig
, 
	`XSTRDUP
 (
MTYPE_VTYSH_CONFIG_LINE
, 
löe
));

142 
	}
}

145 
	$vtysh_c⁄fig_∑r£_löe
 (c⁄° *
löe
)

147 
c
;

148 
c⁄fig
 *c⁄fig = 
NULL
;

150 i‡(! 
löe
)

153 
c
 = 
löe
[0];

155 i‡(
c
 == '\0')

160 
c
)

167 i‡(
c⁄fig
)

169 i‡(
	`°∫cmp
 (
löe
, "áddress-family vpnv4",

170 
	`°æí
 ("áddress-family vpnv4")) == 0)

171 
c⁄fig
 = 
	`c⁄fig_gë
 (
BGP_VPNV4_NODE
, 
löe
);

172 i‡(
	`°∫cmp
 (
löe
, "áddress-family ipv4 multicast",

173 
	`°æí
 ("áddress-family ipv4 multicast")) == 0)

174 
c⁄fig
 = 
	`c⁄fig_gë
 (
BGP_IPV4M_NODE
, 
löe
);

175 i‡(
	`°∫cmp
 (
löe
, "áddress-family ipv6",

176 
	`°æí
 ("áddress-family ipv6")) == 0)

177 
c⁄fig
 = 
	`c⁄fig_gë
 (
BGP_IPV6_NODE
, 
löe
);

178 i‡(
c⁄fig
->
ödex
 =
RMAP_NODE
 ||

179 
c⁄fig
->
ödex
 =
INTERFACE_NODE
 ||

180 
c⁄fig
->
ödex
 =
VTY_NODE
)

181 
	`c⁄fig_add_löe_uniq
 (
c⁄fig
->
löe
,Üine);

183 
	`c⁄fig_add_löe
 (
c⁄fig
->
löe
,Üine);

186 
	`c⁄fig_add_löe
 (
c⁄fig_t›
, 
löe
);

189 i‡(
	`°∫cmp
 (
löe
, "öãrÁ˚", 
	`°æí
 ("interface")) == 0)

190 
c⁄fig
 = 
	`c⁄fig_gë
 (
INTERFACE_NODE
, 
löe
);

191 i‡(
	`°∫cmp
 (
löe
, "rouãr-id", 
	`°æí
 ("router-id")) == 0)

192 
c⁄fig
 = 
	`c⁄fig_gë
 (
ZEBRA_NODE
, 
löe
);

193 i‡(
	`°∫cmp
 (
löe
, "rouã∏rù", 
	`°æí
 ("routerÑip")) == 0)

194 
c⁄fig
 = 
	`c⁄fig_gë
 (
RIP_NODE
, 
löe
);

195 i‡(
	`°∫cmp
 (
löe
, "rouã∏rùng", 
	`°æí
 ("routerÑipng")) == 0)

196 
c⁄fig
 = 
	`c⁄fig_gë
 (
RIPNG_NODE
, 
löe
);

197 i‡(
	`°∫cmp
 (
löe
, "rouã∏o•f", 
	`°æí
 ("router ospf")) == 0)

198 
c⁄fig
 = 
	`c⁄fig_gë
 (
OSPF_NODE
, 
löe
);

199 i‡(
	`°∫cmp
 (
löe
, "rouã∏o•f6", 
	`°æí
 ("router ospf6")) == 0)

200 
c⁄fig
 = 
	`c⁄fig_gë
 (
OSPF6_NODE
, 
löe
);

201 i‡(
	`°∫cmp
 (
löe
, "rouã∏babñ", 
	`°æí
 ("router babel")) == 0)

202 
c⁄fig
 = 
	`c⁄fig_gë
 (
BABEL_NODE
, 
löe
);

203 i‡(
	`°∫cmp
 (
löe
, "rouã∏bgp", 
	`°æí
 ("router bgp")) == 0)

204 
c⁄fig
 = 
	`c⁄fig_gë
 (
BGP_NODE
, 
löe
);

205 i‡(
	`°∫cmp
 (
löe
, "rouã∏isis", 
	`°æí
 ("router isis")) == 0)

206 
c⁄fig
 = 
	`c⁄fig_gë
 (
ISIS_NODE
, 
löe
);

207 i‡(
	`°∫cmp
 (
löe
, "rouã∏bgp", 
	`°æí
 ("router bgp")) == 0)

208 
c⁄fig
 = 
	`c⁄fig_gë
 (
BGP_NODE
, 
löe
);

209 i‡(
	`°∫cmp
 (
löe
, "rouã-m≠", 
	`°æí
 ("route-map")) == 0)

210 
c⁄fig
 = 
	`c⁄fig_gë
 (
RMAP_NODE
, 
löe
);

211 i‡(
	`°∫cmp
 (
löe
, "ac˚ss-li°", 
	`°æí
 ("access-list")) == 0)

212 
c⁄fig
 = 
	`c⁄fig_gë
 (
ACCESS_NODE
, 
löe
);

213 i‡(
	`°∫cmp
 (
löe
, "ipv6áccess-list",

214 
	`°æí
 ("ipv6áccess-list")) == 0)

215 
c⁄fig
 = 
	`c⁄fig_gë
 (
ACCESS_IPV6_NODE
, 
löe
);

216 i‡(
	`°∫cmp
 (
löe
, "ipÖrefix-list",

217 
	`°æí
 ("ipÖrefix-list")) == 0)

218 
c⁄fig
 = 
	`c⁄fig_gë
 (
PREFIX_NODE
, 
löe
);

219 i‡(
	`°∫cmp
 (
löe
, "ipv6Örefix-list",

220 
	`°æí
 ("ipv6Örefix-list")) == 0)

221 
c⁄fig
 = 
	`c⁄fig_gë
 (
PREFIX_IPV6_NODE
, 
löe
);

222 i‡(
	`°∫cmp
 (
löe
, "ipás-patháccess-list",

223 
	`°æí
 ("ipás-patháccess-list")) == 0)

224 
c⁄fig
 = 
	`c⁄fig_gë
 (
AS_LIST_NODE
, 
löe
);

225 i‡(
	`°∫cmp
 (
löe
, "ip community-list",

226 
	`°æí
 ("ip community-list")) == 0)

227 
c⁄fig
 = 
	`c⁄fig_gë
 (
COMMUNITY_LIST_NODE
, 
löe
);

228 i‡(
	`°∫cmp
 (
löe
, "ùÑouã", 
	`°æí
 ("ipÑoute")) == 0)

229 
c⁄fig
 = 
	`c⁄fig_gë
 (
IP_NODE
, 
löe
);

230 i‡(
	`°∫cmp
 (
löe
, "ùv6Ñouã", 
	`°æí
 ("ipv6Ñoute")) == 0)

231 
c⁄fig
 = 
	`c⁄fig_gë
 (
IP_NODE
, 
löe
);

232 i‡(
	`°∫cmp
 (
löe
, "key", 
	`°æí
 ("key")) == 0)

233 
c⁄fig
 = 
	`c⁄fig_gë
 (
KEYCHAIN_NODE
, 
löe
);

234 i‡(
	`°∫cmp
 (
löe
, "löe", 
	`°æí
 ("line")) == 0)

235 
c⁄fig
 = 
	`c⁄fig_gë
 (
VTY_NODE
, 
löe
);

236 i‡–(
	`°∫cmp
 (
löe
, "ipv6 forwarding",

237 
	`°æí
 ("ipv6 forwarding")) == 0)

238 || (
	`°∫cmp
 (
löe
, "ip forwarding",

239 
	`°æí
 ("ip forwarding")) == 0) )

240 
c⁄fig
 = 
	`c⁄fig_gë
 (
FORWARDING_NODE
, 
löe
);

241 i‡(
	`°∫cmp
 (
löe
, "£rvi˚", 
	`°æí
 ("service")) == 0)

242 
c⁄fig
 = 
	`c⁄fig_gë
 (
SERVICE_NODE
, 
löe
);

243 i‡(
	`°∫cmp
 (
löe
, "debug", 
	`°æí
 ("debug")) == 0)

244 
c⁄fig
 = 
	`c⁄fig_gë
 (
DEBUG_NODE
, 
löe
);

245 i‡(
	`°∫cmp
 (
löe
, "∑ssw‹d", 
	`°æí
 ("password")) == 0

246 || 
	`°∫cmp
 (
löe
, "enableÖassword",

247 
	`°æí
 ("enableÖassword")) == 0)

248 
c⁄fig
 = 
	`c⁄fig_gë
 (
AAA_NODE
, 
löe
);

249 i‡(
	`°∫cmp
 (
löe
, "ùÖrŸocﬁ", 
	`°æí
 ("ipÖrotocol")) == 0)

250 
c⁄fig
 = 
	`c⁄fig_gë
 (
PROTOCOL_NODE
, 
löe
);

253 i‡(
	`°∫cmp
 (
löe
, "log", 
	`°æí
 ("log")) == 0

254 || 
	`°∫cmp
 (
löe
, "ho°«me", 
	`°æí
 ("hostname")) == 0

256 
	`c⁄fig_add_löe_uniq
 (
c⁄fig_t›
, 
löe
);

258 
	`c⁄fig_add_löe
 (
c⁄fig_t›
, 
löe
);

259 
c⁄fig
 = 
NULL
;

263 
	}
}

266 
	$vtysh_c⁄fig_∑r£
 (*
löe
)

268 *
begö
;

269 *
≤t
;

271 
begö
 = 
≤t
 = 
löe
;

273 *
≤t
 != '\0')

275 i‡(*
≤t
 == '\n')

277 *
≤t
++ = '\0';

278 
	`vtysh_c⁄fig_∑r£_löe
 (
begö
);

279 
begö
 = 
≤t
;

283 
≤t
++;

286 
	}
}

290 
	#NO_DELIMITER
(
I
) \

291 ((
I
Ë=
ACCESS_NODE
 || (IË=
PREFIX_NODE
 || (IË=
IP_NODE
 \

292 || (
I
Ë=
AS_LIST_NODE
 || (IË=
COMMUNITY_LIST_NODE
 || \

293 (
I
Ë=
ACCESS_IPV6_NODE
 || (IË=
PREFIX_IPV6_NODE
 \

294 || (
I
Ë=
SERVICE_NODE
 || (IË=
FORWARDING_NODE
 || (IË=
DEBUG_NODE
 \

295 || (
I
Ë=
AAA_NODE
)

	)

299 
	$vtysh_c⁄fig_dump
 (
FILE
 *
Â
)

301 
li°node
 *
node
, *
¬ode
;

302 
li°node
 *
mnode
, *
m¬ode
;

303 
c⁄fig
 *config;

304 
li°
 *
ma°î
;

305 *
löe
;

306 
i
;

308 
	`ALL_LIST_ELEMENTS
 (
c⁄fig_t›
, 
node
, 
¬ode
, 
löe
))

310 
	`Ârötf
 (
Â
, "%s\n", 
löe
);

311 
	`fÊush
 (
Â
);

313 
	`Ârötf
 (
Â
, "!\n");

314 
	`fÊush
 (
Â
);

316 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
c⁄figvec
); i++)

317 i‡((
ma°î
 = 
	`ve˘‹_¶Ÿ
 (
c⁄figvec
, 
i
)Ë!
NULL
)

319 
	`ALL_LIST_ELEMENTS
 (
ma°î
, 
node
, 
¬ode
, 
c⁄fig
))

321 
	`Ârötf
 (
Â
, "%s\n", 
c⁄fig
->
«me
);

322 
	`fÊush
 (
Â
);

324 
	`ALL_LIST_ELEMENTS
 (
c⁄fig
->
löe
, 
mnode
, 
m¬ode
,Üine))

326 
	`Ârötf
 (
Â
, "%s\n", 
löe
);

327 
	`fÊush
 (
Â
);

329 i‡(! 
	`NO_DELIMITER
 (
i
))

331 
	`Ârötf
 (
Â
, "!\n");

332 
	`fÊush
 (
Â
);

335 i‡(
	`NO_DELIMITER
 (
i
))

337 
	`Ârötf
 (
Â
, "!\n");

338 
	`fÊush
 (
Â
);

342 
i
 = 0; i < 
	`ve˘‹_a˘ive
 (
c⁄figvec
); i++)

343 i‡((
ma°î
 = 
	`ve˘‹_¶Ÿ
 (
c⁄figvec
, 
i
)Ë!
NULL
)

345 
	`li°_dñëe
 (
ma°î
);

346 
	`ve˘‹_¶Ÿ
 (
c⁄figvec
, 
i
Ë
NULL
;

348 
	`li°_dñëe_Æl_node
 (
c⁄fig_t›
);

349 
	}
}

353 
	$vtysh_ªad_fûe
 (
FILE
 *
c⁄Â
)

355 
ªt
;

356 
vty
 *vty;

358 
vty
 = 
	`vty_√w
 ();

359 
vty
->
fd
 = 0;

360 
vty
->
ty≥
 = 
VTY_TERM
;

361 
vty
->
node
 = 
CONFIG_NODE
;

363 
	`vtysh_execuã_no_∑gî
 ("enable");

364 
	`vtysh_execuã_no_∑gî
 ("configureÅerminal");

367 
ªt
 = 
	`vtysh_c⁄fig_‰om_fûe
 (
vty
, 
c⁄Â
);

369 
	`vtysh_execuã_no_∑gî
 ("end");

370 
	`vtysh_execuã_no_∑gî
 ("disable");

372 
	`vty_˛o£
 (
vty
);

374 i‡(
ªt
 !
CMD_SUCCESS
)

376 
ªt
)

378 
CMD_ERR_AMBIGUOUS
:

379 
	`Ârötf
 (
°dîr
, "Ambiguous command.\n");

381 
CMD_ERR_NO_MATCH
:

382 
	`Ârötf
 (
°dîr
, "There isÇo such command.\n");

385 
	`Ârötf
 (
°dîr
, "Error occured duringÑeading belowÜine.\n%s\n",

386 
vty
->
buf
);

387 
	`exô
 (1);

389 
	}
}

393 
	$vtysh_ªad_c⁄fig
 (*
c⁄fig_deÁu…_dú
)

395 
FILE
 *
c⁄Â
 = 
NULL
;

397 
c⁄Â
 = 
	`f›í
 (
c⁄fig_deÁu…_dú
, "r");

398 i‡(
c⁄Â
 =
NULL
)

401 
	`vtysh_ªad_fûe
 (
c⁄Â
);

402 
	`f˛o£
 (
c⁄Â
);

403 
	`ho°_c⁄fig_£t
 (
c⁄fig_deÁu…_dú
);

406 
	}
}

413 
	$vtysh_c⁄fig_wrôe
 ()

415 
löe
[81];

416 
ho°
 host;

418 i‡(
ho°
.
«me
)

420 
	`•rötf
 (
löe
, "ho°«mê%s", 
ho°
.
«me
);

421 
	`vtysh_c⁄fig_∑r£_löe
(
löe
);

423 i‡(
vtysh_wrôec⁄fig_öãgøãd
)

424 
	`vtysh_c⁄fig_∑r£_löe
 ("service integrated-vtysh-config");

425 
	}
}

428 
	$vtysh_c⁄fig_öô
 ()

430 
c⁄fig_t›
 = 
	`li°_√w
 ();

431 
c⁄fig_t›
->
dñ
 = ((*Ë(*))
löe_dñ
;

432 
c⁄figvec
 = 
	`ve˘‹_öô
 (1);

433 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_main.c

22 
	~<zebø.h
>

24 
	~<sys/un.h
>

25 
	~<£tjmp.h
>

26 
	~<sys/waô.h
>

27 
	~<pwd.h
>

29 
	~<ªadlöe/ªadlöe.h
>

30 
	~<ªadlöe/hi°‹y.h
>

32 
	~<lib/vîsi⁄.h
>

33 
	~"gë›t.h
"

34 
	~"comm™d.h
"

35 
	~"mem‹y.h
"

37 
	~"vtysh/vtysh.h
"

38 
	~"vtysh/vtysh_u£r.h
"

41 *
	g¥og«me
;

44 
	gc⁄fig_deÁu…
[] = 
SYSCONFDIR
 
VTYSH_DEFAULT_CONFIG
;

45 
	ghi°‹y_fûe
[
MAXPATHLEN
];

48 
	gexecuã_Êag
 = 0;

51 
sigjmp_buf
 
	gjmpbuf
;

54 
	gjmpÊag
 = 0;

57 *
	glöe_ªad
;

60 
thªad_ma°î
 *
	gma°î
;

63 
FILE
 *
	glogfûe
;

67 
	$sigt°p
 (
sig
)

70 
	`vtysh_execuã
 ("end");

73 
	`æ_öôülize
 ();

74 
	`¥ötf
 ("\n");

77 i‡(! 
jmpÊag
)

80 
jmpÊag
 = 0;

83 
	`sigl⁄gjmp
 (
jmpbuf
, 1);

84 
	}
}

88 
	$sigöt
 (
sig
)

91 i‡(! 
execuã_Êag
)

93 
	`æ_öôülize
 ();

94 
	`¥ötf
 ("\n");

95 
	`æ_f‹˚d_upd©e_di•œy
 ();

97 
	}
}

101 
RETSIGTYPE
 *

102 
vtysh_sig«l_£t
 (
signo
, (*
func
)())

104 
ªt
;

105 
siga˘i⁄
 
sig
;

106 
siga˘i⁄
 
osig
;

108 
sig
.
ß_h™dÀr
 = 
func
;

109 
	`sigem±y£t
 (&
sig
.
ß_mask
);

110 
sig
.
ß_Êags
 = 0;

111 #ifde‡
SA_RESTART


112 
sig
.
ß_Êags
 |
SA_RESTART
;

115 
ªt
 = 
	`siga˘i⁄
 (
signo
, &
sig
, &
osig
);

117 i‡(
ªt
 < 0)

118  (
SIG_ERR
);

120  (
osig
.
ß_h™dÀr
);

121 
	}
}

125 
	$vtysh_sig«l_öô
 ()

127 
	`vtysh_sig«l_£t
 (
SIGINT
, 
sigöt
);

128 
	`vtysh_sig«l_£t
 (
SIGTSTP
, 
sigt°p
);

129 
	`vtysh_sig«l_£t
 (
SIGPIPE
, 
SIG_IGN
);

130 
	}
}

134 
	$ußge
 (
°©us
)

136 i‡(
°©us
 != 0)

137 
	`Ârötf
 (
°dîr
, "Try `%†--hñp' f‹ m‹êöf‹m©i⁄.\n", 
¥og«me
);

139 
	`¥ötf
 ("Usage : %s [OPTION...]\n\n" \

150 "Rï‹àbug†tÿ%s\n", 
¥og«me
, 
ZEBRA_BUG_ADDRESS
);

152 
	`exô
 (
°©us
);

153 
	}
}

156 
›ti⁄
 
	gl⁄g›ts
[] =

158 { "boŸ", 
no_¨gumít
, 
NULL
, 'b'},

160 { "evÆ", 
ªquúed_¨gumít
, 
NULL
, 'e'},

161 { "comm™d", 
ªquúed_¨gumít
, 
NULL
, 'c'},

162 { "d´m⁄", 
ªquúed_¨gumít
, 
NULL
, 'd'},

163 { "echo", 
no_¨gumít
, 
NULL
, 'E'},

164 { "dryrun", 
no_¨gumít
, 
NULL
, 'C'},

165 { "hñp", 
no_¨gumít
, 
NULL
, 'h'},

166 { "n€º‹", 
no_¨gumít
, 
NULL
, 'n'},

172 
	$vtysh_æ_gës
 ()

174 
HIST_ENTRY
 *
œ°
;

177 i‡(
löe_ªad
)

179 
	`‰ì
 (
löe_ªad
);

180 
löe_ªad
 = 
NULL
;

184 
löe_ªad
 = 
	`ªadlöe
 (
	`vtysh_¥om±
 ());

188 i‡(
löe_ªad
 && *line_read)

190 
	`usög_hi°‹y
();

191 
œ°
 = 
	`¥evious_hi°‹y
();

192 i‡(!
œ°
 || 
	`°rcmp
 (œ°->
löe
, 
löe_ªad
) != 0) {

193 
	`add_hi°‹y
 (
löe_ªad
);

194 
	`≠≥nd_hi°‹y
(1,
hi°‹y_fûe
);

198  (
löe_ªad
);

199 
	}
}

201 
	$log_ô
(c⁄° *
löe
)

203 
time_t
 
t
 = 
	`time
(
NULL
);

204 
tm
 *
tmp
 = 
	`loˇ…ime
(&
t
);

205 *
u£r
 = 
	`gëív
("USER") ? : "boot";

206 
tod
[64];

208 
	`°r·ime
(
tod
, Åod, "%Y%m%d-%H:%M.%S", 
tmp
);

210 
	`Ârötf
(
logfûe
, "%s:%†%s\n", 
tod
, 
u£r
, 
löe
);

211 
	}
}

215 
	$maö
 (
¨gc
, **
¨gv
, **
ív
)

217 *
p
;

218 
›t
;

219 
dryrun
 = 0;

220 
boŸ_Êag
 = 0;

221 c⁄° *
d´m⁄_«me
 = 
NULL
;

222 
	scmd_ªc
 {

223 c⁄° *
löe
;

224 
cmd_ªc
 *
√xt
;

225 } *
cmd
 = 
NULL
;

226 
cmd_ªc
 *
èû
 = 
NULL
;

227 
echo_comm™d
 = 0;

228 
no_îr‹
 = 0;

231 
¥og«me
 = ((
p
 = 
	`°ºchr
 (
¨gv
[0], '/')) ? ++p :árgv[0]);

234 i‡((
p
 = 
	`gëív
("VTYSH_LOG")Ë!
NULL
)

235 
logfûe
 = 
	`f›í
(
p
, "a");

240 
›t
 = 
	`gë›t_l⁄g
 (
¨gc
, 
¨gv
, "be:c:d:nEhC", 
l⁄g›ts
, 0);

242 i‡(
›t
 =
EOF
)

245 
›t
)

250 
boŸ_Êag
 = 1;

255 
cmd_ªc
 *
¸
;

256 
¸
 = 
	`XMALLOC
(0, (*cr));

257 
¸
->
löe
 = 
›èrg
;

258 
¸
->
√xt
 = 
NULL
;

259 i‡(
èû
)

260 
èû
->
√xt
 = 
¸
;

262 
cmd
 = 
¸
;

263 
èû
 = 
¸
;

267 
d´m⁄_«me
 = 
›èrg
;

270 
no_îr‹
 = 1;

273 
echo_comm™d
 = 1;

276 
dryrun
 = 1;

279 
	`ußge
 (0);

282 
	`ußge
 (1);

288 
löe_ªad
 = 
NULL
;

289 
	`£éöebuf
(
°dout
);

292 
	`vtysh_sig«l_öô
 ();

295 
	`vtysh_öô_vty
 ();

296 
	`vtysh_öô_cmd
 ();

297 
	`vtysh_u£r_öô
 ();

298 
	`vtysh_c⁄fig_öô
 ();

300 
	`vty_öô_vtysh
 ();

302 
	`s‹t_node
 ();

305 
	`vtysh_ªad_c⁄fig
 (
c⁄fig_deÁu…
);

308 if(
dryrun
)

312 i‡(
no_îr‹
)

313 
	`‰e›í
("/dev/nuŒ", "w", 
°dout
);

316 
	`vtysh_auth
 ();

319 i‡(
	`vtysh_c⁄√˘_Æl
 (
d´m⁄_«me
) <= 0)

321 
	`Ârötf
(
°dîr
, "Exiting: failedÅo connectÅoány daemons.\n");

322 
	`exô
(1);

326 i‡(
cmd
)

329 
	`vtysh_execuã
 ("enable");

331 
cmd
 !
NULL
)

333 
ªt
;

334 *
eﬁ
;

336 (
eﬁ
 = 
	`°rchr
(
cmd
->
löe
, '\n')Ë!
NULL
)

338 *
eﬁ
 = '\0';

340 i‡(
echo_comm™d
)

341 
	`¥ötf
("%s%s\n", 
	`vtysh_¥om±
(), 
cmd
->
löe
);

343 i‡(
logfûe
)

344 
	`log_ô
(
cmd
->
löe
);

346 
ªt
 = 
	`vtysh_execuã_no_∑gî
(
cmd
->
löe
);

347 i‡(!
no_îr‹
 &&

348 ! (
ªt
 =
CMD_SUCCESS
 ||

349 
ªt
 =
CMD_SUCCESS_DAEMON
 ||

350 
ªt
 =
CMD_WARNING
))

351 
	`exô
(1);

353 
cmd
->
löe
 = 
eﬁ
+1;

356 i‡(
echo_comm™d
)

357 
	`¥ötf
("%s%s\n", 
	`vtysh_¥om±
(), 
cmd
->
löe
);

359 i‡(
logfûe
)

360 
	`log_ô
(
cmd
->
löe
);

362 
ªt
 = 
	`vtysh_execuã_no_∑gî
(
cmd
->
löe
);

363 i‡(!
no_îr‹
 &&

364 ! (
ªt
 =
CMD_SUCCESS
 ||

365 
ªt
 =
CMD_SUCCESS_DAEMON
 ||

366 
ªt
 =
CMD_WARNING
))

367 
	`exô
(1);

370 
cmd_ªc
 *
¸
;

371 
¸
 = 
cmd
;

372 
cmd
 = cmd->
√xt
;

373 
	`XFREE
(0, 
¸
);

376 
	`exô
 (0);

380 i‡(
boŸ_Êag
)

382 i‡(
	`vtysh_ªad_c⁄fig
 (
öãgøã_deÁu…
))

384 
	`Ârötf
 (
°dîr
, "Can't open configuration file [%s]\n",

385 
öãgøã_deÁu…
);

386 
	`exô
 (1);

389 
	`exô
 (0);

392 
	`vtysh_∑gî_öô
 ();

394 
	`vtysh_ªadlöe_öô
 ();

396 
	`vty_hñlo
 (
vty
);

399 
	`vtysh_execuã
 ("enable");

402 
	`sig£tjmp
 (
jmpbuf
, 1);

403 
jmpÊag
 = 1;

405 
	`¢¥ötf
(
hi°‹y_fûe
, (hi°‹y_fûe), "%s/.hi°‹y_quagga", 
	`gëív
("HOME"));

406 
	`ªad_hi°‹y
(
hi°‹y_fûe
);

408 
	`vtysh_æ_gës
 ())

409 
	`vtysh_execuã
 (
löe_ªad
);

411 
	`hi°‹y_åunˇã_fûe
(
hi°‹y_fûe
,1000);

412 
	`¥ötf
 ("\n");

415 
	`exô
 (0);

416 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_user.c

22 
	~<zebø.h
>

23 
	~<lib/vîsi⁄.h
>

25 
	~<pwd.h
>

27 #ifde‡
USE_PAM


28 
	~<£curôy/∑m_≠∂.h
>

29 #ifde‡
HAVE_PAM_MISC_H


30 
	~<£curôy/∑m_misc.h
>

32 #ifde‡
HAVE_OPENPAM_H


33 
	~<£curôy/›í∑m.h
>

37 
	~"mem‹y.h
"

38 
	~"lökli°.h
"

39 
	~"comm™d.h
"

41 #ifde‡
USE_PAM


42 
∑m_c⁄v
 
	gc⁄v
 =

44 
PAM_CONV_FUNC
,

45 
NULL


49 
	$vtysh_∑m
 (c⁄° *
u£r
)

51 
ªt
;

52 
∑m_h™dÀ_t
 *
∑mh
 = 
NULL
;

55 
ªt
 = 
	`∑m_°¨t
(
QUAGGA_PROGNAME
, 
u£r
, &
c⁄v
, &
∑mh
);

59 i‡(
ªt
 =
PAM_SUCCESS
)

60 
ªt
 = 
	`∑m_authítiˇã
 (
∑mh
, 0);

65 i‡(
ªt
 =
PAM_SUCCESS
)

66 
ªt
 = 
	`∑m_ac˘_mgmt
 (
∑mh
, 0);

67 
	`¥ötf
 ("ªà%d\n", 
ªt
);

69 i‡(
ªt
 =
PAM_AUTHINFO_UNAVAIL
)

70 
ªt
 = 
PAM_SUCCESS
;

74 #ifde‡
DEBUG


75 i‡(
ªt
 =
PAM_SUCCESS
)

76 
	`¥ötf
("Authenticated\n");

78 
	`¥ötf
("Not Authenticated\n");

82 i‡(
	`∑m_íd
 (
∑mh
, 
ªt
Ë!
PAM_SUCCESS
)

84 
∑mh
 = 
NULL
;

85 
	`Ârötf
(
°dîr
, "vtysh_pam: failedÅoÑeleaseáuthenticator\n");

86 
	`exô
(1);

89  
ªt
 =
PAM_SUCCESS
 ? 0 : 1;

90 
	}
}

93 
	svtysh_u£r


95 *
	m«me
;

96 
u_ch¨
 
	mn›assw‹d
;

99 
li°
 *
	gu£æi°
;

101 
vtysh_u£r
 *

102 
	$u£r_√w
 ()

104  
	`XCALLOC
 (0,  (
vtysh_u£r
));

105 
	}
}

108 
	$u£r_‰ì
 (
vtysh_u£r
 *
u£r
)

110 
	`XFREE
 (0, 
u£r
);

111 
	}
}

113 
vtysh_u£r
 *

114 
	$u£r_lookup
 (c⁄° *
«me
)

116 
li°node
 *
node
, *
¬ode
;

117 
vtysh_u£r
 *
u£r
;

119 
	`ALL_LIST_ELEMENTS
 (
u£æi°
, 
node
, 
¬ode
, 
u£r
))

121 i‡(
	`°rcmp
 (
u£r
->
«me
,Çame) == 0)

122  
u£r
;

124  
NULL
;

125 
	}
}

128 
	$u£r_c⁄fig_wrôe
 ()

130 
li°node
 *
node
, *
¬ode
;

131 
vtysh_u£r
 *
u£r
;

133 
	`ALL_LIST_ELEMENTS
 (
u£æi°
, 
node
, 
¬ode
, 
u£r
))

135 i‡(
u£r
->
n›assw‹d
)

136 
	`¥ötf
 (" u£∫amê%†n›assw‹d\n", 
u£r
->
«me
);

138 
	}
}

140 
vtysh_u£r
 *

141 
	$u£r_gë
 (c⁄° *
«me
)

143 
vtysh_u£r
 *
u£r
;

144 
u£r
 = 
	`u£r_lookup
 (
«me
);

145 i‡(
u£r
)

146  
u£r
;

148 
u£r
 = 
	`u£r_√w
 ();

149 
u£r
->
«me
 = 
	`°rdup
 (name);

150 
	`li°node_add
 (
u£æi°
, 
u£r
);

152  
u£r
;

153 
	}
}

155 
DEFUN
 (
u£∫ame_n›assw‹d
,

156 
u£∫ame_n›assw‹d_cmd
,

162 
vtysh_u£r
 *
	gu£r
;

163 
	gu£r
 = 
u£r_gë
 (
¨gv
[0]);

164 
	gu£r
->
	gn›assw‹d
 = 1;

165  
	gCMD_SUCCESS
;

169 
	$vtysh_auth
 ()

171 
vtysh_u£r
 *
u£r
;

172 
∑sswd
 *passwd;

174 
∑sswd
 = 
	`gëpwuid
 (
	`gëeuid
 ());

176 
u£r
 = 
	`u£r_lookup
 (
∑sswd
->
pw_«me
);

177 i‡(
u£r
 && u£r->
n›assw‹d
)

181 #ifde‡
USE_PAM


182 i‡(
	`vtysh_∑m
 (
∑sswd
->
pw_«me
))

183 
	`exô
 (0);

187 
	}
}

190 
	$vtysh_u£r_öô
 ()

192 
u£æi°
 = 
	`li°_√w
 ();

193 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
u£∫ame_n›assw‹d_cmd
);

194 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_user.h

22 #i‚de‡
_VTYSH_USER_H


23 
	#_VTYSH_USER_H


	)

25 
vtysh_auth
 ();

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/watchquagga/watchquagga.c

21 
	~<zebø.h
>

22 
	~<thªad.h
>

23 
	~<log.h
>

24 
	~<√tw‹k.h
>

25 
	~<sigevít.h
>

26 
	~<lib/vîsi⁄.h
>

27 
	~<gë›t.h
>

28 
	~<sys/un.h
>

29 
	~<sys/waô.h
>

30 
	~<mem‹y.h
>

32 #i‚de‡
MIN


33 
	#MIN
(
X
,
Y
Ë(((XË<(Y)Ë? (XË: (Y))

	)

37 
	#JITTER
(
X
Ë((
	`øndom
(Ë% ((X)+1))-((X)/2))

	)

38 
	#FUZZY
(
X
Ë((X)+
	`JITTER
((X)/20))

	)

40 
	#DEFAULT_PERIOD
 5

	)

41 
	#DEFAULT_TIMEOUT
 10

	)

42 
	#DEFAULT_RESTART_TIMEOUT
 20

	)

43 
	#DEFAULT_LOGLEVEL
 
LOG_INFO


	)

44 
	#DEFAULT_MIN_RESTART
 60

	)

45 
	#DEFAULT_MAX_RESTART
 600

	)

46 #ifde‡
PATH_WATCHQUAGGA_PID


47 
	#DEFAULT_PIDFILE
 
PATH_WATCHQUAGGA_PID


	)

49 
	#DEFAULT_PIDFILE
 
STATEDIR
 "/w©chquagga.pid"

	)

51 #ifde‡
DAEMON_VTY_DIR


52 
	#VTYDIR
 
DAEMON_VTY_DIR


	)

54 
	#VTYDIR
 
STATEDIR


	)

57 
	#PING_TOKEN
 "PING"

	)

60 
thªad_ma°î
 *
	gma°î
;

64 
	mMODE_MONITOR
 = 0,

65 
	mMODE_GLOBAL_RESTART
,

66 
	mMODE_SEPARATE_RESTART
,

67 
	mMODE_PHASED_ZEBRA_RESTART
,

68 
	mMODE_PHASED_ALL_RESTART


69 } 
	tw©ch_mode_t
;

71 c⁄° *
	gmode_°r
[] =

82 
	mPHASE_NONE
 = 0,

83 
	mPHASE_STOPS_PENDING
,

84 
	mPHASE_WAITING_DOWN
,

85 
	mPHASE_ZEBRA_RESTART_PENDING
,

86 
	mPHASE_WAITING_ZEBRA_UP


87 } 
	tª°¨t_pha£_t
;

89 c⁄° *
	gpha£_°r
[] =

99 
	#PHASE_TIMEOUT
 (3*
gs
.
ª°¨t_timeout
)

	)

101 
	sª°¨t_öfo


103 c⁄° *
	m«me
;

104 c⁄° *
	mwh©
;

105 
pid_t
 
	mpid
;

106 
timevÆ
 
	mtime
;

107 
	möãrvÆ
;

108 
thªad
 *
	mt_kûl
;

109 
	mkûls
;

112 
	sglobÆ_°©e


114 
w©ch_mode_t
 
	mmode
;

115 
ª°¨t_pha£_t
 
	mpha£
;

116 
thªad
 *
	mt_pha£_h™gög
;

117 c⁄° *
	mvtydú
;

118 
	m≥riod
;

119 
	mtimeout
;

120 
	mª°¨t_timeout
;

121 
	mmö_ª°¨t_öãrvÆ
;

122 
	mmax_ª°¨t_öãrvÆ
;

123 
	mdo_pög
;

124 
d´m⁄
 *
	md´m⁄s
;

125 c⁄° *
	mª°¨t_comm™d
;

126 c⁄° *
	m°¨t_comm™d
;

127 c⁄° *
	m°›_comm™d
;

128 
ª°¨t_öfo
 
	mª°¨t
;

129 
	muƒe•⁄sive_ª°¨t
;

130 
	mlogÀvñ
;

131 
d´m⁄
 *
	m•ecül
;

132 
	mnumd´m⁄s
;

133 
	mnumpids
;

134 
	mnumdown
;

135 } 
	ggs
 = {

136 .
mode
 = 
MODE_MONITOR
,

137 .
	gpha£
 = 
PHASE_NONE
,

138 .
	gvtydú
 = 
VTYDIR
,

139 .
	g≥riod
 = 1000*
DEFAULT_PERIOD
,

140 .
	gtimeout
 = 
DEFAULT_TIMEOUT
,

141 .
	gª°¨t_timeout
 = 
DEFAULT_RESTART_TIMEOUT
,

142 .
	glogÀvñ
 = 
DEFAULT_LOGLEVEL
,

143 .
	gmö_ª°¨t_öãrvÆ
 = 
DEFAULT_MIN_RESTART
,

144 .
	gmax_ª°¨t_öãrvÆ
 = 
DEFAULT_MAX_RESTART
,

145 .
	gdo_pög
 = 1,

150 
	mDAEMON_INIT
,

151 
	mDAEMON_DOWN
,

152 
	mDAEMON_CONNECTING
,

153 
	mDAEMON_UP
,

154 
	mDAEMON_UNRESPONSIVE


155 } 
	td´m⁄_°©e_t
;

157 
	#IS_UP
(
DMN
) \

158 (((
DMN
)->
°©e
 =
DAEMON_UP
Ë|| ((DMN)->°©ê=
DAEMON_UNRESPONSIVE
))

	)

160 c⁄° *
	g°©e_°r
[] =

169 
	sd´m⁄
 {

170 c⁄° *
	m«me
;

171 
d´m⁄_°©e_t
 
	m°©e
;

172 
	mfd
;

173 
timevÆ
 
	mecho_£¡
;

174 
u_öt
 
	mc⁄√˘_åõs
;

175 
thªad
 *
	mt_wakeup
;

176 
thªad
 *
	mt_ªad
;

177 
thªad
 *
	mt_wrôe
;

178 
d´m⁄
 *
	m√xt
;

179 
ª°¨t_öfo
 
	mª°¨t
;

182 c⁄° 
›ti⁄
 
	gl⁄g›ts
[] =

184 { "d´m⁄", 
no_¨gumít
, 
NULL
, 'd'},

185 { "°©edú", 
ªquúed_¨gumít
, 
NULL
, 'S'},

186 { "no-echo", 
no_¨gumít
, 
NULL
, 'e'},

187 { "logÀvñ", 
ªquúed_¨gumít
, 
NULL
, 'l'},

188 { "öãrvÆ", 
ªquúed_¨gumít
, 
NULL
, 'i'},

189 { "timeout", 
ªquúed_¨gumít
, 
NULL
, 't'},

190 { "ª°¨t-timeout", 
ªquúed_¨gumít
, 
NULL
, 'T'},

191 { "ª°¨t", 
ªquúed_¨gumít
, 
NULL
, 'r'},

192 { "°¨t-comm™d", 
ªquúed_¨gumít
, 
NULL
, 's'},

193 { "kûl-comm™d", 
ªquúed_¨gumít
, 
NULL
, 'k'},

194 { "ª°¨t-Æl", 
ªquúed_¨gumít
, 
NULL
, 'R'},

195 { "Æl-ª°¨t", 
no_¨gumít
, 
NULL
, 'a'},

196 { "Æways-Æl-ª°¨t", 
no_¨gumít
, 
NULL
, 'A'},

197 { "uƒe•⁄sive-ª°¨t", 
no_¨gumít
, 
NULL
, 'z'},

198 { "mö-ª°¨t-öãrvÆ", 
ªquúed_¨gumít
, 
NULL
, 'm'},

199 { "max-ª°¨t-öãrvÆ", 
ªquúed_¨gumít
, 
NULL
, 'M'},

200 { "pid-fûe", 
ªquúed_¨gumít
, 
NULL
, 'p'},

201 { "bœnk-°rög", 
ªquúed_¨gumít
, 
NULL
, 'b'},

202 { "hñp", 
no_¨gumít
, 
NULL
, 'h'},

203 { "vîsi⁄", 
no_¨gumít
, 
NULL
, 'v'},

204 { 
NULL
, 0, NULL, 0 }

207 
åy_c⁄√˘
(
d´m⁄
 *
dmn
);

208 
wakeup_£nd_echo
(
thªad
 *
t_wakeup
);

209 
åy_ª°¨t
(
d´m⁄
 *
dmn
);

210 
pha£_check
();

213 
	$ußge
(c⁄° *
¥og«me
, 
°©us
)

215 i‡(
°©us
 != 0)

216 
	`Ârötf
(
°dîr
, "Try `%†--hñp' f‹ m‹êöf‹m©i⁄.\n", 
¥og«me
);

218 
	`¥ötf
("Ußgê: %†[OPTION...] <d´m⁄Çame> ...\n\n\
ÖrogømÅÿm⁄ô‹ sètu†o‡quagg®d´m⁄†™dÅryÅÿª°¨t\n\
 i‡theyáª dow¿‹ uƒe•⁄sive. Iàdëîmöe†whëhîá d´m⁄ is\n\
 ba£d o¿whëhî iàˇ¿c⁄√˘Åÿthêd´m⁄'†vty unix såóm sockë.\n\
ÅhíÑïóãdly síd†echÿcomm™d†ovîÅh© sockëÅÿdëîmöêwhëhî\n\
 d´m⁄ i†ª•⁄sive. I‡thêd´m⁄ cøshes, wêwû»ª˚ivê™ EOF\n\
Åhêsockë c⁄√˘i⁄ánd know immedüãlyÅh©Åhêd´m⁄ i†down.\n\n\
 d´m⁄†tÿbêm⁄ô‹ed should bêli°ed o¿thêcomm™dÜöe.\n\n\
Örogøm c™Ñu¿ö o√ o‡5 modes:\n\n\
0. Mode: %s.\n\
 m⁄ô‹ándÑï‹à⁄ sètu†ch™ges. Exam∂e:\n\
%†-d zebø o•fd bgpd\n\n\
1. Mode: %s.\n\
ány d´m⁄ h™g†‹ cøshes, u£Åhêgiví comm™dÅÿª°¨t\n\
áŒ. Exam∂e:\n\
%†-dz \\\n\
-R '/sbö/£rvi˚ zebøÑe°¨t; /sbö/£rvi˚ o•fdÑe°¨t' \\\n\
 o•fd\n\n\
2. Mode: %s.\n\
ány sögÀ d´m⁄ h™g†‹ cøshes,Ñe°¨à⁄lyÅhêd´m⁄Åh©'s\n\
ÅroubÀ usögÅhêsuµlõdÑe°¨àcomm™d. Exam∂e:\n\
%†-dz -∏'/sbö/£rvi˚ %%†ª°¨t' zebø o•fd bgpd\n\n\
3. Mode: %s.\n\
 samêa†thê¥eviou†mode,Éx˚±Åh©Åhîêi†•ecü»åótmíàwhí\n\
 zebø d´m⁄ i†öÅroubÀ. I¿th© ca£,áÖha£dÑe°¨à≠¥ﬂch\n\
 u£d: 1. st›áŒ othî d´m⁄s; 2.Ñe°¨àzebø; 3. sèπÅhêŸhî\n\
. Exam∂e:\n\
%†-adz -∏'/sbö/£rvi˚ %%†ª°¨t' \\\n\
-†'/sbö/£rvi˚ %%†°¨t' \\\n\
-k '/sbö/£rvi˚ %%†°›' zebø o•fd bgpd\n\n\
4. Mode: %s.\n\
 i†thêßmêa†thê¥eviou†mode,Éx˚±Åh©Åhêpha£dÑe°¨t\n\
 i†u£d whíevîány o‡thêd´m⁄†h™g†‹ cøshes. Exam∂e:\n\
%†-Adz -∏'/sbö/£rvi˚ %%†ª°¨t' \\\n\
-†'/sbö/£rvi˚ %%†°¨t' \\\n\
-k '/sbö/£rvi˚ %%†°›' zebø o•fd bgpd\n\n\
 o‡thi†wrôög, iài†bñõvedÅh© modê2 [%s]\n\
ÇŸ sa„,ánd modê3 [%s] mayÇŸ bêß„ wôh somêo‡the\n\
 d´m⁄s.\n\n\
 ordîÅÿavoidáâem±ögÅÿª°¨àthêd´m⁄†öá fa°Üo›,\n\
 -mánd -M o±i⁄†Ælow youÅÿc⁄åﬁÅhêmöimum dñay bëwìn\n\
 comm™ds. ThêmöimumÑe°¨àdñay i†ªˇlcuœãdÉachÅime\n\
Ñe°¨ài†©ãm±ed: i‡thêtimêsö˚Åhêœ°Ñe°¨à©ãm±Éx˚eds\n\
Åhê-M vÆue,ÅhíÅhêª°¨àdñay i†£àtÿthê-m vÆue.\n\
,ÅhêöãrvÆ i†doubÀd (buàˇµedáàthê-M vÆue).\n\n\
:\n\
-d, --d´m⁄ Ru¿ö d´m⁄ mode. I¿thi†mode,Éº‹ mesßge†¨ê£¡\n\
 sy¶og in°ód o‡°dout.\n\
-S, --°©edú SëÅhêvty sockë dúe˘‹y (deÁu… i†%s)\n\
-e, --no-echo DÿnŸÖögÅhêd´m⁄†tÿã°Ñe•⁄sivíes†—his\n\
 i†√˚sßry i‡thêd´m⁄†dÿnŸ suµ‹àthe\n\
 comm™d)\n\
-l, --logÀvñ SëÅhêloggögÜevñ (deÁu… i†%d).\n\
 vÆuêshouldÑ™gê‰om %d (LOG_EMERGËtÿ%d (LOG_DEBUG),\n\
 iàˇ¿bê£àhighîÅh™ %d i‡exåa-vîbo£ debuggög\n\
áª desúed.\n\
-m, --mö-ª°¨t-öãrvÆ\n\
Åhêmöimum sec⁄d†tÿwaô bëwì¿övoˇti⁄†o‡d´m⁄\n\
 comm™d†(deÁu… i†%d).\n\
-M, --max-ª°¨t-öãrvÆ\n\
Åhêmaximum sec⁄d†tÿwaô bëwì¿övoˇti⁄†o‡d´m⁄\n\
 comm™d†(deÁu… i†%d).\n\
-i, --öãrvÆ SëÅhê°©u†pﬁlög i¡îvÆ i¿£c⁄d†(deÁu… i†%d)\n\
-t, --timeout SëÅhêuƒe•⁄sivíes†timeouàö sec⁄d†(deÁu… i†%d)\n\
-T, --ª°¨t-timeout\n\
Åhêª°¨à(kûlËtimeouàö sec⁄d†(deÁu… i†%d).\n\
ány background job†¨ê°û»ru¬ögá·îÅhi†much\n\
 ha†ñ≠£d,Åhey wû»bêkûÀd.\n\
-r, --ª°¨t Suµlyá Bou∫êshñ»comm™dÅÿu£Åÿª°¨à®sögÀ\n\
. Thêcomm™d såög should in˛udê'%%s' whîêthe\n\
 o‡thêd´m⁄ should bêsub°ôuãd.\n\
Åh© -∏™d -Ráª incom∑tibÀ.\n\
-s, --°¨t-comm™d\n\
á Bou∫êshñ»tÿcomm™dÅÿu£Åÿ°¨à®sögÀ\n\
. Thêcomm™d såög should in˛udê'%%s' whîêthe\n\
 o‡thêd´m⁄ should bêsub°ôuãd.\n\
-k, --kûl-comm™d\n\
á Bou∫êshñ»tÿcomm™dÅÿu£Åÿ°›á sögÀ\n\
. Thêcomm™d såög should in˛udê'%%s' whîêthe\n\
 o‡thêd´m⁄ should bêsub°ôuãd.\n\
-R, --ª°¨t-Æl\n\
 o√ o∏m‹êd´m⁄†i†down,ÅryÅÿª°¨àevîythög\n\
ÅhêBou∫êshñ»comm™d suµlõdá†thê¨gumít.\n\
Åh© -∏™d -Ráª incom∑tibÀ.\n\
-z, --uƒe•⁄sive-ª°¨t\n\
á d´m⁄ i†uƒe•⁄sive,Åª© iàa†beög dow¿f‹\n\
ÖuΩo£s.\n\
-a, --Æl-ª°¨t\n\
 zebø h™g†‹ cøshes,Ñe°¨àÆ»d´m⁄†usög\n\
Öha£dáµrﬂch: 1. st›áŒ othî d´m⁄s; 2.Ñe°¨t\n\
; 3. sèπ othî d´m⁄s. Requúe†-r, -s,ánd -k.\n\
-A, --Æways-Æl-ª°¨t\n\
ány d´m⁄ (nŸ ju° zebøËh™g†‹ cøshes, u£Åhe\n\
Öha£dÑe°¨àmech™ism des¸ibedábovêf‹ -a.\n\
 -r, -s,ánd -k.\n\
-p, --pid-fûe SëÖro˚s†idítifõ∏fûê«me\n\
(deÁu… i†%s).\n\
-b, --bœnk-°rög\n\
Åhêsuµlõdárgumíà°rög i†found i¿™y o‡the\n\
 shñ»comm™dárgumít†(-r, -s, -k, o∏-R),Ñïœ˚\n\
 wôhá s∑˚. Thi†i†™ ugly hackÅÿcúcumvíà¥obÀms\n\
 comm™d-löê¨gumít†wôhÉmbedded s∑˚s.\n\
-v, --vîsi⁄ Pröà¥ogøm vîsi⁄\n\
-h, --hñp Di•œyÅhi†hñ∞™dÉxô\n\
", 
¥og«me
,
mode_°r
[0],progname,mode_str[1],progname,mode_str[2],

323 
¥og«me
,
mode_°r
[3],progname,mode_str[4],progname,mode_str[2],mode_str[3],

324 
VTYDIR
,
DEFAULT_LOGLEVEL
,
LOG_EMERG
,
LOG_DEBUG
,LOG_DEBUG,

325 
DEFAULT_MIN_RESTART
,
DEFAULT_MAX_RESTART
,

326 
DEFAULT_PERIOD
,
DEFAULT_TIMEOUT
,
DEFAULT_RESTART_TIMEOUT
,
DEFAULT_PIDFILE
);

328  
°©us
;

329 
	}
}

331 
pid_t


332 
	$run_background
(c⁄° *
shñl_cmd
)

334 
pid_t
 
chûd
;

336 
chûd
 = 
	`f‹k
())

339 
	`zlog_îr
("fork failed, cannotÑun command [%s]: %s",

340 
shñl_cmd
,
	`ß„_°ªº‹
(
î∫o
));

345 i‡(
	`£çgid
(0,0) < 0)

346 
	`zlog_w¨n
("w¨nög: sëpgid(0,0ËÁûed: %s",
	`ß„_°ªº‹
(
î∫o
));

348 c⁄° *
¨gv
[4] = { "sh", "-c", 
shñl_cmd
, 
NULL
};

349 
	`execv
("/bö/sh",(*c⁄° *)
¨gv
);

350 
	`zlog_îr
("execv(/bin/sh -c '%s') failed: %s",

351 
shñl_cmd
,
	`ß„_°ªº‹
(
î∫o
));

352 
	`_exô
(127);

356 
	`zlog_îr
("F‹ked background comm™d [pid %d]: %s",()
chûd
,
shñl_cmd
);

357  
chûd
;

359 
	}
}

361 
timevÆ
 *

362 
	$time_ñ≠£d
(
timevÆ
 *
ªsu…
, c⁄° timevÆ *
°¨t_time
)

364 
	`gëtimeofday
(
ªsu…
,
NULL
);

365 
ªsu…
->
tv_£c
 -
°¨t_time
->tv_sec;

366 
ªsu…
->
tv_u£c
 -
°¨t_time
->tv_usec;

367 
ªsu…
->
tv_u£c
 < 0)

369 
ªsu…
->
tv_u£c
 += 1000000L;

370 
ªsu…
->
tv_£c
--;

372  
ªsu…
;

373 
	}
}

376 
	$ª°¨t_kûl
(
thªad
 *
t_kûl
)

378 
ª°¨t_öfo
 *
ª°¨t
 = 
	`THREAD_ARG
(
t_kûl
);

379 
timevÆ
 
dñay
;

381 
	`time_ñ≠£d
(&
dñay
,&
ª°¨t
->
time
);

382 
	`zlog_w¨n
("Warning: %s %s childÖrocess %d stillÑunningáfter "

384 
ª°¨t
->
wh©
,ª°¨t->
«me
,(Ïe°¨t->
pid
,
dñay
.
tv_£c
,

385 (
ª°¨t
->
kûls
 ? 
SIGKILL
 : 
SIGTERM
));

386 
	`kûl
(-
ª°¨t
->
pid
,‘e°¨t->
kûls
 ? 
SIGKILL
 : 
SIGTERM
));

387 
ª°¨t
->
kûls
++;

388 
ª°¨t
->
t_kûl
 = 
	`thªad_add_timî
(
ma°î
,
ª°¨t_kûl
,restart,

389 
gs
.
ª°¨t_timeout
);

391 
	}
}

393 
ª°¨t_öfo
 *

394 
	$föd_chûd
(
pid_t
 
chûd
)

396 i‡(
gs
.
mode
 =
MODE_GLOBAL_RESTART
)

398 i‡(
gs
.
ª°¨t
.
pid
 =
chûd
)

399  &
gs
.
ª°¨t
;

403 
d´m⁄
 *
dmn
;

404 
dmn
 = 
gs
.
d´m⁄s
; dmn; dm¿dmn->
√xt
)

406 i‡(
dmn
->
ª°¨t
.
pid
 =
chûd
)

407  &
dmn
->
ª°¨t
;

410  
NULL
;

411 
	}
}

414 
	$sigchûd
()

416 
pid_t
 
chûd
;

417 
°©us
;

418 c⁄° *
«me
;

419 c⁄° *
wh©
;

420 
ª°¨t_öfo
 *
ª°¨t
;

422 
chûd
 = 
	`waôpid
(-1,&
°©us
,
WNOHANG
))

425 
	`zlog_îr
("waôpid faûed: %s",
	`ß„_°ªº‹
(
î∫o
));

428 
	`zlog_w¨n
("SIGCHLDÑeceived, but waitpid didÇotÑeapá child");

432 i‡((
ª°¨t
 = 
	`föd_chûd
(
chûd
)Ë!
NULL
)

434 
«me
 = 
ª°¨t
->name;

435 
wh©
 = 
ª°¨t
->what;

436 
ª°¨t
->
pid
 = 0;

437 
gs
.
numpids
--;

438 
	`thªad_ˇn˚l
(
ª°¨t
->
t_kûl
);

439 
ª°¨t
->
t_kûl
 = 
NULL
;

441 
	`gëtimeofday
(&
ª°¨t
->
time
,
NULL
);

445 
	`zlog_îr
("waitpidÑeturned status forán unknown childÖrocess %d",

446 ()
chûd
);

447 
«me
 = "(unknown)";

448 
wh©
 = "background";

450 i‡(
	`WIFSTOPPED
(
°©us
))

451 
	`zlog_w¨n
("warning: %s %sÖrocess %d is stopped",

452 
wh©
,
«me
,()
chûd
);

453 i‡(
	`WIFSIGNALED
(
°©us
))

454 
	`zlog_w¨n
("%s %sÖrocess %dÅerminated dueÅo signal %d",

455 
wh©
,
«me
,()
chûd
,
	`WTERMSIG
(
°©us
));

456 i‡(
	`WIFEXITED
(
°©us
))

458 i‡(
	`WEXITSTATUS
(
°©us
) != 0)

459 
	`zlog_w¨n
("%s %sÖrocess %dÉxited withÇon-zero status %d",

460 
wh©
,
«me
,()
chûd
,
	`WEXITSTATUS
(
°©us
));

462 
	`zlog_debug
("%†%†¥o˚s†%dÉxôedÇ‹mÆly",
wh©
,
«me
,()
chûd
);

465 
	`zlog_îr
("cannot interpret %s %sÖrocess %d wait status 0x%x",

466 
wh©
,
«me
,()
chûd
,
°©us
);

467 
	`pha£_check
();

468 
	}
}

471 
	$run_job
(
ª°¨t_öfo
 *
ª°¨t
, c⁄° *
cmdty≥
, c⁄° *
comm™d
,

472 
f‹˚
, 
upd©e_öãrvÆ
)

474 
timevÆ
 
dñay
;

476 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

477 
	`zlog_debug
("©ãm±ögÅÿ%†%s",
cmdty≥
,
ª°¨t
->
«me
);

479 i‡(
ª°¨t
->
pid
)

481 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

482 
	`zlog_debug
("cannot %s %s,ÖreviousÖid %d stillÑunning",

483 
cmdty≥
,
ª°¨t
->
«me
,(Ïe°¨t->
pid
);

490 i‡((
	`time_ñ≠£d
(&
dñay
,&
ª°¨t
->
time
)->
tv_£c
 <Ñe°¨t->
öãrvÆ
) &&

491 !
f‹˚
)

493 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

494 
	`zlog_debug
("postponing %s %s: "

496 
cmdty≥
,
ª°¨t
->
«me
,()
dñay
.
tv_£c
,ª°¨t->
öãrvÆ
);

500 
	`gëtimeofday
(&
ª°¨t
->
time
,
NULL
);

501 
ª°¨t
->
kûls
 = 0;

503 
cmd
[
	`°æí
(
comm™d
)+°æí(
ª°¨t
->
«me
)+1];

504 
	`¢¥ötf
(
cmd
,(cmd),
comm™d
,
ª°¨t
->
«me
);

505 i‡((
ª°¨t
->
pid
 = 
	`run_background
(
cmd
)) > 0)

507 
ª°¨t
->
t_kûl
 = 
	`thªad_add_timî
(
ma°î
,
ª°¨t_kûl
,restart,

508 
gs
.
ª°¨t_timeout
);

509 
ª°¨t
->
wh©
 = 
cmdty≥
;

510 
gs
.
numpids
++;

513 
ª°¨t
->
pid
 = 0;

517 i‡(
upd©e_öãrvÆ
)

519 i‡(
dñay
.
tv_£c
 > 2*
gs
.
max_ª°¨t_öãrvÆ
)

520 
ª°¨t
->
öãrvÆ
 = 
gs
.
mö_ª°¨t_öãrvÆ
;

521 i‡((
ª°¨t
->
öãrvÆ
 *2Ë> 
gs
.
max_ª°¨t_öãrvÆ
)

522 
ª°¨t
->
öãrvÆ
 = 
gs
.
max_ª°¨t_öãrvÆ
;

523 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

524 
	`zlog_debug
("restart %s interval isÇow %ld",

525 
ª°¨t
->
«me
,ª°¨t->
öãrvÆ
);

527  
ª°¨t
->
pid
;

528 
	}
}

530 
	#SET_READ_HANDLER
(
DMN
) \

531 (
DMN
)->
t_ªad
 = 
	`thªad_add_ªad
(
ma°î
,
h™dÀ_ªad
,(DMN),(DMN)->
fd
)

	)

533 
	#SET_WAKEUP_DOWN
(
DMN
) \

534 (
DMN
)->
t_wakeup
 = 
	`thªad_add_timî_m£c
(
ma°î
,
wakeup_down
,(DMN), \

535 
	`FUZZY
(
gs
.
≥riod
))

	)

537 
	#SET_WAKEUP_UNRESPONSIVE
(
DMN
) \

538 (
DMN
)->
t_wakeup
 = 
	`thªad_add_timî_m£c
(
ma°î
,
wakeup_uƒe•⁄sive
,(DMN), \

539 
	`FUZZY
(
gs
.
≥riod
))

	)

541 
	#SET_WAKEUP_ECHO
(
DMN
) \

542 (
DMN
)->
t_wakeup
 = 
	`thªad_add_timî_m£c
(
ma°î
,
wakeup_£nd_echo
,(DMN), \

543 
	`FUZZY
(
gs
.
≥riod
))

	)

546 
	$wakeup_down
(
thªad
 *
t_wakeup
)

548 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_wakeup
);

550 
dmn
->
t_wakeup
 = 
NULL
;

551 i‡(
	`åy_c⁄√˘
(
dmn
) < 0)

552 
	`SET_WAKEUP_DOWN
(
dmn
);

553 i‡((
dmn
->
c⁄√˘_åõs
 > 1Ë&& (dmn->
°©e
 !
DAEMON_UP
))

554 
	`åy_ª°¨t
(
dmn
);

556 
	}
}

559 
	$wakeup_öô
(
thªad
 *
t_wakeup
)

561 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_wakeup
);

563 
dmn
->
t_wakeup
 = 
NULL
;

564 i‡(
	`åy_c⁄√˘
(
dmn
) < 0)

566 
	`SET_WAKEUP_DOWN
(
dmn
);

567 
	`zlog_îr
("%s state -> down : initial connectionáttempt failed",

568 
dmn
->
«me
);

569 
dmn
->
°©e
 = 
DAEMON_DOWN
;

572 
	}
}

575 
	$d´m⁄_down
(
d´m⁄
 *
dmn
, c⁄° *
why
)

577 i‡(
	`IS_UP
(
dmn
Ë|| (dmn->
°©e
 =
DAEMON_INIT
))

578 
	`zlog_îr
("%†°©ê-> dow¿: %s",
dmn
->
«me
,
why
);

579 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
)

580 
	`zlog_debug
("%†°û»dow¿: %s",
dmn
->
«me
,
why
);

581 i‡(
	`IS_UP
(
dmn
))

582 
gs
.
numdown
++;

583 
dmn
->
°©e
 = 
DAEMON_DOWN
;

584 i‡(
dmn
->
fd
 >= 0)

586 
	`˛o£
(
dmn
->
fd
);

587 
dmn
->
fd
 = -1;

589 
	`THREAD_OFF
(
dmn
->
t_ªad
);

590 
	`THREAD_OFF
(
dmn
->
t_wrôe
);

591 
	`THREAD_OFF
(
dmn
->
t_wakeup
);

592 i‡(
	`åy_c⁄√˘
(
dmn
) < 0)

593 
	`SET_WAKEUP_DOWN
(
dmn
);

594 
	`pha£_check
();

595 
	}
}

598 
	$h™dÀ_ªad
(
thªad
 *
t_ªad
)

600 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_ªad
);

601 c⁄° 
ª•
[(
PING_TOKEN
)+4] = PING_TOKEN "\n";

602 
buf
[(
ª•
)+100];

603 
ssize_t
 
rc
;

604 
timevÆ
 
dñay
;

606 
dmn
->
t_ªad
 = 
NULL
;

607 i‡((
rc
 = 
	`ªad
(
dmn
->
fd
,
buf
,(buf))) < 0)

609 
why
[100];

611 i‡(
	`ERRNO_IO_RETRY
(
î∫o
))

614 
	`SET_READ_HANDLER
(
dmn
);

617 
	`¢¥ötf
(
why
,(why),"unexpectedÑeadÉrror: %s",

618 
	`ß„_°ªº‹
(
î∫o
));

619 
	`d´m⁄_down
(
dmn
,
why
);

622 i‡(
rc
 == 0)

624 
	`d´m⁄_down
(
dmn
,"readÑeturned EOF");

627 i‡(!
dmn
->
echo_£¡
.
tv_£c
)

629 
why
[(
buf
)+100];

630 
	`¢¥ötf
(
why
,(why),"unexpectedÑeadÑeturns %d bytes: %.*s",

631 ()
rc
,(Ïc,
buf
);

632 
	`d´m⁄_down
(
dmn
,
why
);

639 i‡((
rc
 !(
ª•
)Ë|| 
	`memcmp
(
buf
,resp,(resp)))

641 
why
[100+(
buf
)];

642 
	`¢¥ötf
(
why
,(why),"readÑeturned badÉchoÑesponse of %d bytes "

644 ()
rc
,(
u_öt
)(
ª•
),(Ïc,
buf
);

645 
	`d´m⁄_down
(
dmn
,
why
);

649 
	`time_ñ≠£d
(&
dñay
,&
dmn
->
echo_£¡
);

650 
dmn
->
echo_£¡
.
tv_£c
 = 0;

651 i‡(
dmn
->
°©e
 =
DAEMON_UNRESPONSIVE
)

653 i‡(
dñay
.
tv_£c
 < 
gs
.
timeout
)

655 
dmn
->
°©e
 = 
DAEMON_UP
;

656 
	`zlog_w¨n
("%s state -> up :ÉchoÑesponseÑeceivedáfter %ld.%06ld "

657 "£c⁄ds", 
dmn
->
«me
,
dñay
.
tv_£c
,dñay.
tv_u£c
);

660 
	`zlog_w¨n
("%s: slowÉchoÑesponse finallyÑeceivedáfter %ld.%06ld "

661 "£c⁄ds", 
dmn
->
«me
,
dñay
.
tv_£c
,dñay.
tv_u£c
);

663 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

664 
	`zlog_debug
("%s:ÉchoÑesponseÑeceivedáfter %ld.%06ld seconds",

665 
dmn
->
«me
,
dñay
.
tv_£c
,dñay.
tv_u£c
);

667 
	`SET_READ_HANDLER
(
dmn
);

668 i‡(
dmn
->
t_wakeup
)

669 
	`thªad_ˇn˚l
(
dmn
->
t_wakeup
);

670 
	`SET_WAKEUP_ECHO
(
dmn
);

673 
	}
}

676 
	$d´m⁄_up
(
d´m⁄
 *
dmn
, c⁄° *
why
)

678 
dmn
->
°©e
 = 
DAEMON_UP
;

679 
gs
.
numdown
--;

680 
dmn
->
c⁄√˘_åõs
 = 0;

681 
	`zlog_nŸi˚
("%†°©ê-> u∞: %s",
dmn
->
«me
,
why
);

682 i‡(
gs
.
do_pög
)

683 
	`SET_WAKEUP_ECHO
(
dmn
);

684 
	`pha£_check
();

685 
	}
}

688 
	$check_c⁄√˘
(
thªad
 *
t_wrôe
)

690 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_wrôe
);

691 
sockîr
;

692 
sockÀn_t
 
ª¶í
 = (
sockîr
);

694 
dmn
->
t_wrôe
 = 
NULL
;

695 i‡(
	`gësock›t
(
dmn
->
fd
,
SOL_SOCKET
,
SO_ERROR
,(*)&
sockîr
,&
ª¶í
) < 0)

697 
	`zlog_w¨n
("%s: check_connect: getsockopt failed: %s",

698 
dmn
->
«me
,
	`ß„_°ªº‹
(
î∫o
));

699 
	`d´m⁄_down
(
dmn
,"getsockopt failed checking connection success");

702 i‡((
ª¶í
 =(
sockîr
)) && sockerr)

704 
why
[100];

705 
	`¢¥ötf
(
why
,(why),

707 
	`ß„_°ªº‹
(
sockîr
));

708 
	`d´m⁄_down
(
dmn
,
why
);

712 
	`d´m⁄_up
(
dmn
,"delayed connect succeeded");

714 
	}
}

717 
	$wakeup_c⁄√˘_h™gög
(
thªad
 *
t_wakeup
)

719 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_wakeup
);

720 
why
[100];

722 
dmn
->
t_wakeup
 = 
NULL
;

723 
	`¢¥ötf
(
why
,(why),"connectionáttemptÅimed outáfter %ld seconds",

724 
gs
.
timeout
);

725 
	`d´m⁄_down
(
dmn
,
why
);

727 
	}
}

731 
	$åy_c⁄√˘
(
d´m⁄
 *
dmn
)

733 
sock
;

734 
sockaddr_un
 
addr
;

735 
sockÀn_t
 
Àn
;

737 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

738 
	`zlog_debug
("%s:áâem±ögÅÿc⁄√˘",
dmn
->
«me
);

739 
dmn
->
c⁄√˘_åõs
++;

741 
	`mem£t
 (&
addr
, 0,  (
sockaddr_un
));

742 
addr
.
sun_Ámûy
 = 
AF_UNIX
;

743 
	`¢¥ötf
(
addr
.
sun_∑th
, (addr.sun_path), "%s/%s.vty",

744 
gs
.
vtydú
,
dmn
->
«me
);

745 #ifde‡
HAVE_STRUCT_SOCKADDR_UN_SUN_LEN


746 
Àn
 = 
addr
.
sun_Àn
 = 
	`SUN_LEN
(&addr);

748 
Àn
 =  (
addr
.
sun_Ámûy
Ë+ 
	`°æí
 (addr.
sun_∑th
);

753 i‡(
	`ac˚ss
(
addr
.
sun_∑th
, 
W_OK
) < 0)

755 i‡(
î∫o
 !
ENOENT
)

756 
	`zlog_îr
("%s:áccessÅo socket %s denied: %s",

757 
dmn
->
«me
,
addr
.
sun_∑th
,
	`ß„_°ªº‹
(
î∫o
));

761 i‡((
sock
 = 
	`sockë
 (
AF_UNIX
, 
SOCK_STREAM
, 0)) < 0)

763 
	`zlog_îr
("%s(%s): cannot make socket: %s",

764 
__func__
,
addr
.
sun_∑th
, 
	`ß„_°ªº‹
(
î∫o
));

768 i‡(
	`£t_n⁄blockög
(
sock
) < 0)

770 
	`zlog_îr
("%s(%s): set_nonblocking(%d) failed",

771 
__func__
, 
addr
.
sun_∑th
, 
sock
);

772 
	`˛o£
(
sock
);

776 i‡(
	`c⁄√˘
 (
sock
, (
sockaddr
 *Ë&
addr
, 
Àn
) < 0)

778 i‡((
î∫o
 !
EINPROGRESS
Ë&& (î∫ÿ!
EWOULDBLOCK
))

780 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
)

781 
	`zlog_debug
("%s(%s): connect failed: %s",

782 
__func__
,
addr
.
sun_∑th
, 
	`ß„_°ªº‹
(
î∫o
));

783 
	`˛o£
 (
sock
);

786 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
)

787 
	`zlog_debug
("%s: c⁄√˘i⁄ i¿¥ogªss",
dmn
->
«me
);

788 
dmn
->
°©e
 = 
DAEMON_CONNECTING
;

789 
dmn
->
fd
 = 
sock
;

790 
dmn
->
t_wrôe
 = 
	`thªad_add_wrôe
(
ma°î
,
check_c⁄√˘
,dmn,dmn->
fd
);

791 
dmn
->
t_wakeup
 = 
	`thªad_add_timî
(
ma°î
,
wakeup_c⁄√˘_h™gög
,dmn,

792 
gs
.
timeout
);

793 
	`SET_READ_HANDLER
(
dmn
);

797 
dmn
->
fd
 = 
sock
;

798 
	`SET_READ_HANDLER
(
dmn
);

799 
	`d´m⁄_up
(
dmn
,"connect succeeded");

801 
	}
}

804 
	$pha£_h™gög
(
thªad
 *
t_h™gög
)

806 
gs
.
t_pha£_h™gög
 = 
NULL
;

807 
	`zlog_îr
("Phase [%s] hanging for %ld seconds,ábortingÖhasedÑestart",

808 
pha£_°r
[
gs
.
pha£
],
PHASE_TIMEOUT
);

809 
gs
.
pha£
 = 
PHASE_NONE
;

811 
	}
}

814 
	$£t_pha£
(
ª°¨t_pha£_t
 
√w_pha£
)

816 
gs
.
pha£
 = 
√w_pha£
;

817 i‡(
gs
.
t_pha£_h™gög
)

818 
	`thªad_ˇn˚l
(
gs
.
t_pha£_h™gög
);

819 
gs
.
t_pha£_h™gög
 = 
	`thªad_add_timî
(
ma°î
,
pha£_h™gög
,
NULL
,

820 
PHASE_TIMEOUT
);

821 
	}
}

824 
	$pha£_check
()

826 
gs
.
pha£
)

828 
PHASE_NONE
:

830 
PHASE_STOPS_PENDING
:

831 i‡(
gs
.
numpids
)

833 
	`zlog_öfo
("PhasedÑestart:állÑouting daemon stop jobs have completed.");

834 
	`£t_pha£
(
PHASE_WAITING_DOWN
);

836 
PHASE_WAITING_DOWN
:

837 i‡(
gs
.
numdown
+
	`IS_UP
(gs.
•ecül
Ë< gs.
numd´m⁄s
)

839 
	`zlog_öfo
("PhasedÑestart:állÑouting daemonsÇow down.");

840 
	`run_job
(&
gs
.
•ecül
->
ª°¨t
,"ª°¨t",gs.
ª°¨t_comm™d
,1,1);

841 
	`£t_pha£
(
PHASE_ZEBRA_RESTART_PENDING
);

843 
PHASE_ZEBRA_RESTART_PENDING
:

844 i‡(
gs
.
•ecül
->
ª°¨t
.
pid
)

846 
	`zlog_öfo
("Pha£dÑe°¨t: %†ª°¨àjob com∂ëed.",
gs
.
•ecül
->
«me
);

847 
	`£t_pha£
(
PHASE_WAITING_ZEBRA_UP
);

849 
PHASE_WAITING_ZEBRA_UP
:

850 i‡(!
	`IS_UP
(
gs
.
•ecül
))

852 
	`zlog_öfo
("Pha£dÑe°¨t: %†i†now up.",
gs
.
•ecül
->
«me
);

854 
d´m⁄
 *
dmn
;

855 
dmn
 = 
gs
.
d´m⁄s
; dmn; dm¿dmn->
√xt
)

857 i‡(
dmn
 !
gs
.
•ecül
)

858 
	`run_job
(&
dmn
->
ª°¨t
,"°¨t",
gs
.
°¨t_comm™d
,1,0);

861 
gs
.
pha£
 = 
PHASE_NONE
;

862 
	`THREAD_OFF
(
gs
.
t_pha£_h™gög
);

863 
	`zlog_nŸi˚
("Phased globalÑestart has completed.");

866 
	}
}

869 
	$åy_ª°¨t
(
d´m⁄
 *
dmn
)

871 
gs
.
mode
)

873 
MODE_MONITOR
:

875 
MODE_GLOBAL_RESTART
:

876 
	`run_job
(&
gs
.
ª°¨t
,"ª°¨t",gs.
ª°¨t_comm™d
,0,1);

878 
MODE_SEPARATE_RESTART
:

879 
	`run_job
(&
dmn
->
ª°¨t
,"ª°¨t",
gs
.
ª°¨t_comm™d
,0,1);

881 
MODE_PHASED_ZEBRA_RESTART
:

882 i‡(
dmn
 !
gs
.
•ecül
)

884 i‡((
gs
.
•ecül
->
°©e
 =
DAEMON_UP
Ë&& (gs.
pha£
 =
PHASE_NONE
))

885 
	`run_job
(&
dmn
->
ª°¨t
,"ª°¨t",
gs
.
ª°¨t_comm™d
,0,1);

887 
	`zlog_debug
("%s:ÖostponingÑestartáttempt because master %s daemon "

889 
dmn
->
«me
,
gs
.
•ecül
->«me,
°©e_°r
[gs.•ecül->
°©e
]);

893 
MODE_PHASED_ALL_RESTART
:

894 i‡((
gs
.
pha£
 !
PHASE_NONE
Ë|| gs.
numpids
)

896 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

897 
	`zlog_debug
("postponingÖhased globalÑestart:Ñestartálready in "

899 
pha£_°r
[
gs
.
pha£
],gs.
numpids
);

904 
timevÆ
 
dñay
;

905 i‡(
	`time_ñ≠£d
(&
dñay
,&
gs
.
•ecül
->
ª°¨t
.
time
)->
tv_£c
 <

906 
gs
.
•ecül
->
ª°¨t
.
öãrvÆ
)

908 i‡(
gs
.
logÀvñ
 > 
LOG_DEBUG
+1)

909 
	`zlog_debug
("postponingÖhased globalÑestart: "

911 ()
dñay
.
tv_£c
,
gs
.
•ecül
->
ª°¨t
.
öãrvÆ
);

915 
	`zlog_öfo
("PhasedÑestart: stoppingállÑouting daemons.");

917 
dmn
 = 
gs
.
d´m⁄s
; dmn; dm¿dmn->
√xt
)

919 i‡(
dmn
 !
gs
.
•ecül
)

920 
	`run_job
(&
dmn
->
ª°¨t
,"°›",
gs
.
°›_comm™d
,1,1);

922 
	`£t_pha£
(
PHASE_STOPS_PENDING
);

925 
	`zlog_îr
("îr‹: unknow¿ª°¨àmodê%d",
gs
.
mode
);

928 
	}
}

931 
	$wakeup_uƒe•⁄sive
(
thªad
 *
t_wakeup
)

933 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_wakeup
);

935 
dmn
->
t_wakeup
 = 
NULL
;

936 i‡(
dmn
->
°©e
 !
DAEMON_UNRESPONSIVE
)

937 
	`zlog_îr
("%s:ÇoÜonger unresponsive (now %s), "

939 
dmn
->
«me
,
°©e_°r
[dmn->
°©e
]);

942 
	`SET_WAKEUP_UNRESPONSIVE
(
dmn
);

943 
	`åy_ª°¨t
(
dmn
);

946 
	}
}

949 
	$wakeup_no_™swî
(
thªad
 *
t_wakeup
)

951 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_wakeup
);

953 
dmn
->
t_wakeup
 = 
NULL
;

954 
dmn
->
°©e
 = 
DAEMON_UNRESPONSIVE
;

955 
	`zlog_îr
("%s state -> unresponsive :ÇoÑesponse yetÅoÖing "

956 "£¡ %ld sec⁄d†ago",
dmn
->
«me
,
gs
.
timeout
);

957 i‡(
gs
.
uƒe•⁄sive_ª°¨t
)

959 
	`SET_WAKEUP_UNRESPONSIVE
(
dmn
);

960 
	`åy_ª°¨t
(
dmn
);

963 
	}
}

966 
	$wakeup_£nd_echo
(
thªad
 *
t_wakeup
)

968 c⁄° 
echocmd
[] = "echÿ" 
PING_TOKEN
;

969 
ssize_t
 
rc
;

970 
d´m⁄
 *
dmn
 = 
	`THREAD_ARG
(
t_wakeup
);

972 
dmn
->
t_wakeup
 = 
NULL
;

973 i‡(((
rc
 = 
	`wrôe
(
dmn
->
fd
,
echocmd
,(echocmd))) < 0) ||

974 ((
size_t
)
rc
 !(
echocmd
)))

976 
why
[100+(
echocmd
)];

977 
	`¢¥ötf
(
why
,(why),"write '%s'Ñeturned %d instead of %u",

978 
echocmd
,()
rc
,(
u_öt
)(echocmd));

979 
	`d´m⁄_down
(
dmn
,
why
);

983 
	`gëtimeofday
(&
dmn
->
echo_£¡
,
NULL
);

984 
dmn
->
t_wakeup
 = 
	`thªad_add_timî
(
ma°î
,
wakeup_no_™swî
,dmn,
gs
.
timeout
);

987 
	}
}

990 
	$sigöt
()

992 
	`zlog_nŸi˚
("Terminating on signal");

993 
	`exô
(0);

994 
	}
}

997 
	$vÆid_comm™d
(c⁄° *
cmd
)

999 *
p
;

1001  ((
p
 = 
	`°rchr
(
cmd
,'%')Ë!
NULL
) && (*(p+1) == 's') && !strchr(p+1,'%');

1002 
	}
}

1007 
	$å™¶©e_bœnks
(c⁄° *
cmd
, c⁄° *
bœnk°r
)

1009 *
ªs
;

1010 *
p
;

1011 
size_t
 
b¶í
 = 
	`°æí
(
bœnk°r
);

1013 i‡(!(
ªs
 = 
	`°rdup
(
cmd
)))

1015 
	`≥º‹
("strdup");

1016 
	`exô
(1);

1018 (
p
 = 
	`°r°r
(
ªs
,
bœnk°r
)Ë!
NULL
)

1020 *
p
 = ' ';

1021 i‡(
b¶í
 != 1)

1022 
	`memmove
(
p
+1,p+
b¶í
,
	`°æí
(p+bslen)+1);

1024  
ªs
;

1025 
	}
}

1028 
	$maö
(
¨gc
, **
¨gv
)

1030 c⁄° *
¥og«me
;

1031 
›t
;

1032 
d´m⁄_mode
 = 0;

1033 c⁄° *
pidfûe
 = 
DEFAULT_PIDFILE
;

1034 c⁄° *
•ecül
 = "zebra";

1035 c⁄° *
bœnk°r
 = 
NULL
;

1036 
quagga_sig«l_t
 
my_sig«ls
[] =

1039 .
sig«l
 = 
SIGINT
,

1040 .
h™dÀr
 = 
sigöt
,

1043 .
sig«l
 = 
SIGTERM
,

1044 .
h™dÀr
 = 
sigöt
,

1047 .
sig«l
 = 
SIGCHLD
,

1048 .
h™dÀr
 = 
sigchûd
,

1052 i‡((
¥og«me
 = 
	`°ºchr
 (
¨gv
[0], '/')Ë!
NULL
)

1053 
¥og«me
++;

1055 
¥og«me
 = 
¨gv
[0];

1057 
gs
.
ª°¨t
.
«me
 = "all";

1058 (
›t
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, "aAb:dek:l:m:M:i:p:r:R:S:s:t:T:zvh",

1059 
l⁄g›ts
, 0)Ë!
EOF
)

1061 
›t
)

1066 i‡((
gs
.
mode
 !
MODE_MONITOR
Ë&& (gs.modê!
MODE_SEPARATE_RESTART
))

1068 
	`Âuts
("Ambiguou†›î©ög modê£À˘ed.\n",
°dîr
);

1069  
	`ußge
(
¥og«me
,1);

1071 
gs
.
mode
 = 
MODE_PHASED_ZEBRA_RESTART
;

1074 i‡((
gs
.
mode
 !
MODE_MONITOR
Ë&& (gs.modê!
MODE_SEPARATE_RESTART
))

1076 
	`Âuts
("Ambiguou†›î©ög modê£À˘ed.\n",
°dîr
);

1077  
	`ußge
(
¥og«me
,1);

1079 
gs
.
mode
 = 
MODE_PHASED_ALL_RESTART
;

1082 
bœnk°r
 = 
›èrg
;

1085 
d´m⁄_mode
 = 1;

1088 
gs
.
do_pög
 = 0;

1091 i‡(!
	`vÆid_comm™d
(
›èrg
))

1093 
	`Ârötf
(
°dîr
,"Invalid kill command, must contain '%%s': %s\n",

1094 
›èrg
);

1095  
	`ußge
(
¥og«me
,1);

1097 
gs
.
°›_comm™d
 = 
›èrg
;

1101 
g¨bage
[3];

1102 i‡((
	`ssˇnf
(
›èrg
,"%d%1s",&
gs
.
logÀvñ
,
g¨bage
) != 1) ||

1103 (
gs
.
logÀvñ
 < 
LOG_EMERG
))

1105 
	`Ârötf
(
°dîr
,"InvÆidÜogÀvñárgumít: %s\n",
›èrg
);

1106  
	`ußge
(
¥og«me
,1);

1112 
g¨bage
[3];

1113 i‡((
	`ssˇnf
(
›èrg
,"%ld%1s",

1114 &
gs
.
mö_ª°¨t_öãrvÆ
,
g¨bage
) != 1) ||

1115 (
gs
.
mö_ª°¨t_öãrvÆ
 < 0))

1117 
	`Ârötf
(
°dîr
,"Invalid min_restart_intervalárgument: %s\n",

1118 
›èrg
);

1119  
	`ußge
(
¥og«me
,1);

1125 
g¨bage
[3];

1126 i‡((
	`ssˇnf
(
›èrg
,"%ld%1s",

1127 &
gs
.
max_ª°¨t_öãrvÆ
,
g¨bage
) != 1) ||

1128 (
gs
.
max_ª°¨t_öãrvÆ
 < 0))

1130 
	`Ârötf
(
°dîr
,"Invalid max_restart_intervalárgument: %s\n",

1131 
›èrg
);

1132  
	`ußge
(
¥og«me
,1);

1138 
g¨bage
[3];

1139 
≥riod
;

1140 i‡((
	`ssˇnf
(
›èrg
,"%d%1s",&
≥riod
,
g¨bage
) != 1) ||

1141 (
gs
.
≥riod
 < 1))

1143 
	`Ârötf
(
°dîr
,"InvÆid i¡îvÆárgumít: %s\n",
›èrg
);

1144  
	`ußge
(
¥og«me
,1);

1146 
gs
.
≥riod
 = 1000*period;

1150 
pidfûe
 = 
›èrg
;

1153 i‡((
gs
.
mode
 =
MODE_GLOBAL_RESTART
) ||

1154 (
gs
.
mode
 =
MODE_SEPARATE_RESTART
))

1156 
	`Âuts
("Ambiguou†›î©ög modê£À˘ed.\n",
°dîr
);

1157  
	`ußge
(
¥og«me
,1);

1159 i‡(!
	`vÆid_comm™d
(
›èrg
))

1161 
	`Ârötf
(
°dîr
,

1163 
›èrg
);

1164  
	`ußge
(
¥og«me
,1);

1166 
gs
.
ª°¨t_comm™d
 = 
›èrg
;

1167 i‡(
gs
.
mode
 =
MODE_MONITOR
)

1168 
gs
.
mode
 = 
MODE_SEPARATE_RESTART
;

1171 i‡(
gs
.
mode
 !
MODE_MONITOR
)

1173 
	`Âuts
("Ambiguou†›î©ög modê£À˘ed.\n",
°dîr
);

1174  
	`ußge
(
¥og«me
,1);

1176 i‡(
	`°rchr
(
›èrg
,'%'))

1178 
	`Ârötf
(
°dîr
,

1180 
›èrg
);

1181  
	`ußge
(
¥og«me
,1);

1183 
gs
.
ª°¨t_comm™d
 = 
›èrg
;

1184 
gs
.
mode
 = 
MODE_GLOBAL_RESTART
;

1187 i‡(!
	`vÆid_comm™d
(
›èrg
))

1189 
	`Ârötf
(
°dîr
,"Invalid start command, must contain '%%s': %s\n",

1190 
›èrg
);

1191  
	`ußge
(
¥og«me
,1);

1193 
gs
.
°¨t_comm™d
 = 
›èrg
;

1196 
gs
.
vtydú
 = 
›èrg
;

1200 
g¨bage
[3];

1201 i‡((
	`ssˇnf
(
›èrg
,"%ld%1s",&
gs
.
timeout
,
g¨bage
) != 1) ||

1202 (
gs
.
timeout
 < 1))

1204 
	`Ârötf
(
°dîr
,"InvÆidÅimeouà¨gumít: %s\n",
›èrg
);

1205  
	`ußge
(
¥og«me
,1);

1211 
g¨bage
[3];

1212 i‡((
	`ssˇnf
(
›èrg
,"%ld%1s",&
gs
.
ª°¨t_timeout
,
g¨bage
) != 1) ||

1213 (
gs
.
ª°¨t_timeout
 < 1))

1215 
	`Ârötf
(
°dîr
,"InvÆidÑe°¨àtimeouà¨gumít: %s\n",
›èrg
);

1216  
	`ußge
(
¥og«me
,1);

1221 
gs
.
uƒe•⁄sive_ª°¨t
 = 1;

1224 
	`¥ötf
 ("%†vîsi⁄ %s\n", 
¥og«me
, 
QUAGGA_VERSION
);

1225 
	`puts
("Copyright 2004 Andrew J. Schorr");

1228  
	`ußge
(
¥og«me
,0);

1230 
	`Âuts
("InvÆid o±i⁄.\n",
°dîr
);

1231  
	`ußge
(
¥og«me
,1);

1235 i‡(
gs
.
uƒe•⁄sive_ª°¨t
 && (gs.
mode
 =
MODE_MONITOR
))

1237 
	`Âuts
("O±i⁄ -zÑequúe†®-∏‹ -RÑe°¨à›ti⁄.\n",
°dîr
);

1238  
	`ußge
(
¥og«me
,1);

1240 
gs
.
mode
)

1242 
MODE_MONITOR
:

1243 i‡(
gs
.
ª°¨t_comm™d
 || gs.
°¨t_comm™d
 || gs.
°›_comm™d
)

1245 
	`Ârötf
(
°dîr
,"No kill/(re)start commandsÇeeded for %s mode.\n",

1246 
mode_°r
[
gs
.
mode
]);

1247  
	`ußge
(
¥og«me
,1);

1250 
MODE_GLOBAL_RESTART
:

1251 
MODE_SEPARATE_RESTART
:

1252 i‡(!
gs
.
ª°¨t_comm™d
 || gs.
°¨t_comm™d
 || gs.
°›_comm™d
)

1254 
	`Ârötf
(
°dîr
,"No start/kill commandsÇeeded in [%s] mode.\n",

1255 
mode_°r
[
gs
.
mode
]);

1256  
	`ußge
(
¥og«me
,1);

1259 
MODE_PHASED_ZEBRA_RESTART
:

1260 
MODE_PHASED_ALL_RESTART
:

1261 i‡(!
gs
.
ª°¨t_comm™d
 || !gs.
°¨t_comm™d
 || !gs.
°›_comm™d
)

1263 
	`Ârötf
(
°dîr
,

1265 
mode_°r
[
gs
.
mode
]);

1266  
	`ußge
(
¥og«me
,1);

1271 i‡(
bœnk°r
)

1273 i‡(
gs
.
ª°¨t_comm™d
)

1274 
gs
.
ª°¨t_comm™d
 = 
	`å™¶©e_bœnks
(gs.ª°¨t_comm™d,
bœnk°r
);

1275 i‡(
gs
.
°¨t_comm™d
)

1276 
gs
.
°¨t_comm™d
 = 
	`å™¶©e_bœnks
(gs.°¨t_comm™d,
bœnk°r
);

1277 i‡(
gs
.
°›_comm™d
)

1278 
gs
.
°›_comm™d
 = 
	`å™¶©e_bœnks
(gs.°›_comm™d,
bœnk°r
);

1281 
gs
.
ª°¨t
.
öãrvÆ
 = gs.
mö_ª°¨t_öãrvÆ
;

1282 
ma°î
 = 
	`thªad_ma°î_¸óã
();

1283 
	`sig«l_öô
 (
ma°î
, 
	`¨øy_size
(
my_sig«ls
), my_signals);

1284 
	`§™dom
(
	`time
(
NULL
));

1287 
i
;

1288 
d´m⁄
 *
èû
 = 
NULL
;

1290 
i
 = 
›töd
; i < 
¨gc
; i++)

1292 
d´m⁄
 *
dmn
;

1294 i‡(!(
dmn
 = (
d´m⁄
 *)
	`ˇŒoc
(1,(*dmn))))

1296 
	`Ârötf
(
°dîr
,"calloc(1,%u) failed: %s\n",

1297 (
u_öt
)(*
dmn
), 
	`ß„_°ªº‹
(
î∫o
));

1300 
dmn
->
«me
 = dmn->
ª°¨t
.«mê
¨gv
[
i
];

1301 
dmn
->
°©e
 = 
DAEMON_INIT
;

1302 
gs
.
numd´m⁄s
++;

1303 
gs
.
numdown
++;

1304 
dmn
->
fd
 = -1;

1305 
dmn
->
t_wakeup
 = 
	`thªad_add_timî_m£c
(
ma°î
,
wakeup_öô
,dmn,

1306 100+(
	`øndom
() % 900));

1307 
dmn
->
ª°¨t
.
öãrvÆ
 = 
gs
.
mö_ª°¨t_öãrvÆ
;

1308 i‡(
èû
)

1309 
èû
->
√xt
 = 
dmn
;

1311 
gs
.
d´m⁄s
 = 
dmn
;

1312 
èû
 = 
dmn
;

1314 i‡(((
gs
.
mode
 =
MODE_PHASED_ZEBRA_RESTART
) ||

1315 (
gs
.
mode
 =
MODE_PHASED_ALL_RESTART
)) &&

1316 !
	`°rcmp
(
dmn
->
«me
,
•ecül
))

1317 
gs
.
•ecül
 = 
dmn
;

1320 i‡(!
gs
.
d´m⁄s
)

1322 
	`Âuts
("Mu° s≥cify o√ o∏m‹êd´m⁄†tÿm⁄ô‹.\n",
°dîr
);

1323  
	`ußge
(
¥og«me
,1);

1325 i‡(((
gs
.
mode
 =
MODE_PHASED_ZEBRA_RESTART
) ||

1326 (
gs
.
mode
 =
MODE_PHASED_ALL_RESTART
)Ë&& !gs.
•ecül
)

1328 
	`Ârötf
(
°dîr
,"In mode [%s], but cannot find master daemon %s\n",

1329 
mode_°r
[
gs
.
mode
],
•ecül
);

1330  
	`ußge
(
¥og«me
,1);

1332 i‡(
gs
.
•ecül
 && (gs.
numd´m⁄s
 < 2))

1334 
	`Ârötf
(
°dîr
,"Mode [%s] doesÇot make sense with only 1 daemon "

1335 "tÿw©ch.\n",
mode_°r
[
gs
.
mode
]);

1336  
	`ußge
(
¥og«me
,1);

1339 
zlog_deÁu…
 = 
	`›ízlog
(
¥og«me
, 
ZLOG_NONE
,

1340 
LOG_CONS
|
LOG_NDELAY
|
LOG_PID
, 
LOG_DAEMON
);

1341 
	`zlog_£t_Àvñ
(
NULL
, 
ZLOG_DEST_MONITOR
, 
ZLOG_DISABLED
);

1342 i‡(
d´m⁄_mode
)

1344 
	`zlog_£t_Àvñ
(
NULL
, 
ZLOG_DEST_SYSLOG
, 
	`MIN
(
gs
.
logÀvñ
,
LOG_DEBUG
));

1345 i‡(
	`d´m⁄
 (0, 0) < 0)

1347 
	`Ârötf
(
°dîr
, "W©chquagg®d´m⁄ faûed: %s", 
	`°ªº‹
(
î∫o
));

1348 
	`exô
 (1);

1352 
	`zlog_£t_Àvñ
(
NULL
, 
ZLOG_DEST_STDOUT
, 
	`MIN
(
gs
.
logÀvñ
,
LOG_DEBUG
));

1355 
	`pid_ouçut
 (
pidfûe
);

1359 
d´m⁄
 *
dmn
;

1360 
size_t
 
Àn
 = 0;

1362 
dmn
 = 
gs
.
d´m⁄s
; dmn; dm¿dmn->
√xt
)

1363 
Àn
 +
	`°æí
(
dmn
->
«me
)+1;

1366 
buf
[
Àn
+1];

1367 *
p
 = 
buf
;

1369 
dmn
 = 
gs
.
d´m⁄s
; dmn; dm¿dmn->
√xt
)

1371 i‡(
p
 !
buf
)

1372 *
p
++ = ' ';

1373 
	`°r˝y
(
p
,
dmn
->
«me
);

1374 
p
 +
	`°æí
(p);

1376 
	`zlog_nŸi˚
("%s %s watching [%s], mode [%s]",

1377 
¥og«me
, 
QUAGGA_VERSION
, 
buf
, 
mode_°r
[
gs
.
mode
]);

1382 
thªad
Åhread;

1384 
	`thªad_„tch
 (
ma°î
, &
thªad
))

1385 
	`thªad_ˇŒ
 (&
thªad
);

1390 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/connected.c

23 
	~<zebø.h
>

25 
	~"¥efix.h
"

26 
	~"lökli°.h
"

27 
	~"if.h
"

28 
	~"èbÀ.h
"

29 
	~"rib.h
"

30 
	~"èbÀ.h
"

31 
	~"log.h
"

32 
	~"mem‹y.h
"

34 
	~"zebø/z£rv.h
"

35 
	~"zebø/ªdi°ribuã.h
"

36 
	~"zebø/öãrÁ˚.h
"

37 
	~"zebø/c⁄√˘ed.h
"

38 
zebø_t
 
zebød
;

42 
	$c⁄√˘ed_wôhdøw
 (
c⁄√˘ed
 *
ifc
)

44 i‡(! 
ifc
)

48 i‡(
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

50 
	`zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
ifc
->
iÂ
, ifc);

52 
	`if_sub√t_dñëe
 (
ifc
->
iÂ
, ifc);

54 i‡(
ifc
->
addªss
->
Ámûy
 =
AF_INET
)

55 
	`c⁄√˘ed_down_ùv4
 (
ifc
->
iÂ
, ifc);

56 #ifde‡
HAVE_IPV6


58 
	`c⁄√˘ed_down_ùv6
 (
ifc
->
iÂ
, ifc);

61 
	`UNSET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

64 i‡(!
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

66 
	`li°node_dñëe
 (
ifc
->
iÂ
->
c⁄√˘ed
, ifc);

67 
	`c⁄√˘ed_‰ì
 (
ifc
);

69 
	}
}

72 
	$c⁄√˘ed_™noun˚
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

74 i‡(!
ifc
)

77 
	`li°node_add
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

80 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

82 i‡(
ifc
->
addªss
->
Ámûy
 =
AF_INET
)

83 
	`if_sub√t_add
 (
iÂ
, 
ifc
);

85 
	`SET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

87 
	`zebø_öãrÁ˚_addªss_add_upd©e
 (
iÂ
, 
ifc
);

89 i‡(
	`if_is_›î©ive
(
iÂ
))

91 i‡(
ifc
->
addªss
->
Ámûy
 =
AF_INET
)

92 
	`c⁄√˘ed_up_ùv4
 (
iÂ
, 
ifc
);

93 #ifde‡
HAVE_IPV6


95 
	`c⁄√˘ed_up_ùv6
 (
iÂ
, 
ifc
);

99 
	}
}

102 
c⁄√˘ed
 *

103 
	$c⁄√˘ed_check
 (
öãrÁ˚
 *
iÂ
, 
¥efix
 *
p
)

105 
c⁄√˘ed
 *
ifc
;

106 
li°node
 *
node
;

108 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
node
, 
ifc
))

109 i‡(
	`¥efix_ßme
 (
ifc
->
addªss
, 
p
))

110  
ifc
;

112  
NULL
;

113 
	}
}

117 
	$c⁄√˘ed_ßme
 (
c⁄√˘ed
 *
ifc1
, c⁄√˘ed *
ifc2
)

119 i‡(
ifc1
->
iÂ
 !
ifc2
->ifp)

122 i‡(
ifc1
->
de°ö©i⁄
)

123 i‡(!
ifc2
->
de°ö©i⁄
)

125 i‡(
ifc2
->
de°ö©i⁄
)

126 i‡(!
ifc1
->
de°ö©i⁄
)

129 i‡(
ifc1
->
de°ö©i⁄
 && 
ifc2
->destination)

130 i‡(!
	`¥efix_ßme
 (
ifc1
->
de°ö©i⁄
, 
ifc2
->destination))

133 i‡(
ifc1
->
Êags
 !
ifc2
->flags)

137 
	}
}

145 
c⁄√˘ed
 *

146 
	$c⁄√˘ed_im∂icô_wôhdøw
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

148 
c⁄√˘ed
 *
cuºít
;

151 i‡((
cuºít
 = 
	`c⁄√˘ed_check
 (
iÂ
, (
¥efix
 *Ë
ifc
->
addªss
)))

153 i‡(
	`CHECK_FLAG
(
cuºít
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

154 
	`SET_FLAG
(
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
);

159 i‡(
	`c⁄√˘ed_ßme
 (
cuºít
, 
ifc
Ë&& 
	`CHECK_FLAG
(cuºít->
c⁄f
, 
ZEBRA_IFC_REAL
))

162 
	`c⁄√˘ed_‰ì
 (
ifc
);

163  
NULL
;

166 
	`UNSET_FLAG
(
cuºít
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
);

167 
	`c⁄√˘ed_wôhdøw
 (
cuºít
);

169  
ifc
;

170 
	}
}

174 
	$c⁄√˘ed_up_ùv4
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

176 
¥efix_ùv4
 
p
;

178 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

181 
	`PREFIX_COPY_IPV4
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

184 
	`≠∂y_mask_ùv4
 (&
p
);

188 i‡(
	`¥efix_ùv4_™y
 (&
p
))

191 
	`rib_add_ùv4
 (
ZEBRA_ROUTE_CONNECT
, 0, &
p
, 
NULL
, NULL, 
iÂ
->
ifödex
,

192 
RT_TABLE_MAIN
, 
iÂ
->
mëric
, 0, 
SAFI_UNICAST
);

194 
	`rib_add_ùv4
 (
ZEBRA_ROUTE_CONNECT
, 0, &
p
, 
NULL
, NULL, 
iÂ
->
ifödex
,

195 
RT_TABLE_MAIN
, 
iÂ
->
mëric
, 0, 
SAFI_MULTICAST
);

197 
	`rib_upd©e
 ();

198 
	}
}

202 
	$c⁄√˘ed_add_ùv4
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö_addr
 *
addr
,

203 
u_ch¨
 
¥efixÀn
, 
ö_addr
 *
brﬂd
,

204 c⁄° *
œbñ
)

206 
¥efix_ùv4
 *
p
;

207 
c⁄√˘ed
 *
ifc
;

210 
ifc
 = 
	`c⁄√˘ed_√w
 ();

211 
ifc
->
iÂ
 = ifp;

212 
ifc
->
Êags
 = flags;

215 
p
 = 
	`¥efix_ùv4_√w
 ();

216 
p
->
Ámûy
 = 
AF_INET
;

217 
p
->
¥efix
 = *
addr
;

218 
p
->
¥efixÀn
 =Örefixlen;

219 
ifc
->
addªss
 = (
¥efix
 *Ë
p
;

222 i‡(
brﬂd
)

224 
p
 = 
	`¥efix_ùv4_√w
 ();

225 
p
->
Ámûy
 = 
AF_INET
;

226 
p
->
¥efix
 = *
brﬂd
;

227 
p
->
¥efixÀn
 =Örefixlen;

228 
ifc
->
de°ö©i⁄
 = (
¥efix
 *Ë
p
;

231 i‡(
	`CONNECTED_PEER
(
ifc
))

233 i‡(
	`IPV4_ADDR_SAME
(
addr
,
brﬂd
))

234 
	`zlog_w¨n
("warning: interface %s has sameÜocalándÖeer "

236 
iÂ
->
«me
,
	`öë_¡ﬂ
(*
addr
));

240 i‡(
brﬂd
->
s_addr
 !
	`ùv4_brﬂdˇ°_addr
(
addr
->s_addr,
¥efixÀn
))

242 
buf
[2][
INET_ADDRSTRLEN
];

243 
ö_addr
 
bˇlc
;

244 
bˇlc
.
s_addr
 = 
	`ùv4_brﬂdˇ°_addr
(
addr
->s_addr,
¥efixÀn
);

245 
	`zlog_w¨n
("warning: interface %s broadcastáddr %s/%d != "

247 
iÂ
->
«me
,

248 
	`öë_¡›
 (
AF_INET
, 
brﬂd
, 
buf
[0], (buf[0])),

249 
¥efixÀn
,

250 
	`öë_¡›
 (
AF_INET
, &
bˇlc
, 
buf
[1], (buf[1])));

257 i‡(
	`CHECK_FLAG
(
ifc
->
Êags
, 
ZEBRA_IFA_PEER
))

259 
	`zlog_w¨n
("warning: %s called for interface %s "

261 
__func__
, 
iÂ
->
«me
);

262 
	`UNSET_FLAG
(
ifc
->
Êags
, 
ZEBRA_IFA_PEER
);

266 i‡((
¥efixÀn
 =
IPV4_MAX_PREFIXLEN
Ë&& 
	`if_is_poöt›oöt
(
iÂ
))

267 
	`zlog_w¨n
("warning: PtP interface %s witháddr %s/%dÇeedsá "

268 "≥îáddªss",
iÂ
->
«me
,
	`öë_¡ﬂ
(*
addr
),
¥efixÀn
);

272 i‡(
œbñ
)

273 
ifc
->
œbñ
 = 
	`XSTRDUP
 (
MTYPE_CONNECTED_LABEL
,Üabel);

276 i‡((
ifc
 = 
	`c⁄√˘ed_im∂icô_wôhdøw
 (
iÂ
, ifc)Ë=
NULL
)

279 
	`c⁄√˘ed_™noun˚
 (
iÂ
, 
ifc
);

280 
	}
}

283 
	$c⁄√˘ed_down_ùv4
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

285 
¥efix_ùv4
 
p
;

287 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

290 
	`PREFIX_COPY_IPV4
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

293 
	`≠∂y_mask_ùv4
 (&
p
);

297 i‡(
	`¥efix_ùv4_™y
 (&
p
))

301 
	`rib_dñëe_ùv4
 (
ZEBRA_ROUTE_CONNECT
, 0, &
p
, 
NULL
, 
iÂ
->
ifödex
, 0, 
SAFI_UNICAST
);

303 
	`rib_dñëe_ùv4
 (
ZEBRA_ROUTE_CONNECT
, 0, &
p
, 
NULL
, 
iÂ
->
ifödex
, 0, 
SAFI_MULTICAST
);

305 
	`rib_upd©e
 ();

306 
	}
}

310 
	$c⁄√˘ed_dñëe_ùv4
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö_addr
 *
addr
,

311 
u_ch¨
 
¥efixÀn
, 
ö_addr
 *
brﬂd
)

313 
¥efix_ùv4
 
p
;

314 
c⁄√˘ed
 *
ifc
;

316 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

317 
p
.
Ámûy
 = 
AF_INET
;

318 
p
.
¥efix
 = *
addr
;

319 
p
.
¥efixÀn
 =Örefixlen;

321 
ifc
 = 
	`c⁄√˘ed_check
 (
iÂ
, (
¥efix
 *Ë&
p
);

322 i‡(! 
ifc
)

325 
	`c⁄√˘ed_wôhdøw
 (
ifc
);

327 
	`rib_upd©e
();

328 
	}
}

330 #ifde‡
HAVE_IPV6


332 
	$c⁄√˘ed_up_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

334 
¥efix_ùv6
 
p
;

336 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

339 
	`PREFIX_COPY_IPV6
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

342 
	`≠∂y_mask_ùv6
 (&
p
);

344 #i‡! 
	`deföed
 (
MUSICA
Ë&& ! deföed (
LINUX
)

346 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
p
.
¥efix
))

350 
	`rib_add_ùv6
 (
ZEBRA_ROUTE_CONNECT
, 0, &
p
, 
NULL
, 
iÂ
->
ifödex
, 
RT_TABLE_MAIN
,

351 
iÂ
->
mëric
, 0, 
SAFI_UNICAST
);

353 
	`rib_upd©e
 ();

354 
	}
}

358 
	$c⁄√˘ed_add_ùv6
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö6_addr
 *
addr
,

359 
u_ch¨
 
¥efixÀn
, 
ö6_addr
 *
brﬂd
,

360 c⁄° *
œbñ
)

362 
¥efix_ùv6
 *
p
;

363 
c⁄√˘ed
 *
ifc
;

366 
ifc
 = 
	`c⁄√˘ed_√w
 ();

367 
ifc
->
iÂ
 = ifp;

368 
ifc
->
Êags
 = flags;

371 
p
 = 
	`¥efix_ùv6_√w
 ();

372 
p
->
Ámûy
 = 
AF_INET6
;

373 
	`IPV6_ADDR_COPY
 (&
p
->
¥efix
, 
addr
);

374 
p
->
¥efixÀn
 =Örefixlen;

375 
ifc
->
addªss
 = (
¥efix
 *Ë
p
;

378 i‡(
brﬂd
)

380 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
(
brﬂd
))

381 
	`zlog_w¨n
("warning: %s called for interface %s with unspecified "

382 "de°ö©i⁄áddªss; ign‹ög!", 
__func__
, 
iÂ
->
«me
);

385 
p
 = 
	`¥efix_ùv6_√w
 ();

386 
p
->
Ámûy
 = 
AF_INET6
;

387 
	`IPV6_ADDR_COPY
 (&
p
->
¥efix
, 
brﬂd
);

388 
p
->
¥efixÀn
 =Örefixlen;

389 
ifc
->
de°ö©i⁄
 = (
¥efix
 *Ë
p
;

392 i‡(
	`CHECK_FLAG
(
ifc
->
Êags
, 
ZEBRA_IFA_PEER
Ë&& !ifc->
de°ö©i⁄
)

394 
	`zlog_w¨n
("warning: %s called for interface %s "

396 
__func__
, 
iÂ
->
«me
);

397 
	`UNSET_FLAG
(
ifc
->
Êags
, 
ZEBRA_IFA_PEER
);

401 i‡(
œbñ
)

402 
ifc
->
œbñ
 = 
	`XSTRDUP
 (
MTYPE_CONNECTED_LABEL
,Üabel);

404 i‡((
ifc
 = 
	`c⁄√˘ed_im∂icô_wôhdøw
 (
iÂ
, ifc)Ë=
NULL
)

407 
	`c⁄√˘ed_™noun˚
 (
iÂ
, 
ifc
);

408 
	}
}

411 
	$c⁄√˘ed_down_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

413 
¥efix_ùv6
 
p
;

415 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

418 
	`PREFIX_COPY_IPV6
(&
p
, 
	`CONNECTED_PREFIX
(
ifc
));

420 
	`≠∂y_mask_ùv6
 (&
p
);

422 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
p
.
¥efix
))

425 
	`rib_dñëe_ùv6
 (
ZEBRA_ROUTE_CONNECT
, 0, &
p
, 
NULL
, 
iÂ
->
ifödex
, 0, 
SAFI_UNICAST
);

427 
	`rib_upd©e
 ();

428 
	}
}

431 
	$c⁄√˘ed_dñëe_ùv6
 (
öãrÁ˚
 *
iÂ
, 
ö6_addr
 *
addªss
,

432 
u_ch¨
 
¥efixÀn
, 
ö6_addr
 *
brﬂd
)

434 
¥efix_ùv6
 
p
;

435 
c⁄√˘ed
 *
ifc
;

437 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv6
));

438 
p
.
Ámûy
 = 
AF_INET6
;

439 
	`mem˝y
 (&
p
.
¥efix
, 
addªss
,  (
ö6_addr
));

440 
p
.
¥efixÀn
 =Örefixlen;

442 
ifc
 = 
	`c⁄√˘ed_check
 (
iÂ
, (
¥efix
 *Ë&
p
);

443 i‡(! 
ifc
)

446 
	`c⁄√˘ed_wôhdøw
 (
ifc
);

448 
	`rib_upd©e
();

449 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/connected.h

23 #i‚de‡
_ZEBRA_CONNECTED_H


24 
	#_ZEBRA_CONNECTED_H


	)

26 
c⁄√˘ed
 *

27 
c⁄√˘ed_check
 (
öãrÁ˚
 *
iÂ
, 
¥efix
 *
p
);

30 
c⁄√˘ed_add_ùv4
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö_addr
 *
addr
,

31 
u_ch¨
 
¥efixÀn
, 
ö_addr
 *
brﬂd
,

32 c⁄° *
œbñ
);

35 
c⁄√˘ed_dñëe_ùv4
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö_addr
 *
addr
,

36 
u_ch¨
 
¥efixÀn
, 
ö_addr
 *
brﬂd
);

38 
c⁄√˘ed_up_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

39 
c⁄√˘ed_down_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

41 #ifde‡
HAVE_IPV6


43 
c⁄√˘ed_add_ùv6
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö6_addr
 *
addªss
,

44 
u_ch¨
 
¥efixÀn
, 
ö6_addr
 *
brﬂd
,

45 c⁄° *
œbñ
);

47 
c⁄√˘ed_dñëe_ùv6
 (
öãrÁ˚
 *
iÂ
, 
ö6_addr
 *
addªss
,

48 
u_ch¨
 
¥efixÀn
, 
ö6_addr
 *
brﬂd
);

50 
c⁄√˘ed_up_ùv6
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

51 
c⁄√˘ed_down_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/debug.c

23 
	~<zebø.h
>

24 
	~"comm™d.h
"

25 
	~"debug.h
"

28 
	gzebø_debug_evít
;

29 
	gzebø_debug_∑ckë
;

30 
	gzebø_debug_kî√l
;

31 
	gzebø_debug_rib
;

32 
	gzebø_debug_Âm
;

34 
DEFUN
 (
show_debuggög_zebø
,

35 
show_debuggög_zebø_cmd
,

37 
SHOW_STR


41 
vty_out
 (
vty
, "Zebø debuggög sètus:%s", 
VTY_NEWLINE
);

43 i‡(
	gIS_ZEBRA_DEBUG_EVENT
)

44 
vty_out
 (
vty
, " ZebøÉvíàdebuggög i†⁄%s", 
VTY_NEWLINE
);

46 i‡(
	gIS_ZEBRA_DEBUG_PACKET
)

48 i‡(
	gIS_ZEBRA_DEBUG_SEND
 && 
	gIS_ZEBRA_DEBUG_RECV
)

50 
vty_out
 (
vty
, " ZebraÖacket%s debugging is on%s",

51 
IS_ZEBRA_DEBUG_DETAIL
 ? " detail" : "",

52 
VTY_NEWLINE
);

56 i‡(
	gIS_ZEBRA_DEBUG_SEND
)

57 
vty_out
 (
vty
, " ZebraÖacket send%s debugging is on%s",

58 
IS_ZEBRA_DEBUG_DETAIL
 ? " detail" : "",

59 
VTY_NEWLINE
);

61 
vty_out
 (
vty
, " ZebraÖacketÑeceive%s debugging is on%s",

62 
IS_ZEBRA_DEBUG_DETAIL
 ? " detail" : "",

63 
VTY_NEWLINE
);

67 i‡(
	gIS_ZEBRA_DEBUG_KERNEL
)

68 
vty_out
 (
vty
, " Zebø kî√»debuggög i†⁄%s", 
VTY_NEWLINE
);

70 i‡(
	gIS_ZEBRA_DEBUG_RIB
)

71 
vty_out
 (
vty
, " Zebø RIB debuggög i†⁄%s", 
VTY_NEWLINE
);

72 i‡(
	gIS_ZEBRA_DEBUG_RIB_Q
)

73 
vty_out
 (
vty
, " Zebø RIB queuêdebuggög i†⁄%s", 
VTY_NEWLINE
);

75 i‡(
	gIS_ZEBRA_DEBUG_FPM
)

76 
vty_out
 (
vty
, " Zebø FPM debuggög i†⁄%s", 
VTY_NEWLINE
);

78  
	gCMD_SUCCESS
;

81 
DEFUN
 (
debug_zebø_evíts
,

82 
debug_zebø_evíts_cmd
,

84 
DEBUG_STR


88 
	gzebø_debug_evít
 = 
ZEBRA_DEBUG_EVENT
;

89  
	gCMD_WARNING
;

92 
DEFUN
 (
debug_zebø_∑ckë
,

93 
debug_zebø_∑ckë_cmd
,

95 
DEBUG_STR


99 
	gzebø_debug_∑ckë
 = 
ZEBRA_DEBUG_PACKET
;

100 
	gzebø_debug_∑ckë
 |
ZEBRA_DEBUG_SEND
;

101 
	gzebø_debug_∑ckë
 |
ZEBRA_DEBUG_RECV
;

102  
	gCMD_SUCCESS
;

105 
DEFUN
 (
debug_zebø_∑ckë_dúe˘
,

106 
debug_zebø_∑ckë_dúe˘_cmd
,

108 
DEBUG_STR


114 
	gzebø_debug_∑ckë
 = 
ZEBRA_DEBUG_PACKET
;

115 i‡(
°∫cmp
 ("£nd", 
¨gv
[0], 
°æí
 (argv[0])) == 0)

116 
zebø_debug_∑ckë
 |
ZEBRA_DEBUG_SEND
;

117 i‡(
°∫cmp
 ("ªcv", 
¨gv
[0], 
°æí
 (argv[0])) == 0)

118 
zebø_debug_∑ckë
 |
ZEBRA_DEBUG_RECV
;

119 
	gzebø_debug_∑ckë
 &~
ZEBRA_DEBUG_DETAIL
;

120  
	gCMD_SUCCESS
;

123 
DEFUN
 (
debug_zebø_∑ckë_dëaû
,

124 
debug_zebø_∑ckë_dëaû_cmd
,

126 
DEBUG_STR


133 
	gzebø_debug_∑ckë
 = 
ZEBRA_DEBUG_PACKET
;

134 i‡(
°∫cmp
 ("£nd", 
¨gv
[0], 
°æí
 (argv[0])) == 0)

135 
zebø_debug_∑ckë
 |
ZEBRA_DEBUG_SEND
;

136 i‡(
°∫cmp
 ("ªcv", 
¨gv
[0], 
°æí
 (argv[0])) == 0)

137 
zebø_debug_∑ckë
 |
ZEBRA_DEBUG_RECV
;

138 
	gzebø_debug_∑ckë
 |
ZEBRA_DEBUG_DETAIL
;

139  
	gCMD_SUCCESS
;

142 
DEFUN
 (
debug_zebø_kî√l
,

143 
debug_zebø_kî√l_cmd
,

145 
DEBUG_STR


149 
	gzebø_debug_kî√l
 = 
ZEBRA_DEBUG_KERNEL
;

150  
	gCMD_SUCCESS
;

153 
DEFUN
 (
debug_zebø_rib
,

154 
debug_zebø_rib_cmd
,

156 
DEBUG_STR


160 
SET_FLAG
 (
zebø_debug_rib
, 
ZEBRA_DEBUG_RIB
);

161  
	gCMD_SUCCESS
;

164 
DEFUN
 (
debug_zebø_rib_q
,

165 
debug_zebø_rib_q_cmd
,

167 
DEBUG_STR


172 
SET_FLAG
 (
zebø_debug_rib
, 
ZEBRA_DEBUG_RIB_Q
);

173  
	gCMD_SUCCESS
;

176 
DEFUN
 (
debug_zebø_Âm
,

177 
debug_zebø_Âm_cmd
,

179 
DEBUG_STR


183 
SET_FLAG
 (
zebø_debug_Âm
, 
ZEBRA_DEBUG_FPM
);

184  
	gCMD_SUCCESS
;

187 
DEFUN
 (
no_debug_zebø_evíts
,

188 
no_debug_zebø_evíts_cmd
,

190 
NO_STR


191 
DEBUG_STR


195 
	gzebø_debug_evít
 = 0;

196  
	gCMD_SUCCESS
;

199 
DEFUN
 (
no_debug_zebø_∑ckë
,

200 
no_debug_zebø_∑ckë_cmd
,

202 
NO_STR


203 
DEBUG_STR


207 
	gzebø_debug_∑ckë
 = 0;

208  
	gCMD_SUCCESS
;

211 
DEFUN
 (
no_debug_zebø_∑ckë_dúe˘
,

212 
no_debug_zebø_∑ckë_dúe˘_cmd
,

214 
NO_STR


215 
DEBUG_STR


221 i‡(
°∫cmp
 ("£nd", 
¨gv
[0], 
°æí
 (argv[0])) == 0)

222 
zebø_debug_∑ckë
 &~
ZEBRA_DEBUG_SEND
;

223 i‡(
°∫cmp
 ("ªcv", 
¨gv
[0], 
°æí
 (argv[0])) == 0)

224 
zebø_debug_∑ckë
 &~
ZEBRA_DEBUG_RECV
;

225  
	gCMD_SUCCESS
;

228 
DEFUN
 (
no_debug_zebø_kî√l
,

229 
no_debug_zebø_kî√l_cmd
,

231 
NO_STR


232 
DEBUG_STR


236 
	gzebø_debug_kî√l
 = 0;

237  
	gCMD_SUCCESS
;

240 
DEFUN
 (
no_debug_zebø_rib
,

241 
no_debug_zebø_rib_cmd
,

243 
NO_STR


244 
DEBUG_STR


248 
	gzebø_debug_rib
 = 0;

249  
	gCMD_SUCCESS
;

252 
DEFUN
 (
no_debug_zebø_rib_q
,

253 
no_debug_zebø_rib_q_cmd
,

255 
NO_STR


256 
DEBUG_STR


261 
UNSET_FLAG
 (
zebø_debug_rib
, 
ZEBRA_DEBUG_RIB_Q
);

262  
	gCMD_SUCCESS
;

265 
DEFUN
 (
no_debug_zebø_Âm
,

266 
no_debug_zebø_Âm_cmd
,

268 
NO_STR


269 
DEBUG_STR


273 
	gzebø_debug_Âm
 = 0;

274  
	gCMD_SUCCESS
;

278 
cmd_node
 
	gdebug_node
 =

280 
DEBUG_NODE
,

286 
	$c⁄fig_wrôe_debug
 (
vty
 *vty)

288 
wrôe
 = 0;

290 i‡(
IS_ZEBRA_DEBUG_EVENT
)

292 
	`vty_out
 (
vty
, "debug zebøÉvíts%s", 
VTY_NEWLINE
);

293 
wrôe
++;

295 i‡(
IS_ZEBRA_DEBUG_PACKET
)

297 i‡(
IS_ZEBRA_DEBUG_SEND
 && 
IS_ZEBRA_DEBUG_RECV
)

299 
	`vty_out
 (
vty
, "debug zebraÖacket%s%s",

300 
IS_ZEBRA_DEBUG_DETAIL
 ? " detail" : "",

301 
VTY_NEWLINE
);

302 
wrôe
++;

306 i‡(
IS_ZEBRA_DEBUG_SEND
)

307 
	`vty_out
 (
vty
, "debug zebraÖacket send%s%s",

308 
IS_ZEBRA_DEBUG_DETAIL
 ? " detail" : "",

309 
VTY_NEWLINE
);

311 
	`vty_out
 (
vty
, "debug zebraÖacketÑecv%s%s",

312 
IS_ZEBRA_DEBUG_DETAIL
 ? " detail" : "",

313 
VTY_NEWLINE
);

314 
wrôe
++;

317 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

319 
	`vty_out
 (
vty
, "debug zebø kî√l%s", 
VTY_NEWLINE
);

320 
wrôe
++;

322 i‡(
IS_ZEBRA_DEBUG_RIB
)

324 
	`vty_out
 (
vty
, "debug zebøÑib%s", 
VTY_NEWLINE
);

325 
wrôe
++;

327 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

329 
	`vty_out
 (
vty
, "debug zebøÑib queue%s", 
VTY_NEWLINE
);

330 
wrôe
++;

332 i‡(
IS_ZEBRA_DEBUG_FPM
)

334 
	`vty_out
 (
vty
, "debug zebø fpm%s", 
VTY_NEWLINE
);

335 
wrôe
++;

337  
wrôe
;

338 
	}
}

341 
	$zebø_debug_öô
 ()

343 
zebø_debug_evít
 = 0;

344 
zebø_debug_∑ckë
 = 0;

345 
zebø_debug_kî√l
 = 0;

346 
zebø_debug_rib
 = 0;

347 
zebø_debug_Âm
 = 0;

349 
	`ö°Æl_node
 (&
debug_node
, 
c⁄fig_wrôe_debug
);

351 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_debuggög_zebø_cmd
);

353 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_debuggög_zebø_cmd
);

354 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_evíts_cmd
);

355 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_∑ckë_cmd
);

356 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_∑ckë_dúe˘_cmd
);

357 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_∑ckë_dëaû_cmd
);

358 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_kî√l_cmd
);

359 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_rib_cmd
);

360 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_rib_q_cmd
);

361 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
debug_zebø_Âm_cmd
);

362 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_zebø_evíts_cmd
);

363 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_zebø_∑ckë_cmd
);

364 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_zebø_kî√l_cmd
);

365 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_zebø_rib_cmd
);

366 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_zebø_rib_q_cmd
);

367 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
no_debug_zebø_Âm_cmd
);

369 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_evíts_cmd
);

370 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_∑ckë_cmd
);

371 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_∑ckë_dúe˘_cmd
);

372 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_∑ckë_dëaû_cmd
);

373 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_kî√l_cmd
);

374 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_rib_cmd
);

375 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_rib_q_cmd
);

376 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
debug_zebø_Âm_cmd
);

377 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_zebø_evíts_cmd
);

378 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_zebø_∑ckë_cmd
);

379 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_zebø_kî√l_cmd
);

380 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_zebø_rib_cmd
);

381 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_zebø_rib_q_cmd
);

382 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_debug_zebø_Âm_cmd
);

383 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/debug.h

23 #i‚de‡
_ZEBRA_DEBUG_H


24 
	#_ZEBRA_DEBUG_H


	)

27 
	#ZEBRA_DEBUG_EVENT
 0x01

	)

29 
	#ZEBRA_DEBUG_PACKET
 0x01

	)

30 
	#ZEBRA_DEBUG_SEND
 0x20

	)

31 
	#ZEBRA_DEBUG_RECV
 0x40

	)

32 
	#ZEBRA_DEBUG_DETAIL
 0x80

	)

34 
	#ZEBRA_DEBUG_KERNEL
 0x01

	)

36 
	#ZEBRA_DEBUG_RIB
 0x01

	)

37 
	#ZEBRA_DEBUG_RIB_Q
 0x02

	)

39 
	#ZEBRA_DEBUG_FPM
 0x01

	)

42 
	#IS_ZEBRA_DEBUG_EVENT
 (
zebø_debug_evít
 & 
ZEBRA_DEBUG_EVENT
)

	)

44 
	#IS_ZEBRA_DEBUG_PACKET
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_PACKET
)

	)

45 
	#IS_ZEBRA_DEBUG_SEND
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_SEND
)

	)

46 
	#IS_ZEBRA_DEBUG_RECV
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_RECV
)

	)

47 
	#IS_ZEBRA_DEBUG_DETAIL
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_DETAIL
)

	)

49 
	#IS_ZEBRA_DEBUG_KERNEL
 (
zebø_debug_kî√l
 & 
ZEBRA_DEBUG_KERNEL
)

	)

51 
	#IS_ZEBRA_DEBUG_RIB
 (
zebø_debug_rib
 & 
ZEBRA_DEBUG_RIB
)

	)

52 
	#IS_ZEBRA_DEBUG_RIB_Q
 (
zebø_debug_rib
 & 
ZEBRA_DEBUG_RIB_Q
)

	)

54 
	#IS_ZEBRA_DEBUG_FPM
 (
zebø_debug_Âm
 & 
ZEBRA_DEBUG_FPM
)

	)

56 
zebø_debug_evít
;

57 
zebø_debug_∑ckë
;

58 
zebø_debug_kî√l
;

59 
zebø_debug_rib
;

60 
zebø_debug_Âm
;

62 
zebø_debug_öô
 ();

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_ioctl.c

23 
	~<zebø.h
>

25 
	~"if.h
"

26 
	~"sockuni⁄.h
"

27 
	~"¥efix.h
"

28 
	~"io˘l.h
"

29 
	~"c⁄√˘ed.h
"

30 
	~"mem‹y.h
"

31 
	~"log.h
"

33 
	~"zebø/öãrÁ˚.h
"

37 
	$öãrÁ˚_li°_io˘l
 ()

39 
ªt
;

40 
sock
;

41 
	#IFNUM_BASE
 32

	)

42 
i‚um
;

43 
i‰eq
 *ifreq;

44 
ifc⁄f
 ifconf;

45 
öãrÁ˚
 *
iÂ
;

46 
n
;

47 
œ°Àn
;

50 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_DGRAM
, 0);

51 i‡(
sock
 < 0)

53 
	`zlog_w¨n
 ("C™'àmakêAF_INET sockë såóm: %s", 
	`ß„_°ªº‹
 (
î∫o
));

59 #ifde‡
SIOCGIFNUM


60 
ªt
 = 
	`io˘l
 (
sock
, 
SIOCGIFNUM
, &
i‚um
);

61 i‡(
ªt
 < 0)

62 
i‚um
 = 
IFNUM_BASE
;

64 
i‚um
++;

66 
i‚um
 = 
IFNUM_BASE
;

69 
ifc⁄f
.
ifc_buf
 = 
NULL
;

71 
œ°Àn
 = 0;

75 
ifc⁄f
.
ifc_Àn
 =  (
i‰eq
Ë* 
i‚um
;

76 
ifc⁄f
.
ifc_buf
 = 
	`XREALLOC
(
MTYPE_TMP
, ifc⁄f.ifc_buf, ifc⁄f.
ifc_Àn
);

78 
ªt
 = 
	`io˘l
(
sock
, 
SIOCGIFCONF
, &
ifc⁄f
);

80 i‡(
ªt
 < 0)

82 
	`zlog_w¨n
 ("SIOCGIFCONF: %s", 
	`ß„_°ªº‹
(
î∫o
));

83 
íd
;

86 i‡(
ifc⁄f
.
ifc_Àn
 > 
œ°Àn
)

88 
œ°Àn
 = 
ifc⁄f
.
ifc_Àn
;

89 
i‚um
 += 10;

97 
i‰eq
 = 
ifc⁄f
.
ifc_ªq
;

99 #ifde‡
OPEN_BSD


100 
n
 = 0;Ç < 
ifc⁄f
.
ifc_Àn
; )

102 
size
;

104 
i‰eq
 = (i‰eq *)((
ˇddr_t
Ë
ifc⁄f
.
ifc_ªq
 + 
n
);

105 
iÂ
 = 
	`if_gë_by_«me_Àn
(
i‰eq
->
i‰_«me
,

106 
	`°∫Àn
(
i‰eq
->
i‰_«me
,

107 (
i‰eq
->
i‰_«me
)));

108 
	`if_add_upd©e
 (
iÂ
);

109 
size
 = 
i‰eq
->
i‰_addr
.
ß_Àn
;

110 i‡(
size
 <  (
i‰eq
->
i‰_addr
))

111 
size
 =  (
i‰eq
->
i‰_addr
);

112 
size
 + (
i‰eq
->
i‰_«me
);

113 
n
 +
size
;

116 
n
 = 0;Ç < 
ifc⁄f
.
ifc_Àn
;Ç +(
i‰eq
))

118 
iÂ
 = 
	`if_gë_by_«me_Àn
(
i‰eq
->
i‰_«me
,

119 
	`°∫Àn
(
i‰eq
->
i‰_«me
,

120 (
i‰eq
->
i‰_«me
)));

121 
	`if_add_upd©e
 (
iÂ
);

122 
i‰eq
++;

126 
íd
:

127 
	`˛o£
 (
sock
);

128 
	`XFREE
 (
MTYPE_TMP
, 
ifc⁄f
.
ifc_buf
);

130  
ªt
;

131 
	}
}

135 
	$if_gë_ödex
 (
öãrÁ˚
 *
iÂ
)

137 #i‡
	`deföed
(
HAVE_IF_NAMETOINDEX
)

139 
iÂ
->
ifödex
 = 
	`if_«mëoödex
(iÂ->
«me
);

140 #ñi‡
	`deföed
(
SIOCGIFINDEX
Ë&& !deföed(
HAVE_BROKEN_ALIASES
)

142 
ªt
;

143 
i‰eq
 ifreq;

144 
if_Áke_ödex
;

146 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

148 
ªt
 = 
	`if_io˘l
 (
SIOCGIFINDEX
, (
ˇddr_t
Ë&
i‰eq
);

149 i‡(
ªt
 < 0)

152 
iÂ
->
ifödex
 = 
if_Áke_ödex
++;

153  
iÂ
->
ifödex
;

157 #ifde‡
i‰_ifödex


158 
iÂ
->
ifödex
 = 
i‰eq
.
i‰_ifödex
;

160 
iÂ
->
ifödex
 = 
i‰eq
.
i‰_ödex
;

166 #i‡!
	`deföed
(
HAVE_BROKEN_ALIASES
)

171 
if_Áke_ödex
 = 1;

172 
iÂ
->
ifödex
 = 
if_Áke_ödex
++;

175  
iÂ
->
ifödex
;

176 
	}
}

178 #ifde‡
SIOCGIFHWADDR


180 
	$if_gë_hwaddr
 (
öãrÁ˚
 *
iÂ
)

182 
ªt
;

183 
i‰eq
 ifreq;

184 
i
;

186 
	`°∫˝y
 (
i‰eq
.
i‰_«me
, 
iÂ
->
«me
, 
IFNAMSIZ
);

187 
i‰eq
.
i‰_addr
.
ß_Ámûy
 = 
AF_INET
;

190 
ªt
 = 
	`if_io˘l
 (
SIOCGIFHWADDR
, (
ˇddr_t
Ë&
i‰eq
);

191 i‡(
ªt
 < 0)

192 
iÂ
->
hw_addr_Àn
 = 0;

195 
	`mem˝y
 (
iÂ
->
hw_addr
, 
i‰eq
.
i‰_hwaddr
.
ß_d©a
, 6);

197 
i
 = 0; i < 6; i++)

198 i‡(
iÂ
->
hw_addr
[
i
] != 0)

201 i‡(
i
 == 6)

202 
iÂ
->
hw_addr_Àn
 = 0;

204 
iÂ
->
hw_addr_Àn
 = 6;

207 
	}
}

210 #ifde‡
HAVE_GETIFADDRS


211 
	~<iÁddrs.h
>

214 
	$if_gëaddrs
 ()

216 
ªt
;

217 
iÁddrs
 *
iÁp
;

218 
iÁddrs
 *
iÁp‰ì
;

219 
öãrÁ˚
 *
iÂ
;

220 
¥efixÀn
;

222 
ªt
 = 
	`gëiÁddrs
 (&
iÁp
);

223 i‡(
ªt
 != 0)

225 
	`zlog_îr
 ("gëiÁddrs(): %s", 
	`ß„_°ªº‹
 (
î∫o
));

229 
iÁp‰ì
 = 
iÁp
; iÁp; iÁ∞iÁp->
iÁ_√xt
)

231 i‡(
iÁp
->
iÁ_addr
 =
NULL
)

233 
	`zlog_îr
 ("%s:Çonsensical ifaddr with NULL ifa_addr, ifname %s",

234 
__func__
, (
iÁp
->
iÁ_«me
 ? ifap->ifa_name : "(null)"));

238 
iÂ
 = 
	`if_lookup_by_«me
 (
iÁp
->
iÁ_«me
);

239 i‡(
iÂ
 =
NULL
)

241 
	`zlog_îr
 ("if_getaddrs(): Can'tÜookup interface %s\n",

242 
iÁp
->
iÁ_«me
);

246 i‡(
iÁp
->
iÁ_addr
->
ß_Ámûy
 =
AF_INET
)

248 
sockaddr_ö
 *
addr
;

249 
sockaddr_ö
 *
mask
;

250 
sockaddr_ö
 *
de°
;

251 
ö_addr
 *
de°_≤t
;

252 
Êags
 = 0;

254 
addr
 = (
sockaddr_ö
 *Ë
iÁp
->
iÁ_addr
;

255 
mask
 = (
sockaddr_ö
 *Ë
iÁp
->
iÁ_√tmask
;

256 
¥efixÀn
 = 
	`ù_maskÀn
 (
mask
->
sö_addr
);

258 
de°_≤t
 = 
NULL
;

260 i‡(
iÁp
->
iÁ_d°addr
 &&

261 !
	`IPV4_ADDR_SAME
(&
addr
->
sö_addr
,

262 &((
sockaddr_ö
 *)

263 
iÁp
->
iÁ_d°addr
)->
sö_addr
))

265 
de°
 = (
sockaddr_ö
 *Ë
iÁp
->
iÁ_d°addr
;

266 
de°_≤t
 = &
de°
->
sö_addr
;

267 
Êags
 = 
ZEBRA_IFA_PEER
;

269 i‡(
iÁp
->
iÁ_brﬂdaddr
 &&

270 !
	`IPV4_ADDR_SAME
(&
addr
->
sö_addr
,

271 &((
sockaddr_ö
 *)

272 
iÁp
->
iÁ_brﬂdaddr
)->
sö_addr
))

274 
de°
 = (
sockaddr_ö
 *Ë
iÁp
->
iÁ_brﬂdaddr
;

275 
de°_≤t
 = &
de°
->
sö_addr
;

278 
	`c⁄√˘ed_add_ùv4
 (
iÂ
, 
Êags
, &
addr
->
sö_addr
,

279 
¥efixÀn
, 
de°_≤t
, 
NULL
);

281 #ifde‡
HAVE_IPV6


282 i‡(
iÁp
->
iÁ_addr
->
ß_Ámûy
 =
AF_INET6
)

284 
sockaddr_ö6
 *
addr
;

285 
sockaddr_ö6
 *
mask
;

286 
sockaddr_ö6
 *
de°
;

287 
ö6_addr
 *
de°_≤t
;

288 
Êags
 = 0;

290 
addr
 = (
sockaddr_ö6
 *Ë
iÁp
->
iÁ_addr
;

291 
mask
 = (
sockaddr_ö6
 *Ë
iÁp
->
iÁ_√tmask
;

292 
¥efixÀn
 = 
	`ù6_maskÀn
 (
mask
->
sö6_addr
);

294 
de°_≤t
 = 
NULL
;

296 i‡(
iÁp
->
iÁ_d°addr
 &&

297 !
	`IPV6_ADDR_SAME
(&
addr
->
sö6_addr
,

298 &((
sockaddr_ö6
 *)

299 
iÁp
->
iÁ_d°addr
)->
sö6_addr
))

301 
de°
 = (
sockaddr_ö6
 *Ë
iÁp
->
iÁ_d°addr
;

302 
de°_≤t
 = &
de°
->
sö6_addr
;

303 
Êags
 = 
ZEBRA_IFA_PEER
;

305 i‡(
iÁp
->
iÁ_brﬂdaddr
 &&

306 !
	`IPV6_ADDR_SAME
(&
addr
->
sö6_addr
,

307 &((
sockaddr_ö6
 *)

308 
iÁp
->
iÁ_brﬂdaddr
)->
sö6_addr
))

310 
de°
 = (
sockaddr_ö6
 *Ë
iÁp
->
iÁ_brﬂdaddr
;

311 
de°_≤t
 = &
de°
->
sö6_addr
;

314 #i‡
	`deföed
(
KAME
)

315 i‡(
	`IN6_IS_ADDR_LINKLOCAL
(&
addr
->
sö6_addr
))

317 
addr
->
sö6_sc›e_id
 =

318 
	`¡ohs
(*(
u_öt16_t
 *)&
addr
->
sö6_addr
.
s6_addr
[2]);

319 
addr
->
sö6_addr
.
s6_addr
[2] =áddr->sin6_addr.s6_addr[3] = 0;

323 
	`c⁄√˘ed_add_ùv6
 (
iÂ
, 
Êags
, &
addr
->
sö6_addr
, 
¥efixÀn
,

324 
de°_≤t
, 
NULL
);

329 
	`‰ìiÁddrs
 (
iÁp‰ì
);

332 
	}
}

337 
	$if_gë_addr
 (
öãrÁ˚
 *
iÂ
)

339 
ªt
;

340 
i‰eq
 ifreq;

341 
sockaddr_ö
 
addr
;

342 
sockaddr_ö
 
mask
;

343 
sockaddr_ö
 
de°
;

344 
ö_addr
 *
de°_≤t
;

345 
u_ch¨
 
¥efixÀn
;

346 
Êags
 = 0;

349 
	`°∫˝y
 (
i‰eq
.
i‰_«me
, 
iÂ
->
«me
, 
IFNAMSIZ
);

350 
i‰eq
.
i‰_addr
.
ß_Ámûy
 = 
AF_INET
;

353 
ªt
 = 
	`if_io˘l
 (
SIOCGIFADDR
, (
ˇddr_t
Ë&
i‰eq
);

354 i‡(
ªt
 < 0)

356 i‡(
î∫o
 !
EADDRNOTAVAIL
)

358 
	`zlog_w¨n
 ("SIOCGIFADDR faû: %s", 
	`ß„_°ªº‹
 (
î∫o
));

359  
ªt
;

363 
	`mem˝y
 (&
addr
, &
i‰eq
.
i‰_addr
,  (
sockaddr_ö
));

366 
ªt
 = 
	`if_io˘l
 (
SIOCGIFNETMASK
, (
ˇddr_t
Ë&
i‰eq
);

367 i‡(
ªt
 < 0)

369 i‡(
î∫o
 !
EADDRNOTAVAIL
)

371 
	`zlog_w¨n
 ("SIOCGIFNETMASK faû: %s", 
	`ß„_°ªº‹
 (
î∫o
));

372  
ªt
;

376 #ifde‡
i‰_√tmask


377 
	`mem˝y
 (&
mask
, &
i‰eq
.
i‰_√tmask
,  (
sockaddr_ö
));

379 
	`mem˝y
 (&
mask
, &
i‰eq
.
i‰_addr
,  (
sockaddr_ö
));

381 
¥efixÀn
 = 
	`ù_maskÀn
 (
mask
.
sö_addr
);

384 
de°_≤t
 = 
NULL
;

386 
ªt
 = 
	`if_io˘l
 (
SIOCGIFDSTADDR
, (
ˇddr_t
Ë&
i‰eq
);

387 i‡(
ªt
 < 0)

389 i‡(
î∫o
 !
EADDRNOTAVAIL
)

390 
	`zlog_w¨n
 ("SIOCGIFDSTADDR faû: %s", 
	`ß„_°ªº‹
 (
î∫o
));

392 i‡(!
	`IPV4_ADDR_SAME
(&
addr
.
sö_addr
, &
i‰eq
.
i‰_d°addr
.sin_addr))

394 
	`mem˝y
 (&
de°
, &
i‰eq
.
i‰_d°addr
,  (
sockaddr_ö
));

395 
de°_≤t
 = &
de°
.
sö_addr
;

396 
Êags
 = 
ZEBRA_IFA_PEER
;

398 i‡(!
de°_≤t
)

400 
ªt
 = 
	`if_io˘l
 (
SIOCGIFBRDADDR
, (
ˇddr_t
Ë&
i‰eq
);

401 i‡(
ªt
 < 0)

403 i‡(
î∫o
 !
EADDRNOTAVAIL
)

404 
	`zlog_w¨n
 ("SIOCGIFBRDADDR faû: %s", 
	`ß„_°ªº‹
 (
î∫o
));

406 i‡(!
	`IPV4_ADDR_SAME
(&
addr
.
sö_addr
, &
i‰eq
.
i‰_brﬂdaddr
.sin_addr))

408 
	`mem˝y
 (&
de°
, &
i‰eq
.
i‰_brﬂdaddr
,  (
sockaddr_ö
));

409 
de°_≤t
 = &
de°
.
sö_addr
;

415 
	`c⁄√˘ed_add_ùv4
 (
iÂ
, 
Êags
, &
addr
.
sö_addr
, 
¥efixÀn
, 
de°_≤t
, 
NULL
);

418 
	}
}

423 
	$öãrÁ˚_öfo_io˘l
 ()

425 
li°node
 *
node
, *
¬ode
;

426 
öãrÁ˚
 *
iÂ
;

428 
	`ALL_LIST_ELEMENTS
 (
iÊi°
, 
node
, 
¬ode
, 
iÂ
))

430 
	`if_gë_ödex
 (
iÂ
);

431 #ifde‡
SIOCGIFHWADDR


432 
	`if_gë_hwaddr
 (
iÂ
);

434 
	`if_gë_Êags
 (
iÂ
);

435 #i‚de‡
HAVE_GETIFADDRS


436 
	`if_gë_addr
 (
iÂ
);

438 
	`if_gë_mtu
 (
iÂ
);

439 
	`if_gë_mëric
 (
iÂ
);

441 
	}
}

445 
	$öãrÁ˚_li°
 ()

449 #ifde‡
HAVE_PROC_NET_DEV


450 
	`öãrÁ˚_li°_¥oc
 ();

452 
	`öãrÁ˚_li°_io˘l
 ();

456 
	`öãrÁ˚_öfo_io˘l
 ();

458 #ifde‡
HAVE_GETIFADDRS


459 
	`if_gëaddrs
 ();

462 #i‡
	`deföed
(
HAVE_IPV6
Ë&& deföed(
HAVE_PROC_NET_IF_INET6
)

465 
	`iÁddr_¥oc_ùv6
 ();

467 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_ioctl_solaris.c

23 
	~<zebø.h
>

25 
	~"if.h
"

26 
	~"sockuni⁄.h
"

27 
	~"¥efix.h
"

28 
	~"io˘l.h
"

29 
	~"c⁄√˘ed.h
"

30 
	~"mem‹y.h
"

31 
	~"log.h
"

32 
	~"¥ivs.h
"

34 
	~"zebø/öãrÁ˚.h
"

36 
li‰eq_£t_«me
 (
li‰eq
 *, const *);

37 
if_gë_Êags_dúe˘
 (c⁄° *, 
uöt64_t
 *, 
af
);

38 
if_gë_addr
 (
öãrÁ˚
 *, 
sockaddr
 *, const *);

39 
öãrÁ˚_öfo_io˘l
 (
öãrÁ˚
 *);

40 
zebø_¥ivs_t
 
z£rv_¥ivs
;

43 
	$öãrÁ˚_li°_io˘l
 (
af
)

45 
ªt
;

46 
sock
;

47 
	#IFNUM_BASE
 32

	)

48 
li‚um
 
li‚
;

49 
i‚um
;

50 
li‰eq
 *lifreq;

51 
lifc⁄f
Üifconf;

52 
öãrÁ˚
 *
iÂ
;

53 
n
;

54 
ßve_î∫o
;

55 
size_t
 
√eded
, 
œ°√eded
 = 0;

56 *
buf
 = 
NULL
;

58 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

59 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

61 
sock
 = 
	`sockë
 (
af
, 
SOCK_DGRAM
, 0);

62 i‡(
sock
 < 0)

64 
	`zlog_w¨n
 ("Can't make %s socket stream: %s",

65 (
af
 =
AF_INET
 ? "AF_INET" : "AF_INET6"), 
	`ß„_°ªº‹
 (
î∫o
));

67 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

68 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

73 
ˇlcuœã_lifc_Àn
:

74 
li‚
.
li‚_Ámûy
 = 
af
;

75 
li‚
.
li‚_Êags
 = 
LIFC_NOXMIT
;

76 
ªt
 = 
	`io˘l
 (
sock
, 
SIOCGLIFNUM
, &
li‚
);

77 
ßve_î∫o
 = 
î∫o
;

79 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

80 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

82 i‡(
ªt
 < 0)

84 
	`zlog_w¨n
 ("interface_list_ioctl: SIOCGLIFNUM failed %s",

85 
	`ß„_°ªº‹
 (
ßve_î∫o
));

86 
	`˛o£
 (
sock
);

89 
i‚um
 = 
li‚
.
li‚_cou¡
;

97 
√eded
 = (
i‚um
 + 4Ë*  (
li‰eq
);

98 i‡(
√eded
 > 
œ°√eded
 ||Çeeded <Üastneeded / 2)

100 i‡(
buf
 !
NULL
)

101 
	`XFREE
 (
MTYPE_TMP
, 
buf
);

102 i‡((
buf
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
√eded
)Ë=
NULL
)

104 
	`zlog_w¨n
 ("interface_list_ioctl: malloc failed");

105 
	`˛o£
 (
sock
);

109 
œ°√eded
 = 
√eded
;

111 
lifc⁄f
.
lifc_Ámûy
 = 
af
;

112 
lifc⁄f
.
lifc_Êags
 = 
LIFC_NOXMIT
;

113 
lifc⁄f
.
lifc_Àn
 = 
√eded
;

114 
lifc⁄f
.
lifc_buf
 = 
buf
;

116 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

117 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

119 
ªt
 = 
	`io˘l
 (
sock
, 
SIOCGLIFCONF
, &
lifc⁄f
);

121 i‡(
ªt
 < 0)

123 i‡(
î∫o
 =
EINVAL
)

124 
ˇlcuœã_lifc_Àn
;

126 
	`zlog_w¨n
 ("SIOCGLIFCONF: %s", 
	`ß„_°ªº‹
 (
î∫o
));

128 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

129 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

131 
íd
;

134 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

135 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

138 
li‰eq
 = 
lifc⁄f
.
lifc_ªq
;

140 
n
 = 0;Ç < 
lifc⁄f
.
lifc_Àn
;Ç + (
li‰eq
))

150 
n‹mÆÀn
 = 0;

151 
uöt64_t
 
lifÊags
;

156 i‡(
	`if_gë_Êags_dúe˘
 (
li‰eq
->
li‰_«me
, &
lifÊags
,

157 
li‰eq
->
li‰_addr
.
ss_Ámûy
)

158 || !
	`CHECK_FLAG
 (
lifÊags
, 
IFF_UP
))

160 
li‰eq
++;

165  (
n‹mÆÀn
 < (
li‰eq
->
li‰_«me
))

166 && ( *(
li‰eq
->
li‰_«me
 + 
n‹mÆÀn
) != '\0')

167 && ( *(
li‰eq
->
li‰_«me
 + 
n‹mÆÀn
) != ':') )

168 
n‹mÆÀn
++;

170 
iÂ
 = 
	`if_gë_by_«me_Àn
(
li‰eq
->
li‰_«me
, 
n‹mÆÀn
);

172 i‡(
li‰eq
->
li‰_addr
.
ss_Ámûy
 =
AF_INET
)

173 
iÂ
->
Êags
 |
IFF_IPV4
;

175 i‡(
li‰eq
->
li‰_addr
.
ss_Ámûy
 =
AF_INET6
)

177 #ifde‡
HAVE_IPV6


178 
iÂ
->
Êags
 |
IFF_IPV6
;

180 
li‰eq
++;

185 
	`if_add_upd©e
 (
iÂ
);

187 
	`öãrÁ˚_öfo_io˘l
 (
iÂ
);

192 i‡–*(
li‰eq
->
li‰_«me
 + 
n‹mÆÀn
) != '\0')

193 
	`if_gë_addr
 (
iÂ
, (
sockaddr
 *Ë&
li‰eq
->
li‰_addr
,

194 
li‰eq
->
li‰_«me
);

196 
	`if_gë_addr
 (
iÂ
, (
sockaddr
 *Ë&
li‰eq
->
li‰_addr
, 
NULL
);

199 
	`if_Êags_upd©e
 (
iÂ
, iÂ->
Êags
);

201 
li‰eq
++;

204 
íd
:

205 
	`˛o£
 (
sock
);

206 
	`XFREE
 (
MTYPE_TMP
, 
lifc⁄f
.
lifc_buf
);

207  
ªt
;

208 
	}
}

212 
	$if_gë_ödex
 (
öãrÁ˚
 *
iÂ
)

214 
ªt
;

215 
li‰eq
Üifreq;

217 
	`li‰eq_£t_«me
 (&
li‰eq
, 
iÂ
->
«me
);

219 i‡(
iÂ
->
Êags
 & 
IFF_IPV4
)

220 
ªt
 = 
	`AF_IOCTL
 (
AF_INET
, 
SIOCGLIFINDEX
, (
ˇddr_t
Ë& 
li‰eq
);

221 i‡(
iÂ
->
Êags
 & 
IFF_IPV6
)

222 
ªt
 = 
	`AF_IOCTL
 (
AF_INET6
, 
SIOCGLIFINDEX
, (
ˇddr_t
Ë& 
li‰eq
);

224 
ªt
 = -1;

226 i‡(
ªt
 < 0)

228 
	`zlog_w¨n
 ("SIOCGLIFINDEX(%sËÁûed", 
iÂ
->
«me
);

229  
ªt
;

233 #ifde‡
i‰_ifödex


234 
iÂ
->
ifödex
 = 
li‰eq
.
li‰_ifödex
;

236 
iÂ
->
ifödex
 = 
li‰eq
.
li‰_ödex
;

238  
iÂ
->
ifödex
;

240 
	}
}

245 
	#ADDRLEN
(
ß
Ë(((ß)->
ß_Ámûy
 =
AF_INET
 ? \

246  (
sockaddr_ö
Ë:  (
sockaddr_ö6
)))

	)

248 
	#SIN
(
s
Ë((
sockaddr_ö
 *)(s))

	)

249 
	#SIN6
(
s
Ë((
sockaddr_ö6
 *)(s))

	)

253 
	$if_gë_addr
 (
öãrÁ˚
 *
iÂ
, 
sockaddr
 *
addr
, c⁄° *
œbñ
)

255 
ªt
;

256 
li‰eq
Üifreq;

257 
sockaddr_°‹age
 
mask
, 
de°
;

258 *
de°_≤t
 = 
NULL
;

259 
u_ch¨
 
¥efixÀn
 = 0;

260 
afi_t
 
af
;

261 
Êags
 = 0;

267 
	`°∫˝y
 (
li‰eq
.
li‰_«me
, (
œbñ
 ?Üabñ : 
iÂ
->
«me
), 
IFNAMSIZ
);

270 
	`mem˝y
 (&
li‰eq
.
li‰_addr
, 
addr
, 
	`ADDRLEN
 (addr));

271 
af
 = 
addr
->
ß_Ámûy
;

274 
de°_≤t
 = 
NULL
;

276 i‡(
	`AF_IOCTL
 (
af
, 
SIOCGLIFDSTADDR
, (
ˇddr_t
Ë& 
li‰eq
) >= 0)

278 
	`mem˝y
 (&
de°
, &
li‰eq
.
li‰_d°addr
, 
	`ADDRLEN
 (
addr
));

279 i‡(
af
 =
AF_INET
)

280 
de°_≤t
 = (*Ë&(
	`SIN
 (&
de°
)->
sö_addr
);

282 
de°_≤t
 = (*Ë&(
	`SIN6
 (&
de°
)->
sö6_addr
);

283 
Êags
 = 
ZEBRA_IFA_PEER
;

286 i‡(
af
 =
AF_INET
)

288 
ªt
 = 
	`if_io˘l
 (
SIOCGLIFNETMASK
, (
ˇddr_t
Ë& 
li‰eq
);

290 i‡(
ªt
 < 0)

292 i‡(
î∫o
 !
EADDRNOTAVAIL
)

294 
	`zlog_w¨n
 ("SIOCGLIFNETMASK (%sËÁû: %s", 
iÂ
->
«me
,

295 
	`ß„_°ªº‹
 (
î∫o
));

296  
ªt
;

300 
	`mem˝y
 (&
mask
, &
li‰eq
.
li‰_addr
, 
	`ADDRLEN
 (
addr
));

302 
¥efixÀn
 = 
	`ù_maskÀn
 (
	`SIN
 (&
mask
)->
sö_addr
);

303 i‡(!
de°_≤t
 && (
	`if_io˘l
 (
SIOCGLIFBRDADDR
, (
ˇddr_t
Ë& 
li‰eq
) >= 0))

305 
	`mem˝y
 (&
de°
, &
li‰eq
.
li‰_brﬂdaddr
,  (
sockaddr_ö
));

306 
de°_≤t
 = (*Ë&
	`SIN
 (&
de°
)->
sö_addr
;

309 #ifde‡
HAVE_IPV6


310 i‡(
af
 =
AF_INET6
)

312 i‡(
	`if_io˘l_ùv6
 (
SIOCGLIFSUBNET
, (
ˇddr_t
Ë& 
li‰eq
) < 0)

314 i‡(
iÂ
->
Êags
 & 
IFF_POINTOPOINT
)

315 
¥efixÀn
 = 
IPV6_MAX_BITLEN
;

317 
	`zlog_w¨n
 ("SIOCGLIFSUBNET (%s) fail: %s",

318 
iÂ
->
«me
, 
	`ß„_°ªº‹
 (
î∫o
));

322 
¥efixÀn
 = 
li‰eq
.
li‰_addæí
;

328 i‡(
af
 =
AF_INET
)

329 
	`c⁄√˘ed_add_ùv4
 (
iÂ
, 
Êags
, &
	`SIN
 (
addr
)->
sö_addr
, 
¥efixÀn
,

330 (
ö_addr
 *Ë
de°_≤t
, 
œbñ
);

331 #ifde‡
HAVE_IPV6


332 i‡(
af
 =
AF_INET6
)

333 
	`c⁄√˘ed_add_ùv6
 (
iÂ
, 
Êags
, &
	`SIN6
 (
addr
)->
sö6_addr
, 
¥efixÀn
,

334 (
ö6_addr
 *Ë
de°_≤t
, 
œbñ
);

338 
	}
}

342 
	$öãrÁ˚_öfo_io˘l
 (
öãrÁ˚
 *
iÂ
)

344 
	`if_gë_ödex
 (
iÂ
);

345 
	`if_gë_Êags
 (
iÂ
);

346 
	`if_gë_mtu
 (
iÂ
);

347 
	`if_gë_mëric
 (
iÂ
);

348 
	}
}

352 
	$öãrÁ˚_li°
 ()

354 
	`öãrÁ˚_li°_io˘l
 (
AF_INET
);

355 
	`öãrÁ˚_li°_io˘l
 (
AF_INET6
);

356 
	`öãrÁ˚_li°_io˘l
 (
AF_UNSPEC
);

357 
	}
}

359 
c⁄√˘ed
 *

360 
	$if_lookup_lökloˇl
 (
öãrÁ˚
 *
iÂ
)

362 #ifde‡
HAVE_IPV6


363 
li°node
 *
node
;

364 
c⁄√˘ed
 *
ifc
;

366 i‡(
iÂ
 =
NULL
)

367  
NULL
;

369 
	`ALL_LIST_ELEMENTS_RO
(
iÂ
->
c⁄√˘ed
, 
node
, 
ifc
))

371 i‡((
ifc
->
addªss
->
Ámûy
 =
AF_INET6
) &&

372 (
	`IN6_IS_ADDR_LINKLOCAL
 (&
ifc
->
addªss
->
u
.
¥efix6
)))

373  
ifc
;

377  
NULL
;

378 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_netlink.c

23 
	~<zebø.h
>

25 
	~"zebø/z£rv.h
"

27 
öãrÁ˚_lookup_√éök
 ();

31 
	$öãrÁ˚_li°
 ()

33 
	`öãrÁ˚_lookup_√éök
 ();

34 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_proc.c

22 
	~<zebø.h
>

24 
	~"if.h
"

25 
	~"¥efix.h
"

26 
	~"log.h
"

28 
	~"zebø/io˘l.h
"

29 
	~"zebø/c⁄√˘ed.h
"

30 
	~"zebø/öãrÁ˚.h
"

33 
	#PROCBUFSIZ
 1024

	)

36 #i‚de‡
_PATH_PROC_NET_DEV


37 
	#_PATH_PROC_NET_DEV
 "/¥oc/√t/dev"

	)

42 
	$öãrÁ˚_«me_cut
 (*
buf
, **
«me
)

44 *
°©
;

47 *
buf
 == ' ')

48 
buf
++;

49 *
«me
 = 
buf
;

52 
°©
 = 
	`°ºchr
 (
buf
, ':');

53 *
°©
++ = '\0';

55  
°©
;

56 
	}
}

60 
	$if°©_dev_fõlds
 (
vîsi⁄
, *
buf
, 
öãrÁ˚
 *
iÂ
)

62 
vîsi⁄
)

65 
	`ssˇnf
(
buf
,

67 &
iÂ
->
°©s
.
rx_byãs
,

68 &
iÂ
->
°©s
.
rx_∑ckës
,

69 &
iÂ
->
°©s
.
rx_îr‹s
,

70 &
iÂ
->
°©s
.
rx_dr›≥d
,

71 &
iÂ
->
°©s
.
rx_fifo_îr‹s
,

72 &
iÂ
->
°©s
.
rx_‰ame_îr‹s
,

73 &
iÂ
->
°©s
.
rx_com¥es£d
,

74 &
iÂ
->
°©s
.
rx_mu…iˇ°
,

76 &
iÂ
->
°©s
.
tx_byãs
,

77 &
iÂ
->
°©s
.
tx_∑ckës
,

78 &
iÂ
->
°©s
.
tx_îr‹s
,

79 &
iÂ
->
°©s
.
tx_dr›≥d
,

80 &
iÂ
->
°©s
.
tx_fifo_îr‹s
,

81 &
iÂ
->
°©s
.
cﬁlisi⁄s
,

82 &
iÂ
->
°©s
.
tx_ˇºõr_îr‹s
,

83 &
iÂ
->
°©s
.
tx_com¥es£d
);

86 
	`ssˇnf
(
buf
, "%ld %ld %ld %ld %ld %ld %ld %ld %ld %ld %ld %ld %ld",

87 &
iÂ
->
°©s
.
rx_byãs
,

88 &
iÂ
->
°©s
.
rx_∑ckës
,

89 &
iÂ
->
°©s
.
rx_îr‹s
,

90 &
iÂ
->
°©s
.
rx_dr›≥d
,

91 &
iÂ
->
°©s
.
rx_fifo_îr‹s
,

92 &
iÂ
->
°©s
.
rx_‰ame_îr‹s
,

94 &
iÂ
->
°©s
.
tx_byãs
,

95 &
iÂ
->
°©s
.
tx_∑ckës
,

96 &
iÂ
->
°©s
.
tx_îr‹s
,

97 &
iÂ
->
°©s
.
tx_dr›≥d
,

98 &
iÂ
->
°©s
.
tx_fifo_îr‹s
,

99 &
iÂ
->
°©s
.
cﬁlisi⁄s
,

100 &
iÂ
->
°©s
.
tx_ˇºõr_îr‹s
);

101 
iÂ
->
°©s
.
rx_mu…iˇ°
 = 0;

104 
	`ssˇnf
(
buf
, "%ld %ld %ld %ld %ld %ld %ld %ld %ld %ld %ld",

105 &
iÂ
->
°©s
.
rx_∑ckës
,

106 &
iÂ
->
°©s
.
rx_îr‹s
,

107 &
iÂ
->
°©s
.
rx_dr›≥d
,

108 &
iÂ
->
°©s
.
rx_fifo_îr‹s
,

109 &
iÂ
->
°©s
.
rx_‰ame_îr‹s
,

111 &
iÂ
->
°©s
.
tx_∑ckës
,

112 &
iÂ
->
°©s
.
tx_îr‹s
,

113 &
iÂ
->
°©s
.
tx_dr›≥d
,

114 &
iÂ
->
°©s
.
tx_fifo_îr‹s
,

115 &
iÂ
->
°©s
.
cﬁlisi⁄s
,

116 &
iÂ
->
°©s
.
tx_ˇºõr_îr‹s
);

117 
iÂ
->
°©s
.
rx_byãs
 = 0;

118 
iÂ
->
°©s
.
tx_byãs
 = 0;

119 
iÂ
->
°©s
.
rx_mu…iˇ°
 = 0;

123 
	}
}

127 
	$if°©_upd©e_¥oc
 ()

129 
FILE
 *
Â
;

130 
buf
[
PROCBUFSIZ
];

131 
vîsi⁄
;

132 
öãrÁ˚
 *
iÂ
;

133 *
°©
;

134 *
«me
;

137 
Â
 = 
	`f›í
 (
_PATH_PROC_NET_DEV
, "r");

138 i‡(
Â
 =
NULL
)

140 
	`zlog_w¨n
 ("Can't openÖroc file %s: %s",

141 
_PATH_PROC_NET_DEV
, 
	`ß„_°ªº‹
 (
î∫o
));

146 
	`fgës
 (
buf
, 
PROCBUFSIZ
, 
Â
);

147 
	`fgës
 (
buf
, 
PROCBUFSIZ
, 
Â
);

150 i‡(
	`°r°r
 (
buf
, "compressed"))

151 
vîsi⁄
 = 3;

152 i‡(
	`°r°r
 (
buf
, "bytes"))

153 
vîsi⁄
 = 2;

155 
vîsi⁄
 = 1;

158 
	`fgës
 (
buf
, 
PROCBUFSIZ
, 
Â
Ë!
NULL
)

160 
°©
 = 
	`öãrÁ˚_«me_cut
 (
buf
, &
«me
);

161 
iÂ
 = 
	`if_gë_by_«me
 (
«me
);

162 
	`if°©_dev_fõlds
 (
vîsi⁄
, 
°©
, 
iÂ
);

164 
	`f˛o£
(
Â
);

166 
	}
}

170 
	$öãrÁ˚_li°_¥oc
 ()

172 
FILE
 *
Â
;

173 
buf
[
PROCBUFSIZ
];

174 
öãrÁ˚
 *
iÂ
;

175 *
«me
;

178 
Â
 = 
	`f›í
 (
_PATH_PROC_NET_DEV
, "r");

179 i‡(
Â
 =
NULL
)

181 
	`zlog_w¨n
 ("Can't openÖroc file %s: %s",

182 
_PATH_PROC_NET_DEV
, 
	`ß„_°ªº‹
 (
î∫o
));

187 
	`fgës
 (
buf
, 
PROCBUFSIZ
, 
Â
);

188 
	`fgës
 (
buf
, 
PROCBUFSIZ
, 
Â
);

192 
	`fgës
 (
buf
, 
PROCBUFSIZ
, 
Â
Ë!
NULL
)

194 
	`öãrÁ˚_«me_cut
 (
buf
, &
«me
);

195 
iÂ
 = 
	`if_gë_by_«me
 (
«me
);

196 
	`if_add_upd©e
 (
iÂ
);

198 
	`f˛o£
(
Â
);

200 
	}
}

202 #i‡
deföed
(
HAVE_IPV6
Ë&& deföed(
HAVE_PROC_NET_IF_INET6
)

204 #i‚de‡
_PATH_PROC_NET_IF_INET6


205 
	#_PATH_PROC_NET_IF_INET6
 "/¥oc/√t/if_öë6"

	)

209 
	$iÁddr_¥oc_ùv6
 ()

211 
FILE
 *
Â
;

212 
buf
[
PROCBUFSIZ
];

213 
n
;

214 
addr
[33];

215 
i‚ame
[21];

216 
ifödex
, 
∂í
, 
sc›e
, 
°©us
;

217 
öãrÁ˚
 *
iÂ
;

218 
¥efix_ùv6
 
p
;

221 
Â
 = 
	`f›í
 (
_PATH_PROC_NET_IF_INET6
, "r");

222 i‡(
Â
 =
NULL
)

224 
	`zlog_w¨n
 ("Can't openÖroc file %s: %s",

225 
_PATH_PROC_NET_IF_INET6
, 
	`ß„_°ªº‹
 (
î∫o
));

230 
	`fgës
 (
buf
, 
PROCBUFSIZ
, 
Â
Ë!
NULL
)

232 
n
 = 
	`ssˇnf
 (
buf
, "%32s %02x %02x %02x %02x %20s",

233 
addr
, &
ifödex
, &
∂í
, &
sc›e
, &
°©us
, 
i‚ame
);

234 i‡(
n
 != 6)

237 
iÂ
 = 
	`if_gë_by_«me
 (
i‚ame
);

240 
	`°r2ö6_addr
 (
addr
, &
p
.
¥efix
);

241 
p
.
¥efixÀn
 = 
∂í
;

243 
	`c⁄√˘ed_add_ùv6
 (
iÂ
, 0, &
p
.
¥efix
,Ö.
¥efixÀn
, 
NULL
, 
i‚ame
);

245 
	`f˛o£
 (
Â
);

247 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_sysctl.c

23 
	~<zebø.h
>

25 
	~"if.h
"

26 
	~"sockuni⁄.h
"

27 
	~"¥efix.h
"

28 
	~"c⁄√˘ed.h
"

29 
	~"mem‹y.h
"

30 
	~"io˘l.h
"

31 
	~"log.h
"

33 
	~"zebø/π.h
"

34 
	~"zebø/kî√l_sockë.h
"

37 
	$if°©_upd©e_sys˘l
 ()

39 
ˇddr_t
 
ªf
, 
buf
, 
íd
;

40 
size_t
 
bufsiz
;

41 
if_msghdr
 *
ifm
;

42 
öãrÁ˚
 *
iÂ
;

44 
	#MIBSIZ
 6

	)

45 
mib
[
MIBSIZ
] =

47 
CTL_NET
,

48 
PF_ROUTE
,

51 
NET_RT_IFLIST
,

56 i‡(
	`sys˘l
 (
mib
, 
MIBSIZ
, 
NULL
, &
bufsiz
, NULL, 0) < 0)

58 
	`zlog_w¨n
 ("sys˘l(Ëîr‹ by %s", 
	`ß„_°ªº‹
 (
î∫o
));

63 
ªf
 = 
buf
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
bufsiz
);

66 i‡(
	`sys˘l
 (
mib
, 
MIBSIZ
, 
buf
, &
bufsiz
, 
NULL
, 0) < 0)

68 
	`zlog
 (
NULL
, 
LOG_WARNING
, "sys˘»îr‹ by %s", 
	`ß„_°ªº‹
 (
î∫o
));

73 
íd
 = 
buf
 + 
bufsiz
; bu‡<Énd; bu‡+
ifm
->
ifm_msgÀn
)

75 
ifm
 = (
if_msghdr
 *Ë
buf
;

76 i‡(
ifm
->
ifm_ty≥
 =
RTM_IFINFO
)

78 
iÂ
 = 
	`if_lookup_by_ödex
 (
ifm
->
ifm_ödex
);

79 i‡(
iÂ
)

80 
iÂ
->
°©s
 = 
ifm
->
ifm_d©a
;

85 
	`XFREE
 (
MTYPE_TMP
, 
ªf
);

88 
	}
}

92 
	$öãrÁ˚_li°
 ()

94 
ˇddr_t
 
ªf
, 
buf
, 
íd
;

95 
size_t
 
bufsiz
;

96 
if_msghdr
 *
ifm
;

98 
	#MIBSIZ
 6

	)

99 
mib
[
MIBSIZ
] =

101 
CTL_NET
,

102 
PF_ROUTE
,

105 
NET_RT_IFLIST
,

110 i‡(
	`sys˘l
 (
mib
, 
MIBSIZ
, 
NULL
, &
bufsiz
, NULL, 0) < 0)

112 
	`zlog
 (
NULL
, 
LOG_WARNING
, "sys˘l(Ëîr‹ by %s", 
	`ß„_°ªº‹
 (
î∫o
));

117 
ªf
 = 
buf
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
bufsiz
);

120 i‡(
	`sys˘l
 (
mib
, 
MIBSIZ
, 
buf
, &
bufsiz
, 
NULL
, 0) < 0)

122 
	`zlog
 (
NULL
, 
LOG_WARNING
, "sys˘»îr‹ by %s", 
	`ß„_°ªº‹
 (
î∫o
));

127 
íd
 = 
buf
 + 
bufsiz
; bu‡<Énd; bu‡+
ifm
->
ifm_msgÀn
)

129 
ifm
 = (
if_msghdr
 *Ë
buf
;

131 
ifm
->
ifm_ty≥
)

133 
RTM_IFINFO
:

134 
	`ifm_ªad
 (
ifm
);

136 
RTM_NEWADDR
:

137 
	`iÁm_ªad
 ((
iÁ_msghdr
 *Ë
ifm
);

140 
	`zlog_öfo
 ("interfaces_list(): unexpected messageÅype");

141 
	`XFREE
 (
MTYPE_TMP
, 
ªf
);

148 
	`XFREE
 (
MTYPE_TMP
, 
ªf
);

149 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/interface.c

23 
	~<zebø.h
>

25 
	~"if.h
"

26 
	~"vty.h
"

27 
	~"sockuni⁄.h
"

28 
	~"¥efix.h
"

29 
	~"comm™d.h
"

30 
	~"mem‹y.h
"

31 
	~"io˘l.h
"

32 
	~"c⁄√˘ed.h
"

33 
	~"log.h
"

34 
	~"z˛õ¡.h
"

36 
	~"zebø/öãrÁ˚.h
"

37 
	~"zebø/πadv.h
"

38 
	~"zebø/rib.h
"

39 
	~"zebø/z£rv.h
"

40 
	~"zebø/ªdi°ribuã.h
"

41 
	~"zebø/debug.h
"

42 
	~"zebø/údp.h
"

44 #ifde‡
RTADV


47 c⁄° *
	gπadv_¥ef_°rs
[] = { "medium", "high", "INVALID", "low", 0 };

52 
	$if_zebø_√w_hook
 (
öãrÁ˚
 *
iÂ
)

54 
zebø_if
 *zebra_if;

56 
zebø_if
 = 
	`XCALLOC
 (
MTYPE_TMP
,  (zebra_if));

58 
zebø_if
->
mu…iˇ°
 = 
IF_ZEBRA_MULTICAST_UNSPEC
;

59 
zebø_if
->
shutdown
 = 
IF_ZEBRA_SHUTDOWN_UNSPEC
;

61 #ifde‡
RTADV


64 
πadvc⁄f
 *
πadv
;

66 
πadv
 = &
zebø_if
->rtadv;

68 
πadv
->
AdvSídAdvîti£míts
 = 0;

69 
πadv
->
MaxRåAdvI¡îvÆ
 = 
RTADV_MAX_RTR_ADV_INTERVAL
;

70 
πadv
->
MöRåAdvI¡îvÆ
 = 
RTADV_MIN_RTR_ADV_INTERVAL
;

71 
πadv
->
AdvI¡îvÆTimî
 = 0;

72 
πadv
->
AdvM™agedFœg
 = 0;

73 
πadv
->
AdvOthîC⁄figFœg
 = 0;

74 
πadv
->
AdvHomeAgítFœg
 = 0;

75 
πadv
->
AdvLökMTU
 = 0;

76 
πadv
->
AdvRóchabÀTime
 = 0;

77 
πadv
->
AdvRëønsTimî
 = 0;

78 
πadv
->
AdvCurH›Limô
 = 0;

79 
πadv
->
AdvDeÁu…Li„time
 = -1;

80 
πadv
->
HomeAgítPª„ªn˚
 = 0;

81 
πadv
->
HomeAgítLi„time
 = -1;

82 
πadv
->
AdvI¡îvÆO±i⁄
 = 0;

83 
πadv
->
DeÁu…Pª„ªn˚
 = 
RTADV_PREF_MEDIUM
;

85 
πadv
->
AdvPªfixLi°
 = 
	`li°_√w
 ();

90 
zebø_if
->
ùv4_sub√ts
 = 
	`rouã_èbÀ_öô
 ();

92 
iÂ
->
öfo
 = 
zebø_if
;

94 
	}
}

98 
	$if_zebø_dñëe_hook
 (
öãrÁ˚
 *
iÂ
)

100 
zebø_if
 *zebra_if;

102 i‡(
iÂ
->
öfo
)

104 
zebø_if
 = 
iÂ
->
öfo
;

107 i‡(
zebø_if
->
ùv4_sub√ts
)

108 
	`rouã_èbÀ_föish
 (
zebø_if
->
ùv4_sub√ts
);

110 
	`XFREE
 (
MTYPE_TMP
, 
zebø_if
);

114 
	}
}

118 
	$if_sub√t_add
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

120 
rouã_node
 *
∫
;

121 
zebø_if
 *zebra_if;

122 
¥efix
 
˝
;

123 
li°
 *
addr_li°
;

125 
	`as£π
 (
iÂ
 && iÂ->
öfo
 && 
ifc
);

126 
zebø_if
 = 
iÂ
->
öfo
;

130 
˝
 = *
ifc
->
addªss
;

131 
	`≠∂y_mask
 (&
˝
);

132 
∫
 = 
	`rouã_node_gë
 (
zebø_if
->
ùv4_sub√ts
, &
˝
);

134 i‡((
addr_li°
 = 
∫
->
öfo
))

135 
	`SET_FLAG
 (
ifc
->
Êags
, 
ZEBRA_IFA_SECONDARY
);

138 
	`UNSET_FLAG
 (
ifc
->
Êags
, 
ZEBRA_IFA_SECONDARY
);

139 
∫
->
öfo
 = 
addr_li°
 = 
	`li°_√w
 ();

140 
	`rouã_lock_node
 (
∫
);

144 
	`li°node_add
 (
addr_li°
, 
ifc
);

147  (
addr_li°
->
cou¡
);

148 
	}
}

152 
	$if_sub√t_dñëe
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

154 
rouã_node
 *
∫
;

155 
zebø_if
 *zebra_if;

156 
li°
 *
addr_li°
;

158 
	`as£π
 (
iÂ
 && iÂ->
öfo
 && 
ifc
);

159 
zebø_if
 = 
iÂ
->
öfo
;

162 
∫
 = 
	`rouã_node_lookup
 (
zebø_if
->
ùv4_sub√ts
, 
ifc
->
addªss
);

163 i‡(! (
∫
 &&Ñn->
öfo
))

165 
	`rouã_u∆ock_node
 (
∫
);

168 
addr_li°
 = 
∫
->
öfo
;

169 
	`li°node_dñëe
 (
addr_li°
, 
ifc
);

170 
	`rouã_u∆ock_node
 (
∫
);

173 i‡(
addr_li°
->
cou¡
)

176 i‡(! 
	`CHECK_FLAG
 (
ifc
->
Êags
, 
ZEBRA_IFA_SECONDARY
))

178 
ifc
 = 
	`li°gëd©a
 (
	`li°hód
 (
addr_li°
));

179 
	`zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
iÂ
, 
ifc
);

180 
	`UNSET_FLAG
 (
ifc
->
Êags
, 
ZEBRA_IFA_SECONDARY
);

181 
	`zebø_öãrÁ˚_addªss_add_upd©e
 (
iÂ
, 
ifc
);

184  
addr_li°
->
cou¡
;

188 
	`li°_‰ì
 (
addr_li°
);

189 
∫
->
öfo
 = 
NULL
;

190 
	`rouã_u∆ock_node
 (
∫
);

193 
	}
}

220 
	$if_Êags_m™gÀ
 (
öãrÁ˚
 *
iÂ
, 
uöt64_t
 *
√wÊags
)

222 #ifde‡
SUNOS_5


223 
zebø_if
 *
zif
 = 
iÂ
->
öfo
;

225 
zif
->
¥im¨y_°©e
 = *
√wÊags
 & (
IFF_UP
 & 0xff);

227 i‡(
	`CHECK_FLAG
 (
zif
->
¥im¨y_°©e
, 
IFF_UP
)

228 || 
	`li°cou¡
(
iÂ
->
c⁄√˘ed
) > 0)

229 
	`SET_FLAG
 (*
√wÊags
, 
IFF_UP
);

231 
	`UNSET_FLAG
 (*
√wÊags
, 
IFF_UP
);

233 
	}
}

242 
	$if_Êags_upd©e
 (
öãrÁ˚
 *
iÂ
, 
uöt64_t
 
√wÊags
)

244 
	`if_Êags_m™gÀ
 (
iÂ
, &
√wÊags
);

246 i‡(
	`if_is_›î©ive
 (
iÂ
))

249 
iÂ
->
Êags
 = 
√wÊags
;

250 i‡(!
	`if_is_›î©ive
 (
iÂ
))

251 
	`if_down
 (
iÂ
);

256 
iÂ
->
Êags
 = 
√wÊags
;

257 i‡(
	`if_is_›î©ive
 (
iÂ
))

258 
	`if_up
 (
iÂ
);

260 
	}
}

265 
	$if_addr_wakeup
 (
öãrÁ˚
 *
iÂ
)

267 
li°node
 *
node
, *
¬ode
;

268 
c⁄√˘ed
 *
ifc
;

269 
¥efix
 *
p
;

270 
ªt
;

272 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
node
, 
¬ode
, 
ifc
))

274 
p
 = 
ifc
->
addªss
;

276 i‡(
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
)

277 && ! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

280 i‡(
p
->
Ámûy
 =
AF_INET
)

282 i‡(! 
	`if_is_up
 (
iÂ
))

294 
	`if_£t_Êags
 (
iÂ
, 
IFF_UP
 | 
IFF_RUNNING
);

295 
	`if_ª‰esh
 (
iÂ
);

298 
ªt
 = 
	`if_£t_¥efix
 (
iÂ
, 
ifc
);

299 i‡(
ªt
 < 0)

301 
	`zlog_w¨n
 ("Can't set interface'sáddress: %s",

302 
	`ß„_°ªº‹
(
î∫o
));

307 
	`if_sub√t_add
 (
iÂ
, 
ifc
);

309 
	`SET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

311 
	`zebø_öãrÁ˚_addªss_add_upd©e
 (
iÂ
, 
ifc
);

313 i‡(
	`if_is_›î©ive
(
iÂ
))

314 
	`c⁄√˘ed_up_ùv4
 (
iÂ
, 
ifc
);

316 #ifde‡
HAVE_IPV6


317 i‡(
p
->
Ámûy
 =
AF_INET6
)

319 i‡(! 
	`if_is_up
 (
iÂ
))

322 
	`if_£t_Êags
 (
iÂ
, 
IFF_UP
 | 
IFF_RUNNING
);

323 
	`if_ª‰esh
 (
iÂ
);

326 
ªt
 = 
	`if_¥efix_add_ùv6
 (
iÂ
, 
ifc
);

327 i‡(
ªt
 < 0)

329 
	`zlog_w¨n
 ("Can't set interface'sáddress: %s",

330 
	`ß„_°ªº‹
(
î∫o
));

333 
	`SET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

335 
	`zebø_öãrÁ˚_addªss_add_upd©e
 (
iÂ
, 
ifc
);

337 i‡(
	`if_is_›î©ive
(
iÂ
))

338 
	`c⁄√˘ed_up_ùv6
 (
iÂ
, 
ifc
);

343 
	}
}

347 
	$if_add_upd©e
 (
öãrÁ˚
 *
iÂ
)

349 
zebø_if
 *
if_d©a
;

351 
if_d©a
 = 
iÂ
->
öfo
;

352 i‡(
if_d©a
->
mu…iˇ°
 =
IF_ZEBRA_MULTICAST_ON
)

353 
	`if_£t_Êags
 (
iÂ
, 
IFF_MULTICAST
);

354 i‡(
if_d©a
->
mu…iˇ°
 =
IF_ZEBRA_MULTICAST_OFF
)

355 
	`if_un£t_Êags
 (
iÂ
, 
IFF_MULTICAST
);

357 
	`zebø_öãrÁ˚_add_upd©e
 (
iÂ
);

359 i‡(! 
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

361 
	`SET_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
);

363 
	`if_addr_wakeup
 (
iÂ
);

365 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

366 
	`zlog_debug
 ("interface %s index %d becomesáctive.",

367 
iÂ
->
«me
, iÂ->
ifödex
);

371 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

372 
	`zlog_debug
 ("öãrÁ˚ %†ödex %d i†added.", 
iÂ
->
«me
, iÂ->
ifödex
);

374 
	}
}

378 
	$if_dñëe_upd©e
 (
öãrÁ˚
 *
iÂ
)

380 
c⁄√˘ed
 *
ifc
;

381 
¥efix
 *
p
;

382 
rouã_node
 *
∫
;

383 
zebø_if
 *zebra_if;

385 
zebø_if
 = 
iÂ
->
öfo
;

387 i‡(
	`if_is_up
(
iÂ
))

389 
	`zlog_îr
 ("interface %s index %d is still up while being deleted.",

390 
iÂ
->
«me
, iÂ->
ifödex
);

395 
	`UNSET_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
);

397 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

398 
	`zlog_debug
 ("interface %s index %d isÇow inactive.",

399 
iÂ
->
«me
, iÂ->
ifödex
);

402 i‡(
iÂ
->
c⁄√˘ed
)

404 
li°node
 *
node
;

405 
li°node
 *
œ°
 = 
NULL
;

407 (
node
 = (
œ°
 ?Üa°->
√xt
 : 
	`li°hód
 (
iÂ
->
c⁄√˘ed
))))

409 
ifc
 = 
	`li°gëd©a
 (
node
);

410 
p
 = 
ifc
->
addªss
;

412 i‡(
p
->
Ámûy
 =
AF_INET


413 && (
∫
 = 
	`rouã_node_lookup
 (
zebø_if
->
ùv4_sub√ts
, 
p
)))

415 
li°node
 *
™ode
;

416 
li°node
 *
√xt
;

417 
li°node
 *
fú°
;

418 
li°
 *
addr_li°
;

420 
	`rouã_u∆ock_node
 (
∫
);

421 
addr_li°
 = (
li°
 *Ë
∫
->
öfo
;

424 
fú°
 = 
	`li°hód
 (
addr_li°
);

425 
™ode
 = 
fú°
->
√xt
;ánode || first;ánode =Çext)

427 i‡(!
™ode
)

429 
™ode
 = 
fú°
;

430 
fú°
 = 
NULL
;

432 
√xt
 = 
™ode
->next;

434 
ifc
 = 
	`li°gëd©a
 (
™ode
);

435 
p
 = 
ifc
->
addªss
;

437 
	`c⁄√˘ed_down_ùv4
 (
iÂ
, 
ifc
);

439 
	`zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
iÂ
, 
ifc
);

441 
	`UNSET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

444 
	`li°_dñëe_node
 (
addr_li°
, 
™ode
);

445 
	`rouã_u∆ock_node
 (
∫
);

448 i‡(!
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

450 
	`li°node_dñëe
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

451 
	`c⁄√˘ed_‰ì
 (
ifc
);

454 
œ°
 = 
node
;

458 
	`li°_dñëe
 (
addr_li°
);

459 
∫
->
öfo
 = 
NULL
;

460 
	`rouã_u∆ock_node
 (
∫
);

462 #ifde‡
HAVE_IPV6


463 i‡(
p
->
Ámûy
 =
AF_INET6
)

465 
	`c⁄√˘ed_down_ùv6
 (
iÂ
, 
ifc
);

467 
	`zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
iÂ
, 
ifc
);

469 
	`UNSET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

471 i‡(
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

472 
œ°
 = 
node
;

475 
	`li°node_dñëe
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

476 
	`c⁄√˘ed_‰ì
 (
ifc
);

482 
œ°
 = 
node
;

486 
	`zebø_öãrÁ˚_dñëe_upd©e
 (
iÂ
);

493 
iÂ
->
ifödex
 = 
IFINDEX_INTERNAL
;

494 
	}
}

498 
	$if_up
 (
öãrÁ˚
 *
iÂ
)

500 
li°node
 *
node
;

501 
li°node
 *
√xt
;

502 
c⁄√˘ed
 *
ifc
;

503 
¥efix
 *
p
;

506 
	`zebø_öãrÁ˚_up_upd©e
 (
iÂ
);

509 i‡(
iÂ
->
c⁄√˘ed
)

511 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
node
, 
√xt
, 
ifc
))

513 
p
 = 
ifc
->
addªss
;

515 i‡(
p
->
Ámûy
 =
AF_INET
)

516 
	`c⁄√˘ed_up_ùv4
 (
iÂ
, 
ifc
);

517 #ifde‡
HAVE_IPV6


518 i‡(
p
->
Ámûy
 =
AF_INET6
)

519 
	`c⁄√˘ed_up_ùv6
 (
iÂ
, 
ifc
);

525 
	`rib_upd©e
 ();

526 
	}
}

531 
	$if_down
 (
öãrÁ˚
 *
iÂ
)

533 
li°node
 *
node
;

534 
li°node
 *
√xt
;

535 
c⁄√˘ed
 *
ifc
;

536 
¥efix
 *
p
;

539 
	`zebø_öãrÁ˚_down_upd©e
 (
iÂ
);

542 i‡(
iÂ
->
c⁄√˘ed
)

544 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
node
, 
√xt
, 
ifc
))

546 
p
 = 
ifc
->
addªss
;

548 i‡(
p
->
Ámûy
 =
AF_INET
)

549 
	`c⁄√˘ed_down_ùv4
 (
iÂ
, 
ifc
);

550 #ifde‡
HAVE_IPV6


551 i‡(
p
->
Ámûy
 =
AF_INET6
)

552 
	`c⁄√˘ed_down_ùv6
 (
iÂ
, 
ifc
);

558 
	`rib_upd©e
 ();

559 
	}
}

562 
	$if_ª‰esh
 (
öãrÁ˚
 *
iÂ
)

564 
	`if_gë_Êags
 (
iÂ
);

565 
	}
}

569 
	$¥efix_vty_out
 (
vty
 *vty, 
¥efix
 *
p
)

571 
°r
[
INET6_ADDRSTRLEN
];

573 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
°r
,  (str));

574 
	`vty_out
 (
vty
, "%s", 
°r
);

575  
	`°æí
 (
°r
);

576 
	}
}

580 
	$c⁄√˘ed_dump_vty
 (
vty
 *vty, 
c⁄√˘ed
 *connected)

582 
¥efix
 *
p
;

585 
p
 = 
c⁄√˘ed
->
addªss
;

586 
	`vty_out
 (
vty
, " %†", 
	`¥efix_Ámûy_°r
 (
p
));

587 
	`¥efix_vty_out
 (
vty
, 
p
);

588 
	`vty_out
 (
vty
, "/%d", 
p
->
¥efixÀn
);

591 i‡(
c⁄√˘ed
->
de°ö©i⁄
)

593 
	`vty_out
 (
vty
, (
	`CONNECTED_PEER
(
c⁄√˘ed
) ? "Öeer " : " broadcast "));

594 
	`¥efix_vty_out
 (
vty
, 
c⁄√˘ed
->
de°ö©i⁄
);

597 i‡(
	`CHECK_FLAG
 (
c⁄√˘ed
->
Êags
, 
ZEBRA_IFA_SECONDARY
))

598 
	`vty_out
 (
vty
, " secondary");

600 i‡(
c⁄√˘ed
->
œbñ
)

601 
	`vty_out
 (
vty
, " %s", 
c⁄√˘ed
->
œbñ
);

603 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

604 
	}
}

606 #ifde‡
RTADV


609 
	$nd_dump_vty
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
)

611 
zebø_if
 *
zif
;

612 
πadvc⁄f
 *
πadv
;

613 
öãrvÆ
;

615 
zif
 = (
zebø_if
 *Ë
iÂ
->
öfo
;

616 
πadv
 = &
zif
->rtadv;

618 i‡(
πadv
->
AdvSídAdvîti£míts
)

620 
	`vty_out
 (
vty
, " NDádvertisedÑeachableÅime is %d milliseconds%s",

621 
πadv
->
AdvRóchabÀTime
, 
VTY_NEWLINE
);

622 
	`vty_out
 (
vty
, " NDádvertisedÑetransmit interval is %d milliseconds%s",

623 
πadv
->
AdvRëønsTimî
, 
VTY_NEWLINE
);

624 
öãrvÆ
 = 
πadv
->
MaxRåAdvI¡îvÆ
;

625 i‡(
öãrvÆ
 % 1000)

626 
	`vty_out
 (
vty
, " NDÑouterádvertisementsáre sentÉvery "

627 "%d mûli£c⁄ds%s", 
öãrvÆ
,

628 
VTY_NEWLINE
);

630 
	`vty_out
 (
vty
, " NDÑouterádvertisementsáre sentÉvery "

631 "%d sec⁄ds%s", 
öãrvÆ
 / 1000,

632 
VTY_NEWLINE
);

633 i‡(
πadv
->
AdvDeÁu…Li„time
 != -1)

634 
	`vty_out
 (
vty
, " NDÑouterádvertisementsÜive for %d seconds%s",

635 
πadv
->
AdvDeÁu…Li„time
, 
VTY_NEWLINE
);

637 
	`vty_out
 (
vty
, " NDÑouterádvertisementsÜifetimeÅracksÑa-interval%s",

638 
VTY_NEWLINE
);

639 
	`vty_out
 (
vty
, " NDÑouterádvertisement defaultÑouterÖreference is "

640 "%s%s", 
πadv_¥ef_°rs
[
πadv
->
DeÁu…Pª„ªn˚
],

641 
VTY_NEWLINE
);

642 i‡(
πadv
->
AdvM™agedFœg
)

643 
	`vty_out
 (
vty
, " Hosts use DHCPÅo obtainÑoutableáddresses.%s",

644 
VTY_NEWLINE
);

646 
	`vty_out
 (
vty
, " Hosts use statelessáutoconfig foráddresses.%s",

647 
VTY_NEWLINE
);

648 i‡(
πadv
->
AdvHomeAgítFœg
)

650 
	`vty_out
 (
vty
, " NDÑouterádvertisements with "

652 
VTY_NEWLINE
);

653 i‡(
πadv
->
HomeAgítLi„time
 != -1)

654 
	`vty_out
 (
vty
, " Home AgentÜifetime is %u seconds%s",

655 
πadv
->
HomeAgítLi„time
, 
VTY_NEWLINE
);

657 
	`vty_out
 (
vty
, " Home AgentÜifetimeÅracksÑa-lifetime%s",

658 
VTY_NEWLINE
);

659 
	`vty_out
 (
vty
, " Home AgentÖreference is %u%s",

660 
πadv
->
HomeAgítPª„ªn˚
, 
VTY_NEWLINE
);

662 i‡(
πadv
->
AdvI¡îvÆO±i⁄
)

663 
	`vty_out
 (
vty
, " NDÑouterádvertisements with Adv. Interval option.%s",

664 
VTY_NEWLINE
);

666 
	}
}

671 
	$if_dump_vty
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
)

673 #ifde‡
HAVE_STRUCT_SOCKADDR_DL


674 
sockaddr_dl
 *
sdl
;

676 
c⁄√˘ed
 *connected;

677 
li°node
 *
node
;

678 
rouã_node
 *
∫
;

679 
zebø_if
 *zebra_if;

681 
zebø_if
 = 
iÂ
->
öfo
;

683 
	`vty_out
 (
vty
, "I¡îÁ˚ %†i†", 
iÂ
->
«me
);

684 i‡(
	`if_is_up
(
iÂ
)) {

685 
	`vty_out
 (
vty
, "up,ÜineÖrotocol ");

687 i‡(
	`CHECK_FLAG
(
iÂ
->
°©us
, 
ZEBRA_INTERFACE_LINKDETECTION
)) {

688 i‡(
	`if_is_ru¬ög
(
iÂ
))

689 
	`vty_out
 (
vty
, "i†up%s", 
VTY_NEWLINE
);

691 
	`vty_out
 (
vty
, "i†down%s", 
VTY_NEWLINE
);

693 
	`vty_out
 (
vty
, "dëe˘i⁄ i†dißbÀd%s", 
VTY_NEWLINE
);

696 
	`vty_out
 (
vty
, "down%s", 
VTY_NEWLINE
);

699 i‡(
iÂ
->
desc
)

700 
	`vty_out
 (
vty
, " Des¸ùti⁄: %s%s", 
iÂ
->
desc
,

701 
VTY_NEWLINE
);

702 i‡(
iÂ
->
ifödex
 =
IFINDEX_INTERNAL
)

704 
	`vty_out
(
vty
, "Ö£udÿöãrÁ˚%s", 
VTY_NEWLINE
);

707 i‡(! 
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

709 
	`vty_out
(
vty
, " index %d inactive interface%s",

710 
iÂ
->
ifödex
,

711 
VTY_NEWLINE
);

715 
	`vty_out
 (
vty
, " index %d metric %d mtu %d ",

716 
iÂ
->
ifödex
, iÂ->
mëric
, iÂ->
mtu
);

717 #ifde‡
HAVE_IPV6


718 i‡(
iÂ
->
mtu6
 !iÂ->
mtu
)

719 
	`vty_out
 (
vty
, "mtu6 %d ", 
iÂ
->
mtu6
);

721 
	`vty_out
 (
vty
, "%† fœgs: %s%s", 
VTY_NEWLINE
,

722 
	`if_Êag_dump
 (
iÂ
->
Êags
), 
VTY_NEWLINE
);

725 #ifde‡
HAVE_STRUCT_SOCKADDR_DL


726 
sdl
 = &
iÂ
->sdl;

727 i‡(
sdl
 !
NULL
 && sdl->
sdl_Æí
 != 0)

729 
i
;

730 
u_ch¨
 *
±r
;

732 
	`vty_out
 (
vty
, " HWaddr: ");

733 
i
 = 0, 
±r
 = (
u_ch¨
 *)
	`LLADDR
 (
sdl
); i < sdl->
sdl_Æí
; i++,Ötr++)

734 
	`vty_out
 (
vty
, "%s%02x", 
i
 =0 ? "" : ":", *
±r
);

735 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

738 i‡(
iÂ
->
hw_addr_Àn
 != 0)

740 
i
;

742 
	`vty_out
 (
vty
, " HWaddr: ");

743 
i
 = 0; i < 
iÂ
->
hw_addr_Àn
; i++)

744 
	`vty_out
 (
vty
, "%s%02x", 
i
 =0 ? "" : ":", 
iÂ
->
hw_addr
[i]);

745 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

750 i‡(
iÂ
->
b™dwidth
 != 0)

752 
	`vty_out
(
vty
, " b™dwidth %u kbps", 
iÂ
->
b™dwidth
);

753 
	`vty_out
(
vty
, "%s", 
VTY_NEWLINE
);

756 
∫
 = 
	`rouã_t›
 (
zebø_if
->
ùv4_sub√ts
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

758 i‡(! 
∫
->
öfo
)

761 
	`ALL_LIST_ELEMENTS_RO
 ((
li°
 *)
∫
->
öfo
, 
node
, 
c⁄√˘ed
))

762 
	`c⁄√˘ed_dump_vty
 (
vty
, 
c⁄√˘ed
);

765 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
node
, connected))

767 i‡(
	`CHECK_FLAG
 (
c⁄√˘ed
->
c⁄f
, 
ZEBRA_IFC_REAL
) &&

768 (
c⁄√˘ed
->
addªss
->
Ámûy
 =
AF_INET6
))

769 
	`c⁄√˘ed_dump_vty
 (
vty
, 
c⁄√˘ed
);

772 #ifde‡
RTADV


773 
	`nd_dump_vty
 (
vty
, 
iÂ
);

776 #ifde‡
HAVE_PROC_NET_DEV


778 
	`vty_out
 (
vty
, " %lu inputÖackets (%lu multicast), %lu bytes, "

780 
iÂ
->
°©s
.
rx_∑ckës
, iÂ->°©s.
rx_mu…iˇ°
,

781 
iÂ
->
°©s
.
rx_byãs
, iÂ->°©s.
rx_dr›≥d
, 
VTY_NEWLINE
);

783 
	`vty_out
 (
vty
, " %lu inputÉrrors, %luÜength, %lu overrun,"

785 
iÂ
->
°©s
.
rx_îr‹s
, iÂ->°©s.
rx_Àngth_îr‹s
,

786 
iÂ
->
°©s
.
rx_ovî_îr‹s
, iÂ->°©s.
rx_¸c_îr‹s
,

787 
iÂ
->
°©s
.
rx_‰ame_îr‹s
, 
VTY_NEWLINE
);

789 
	`vty_out
 (
vty
, " %lu fifo, %lu mis£d%s", 
iÂ
->
°©s
.
rx_fifo_îr‹s
,

790 
iÂ
->
°©s
.
rx_mis£d_îr‹s
, 
VTY_NEWLINE
);

792 
	`vty_out
 (
vty
, " %lu outputÖackets, %lu bytes, %lu dropped%s",

793 
iÂ
->
°©s
.
tx_∑ckës
, iÂ->°©s.
tx_byãs
,

794 
iÂ
->
°©s
.
tx_dr›≥d
, 
VTY_NEWLINE
);

796 
	`vty_out
 (
vty
, " %lu outputÉrrors, %luáborted, %lu carrier,"

798 
iÂ
->
°©s
.
tx_îr‹s
, iÂ->°©s.
tx_ab‹ãd_îr‹s
,

799 
iÂ
->
°©s
.
tx_ˇºõr_îr‹s
, iÂ->°©s.
tx_fifo_îr‹s
,

800 
iÂ
->
°©s
.
tx_hóπbót_îr‹s
, 
VTY_NEWLINE
);

802 
	`vty_out
 (
vty
, " %lu window, %lu collisions%s",

803 
iÂ
->
°©s
.
tx_wödow_îr‹s
, iÂ->°©s.
cﬁlisi⁄s
, 
VTY_NEWLINE
);

806 #ifde‡
HAVE_NET_RT_IFLIST


807 #i‡
	`deföed
 (
__bsdi__
Ë|| deföed (
__NëBSD__
)

809 
	`vty_out
 (
vty
, " inputÖackets %qu, bytes %qu, dropped %qu,"

811 
iÂ
->
°©s
.
ifi_ùackës
, iÂ->°©s.
ifi_ibyãs
,

812 
iÂ
->
°©s
.
ifi_iqdr›s
, iÂ->°©s.
ifi_imˇ°s
,

813 
VTY_NEWLINE
);

815 
	`vty_out
 (
vty
, " inputÉrrors %qu%s",

816 
iÂ
->
°©s
.
ifi_õº‹s
, 
VTY_NEWLINE
);

818 
	`vty_out
 (
vty
, " outputÖackets %qu, bytes %qu, multicastÖackets %qu%s",

819 
iÂ
->
°©s
.
ifi_›ackës
, iÂ->°©s.
ifi_obyãs
,

820 
iÂ
->
°©s
.
ifi_omˇ°s
, 
VTY_NEWLINE
);

822 
	`vty_out
 (
vty
, " outputÉrrors %qu%s",

823 
iÂ
->
°©s
.
ifi_€º‹s
, 
VTY_NEWLINE
);

825 
	`vty_out
 (
vty
, " collisions %qu%s",

826 
iÂ
->
°©s
.
ifi_cﬁlisi⁄s
, 
VTY_NEWLINE
);

829 
	`vty_out
 (
vty
, " inputÖackets %lu, bytes %lu, dropped %lu,"

831 
iÂ
->
°©s
.
ifi_ùackës
, iÂ->°©s.
ifi_ibyãs
,

832 
iÂ
->
°©s
.
ifi_iqdr›s
, iÂ->°©s.
ifi_imˇ°s
,

833 
VTY_NEWLINE
);

835 
	`vty_out
 (
vty
, " inputÉrrors %lu%s",

836 
iÂ
->
°©s
.
ifi_õº‹s
, 
VTY_NEWLINE
);

838 
	`vty_out
 (
vty
, " outputÖackets %lu, bytes %lu, multicastÖackets %lu%s",

839 
iÂ
->
°©s
.
ifi_›ackës
, iÂ->°©s.
ifi_obyãs
,

840 
iÂ
->
°©s
.
ifi_omˇ°s
, 
VTY_NEWLINE
);

842 
	`vty_out
 (
vty
, " outputÉrrors %lu%s",

843 
iÂ
->
°©s
.
ifi_€º‹s
, 
VTY_NEWLINE
);

845 
	`vty_out
 (
vty
, " collisions %lu%s",

846 
iÂ
->
°©s
.
ifi_cﬁlisi⁄s
, 
VTY_NEWLINE
);

849 
	}
}

855 
DEFUN_NOSH
 (
zebø_öãrÁ˚
,

856 
zebø_öãrÁ˚_cmd
,

861 
	gªt
;

862 
öãrÁ˚
 * 
	giÂ
;

865 i‡((
	gªt
 = 
öãrÁ˚_cmd
.
func
 (
£lf
, 
vty
, 
¨gc
, 
¨gv
)Ë!
CMD_SUCCESS
)

866  
ªt
;

868 
	giÂ
 = 
vty
->
ödex
;

870 i‡(
	giÂ
->
	gifödex
 =
IFINDEX_INTERNAL
)

873 
UNSET_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
);

875  
	gªt
;

878 
cmd_node
 
	göãrÁ˚_node
 =

880 
INTERFACE_NODE
,

886 
DEFUN
 (
show_öãrÁ˚
, 
show_öãrÁ˚_cmd
,

888 
SHOW_STR


892 
li°node
 *
	gnode
;

893 
öãrÁ˚
 *
	giÂ
;

895 #ifde‡
HAVE_PROC_NET_DEV


898 
if°©_upd©e_¥oc
 ();

900 #ifde‡
HAVE_NET_RT_IFLIST


901 
if°©_upd©e_sys˘l
 ();

905 i‡(
	g¨gc
 != 0)

907 
iÂ
 = 
if_lookup_by_«me
 (
¨gv
[0]);

908 i‡(
	giÂ
 =
NULL
)

910 
vty_out
 (
vty
, "%% C™'àföd i¡îÁ˚ %s%s", 
¨gv
[0],

911 
VTY_NEWLINE
);

912  
	gCMD_WARNING
;

914 
if_dump_vty
 (
vty
, 
iÂ
);

915  
	gCMD_SUCCESS
;

919 
ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

920 
if_dump_vty
 (
vty
, 
iÂ
);

922  
	gCMD_SUCCESS
;

925 
DEFUN
 (
show_öãrÁ˚_desc
,

926 
show_öãrÁ˚_desc_cmd
,

928 
SHOW_STR


932 
li°node
 *
	gnode
;

933 
öãrÁ˚
 *
	giÂ
;

935 
vty_out
 (
vty
, "I¡îÁ˚ Sètu† PrŸocﬁ Des¸ùti⁄%s", 
VTY_NEWLINE
);

936 
ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

938 
	gÀn
;

940 
	gÀn
 = 
vty_out
 (
vty
, "%s", 
iÂ
->
«me
);

941 
vty_out
 (
vty
, "%*s", (16 - 
Àn
), " ");

943 i‡(
if_is_up
(
iÂ
))

945 
vty_out
 (
vty
, "up ");

946 i‡(
CHECK_FLAG
(
iÂ
->
°©us
, 
ZEBRA_INTERFACE_LINKDETECTION
))

948 i‡(
if_is_ru¬ög
(
iÂ
))

949 
vty_out
 (
vty
, "up ");

951 
vty_out
 (
vty
, "down ");

955 
vty_out
 (
vty
, "unknown ");

960 
vty_out
 (
vty
, "down down ");

963 i‡(
	giÂ
->
	gdesc
)

964 
vty_out
 (
vty
, "%s", 
iÂ
->
desc
);

965 
vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

967  
	gCMD_SUCCESS
;

970 
DEFUN
 (
mu…iˇ°
,

971 
mu…iˇ°_cmd
,

975 
	gªt
;

976 
öãrÁ˚
 *
	giÂ
;

977 
zebø_if
 *
	gif_d©a
;

979 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

980 i‡(
CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

982 
	gªt
 = 
if_£t_Êags
 (
iÂ
, 
IFF_MULTICAST
);

983 i‡(
	gªt
 < 0)

985 
vty_out
 (
vty
, "C™'à£àmu…iˇ° fœg%s", 
VTY_NEWLINE
);

986  
	gCMD_WARNING
;

988 
if_ª‰esh
 (
iÂ
);

990 
	gif_d©a
 = 
iÂ
->
öfo
;

991 
	gif_d©a
->
	gmu…iˇ°
 = 
IF_ZEBRA_MULTICAST_ON
;

993  
	gCMD_SUCCESS
;

996 
DEFUN
 (
no_mu…iˇ°
,

997 
no_mu…iˇ°_cmd
,

999 
NO_STR


1002 
	gªt
;

1003 
öãrÁ˚
 *
	giÂ
;

1004 
zebø_if
 *
	gif_d©a
;

1006 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1007 i‡(
CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

1009 
	gªt
 = 
if_un£t_Êags
 (
iÂ
, 
IFF_MULTICAST
);

1010 i‡(
	gªt
 < 0)

1012 
vty_out
 (
vty
, "C™'àun£àmu…iˇ° fœg%s", 
VTY_NEWLINE
);

1013  
	gCMD_WARNING
;

1015 
if_ª‰esh
 (
iÂ
);

1017 
	gif_d©a
 = 
iÂ
->
öfo
;

1018 
	gif_d©a
->
	gmu…iˇ°
 = 
IF_ZEBRA_MULTICAST_OFF
;

1020  
	gCMD_SUCCESS
;

1023 
DEFUN
 (
lökdëe˘
,

1024 
lökdëe˘_cmd
,

1028 
öãrÁ˚
 *
	giÂ
;

1029 
	gif_was_›î©ive
;

1031 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1032 
	gif_was_›î©ive
 = 
if_is_›î©ive
(
iÂ
);

1033 
SET_FLAG
(
iÂ
->
°©us
, 
ZEBRA_INTERFACE_LINKDETECTION
);

1036 i‡(!
if_is_›î©ive
(
iÂ
Ë&& 
	gif_was_›î©ive
Ë
if_down
(ifp);

1041  
	gCMD_SUCCESS
;

1045 
DEFUN
 (
no_lökdëe˘
,

1046 
no_lökdëe˘_cmd
,

1048 
NO_STR


1051 
öãrÁ˚
 *
	giÂ
;

1052 
	gif_was_›î©ive
;

1054 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1055 
	gif_was_›î©ive
 = 
if_is_›î©ive
(
iÂ
);

1056 
UNSET_FLAG
(
iÂ
->
°©us
, 
ZEBRA_INTERFACE_LINKDETECTION
);

1059 i‡(
if_is_›î©ive
(
iÂ
Ë&& !
	gif_was_›î©ive
Ë
if_up
(ifp);

1063  
	gCMD_SUCCESS
;

1066 
DEFUN
 (
shutdown_if
,

1067 
shutdown_if_cmd
,

1071 
	gªt
;

1072 
öãrÁ˚
 *
	giÂ
;

1073 
zebø_if
 *
	gif_d©a
;

1075 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1076 
	gªt
 = 
if_un£t_Êags
 (
iÂ
, 
IFF_UP
);

1077 i‡(
	gªt
 < 0)

1079 
vty_out
 (
vty
, "C™'àshutdow¿öãrÁ˚%s", 
VTY_NEWLINE
);

1080  
	gCMD_WARNING
;

1082 
if_ª‰esh
 (
iÂ
);

1083 
	gif_d©a
 = 
iÂ
->
öfo
;

1084 
	gif_d©a
->
	gshutdown
 = 
IF_ZEBRA_SHUTDOWN_ON
;

1086  
	gCMD_SUCCESS
;

1089 
DEFUN
 (
no_shutdown_if
,

1090 
no_shutdown_if_cmd
,

1092 
NO_STR


1095 
	gªt
;

1096 
öãrÁ˚
 *
	giÂ
;

1097 
zebø_if
 *
	gif_d©a
;

1099 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1100 
	gªt
 = 
if_£t_Êags
 (
iÂ
, 
IFF_UP
 | 
IFF_RUNNING
);

1101 i‡(
	gªt
 < 0)

1103 
vty_out
 (
vty
, "C™'àu∞öãrÁ˚%s", 
VTY_NEWLINE
);

1104  
	gCMD_WARNING
;

1106 
if_ª‰esh
 (
iÂ
);

1107 
	gif_d©a
 = 
iÂ
->
öfo
;

1108 
	gif_d©a
->
	gshutdown
 = 
IF_ZEBRA_SHUTDOWN_OFF
;

1110  
	gCMD_SUCCESS
;

1113 
DEFUN
 (
b™dwidth_if
,

1114 
b™dwidth_if_cmd
,

1119 
öãrÁ˚
 *
	giÂ
;

1120 
	gb™dwidth
;

1122 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1123 
	gb™dwidth
 = 
°πﬁ
(
¨gv
[0], 
NULL
, 10);

1126 i‡(
	gb™dwidth
 < 1 || bandwidth > 10000000)

1128 
vty_out
 (
vty
, "B™dwidth i†övÆid%s", 
VTY_NEWLINE
);

1129  
	gCMD_WARNING
;

1132 
	giÂ
->
	gb™dwidth
 = 
b™dwidth
;

1135 i‡(
if_is_›î©ive
 (
iÂ
))

1136 
zebø_öãrÁ˚_up_upd©e
 (
iÂ
);

1138  
	gCMD_SUCCESS
;

1141 
DEFUN
 (
no_b™dwidth_if
,

1142 
no_b™dwidth_if_cmd
,

1144 
NO_STR


1147 
öãrÁ˚
 *
	giÂ
;

1149 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1151 
	giÂ
->
	gb™dwidth
 = 0;

1154 i‡(
if_is_›î©ive
 (
iÂ
))

1155 
zebø_öãrÁ˚_up_upd©e
 (
iÂ
);

1157  
	gCMD_SUCCESS
;

1160 
ALIAS
 (
no_b™dwidth_if
,

1161 
no_b™dwidth_if_vÆ_cmd
,

1163 
NO_STR


1168 
	$ù_addªss_ö°Æl
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
,

1169 c⁄° *
addr_°r
, c⁄° *
≥î_°r
,

1170 c⁄° *
œbñ
)

1172 
¥efix_ùv4
 
˝
;

1173 
c⁄√˘ed
 *
ifc
;

1174 
¥efix_ùv4
 *
p
;

1175 
ªt
;

1177 
ªt
 = 
	`°r2¥efix_ùv4
 (
addr_°r
, &
˝
);

1178 i‡(
ªt
 <= 0)

1180 
	`vty_out
 (
vty
, "%% MÆf‹medáddªs†%s", 
VTY_NEWLINE
);

1181  
CMD_WARNING
;

1184 
ifc
 = 
	`c⁄√˘ed_check
 (
iÂ
, (
¥efix
 *Ë&
˝
);

1185 i‡(! 
ifc
)

1187 
ifc
 = 
	`c⁄√˘ed_√w
 ();

1188 
ifc
->
iÂ
 = ifp;

1191 
p
 = 
	`¥efix_ùv4_√w
 ();

1192 *
p
 = 
˝
;

1193 
ifc
->
addªss
 = (
¥efix
 *Ë
p
;

1196 i‡(
p
->
¥efixÀn
 <
IPV4_MAX_PREFIXLEN
-2)

1198 
p
 = 
	`¥efix_ùv4_√w
 ();

1199 *
p
 = 
˝
;

1200 
p
->
¥efix
.
s_addr
 = 
	`ùv4_brﬂdˇ°_addr
’->¥efix.s_addr,p->
¥efixÀn
);

1201 
ifc
->
de°ö©i⁄
 = (
¥efix
 *Ë
p
;

1205 i‡(
œbñ
)

1206 
ifc
->
œbñ
 = 
	`XSTRDUP
 (
MTYPE_CONNECTED_LABEL
,Üabel);

1209 
	`li°node_add
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

1213 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

1214 
	`SET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
);

1217 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
)

1218 && 
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

1221 i‡(! 
	`if_is_up
 (
iÂ
))

1223 
	`if_£t_Êags
 (
iÂ
, 
IFF_UP
 | 
IFF_RUNNING
);

1224 
	`if_ª‰esh
 (
iÂ
);

1227 
ªt
 = 
	`if_£t_¥efix
 (
iÂ
, 
ifc
);

1228 i‡(
ªt
 < 0)

1230 
	`vty_out
 (
vty
, "%% Can't set interface IPáddress: %s.%s",

1231 
	`ß„_°ªº‹
(
î∫o
), 
VTY_NEWLINE
);

1232  
CMD_WARNING
;

1236 
	`if_sub√t_add
 (
iÂ
, 
ifc
);

1239 
	`SET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

1242 
	`zebø_öãrÁ˚_addªss_add_upd©e
 (
iÂ
, 
ifc
);

1245 i‡(
	`if_is_›î©ive
(
iÂ
))

1246 
	`c⁄√˘ed_up_ùv4
 (
iÂ
, 
ifc
);

1249  
CMD_SUCCESS
;

1250 
	}
}

1253 
	$ù_addªss_unö°Æl
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
,

1254 c⁄° *
addr_°r
, c⁄° *
≥î_°r
,

1255 c⁄° *
œbñ
)

1257 
¥efix_ùv4
 
˝
;

1258 
c⁄√˘ed
 *
ifc
;

1259 
ªt
;

1262 
ªt
 = 
	`°r2¥efix_ùv4
 (
addr_°r
, &
˝
);

1263 i‡(
ªt
 <= 0)

1265 
	`vty_out
 (
vty
, "%% MÆf‹medáddªs†%s", 
VTY_NEWLINE
);

1266  
CMD_WARNING
;

1270 
ifc
 = 
	`c⁄√˘ed_check
 (
iÂ
, (
¥efix
 *Ë&
˝
);

1271 i‡(! 
ifc
)

1273 
	`vty_out
 (
vty
, "%% C™'àfödáddªss%s", 
VTY_NEWLINE
);

1274  
CMD_WARNING
;

1278 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

1279  
CMD_WARNING
;

1281 
	`UNSET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
);

1284 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
)

1285 || ! 
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

1287 
	`li°node_dñëe
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

1288 
	`c⁄√˘ed_‰ì
 (
ifc
);

1289  
CMD_WARNING
;

1293 
ªt
 = 
	`if_un£t_¥efix
 (
iÂ
, 
ifc
);

1294 i‡(
ªt
 < 0)

1296 
	`vty_out
 (
vty
, "%% Can't unset interface IPáddress: %s.%s",

1297 
	`ß„_°ªº‹
(
î∫o
), 
VTY_NEWLINE
);

1298  
CMD_WARNING
;

1309 #ifde‡
HAVE_NETLINK


1312 
	`c⁄√˘ed_down_ùv4
 (
iÂ
, 
ifc
);

1315 
	`zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
iÂ
, 
ifc
);

1318 
	`UNSET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

1321 
	`if_sub√t_dñëe
 (
iÂ
, 
ifc
);

1324 
	`li°node_dñëe
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

1325 
	`c⁄√˘ed_‰ì
 (
ifc
);

1328  
CMD_SUCCESS
;

1329 
	}
}

1331 
DEFUN
 (
ù_addªss
,

1332 
ù_addªss_cmd
,

1338  
ù_addªss_ö°Æl
 (
vty
, vty->
ödex
, 
¨gv
[0], 
NULL
, NULL);

1341 
DEFUN
 (
no_ù_addªss
,

1342 
no_ù_addªss_cmd
,

1344 
NO_STR


1349  
ù_addªss_unö°Æl
 (
vty
, vty->
ödex
, 
¨gv
[0], 
NULL
, NULL);

1352 #ifde‡
HAVE_NETLINK


1353 
DEFUN
 (
ù_addªss_œbñ
,

1354 
ù_addªss_œbñ_cmd
,

1362  
ù_addªss_ö°Æl
 (
vty
, vty->
ödex
, 
¨gv
[0], 
NULL
,árgv[1]);

1365 
DEFUN
 (
no_ù_addªss_œbñ
,

1366 
no_ù_addªss_œbñ_cmd
,

1368 
NO_STR


1375  
ù_addªss_unö°Æl
 (
vty
, vty->
ödex
, 
¨gv
[0], 
NULL
,árgv[1]);

1379 #ifde‡
HAVE_IPV6


1381 
	$ùv6_addªss_ö°Æl
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
,

1382 c⁄° *
addr_°r
, c⁄° *
≥î_°r
,

1383 c⁄° *
œbñ
, 
£c⁄d¨y
)

1385 
¥efix_ùv6
 
˝
;

1386 
c⁄√˘ed
 *
ifc
;

1387 
¥efix_ùv6
 *
p
;

1388 
ªt
;

1390 
ªt
 = 
	`°r2¥efix_ùv6
 (
addr_°r
, &
˝
);

1391 i‡(
ªt
 <= 0)

1393 
	`vty_out
 (
vty
, "%% MÆf‹medáddªs†%s", 
VTY_NEWLINE
);

1394  
CMD_WARNING
;

1397 
ifc
 = 
	`c⁄√˘ed_check
 (
iÂ
, (
¥efix
 *Ë&
˝
);

1398 i‡(! 
ifc
)

1400 
ifc
 = 
	`c⁄√˘ed_√w
 ();

1401 
ifc
->
iÂ
 = ifp;

1404 
p
 = 
	`¥efix_ùv6_√w
 ();

1405 *
p
 = 
˝
;

1406 
ifc
->
addªss
 = (
¥efix
 *Ë
p
;

1409 i‡(
£c⁄d¨y
)

1410 
	`SET_FLAG
 (
ifc
->
Êags
, 
ZEBRA_IFA_SECONDARY
);

1413 i‡(
œbñ
)

1414 
ifc
->
œbñ
 = 
	`XSTRDUP
 (
MTYPE_CONNECTED_LABEL
,Üabel);

1417 
	`li°node_add
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

1421 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

1422 
	`SET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
);

1425 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
)

1426 && 
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

1429 i‡(! 
	`if_is_up
 (
iÂ
))

1431 
	`if_£t_Êags
 (
iÂ
, 
IFF_UP
 | 
IFF_RUNNING
);

1432 
	`if_ª‰esh
 (
iÂ
);

1435 
ªt
 = 
	`if_¥efix_add_ùv6
 (
iÂ
, 
ifc
);

1437 i‡(
ªt
 < 0)

1439 
	`vty_out
 (
vty
, "%% Can't set interface IPáddress: %s.%s",

1440 
	`ß„_°ªº‹
(
î∫o
), 
VTY_NEWLINE
);

1441  
CMD_WARNING
;

1445 
	`SET_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
);

1448 
	`zebø_öãrÁ˚_addªss_add_upd©e
 (
iÂ
, 
ifc
);

1451 i‡(
	`if_is_›î©ive
(
iÂ
))

1452 
	`c⁄√˘ed_up_ùv6
 (
iÂ
, 
ifc
);

1455  
CMD_SUCCESS
;

1456 
	}
}

1459 
	$ùv6_addªss_unö°Æl
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
,

1460 c⁄° *
addr_°r
, c⁄° *
≥î_°r
,

1461 c⁄° *
œbñ
, 
£c⁄dry
)

1463 
¥efix_ùv6
 
˝
;

1464 
c⁄√˘ed
 *
ifc
;

1465 
ªt
;

1468 
ªt
 = 
	`°r2¥efix_ùv6
 (
addr_°r
, &
˝
);

1469 i‡(
ªt
 <= 0)

1471 
	`vty_out
 (
vty
, "%% MÆf‹medáddªs†%s", 
VTY_NEWLINE
);

1472  
CMD_WARNING
;

1476 
ifc
 = 
	`c⁄√˘ed_check
 (
iÂ
, (
¥efix
 *Ë&
˝
);

1477 i‡(! 
ifc
)

1479 
	`vty_out
 (
vty
, "%% C™'àfödáddªss%s", 
VTY_NEWLINE
);

1480  
CMD_WARNING
;

1484 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

1485  
CMD_WARNING
;

1488 i‡(! 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
)

1489 || ! 
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

1491 
	`li°node_dñëe
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

1492 
	`c⁄√˘ed_‰ì
 (
ifc
);

1493  
CMD_WARNING
;

1497 
ªt
 = 
	`if_¥efix_dñëe_ùv6
 (
iÂ
, 
ifc
);

1498 i‡(
ªt
 < 0)

1500 
	`vty_out
 (
vty
, "%% Can't unset interface IPáddress: %s.%s",

1501 
	`ß„_°ªº‹
(
î∫o
), 
VTY_NEWLINE
);

1502  
CMD_WARNING
;

1506 
	`zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
iÂ
, 
ifc
);

1509 
	`c⁄√˘ed_down_ùv6
 (
iÂ
, 
ifc
);

1512 
	`li°node_dñëe
 (
iÂ
->
c⁄√˘ed
, 
ifc
);

1513 
	`c⁄√˘ed_‰ì
 (
ifc
);

1515  
CMD_SUCCESS
;

1516 
	}
}

1518 
DEFUN
 (
ùv6_addªss
,

1519 
ùv6_addªss_cmd
,

1525  
ùv6_addªss_ö°Æl
 (
vty
, vty->
ödex
, 
¨gv
[0], 
NULL
, NULL, 0);

1528 
DEFUN
 (
no_ùv6_addªss
,

1529 
no_ùv6_addªss_cmd
,

1531 
NO_STR


1536  
ùv6_addªss_unö°Æl
 (
vty
, vty->
ödex
, 
¨gv
[0], 
NULL
, NULL, 0);

1541 
	$if_c⁄fig_wrôe
 (
vty
 *vty)

1543 
li°node
 *
node
;

1544 
öãrÁ˚
 *
iÂ
;

1546 
	`ALL_LIST_ELEMENTS_RO
 (
iÊi°
, 
node
, 
iÂ
))

1548 
zebø_if
 *
if_d©a
;

1549 
li°node
 *
add∫ode
;

1550 
c⁄√˘ed
 *
ifc
;

1551 
¥efix
 *
p
;

1553 
if_d©a
 = 
iÂ
->
öfo
;

1555 
	`vty_out
 (
vty
, "öãrÁ˚ %s%s", 
iÂ
->
«me
,

1556 
VTY_NEWLINE
);

1558 i‡(
iÂ
->
desc
)

1559 
	`vty_out
 (
vty
, " des¸ùti⁄ %s%s", 
iÂ
->
desc
,

1560 
VTY_NEWLINE
);

1564 i‡(
iÂ
->
b™dwidth
 != 0)

1565 
	`vty_out
(
vty
, " b™dwidth %u%s", 
iÂ
->
b™dwidth
, 
VTY_NEWLINE
);

1567 i‡(
	`CHECK_FLAG
(
iÂ
->
°©us
, 
ZEBRA_INTERFACE_LINKDETECTION
))

1568 
	`vty_out
(
vty
, "Üök-dëe˘%s", 
VTY_NEWLINE
);

1570 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
add∫ode
, 
ifc
))

1572 i‡(
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_CONFIGURED
))

1574 
buf
[
INET6_ADDRSTRLEN
];

1575 
p
 = 
ifc
->
addªss
;

1576 
	`vty_out
 (
vty
, " ip%sáddress %s/%d",

1577 
p
->
Ámûy
 =
AF_INET
 ? "" : "v6",

1578 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, (buf)),

1579 
p
->
¥efixÀn
);

1581 i‡(
ifc
->
œbñ
)

1582 
	`vty_out
 (
vty
, "Üabñ %s", 
ifc
->
œbñ
);

1584 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1588 i‡(
if_d©a
)

1590 i‡(
if_d©a
->
shutdown
 =
IF_ZEBRA_SHUTDOWN_ON
)

1591 
	`vty_out
 (
vty
, " shutdown%s", 
VTY_NEWLINE
);

1593 i‡(
if_d©a
->
mu…iˇ°
 !
IF_ZEBRA_MULTICAST_UNSPEC
)

1594 
	`vty_out
 (
vty
, " %smulticast%s",

1595 
if_d©a
->
mu…iˇ°
 =
IF_ZEBRA_MULTICAST_ON
 ? "" : "no ",

1596 
VTY_NEWLINE
);

1599 #ifde‡
RTADV


1600 
	`πadv_c⁄fig_wrôe
 (
vty
, 
iÂ
);

1603 #ifde‡
HAVE_IRDP


1604 
	`údp_c⁄fig_wrôe
 (
vty
, 
iÂ
);

1607 
	`vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

1610 
	}
}

1614 
	$zebø_if_öô
 ()

1617 
	`if_öô
 ();

1618 
	`if_add_hook
 (
IF_NEW_HOOK
, 
if_zebø_√w_hook
);

1619 
	`if_add_hook
 (
IF_DELETE_HOOK
, 
if_zebø_dñëe_hook
);

1622 
	`ö°Æl_node
 (&
öãrÁ˚_node
, 
if_c⁄fig_wrôe
);

1624 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_öãrÁ˚_cmd
);

1625 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_öãrÁ˚_cmd
);

1626 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_öãrÁ˚_desc_cmd
);

1627 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
zebø_öãrÁ˚_cmd
);

1628 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_öãrÁ˚_cmd
);

1629 
	`ö°Æl_deÁu…
 (
INTERFACE_NODE
);

1630 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
öãrÁ˚_desc_cmd
);

1631 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_öãrÁ˚_desc_cmd
);

1632 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
mu…iˇ°_cmd
);

1633 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_mu…iˇ°_cmd
);

1634 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
lökdëe˘_cmd
);

1635 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_lökdëe˘_cmd
);

1636 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
shutdown_if_cmd
);

1637 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_shutdown_if_cmd
);

1638 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
b™dwidth_if_cmd
);

1639 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_b™dwidth_if_cmd
);

1640 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_b™dwidth_if_vÆ_cmd
);

1641 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_addªss_cmd
);

1642 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ù_addªss_cmd
);

1643 #ifde‡
HAVE_IPV6


1644 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_addªss_cmd
);

1645 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_addªss_cmd
);

1647 #ifde‡
HAVE_NETLINK


1648 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_addªss_œbñ_cmd
);

1649 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ù_addªss_œbñ_cmd
);

1651 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/interface.h

22 #i‚de‡
_ZEBRA_INTERFACE_H


23 
	#_ZEBRA_INTERFACE_H


	)

25 
	~"ªdi°ribuã.h
"

27 #ifde‡
HAVE_IRDP


28 
	~"zebø/údp.h
"

32 
	#IF_ZEBRA_MULTICAST_UNSPEC
 0

	)

33 
	#IF_ZEBRA_MULTICAST_ON
 1

	)

34 
	#IF_ZEBRA_MULTICAST_OFF
 2

	)

37 
	#IF_ZEBRA_SHUTDOWN_UNSPEC
 0

	)

38 
	#IF_ZEBRA_SHUTDOWN_ON
 1

	)

39 
	#IF_ZEBRA_SHUTDOWN_OFF
 2

	)

42 #i‡(
deföed
(
LINUX_IPV6
Ë&& (deföed(
__GLIBC__
Ë&& __GLIBC__ >2 && 
__GLIBC_MINOR__
 >1)Ë|| deföed(
KAME
)

43 #ifde‡
HAVE_RTADV


44 
	#RTADV


	)

48 #ifde‡
RTADV


50 
	sπadvc⁄f


55 
	mAdvSídAdvîti£míts
;

63 
	mMaxRåAdvI¡îvÆ
;

64 
	#RTADV_MAX_RTR_ADV_INTERVAL
 600000

	)

72 
	mMöRåAdvI¡îvÆ
;

73 
	#RTADV_MIN_RTR_ADV_INTERVAL
 (0.33 * 
RTADV_MAX_RTR_ADV_INTERVAL
)

	)

76 
	mAdvI¡îvÆTimî
;

83 
	mAdvM™agedFœg
;

91 
	mAdvOthîC⁄figFœg
;

97 
	mAdvLökMTU
;

106 
u_öt32_t
 
	mAdvRóchabÀTime
;

107 
	#RTADV_MAX_REACHABLE_TIME
 3600000

	)

115 
	mAdvRëønsTimî
;

124 
	mAdvCurH›Limô
;

133 
	mAdvDeÁu…Li„time
;

134 
	#RTADV_MAX_RTRLIFETIME
 9000

	)

143 
li°
 *
	mAdvPªfixLi°
;

149 
	mAdvHomeAgítFœg
;

150 #i‚de‡
ND_RA_FLAG_HOME_AGENT


151 
	#ND_RA_FLAG_HOME_AGENT
 0x20

	)

157 
	mHomeAgítPª„ªn˚
;

165 
	mHomeAgítLi„time
;

166 
	#RTADV_MAX_HALIFETIME
 65520

	)

172 
	mAdvI¡îvÆO±i⁄
;

178 
	mDeÁu…Pª„ªn˚
;

179 
	#RTADV_PREF_MEDIUM
 0x0

	)

185 
	szebø_if


188 
u_ch¨
 
	mshutdown
;

191 
u_ch¨
 
	mmu…iˇ°
;

194 
u_ch¨
 
	mπadv_íabÀ
;

197 
rouã_èbÀ
 *
	mùv4_sub√ts
;

199 #ifde‡
RTADV


200 
πadvc⁄f
 
	mπadv
;

203 #ifde‡
HAVE_IRDP


204 
údp_öãrÁ˚
 
	múdp
;

207 #ifde‡
SUNOS_5


213 
u_ch¨
 
	m¥im¨y_°©e
;

217 
if_dñëe_upd©e
 (
öãrÁ˚
 *
iÂ
);

218 
if_add_upd©e
 (
öãrÁ˚
 *
iÂ
);

219 
if_up
 (
öãrÁ˚
 *);

220 
if_down
 (
öãrÁ˚
 *);

221 
if_ª‰esh
 (
öãrÁ˚
 *);

222 
if_Êags_upd©e
 (
öãrÁ˚
 *, 
uöt64_t
);

223 
if_sub√t_add
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

224 
if_sub√t_dñëe
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

226 #ifde‡
HAVE_PROC_NET_DEV


227 
if°©_upd©e_¥oc
 ();

229 #ifde‡
HAVE_NET_RT_IFLIST


230 
if°©_upd©e_sys˘l
 ();

233 #ifde‡
HAVE_PROC_NET_DEV


234 
öãrÁ˚_li°_¥oc
 ();

236 #ifde‡
HAVE_PROC_NET_IF_INET6


237 
iÁddr_¥oc_ùv6
 ();

240 #ifde‡
BSDI


241 
if_kvm_gë_mtu
 (
öãrÁ˚
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl.c

23 
	~<zebø.h
>

25 
	~"lökli°.h
"

26 
	~"if.h
"

27 
	~"¥efix.h
"

28 
	~"io˘l.h
"

29 
	~"log.h
"

30 
	~"¥ivs.h
"

32 
	~"zebø/rib.h
"

33 
	~"zebø/π.h
"

34 
	~"zebø/öãrÁ˚.h
"

36 #ifde‡
HAVE_BSD_LINK_DETECT


37 
	~<√t/if_medü.h
>

40 
zebø_¥ivs_t
 
z£rv_¥ivs
;

44 
	$i‰eq_£t_«me
 (
i‰eq
 *i‰eq, 
öãrÁ˚
 *
iÂ
)

46 
	`°∫˝y
 (
i‰eq
->
i‰_«me
, 
iÂ
->
«me
, 
IFNAMSIZ
);

47 
	}
}

51 
	$if_io˘l
 (
u_l⁄g
 
ªque°
, 
ˇddr_t
 
buf„r
)

53 
sock
;

54 
ªt
;

55 
îr
;

57 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

58 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

59 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_DGRAM
, 0);

60 i‡(
sock
 < 0)

62 
ßve_î∫o
 = 
î∫o
;

63 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

64 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

65 
	`zlog_îr
("C™nŸ cª©êUDP sockë: %s", 
	`ß„_°ªº‹
(
ßve_î∫o
));

66 
	`exô
 (1);

68 i‡((
ªt
 = 
	`io˘l
 (
sock
, 
ªque°
, 
buf„r
)) < 0)

69 
îr
 = 
î∫o
;

70 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

71 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

72 
	`˛o£
 (
sock
);

74 i‡(
ªt
 < 0)

76 
î∫o
 = 
îr
;

77  
ªt
;

80 
	}
}

82 #ifde‡
HAVE_IPV6


84 
	$if_io˘l_ùv6
 (
u_l⁄g
 
ªque°
, 
ˇddr_t
 
buf„r
)

86 
sock
;

87 
ªt
;

88 
îr
;

90 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

91 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

92 
sock
 = 
	`sockë
 (
AF_INET6
, 
SOCK_DGRAM
, 0);

93 i‡(
sock
 < 0)

95 
ßve_î∫o
 = 
î∫o
;

96 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

97 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

98 
	`zlog_îr
("Cannot create IPv6 datagram socket: %s",

99 
	`ß„_°ªº‹
(
ßve_î∫o
));

100 
	`exô
 (1);

103 i‡((
ªt
 = 
	`io˘l
 (
sock
, 
ªque°
, 
buf„r
)) < 0)

104 
îr
 = 
î∫o
;

105 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

106 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

107 
	`˛o£
 (
sock
);

109 i‡(
ªt
 < 0)

111 
î∫o
 = 
îr
;

112  
ªt
;

115 
	}
}

123 
	$if_gë_mëric
 (
öãrÁ˚
 *
iÂ
)

125 #ifde‡
SIOCGIFMETRIC


126 
i‰eq
 ifreq;

128 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

130 i‡(
	`if_io˘l
 (
SIOCGIFMETRIC
, (
ˇddr_t
Ë&
i‰eq
) < 0)

132 
iÂ
->
mëric
 = 
i‰eq
.
i‰_mëric
;

133 i‡(
iÂ
->
mëric
 == 0)

134 
iÂ
->
mëric
 = 1;

136 
iÂ
->
mëric
 = -1;

138 
	}
}

142 
	$if_gë_mtu
 (
öãrÁ˚
 *
iÂ
)

144 
i‰eq
 ifreq;

146 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

148 #i‡
	`deföed
(
SIOCGIFMTU
)

149 i‡(
	`if_io˘l
 (
SIOCGIFMTU
, (
ˇddr_t
Ë& 
i‰eq
) < 0)

151 
	`zlog_öfo
 ("Can'tÜookup mtu by ioctl(SIOCGIFMTU)");

152 
iÂ
->
mtu6
 = iÂ->
mtu
 = -1;

156 #ifde‡
SUNOS_5


157 
iÂ
->
mtu6
 = iÂ->
mtu
 = 
i‰eq
.
i‰_mëric
;

159 
iÂ
->
mtu6
 = iÂ->
mtu
 = 
i‰eq
.
i‰_mtu
;

163 
	`zebø_öãrÁ˚_up_upd©e
(
iÂ
);

166 
	`zlog
 (
NULL
, 
LOG_INFO
, "Can'tÜookup mtu onÅhis system");

167 
iÂ
->
mtu6
 = iÂ->
mtu
 = -1;

169 
	}
}

171 #ifde‡
HAVE_NETLINK


174 
	$if_£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

176  
	`kî√l_addªss_add_ùv4
 (
iÂ
, 
ifc
);

177 
	}
}

181 
	$if_un£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

183  
	`kî√l_addªss_dñëe_ùv4
 (
iÂ
, 
ifc
);

184 
	}
}

186 #ifde‡
HAVE_STRUCT_IFALIASREQ


190 
	$if_£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

192 
ªt
;

193 
iÁlü§eq
 
addªq
;

194 
sockaddr_ö
 
addr
;

195 
sockaddr_ö
 
mask
;

196 
¥efix_ùv4
 *
p
;

198 
p
 = (
¥efix_ùv4
 *Ë
ifc
->
addªss
;

199 
	`rib_lookup_™d_pushup
 (
p
);

201 
	`mem£t
 (&
addªq
, 0, áddreq);

202 
	`°∫˝y
 ((*)&
addªq
.
i‰a_«me
, 
iÂ
->
«me
, áddreq.ifra_name);

204 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö
));

205 
addr
.
sö_addr
 = 
p
->
¥efix
;

206 
addr
.
sö_Ámûy
 = 
p
->
Ámûy
;

207 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


208 
addr
.
sö_Àn
 =  (
sockaddr_ö
);

210 
	`mem˝y
 (&
addªq
.
i‰a_addr
, &
addr
,  (
sockaddr_ö
));

212 
	`mem£t
 (&
mask
, 0,  (
sockaddr_ö
));

213 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
mask
.
sö_addr
);

214 
mask
.
sö_Ámûy
 = 
p
->
Ámûy
;

215 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


216 
mask
.
sö_Àn
 =  (
sockaddr_ö
);

218 
	`mem˝y
 (&
addªq
.
i‰a_mask
, &
mask
,  (
sockaddr_ö
));

220 
ªt
 = 
	`if_io˘l
 (
SIOCAIFADDR
, (
ˇddr_t
Ë&
addªq
);

221 i‡(
ªt
 < 0)

222  
ªt
;

224 
	}
}

229 
	$if_un£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

231 
ªt
;

232 
iÁlü§eq
 
addªq
;

233 
sockaddr_ö
 
addr
;

234 
sockaddr_ö
 
mask
;

235 
¥efix_ùv4
 *
p
;

237 
p
 = (
¥efix_ùv4
 *)
ifc
->
addªss
;

239 
	`mem£t
 (&
addªq
, 0, áddreq);

240 
	`°∫˝y
 ((*)&
addªq
.
i‰a_«me
, 
iÂ
->
«me
, áddreq.ifra_name);

242 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö
));

243 
addr
.
sö_addr
 = 
p
->
¥efix
;

244 
addr
.
sö_Ámûy
 = 
p
->
Ámûy
;

245 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


246 
addr
.
sö_Àn
 =  (
sockaddr_ö
);

248 
	`mem˝y
 (&
addªq
.
i‰a_addr
, &
addr
,  (
sockaddr_ö
));

250 
	`mem£t
 (&
mask
, 0,  (
sockaddr_ö
));

251 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
mask
.
sö_addr
);

252 
mask
.
sö_Ámûy
 = 
p
->
Ámûy
;

253 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


254 
mask
.
sö_Àn
 =  (
sockaddr_ö
);

256 
	`mem˝y
 (&
addªq
.
i‰a_mask
, &
mask
,  (
sockaddr_ö
));

258 
ªt
 = 
	`if_io˘l
 (
SIOCDIFADDR
, (
ˇddr_t
Ë&
addªq
);

259 i‡(
ªt
 < 0)

260  
ªt
;

262 
	}
}

267 
	$if_£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

269 
ªt
;

270 
i‰eq
 ifreq;

271 
sockaddr_ö
 
addr
;

272 
sockaddr_ö
 
brﬂd
;

273 
sockaddr_ö
 
mask
;

274 
¥efix_ùv4
 
iÁddr
;

275 
¥efix_ùv4
 *
p
;

277 
p
 = (
¥efix_ùv4
 *Ë
ifc
->
addªss
;

279 
iÁddr
 = *
p
;

281 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

283 
addr
.
sö_addr
 = 
p
->
¥efix
;

284 
addr
.
sö_Ámûy
 = 
p
->
Ámûy
;

285 
	`mem˝y
 (&
i‰eq
.
i‰_addr
, &
addr
,  (
sockaddr_ö
));

286 
ªt
 = 
	`if_io˘l
 (
SIOCSIFADDR
, (
ˇddr_t
Ë&
i‰eq
);

287 i‡(
ªt
 < 0)

288  
ªt
;

291 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
mask
.
sö_addr
);

293 i‡(
	`if_is_brﬂdˇ°
 (
iÂ
))

295 
	`≠∂y_mask_ùv4
 (&
iÁddr
);

296 
addr
.
sö_addr
 = 
iÁddr
.
¥efix
;

298 
brﬂd
.
sö_addr
.
s_addr
 = (
addr
.sö_addr.s_add∏| ~
mask
.sin_addr.s_addr);

299 
brﬂd
.
sö_Ámûy
 = 
p
->
Ámûy
;

301 
	`mem˝y
 (&
i‰eq
.
i‰_brﬂdaddr
, &
brﬂd
,  (
sockaddr_ö
));

302 
ªt
 = 
	`if_io˘l
 (
SIOCSIFBRDADDR
, (
ˇddr_t
Ë&
i‰eq
);

303 i‡(
ªt
 < 0)

304  
ªt
;

307 
mask
.
sö_Ámûy
 = 
p
->
Ámûy
;

308 #ifde‡
SUNOS_5


309 
	`mem˝y
 (&
mask
, &
i‰eq
.
i‰_addr
,  (mask));

311 
	`mem˝y
 (&
i‰eq
.
i‰_√tmask
, &
mask
,  (
sockaddr_ö
));

313 
ªt
 = 
	`if_io˘l
 (
SIOCSIFNETMASK
, (
ˇddr_t
Ë&
i‰eq
);

314 i‡(
ªt
 < 0)

315  
ªt
;

318 
	}
}

323 
	$if_un£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

325 
ªt
;

326 
i‰eq
 ifreq;

327 
sockaddr_ö
 
addr
;

328 
¥efix_ùv4
 *
p
;

330 
p
 = (
¥efix_ùv4
 *Ë
ifc
->
addªss
;

332 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

334 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö
));

335 
addr
.
sö_Ámûy
 = 
p
->
Ámûy
;

336 
	`mem˝y
 (&
i‰eq
.
i‰_addr
, &
addr
,  (
sockaddr_ö
));

337 
ªt
 = 
	`if_io˘l
 (
SIOCSIFADDR
, (
ˇddr_t
Ë&
i‰eq
);

338 i‡(
ªt
 < 0)

339  
ªt
;

342 
	}
}

348 
	$if_gë_Êags
 (
öãrÁ˚
 *
iÂ
)

350 
ªt
;

351 
i‰eq
 ifreq;

352 #ifde‡
HAVE_BSD_LINK_DETECT


353 
ifmedüªq
 
ifmr
;

356 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

358 
ªt
 = 
	`if_io˘l
 (
SIOCGIFFLAGS
, (
ˇddr_t
Ë&
i‰eq
);

359 i‡(
ªt
 < 0)

361 
	`zlog_îr
("if_io˘l(SIOCGIFFLAGSËÁûed: %s", 
	`ß„_°ªº‹
(
î∫o
));

364 #ifde‡
HAVE_BSD_LINK_DETECT


370 
	`SET_FLAG
(
i‰eq
.
i‰_Êags
, 
IFF_RUNNING
);

372 i‡(
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_LINKDETECTION
))

374 (Ë
	`mem£t
(&
ifmr
, 0, (ifmr));

375 
	`°∫˝y
 (
ifmr
.
ifm_«me
, 
iÂ
->
«me
, 
IFNAMSIZ
);

378 i‡(
	`if_io˘l
(
SIOCGIFMEDIA
, (
ˇddr_t
Ë&
ifmr
) < 0)

379 
	`zlog_îr
("if_io˘l(SIOCGIFMEDIAËÁûed: %s", 
	`ß„_°ªº‹
(
î∫o
));

380 i‡(
ifmr
.
ifm_°©us
 & 
IFM_AVALID
)

382 i‡(
ifmr
.
ifm_°©us
 & 
IFM_ACTIVE
)

383 
	`SET_FLAG
(
i‰eq
.
i‰_Êags
, 
IFF_RUNNING
);

385 
	`UNSET_FLAG
(
i‰eq
.
i‰_Êags
, 
IFF_RUNNING
);

390 
	`if_Êags_upd©e
 (
iÂ
, (
i‰eq
.
i‰_Êags
 & 0x0000ffff));

391 
	}
}

395 
	$if_£t_Êags
 (
öãrÁ˚
 *
iÂ
, 
uöt64_t
 
Êags
)

397 
ªt
;

398 
i‰eq
 ifreq;

400 
	`mem£t
 (&
i‰eq
, 0, (ifreq));

401 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

403 
i‰eq
.
i‰_Êags
 = 
iÂ
->
Êags
;

404 
i‰eq
.
i‰_Êags
 |
Êags
;

406 
ªt
 = 
	`if_io˘l
 (
SIOCSIFFLAGS
, (
ˇddr_t
Ë&
i‰eq
);

408 i‡(
ªt
 < 0)

410 
	`zlog_öfo
 ("can't set interface flags");

411  
ªt
;

414 
	}
}

418 
	$if_un£t_Êags
 (
öãrÁ˚
 *
iÂ
, 
uöt64_t
 
Êags
)

420 
ªt
;

421 
i‰eq
 ifreq;

423 
	`mem£t
 (&
i‰eq
, 0, (ifreq));

424 
	`i‰eq_£t_«me
 (&
i‰eq
, 
iÂ
);

426 
i‰eq
.
i‰_Êags
 = 
iÂ
->
Êags
;

427 
i‰eq
.
i‰_Êags
 &~
Êags
;

429 
ªt
 = 
	`if_io˘l
 (
SIOCSIFFLAGS
, (
ˇddr_t
Ë&
i‰eq
);

431 i‡(
ªt
 < 0)

433 
	`zlog_öfo
 ("can't unset interface flags");

434  
ªt
;

437 
	}
}

439 #ifde‡
HAVE_IPV6


441 #ifde‡
LINUX_IPV6


442 #i‚de‡
_LINUX_IN6_H


444 
	sö6_i‰eq


446 
ö6_addr
 
	mi‰6_addr
;

447 
u_öt32_t
 
	mi‰6_¥efixÀn
;

448 
	mi‰6_ifödex
;

454 
	$if_¥efix_add_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

456 
ªt
;

457 
¥efix_ùv6
 *
p
;

458 
ö6_i‰eq
 
i‰eq
;

460 
p
 = (
¥efix_ùv6
 *Ë
ifc
->
addªss
;

462 
	`mem£t
 (&
i‰eq
, 0,  (
ö6_i‰eq
));

464 
	`mem˝y
 (&
i‰eq
.
i‰6_addr
, &
p
->
¥efix
,  (
ö6_addr
));

465 
i‰eq
.
i‰6_ifödex
 = 
iÂ
->
ifödex
;

466 
i‰eq
.
i‰6_¥efixÀn
 = 
p
->
¥efixÀn
;

468 
ªt
 = 
	`if_io˘l_ùv6
 (
SIOCSIFADDR
, (
ˇddr_t
Ë&
i‰eq
);

470  
ªt
;

471 
	}
}

474 
	$if_¥efix_dñëe_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

476 
ªt
;

477 
¥efix_ùv6
 *
p
;

478 
ö6_i‰eq
 
i‰eq
;

480 
p
 = (
¥efix_ùv6
 *Ë
ifc
->
addªss
;

482 
	`mem£t
 (&
i‰eq
, 0,  (
ö6_i‰eq
));

484 
	`mem˝y
 (&
i‰eq
.
i‰6_addr
, &
p
->
¥efix
,  (
ö6_addr
));

485 
i‰eq
.
i‰6_ifödex
 = 
iÂ
->
ifödex
;

486 
i‰eq
.
i‰6_¥efixÀn
 = 
p
->
¥efixÀn
;

488 
ªt
 = 
	`if_io˘l_ùv6
 (
SIOCDIFADDR
, (
ˇddr_t
Ë&
i‰eq
);

490  
ªt
;

491 
	}
}

493 #ifde‡
HAVE_STRUCT_IN6_ALIASREQ


494 #i‚de‡
ND6_INFINITE_LIFETIME


495 
	#ND6_INFINITE_LIFETIME
 0xffffffffL

	)

498 
	$if_¥efix_add_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

500 
ªt
;

501 
ö6_Æü§eq
 
addªq
;

502 
sockaddr_ö6
 
addr
;

503 
sockaddr_ö6
 
mask
;

504 
¥efix_ùv6
 *
p
;

506 
p
 = (
¥efix_ùv6
 * ) 
ifc
->
addªss
;

508 
	`mem£t
 (&
addªq
, 0, áddreq);

509 
	`°∫˝y
 ((*)&
addªq
.
i‰a_«me
, 
iÂ
->
«me
, áddreq.ifra_name);

511 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö6
));

512 
addr
.
sö6_addr
 = 
p
->
¥efix
;

513 
addr
.
sö6_Ámûy
 = 
p
->
Ámûy
;

514 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


515 
addr
.
sö6_Àn
 =  (
sockaddr_ö6
);

517 
	`mem˝y
 (&
addªq
.
i‰a_addr
, &
addr
,  (
sockaddr_ö6
));

519 
	`mem£t
 (&
mask
, 0,  (
sockaddr_ö6
));

520 
	`maskÀn2ù6
 (
p
->
¥efixÀn
, &
mask
.
sö6_addr
);

521 
mask
.
sö6_Ámûy
 = 
p
->
Ámûy
;

522 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


523 
mask
.
sö6_Àn
 =  (
sockaddr_ö6
);

525 
	`mem˝y
 (&
addªq
.
i‰a_¥efixmask
, &
mask
,  (
sockaddr_ö6
));

527 
addªq
.
i‰a_li„time
.
ü6t_v…ime
 = 0xffffffff;

528 
addªq
.
i‰a_li„time
.
ü6t_∂time
 = 0xffffffff;

530 #ifde‡
HAVE_STRUCT_IF6_ALIASREQ_IFRA_LIFETIME


531 
addªq
.
i‰a_li„time
.
ü6t_∂time
 = 
ND6_INFINITE_LIFETIME
;

532 
addªq
.
i‰a_li„time
.
ü6t_v…ime
 = 
ND6_INFINITE_LIFETIME
;

535 
ªt
 = 
	`if_io˘l_ùv6
 (
SIOCAIFADDR_IN6
, (
ˇddr_t
Ë&
addªq
);

536 i‡(
ªt
 < 0)

537  
ªt
;

539 
	}
}

542 
	$if_¥efix_dñëe_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

544 
ªt
;

545 
ö6_Æü§eq
 
addªq
;

546 
sockaddr_ö6
 
addr
;

547 
sockaddr_ö6
 
mask
;

548 
¥efix_ùv6
 *
p
;

550 
p
 = (
¥efix_ùv6
 *Ë
ifc
->
addªss
;

552 
	`mem£t
 (&
addªq
, 0, áddreq);

553 
	`°∫˝y
 ((*)&
addªq
.
i‰a_«me
, 
iÂ
->
«me
, áddreq.ifra_name);

555 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö6
));

556 
addr
.
sö6_addr
 = 
p
->
¥efix
;

557 
addr
.
sö6_Ámûy
 = 
p
->
Ámûy
;

558 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


559 
addr
.
sö6_Àn
 =  (
sockaddr_ö6
);

561 
	`mem˝y
 (&
addªq
.
i‰a_addr
, &
addr
,  (
sockaddr_ö6
));

563 
	`mem£t
 (&
mask
, 0,  (
sockaddr_ö6
));

564 
	`maskÀn2ù6
 (
p
->
¥efixÀn
, &
mask
.
sö6_addr
);

565 
mask
.
sö6_Ámûy
 = 
p
->
Ámûy
;

566 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


567 
mask
.
sö6_Àn
 =  (
sockaddr_ö6
);

569 
	`mem˝y
 (&
addªq
.
i‰a_¥efixmask
, &
mask
,  (
sockaddr_ö6
));

571 #ifde‡
HAVE_STRUCT_IF6_ALIASREQ_IFRA_LIFETIME


572 
addªq
.
i‰a_li„time
.
ü6t_∂time
 = 
ND6_INFINITE_LIFETIME
;

573 
addªq
.
i‰a_li„time
.
ü6t_v…ime
 = 
ND6_INFINITE_LIFETIME
;

576 
ªt
 = 
	`if_io˘l_ùv6
 (
SIOCDIFADDR_IN6
, (
ˇddr_t
Ë&
addªq
);

577 i‡(
ªt
 < 0)

578  
ªt
;

580 
	}
}

583 
	$if_¥efix_add_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

586 
	}
}

589 
	$if_¥efix_dñëe_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

592 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl.h

23 #i‚de‡
_ZEBRA_IOCTL_H


24 
	#_ZEBRA_IOCTL_H


	)

27 
i‰eq_£t_«me
 (
i‰eq
 *, 
öãrÁ˚
 *);

28 
if_io˘l
 (
u_l⁄g
, 
ˇddr_t
);

30 
if_£t_Êags
 (
öãrÁ˚
 *, 
uöt64_t
);

31 
if_un£t_Êags
 (
öãrÁ˚
 *, 
uöt64_t
);

32 
if_gë_Êags
 (
öãrÁ˚
 *);

34 
if_£t_¥efix
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

35 
if_un£t_¥efix
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

37 
if_gë_mëric
 (
öãrÁ˚
 *);

38 
if_gë_mtu
 (
öãrÁ˚
 *);

40 #ifde‡
HAVE_IPV6


41 
if_¥efix_add_ùv6
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

42 
if_¥efix_dñëe_ùv6
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

45 #ifde‡
SOLARIS_IPV6


46 
if_io˘l_ùv6
(
u_l⁄g
, 
ˇddr_t
);

47 
c⁄√˘ed
 *
if_lookup_lökloˇl
–
öãrÁ˚
 *);

49 
	#AF_IOCTL
(
af
, 
ªque°
, 
buf„r
) \

50 ((
af
Ë=
AF_INET
? 
	`if_io˘l
(
ªque°
, 
buf„r
) : \

51 
	`if_io˘l_ùv6
(
ªque°
, 
buf„r
))

	)

54 
	#AF_IOCTL
(
af
, 
ªque°
, 
buf„r
Ë
	`if_io˘l
‘eque°, buf„r)

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl_null.c

1 
	~<zebø.h
>

3 
	~"zebø/rib.h
"

4 
	~"zebø/π.h
"

5 
	~"zebø/io˘l.h
"

7 
	$i‰eq_£t_«me
 (
i‰eq
 *
a
, 
öãrÁ˚
 *
b
Ë{ ; 
	}
}

9 
	$if_£t_¥efix
 (
öãrÁ˚
 *
a
, 
c⁄√˘ed
 *
b
)

11 
	`kî√l_addªss_add_ùv4
 (
a
, 
b
);

13 
	}
}

15 
	$if_un£t_¥efix
 (
öãrÁ˚
 *
a
, 
c⁄√˘ed
 *
b
)

17 
	`kî√l_addªss_dñëe_ùv4
 (
a
, 
b
);

19 
	}
}

21 
	$if_¥efix_add_ùv6
 (
öãrÁ˚
 *
a
, 
c⁄√˘ed
 *
b
Ë{  0; 
	}
}

22 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


23 #¥agm®
wók
 
if_¥efix_dñëe_ùv6
 = 
if_¥efix_add_ùv6


25 
	$if_¥efix_dñëe_ùv6
 (
öãrÁ˚
 *
a
, 
c⁄√˘ed
 *
b
Ë{  0; 
	}
}

28 
	$if_io˘l
 (
u_l⁄g
 
a
, 
ˇddr_t
 
b
Ë{  0; 
	}
}

30 
	$if_£t_Êags
 (
öãrÁ˚
 *
a
, 
uöt64_t
 
b
Ë{  0; 
	}
}

31 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


32 #¥agm®
wók
 
if_un£t_Êags
 = 
if_£t_Êags


34 
	$if_un£t_Êags
 (
öãrÁ˚
 *
a
, 
uöt64_t
 
b
Ë{  0; 
	}
}

37 
	$if_gë_Êags
 (
öãrÁ˚
 *
a
Ë{ ; 
	}
}

38 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


39 #¥agm®
wók
 
if_gë_mëric
 = 
if_gë_Êags


40 #¥agm®
wók
 
if_gë_mtu
 = 
if_gë_Êags


46 #ifde‡
SOLARIS_IPV6


47 #¥agm®
wók
 
if_io˘l_ùv6
 = 
if_io˘l


48 
c⁄√˘ed
 *
	$if_lookup_lökloˇl
(
öãrÁ˚
 *
a
Ë{  0; 
	}
}

50 
	#AF_IOCTL
(
af
, 
ªque°
, 
buf„r
) \

51 ((
af
Ë=
AF_INET
? 
	`if_io˘l
(
ªque°
, 
buf„r
) : \

52 
	`if_io˘l_ùv6
(
ªque°
, 
buf„r
))

	)

55 
	#AF_IOCTL
(
af
, 
ªque°
, 
buf„r
Ë
	`if_io˘l
‘eque°, buf„r)

	)

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl_solaris.c

23 
	~<zebø.h
>

25 
	~"lökli°.h
"

26 
	~"if.h
"

27 
	~"¥efix.h
"

28 
	~"io˘l.h
"

29 
	~"log.h
"

30 
	~"¥ivs.h
"

32 
	~"zebø/rib.h
"

33 
	~"zebø/π.h
"

34 
	~"zebø/öãrÁ˚.h
"

36 
zebø_¥ivs_t
 
z£rv_¥ivs
;

40 
	$li‰eq_£t_«me
 (
li‰eq
 *li‰eq, c⁄° *
i‚ame
)

42 
	`°∫˝y
 (
li‰eq
->
li‰_«me
, 
i‚ame
, 
IFNAMSIZ
);

43 
	}
}

47 
	$if_io˘l
 (
u_l⁄g
 
ªque°
, 
ˇddr_t
 
buf„r
)

49 
sock
;

50 
ªt
;

51 
îr
;

53 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

54 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

56 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_DGRAM
, 0);

57 i‡(
sock
 < 0)

59 
ßve_î∫o
 = 
î∫o
;

60 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

61 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

62 
	`zlog_îr
("C™nŸ cª©êUDP sockë: %s", 
	`ß„_°ªº‹
(
ßve_î∫o
));

63 
	`exô
 (1);

66 i‡((
ªt
 = 
	`io˘l
 (
sock
, 
ªque°
, 
buf„r
)) < 0)

67 
îr
 = 
î∫o
;

69 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

70 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

72 
	`˛o£
 (
sock
);

74 i‡(
ªt
 < 0)

76 
î∫o
 = 
îr
;

77  
ªt
;

80 
	}
}

84 
	$if_io˘l_ùv6
 (
u_l⁄g
 
ªque°
, 
ˇddr_t
 
buf„r
)

86 #ifde‡
HAVE_IPV6


87 
sock
;

88 
ªt
;

89 
îr
;

91 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

92 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

94 
sock
 = 
	`sockë
 (
AF_INET6
, 
SOCK_DGRAM
, 0);

95 i‡(
sock
 < 0)

97 
ßve_î∫o
 = 
î∫o
;

98 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

99 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

100 
	`zlog_îr
("Cannot create IPv6 datagram socket: %s",

101 
	`ß„_°ªº‹
(
ßve_î∫o
));

102 
	`exô
 (1);

105 i‡((
ªt
 = 
	`io˘l
 (
sock
, 
ªque°
, 
buf„r
)) < 0)

106 
îr
 = 
î∫o
;

108 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

109 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

111 
	`˛o£
 (
sock
);

113 i‡(
ªt
 < 0)

115 
î∫o
 = 
îr
;

116  
ªt
;

121 
	}
}

128 
	$if_gë_mëric
 (
öãrÁ˚
 *
iÂ
)

130 
li‰eq
Üifreq;

131 
ªt
;

133 
	`li‰eq_£t_«me
 (&
li‰eq
, 
iÂ
->
«me
);

135 i‡(
iÂ
->
Êags
 & 
IFF_IPV4
)

136 
ªt
 = 
	`AF_IOCTL
 (
AF_INET
, 
SIOCGLIFMETRIC
, (
ˇddr_t
Ë& 
li‰eq
);

137 #ifde‡
SOLARIS_IPV6


138 i‡(
iÂ
->
Êags
 & 
IFF_IPV6
)

139 
ªt
 = 
	`AF_IOCTL
 (
AF_INET6
, 
SIOCGLIFMETRIC
, (
ˇddr_t
Ë& 
li‰eq
);

142 
ªt
 = -1;

144 i‡(
ªt
 < 0)

147 
iÂ
->
mëric
 = 
li‰eq
.
li‰_mëric
;

149 i‡(
iÂ
->
mëric
 == 0)

150 
iÂ
->
mëric
 = 1;

151 
	}
}

155 
	$if_gë_mtu
 (
öãrÁ˚
 *
iÂ
)

157 
li‰eq
Üifreq;

158 
ªt
;

159 
u_ch¨
 
ch™ged
 = 0;

161 i‡(
iÂ
->
Êags
 & 
IFF_IPV4
)

163 
	`li‰eq_£t_«me
 (&
li‰eq
, 
iÂ
->
«me
);

164 
ªt
 = 
	`AF_IOCTL
 (
AF_INET
, 
SIOCGLIFMTU
, (
ˇddr_t
Ë& 
li‰eq
);

165 i‡(
ªt
 < 0)

167 
	`zlog_öfo
 ("Can'tÜookup mtu on %s by ioctl(SIOCGLIFMTU)",

168 
iÂ
->
«me
);

169 
iÂ
->
mtu
 = -1;

173 
iÂ
->
mtu
 = 
li‰eq
.
li‰_mëric
;

174 
ch™ged
 = 1;

178 #ifde‡
HAVE_IPV6


179 i‡(
iÂ
->
Êags
 & 
IFF_IPV6
)

181 
	`mem£t
(&
li‰eq
, 0, (lifreq));

182 
	`li‰eq_£t_«me
 (&
li‰eq
, 
iÂ
->
«me
);

184 
ªt
 = 
	`AF_IOCTL
 (
AF_INET6
, 
SIOCGLIFMTU
, (
ˇddr_t
Ë& 
li‰eq
);

185 i‡(
ªt
 < 0)

187 
	`zlog_öfo
 ("C™'àlooku∞mtu6 o¿%†by io˘l(SIOCGIFMTU)", 
iÂ
->
«me
);

188 
iÂ
->
mtu6
 = -1;

192 
iÂ
->
mtu6
 = 
li‰eq
.
li‰_mëric
;

193 
ch™ged
 = 1;

198 i‡(
ch™ged
)

199 
	`zebø_öãrÁ˚_up_upd©e
(
iÂ
);

200 
	}
}

205 
	$if_£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

207 
ªt
;

208 
i‰eq
 ifreq;

209 
sockaddr_ö
 
addr
;

210 
sockaddr_ö
 
brﬂd
;

211 
sockaddr_ö
 
mask
;

212 
¥efix_ùv4
 
iÁddr
;

213 
¥efix_ùv4
 *
p
;

215 
p
 = (
¥efix_ùv4
 *Ë
ifc
->
addªss
;

217 
iÁddr
 = *
p
;

219 
	`°∫˝y
 (
i‰eq
.
i‰_«me
, 
iÂ
->
«me
, 
IFNAMSIZ
);

221 
addr
.
sö_addr
 = 
p
->
¥efix
;

222 
addr
.
sö_Ámûy
 = 
p
->
Ámûy
;

223 
	`mem˝y
 (&
i‰eq
.
i‰_addr
, &
addr
,  (
sockaddr_ö
));

225 
ªt
 = 
	`if_io˘l
 (
SIOCSIFADDR
, (
ˇddr_t
Ë& 
i‰eq
);

227 i‡(
ªt
 < 0)

228  
ªt
;

231 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
mask
.
sö_addr
);

233 i‡(
	`if_is_brﬂdˇ°
 (
iÂ
))

235 
	`≠∂y_mask_ùv4
 (&
iÁddr
);

236 
addr
.
sö_addr
 = 
iÁddr
.
¥efix
;

238 
brﬂd
.
sö_addr
.
s_addr
 = (
addr
.sö_addr.s_add∏| ~
mask
.sin_addr.s_addr);

239 
brﬂd
.
sö_Ámûy
 = 
p
->
Ámûy
;

241 
	`mem˝y
 (&
i‰eq
.
i‰_brﬂdaddr
, &
brﬂd
,  (
sockaddr_ö
));

242 
ªt
 = 
	`if_io˘l
 (
SIOCSIFBRDADDR
, (
ˇddr_t
Ë& 
i‰eq
);

243 i‡(
ªt
 < 0)

244  
ªt
;

247 
mask
.
sö_Ámûy
 = 
p
->
Ámûy
;

248 #ifde‡
SUNOS_5


249 
	`mem˝y
 (&
mask
, &
i‰eq
.
i‰_addr
,  (mask));

251 
	`mem˝y
 (&
i‰eq
.
i‰_√tmask
, &
mask
,  (
sockaddr_ö
));

253 
ªt
 = 
	`if_io˘l
 (
SIOCSIFNETMASK
, (
ˇddr_t
Ë& 
i‰eq
);

255  ((
ªt
 < 0) ?Ñet : 0);

256 
	}
}

261 
	$if_un£t_¥efix
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

263 
ªt
;

264 
i‰eq
 ifreq;

265 
sockaddr_ö
 
addr
;

266 
¥efix_ùv4
 *
p
;

268 
p
 = (
¥efix_ùv4
 *Ë
ifc
->
addªss
;

270 
	`°∫˝y
 (
i‰eq
.
i‰_«me
, 
iÂ
->
«me
, 
IFNAMSIZ
);

272 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö
));

273 
addr
.
sö_Ámûy
 = 
p
->
Ámûy
;

274 
	`mem˝y
 (&
i‰eq
.
i‰_addr
, &
addr
,  (
sockaddr_ö
));

276 
ªt
 = 
	`if_io˘l
 (
SIOCSIFADDR
, (
ˇddr_t
Ë& 
i‰eq
);

278 i‡(
ªt
 < 0)

279  
ªt
;

282 
	}
}

290 
	$if_gë_Êags_dúe˘
 (c⁄° *
i‚ame
, 
uöt64_t
 *
Êags
, 
af
)

292 
li‰eq
Üifreq;

293 
ªt
;

295 
	`li‰eq_£t_«me
 (&
li‰eq
, 
i‚ame
);

297 
ªt
 = 
	`AF_IOCTL
 (
af
, 
SIOCGLIFFLAGS
, (
ˇddr_t
Ë&
li‰eq
);

299 i‡(
ªt
)

300 
	`zlog_debug
 ("%s: ifname %s,Érror %s (%d)",

301 
__func__
, 
i‚ame
, 
	`ß„_°ªº‹
 (
î∫o
),Érrno);

303 *
Êags
 = 
li‰eq
.
li‰_Êags
;

305  
ªt
;

306 
	}
}

310 
	$if_gë_Êags
 (
öãrÁ˚
 *
iÂ
)

312 
ªt4
, 
ªt6
;

313 
uöt64_t
 
√wÊags
 = 0;

314 
uöt64_t
 
tmpÊags
;

316 i‡(
iÂ
->
Êags
 & 
IFF_IPV4
)

318 
ªt4
 = 
	`if_gë_Êags_dúe˘
 (
iÂ
->
«me
, &
tmpÊags
, 
AF_INET
);

320 i‡(!
ªt4
)

321 
√wÊags
 |
tmpÊags
;

322 i‡(
î∫o
 =
ENXIO
)

325 
	`UNSET_FLAG
 (
iÂ
->
Êags
, 
IFF_UP
);

326 
	`if_Êags_upd©e
 (
iÂ
, iÂ->
Êags
);

330 i‡(
iÂ
->
Êags
 & 
IFF_IPV6
)

332 
ªt6
 = 
	`if_gë_Êags_dúe˘
 (
iÂ
->
«me
, &
tmpÊags
, 
AF_INET6
);

334 i‡(!
ªt6
)

335 
√wÊags
 |
tmpÊags
;

336 i‡(
î∫o
 =
ENXIO
)

339 
	`UNSET_FLAG
 (
iÂ
->
Êags
, 
IFF_UP
);

340 
	`if_Êags_upd©e
 (
iÂ
, iÂ->
Êags
);

345 i‡–!(
ªt4
 && 
ªt6
) )

346 
	`if_Êags_upd©e
 (
iÂ
, 
√wÊags
);

347 
	}
}

351 
	$if_£t_Êags
 (
öãrÁ˚
 *
iÂ
, 
uöt64_t
 
Êags
)

353 
ªt
;

354 
li‰eq
Üifreq;

356 
	`li‰eq_£t_«me
 (&
li‰eq
, 
iÂ
->
«me
);

358 
li‰eq
.
li‰_Êags
 = 
iÂ
->
Êags
;

359 
li‰eq
.
li‰_Êags
 |
Êags
;

361 i‡(
iÂ
->
Êags
 & 
IFF_IPV4
)

362 
ªt
 = 
	`AF_IOCTL
 (
AF_INET
, 
SIOCSLIFFLAGS
, (
ˇddr_t
Ë& 
li‰eq
);

363 i‡(
iÂ
->
Êags
 & 
IFF_IPV6
)

364 
ªt
 = 
	`AF_IOCTL
 (
AF_INET6
, 
SIOCSLIFFLAGS
, (
ˇddr_t
Ë& 
li‰eq
);

366 
ªt
 = -1;

368 i‡(
ªt
 < 0)

369 
	`zlog_öfo
 ("ˇn'à£àöãrÁ˚ fœg†⁄ %s: %s", 
iÂ
->
«me
,

370 
	`ß„_°ªº‹
 (
î∫o
));

372 
ªt
 = 0;

374  
ªt
;

375 
	}
}

379 
	$if_un£t_Êags
 (
öãrÁ˚
 *
iÂ
, 
uöt64_t
 
Êags
)

381 
ªt
;

382 
li‰eq
Üifreq;

384 
	`li‰eq_£t_«me
 (&
li‰eq
, 
iÂ
->
«me
);

386 
li‰eq
.
li‰_Êags
 = 
iÂ
->
Êags
;

387 
li‰eq
.
li‰_Êags
 &~
Êags
;

389 i‡(
iÂ
->
Êags
 & 
IFF_IPV4
)

390 
ªt
 = 
	`AF_IOCTL
 (
AF_INET
, 
SIOCSLIFFLAGS
, (
ˇddr_t
Ë& 
li‰eq
);

391 i‡(
iÂ
->
Êags
 & 
IFF_IPV6
)

392 
ªt
 = 
	`AF_IOCTL
 (
AF_INET6
, 
SIOCSLIFFLAGS
, (
ˇddr_t
Ë& 
li‰eq
);

394 
ªt
 = -1;

396 i‡(
ªt
 < 0)

397 
	`zlog_öfo
 ("can't unset interface flags");

399 
ªt
 = 0;

401  
ªt
;

402 
	}
}

404 #ifde‡
HAVE_IPV6


408 
	$if_¥efix_add_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

410 
addrbuf
[
INET_ADDRSTRLEN
];

412 
	`öë_¡›
 (
AF_INET6
, &(((
¥efix_ùv6
 *Ë(
ifc
->
addªss
))->
¥efix
),

413 
addrbuf
,  (addrbuf));

414 
	`zlog_w¨n
 ("C™'à£à%†⁄ i¡îÁ˚ %s", 
addrbuf
, 
iÂ
->
«me
);

418 
	}
}

421 
	$if_¥efix_dñëe_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

423 
addrbuf
[
INET_ADDRSTRLEN
];

425 
	`öë_¡›
 (
AF_INET6
, &(((
¥efix_ùv6
 *Ë(
ifc
->
addªss
))->
¥efix
),

426 
addrbuf
,  (addrbuf));

427 
	`zlog_w¨n
 ("C™'àdñëê%†⁄ i¡îÁ˚ %s", 
addrbuf
, 
iÂ
->
«me
);

431 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward.h

22 #i‚de‡
_ZEBRA_IPFORWARD_H


23 
	#_ZEBRA_IPFORWARD_H


	)

25 
ùf‹w¨d
 ();

26 
ùf‹w¨d_⁄
 ();

27 
ùf‹w¨d_off
 ();

29 #ifde‡
HAVE_IPV6


30 
ùf‹w¨d_ùv6
 ();

31 
ùf‹w¨d_ùv6_⁄
 ();

32 
ùf‹w¨d_ùv6_off
 ();

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_aix.c

23 
	~<zebø.h
>

26 
	$ùf‹w¨d
 ()

28 
fd
, 
ªt
;

29 
af
 = 
AF_INET
;

30 
√t›t
[] = "ipforwarding";

31 
›åeq
 
oq
;

33 
fd
 = 
	`sockë
(
af
, 
SOCK_DGRAM
, 0);

34 i‡(
fd
 < 0) {

39 
	`°r˝y
 (
oq
.
«me
, 
√t›t
);

40 
oq
.
gë√xt
 = 0;

42 
ªt
 = 
	`io˘l
 (
fd
, 
SIOCGNETOPT
, (
ˇddr_t
)&
oq
);

43 
	`˛o£
(
fd
);

45 i‡(
ªt
 < 0) {

50 
ªt
 = 
	`©oi
 (
oq
.
d©a
);

51  
ªt
;

52 
	}
}

55 
	$ùf‹w¨d_⁄
 ()

58 
	}
}

61 
	$ùf‹w¨d_off
 ()

64 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_ews.c

23 
	~<zebø.h
>

26 
	$ùf‹w¨d
 ()

28 
fd
;

29 
buf
[
BUFSIZ
];

30 
mioc_rksym
 
rks
;

32 
fd
 = 
	`›í
 ("/dev/kmem", 
O_RDWR
);

33 i‡(
fd
 < 0) {

38 
rks
.
múk_sym«me
 = "ipforwarding";

39 
rks
.
múk_buf
 = 
buf
;

40 
rks
.
múk_buÊí
 =  ();

42 i‡(
	`io˘l
 (
fd
, 
MIOC_READKSYM
, &
rks
) < 0) {

46 
	`˛o£
 (
fd
);

47  *(*)
buf
;

48 
	}
}

51 
	$ùf‹w¨d_⁄
 ()

54 
	}
}

57 
	$ùf‹w¨d_off
 ()

60 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_proc.c

23 
	~<zebø.h
>

25 
	~"log.h
"

26 
	~"¥ivs.h
"

28 
	~"zebø/ùf‹w¨d.h
"

30 
zebø_¥ivs_t
 
z£rv_¥ivs
;

32 
	g¥oc_√t_¢mp
[] = "/proc/net/snmp";

35 
	$dr›löe
 (
FILE
 *
Â
)

37 
c
;

39 (
c
 = 
	`gëc
 (
Â
)) != '\n')

41 
	}
}

44 
	$ùf‹w¨d
 ()

46 
FILE
 *
Â
;

47 
ùf‹w¨dög
 = 0;

48 
buf
[10];

50 
Â
 = 
	`f›í
 (
¥oc_√t_¢mp
, "r");

52 i‡(
Â
 =
NULL
)

56 
	`dr›löe
 (
Â
);

61 i‡(
	`fgës
 (
buf
, 6, 
Â
))

62 
	`ssˇnf
 (
buf
, "Ip: %d", &
ùf‹w¨dög
);

64 
	`f˛o£
(
Â
);

66 i‡(
ùf‹w¨dög
 == 1)

70 
	}
}

73 
	g¥oc_ùv4_f‹w¨dög
[] = "/proc/sys/net/ipv4/ip_forward";

76 
	$ùf‹w¨d_⁄
 ()

78 
FILE
 *
Â
;

80 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
) )

81 
	`zlog_îr
 ("C™'àøi£Örivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
) );

83 
Â
 = 
	`f›í
 (
¥oc_ùv4_f‹w¨dög
, "w");

85 i‡(
Â
 =
NULL
) {

86 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

87 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

91 
	`Ârötf
 (
Â
, "1\n");

93 
	`f˛o£
 (
Â
);

95 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

96 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

98  
	`ùf‹w¨d
 ();

99 
	}
}

102 
	$ùf‹w¨d_off
 ()

104 
FILE
 *
Â
;

106 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
) )

107 
	`zlog_îr
 ("C™'àøi£Örivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

109 
Â
 = 
	`f›í
 (
¥oc_ùv4_f‹w¨dög
, "w");

111 i‡(
Â
 =
NULL
) {

112 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

113 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

117 
	`Ârötf
 (
Â
, "0\n");

119 
	`f˛o£
 (
Â
);

121 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

122 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

124  
	`ùf‹w¨d
 ();

125 
	}
}

126 #ifde‡
HAVE_IPV6


128 
	g¥oc_ùv6_f‹w¨dög
[] = "/proc/sys/net/ipv6/conf/all/forwarding";

131 
	$ùf‹w¨d_ùv6
 ()

133 
FILE
 *
Â
;

134 
buf
[5];

135 
ùf‹w¨dög
 = 0;

137 
Â
 = 
	`f›í
 (
¥oc_ùv6_f‹w¨dög
, "r");

139 i‡(
Â
 =
NULL
)

142 i‡(
	`fgës
 (
buf
, 2, 
Â
))

143 
	`ssˇnf
 (
buf
, "%d", &
ùf‹w¨dög
);

145 
	`f˛o£
 (
Â
);

146  
ùf‹w¨dög
;

147 
	}
}

150 
	$ùf‹w¨d_ùv6_⁄
 ()

152 
FILE
 *
Â
;

154 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
) )

155 
	`zlog_îr
 ("C™'àøi£Örivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

157 
Â
 = 
	`f›í
 (
¥oc_ùv6_f‹w¨dög
, "w");

159 i‡(
Â
 =
NULL
) {

160 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

161 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

165 
	`Ârötf
 (
Â
, "1\n");

167 
	`f˛o£
 (
Â
);

169 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

170 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

172  
	`ùf‹w¨d_ùv6
 ();

173 
	}
}

176 
	$ùf‹w¨d_ùv6_off
 ()

178 
FILE
 *
Â
;

180 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
) )

181 
	`zlog_îr
 ("C™'àøi£Örivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

183 
Â
 = 
	`f›í
 (
¥oc_ùv6_f‹w¨dög
, "w");

185 i‡(
Â
 =
NULL
) {

186 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

187 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

191 
	`Ârötf
 (
Â
, "0\n");

193 
	`f˛o£
 (
Â
);

195 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

196 
	`zlog_îr
 ("C™'àlowîÖrivûeges, %s", 
	`ß„_°ªº‹
 (
î∫o
));

198  
	`ùf‹w¨d_ùv6
 ();

199 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_solaris.c

23 
	~<zebø.h
>

24 
	~"log.h
"

25 
	~"¥efix.h
"

27 
	~"¥ivs.h
"

28 
	~"zebø/ùf‹w¨d.h
"

36 #i‚de‡
IP_DEV_NAME


37 
	#IP_DEV_NAME
 "/dev/ù"

	)

41 
zebø_¥ivs_t
 
z£rv_¥ivs
;

51 
	$sﬁ¨is_nd
(c⁄° 
cmd
, c⁄° * 
∑ømëî
, c⁄° 
vÆue
)

53 
	#ND_BUFFER_SIZE
 1024

	)

54 
fd
;

55 
nd_buf
[
ND_BUFFER_SIZE
];

56 
°rio˘l
 strioctl;

57 c⁄° * 
devi˚
 = 
IP_DEV_NAME
;

58 
ªtvÆ
;

59 
	`mem£t
(
nd_buf
, '\0', 
ND_BUFFER_SIZE
);

65 i‡(
cmd
 =
ND_SET
)

66 
	`¢¥ötf
(
nd_buf
, 
ND_BUFFER_SIZE
, "%s%c%d%c", 
∑ømëî
, '\0', 
vÆue
,'\0');

67 i‡(
cmd
 =
ND_GET
)

68 
	`¢¥ötf
(
nd_buf
, 
ND_BUFFER_SIZE
, "%s", 
∑ømëî
);

70 
	`zlog_îr
("internalÉrror - inappropriate command givenÅo "

71 "sﬁ¨is_nd()%s:%d", 
__FILE__
, 
__LINE__
);

75 
°rio˘l
.
ic_cmd
 = 
cmd
;

76 
°rio˘l
.
ic_timout
 = 0;

77 
°rio˘l
.
ic_Àn
 = 
ND_BUFFER_SIZE
;

78 
°rio˘l
.
ic_dp
 = 
nd_buf
;

80 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
) )

81 
	`zlog_îr
 ("solaris_nd: Can'tÑaiseÖrivileges");

82 i‡((
fd
 = 
	`›í
 (
devi˚
, 
O_RDWR
)) < 0)

84 
	`zlog_w¨n
("ÁûedÅÿ›í devi˚ %†- %s", 
devi˚
, 
	`ß„_°ªº‹
(
î∫o
));

85 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

86 
	`zlog_îr
 ("solaris_nd: Can'tÜowerÖrivileges");

89 i‡(
	`io˘l
 (
fd
, 
I_STR
, &
°rio˘l
) < 0)

91 
ßve_î∫o
 = 
î∫o
;

92 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

93 
	`zlog_îr
 ("solaris_nd: Can'tÜowerÖrivileges");

94 
	`˛o£
 (
fd
);

95 
	`zlog_w¨n
("ioctl I_STR failed on device %s - %s",

96 
devi˚
, 
	`ß„_°ªº‹
(
ßve_î∫o
));

99 
	`˛o£
(
fd
);

100 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

101 
	`zlog_îr
 ("solaris_nd: Can'tÜowerÖrivileges");

103 i‡(
cmd
 =
ND_GET
)

105 
î∫o
 = 0;

106 
ªtvÆ
 = 
	`©oi
(
nd_buf
);

107 i‡(
î∫o
)

109 
	`zlog_w¨n
("failedÅo convertÑeturned valueÅo integer - %s",

110 
	`ß„_°ªº‹
(
î∫o
));

111 
ªtvÆ
 = -1;

116 
ªtvÆ
 = 0;

118  
ªtvÆ
;

119 
	}
}

122 
	$sﬁ¨is_nd_£t
(c⁄° * 
∑ømëî
, c⁄° 
vÆue
) {

123  
	`sﬁ¨is_nd
(
ND_SET
, 
∑ømëî
, 
vÆue
);

124 
	}
}

126 
	$sﬁ¨is_nd_gë
(c⁄° * 
∑ømëî
) {

127  
	`sﬁ¨is_nd
(
ND_GET
, 
∑ømëî
, 0);

128 
	}
}

130 
	$ùf‹w¨d
()

132  
	`sﬁ¨is_nd_gë
("ip_forwarding");

133 
	}
}

136 
	$ùf‹w¨d_⁄
 ()

138 (Ë
	`sﬁ¨is_nd_£t
("ip_forwarding", 1);

139  
	`ùf‹w¨d
();

140 
	}
}

143 
	$ùf‹w¨d_off
 ()

145 (Ë
	`sﬁ¨is_nd_£t
("ip_forwarding", 0);

146  
	`ùf‹w¨d
();

147 
	}
}

148 #ifde‡
HAVE_IPV6


149 
	$ùf‹w¨d_ùv6
()

151  
	`sﬁ¨is_nd_gë
("ip6_forwarding");

152 
	}
}

154 
	$ùf‹w¨d_ùv6_⁄
 ()

156 (Ë
	`sﬁ¨is_nd_£t
("ip6_forwarding", 1);

157  
	`ùf‹w¨d_ùv6
();

158 
	}
}

160 
	$ùf‹w¨d_ùv6_off
 ()

162 (Ë
	`sﬁ¨is_nd_£t
("ip6_forwarding", 0);

163  
	`ùf‹w¨d_ùv6
();

164 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_sysctl.c

22 
	~<zebø.h
>

23 
	~"¥ivs.h
"

24 
	~"zebø/ùf‹w¨d.h
"

26 #ifde‡
NRL


27 
	~<√töë6/ö6.h
>

30 
	~"log.h
"

32 
	#MIB_SIZ
 4

	)

34 
zebø_¥ivs_t
 
z£rv_¥ivs
;

37 
	gmib
[
MIB_SIZ
] =

39 
CTL_NET
,

40 
PF_INET
,

41 
IPPROTO_IP
,

42 
IPCTL_FORWARDING


46 
	$ùf‹w¨d
 ()

48 
size_t
 
Àn
;

49 
ùf‹w¨dög
 = 0;

51 
Àn
 =  
ùf‹w¨dög
;

52 i‡(
	`sys˘l
 (
mib
, 
MIB_SIZ
, &
ùf‹w¨dög
, &
Àn
, 0, 0) < 0)

54 
	`zlog_w¨n
 ("Can't get ipforwarding value");

57  
ùf‹w¨dög
;

58 
	}
}

61 
	$ùf‹w¨d_⁄
 ()

63 
size_t
 
Àn
;

64 
ùf‹w¨dög
 = 1;

66 
Àn
 =  
ùf‹w¨dög
;

67 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

68 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

69 i‡(
	`sys˘l
 (
mib
, 
MIB_SIZ
, 
NULL
, NULL, &
ùf‹w¨dög
, 
Àn
) < 0)

71 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

72 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

73 
	`zlog_w¨n
 ("Can't set ipforwarding on");

76 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

77 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

78  
ùf‹w¨dög
;

79 
	}
}

82 
	$ùf‹w¨d_off
 ()

84 
size_t
 
Àn
;

85 
ùf‹w¨dög
 = 0;

87 
Àn
 =  
ùf‹w¨dög
;

88 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

89 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

90 i‡(
	`sys˘l
 (
mib
, 
MIB_SIZ
, 
NULL
, NULL, &
ùf‹w¨dög
, 
Àn
) < 0)

92 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

93 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

94 
	`zlog_w¨n
 ("Can't set ipforwarding on");

97 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

98 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

99  
ùf‹w¨dög
;

100 
	}
}

102 #ifde‡
HAVE_IPV6


105 
	gmib_ùv6
[
MIB_SIZ
] =

107 
CTL_NET
,

108 
PF_INET6
,

109 #i‡
deföed
(
KAME
Ë|| (deföed(
__bsdi__
Ë&& 
_BSDI_VERSION
 >199802 ) || deföed(
NRL
)

110 
IPPROTO_IPV6
,

111 
IPV6CTL_FORWARDING


113 
IPPROTO_IP
,

114 
IP6CTL_FORWARDING


119 
	$ùf‹w¨d_ùv6
 ()

121 
size_t
 
Àn
;

122 
ù6f‹w¨dög
 = 0;

124 
Àn
 =  
ù6f‹w¨dög
;

125 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

126 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

127 i‡(
	`sys˘l
 (
mib_ùv6
, 
MIB_SIZ
, &
ù6f‹w¨dög
, &
Àn
, 0, 0) < 0)

129 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

130 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

131 
	`zlog_w¨n
 ("can't get ip6forwarding value");

134 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

135 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

136  
ù6f‹w¨dög
;

137 
	}
}

140 
	$ùf‹w¨d_ùv6_⁄
 ()

142 
size_t
 
Àn
;

143 
ù6f‹w¨dög
 = 1;

145 
Àn
 =  
ù6f‹w¨dög
;

146 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

147 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

148 i‡(
	`sys˘l
 (
mib_ùv6
, 
MIB_SIZ
, 
NULL
, NULL, &
ù6f‹w¨dög
, 
Àn
) < 0)

150 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

151 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

152 
	`zlog_w¨n
 ("can't get ip6forwarding value");

155 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

156 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

157  
ù6f‹w¨dög
;

158 
	}
}

161 
	$ùf‹w¨d_ùv6_off
 ()

163 
size_t
 
Àn
;

164 
ù6f‹w¨dög
 = 0;

166 
Àn
 =  
ù6f‹w¨dög
;

167 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

168 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

169 i‡(
	`sys˘l
 (
mib_ùv6
, 
MIB_SIZ
, 
NULL
, NULL, &
ù6f‹w¨dög
, 
Àn
) < 0)

171 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

172 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

173 
	`zlog_w¨n
 ("can't get ip6forwarding value");

176 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

177 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

178  
ù6f‹w¨dög
;

179 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp.h

27 #i‚de‡
_IRDP_H


28 
	#_IRDP_H


	)

30 
	~"lib/vty.h
"

32 
	#TRUE
 1

	)

33 
	#FALSE
 0

	)

36 #i‚de‡
ICMP_ROUTERADVERT


37 
	#ICMP_ROUTERADVERT
 9

	)

40 #i‚de‡
ICMP_ROUTERSOLICIT


41 
	#ICMP_ROUTERSOLICIT
 10

	)

45 #i‚de‡
INADDR_ALLHOSTS_GROUP


46 
	#INADDR_ALLHOSTS_GROUP
 0xe0000001U

	)

49 #i‚de‡
INADDR_ALLRTRS_GROUP


50 
	#INADDR_ALLRTRS_GROUP
 0xe0000002U

	)

54 
	#IRDP_DEFAULT_INTERVAL
 300

	)

57 
	#MAX_INITIAL_ADVERT_INTERVAL
 16

	)

58 
	#MAX_INITIAL_ADVERTISEMENTS
 3

	)

59 
	#MAX_RESPONSE_DELAY
 2

	)

61 
	#IRDP_MAXADVERTINTERVAL
 600

	)

62 
	#IRDP_MINADVERTINTERVAL
 450

	)

63 
	#IRDP_LIFETIME
 1350

	)

64 
	#IRDP_PREFERENCE
 0

	)

66 
	#ICMP_MINLEN
 8

	)

68 
	#IRDP_LAST_ADVERT_MESSAGES
 2

	)

70 
	#IRDP_RX_BUF
 1500

	)

114 
	súdp_öãrÁ˚


116 
	mMaxAdvîtI¡îvÆ
;

117 
	mMöAdvîtI¡îvÆ
;

118 
	mPª„ªn˚
;

120 
u_öt32_t
 
	mÊags
;

122 
	#IF_ACTIVE
 (1<<0Ë

	)

123 
	#IF_BROADCAST
 (1<<1Ë

	)

124 
	#IF_SOLICIT
 (1<<2Ë

	)

125 
	#IF_DEBUG_MESSAGES
 (1<<3)

	)

126 
	#IF_DEBUG_PACKET
 (1<<4)

	)

127 
	#IF_DEBUG_MISC
 (1<<5)

	)

128 
	#IF_SHUTDOWN
 (1<<6)

	)

130 
öãrÁ˚
 *
	miÂ
;

131 
thªad
 *
	mt_advîti£
;

132 
	múdp_£¡
;

133 
u_öt16_t
 
	mLi„time
;

135 
li°
 *
	mAdvPªfLi°
;

139 
	sAdv


141 
ö_addr
 
	mù
;

142 
	m¥ef
;

145 
údp_öô
();

146 
údp_sock_öô
();

147 
údp_föish
();

148 
údp_c⁄fig_wrôe
 (
vty
 *, 
öãrÁ˚
 *);

149 
údp_£nd_thªad
(
thªad
 *
t_advît
);

150 
údp_advît_off
(
öãrÁ˚
 *
iÂ
);

151 
¥o˚ss_sﬁicô
 (
öãrÁ˚
 *
iÂ
);

152 
údp_ªad_øw
(
thªad
 *
r
);

153 
£nd_∑ckë
(
öãrÁ˚
 *
iÂ
, 
°ªam
 *
s
,

154 
u_öt32_t
 
d°
, 
¥efix
 *
p
, u_öt32_à
âl
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp_interface.c

37 
	~<zebø.h
>

39 #ifde‡
HAVE_IRDP


41 
	~"if.h
"

42 
	~"vty.h
"

43 
	~"sockuni⁄.h
"

44 
	~"¥efix.h
"

45 
	~"comm™d.h
"

46 
	~"mem‹y.h
"

47 
	~"°ªam.h
"

48 
	~"io˘l.h
"

49 
	~"c⁄√˘ed.h
"

50 
	~"log.h
"

51 
	~"z˛õ¡.h
"

52 
	~"thªad.h
"

53 
	~"zebø/öãrÁ˚.h
"

54 
	~"zebø/πadv.h
"

55 
	~"zebø/rib.h
"

56 
	~"zebø/z£rv.h
"

57 
	~"zebø/ªdi°ribuã.h
"

58 
	~"zebø/údp.h
"

59 
	~<√töë/ù_icmp.h
>

60 
	~"if.h
"

61 
	~"sockuni⁄.h
"

62 
	~"log.h
"

66 
zebø_t
 
zebød
;

68 
údp_sock
;

71 
	$öë_2a
(
u_öt32_t
 
a
, *
b
)

73 
	`•rötf
(
b
, "%u.%u.%u.%u",

74 (
a
 ) & 0xFF,

75 (
a
>> 8) & 0xFF,

76 (
a
>>16) & 0xFF,

77 (
a
>>24) & 0xFF);

78  
b
;

79 
	}
}

82 
¥efix
 *

83 
	$údp_gë_¥efix
(
öãrÁ˚
 *
iÂ
)

85 
li°node
 *
node
;

86 
c⁄√˘ed
 *
ifc
;

88 i‡(
iÂ
->
c⁄√˘ed
)

89 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
node
, 
ifc
))

90  
ifc
->
addªss
;

92  
NULL
;

93 
	}
}

97 
	$if_group
 (
öãrÁ˚
 *
iÂ
,

98 
sock
,

99 
u_öt32_t
 
group
,

100 
add_Àave
)

102 
ù_mªq
 
m
;

103 
¥efix
 *
p
;

104 
ªt
;

105 
b1
[
INET_ADDRSTRLEN
];

107 
	`mem£t
 (&
m
, 0,  (m));

108 
m
.
imr_mu…üddr
.
s_addr
 = 
	`ht⁄l
 (
group
);

109 
p
 = 
	`údp_gë_¥efix
(
iÂ
);

111 if(!
p
) {

112 
	`zlog_w¨n
 ("IRDP: c™'àgëáddªs†f‹ %s", 
iÂ
->
«me
);

116 
m
.
imr_öãrÁ˚
 = 
p
->
u
.
¥efix4
;

118 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
add_Àave
,

119 (*Ë&
m
,  (
ù_mªq
));

120 i‡(
ªt
 < 0)

121 
	`zlog_w¨n
 ("IRDP: %s can't setsockopt %s: %s",

122 
add_Àave
 =
IP_ADD_MEMBERSHIP
? "join group":"leave group",

123 
	`öë_2a
(
group
, 
b1
),

124 
	`ß„_°ªº‹
 (
î∫o
));

126  
ªt
;

127 
	}
}

130 
	$if_add_group
 (
öãrÁ˚
 *
iÂ
)

132 
zebø_if
 *
zi

iÂ
->
öfo
;

133 
údp_öãrÁ˚
 *
údp
 = &
zi
->irdp;

134 
ªt
;

135 
b1
[
INET_ADDRSTRLEN
];

137 
ªt
 = 
	`if_group
 (
iÂ
, 
údp_sock
, 
INADDR_ALLRTRS_GROUP
, 
IP_ADD_MEMBERSHIP
);

138 i‡(
ªt
 < 0) {

139  
ªt
;

142 if(
údp
->
Êags
 & 
IF_DEBUG_MISC
 )

143 
	`zlog_debug
("IRDP: Adding group %s for %s",

144 
	`öë_2a
(
	`ht⁄l
(
INADDR_ALLRTRS_GROUP
), 
b1
),

145 
iÂ
->
«me
);

147 
	}
}

150 
	$if_dr›_group
 (
öãrÁ˚
 *
iÂ
)

152 
zebø_if
 *
zi

iÂ
->
öfo
;

153 
údp_öãrÁ˚
 *
údp
 = &
zi
->irdp;

154 
ªt
;

155 
b1
[
INET_ADDRSTRLEN
];

157 
ªt
 = 
	`if_group
 (
iÂ
, 
údp_sock
, 
INADDR_ALLRTRS_GROUP
, 
IP_DROP_MEMBERSHIP
);

158 i‡(
ªt
 < 0)

159  
ªt
;

161 if(
údp
->
Êags
 & 
IF_DEBUG_MISC
)

162 
	`zlog_debug
("IRDP: Leaving group %s for %s",

163 
	`öë_2a
(
	`ht⁄l
(
INADDR_ALLRTRS_GROUP
), 
b1
),

164 
iÂ
->
«me
);

166 
	}
}

169 
	$if_£t_deÁu…s
(
öãrÁ˚
 *
iÂ
)

171 
zebø_if
 *
zi
=
iÂ
->
öfo
;

172 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

174 
údp
->
MaxAdvîtI¡îvÆ
 = 
IRDP_MAXADVERTINTERVAL
;

175 
údp
->
MöAdvîtI¡îvÆ
 = 
IRDP_MINADVERTINTERVAL
;

176 
údp
->
Pª„ªn˚
 = 
IRDP_PREFERENCE
;

177 
údp
->
Li„time
 = 
IRDP_LIFETIME
;

178 
	}
}

181 
Adv
 *
	$Adv_√w
 ()

183  
	`XCALLOC
 (
MTYPE_TMP
,  (
Adv
));

184 
	}
}

187 
	$Adv_‰ì
 (
Adv
 *
adv
)

189 
	`XFREE
 (
MTYPE_TMP
, 
adv
);

190 
	}
}

193 
	$údp_if_°¨t
(
öãrÁ˚
 *
iÂ
, 
mu…iˇ°
, 
£t_deÁu…s
)

195 
zebø_if
 *
zi

iÂ
->
öfo
;

196 
údp_öãrÁ˚
 *
údp
 = &
zi
->irdp;

197 
li°node
 *
node
;

198 
c⁄√˘ed
 *
ifc
;

199 
u_öt32_t
 
timî
, 
£ed
;

201 i‡(
údp
->
Êags
 & 
IF_ACTIVE
 ) {

202 
	`zlog_w¨n
("IRDP: I¡îÁ˚ i†Æªadyá˘ivê%s", 
iÂ
->
«me
);

205 i‡((
údp_sock
 < 0Ë&& ((údp_sock = 
	`údp_sock_öô
()) < 0)) {

206 
	`zlog_w¨n
("IRDP: Cannotáctivate interface %s (cannot create "

207 "IRDP sockë)", 
iÂ
->
«me
);

210 
údp
->
Êags
 |
IF_ACTIVE
;

212 if(!
mu…iˇ°
)

213 
údp
->
Êags
 |
IF_BROADCAST
;

215 
	`if_add_upd©e
(
iÂ
);

217 i‡(! (
iÂ
->
Êags
 & 
IFF_UP
)) {

218 
	`zlog_w¨n
("IRDP: I¡îÁ˚ i†dow¿%s", 
iÂ
->
«me
);

223 if–
mu…iˇ°
) {

224 
	`if_add_group
(
iÂ
);

226 i‡(! (
iÂ
->
Êags
 & (
IFF_MULTICAST
|
IFF_ALLMULTI
))) {

227 
	`zlog_w¨n
("IRDP: I¡îÁ˚ÇŸ mu…iˇ°É«bÀd %s", 
iÂ
->
«me
);

231 if(
£t_deÁu…s
)

232 
	`if_£t_deÁu…s
(
iÂ
);

234 
údp
->
údp_£¡
 = 0;

238 
£ed
 = 0;

239 if–
iÂ
->
c⁄√˘ed
)

240 
	`ALL_LIST_ELEMENTS_RO
 (
iÂ
->
c⁄√˘ed
, 
node
, 
ifc
))

242 
£ed
 = 
ifc
->
addªss
->
u
.
¥efix4
.
s_addr
;

246 
	`§™dom
(
£ed
);

247 
timî
 = (
	`øndom
 (Ë% 
IRDP_DEFAULT_INTERVAL
) + 1;

249 
údp
->
AdvPªfLi°
 = 
	`li°_√w
();

250 
údp
->
AdvPªfLi°
->
dñ
 = ((*)(*)Ë
Adv_‰ì
;

255 if(
údp
->
údp_£¡
 < 
MAX_INITIAL_ADVERTISEMENTS
 &&

256 
timî
 > 
MAX_INITIAL_ADVERT_INTERVAL
 )

257 
timî

MAX_INITIAL_ADVERT_INTERVAL
;

260 if(
údp
->
Êags
 & 
IF_DEBUG_MISC
)

261 
	`zlog_debug
("IRDP: InitÅimer for %s setÅo %u",

262 
iÂ
->
«me
,

263 
timî
);

265 
údp
->
t_advîti£
 = 
	`thªad_add_timî
(
zebød
.
ma°î
,

266 
údp_£nd_thªad
,

267 
iÂ
,

268 
timî
);

269 
	}
}

272 
	$údp_if_°›
(
öãrÁ˚
 *
iÂ
)

274 
zebø_if
 *
zi
=
iÂ
->
öfo
;

275 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

277 i‡(
údp
 =
NULL
) {

278 
	`zlog_w¨n
 ("I¡îÁ˚ %†°ru˘uª i†NULL", 
iÂ
->
«me
);

282 i‡(! (
údp
->
Êags
 & 
IF_ACTIVE
 )) {

283 
	`zlog_w¨n
("I¡îÁ˚ i†nŸá˘ivê%s", 
iÂ
->
«me
);

287 if(! (
údp
->
Êags
 & 
IF_BROADCAST
))

288 
	`if_dr›_group
(
iÂ
);

290 
	`údp_advît_off
(
iÂ
);

292 
	`li°_dñëe
(
údp
->
AdvPªfLi°
);

293 
údp
->
AdvPªfLi°
=
NULL
;

295 
údp
->
Êags
 = 0;

296 
	}
}

300 
	$údp_if_shutdown
(
öãrÁ˚
 *
iÂ
)

302 
zebø_if
 *
zi

iÂ
->
öfo
;

303 
údp_öãrÁ˚
 *
údp
 = &
zi
->irdp;

305 i‡(
údp
->
Êags
 & 
IF_SHUTDOWN
 ) {

306 
	`zlog_w¨n
("IRDP: I¡îÁ˚ i†Æªady shutdow¿%s", 
iÂ
->
«me
);

310 
údp
->
Êags
 |
IF_SHUTDOWN
;

311 
údp
->
Êags
 &~
IF_ACTIVE
;

313 if(! (
údp
->
Êags
 & 
IF_BROADCAST
))

314 
	`if_dr›_group
(
iÂ
);

317 
	`údp_advît_off
(
iÂ
);

318 
	}
}

321 
	$údp_if_no_shutdown
(
öãrÁ˚
 *
iÂ
)

323 
zebø_if
 *
zi

iÂ
->
öfo
;

324 
údp_öãrÁ˚
 *
údp
 = &
zi
->irdp;

326 i‡(! (
údp
->
Êags
 & 
IF_SHUTDOWN
 )) {

327 
	`zlog_w¨n
("IRDP: I¡îÁ˚ i†nŸ shutdow¿%s", 
iÂ
->
«me
);

331 
údp
->
Êags
 &~
IF_SHUTDOWN
;

333 
	`údp_if_°¨t
(
iÂ
, 
údp
->
Êags
 & 
IF_BROADCAST
? 
FALSE
 : 
TRUE
, FALSE);

335 
	}
}

340 
	$údp_c⁄fig_wrôe
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
)

342 
zebø_if
 *
zi
=
iÂ
->
öfo
;

343 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

344 
Adv
 *
adv
;

345 
li°node
 *
node
;

346 
b1
[
INET_ADDRSTRLEN
];

348 if(
údp
->
Êags
 & 
IF_ACTIVE
 || irdp->Êag†& 
IF_SHUTDOWN
) {

350 if–
údp
->
Êags
 & 
IF_SHUTDOWN
)

351 
	`vty_out
 (
vty
, " i∞úd∞shutdow¿%s", 
VTY_NEWLINE
);

353 if–
údp
->
Êags
 & 
IF_BROADCAST
)

354 
	`vty_out
 (
vty
, " i∞úd∞brﬂdˇ°%s", 
VTY_NEWLINE
);

356 
	`vty_out
 (
vty
, " i∞úd∞mu…iˇ°%s", 
VTY_NEWLINE
);

358 
	`vty_out
 (
vty
, " ip irdpÖreference %ld%s",

359 
údp
->
Pª„ªn˚
, 
VTY_NEWLINE
);

361 
	`ALL_LIST_ELEMENTS_RO
 (
údp
->
AdvPªfLi°
, 
node
, 
adv
))

362 
	`vty_out
 (
vty
, " ip irdpáddress %sÖreference %d%s",

363 
	`öë_2a
(
adv
->
ù
.
s_addr
, 
b1
),

364 
adv
->
¥ef
,

365 
VTY_NEWLINE
);

367 
	`vty_out
 (
vty
, " ip irdp holdtime %d%s",

368 
údp
->
Li„time
, 
VTY_NEWLINE
);

370 
	`vty_out
 (
vty
, " ip irdp minadvertinterval %ld%s",

371 
údp
->
MöAdvîtI¡îvÆ
, 
VTY_NEWLINE
);

373 
	`vty_out
 (
vty
, " ip irdp maxadvertinterval %ld%s",

374 
údp
->
MaxAdvîtI¡îvÆ
, 
VTY_NEWLINE
);

377 
	}
}

380 
DEFUN
 (
ù_údp_mu…iˇ°
,

381 
ù_údp_mu…iˇ°_cmd
,

383 
IP_STR


386 
öãrÁ˚
 *
	giÂ
;

388 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

389 if(!
	giÂ
) {

390  
	gCMD_WARNING
;

393 
údp_if_°¨t
(
iÂ
, 
TRUE
, TRUE);

394  
	gCMD_SUCCESS
;

397 
DEFUN
 (
ù_údp_brﬂdˇ°
,

398 
ù_údp_brﬂdˇ°_cmd
,

400 
IP_STR


403 
öãrÁ˚
 *
	giÂ
;

405 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

406 if(!
	giÂ
) {

407  
	gCMD_WARNING
;

410 
údp_if_°¨t
(
iÂ
, 
FALSE
, 
TRUE
);

411  
	gCMD_SUCCESS
;

414 
DEFUN
 (
no_ù_údp
,

415 
no_ù_údp_cmd
,

417 
NO_STR


418 
IP_STR


421 
öãrÁ˚
 *
	giÂ
;

423 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

424 if(!
	giÂ
) {

425  
	gCMD_WARNING
;

428 
údp_if_°›
(
iÂ
);

429  
	gCMD_SUCCESS
;

432 
DEFUN
 (
ù_údp_shutdown
,

433 
ù_údp_shutdown_cmd
,

435 
IP_STR


438 
öãrÁ˚
 *
	giÂ
;

440 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

441 if(!
	giÂ
) {

442  
	gCMD_WARNING
;

445 
údp_if_shutdown
(
iÂ
);

446  
	gCMD_SUCCESS
;

449 
DEFUN
 (
no_ù_údp_shutdown
,

450 
no_ù_údp_shutdown_cmd
,

452 
NO_STR


453 
IP_STR


456 
öãrÁ˚
 *
	giÂ
;

458 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

459 if(!
	giÂ
) {

460  
	gCMD_WARNING
;

463 
údp_if_no_shutdown
(
iÂ
);

464  
	gCMD_SUCCESS
;

467 
DEFUN
 (
ù_údp_hﬁdtime
,

468 
ù_údp_hﬁdtime_cmd
,

470 
IP_STR


475 
öãrÁ˚
 *
	giÂ
;

476 
zebø_if
 *
	gzi
;

477 
údp_öãrÁ˚
 *
	gúdp
;

478 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

479 if(!
	giÂ
) {

480  
	gCMD_WARNING
;

483 
	gzi
=
iÂ
->
öfo
;

484 
	gúdp
=&
zi
->
údp
;

486 
	gúdp
->
	gLi„time
 = 
©oi
(
¨gv
[0]);

487  
	gCMD_SUCCESS
;

490 
DEFUN
 (
ù_údp_möadvîtöãrvÆ
,

491 
ù_údp_möadvîtöãrvÆ_cmd
,

493 
IP_STR


498 
öãrÁ˚
 *
	giÂ
;

499 
zebø_if
 *
	gzi
;

500 
údp_öãrÁ˚
 *
	gúdp
;

501 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

502 if(!
	giÂ
) {

503  
	gCMD_WARNING
;

506 
	gzi
=
iÂ
->
öfo
;

507 
	gúdp
=&
zi
->
údp
;

509 if–(Ë
©oi
(
¨gv
[0]Ë<
údp
->
MaxAdvîtI¡îvÆ
) {

510 
údp
->
MöAdvîtI¡îvÆ
 = 
©oi
(
¨gv
[0]);

512  
	gCMD_SUCCESS
;

515 
vty_out
 (
vty
, "ICMP warning maxadvertinterval is greater orÉqualÅhan minadvertinterval%s",

516 
VTY_NEWLINE
);

518 
vty_out
 (
vty
, "Please correct!%s",

519 
VTY_NEWLINE
);

520  
	gCMD_WARNING
;

523 
DEFUN
 (
ù_údp_maxadvîtöãrvÆ
,

524 
ù_údp_maxadvîtöãrvÆ_cmd
,

526 
IP_STR


531 
öãrÁ˚
 *
	giÂ
;

532 
zebø_if
 *
	gzi
;

533 
údp_öãrÁ˚
 *
	gúdp
;

534 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

535 if(!
	giÂ
) {

536  
	gCMD_WARNING
;

539 
	gzi
=
iÂ
->
öfo
;

540 
	gúdp
=&
zi
->
údp
;

543 if–
	gúdp
->
	gMöAdvîtI¡îvÆ
 <(Ë
©oi
(
¨gv
[0]) ) {

544 
údp
->
MaxAdvîtI¡îvÆ
 = 
©oi
(
¨gv
[0]);

546  
	gCMD_SUCCESS
;

549 
vty_out
 (
vty
, "ICMP warning maxadvertinterval is greater orÉqualÅhan minadvertinterval%s",

550 
VTY_NEWLINE
);

552 
vty_out
 (
vty
, "Please correct!%s",

553 
VTY_NEWLINE
);

554  
	gCMD_WARNING
;

562 
DEFUN
 (
ù_údp_¥e„ªn˚
,

563 
ù_údp_¥e„ªn˚_cmd
,

565 
IP_STR


570 
öãrÁ˚
 *
	giÂ
;

571 
zebø_if
 *
	gzi
;

572 
údp_öãrÁ˚
 *
	gúdp
;

573 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

574 if(!
	giÂ
) {

575  
	gCMD_WARNING
;

578 
	gzi
=
iÂ
->
öfo
;

579 
	gúdp
=&
zi
->
údp
;

581 
	gúdp
->
	gPª„ªn˚
 = 
©oi
(
¨gv
[0]);

582  
	gCMD_SUCCESS
;

585 
DEFUN
 (
ù_údp_addªss_¥e„ªn˚
,

586 
ù_údp_addªss_¥e„ªn˚_cmd
,

588 
IP_STR


594 
li°node
 *
	gnode
;

595 
ö_addr
 
	gù
;

596 
	g¥ef
;

597 
	gªt
;

598 
öãrÁ˚
 *
	giÂ
;

599 
zebø_if
 *
	gzi
;

600 
údp_öãrÁ˚
 *
	gúdp
;

601 
Adv
 *
	gadv
;

603 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

604 if(!
	giÂ
) {

605  
	gCMD_WARNING
;

608 
	gzi
=
iÂ
->
öfo
;

609 
	gúdp
=&
zi
->
údp
;

611 
	gªt
 = 
öë_©⁄
(
¨gv
[0], &
ù
);

612 if(!
	gªt
Ë 
	gCMD_WARNING
;

614 
	g¥ef
 = 
©oi
(
¨gv
[1]);

616 
ALL_LIST_ELEMENTS_RO
 (
údp
->
AdvPªfLi°
, 
node
, 
adv
))

617 if(
	gadv
->
	gù
.
	gs_addr
 =
ù
.
s_addr
)

618  
CMD_SUCCESS
;

620 
	gadv
 = 
Adv_√w
();

621 
	gadv
->
	gù
 = 
ù
;

622 
	gadv
->
	g¥ef
 = 
¥ef
;

623 
li°node_add
(
údp
->
AdvPªfLi°
, 
adv
);

625  
	gCMD_SUCCESS
;

629 
DEFUN
 (
no_ù_údp_addªss_¥e„ªn˚
,

630 
no_ù_údp_addªss_¥e„ªn˚_cmd
,

632 
NO_STR


633 
IP_STR


639 
li°node
 *
	gnode
, *
	g¬ode
;

640 
ö_addr
 
	gù
;

641 
	g¥ef
;

642 
	gªt
;

643 
öãrÁ˚
 *
	giÂ
;

644 
zebø_if
 *
	gzi
;

645 
údp_öãrÁ˚
 *
	gúdp
;

646 
Adv
 *
	gadv
;

648 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

649 if(!
	giÂ
) {

650  
	gCMD_WARNING
;

653 
	gzi
=
iÂ
->
öfo
;

654 
	gúdp
=&
zi
->
údp
;

656 
	gªt
 = 
öë_©⁄
(
¨gv
[0], &
ù
);

657 i‡(!
	gªt
)

658  
	gCMD_WARNING
;

660 
	g¥ef
 = 
©oi
(
¨gv
[1]);

662 
ALL_LIST_ELEMENTS
 (
údp
->
AdvPªfLi°
, 
node
, 
¬ode
, 
adv
))

664 if(
	gadv
->
	gù
.
	gs_addr
 =
ù
.
s_addr
 )

666 
li°node_dñëe
(
údp
->
AdvPªfLi°
, 
adv
);

671  
	gCMD_SUCCESS
;

674 
DEFUN
 (
ù_údp_debug_mesßges
,

675 
ù_údp_debug_mesßges_cmd
,

677 
IP_STR


680 
öãrÁ˚
 *
	giÂ
;

681 
zebø_if
 *
	gzi
;

682 
údp_öãrÁ˚
 *
	gúdp
;

683 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

684 if(!
	giÂ
) {

685  
	gCMD_WARNING
;

688 
	gzi
=
iÂ
->
öfo
;

689 
	gúdp
=&
zi
->
údp
;

691 
	gúdp
->
	gÊags
 |
IF_DEBUG_MESSAGES
;

693  
	gCMD_SUCCESS
;

696 
DEFUN
 (
ù_údp_debug_misc
,

697 
ù_údp_debug_misc_cmd
,

699 
IP_STR


702 
öãrÁ˚
 *
	giÂ
;

703 
zebø_if
 *
	gzi
;

704 
údp_öãrÁ˚
 *
	gúdp
;

705 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

706 if(!
	giÂ
) {

707  
	gCMD_WARNING
;

710 
	gzi
=
iÂ
->
öfo
;

711 
	gúdp
=&
zi
->
údp
;

713 
	gúdp
->
	gÊags
 |
IF_DEBUG_MISC
;

715  
	gCMD_SUCCESS
;

718 
DEFUN
 (
ù_údp_debug_∑ckë
,

719 
ù_údp_debug_∑ckë_cmd
,

721 
IP_STR


724 
öãrÁ˚
 *
	giÂ
;

725 
zebø_if
 *
	gzi
;

726 
údp_öãrÁ˚
 *
	gúdp
;

727 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

728 if(!
	giÂ
) {

729  
	gCMD_WARNING
;

732 
	gzi
=
iÂ
->
öfo
;

733 
	gúdp
=&
zi
->
údp
;

735 
	gúdp
->
	gÊags
 |
IF_DEBUG_PACKET
;

737  
	gCMD_SUCCESS
;

741 
DEFUN
 (
ù_údp_debug_dißbÀ
,

742 
ù_údp_debug_dißbÀ_cmd
,

744 
IP_STR


747 
öãrÁ˚
 *
	giÂ
;

748 
zebø_if
 *
	gzi
;

749 
údp_öãrÁ˚
 *
	gúdp
;

750 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

751 if(!
	giÂ
) {

752  
	gCMD_WARNING
;

755 
	gzi
=
iÂ
->
öfo
;

756 
	gúdp
=&
zi
->
údp
;

758 
	gúdp
->
	gÊags
 &~
IF_DEBUG_PACKET
;

759 
	gúdp
->
	gÊags
 &~
IF_DEBUG_MESSAGES
;

760 
	gúdp
->
	gÊags
 &~
IF_DEBUG_MISC
;

762  
	gCMD_SUCCESS
;

766 
	$údp_öô
 ()

768 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_brﬂdˇ°_cmd
);

769 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_mu…iˇ°_cmd
);

770 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ù_údp_cmd
);

771 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_shutdown_cmd
);

772 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ù_údp_shutdown_cmd
);

773 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_hﬁdtime_cmd
);

774 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_maxadvîtöãrvÆ_cmd
);

775 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_möadvîtöãrvÆ_cmd
);

776 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_¥e„ªn˚_cmd
);

777 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_addªss_¥e„ªn˚_cmd
);

778 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ù_údp_addªss_¥e„ªn˚_cmd
);

780 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_debug_mesßges_cmd
);

781 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_debug_misc_cmd
);

782 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_debug_∑ckë_cmd
);

783 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ù_údp_debug_dißbÀ_cmd
);

784 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp_main.c

37 
	~<zebø.h
>

39 #ifde‡
HAVE_IRDP


41 
	~"if.h
"

42 
	~"vty.h
"

43 
	~"sockuni⁄.h
"

44 
	~"sock›t.h
"

45 
	~"¥efix.h
"

46 
	~"comm™d.h
"

47 
	~"mem‹y.h
"

48 
	~"°ªam.h
"

49 
	~"io˘l.h
"

50 
	~"c⁄√˘ed.h
"

51 
	~"log.h
"

52 
	~"z˛õ¡.h
"

53 
	~"thªad.h
"

54 
	~"¥ivs.h
"

55 
	~"zebø/öãrÁ˚.h
"

56 
	~"zebø/πadv.h
"

57 
	~"zebø/rib.h
"

58 
	~"zebø/z£rv.h
"

59 
	~"zebø/ªdi°ribuã.h
"

60 
	~"zebø/údp.h
"

61 
	~<√töë/ù_icmp.h
>

63 
	~"checksum.h
"

64 
	~"if.h
"

65 
	~"sockuni⁄.h
"

66 
	~"log.h
"

70 
zebø_¥ivs_t
 
z£rv_¥ivs
;

73 
zebø_t
 
zebød
;

74 
thªad
 *
	gt_údp_øw
;

77 
	gúdp_timî_öãrvÆ
 = 
IRDP_DEFAULT_INTERVAL
;

80 
	$údp_sock_öô
 ()

82 
ªt
, 
i
;

83 
ßve_î∫o
;

84 
sock
;

86 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
) )

87 
	`zlog_îr
 ("irdp_sock_init: couldÇotÑaiseÖrivs, %s",

88 
	`ß„_°ªº‹
 (
î∫o
) );

90 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_RAW
, 
IPPROTO_ICMP
);

91 
ßve_î∫o
 = 
î∫o
;

93 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

94 
	`zlog_îr
 ("irdp_sock_init: couldÇotÜowerÖrivs, %s",

95 
	`ß„_°ªº‹
 (
î∫o
) );

97 i‡(
sock
 < 0) {

98 
	`zlog_w¨n
 ("IRDP: c™'à¸óã ird∞sockë %s", 
	`ß„_°ªº‹
(
ßve_î∫o
));

99  
sock
;

102 
i
 = 1;

103 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IP
, 
IP_TTL
,

104 (*Ë&
i
,  (i));

105 i‡(
ªt
 < 0) {

106 
	`zlog_w¨n
 ("IRDP: c™'àdÿúd∞sock›à%s", 
	`ß„_°ªº‹
(
î∫o
));

107 
	`˛o£
(
sock
);

108  
ªt
;

111 
ªt
 = 
	`£tsock›t_ifödex
 (
AF_INET
, 
sock
, 1);

112 i‡(
ªt
 < 0) {

113 
	`zlog_w¨n
 ("IRDP: c™'àdÿúd∞sock›à%s", 
	`ß„_°ªº‹
(
î∫o
));

114 
	`˛o£
(
sock
);

115  
ªt
;

118 
t_údp_øw
 = 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
údp_ªad_øw
, 
NULL
, 
sock
);

120  
sock
;

121 
	}
}

125 
	$gë_¥ef
(
údp_öãrÁ˚
 *
údp
, 
¥efix
 *
p
)

127 
li°node
 *
node
;

128 
Adv
 *
adv
;

132 if–
údp
->
AdvPªfLi°
 =
NULL
 )

133  
údp
->
Pª„ªn˚
;

135 
	`ALL_LIST_ELEMENTS_RO
 (
údp
->
AdvPªfLi°
, 
node
, 
adv
))

136 if–
p
->
u
.
¥efix4
.
s_addr
 =
adv
->
ù
.s_addr )

137  
adv
->
¥ef
;

139  
údp
->
Pª„ªn˚
;

140 
	}
}

144 
	$make_advîti£mít_∑ckë
 (
öãrÁ˚
 *
iÂ
,

145 
¥efix
 *
p
,

146 
°ªam
 *
s
)

148 
zebø_if
 *
zi
=
iÂ
->
öfo
;

149 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

150 
size
;

151 
¥ef
;

152 
u_öt16_t
 
checksum
;

154 
¥ef
 = 
	`gë_¥ef
(
údp
, 
p
);

156 
	`°ªam_putc
 (
s
, 
ICMP_ROUTERADVERT
);

157 
	`°ªam_putc
 (
s
, 0);

158 
	`°ªam_putw
 (
s
, 0);

159 
	`°ªam_putc
 (
s
, 1);

160 
	`°ªam_putc
 (
s
, 2);

162 if(
údp
->
Êags
 & 
IF_SHUTDOWN
)

163 
	`°ªam_putw
 (
s
, 0);

165 
	`°ªam_putw
 (
s
, 
údp
->
Li„time
);

167 
	`°ªam_pué
 (
s
, 
	`ht⁄l
(
p
->
u
.
¥efix4
.
s_addr
));

168 
	`°ªam_pué
 (
s
, 
¥ef
);

171 
size
 = 16;

172 
checksum
 = 
	`ö_cksum
 (
s
->
d©a
, 
size
);

173 
	`°ªam_putw_©
 (
s
, 2, 
	`ht⁄s
(
checksum
));

175  
size
;

176 
	}
}

179 
	$údp_£nd
(
öãrÁ˚
 *
iÂ
, 
¥efix
 *
p
, 
°ªam
 *
s
)

181 
zebø_if
 *
zi
=
iÂ
->
öfo
;

182 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

183 
u_öt32_t
 
d°
;

184 
u_öt32_t
 
âl
=1;

186 i‡(! (
iÂ
->
Êags
 & 
IFF_UP
)) ;

188 i‡(
údp
->
Êags
 & 
IF_BROADCAST
)

189 
d°
 =
INADDR_BROADCAST
 ;

191 
d°
 = 
	`ht⁄l
(
INADDR_ALLHOSTS_GROUP
);

193 if(
údp
->
Êags
 & 
IF_DEBUG_MESSAGES
)

194 
	`zlog_debug
("IRDP: TX Advert on %s %s/%d Holdtime=%d Preference=%d",

195 
iÂ
->
«me
,

196 
	`öë_¡ﬂ
(
p
->
u
.
¥efix4
),

197 
p
->
¥efixÀn
,

198 
údp
->
Êags
 & 
IF_SHUTDOWN
? 0 : irdp->
Li„time
,

199 
	`gë_¥ef
(
údp
, 
p
));

201 
	`£nd_∑ckë
 (
iÂ
, 
s
, 
d°
, 
p
, 
âl
);

202 
	}
}

204 
	$údp_advîti£mít
 (
öãrÁ˚
 *
iÂ
, 
¥efix
 *
p
)

206 
°ªam
 *
s
;

207 
s
 = 
	`°ªam_√w
 (128);

208 
	`make_advîti£mít_∑ckë
 (
iÂ
, 
p
, 
s
);

209 
	`údp_£nd
(
iÂ
, 
p
, 
s
);

210 
	`°ªam_‰ì
 (
s
);

211 
	}
}

213 
	$údp_£nd_thªad
(
thªad
 *
t_advît
)

215 
u_öt32_t
 
timî
, 
tmp
;

216 
öãrÁ˚
 *
iÂ
 = 
	`THREAD_ARG
 (
t_advît
);

217 
zebø_if
 *
zi
=
iÂ
->
öfo
;

218 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

219 
¥efix
 *
p
;

220 
li°node
 *
node
, *
¬ode
;

221 
c⁄√˘ed
 *
ifc
;

223 
údp
->
Êags
 &~
IF_SOLICIT
;

225 if(
iÂ
->
c⁄√˘ed
)

226 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
node
, 
¬ode
, 
ifc
))

228 
p
 = 
ifc
->
addªss
;

230 i‡(
p
->
Ámûy
 !
AF_INET
)

233 
	`údp_advîti£mít
(
iÂ
, 
p
);

234 
údp
->
údp_£¡
++;

237 
tmp
 = 
údp
->
MaxAdvîtI¡îvÆ
-údp->
MöAdvîtI¡îvÆ
;

238 
timî
 = (
	`øndom
 (Ë% 
tmp
 ) + 1;

239 
timî
 = 
údp
->
MöAdvîtI¡îvÆ
 +Åimer;

241 if(
údp
->
údp_£¡
 < 
MAX_INITIAL_ADVERTISEMENTS
 &&

242 
timî
 > 
MAX_INITIAL_ADVERT_INTERVAL
 )

243 
timî

MAX_INITIAL_ADVERT_INTERVAL
;

245 if(
údp
->
Êags
 & 
IF_DEBUG_MISC
)

246 
	`zlog_debug
("IRDP: NewÅimî f‹ %†£àtÿ%u\n", 
iÂ
->
«me
, 
timî
);

248 
údp
->
t_advîti£
 = 
	`thªad_add_timî
(
zebød
.
ma°î
, 
údp_£nd_thªad
, 
iÂ
, 
timî
);

250 
	}
}

252 
	$údp_advît_off
(
öãrÁ˚
 *
iÂ
)

254 
zebø_if
 *
zi
=
iÂ
->
öfo
;

255 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

256 
li°node
 *
node
, *
¬ode
;

257 
i
;

258 
c⁄√˘ed
 *
ifc
;

259 
¥efix
 *
p
;

261 if(
údp
->
t_advîti£
Ë
	`thªad_ˇn˚l
(irdp->t_advertise);

262 
údp
->
t_advîti£
 = 
NULL
;

264 if(
iÂ
->
c⁄√˘ed
)

265 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
node
, 
¬ode
, 
ifc
))

267 
p
 = 
ifc
->
addªss
;

273 
i
=0; i< 
IRDP_LAST_ADVERT_MESSAGES
; i++)

275 
údp
->
údp_£¡
++;

276 
	`údp_advîti£mít
(
iÂ
, 
p
);

279 
	}
}

282 
	$¥o˚ss_sﬁicô
 (
öãrÁ˚
 *
iÂ
)

284 
zebø_if
 *
zi
=
iÂ
->
öfo
;

285 
údp_öãrÁ˚
 *
údp
=&
zi
->irdp;

286 
u_öt32_t
 
timî
;

292 if–
údp
->
Êags
 & 
IF_SOLICIT
) ;

294 
údp
->
Êags
 |
IF_SOLICIT
;

295 if(
údp
->
t_advîti£
Ë
	`thªad_ˇn˚l
(irdp->t_advertise);

296 
údp
->
t_advîti£
 = 
NULL
;

298 
timî
 = (
	`øndom
 (Ë% 
MAX_RESPONSE_DELAY
) + 1;

300 
údp
->
t_advîti£
 = 
	`thªad_add_timî
(
zebød
.
ma°î
,

301 
údp_£nd_thªad
,

302 
iÂ
,

303 
timî
);

304 
	}
}

306 
	$údp_föish
()

309 
li°node
 *
node
, *
¬ode
;

310 
öãrÁ˚
 *
iÂ
;

311 
zebø_if
 *
zi
;

312 
údp_öãrÁ˚
 *
údp
;

314 
	`zlog_öfo
("IRDP: Received shutdownÇotification.");

316 
	`ALL_LIST_ELEMENTS
 (
iÊi°
, 
node
, 
¬ode
, 
iÂ
))

318 
zi
 = 
iÂ
->
öfo
;

320 i‡(!
zi
)

322 
údp
 = &
zi
->irdp;

323 i‡(!
údp
)

326 i‡(
údp
->
Êags
 & 
IF_ACTIVE
 )

328 
údp
->
Êags
 |
IF_SHUTDOWN
;

329 
	`údp_advît_off
(
iÂ
);

332 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp_packet.c

37 
	~<zebø.h
>

40 #ifde‡
HAVE_IRDP


42 
	~"if.h
"

43 
	~"vty.h
"

44 
	~"sockuni⁄.h
"

45 
	~"¥efix.h
"

46 
	~"comm™d.h
"

47 
	~"mem‹y.h
"

48 
	~"°ªam.h
"

49 
	~"io˘l.h
"

50 
	~"c⁄√˘ed.h
"

51 
	~"log.h
"

52 
	~"z˛õ¡.h
"

53 
	~"thªad.h
"

54 
	~"zebø/öãrÁ˚.h
"

55 
	~"zebø/πadv.h
"

56 
	~"zebø/rib.h
"

57 
	~"zebø/z£rv.h
"

58 
	~"zebø/ªdi°ribuã.h
"

59 
	~"zebø/údp.h
"

60 
	~<√töë/ù_icmp.h
>

61 
	~"if.h
"

62 
	~"checksum.h
"

63 
	~"sockuni⁄.h
"

64 
	~"log.h
"

65 
	~"sock›t.h
"

70 
	gúdp_sock
 = -1;

72 
zebø_t
 
zebød
;

73 
thªad
 *
t_údp_øw
;

76 
	$∑r£_údp_∑ckë
(*
p
,

77 
Àn
,

78 
öãrÁ˚
 *
iÂ
)

80 
ù
 *ù = (ù *)
p
 ;

81 
icmphdr
 *
icmp
;

82 
ö_addr
 
§c
;

83 
ù_hÀn
, 
ùÀn
, 
d©Æí
;

84 
zebø_if
 *
zi
;

85 
údp_öãrÁ˚
 *
údp
;

87 
zi
 = 
iÂ
->
öfo
;

88 i‡(!
zi
)

91 
údp
 = &
zi
->irdp;

92 i‡(!
údp
)

95 
ù_hÀn
 = 
ù
->
ù_hl
 << 2;

97 
	`sock›t_ùhdrö˛_swab_sy°oh
 (
ù
);

99 
ùÀn
 = 
ù
->
ù_Àn
;

100 
d©Æí
 = 
Àn
 - 
ù_hÀn
;

101 
§c
 = 
ù
->
ù_§c
;

103 i‡(
Àn
 !
ùÀn
)

105 
	`zlog_îr
 ("IRDP: RXÜength doesnt match IPÜength");

109 i‡(
ùÀn
 < 
ICMP_MINLEN
)

111 
	`zlog_îr
 ("IRDP: RX ICMPÖacketÅoo short from %s\n",

112 
	`öë_¡ﬂ
 (
§c
));

119 i‡(
ùÀn
 > 
IRDP_RX_BUF
-34)

121 
	`zlog_îr
 ("IRDP: RX ICMPÖacketÅooÜong from %s\n",

122 
	`öë_¡ﬂ
 (
§c
));

126 
icmp
 = (
icmphdr
 *Ë(
p
+
ù_hÀn
);

129 i‡(
	`ö_cksum
 (
icmp
, 
d©Æí
Ë!icmp->
checksum
)

131 
	`zlog_w¨n
 ("IRDP: RX ICMPÖacket from %s. Bad checksum, silently ignored",

132 
	`öë_¡ﬂ
 (
§c
));

137 i‡(!(
icmp
->
ty≥
 =
ICMP_ROUTERADVERT


138 || 
icmp
->
ty≥
 =
ICMP_ROUTERSOLICIT
))

141 i‡(
icmp
->
code
 != 0)

143 
	`zlog_w¨n
 ("IRDP: RXÖacketÅype %d from %s. Bad ICMPÅype code,"

145 
icmp
->
ty≥
, 
	`öë_¡ﬂ
 (
§c
));

149 i‡(! ((
	`¡ohl
 (
ù
->
ù_d°
.
s_addr
Ë=
INADDR_BROADCAST
)

150 && (
údp
->
Êags
 & 
IF_BROADCAST
))

152 (
	`¡ohl
 (
ù
->
ù_d°
.
s_addr
Ë=
INADDR_ALLRTRS_GROUP


153 && !(
údp
->
Êags
 & 
IF_BROADCAST
)))

155 
	`zlog_w¨n
 ("IRDP: RX illegal from %sÅo %s while %s operates in %s\n",

156 
	`öë_¡ﬂ
 (
§c
),

157 
	`¡ohl
 (
ù
->
ù_d°
.
s_addr
Ë=
INADDR_ALLRTRS_GROUP
 ?

158 "mu…iˇ°" : 
	`öë_¡ﬂ
 (
ù
->
ù_d°
),

159 
iÂ
->
«me
,

160 
údp
->
Êags
 & 
IF_BROADCAST
 ? "broadcast" : "multicast");

162 
	`zlog_w¨n
 ("IRDP: Please correct settings\n");

166 
icmp
->
ty≥
)

168 
ICMP_ROUTERADVERT
:

171 
ICMP_ROUTERSOLICIT
:

173 if(
údp
->
Êags
 & 
IF_DEBUG_MESSAGES
)

174 
	`zlog_debug
 ("IRDP: RX Solicit on %s from %s\n",

175 
iÂ
->
«me
,

176 
	`öë_¡ﬂ
 (
§c
));

178 
	`¥o˚ss_sﬁicô
(
iÂ
);

182 
	`zlog_w¨n
 ("IRDP: RXÅype %d from %s. Bad ICMPÅype, silently ignored",

183 
icmp
->
ty≥
,

184 
	`öë_¡ﬂ
 (
§c
));

186 
	}
}

189 
	$údp_ªcvmsg
 (
sock
, 
u_ch¨
 *
buf
, 
size
, *
ifödex
)

191 
msghdr
 
msg
;

192 
iovec
 
iov
;

193 
ad©a
[
	`CMSG_SPACE
–
	`SOPT_SIZE_CMSG_PKTINFO_IPV4
() )];

194 
ªt
;

196 
msg
.
msg_«me
 = (*)0;

197 
msg
.
msg_«mñí
 = 0;

198 
msg
.
msg_iov
 = &
iov
;

199 
msg
.
msg_iovÀn
 = 1;

200 
msg
.
msg_c⁄åﬁ
 = (*Ë
ad©a
;

201 
msg
.
msg_c⁄åﬁÀn
 =  
ad©a
;

203 
iov
.
iov_ba£
 = 
buf
;

204 
iov
.
iov_Àn
 = 
size
;

206 
ªt
 = 
	`ªcvmsg
 (
sock
, &
msg
, 0);

207 i‡(
ªt
 < 0) {

208 
	`zlog_w¨n
("IRDP:Ñecvmsg:ÑódÉº‹ %s", 
	`ß„_°ªº‹
(
î∫o
));

209  
ªt
;

212 i‡(
msg
.
msg_Êags
 & 
MSG_TRUNC
) {

213 
	`zlog_w¨n
("IRDP:Ñecvmsg:Åruncated message");

214  
ªt
;

216 i‡(
msg
.
msg_Êags
 & 
MSG_CTRUNC
) {

217 
	`zlog_w¨n
("IRDP:Ñecvmsg:Åruncated control message");

218  
ªt
;

221 *
ifödex
 = 
	`gësock›t_ifödex
 (
AF_INET
, &
msg
);

223  
ªt
;

224 
	}
}

226 
	$údp_ªad_øw
(
thªad
 *
r
)

228 
öãrÁ˚
 *
iÂ
;

229 
zebø_if
 *
zi
;

230 
údp_öãrÁ˚
 *
údp
;

231 
buf
[
IRDP_RX_BUF
];

232 
ªt
, 
ifödex
 = 0;

234 
údp_sock
 = 
	`THREAD_FD
 (
r
);

235 
t_údp_øw
 = 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
údp_ªad_øw
, 
NULL
, 
údp_sock
);

237 
ªt
 = 
	`údp_ªcvmsg
 (
údp_sock
, (
u_ch¨
 *Ë
buf
, 
IRDP_RX_BUF
, &
ifödex
);

239 i‡(
ªt
 < 0Ë
	`zlog_w¨n
 ("IRDP: RX ErrorÜength = %d",Ñet);

241 
iÂ
 = 
	`if_lookup_by_ödex
(
ifödex
);

242 if(! 
iÂ
 )  
ªt
;

244 
zi

iÂ
->
öfo
;

245 if(! 
zi
 )  
ªt
;

247 
údp
 = &
zi
->irdp;

248 if(! 
údp
 )  
ªt
;

250 if(! (
údp
->
Êags
 & 
IF_ACTIVE
)) {

252 if(
údp
->
Êags
 & 
IF_DEBUG_MISC
)

253 
	`zlog_debug
("IRDP: RX ICMP f‹ dißbÀd i¡îÁ˚ %s\n", 
iÂ
->
«me
);

257 if(
údp
->
Êags
 & 
IF_DEBUG_PACKET
) {

258 
i
;

259 
	`zlog_debug
("IRDP: RX (idx %dË", 
ifödex
);

260 
i
=0; i < 
ªt
; i++Ë
	`zlog_debug
–"IRDP: RX %x ", 
buf
[i]&0xFF);

263 
	`∑r£_údp_∑ckë
(
buf
, 
ªt
, 
iÂ
);

265  
ªt
;

266 
	}
}

269 
	$£nd_∑ckë
(
öãrÁ˚
 *
iÂ
,

270 
°ªam
 *
s
,

271 
u_öt32_t
 
d°
,

272 
¥efix
 *
p
,

273 
u_öt32_t
 
âl
)

275 
sockaddr_ö
 
sockd°
 = {
AF_INET
};

276 
ù
 *ip;

277 
icmphdr
 *
icmp
;

278 
msghdr
 *
msg
;

279 
cmsghdr
 *
cmsg
;

280 
iovec
 
iove˘‹
;

281 
msgbuf
[256];

282 
buf
[256];

283 
ö_pktöfo
 *
pktöfo
;

284 
u_l⁄g
 
§c
;

285 
⁄
;

287 i‡(!(
iÂ
->
Êags
 & 
IFF_UP
))

290 i‡(!
p
)

291 
§c
 = 
	`¡ohl
(
p
->
u
.
¥efix4
.
s_addr
);

293 
§c
 = 0;

295 
ù
 = (ù *Ë
buf
;

296 
ù
->
ù_hl
 = (ip) >> 2;

297 
ù
->
ù_v
 = 
IPVERSION
;

298 
ù
->
ù_tos
 = 0xC0;

299 
ù
->
ù_off
 = 0L;

300 
ù
->
ù_p
 = 1;

301 
ù
->
ù_âl
 = 
âl
;

302 
ù
->
ù_§c
.
s_addr
 = 
§c
;

303 
ù
->
ù_d°
.
s_addr
 = 
d°
;

304 
icmp
 = (
icmphdr
 *Ë(
buf
 +  (
ù
));

307 
	`as£π
 (
	`°ªam_gë_ídp
(
s
Ë< ( (
buf
Ë-  (
ù
)));

308 
	`°ªam_gë
(
icmp
, 
s
, 
	`°ªam_gë_ídp
(s));

311 
ù
->
ù_Àn
 = (ùË+ 
	`°ªam_gë_ídp
(
s
);

313 
⁄
 = 1;

314 i‡(
	`£tsock›t
(
údp_sock
, 
IPPROTO_IP
, 
IP_HDRINCL
,

315 (*Ë&
⁄
, (on)) < 0)

316 
	`zlog_w¨n
("£ndtÿ%s", 
	`ß„_°ªº‹
 (
î∫o
));

319 if(
d°
 =
INADDR_BROADCAST
 ) {

320 
⁄
 = 1;

321 i‡(
	`£tsock›t
(
údp_sock
, 
SOL_SOCKET
, 
SO_BROADCAST
,

322 (*Ë&
⁄
, (on)) < 0)

323 
	`zlog_w¨n
("£ndtÿ%s", 
	`ß„_°ªº‹
 (
î∫o
));

326 if(
d°
 !
INADDR_BROADCAST
) {

327 
⁄
 = 0;

328 if–
	`£tsock›t
(
údp_sock
,
IPPROTO_IP
, 
IP_MULTICAST_LOOP
,

329 (*)&
⁄
,(on)) < 0)

330 
	`zlog_w¨n
("£ndtÿ%s", 
	`ß„_°ªº‹
 (
î∫o
));

333 
	`mem£t
(&
sockd°
,0,(sockdst));

334 
sockd°
.
sö_Ámûy
=
AF_INET
;

335 
sockd°
.
sö_addr
.
s_addr
 = 
d°
;

337 
cmsg
 = (
cmsghdr
 *Ë(
msgbuf
 + (
msghdr
));

338 
cmsg
->
cmsg_Àn
 = (
cmsghdr
Ë+ (
ö_pktöfo
);

339 
cmsg
->
cmsg_Àvñ
 = 
SOL_IP
;

340 
cmsg
->
cmsg_ty≥
 = 
IP_PKTINFO
;

341 
pktöfo
 = (
ö_pktöfo
 *Ë
	`CMSG_DATA
(
cmsg
);

342 
pktöfo
->
ùi_ifödex
 = 
iÂ
->
ifödex
;

343 
pktöfo
->
ùi_•ec_d°
.
s_addr
 = 
§c
;

344 
pktöfo
->
ùi_addr
.
s_addr
 = 
§c
;

346 
iove˘‹
.
iov_ba£
 = (*Ë
buf
;

347 
iove˘‹
.
iov_Àn
 = 
ù
->
ù_Àn
;

348 
msg
 = (
msghdr
 *Ë
msgbuf
;

349 
msg
->
msg_«me
 = &
sockd°
;

350 
msg
->
msg_«mñí
 = (
sockd°
);

351 
msg
->
msg_iov
 = &
iove˘‹
;

352 
msg
->
msg_iovÀn
 = 1;

353 
msg
->
msg_c⁄åﬁ
 = 
cmsg
;

354 
msg
->
msg_c⁄åﬁÀn
 = 
cmsg
->
cmsg_Àn
;

356 
	`sock›t_ùhdrö˛_swab_htosys
 (
ù
);

358 i‡(
	`£ndmsg
(
údp_sock
, 
msg
, 0) < 0) {

359 
	`zlog_w¨n
("£ndtÿ%s", 
	`ß„_°ªº‹
 (
î∫o
));

362 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_netlink.c

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_null.c

3 
	~<zebø.h
>

4 
	~<log.h
>

6 
	~"zebø/z£rv.h
"

7 
	~"zebø/π.h
"

8 
	~"zebø/ªdi°ribuã.h
"

9 
	~"zebø/c⁄√˘ed.h
"

11 
	$kî√l_add_ùv4
 (
¥efix
 *
a
, 
rib
 *
b
Ë{  0; 
	}
}

12 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


13 #¥agm®
wók
 
kî√l_dñëe_ùv4
 = 
kî√l_add_ùv4


15 
	$kî√l_dñëe_ùv4
 (
¥efix
 *
a
, 
rib
 *
b
Ë{  0; 
	}
}

18 
	$kî√l_add_ùv6
 (
¥efix
 *
a
, 
rib
 *
b
Ë{  0; 
	}
}

19 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


20 #¥agm®
wók
 
kî√l_dñëe_ùv6
 = 
kî√l_add_ùv6


22 
	$kî√l_dñëe_ùv6
 (
¥efix
 *
a
, 
rib
 *
b
Ë{  0; 
	}
}

25 
	$kî√l_dñëe_ùv6_ﬁd
 (
¥efix_ùv6
 *
de°
, 
ö6_addr
 *
g©e
,

26 
ödex
, 
Êags
, 
èbÀ
)

27 {  0; 
	}
}

29 
	$kî√l_add_rouã
 (
¥efix_ùv4
 *
a
, 
ö_addr
 *
b
, 
c
, 
d
)

30 {  0; 
	}
}

32 
	$kî√l_addªss_add_ùv4
 (
öãrÁ˚
 *
a
, 
c⁄√˘ed
 *
b
)

34 
	`zlog_debug
 ("%s", 
__func__
);

35 
	`SET_FLAG
 (
b
->
c⁄f
, 
ZEBRA_IFC_REAL
);

36 
	`c⁄√˘ed_add_ùv4
 (
a
, 0, &
b
->
addªss
->
u
.
¥efix4
, b->addªss->
¥efixÀn
,

37 (
b
->
de°ö©i⁄
 ? &b->de°ö©i⁄->
u
.
¥efix4
 : 
NULL
),

38 
NULL
);

40 
	}
}

42 
	$kî√l_addªss_dñëe_ùv4
 (
öãrÁ˚
 *
a
, 
c⁄√˘ed
 *
b
)

44 
	`zlog_debug
 ("%s", 
__func__
);

45 
	`c⁄√˘ed_dñëe_ùv4
 (
a
, 0, &
b
->
addªss
->
u
.
¥efix4
, b->addªss->
¥efixÀn
,

46 (
b
->
de°ö©i⁄
 ? &b->de°ö©i⁄->
u
.
¥efix4
 : 
NULL
));

48 
	}
}

50 
	$kî√l_öô
 (Ë{ ; 
	}
}

51 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


52 #¥agm®
wók
 
rouã_ªad
 = 
kî√l_öô


54 
	$rouã_ªad
 (Ë{ ; 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_socket.c

22 
	~<zebø.h
>

24 
	~"if.h
"

25 
	~"¥efix.h
"

26 
	~"sockuni⁄.h
"

27 
	~"c⁄√˘ed.h
"

28 
	~"mem‹y.h
"

29 
	~"io˘l.h
"

30 
	~"log.h
"

31 
	~"°r.h
"

32 
	~"èbÀ.h
"

33 
	~"rib.h
"

34 
	~"¥ivs.h
"

36 
	~"zebø/öãrÁ˚.h
"

37 
	~"zebø/z£rv.h
"

38 
	~"zebø/debug.h
"

39 
	~"zebø/kî√l_sockë.h
"

41 
zebø_¥ivs_t
 
z£rv_¥ivs
;

42 
zebø_t
 
zebød
;

53 #ifde‡
__APPLE__


54 
	#ROUNDUP
(
a
) \

55 ((
a
Ë> 0 ? (1 + ((◊Ë- 1Ë| ((Ë- 1))Ë: ())

	)

57 
	#ROUNDUP
(
a
) \

58 ((
a
Ë> 0 ? (1 + ((◊Ë- 1Ë| ((Ë- 1))Ë: ())

	)

65 #i‡
deföed
(
HAVE_STRUCT_SOCKADDR_SA_LEN
)

66 
	#SAROUNDUP
(
X
Ë
	`ROUNDUP
(((
sockaddr
 *)(X))->
ß_Àn
)

	)

67 #ñi‡
deföed
(
HAVE_IPV6
)

72 
	#SAROUNDUP
(
X
) \

73 (((
sockaddr
 *)(
X
))->
ß_Ámûy
 =
AF_INET
 ? \

74 
	`ROUNDUP
((
sockaddr_ö
)):\

75 (((
sockaddr
 *)(
X
))->
ß_Ámûy
 =
AF_INET6
 ? \

76 
	`ROUNDUP
((
sockaddr_ö6
)) : \

77 (((
sockaddr
 *)(
X
))->
ß_Ámûy
 =
AF_LINK
 ? \

78 
	`ROUNDUP
((
sockaddr_dl
)Ë: (
sockaddr
))))

	)

80 
	#SAROUNDUP
(
X
) \

81 (((
sockaddr
 *)(
X
))->
ß_Ámûy
 =
AF_INET
 ? \

82 
	`ROUNDUP
((
sockaddr_ö
)):\

83 (((
sockaddr
 *)(
X
))->
ß_Ámûy
 =
AF_LINK
 ? \

84 
	`ROUNDUP
((
sockaddr_dl
)Ë: (
sockaddr
)))

	)

94 
ölöe


95 
	$πa_c›y
 (
sockuni⁄
 *
de°
, 
ˇddr_t
 
§c
) {

96 
Àn
;

97 #ifde‡
HAVE_STRUCT_SOCKADDR_SA_LEN


98 
Àn
 = (((
sockaddr
 *)
§c
)->
ß_Àn
 >  (*
de°
)) ?

99  (*
de°
Ë: ((
sockaddr
 *)
§c
)->
ß_Àn
 ;

101 
Àn
 = (
	`SAROUNDUP
 (
§c
Ë>  (*
de°
)) ?

102  (*
de°
Ë: 
	`SAROUNDUP
 (
§c
) ;

104 
	`mem˝y
 (
de°
, 
§c
, 
Àn
);

105 
	}
}

107 
	#RTA_ADDR_GET
(
DEST
, 
RTA
, 
RTMADDRS
, 
PNT
) \

108 i‡((
RTMADDRS
Ë& (
RTA
)) \

110 
Àn
 = 
	`SAROUNDUP
 ((
PNT
)); \

111 i‡–((
DEST
Ë!
NULL
) && \

112 
	`af_check
 (((
sockaddr
 *)(
PNT
))->
ß_Ámûy
)) \

113 
	`πa_c›y
((
DEST
), (
PNT
)); \

114 (
PNT
Ë+
Àn
; \

115 }

	)

116 
	#RTA_ATTR_GET
(
DEST
, 
RTA
, 
RTMADDRS
, 
PNT
) \

117 i‡((
RTMADDRS
Ë& (
RTA
)) \

119 
Àn
 = 
	`SAROUNDUP
 ((
PNT
)); \

120 i‡((
DEST
Ë!
NULL
) \

121 
	`πa_c›y
((
DEST
), (
PNT
)); \

122 (
PNT
Ë+
Àn
; \

123 }

	)

125 
	#RTA_NAME_GET
(
DEST
, 
RTA
, 
RTMADDRS
, 
PNT
, 
LEN
) \

126 i‡((
RTMADDRS
Ë& (
RTA
)) \

128 
u_ch¨
 *
pde°
 = (u_ch¨ *Ë(
DEST
); \

129 
Àn
 = 
	`SAROUNDUP
 ((
PNT
)); \

130 
sockaddr_dl
 *
sdl
 = (sockaddr_d»*)(
PNT
); \

131 i‡(
IS_ZEBRA_DEBUG_KERNEL
) \

132 
	`zlog_debug
 ("%s: RTA_SDL_GETÇlen %d,álen %d", \

133 
__func__
, 
sdl
->
sdl_∆í
, sdl->
sdl_Æí
); \

134 i‡–((
DEST
Ë!
NULL
Ë&& (
sdl
->
sdl_Ámûy
 =
AF_LINK
) \

135 && (
sdl
->
sdl_∆í
 < 
IFNAMSIZ
Ë&& (sdl->sdl_∆í <
Àn
) ) \

137 
	`mem˝y
 (
pde°
, 
sdl
->
sdl_d©a
, sdl->
sdl_∆í
); \

138 
pde°
[
sdl
->
sdl_∆í
] = '\0'; \

139 (
LEN
Ë
sdl
->
sdl_∆í
; \

141 (
PNT
Ë+
Àn
; \

145 (
LEN
) = 0; \

146 }

	)

148 c⁄° 
mesßge
 
	gπm_ty≥_°r
[] =

150 {
RTM_ADD
, "RTM_ADD"},

151 {
RTM_DELETE
, "RTM_DELETE"},

152 {
RTM_CHANGE
, "RTM_CHANGE"},

153 {
RTM_GET
, "RTM_GET"},

154 {
RTM_LOSING
, "RTM_LOSING"},

155 {
RTM_REDIRECT
, "RTM_REDIRECT"},

156 {
RTM_MISS
, "RTM_MISS"},

157 {
RTM_LOCK
, "RTM_LOCK"},

158 #ifde‡
OLDADD


159 {
RTM_OLDADD
, "RTM_OLDADD"},

161 #ifde‡
RTM_OLDDEL


162 {
RTM_OLDDEL
, "RTM_OLDDEL"},

164 {
RTM_RESOLVE
, "RTM_RESOLVE"},

165 {
RTM_NEWADDR
, "RTM_NEWADDR"},

166 {
RTM_DELADDR
, "RTM_DELADDR"},

167 {
RTM_IFINFO
, "RTM_IFINFO"},

168 #ifde‡
RTM_OIFINFO


169 {
RTM_OIFINFO
, "RTM_OIFINFO"},

171 #ifde‡
RTM_NEWMADDR


172 {
RTM_NEWMADDR
, "RTM_NEWMADDR"},

174 #ifde‡
RTM_DELMADDR


175 {
RTM_DELMADDR
, "RTM_DELMADDR"},

177 #ifde‡
RTM_IFANNOUNCE


178 {
RTM_IFANNOUNCE
, "RTM_IFANNOUNCE"},

180 {0, 
NULL
}

183 c⁄° 
mesßge
 
	gπm_Êag_°r
[] =

185 {
RTF_UP
, "UP"},

186 {
RTF_GATEWAY
, "GATEWAY"},

187 {
RTF_HOST
, "HOST"},

188 {
RTF_REJECT
, "REJECT"},

189 {
RTF_DYNAMIC
, "DYNAMIC"},

190 {
RTF_MODIFIED
, "MODIFIED"},

191 {
RTF_DONE
, "DONE"},

192 #ifde‡
RTF_MASK


193 {
RTF_MASK
, "MASK"},

195 #ifde‡
RTF_CLONING


196 {
RTF_CLONING
, "CLONING"},

198 {
RTF_XRESOLVE
, "XRESOLVE"},

199 {
RTF_LLINFO
, "LLINFO"},

200 {
RTF_STATIC
, "STATIC"},

201 {
RTF_BLACKHOLE
, "BLACKHOLE"},

202 #ifde‡
RTF_PRIVATE


203 {
RTF_PRIVATE
, "PRIVATE"},

205 {
RTF_PROTO1
, "PROTO1"},

206 {
RTF_PROTO2
, "PROTO2"},

207 #ifde‡
RTF_PRCLONING


208 {
RTF_PRCLONING
, "PRCLONING"},

210 #ifde‡
RTF_WASCLONED


211 {
RTF_WASCLONED
, "WASCLONED"},

213 #ifde‡
RTF_PROTO3


214 {
RTF_PROTO3
, "PROTO3"},

216 #ifde‡
RTF_PINNED


217 {
RTF_PINNED
, "PINNED"},

219 #ifde‡
RTF_LOCAL


220 {
RTF_LOCAL
, "LOCAL"},

222 #ifde‡
RTF_BROADCAST


223 {
RTF_BROADCAST
, "BROADCAST"},

225 #ifde‡
RTF_MULTICAST


226 {
RTF_MULTICAST
, "MULTICAST"},

228 #ifde‡
RTF_MULTIRT


229 {
RTF_MULTIRT
, "MULTIRT"},

231 #ifde‡
RTF_SETSRC


232 {
RTF_SETSRC
, "SETSRC"},

234 {0, 
NULL
}

238 
	groutög_sock
 = -1;

244 
ölöe


245 
	$af_check
 (
Ámûy
)

247 i‡(
Ámûy
 =
AF_INET
)

249 #ifde‡
HAVE_IPV6


250 i‡(
Ámûy
 =
AF_INET6
)

254 
	}
}

258 
	$πm_Êag_dump
 (
Êag
)

260 c⁄° 
mesßge
 *
mes
;

261 
buf
[
BUFSIZ
];

263 
buf
[0] = '\0';

264 
mes
 = 
πm_Êag_°r
; mes->
key
 != 0; mes++)

266 i‡(
mes
->
key
 & 
Êag
)

268 
	`°æˇt
 (
buf
, 
mes
->
°r
, 
BUFSIZ
);

269 
	`°æˇt
 (
buf
, " ", 
BUFSIZ
);

272 
	`zlog_debug
 ("Kî√l: %s", 
buf
);

273 
	}
}

275 #ifde‡
RTM_IFANNOUNCE


278 
	$iÁn_ªad
 (
if_™noun˚msghdr
 *
iÁn
)

280 
öãrÁ˚
 *
iÂ
;

282 
iÂ
 = 
	`if_lookup_by_ödex
 (
iÁn
->
iÁn_ödex
);

284 i‡(
iÂ
)

285 
	`as£π
 ( (
iÂ
->
ifödex
 =
iÁn
->
iÁn_ödex
)

286 || (
iÂ
->
ifödex
 =
IFINDEX_INTERNAL
) );

288 i‡–(
iÂ
 =
NULL
)

289 || ((
iÂ
->
ifödex
 =
IFINDEX_INTERNAL
)

290 && (
iÁn
->
iÁn_wh©
 =
IFAN_ARRIVAL
)) )

292 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

293 
	`zlog_debug
 ("%s: creating interface for ifindex %d,Çame %s",

294 
__func__
, 
iÁn
->
iÁn_ödex
, iÁn->
iÁn_«me
);

297 
iÂ
 = 
	`if_gë_by_«me_Àn
(
iÁn
->
iÁn_«me
,

298 
	`°∫Àn
(
iÁn
->
iÁn_«me
,

299 (
iÁn
->
iÁn_«me
)));

300 
iÂ
->
ifödex
 = 
iÁn
->
iÁn_ödex
;

302 
	`if_add_upd©e
 (
iÂ
);

304 i‡(
iÂ
 !
NULL
 && 
iÁn
->
iÁn_wh©
 =
IFAN_DEPARTURE
)

305 
	`if_dñëe_upd©e
 (
iÂ
);

307 
	`if_gë_Êags
 (
iÂ
);

308 
	`if_gë_mtu
 (
iÂ
);

309 
	`if_gë_mëric
 (
iÂ
);

311 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

312 
	`zlog_debug
 ("%s: interface %s index %d",

313 
__func__
, 
iÁn
->
iÁn_«me
, iÁn->
iÁn_ödex
);

316 
	}
}

319 #ifde‡
HAVE_BSD_IFI_LINK_STATE


322 
	$bsd_lökdëe˘_å™¶©e
 (
if_msghdr
 *
ifm
)

324 i‡((
ifm
->
ifm_d©a
.
ifi_lök_°©e
 >
LINK_STATE_UP
) ||

325 (
ifm
->
ifm_d©a
.
ifi_lök_°©e
 =
LINK_STATE_UNKNOWN
))

326 
	`SET_FLAG
(
ifm
->
ifm_Êags
, 
IFF_RUNNING
);

328 
	`UNSET_FLAG
(
ifm
->
ifm_Êags
, 
IFF_RUNNING
);

329 
	}
}

338 
	$ifm_ªad
 (
if_msghdr
 *
ifm
)

340 
öãrÁ˚
 *
iÂ
 = 
NULL
;

341 
sockaddr_dl
 *
sdl
;

342 
i‚ame
[
IFNAMSIZ
];

343 
i‚Àn
 = 0;

344 
ˇddr_t
 
˝
;

347 
i‚ame
[
IFNAMSIZ
 - 1] = '\0';

350 i‡(
ifm
->
ifm_msgÀn
 < (
if_msghdr
))

352 
	`zlog_îr
 ("ifm_read: ifm->ifm_msglen %dÅoo short\n",

353 
ifm
->
ifm_msgÀn
);

361 
˝
 = (*)(
ifm
 + 1);

363 #ifde‡
SUNOS_5


371 i‡(((
sockaddr
 *Ë
˝
)->
ß_Ámûy
 =
AF_UNSPEC
)

372 
˝
 = cp + 12;

375 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_DST
, 
ifm
->
ifm_addrs
, 
˝
);

376 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_GATEWAY
, 
ifm
->
ifm_addrs
, 
˝
);

377 
	`RTA_ATTR_GET
 (
NULL
, 
RTA_NETMASK
, 
ifm
->
ifm_addrs
, 
˝
);

378 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_GENMASK
, 
ifm
->
ifm_addrs
, 
˝
);

379 
sdl
 = (
sockaddr_dl
 *)
˝
;

380 
	`RTA_NAME_GET
 (
i‚ame
, 
RTA_IFP
, 
ifm
->
ifm_addrs
, 
˝
, 
i‚Àn
);

381 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_IFA
, 
ifm
->
ifm_addrs
, 
˝
);

382 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_AUTHOR
, 
ifm
->
ifm_addrs
, 
˝
);

383 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_BRD
, 
ifm
->
ifm_addrs
, 
˝
);

385 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

386 
	`zlog_debug
 ("%s: sd»i‚amê%s", 
__func__
, (
i‚Àn
 ? 
i‚ame
 : "(nil)"));

394 i‡–(
iÂ
 = 
	`if_lookup_by_ödex
 (
ifm
->
ifm_ödex
)Ë!
NULL
 )

401 i‡(
i‚Àn
 && (
	`°∫cmp
 (
iÂ
->
«me
, 
i‚ame
, 
IFNAMSIZ
) != 0) )

403 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

404 
	`zlog_debug
 ("%s: ifpÇame %s doesnt match sdlÇame %s",

405 
__func__
, 
iÂ
->
«me
, 
i‚ame
);

406 
iÂ
 = 
NULL
;

420 i‡–(
iÂ
 =
NULL
Ë&& 
i‚Àn
)

421 
iÂ
 = 
	`if_lookup_by_«me
 (
i‚ame
);

427 i‡((
iÂ
 =
NULL
Ë|| (iÂ->
ifödex
 =
IFINDEX_INTERNAL
))

433 i‡(!
i‚Àn
)

435 
	`zlog_w¨n
 ("Interface index %d (new) missing ifname\n",

436 
ifm
->
ifm_ödex
);

440 #i‚de‡
RTM_IFANNOUNCE


444 i‡(!
	`CHECK_FLAG
 (
ifm
->
ifm_Êags
, 
IFF_UP
))

448 i‡(
iÂ
 =
NULL
)

451 
iÂ
 = 
	`if_¸óã
 (
i‚ame
, 
i‚Àn
);

452 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

453 
	`zlog_debug
 ("%s: creating ifp for ifindex %d",

454 
__func__
, 
ifm
->
ifm_ödex
);

457 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

458 
	`zlog_debug
 ("%s: updated/created ifp, ifname %s, ifindex %d",

459 
__func__
, 
iÂ
->
«me
, iÂ->
ifödex
);

464 
iÂ
->
ifödex
 = 
ifm
->
ifm_ödex
;

466 #ifde‡
HAVE_BSD_IFI_LINK_STATE


467 
	`bsd_lökdëe˘_å™¶©e
(
ifm
);

470 
	`if_Êags_upd©e
 (
iÂ
, 
ifm
->
ifm_Êags
);

471 #i‡
	`deföed
(
__bsdi__
)

472 
	`if_kvm_gë_mtu
 (
iÂ
);

474 
	`if_gë_mtu
 (
iÂ
);

476 
	`if_gë_mëric
 (
iÂ
);

488 i‡(
i‚Àn
)

490 #ifde‡
HAVE_STRUCT_SOCKADDR_DL_SDL_LEN


491 
	`mem˝y
 (&
iÂ
->
sdl
, sdl, sdl->
sdl_Àn
);

493 
	`mem˝y
 (&
iÂ
->
sdl
, sdl,  (
sockaddr_dl
));

497 
	`if_add_upd©e
 (
iÂ
);

508 i‡(
iÂ
->
ifödex
 !
ifm
->
ifm_ödex
)

510 
	`zlog_w¨n
 ("%s: index mismatch, ifname %s, ifp index %d, "

512 
__func__
, 
iÂ
->
«me
, iÂ->
ifödex
, 
ifm
->
ifm_ödex
);

516 #ifde‡
HAVE_BSD_IFI_LINK_STATE


517 
	`bsd_lökdëe˘_å™¶©e
(
ifm
);

521 
	`if_Êags_upd©e
 (
iÂ
, 
ifm
->
ifm_Êags
);

523 #i‚de‡
RTM_IFANNOUNCE


524 i‡(!
	`if_is_up
 (
iÂ
))

535 
	`if_dñëe_upd©e
 (
iÂ
);

538 i‡(
	`if_is_up
 (
iÂ
))

540 #i‡
	`deföed
(
__bsdi__
)

541 
	`if_kvm_gë_mtu
 (
iÂ
);

543 
	`if_gë_mtu
 (
iÂ
);

545 
	`if_gë_mëric
 (
iÂ
);

549 #ifde‡
HAVE_NET_RT_IFLIST


550 
iÂ
->
°©s
 = 
ifm
->
ifm_d©a
;

553 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

554 
	`zlog_debug
 ("%s: interface %s index %d",

555 
__func__
, 
iÂ
->
«me
, iÂ->
ifödex
);

558 
	}
}

562 
	$iÁm_ªad_mesg
 (
iÁ_msghdr
 *
ifm
,

563 
sockuni⁄
 *
addr
,

564 
sockuni⁄
 *
mask
,

565 
sockuni⁄
 *
brd
,

566 *
i‚ame
,

567 *
i‚Àn
)

569 
ˇddr_t
 
≤t
, 
íd
;

570 
sockuni⁄
 
d°
;

571 
sockuni⁄
 
g©eway
;

573 
≤t
 = (
ˇddr_t
)(
ifm
 + 1);

574 
íd
 = ((
ˇddr_t
)
ifm
Ë+ ifm->
iÁm_msgÀn
;

577 
	`mem£t
 (
mask
, 0,  (
sockuni⁄
));

578 
	`mem£t
 (
addr
, 0,  (
sockuni⁄
));

579 
	`mem£t
 (
brd
, 0,  (
sockuni⁄
));

580 
	`mem£t
 (&
d°
, 0,  (
sockuni⁄
));

581 
	`mem£t
 (&
g©eway
, 0,  (
sockuni⁄
));

584 
	`RTA_ADDR_GET
 (&
d°
, 
RTA_DST
, 
ifm
->
iÁm_addrs
, 
≤t
);

585 
	`RTA_ADDR_GET
 (&
g©eway
, 
RTA_GATEWAY
, 
ifm
->
iÁm_addrs
, 
≤t
);

586 
	`RTA_ATTR_GET
 (
mask
, 
RTA_NETMASK
, 
ifm
->
iÁm_addrs
, 
≤t
);

587 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_GENMASK
, 
ifm
->
iÁm_addrs
, 
≤t
);

588 
	`RTA_NAME_GET
 (
i‚ame
, 
RTA_IFP
, 
ifm
->
iÁm_addrs
, 
≤t
, *
i‚Àn
);

589 
	`RTA_ADDR_GET
 (
addr
, 
RTA_IFA
, 
ifm
->
iÁm_addrs
, 
≤t
);

590 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_AUTHOR
, 
ifm
->
iÁm_addrs
, 
≤t
);

591 
	`RTA_ADDR_GET
 (
brd
, 
RTA_BRD
, 
ifm
->
iÁm_addrs
, 
≤t
);

593 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

595 
	`sockuni⁄_Ámûy
(
addr
))

597 
AF_INET
:

599 
buf
[4][
INET_ADDRSTRLEN
];

600 
	`zlog_debug
 ("%s: ifindex %d, ifname %s, ifam_addrs 0x%x, "

603 
__func__
, 
ifm
->
iÁm_ödex
,

604 (
i‚Àn
 ? 
i‚ame
 : "“û)"), 
ifm
->
iÁm_addrs
,

605 
ifm
->
iÁm_Êags
,

606 
	`öë_¡›
(
AF_INET
,&
addr
->
sö
.
sö_addr
,

607 
buf
[0],(buf[0])),

608 
	`ù_maskÀn
(
mask
->
sö
.
sö_addr
),

609 
	`öë_¡›
(
AF_INET
,&
brd
->
sö
.
sö_addr
,

610 
buf
[1],(buf[1])),

611 
	`öë_¡›
(
AF_INET
,&
d°
.
sö
.
sö_addr
,

612 
buf
[2],(buf[2])),

613 
	`öë_¡›
(
AF_INET
,&
g©eway
.
sö
.
sö_addr
,

614 
buf
[3],(buf[3])));

617 #ifde‡
HAVE_IPV6


618 
AF_INET6
:

620 
buf
[4][
INET6_ADDRSTRLEN
];

621 
	`zlog_debug
 ("%s: ifindex %d, ifname %s, ifam_addrs 0x%x, "

624 
__func__
, 
ifm
->
iÁm_ödex
,

625 (
i‚Àn
 ? 
i‚ame
 : "“û)"), 
ifm
->
iÁm_addrs
,

626 
ifm
->
iÁm_Êags
,

627 
	`öë_¡›
(
AF_INET6
,&
addr
->
sö6
.
sö6_addr
,

628 
buf
[0],(buf[0])),

629 
	`ù6_maskÀn
(
mask
->
sö6
.
sö6_addr
),

630 
	`öë_¡›
(
AF_INET6
,&
brd
->
sö6
.
sö6_addr
,

631 
buf
[1],(buf[1])),

632 
	`öë_¡›
(
AF_INET6
,&
d°
.
sö6
.
sö6_addr
,

633 
buf
[2],(buf[2])),

634 
	`öë_¡›
(
AF_INET6
,&
g©eway
.
sö6
.
sö6_addr
,

635 
buf
[3],(buf[3])));

640 
	`zlog_debug
 ("%s: ifindex %d, ifname %s, ifam_addrs 0x%x",

641 
__func__
, 
ifm
->
iÁm_ödex
,

642 (
i‚Àn
 ? 
i‚ame
 : "“û)"), 
ifm
->
iÁm_addrs
);

648 i‡(
≤t
 !
íd
)

649 
	`zlog_w¨n
 ("ifam_read() doesn'tÑeadáll socket data");

650 
	}
}

654 
	$iÁm_ªad
 (
iÁ_msghdr
 *
iÁm
)

656 
öãrÁ˚
 *
iÂ
 = 
NULL
;

657 
sockuni⁄
 
addr
, 
mask
, 
brd
;

658 
i‚ame
[
INTERFACE_NAMSIZ
];

659 
i‚Àn
 = 0;

660 
ißlüs
 = 0;

661 
Êags
 = 0;

663 
i‚ame
[0] = i‚ame[
INTERFACE_NAMSIZ
 - 1] = '\0';

666 
	`iÁm_ªad_mesg
 (
iÁm
, &
addr
, &
mask
, &
brd
, 
i‚ame
, &
i‚Àn
);

668 i‡((
iÂ
 = 
	`if_lookup_by_ödex
(
iÁm
->
iÁm_ödex
)Ë=
NULL
)

670 
	`zlog_w¨n
 ("%s:Ço interface for ifname %s, index %d",

671 
__func__
, 
i‚ame
, 
iÁm
->
iÁm_ödex
);

675 i‡(
i‚Àn
 && 
	`°∫cmp
 (
iÂ
->
«me
, 
i‚ame
, 
INTERFACE_NAMSIZ
))

676 
ißlüs
 = 1;

681 i‡(
	`if_is_poöt›oöt
(
iÂ
))

682 
	`SET_FLAG
(
Êags
, 
ZEBRA_IFA_PEER
);

690 
iÂ
->
mëric
 = 
iÁm
->
iÁm_mëric
;

694 
	`sockuni⁄_Ámûy
 (&
addr
))

696 
AF_INET
:

697 i‡(
iÁm
->
iÁm_ty≥
 =
RTM_NEWADDR
)

698 
	`c⁄√˘ed_add_ùv4
 (
iÂ
, 
Êags
, &
addr
.
sö
.
sö_addr
,

699 
	`ù_maskÀn
 (
mask
.
sö
.
sö_addr
),

700 &
brd
.
sö
.
sö_addr
,

701 (
ißlüs
 ? 
i‚ame
 : 
NULL
));

703 
	`c⁄√˘ed_dñëe_ùv4
 (
iÂ
, 
Êags
, &
addr
.
sö
.
sö_addr
,

704 
	`ù_maskÀn
 (
mask
.
sö
.
sö_addr
),

705 &
brd
.
sö
.
sö_addr
);

707 #ifde‡
HAVE_IPV6


708 
AF_INET6
:

711 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
addr
.
sö6
.
sö6_addr
))

712 
	`SET_IN6_LINKLOCAL_IFINDEX
 (
addr
.
sö6
.
sö6_addr
, 0);

714 i‡(
iÁm
->
iÁm_ty≥
 =
RTM_NEWADDR
)

715 
	`c⁄√˘ed_add_ùv6
 (
iÂ
, 
Êags
, &
addr
.
sö6
.
sö6_addr
,

716 
	`ù6_maskÀn
 (
mask
.
sö6
.
sö6_addr
),

717 &
brd
.
sö6
.
sö6_addr
,

718 (
ißlüs
 ? 
i‚ame
 : 
NULL
));

720 
	`c⁄√˘ed_dñëe_ùv6
 (
iÂ
,

721 &
addr
.
sö6
.
sö6_addr
,

722 
	`ù6_maskÀn
 (
mask
.
sö6
.
sö6_addr
),

723 &
brd
.
sö6
.
sö6_addr
);

732 
	`if_ª‰esh
 (
iÂ
);

734 #ifde‡
SUNOS_5


747 i‡(!
	`if_is_up
 (
iÂ
))

748 
	`if_dñëe_upd©e
 (
iÂ
);

752 
	}
}

756 
	$πm_ªad_mesg
 (
π_msghdr
 *
πm
,

757 
sockuni⁄
 *
de°
,

758 
sockuni⁄
 *
mask
,

759 
sockuni⁄
 *
g©e
,

760 *
i‚ame
,

761 *
i‚Àn
)

763 
ˇddr_t
 
≤t
, 
íd
;

766 
≤t
 = (
ˇddr_t
)(
πm
 + 1);

767 
íd
 = ((
ˇddr_t
)
πm
Ë+Ñtm->
πm_msgÀn
;

770 i‡(
πm
->
πm_vîsi⁄
 !
RTM_VERSION
)

771 
	`zlog
 (
NULL
, 
LOG_WARNING
,

773 "Thi†may cau£ÖrobÀm\n", 
πm
->
πm_vîsi⁄
, 
RTM_VERSION
);

776 
	`mem£t
 (
de°
, 0,  (
sockuni⁄
));

777 
	`mem£t
 (
g©e
, 0,  (
sockuni⁄
));

778 
	`mem£t
 (
mask
, 0,  (
sockuni⁄
));

781 
	`RTA_ADDR_GET
 (
de°
, 
RTA_DST
, 
πm
->
πm_addrs
, 
≤t
);

782 
	`RTA_ADDR_GET
 (
g©e
, 
RTA_GATEWAY
, 
πm
->
πm_addrs
, 
≤t
);

783 
	`RTA_ATTR_GET
 (
mask
, 
RTA_NETMASK
, 
πm
->
πm_addrs
, 
≤t
);

784 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_GENMASK
, 
πm
->
πm_addrs
, 
≤t
);

785 
	`RTA_NAME_GET
 (
i‚ame
, 
RTA_IFP
, 
πm
->
πm_addrs
, 
≤t
, *
i‚Àn
);

786 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_IFA
, 
πm
->
πm_addrs
, 
≤t
);

787 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_AUTHOR
, 
πm
->
πm_addrs
, 
≤t
);

788 
	`RTA_ADDR_GET
 (
NULL
, 
RTA_BRD
, 
πm
->
πm_addrs
, 
≤t
);

792 i‡(
πm
->
πm_addrs
 & 
RTA_NETMASK
)

793 
mask
->
ß
.
ß_Ámûy
 = 
de°
->sa.sa_family;

796 i‡(
≤t
 !
íd
)

797 
	`zlog
 (
NULL
, 
LOG_WARNING
, "rtm_read() doesn'tÑeadáll socket data.");

799  
πm
->
πm_Êags
;

800 
	}
}

803 
	$πm_ªad
 (
π_msghdr
 *
πm
)

805 
Êags
;

806 
u_ch¨
 
zebø_Êags
;

807 
sockuni⁄
 
de°
, 
mask
, 
g©e
;

808 
i‚ame
[
INTERFACE_NAMSIZ
 + 1];

809 
i‚Àn
 = 0;

811 
zebø_Êags
 = 0;

815 
Êags
 = 
	`πm_ªad_mesg
 (
πm
, &
de°
, &
mask
, &
g©e
, 
i‚ame
, &
i‚Àn
);

816 i‡(!(
Êags
 & 
RTF_DONE
))

818 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

819 
	`zlog_debug
 ("%s: gŸÑtm o‡ty≥ %d (%s)", 
__func__
, 
πm
->
πm_ty≥
,

820 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
));

822 #ifde‡
RTF_CLONED


823 i‡(
Êags
 & 
RTF_CLONED
)

826 #ifde‡
RTF_WASCLONED


827 i‡(
Êags
 & 
RTF_WASCLONED
)

831 i‡((
πm
->
πm_ty≥
 =
RTM_ADD
Ë&& ! (
Êags
 & 
RTF_UP
))

835 i‡(! (
Êags
 & 
RTF_GATEWAY
))

838 i‡(
Êags
 & 
RTF_PROTO1
)

839 
	`SET_FLAG
 (
zebø_Êags
, 
ZEBRA_FLAG_SELFROUTE
);

842 i‡(
Êags
 & 
RTF_STATIC
)

843 
	`SET_FLAG
 (
zebø_Êags
, 
ZEBRA_FLAG_STATIC
);

846 i‡(
Êags
 & 
RTF_REJECT
)

847 
	`SET_FLAG
 (
zebø_Êags
, 
ZEBRA_FLAG_REJECT
);

848 i‡(
Êags
 & 
RTF_BLACKHOLE
)

849 
	`SET_FLAG
 (
zebø_Êags
, 
ZEBRA_FLAG_BLACKHOLE
);

851 i‡(
de°
.
ß
.
ß_Ámûy
 =
AF_INET
)

853 
¥efix_ùv4
 
p
;

855 
p
.
Ámûy
 = 
AF_INET
;

856 
p
.
¥efix
 = 
de°
.
sö
.
sö_addr
;

857 i‡(
Êags
 & 
RTF_HOST
)

858 
p
.
¥efixÀn
 = 
IPV4_MAX_PREFIXLEN
;

860 
p
.
¥efixÀn
 = 
	`ù_maskÀn
 (
mask
.
sö
.
sö_addr
);

866 i‡(
πm
->
πm_ty≥
 !
RTM_GET
 &&Ñtm->
πm_pid
 =
pid
)

868 
buf
[
INET_ADDRSTRLEN
], 
g©e_buf
[INET_ADDRSTRLEN];

869 
ªt
;

870 i‡(! 
IS_ZEBRA_DEBUG_RIB
)

872 
ªt
 = 
	`rib_lookup_ùv4_rouã
 (&
p
, &
g©e
);

873 
	`öë_¡›
 (
AF_INET
, &
p
.
¥efix
, 
buf
, 
INET_ADDRSTRLEN
);

874 
πm
->
πm_ty≥
)

876 
RTM_ADD
:

877 
RTM_GET
:

878 
RTM_CHANGE
:

881 
ªt
)

883 
ZEBRA_RIB_NOTFOUND
:

884 
	`zlog_debug
 ("%s: %s %s/%d: desync: RR isn't yet in RIB, whileálready in FIB",

885 
__func__
, 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
), 
buf
, 
p
.
¥efixÀn
);

887 
ZEBRA_RIB_FOUND_CONNECTED
:

888 
ZEBRA_RIB_FOUND_NOGATE
:

889 
	`öë_¡›
 (
AF_INET
, &
g©e
.
sö
.
sö_addr
, 
g©e_buf
, 
INET_ADDRSTRLEN
);

890 
	`zlog_debug
 ("%s: %s %s/%d: desync: RR is in RIB, but gate differs (ours is %s)",

891 
__func__
, 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
), 
buf
, 
p
.
¥efixÀn
, 
g©e_buf
);

893 
ZEBRA_RIB_FOUND_EXACT
:

894 
	`zlog_debug
 ("%s: %s %s/%d: done Ok",

895 
__func__
, 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
), 
buf
, 
p
.
¥efixÀn
);

896 
	`rib_lookup_™d_dump
 (&
p
);

901 
RTM_DELETE
:

904 
ªt
)

906 
ZEBRA_RIB_FOUND_EXACT
:

907 
	`zlog_debug
 ("%s: %s %s/%d: desync: RR is still in RIB, whileálreadyÇot in FIB",

908 
__func__
, 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
), 
buf
, 
p
.
¥efixÀn
);

909 
	`rib_lookup_™d_dump
 (&
p
);

911 
ZEBRA_RIB_FOUND_CONNECTED
:

912 
ZEBRA_RIB_FOUND_NOGATE
:

913 
	`zlog_debug
 ("%s: %s %s/%d: desync: RR is still in RIB,Ölus gate differs",

914 
__func__
, 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
), 
buf
, 
p
.
¥efixÀn
);

915 
	`rib_lookup_™d_dump
 (&
p
);

917 
ZEBRA_RIB_NOTFOUND
:

918 
	`zlog_debug
 ("%s: %s %s/%d: done Ok",

919 
__func__
, 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
), 
buf
, 
p
.
¥efixÀn
);

920 
	`rib_lookup_™d_dump
 (&
p
);

926 
	`zlog_debug
 ("%s: %s/%d: warning:Üoopback RTM ofÅype %sÑeceived",

927 
__func__
, 
buf
, 
p
.
¥efixÀn
, 
	`lookup
 (
πm_ty≥_°r
, 
πm
->
πm_ty≥
));

935 i‡(
πm
->
πm_ty≥
 =
RTM_CHANGE
)

936 
	`rib_dñëe_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
, &
p
,

937 
NULL
, 0, 0, 
SAFI_UNICAST
);

939 i‡(
πm
->
πm_ty≥
 =
RTM_GET


940 || 
πm
->
πm_ty≥
 =
RTM_ADD


941 || 
πm
->
πm_ty≥
 =
RTM_CHANGE
)

942 
	`rib_add_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
,

943 &
p
, &
g©e
.
sö
.
sö_addr
, 
NULL
, 0, 0, 0, 0, 
SAFI_UNICAST
);

945 
	`rib_dñëe_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
,

946 &
p
, &
g©e
.
sö
.
sö_addr
, 0, 0, 
SAFI_UNICAST
);

948 #ifde‡
HAVE_IPV6


949 i‡(
de°
.
ß
.
ß_Ámûy
 =
AF_INET6
)

954 i‡(
πm
->
πm_ty≥
 !
RTM_GET
 &&Ñtm->
πm_pid
 =
pid
)

956 
¥efix_ùv6
 
p
;

957 
ifödex
 = 0;

959 
p
.
Ámûy
 = 
AF_INET6
;

960 
p
.
¥efix
 = 
de°
.
sö6
.
sö6_addr
;

961 i‡(
Êags
 & 
RTF_HOST
)

962 
p
.
¥efixÀn
 = 
IPV6_MAX_PREFIXLEN
;

964 
p
.
¥efixÀn
 = 
	`ù6_maskÀn
 (
mask
.
sö6
.
sö6_addr
);

966 #ifde‡
KAME


967 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
g©e
.
sö6
.
sö6_addr
))

969 
ifödex
 = 
	`IN6_LINKLOCAL_IFINDEX
 (
g©e
.
sö6
.
sö6_addr
);

970 
	`SET_IN6_LINKLOCAL_IFINDEX
 (
g©e
.
sö6
.
sö6_addr
, 0);

977 i‡(
πm
->
πm_ty≥
 =
RTM_CHANGE
)

978 
	`rib_dñëe_ùv6
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
, &
p
,

979 
NULL
, 0, 0, 
SAFI_UNICAST
);

981 i‡(
πm
->
πm_ty≥
 =
RTM_GET


982 || 
πm
->
πm_ty≥
 =
RTM_ADD


983 || 
πm
->
πm_ty≥
 =
RTM_CHANGE
)

984 
	`rib_add_ùv6
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
,

985 &
p
, &
g©e
.
sö6
.
sö6_addr
, 
ifödex
, 0, 0, 0, 
SAFI_UNICAST
);

987 
	`rib_dñëe_ùv6
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
,

988 &
p
, &
g©e
.
sö6
.
sö6_addr
, 
ifödex
, 0, 
SAFI_UNICAST
);

991 
	}
}

998 
	$πm_wrôe
 (
mesßge
,

999 
sockuni⁄
 *
de°
,

1000 
sockuni⁄
 *
mask
,

1001 
sockuni⁄
 *
g©e
,

1002 
ödex
,

1003 
zebø_Êags
,

1004 
mëric
)

1006 
ªt
;

1007 
ˇddr_t
 
≤t
;

1008 
öãrÁ˚
 *
iÂ
;

1011 
msg_£q
 = 0;

1016 
π_msghdr
 
πm
;

1017 
buf
[512];

1018 } 
msg
;

1020 i‡(
routög_sock
 < 0)

1021  
ZEBRA_ERR_EPERM
;

1024 
	`mem£t
 (&
msg
, 0,  (
π_msghdr
));

1025 
msg
.
πm
.
πm_vîsi⁄
 = 
RTM_VERSION
;

1026 
msg
.
πm
.
πm_ty≥
 = 
mesßge
;

1027 
msg
.
πm
.
πm_£q
 = 
msg_£q
++;

1028 
msg
.
πm
.
πm_addrs
 = 
RTA_DST
;

1029 
msg
.
πm
.
πm_addrs
 |
RTA_GATEWAY
;

1030 
msg
.
πm
.
πm_Êags
 = 
RTF_UP
;

1031 
msg
.
πm
.
πm_ödex
 = 
ödex
;

1033 i‡(
mëric
 != 0)

1035 
msg
.
πm
.
πm_rmx
.
rmx_h›cou¡
 = 
mëric
;

1036 
msg
.
πm
.
πm_öôs
 |
RTV_HOPCOUNT
;

1039 
iÂ
 = 
	`if_lookup_by_ödex
 (
ödex
);

1041 i‡(
g©e
 && 
mesßge
 =
RTM_ADD
)

1042 
msg
.
πm
.
πm_Êags
 |
RTF_GATEWAY
;

1047 #ifde‡
RTF_CLONING


1048 i‡(! 
g©e
 && 
mesßge
 =
RTM_ADD
 && 
iÂ
 &&

1049 (
iÂ
->
Êags
 & 
IFF_POINTOPOINT
) == 0)

1050 
msg
.
πm
.
πm_Êags
 |
RTF_CLONING
;

1055 i‡(! 
g©e
)

1057 i‡(!
iÂ
)

1059 
de°_buf
[
INET_ADDRSTRLEN
] = "NULL", 
mask_buf
[INET_ADDRSTRLEN] = "255.255.255.255";

1060 i‡(
de°
)

1061 
	`öë_¡›
 (
AF_INET
, &
de°
->
sö
.
sö_addr
, 
de°_buf
, 
INET_ADDRSTRLEN
);

1062 i‡(
mask
)

1063 
	`öë_¡›
 (
AF_INET
, &
mask
->
sö
.
sö_addr
, 
mask_buf
, 
INET_ADDRSTRLEN
);

1064 
	`zlog_w¨n
 ("%s: %s/%s: gate == NULLándÇo gateway found for ifindex %d",

1065 
__func__
, 
de°_buf
, 
mask_buf
, 
ödex
);

1068 
g©e
 = (
sockuni⁄
 *Ë& 
iÂ
->
sdl
;

1071 i‡(
mask
)

1072 
msg
.
πm
.
πm_addrs
 |
RTA_NETMASK
;

1073 i‡(
mesßge
 =
RTM_ADD
)

1074 
msg
.
πm
.
πm_Êags
 |
RTF_HOST
;

1077 
msg
.
πm
.
πm_Êags
 |(
RTF_PROTO1
);

1080 i‡(
zebø_Êags
 & 
ZEBRA_FLAG_BLACKHOLE
)

1081 
msg
.
πm
.
πm_Êags
 |
RTF_BLACKHOLE
;

1082 i‡(
zebø_Êags
 & 
ZEBRA_FLAG_REJECT
)

1083 
msg
.
πm
.
πm_Êags
 |
RTF_REJECT
;

1086 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


1087 
	#SOCKADDRSET
(
X
,
R
) \

1088 i‡(
msg
.
πm
.
πm_addrs
 & (
R
)) \

1090 
Àn
 = 
	`ROUNDUP
 ((
X
)->
ß
.
ß_Àn
); \

1091 
	`mem˝y
 (
≤t
, (
ˇddr_t
)(
X
), 
Àn
); \

1092 
≤t
 +
Àn
; \

1093 }

	)

1095 
	#SOCKADDRSET
(
X
,
R
) \

1096 i‡(
msg
.
πm
.
πm_addrs
 & (
R
)) \

1098 
Àn
 = 
	`SAROUNDUP
 (
X
); \

1099 
	`mem˝y
 (
≤t
, (
ˇddr_t
)(
X
), 
Àn
); \

1100 
≤t
 +
Àn
; \

1101 }

	)

1104 
≤t
 = (
ˇddr_t
Ë
msg
.
buf
;

1107 
	`SOCKADDRSET
 (
de°
, 
RTA_DST
);

1108 
	`SOCKADDRSET
 (
g©e
, 
RTA_GATEWAY
);

1109 
	`SOCKADDRSET
 (
mask
, 
RTA_NETMASK
);

1111 
msg
.
πm
.
πm_msgÀn
 = 
≤t
 - (
ˇddr_t
) &msg;

1113 
ªt
 = 
	`wrôe
 (
routög_sock
, &
msg
, msg.
πm
.
πm_msgÀn
);

1115 i‡(
ªt
 !
msg
.
πm
.
πm_msgÀn
)

1117 i‡(
î∫o
 =
EEXIST
)

1118  
ZEBRA_ERR_RTEXIST
;

1119 i‡(
î∫o
 =
ENETUNREACH
)

1120  
ZEBRA_ERR_RTUNREACH
;

1121 i‡(
î∫o
 =
ESRCH
)

1122  
ZEBRA_ERR_RTNOEXIST
;

1124 
	`zlog_w¨n
 ("%s: wrôê: %†(%d)", 
__func__
, 
	`ß„_°ªº‹
 (
î∫o
),Érrno);

1125  
ZEBRA_ERR_KERNEL
;

1127  
ZEBRA_ERR_NOERROR
;

1128 
	}
}

1131 
	~"thªad.h
"

1132 
	~"zebø/z£rv.h
"

1136 
	$πmsg_debug
 (
π_msghdr
 *
πm
)

1138 
	`zlog_debug
 ("Kî√l: Lí: %d Ty≥: %s", 
πm
->
πm_msgÀn
, 
	`lookup
 (
πm_ty≥_°r
,Ñtm->
πm_ty≥
));

1139 
	`πm_Êag_dump
 (
πm
->
πm_Êags
);

1140 
	`zlog_debug
 ("Kî√l: mesßgê£q %d", 
πm
->
πm_£q
);

1141 
	`zlog_debug
 ("Kî√l:Öid %d,Ñtm_addr†0x%x", 
πm
->
πm_pid
,Ñtm->
πm_addrs
);

1142 
	}
}

1145 #i‚de‡
RTAX_MAX


1146 #ifde‡
RTA_NUMBITS


1147 
	#RTAX_MAX
 
RTA_NUMBITS


	)

1149 
	#RTAX_MAX
 8

	)

1155 
	$kî√l_ªad
 (
thªad
 *thread)

1157 
sock
;

1158 
nbyãs
;

1159 
π_msghdr
 *
πm
;

1175 
π_msghdr
 
πm
;

1176 
sockaddr_°‹age
 
addr
[
RTAX_MAX
];

1177 } 
r
;

1182 
if_msghdr
 
ifm
;

1183 
sockaddr_°‹age
 
addr
[
RTAX_MAX
];

1184 } 
im
;

1189 
iÁ_msghdr
 
iÁ
;

1190 
sockaddr_°‹age
 
addr
[
RTAX_MAX
];

1191 } 
ü
;

1193 #ifde‡
RTM_IFANNOUNCE


1197 
if_™noun˚msghdr
 
iÁn
;

1198 
sockaddr_°‹age
 
addr
[
RTAX_MAX
];

1199 } 
ün
;

1202 } 
buf
;

1205 
sock
 = 
	`THREAD_FD
 (
thªad
);

1207 
nbyãs

	`ªad
 (
sock
, &
buf
,  buf);

1209 i‡(
nbyãs
 <= 0)

1211 i‡(
nbyãs
 < 0 && 
î∫o
 !
EWOULDBLOCK
 &&Éºnÿ!
EAGAIN
)

1212 
	`zlog_w¨n
 ("routög sockëÉº‹: %s", 
	`ß„_°ªº‹
 (
î∫o
));

1216 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
kî√l_ªad
, 
NULL
, 
sock
);

1218 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1219 
	`πmsg_debug
 (&
buf
.
r
.
πm
);

1221 
πm
 = &
buf
.
r
.rtm;

1227 i‡(
πm
->
πm_msgÀn
 !
nbyãs
)

1229 
	`zlog_w¨n
 ("kernel_read:Ñtm->rtm_msglen %d,Çbytes %d,Åype %d\n",

1230 
πm
->
πm_msgÀn
, 
nbyãs
,Ñtm->
πm_ty≥
);

1234 
πm
->
πm_ty≥
)

1236 
RTM_ADD
:

1237 
RTM_DELETE
:

1238 
RTM_CHANGE
:

1239 
	`πm_ªad
 (
πm
);

1241 
RTM_IFINFO
:

1242 
	`ifm_ªad
 (&
buf
.
im
.
ifm
);

1244 
RTM_NEWADDR
:

1245 
RTM_DELADDR
:

1246 
	`iÁm_ªad
 (&
buf
.
ü
.
iÁ
);

1248 #ifde‡
RTM_IFANNOUNCE


1249 
RTM_IFANNOUNCE
:

1250 
	`iÁn_ªad
 (&
buf
.
ün
.
iÁn
);

1254 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1255 
	`zlog_debug
("U≈ro˚s£d RTM_ty≥: %d", 
πm
->
πm_ty≥
);

1259 
	}
}

1263 
	$routög_sockë
 ()

1265 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
) )

1266 
	`zlog_îr
 ("routing_socket: Can'tÑaiseÖrivileges");

1268 
routög_sock
 = 
	`sockë
 (
AF_ROUTE
, 
SOCK_RAW
, 0);

1270 i‡(
routög_sock
 < 0)

1272 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

1273 
	`zlog_îr
 ("routing_socket: Can'tÜowerÖrivileges");

1274 
	`zlog_w¨n
 ("Can't init kernelÑouting socket");

1285 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

1286 
	`zlog_îr
 ("routing_socket: Can'tÜowerÖrivileges");

1289 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
kî√l_ªad
, 
NULL
, 
routög_sock
);

1290 
	}
}

1295 
	$kî√l_öô
 ()

1297 
	`routög_sockë
 ();

1298 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_socket.h

23 #i‚de‡
__ZEBRA_KERNEL_SOCKET_H


24 
	#__ZEBRA_KERNEL_SOCKET_H


	)

26 
πm_ªad
 (
π_msghdr
 *);

27 
iÁm_ªad
 (
iÁ_msghdr
 *);

28 
ifm_ªad
 (
if_msghdr
 *);

29 
πm_wrôe
 (, 
sockuni⁄
 *, sockunion *,

30 
sockuni⁄
 *, , , );

31 c⁄° 
mesßge
 
πm_ty≥_°r
[];

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/main.c

22 
	~<zebø.h
>

24 
	~<lib/vîsi⁄.h
>

25 
	~"gë›t.h
"

26 
	~"comm™d.h
"

27 
	~"thªad.h
"

28 
	~"fûãr.h
"

29 
	~"mem‹y.h
"

30 
	~"¥efix.h
"

31 
	~"log.h
"

32 
	~"∂i°.h
"

33 
	~"¥ivs.h
"

34 
	~"sigevít.h
"

36 
	~"zebø/rib.h
"

37 
	~"zebø/z£rv.h
"

38 
	~"zebø/debug.h
"

39 
	~"zebø/rouãr-id.h
"

40 
	~"zebø/údp.h
"

41 
	~"zebø/πadv.h
"

42 
	~"zebø/zebø_Âm.h
"

45 
zebø_t
 
	gzebød
 =

47 .
πm_èbÀ_deÁu…
 = 0,

51 
pid_t
 
	gpid
;

54 
thªad_ma°î
 *
	gma°î
;

57 
	gªèö_mode
 = 0;

60 
	gkìp_kî√l_mode
 = 0;

62 #ifde‡
HAVE_NETLINK


64 
u_öt32_t
 
	g∆_rcvbufsize
 = 0;

68 
›ti⁄
 
	gl⁄g›ts
[] =

70 { "b©ch", 
no_¨gumít
, 
NULL
, 'b'},

71 { "d´m⁄", 
no_¨gumít
, 
NULL
, 'd'},

72 { "kìp_kî√l", 
no_¨gumít
, 
NULL
, 'k'},

73 { "c⁄fig_fûe", 
ªquúed_¨gumít
, 
NULL
, 'f'},

74 { "pid_fûe", 
ªquúed_¨gumít
, 
NULL
, 'i'},

75 { "sockë", 
ªquúed_¨gumít
, 
NULL
, 'z'},

76 { "hñp", 
no_¨gumít
, 
NULL
, 'h'},

77 { "vty_addr", 
ªquúed_¨gumít
, 
NULL
, 'A'},

78 { "vty_p‹t", 
ªquúed_¨gumít
, 
NULL
, 'P'},

79 { "ªèö", 
no_¨gumít
, 
NULL
, 'r'},

80 { "dryrun", 
no_¨gumít
, 
NULL
, 'C'},

81 #ifde‡
HAVE_NETLINK


82 { "∆-bufsize", 
ªquúed_¨gumít
, 
NULL
, 's'},

84 { "u£r", 
ªquúed_¨gumít
, 
NULL
, 'u'},

85 { "group", 
ªquúed_¨gumít
, 
NULL
, 'g'},

86 { "vîsi⁄", 
no_¨gumít
, 
NULL
, 'v'},

90 
zebø_ˇ∑bûôõs_t
 
	g_ˇps_p
 [] =

92 
ZCAP_NET_ADMIN
,

93 
ZCAP_SYS_ADMIN
,

94 
ZCAP_NET_RAW
,

98 
zebø_¥ivs_t
 
	gz£rv_¥ivs
 =

100 #i‡
deföed
(
QUAGGA_USER
Ë&& deföed(
QUAGGA_GROUP
)

101 .
u£r
 = 
QUAGGA_USER
,

102 .
	ggroup
 = 
QUAGGA_GROUP
,

104 #ifde‡
VTY_GROUP


105 .
	gvty_group
 = 
VTY_GROUP
,

107 .
	gˇps_p
 = 
_ˇps_p
,

108 .
	gˇp_num_p
 = 
¨øy_size
(
_ˇps_p
),

109 .
	gˇp_num_i
 = 0

113 
	gc⁄fig_deÁu…
[] = 
SYSCONFDIR
 
DEFAULT_CONFIG_FILE
;

116 c⁄° *
	gpid_fûe
 = 
PATH_ZEBRA_PID
;

120 
	$ußge
 (*
¥og«me
, 
°©us
)

122 i‡(
°©us
 != 0)

123 
	`Ârötf
 (
°dîr
, "Try `%†--hñp' f‹ m‹êöf‹m©i⁄.\n", 
¥og«me
);

126 
	`¥ötf
 ("Usage : %s [OPTION...]\n\n"\

142 "-g, --group Grou∞tÿru¿as\n", 
¥og«me
);

143 #ifde‡
HAVE_NETLINK


144 
	`¥ötf
 ("-s, --nl-bufsize SetÇetlinkÑeceive buffer size\n");

146 
	`¥ötf
 ("-v, --version PrintÖrogram version\n"\

149 "Rï‹àbug†tÿ%s\n", 
ZEBRA_BUG_ADDRESS
);

152 
	`exô
 (
°©us
);

153 
	}
}

157 
	$sighup
 ()

159 
	`zlog_öfo
 ("SIGHUPÑeceived");

163 
	}
}

167 
	$sigöt
 ()

169 
	`zlog_nŸi˚
 ("Terminating on signal");

171 i‡(!
ªèö_mode
)

172 
	`rib_˛o£
 ();

173 #ifde‡
HAVE_IRDP


174 
	`údp_föish
();

177 
	`exô
 (0);

178 
	}
}

182 
	$sigu§1
 ()

184 
	`zlog_rŸ©e
 (
NULL
);

185 
	}
}

187 
quagga_sig«l_t
 
	gzebø_sig«ls
[] =

190 .
sig«l
 = 
SIGHUP
,

191 .
	gh™dÀr
 = &
sighup
,

194 .
	gsig«l
 = 
SIGUSR1
,

195 .
	gh™dÀr
 = &
sigu§1
,

198 .
	gsig«l
 = 
SIGINT
,

199 .
	gh™dÀr
 = &
sigöt
,

202 .
	gsig«l
 = 
SIGTERM
,

203 .
	gh™dÀr
 = &
sigöt
,

209 
	$maö
 (
¨gc
, **
¨gv
)

211 *
p
;

212 *
vty_addr
 = 
NULL
;

213 
vty_p‹t
 = 
ZEBRA_VTY_PORT
;

214 
dryrun
 = 0;

215 
b©ch_mode
 = 0;

216 
d´m⁄_mode
 = 0;

217 *
c⁄fig_fûe
 = 
NULL
;

218 *
¥og«me
;

219 
thªad
Åhread;

220 *
z£rv_∑th
 = 
NULL
;

223 
	`umask
 (0027);

226 
¥og«me
 = ((
p
 = 
	`°ºchr
 (
¨gv
[0], '/')) ? ++p :árgv[0]);

228 
zlog_deÁu…
 = 
	`›ízlog
 (
¥og«me
, 
ZLOG_ZEBRA
,

229 
LOG_CONS
|
LOG_NDELAY
|
LOG_PID
, 
LOG_DAEMON
);

233 
›t
;

235 #ifde‡
HAVE_NETLINK


236 
›t
 = 
	`gë›t_l⁄g
 (
¨gc
, 
¨gv
, "bdkf:i:z:hA:P:ru:g:vs:C", 
l⁄g›ts
, 0);

238 
›t
 = 
	`gë›t_l⁄g
 (
¨gc
, 
¨gv
, "bdkf:i:z:hA:P:ru:g:vC", 
l⁄g›ts
, 0);

241 i‡(
›t
 =
EOF
)

244 
›t
)

249 
b©ch_mode
 = 1;

251 
d´m⁄_mode
 = 1;

254 
kìp_kî√l_mode
 = 1;

257 
dryrun
 = 1;

260 
c⁄fig_fûe
 = 
›èrg
;

263 
vty_addr
 = 
›èrg
;

266 
pid_fûe
 = 
›èrg
;

269 
z£rv_∑th
 = 
›èrg
;

274 i‡(
	`°rcmp
(
›èrg
, "0") == 0)

276 
vty_p‹t
 = 0;

279 
vty_p‹t
 = 
	`©oi
 (
›èrg
);

280 i‡(
vty_p‹t
 <= 0 || vty_port > 0xffff)

281 
vty_p‹t
 = 
ZEBRA_VTY_PORT
;

284 
ªèö_mode
 = 1;

286 #ifde‡
HAVE_NETLINK


288 
∆_rcvbufsize
 = 
	`©oi
 (
›èrg
);

292 
z£rv_¥ivs
.
u£r
 = 
›èrg
;

295 
z£rv_¥ivs
.
group
 = 
›èrg
;

298 
	`¥öt_vîsi⁄
 (
¥og«me
);

299 
	`exô
 (0);

302 
	`ußge
 (
¥og«me
, 0);

305 
	`ußge
 (
¥og«me
, 1);

311 
zebød
.
ma°î
 = 
	`thªad_ma°î_¸óã
 ();

314 
	`z¥ivs_öô
 (&
z£rv_¥ivs
);

317 
	`sig«l_öô
 (
zebød
.
ma°î
, 
	`¨øy_size
(
zebø_sig«ls
), zebra_signals);

318 
	`cmd_öô
 (1);

319 
	`vty_öô
 (
zebød
.
ma°î
);

320 
	`mem‹y_öô
 ();

323 
	`zebø_öô
 ();

324 
	`rib_öô
 ();

325 
	`zebø_if_öô
 ();

326 
	`zebø_debug_öô
 ();

327 
	`rouãr_id_öô
();

328 
	`zebø_vty_öô
 ();

329 
	`ac˚ss_li°_öô
 ();

330 
	`¥efix_li°_öô
 ();

331 #ifde‡
RTADV


332 
	`πadv_öô
 ();

334 #ifde‡
HAVE_IRDP


335 
	`údp_öô
();

342 
	`kî√l_öô
 ();

343 
	`öãrÁ˚_li°
 ();

344 
	`rouã_ªad
 ();

347 
	`s‹t_node
 ();

349 #ifde‡
HAVE_SNMP


350 
	`zebø_¢mp_öô
 ();

353 #ifde‡
HAVE_FPM


354 
	`zÂm_öô
 (
zebød
.
ma°î
, 1, 0);

356 
	`zÂm_öô
 (
zebød
.
ma°î
, 0, 0);

366 
	`vty_ªad_c⁄fig
 (
c⁄fig_fûe
, 
c⁄fig_deÁu…
);

369 i‡(
dryrun
)

373 
	`rib_wìd_èbÀs
 ();

376 i‡(
b©ch_mode
)

377 
	`exô
 (0);

380 i‡(
d´m⁄_mode
 && 
	`d´m⁄
 (0, 0) < 0)

382 
	`zlog_îr
("Zebø d´m⁄ faûed: %s", 
	`°ªº‹
(
î∫o
));

383 
	`exô
 (1);

387 
	`pid_ouçut
 (
pid_fûe
);

397 i‡(! 
kìp_kî√l_mode
)

398 
	`rib_swìp_rouã
 ();

401 
pid
 = 
	`gëpid
 ();

404 
	`zebø_z£rv_sockë_öô
 (
z£rv_∑th
);

407 
	`vty_£rv_sock
 (
vty_addr
, 
vty_p‹t
, 
ZEBRA_VTYSH_PATH
);

410 
	`zlog_nŸi˚
 ("Zebø %†°¨tög: vty@%d", 
QUAGGA_VERSION
, 
vty_p‹t
);

412 
	`thªad_„tch
 (
zebød
.
ma°î
, &
thªad
))

413 
	`thªad_ˇŒ
 (&
thªad
);

417 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/misc_null.c

1 
	~<zebø.h
>

3 
	~"¥efix.h
"

4 
	~"zebø/πadv.h
"

5 
	~"zebø/údp.h
"

6 
	~"zebø/öãrÁ˚.h
"

7 
	~"zebø/zebø_Âm.h
"

9 
	$if°©_upd©e_¥oc
 (Ë{ ; 
	}
}

10 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


11 #¥agm®
wók
 
πadv_c⁄fig_wrôe
 = 
if°©_upd©e_¥oc


12 #¥agm®
wók
 
údp_c⁄fig_wrôe
 = 
if°©_upd©e_¥oc


13 #¥agm®
wók
 
if°©_upd©e_sys˘l
 = 
if°©_upd©e_¥oc


15 
	$πadv_c⁄fig_wrôe
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
Ë{ ; 
	}
}

16 
	$údp_c⁄fig_wrôe
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
Ë{ ; 
	}
}

17 
	$if°©_upd©e_sys˘l
 (Ë{ ; 
	}
}

21 
	$zÂm_åiggî_upd©e
 (
rouã_node
 *
∫
, c⁄° *
ªas⁄
)

24 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/mtu_kvm.c

22 
	~<zebø.h
>

24 
	~<kvm.h
>

25 
	~<limôs.h
>

26 
	~<f˙é.h
>

28 
	~"if.h
"

32 
	$if_kvm_gë_mtu
 (
öãrÁ˚
 *
iÂ
)

34 
kvm_t
 *
kvmd
;

35 
i‚ë
 ifnet;

36 
i‚ëaddr
;

37 
Àn
;

39 
i‚ame
[
IFNAMSIZ
];

40 
äame
[
INTERFACE_NAMSIZ
 + 1];

41 
buf
[
_POSIX2_LINE_MAX
];

43 
∆i°
 
∆
[] =

49 
iÂ
->
mtu6
 = iÂ->
mtu
 = -1;

51 
kvmd
 = 
	`kvm_›ífûes
 (
NULL
, NULL, NULL, 
O_RDONLY
, 
buf
);

53 i‡(
kvmd
 =
NULL
)

56 
	`kvm_∆i°
(
kvmd
, 
∆
);

58 
i‚ëaddr
 = 
∆
[0].
n_vÆue
;

60 i‡(
	`kvm_ªad
(
kvmd
, 
i‚ëaddr
, (*)&ifnetaddr,  ifnetaddr) < 0)

62 
	`kvm_˛o£
 (
kvmd
);

66 
i‚ëaddr
 != 0)

68 i‡(
	`kvm_ªad
 (
kvmd
, 
i‚ëaddr
, (*)&
i‚ë
,  ifnet) < 0)

70 
	`kvm_˛o£
 (
kvmd
);

74 i‡(
	`kvm_ªad
 (
kvmd
, (
u_l⁄g
)
i‚ë
.
if_«me
, 
i‚ame
, 
IFNAMSIZ
) < 0)

76 
	`kvm_˛o£
 (
kvmd
);

80 
Àn
 = 
	`¢¥ötf
 (
äame
, 
INTERFACE_NAMSIZ
 + 1,

81 "%s%d", 
i‚ame
, 
i‚ë
.
if_unô
);

83 i‡(
	`°∫cmp
 (
äame
, 
iÂ
->
«me
, 
Àn
) == 0)

86 
i‚ëaddr
 = (
u_l⁄g
)
i‚ë
.
if_√xt
;

89 
	`kvm_˛o£
 (
kvmd
);

91 i‡(
i‚ëaddr
 == 0)

96 
iÂ
->
mtu6
 = iÂ->
mtu
 = 
i‚ë
.
if_mtu
;

97 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/redistribute.c

22 
	~<zebø.h
>

24 
	~"ve˘‹.h
"

25 
	~"vty.h
"

26 
	~"comm™d.h
"

27 
	~"¥efix.h
"

28 
	~"èbÀ.h
"

29 
	~"°ªam.h
"

30 
	~"z˛õ¡.h
"

31 
	~"lökli°.h
"

32 
	~"log.h
"

34 
	~"zebø/rib.h
"

35 
	~"zebø/z£rv.h
"

36 
	~"zebø/ªdi°ribuã.h
"

37 
	~"zebø/debug.h
"

38 
	~"zebø/rouãr-id.h
"

41 
zebø_t
 
zebød
;

44 
	$zebø_check_addr
 (
¥efix
 *
p
)

46 i‡(
p
->
Ámûy
 =
AF_INET
)

48 
u_öt32_t
 
addr
;

50 
addr
 = 
p
->
u
.
¥efix4
.
s_addr
;

51 
addr
 = 
	`¡ohl
 (addr);

53 i‡(
	`IPV4_NET127
 (
addr
)

54 || 
	`IN_CLASSD
 (
addr
)

55 || 
	`IPV4_LINKLOCAL
(
addr
))

58 #ifde‡
HAVE_IPV6


59 i‡(
p
->
Ámûy
 =
AF_INET6
)

61 i‡(
	`IN6_IS_ADDR_LOOPBACK
 (&
p
->
u
.
¥efix6
))

63 i‡(
	`IN6_IS_ADDR_LINKLOCAL
(&
p
->
u
.
¥efix6
))

68 
	}
}

71 
	$is_deÁu…
 (
¥efix
 *
p
)

73 i‡(
p
->
Ámûy
 =
AF_INET
)

74 i‡(
p
->
u
.
¥efix4
.
s_addr
 =0 &&Ö->
¥efixÀn
 == 0)

76 #ifde‡
HAVE_IPV6


79 i‡(
p
->
Ámûy
 =
AF_INET6
)

80 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
p
->
u
.
¥efix6
Ë&&Ö->
¥efixÀn
 == 0)

85 
	}
}

88 
	$zebø_ªdi°ribuã_deÁu…
 (
z£rv
 *
˛õ¡
)

90 
¥efix_ùv4
 
p
;

91 
rouã_èbÀ
 *
èbÀ
;

92 
rouã_node
 *
∫
;

93 
rib
 *
√wrib
;

94 #ifde‡
HAVE_IPV6


95 
¥efix_ùv6
 
p6
;

100 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

101 
p
.
Ámûy
 = 
AF_INET
;

104 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

105 i‡(
èbÀ
)

107 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *)&
p
);

108 i‡(
∫
)

110 
	`RNODE_FOREACH_RIB
 (
∫
, 
√wrib
)

111 i‡(
	`CHECK_FLAG
 (
√wrib
->
Êags
, 
ZEBRA_FLAG_SELECTED
)

112 && 
√wrib
->
di°™˚
 !
DISTANCE_INFINITY
)

113 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV4_ROUTE_ADD
, 
˛õ¡
, &
∫
->
p
, 
√wrib
);

114 
	`rouã_u∆ock_node
 (
∫
);

118 #ifde‡
HAVE_IPV6


120 
	`mem£t
 (&
p6
, 0,  (
¥efix_ùv6
));

121 
p6
.
Ámûy
 = 
AF_INET6
;

124 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

125 i‡(
èbÀ
)

127 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *)&
p6
);

128 i‡(
∫
)

130 
	`RNODE_FOREACH_RIB
 (
∫
, 
√wrib
)

131 i‡(
	`CHECK_FLAG
 (
√wrib
->
Êags
, 
ZEBRA_FLAG_SELECTED
)

132 && 
√wrib
->
di°™˚
 !
DISTANCE_INFINITY
)

133 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV6_ROUTE_ADD
, 
˛õ¡
, &
∫
->
p
, 
√wrib
);

134 
	`rouã_u∆ock_node
 (
∫
);

138 
	}
}

142 
	$zebø_ªdi°ribuã
 (
z£rv
 *
˛õ¡
, 
ty≥
)

144 
rib
 *
√wrib
;

145 
rouã_èbÀ
 *
èbÀ
;

146 
rouã_node
 *
∫
;

148 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

149 i‡(
èbÀ
)

150 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

151 
	`RNODE_FOREACH_RIB
 (
∫
, 
√wrib
)

152 i‡(
	`CHECK_FLAG
 (
√wrib
->
Êags
, 
ZEBRA_FLAG_SELECTED
)

153 && 
√wrib
->
ty≥
 ==Åype

154 && 
√wrib
->
di°™˚
 !
DISTANCE_INFINITY


155 && 
	`zebø_check_addr
 (&
∫
->
p
))

156 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV4_ROUTE_ADD
, 
˛õ¡
, &
∫
->
p
, 
√wrib
);

158 #ifde‡
HAVE_IPV6


159 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

160 i‡(
èbÀ
)

161 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

162 
	`RNODE_FOREACH_RIB
 (
∫
, 
√wrib
)

163 i‡(
	`CHECK_FLAG
 (
√wrib
->
Êags
, 
ZEBRA_FLAG_SELECTED
)

164 && 
√wrib
->
ty≥
 ==Åype

165 && 
√wrib
->
di°™˚
 !
DISTANCE_INFINITY


166 && 
	`zebø_check_addr
 (&
∫
->
p
))

167 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV6_ROUTE_ADD
, 
˛õ¡
, &
∫
->
p
, 
√wrib
);

169 
	}
}

172 
	$ªdi°ribuã_add
 (
¥efix
 *
p
, 
rib
 *rib)

174 
li°node
 *
node
, *
¬ode
;

175 
z£rv
 *
˛õ¡
;

177 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

179 i‡(
	`is_deÁu…
 (
p
))

181 i‡(
˛õ¡
->
ªdi°_deÁu…
 || clõ¡->
ªdi°
[
rib
->
ty≥
])

183 i‡(
p
->
Ámûy
 =
AF_INET
)

184 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV4_ROUTE_ADD
, 
˛õ¡
, 
p
, 
rib
);

185 #ifde‡
HAVE_IPV6


186 i‡(
p
->
Ámûy
 =
AF_INET6
)

187 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV6_ROUTE_ADD
, 
˛õ¡
, 
p
, 
rib
);

191 i‡(
˛õ¡
->
ªdi°
[
rib
->
ty≥
])

193 i‡(
p
->
Ámûy
 =
AF_INET
)

194 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV4_ROUTE_ADD
, 
˛õ¡
, 
p
, 
rib
);

195 #ifde‡
HAVE_IPV6


196 i‡(
p
->
Ámûy
 =
AF_INET6
)

197 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV6_ROUTE_ADD
, 
˛õ¡
, 
p
, 
rib
);

201 
	}
}

204 
	$ªdi°ribuã_dñëe
 (
¥efix
 *
p
, 
rib
 *rib)

206 
li°node
 *
node
, *
¬ode
;

207 
z£rv
 *
˛õ¡
;

210 i‡(
rib
->
di°™˚
 =
DISTANCE_INFINITY
)

213 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

215 i‡(
	`is_deÁu…
 (
p
))

217 i‡(
˛õ¡
->
ªdi°_deÁu…
 || clõ¡->
ªdi°
[
rib
->
ty≥
])

219 i‡(
p
->
Ámûy
 =
AF_INET
)

220 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV4_ROUTE_DELETE
, 
˛õ¡
, 
p
,

221 
rib
);

222 #ifde‡
HAVE_IPV6


223 i‡(
p
->
Ámûy
 =
AF_INET6
)

224 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV6_ROUTE_DELETE
, 
˛õ¡
, 
p
,

225 
rib
);

229 i‡(
˛õ¡
->
ªdi°
[
rib
->
ty≥
])

231 i‡(
p
->
Ámûy
 =
AF_INET
)

232 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV4_ROUTE_DELETE
, 
˛õ¡
, 
p
, 
rib
);

233 #ifde‡
HAVE_IPV6


234 i‡(
p
->
Ámûy
 =
AF_INET6
)

235 
	`z£nd_rouã_mu…ù©h
 (
ZEBRA_IPV6_ROUTE_DELETE
, 
˛õ¡
, 
p
, 
rib
);

239 
	}
}

242 
	$zebø_ªdi°ribuã_add
 (
comm™d
, 
z£rv
 *
˛õ¡
, 
Àngth
)

244 
ty≥
;

246 
ty≥
 = 
	`°ªam_gëc
 (
˛õ¡
->
ibuf
);

248 i‡(
ty≥
 =0 ||Åy≥ >
ZEBRA_ROUTE_MAX
)

251 i‡(! 
˛õ¡
->
ªdi°
[
ty≥
])

253 
˛õ¡
->
ªdi°
[
ty≥
] = 1;

254 
	`zebø_ªdi°ribuã
 (
˛õ¡
, 
ty≥
);

256 
	}
}

259 
	$zebø_ªdi°ribuã_dñëe
 (
comm™d
, 
z£rv
 *
˛õ¡
, 
Àngth
)

261 
ty≥
;

263 
ty≥
 = 
	`°ªam_gëc
 (
˛õ¡
->
ibuf
);

265 i‡(
ty≥
 =0 ||Åy≥ >
ZEBRA_ROUTE_MAX
)

268 
˛õ¡
->
ªdi°
[
ty≥
] = 0;

269 
	}
}

272 
	$zebø_ªdi°ribuã_deÁu…_add
 (
comm™d
, 
z£rv
 *
˛õ¡
, 
Àngth
)

274 
˛õ¡
->
ªdi°_deÁu…
 = 1;

275 
	`zebø_ªdi°ribuã_deÁu…
 (
˛õ¡
);

276 
	}
}

279 
	$zebø_ªdi°ribuã_deÁu…_dñëe
 (
comm™d
, 
z£rv
 *
˛õ¡
,

280 
Àngth
)

282 
˛õ¡
->
ªdi°_deÁu…
 = 0;;

283 
	}
}

287 
	$zebø_öãrÁ˚_up_upd©e
 (
öãrÁ˚
 *
iÂ
)

289 
li°node
 *
node
, *
¬ode
;

290 
z£rv
 *
˛õ¡
;

292 i‡(
IS_ZEBRA_DEBUG_EVENT
)

293 
	`zlog_debug
 ("MESSAGE: ZEBRA_INTERFACE_UP %s", 
iÂ
->
«me
);

295 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

296 
	`z£nd_öãrÁ˚_upd©e
 (
ZEBRA_INTERFACE_UP
, 
˛õ¡
, 
iÂ
);

297 
	}
}

301 
	$zebø_öãrÁ˚_down_upd©e
 (
öãrÁ˚
 *
iÂ
)

303 
li°node
 *
node
, *
¬ode
;

304 
z£rv
 *
˛õ¡
;

306 i‡(
IS_ZEBRA_DEBUG_EVENT
)

307 
	`zlog_debug
 ("MESSAGE: ZEBRA_INTERFACE_DOWN %s", 
iÂ
->
«me
);

309 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

310 
	`z£nd_öãrÁ˚_upd©e
 (
ZEBRA_INTERFACE_DOWN
, 
˛õ¡
, 
iÂ
);

311 
	}
}

315 
	$zebø_öãrÁ˚_add_upd©e
 (
öãrÁ˚
 *
iÂ
)

317 
li°node
 *
node
, *
¬ode
;

318 
z£rv
 *
˛õ¡
;

320 i‡(
IS_ZEBRA_DEBUG_EVENT
)

321 
	`zlog_debug
 ("MESSAGE: ZEBRA_INTERFACE_ADD %s", 
iÂ
->
«me
);

323 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

324 i‡(
˛õ¡
->
iföfo
)

325 
	`z£nd_öãrÁ˚_add
 (
˛õ¡
, 
iÂ
);

326 
	}
}

329 
	$zebø_öãrÁ˚_dñëe_upd©e
 (
öãrÁ˚
 *
iÂ
)

331 
li°node
 *
node
, *
¬ode
;

332 
z£rv
 *
˛õ¡
;

334 i‡(
IS_ZEBRA_DEBUG_EVENT
)

335 
	`zlog_debug
 ("MESSAGE: ZEBRA_INTERFACE_DELETE %s", 
iÂ
->
«me
);

337 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

338 i‡(
˛õ¡
->
iföfo
)

339 
	`z£nd_öãrÁ˚_dñëe
 (
˛õ¡
, 
iÂ
);

340 
	}
}

344 
	$zebø_öãrÁ˚_addªss_add_upd©e
 (
öãrÁ˚
 *
iÂ
,

345 
c⁄√˘ed
 *
ifc
)

347 
li°node
 *
node
, *
¬ode
;

348 
z£rv
 *
˛õ¡
;

349 
¥efix
 *
p
;

351 i‡(
IS_ZEBRA_DEBUG_EVENT
)

353 
buf
[
INET6_ADDRSTRLEN
];

355 
p
 = 
ifc
->
addªss
;

356 
	`zlog_debug
 ("MESSAGE: ZEBRA_INTERFACE_ADDRESS_ADD %s/%d on %s",

357 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
),

358 
p
->
¥efixÀn
, 
ifc
->
iÂ
->
«me
);

361 
	`rouãr_id_add_addªss
(
ifc
);

363 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

364 i‡(
˛õ¡
->
iföfo
 && 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

365 
	`z£nd_öãrÁ˚_addªss
 (
ZEBRA_INTERFACE_ADDRESS_ADD
, 
˛õ¡
, 
iÂ
, 
ifc
);

366 
	}
}

370 
	$zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
öãrÁ˚
 *
iÂ
,

371 
c⁄√˘ed
 *
ifc
)

373 
li°node
 *
node
, *
¬ode
;

374 
z£rv
 *
˛õ¡
;

375 
¥efix
 *
p
;

377 i‡(
IS_ZEBRA_DEBUG_EVENT
)

379 
buf
[
INET6_ADDRSTRLEN
];

381 
p
 = 
ifc
->
addªss
;

382 
	`zlog_debug
 ("MESSAGE: ZEBRA_INTERFACE_ADDRESS_DELETE %s/%d on %s",

383 
	`öë_¡›
 (
p
->
Ámûy
, &p->
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
),

384 
p
->
¥efixÀn
, 
ifc
->
iÂ
->
«me
);

387 
	`rouãr_id_dñ_addªss
(
ifc
);

389 
	`ALL_LIST_ELEMENTS
 (
zebød
.
˛õ¡_li°
, 
node
, 
¬ode
, 
˛õ¡
))

390 i‡(
˛õ¡
->
iföfo
 && 
	`CHECK_FLAG
 (
ifc
->
c⁄f
, 
ZEBRA_IFC_REAL
))

391 
	`z£nd_öãrÁ˚_addªss
 (
ZEBRA_INTERFACE_ADDRESS_DELETE
, 
˛õ¡
, 
iÂ
, 
ifc
);

392 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/redistribute.h

23 #i‚de‡
_ZEBRA_REDISTRIBUTE_H


24 
	#_ZEBRA_REDISTRIBUTE_H


	)

26 
	~"èbÀ.h
"

27 
	~"z£rv.h
"

29 
zebø_ªdi°ribuã_add
 (, 
z£rv
 *, );

30 
zebø_ªdi°ribuã_dñëe
 (, 
z£rv
 *, );

32 
zebø_ªdi°ribuã_deÁu…_add
 (, 
z£rv
 *, );

33 
zebø_ªdi°ribuã_deÁu…_dñëe
 (, 
z£rv
 *, );

35 
ªdi°ribuã_add
 (
¥efix
 *, 
rib
 *);

36 
ªdi°ribuã_dñëe
 (
¥efix
 *, 
rib
 *);

38 
zebø_öãrÁ˚_up_upd©e
 (
öãrÁ˚
 *);

39 
zebø_öãrÁ˚_down_upd©e
 (
öãrÁ˚
 *);

41 
zebø_öãrÁ˚_add_upd©e
 (
öãrÁ˚
 *);

42 
zebø_öãrÁ˚_dñëe_upd©e
 (
öãrÁ˚
 *);

44 
zebø_öãrÁ˚_addªss_add_upd©e
 (
öãrÁ˚
 *,

45 
c⁄√˘ed
 *);

46 
zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
öãrÁ˚
 *,

47 
c⁄√˘ed
 *
c
);

49 
zebø_check_addr
 (
¥efix
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/redistribute_null.c

1 
	~<zebø.h
>

2 
	~"zebø/rib.h
"

3 
	~"zebø/z£rv.h
"

5 
	~"zebø/ªdi°ribuã.h
"

7 
	$zebø_ªdi°ribuã_add
 (
a
, 
z£rv
 *
b
, 
c
)

8 { ; 
	}
}

9 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


10 #¥agm®
wók
 
zebø_ªdi°ribuã_dñëe
 = 
zebø_ªdi°ribuã_add


11 #¥agm®
wók
 
zebø_ªdi°ribuã_deÁu…_add
 = 
zebø_ªdi°ribuã_add


12 #¥agm®
wók
 
zebø_ªdi°ribuã_deÁu…_dñëe
 = 
zebø_ªdi°ribuã_add


14 
	$zebø_ªdi°ribuã_dñëe
 (
a
, 
z£rv
 *
b
, 
c
)

15 { ; 
	}
}

16 
	$zebø_ªdi°ribuã_deÁu…_add
 (
a
, 
z£rv
 *
b
, 
c
)

17 { ; 
	}
}

18 
	$zebø_ªdi°ribuã_deÁu…_dñëe
 (
a
, 
z£rv
 *
b
, 
c
)

19 { ; 
	}
}

22 
	$ªdi°ribuã_add
 (
¥efix
 *
a
, 
rib
 *
b
)

23 { ; 
	}
}

24 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


25 #¥agm®
wók
 
ªdi°ribuã_dñëe
 = 
ªdi°ribuã_add


27 
	$ªdi°ribuã_dñëe
 (
¥efix
 *
a
, 
rib
 *
b
)

28 { ; 
	}
}

31 
	$zebø_öãrÁ˚_up_upd©e
 (
öãrÁ˚
 *
a
)

32 { ; 
	}
}

33 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


34 #¥agm®
wók
 
zebø_öãrÁ˚_down_upd©e
 = 
zebø_öãrÁ˚_up_upd©e


35 #¥agm®
wók
 
zebø_öãrÁ˚_add_upd©e
 = 
zebø_öãrÁ˚_up_upd©e


36 #¥agm®
wók
 
zebø_öãrÁ˚_dñëe_upd©e
 = 
zebø_öãrÁ˚_up_upd©e


38 
	$zebø_öãrÁ˚_down_upd©e
 (
öãrÁ˚
 *
a
)

39 { ; 
	}
}

40 
	$zebø_öãrÁ˚_add_upd©e
 (
öãrÁ˚
 *
a
)

41 { ; 
	}
}

42 
	$zebø_öãrÁ˚_dñëe_upd©e
 (
öãrÁ˚
 *
a
)

43 { ; 
	}
}

46 
	$zebø_öãrÁ˚_addªss_add_upd©e
 (
öãrÁ˚
 *
a
,

47 
c⁄√˘ed
 *
b
)

48 { ; 
	}
}

49 #ifde‡
HAVE_SYS_WEAK_ALIAS_PRAGMA


50 #¥agm®
wók
 
zebø_öãrÁ˚_addªss_dñëe_upd©e
 = 
zebø_öãrÁ˚_addªss_add_upd©e


52 
	$zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
öãrÁ˚
 *
a
,

53 
c⁄√˘ed
 *
b
)

54 { ; 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rib.h

23 #i‚de‡
_ZEBRA_RIB_H


24 
	#_ZEBRA_RIB_H


	)

26 
	~"¥efix.h
"

27 
	~"èbÀ.h
"

28 
	~"queue.h
"

30 
	#DISTANCE_INFINITY
 255

	)

34 
	ug_addr
 {

35 
ö_addr
 
	mùv4
;

36 #ifde‡
HAVE_IPV6


37 
ö6_addr
 
	mùv6
;

41 
	srib


44 
rib
 *
	m√xt
;

45 
rib
 *
	m¥ev
;

48 
√xth›
 *
	m√xth›
;

51 
	mªf˙t
;

54 
time_t
 
	mu±ime
;

57 
	mty≥
;

60 
	mèbÀ
;

63 
u_öt32_t
 
	mmëric
;

66 
u_ch¨
 
	mdi°™˚
;

72 
u_ch¨
 
	mÊags
;

75 
u_ch¨
 
	m°©us
;

76 
	#RIB_ENTRY_REMOVED
 (1 << 0)

	)

79 
u_ch¨
 
	m√xth›_num
;

80 
u_ch¨
 
	m√xth›_a˘ive_num
;

81 
u_ch¨
 
	m√xth›_fib_num
;

91 
	#MQ_SIZE
 5

	)

92 
	smëa_queue


94 
li°
 *
	msubq
[
MQ_SIZE
];

95 
u_öt32_t
 
	msize
;

101 
	srib_de°_t_


108 
rouã_node
 *
	m∫ode
;

113 
rib
 *
	mrouãs
;

118 
u_öt32_t
 
	mÊags
;

123 
TAILQ_ENTRY
(
rib_de°_t_
Ë
	mÂm_q_íåõs
;

125 } 
	trib_de°_t
;

127 
	#RIB_ROUTE_QUEUED
(
x
Ë(1 << (x))

	)

132 
	#ZEBRA_MAX_QINDEX
 (
MQ_SIZE
 - 1)

	)

138 
	#RIB_DEST_SENT_TO_FPM
 (1 << (
ZEBRA_MAX_QINDEX
 + 1))

	)

144 
	#RIB_DEST_UPDATE_FPM
 (1 << (
ZEBRA_MAX_QINDEX
 + 2))

	)

149 
	#RIB_DEST_FOREACH_ROUTE
(
de°
, 
rib
) \

150 (
rib
Ë(
de°
Ë? (de°)->
rouãs
 : 
NULL
; (rib); (ribË‘ib)->
√xt
)

	)

155 
	#RIB_DEST_FOREACH_ROUTE_SAFE
(
de°
, 
rib
, 
√xt
) \

156 (
rib
Ë(
de°
Ë? (de°)->
rouãs
 : 
NULL
; \

157 (
rib
Ë&& ((
√xt
) = (rib)->next, 1); \

158 (
rib
Ë(
√xt
))

	)

160 
	#RNODE_FOREACH_RIB
(
∫
, 
rib
) \

161 
	`RIB_DEST_FOREACH_ROUTE
 (
	`rib_de°_‰om_∫ode
 (
∫
), 
rib
)

	)

163 
	#RNODE_FOREACH_RIB_SAFE
(
∫
, 
rib
, 
√xt
) \

164 
	`RIB_DEST_FOREACH_ROUTE_SAFE
 (
	`rib_de°_‰om_∫ode
 (
∫
), 
rib
, 
√xt
)

	)

167 
	s°©ic_ùv4


170 
°©ic_ùv4
 *
	m¥ev
;

171 
°©ic_ùv4
 *
	m√xt
;

174 
u_ch¨
 
	mdi°™˚
;

177 
u_ch¨
 
	mty≥
;

178 
	#STATIC_IPV4_GATEWAY
 1

	)

179 
	#STATIC_IPV4_IFNAME
 2

	)

180 
	#STATIC_IPV4_BLACKHOLE
 3

	)

185 
ö_addr
 
	mùv4
;

186 *
	mi‚ame
;

187 } 
	mg©e
;

190 
u_ch¨
 
	mÊags
;

197 #ifde‡
HAVE_IPV6


199 
	s°©ic_ùv6


202 
°©ic_ùv6
 *
	m¥ev
;

203 
°©ic_ùv6
 *
	m√xt
;

206 
u_ch¨
 
	mdi°™˚
;

209 
u_ch¨
 
	mty≥
;

210 
	#STATIC_IPV6_GATEWAY
 1

	)

211 
	#STATIC_IPV6_GATEWAY_IFNAME
 2

	)

212 
	#STATIC_IPV6_IFNAME
 3

	)

215 
ö6_addr
 
	mùv6
;

216 *
	mi‚ame
;

219 
u_ch¨
 
	mÊags
;

227 
	e√xth›_ty≥s_t


229 
	mNEXTHOP_TYPE_IFINDEX
 = 1,

230 
	mNEXTHOP_TYPE_IFNAME
,

231 
	mNEXTHOP_TYPE_IPV4
,

232 
	mNEXTHOP_TYPE_IPV4_IFINDEX
,

233 
	mNEXTHOP_TYPE_IPV4_IFNAME
,

234 
	mNEXTHOP_TYPE_IPV6
,

235 
	mNEXTHOP_TYPE_IPV6_IFINDEX
,

236 
	mNEXTHOP_TYPE_IPV6_IFNAME
,

237 
	mNEXTHOP_TYPE_BLACKHOLE
,

241 
	s√xth›


243 
√xth›
 *
	m√xt
;

244 
√xth›
 *
	m¥ev
;

247 *
	mi‚ame
;

248 
	mifödex
;

250 
√xth›_ty≥s_t
 
	mty≥
;

252 
u_ch¨
 
	mÊags
;

253 
	#NEXTHOP_FLAG_ACTIVE
 (1 << 0Ë

	)

254 
	#NEXTHOP_FLAG_FIB
 (1 << 1Ë

	)

255 
	#NEXTHOP_FLAG_RECURSIVE
 (1 << 2Ë

	)

258 
g_addr
 
	mg©e
;

261 
u_ch¨
 
	mπy≥
;

262 
	mrifödex
;

263 
g_addr
 
	mrg©e
;

264 
g_addr
 
	m§c
;

268 
	svrf


271 
u_öt32_t
 
	mid
;

274 *
	m«me
;

277 *
	mdesc
;

280 
u_ch¨
 
	mfib_id
;

283 
rouã_èbÀ
 *
	mèbÀ
[
AFI_MAX
][
SAFI_MAX
];

286 
rouã_èbÀ
 *
	m°abÀ
[
AFI_MAX
][
SAFI_MAX
];

295 
	srib_èbÀ_öfo_t_


301 
vrf
 *
	mvrf
;

302 
afi_t
 
	mafi
;

303 
ßfi_t
 
	mßfi
;

305 } 
	trib_èbÀ_öfo_t
;

309 
	mRIB_TABLES_ITER_S_INIT
,

310 
	mRIB_TABLES_ITER_S_ITERATING
,

311 
	mRIB_TABLES_ITER_S_DONE


312 } 
	trib_èbÀs_ôî_°©e_t
;

318 
	srib_èbÀs_ôî_t_


320 
uöt32_t
 
	mvrf_id
;

321 
	mafi_ßfi_ix
;

323 
rib_èbÀs_ôî_°©e_t
 
	m°©e
;

324 } 
	trib_èbÀs_ôî_t
;

326 c⁄° *
√xth›_ty≥_to_°r
 (
√xth›_ty≥s_t
 
nh_ty≥
);

327 
√xth›
 *
√xth›_ifödex_add
 (
rib
 *, );

328 
√xth›
 *
√xth›_i‚ame_add
 (
rib
 *, *);

329 
√xth›
 *
√xth›_bœckhﬁe_add
 (
rib
 *);

330 
√xth›
 *
√xth›_ùv4_add
 (
rib
 *, 
ö_addr
 *,

331 
ö_addr
 *);

332 
√xth›
 *
√xth›_ùv4_ifödex_add
 (
rib
 *,

333 
ö_addr
 *,

334 
ö_addr
 *,

336 
rib_lookup_™d_dump
 (
¥efix_ùv4
 *);

337 
rib_lookup_™d_pushup
 (
¥efix_ùv4
 *);

338 
rib_dump
 (c⁄° *, c⁄° 
¥efix_ùv4
 *, c⁄° 
rib
 *);

339 
rib_lookup_ùv4_rouã
 (
¥efix_ùv4
 *, 
sockuni⁄
 *);

340 
	#ZEBRA_RIB_LOOKUP_ERROR
 -1

	)

341 
	#ZEBRA_RIB_FOUND_EXACT
 0

	)

342 
	#ZEBRA_RIB_FOUND_NOGATE
 1

	)

343 
	#ZEBRA_RIB_FOUND_CONNECTED
 2

	)

344 
	#ZEBRA_RIB_NOTFOUND
 3

	)

346 #ifde‡
HAVE_IPV6


347 
√xth›
 *
√xth›_ùv6_add
 (
rib
 *, 
ö6_addr
 *);

350 
vrf
 *
vrf_lookup
 (
u_öt32_t
);

351 
rouã_èbÀ
 *
vrf_èbÀ
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
id
);

352 
rouã_èbÀ
 *
vrf_°©ic_èbÀ
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
id
);

357 
rib_add_ùv4
 (
ty≥
, 
Êags
, 
¥efix_ùv4
 *
p
,

358 
ö_addr
 *
g©e
, ö_add∏*
§c
,

359 
ifödex
, 
u_öt32_t
 
vrf_id
,

360 
u_öt32_t
, 
u_ch¨
, 
ßfi_t
);

362 
rib_add_ùv4_mu…ù©h
 (
¥efix_ùv4
 *, 
rib
 *, 
ßfi_t
);

364 
rib_dñëe_ùv4
 (
ty≥
, 
Êags
, 
¥efix_ùv4
 *
p
,

365 
ö_addr
 *
g©e
, 
ifödex
,

366 
u_öt32_t
, 
ßfi_t
 
ßfi
);

368 
rib
 *
rib_m©ch_ùv4
 (
ö_addr
);

370 
rib
 *
rib_lookup_ùv4
 (
¥efix_ùv4
 *);

372 
rib_upd©e
 ();

373 
rib_wìd_èbÀs
 ();

374 
rib_swìp_rouã
 ();

375 
rib_˛o£
 ();

376 
rib_öô
 ();

377 
rib_sc‹e_¥Ÿo
 (
u_ch¨
 
¥Ÿo
);

380 
°©ic_add_ùv4
 (
¥efix
 *
p
, 
ö_addr
 *
g©e
, c⁄° *
i‚ame
,

381 
u_ch¨
 
Êags
, u_ch¨ 
di°™˚
, 
u_öt32_t
 
vrf_id
);

384 
°©ic_dñëe_ùv4
 (
¥efix
 *
p
, 
ö_addr
 *
g©e
, c⁄° *
i‚ame
,

385 
u_ch¨
 
di°™˚
, 
u_öt32_t
 
vrf_id
);

387 #ifde‡
HAVE_IPV6


389 
rib_add_ùv6
 (
ty≥
, 
Êags
, 
¥efix_ùv6
 *
p
,

390 
ö6_addr
 *
g©e
, 
ifödex
, 
u_öt32_t
 
vrf_id
,

391 
u_öt32_t
 
mëric
, 
u_ch¨
 
di°™˚
, 
ßfi_t
 
ßfi
);

394 
rib_dñëe_ùv6
 (
ty≥
, 
Êags
, 
¥efix_ùv6
 *
p
,

395 
ö6_addr
 *
g©e
, 
ifödex
, 
u_öt32_t
 
vrf_id
, 
ßfi_t
 
ßfi
);

397 
rib
 *
rib_lookup_ùv6
 (
ö6_addr
 *);

399 
rib
 *
rib_m©ch_ùv6
 (
ö6_addr
 *);

401 
rouã_èbÀ
 *
rib_èbÀ_ùv6
;

404 
°©ic_add_ùv6
 (
¥efix
 *
p
, 
u_ch¨
 
ty≥
, 
ö6_addr
 *
g©e
,

405 c⁄° *
i‚ame
, 
u_ch¨
 
Êags
, u_ch¨ 
di°™˚
,

406 
u_öt32_t
 
vrf_id
);

409 
°©ic_dñëe_ùv6
 (
¥efix
 *
p
, 
u_ch¨
 
ty≥
, 
ö6_addr
 *
g©e
,

410 c⁄° *
i‚ame
, 
u_ch¨
 
di°™˚
, 
u_öt32_t
 
vrf_id
);

414 
rib_gc_de°
 (
rouã_node
 *
∫
);

415 
rouã_èbÀ
 *
rib_èbÀs_ôî_√xt
 (
rib_èbÀs_ôî_t
 *
ôî
);

424 
ölöe
 
rib_èbÀ_öfo_t
 *

425 
	$rib_èbÀ_öfo
 (
rouã_èbÀ
 *
èbÀ
)

427  (
rib_èbÀ_öfo_t
 *Ë
èbÀ
->
öfo
;

428 
	}
}

433 
ölöe
 
rib_de°_t
 *

434 
	$rib_de°_‰om_∫ode
 (
rouã_node
 *
∫
)

436  (
rib_de°_t
 *Ë
∫
->
öfo
;

437 
	}
}

445 
ölöe
 
rib
 *

446 
	$∫ode_to_ribs
 (
rouã_node
 *
∫
)

448 
rib_de°_t
 *
de°
;

450 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫
);

451 i‡(!
de°
)

452  
NULL
;

454  
de°
->
rouãs
;

455 
	}
}

460 
ölöe
 
¥efix
 *

461 
	$rib_de°_¥efix
 (
rib_de°_t
 *
de°
)

463  &
de°
->
∫ode
->
p
;

464 
	}
}

471 
ölöe
 
u_ch¨


472 
	$rib_de°_af
 (
rib_de°_t
 *
de°
)

474  
de°
->
∫ode
->
p
.
Ámûy
;

475 
	}
}

480 
ölöe
 
rouã_èbÀ
 *

481 
	$rib_de°_èbÀ
 (
rib_de°_t
 *
de°
)

483  
de°
->
∫ode
->
èbÀ
;

484 
	}
}

489 
ölöe
 
vrf
 *

490 
	$rib_de°_vrf
 (
rib_de°_t
 *
de°
)

492  
	`rib_èbÀ_öfo
 (
	`rib_de°_èbÀ
 (
de°
))->
vrf
;

493 
	}
}

498 
ölöe
 

499 
	$rib_èbÀs_ôî_öô
 (
rib_èbÀs_ôî_t
 *
ôî
)

502 
	`mem£t
 (
ôî
, 0,  (*iter));

503 
ôî
->
°©e
 = 
RIB_TABLES_ITER_S_INIT
;

504 
	}
}

512 
ölöe
 

513 
	$rib_èbÀs_ôî_°¨ãd
 (
rib_èbÀs_ôî_t
 *
ôî
)

515  
ôî
->
°©e
 !
RIB_TABLES_ITER_S_INIT
;

516 
	}
}

521 
ölöe
 

522 
	$rib_èbÀs_ôî_˛ónup
 (
rib_èbÀs_ôî_t
 *
ôî
)

524 
ôî
->
°©e
 = 
RIB_TABLES_ITER_S_DONE
;

525 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/router-id.c

24 
	~<zebø.h
>

26 
	~"if.h
"

27 
	~"vty.h
"

28 
	~"sockuni⁄.h
"

29 
	~"¥efix.h
"

30 
	~"°ªam.h
"

31 
	~"comm™d.h
"

32 
	~"mem‹y.h
"

33 
	~"io˘l.h
"

34 
	~"c⁄√˘ed.h
"

35 
	~"√tw‹k.h
"

36 
	~"log.h
"

37 
	~"èbÀ.h
"

38 
	~"rib.h
"

40 
	~"zebø/z£rv.h
"

41 
	~"zebø/rouãr-id.h
"

42 
	~"zebø/ªdi°ribuã.h
"

44 
li°
 
	grid_Æl_s‹ãd_li°
;

45 
li°
 
	grid_lo_s‹ãd_li°
;

46 
¥efix
 
	grid_u£r_assig√d
;

49 
zebø_t
 
zebød
;

51 
c⁄√˘ed
 *

52 
	$rouãr_id_föd_node
 (
li°
 *
l
, 
c⁄√˘ed
 *
ifc
)

54 
li°node
 *
node
;

55 
c⁄√˘ed
 *
c
;

57 
	`ALL_LIST_ELEMENTS_RO
 (
l
, 
node
, 
c
))

58 i‡(
	`¥efix_ßme
 (
ifc
->
addªss
, 
c
->address))

59  
c
;

61  
NULL
;

62 
	}
}

65 
	$rouãr_id_bad_addªss
 (
c⁄√˘ed
 *
ifc
)

67 i‡(
ifc
->
addªss
->
Ámûy
 !
AF_INET
)

71 i‡(!
	`zebø_check_addr
 (
ifc
->
addªss
))

75 
	}
}

78 
	$rouãr_id_gë
 (
¥efix
 *
p
)

80 
li°node
 *
node
;

81 
c⁄√˘ed
 *
c
;

83 
p
->
u
.
¥efix4
.
s_addr
 = 0;

84 
p
->
Ámûy
 = 
AF_INET
;

85 
p
->
¥efixÀn
 = 32;

87 i‡(
rid_u£r_assig√d
.
u
.
¥efix4
.
s_addr
)

88 
p
->
u
.
¥efix4
.
s_addr
 = 
rid_u£r_assig√d
.u.prefix4.s_addr;

89 i‡(!
	`li°_i£m±y
 (&
rid_lo_s‹ãd_li°
))

91 
node
 = 
	`li°èû
 (&
rid_lo_s‹ãd_li°
);

92 
c
 = 
	`li°gëd©a
 (
node
);

93 
p
->
u
.
¥efix4
.
s_addr
 = 
c
->
addªss
->u.prefix4.s_addr;

95 i‡(!
	`li°_i£m±y
 (&
rid_Æl_s‹ãd_li°
))

97 
node
 = 
	`li°èû
 (&
rid_Æl_s‹ãd_li°
);

98 
c
 = 
	`li°gëd©a
 (
node
);

99 
p
->
u
.
¥efix4
.
s_addr
 = 
c
->
addªss
->u.prefix4.s_addr;

101 
	}
}

104 
	$rouãr_id_£t
 (
¥efix
 *
p
)

106 
¥efix
 
p2
;

107 
li°node
 *
node
;

108 
z£rv
 *
˛õ¡
;

110 
rid_u£r_assig√d
.
u
.
¥efix4
.
s_addr
 = 
p
->u.prefix4.s_addr;

112 
	`rouãr_id_gë
 (&
p2
);

114 
	`ALL_LIST_ELEMENTS_RO
 (
zebød
.
˛õ¡_li°
, 
node
, 
˛õ¡
))

115 
	`z£nd_rouãr_id_upd©e
 (
˛õ¡
, &
p2
);

116 
	}
}

119 
	$rouãr_id_add_addªss
 (
c⁄√˘ed
 *
ifc
)

121 
li°
 *
l
 = 
NULL
;

122 
li°node
 *
node
;

123 
¥efix
 
bef‹e
;

124 
¥efix
 
a·î
;

125 
z£rv
 *
˛õ¡
;

127 i‡(
	`rouãr_id_bad_addªss
 (
ifc
))

130 
	`rouãr_id_gë
 (&
bef‹e
);

132 i‡(!
	`°∫cmp
 (
ifc
->
iÂ
->
«me
, "lo", 2)

133 || !
	`°∫cmp
 (
ifc
->
iÂ
->
«me
, "dummy", 5))

134 
l
 = &
rid_lo_s‹ãd_li°
;

136 
l
 = &
rid_Æl_s‹ãd_li°
;

138 i‡(!
	`rouãr_id_föd_node
 (
l
, 
ifc
))

139 
	`li°node_add_s‹t
 (
l
, 
ifc
);

141 
	`rouãr_id_gë
 (&
a·î
);

143 i‡(
	`¥efix_ßme
 (&
bef‹e
, &
a·î
))

146 
	`ALL_LIST_ELEMENTS_RO
 (
zebød
.
˛õ¡_li°
, 
node
, 
˛õ¡
))

147 
	`z£nd_rouãr_id_upd©e
 (
˛õ¡
, &
a·î
);

148 
	}
}

151 
	$rouãr_id_dñ_addªss
 (
c⁄√˘ed
 *
ifc
)

153 
c⁄√˘ed
 *
c
;

154 
li°
 *
l
;

155 
¥efix
 
a·î
;

156 
¥efix
 
bef‹e
;

157 
li°node
 *
node
;

158 
z£rv
 *
˛õ¡
;

160 i‡(
	`rouãr_id_bad_addªss
 (
ifc
))

163 
	`rouãr_id_gë
 (&
bef‹e
);

165 i‡(!
	`°∫cmp
 (
ifc
->
iÂ
->
«me
, "lo", 2)

166 || !
	`°∫cmp
 (
ifc
->
iÂ
->
«me
, "dummy", 5))

167 
l
 = &
rid_lo_s‹ãd_li°
;

169 
l
 = &
rid_Æl_s‹ãd_li°
;

171 i‡((
c
 = 
	`rouãr_id_föd_node
 (
l
, 
ifc
)))

172 
	`li°node_dñëe
 (
l
, 
c
);

174 
	`rouãr_id_gë
 (&
a·î
);

176 i‡(
	`¥efix_ßme
 (&
bef‹e
, &
a·î
))

179 
	`ALL_LIST_ELEMENTS_RO
 (
zebød
.
˛õ¡_li°
, 
node
, 
˛õ¡
))

180 
	`z£nd_rouãr_id_upd©e
 (
˛õ¡
, &
a·î
);

181 
	}
}

184 
	$rouãr_id_wrôe
 (
vty
 *vty)

186 i‡(
rid_u£r_assig√d
.
u
.
¥efix4
.
s_addr
)

187 
	`vty_out
 (
vty
, "rouãr-id %s%s", 
	`öë_¡ﬂ
 (
rid_u£r_assig√d
.
u
.
¥efix4
),

188 
VTY_NEWLINE
);

189 
	}
}

191 
DEFUN
 (
rouãr_id
,

192 
rouãr_id_cmd
,

197 
¥efix
 
	grid
;

199 
	grid
.
	gu
.
	g¥efix4
.
	gs_addr
 = 
öë_addr
 (
¨gv
[0]);

200 i‡(!
	grid
.
	gu
.
	g¥efix4
.
	gs_addr
)

201  
	gCMD_WARNING
;

203 
	grid
.
	g¥efixÀn
 = 32;

204 
	grid
.
	gÁmûy
 = 
AF_INET
;

206 
rouãr_id_£t
 (&
rid
);

208  
	gCMD_SUCCESS
;

211 
DEFUN
 (
no_rouãr_id
,

212 
no_rouãr_id_cmd
,

214 
NO_STR


217 
¥efix
 
	grid
;

219 
	grid
.
	gu
.
	g¥efix4
.
	gs_addr
 = 0;

220 
	grid
.
	g¥efixÀn
 = 0;

221 
	grid
.
	gÁmûy
 = 
AF_INET
;

223 
rouãr_id_£t
 (&
rid
);

225  
	gCMD_SUCCESS
;

229 
	$rouãr_id_cmp
 (*
a
, *
b
)

231 c⁄° 
c⁄√˘ed
 *
iÁ
 = (c⁄° c⁄√˘ed *)
a
;

232 c⁄° 
c⁄√˘ed
 *
ifb
 = (c⁄° c⁄√˘ed *)
b
;

233 
A
 = 
	`¡ohl
(
iÁ
->
addªss
->
u
.
¥efix4
.
s_addr
);

234 
B
 = 
	`¡ohl
(
ifb
->
addªss
->
u
.
¥efix4
.
s_addr
);

236  (Ë(
A
 - 
B
);

237 
	}
}

240 
	$rouãr_id_öô
 ()

242 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
rouãr_id_cmd
);

243 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_rouãr_id_cmd
);

245 
	`mem£t
 (&
rid_Æl_s‹ãd_li°
, 0,  (rid_all_sorted_list));

246 
	`mem£t
 (&
rid_lo_s‹ãd_li°
, 0,  (rid_lo_sorted_list));

247 
	`mem£t
 (&
rid_u£r_assig√d
, 0,  (rid_user_assigned));

249 
rid_Æl_s‹ãd_li°
.
cmp
 = 
rouãr_id_cmp
;

250 
rid_lo_s‹ãd_li°
.
cmp
 = 
rouãr_id_cmp
;

252 
rid_u£r_assig√d
.
Ámûy
 = 
AF_INET
;

253 
rid_u£r_assig√d
.
¥efixÀn
 = 32;

254 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/router-id.h

24 #i‚de‡
_ROUTER_ID_H_


25 
	#_ROUTER_ID_H_


	)

27 
	~<zebø.h
>

29 
	~"mem‹y.h
"

30 
	~"¥efix.h
"

31 
	~"z˛õ¡.h
"

32 
	~"if.h
"

34 
rouãr_id_add_addªss
(
c⁄√˘ed
 *);

35 
rouãr_id_dñ_addªss
(
c⁄√˘ed
 *);

36 
rouãr_id_öô
();

37 
rouãr_id_wrôe
(
vty
 *);

38 
rouãr_id_gë
(
¥efix
 *);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt.h

23 #i‚de‡
_ZEBRA_RT_H


24 
	#_ZEBRA_RT_H


	)

26 
	~"¥efix.h
"

27 
	~"if.h
"

28 
	~"zebø/rib.h
"

30 
kî√l_add_ùv4
 (
¥efix
 *, 
rib
 *);

31 
kî√l_dñëe_ùv4
 (
¥efix
 *, 
rib
 *);

32 
kî√l_add_rouã
 (
¥efix_ùv4
 *, 
ö_addr
 *, , );

33 
kî√l_addªss_add_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

34 
kî√l_addªss_dñëe_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

36 #ifde‡
HAVE_IPV6


37 
kî√l_add_ùv6
 (
¥efix
 *, 
rib
 *);

38 
kî√l_dñëe_ùv6
 (
¥efix
 *, 
rib
 *);

39 
kî√l_dñëe_ùv6_ﬁd
 (
¥efix_ùv6
 *
de°
, 
ö6_addr
 *
g©e
,

40 
ödex
, 
Êags
, 
èbÀ
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_ioctl.c

23 
	~<zebø.h
>

25 
	~"¥efix.h
"

26 
	~"log.h
"

27 
	~"if.h
"

29 
	~"zebø/z£rv.h
"

30 
	~"zebø/rib.h
"

31 
	~"zebø/debug.h
"

32 
	~"zebø/π.h
"

37 
	$kî√l_öô
 ()

40 
	}
}

44 
	$kî√l_ªad
 (
sock
)

47 
	}
}

51 
sockaddr_ö
 
	gsö_¥Ÿo
 =

53 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


54  (
sockaddr_ö
),

56 
AF_INET
, 0, {0}, {0}

61 #ifde‡
HAVE_OLD_RTENTRY


62 
	#πíåy
 
‹ã¡ry


	)

67 
	$kî√l_add_rouã
 (
¥efix_ùv4
 *
de°
, 
ö_addr
 *
g©e
,

68 
ödex
, 
Êags
)

70 
ªt
;

71 
sock
;

72 
πíåy
Ñtentry;

73 
sockaddr_ö
 
sö_de°
, 
sö_mask
, 
sö_g©e
;

75 
	`mem£t
 (&
πíåy
, 0,  (rtentry));

78 
	`mem£t
 (&
sö_de°
, 0,  (
sockaddr_ö
));

79 
sö_de°
.
sö_Ámûy
 = 
AF_INET
;

80 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


81 
sö_de°
.
sö_Àn
 =  (
sockaddr_ö
);

83 
sö_de°
.
sö_addr
 = 
de°
->
¥efix
;

86 i‡(
g©e
)

88 
	`mem£t
 (&
sö_g©e
, 0,  (
sockaddr_ö
));

89 
sö_g©e
.
sö_Ámûy
 = 
AF_INET
;

90 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


91 
sö_g©e
.
sö_Àn
 =  (
sockaddr_ö
);

93 
sö_g©e
.
sö_addr
 = *
g©e
;

96 
	`mem£t
 (&
sö_mask
, 0,  (
sockaddr_ö
));

97 
sö_mask
.
sö_Ámûy
 = 
AF_INET
;

98 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


99 
sö_g©e
.
sö_Àn
 =  (
sockaddr_ö
);

101 
	`maskÀn2ù
 (
de°
->
¥efixÀn
, &
sö_mask
.
sö_addr
);

104 
	`mem˝y
 (&
πíåy
.
π_d°
, &
sö_de°
,  (
sockaddr_ö
));

105 i‡(
g©e
)

106 
	`mem˝y
 (&
πíåy
.
π_g©eway
, &
sö_g©e
,  (
sockaddr_ö
));

107 #i‚de‡
SUNOS_5


108 
	`mem˝y
 (&
πíåy
.
π_gímask
, &
sö_mask
,  (
sockaddr_ö
));

112 i‡(
de°
->
¥efixÀn
 == 32)

113 
πíåy
.
π_Êags
 |
RTF_HOST
;

115 i‡(
g©e
 && g©e->
s_addr
 !
INADDR_ANY
)

116 
πíåy
.
π_Êags
 |
RTF_GATEWAY
;

118 
πíåy
.
π_Êags
 |
RTF_UP
;

121 
πíåy
.
π_Êags
 |
Êags
;

128 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_DGRAM
, 0);

129 i‡(
sock
 < 0)

131 
	`zlog_w¨n
 ("can't make socket\n");

136 
ªt
 = 
	`io˘l
 (
sock
, 
SIOCADDRT
, &
πíåy
);

137 i‡(
ªt
 < 0)

139 
î∫o
)

141 
EEXIST
:

142 
	`˛o£
 (
sock
);

143  
ZEBRA_ERR_RTEXIST
;

145 
ENETUNREACH
:

146 
	`˛o£
 (
sock
);

147  
ZEBRA_ERR_RTUNREACH
;

149 
EPERM
:

150 
	`˛o£
 (
sock
);

151  
ZEBRA_ERR_EPERM
;

155 
	`˛o£
 (
sock
);

156 
	`zlog_w¨n
 ("wrôê: %†(%d)", 
	`ß„_°ªº‹
 (
î∫o
),Érrno);

159 
	`˛o£
 (
sock
);

161  
ªt
;

162 
	}
}

166 
	$kî√l_io˘l_ùv4
 (
u_l⁄g
 
cmd
, 
¥efix
 *
p
, 
rib
 *rib, 
Ámûy
)

168 
ªt
;

169 
sock
;

170 
πíåy
Ñtentry;

171 
sockaddr_ö
 
sö_de°
, 
sö_mask
, 
sö_g©e
;

172 
√xth›
 *nexthop;

173 
√xth›_num
 = 0;

174 
öãrÁ˚
 *
iÂ
;

176 
	`mem£t
 (&
πíåy
, 0,  (rtentry));

179 
	`mem£t
 (&
sö_de°
, 0,  (
sockaddr_ö
));

180 
sö_de°
.
sö_Ámûy
 = 
AF_INET
;

181 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


182 
sö_de°
.
sö_Àn
 =  (
sockaddr_ö
);

184 
sö_de°
.
sö_addr
 = 
p
->
u
.
¥efix4
;

186 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

188 
	`SET_FLAG
 (
πíåy
.
π_Êags
, 
RTF_REJECT
);

190 i‡(
cmd
 =
SIOCADDRT
)

191 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

192 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

194 
skù
;

197 
	`mem£t
 (&
sö_g©e
, 0,  (
sockaddr_ö
));

200 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

202 i‡((
cmd
 =
SIOCADDRT


203 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

204 || (
cmd
 =
SIOCDELRT


205 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)))

207 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

209 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4
 ||

210 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

212 
sö_g©e
.
sö_Ámûy
 = 
AF_INET
;

213 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


214 
sö_g©e
.
sö_Àn
 =  (
sockaddr_ö
);

216 
sö_g©e
.
sö_addr
 = 
√xth›
->
rg©e
.
ùv4
;

217 
πíåy
.
π_Êags
 |
RTF_GATEWAY
;

219 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX


220 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFNAME
)

222 
iÂ
 = 
	`if_lookup_by_ödex
 (
√xth›
->
rifödex
);

223 i‡(
iÂ
)

224 
πíåy
.
π_dev
 = 
iÂ
->
«me
;

231 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4
 ||

232 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

234 
sö_g©e
.
sö_Ámûy
 = 
AF_INET
;

235 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


236 
sö_g©e
.
sö_Àn
 =  (
sockaddr_ö
);

238 
sö_g©e
.
sö_addr
 = 
√xth›
->
g©e
.
ùv4
;

239 
πíåy
.
π_Êags
 |
RTF_GATEWAY
;

241 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


242 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME
)

244 
iÂ
 = 
	`if_lookup_by_ödex
 (
√xth›
->
ifödex
);

245 i‡(
iÂ
)

246 
πíåy
.
π_dev
 = 
iÂ
->
«me
;

252 i‡(
cmd
 =
SIOCADDRT
)

253 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

255 
√xth›_num
++;

261 i‡(
√xth›_num
 == 0)

263 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

264 
	`zlog_debug
 ("netlink_route_multipath(): No usefulÇexthop.");

268 
skù
:

270 
	`mem£t
 (&
sö_mask
, 0,  (
sockaddr_ö
));

271 
sö_mask
.
sö_Ámûy
 = 
AF_INET
;

272 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


273 
sö_mask
.
sö_Àn
 =  (
sockaddr_ö
);

275 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
sö_mask
.
sö_addr
);

278 
	`mem˝y
 (&
πíåy
.
π_d°
, &
sö_de°
,  (
sockaddr_ö
));

280 i‡(
πíåy
.
π_Êags
 & 
RTF_GATEWAY
)

281 
	`mem˝y
 (&
πíåy
.
π_g©eway
, &
sö_g©e
,  (
sockaddr_ö
));

283 #i‚de‡
SUNOS_5


284 
	`mem˝y
 (&
πíåy
.
π_gímask
, &
sö_mask
,  (
sockaddr_ö
));

288 
πíåy
.
π_mëric
 = 
rib
->
mëric
;

291 i‡(
p
->
¥efixÀn
 == 32)

292 
πíåy
.
π_Êags
 |
RTF_HOST
;

294 
πíåy
.
π_Êags
 |
RTF_UP
;

303 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_DGRAM
, 0);

304 i‡(
sock
 < 0)

306 
	`zlog_w¨n
 ("can't make socket\n");

311 
ªt
 = 
	`io˘l
 (
sock
, 
cmd
, &
πíåy
);

312 i‡(
ªt
 < 0)

314 
î∫o
)

316 
EEXIST
:

317 
	`˛o£
 (
sock
);

318  
ZEBRA_ERR_RTEXIST
;

320 
ENETUNREACH
:

321 
	`˛o£
 (
sock
);

322  
ZEBRA_ERR_RTUNREACH
;

324 
EPERM
:

325 
	`˛o£
 (
sock
);

326  
ZEBRA_ERR_EPERM
;

330 
	`˛o£
 (
sock
);

331 
	`zlog_w¨n
 ("wrôê: %†(%d)", 
	`ß„_°ªº‹
 (
î∫o
),Érrno);

332  
ªt
;

334 
	`˛o£
 (
sock
);

336  
ªt
;

337 
	}
}

340 
	$kî√l_add_ùv4
 (
¥efix
 *
p
, 
rib
 *rib)

342  
	`kî√l_io˘l_ùv4
 (
SIOCADDRT
, 
p
, 
rib
, 
AF_INET
);

343 
	}
}

346 
	$kî√l_dñëe_ùv4
 (
¥efix
 *
p
, 
rib
 *rib)

348  
	`kî√l_io˘l_ùv4
 (
SIOCDELRT
, 
p
, 
rib
, 
AF_INET
);

349 
	}
}

351 #ifde‡
HAVE_IPV6


354 #unde‡
RTF_DEFAULT


355 #unde‡
RTF_ADDRCONF


357 
	~<asm/ty≥s.h
>

359 #i‡
deföed
(
__GLIBC__
Ë&& __GLIBC__ >2 && 
__GLIBC_MINOR__
 >= 1

362 
	~<löux/ùv6_rouã.h
>

366 
	$kî√l_io˘l_ùv6
 (
u_l⁄g
 
ty≥
, 
¥efix_ùv6
 *
de°
, 
ö6_addr
 *
g©e
,

367 
ödex
, 
Êags
)

369 
ªt
;

370 
sock
;

371 
ö6_πmsg
 
πm
;

373 
	`mem£t
 (&
πm
, 0,  (
ö6_πmsg
));

375 
πm
.
πmsg_Êags
 |
RTF_UP
;

376 
πm
.
πmsg_mëric
 = 1;

377 
	`mem˝y
 (&
πm
.
πmsg_d°
, &
de°
->
¥efix
,  (
ö6_addr
));

378 
πm
.
πmsg_d°_Àn
 = 
de°
->
¥efixÀn
;

390 
πm
.
πmsg_Êags
 |
RTF_GATEWAY
;

395 
	`mem˝y
 (&
πm
.
πmsg_g©eway
, 
g©e
,  (
ö6_addr
));

397 i‡(
ödex
)

398 
πm
.
πmsg_ifödex
 = 
ödex
;

400 
πm
.
πmsg_ifödex
 = 0;

402 
πm
.
πmsg_mëric
 = 1;

404 
sock
 = 
	`sockë
 (
AF_INET6
, 
SOCK_DGRAM
, 0);

405 i‡(
sock
 < 0)

407 
	`zlog_w¨n
 ("can't make socket\n");

412 
ªt
 = 
	`io˘l
 (
sock
, 
ty≥
, &
πm
);

413 i‡(
ªt
 < 0)

415 
	`zlog_w¨n
 ("ˇn'à%†ùv6Ñouã: %s\n", 
ty≥
 =
SIOCADDRT
 ? "add" : "delete",

416 
	`ß„_°ªº‹
(
î∫o
));

417 
ªt
 = 
î∫o
;

418 
	`˛o£
 (
sock
);

419  
ªt
;

421 
	`˛o£
 (
sock
);

423  
ªt
;

424 
	}
}

427 
	$kî√l_io˘l_ùv6_mu…ù©h
 (
u_l⁄g
 
cmd
, 
¥efix
 *
p
, 
rib
 *rib,

428 
Ámûy
)

430 
ªt
;

431 
sock
;

432 
ö6_πmsg
 
πm
;

433 
√xth›
 *nexthop;

434 
√xth›_num
 = 0;

436 
	`mem£t
 (&
πm
, 0,  (
ö6_πmsg
));

438 
πm
.
πmsg_Êags
 |
RTF_UP
;

439 
πm
.
πmsg_mëric
 = 
rib
->
mëric
;

440 
	`mem˝y
 (&
πm
.
πmsg_d°
, &
p
->
u
.
¥efix
,  (
ö6_addr
));

441 
πm
.
πmsg_d°_Àn
 = 
p
->
¥efixÀn
;

453 
πm
.
πmsg_Êags
 |
RTF_GATEWAY
;

459 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

461 i‡((
cmd
 =
SIOCADDRT


462 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

463 || (
cmd
 =
SIOCDELRT


464 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)))

466 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

468 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6


469 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


470 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

472 
	`mem˝y
 (&
πm
.
πmsg_g©eway
, &
√xth›
->
rg©e
.
ùv6
,

473  (
ö6_addr
));

475 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX


476 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFNAME


477 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


478 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

479 
πm
.
πmsg_ifödex
 = 
√xth›
->
rifödex
;

481 
πm
.
πmsg_ifödex
 = 0;

486 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6


487 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


488 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

490 
	`mem˝y
 (&
πm
.
πmsg_g©eway
, &
√xth›
->
g©e
.
ùv6
,

491  (
ö6_addr
));

493 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


494 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


495 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


496 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

497 
πm
.
πmsg_ifödex
 = 
√xth›
->
ifödex
;

499 
πm
.
πmsg_ifödex
 = 0;

502 i‡(
cmd
 =
SIOCADDRT
)

503 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

505 
√xth›_num
++;

511 i‡(
√xth›_num
 == 0)

513 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

514 
	`zlog_debug
 ("netlink_route_multipath(): No usefulÇexthop.");

518 
sock
 = 
	`sockë
 (
AF_INET6
, 
SOCK_DGRAM
, 0);

519 i‡(
sock
 < 0)

521 
	`zlog_w¨n
 ("can't make socket\n");

526 
ªt
 = 
	`io˘l
 (
sock
, 
cmd
, &
πm
);

527 i‡(
ªt
 < 0)

529 
	`zlog_w¨n
 ("can't %s ipv6Ñoute: %s\n",

530 
cmd
 =
SIOCADDRT
 ? "add" : "delete",

531 
	`ß„_°ªº‹
(
î∫o
));

532 
ªt
 = 
î∫o
;

533 
	`˛o£
 (
sock
);

534  
ªt
;

536 
	`˛o£
 (
sock
);

538  
ªt
;

539 
	}
}

542 
	$kî√l_add_ùv6
 (
¥efix
 *
p
, 
rib
 *rib)

544  
	`kî√l_io˘l_ùv6_mu…ù©h
 (
SIOCADDRT
, 
p
, 
rib
, 
AF_INET6
);

545 
	}
}

548 
	$kî√l_dñëe_ùv6
 (
¥efix
 *
p
, 
rib
 *rib)

550  
	`kî√l_io˘l_ùv6_mu…ù©h
 (
SIOCDELRT
, 
p
, 
rib
, 
AF_INET6
);

551 
	}
}

555 
	$kî√l_dñëe_ùv6_ﬁd
 (
¥efix_ùv6
 *
de°
, 
ö6_addr
 *
g©e
,

556 
ödex
, 
Êags
, 
èbÀ
)

558  
	`kî√l_io˘l_ùv6
 (
SIOCDELRT
, 
de°
, 
g©e
, 
ödex
, 
Êags
);

559 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_netlink.c

22 
	~<zebø.h
>

25 #i‚de‡
MSG_TRUNC


26 
	#MSG_TRUNC
 0x20

	)

29 
	~"lökli°.h
"

30 
	~"if.h
"

31 
	~"log.h
"

32 
	~"¥efix.h
"

33 
	~"c⁄√˘ed.h
"

34 
	~"èbÀ.h
"

35 
	~"mem‹y.h
"

36 
	~"rib.h
"

37 
	~"thªad.h
"

38 
	~"¥ivs.h
"

40 
	~"zebø/z£rv.h
"

41 
	~"zebø/π.h
"

42 
	~"zebø/ªdi°ribuã.h
"

43 
	~"zebø/öãrÁ˚.h
"

44 
	~"zebø/debug.h
"

46 
	~"π_√éök.h
"

49 
	s∆sock


51 
	msock
;

52 
	m£q
;

53 
sockaddr_∆
 
	m¢l
;

54 c⁄° *
	m«me
;

55 } 
	g√éök
 = { -1, 0, {0}, "netlink-listen"},

56 
	g√éök_cmd
 = { -1, 0, {0}, "netlink-cmd"};

58 c⁄° 
mesßge
 
	g∆msg_°r
[] = {

59 {
RTM_NEWROUTE
, "RTM_NEWROUTE"},

60 {
RTM_DELROUTE
, "RTM_DELROUTE"},

61 {
RTM_GETROUTE
, "RTM_GETROUTE"},

62 {
RTM_NEWLINK
, "RTM_NEWLINK"},

63 {
RTM_DELLINK
, "RTM_DELLINK"},

64 {
RTM_GETLINK
, "RTM_GETLINK"},

65 {
RTM_NEWADDR
, "RTM_NEWADDR"},

66 {
RTM_DELADDR
, "RTM_DELADDR"},

67 {
RTM_GETADDR
, "RTM_GETADDR"},

68 {0, 
NULL
}

71 
zebø_t
 
zebød
;

73 
zebø_¥ivs_t
 
z£rv_¥ivs
;

75 
u_öt32_t
 
∆_rcvbufsize
;

80 
	$£t_ifödex
(
öãrÁ˚
 *
iÂ
, 
ifi_ödex
)

82 
öãrÁ˚
 *
oiÂ
;

84 i‡(((
oiÂ
 = 
	`if_lookup_by_ödex
(
ifi_ödex
)Ë!
NULL
Ë&& (oiÂ !
iÂ
))

86 i‡(
ifi_ödex
 =
IFINDEX_INTERNAL
)

87 
	`zlog_îr
("Netlink is setting interface %s ifindexÅoÑeserved "

88 "öã∫Æ vÆuê%u", 
iÂ
->
«me
, 
ifi_ödex
);

91 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

92 
	`zlog_debug
("interface index %d wasÑenamed from %sÅo %s",

93 
ifi_ödex
, 
oiÂ
->
«me
, 
iÂ
->name);

94 i‡(
	`if_is_up
(
oiÂ
))

95 
	`zlog_îr
("interfaceÑename detected on up interface: index %d "

97 
ifi_ödex
, 
oiÂ
->
«me
, 
iÂ
->name);

98 
	`if_dñëe_upd©e
(
oiÂ
);

101 
iÂ
->
ifödex
 = 
ifi_ödex
;

102 
	}
}

105 
	$√éök_ªcvbuf
 (
∆sock
 *
∆
, 
uöt32_t
 
√wsize
)

107 
u_öt32_t
 
ﬁdsize
;

108 
sockÀn_t
 
√wÀn
 = (
√wsize
);

109 
sockÀn_t
 
ﬁdÀn
 = (
ﬁdsize
);

110 
ªt
;

112 
ªt
 = 
	`gësock›t
(
∆
->
sock
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
ﬁdsize
, &
ﬁdÀn
);

113 i‡(
ªt
 < 0)

115 
	`zlog
 (
NULL
, 
LOG_ERR
, "C™'àgë %†ª˚ivêbuf„∏size: %s", 
∆
->
«me
,

116 
	`ß„_°ªº‹
 (
î∫o
));

120 
ªt
 = 
	`£tsock›t
(
∆
->
sock
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
∆_rcvbufsize
,

121 (
∆_rcvbufsize
));

122 i‡(
ªt
 < 0)

124 
	`zlog
 (
NULL
, 
LOG_ERR
, "C™'à£à%†ª˚ivêbuf„∏size: %s", 
∆
->
«me
,

125 
	`ß„_°ªº‹
 (
î∫o
));

129 
ªt
 = 
	`gësock›t
(
∆
->
sock
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
√wsize
, &
√wÀn
);

130 i‡(
ªt
 < 0)

132 
	`zlog
 (
NULL
, 
LOG_ERR
, "C™'àgë %†ª˚ivêbuf„∏size: %s", 
∆
->
«me
,

133 
	`ß„_°ªº‹
 (
î∫o
));

137 
	`zlog
 (
NULL
, 
LOG_INFO
,

139 
ﬁdsize
, 
√wsize
);

141 
	}
}

145 
	$√éök_sockë
 (
∆sock
 *
∆
, 
groups
)

147 
ªt
;

148 
sockaddr_∆
 
¢l
;

149 
sock
;

150 
«mñí
;

151 
ßve_î∫o
;

153 
sock
 = 
	`sockë
 (
AF_NETLINK
, 
SOCK_RAW
, 
NETLINK_ROUTE
);

154 i‡(
sock
 < 0)

156 
	`zlog
 (
NULL
, 
LOG_ERR
, "C™'à›í %†sockë: %s", 
∆
->
«me
,

157 
	`ß„_°ªº‹
 (
î∫o
));

161 
	`mem£t
 (&
¢l
, 0,  snl);

162 
¢l
.
∆_Ámûy
 = 
AF_NETLINK
;

163 
¢l
.
∆_groups
 = 
groups
;

166 i‡(
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
))

168 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

172 
ªt
 = 
	`böd
 (
sock
, (
sockaddr
 *Ë&
¢l
,  snl);

173 
ßve_î∫o
 = 
î∫o
;

174 i‡(
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
))

175 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

177 i‡(
ªt
 < 0)

179 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can't bind %s socketÅo group 0x%x: %s",

180 
∆
->
«me
, 
¢l
.
∆_groups
, 
	`ß„_°ªº‹
 (
ßve_î∫o
));

181 
	`˛o£
 (
sock
);

186 
«mñí
 =  
¢l
;

187 
ªt
 = 
	`gësock«me
 (
sock
, (
sockaddr
 *Ë&
¢l
, (
sockÀn_t
 *Ë&
«mñí
);

188 i‡(
ªt
 < 0 || 
«mñí
 ! 
¢l
)

190 
	`zlog
 (
NULL
, 
LOG_ERR
, "C™'àgë %†sockëÇame: %s", 
∆
->
«me
,

191 
	`ß„_°ªº‹
 (
î∫o
));

192 
	`˛o£
 (
sock
);

196 
∆
->
¢l
 = snl;

197 
∆
->
sock
 = sock;

198  
ªt
;

199 
	}
}

203 
	$√éök_ªque°
 (
Ámûy
, 
ty≥
, 
∆sock
 *
∆
)

205 
ªt
;

206 
sockaddr_∆
 
¢l
;

207 
ßve_î∫o
;

211 
∆msghdr
 
∆h
;

212 
πgímsg
 
g
;

213 } 
ªq
;

217 i‡(
∆
->
sock
 < 0)

219 
	`zlog
 (
NULL
, 
LOG_ERR
, "%†sockë i¢'àa˘ive.", 
∆
->
«me
);

223 
	`mem£t
 (&
¢l
, 0,  snl);

224 
¢l
.
∆_Ámûy
 = 
AF_NETLINK
;

226 
	`mem£t
 (&
ªq
, 0, Ñeq);

227 
ªq
.
∆h
.
∆msg_Àn
 = Ñeq;

228 
ªq
.
∆h
.
∆msg_ty≥
 = 
ty≥
;

229 
ªq
.
∆h
.
∆msg_Êags
 = 
NLM_F_ROOT
 | 
NLM_F_MATCH
 | 
NLM_F_REQUEST
;

230 
ªq
.
∆h
.
∆msg_pid
 = 
∆
->
¢l
.
∆_pid
;

231 
ªq
.
∆h
.
∆msg_£q
 = ++
∆
->
£q
;

232 
ªq
.
g
.
πgí_Ámûy
 = 
Ámûy
;

237 i‡(
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
))

239 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

243 
ªt
 = 
	`£ndto
 (
∆
->
sock
, (*Ë&
ªq
, Ñeq, 0,

244 (
sockaddr
 *Ë&
¢l
,  snl);

245 
ßve_î∫o
 = 
î∫o
;

247 i‡(
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
))

248 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

250 i‡(
ªt
 < 0)

252 
	`zlog
 (
NULL
, 
LOG_ERR
, "%†£ndtÿÁûed: %s", 
∆
->
«me
,

253 
	`ß„_°ªº‹
 (
ßve_î∫o
));

258 
	}
}

263 
√éök_∑r£_öfo
 ((*
fûãr
Ë(
sockaddr_∆
 *, 
∆msghdr
 *),

264 
∆sock
 *
∆
)

266 
°©us
;

267 
ªt
 = 0;

268 
îr‹
;

272 
buf
[
NL_PKT_BUF_SIZE
];

273 
iovec
 
iov
 = { 
buf
,  buf };

274 
sockaddr_∆
 
¢l
;

275 
msghdr
 
msg
 = { (*Ë&
¢l
,  s∆, &
iov
, 1, 
NULL
, 0, 0 };

276 
∆msghdr
 *
h
;

278 
°©us
 = 
	`ªcvmsg
 (
∆
->
sock
, &
msg
, 0);

279 i‡(
°©us
 < 0)

281 i‡(
î∫o
 =
EINTR
)

283 i‡(
î∫o
 =
EWOULDBLOCK
 ||Éºnÿ=
EAGAIN
)

285 
	`zlog
 (
NULL
, 
LOG_ERR
, "%sÑecvmsg overrun: %s",

286 
∆
->
«me
, 
	`ß„_°ªº‹
(
î∫o
));

290 i‡(
°©us
 == 0)

292 
	`zlog
 (
NULL
, 
LOG_ERR
, "%†EOF", 
∆
->
«me
);

296 i‡(
msg
.
msg_«mñí
 ! 
¢l
)

298 
	`zlog
 (
NULL
, 
LOG_ERR
, "%s senderáddressÜengthÉrror:Üength %d",

299 
∆
->
«me
, 
msg
.
msg_«mñí
);

303 
h
 = (
∆msghdr
 *Ë
buf
; 
	`NLMSG_OK
 (h, (Ë
°©us
);

304 
h
 = 
	`NLMSG_NEXT
 (h, 
°©us
))

307 i‡(
h
->
∆msg_ty≥
 =
NLMSG_DONE
)

308  
ªt
;

311 i‡(
h
->
∆msg_ty≥
 =
NLMSG_ERROR
)

313 
∆msgîr
 *
îr
 = (∆msgî∏*Ë
	`NLMSG_DATA
 (
h
);

314 
î∫um
 = 
îr
->
îr‹
;

315 
msg_ty≥
 = 
îr
->
msg
.
∆msg_ty≥
;

318 i‡(
îr
->
îr‹
 == 0)

320 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

322 
	`zlog_debug
 ("%s: %s ACK:Åype=%s(%u), seq=%u,Öid=%u",

323 
__FUNCTION__
, 
∆
->
«me
,

324 
	`lookup
 (
∆msg_°r
, 
îr
->
msg
.
∆msg_ty≥
),

325 
îr
->
msg
.
∆msg_ty≥
,Éº->msg.
∆msg_£q
,

326 
îr
->
msg
.
∆msg_pid
);

330 i‡(!(
h
->
∆msg_Êags
 & 
NLM_F_MULTI
))

337 i‡(
h
->
∆msg_Àn
 < 
	`NLMSG_LENGTH
 ( (
∆msgîr
)))

339 
	`zlog
 (
NULL
, 
LOG_ERR
, "%sÉrror: messageÅruncated",

340 
∆
->
«me
);

345 i‡(
∆
 =&
√éök_cmd


346 && ((
msg_ty≥
 =
RTM_DELROUTE
 &&

347 (-
î∫um
 =
ENODEV
 || -î∫um =
ESRCH
))

348 || (
msg_ty≥
 =
RTM_NEWROUTE
 && -
î∫um
 =
EEXIST
)))

350 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

351 
	`zlog_debug
 ("%s:Érror: %sÅype=%s(%u), seq=%u,Öid=%u",

352 
∆
->
«me
, 
	`ß„_°ªº‹
 (-
î∫um
),

353 
	`lookup
 (
∆msg_°r
, 
msg_ty≥
),

354 
msg_ty≥
, 
îr
->
msg
.
∆msg_£q
,Éº->msg.
∆msg_pid
);

358 
	`zlog_îr
 ("%sÉrror: %s,Åype=%s(%u), seq=%u,Öid=%u",

359 
∆
->
«me
, 
	`ß„_°ªº‹
 (-
î∫um
),

360 
	`lookup
 (
∆msg_°r
, 
msg_ty≥
),

361 
msg_ty≥
, 
îr
->
msg
.
∆msg_£q
,Éº->msg.
∆msg_pid
);

366 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

367 
	`zlog_debug
 ("netlink_parse_info: %sÅype %s(%u), seq=%u,Öid=%u",

368 
∆
->
«me
,

369 
	`lookup
 (
∆msg_°r
, 
h
->
∆msg_ty≥
), h->nlmsg_type,

370 
h
->
∆msg_£q
, h->
∆msg_pid
);

373 i‡(
∆
 !&
√éök_cmd
 && 
h
->
∆msg_pid
 =√éök_cmd.
¢l
.
∆_pid
)

375 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

376 
	`zlog_debug
 ("netlink_parse_info: %sÖacket comes from %s",

377 
√éök_cmd
.
«me
, 
∆
->name);

381 
îr‹
 = (*
fûãr
Ë(&
¢l
, 
h
);

382 i‡(
îr‹
 < 0)

384 
	`zlog
 (
NULL
, 
LOG_ERR
, "%†fûã∏fun˘i⁄Éº‹", 
∆
->
«me
);

385 
ªt
 = 
îr‹
;

390 i‡(
msg
.
msg_Êags
 & 
MSG_TRUNC
)

392 
	`zlog
 (
NULL
, 
LOG_ERR
, "%†îr‹: mesßgêåunˇãd", 
∆
->
«me
);

395 i‡(
°©us
)

397 
	`zlog
 (
NULL
, 
LOG_ERR
, "%†îr‹: d©®ªm«¡ sizê%d", 
∆
->
«me
,

398 
°©us
);

402  
ªt
;

403 
	}
}

407 
	$√éök_∑r£_π©å
 (
π©å
 **
tb
, 
max
, π©å *
πa
,

408 
Àn
)

410 
	`RTA_OK
 (
πa
, 
Àn
))

412 i‡(
πa
->
πa_ty≥
 <
max
)

413 
tb
[
πa
->
πa_ty≥
] =Ñta;

414 
πa
 = 
	`RTA_NEXT
 (πa, 
Àn
);

416 
	}
}

420 
	$√éök_öãrÁ˚_upd©e_hw_addr
 (
π©å
 **
tb
, 
öãrÁ˚
 *
iÂ
)

422 
i
;

424 i‡(
tb
[
IFLA_ADDRESS
])

426 
hw_addr_Àn
;

428 
hw_addr_Àn
 = 
	`RTA_PAYLOAD
 (
tb
[
IFLA_ADDRESS
]);

430 i‡(
hw_addr_Àn
 > 
INTERFACE_HWADDR_MAX
)

431 
	`zlog_w¨n
 ("H¨dw¨êaddªs†i†toÿœrge: %d", 
hw_addr_Àn
);

434 
iÂ
->
hw_addr_Àn
 = hw_addr_len;

435 
	`mem˝y
 (
iÂ
->
hw_addr
, 
	`RTA_DATA
 (
tb
[
IFLA_ADDRESS
]), 
hw_addr_Àn
);

437 
i
 = 0; i < 
hw_addr_Àn
; i++)

438 i‡(
iÂ
->
hw_addr
[
i
] != 0)

441 i‡(
i
 =
hw_addr_Àn
)

442 
iÂ
->
hw_addr_Àn
 = 0;

444 
iÂ
->
hw_addr_Àn
 = hw_addr_len;

447 
	}
}

452 
	$√éök_öãrÁ˚
 (
sockaddr_∆
 *
¢l
, 
∆msghdr
 *
h
)

454 
Àn
;

455 
iföfomsg
 *
ifi
;

456 
π©å
 *
tb
[
IFLA_MAX
 + 1];

457 
öãrÁ˚
 *
iÂ
;

458 *
«me
;

460 
ifi
 = 
	`NLMSG_DATA
 (
h
);

462 i‡(
h
->
∆msg_ty≥
 !
RTM_NEWLINK
)

465 
Àn
 = 
h
->
∆msg_Àn
 - 
	`NLMSG_LENGTH
 ( (
iföfomsg
));

466 i‡(
Àn
 < 0)

470 
	`mem£t
 (
tb
, 0, Åb);

471 
	`√éök_∑r£_π©å
 (
tb
, 
IFLA_MAX
, 
	`IFLA_RTA
 (
ifi
), 
Àn
);

473 #ifde‡
IFLA_WIRELESS


475 i‡((
tb
[
IFLA_WIRELESS
] !
NULL
Ë&& (
ifi
->
ifi_ch™ge
 == 0))

477 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

478 
	`zlog_debug
 ("%s: ign‹ög IFLA_WIRELESS mesßge", 
__func__
);

483 i‡(
tb
[
IFLA_IFNAME
] =
NULL
)

485 
«me
 = (*Ë
	`RTA_DATA
 (
tb
[
IFLA_IFNAME
]);

488 
iÂ
 = 
	`if_gë_by_«me
 (
«me
);

489 
	`£t_ifödex
(
iÂ
, 
ifi
->
ifi_ödex
);

490 
iÂ
->
Êags
 = 
ifi
->
ifi_Êags
 & 0x0000fffff;

491 
iÂ
->
mtu6
 = iÂ->
mtu
 = *(
uöt32_t
 *Ë
	`RTA_DATA
 (
tb
[
IFLA_MTU
]);

492 
iÂ
->
mëric
 = 1;

495 
iÂ
->
hw_ty≥
 = 
ifi
->
ifi_ty≥
;

496 
	`√éök_öãrÁ˚_upd©e_hw_addr
 (
tb
, 
iÂ
);

498 
	`if_add_upd©e
 (
iÂ
);

501 
	}
}

505 
	$√éök_öãrÁ˚_addr
 (
sockaddr_∆
 *
¢l
, 
∆msghdr
 *
h
)

507 
Àn
;

508 
iÁddrmsg
 *
iÁ
;

509 
π©å
 *
tb
[
IFA_MAX
 + 1];

510 
öãrÁ˚
 *
iÂ
;

511 *
addr
;

512 *
brﬂd
;

513 
u_ch¨
 
Êags
 = 0;

514 *
œbñ
 = 
NULL
;

516 
iÁ
 = 
	`NLMSG_DATA
 (
h
);

518 i‡(
iÁ
->
iÁ_Ámûy
 !
AF_INET


519 #ifde‡
HAVE_IPV6


520 && 
iÁ
->
iÁ_Ámûy
 !
AF_INET6


525 i‡(
h
->
∆msg_ty≥
 !
RTM_NEWADDR
 && h->∆msg_ty≥ !
RTM_DELADDR
)

528 
Àn
 = 
h
->
∆msg_Àn
 - 
	`NLMSG_LENGTH
 ( (
iÁddrmsg
));

529 i‡(
Àn
 < 0)

532 
	`mem£t
 (
tb
, 0, Åb);

533 
	`√éök_∑r£_π©å
 (
tb
, 
IFA_MAX
, 
	`IFA_RTA
 (
iÁ
), 
Àn
);

535 
iÂ
 = 
	`if_lookup_by_ödex
 (
iÁ
->
iÁ_ödex
);

536 i‡(
iÂ
 =
NULL
)

538 
	`zlog_îr
 ("netlink_interface_addr can't find interface by index %d",

539 
iÁ
->
iÁ_ödex
);

543 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

545 
buf
[
BUFSIZ
];

546 
	`zlog_debug
 ("netlink_interface_addr %s %s:",

547 
	`lookup
 (
∆msg_°r
, 
h
->
∆msg_ty≥
), 
iÂ
->
«me
);

548 i‡(
tb
[
IFA_LOCAL
])

549 
	`zlog_debug
 (" IFA_LOCAL %s/%d",

550 
	`öë_¡›
 (
iÁ
->
iÁ_Ámûy
, 
	`RTA_DATA
 (
tb
[
IFA_LOCAL
]),

551 
buf
, 
BUFSIZ
), 
iÁ
->
iÁ_¥efixÀn
);

552 i‡(
tb
[
IFA_ADDRESS
])

553 
	`zlog_debug
 (" IFA_ADDRESS %s/%d",

554 
	`öë_¡›
 (
iÁ
->
iÁ_Ámûy
, 
	`RTA_DATA
 (
tb
[
IFA_ADDRESS
]),

555 
buf
, 
BUFSIZ
), 
iÁ
->
iÁ_¥efixÀn
);

556 i‡(
tb
[
IFA_BROADCAST
])

557 
	`zlog_debug
 (" IFA_BROADCAST %s/%d",

558 
	`öë_¡›
 (
iÁ
->
iÁ_Ámûy
, 
	`RTA_DATA
 (
tb
[
IFA_BROADCAST
]),

559 
buf
, 
BUFSIZ
), 
iÁ
->
iÁ_¥efixÀn
);

560 i‡(
tb
[
IFA_LABEL
] && 
	`°rcmp
 (
iÂ
->
«me
, 
	`RTA_DATA
 (tb[IFA_LABEL])))

561 
	`zlog_debug
 (" IFA_LABEL %s", (*)
	`RTA_DATA
 (
tb
[
IFA_LABEL
]));

563 i‡(
tb
[
IFA_CACHEINFO
])

565 
iÁ_ˇcheöfo
 *
ci
 = 
	`RTA_DATA
 (
tb
[
IFA_CACHEINFO
]);

566 
	`zlog_debug
 (" IFA_CACHEINFOÖref %d, valid %d",

567 
ci
->
iÁ_¥e„ªd
, ci->
iÁ_vÆid
);

572 i‡(
tb
[
IFA_LOCAL
] =
NULL
)

573 
tb
[
IFA_LOCAL
] =Åb[
IFA_ADDRESS
];

574 i‡(
tb
[
IFA_ADDRESS
] =
NULL
)

575 
tb
[
IFA_ADDRESS
] =Åb[
IFA_LOCAL
];

578 
addr
 = (
tb
[
IFA_LOCAL
] ? 
	`RTA_DATA
—b[IFA_LOCAL]Ë: 
NULL
);

581 i‡(
tb
[
IFA_ADDRESS
] &&

582 
	`memcmp
(
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]), RTA_DATA—b[
IFA_LOCAL
]), 
	`RTA_PAYLOAD
(tb[IFA_ADDRESS])))

584 
brﬂd
 = 
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]);

585 
	`SET_FLAG
 (
Êags
, 
ZEBRA_IFA_PEER
);

589 
brﬂd
 = (
tb
[
IFA_BROADCAST
] ? 
	`RTA_DATA
—b[IFA_BROADCAST]Ë: 
NULL
);

592 i‡(
addr
 =
NULL
)

594 
	`zlog_debug
 ("%s: NULLáddªss", 
__func__
);

599 i‡(
iÁ
->
iÁ_Êags
 & 
IFA_F_SECONDARY
)

600 
	`SET_FLAG
 (
Êags
, 
ZEBRA_IFA_SECONDARY
);

603 i‡(
tb
[
IFA_LABEL
])

604 
œbñ
 = (*Ë
	`RTA_DATA
 (
tb
[
IFA_LABEL
]);

606 i‡(
iÂ
 && 
œbñ
 && 
	`°rcmp
 (iÂ->
«me
,Üabel) == 0)

607 
œbñ
 = 
NULL
;

610 i‡(
iÁ
->
iÁ_Ámûy
 =
AF_INET
)

612 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWADDR
)

613 
	`c⁄√˘ed_add_ùv4
 (
iÂ
, 
Êags
,

614 (
ö_addr
 *Ë
addr
, 
iÁ
->
iÁ_¥efixÀn
,

615 (
ö_addr
 *Ë
brﬂd
, 
œbñ
);

617 
	`c⁄√˘ed_dñëe_ùv4
 (
iÂ
, 
Êags
,

618 (
ö_addr
 *Ë
addr
, 
iÁ
->
iÁ_¥efixÀn
,

619 (
ö_addr
 *Ë
brﬂd
);

621 #ifde‡
HAVE_IPV6


622 i‡(
iÁ
->
iÁ_Ámûy
 =
AF_INET6
)

624 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWADDR
)

625 
	`c⁄√˘ed_add_ùv6
 (
iÂ
, 
Êags
,

626 (
ö6_addr
 *Ë
addr
, 
iÁ
->
iÁ_¥efixÀn
,

627 (
ö6_addr
 *Ë
brﬂd
, 
œbñ
);

629 
	`c⁄√˘ed_dñëe_ùv6
 (
iÂ
,

630 (
ö6_addr
 *Ë
addr
, 
iÁ
->
iÁ_¥efixÀn
,

631 (
ö6_addr
 *Ë
brﬂd
);

636 
	}
}

640 
	$√éök_routög_èbÀ
 (
sockaddr_∆
 *
¢l
, 
∆msghdr
 *
h
)

642 
Àn
;

643 
πmsg
 *
πm
;

644 
π©å
 *
tb
[
RTA_MAX
 + 1];

645 
u_ch¨
 
Êags
 = 0;

647 
™yaddr
[16] = { 0 };

649 
ödex
;

650 
èbÀ
;

651 
mëric
;

653 *
de°
;

654 *
g©e
;

655 *
§c
;

657 
πm
 = 
	`NLMSG_DATA
 (
h
);

659 i‡(
h
->
∆msg_ty≥
 !
RTM_NEWROUTE
)

661 i‡(
πm
->
πm_ty≥
 !
RTN_UNICAST
)

664 
èbÀ
 = 
πm
->
πm_èbÀ
;

666 i‡(
èbÀ
 !
RT_TABLE_MAIN
 &&ÅabÀ !
zebød
.
πm_èbÀ_deÁu…
)

670 
Àn
 = 
h
->
∆msg_Àn
 - 
	`NLMSG_LENGTH
 ( (
πmsg
));

671 i‡(
Àn
 < 0)

674 
	`mem£t
 (
tb
, 0, Åb);

675 
	`√éök_∑r£_π©å
 (
tb
, 
RTA_MAX
, 
	`RTM_RTA
 (
πm
), 
Àn
);

677 i‡(
πm
->
πm_Êags
 & 
RTM_F_CLONED
)

679 i‡(
πm
->
πm_¥Ÿocﬁ
 =
RTPROT_REDIRECT
)

681 i‡(
πm
->
πm_¥Ÿocﬁ
 =
RTPROT_KERNEL
)

684 i‡(
πm
->
πm_§c_Àn
 != 0)

688 i‡(
πm
->
πm_¥Ÿocﬁ
 =
RTPROT_ZEBRA
)

689 
Êags
 |
ZEBRA_FLAG_SELFROUTE
;

691 
ödex
 = 0;

692 
mëric
 = 0;

693 
de°
 = 
NULL
;

694 
g©e
 = 
NULL
;

695 
§c
 = 
NULL
;

697 i‡(
tb
[
RTA_OIF
])

698 
ödex
 = *(*Ë
	`RTA_DATA
 (
tb
[
RTA_OIF
]);

700 i‡(
tb
[
RTA_DST
])

701 
de°
 = 
	`RTA_DATA
 (
tb
[
RTA_DST
]);

703 
de°
 = 
™yaddr
;

705 i‡(
tb
[
RTA_PREFSRC
])

706 
§c
 = 
	`RTA_DATA
 (
tb
[
RTA_PREFSRC
]);

708 i‡(
tb
[
RTA_GATEWAY
])

709 
g©e
 = 
	`RTA_DATA
 (
tb
[
RTA_GATEWAY
]);

711 i‡(
tb
[
RTA_PRIORITY
])

712 
mëric
 = *(*Ë
	`RTA_DATA
(
tb
[
RTA_PRIORITY
]);

714 i‡(
πm
->
πm_Ámûy
 =
AF_INET
)

716 
¥efix_ùv4
 
p
;

717 
p
.
Ámûy
 = 
AF_INET
;

718 
	`mem˝y
 (&
p
.
¥efix
, 
de°
, 4);

719 
p
.
¥efixÀn
 = 
πm
->
πm_d°_Àn
;

721 i‡(!
tb
[
RTA_MULTIPATH
])

722 
	`rib_add_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 
Êags
, &
p
, 
g©e
, 
§c
, 
ödex
,

723 
èbÀ
, 
mëric
, 0, 
SAFI_UNICAST
);

728 
rib
 *rib;

729 
π√xth›
 *
πnh
 =

730 (
π√xth›
 *Ë
	`RTA_DATA
 (
tb
[
RTA_MULTIPATH
]);

732 
Àn
 = 
	`RTA_PAYLOAD
 (
tb
[
RTA_MULTIPATH
]);

734 
rib
 = 
	`XCALLOC
 (
MTYPE_RIB
,  (rib));

735 
rib
->
ty≥
 = 
ZEBRA_ROUTE_KERNEL
;

736 
rib
->
di°™˚
 = 0;

737 
rib
->
Êags
 = flags;

738 
rib
->
mëric
 = metric;

739 
rib
->
èbÀ
 =Åable;

740 
rib
->
√xth›_num
 = 0;

741 
rib
->
u±ime
 = 
	`time
 (
NULL
);

745 i‡(
Àn
 < (Ë (*
πnh
Ë||Ñäh->
πnh_Àn
 >Üen)

748 
rib
->
√xth›_num
++;

749 
ödex
 = 
πnh
->
πnh_ifödex
;

750 
g©e
 = 0;

751 i‡(
πnh
->
πnh_Àn
 >  (*rtnh))

753 
	`mem£t
 (
tb
, 0,  (tb));

754 
	`√éök_∑r£_π©å
 (
tb
, 
RTA_MAX
, 
	`RTNH_DATA
 (
πnh
),

755 
πnh
->
πnh_Àn
 -  (*rtnh));

756 i‡(
tb
[
RTA_GATEWAY
])

757 
g©e
 = 
	`RTA_DATA
 (
tb
[
RTA_GATEWAY
]);

760 i‡(
g©e
)

762 i‡(
ödex
)

763 
	`√xth›_ùv4_ifödex_add
 (
rib
, 
g©e
, 
§c
, 
ödex
);

765 
	`√xth›_ùv4_add
 (
rib
, 
g©e
, 
§c
);

768 
	`√xth›_ifödex_add
 (
rib
, 
ödex
);

770 
Àn
 -
	`NLMSG_ALIGN
(
πnh
->
πnh_Àn
);

771 
πnh
 = 
	`RTNH_NEXT
(rtnh);

774 i‡(
rib
->
√xth›_num
 == 0)

775 
	`XFREE
 (
MTYPE_RIB
, 
rib
);

777 
	`rib_add_ùv4_mu…ù©h
 (&
p
, 
rib
, 
SAFI_UNICAST
);

780 #ifde‡
HAVE_IPV6


781 i‡(
πm
->
πm_Ámûy
 =
AF_INET6
)

783 
¥efix_ùv6
 
p
;

784 
p
.
Ámûy
 = 
AF_INET6
;

785 
	`mem˝y
 (&
p
.
¥efix
, 
de°
, 16);

786 
p
.
¥efixÀn
 = 
πm
->
πm_d°_Àn
;

788 
	`rib_add_ùv6
 (
ZEBRA_ROUTE_KERNEL
, 
Êags
, &
p
, 
g©e
, 
ödex
, 
èbÀ
,

789 
mëric
, 0, 
SAFI_UNICAST
);

794 
	}
}

796 c⁄° 
mesßge
 
	gπ¥Ÿo_°r
[] = {

797 {
RTPROT_REDIRECT
, "redirect"},

798 {
RTPROT_KERNEL
, "kernel"},

799 {
RTPROT_BOOT
, "boot"},

800 {
RTPROT_STATIC
, "static"},

801 {
RTPROT_GATED
, "GateD"},

802 {
RTPROT_RA
, "routerádvertisement"},

803 {
RTPROT_MRT
, "MRT"},

804 {
RTPROT_ZEBRA
, "Zebra"},

805 #ifde‡
RTPROT_BIRD


806 {
RTPROT_BIRD
, "BIRD"},

808 {0, 
NULL
}

813 
	$√éök_rouã_ch™ge
 (
sockaddr_∆
 *
¢l
, 
∆msghdr
 *
h
)

815 
Àn
;

816 
πmsg
 *
πm
;

817 
π©å
 *
tb
[
RTA_MAX
 + 1];

819 
™yaddr
[16] = { 0 };

821 
ödex
;

822 
èbÀ
;

823 
mëric
;

825 *
de°
;

826 *
g©e
;

827 *
§c
;

829 
πm
 = 
	`NLMSG_DATA
 (
h
);

831 i‡(!(
h
->
∆msg_ty≥
 =
RTM_NEWROUTE
 || h->∆msg_ty≥ =
RTM_DELROUTE
))

834 
	`zlog_w¨n
 ("Kî√»mesßge: %d\n", 
h
->
∆msg_ty≥
);

839 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

840 
	`zlog_debug
 ("%s %s %sÖroto %s",

841 
h
->
∆msg_ty≥
 ==

842 
RTM_NEWROUTE
 ? "RTM_NEWROUTE" : "RTM_DELROUTE",

843 
πm
->
πm_Ámûy
 =
AF_INET
 ? "ipv4" : "ipv6",

844 
πm
->
πm_ty≥
 =
RTN_UNICAST
 ? "unicast" : "multicast",

845 
	`lookup
 (
π¥Ÿo_°r
, 
πm
->
πm_¥Ÿocﬁ
));

847 i‡(
πm
->
πm_ty≥
 !
RTN_UNICAST
)

852 
èbÀ
 = 
πm
->
πm_èbÀ
;

853 i‡(
èbÀ
 !
RT_TABLE_MAIN
 &&ÅabÀ !
zebød
.
πm_èbÀ_deÁu…
)

858 
Àn
 = 
h
->
∆msg_Àn
 - 
	`NLMSG_LENGTH
 ( (
πmsg
));

859 i‡(
Àn
 < 0)

862 
	`mem£t
 (
tb
, 0, Åb);

863 
	`√éök_∑r£_π©å
 (
tb
, 
RTA_MAX
, 
	`RTM_RTA
 (
πm
), 
Àn
);

865 i‡(
πm
->
πm_Êags
 & 
RTM_F_CLONED
)

867 i‡(
πm
->
πm_¥Ÿocﬁ
 =
RTPROT_REDIRECT
)

869 i‡(
πm
->
πm_¥Ÿocﬁ
 =
RTPROT_KERNEL
)

872 i‡(
πm
->
πm_¥Ÿocﬁ
 =
RTPROT_ZEBRA
 && 
h
->
∆msg_ty≥
 =
RTM_NEWROUTE
)

875 i‡(
πm
->
πm_§c_Àn
 != 0)

877 
	`zlog_w¨n
 ("netlink_route_change():Ço srcÜen");

881 
ödex
 = 0;

882 
mëric
 = 0;

883 
de°
 = 
NULL
;

884 
g©e
 = 
NULL
;

885 
§c
 = 
NULL
;

887 i‡(
tb
[
RTA_OIF
])

888 
ödex
 = *(*Ë
	`RTA_DATA
 (
tb
[
RTA_OIF
]);

890 i‡(
tb
[
RTA_DST
])

891 
de°
 = 
	`RTA_DATA
 (
tb
[
RTA_DST
]);

893 
de°
 = 
™yaddr
;

895 i‡(
tb
[
RTA_GATEWAY
])

896 
g©e
 = 
	`RTA_DATA
 (
tb
[
RTA_GATEWAY
]);

898 i‡(
tb
[
RTA_PREFSRC
])

899 
§c
 = 
	`RTA_DATA
 (
tb
[
RTA_PREFSRC
]);

901 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWROUTE
 && 
tb
[
RTA_PRIORITY
])

902 
mëric
 = *(*Ë
	`RTA_DATA
(
tb
[
RTA_PRIORITY
]);

904 i‡(
πm
->
πm_Ámûy
 =
AF_INET
)

906 
¥efix_ùv4
 
p
;

907 
p
.
Ámûy
 = 
AF_INET
;

908 
	`mem˝y
 (&
p
.
¥efix
, 
de°
, 4);

909 
p
.
¥efixÀn
 = 
πm
->
πm_d°_Àn
;

911 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

913 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWROUTE
)

914 
	`zlog_debug
 ("RTM_NEWROUTE %s/%d",

915 
	`öë_¡ﬂ
 (
p
.
¥efix
),Ö.
¥efixÀn
);

917 
	`zlog_debug
 ("RTM_DELROUTE %s/%d",

918 
	`öë_¡ﬂ
 (
p
.
¥efix
),Ö.
¥efixÀn
);

921 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWROUTE
)

923 i‡(!
tb
[
RTA_MULTIPATH
])

924 
	`rib_add_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 0, &
p
, 
g©e
, 
§c
, 
ödex
, 
èbÀ
,

925 
mëric
, 0, 
SAFI_UNICAST
);

930 
rib
 *rib;

931 
π√xth›
 *
πnh
 =

932 (
π√xth›
 *Ë
	`RTA_DATA
 (
tb
[
RTA_MULTIPATH
]);

934 
Àn
 = 
	`RTA_PAYLOAD
 (
tb
[
RTA_MULTIPATH
]);

936 
rib
 = 
	`XCALLOC
 (
MTYPE_RIB
,  (rib));

937 
rib
->
ty≥
 = 
ZEBRA_ROUTE_KERNEL
;

938 
rib
->
di°™˚
 = 0;

939 
rib
->
Êags
 = 0;

940 
rib
->
mëric
 = metric;

941 
rib
->
èbÀ
 =Åable;

942 
rib
->
√xth›_num
 = 0;

943 
rib
->
u±ime
 = 
	`time
 (
NULL
);

947 i‡(
Àn
 < (Ë (*
πnh
Ë||Ñäh->
πnh_Àn
 >Üen)

950 
rib
->
√xth›_num
++;

951 
ödex
 = 
πnh
->
πnh_ifödex
;

952 
g©e
 = 0;

953 i‡(
πnh
->
πnh_Àn
 >  (*rtnh))

955 
	`mem£t
 (
tb
, 0,  (tb));

956 
	`√éök_∑r£_π©å
 (
tb
, 
RTA_MAX
, 
	`RTNH_DATA
 (
πnh
),

957 
πnh
->
πnh_Àn
 -  (*rtnh));

958 i‡(
tb
[
RTA_GATEWAY
])

959 
g©e
 = 
	`RTA_DATA
 (
tb
[
RTA_GATEWAY
]);

962 i‡(
g©e
)

964 i‡(
ödex
)

965 
	`√xth›_ùv4_ifödex_add
 (
rib
, 
g©e
, 
§c
, 
ödex
);

967 
	`√xth›_ùv4_add
 (
rib
, 
g©e
, 
§c
);

970 
	`√xth›_ifödex_add
 (
rib
, 
ödex
);

972 
Àn
 -
	`NLMSG_ALIGN
(
πnh
->
πnh_Àn
);

973 
πnh
 = 
	`RTNH_NEXT
(rtnh);

976 i‡(
rib
->
√xth›_num
 == 0)

977 
	`XFREE
 (
MTYPE_RIB
, 
rib
);

979 
	`rib_add_ùv4_mu…ù©h
 (&
p
, 
rib
, 
SAFI_UNICAST
);

983 
	`rib_dñëe_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 0, &
p
, 
g©e
, 
ödex
, 
èbÀ
, 
SAFI_UNICAST
);

986 #ifde‡
HAVE_IPV6


987 i‡(
πm
->
πm_Ámûy
 =
AF_INET6
)

989 
¥efix_ùv6
 
p
;

990 
buf
[
BUFSIZ
];

992 
p
.
Ámûy
 = 
AF_INET6
;

993 
	`mem˝y
 (&
p
.
¥efix
, 
de°
, 16);

994 
p
.
¥efixÀn
 = 
πm
->
πm_d°_Àn
;

996 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

998 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWROUTE
)

999 
	`zlog_debug
 ("RTM_NEWROUTE %s/%d",

1000 
	`öë_¡›
 (
AF_INET6
, &
p
.
¥efix
, 
buf
, 
BUFSIZ
),

1001 
p
.
¥efixÀn
);

1003 
	`zlog_debug
 ("RTM_DELROUTE %s/%d",

1004 
	`öë_¡›
 (
AF_INET6
, &
p
.
¥efix
, 
buf
, 
BUFSIZ
),

1005 
p
.
¥efixÀn
);

1008 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWROUTE
)

1009 
	`rib_add_ùv6
 (
ZEBRA_ROUTE_KERNEL
, 0, &
p
, 
g©e
, 
ödex
, 
èbÀ
, 
mëric
, 0, 
SAFI_UNICAST
);

1011 
	`rib_dñëe_ùv6
 (
ZEBRA_ROUTE_KERNEL
, 0, &
p
, 
g©e
, 
ödex
, 
èbÀ
, 
SAFI_UNICAST
);

1016 
	}
}

1019 
	$√éök_lök_ch™ge
 (
sockaddr_∆
 *
¢l
, 
∆msghdr
 *
h
)

1021 
Àn
;

1022 
iföfomsg
 *
ifi
;

1023 
π©å
 *
tb
[
IFLA_MAX
 + 1];

1024 
öãrÁ˚
 *
iÂ
;

1025 *
«me
;

1027 
ifi
 = 
	`NLMSG_DATA
 (
h
);

1029 i‡(!(
h
->
∆msg_ty≥
 =
RTM_NEWLINK
 || h->∆msg_ty≥ =
RTM_DELLINK
))

1032 
	`zlog_w¨n
 ("netlink_link_change: wrong kernel message %d\n",

1033 
h
->
∆msg_ty≥
);

1037 
Àn
 = 
h
->
∆msg_Àn
 - 
	`NLMSG_LENGTH
 ( (
iföfomsg
));

1038 i‡(
Àn
 < 0)

1042 
	`mem£t
 (
tb
, 0, Åb);

1043 
	`√éök_∑r£_π©å
 (
tb
, 
IFLA_MAX
, 
	`IFLA_RTA
 (
ifi
), 
Àn
);

1045 #ifde‡
IFLA_WIRELESS


1047 i‡((
tb
[
IFLA_WIRELESS
] !
NULL
Ë&& (
ifi
->
ifi_ch™ge
 == 0))

1049 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1050 
	`zlog_debug
 ("%s: ign‹ög IFLA_WIRELESS mesßge", 
__func__
);

1055 i‡(
tb
[
IFLA_IFNAME
] =
NULL
)

1057 
«me
 = (*Ë
	`RTA_DATA
 (
tb
[
IFLA_IFNAME
]);

1060 i‡(
h
->
∆msg_ty≥
 =
RTM_NEWLINK
)

1062 
iÂ
 = 
	`if_lookup_by_«me
 (
«me
);

1064 i‡(
iÂ
 =
NULL
 || !
	`CHECK_FLAG
 (iÂ->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

1066 i‡(
iÂ
 =
NULL
)

1067 
iÂ
 = 
	`if_gë_by_«me
 (
«me
);

1069 
	`£t_ifödex
(
iÂ
, 
ifi
->
ifi_ödex
);

1070 
iÂ
->
Êags
 = 
ifi
->
ifi_Êags
 & 0x0000fffff;

1071 
iÂ
->
mtu6
 = iÂ->
mtu
 = *(*Ë
	`RTA_DATA
 (
tb
[
IFLA_MTU
]);

1072 
iÂ
->
mëric
 = 1;

1074 
	`√éök_öãrÁ˚_upd©e_hw_addr
 (
tb
, 
iÂ
);

1077 
	`if_add_upd©e
 (
iÂ
);

1082 
	`£t_ifödex
(
iÂ
, 
ifi
->
ifi_ödex
);

1083 
iÂ
->
mtu6
 = iÂ->
mtu
 = *(*Ë
	`RTA_DATA
 (
tb
[
IFLA_MTU
]);

1084 
iÂ
->
mëric
 = 1;

1086 
	`√éök_öãrÁ˚_upd©e_hw_addr
 (
tb
, 
iÂ
);

1088 i‡(
	`if_is_›î©ive
 (
iÂ
))

1090 
iÂ
->
Êags
 = 
ifi
->
ifi_Êags
 & 0x0000fffff;

1091 i‡(!
	`if_is_›î©ive
 (
iÂ
))

1092 
	`if_down
 (
iÂ
);

1095 
	`zebø_öãrÁ˚_up_upd©e
 (
iÂ
);

1099 
iÂ
->
Êags
 = 
ifi
->
ifi_Êags
 & 0x0000fffff;

1100 i‡(
	`if_is_›î©ive
 (
iÂ
))

1101 
	`if_up
 (
iÂ
);

1108 
iÂ
 = 
	`if_lookup_by_«me
 (
«me
);

1110 i‡(
iÂ
 =
NULL
)

1112 
	`zlog
 (
NULL
, 
LOG_WARNING
, "interface %s is deleted but can't find",

1113 
«me
);

1117 
	`if_dñëe_upd©e
 (
iÂ
);

1121 
	}
}

1124 
	$√éök_öf‹m©i⁄_„tch
 (
sockaddr_∆
 *
¢l
, 
∆msghdr
 *
h
)

1127 i‡–
¢l
->
∆_pid
 != 0 )

1129 
	`zlog
 ( 
NULL
, 
LOG_ERR
, "Ign‹ög mesßgê‰omÖid %u", 
¢l
->
∆_pid
 );

1133 
h
->
∆msg_ty≥
)

1135 
RTM_NEWROUTE
:

1136  
	`√éök_rouã_ch™ge
 (
¢l
, 
h
);

1138 
RTM_DELROUTE
:

1139  
	`√éök_rouã_ch™ge
 (
¢l
, 
h
);

1141 
RTM_NEWLINK
:

1142  
	`√éök_lök_ch™ge
 (
¢l
, 
h
);

1144 
RTM_DELLINK
:

1145  
	`√éök_lök_ch™ge
 (
¢l
, 
h
);

1147 
RTM_NEWADDR
:

1148  
	`√éök_öãrÁ˚_addr
 (
¢l
, 
h
);

1150 
RTM_DELADDR
:

1151  
	`√éök_öãrÁ˚_addr
 (
¢l
, 
h
);

1154 
	`zlog_w¨n
 ("Unknow¿√éökÇlmsg_ty≥ %d\n", 
h
->
∆msg_ty≥
);

1158 
	}
}

1162 
	$öãrÁ˚_lookup_√éök
 ()

1164 
ªt
;

1167 
ªt
 = 
	`√éök_ªque°
 (
AF_PACKET
, 
RTM_GETLINK
, &
√éök_cmd
);

1168 i‡(
ªt
 < 0)

1169  
ªt
;

1170 
ªt
 = 
	`√éök_∑r£_öfo
 (
√éök_öãrÁ˚
, &
√éök_cmd
);

1171 i‡(
ªt
 < 0)

1172  
ªt
;

1175 
ªt
 = 
	`√éök_ªque°
 (
AF_INET
, 
RTM_GETADDR
, &
√éök_cmd
);

1176 i‡(
ªt
 < 0)

1177  
ªt
;

1178 
ªt
 = 
	`√éök_∑r£_öfo
 (
√éök_öãrÁ˚_addr
, &
√éök_cmd
);

1179 i‡(
ªt
 < 0)

1180  
ªt
;

1182 #ifde‡
HAVE_IPV6


1184 
ªt
 = 
	`√éök_ªque°
 (
AF_INET6
, 
RTM_GETADDR
, &
√éök_cmd
);

1185 i‡(
ªt
 < 0)

1186  
ªt
;

1187 
ªt
 = 
	`√éök_∑r£_öfo
 (
√éök_öãrÁ˚_addr
, &
√éök_cmd
);

1188 i‡(
ªt
 < 0)

1189  
ªt
;

1193 
	}
}

1198 
	$√éök_rouã_ªad
 ()

1200 
ªt
;

1203 
ªt
 = 
	`√éök_ªque°
 (
AF_INET
, 
RTM_GETROUTE
, &
√éök_cmd
);

1204 i‡(
ªt
 < 0)

1205  
ªt
;

1206 
ªt
 = 
	`√éök_∑r£_öfo
 (
√éök_routög_èbÀ
, &
√éök_cmd
);

1207 i‡(
ªt
 < 0)

1208  
ªt
;

1210 #ifde‡
HAVE_IPV6


1212 
ªt
 = 
	`√éök_ªque°
 (
AF_INET6
, 
RTM_GETROUTE
, &
√éök_cmd
);

1213 i‡(
ªt
 < 0)

1214  
ªt
;

1215 
ªt
 = 
	`√éök_∑r£_öfo
 (
√éök_routög_èbÀ
, &
√éök_cmd
);

1216 i‡(
ªt
 < 0)

1217  
ªt
;

1221 
	}
}

1226 
	$add©å_l
 (
∆msghdr
 *
n
, 
maxÀn
, 
ty≥
, *
d©a
, 
Æí
)

1228 
Àn
;

1229 
π©å
 *
πa
;

1231 
Àn
 = 
	`RTA_LENGTH
 (
Æí
);

1233 i‡(
	`NLMSG_ALIGN
 (
n
->
∆msg_Àn
Ë+ 
Àn
 > 
maxÀn
)

1236 
πa
 = (
π©å
 *Ë(((*Ë
n
Ë+ 
	`NLMSG_ALIGN
 (n->
∆msg_Àn
));

1237 
πa
->
πa_ty≥
 = 
ty≥
;

1238 
πa
->
πa_Àn
 = 
Àn
;

1239 
	`mem˝y
 (
	`RTA_DATA
 (
πa
), 
d©a
, 
Æí
);

1240 
n
->
∆msg_Àn
 = 
	`NLMSG_ALIGN
 (n->∆msg_ÀnË+ 
Àn
;

1243 
	}
}

1246 
	$πa_add©å_l
 (
π©å
 *
πa
, 
maxÀn
, 
ty≥
, *
d©a
, 
Æí
)

1248 
Àn
;

1249 
π©å
 *
subπa
;

1251 
Àn
 = 
	`RTA_LENGTH
 (
Æí
);

1253 i‡(
	`RTA_ALIGN
 (
πa
->
πa_Àn
Ë+ 
Àn
 > 
maxÀn
)

1256 
subπa
 = (
π©å
 *Ë(((*Ë
πa
Ë+ 
	`RTA_ALIGN
 (πa->
πa_Àn
));

1257 
subπa
->
πa_ty≥
 = 
ty≥
;

1258 
subπa
->
πa_Àn
 = 
Àn
;

1259 
	`mem˝y
 (
	`RTA_DATA
 (
subπa
), 
d©a
, 
Æí
);

1260 
πa
->
πa_Àn
 = 
	`NLMSG_ALIGN
 (πa->πa_ÀnË+ 
Àn
;

1263 
	}
}

1268 
	$add©å32
 (
∆msghdr
 *
n
, 
maxÀn
, 
ty≥
, 
d©a
)

1270 
Àn
;

1271 
π©å
 *
πa
;

1273 
Àn
 = 
	`RTA_LENGTH
 (4);

1275 i‡(
	`NLMSG_ALIGN
 (
n
->
∆msg_Àn
Ë+ 
Àn
 > 
maxÀn
)

1278 
πa
 = (
π©å
 *Ë(((*Ë
n
Ë+ 
	`NLMSG_ALIGN
 (n->
∆msg_Àn
));

1279 
πa
->
πa_ty≥
 = 
ty≥
;

1280 
πa
->
πa_Àn
 = 
Àn
;

1281 
	`mem˝y
 (
	`RTA_DATA
 (
πa
), &
d©a
, 4);

1282 
n
->
∆msg_Àn
 = 
	`NLMSG_ALIGN
 (n->∆msg_ÀnË+ 
Àn
;

1285 
	}
}

1288 
	$√éök_èlk_fûãr
 (
sockaddr_∆
 *
¢l
, 
∆msghdr
 *
h
)

1290 
	`zlog_w¨n
 ("√éök_èlk: ign‹ög mesßgêty≥ 0x%04x", 
h
->
∆msg_ty≥
);

1292 
	}
}

1296 
	$√éök_èlk
 (
∆msghdr
 *
n
, 
∆sock
 *
∆
)

1298 
°©us
;

1299 
sockaddr_∆
 
¢l
;

1300 
iovec
 
iov
 = { (*Ë
n
,Ç->
∆msg_Àn
 };

1301 
msghdr
 
msg
 = { (*Ë&
¢l
,  s∆, &
iov
, 1, 
NULL
, 0, 0 };

1302 
ßve_î∫o
;

1304 
	`mem£t
 (&
¢l
, 0,  snl);

1305 
¢l
.
∆_Ámûy
 = 
AF_NETLINK
;

1307 
n
->
∆msg_£q
 = ++
∆
->
£q
;

1310 
n
->
∆msg_Êags
 |
NLM_F_ACK
;

1312 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1313 
	`zlog_debug
 ("√éök_èlk: %†ty≥ %s(%u), seq=%u", 
∆
->
«me
,

1314 
	`lookup
 (
∆msg_°r
, 
n
->
∆msg_ty≥
),Ç->nlmsg_type,

1315 
n
->
∆msg_£q
);

1318 i‡(
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
))

1319 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

1320 
°©us
 = 
	`£ndmsg
 (
∆
->
sock
, &
msg
, 0);

1321 
ßve_î∫o
 = 
î∫o
;

1322 i‡(
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
))

1323 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

1325 i‡(
°©us
 < 0)

1327 
	`zlog
 (
NULL
, 
LOG_ERR
, "netlink_talk sendmsg()Érror: %s",

1328 
	`ß„_°ªº‹
 (
ßve_î∫o
));

1337  
	`√éök_∑r£_öfo
 (
√éök_èlk_fûãr
, 
∆
);

1338 
	}
}

1342 
	$√éök_rouã
 (
cmd
, 
Ámûy
, *
de°
, 
Àngth
, *
g©e
,

1343 
ödex
, 
zebø_Êags
, 
èbÀ
)

1345 
ªt
;

1346 
byãÀn
;

1347 
sockaddr_∆
 
¢l
;

1348 
disˇrd
;

1352 
∆msghdr
 
n
;

1353 
πmsg
 
r
;

1354 
buf
[
NL_PKT_BUF_SIZE
];

1355 } 
ªq
;

1357 
	`mem£t
 (&
ªq
, 0, Ñeq - 
NL_PKT_BUF_SIZE
);

1359 
byãÀn
 = (
Ámûy
 =
AF_INET
 ? 4 : 16);

1361 
ªq
.
n
.
∆msg_Àn
 = 
	`NLMSG_LENGTH
 ( (
πmsg
));

1362 
ªq
.
n
.
∆msg_Êags
 = 
NLM_F_CREATE
 | 
NLM_F_REQUEST
;

1363 
ªq
.
n
.
∆msg_ty≥
 = 
cmd
;

1364 
ªq
.
r
.
πm_Ámûy
 = 
Ámûy
;

1365 
ªq
.
r
.
πm_èbÀ
 = 
èbÀ
;

1366 
ªq
.
r
.
πm_d°_Àn
 = 
Àngth
;

1367 
ªq
.
r
.
πm_¥Ÿocﬁ
 = 
RTPROT_ZEBRA
;

1368 
ªq
.
r
.
πm_sc›e
 = 
RT_SCOPE_UNIVERSE
;

1370 i‡((
zebø_Êags
 & 
ZEBRA_FLAG_BLACKHOLE
)

1371 || (
zebø_Êags
 & 
ZEBRA_FLAG_REJECT
))

1372 
disˇrd
 = 1;

1374 
disˇrd
 = 0;

1376 i‡(
cmd
 =
RTM_NEWROUTE
)

1378 i‡(
disˇrd
)

1380 i‡(
zebø_Êags
 & 
ZEBRA_FLAG_BLACKHOLE
)

1381 
ªq
.
r
.
πm_ty≥
 = 
RTN_BLACKHOLE
;

1382 i‡(
zebø_Êags
 & 
ZEBRA_FLAG_REJECT
)

1383 
ªq
.
r
.
πm_ty≥
 = 
RTN_UNREACHABLE
;

1385 
	`as£π
 (
RTN_BLACKHOLE
 !
RTN_UNREACHABLE
);

1388 
ªq
.
r
.
πm_ty≥
 = 
RTN_UNICAST
;

1391 i‡(
de°
)

1392 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_DST
, 
de°
, 
byãÀn
);

1394 i‡(!
disˇrd
)

1396 i‡(
g©e
)

1397 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_GATEWAY
, 
g©e
, 
byãÀn
);

1398 i‡(
ödex
 > 0)

1399 
	`add©å32
 (&
ªq
.
n
, Ñeq, 
RTA_OIF
, 
ödex
);

1403 
	`mem£t
 (&
¢l
, 0,  snl);

1404 
¢l
.
∆_Ámûy
 = 
AF_NETLINK
;

1407 
ªt
 = 
	`√éök_èlk
 (&
ªq
.
n
, &
√éök_cmd
);

1408 i‡(
ªt
 < 0)

1412 
	}
}

1416 
	$√éök_rouã_mu…ù©h
 (
cmd
, 
¥efix
 *
p
, 
rib
 *rib,

1417 
Ámûy
)

1419 
byãÀn
;

1420 
sockaddr_∆
 
¢l
;

1421 
√xth›
 *√xth› = 
NULL
;

1422 
√xth›_num
 = 0;

1423 
disˇrd
;

1427 
∆msghdr
 
n
;

1428 
πmsg
 
r
;

1429 
buf
[
NL_PKT_BUF_SIZE
];

1430 } 
ªq
;

1432 
	`mem£t
 (&
ªq
, 0, Ñeq - 
NL_PKT_BUF_SIZE
);

1434 
byãÀn
 = (
Ámûy
 =
AF_INET
 ? 4 : 16);

1436 
ªq
.
n
.
∆msg_Àn
 = 
	`NLMSG_LENGTH
 ( (
πmsg
));

1437 
ªq
.
n
.
∆msg_Êags
 = 
NLM_F_CREATE
 | 
NLM_F_REQUEST
;

1438 
ªq
.
n
.
∆msg_ty≥
 = 
cmd
;

1439 
ªq
.
r
.
πm_Ámûy
 = 
Ámûy
;

1440 
ªq
.
r
.
πm_èbÀ
 = 
rib
->
èbÀ
;

1441 
ªq
.
r
.
πm_d°_Àn
 = 
p
->
¥efixÀn
;

1442 
ªq
.
r
.
πm_¥Ÿocﬁ
 = 
RTPROT_ZEBRA
;

1443 
ªq
.
r
.
πm_sc›e
 = 
RT_SCOPE_UNIVERSE
;

1445 i‡((
rib
->
Êags
 & 
ZEBRA_FLAG_BLACKHOLE
Ë|| (rib->Êag†& 
ZEBRA_FLAG_REJECT
))

1446 
disˇrd
 = 1;

1448 
disˇrd
 = 0;

1450 i‡(
cmd
 =
RTM_NEWROUTE
)

1452 i‡(
disˇrd
)

1454 i‡(
rib
->
Êags
 & 
ZEBRA_FLAG_BLACKHOLE
)

1455 
ªq
.
r
.
πm_ty≥
 = 
RTN_BLACKHOLE
;

1456 i‡(
rib
->
Êags
 & 
ZEBRA_FLAG_REJECT
)

1457 
ªq
.
r
.
πm_ty≥
 = 
RTN_UNREACHABLE
;

1459 
	`as£π
 (
RTN_BLACKHOLE
 !
RTN_UNREACHABLE
);

1462 
ªq
.
r
.
πm_ty≥
 = 
RTN_UNICAST
;

1465 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_DST
, &
p
->
u
.
¥efix
, 
byãÀn
);

1468 
	`add©å32
 (&
ªq
.
n
, Ñeq, 
RTA_PRIORITY
, 
rib
->
mëric
);

1470 i‡(
disˇrd
)

1472 i‡(
cmd
 =
RTM_NEWROUTE
)

1473 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1474 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

1475 
skù
;

1479 i‡(
rib
->
√xth›_a˘ive_num
 =1 || 
MULTIPATH_NUM
 == 1)

1481 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1484 i‡((
cmd
 =
RTM_NEWROUTE


1485 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

1486 || (
cmd
 =
RTM_DELROUTE


1487 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)))

1490 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

1492 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1494 
zlog_debug


1496 "%†%s/%d,Åy≥ %s", 
	`lookup
 (
∆msg_°r
, 
cmd
),

1497 #ifde‡
HAVE_IPV6


1498 (
Ámûy
 =
AF_INET
Ë? 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
) :

1499 
	`öë6_¡ﬂ
 (
p
->
u
.
¥efix6
),

1501 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
),

1504 
p
->
¥efixÀn
, 
	`√xth›_ty≥_to_°r
 (
√xth›
->
πy≥
));

1507 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4


1508 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

1510 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_GATEWAY
,

1511 &
√xth›
->
rg©e
.
ùv4
, 
byãÀn
);

1512 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

1513 
	`add©å_l
(&
ªq
.
n
, Ñeq, 
RTA_PREFSRC
,

1514 &
√xth›
->
§c
.
ùv4
, 
byãÀn
);

1515 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1516 
	`zlog_debug
("netlink_route_multipath() (recursive, "

1518 
	`öë_¡ﬂ
 (
√xth›
->
rg©e
.
ùv4
),

1519 
√xth›
->
rifödex
);

1521 #ifde‡
HAVE_IPV6


1522 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6


1523 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX


1524 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

1526 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_GATEWAY
,

1527 &
√xth›
->
rg©e
.
ùv6
, 
byãÀn
);

1529 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1530 
	`zlog_debug
("netlink_route_multipath() (recursive, "

1532 
	`öë6_¡ﬂ
 (
√xth›
->
rg©e
.
ùv6
),

1533 
√xth›
->
rifödex
);

1536 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX


1537 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFNAME


1538 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX


1539 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX


1540 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

1542 
	`add©å32
 (&
ªq
.
n
, Ñeq, 
RTA_OIF
,

1543 
√xth›
->
rifödex
);

1544 i‡((
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX


1545 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX
)

1546 && 
√xth›
->
§c
.
ùv4
.
s_addr
)

1547 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_PREFSRC
,

1548 &
√xth›
->
§c
.
ùv4
, 
byãÀn
);

1550 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1551 
	`zlog_debug
("netlink_route_multipath() (recursive, "

1553 
√xth›
->
rifödex
);

1558 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1560 
zlog_debug


1562 "%†%s/%d,Åy≥ %s", 
	`lookup
 (
∆msg_°r
, 
cmd
),

1563 #ifde‡
HAVE_IPV6


1564 (
Ámûy
 =
AF_INET
Ë? 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
) :

1565 
	`öë6_¡ﬂ
 (
p
->
u
.
¥efix6
),

1567 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
),

1569 
p
->
¥efixÀn
, 
	`√xth›_ty≥_to_°r
 (
√xth›
->
ty≥
));

1572 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4


1573 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

1575 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_GATEWAY
,

1576 &
√xth›
->
g©e
.
ùv4
, 
byãÀn
);

1577 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

1578 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_PREFSRC
,

1579 &
√xth›
->
§c
.
ùv4
, 
byãÀn
);

1581 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1582 
	`zlog_debug
("netlink_route_multipath() (single hop): "

1584 
	`öë_¡ﬂ
 (
√xth›
->
g©e
.
ùv4
),

1585 
√xth›
->
ifödex
);

1587 #ifde‡
HAVE_IPV6


1588 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6


1589 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


1590 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

1592 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_GATEWAY
,

1593 &
√xth›
->
g©e
.
ùv6
, 
byãÀn
);

1595 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1596 
	`zlog_debug
("netlink_route_multipath() (single hop): "

1598 
	`öë6_¡ﬂ
 (
√xth›
->
g©e
.
ùv6
),

1599 
√xth›
->
ifödex
);

1602 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


1603 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


1604 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

1606 
	`add©å32
 (&
ªq
.
n
, Ñeq, 
RTA_OIF
, 
√xth›
->
ifödex
);

1608 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

1609 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_PREFSRC
,

1610 &
√xth›
->
§c
.
ùv4
, 
byãÀn
);

1612 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1613 
	`zlog_debug
("netlink_route_multipath() (single hop): "

1614 "√xth› vü i‡%u", 
√xth›
->
ifödex
);

1616 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX


1617 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

1619 
	`add©å32
 (&
ªq
.
n
, Ñeq, 
RTA_OIF
, 
√xth›
->
ifödex
);

1621 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1622 
	`zlog_debug
("netlink_route_multipath() (single hop): "

1623 "√xth› vü i‡%u", 
√xth›
->
ifödex
);

1627 i‡(
cmd
 =
RTM_NEWROUTE
)

1628 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

1630 
√xth›_num
++;

1637 
buf
[
NL_PKT_BUF_SIZE
];

1638 
π©å
 *
πa
 = (*Ë
buf
;

1639 
π√xth›
 *
πnh
;

1640 
g_addr
 *
§c
 = 
NULL
;

1642 
πa
->
πa_ty≥
 = 
RTA_MULTIPATH
;

1643 
πa
->
πa_Àn
 = 
	`RTA_LENGTH
 (0);

1644 
πnh
 = 
	`RTA_DATA
 (
πa
);

1646 
√xth›_num
 = 0;

1647 
√xth›
 = 
rib
->nexthop;

1648 
√xth›
 && (
MULTIPATH_NUM
 =0 || 
√xth›_num
 < MULTIPATH_NUM);

1649 
√xth›
 =Çexth›->
√xt
)

1651 i‡((
cmd
 =
RTM_NEWROUTE


1652 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

1653 || (
cmd
 =
RTM_DELROUTE


1654 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)))

1656 
√xth›_num
++;

1658 
πnh
->
πnh_Àn
 =  (*rtnh);

1659 
πnh
->
πnh_Êags
 = 0;

1660 
πnh
->
πnh_h›s
 = 0;

1661 
πa
->
πa_Àn
 +
πnh
->
πnh_Àn
;

1663 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

1665 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1667 
	`zlog_debug
 ("netlink_route_multipath() "

1669 
	`lookup
 (
∆msg_°r
, 
cmd
),

1670 #ifde‡
HAVE_IPV6


1671 (
Ámûy
 =
AF_INET
Ë? 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
) :

1672 
	`öë6_¡ﬂ
 (
p
->
u
.
¥efix6
),

1674 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
),

1676 
p
->
¥efixÀn
, 
	`√xth›_ty≥_to_°r
 (
√xth›
->
πy≥
));

1678 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4


1679 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

1681 
	`πa_add©å_l
 (
πa
, 
NL_PKT_BUF_SIZE
, 
RTA_GATEWAY
,

1682 &
√xth›
->
rg©e
.
ùv4
, 
byãÀn
);

1683 
πnh
->
πnh_Àn
 + (
π©å
) + 4;

1685 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

1686 
§c
 = &
√xth›
->src;

1688 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1689 
	`zlog_debug
("netlink_route_multipath() (recursive, "

1691 
	`öë_¡ﬂ
 (
√xth›
->
rg©e
.
ùv4
),

1692 
√xth›
->
rifödex
);

1694 #ifde‡
HAVE_IPV6


1695 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6


1696 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


1697 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

1699 
	`πa_add©å_l
 (
πa
, 
NL_PKT_BUF_SIZE
, 
RTA_GATEWAY
,

1700 &
√xth›
->
rg©e
.
ùv6
, 
byãÀn
);

1702 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1703 
	`zlog_debug
("netlink_route_multipath() (recursive, "

1705 
	`öë6_¡ﬂ
 (
√xth›
->
rg©e
.
ùv6
),

1706 
√xth›
->
rifödex
);

1710 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX


1711 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX


1712 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFNAME
)

1714 
πnh
->
πnh_ifödex
 = 
√xth›
->
rifödex
;

1715 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

1716 
§c
 = &
√xth›
->src;

1718 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1719 
	`zlog_debug
("netlink_route_multipath() (recursive, "

1721 
√xth›
->
rifödex
);

1723 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX


1724 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

1726 
πnh
->
πnh_ifödex
 = 
√xth›
->
rifödex
;

1728 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1729 
	`zlog_debug
("netlink_route_multipath() (recursive, "

1731 
√xth›
->
rifödex
);

1735 
πnh
->
πnh_ifödex
 = 0;

1740 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1742 
	`zlog_debug
 ("netlink_route_multipath() (multihop): "

1743 "%†%s/%d,Åy≥ %s", 
	`lookup
 (
∆msg_°r
, 
cmd
),

1744 #ifde‡
HAVE_IPV6


1745 (
Ámûy
 =
AF_INET
Ë? 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
) :

1746 
	`öë6_¡ﬂ
 (
p
->
u
.
¥efix6
),

1748 
	`öë_¡ﬂ
 (
p
->
u
.
¥efix4
),

1750 
p
->
¥efixÀn
, 
	`√xth›_ty≥_to_°r
 (
√xth›
->
ty≥
));

1752 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4


1753 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

1755 
	`πa_add©å_l
 (
πa
, 
NL_PKT_BUF_SIZE
, 
RTA_GATEWAY
,

1756 &
√xth›
->
g©e
.
ùv4
, 
byãÀn
);

1757 
πnh
->
πnh_Àn
 + (
π©å
) + 4;

1759 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

1760 
§c
 = &
√xth›
->src;

1762 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1763 
	`zlog_debug
("netlink_route_multipath() (multihop): "

1765 
	`öë_¡ﬂ
 (
√xth›
->
g©e
.
ùv4
),

1766 
√xth›
->
ifödex
);

1768 #ifde‡
HAVE_IPV6


1769 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6


1770 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


1771 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

1773 
	`πa_add©å_l
 (
πa
, 
NL_PKT_BUF_SIZE
, 
RTA_GATEWAY
,

1774 &
√xth›
->
g©e
.
ùv6
, 
byãÀn
);

1776 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1777 
	`zlog_debug
("netlink_route_multipath() (multihop): "

1779 
	`öë6_¡ﬂ
 (
√xth›
->
g©e
.
ùv6
),

1780 
√xth›
->
ifödex
);

1784 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX


1785 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


1786 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME
)

1788 
πnh
->
πnh_ifödex
 = 
√xth›
->
ifödex
;

1789 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

1790 
§c
 = &
√xth›
->src;

1791 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1792 
	`zlog_debug
("netlink_route_multipath() (multihop): "

1793 "√xth› vü i‡%u", 
√xth›
->
ifödex
);

1795 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


1796 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

1798 
πnh
->
πnh_ifödex
 = 
√xth›
->
ifödex
;

1800 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1801 
	`zlog_debug
("netlink_route_multipath() (multihop): "

1802 "√xth› vü i‡%u", 
√xth›
->
ifödex
);

1806 
πnh
->
πnh_ifödex
 = 0;

1809 
πnh
 = 
	`RTNH_NEXT
 (rtnh);

1811 i‡(
cmd
 =
RTM_NEWROUTE
)

1812 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

1815 i‡(
§c
)

1816 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
RTA_PREFSRC
, &
§c
->
ùv4
, 
byãÀn
);

1818 i‡(
πa
->
πa_Àn
 > 
	`RTA_LENGTH
 (0))

1819 
	`add©å_l
 (&
ªq
.
n
, 
NL_PKT_BUF_SIZE
, 
RTA_MULTIPATH
, 
	`RTA_DATA
 (
πa
),

1820 
	`RTA_PAYLOAD
 (
πa
));

1824 i‡(
√xth›_num
 == 0)

1826 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

1827 
	`zlog_debug
 ("netlink_route_multipath(): No usefulÇexthop.");

1831 
skù
:

1834 
	`mem£t
 (&
¢l
, 0,  snl);

1835 
¢l
.
∆_Ámûy
 = 
AF_NETLINK
;

1838  
	`√éök_èlk
 (&
ªq
.
n
, &
√éök_cmd
);

1839 
	}
}

1842 
	$kî√l_add_ùv4
 (
¥efix
 *
p
, 
rib
 *rib)

1844  
	`√éök_rouã_mu…ù©h
 (
RTM_NEWROUTE
, 
p
, 
rib
, 
AF_INET
);

1845 
	}
}

1848 
	$kî√l_dñëe_ùv4
 (
¥efix
 *
p
, 
rib
 *rib)

1850  
	`√éök_rouã_mu…ù©h
 (
RTM_DELROUTE
, 
p
, 
rib
, 
AF_INET
);

1851 
	}
}

1853 #ifde‡
HAVE_IPV6


1855 
	$kî√l_add_ùv6
 (
¥efix
 *
p
, 
rib
 *rib)

1857  
	`√éök_rouã_mu…ù©h
 (
RTM_NEWROUTE
, 
p
, 
rib
, 
AF_INET6
);

1858 
	}
}

1861 
	$kî√l_dñëe_ùv6
 (
¥efix
 *
p
, 
rib
 *rib)

1863  
	`√éök_rouã_mu…ù©h
 (
RTM_DELROUTE
, 
p
, 
rib
, 
AF_INET6
);

1864 
	}
}

1868 
	$kî√l_dñëe_ùv6_ﬁd
 (
¥efix_ùv6
 *
de°
, 
ö6_addr
 *
g©e
,

1869 
ödex
, 
Êags
, 
èbÀ
)

1871  
	`√éök_rouã
 (
RTM_DELROUTE
, 
AF_INET6
, &
de°
->
¥efix
,

1872 
de°
->
¥efixÀn
, 
g©e
, 
ödex
, 
Êags
, 
èbÀ
);

1873 
	}
}

1878 
	$√éök_addªss
 (
cmd
, 
Ámûy
, 
öãrÁ˚
 *
iÂ
,

1879 
c⁄√˘ed
 *
ifc
)

1881 
byãÀn
;

1882 
¥efix
 *
p
;

1886 
∆msghdr
 
n
;

1887 
iÁddrmsg
 
iÁ
;

1888 
buf
[
NL_PKT_BUF_SIZE
];

1889 } 
ªq
;

1891 
p
 = 
ifc
->
addªss
;

1892 
	`mem£t
 (&
ªq
, 0, Ñeq - 
NL_PKT_BUF_SIZE
);

1894 
byãÀn
 = (
Ámûy
 =
AF_INET
 ? 4 : 16);

1896 
ªq
.
n
.
∆msg_Àn
 = 
	`NLMSG_LENGTH
 ( (
iÁddrmsg
));

1897 
ªq
.
n
.
∆msg_Êags
 = 
NLM_F_REQUEST
;

1898 
ªq
.
n
.
∆msg_ty≥
 = 
cmd
;

1899 
ªq
.
iÁ
.
iÁ_Ámûy
 = 
Ámûy
;

1901 
ªq
.
iÁ
.
iÁ_ödex
 = 
iÂ
->
ifödex
;

1902 
ªq
.
iÁ
.
iÁ_¥efixÀn
 = 
p
->
¥efixÀn
;

1904 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
IFA_LOCAL
, &
p
->
u
.
¥efix
, 
byãÀn
);

1906 i‡(
Ámûy
 =
AF_INET
 && 
cmd
 =
RTM_NEWADDR
)

1908 i‡(!
	`CONNECTED_PEER
(
ifc
Ë&& ifc->
de°ö©i⁄
)

1910 
p
 = 
ifc
->
de°ö©i⁄
;

1911 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
IFA_BROADCAST
, &
p
->
u
.
¥efix
,

1912 
byãÀn
);

1916 i‡(
	`CHECK_FLAG
 (
ifc
->
Êags
, 
ZEBRA_IFA_SECONDARY
))

1917 
	`SET_FLAG
 (
ªq
.
iÁ
.
iÁ_Êags
, 
IFA_F_SECONDARY
);

1919 i‡(
ifc
->
œbñ
)

1920 
	`add©å_l
 (&
ªq
.
n
, Ñeq, 
IFA_LABEL
, 
ifc
->
œbñ
,

1921 
	`°æí
 (
ifc
->
œbñ
) + 1);

1923  
	`√éök_èlk
 (&
ªq
.
n
, &
√éök_cmd
);

1924 
	}
}

1927 
	$kî√l_addªss_add_ùv4
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

1929  
	`√éök_addªss
 (
RTM_NEWADDR
, 
AF_INET
, 
iÂ
, 
ifc
);

1930 
	}
}

1933 
	$kî√l_addªss_dñëe_ùv4
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

1935  
	`√éök_addªss
 (
RTM_DELADDR
, 
AF_INET
, 
iÂ
, 
ifc
);

1936 
	}
}

1939 
thªad_ma°î
 *
ma°î
;

1943 
	$kî√l_ªad
 (
thªad
 *thread)

1945 
	`√éök_∑r£_öfo
 (
√éök_öf‹m©i⁄_„tch
, &
√éök
);

1946 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
kî√l_ªad
, 
NULL
, 
√éök
.
sock
);

1949 
	}
}

1954 
	$√éök_ö°Æl_fûãr
 (
sock
, 
__u32
 
pid
)

1956 
sock_fûãr
 
fûãr
[] = {

1958 
	`BPF_STMT
(
BPF_LD
|
BPF_ABS
|
BPF_H
, 
	`off£tof
(
∆msghdr
, 
∆msg_ty≥
)),

1960 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
	`ht⁄s
(
RTM_NEWROUTE
), 1, 0),

1962 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
	`ht⁄s
(
RTM_DELROUTE
), 0, 3),

1964 
	`BPF_STMT
(
BPF_LD
|
BPF_ABS
|
BPF_W
, 
	`off£tof
(
∆msghdr
, 
∆msg_pid
)),

1966 
	`BPF_JUMP
(
BPF_JMP
|
BPF_JEQ
|
BPF_K
, 
	`ht⁄l
(
pid
), 0, 1),

1968 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, 0),

1970 
	`BPF_STMT
(
BPF_RET
|
BPF_K
, 0xffff),

1973 
sock_Ârog
 
¥og
 = {

1974 .
Àn
 = 
	`¨øy_size
(
fûãr
),

1975 .
fûãr
 = filter,

1978 i‡(
	`£tsock›t
(
sock
, 
SOL_SOCKET
, 
SO_ATTACH_FILTER
, &
¥og
, (prog)) < 0)

1979 
	`zlog_w¨n
 ("C™'àö°Æ»sockë fûãr: %s\n", 
	`ß„_°ªº‹
(
î∫o
));

1980 
	}
}

1985 
	$kî√l_öô
 ()

1987 
groups
;

1989 
groups
 = 
RTMGRP_LINK
 | 
RTMGRP_IPV4_ROUTE
 | 
RTMGRP_IPV4_IFADDR
;

1990 #ifde‡
HAVE_IPV6


1991 
groups
 |
RTMGRP_IPV6_ROUTE
 | 
RTMGRP_IPV6_IFADDR
;

1993 
	`√éök_sockë
 (&
√éök
, 
groups
);

1994 
	`√éök_sockë
 (&
√éök_cmd
, 0);

1997 i‡(
√éök
.
sock
 > 0)

2000 i‡(
	`f˙é
 (
√éök
.
sock
, 
F_SETFL
, 
O_NONBLOCK
) < 0)

2001 
	`zlog
 (
NULL
, 
LOG_ERR
, "C™'à£à%†sockë fœgs: %s", 
√éök
.
«me
,

2002 
	`ß„_°ªº‹
 (
î∫o
));

2005 i‡(
∆_rcvbufsize
)

2006 
	`√éök_ªcvbuf
 (&
√éök
, 
∆_rcvbufsize
);

2008 
	`√éök_ö°Æl_fûãr
 (
√éök
.
sock
, 
√éök_cmd
.
¢l
.
∆_pid
);

2009 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
kî√l_ªad
, 
NULL
, 
√éök
.
sock
);

2011 
	}
}

2017 
	$∆_msg_ty≥_to_°r
 (
uöt16_t
 
msg_ty≥
)

2019  
	`lookup
 (
∆msg_°r
, 
msg_ty≥
);

2020 
	}
}

2026 
	$∆_π¥Ÿo_to_°r
 (
u_ch¨
 
π¥Ÿo
)

2028  
	`lookup
 (
π¥Ÿo_°r
, 
π¥Ÿo
);

2029 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_netlink.h

22 #i‚de‡
_ZEBRA_RT_NETLINK_H


23 
	#_ZEBRA_RT_NETLINK_H


	)

25 #ifde‡
HAVE_NETLINK


27 
	#NL_PKT_BUF_SIZE
 8192

	)

30 
add©å32
 (
∆msghdr
 *
n
, 
maxÀn
, 
ty≥
, 
d©a
);

32 
add©å_l
 (
∆msghdr
 *
n
, 
maxÀn
, 
ty≥
, *
d©a
, 
Æí
);

35 
πa_add©å_l
 (
π©å
 *
πa
, 
maxÀn
, 
ty≥
, *
d©a
, 
Æí
);

38 
∆_msg_ty≥_to_°r
 (
uöt16_t
 
msg_ty≥
);

41 
∆_π¥Ÿo_to_°r
 (
u_ch¨
 
π¥Ÿo
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_socket.c

23 
	~<zebø.h
>

25 
	~"if.h
"

26 
	~"¥efix.h
"

27 
	~"sockuni⁄.h
"

28 
	~"log.h
"

29 
	~"°r.h
"

30 
	~"¥ivs.h
"

32 
	~"zebø/debug.h
"

33 
	~"zebø/rib.h
"

34 
	~"zebø/π.h
"

35 
	~"zebø/kî√l_sockë.h
"

37 
zebø_¥ivs_t
 
z£rv_¥ivs
;

40 
πm_wrôe
 (
mesßge
, 
sockuni⁄
 *
de°
,

41 
sockuni⁄
 *
mask
, sockuni⁄ *
g©e
,

42 
ödex
, 
zebø_Êags
, 
mëric
);

47 
	$sö_maskÀn
 (
ö_addr
 
mask
)

49 *
p
, *
lim
;

50 
Àn
;

51 
sockaddr_ö
 
sö
;

53 i‡(
mask
.
s_addr
 == 0)

56 
sö
.
sö_addr
 = 
mask
;

57 
Àn
 =  (
sockaddr_ö
);

59 
lim
 = (*Ë&
sö
.
sö_addr
;

60 
p
 = 
lim
 +  (
sö
.
sö_addr
);

62 *--
p
 =0 &&Ö >
lim
)

63 
Àn
--;

64  
Àn
;

65 
	}
}

69 
	$kî√l_πm_ùv4
 (
cmd
, 
¥efix
 *
p
, 
rib
 *rib, 
Ámûy
)

72 
sockaddr_ö
 *
mask
 = 
NULL
;

73 
sockaddr_ö
 
sö_de°
, 
sö_mask
, 
sö_g©e
;

74 
√xth›
 *nexthop;

75 
√xth›_num
 = 0;

76 
ifödex
 = 0;

77 
g©e
 = 0;

78 
îr‹
;

79 
¥efix_buf
[
INET_ADDRSTRLEN
];

81 i‡(
IS_ZEBRA_DEBUG_RIB
)

82 
	`öë_¡›
 (
AF_INET
, &
p
->
u
.
¥efix
, 
¥efix_buf
, 
INET_ADDRSTRLEN
);

83 
	`mem£t
 (&
sö_de°
, 0,  (
sockaddr_ö
));

84 
sö_de°
.
sö_Ámûy
 = 
AF_INET
;

85 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


86 
sö_de°
.
sö_Àn
 =  (
sockaddr_ö
);

88 
sö_de°
.
sö_addr
 = 
p
->
u
.
¥efix4
;

90 
	`mem£t
 (&
sö_mask
, 0,  (
sockaddr_ö
));

92 
	`mem£t
 (&
sö_g©e
, 0,  (
sockaddr_ö
));

93 
sö_g©e
.
sö_Ámûy
 = 
AF_INET
;

94 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


95 
sö_g©e
.
sö_Àn
 =  (
sockaddr_ö
);

99 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

101 
g©e
 = 0;

102 
g©e_buf
[
INET_ADDRSTRLEN
] = "NULL";

109 i‡((
cmd
 =
RTM_ADD


110 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

111 || (
cmd
 =
RTM_DELETE


112 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

115 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

117 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4
 ||

118 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

120 
sö_g©e
.
sö_addr
 = 
√xth›
->
rg©e
.
ùv4
;

121 
g©e
 = 1;

123 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX


124 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFNAME


125 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

126 
ifödex
 = 
√xth›
->
rifödex
;

130 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4
 ||

131 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

133 
sö_g©e
.
sö_addr
 = 
√xth›
->
g©e
.
ùv4
;

134 
g©e
 = 1;

136 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


137 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


138 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

139 
ifödex
 = 
√xth›
->ifindex;

140 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_BLACKHOLE
)

142 
ö_addr
 
lo›back
;

143 
lo›back
.
s_addr
 = 
	`ht⁄l
 (
INADDR_LOOPBACK
);

144 
sö_g©e
.
sö_addr
 = 
lo›back
;

145 
g©e
 = 1;

149 i‡(
g©e
 && 
p
->
¥efixÀn
 == 32)

150 
mask
 = 
NULL
;

153 
	`maskÀn2ù
 (
p
->
¥efixÀn
, &
sö_mask
.
sö_addr
);

154 
sö_mask
.
sö_Ámûy
 = 
AF_INET
;

155 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


156 
sö_mask
.
sö_Àn
 = 
	`sö_maskÀn
 (sö_mask.
sö_addr
);

158 
mask
 = &
sö_mask
;

161 
îr‹
 = 
	`πm_wrôe
 (
cmd
,

162 (
sockuni⁄
 *)&
sö_de°
,

163 (
sockuni⁄
 *)
mask
,

164 
g©e
 ? (
sockuni⁄
 *)&
sö_g©e
 : 
NULL
,

165 
ifödex
,

166 
rib
->
Êags
,

167 
rib
->
mëric
);

169 i‡(
IS_ZEBRA_DEBUG_RIB
)

171 i‡(!
g©e
)

173 
	`zlog_debug
 ("%s: %s/%d:áttention! gateÇot found forÑib %p",

174 
__func__
, 
¥efix_buf
, 
p
->
¥efixÀn
, 
rib
);

175 
	`rib_dump
 (
__func__
, (
¥efix_ùv4
 *)
p
, 
rib
);

178 
	`öë_¡›
 (
AF_INET
, &
sö_g©e
.
sö_addr
, 
g©e_buf
, 
INET_ADDRSTRLEN
);

181 
îr‹
)

184 
ZEBRA_ERR_NOERROR
:

185 
√xth›_num
++;

186 i‡(
IS_ZEBRA_DEBUG_RIB
)

187 
	`zlog_debug
 ("%s: %s/%d: successfully did NH %s",

188 
__func__
, 
¥efix_buf
, 
p
->
¥efixÀn
, 
g©e_buf
);

189 i‡(
cmd
 =
RTM_ADD
)

190 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

197 
ZEBRA_ERR_RTEXIST
:

198 i‡(
cmd
 !
RTM_ADD
)

199 
	`zlog_îr
 ("%s:Ñtm_write()Ñeturned %d for command %d",

200 
__func__
, 
îr‹
, 
cmd
);

207 
ZEBRA_ERR_RTNOEXIST
:

208 
ZEBRA_ERR_RTUNREACH
:

211 i‡(!
IS_ZEBRA_DEBUG_RIB
)

212 
	`öë_¡›
 (
AF_INET
, &
p
->
u
.
¥efix
, 
¥efix_buf
, 
INET_ADDRSTRLEN
);

213 
	`zlog_îr
 ("%s: %s/%d:Ñtm_write() unexpectedlyÑeturned %d for command %s",

214 
__func__
, 
¥efix_buf
, 
p
->
¥efixÀn
, 
îr‹
, 
	`lookup
 (
πm_ty≥_°r
, 
cmd
));

219 i‡(
IS_ZEBRA_DEBUG_RIB
)

220 
	`zlog_debug
 ("%s: odd command %s for flags %d",

221 
__func__
, 
	`lookup
 (
πm_ty≥_°r
, 
cmd
), 
√xth›
->
Êags
);

225 i‡(
√xth›_num
 =0 && 
IS_ZEBRA_DEBUG_KERNEL
)

226 
	`zlog_debug
 ("%s: Nÿu£fu»√xth›†wîêfound i¿RIBÉ¡ry %p", 
__func__
, 
rib
);

229 
	}
}

232 
	$kî√l_add_ùv4
 (
¥efix
 *
p
, 
rib
 *rib)

234 
rouã
;

236 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

237 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

238 
rouã
 = 
	`kî√l_πm_ùv4
 (
RTM_ADD
, 
p
, 
rib
, 
AF_INET
);

239 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

240 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

242  
rouã
;

243 
	}
}

246 
	$kî√l_dñëe_ùv4
 (
¥efix
 *
p
, 
rib
 *rib)

248 
rouã
;

250 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

251 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

252 
rouã
 = 
	`kî√l_πm_ùv4
 (
RTM_DELETE
, 
p
, 
rib
, 
AF_INET
);

253 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

254 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

256  
rouã
;

257 
	}
}

259 #ifde‡
HAVE_IPV6


263 
	$sö6_maskÀn
 (
ö6_addr
 
mask
)

265 
sockaddr_ö6
 
sö6
;

266 *
p
, *
lim
;

267 
Àn
;

269 #i‡
	`deföed
 (
INRIA
)

270 i‡(
	`IN_ANYADDR6
 (
mask
))

273 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
mask
))

277 
sö6
.
sö6_addr
 = 
mask
;

278 
Àn
 =  (
sockaddr_ö6
);

280 
lim
 = (*Ë& 
sö6
.
sö6_addr
;

281 
p
 = 
lim
 +  (
sö6
.
sö6_addr
);

283 *--
p
 =0 &&Ö >
lim
)

284 
Àn
--;

286  
Àn
;

287 
	}
}

291 
	$kî√l_πm_ùv6
 (
mesßge
, 
¥efix_ùv6
 *
de°
,

292 
ö6_addr
 *
g©e
, 
ödex
, 
Êags
)

294 
sockaddr_ö6
 *
mask
;

295 
sockaddr_ö6
 
sö_de°
, 
sö_mask
, 
sö_g©e
;

297 
	`mem£t
 (&
sö_de°
, 0,  (
sockaddr_ö6
));

298 
sö_de°
.
sö6_Ámûy
 = 
AF_INET6
;

299 #ifde‡
SIN6_LEN


300 
sö_de°
.
sö6_Àn
 =  (
sockaddr_ö6
);

303 
	`mem£t
 (&
sö_mask
, 0,  (
sockaddr_ö6
));

305 
	`mem£t
 (&
sö_g©e
, 0,  (
sockaddr_ö6
));

306 
sö_g©e
.
sö6_Ámûy
 = 
AF_INET6
;

307 #ifde‡
SIN6_LEN


308 
sö_g©e
.
sö6_Àn
 =  (
sockaddr_ö6
);

311 
sö_de°
.
sö6_addr
 = 
de°
->
¥efix
;

313 i‡(
g©e
)

314 
	`mem˝y
 (&
sö_g©e
.
sö6_addr
, 
g©e
,  (
ö6_addr
));

317 #ifde‡
KAME


319 
	#SET_IN6_LINKLOCAL_IFINDEX
(
a
, 
i
) \

321 (
a
).
s6_addr
[2] = ((
i
) >> 8) & 0xff; \

322 (
a
).
s6_addr
[3] = (
i
) & 0xff; \

323 } 0)

	)

325 i‡(
g©e
 && 
	`IN6_IS_ADDR_LINKLOCAL
(gate))

326 
	`SET_IN6_LINKLOCAL_IFINDEX
 (
sö_g©e
.
sö6_addr
, 
ödex
);

329 i‡(
g©e
 && 
de°
->
¥efixÀn
 == 128)

330 
mask
 = 
NULL
;

333 
	`maskÀn2ù6
 (
de°
->
¥efixÀn
, &
sö_mask
.
sö6_addr
);

334 
sö_mask
.
sö6_Ámûy
 = 
AF_INET6
;

335 #ifde‡
SIN6_LEN


336 
sö_mask
.
sö6_Àn
 = 
	`sö6_maskÀn
 (sö_mask.
sö6_addr
);

338 
mask
 = &
sö_mask
;

341  
	`πm_wrôe
 (
mesßge
,

342 (
sockuni⁄
 *Ë&
sö_de°
,

343 (
sockuni⁄
 *Ë
mask
,

344 
g©e
 ? (
sockuni⁄
 *)&
sö_g©e
 : 
NULL
,

345 
ödex
,

346 
Êags
,

348 
	}
}

352 
	$kî√l_πm_ùv6_mu…ù©h
 (
cmd
, 
¥efix
 *
p
, 
rib
 *rib,

353 
Ámûy
)

355 
sockaddr_ö6
 *
mask
;

356 
sockaddr_ö6
 
sö_de°
, 
sö_mask
, 
sö_g©e
;

357 
√xth›
 *nexthop;

358 
√xth›_num
 = 0;

359 
ifödex
 = 0;

360 
g©e
 = 0;

361 
îr‹
;

363 
	`mem£t
 (&
sö_de°
, 0,  (
sockaddr_ö6
));

364 
sö_de°
.
sö6_Ámûy
 = 
AF_INET6
;

365 #ifde‡
SIN6_LEN


366 
sö_de°
.
sö6_Àn
 =  (
sockaddr_ö6
);

368 
sö_de°
.
sö6_addr
 = 
p
->
u
.
¥efix6
;

370 
	`mem£t
 (&
sö_mask
, 0,  (
sockaddr_ö6
));

372 
	`mem£t
 (&
sö_g©e
, 0,  (
sockaddr_ö6
));

373 
sö_g©e
.
sö6_Ámûy
 = 
AF_INET6
;

374 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


375 
sö_g©e
.
sö6_Àn
 =  (
sockaddr_ö6
);

379 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

381 
g©e
 = 0;

383 i‡((
cmd
 =
RTM_ADD


384 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

385 || (
cmd
 =
RTM_DELETE


387 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

391 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

393 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6


394 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


395 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

397 
sö_g©e
.
sö6_addr
 = 
√xth›
->
rg©e
.
ùv6
;

398 
g©e
 = 1;

400 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX


401 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFNAME


402 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


403 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

404 
ifödex
 = 
√xth›
->
rifödex
;

408 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6


409 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


410 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

412 
sö_g©e
.
sö6_addr
 = 
√xth›
->
g©e
.
ùv6
;

413 
g©e
 = 1;

415 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


416 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


417 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


418 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

419 
ifödex
 = 
√xth›
->ifindex;

422 i‡(
cmd
 =
RTM_ADD
)

423 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

427 #ifde‡
KAME


429 
	#SET_IN6_LINKLOCAL_IFINDEX
(
a
, 
i
) \

431 (
a
).
s6_addr
[2] = ((
i
) >> 8) & 0xff; \

432 (
a
).
s6_addr
[3] = (
i
) & 0xff; \

433 } 0)

	)

435 i‡(
g©e
 && 
	`IN6_IS_ADDR_LINKLOCAL
(&
sö_g©e
.
sö6_addr
))

436 
	`SET_IN6_LINKLOCAL_IFINDEX
 (
sö_g©e
.
sö6_addr
, 
ifödex
);

439 i‡(
g©e
 && 
p
->
¥efixÀn
 == 128)

440 
mask
 = 
NULL
;

443 
	`maskÀn2ù6
 (
p
->
¥efixÀn
, &
sö_mask
.
sö6_addr
);

444 
sö_mask
.
sö6_Ámûy
 = 
AF_INET6
;

445 #ifde‡
SIN6_LEN


446 
sö_mask
.
sö6_Àn
 = 
	`sö6_maskÀn
 (sö_mask.
sö6_addr
);

448 
mask
 = &
sö_mask
;

451 
îr‹
 = 
	`πm_wrôe
 (
cmd
,

452 (
sockuni⁄
 *Ë&
sö_de°
,

453 (
sockuni⁄
 *Ë
mask
,

454 
g©e
 ? (
sockuni⁄
 *)&
sö_g©e
 : 
NULL
,

455 
ifödex
,

456 
rib
->
Êags
,

457 
rib
->
mëric
);

460 i‡(
îr‹
)

462 
	`zlog_öfo
 ("kernel_rtm_ipv6_multipath():Çexthop %dáddÉrror=%d.",

463 
√xth›_num
, 
îr‹
);

467 
√xth›_num
++;

471 i‡(
√xth›_num
 == 0)

473 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

474 
	`zlog_debug
 ("kernel_rtm_ipv6_multipath(): No usefulÇexthop.");

479 
	}
}

482 
	$kî√l_add_ùv6
 (
¥efix
 *
p
, 
rib
 *rib)

484 
rouã
;

486 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

487 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

488 
rouã
 = 
	`kî√l_πm_ùv6_mu…ù©h
 (
RTM_ADD
, 
p
, 
rib
, 
AF_INET6
);

489 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

490 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

492  
rouã
;

493 
	}
}

496 
	$kî√l_dñëe_ùv6
 (
¥efix
 *
p
, 
rib
 *rib)

498 
rouã
;

500 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

501 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

502 
rouã
 = 
	`kî√l_πm_ùv6_mu…ù©h
 (
RTM_DELETE
, 
p
, 
rib
, 
AF_INET6
);

503 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

504 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

506  
rouã
;

507 
	}
}

511 
	$kî√l_dñëe_ùv6_ﬁd
 (
¥efix_ùv6
 *
de°
, 
ö6_addr
 *
g©e
,

512 
ödex
, 
Êags
, 
èbÀ
)

514 
rouã
;

516 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
))

517 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

518 
rouã
 = 
	`kî√l_πm_ùv6
 (
RTM_DELETE
, 
de°
, 
g©e
, 
ödex
, 
Êags
);

519 i‡(
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
))

520 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

522  
rouã
;

523 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtadv.c

23 
	~<zebø.h
>

25 
	~"mem‹y.h
"

26 
	~"sock›t.h
"

27 
	~"thªad.h
"

28 
	~"if.h
"

29 
	~"log.h
"

30 
	~"¥efix.h
"

31 
	~"lökli°.h
"

32 
	~"comm™d.h
"

33 
	~"¥ivs.h
"

35 
	~"zebø/öãrÁ˚.h
"

36 
	~"zebø/πadv.h
"

37 
	~"zebø/debug.h
"

38 
	~"zebø/rib.h
"

39 
	~"zebø/z£rv.h
"

41 
zebø_¥ivs_t
 
z£rv_¥ivs
;

43 #i‡
deföed
 (
HAVE_IPV6
Ë&& deföed (
RTADV
)

45 #ifde‡
OPEN_BSD


46 
	~<√töë/icmp6.h
>

50 #i‚de‡
IPV6_JOIN_GROUP


51 
	#IPV6_JOIN_GROUP
 
IPV6_ADD_MEMBERSHIP


	)

53 #i‚de‡
IPV6_LEAVE_GROUP


54 
	#IPV6_LEAVE_GROUP
 
IPV6_DROP_MEMBERSHIP


	)

57 
	#ALLNODE
 "ff02::1"

	)

58 
	#ALLROUTER
 "ff02::2"

	)

60 
zebø_t
 
zebød
;

62 
	eπadv_evít
 {
	mRTADV_START
, 
	mRTADV_STOP
, 
	mRTADV_TIMER
,

63 
	mRTADV_TIMER_MSEC
, 
	mRTADV_READ
};

65 
πadv_evít
 (rtadv_event, );

67 
if_joö_Æl_rouãr
 (, 
öãrÁ˚
 *);

68 
if_Àave_Æl_rouãr
 (, 
öãrÁ˚
 *);

71 
	sπadv


73 
	msock
;

75 
	madv_if_cou¡
;

76 
	madv_m£c_if_cou¡
;

78 
thªad
 *
	mø_ªad
;

79 
thªad
 *
	mø_timî
;

82 
πadv
 *
	gπadv
 = 
NULL
;

84 
πadv
 *

85 
	$πadv_√w
 ()

87  
	`XCALLOC
 (
MTYPE_TMP
,  (
πadv
));

88 
	}
}

91 
	$πadv_ªcv_∑ckë
 (
sock
, 
u_ch¨
 *
buf
, 
buÊí
,

92 
sockaddr_ö6
 *
‰om
, *
ifödex
,

93 *
h›limô
)

95 
ªt
;

96 
msghdr
 
msg
;

97 
iovec
 
iov
;

98 
cmsghdr
 *
cmsg±r
;

99 
ö6_addr
 
d°
;

101 
ad©a
[1024];

104 
msg
.
msg_«me
 = (*Ë
‰om
;

105 
msg
.
msg_«mñí
 =  (
sockaddr_ö6
);

106 
msg
.
msg_iov
 = &
iov
;

107 
msg
.
msg_iovÀn
 = 1;

108 
msg
.
msg_c⁄åﬁ
 = (*Ë
ad©a
;

109 
msg
.
msg_c⁄åﬁÀn
 =  
ad©a
;

110 
iov
.
iov_ba£
 = 
buf
;

111 
iov
.
iov_Àn
 = 
buÊí
;

114 
ªt
 = 
	`ªcvmsg
 (
sock
, &
msg
, 0);

115 i‡(
ªt
 < 0)

116  
ªt
;

118 
cmsg±r
 = 
	`ZCMSG_FIRSTHDR
(&
msg
); cmsg±∏!
NULL
;

119 
cmsg±r
 = 
	`CMSG_NXTHDR
(&
msg
, cmsgptr))

122 i‡(
cmsg±r
->
cmsg_Àvñ
 =
IPPROTO_IPV6
 &&

123 
cmsg±r
->
cmsg_ty≥
 =
IPV6_PKTINFO
)

125 
ö6_pktöfo
 *
±r
;

127 
±r
 = (
ö6_pktöfo
 *Ë
	`CMSG_DATA
 (
cmsg±r
);

128 *
ifödex
 = 
±r
->
ùi6_ifödex
;

129 
	`mem˝y
(&
d°
, &
±r
->
ùi6_addr
, (ptr->ipi6_addr));

133 i‡(
cmsg±r
->
cmsg_Àvñ
 =
IPPROTO_IPV6
 &&

134 
cmsg±r
->
cmsg_ty≥
 =
IPV6_HOPLIMIT
)

136 *
h›å
 = (*Ë
	`CMSG_DATA
 (
cmsg±r
);

137 *
h›limô
 = *
h›å
;

140  
ªt
;

141 
	}
}

143 
	#RTADV_MSG_SIZE
 4096

	)

147 
	$πadv_£nd_∑ckë
 (
sock
, 
öãrÁ˚
 *
iÂ
)

149 
msghdr
 
msg
;

150 
iovec
 
iov
;

151 
cmsghdr
 *
cmsg±r
;

152 
ö6_pktöfo
 *
pkt
;

153 
sockaddr_ö6
 
addr
;

154 #ifde‡
HAVE_STRUCT_SOCKADDR_DL


155 
sockaddr_dl
 *
sdl
;

157 *
ad©a
 = 
NULL
;

158 
buf
[
RTADV_MSG_SIZE
];

159 
nd_rouãr_advît
 *
πadv
;

160 
ªt
;

161 
Àn
 = 0;

162 
zebø_if
 *
zif
;

163 
πadv_¥efix
 *
Ωªfix
;

164 
u_ch¨
 
Æl_nodes_addr
[] = {0xff,0x02,0,0,0,0,0,0,0,0,0,0,0,0,0,1};

165 
li°node
 *
node
;

166 
u_öt16_t
 
pkt_RouãrLi„time
;

174 i‡(
ad©a
 =
NULL
)

177 
ad©a
 = 
	`mÆloc
(
	`CMSG_SPACE
((
ö6_pktöfo
)));

179 i‡(
ad©a
 =
NULL
)

180 
	`zlog_îr
("rtadv_send_packet: can't malloc control data\n");

184 i‡(
IS_ZEBRA_DEBUG_PACKET
)

185 
	`zlog_debug
 ("Rouã∏advîti£míà£ndÅÿ%s", 
iÂ
->
«me
);

188 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö6
));

189 
addr
.
sö6_Ámûy
 = 
AF_INET6
;

190 #ifde‡
SIN6_LEN


191 
addr
.
sö6_Àn
 =  (
sockaddr_ö6
);

193 
addr
.
sö6_p‹t
 = 
	`ht⁄s
 (
IPPROTO_ICMPV6
);

194 
	`IPV6_ADDR_COPY
 (&
addr
.
sö6_addr
, 
Æl_nodes_addr
);

197 
zif
 = 
iÂ
->
öfo
;

200 
πadv
 = (
nd_rouãr_advît
 *Ë
buf
;

202 
πadv
->
nd_ø_ty≥
 = 
ND_ROUTER_ADVERT
;

203 
πadv
->
nd_ø_code
 = 0;

204 
πadv
->
nd_ø_cksum
 = 0;

206 
πadv
->
nd_ø_curh›limô
 = 64;

209 
πadv
->
nd_ø_Êags_ª£rved
 =

210 
zif
->
πadv
.
AdvDeÁu…Li„time
 =0 ? 0 : zif->πadv.
DeÁu…Pª„ªn˚
;

211 
πadv
->
nd_ø_Êags_ª£rved
 <<= 3;

213 i‡(
zif
->
πadv
.
AdvM™agedFœg
)

214 
πadv
->
nd_ø_Êags_ª£rved
 |
ND_RA_FLAG_MANAGED
;

215 i‡(
zif
->
πadv
.
AdvOthîC⁄figFœg
)

216 
πadv
->
nd_ø_Êags_ª£rved
 |
ND_RA_FLAG_OTHER
;

217 i‡(
zif
->
πadv
.
AdvHomeAgítFœg
)

218 
πadv
->
nd_ø_Êags_ª£rved
 |
ND_RA_FLAG_HOME_AGENT
;

227 
pkt_RouãrLi„time
 = 
zif
->
πadv
.
AdvDeÁu…Li„time
 != -1 ?

228 
zif
->
πadv
.
AdvDeÁu…Li„time
 :

229 
	`MAX
 (1, 0.003 * 
zif
->
πadv
.
MaxRåAdvI¡îvÆ
);

230 
πadv
->
nd_ø_rouãr_li„time
 = 
	`ht⁄s
 (
pkt_RouãrLi„time
);

231 
πadv
->
nd_ø_ªachabÀ
 = 
	`ht⁄l
 (
zif
->πadv.
AdvRóchabÀTime
);

232 
πadv
->
nd_ø_ªå™smô
 = 
	`ht⁄l
 (0);

234 
Àn
 =  (
nd_rouãr_advît
);

242 
zif
->
πadv
.
AdvHomeAgítFœg
 &&

243 (
zif
->
πadv
.
HomeAgítPª„ªn˚
 || zif->πadv.
HomeAgítLi„time
 != -1)

246 
nd_›t_homógít_öfo
 *
nd›t_hai
 =

247 (
nd_›t_homógít_öfo
 *)(
buf
 + 
Àn
);

248 
nd›t_hai
->
nd_›t_hai_ty≥
 = 
ND_OPT_HA_INFORMATION
;

249 
nd›t_hai
->
nd_›t_hai_Àn
 = 1;

250 
nd›t_hai
->
nd_›t_hai_ª£rved
 = 0;

251 
nd›t_hai
->
nd_›t_hai_¥e„ªn˚
 = 
	`ht⁄s
(
zif
->
πadv
.
HomeAgítPª„ªn˚
);

257 
nd›t_hai
->
nd_›t_hai_li„time
 = 
ht⁄s


259 
zif
->
πadv
.
HomeAgítLi„time
 != -1 ?

260 
zif
->
πadv
.
HomeAgítLi„time
 :

261 
	`MAX
 (1, 
pkt_RouãrLi„time
)

263 
Àn
 +(
nd_›t_homógít_öfo
);

266 i‡(
zif
->
πadv
.
AdvI¡îvÆO±i⁄
)

268 
nd_›t_adv_öãrvÆ
 *
nd›t_adv
 =

269 (
nd_›t_adv_öãrvÆ
 *)(
buf
 + 
Àn
);

270 
nd›t_adv
->
nd_›t_ai_ty≥
 = 
ND_OPT_ADV_INTERVAL
;

271 
nd›t_adv
->
nd_›t_ai_Àn
 = 1;

272 
nd›t_adv
->
nd_›t_ai_ª£rved
 = 0;

273 
nd›t_adv
->
nd_›t_ai_öãrvÆ
 = 
	`ht⁄l
(
zif
->
πadv
.
MaxRåAdvI¡îvÆ
);

274 
Àn
 +(
nd_›t_adv_öãrvÆ
);

278 
	`ALL_LIST_ELEMENTS_RO
 (
zif
->
πadv
.
AdvPªfixLi°
, 
node
, 
Ωªfix
))

280 
nd_›t_¥efix_öfo
 *
pöfo
;

282 
pöfo
 = (
nd_›t_¥efix_öfo
 *Ë(
buf
 + 
Àn
);

284 
pöfo
->
nd_›t_pi_ty≥
 = 
ND_OPT_PREFIX_INFORMATION
;

285 
pöfo
->
nd_›t_pi_Àn
 = 4;

286 
pöfo
->
nd_›t_pi_¥efix_Àn
 = 
Ωªfix
->
¥efix
.
¥efixÀn
;

288 
pöfo
->
nd_›t_pi_Êags_ª£rved
 = 0;

289 i‡(
Ωªfix
->
AdvOnLökFœg
)

290 
pöfo
->
nd_›t_pi_Êags_ª£rved
 |
ND_OPT_PI_FLAG_ONLINK
;

291 i‡(
Ωªfix
->
AdvAut⁄omousFœg
)

292 
pöfo
->
nd_›t_pi_Êags_ª£rved
 |
ND_OPT_PI_FLAG_AUTO
;

293 i‡(
Ωªfix
->
AdvRouãrAddªssFœg
)

294 
pöfo
->
nd_›t_pi_Êags_ª£rved
 |
ND_OPT_PI_FLAG_RADDR
;

296 
pöfo
->
nd_›t_pi_vÆid_time
 = 
	`ht⁄l
 (
Ωªfix
->
AdvVÆidLi„time
);

297 
pöfo
->
nd_›t_pi_¥e„ºed_time
 = 
	`ht⁄l
 (
Ωªfix
->
AdvPª„ºedLi„time
);

298 
pöfo
->
nd_›t_pi_ª£rved2
 = 0;

300 
	`IPV6_ADDR_COPY
 (&
pöfo
->
nd_›t_pi_¥efix
, &
Ωªfix
->
¥efix
.prefix);

302 #ifde‡
DEBUG


304 
u_ch¨
 
buf
[
INET6_ADDRSTRLEN
];

306 
	`zlog_debug
 ("DEBUG %s", 
	`öë_¡›
 (
AF_INET6
, &
pöfo
->
nd_›t_pi_¥efix
,

307 
buf
, 
INET6_ADDRSTRLEN
));

312 
Àn
 + (
nd_›t_¥efix_öfo
);

316 #ifde‡
HAVE_STRUCT_SOCKADDR_DL


317 
sdl
 = &
iÂ
->sdl;

318 i‡(
sdl
 !
NULL
 && sdl->
sdl_Æí
 != 0)

320 
buf
[
Àn
++] = 
ND_OPT_SOURCE_LINKADDR
;

324 
buf
[
Àn
++] = (
sdl
->
sdl_Æí
 + 9) >> 3;

326 
	`mem˝y
 (
buf
 + 
Àn
, 
	`LLADDR
 (
sdl
), sdl->
sdl_Æí
);

327 
Àn
 +
sdl
->
sdl_Æí
;

330 
	`mem£t
 (
buf
 + 
Àn
, 0, -(
sdl
->
sdl_Æí
 + 2) & 0x7);

331 
Àn
 +-(
sdl
->
sdl_Æí
 + 2) & 0x7;

334 i‡(
iÂ
->
hw_addr_Àn
 != 0)

336 
buf
[
Àn
++] = 
ND_OPT_SOURCE_LINKADDR
;

340 
buf
[
Àn
++] = (
iÂ
->
hw_addr_Àn
 + 9) >> 3;

342 
	`mem˝y
 (
buf
 + 
Àn
, 
iÂ
->
hw_addr
, iÂ->
hw_addr_Àn
);

343 
Àn
 +
iÂ
->
hw_addr_Àn
;

346 
	`mem£t
 (
buf
 + 
Àn
, 0, -(
iÂ
->
hw_addr_Àn
 + 2) & 0x7);

347 
Àn
 +-(
iÂ
->
hw_addr_Àn
 + 2) & 0x7;

352 i‡(
zif
->
πadv
.
AdvLökMTU
)

354 
nd_›t_mtu
 * 
›t
 = (nd_›t_mtu *Ë(
buf
 + 
Àn
);

355 
›t
->
nd_›t_mtu_ty≥
 = 
ND_OPT_MTU
;

356 
›t
->
nd_›t_mtu_Àn
 = 1;

357 
›t
->
nd_›t_mtu_ª£rved
 = 0;

358 
›t
->
nd_›t_mtu_mtu
 = 
	`ht⁄l
 (
zif
->
πadv
.
AdvLökMTU
);

359 
Àn
 + (
nd_›t_mtu
);

362 
msg
.
msg_«me
 = (*Ë&
addr
;

363 
msg
.
msg_«mñí
 =  (
sockaddr_ö6
);

364 
msg
.
msg_iov
 = &
iov
;

365 
msg
.
msg_iovÀn
 = 1;

366 
msg
.
msg_c⁄åﬁ
 = (*Ë
ad©a
;

367 
msg
.
msg_c⁄åﬁÀn
 = 
	`CMSG_SPACE
((
ö6_pktöfo
));

368 
msg
.
msg_Êags
 = 0;

369 
iov
.
iov_ba£
 = 
buf
;

370 
iov
.
iov_Àn
 = 
Àn
;

372 
cmsg±r
 = 
	`ZCMSG_FIRSTHDR
(&
msg
);

373 
cmsg±r
->
cmsg_Àn
 = 
	`CMSG_LEN
((
ö6_pktöfo
));

374 
cmsg±r
->
cmsg_Àvñ
 = 
IPPROTO_IPV6
;

375 
cmsg±r
->
cmsg_ty≥
 = 
IPV6_PKTINFO
;

377 
pkt
 = (
ö6_pktöfo
 *Ë
	`CMSG_DATA
 (
cmsg±r
);

378 
	`mem£t
 (&
pkt
->
ùi6_addr
, 0,  (
ö6_addr
));

379 
pkt
->
ùi6_ifödex
 = 
iÂ
->
ifödex
;

381 
ªt
 = 
	`£ndmsg
 (
sock
, &
msg
, 0);

382 i‡(
ªt
 < 0)

384 
	`zlog_îr
 ("rtadv_send_packet: sendmsg %d (%s)\n",

385 
î∫o
, 
	`ß„_°ªº‹
(errno));

387 
	}
}

390 
	$πadv_timî
 (
thªad
 *thread)

392 
li°node
 *
node
, *
¬ode
;

393 
öãrÁ˚
 *
iÂ
;

394 
zebø_if
 *
zif
;

395 
≥riod
;

397 
πadv
->
ø_timî
 = 
NULL
;

398 i‡(
πadv
->
adv_m£c_if_cou¡
 == 0)

400 
≥riod
 = 1000;

401 
	`πadv_evít
 (
RTADV_TIMER
, 1 );

405 
≥riod
 = 10;

406 
	`πadv_evít
 (
RTADV_TIMER_MSEC
, 10 );

409 
	`ALL_LIST_ELEMENTS
 (
iÊi°
, 
node
, 
¬ode
, 
iÂ
))

411 i‡(
	`if_is_lo›back
 (
iÂ
Ë|| ! 
	`if_is_›î©ive
 (ifp))

414 
zif
 = 
iÂ
->
öfo
;

416 i‡(
zif
->
πadv
.
AdvSídAdvîti£míts
)

418 
zif
->
πadv
.
AdvI¡îvÆTimî
 -
≥riod
;

419 i‡(
zif
->
πadv
.
AdvI¡îvÆTimî
 <= 0)

423 
zif
->
πadv
.
AdvI¡îvÆTimî
 = zif->πadv.
MaxRåAdvI¡îvÆ
;

424 
	`πadv_£nd_∑ckë
 (
πadv
->
sock
, 
iÂ
);

429 
	}
}

432 
	$πadv_¥o˚ss_sﬁicô
 (
öãrÁ˚
 *
iÂ
)

434 
	`zlog_öfo
 ("Rouã∏sﬁicô©i⁄Ñe˚ived o¿%s", 
iÂ
->
«me
);

436 
	`πadv_£nd_∑ckë
 (
πadv
->
sock
, 
iÂ
);

437 
	}
}

440 
	$πadv_¥o˚ss_advît
 ()

442 
	`zlog_öfo
 ("RouterádvertisementÑeceived");

443 
	}
}

446 
	$πadv_¥o˚ss_∑ckë
 (
u_ch¨
 *
buf
, 
Àn
, 
ifödex
, 
h›limô
)

448 
icmp6_hdr
 *
icmph
;

449 
öãrÁ˚
 *
iÂ
;

450 
zebø_if
 *
zif
;

453 
iÂ
 = 
	`if_lookup_by_ödex
 (
ifödex
);

454 i‡(
iÂ
 =
NULL
)

456 
	`zlog_w¨n
 ("Unknow¿öãrÁ˚ index: %d", 
ifödex
);

460 i‡(
	`if_is_lo›back
 (
iÂ
))

464 
zif
 = 
iÂ
->
öfo
;

465 i‡(! 
zif
->
πadv
.
AdvSídAdvîti£míts
)

469 i‡(
Àn
 <  (
icmp6_hdr
))

471 
	`zlog_w¨n
 ("InvÆid ICMPV6ÖackëÜígth: %d", 
Àn
);

475 
icmph
 = (
icmp6_hdr
 *Ë
buf
;

478 i‡(
icmph
->
icmp6_ty≥
 !
ND_ROUTER_SOLICIT
 &&

479 
icmph
->
icmp6_ty≥
 !
ND_ROUTER_ADVERT
)

481 
	`zlog_w¨n
 ("Unw™ãd ICMPV6 mesßgêty≥: %d", 
icmph
->
icmp6_ty≥
);

486 i‡(
h›limô
 >= 0 && hoplimit != 255)

488 
	`zlog_w¨n
 ("Invalid hoplimit %d forÑouterádvertisement ICMPÖacket",

489 
h›limô
);

494 i‡(
icmph
->
icmp6_ty≥
 =
ND_ROUTER_SOLICIT
)

495 
	`πadv_¥o˚ss_sﬁicô
 (
iÂ
);

496 i‡(
icmph
->
icmp6_ty≥
 =
ND_ROUTER_ADVERT
)

497 
	`πadv_¥o˚ss_advît
 ();

500 
	}
}

503 
	$πadv_ªad
 (
thªad
 *thread)

505 
sock
;

506 
Àn
;

507 
u_ch¨
 
buf
[
RTADV_MSG_SIZE
];

508 
sockaddr_ö6
 
‰om
;

509 
ifödex
 = 0;

510 
h›limô
 = -1;

512 
sock
 = 
	`THREAD_FD
 (
thªad
);

513 
πadv
->
ø_ªad
 = 
NULL
;

516 
	`πadv_evít
 (
RTADV_READ
, 
sock
);

518 
Àn
 = 
	`πadv_ªcv_∑ckë
 (
sock
, 
buf
, 
BUFSIZ
, &
‰om
, &
ifödex
, &
h›limô
);

520 i‡(
Àn
 < 0)

522 
	`zlog_w¨n
 ("rouã∏sﬁicô©i⁄Ñecv faûed: %s.", 
	`ß„_°ªº‹
 (
î∫o
));

523  
Àn
;

526 
	`πadv_¥o˚ss_∑ckë
 (
buf
, ()
Àn
, 
ifödex
, 
h›limô
);

529 
	}
}

532 
	$πadv_make_sockë
 ()

534 
sock
;

535 
ªt
;

536 
icmp6_fûãr
 
fûãr
;

538 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_RAISE
) )

539 
	`zlog_îr
 ("rtadv_make_socket: couldÇotÑaiseÖrivs, %s",

540 
	`ß„_°ªº‹
 (
î∫o
) );

542 
sock
 = 
	`sockë
 (
AF_INET6
, 
SOCK_RAW
, 
IPPROTO_ICMPV6
);

544 i‡–
z£rv_¥ivs
.
	`ch™ge
 (
ZPRIVS_LOWER
) )

545 
	`zlog_îr
 ("rtadv_make_socket: couldÇotÜowerÖrivs, %s",

546 
	`ß„_°ªº‹
 (
î∫o
) );

550 i‡(
sock
 < 0)

553 
ªt
 = 
	`£tsock›t_ùv6_pktöfo
 (
sock
, 1);

554 i‡(
ªt
 < 0)

555  
ªt
;

556 
ªt
 = 
	`£tsock›t_ùv6_mu…iˇ°_lo›
 (
sock
, 0);

557 i‡(
ªt
 < 0)

558  
ªt
;

559 
ªt
 = 
	`£tsock›t_ùv6_uniˇ°_h›s
 (
sock
, 255);

560 i‡(
ªt
 < 0)

561  
ªt
;

562 
ªt
 = 
	`£tsock›t_ùv6_mu…iˇ°_h›s
 (
sock
, 255);

563 i‡(
ªt
 < 0)

564  
ªt
;

565 
ªt
 = 
	`£tsock›t_ùv6_h›limô
 (
sock
, 1);

566 i‡(
ªt
 < 0)

567  
ªt
;

569 
	`ICMP6_FILTER_SETBLOCKALL
(&
fûãr
);

570 
	`ICMP6_FILTER_SETPASS
 (
ND_ROUTER_SOLICIT
, &
fûãr
);

571 
	`ICMP6_FILTER_SETPASS
 (
ND_ROUTER_ADVERT
, &
fûãr
);

573 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_ICMPV6
, 
ICMP6_FILTER
, &
fûãr
,

574  (
icmp6_fûãr
));

575 i‡(
ªt
 < 0)

577 
	`zlog_öfo
 ("ICMP6_FILTER së faû: %s", 
	`ß„_°ªº‹
 (
î∫o
));

578  
ªt
;

581  
sock
;

582 
	}
}

584 
πadv_¥efix
 *

585 
	$πadv_¥efix_√w
 ()

587  
	`XCALLOC
 (
MTYPE_RTADV_PREFIX
,  (
πadv_¥efix
));

588 
	}
}

591 
	$πadv_¥efix_‰ì
 (
πadv_¥efix
 *rtadv_prefix)

593 
	`XFREE
 (
MTYPE_RTADV_PREFIX
, 
πadv_¥efix
);

594 
	}
}

596 
πadv_¥efix
 *

597 
	$πadv_¥efix_lookup
 (
li°
 *
Ωli°
, 
¥efix_ùv6
 *
p
)

599 
li°node
 *
node
;

600 
πadv_¥efix
 *
Ωªfix
;

602 
	`ALL_LIST_ELEMENTS_RO
 (
Ωli°
, 
node
, 
Ωªfix
))

603 i‡(
	`¥efix_ßme
 ((
¥efix
 *Ë&
Ωªfix
->¥efix, (¥efix *Ë
p
))

604  
Ωªfix
;

605  
NULL
;

606 
	}
}

608 
πadv_¥efix
 *

609 
	$πadv_¥efix_gë
 (
li°
 *
Ωli°
, 
¥efix_ùv6
 *
p
)

611 
πadv_¥efix
 *
Ωªfix
;

613 
Ωªfix
 = 
	`πadv_¥efix_lookup
 (
Ωli°
, 
p
);

614 i‡(
Ωªfix
)

615  
Ωªfix
;

617 
Ωªfix
 = 
	`πadv_¥efix_√w
 ();

618 
	`mem˝y
 (&
Ωªfix
->
¥efix
, 
p
,  (
¥efix_ùv6
));

619 
	`li°node_add
 (
Ωli°
, 
Ωªfix
);

621  
Ωªfix
;

622 
	}
}

625 
	$πadv_¥efix_£t
 (
zebø_if
 *
zif
, 
πadv_¥efix
 *
Ω
)

627 
πadv_¥efix
 *
Ωªfix
;

629 
Ωªfix
 = 
	`πadv_¥efix_gë
 (
zif
->
πadv
.
AdvPªfixLi°
, &
Ω
->
¥efix
);

632 
Ωªfix
->
AdvVÆidLi„time
 = 
Ω
->AdvValidLifetime;

633 
Ωªfix
->
AdvPª„ºedLi„time
 = 
Ω
->AdvPreferredLifetime;

634 
Ωªfix
->
AdvOnLökFœg
 = 
Ω
->AdvOnLinkFlag;

635 
Ωªfix
->
AdvAut⁄omousFœg
 = 
Ω
->AdvAutonomousFlag;

636 
Ωªfix
->
AdvRouãrAddªssFœg
 = 
Ω
->AdvRouterAddressFlag;

637 
	}
}

640 
	$πadv_¥efix_ª£t
 (
zebø_if
 *
zif
, 
πadv_¥efix
 *
Ω
)

642 
πadv_¥efix
 *
Ωªfix
;

644 
Ωªfix
 = 
	`πadv_¥efix_lookup
 (
zif
->
πadv
.
AdvPªfixLi°
, &
Ω
->
¥efix
);

645 i‡(
Ωªfix
 !
NULL
)

647 
	`li°node_dñëe
 (
zif
->
πadv
.
AdvPªfixLi°
, (*Ë
Ωªfix
);

648 
	`πadv_¥efix_‰ì
 (
Ωªfix
);

653 
	}
}

655 
DEFUN
 (
ùv6_nd_suµªss_ø
,

656 
ùv6_nd_suµªss_ø_cmd
,

662 
öãrÁ˚
 *
	giÂ
;

663 
zebø_if
 *
	gzif
;

665 
	giÂ
 = 
vty
->
ödex
;

666 
	gzif
 = 
iÂ
->
öfo
;

668 i‡(
if_is_lo›back
 (
iÂ
))

670 
vty_out
 (
vty
, "InvÆid i¡îÁ˚%s", 
VTY_NEWLINE
);

671  
	gCMD_WARNING
;

674 i‡(
	gzif
->
	gπadv
.
	gAdvSídAdvîti£míts
)

676 
	gzif
->
	gπadv
.
	gAdvSídAdvîti£míts
 = 0;

677 
	gzif
->
	gπadv
.
	gAdvI¡îvÆTimî
 = 0;

678 
	gπadv
->
	gadv_if_cou¡
--;

680 
if_Àave_Æl_rouãr
 (
πadv
->
sock
, 
iÂ
);

682 i‡(
	gπadv
->
	gadv_if_cou¡
 == 0)

683 
πadv_evít
 (
RTADV_STOP
, 0);

686  
	gCMD_SUCCESS
;

689 
DEFUN
 (
no_ùv6_nd_suµªss_ø
,

690 
no_ùv6_nd_suµªss_ø_cmd
,

692 
NO_STR


697 
öãrÁ˚
 *
	giÂ
;

698 
zebø_if
 *
	gzif
;

700 
	giÂ
 = 
vty
->
ödex
;

701 
	gzif
 = 
iÂ
->
öfo
;

703 i‡(
if_is_lo›back
 (
iÂ
))

705 
vty_out
 (
vty
, "InvÆid i¡îÁ˚%s", 
VTY_NEWLINE
);

706  
	gCMD_WARNING
;

709 i‡(! 
	gzif
->
	gπadv
.
	gAdvSídAdvîti£míts
)

711 
	gzif
->
	gπadv
.
	gAdvSídAdvîti£míts
 = 1;

712 
	gzif
->
	gπadv
.
	gAdvI¡îvÆTimî
 = 0;

713 
	gπadv
->
	gadv_if_cou¡
++;

715 
if_joö_Æl_rouãr
 (
πadv
->
sock
, 
iÂ
);

717 i‡(
	gπadv
->
	gadv_if_cou¡
 == 1)

718 
πadv_evít
 (
RTADV_START
, 
πadv
->
sock
);

721  
	gCMD_SUCCESS
;

724 
DEFUN
 (
ùv6_nd_ø_öãrvÆ_m£c
,

725 
ùv6_nd_ø_öãrvÆ_m£c_cmd
,

732 
	göãrvÆ
;

733 
öãrÁ˚
 *
	giÂ
 = (öãrÁ˚ *Ë
vty
->
ödex
;

734 
zebø_if
 *
	gzif
 = 
iÂ
->
öfo
;

736 
VTY_GET_INTEGER_RANGE
 ("rouã∏advîti£míàöãrvÆ", 
öãrvÆ
, 
¨gv
[0], 70, 1800000);

737 i‡((
	gzif
->
	gπadv
.
	gAdvDeÁu…Li„time
 !-1 && 
öãrvÆ
 > ()
zif
->
πadv
.
AdvDeÁu…Li„time
 * 1000))

739 
vty_out
 (
vty
, "Thi†ø-öãrvÆ would c⁄Êi˘ wôh c⁄figuªdÑa-li„time!%s", 
VTY_NEWLINE
);

740  
	gCMD_WARNING
;

743 i‡(
	gzif
->
	gπadv
.
	gMaxRåAdvI¡îvÆ
 % 1000)

744 
	gπadv
->
	gadv_m£c_if_cou¡
--;

746 i‡(
	göãrvÆ
 % 1000)

747 
	gπadv
->
	gadv_m£c_if_cou¡
++;

749 
	gzif
->
	gπadv
.
	gMaxRåAdvI¡îvÆ
 = 
öãrvÆ
;

750 
	gzif
->
	gπadv
.
	gMöRåAdvI¡îvÆ
 = 0.33 * 
öãrvÆ
;

751 
	gzif
->
	gπadv
.
	gAdvI¡îvÆTimî
 = 0;

753  
	gCMD_SUCCESS
;

756 
DEFUN
 (
ùv6_nd_ø_öãrvÆ
,

757 
ùv6_nd_ø_öãrvÆ_cmd
,

764 
	göãrvÆ
;

765 
öãrÁ˚
 *
	giÂ
 = (öãrÁ˚ *Ë
vty
->
ödex
;

766 
zebø_if
 *
	gzif
 = 
iÂ
->
öfo
;

768 
VTY_GET_INTEGER_RANGE
 ("rouã∏advîti£míàöãrvÆ", 
öãrvÆ
, 
¨gv
[0], 1, 1800);

769 i‡((
	gzif
->
	gπadv
.
	gAdvDeÁu…Li„time
 !-1 && 
öãrvÆ
 > ()
zif
->
πadv
.
AdvDeÁu…Li„time
))

771 
vty_out
 (
vty
, "Thi†ø-öãrvÆ would c⁄Êi˘ wôh c⁄figuªdÑa-li„time!%s", 
VTY_NEWLINE
);

772  
	gCMD_WARNING
;

775 i‡(
	gzif
->
	gπadv
.
	gMaxRåAdvI¡îvÆ
 % 1000)

776 
	gπadv
->
	gadv_m£c_if_cou¡
--;

779 
	göãrvÆ
 = 
öãrvÆ
 * 1000;

781 
	gzif
->
	gπadv
.
	gMaxRåAdvI¡îvÆ
 = 
öãrvÆ
;

782 
	gzif
->
	gπadv
.
	gMöRåAdvI¡îvÆ
 = 0.33 * 
öãrvÆ
;

783 
	gzif
->
	gπadv
.
	gAdvI¡îvÆTimî
 = 0;

785  
	gCMD_SUCCESS
;

788 
DEFUN
 (
no_ùv6_nd_ø_öãrvÆ
,

789 
no_ùv6_nd_ø_öãrvÆ_cmd
,

791 
NO_STR


796 
öãrÁ˚
 *
	giÂ
;

797 
zebø_if
 *
	gzif
;

799 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

800 
	gzif
 = 
iÂ
->
öfo
;

802 i‡(
	gzif
->
	gπadv
.
	gMaxRåAdvI¡îvÆ
 % 1000)

803 
	gπadv
->
	gadv_m£c_if_cou¡
--;

805 
	gzif
->
	gπadv
.
	gMaxRåAdvI¡îvÆ
 = 
RTADV_MAX_RTR_ADV_INTERVAL
;

806 
	gzif
->
	gπadv
.
	gMöRåAdvI¡îvÆ
 = 
RTADV_MIN_RTR_ADV_INTERVAL
;

807 
	gzif
->
	gπadv
.
	gAdvI¡îvÆTimî
 = 
zif
->
πadv
.
MaxRåAdvI¡îvÆ
;

809  
	gCMD_SUCCESS
;

812 
ALIAS
 (
no_ùv6_nd_ø_öãrvÆ
,

813 
no_ùv6_nd_ø_öãrvÆ_vÆ_cmd
,

815 
NO_STR


820 
ALIAS
 (
no_ùv6_nd_ø_öãrvÆ
,

821 
no_ùv6_nd_ø_öãrvÆ_m£c_vÆ_cmd
,

823 
NO_STR


829 
DEFUN
 (
ùv6_nd_ø_li„time
,

830 
ùv6_nd_ø_li„time_cmd
,

837 
	gli„time
;

838 
öãrÁ˚
 *
	giÂ
;

839 
zebø_if
 *
	gzif
;

841 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

842 
	gzif
 = 
iÂ
->
öfo
;

844 
VTY_GET_INTEGER_RANGE
 ("rouã∏li„time", 
li„time
, 
¨gv
[0], 0, 9000);

850 i‡((
	gli„time
 !0 && 
li„time
 * 1000 < 
zif
->
πadv
.
MaxRåAdvI¡îvÆ
))

852 
vty_out
 (
vty
, "Thi†ø-li„timêwould c⁄Êi˘ wôh c⁄figuªdÑa-öãrvÆ%s", 
VTY_NEWLINE
);

853  
	gCMD_WARNING
;

856 
	gzif
->
	gπadv
.
	gAdvDeÁu…Li„time
 = 
li„time
;

858  
	gCMD_SUCCESS
;

861 
DEFUN
 (
no_ùv6_nd_ø_li„time
,

862 
no_ùv6_nd_ø_li„time_cmd
,

864 
NO_STR


869 
öãrÁ˚
 *
	giÂ
;

870 
zebø_if
 *
	gzif
;

872 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

873 
	gzif
 = 
iÂ
->
öfo
;

875 
	gzif
->
	gπadv
.
	gAdvDeÁu…Li„time
 = -1;

877  
	gCMD_SUCCESS
;

880 
ALIAS
 (
no_ùv6_nd_ø_li„time
,

881 
no_ùv6_nd_ø_li„time_vÆ_cmd
,

883 
NO_STR


889 
DEFUN
 (
ùv6_nd_ªachabÀ_time
,

890 
ùv6_nd_ªachabÀ_time_cmd
,

897 
öãrÁ˚
 *
	giÂ
 = (öãrÁ˚ *Ë
vty
->
ödex
;

898 
zebø_if
 *
	gzif
 = 
iÂ
->
öfo
;

899 
VTY_GET_INTEGER_RANGE
 ("ªachabÀÅime", 
zif
->
πadv
.
AdvRóchabÀTime
, 
¨gv
[0], 1, 
RTADV_MAX_REACHABLE_TIME
);

900  
	gCMD_SUCCESS
;

903 
DEFUN
 (
no_ùv6_nd_ªachabÀ_time
,

904 
no_ùv6_nd_ªachabÀ_time_cmd
,

906 
NO_STR


911 
öãrÁ˚
 *
	giÂ
;

912 
zebø_if
 *
	gzif
;

914 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

915 
	gzif
 = 
iÂ
->
öfo
;

917 
	gzif
->
	gπadv
.
	gAdvRóchabÀTime
 = 0;

919  
	gCMD_SUCCESS
;

922 
ALIAS
 (
no_ùv6_nd_ªachabÀ_time
,

923 
no_ùv6_nd_ªachabÀ_time_vÆ_cmd
,

925 
NO_STR


931 
DEFUN
 (
ùv6_nd_homógít_¥e„ªn˚
,

932 
ùv6_nd_homógít_¥e„ªn˚_cmd
,

939 
öãrÁ˚
 *
	giÂ
 = (öãrÁ˚ *Ë
vty
->
ödex
;

940 
zebø_if
 *
	gzif
 = 
iÂ
->
öfo
;

941 
VTY_GET_INTEGER_RANGE
 ("homêagíà¥e„ªn˚", 
zif
->
πadv
.
HomeAgítPª„ªn˚
, 
¨gv
[0], 0, 65535);

942  
	gCMD_SUCCESS
;

945 
DEFUN
 (
no_ùv6_nd_homógít_¥e„ªn˚
,

946 
no_ùv6_nd_homógít_¥e„ªn˚_cmd
,

948 
NO_STR


953 
öãrÁ˚
 *
	giÂ
;

954 
zebø_if
 *
	gzif
;

956 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

957 
	gzif
 = 
iÂ
->
öfo
;

959 
	gzif
->
	gπadv
.
	gHomeAgítPª„ªn˚
 = 0;

961  
	gCMD_SUCCESS
;

964 
ALIAS
 (
no_ùv6_nd_homógít_¥e„ªn˚
,

965 
no_ùv6_nd_homógít_¥e„ªn˚_vÆ_cmd
,

967 
NO_STR


973 
DEFUN
 (
ùv6_nd_homógít_li„time
,

974 
ùv6_nd_homógít_li„time_cmd
,

981 
öãrÁ˚
 *
	giÂ
 = (öãrÁ˚ *Ë
vty
->
ödex
;

982 
zebø_if
 *
	gzif
 = 
iÂ
->
öfo
;

983 
VTY_GET_INTEGER_RANGE
 ("homêagíàli„time", 
zif
->
πadv
.
HomeAgítLi„time
, 
¨gv
[0], 0, 
RTADV_MAX_HALIFETIME
);

984  
	gCMD_SUCCESS
;

987 
DEFUN
 (
no_ùv6_nd_homógít_li„time
,

988 
no_ùv6_nd_homógít_li„time_cmd
,

990 
NO_STR


995 
öãrÁ˚
 *
	giÂ
;

996 
zebø_if
 *
	gzif
;

998 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

999 
	gzif
 = 
iÂ
->
öfo
;

1001 
	gzif
->
	gπadv
.
	gHomeAgítLi„time
 = -1;

1003  
	gCMD_SUCCESS
;

1006 
ALIAS
 (
no_ùv6_nd_homógít_li„time
,

1007 
no_ùv6_nd_homógít_li„time_vÆ_cmd
,

1009 
NO_STR


1015 
DEFUN
 (
ùv6_nd_m™aged_c⁄fig_Êag
,

1016 
ùv6_nd_m™aged_c⁄fig_Êag_cmd
,

1022 
öãrÁ˚
 *
	giÂ
;

1023 
zebø_if
 *
	gzif
;

1025 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1026 
	gzif
 = 
iÂ
->
öfo
;

1028 
	gzif
->
	gπadv
.
	gAdvM™agedFœg
 = 1;

1030  
	gCMD_SUCCESS
;

1033 
DEFUN
 (
no_ùv6_nd_m™aged_c⁄fig_Êag
,

1034 
no_ùv6_nd_m™aged_c⁄fig_Êag_cmd
,

1036 
NO_STR


1041 
öãrÁ˚
 *
	giÂ
;

1042 
zebø_if
 *
	gzif
;

1044 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1045 
	gzif
 = 
iÂ
->
öfo
;

1047 
	gzif
->
	gπadv
.
	gAdvM™agedFœg
 = 0;

1049  
	gCMD_SUCCESS
;

1052 
DEFUN
 (
ùv6_nd_homógít_c⁄fig_Êag
,

1053 
ùv6_nd_homógít_c⁄fig_Êag_cmd
,

1059 
öãrÁ˚
 *
	giÂ
;

1060 
zebø_if
 *
	gzif
;

1062 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1063 
	gzif
 = 
iÂ
->
öfo
;

1065 
	gzif
->
	gπadv
.
	gAdvHomeAgítFœg
 = 1;

1067  
	gCMD_SUCCESS
;

1070 
DEFUN
 (
no_ùv6_nd_homógít_c⁄fig_Êag
,

1071 
no_ùv6_nd_homógít_c⁄fig_Êag_cmd
,

1073 
NO_STR


1078 
öãrÁ˚
 *
	giÂ
;

1079 
zebø_if
 *
	gzif
;

1081 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1082 
	gzif
 = 
iÂ
->
öfo
;

1084 
	gzif
->
	gπadv
.
	gAdvHomeAgítFœg
 = 0;

1086  
	gCMD_SUCCESS
;

1089 
DEFUN
 (
ùv6_nd_adv_öãrvÆ_c⁄fig_›ti⁄
,

1090 
ùv6_nd_adv_öãrvÆ_c⁄fig_›ti⁄_cmd
,

1096 
öãrÁ˚
 *
	giÂ
;

1097 
zebø_if
 *
	gzif
;

1099 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1100 
	gzif
 = 
iÂ
->
öfo
;

1102 
	gzif
->
	gπadv
.
	gAdvI¡îvÆO±i⁄
 = 1;

1104  
	gCMD_SUCCESS
;

1107 
DEFUN
 (
no_ùv6_nd_adv_öãrvÆ_c⁄fig_›ti⁄
,

1108 
no_ùv6_nd_adv_öãrvÆ_c⁄fig_›ti⁄_cmd
,

1110 
NO_STR


1115 
öãrÁ˚
 *
	giÂ
;

1116 
zebø_if
 *
	gzif
;

1118 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1119 
	gzif
 = 
iÂ
->
öfo
;

1121 
	gzif
->
	gπadv
.
	gAdvI¡îvÆO±i⁄
 = 0;

1123  
	gCMD_SUCCESS
;

1126 
DEFUN
 (
ùv6_nd_Ÿhî_c⁄fig_Êag
,

1127 
ùv6_nd_Ÿhî_c⁄fig_Êag_cmd
,

1133 
öãrÁ˚
 *
	giÂ
;

1134 
zebø_if
 *
	gzif
;

1136 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1137 
	gzif
 = 
iÂ
->
öfo
;

1139 
	gzif
->
	gπadv
.
	gAdvOthîC⁄figFœg
 = 1;

1141  
	gCMD_SUCCESS
;

1144 
DEFUN
 (
no_ùv6_nd_Ÿhî_c⁄fig_Êag
,

1145 
no_ùv6_nd_Ÿhî_c⁄fig_Êag_cmd
,

1147 
NO_STR


1152 
öãrÁ˚
 *
	giÂ
;

1153 
zebø_if
 *
	gzif
;

1155 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1156 
	gzif
 = 
iÂ
->
öfo
;

1158 
	gzif
->
	gπadv
.
	gAdvOthîC⁄figFœg
 = 0;

1160  
	gCMD_SUCCESS
;

1163 
DEFUN
 (
ùv6_nd_¥efix
,

1164 
ùv6_nd_¥efix_cmd
,

1179 
	gi
;

1180 
	gªt
;

1181 
	gcurs‹
 = 1;

1182 
öãrÁ˚
 *
	giÂ
;

1183 
zebø_if
 *
	gzebø_if
;

1184 
πadv_¥efix
 
	gΩ
;

1186 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1187 
	gzebø_if
 = 
iÂ
->
öfo
;

1189 
	gªt
 = 
°r2¥efix_ùv6
 (
¨gv
[0], &
Ω
.
¥efix
);

1190 i‡(!
	gªt
)

1192 
vty_out
 (
vty
, "MÆf‹med IPv6Öªfix%s", 
VTY_NEWLINE
);

1193  
	gCMD_WARNING
;

1195 
≠∂y_mask_ùv6
 (&
Ω
.
¥efix
);

1196 
	gΩ
.
	gAdvOnLökFœg
 = 1;

1197 
	gΩ
.
	gAdvAut⁄omousFœg
 = 1;

1198 
	gΩ
.
	gAdvRouãrAddªssFœg
 = 0;

1199 
	gΩ
.
	gAdvVÆidLi„time
 = 
RTADV_VALID_LIFETIME
;

1200 
	gΩ
.
	gAdvPª„ºedLi„time
 = 
RTADV_PREFERRED_LIFETIME
;

1202 i‡(
	g¨gc
 > 1)

1204 i‡((
isdigô
(
¨gv
[1][0])Ë|| 
°∫cmp
 (argv[1], "i", 1) == 0)

1206 i‡–
°∫cmp
 (
¨gv
[1], "i", 1) == 0)

1207 
Ω
.
AdvVÆidLi„time
 = 
UINT32_MAX
;

1209 
	gΩ
.
	gAdvVÆidLi„time
 = (
u_öt32_t
Ë
°πﬁl
 (
¨gv
[1],

1210 (**)
NULL
, 10);

1212 i‡–
°∫cmp
 (
¨gv
[2], "i", 1) == 0)

1213 
Ω
.
AdvPª„ºedLi„time
 = 
UINT32_MAX
;

1215 
	gΩ
.
	gAdvPª„ºedLi„time
 = (
u_öt32_t
Ë
°πﬁl
 (
¨gv
[2],

1216 (**)
NULL
, 10);

1218 i‡(
	gΩ
.
	gAdvPª„ºedLi„time
 >Ñp.
	gAdvVÆidLi„time
)

1220 
vty_out
 (
vty
, "InvÆidÖª„ºedÜi„time%s", 
VTY_NEWLINE
);

1221  
	gCMD_WARNING
;

1223 
	gcurs‹
 = 
curs‹
 + 2;

1225 i‡(
	g¨gc
 > 
	gcurs‹
)

1227 
	gi
 = 
curs‹
; i < 
	g¨gc
; i++)

1229 i‡(
°∫cmp
 (
¨gv
[
i
], "of", 2) == 0)

1230 
Ω
.
AdvOnLökFœg
 = 0;

1231 i‡(
°∫cmp
 (
¨gv
[
i
], "no", 2) == 0)

1232 
Ω
.
AdvAut⁄omousFœg
 = 0;

1233 i‡(
°∫cmp
 (
¨gv
[
i
], "ro", 2) == 0)

1234 
Ω
.
AdvRouãrAddªssFœg
 = 1;

1239 
πadv_¥efix_£t
 (
zebø_if
, &
Ω
);

1241  
	gCMD_SUCCESS
;

1244 
ALIAS
 (
ùv6_nd_¥efix
,

1245 
ùv6_nd_¥efix_vÆ_n‹èddr_cmd
,

1259 
ALIAS
 (
ùv6_nd_¥efix
,

1260 
ùv6_nd_¥efix_vÆ_ªv_cmd
,

1274 
ALIAS
 (
ùv6_nd_¥efix
,

1275 
ùv6_nd_¥efix_vÆ_ªv_πaddr_cmd
,

1290 
ALIAS
 (
ùv6_nd_¥efix
,

1291 
ùv6_nd_¥efix_vÆ_nﬂuto_cmd
,

1304 
ALIAS
 (
ùv6_nd_¥efix
,

1305 
ùv6_nd_¥efix_vÆ_ofÊök_cmd
,

1318 
ALIAS
 (
ùv6_nd_¥efix
,

1319 
ùv6_nd_¥efix_vÆ_πaddr_cmd
,

1332 
ALIAS
 (
ùv6_nd_¥efix
,

1333 
ùv6_nd_¥efix_vÆ_cmd
,

1345 
ALIAS
 (
ùv6_nd_¥efix
,

1346 
ùv6_nd_¥efix_novÆ_cmd
,

1355 
ALIAS
 (
ùv6_nd_¥efix
,

1356 
ùv6_nd_¥efix_novÆ_ªv_cmd
,

1365 
ALIAS
 (
ùv6_nd_¥efix
,

1366 
ùv6_nd_¥efix_novÆ_nﬂuto_cmd
,

1374 
ALIAS
 (
ùv6_nd_¥efix
,

1375 
ùv6_nd_¥efix_novÆ_ofÊök_cmd
,

1383 
ALIAS
 (
ùv6_nd_¥efix
,

1384 
ùv6_nd_¥efix_novÆ_πaddr_cmd
,

1392 
ALIAS
 (
ùv6_nd_¥efix
,

1393 
ùv6_nd_¥efix_¥efix_cmd
,

1400 
DEFUN
 (
no_ùv6_nd_¥efix
,

1401 
no_ùv6_nd_¥efix_cmd
,

1403 
NO_STR


1409 
	gªt
;

1410 
öãrÁ˚
 *
	giÂ
;

1411 
zebø_if
 *
	gzebø_if
;

1412 
πadv_¥efix
 
	gΩ
;

1414 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1415 
	gzebø_if
 = 
iÂ
->
öfo
;

1417 
	gªt
 = 
°r2¥efix_ùv6
 (
¨gv
[0], &
Ω
.
¥efix
);

1418 i‡(!
	gªt
)

1420 
vty_out
 (
vty
, "MÆf‹med IPv6Öªfix%s", 
VTY_NEWLINE
);

1421  
	gCMD_WARNING
;

1423 
≠∂y_mask_ùv6
 (&
Ω
.
¥efix
);

1425 
	gªt
 = 
πadv_¥efix_ª£t
 (
zebø_if
, &
Ω
);

1426 i‡(!
	gªt
)

1428 
vty_out
 (
vty
, "N⁄-exi° IPv6Öªfix%s", 
VTY_NEWLINE
);

1429  
	gCMD_WARNING
;

1432  
	gCMD_SUCCESS
;

1435 
DEFUN
 (
ùv6_nd_rouãr_¥e„ªn˚
,

1436 
ùv6_nd_rouãr_¥e„ªn˚_cmd
,

1445 
öãrÁ˚
 *
	giÂ
;

1446 
zebø_if
 *
	gzif
;

1447 
	gi
 = 0;

1449 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1450 
	gzif
 = 
iÂ
->
öfo
;

1452 0 !
πadv_¥ef_°rs
[
i
])

1454 i‡(
°∫cmp
 (
¨gv
[0], 
πadv_¥ef_°rs
[
i
], 1) == 0)

1456 
zif
->
πadv
.
DeÁu…Pª„ªn˚
 = 
i
;

1457  
	gCMD_SUCCESS
;

1459 
	gi
++;

1462  
	gCMD_ERR_NO_MATCH
;

1465 
DEFUN
 (
no_ùv6_nd_rouãr_¥e„ªn˚
,

1466 
no_ùv6_nd_rouãr_¥e„ªn˚_cmd
,

1468 
NO_STR


1473 
öãrÁ˚
 *
	giÂ
;

1474 
zebø_if
 *
	gzif
;

1476 
	giÂ
 = (
öãrÁ˚
 *Ë
vty
->
ödex
;

1477 
	gzif
 = 
iÂ
->
öfo
;

1479 
	gzif
->
	gπadv
.
	gDeÁu…Pª„ªn˚
 = 
RTADV_PREF_MEDIUM
;

1481  
	gCMD_SUCCESS
;

1484 
ALIAS
 (
no_ùv6_nd_rouãr_¥e„ªn˚
,

1485 
no_ùv6_nd_rouãr_¥e„ªn˚_vÆ_cmd
,

1487 
NO_STR


1495 
DEFUN
 (
ùv6_nd_mtu
,

1496 
ùv6_nd_mtu_cmd
,

1503 
öãrÁ˚
 *
	giÂ
 = (öãrÁ˚ *Ë
vty
->
ödex
;

1504 
zebø_if
 *
	gzif
 = 
iÂ
->
öfo
;

1505 
VTY_GET_INTEGER_RANGE
 ("MTU", 
zif
->
πadv
.
AdvLökMTU
, 
¨gv
[0], 1, 65535);

1506  
	gCMD_SUCCESS
;

1509 
DEFUN
 (
no_ùv6_nd_mtu
,

1510 
no_ùv6_nd_mtu_cmd
,

1512 
NO_STR


1517 
öãrÁ˚
 *
	giÂ
 = (öãrÁ˚ *Ë
vty
->
ödex
;

1518 
zebø_if
 *
	gzif
 = 
iÂ
->
öfo
;

1519 
	gzif
->
	gπadv
.
	gAdvLökMTU
 = 0;

1520  
	gCMD_SUCCESS
;

1523 
ALIAS
 (
no_ùv6_nd_mtu
,

1524 
no_ùv6_nd_mtu_vÆ_cmd
,

1526 
NO_STR


1534 
	$πadv_c⁄fig_wrôe
 (
vty
 *vty, 
öãrÁ˚
 *
iÂ
)

1536 
zebø_if
 *
zif
;

1537 
li°node
 *
node
;

1538 
πadv_¥efix
 *
Ωªfix
;

1539 
u_ch¨
 
buf
[
INET6_ADDRSTRLEN
];

1540 
öãrvÆ
;

1542 i‡(! 
πadv
)

1545 
zif
 = 
iÂ
->
öfo
;

1547 i‡(! 
	`if_is_lo›back
 (
iÂ
))

1549 i‡(
zif
->
πadv
.
AdvSídAdvîti£míts
)

1550 
	`vty_out
 (
vty
, "Çÿùv6Çd suµªss-ø%s", 
VTY_NEWLINE
);

1552 
	`vty_out
 (
vty
, " ipv6Çd suµªss-ø%s", 
VTY_NEWLINE
);

1556 
öãrvÆ
 = 
zif
->
πadv
.
MaxRåAdvI¡îvÆ
;

1557 i‡(
öãrvÆ
 % 1000)

1558 
	`vty_out
 (
vty
, " ipv6ÇdÑa-öãrvÆ m£¯%d%s", 
öãrvÆ
,

1559 
VTY_NEWLINE
);

1561 i‡(
öãrvÆ
 !
RTADV_MAX_RTR_ADV_INTERVAL
)

1562 
	`vty_out
 (
vty
, " ipv6ÇdÑa-öãrvÆ %d%s", 
öãrvÆ
 / 1000,

1563 
VTY_NEWLINE
);

1565 i‡(
zif
->
πadv
.
AdvI¡îvÆO±i⁄
)

1566 
	`vty_out
 (
vty
, " ipv6Çdádv-öãrvÆ-›ti⁄%s", 
VTY_NEWLINE
);

1568 i‡(
zif
->
πadv
.
AdvDeÁu…Li„time
 != -1)

1569 
	`vty_out
 (
vty
, " ipv6ÇdÑa-li„timê%d%s", 
zif
->
πadv
.
AdvDeÁu…Li„time
,

1570 
VTY_NEWLINE
);

1572 i‡(
zif
->
πadv
.
HomeAgítPª„ªn˚
)

1573 
	`vty_out
 (
vty
, " ipv6Çd home-agent-preference %u%s",

1574 
zif
->
πadv
.
HomeAgítPª„ªn˚
, 
VTY_NEWLINE
);

1576 i‡(
zif
->
πadv
.
HomeAgítLi„time
 != -1)

1577 
	`vty_out
 (
vty
, " ipv6Çd home-agent-lifetime %u%s",

1578 
zif
->
πadv
.
HomeAgítLi„time
, 
VTY_NEWLINE
);

1580 i‡(
zif
->
πadv
.
AdvHomeAgítFœg
)

1581 
	`vty_out
 (
vty
, " ipv6Çd home-agít-c⁄fig-Êag%s", 
VTY_NEWLINE
);

1583 i‡(
zif
->
πadv
.
AdvRóchabÀTime
)

1584 
	`vty_out
 (
vty
, " ipv6ÇdÑóchabÀ-timê%d%s", 
zif
->
πadv
.
AdvRóchabÀTime
,

1585 
VTY_NEWLINE
);

1587 i‡(
zif
->
πadv
.
AdvM™agedFœg
)

1588 
	`vty_out
 (
vty
, " ipv6Çd m™aged-c⁄fig-Êag%s", 
VTY_NEWLINE
);

1590 i‡(
zif
->
πadv
.
AdvOthîC⁄figFœg
)

1591 
	`vty_out
 (
vty
, " ipv6Çd othî-c⁄fig-Êag%s", 
VTY_NEWLINE
);

1593 i‡(
zif
->
πadv
.
DeÁu…Pª„ªn˚
 !
RTADV_PREF_MEDIUM
)

1594 
	`vty_out
 (
vty
, " ipv6ÇdÑouter-preference %s%s",

1595 
πadv_¥ef_°rs
[
zif
->
πadv
.
DeÁu…Pª„ªn˚
],

1596 
VTY_NEWLINE
);

1598 i‡(
zif
->
πadv
.
AdvLökMTU
)

1599 
	`vty_out
 (
vty
, " ipv6Çd mtu %d%s", 
zif
->
πadv
.
AdvLökMTU
, 
VTY_NEWLINE
);

1601 
	`ALL_LIST_ELEMENTS_RO
 (
zif
->
πadv
.
AdvPªfixLi°
, 
node
, 
Ωªfix
))

1603 
	`vty_out
 (
vty
, " ipv6ÇdÖrefix %s/%d",

1604 
	`öë_¡›
 (
AF_INET6
, &
Ωªfix
->
¥efix
.prefix,

1605 (*Ë
buf
, 
INET6_ADDRSTRLEN
),

1606 
Ωªfix
->
¥efix
.
¥efixÀn
);

1607 i‡((
Ωªfix
->
AdvVÆidLi„time
 !
RTADV_VALID_LIFETIME
) ||

1608 (
Ωªfix
->
AdvPª„ºedLi„time
 !
RTADV_PREFERRED_LIFETIME
))

1610 i‡(
Ωªfix
->
AdvVÆidLi„time
 =
UINT32_MAX
)

1611 
	`vty_out
 (
vty
, " infinite");

1613 
	`vty_out
 (
vty
, " %u", 
Ωªfix
->
AdvVÆidLi„time
);

1614 i‡(
Ωªfix
->
AdvPª„ºedLi„time
 =
UINT32_MAX
)

1615 
	`vty_out
 (
vty
, " infinite");

1617 
	`vty_out
 (
vty
, " %u", 
Ωªfix
->
AdvPª„ºedLi„time
);

1619 i‡(!
Ωªfix
->
AdvOnLökFœg
)

1620 
	`vty_out
 (
vty
, " off-link");

1621 i‡(!
Ωªfix
->
AdvAut⁄omousFœg
)

1622 
	`vty_out
 (
vty
, "Ço-autoconfig");

1623 i‡(
Ωªfix
->
AdvRouãrAddªssFœg
)

1624 
	`vty_out
 (
vty
, "Ñouter-address");

1625 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1627 
	}
}

1631 
	$πadv_evít
 (
πadv_evít
 
evít
, 
vÆ
)

1633 
evít
)

1635 
RTADV_START
:

1636 i‡(! 
πadv
->
ø_ªad
)

1637 
πadv
->
ø_ªad
 = 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
πadv_ªad
, 
NULL
, 
vÆ
);

1638 i‡(! 
πadv
->
ø_timî
)

1639 
πadv
->
ø_timî
 = 
	`thªad_add_evít
 (
zebød
.
ma°î
, 
πadv_timî
,

1640 
NULL
, 0);

1642 
RTADV_STOP
:

1643 i‡(
πadv
->
ø_timî
)

1645 
	`thªad_ˇn˚l
 (
πadv
->
ø_timî
);

1646 
πadv
->
ø_timî
 = 
NULL
;

1648 i‡(
πadv
->
ø_ªad
)

1650 
	`thªad_ˇn˚l
 (
πadv
->
ø_ªad
);

1651 
πadv
->
ø_ªad
 = 
NULL
;

1654 
RTADV_TIMER
:

1655 i‡(! 
πadv
->
ø_timî
)

1656 
πadv
->
ø_timî
 = 
	`thªad_add_timî
 (
zebød
.
ma°î
, 
πadv_timî
, 
NULL
,

1657 
vÆ
);

1659 
RTADV_TIMER_MSEC
:

1660 i‡(! 
πadv
->
ø_timî
)

1661 
πadv
->
ø_timî
 = 
	`thªad_add_timî_m£c
 (
zebød
.
ma°î
, 
πadv_timî
,

1662 
NULL
, 
vÆ
);

1664 
RTADV_READ
:

1665 i‡(! 
πadv
->
ø_ªad
)

1666 
πadv
->
ø_ªad
 = 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
πadv_ªad
, 
NULL
, 
vÆ
);

1672 
	}
}

1675 
	$πadv_öô
 ()

1677 
sock
;

1679 
sock
 = 
	`πadv_make_sockë
 ();

1680 i‡(
sock
 < 0)

1683 
πadv
 = 
	`πadv_√w
 ();

1684 
πadv
->
sock
 = sock;

1686 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_suµªss_ø_cmd
);

1687 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_suµªss_ø_cmd
);

1688 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_ø_öãrvÆ_cmd
);

1689 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_ø_öãrvÆ_m£c_cmd
);

1690 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_ø_öãrvÆ_cmd
);

1691 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_ø_öãrvÆ_vÆ_cmd
);

1692 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_ø_öãrvÆ_m£c_vÆ_cmd
);

1693 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_ø_li„time_cmd
);

1694 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_ø_li„time_cmd
);

1695 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_ø_li„time_vÆ_cmd
);

1696 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_ªachabÀ_time_cmd
);

1697 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_ªachabÀ_time_cmd
);

1698 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_ªachabÀ_time_vÆ_cmd
);

1699 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_m™aged_c⁄fig_Êag_cmd
);

1700 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_m™aged_c⁄fig_Êag_cmd
);

1701 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_Ÿhî_c⁄fig_Êag_cmd
);

1702 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_Ÿhî_c⁄fig_Êag_cmd
);

1703 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_homógít_c⁄fig_Êag_cmd
);

1704 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_homógít_c⁄fig_Êag_cmd
);

1705 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_homógít_¥e„ªn˚_cmd
);

1706 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_homógít_¥e„ªn˚_cmd
);

1707 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_homógít_¥e„ªn˚_vÆ_cmd
);

1708 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_homógít_li„time_cmd
);

1709 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_homógít_li„time_cmd
);

1710 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_homógít_li„time_vÆ_cmd
);

1711 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_adv_öãrvÆ_c⁄fig_›ti⁄_cmd
);

1712 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_adv_öãrvÆ_c⁄fig_›ti⁄_cmd
);

1713 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_cmd
);

1714 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_vÆ_ªv_πaddr_cmd
);

1715 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_vÆ_n‹èddr_cmd
);

1716 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_vÆ_ªv_cmd
);

1717 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_vÆ_nﬂuto_cmd
);

1718 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_vÆ_ofÊök_cmd
);

1719 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_vÆ_πaddr_cmd
);

1720 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_vÆ_cmd
);

1721 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_novÆ_cmd
);

1722 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_novÆ_ªv_cmd
);

1723 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_novÆ_nﬂuto_cmd
);

1724 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_novÆ_ofÊök_cmd
);

1725 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_novÆ_πaddr_cmd
);

1726 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_¥efix_¥efix_cmd
);

1727 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_¥efix_cmd
);

1728 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_rouãr_¥e„ªn˚_cmd
);

1729 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_rouãr_¥e„ªn˚_cmd
);

1730 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_rouãr_¥e„ªn˚_vÆ_cmd
);

1731 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ùv6_nd_mtu_cmd
);

1732 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_mtu_cmd
);

1733 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
no_ùv6_nd_mtu_vÆ_cmd
);

1734 
	}
}

1737 
	$if_joö_Æl_rouãr
 (
sock
, 
öãrÁ˚
 *
iÂ
)

1739 
ªt
;

1741 
ùv6_mªq
 
mªq
;

1743 
	`mem£t
 (&
mªq
, 0,  (
ùv6_mªq
));

1744 
	`öë_±⁄
 (
AF_INET6
, 
ALLROUTER
, &
mªq
.
ùv6mr_mu…üddr
);

1745 
mªq
.
ùv6mr_öãrÁ˚
 = 
iÂ
->
ifödex
;

1747 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_JOIN_GROUP
,

1748 (*Ë&
mªq
,  mreq);

1749 i‡(
ªt
 < 0)

1750 
	`zlog_w¨n
 ("ˇn'à£tsock›àIPV6_JOIN_GROUP: %s", 
	`ß„_°ªº‹
 (
î∫o
));

1752 
	`zlog_öfo
 ("πadv: %†joöÅÿÆl-rouãr†mu…iˇ° group", 
iÂ
->
«me
);

1755 
	}
}

1758 
	$if_Àave_Æl_rouãr
 (
sock
, 
öãrÁ˚
 *
iÂ
)

1760 
ªt
;

1762 
ùv6_mªq
 
mªq
;

1764 
	`mem£t
 (&
mªq
, 0,  (
ùv6_mªq
));

1765 
	`öë_±⁄
 (
AF_INET6
, 
ALLROUTER
, &
mªq
.
ùv6mr_mu…üddr
);

1766 
mªq
.
ùv6mr_öãrÁ˚
 = 
iÂ
->
ifödex
;

1768 
ªt
 = 
	`£tsock›t
 (
sock
, 
IPPROTO_IPV6
, 
IPV6_LEAVE_GROUP
,

1769 (*Ë&
mªq
,  mreq);

1770 i‡(
ªt
 < 0)

1771 
	`zlog_w¨n
 ("ˇn'à£tsock›àIPV6_LEAVE_GROUP: %s", 
	`ß„_°ªº‹
 (
î∫o
));

1773 
	`zlog_öfo
 ("πadv: %†Àavê‰omáŒ-rouãr†mu…iˇ° group", 
iÂ
->
«me
);

1776 
	}
}

1780 
	$πadv_öô
 ()

1783 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtadv.h

23 #i‚de‡
_ZEBRA_RTADV_H


24 
	#_ZEBRA_RTADV_H


	)

26 
	~"vty.h
"

27 
	~"zebø/öãrÁ˚.h
"

30 #ifde‡
RTADV


33 
	sπadv_¥efix


36 
¥efix_ùv6
 
	m¥efix
;

39 
u_öt32_t
 
	mAdvVÆidLi„time
;

40 
	#RTADV_VALID_LIFETIME
 2592000

	)

43 
	mAdvOnLökFœg
;

47 
u_öt32_t
 
	mAdvPª„ºedLi„time
;

48 
	#RTADV_PREFERRED_LIFETIME
 604800

	)

51 
	mAdvAut⁄omousFœg
;

54 
	mAdvRouãrAddªssFœg
;

55 #i‚de‡
ND_OPT_PI_FLAG_RADDR


56 
	#ND_OPT_PI_FLAG_RADDR
 0x20

	)

61 
πadv_c⁄fig_wrôe
 (
vty
 *, 
öãrÁ˚
 *);

62 
πadv_öô
 ();

66 #i‚de‡
ND_OPT_ADV_INTERVAL


67 
	#ND_OPT_ADV_INTERVAL
 7

	)

69 #i‚de‡
ND_OPT_HA_INFORMATION


70 
	#ND_OPT_HA_INFORMATION
 8

	)

73 #i‚de‡
HAVE_STRUCT_ND_OPT_ADV_INTERVAL


74 
	snd_›t_adv_öãrvÆ
 {

75 
uöt8_t
 
	mnd_›t_ai_ty≥
;

76 
uöt8_t
 
	mnd_›t_ai_Àn
;

77 
uöt16_t
 
	mnd_›t_ai_ª£rved
;

78 
uöt32_t
 
	mnd_›t_ai_öãrvÆ
;

79 } 
__©åibuã__
((
__∑cked__
));

81 #i‚de‡
HAVE_STRUCT_ND_OPT_ADV_INTERVAL_ND_OPT_AI_TYPE


83 
	#nd_›t_ai_ty≥
 
nd_›t_adv_öãrvÆ_ty≥


	)

84 
	#nd_›t_ai_Àn
 
nd_›t_adv_öãrvÆ_Àn


	)

85 
	#nd_›t_ai_ª£rved
 
nd_›t_adv_öãrvÆ_ª£rved


	)

86 
	#nd_›t_ai_öãrvÆ
 
nd_›t_adv_öãrvÆ_ivÆ


	)

90 #i‚de‡
HAVE_STRUCT_ND_OPT_HOMEAGENT_INFO


91 
	snd_›t_homógít_öfo
 {

92 
u_öt8_t
 
	mnd_›t_hai_ty≥
;

93 
u_öt8_t
 
	mnd_›t_hai_Àn
;

94 
u_öt16_t
 
	mnd_›t_hai_ª£rved
;

95 
u_öt16_t
 
	mnd_›t_hai_¥e„ªn˚
;

96 
u_öt16_t
 
	mnd_›t_hai_li„time
;

97 } 
__©åibuã__
((
__∑cked__
));

100 c⁄° *
πadv_¥ef_°rs
[];

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_getmsg.c

23 
	~<zebø.h
>

25 
	~"¥efix.h
"

26 
	~"log.h
"

27 
	~"if.h
"

29 
	~"zebø/rib.h
"

30 
	~"zebø/z£rv.h
"

32 
	~<sys/°ªam.h
>

33 
	~<sys/tihdr.h
>

36 #ifde‡
SUNOS_5


37 
	~<sys/tiu£r.h
>

38 #i‚de‡
T_CURRENT


39 
	#T_CURRENT
 
MI_T_CURRENT


	)

41 #i‚de‡
IRE_CACHE


42 
	#IRE_CACHE
 0x0020

	)

44 #i‚de‡
IRE_HOST_REDIRECT


45 
	#IRE_HOST_REDIRECT
 0x0200

	)

47 #i‚de‡
IRE_CACHETABLE


48 
	#IRE_CACHETABLE
 (
IRE_CACHE
 | 
IRE_BROADCAST
 | 
IRE_LOCAL
 | \

49 
IRE_LOOPBACK
)

	)

51 #unde‡
IPOPT_EOL


52 #unde‡
IPOPT_NOP


53 #unde‡
IPOPT_LSRR


54 #unde‡
IPOPT_RR


55 #unde‡
IPOPT_SSRR


58 
	~<öë/comm⁄.h
>

59 
	~<öë/ù.h
>

60 
	~<öë/mib2.h
>

63 #i‚de‡
_PATH_GETMSG_ROUTE


64 
	#_PATH_GETMSG_ROUTE
 "/dev/ù"

	)

67 
	#RT_BUFSIZ
 8192

	)

70 
	$h™dÀ_rouã_íåy
 (
mib2_ùRouãE¡ry_t
 *
rouãE¡ry
)

72 
¥efix_ùv4
 
¥efix
;

73 
ö_addr
 
tm∑ddr
, 
g©eway
;

74 
u_ch¨
 
zebø_Êags
 = 0;

76 i‡(
rouãE¡ry
->
ùRouãInfo
.
ª_úe_ty≥
 & 
IRE_CACHETABLE
)

79 i‡(
rouãE¡ry
->
ùRouãInfo
.
ª_úe_ty≥
 & 
IRE_HOST_REDIRECT
)

80 
zebø_Êags
 |
ZEBRA_FLAG_SELFROUTE
;

82 
¥efix
.
Ámûy
 = 
AF_INET
;

84 
tm∑ddr
.
s_addr
 = 
rouãE¡ry
->
ùRouãDe°
;

85 
¥efix
.¥efix = 
tm∑ddr
;

87 
tm∑ddr
.
s_addr
 = 
rouãE¡ry
->
ùRouãMask
;

88 
¥efix
.
¥efixÀn
 = 
	`ù_maskÀn
 (
tm∑ddr
);

90 
g©eway
.
s_addr
 = 
rouãE¡ry
->
ùRouãNextH›
;

92 
	`rib_add_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
, &
¥efix
,

93 &
g©eway
, 
NULL
, 0, 0, 0, 0, 
SAFI_UNICAST
);

94 
	}
}

97 
	$rouã_ªad
 ()

99 
°‹age
[
RT_BUFSIZ
];

101 
T_›tmgmt_ªq
 *
TLIªq
 = (T_›tmgmt_ªq *Ë
°‹age
;

102 
T_›tmgmt_ack
 *
TLIack
 = (T_›tmgmt_ack *Ë
°‹age
;

103 
T_îr‹_ack
 *
TLIîr
 = (T_îr‹_ack *Ë
°‹age
;

105 
›thdr
 *
MIB2hdr
;

107 
mib2_ùRouãE¡ry_t
 *
rouãE¡ry
, *
œ°RouãE¡ry
;

109 
°rbuf
 
msgd©a
;

110 
Êags
, 
dev
, 
ªtvÆ
, 
¥o˚ss
;

112 i‡((
dev
 = 
	`›í
 (
_PATH_GETMSG_ROUTE
, 
O_RDWR
)) == -1) {

113 
	`zlog_w¨n
 ("ˇn'à›í %s: %s", 
_PATH_GETMSG_ROUTE
,

114 
	`ß„_°ªº‹
 (
î∫o
));

118 
TLIªq
->
PRIM_ty≥
 = 
T_OPTMGMT_REQ
;

119 
TLIªq
->
OPT_off£t
 =  (
T_›tmgmt_ªq
);

120 
TLIªq
->
OPT_Àngth
 =  (
›thdr
);

121 
TLIªq
->
MGMT_Êags
 = 
T_CURRENT
;

123 
MIB2hdr
 = (
›thdr
 *Ë&
TLIªq
[1];

125 
MIB2hdr
->
Àvñ
 = 
MIB2_IP
;

126 
MIB2hdr
->
«me
 = 0;

127 
MIB2hdr
->
Àn
 = 0;

129 
msgd©a
.
buf
 = 
°‹age
;

130 
msgd©a
.
Àn
 =  (
T_›tmgmt_ªq
Ë+  (
›thdr
);

132 
Êags
 = 0;

134 i‡(
	`putmsg
 (
dev
, &
msgd©a
, 
NULL
, 
Êags
) == -1) {

135 
	`zlog_w¨n
 ("putmsg faûed: %s", 
	`ß„_°ªº‹
 (
î∫o
));

136 
exô
;

139 
MIB2hdr
 = (
›thdr
 *Ë&
TLIack
[1];

140 
msgd©a
.
maxÀn
 =  (
°‹age
);

143 
Êags
 = 0;

144 
ªtvÆ
 = 
	`gëmsg
 (
dev
, &
msgd©a
, 
NULL
, &
Êags
);

146 i‡(
ªtvÆ
 == -1) {

147 
	`zlog_w¨n
 ("gëmsg(˘lËÁûed: %s", 
	`ß„_°ªº‹
 (
î∫o
));

148 
exô
;

152 i‡(
ªtvÆ
 == 0 &&

153 
msgd©a
.
Àn
 > (
T_›tmgmt_ack
) &&

154 
TLIack
->
PRIM_ty≥
 =
T_OPTMGMT_ACK
 &&

155 
TLIack
->
MGMT_Êags
 =
T_SUCCESS
 &&

156 
MIB2hdr
->
Àn
 == 0)

159 i‡(
msgd©a
.
Àn
 > (
T_îr‹_ack
) &&

160 
TLIîr
->
PRIM_ty≥
 =
T_ERROR_ACK
) {

161 
	`zlog_w¨n
 ("getmsg(ctl)Ñeturned T_ERROR_ACK: %s",

162 
	`ß„_°ªº‹
 ((
TLIîr
->
TLI_îr‹
 =
TSYSERR
)

163 ? 
TLIîr
->
UNIX_îr‹
 : 
EPROTO
));

170 i‡(
ªtvÆ
 !
MOREDATA
 ||

171 
msgd©a
.
Àn
 <  (
T_›tmgmt_ack
) ||

172 
TLIack
->
PRIM_ty≥
 !
T_OPTMGMT_ACK
 ||

173 
TLIack
->
MGMT_Êags
 !
T_SUCCESS
) {

174 
î∫o
 = 
ENOMSG
;

175 
	`zlog_w¨n
 ("getmsg(ctl)Ñeturned bizarreness");

182 
¥o˚ss
 = (
MIB2hdr
->
Àvñ
 =
MIB2_IP
 &&

183 
MIB2hdr
->
«me
 =
MIB2_IP_21
) ? 1 : 0;

191 
msgd©a
.
maxÀn
 =  (
°‹age
) - ( (storage)

192 %  (
mib2_ùRouãE¡ry_t
));

194 
msgd©a
.
Àn
 = 0;

195 
Êags
 = 0;

198 
ªtvÆ
 = 
	`gëmsg
 (
dev
, 
NULL
, &
msgd©a
, &
Êags
);

200 i‡(
ªtvÆ
 == -1) {

201 
	`zlog_w¨n
 ("getmsg(data) failed: %s",

202 
	`ß„_°ªº‹
 (
î∫o
));

203 
exô
;

206 i‡(!(
ªtvÆ
 =0 ||ÑëvÆ =
MOREDATA
)) {

207 
	`zlog_w¨n
 ("gëmsg(d©aËªtu∫ed %d", 
ªtvÆ
);

208 
exô
;

211 i‡(
¥o˚ss
) {

212 i‡(
msgd©a
.
Àn
 %

213  (
mib2_ùRouãE¡ry_t
) != 0) {

214 
	`zlog_w¨n
 ("getmsg(data)Ñeturned "

215 "msgd©a.À¿%d (%% sizeo‡(mib2_ùRouãE¡ry_tË!0)", 
msgd©a
.
Àn
);

216 
exô
;

219 
rouãE¡ry
 = (
mib2_ùRouãE¡ry_t
 *)

220 
msgd©a
.
buf
;

221 
œ°RouãE¡ry
 = (
mib2_ùRouãE¡ry_t
 *)

222 (
msgd©a
.
buf
 + msgd©a.
Àn
);

224 
	`h™dÀ_rouã_íåy
 (
rouãE¡ry
);

225 } ++
rouãE¡ry
 < 
œ°RouãE¡ry
);

227 } 
ªtvÆ
 =
MOREDATA
);

230 
exô
:

231 
	`˛o£
 (
dev
);

232 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_netlink.c

23 
	~<zebø.h
>

25 
	~"zebø/z£rv.h
"

27 
√éök_rouã_ªad
 ();

29 
	$rouã_ªad
 ()

31 
	`√éök_rouã_ªad
 ();

32 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_proc.c

23 
	~<zebø.h
>

25 
	~"¥efix.h
"

26 
	~"log.h
"

27 
	~"if.h
"

28 
	~"rib.h
"

30 
	~"zebø/z£rv.h
"

31 
	~"zebø/π.h
"

34 #i‚de‡
_PATH_PROCNET_ROUTE


35 
	#_PATH_PROCNET_ROUTE
 "/¥oc/√t/rouã"

	)

39 #i‚de‡
_PATH_PROCNET_ROUTE6


40 
	#_PATH_PROCNET_ROUTE6
 "/¥oc/√t/ùv6_rouã"

	)

44 
	#INTERFACE_NAMSIZ
 20

	)

47 
	#RT_BUFSIZ
 1024

	)

51 
	$¥oc_rouã_ªad
 ()

53 
FILE
 *
Â
;

54 
buf
[
RT_BUFSIZ
];

55 
iÁ˚
[
INTERFACE_NAMSIZ
], 
de°
[9], 
g©e
[9], 
mask
[9];

56 
Êags
, 
ªf˙t
, 
u£
, 
mëric
, 
mtu
, 
wödow
, 
πt
;

59 
Â
 = 
	`f›í
 (
_PATH_PROCNET_ROUTE
, "r");

60 i‡(
Â
 =
NULL
)

62 
	`zlog_w¨n
 ("C™'à›í %†: %s\n", 
_PATH_PROCNET_ROUTE
, 
	`ß„_°ªº‹
 (
î∫o
));

67 
	`fgës
 (
buf
, 
RT_BUFSIZ
, 
Â
);

69 
	`fgës
 (
buf
, 
RT_BUFSIZ
, 
Â
Ë!
NULL
)

71 
n
;

72 
¥efix_ùv4
 
p
;

73 
ö_addr
 
tmpmask
;

74 
ö_addr
 
g©eway
;

75 
u_ch¨
 
zebø_Êags
 = 0;

77 
n
 = 
	`ssˇnf
 (
buf
, "%s %s %s %x %d %d %d %s %d %d %d",

78 
iÁ˚
, 
de°
, 
g©e
, &
Êags
, &
ªf˙t
, &
u£
, &
mëric
,

79 
mask
, &
mtu
, &
wödow
, &
πt
);

80 i‡(
n
 != 11)

82 
	`zlog_w¨n
 ("can'tÑeadáll ofÑouting information\n");

85 i‡(! (
Êags
 & 
RTF_UP
))

87 i‡(! (
Êags
 & 
RTF_GATEWAY
))

90 i‡(
Êags
 & 
RTF_DYNAMIC
)

91 
zebø_Êags
 |
ZEBRA_FLAG_SELFROUTE
;

93 
p
.
Ámûy
 = 
AF_INET
;

94 
	`ssˇnf
 (
de°
, "%lX", (*)&
p
.
¥efix
);

95 
	`ssˇnf
 (
mask
, "%lX", (*)&
tmpmask
);

96 
p
.
¥efixÀn
 = 
	`ù_maskÀn
 (
tmpmask
);

97 
	`ssˇnf
 (
g©e
, "%lX", (*)&
g©eway
);

99 
	`rib_add_ùv4
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
, &
p
, &
g©eway
, 
NULL
, 0, 0, 0, 0, 
SAFI_UNICAST
);

102 
	`f˛o£
 (
Â
);

104 
	}
}

106 #ifde‡
HAVE_IPV6


108 
	$¥oc_ùv6_rouã_ªad
 ()

110 
FILE
 *
Â
;

111 
buf
 [
RT_BUFSIZ
];

114 
Â
 = 
	`f›í
 (
_PATH_PROCNET_ROUTE6
, "r");

115 i‡(
Â
 =
NULL
)

117 
	`zlog_w¨n
 ("C™'à›í %†: %s", 
_PATH_PROCNET_ROUTE6
,

118 
	`ß„_°ªº‹
 (
î∫o
));

123 
	`fgës
 (
buf
, 
RT_BUFSIZ
, 
Â
Ë!
NULL
)

125 
n
;

126 
de°
[33], 
§c
[33], 
g©e
[33];

127 
iÁ˚
[
INTERFACE_NAMSIZ
];

128 
de°_∂í
, 
§c_∂í
;

129 
mëric
, 
u£
, 
ªf˙t
, 
Êags
;

130 
¥efix_ùv6
 
p
;

131 
ö6_addr
 
g©eway
;

132 
u_ch¨
 
zebø_Êags
 = 0;

136 
n
 = 
	`ssˇnf
 (
buf
, "%32s %02x %32s %02x %32s %08x %08x %08x %08x %s",

137 
de°
, &
de°_∂í
, 
§c
, &
§c_∂í
, 
g©e
,

138 &
mëric
, &
u£
, &
ªf˙t
, &
Êags
, 
iÁ˚
);

140 i‡(
n
 != 10)

146 i‡(! (
Êags
 & 
RTF_UP
))

148 i‡(! (
Êags
 & 
RTF_GATEWAY
))

151 i‡(
Êags
 & 
RTF_DYNAMIC
)

152 
zebø_Êags
 |
ZEBRA_FLAG_SELFROUTE
;

154 
p
.
Ámûy
 = 
AF_INET6
;

155 
	`°r2ö6_addr
 (
de°
, &
p
.
¥efix
);

156 
	`°r2ö6_addr
 (
g©e
, &
g©eway
);

157 
p
.
¥efixÀn
 = 
de°_∂í
;

159 
	`rib_add_ùv6
 (
ZEBRA_ROUTE_KERNEL
, 
zebø_Êags
, &
p
, &
g©eway
, 0, 0,

160 
mëric
, 0);

163 
	`f˛o£
 (
Â
);

165 
	}
}

169 
	$rouã_ªad
 ()

171 
	`¥oc_rouã_ªad
 ();

172 #ifde‡
HAVE_IPV6


173 
	`¥oc_ùv6_rouã_ªad
 ();

175 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_sysctl.c

23 
	~<zebø.h
>

25 
	~"mem‹y.h
"

26 
	~"log.h
"

28 
	~"zebø/z£rv.h
"

29 
	~"zebø/π.h
"

30 
	~"zebø/kî√l_sockë.h
"

34 
	$rouã_ªad
 ()

36 
ˇddr_t
 
buf
, 
íd
, 
ªf
;

37 
size_t
 
bufsiz
;

38 
π_msghdr
 *
πm
;

40 
	#MIBSIZ
 6

	)

41 
mib
[
MIBSIZ
] =

43 
CTL_NET
,

44 
PF_ROUTE
,

47 
NET_RT_DUMP
,

52 i‡(
	`sys˘l
 (
mib
, 
MIBSIZ
, 
NULL
, &
bufsiz
, NULL, 0) < 0)

54 
	`zlog_w¨n
 ("sys˘»Áû: %s", 
	`ß„_°ªº‹
 (
î∫o
));

59 
ªf
 = 
buf
 = 
	`XMALLOC
 (
MTYPE_TMP
, 
bufsiz
);

62 i‡(
	`sys˘l
 (
mib
, 
MIBSIZ
, 
buf
, &
bufsiz
, 
NULL
, 0) < 0)

64 
	`zlog_w¨n
 ("sys˘l(ËÁû by %s", 
	`ß„_°ªº‹
 (
î∫o
));

68 
íd
 = 
buf
 + 
bufsiz
; bu‡<Énd; bu‡+
πm
->
πm_msgÀn
)

70 
πm
 = (
π_msghdr
 *Ë
buf
;

72 
	`SET_FLAG
 (
πm
->
πm_Êags
, 
RTF_DONE
);

73 
	`πm_ªad
 (
πm
);

77 
	`XFREE
 (
MTYPE_TMP
, 
ªf
);

80 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/test_main.c

20 
	~<zebø.h
>

22 
	~<lib/vîsi⁄.h
>

23 
	~"gë›t.h
"

24 
	~"comm™d.h
"

25 
	~"thªad.h
"

26 
	~"fûãr.h
"

27 
	~"mem‹y.h
"

28 
	~"¥efix.h
"

29 
	~"log.h
"

30 
	~"¥ivs.h
"

31 
	~"sigevít.h
"

33 
	~"zebø/rib.h
"

34 
	~"zebø/z£rv.h
"

35 
	~"zebø/debug.h
"

36 
	~"zebø/rouãr-id.h
"

37 
	~"zebø/öãrÁ˚.h
"

40 
zebø_t
 
	gzebød
 =

42 .
πm_èbÀ_deÁu…
 = 0,

46 
pid_t
 
	gpid
;

49 
rib_¥o˚ss_hﬁd_time
;

52 
thªad_ma°î
 *
	gma°î
;

55 
›ti⁄
 
	gl⁄g›ts
[] =

57 { "b©ch", 
no_¨gumít
, 
NULL
, 'b'},

58 { "d´m⁄", 
no_¨gumít
, 
NULL
, 'd'},

59 { "c⁄fig_fûe", 
ªquúed_¨gumít
, 
NULL
, 'f'},

60 { "hñp", 
no_¨gumít
, 
NULL
, 'h'},

61 { "vty_addr", 
ªquúed_¨gumít
, 
NULL
, 'A'},

62 { "vty_p‹t", 
ªquúed_¨gumít
, 
NULL
, 'P'},

63 { "vîsi⁄", 
no_¨gumít
, 
NULL
, 'v'},

64 { "rib_hﬁd", 
ªquúed_¨gumít
, 
NULL
, 'r'},

68 
zebø_ˇ∑bûôõs_t
 
	g_ˇps_p
 [] =

70 
ZCAP_NET_ADMIN
,

71 
ZCAP_SYS_ADMIN
,

72 
ZCAP_NET_RAW
,

76 
	gc⁄fig_deÁu…
[] = 
SYSCONFDIR
 
DEFAULT_CONFIG_FILE
;

79 c⁄° *
	gpid_fûe
 = 
PATH_ZEBRA_PID
;

83 
	$ußge
 (*
¥og«me
, 
°©us
)

85 i‡(
°©us
 != 0)

86 
	`Ârötf
 (
°dîr
, "Try `%†--hñp' f‹ m‹êöf‹m©i⁄.\n", 
¥og«me
);

89 
	`¥ötf
 ("Usage : %s [OPTION...]\n\n"\

101 "Rï‹àbug†tÿ%s\n", 
¥og«me
, 
ZEBRA_BUG_ADDRESS
);

104 
	`exô
 (
°©us
);

105 
	}
}

107 
	gã°_ifödex
 = 0;

110 
DEFUN
 (
ã°_öãrÁ˚_°©e
,

111 
ã°_öãrÁ˚_°©e_cmd
,

117 
öãrÁ˚
 *
	giÂ
;

118 i‡(
	g¨gc
 < 1)

119  
	gCMD_WARNING
;

121 
	giÂ
 = 
vty
->
ödex
;

122 i‡(
	giÂ
->
	gifödex
 =
IFINDEX_INTERNAL
)

124 
iÂ
->
ifödex
 = ++
ã°_ifödex
;

125 
	giÂ
->
	gmtu
 = 1500;

126 
	giÂ
->
	gÊags
 = 
IFF_BROADCAST
|
IFF_MULTICAST
;

129 
	g¨gv
[0][0])

132 
SET_FLAG
 (
iÂ
->
Êags
, 
IFF_UP
);

133 
if_add_upd©e
 (
iÂ
);

134 
¥ötf
 ("up\n");

137 
UNSET_FLAG
 (
iÂ
->
Êags
, 
IFF_UP
);

138 
if_dñëe_upd©e
 (
iÂ
);

139 
¥ötf
 ("down\n");

142  
CMD_WARNING
;

144  
	gCMD_SUCCESS
;

148 
	$ã°_cmd_öô
 ()

150 
	`ö°Æl_ñemít
 (
INTERFACE_NODE
, &
ã°_öãrÁ˚_°©e_cmd
);

151 
	}
}

155 
	$sighup
 ()

157 
	`zlog_öfo
 ("SIGHUPÑeceived");

161 
	}
}

165 
	$sigöt
 ()

167 
	`zlog_nŸi˚
 ("Terminating on signal");

169 
	`exô
 (0);

170 
	}
}

174 
	$sigu§1
 ()

176 
	`zlog_rŸ©e
 (
NULL
);

177 
	}
}

179 
quagga_sig«l_t
 
	gzebø_sig«ls
[] =

182 .
sig«l
 = 
SIGHUP
,

183 .
	gh™dÀr
 = &
sighup
,

186 .
	gsig«l
 = 
SIGUSR1
,

187 .
	gh™dÀr
 = &
sigu§1
,

190 .
	gsig«l
 = 
SIGINT
,

191 .
	gh™dÀr
 = &
sigöt
,

194 .
	gsig«l
 = 
SIGTERM
,

195 .
	gh™dÀr
 = &
sigöt
,

201 
	$maö
 (
¨gc
, **
¨gv
)

203 *
p
;

204 *
vty_addr
 = 
NULL
;

205 
vty_p‹t
 = 0;

206 
b©ch_mode
 = 0;

207 
d´m⁄_mode
 = 0;

208 *
c⁄fig_fûe
 = 
NULL
;

209 *
¥og«me
;

210 
thªad
Åhread;

213 
	`umask
 (0027);

216 
¥og«me
 = ((
p
 = 
	`°ºchr
 (
¨gv
[0], '/')) ? ++p :árgv[0]);

218 
zlog_deÁu…
 = 
	`›ízlog
 (
¥og«me
, 
ZLOG_ZEBRA
,

219 
LOG_CONS
|
LOG_NDELAY
|
LOG_PID
, 
LOG_DAEMON
);

223 
›t
;

225 
›t
 = 
	`gë›t_l⁄g
 (
¨gc
, 
¨gv
, "bdf:hA:P:r:v", 
l⁄g›ts
, 0);

227 i‡(
›t
 =
EOF
)

230 
›t
)

235 
b©ch_mode
 = 1;

237 
d´m⁄_mode
 = 1;

240 
c⁄fig_fûe
 = 
›èrg
;

243 
vty_addr
 = 
›èrg
;

248 i‡(
	`°rcmp
(
›èrg
, "0") == 0)

250 
vty_p‹t
 = 0;

253 
vty_p‹t
 = 
	`©oi
 (
›èrg
);

256 
rib_¥o˚ss_hﬁd_time
 = 
	`©oi
(
›èrg
);

259 
	`¥öt_vîsi⁄
 (
¥og«me
);

260 
	`exô
 (0);

263 
	`ußge
 (
¥og«me
, 0);

266 
	`ußge
 (
¥og«me
, 1);

272 i‡(!
vty_p‹t
 || !
c⁄fig_fûe
)

274 
	`Ârötf
 (
°dîr
, "Error: --vty_portánd --config_fileárguments"

276 
	`ußge
 (
¥og«me
, 1);

280 
zebød
.
ma°î
 = 
	`thªad_ma°î_¸óã
 ();

283 
	`sig«l_öô
 (
zebød
.
ma°î
, 
	`¨øy_size
(
zebø_sig«ls
), zebra_signals);

284 
	`cmd_öô
 (1);

285 
	`vty_öô
 (
zebød
.
ma°î
);

286 
	`mem‹y_öô
 ();

287 
	`if_öô
();

288 
	`zebø_debug_öô
 ();

289 
	`zebø_if_öô
 ();

290 
	`ã°_cmd_öô
 ();

293 
	`rib_öô
 ();

294 
	`ac˚ss_li°_öô
 ();

297 
	`kî√l_öô
 ();

298 
	`rouã_ªad
 ();

299 
	`zebø_vty_öô
();

302 
	`s‹t_node
 ();

305 
	`vty_ªad_c⁄fig
 (
c⁄fig_fûe
, 
c⁄fig_deÁu…
);

308 
	`rib_wìd_èbÀs
 ();

311 i‡(
b©ch_mode
)

312 
	`exô
 (0);

315 i‡(
d´m⁄_mode
 && 
	`d´m⁄
 (0, 0) < 0)

317 
	`≥º‹
("daemon start failed");

318 
	`exô
 (1);

322 
pid
 = 
	`gëpid
 ();

325 
	`vty_£rv_sock
 (
vty_addr
, 
vty_p‹t
, "/tmp/test_zebra");

328 
	`zlog_nŸi˚
 ("Zebø %†°¨tög: vty@%d", 
QUAGGA_VERSION
, 
vty_p‹t
);

330 
	`thªad_„tch
 (
zebød
.
ma°î
, &
thªad
))

331 
	`thªad_ˇŒ
 (&
thªad
);

335 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm.c

25 
	~<zebø.h
>

27 
	~"log.h
"

28 
	~"°ªam.h
"

29 
	~"thªad.h
"

30 
	~"√tw‹k.h
"

31 
	~"comm™d.h
"

33 
	~"zebø/rib.h
"

35 
	~"Âm/Âm.h
"

36 
	~"zebø_Âm.h
"

37 
	~"zebø_Âm_¥iv©e.h
"

42 
	#ZFPM_CONNECT_RETRY_IVL
 5

	)

48 
	#ZFPM_OBUF_SIZE
 (2 * 
FPM_MAX_MSG_LEN
)

	)

49 
	#ZFPM_IBUF_SIZE
 (
FPM_MAX_MSG_LEN
)

	)

55 
	#ZFPM_MAX_WRITES_PER_RUN
 10

	)

60 
	#ZFPM_STATS_IVL_SECS
 10

	)

66 
	szÂm_∫odes_ôî_t_


68 
rib_èbÀs_ôî_t
 
	mèbÀs_ôî
;

69 
rouã_èbÀ_ôî_t
 
	môî
;

70 } 
	tzÂm_∫odes_ôî_t
;

75 
	szÂm_°©s_t_
 {

76 
	mc⁄√˘_ˇŒs
;

77 
	mc⁄√˘_no_sock
;

79 
	mªad_cb_ˇŒs
;

81 
	mwrôe_cb_ˇŒs
;

82 
	mwrôe_ˇŒs
;

83 
	m∑πül_wrôes
;

84 
	mmax_wrôes_hô
;

85 
	mt_wrôe_yõlds
;

87 
	mn›_dñëes_skù≥d
;

88 
	mrouã_adds
;

89 
	mrouã_dñs
;

91 
	mupd©es_åiggîed
;

92 
	mªdund™t_åiggîs
;

93 
	mn⁄_Âm_èbÀ_åiggîs
;

95 
	mde°s_dñ_a·î_upd©e
;

97 
	mt_c⁄n_down_°¨ts
;

98 
	mt_c⁄n_down_de°s_¥o˚s£d
;

99 
	mt_c⁄n_down_yõlds
;

100 
	mt_c⁄n_down_föishes
;

102 
	mt_c⁄n_up_°¨ts
;

103 
	mt_c⁄n_up_de°s_¥o˚s£d
;

104 
	mt_c⁄n_up_yõlds
;

105 
	mt_c⁄n_up_ab‹ts
;

106 
	mt_c⁄n_up_föishes
;

108 } 
	tzÂm_°©s_t
;

120 
	mZFPM_STATE_IDLE
,

126 
	mZFPM_STATE_ACTIVE
,

132 
	mZFPM_STATE_CONNECTING
,

137 
	mZFPM_STATE_ESTABLISHED


139 } 
	tzÂm_°©e_t
;

144 
	szÂm_glob_t_


150 
	míabÀd
;

152 
thªad_ma°î
 *
	mma°î
;

154 
zÂm_°©e_t
 
	m°©e
;

159 
	mÂm_p‹t
;

164 
TAILQ_HEAD
 (
zÂm_de°_q
, 
rib_de°_t_
Ë
	mde°_q
;

169 
	msock
;

174 
°ªam
 *
	mobuf
;

175 
°ªam
 *
	mibuf
;

180 
thªad
 *
	mt_c⁄√˘
;

181 
thªad
 *
	mt_wrôe
;

182 
thªad
 *
	mt_ªad
;

188 
thªad
 *
	mt_c⁄n_down
;

191 
zÂm_∫odes_ôî_t
 
	môî
;

192 } 
	mt_c⁄n_down_°©e
;

198 
thªad
 *
	mt_c⁄n_up
;

201 
zÂm_∫odes_ôî_t
 
	môî
;

202 } 
	mt_c⁄n_up_°©e
;

204 
	mc⁄√˘_ˇŒs
;

205 
time_t
 
	mœ°_c⁄√˘_ˇŒ_time
;

211 
zÂm_°©s_t
 
	m°©s
;

216 
zÂm_°©s_t
 
	mœ°_ivl_°©s
;

222 
zÂm_°©s_t
 
	mcumuœtive_°©s
;

227 
thªad
 *
	mt_°©s
;

232 
time_t
 
	mœ°_°©s_˛ór_time
;

234 } 
	tzÂm_glob_t
;

236 
zÂm_glob_t
 
	gzÂm_glob_•a˚
;

237 
zÂm_glob_t
 *
	gzÂm_g
 = &
zÂm_glob_•a˚
;

239 
zÂm_ªad_cb
 (
thªad
 *thread);

240 
zÂm_wrôe_cb
 (
thªad
 *thread);

242 
zÂm_£t_°©e
 (
zÂm_°©e_t
 
°©e
, c⁄° *
ªas⁄
);

243 
zÂm_°¨t_c⁄√˘_timî
 (c⁄° *
ªas⁄
);

244 
zÂm_°¨t_°©s_timî
 ();

249 
ölöe
 

250 
	$zÂm_thªad_should_yõld
 (
thªad
 *
t
)

252  
	`thªad_should_yõld
 (
t
);

253 
	}
}

259 
	$zÂm_°©e_to_°r
 (
zÂm_°©e_t
 
°©e
)

261 
°©e
)

264 
ZFPM_STATE_IDLE
:

267 
ZFPM_STATE_ACTIVE
:

270 
ZFPM_STATE_CONNECTING
:

273 
ZFPM_STATE_ESTABLISHED
:

279 
	}
}

284 
time_t


285 
	$zÂm_gë_time
 ()

287 
timevÆ
 
tv
;

289 i‡(
	`quagga_gëtime
 (
QUAGGA_CLK_MONOTONIC
, &
tv
) < 0)

290 
	`zlog_w¨n
 ("FPM: quagga_gettime failed!!");

292  
tv
.
tv_£c
;

293 
	}
}

300 
time_t


301 
	$zÂm_gë_ñ≠£d_time
 (
time_t
 
ª„ªn˚
)

303 
time_t
 
now
;

305 
now
 = 
	`zÂm_gë_time
 ();

307 i‡(
now
 < 
ª„ªn˚
)

309 
	`as£π
 (0);

313  
now
 - 
ª„ªn˚
;

314 
	}
}

322 
ölöe
 

323 
	$zÂm_is_èbÀ_f‹_Âm
 (
rouã_èbÀ
 *
èbÀ
)

325 
rib_èbÀ_öfo_t
 *
öfo
;

327 
öfo
 = 
	`rib_èbÀ_öfo
 (
èbÀ
);

333 i‡(
öfo
->
vrf
->
id
 != 0)

336 i‡(
öfo
->
ßfi
 !
SAFI_UNICAST
)

340 
	}
}

345 
ölöe
 

346 
	$zÂm_∫odes_ôî_öô
 (
zÂm_∫odes_ôî_t
 *
ôî
)

348 
	`mem£t
 (
ôî
, 0,  (*iter));

349 
	`rib_èbÀs_ôî_öô
 (&
ôî
->
èbÀs_ôî
);

356 
	`rouã_èbÀ_ôî_öô
 (&
ôî
->ôî, 
NULL
);

357 
	`rouã_èbÀ_ôî_˛ónup
 (&
ôî
->iter);

358 
	}
}

363 
ölöe
 
rouã_node
 *

364 
	$zÂm_∫odes_ôî_√xt
 (
zÂm_∫odes_ôî_t
 *
ôî
)

366 
rouã_node
 *
∫
;

367 
rouã_èbÀ
 *
èbÀ
;

371 
∫
 = 
	`rouã_èbÀ_ôî_√xt
 (&
ôî
->iter);

372 i‡(
∫
)

373  
∫
;

378 
	`rouã_èbÀ_ôî_˛ónup
 (&
ôî
->iter);

380 (
èbÀ
 = 
	`rib_èbÀs_ôî_√xt
 (&
ôî
->
èbÀs_ôî
)))

382 i‡(
	`zÂm_is_èbÀ_f‹_Âm
 (
èbÀ
))

386 i‡(!
èbÀ
)

387  
NULL
;

389 
	`rouã_èbÀ_ôî_öô
 (&
ôî
->ôî, 
èbÀ
);

392  
NULL
;

393 
	}
}

398 
ölöe
 

399 
	$zÂm_∫odes_ôî_∑u£
 (
zÂm_∫odes_ôî_t
 *
ôî
)

401 
	`rouã_èbÀ_ôî_∑u£
 (&
ôî
->iter);

402 
	}
}

407 
ölöe
 

408 
	$zÂm_∫odes_ôî_˛ónup
 (
zÂm_∫odes_ôî_t
 *
ôî
)

410 
	`rouã_èbÀ_ôî_˛ónup
 (&
ôî
->iter);

411 
	`rib_èbÀs_ôî_˛ónup
 (&
ôî
->
èbÀs_ôî
);

412 
	}
}

419 
ölöe
 

420 
	$zÂm_°©s_öô
 (
zÂm_°©s_t
 *
°©s
)

422 
	`mem£t
 (
°©s
, 0,  (*stats));

423 
	}
}

428 
ölöe
 

429 
	$zÂm_°©s_ª£t
 (
zÂm_°©s_t
 *
°©s
)

431 
	`zÂm_°©s_öô
 (
°©s
);

432 
	}
}

437 
ölöe
 

438 
	$zÂm_°©s_c›y
 (c⁄° 
zÂm_°©s_t
 *
§c
, zÂm_°©s_à*
de°
)

440 
	`mem˝y
 (
de°
, 
§c
,  (*dest));

441 
	}
}

455 
	$zÂm_°©s_compo£
 (c⁄° 
zÂm_°©s_t
 *
s1
, c⁄° zÂm_°©s_à*
s2
,

456 
zÂm_°©s_t
 *
ªsu…
)

458 c⁄° *
p1
, *
p2
;

459 *
ªsu…_p
;

460 
i
, 
num_cou¡îs
;

462 
p1
 = (c⁄° *Ë
s1
;

463 
p2
 = (c⁄° *Ë
s2
;

464 
ªsu…_p
 = (*Ë
ªsu…
;

466 
num_cou¡îs
 = ( (
zÂm_°©s_t
) /  ());

468 
i
 = 0; i < 
num_cou¡îs
; i++)

470 
ªsu…_p
[
i
] = 
p1
[i] + 
p2
[i];

472 
	}
}

477 
ölöe
 

478 
	$zÂm_ªad_⁄
 ()

480 
	`as£π
 (!
zÂm_g
->
t_ªad
);

481 
	`as£π
 (
zÂm_g
->
sock
 >= 0);

483 
	`THREAD_READ_ON
 (
zÂm_g
->
ma°î
, zÂm_g->
t_ªad
, 
zÂm_ªad_cb
, 0,

484 
zÂm_g
->
sock
);

485 
	}
}

490 
ölöe
 

491 
	$zÂm_wrôe_⁄
 ()

493 
	`as£π
 (!
zÂm_g
->
t_wrôe
);

494 
	`as£π
 (
zÂm_g
->
sock
 >= 0);

496 
	`THREAD_WRITE_ON
 (
zÂm_g
->
ma°î
, zÂm_g->
t_wrôe
, 
zÂm_wrôe_cb
, 0,

497 
zÂm_g
->
sock
);

498 
	}
}

503 
ölöe
 

504 
	$zÂm_ªad_off
 ()

506 
	`THREAD_READ_OFF
 (
zÂm_g
->
t_ªad
);

507 
	}
}

512 
ölöe
 

513 
	$zÂm_wrôe_off
 ()

515 
	`THREAD_WRITE_OFF
 (
zÂm_g
->
t_wrôe
);

516 
	}
}

525 
	$zÂm_c⁄n_up_thªad_cb
 (
thªad
 *thread)

527 
rouã_node
 *
∫ode
;

528 
zÂm_∫odes_ôî_t
 *
ôî
;

529 
rib_de°_t
 *
de°
;

531 
	`as£π
 (
zÂm_g
->
t_c⁄n_up
);

532 
zÂm_g
->
t_c⁄n_up
 = 
NULL
;

534 
ôî
 = &
zÂm_g
->
t_c⁄n_up_°©e
.iter;

536 i‡(
zÂm_g
->
°©e
 !
ZFPM_STATE_ESTABLISHED
)

538 
	`zÂm_debug
 ("ConnectionÇot upánymore, conn_upÅhreadáborting");

539 
zÂm_g
->
°©s
.
t_c⁄n_up_ab‹ts
++;

540 
d⁄e
;

543 (
∫ode
 = 
	`zÂm_∫odes_ôî_√xt
 (
ôî
)))

545 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫ode
);

547 i‡(
de°
)

549 
zÂm_g
->
°©s
.
t_c⁄n_up_de°s_¥o˚s£d
++;

550 
	`zÂm_åiggî_upd©e
 (
∫ode
, 
NULL
);

556 i‡(!
	`zÂm_thªad_should_yõld
 (
thªad
))

559 
zÂm_g
->
°©s
.
t_c⁄n_up_yõlds
++;

560 
	`zÂm_∫odes_ôî_∑u£
 (
ôî
);

561 
zÂm_g
->
t_c⁄n_up
 = 
	`thªad_add_background
 (zÂm_g->
ma°î
,

562 
zÂm_c⁄n_up_thªad_cb
,

567 
zÂm_g
->
°©s
.
t_c⁄n_up_föishes
++;

569 
d⁄e
:

570 
	`zÂm_∫odes_ôî_˛ónup
 (
ôî
);

572 
	}
}

580 
	$zÂm_c⁄√˘i⁄_up
 (c⁄° *
dëaû
)

582 
	`as£π
 (
zÂm_g
->
sock
 >= 0);

583 
	`zÂm_ªad_⁄
 ();

584 
	`zÂm_wrôe_⁄
 ();

585 
	`zÂm_£t_°©e
 (
ZFPM_STATE_ESTABLISHED
, 
dëaû
);

590 
	`as£π
 (!
zÂm_g
->
t_c⁄n_up
);

592 
	`zÂm_∫odes_ôî_öô
 (&
zÂm_g
->
t_c⁄n_up_°©e
.
ôî
);

594 
	`zÂm_debug
 ("Starting conn_upÅhread");

595 
zÂm_g
->
t_c⁄n_up
 = 
	`thªad_add_background
 (zÂm_g->
ma°î
,

596 
zÂm_c⁄n_up_thªad_cb
, 0, 0);

597 
zÂm_g
->
°©s
.
t_c⁄n_up_°¨ts
++;

598 
	}
}

606 
	$zÂm_c⁄√˘_check
 ()

608 
°©us
;

609 
sockÀn_t
 
¶í
;

610 
ªt
;

612 
	`zÂm_ªad_off
 ();

613 
	`zÂm_wrôe_off
 ();

615 
¶í
 =  (
°©us
);

616 
ªt
 = 
	`gësock›t
 (
zÂm_g
->
sock
, 
SOL_SOCKET
, 
SO_ERROR
, (*Ë&
°©us
,

617 &
¶í
);

619 i‡(
ªt
 >0 && 
°©us
 == 0)

621 
	`zÂm_c⁄√˘i⁄_up
 ("async connect complete");

628 
	`˛o£
 (
zÂm_g
->
sock
);

629 
zÂm_g
->
sock
 = -1;

631 
	`zÂm_°¨t_c⁄√˘_timî
 ("getsockopt()áfterásync connect failed");

633 
	}
}

642 
	$zÂm_c⁄n_down_thªad_cb
 (
thªad
 *thread)

644 
rouã_node
 *
∫ode
;

645 
zÂm_∫odes_ôî_t
 *
ôî
;

646 
rib_de°_t
 *
de°
;

648 
	`as£π
 (
zÂm_g
->
°©e
 =
ZFPM_STATE_IDLE
);

650 
	`as£π
 (
zÂm_g
->
t_c⁄n_down
);

651 
zÂm_g
->
t_c⁄n_down
 = 
NULL
;

653 
ôî
 = &
zÂm_g
->
t_c⁄n_down_°©e
.iter;

655 (
∫ode
 = 
	`zÂm_∫odes_ôî_√xt
 (
ôî
)))

657 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫ode
);

659 i‡(
de°
)

661 i‡(
	`CHECK_FLAG
 (
de°
->
Êags
, 
RIB_DEST_UPDATE_FPM
))

663 
	`TAILQ_REMOVE
 (&
zÂm_g
->
de°_q
, 
de°
, 
Âm_q_íåõs
);

666 
	`UNSET_FLAG
 (
de°
->
Êags
, 
RIB_DEST_UPDATE_FPM
);

667 
	`UNSET_FLAG
 (
de°
->
Êags
, 
RIB_DEST_SENT_TO_FPM
);

669 
zÂm_g
->
°©s
.
t_c⁄n_down_de°s_¥o˚s£d
++;

674 
	`rib_gc_de°
(
∫ode
);

680 i‡(!
	`zÂm_thªad_should_yõld
 (
thªad
))

683 
zÂm_g
->
°©s
.
t_c⁄n_down_yõlds
++;

684 
	`zÂm_∫odes_ôî_∑u£
 (
ôî
);

685 
zÂm_g
->
t_c⁄n_down
 = 
	`thªad_add_background
 (zÂm_g->
ma°î
,

686 
zÂm_c⁄n_down_thªad_cb
,

691 
zÂm_g
->
°©s
.
t_c⁄n_down_föishes
++;

692 
	`zÂm_∫odes_ôî_˛ónup
 (
ôî
);

697 
	`zÂm_°¨t_c⁄√˘_timî
 ("cleanup complete");

699 
	}
}

707 
	$zÂm_c⁄√˘i⁄_down
 (c⁄° *
dëaû
)

709 i‡(!
dëaû
)

710 
dëaû
 = "unknown";

712 
	`as£π
 (
zÂm_g
->
°©e
 =
ZFPM_STATE_ESTABLISHED
);

714 
	`zlog_öfo
 ("c⁄√˘i⁄ÅÿthêFPM ha†g⁄êdown: %s", 
dëaû
);

716 
	`zÂm_ªad_off
 ();

717 
	`zÂm_wrôe_off
 ();

719 
	`°ªam_ª£t
 (
zÂm_g
->
ibuf
);

720 
	`°ªam_ª£t
 (
zÂm_g
->
obuf
);

722 i‡(
zÂm_g
->
sock
 >= 0) {

723 
	`˛o£
 (
zÂm_g
->
sock
);

724 
zÂm_g
->
sock
 = -1;

730 
	`as£π
 (!
zÂm_g
->
t_c⁄n_down
);

731 
	`zÂm_debug
 ("Starting conn_downÅhread");

732 
	`zÂm_∫odes_ôî_öô
 (&
zÂm_g
->
t_c⁄n_down_°©e
.
ôî
);

733 
zÂm_g
->
t_c⁄n_down
 = 
	`thªad_add_background
 (zÂm_g->
ma°î
,

734 
zÂm_c⁄n_down_thªad_cb
, 0, 0);

735 
zÂm_g
->
°©s
.
t_c⁄n_down_°¨ts
++;

737 
	`zÂm_£t_°©e
 (
ZFPM_STATE_IDLE
, 
dëaû
);

738 
	}
}

744 
	$zÂm_ªad_cb
 (
thªad
 *thread)

746 
size_t
 
Æªady
;

747 
°ªam
 *
ibuf
;

748 
uöt16_t
 
msg_Àn
;

749 
Âm_msg_hdr_t
 *
hdr
;

751 
zÂm_g
->
°©s
.
ªad_cb_ˇŒs
++;

752 
	`as£π
 (
zÂm_g
->
t_ªad
);

753 
zÂm_g
->
t_ªad
 = 
NULL
;

758 i‡(
zÂm_g
->
°©e
 =
ZFPM_STATE_CONNECTING
)

760 
	`zÂm_c⁄√˘_check
();

764 
	`as£π
 (
zÂm_g
->
°©e
 =
ZFPM_STATE_ESTABLISHED
);

765 
	`as£π
 (
zÂm_g
->
sock
 >= 0);

767 
ibuf
 = 
zÂm_g
->ibuf;

769 
Æªady
 = 
	`°ªam_gë_ídp
 (
ibuf
);

770 i‡(
Æªady
 < 
FPM_MSG_HDR_LEN
)

772 
ssize_t
 
nbyã
;

774 
nbyã
 = 
	`°ªam_ªad_åy
 (
ibuf
, 
zÂm_g
->
sock
, 
FPM_MSG_HDR_LEN
 - 
Æªady
);

775 i‡(
nbyã
 == 0 ||Çbyte == -1)

777 
	`zÂm_c⁄√˘i⁄_down
 ("closed socket inÑead");

781 i‡(
nbyã
 !(
ssize_t
Ë(
FPM_MSG_HDR_LEN
 - 
Æªady
))

782 
d⁄e
;

784 
Æªady
 = 
FPM_MSG_HDR_LEN
;

787 
	`°ªam_£t_gëp
 (
ibuf
, 0);

789 
hdr
 = (
Âm_msg_hdr_t
 *Ë
	`°ªam_≤t
 (
ibuf
);

791 i‡(!
	`Âm_msg_hdr_ok
 (
hdr
))

793 
	`zÂm_c⁄√˘i⁄_down
 ("invalid message header");

797 
msg_Àn
 = 
	`Âm_msg_Àn
 (
hdr
);

802 i‡(
Æªady
 < 
msg_Àn
)

804 
ssize_t
 
nbyã
;

806 
nbyã
 = 
	`°ªam_ªad_åy
 (
ibuf
, 
zÂm_g
->
sock
, 
msg_Àn
 - 
Æªady
);

808 i‡(
nbyã
 == 0 ||Çbyte == -1)

810 
	`zÂm_c⁄√˘i⁄_down
 ("failedÅoÑead message");

814 i‡(
nbyã
 !(
ssize_t
Ë(
msg_Àn
 - 
Æªady
))

815 
d⁄e
;

818 
	`zÂm_debug
 ("Read outá full fpm message");

823 
	`°ªam_ª£t
 (
ibuf
);

825 
d⁄e
:

826 
	`zÂm_ªad_⁄
 ();

828 
	}
}

836 
	$zÂm_wrôes_≥ndög
 ()

843 i‡(
	`°ªam_gë_ídp
 (
zÂm_g
->
obuf
Ë- 
	`°ªam_gë_gëp
 (zfpm_g->obuf))

849 i‡(!
	`TAILQ_EMPTY
 (&
zÂm_g
->
de°_q
))

853 
	}
}

863 
ölöe
 

864 
	$zÂm_ícode_rouã
 (
rib_de°_t
 *
de°
, 
rib
 *rib, *
ö_buf
,

865 
size_t
 
ö_buf_Àn
)

867 #i‚de‡
HAVE_NETLINK


871 
cmd
;

873 
cmd
 = 
rib
 ? 
RTM_NEWROUTE
 : 
RTM_DELROUTE
;

875  
	`zÂm_√éök_ícode_rouã
 (
cmd
, 
de°
, 
rib
, 
ö_buf
, 
ö_buf_Àn
);

878 
	}
}

885 
rib
 *

886 
	$zÂm_rouã_f‹_upd©e
 (
rib_de°_t
 *
de°
)

888 
rib
 *rib;

890 
	`RIB_DEST_FOREACH_ROUTE
 (
de°
, 
rib
)

892 i‡(!
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

895  
rib
;

901  
NULL
;

902 
	}
}

911 
	$zÂm_buûd_upd©es
 ()

913 
°ªam
 *
s
;

914 
rib_de°_t
 *
de°
;

915 *
buf
, *
d©a
, *
buf_íd
;

916 
size_t
 
msg_Àn
;

917 
size_t
 
d©a_Àn
;

918 
Âm_msg_hdr_t
 *
hdr
;

919 
rib
 *rib;

920 
is_add
, 
wrôe_msg
;

922 
s
 = 
zÂm_g
->
obuf
;

924 
	`as£π
 (
	`°ªam_em±y
 (
s
));

931 i‡(
	`STREAM_WRITEABLE
 (
s
Ë< 
FPM_MAX_MSG_LEN
)

934 
buf
 = 
	`STREAM_DATA
 (
s
Ë+ 
	`°ªam_gë_ídp
 (s);

935 
buf_íd
 = 
buf
 + 
	`STREAM_WRITEABLE
 (
s
);

937 
de°
 = 
	`TAILQ_FIRST
 (&
zÂm_g
->
de°_q
);

938 i‡(!
de°
)

941 
	`as£π
 (
	`CHECK_FLAG
 (
de°
->
Êags
, 
RIB_DEST_UPDATE_FPM
));

943 
hdr
 = (
Âm_msg_hdr_t
 *Ë
buf
;

944 
hdr
->
vîsi⁄
 = 
FPM_PROTO_VERSION
;

945 
hdr
->
msg_ty≥
 = 
FPM_MSG_TYPE_NETLINK
;

947 
d©a
 = 
	`Âm_msg_d©a
 (
hdr
);

949 
rib
 = 
	`zÂm_rouã_f‹_upd©e
 (
de°
);

950 
is_add
 = 
rib
 ? 1 : 0;

952 
wrôe_msg
 = 1;

958 i‡(!
is_add
 && !
	`CHECK_FLAG
 (
de°
->
Êags
, 
RIB_DEST_SENT_TO_FPM
))

960 
wrôe_msg
 = 0;

961 
zÂm_g
->
°©s
.
n›_dñëes_skù≥d
++;

964 i‡(
wrôe_msg
) {

965 
d©a_Àn
 = 
	`zÂm_ícode_rouã
 (
de°
, 
rib
, (*Ë
d©a
, 
buf_íd
 - data);

967 
	`as£π
 (
d©a_Àn
);

968 i‡(
d©a_Àn
)

970 
msg_Àn
 = 
	`Âm_d©a_Àn_to_msg_Àn
 (
d©a_Àn
);

971 
hdr
->
msg_Àn
 = 
	`ht⁄s
 (msg_len);

972 
	`°ªam_f‹w¨d_ídp
 (
s
, 
msg_Àn
);

974 i‡(
is_add
)

975 
zÂm_g
->
°©s
.
rouã_adds
++;

977 
zÂm_g
->
°©s
.
rouã_dñs
++;

984 
	`UNSET_FLAG
 (
de°
->
Êags
, 
RIB_DEST_UPDATE_FPM
);

985 
	`TAILQ_REMOVE
 (&
zÂm_g
->
de°_q
, 
de°
, 
Âm_q_íåõs
);

987 i‡(
is_add
)

989 
	`SET_FLAG
 (
de°
->
Êags
, 
RIB_DEST_SENT_TO_FPM
);

993 
	`UNSET_FLAG
 (
de°
->
Êags
, 
RIB_DEST_SENT_TO_FPM
);

999 i‡(
	`rib_gc_de°
 (
de°
->
∫ode
))

1000 
zÂm_g
->
°©s
.
de°s_dñ_a·î_upd©e
++;

1004 
	}
}

1010 
	$zÂm_wrôe_cb
 (
thªad
 *thread)

1012 
°ªam
 *
s
;

1013 
num_wrôes
;

1015 
zÂm_g
->
°©s
.
wrôe_cb_ˇŒs
++;

1016 
	`as£π
 (
zÂm_g
->
t_wrôe
);

1017 
zÂm_g
->
t_wrôe
 = 
NULL
;

1022 i‡(
zÂm_g
->
°©e
 =
ZFPM_STATE_CONNECTING
)

1024 
	`zÂm_c⁄√˘_check
 ();

1028 
	`as£π
 (
zÂm_g
->
°©e
 =
ZFPM_STATE_ESTABLISHED
);

1029 
	`as£π
 (
zÂm_g
->
sock
 >= 0);

1031 
num_wrôes
 = 0;

1035 
byãs_to_wrôe
, 
byãs_wrôãn
;

1037 
s
 = 
zÂm_g
->
obuf
;

1042 i‡(
	`°ªam_em±y
 (
s
))

1044 
	`zÂm_buûd_upd©es
 ();

1047 
byãs_to_wrôe
 = 
	`°ªam_gë_ídp
 (
s
Ë- 
	`°ªam_gë_gëp
 (s);

1048 i‡(!
byãs_to_wrôe
)

1051 
byãs_wrôãn
 = 
	`wrôe
 (
zÂm_g
->
sock
, 
	`STREAM_PNT
 (
s
), 
byãs_to_wrôe
);

1052 
zÂm_g
->
°©s
.
wrôe_ˇŒs
++;

1053 
num_wrôes
++;

1055 i‡(
byãs_wrôãn
 < 0)

1057 i‡(
	`ERRNO_IO_RETRY
 (
î∫o
))

1060 
	`zÂm_c⁄√˘i⁄_down
 ("failedÅo writeÅo socket");

1064 i‡(
byãs_wrôãn
 !
byãs_to_wrôe
)

1070 
	`°ªam_f‹w¨d_gëp
 (
s
, 
byãs_wrôãn
);

1071 
zÂm_g
->
°©s
.
∑πül_wrôes
++;

1078 
	`°ªam_ª£t
 (
s
);

1080 i‡(
num_wrôes
 >
ZFPM_MAX_WRITES_PER_RUN
)

1082 
zÂm_g
->
°©s
.
max_wrôes_hô
++;

1086 i‡(
	`zÂm_thªad_should_yõld
 (
thªad
))

1088 
zÂm_g
->
°©s
.
t_wrôe_yõlds
++;

1093 i‡(
	`zÂm_wrôes_≥ndög
 ())

1094 
	`zÂm_wrôe_⁄
 ();

1097 
	}
}

1103 
	$zÂm_c⁄√˘_cb
 (
thªad
 *
t
)

1105 
sock
, 
ªt
;

1106 
sockaddr_ö
 
£rv
;

1108 
	`as£π
 (
zÂm_g
->
t_c⁄√˘
);

1109 
zÂm_g
->
t_c⁄√˘
 = 
NULL
;

1110 
	`as£π
 (
zÂm_g
->
°©e
 =
ZFPM_STATE_ACTIVE
);

1112 
sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_STREAM
, 0);

1113 i‡(
sock
 < 0)

1115 
	`zÂm_debug
 ("FaûedÅÿ¸óã sockë f‹ c⁄√˘(): %s", 
	`°ªº‹
(
î∫o
));

1116 
zÂm_g
->
°©s
.
c⁄√˘_no_sock
++;

1120 
	`£t_n⁄blockög
(
sock
);

1123 
	`mem£t
 (&
£rv
, 0,  (serv));

1124 
£rv
.
sö_Ámûy
 = 
AF_INET
;

1125 
£rv
.
sö_p‹t
 = 
	`ht⁄s
 (
zÂm_g
->
Âm_p‹t
);

1126 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


1127 
£rv
.
sö_Àn
 =  (
sockaddr_ö
);

1129 
£rv
.
sö_addr
.
s_addr
 = 
	`ht⁄l
 (
INADDR_LOOPBACK
);

1134 
zÂm_g
->
c⁄√˘_ˇŒs
++;

1135 
zÂm_g
->
°©s
.
c⁄√˘_ˇŒs
++;

1136 
zÂm_g
->
œ°_c⁄√˘_ˇŒ_time
 = 
	`zÂm_gë_time
 ();

1138 
ªt
 = 
	`c⁄√˘
 (
sock
, (
sockaddr
 *Ë&
£rv
,  (serv));

1139 i‡(
ªt
 >= 0)

1141 
zÂm_g
->
sock
 = sock;

1142 
	`zÂm_c⁄√˘i⁄_up
 ("connect succeeded");

1146 i‡(
î∫o
 =
EINPROGRESS
)

1148 
zÂm_g
->
sock
 = sock;

1149 
	`zÂm_ªad_⁄
 ();

1150 
	`zÂm_wrôe_⁄
 ();

1151 
	`zÂm_£t_°©e
 (
ZFPM_STATE_CONNECTING
, "async connect inÖrogress");

1155 
	`zlog_öfo
 ("ˇn'àc⁄√˘ÅÿFPM %d: %s", 
sock
, 
	`ß„_°ªº‹
 (
î∫o
));

1156 
	`˛o£
 (
sock
);

1161 
	`zÂm_°¨t_c⁄√˘_timî
 ("connect() failed");

1163 
	}
}

1171 
	$zÂm_£t_°©e
 (
zÂm_°©e_t
 
°©e
, c⁄° *
ªas⁄
)

1173 
zÂm_°©e_t
 
cur_°©e
 = 
zÂm_g
->
°©e
;

1175 i‡(!
ªas⁄
)

1176 
ªas⁄
 = "Unknown";

1178 i‡(
°©e
 =
cur_°©e
)

1181 
	`zÂm_debug
("beginning stateÅransition %s -> %s. Reason: %s",

1182 
	`zÂm_°©e_to_°r
 (
cur_°©e
), zÂm_°©e_to_°∏(
°©e
),

1183 
ªas⁄
);

1185 
°©e
) {

1187 
ZFPM_STATE_IDLE
:

1188 
	`as£π
 (
cur_°©e
 =
ZFPM_STATE_ESTABLISHED
);

1191 
ZFPM_STATE_ACTIVE
:

1192 
	`as£π
 (
cur_°©e
 =
ZFPM_STATE_IDLE
 ||

1193 
cur_°©e
 =
ZFPM_STATE_CONNECTING
);

1194 
	`as£π
 (
zÂm_g
->
t_c⁄√˘
);

1197 
ZFPM_STATE_CONNECTING
:

1198 
	`as£π
 (
zÂm_g
->
sock
);

1199 
	`as£π
 (
cur_°©e
 =
ZFPM_STATE_ACTIVE
);

1200 
	`as£π
 (
zÂm_g
->
t_ªad
);

1201 
	`as£π
 (
zÂm_g
->
t_wrôe
);

1204 
ZFPM_STATE_ESTABLISHED
:

1205 
	`as£π
 (
cur_°©e
 =
ZFPM_STATE_ACTIVE
 ||

1206 
cur_°©e
 =
ZFPM_STATE_CONNECTING
);

1207 
	`as£π
 (
zÂm_g
->
sock
);

1208 
	`as£π
 (
zÂm_g
->
t_ªad
);

1209 
	`as£π
 (
zÂm_g
->
t_wrôe
);

1213 
zÂm_g
->
°©e
 = state;

1214 
	}
}

1223 
	$zÂm_ˇlc_c⁄√˘_dñay
 ()

1225 
time_t
 
ñ≠£d
;

1230 i‡(
zÂm_g
->
c⁄√˘_ˇŒs
 == 0)

1235 
ñ≠£d
 = 
	`zÂm_gë_ñ≠£d_time
 (
zÂm_g
->
œ°_c⁄√˘_ˇŒ_time
);

1237 i‡(
ñ≠£d
 > 
ZFPM_CONNECT_RETRY_IVL
) {

1241  
ZFPM_CONNECT_RETRY_IVL
 - 
ñ≠£d
;

1242 
	}
}

1248 
	$zÂm_°¨t_c⁄√˘_timî
 (c⁄° *
ªas⁄
)

1250 
dñay_£cs
;

1252 
	`as£π
 (!
zÂm_g
->
t_c⁄√˘
);

1253 
	`as£π
 (
zÂm_g
->
sock
 < 0);

1255 
	`as£π
(
zÂm_g
->
°©e
 =
ZFPM_STATE_IDLE
 ||

1256 
zÂm_g
->
°©e
 =
ZFPM_STATE_ACTIVE
 ||

1257 
zÂm_g
->
°©e
 =
ZFPM_STATE_CONNECTING
);

1259 
dñay_£cs
 = 
	`zÂm_ˇlc_c⁄√˘_dñay
();

1260 
	`zÂm_debug
 ("schedulög c⁄√˘ i¿%ld sec⁄ds", 
dñay_£cs
);

1262 
	`THREAD_TIMER_ON
 (
zÂm_g
->
ma°î
, zÂm_g->
t_c⁄√˘
, 
zÂm_c⁄√˘_cb
, 0,

1263 
dñay_£cs
);

1264 
	`zÂm_£t_°©e
 (
ZFPM_STATE_ACTIVE
, 
ªas⁄
);

1265 
	}
}

1272 
ölöe
 

1273 
	$zÂm_is_íabÀd
 ()

1275  
zÂm_g
->
íabÀd
;

1276 
	}
}

1283 
ölöe
 

1284 
	$zÂm_c⁄n_is_up
 ()

1286 i‡(
zÂm_g
->
°©e
 !
ZFPM_STATE_ESTABLISHED
)

1289 
	`as£π
 (
zÂm_g
->
sock
 >= 0);

1292 
	}
}

1301 
	$zÂm_åiggî_upd©e
 (
rouã_node
 *
∫
, c⁄° *
ªas⁄
)

1303 
rib_de°_t
 *
de°
;

1304 
buf
[
INET6_ADDRSTRLEN
];

1310 i‡(!
	`zÂm_c⁄n_is_up
 ())

1313 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫
);

1319 i‡(!
	`zÂm_is_èbÀ_f‹_Âm
 (
	`rib_de°_èbÀ
 (
de°
)))

1321 
zÂm_g
->
°©s
.
n⁄_Âm_èbÀ_åiggîs
++;

1325 i‡(
	`CHECK_FLAG
 (
de°
->
Êags
, 
RIB_DEST_UPDATE_FPM
)) {

1326 
zÂm_g
->
°©s
.
ªdund™t_åiggîs
++;

1330 i‡(
ªas⁄
)

1332 
	`zÂm_debug
 ("%s/%dÅriggering updateÅo FPM - Reason: %s",

1333 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
,  (buf)),

1334 
∫
->
p
.
¥efixÀn
, 
ªas⁄
);

1337 
	`SET_FLAG
 (
de°
->
Êags
, 
RIB_DEST_UPDATE_FPM
);

1338 
	`TAILQ_INSERT_TAIL
 (&
zÂm_g
->
de°_q
, 
de°
, 
Âm_q_íåõs
);

1339 
zÂm_g
->
°©s
.
upd©es_åiggîed
++;

1344 i‡(
zÂm_g
->
t_wrôe
)

1347 
	`zÂm_wrôe_⁄
 ();

1348 
	}
}

1354 
	$zÂm_°©s_timî_cb
 (
thªad
 *
t
)

1356 
	`as£π
 (
zÂm_g
->
t_°©s
);

1357 
zÂm_g
->
t_°©s
 = 
NULL
;

1363 
	`zÂm_°©s_c›y
 (&
zÂm_g
->
°©s
, &zÂm_g->
œ°_ivl_°©s
);

1368 
	`zÂm_°©s_compo£
 (&
zÂm_g
->
cumuœtive_°©s
, &zÂm_g->
°©s
,

1369 &
zÂm_g
->
cumuœtive_°©s
);

1374 
	`zÂm_°©s_ª£t
 (&
zÂm_g
->
°©s
);

1376 
	`zÂm_°¨t_°©s_timî
 ();

1379 
	}
}

1385 
	$zÂm_°›_°©s_timî
 ()

1387 i‡(!
zÂm_g
->
t_°©s
)

1390 
	`zÂm_debug
 ("StoppingÉxisting statsÅimer");

1391 
	`THREAD_TIMER_OFF
 (
zÂm_g
->
t_°©s
);

1392 
	}
}

1398 
	$zÂm_°¨t_°©s_timî
 ()

1400 
	`as£π
 (!
zÂm_g
->
t_°©s
);

1402 
	`THREAD_TIMER_ON
 (
zÂm_g
->
ma°î
, zÂm_g->
t_°©s
, 
zÂm_°©s_timî_cb
, 0,

1403 
ZFPM_STATS_IVL_SECS
);

1404 
	}
}

1409 
	#ZFPM_SHOW_STAT
(
cou¡î
) \

1411 
	`vty_out
 (
vty
, "%-40†%10lu %16lu%s", #cou¡î, 
tŸÆ_°©s
.
cou¡î
, \

1412 
zÂm_g
->
œ°_ivl_°©s
.
cou¡î
, 
VTY_NEWLINE
); \

1413 } 0)

	)

1419 
	$zÂm_show_°©s
 (
vty
 *vty)

1421 
zÂm_°©s_t
 
tŸÆ_°©s
;

1422 
time_t
 
ñ≠£d
;

1424 
	`vty_out
 (
vty
, "%s%-40†%10† La° %2d secs%s%s", 
VTY_NEWLINE
, "Counter",

1425 "TŸÆ", 
ZFPM_STATS_IVL_SECS
, 
VTY_NEWLINE
, VTY_NEWLINE);

1430 
	`zÂm_°©s_compo£
 (&
zÂm_g
->
cumuœtive_°©s
, &zÂm_g->
°©s
,

1431 &
tŸÆ_°©s
);

1433 
	`ZFPM_SHOW_STAT
 (
c⁄√˘_ˇŒs
);

1434 
	`ZFPM_SHOW_STAT
 (
c⁄√˘_no_sock
);

1435 
	`ZFPM_SHOW_STAT
 (
ªad_cb_ˇŒs
);

1436 
	`ZFPM_SHOW_STAT
 (
wrôe_cb_ˇŒs
);

1437 
	`ZFPM_SHOW_STAT
 (
wrôe_ˇŒs
);

1438 
	`ZFPM_SHOW_STAT
 (
∑πül_wrôes
);

1439 
	`ZFPM_SHOW_STAT
 (
max_wrôes_hô
);

1440 
	`ZFPM_SHOW_STAT
 (
t_wrôe_yõlds
);

1441 
	`ZFPM_SHOW_STAT
 (
n›_dñëes_skù≥d
);

1442 
	`ZFPM_SHOW_STAT
 (
rouã_adds
);

1443 
	`ZFPM_SHOW_STAT
 (
rouã_dñs
);

1444 
	`ZFPM_SHOW_STAT
 (
upd©es_åiggîed
);

1445 
	`ZFPM_SHOW_STAT
 (
n⁄_Âm_èbÀ_åiggîs
);

1446 
	`ZFPM_SHOW_STAT
 (
ªdund™t_åiggîs
);

1447 
	`ZFPM_SHOW_STAT
 (
de°s_dñ_a·î_upd©e
);

1448 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_down_°¨ts
);

1449 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_down_de°s_¥o˚s£d
);

1450 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_down_yõlds
);

1451 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_down_föishes
);

1452 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_up_°¨ts
);

1453 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_up_de°s_¥o˚s£d
);

1454 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_up_yõlds
);

1455 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_up_ab‹ts
);

1456 
	`ZFPM_SHOW_STAT
 (
t_c⁄n_up_föishes
);

1458 i‡(!
zÂm_g
->
œ°_°©s_˛ór_time
)

1461 
ñ≠£d
 = 
	`zÂm_gë_ñ≠£d_time
 (
zÂm_g
->
œ°_°©s_˛ór_time
);

1463 
	`vty_out
 (
vty
, "%sSèt†wîê˛óªd %lu sec⁄d†ago%s", 
VTY_NEWLINE
,

1464 (Ë
ñ≠£d
, 
VTY_NEWLINE
);

1465 
	}
}

1471 
	$zÂm_˛ór_°©s
 (
vty
 *vty)

1473 i‡(!
	`zÂm_is_íabÀd
 ())

1475 
	`vty_out
 (
vty
, "ThêFPM moduÀ i†nŸÉ«bÀd...%s", 
VTY_NEWLINE
);

1479 
	`zÂm_°©s_ª£t
 (&
zÂm_g
->
°©s
);

1480 
	`zÂm_°©s_ª£t
 (&
zÂm_g
->
œ°_ivl_°©s
);

1481 
	`zÂm_°©s_ª£t
 (&
zÂm_g
->
cumuœtive_°©s
);

1483 
	`zÂm_°›_°©s_timî
 ();

1484 
	`zÂm_°¨t_°©s_timî
 ();

1486 
zÂm_g
->
œ°_°©s_˛ór_time
 = 
	`zÂm_gë_time
();

1488 
	`vty_out
 (
vty
, "CÀ¨ed FPM sèts%s", 
VTY_NEWLINE
);

1489 
	}
}

1494 
DEFUN
 (
show_zebø_Âm_°©s
,

1495 
show_zebø_Âm_°©s_cmd
,

1497 
SHOW_STR


1502 
zÂm_show_°©s
 (
vty
);

1503  
	gCMD_SUCCESS
;

1509 
DEFUN
 (
˛ór_zebø_Âm_°©s
,

1510 
˛ór_zebø_Âm_°©s_cmd
,

1512 
CLEAR_STR


1517 
zÂm_˛ór_°©s
 (
vty
);

1518  
	gCMD_SUCCESS
;

1532 
	$zÂm_öô
 (
thªad_ma°î
 *
ma°î
, 
íabÀ
, 
uöt16_t
 
p‹t
)

1534 
öôülized
 = 0;

1536 i‡(
öôülized
) {

1540 
öôülized
 = 1;

1542 
	`mem£t
 (
zÂm_g
, 0,  (*zfpm_g));

1543 
zÂm_g
->
ma°î
 = master;

1544 
	`TAILQ_INIT
(&
zÂm_g
->
de°_q
);

1545 
zÂm_g
->
sock
 = -1;

1546 
zÂm_g
->
°©e
 = 
ZFPM_STATE_IDLE
;

1552 #i‚de‡
HAVE_NETLINK


1553 
íabÀ
 = 0;

1556 
zÂm_g
->
íabÀd
 = 
íabÀ
;

1558 
	`zÂm_°©s_öô
 (&
zÂm_g
->
°©s
);

1559 
	`zÂm_°©s_öô
 (&
zÂm_g
->
œ°_ivl_°©s
);

1560 
	`zÂm_°©s_öô
 (&
zÂm_g
->
cumuœtive_°©s
);

1562 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_zebø_Âm_°©s_cmd
);

1563 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
˛ór_zebø_Âm_°©s_cmd
);

1565 i‡(!
íabÀ
) {

1569 i‡(!
p‹t
)

1570 
p‹t
 = 
FPM_DEFAULT_PORT
;

1572 
zÂm_g
->
Âm_p‹t
 = 
p‹t
;

1574 
zÂm_g
->
obuf
 = 
	`°ªam_√w
 (
ZFPM_OBUF_SIZE
);

1575 
zÂm_g
->
ibuf
 = 
	`°ªam_√w
 (
ZFPM_IBUF_SIZE
);

1577 
	`zÂm_°¨t_°©s_timî
 ();

1578 
	`zÂm_°¨t_c⁄√˘_timî
 ("initialized");

1581 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm.h

25 #i‚de‡
_ZEBRA_FPM_H


26 
	#_ZEBRA_FPM_H


	)

31 
zÂm_öô
 (
thªad_ma°î
 *
ma°î
, 
íabÀ
, 
uöt16_t
 
p‹t
);

32 
zÂm_åiggî_upd©e
 (
rouã_node
 *
∫
, c⁄° *
ªas⁄
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm_netlink.c

26 
	~<zebø.h
>

28 
	~"log.h
"

29 
	~"rib.h
"

31 
	~"π_√éök.h
"

33 
	~"zebø_Âm_¥iv©e.h
"

40 
ölöe
 const *

41 
	$addr_to_a
 (
u_ch¨
 
af
, *
addr
)

43 i‡(!
addr
)

46 
af
)

49 
AF_INET
:

50  
	`öë_¡ﬂ
 (*((
ö_addr
 *Ë
addr
));

52 #ifde‡
HAVE_IPV6


53 
AF_INET6
:

54  
	`öë6_¡ﬂ
 (*((
ö6_addr
 *Ë
addr
));

60 
	}
}

69 
	$¥efix_addr_to_a
 (
¥efix
 *prefix)

71 i‡(!
¥efix
)

74  
	`addr_to_a
 (
¥efix
->
Ámûy
, &¥efix->
u
.prefix);

75 
	}
}

82 
size_t


83 
	$af_addr_size
 (
u_ch¨
 
af
)

85 
af
)

88 
AF_INET
:

91 #ifde‡
HAVE_IPV6


92 
AF_INET6
:

97 
	`as£π
(0);

100 
	}
}

109 
	s√éök_nh_öfo_t_


111 
uöt32_t
 
	mif_ödex
;

112 
g_addr
 *
	mg©eway
;

118 
	mªcursive
;

119 
√xth›_ty≥s_t
 
	mty≥
;

120 } 
	t√éök_nh_öfo_t
;

127 
	s√éök_rouã_öfo_t_


129 
uöt16_t
 
	m∆msg_ty≥
;

130 
u_ch¨
 
	mπm_ty≥
;

131 
uöt32_t
 
	mπm_èbÀ
;

132 
u_ch¨
 
	mπm_¥Ÿocﬁ
;

133 
u_ch¨
 
	maf
;

134 
¥efix
 *
	m¥efix
;

135 
uöt32_t
 *
	mmëric
;

136 
	mnum_nhs
;

142 
√éök_nh_öfo_t
 
	mnhs
[
MAX
 (
MULTIPATH_NUM
, 64)];

143 
g_addr
 *
	m¥ef_§c
;

144 } 
	t√éök_rouã_öfo_t
;

155 
	$√éök_rouã_öfo_add_nh
 (
√éök_rouã_öfo_t
 *
ri
, 
√xth›
 *nexthop)

157 
√éök_nh_öfo_t
 
nhi
;

158 
g_addr
 *
§c
;

160 
	`mem£t
 (&
nhi
, 0,  (nhi));

161 
§c
 = 
NULL
;

163 i‡(
ri
->
num_nhs
 >(Ë
	`ZEBRA_NUM_OF
 (ri->
nhs
))

166 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

168 
nhi
.
ªcursive
 = 1;

169 
nhi
.
ty≥
 = 
√xth›
->
πy≥
;

170 
nhi
.
if_ödex
 = 
√xth›
->
rifödex
;

172 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4


173 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

175 
nhi
.
g©eway
 = &
√xth›
->
rg©e
;

176 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

177 
§c
 = &
√xth›
->src;

180 #ifde‡
HAVE_IPV6


181 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6


182 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX


183 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

185 
nhi
.
g©eway
 = &
√xth›
->
rg©e
;

189 i‡(
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFINDEX


190 || 
√xth›
->
πy≥
 =
NEXTHOP_TYPE_IFNAME
)

192 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

193 
§c
 = &
√xth›
->src;

196 
d⁄e
;

199 
nhi
.
ªcursive
 = 0;

200 
nhi
.
ty≥
 = 
√xth›
->type;

201 
nhi
.
if_ödex
 = 
√xth›
->
ifödex
;

203 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4


204 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

206 
nhi
.
g©eway
 = &
√xth›
->
g©e
;

207 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

208 
§c
 = &
√xth›
->src;

211 #ifde‡
HAVE_IPV6


212 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6


213 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


214 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX
)

216 
nhi
.
g©eway
 = &
√xth›
->
g©e
;

220 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


221 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME
)

223 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

224 
§c
 = &
√xth›
->src;

231 
d⁄e
:

232 i‡(!
nhi
.
g©eway
 &&Çhi.
if_ödex
 == 0)

238 
ri
->
nhs
[ri->
num_nhs
] = 
nhi
;

239 
ri
->
num_nhs
++;

241 i‡(
§c
 && !
ri
->
¥ef_§c
)

242 
ri
->
¥ef_§c
 = 
§c
;

245 
	}
}

250 
u_ch¨


251 
	$√éök_¥Ÿo_‰om_rouã_ty≥
 (
ty≥
)

253 
ty≥
)

255 
ZEBRA_ROUTE_KERNEL
:

256 
ZEBRA_ROUTE_CONNECT
:

257  
RTPROT_KERNEL
;

260  
RTPROT_ZEBRA
;

262 
	}
}

272 
	$√éök_rouã_öfo_fûl
 (
√éök_rouã_öfo_t
 *
ri
, 
cmd
,

273 
rib_de°_t
 *
de°
, 
rib
 *rib)

275 
√xth›
 *√xth› = 
NULL
;

276 
disˇrd
;

278 
	`mem£t
 (
ri
, 0,  (*ri));

280 
ri
->
¥efix
 = 
	`rib_de°_¥efix
 (
de°
);

281 
ri
->
af
 = 
	`rib_de°_af
 (
de°
);

283 
ri
->
∆msg_ty≥
 = 
cmd
;

284 
ri
->
πm_èbÀ
 = 
	`rib_de°_vrf
 (
de°
)->
id
;

285 
ri
->
πm_¥Ÿocﬁ
 = 
RTPROT_UNSPEC
;

291 i‡(
cmd
 =
RTM_DELROUTE
 && !
rib
)

292 
skù
;

294 i‡(
rib
)

295 
ri
->
πm_¥Ÿocﬁ
 = 
	`√éök_¥Ÿo_‰om_rouã_ty≥
 (
rib
->
ty≥
);

297 i‡((
rib
->
Êags
 & 
ZEBRA_FLAG_BLACKHOLE
Ë|| (rib->Êag†& 
ZEBRA_FLAG_REJECT
))

298 
disˇrd
 = 1;

300 
disˇrd
 = 0;

302 i‡(
cmd
 =
RTM_NEWROUTE
)

304 i‡(
disˇrd
)

306 i‡(
rib
->
Êags
 & 
ZEBRA_FLAG_BLACKHOLE
)

307 
ri
->
πm_ty≥
 = 
RTN_BLACKHOLE
;

308 i‡(
rib
->
Êags
 & 
ZEBRA_FLAG_REJECT
)

309 
ri
->
πm_ty≥
 = 
RTN_UNREACHABLE
;

311 
	`as£π
 (0);

314 
ri
->
πm_ty≥
 = 
RTN_UNICAST
;

317 
ri
->
mëric
 = &
rib
->metric;

319 i‡(
disˇrd
)

321 
skù
;

325 i‡(
rib
->
√xth›_a˘ive_num
 =1 || 
MULTIPATH_NUM
 == 1)

327 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

330 i‡((
cmd
 =
RTM_NEWROUTE


331 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

332 || (
cmd
 =
RTM_DELROUTE


333 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)))

335 
	`√éök_rouã_öfo_add_nh
 (
ri
, 
√xth›
);

342 
√xth›
 = 
rib
->nexthop;

343 
√xth›
 && (
MULTIPATH_NUM
 =0 || 
ri
->
num_nhs
 < MULTIPATH_NUM);

344 
√xth›
 =Çexth›->
√xt
)

346 i‡((
cmd
 =
RTM_NEWROUTE


347 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

348 || (
cmd
 =
RTM_DELROUTE


349 && 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)))

351 
	`√éök_rouã_öfo_add_nh
 (
ri
, 
√xth›
);

357 i‡(
ri
->
num_nhs
 == 0)

359 
	`zÂm_debug
 ("netlink_encode_route(): No usefulÇexthop.");

363 
skù
:

365 
	}
}

374 
	$√éök_rouã_öfo_ícode
 (
√éök_rouã_öfo_t
 *
ri
, *
ö_buf
,

375 
size_t
 
ö_buf_Àn
)

377 
byãÀn
;

378 
√xth›_num
 = 0;

379 
size_t
 
buf_off£t
;

380 
√éök_nh_öfo_t
 *
nhi
;

384 
∆msghdr
 
n
;

385 
πmsg
 
r
;

386 
buf
[1];

387 } *
ªq
;

389 
ªq
 = (*Ë
ö_buf
;

391 
buf_off£t
 = ((*Ë
ªq
->
buf
) - ((*)Ñeq);

393 i‡(
ö_buf_Àn
 < 
buf_off£t
) {

394 
	`as£π
(0);

398 
	`mem£t
 (
ªq
, 0, 
buf_off£t
);

400 
byãÀn
 = 
	`af_addr_size
 (
ri
->
af
);

402 
ªq
->
n
.
∆msg_Àn
 = 
	`NLMSG_LENGTH
 ( (
πmsg
));

403 
ªq
->
n
.
∆msg_Êags
 = 
NLM_F_CREATE
 | 
NLM_F_REQUEST
;

404 
ªq
->
n
.
∆msg_ty≥
 = 
ri
->nlmsg_type;

405 
ªq
->
r
.
πm_Ámûy
 = 
ri
->
af
;

406 
ªq
->
r
.
πm_èbÀ
 = 
ri
->rtm_table;

407 
ªq
->
r
.
πm_d°_Àn
 = 
ri
->
¥efix
->
¥efixÀn
;

408 
ªq
->
r
.
πm_¥Ÿocﬁ
 = 
ri
->rtm_protocol;

409 
ªq
->
r
.
πm_sc›e
 = 
RT_SCOPE_UNIVERSE
;

411 
	`add©å_l
 (&
ªq
->
n
, 
ö_buf_Àn
, 
RTA_DST
, &
ri
->
¥efix
->
u
.¥efix, 
byãÀn
);

413 
ªq
->
r
.
πm_ty≥
 = 
ri
->rtm_type;

416 i‡(
ri
->
mëric
)

417 
	`add©å32
 (&
ªq
->
n
, 
ö_buf_Àn
, 
RTA_PRIORITY
, *
ri
->
mëric
);

419 i‡(
ri
->
num_nhs
 == 0)

420 
d⁄e
;

422 i‡(
ri
->
num_nhs
 == 1)

424 
nhi
 = &
ri
->
nhs
[0];

426 i‡(
nhi
->
g©eway
)

428 
	`add©å_l
 (&
ªq
->
n
, 
ö_buf_Àn
, 
RTA_GATEWAY
, 
nhi
->
g©eway
,

429 
byãÀn
);

432 i‡(
nhi
->
if_ödex
)

434 
	`add©å32
 (&
ªq
->
n
, 
ö_buf_Àn
, 
RTA_OIF
, 
nhi
->
if_ödex
);

437 
d⁄e
;

444 
buf
[
NL_PKT_BUF_SIZE
];

445 
π©å
 *
πa
 = (*Ë
buf
;

446 
π√xth›
 *
πnh
;

448 
πa
->
πa_ty≥
 = 
RTA_MULTIPATH
;

449 
πa
->
πa_Àn
 = 
	`RTA_LENGTH
 (0);

450 
πnh
 = 
	`RTA_DATA
 (
πa
);

452 
√xth›_num
 = 0;Çexth›_num < 
ri
->
num_nhs
;Çexthop_num++)

454 
nhi
 = &
ri
->
nhs
[
√xth›_num
];

456 
πnh
->
πnh_Àn
 =  (*rtnh);

457 
πnh
->
πnh_Êags
 = 0;

458 
πnh
->
πnh_h›s
 = 0;

459 
πnh
->
πnh_ifödex
 = 0;

460 
πa
->
πa_Àn
 +
πnh
->
πnh_Àn
;

462 i‡(
nhi
->
g©eway
)

464 
	`πa_add©å_l
 (
πa
,  (
buf
), 
RTA_GATEWAY
, 
nhi
->
g©eway
, 
byãÀn
);

465 
πnh
->
πnh_Àn
 + (
π©å
Ë+ 
byãÀn
;

468 i‡(
nhi
->
if_ödex
)

470 
πnh
->
πnh_ifödex
 = 
nhi
->
if_ödex
;

473 
πnh
 = 
	`RTNH_NEXT
 (rtnh);

476 
	`as£π
 (
πa
->
πa_Àn
 > 
	`RTA_LENGTH
 (0));

477 
	`add©å_l
 (&
ªq
->
n
, 
ö_buf_Àn
, 
RTA_MULTIPATH
, 
	`RTA_DATA
 (
πa
),

478 
	`RTA_PAYLOAD
 (
πa
));

480 
d⁄e
:

482 i‡(
ri
->
¥ef_§c
)

484 
	`add©å_l
 (&
ªq
->
n
, 
ö_buf_Àn
, 
RTA_PREFSRC
, &
ri
->
¥ef_§c
, 
byãÀn
);

487 
	`as£π
 (
ªq
->
n
.
∆msg_Àn
 < 
ö_buf_Àn
);

488  
ªq
->
n
.
∆msg_Àn
;

489 
	}
}

497 
	$zÂm_log_rouã_öfo
 (
√éök_rouã_öfo_t
 *
ri
, c⁄° *
œbñ
)

499 
√éök_nh_öfo_t
 *
nhi
;

500 
i
;

502 
	`zÂm_debug
 ("%†: %†%s/%d, PrŸo: %s, Mëric: %u", 
œbñ
,

503 
	`∆_msg_ty≥_to_°r
 (
ri
->
∆msg_ty≥
),

504 
	`¥efix_addr_to_a
 (
ri
->
¥efix
),Ñi->¥efix->
¥efixÀn
,

505 
	`∆_π¥Ÿo_to_°r
 (
ri
->
πm_¥Ÿocﬁ
),

506 
ri
->
mëric
 ? *ri->metric : 0);

508 
i
 = 0; i < 
ri
->
num_nhs
; i++)

510 
nhi
 = &
ri
->
nhs
[
i
];

511 
	`zÂm_debug
(" Intf: %u, Gateway: %s, Recursive: %s, Type: %s",

512 
nhi
->
if_ödex
, 
	`addr_to_a
 (
ri
->
af
,Çhi->
g©eway
),

513 
nhi
->
ªcursive
 ? "yes" : "no",

514 
	`√xth›_ty≥_to_°r
 (
nhi
->
ty≥
));

516 
	}
}

528 
	$zÂm_√éök_ícode_rouã
 (
cmd
, 
rib_de°_t
 *
de°
, 
rib
 *rib,

529 *
ö_buf
, 
size_t
 
ö_buf_Àn
)

531 
√éök_rouã_öfo_t
 
ri_•a˚
, *
ri
;

533 
ri
 = &
ri_•a˚
;

535 i‡(!
	`√éök_rouã_öfo_fûl
 (
ri
, 
cmd
, 
de°
, 
rib
))

538 
	`zÂm_log_rouã_öfo
 (
ri
, 
__FUNCTION__
);

540  
	`√éök_rouã_öfo_ícode
 (
ri
, 
ö_buf
, 
ö_buf_Àn
);

541 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm_private.h

25 #i‚de‡
_ZEBRA_FPM_PRIVATE_H


26 
	#_ZEBRA_FPM_PRIVATE_H


	)

28 
	~"zebø/debug.h
"

30 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

32 
	#zÂm_debug
(...) \

34 i‡(
IS_ZEBRA_DEBUG_FPM
Ë
	`zlog_debug
("FPM: " 
__VA_ARGS__
); \

35 } 0)

	)

37 #ñi‡
deföed
 
__GNUC__


39 
	#zÂm_debug
(
_¨gs
...) \

41 i‡(
IS_ZEBRA_DEBUG_FPM
Ë
	`zlog_debug
("FPM: " 
_¨gs
); \

42 } 0)

	)

45 
ölöe
 
	$zÂm_debug
(c⁄° *
f‹m©
, ...Ë{ ; 
	}
}

53 
zÂm_√éök_ícode_rouã
 (
cmd
, 
rib_de°_t
 *
de°
, 
rib
 *rib,

54 *
ö_buf
, 
size_t
 
ö_buf_Àn
);

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_rib.c

22 
	~<zebø.h
>

24 
	~"¥efix.h
"

25 
	~"èbÀ.h
"

26 
	~"mem‹y.h
"

27 
	~"°r.h
"

28 
	~"comm™d.h
"

29 
	~"if.h
"

30 
	~"log.h
"

31 
	~"sockuni⁄.h
"

32 
	~"lökli°.h
"

33 
	~"thªad.h
"

34 
	~"w‹kqueue.h
"

35 
	~"¥efix.h
"

36 
	~"rouãm≠.h
"

38 
	~"zebø/rib.h
"

39 
	~"zebø/π.h
"

40 
	~"zebø/z£rv.h
"

41 
	~"zebø/ªdi°ribuã.h
"

42 
	~"zebø/debug.h
"

43 
	~"zebø/zebø_Âm.h
"

46 
zebø_t
 
zebød
;

52 
	grib_¥o˚ss_hﬁd_time
 = 10;

57 
	mkey
;

58 
	mdi°™˚
;

59 } 
	grouã_öfo
[
ZEBRA_ROUTE_MAX
] =

61 [
ZEBRA_ROUTE_SYSTEM
] = {ZEBRA_ROUTE_SYSTEM, 0},

62 [
ZEBRA_ROUTE_KERNEL
] = {ZEBRA_ROUTE_KERNEL, 0},

63 [
ZEBRA_ROUTE_CONNECT
] = {ZEBRA_ROUTE_CONNECT, 0},

64 [
ZEBRA_ROUTE_STATIC
] = {ZEBRA_ROUTE_STATIC, 1},

65 [
ZEBRA_ROUTE_RIP
] = {ZEBRA_ROUTE_RIP, 120},

66 [
ZEBRA_ROUTE_RIPNG
] = {ZEBRA_ROUTE_RIPNG, 120},

67 [
ZEBRA_ROUTE_OSPF
] = {ZEBRA_ROUTE_OSPF, 110},

68 [
ZEBRA_ROUTE_OSPF6
] = {ZEBRA_ROUTE_OSPF6, 110},

69 [
ZEBRA_ROUTE_ISIS
] = {ZEBRA_ROUTE_ISIS, 115},

70 [
ZEBRA_ROUTE_BGP
] = {ZEBRA_ROUTE_BGP, 20 },

71 [
ZEBRA_ROUTE_BABEL
] = {ZEBRA_ROUTE_BABEL, 95},

76 
ve˘‹
 
	gvrf_ve˘‹
;

82 
	$vrf_èbÀ_¸óã
 (
vrf
 *vrf, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
)

84 
rib_èbÀ_öfo_t
 *
öfo
;

85 
rouã_èbÀ
 *
èbÀ
;

87 
	`as£π
 (!
vrf
->
èbÀ
[
afi
][
ßfi
]);

89 
èbÀ
 = 
	`rouã_èbÀ_öô
 ();

90 
vrf
->
èbÀ
[
afi
][
ßfi
] =Åable;

92 
öfo
 = 
	`XCALLOC
 (
MTYPE_RIB_TABLE_INFO
,  (*info));

93 
öfo
->
vrf
 = vrf;

94 
öfo
->
afi
 =áfi;

95 
öfo
->
ßfi
 = safi;

96 
èbÀ
->
öfo
 = info;

97 
	}
}

100 
vrf
 *

101 
	$vrf_Æloc
 (c⁄° *
«me
)

103 
vrf
 *vrf;

105 
vrf
 = 
	`XCALLOC
 (
MTYPE_VRF
,  (vrf));

108 i‡(
«me
)

109 
vrf
->
«me
 = 
	`XSTRDUP
 (
MTYPE_VRF_NAME
,Çame);

112 
	`vrf_èbÀ_¸óã
 (
vrf
, 
AFI_IP
, 
SAFI_UNICAST
);

113 
	`vrf_èbÀ_¸óã
 (
vrf
, 
AFI_IP6
, 
SAFI_UNICAST
);

114 
vrf
->
°abÀ
[
AFI_IP
][
SAFI_UNICAST
] = 
	`rouã_èbÀ_öô
 ();

115 
vrf
->
°abÀ
[
AFI_IP6
][
SAFI_UNICAST
] = 
	`rouã_èbÀ_öô
 ();

116 
	`vrf_èbÀ_¸óã
 (
vrf
, 
AFI_IP
, 
SAFI_MULTICAST
);

117 
	`vrf_èbÀ_¸óã
 (
vrf
, 
AFI_IP6
, 
SAFI_MULTICAST
);

118 
vrf
->
°abÀ
[
AFI_IP
][
SAFI_MULTICAST
] = 
	`rouã_èbÀ_öô
 ();

119 
vrf
->
°abÀ
[
AFI_IP6
][
SAFI_MULTICAST
] = 
	`rouã_èbÀ_öô
 ();

122  
vrf
;

123 
	}
}

126 
vrf
 *

127 
	$vrf_lookup
 (
u_öt32_t
 
id
)

129  
	`ve˘‹_lookup
 (
vrf_ve˘‹
, 
id
);

130 
	}
}

134 
	$vrf_öô
 ()

136 
vrf
 *
deÁu…_èbÀ
;

139 
vrf_ve˘‹
 = 
	`ve˘‹_öô
 (1);

142 
deÁu…_èbÀ
 = 
	`vrf_Æloc
 ("Default-IP-Routing-Table");

145 
	`ve˘‹_£t_ödex
 (
vrf_ve˘‹
, 0, 
deÁu…_èbÀ
);

146 
	}
}

149 
rouã_èbÀ
 *

150 
	$vrf_èbÀ
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
id
)

152 
vrf
 *vrf;

154 
vrf
 = 
	`vrf_lookup
 (
id
);

155 i‡(! 
vrf
)

156  
NULL
;

158 if–
afi
 >
AFI_MAX
 || 
ßfi
 >
SAFI_MAX
 )

159  
NULL
;

161  
vrf
->
èbÀ
[
afi
][
ßfi
];

162 
	}
}

165 
rouã_èbÀ
 *

166 
	$vrf_°©ic_èbÀ
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
id
)

168 
vrf
 *vrf;

170 
vrf
 = 
	`vrf_lookup
 (
id
);

171 i‡(! 
vrf
)

172  
NULL
;

174 if–
afi
 >
AFI_MAX
 || 
ßfi
 >
SAFI_MAX
 )

175  
NULL
;

177  
vrf
->
°abÀ
[
afi
][
ßfi
];

178 
	}
}

184 
	$√xth›_ty≥_to_°r
 (
√xth›_ty≥s_t
 
nh_ty≥
)

186 c⁄° *
desc
[] = {

199 i‡(
nh_ty≥
 >
	`ZEBRA_NUM_OF
 (
desc
))

202  
desc
[
nh_ty≥
];

203 
	}
}

207 
	$√xth›_add
 (
rib
 *rib, 
√xth›
 *nexthop)

209 
√xth›
 *
œ°
;

211 
œ°
 = 
rib
->
√xth›
;Üa° &&Üa°->
√xt
;Üast =Üast->next)

213 i‡(
œ°
)

214 
œ°
->
√xt
 = 
√xth›
;

216 
rib
->
√xth›
 =Çexthop;

217 
√xth›
->
¥ev
 = 
œ°
;

219 
rib
->
√xth›_num
++;

220 
	}
}

224 
	$√xth›_dñëe
 (
rib
 *rib, 
√xth›
 *nexthop)

226 i‡(
√xth›
->
√xt
)

227 
√xth›
->
√xt
->
¥ev
 =Çexthop->prev;

228 i‡(
√xth›
->
¥ev
)

229 
√xth›
->
¥ev
->
√xt
 =Çexthop->next;

231 
rib
->
√xth›
 =Çexth›->
√xt
;

232 
rib
->
√xth›_num
--;

233 
	}
}

237 
	$√xth›_‰ì
 (
√xth›
 *nexthop)

239 i‡(
√xth›
->
i‚ame
)

240 
	`XFREE
 (0, 
√xth›
->
i‚ame
);

241 
	`XFREE
 (
MTYPE_NEXTHOP
, 
√xth›
);

242 
	}
}

244 
√xth›
 *

245 
	$√xth›_ifödex_add
 (
rib
 *rib, 
ifödex
)

247 
√xth›
 *nexthop;

249 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

250 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_IFINDEX
;

251 
√xth›
->
ifödex
 = ifindex;

253 
	`√xth›_add
 (
rib
, 
√xth›
);

255  
√xth›
;

256 
	}
}

258 
√xth›
 *

259 
	$√xth›_i‚ame_add
 (
rib
 *rib, *
i‚ame
)

261 
√xth›
 *nexthop;

263 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

264 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_IFNAME
;

265 
√xth›
->
i‚ame
 = 
	`XSTRDUP
 (0, ifname);

267 
	`√xth›_add
 (
rib
, 
√xth›
);

269  
√xth›
;

270 
	}
}

272 
√xth›
 *

273 
	$√xth›_ùv4_add
 (
rib
 *rib, 
ö_addr
 *
ùv4
, ö_add∏*
§c
)

275 
√xth›
 *nexthop;

277 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

278 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_IPV4
;

279 
√xth›
->
g©e
.
ùv4
 = *ipv4;

280 i‡(
§c
)

281 
√xth›
->
§c
.
ùv4
 = *src;

283 
	`√xth›_add
 (
rib
, 
√xth›
);

285  
√xth›
;

286 
	}
}

288 
√xth›
 *

289 
	$√xth›_ùv4_ifödex_add
 (
rib
 *rib, 
ö_addr
 *
ùv4
,

290 
ö_addr
 *
§c
, 
ifödex
)

292 
√xth›
 *nexthop;

294 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

295 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_IPV4_IFINDEX
;

296 
√xth›
->
g©e
.
ùv4
 = *ipv4;

297 i‡(
§c
)

298 
√xth›
->
§c
.
ùv4
 = *src;

299 
√xth›
->
ifödex
 = ifindex;

301 
	`√xth›_add
 (
rib
, 
√xth›
);

303  
√xth›
;

304 
	}
}

306 #ifde‡
HAVE_IPV6


307 
√xth›
 *

308 
	$√xth›_ùv6_add
 (
rib
 *rib, 
ö6_addr
 *
ùv6
)

310 
√xth›
 *nexthop;

312 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

313 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_IPV6
;

314 
√xth›
->
g©e
.
ùv6
 = *ipv6;

316 
	`√xth›_add
 (
rib
, 
√xth›
);

318  
√xth›
;

319 
	}
}

321 
√xth›
 *

322 
	$√xth›_ùv6_i‚ame_add
 (
rib
 *rib, 
ö6_addr
 *
ùv6
,

323 *
i‚ame
)

325 
√xth›
 *nexthop;

327 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

328 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_IPV6_IFNAME
;

329 
√xth›
->
g©e
.
ùv6
 = *ipv6;

330 
√xth›
->
i‚ame
 = 
	`XSTRDUP
 (0, ifname);

332 
	`√xth›_add
 (
rib
, 
√xth›
);

334  
√xth›
;

335 
	}
}

337 
√xth›
 *

338 
	$√xth›_ùv6_ifödex_add
 (
rib
 *rib, 
ö6_addr
 *
ùv6
,

339 
ifödex
)

341 
√xth›
 *nexthop;

343 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

344 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_IPV6_IFINDEX
;

345 
√xth›
->
g©e
.
ùv6
 = *ipv6;

346 
√xth›
->
ifödex
 = ifindex;

348 
	`√xth›_add
 (
rib
, 
√xth›
);

350  
√xth›
;

351 
	}
}

354 
√xth›
 *

355 
	$√xth›_bœckhﬁe_add
 (
rib
 *rib)

357 
√xth›
 *nexthop;

359 
√xth›
 = 
	`XCALLOC
 (
MTYPE_NEXTHOP
,  (nexthop));

360 
√xth›
->
ty≥
 = 
NEXTHOP_TYPE_BLACKHOLE
;

361 
	`SET_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
);

363 
	`√xth›_add
 (
rib
, 
√xth›
);

365  
√xth›
;

366 
	}
}

371 
	$√xth›_a˘ive_ùv4
 (
rib
 *rib, 
√xth›
 *√xth›, 
£t
,

372 
rouã_node
 *
t›
)

374 
¥efix_ùv4
 
p
;

375 
rouã_èbÀ
 *
èbÀ
;

376 
rouã_node
 *
∫
;

377 
rib
 *
m©ch
;

378 
√xth›
 *
√wh›
;

380 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4
)

381 
√xth›
->
ifödex
 = 0;

383 i‡(
£t
)

384 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
);

387 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

388 
p
.
Ámûy
 = 
AF_INET
;

389 
p
.
¥efixÀn
 = 
IPV4_MAX_PREFIXLEN
;

390 
p
.
¥efix
 = 
√xth›
->
g©e
.
ùv4
;

393 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

394 i‡(! 
èbÀ
)

397 
∫
 = 
	`rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

398 
∫
)

400 
	`rouã_u∆ock_node
 (
∫
);

403 i‡(
∫
 =
t›
)

407 
	`RNODE_FOREACH_RIB
 (
∫
, 
m©ch
)

409 i‡(
	`CHECK_FLAG
 (
m©ch
->
°©us
, 
RIB_ENTRY_REMOVED
))

411 i‡(
	`CHECK_FLAG
 (
m©ch
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

417 i‡(! 
m©ch


418 || 
m©ch
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

421 
∫
 =Ñn->
∑ª¡
;

422 } 
∫
 &&Ñn->
öfo
 =
NULL
);

423 i‡(
∫
)

424 
	`rouã_lock_node
 (
∫
);

428 i‡(
m©ch
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

431 
√wh›
 = 
m©ch
->
√xth›
;

432 i‡(
√wh›
 && 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4
)

433 
√xth›
->
ifödex
 = 
√wh›
->ifindex;

437 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_INTERNAL
))

439 
√wh›
 = 
m©ch
->
√xth›
;Çewh›;Çewh› =Çewh›->
√xt
)

440 i‡(
	`CHECK_FLAG
 (
√wh›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

441 && ! 
	`CHECK_FLAG
 (
√wh›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

443 i‡(
£t
)

445 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
);

446 
√xth›
->
πy≥
 = 
√wh›
->
ty≥
;

447 i‡(
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV4
 ||

448 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

449 
√xth›
->
rg©e
.
ùv4
 = 
√wh›
->
g©e
.ipv4;

450 i‡(
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


451 || 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


452 || 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV4_IFINDEX
)

453 
√xth›
->
rifödex
 = 
√wh›
->
ifödex
;

466 
	}
}

468 #ifde‡
HAVE_IPV6


472 
	$√xth›_a˘ive_ùv6
 (
rib
 *rib, 
√xth›
 *√xth›, 
£t
,

473 
rouã_node
 *
t›
)

475 
¥efix_ùv6
 
p
;

476 
rouã_èbÀ
 *
èbÀ
;

477 
rouã_node
 *
∫
;

478 
rib
 *
m©ch
;

479 
√xth›
 *
√wh›
;

481 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6
)

482 
√xth›
->
ifödex
 = 0;

484 i‡(
£t
)

485 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
);

488 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv6
));

489 
p
.
Ámûy
 = 
AF_INET6
;

490 
p
.
¥efixÀn
 = 
IPV6_MAX_PREFIXLEN
;

491 
p
.
¥efix
 = 
√xth›
->
g©e
.
ùv6
;

494 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

495 i‡(! 
èbÀ
)

498 
∫
 = 
	`rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

499 
∫
)

501 
	`rouã_u∆ock_node
 (
∫
);

504 i‡(
∫
 =
t›
)

508 
	`RNODE_FOREACH_RIB
 (
∫
, 
m©ch
)

510 i‡(
	`CHECK_FLAG
 (
m©ch
->
°©us
, 
RIB_ENTRY_REMOVED
))

512 i‡(
	`CHECK_FLAG
 (
m©ch
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

518 i‡(! 
m©ch


519 || 
m©ch
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

522 
∫
 =Ñn->
∑ª¡
;

523 } 
∫
 &&Ñn->
öfo
 =
NULL
);

524 i‡(
∫
)

525 
	`rouã_lock_node
 (
∫
);

529 i‡(
m©ch
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

532 
√wh›
 = 
m©ch
->
√xth›
;

534 i‡(
√wh›
 && 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6
)

535 
√xth›
->
ifödex
 = 
√wh›
->ifindex;

539 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_INTERNAL
))

541 
√wh›
 = 
m©ch
->
√xth›
;Çewh›;Çewh› =Çewh›->
√xt
)

542 i‡(
	`CHECK_FLAG
 (
√wh›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

543 && ! 
	`CHECK_FLAG
 (
√wh›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

545 i‡(
£t
)

547 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
);

548 
√xth›
->
πy≥
 = 
√wh›
->
ty≥
;

549 i‡(
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV6


550 || 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX


551 || 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

552 
√xth›
->
rg©e
.
ùv6
 = 
√wh›
->
g©e
.ipv6;

553 i‡(
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


554 || 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


555 || 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFINDEX


556 || 
√wh›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

557 
√xth›
->
rifödex
 = 
√wh›
->
ifödex
;

570 
	}
}

573 
rib
 *

574 
	$rib_m©ch_ùv4
 (
ö_addr
 
addr
)

576 
¥efix_ùv4
 
p
;

577 
rouã_èbÀ
 *
èbÀ
;

578 
rouã_node
 *
∫
;

579 
rib
 *
m©ch
;

580 
√xth›
 *
√wh›
;

583 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

584 i‡(! 
èbÀ
)

587 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

588 
p
.
Ámûy
 = 
AF_INET
;

589 
p
.
¥efixÀn
 = 
IPV4_MAX_PREFIXLEN
;

590 
p
.
¥efix
 = 
addr
;

592 
∫
 = 
	`rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

594 
∫
)

596 
	`rouã_u∆ock_node
 (
∫
);

599 
	`RNODE_FOREACH_RIB
 (
∫
, 
m©ch
)

601 i‡(
	`CHECK_FLAG
 (
m©ch
->
°©us
, 
RIB_ENTRY_REMOVED
))

603 i‡(
	`CHECK_FLAG
 (
m©ch
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

609 i‡(! 
m©ch


610 || 
m©ch
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

613 
∫
 =Ñn->
∑ª¡
;

614 } 
∫
 &&Ñn->
öfo
 =
NULL
);

615 i‡(
∫
)

616 
	`rouã_lock_node
 (
∫
);

620 i‡(
m©ch
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

622  
m©ch
;

625 
√wh›
 = 
m©ch
->
√xth›
;Çewh›;Çewh› =Çewh›->
√xt
)

626 i‡(
	`CHECK_FLAG
 (
√wh›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

627  
m©ch
;

628  
NULL
;

632  
NULL
;

633 
	}
}

635 
rib
 *

636 
	$rib_lookup_ùv4
 (
¥efix_ùv4
 *
p
)

638 
rouã_èbÀ
 *
èbÀ
;

639 
rouã_node
 *
∫
;

640 
rib
 *
m©ch
;

641 
√xth›
 *nexthop;

644 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

645 i‡(! 
èbÀ
)

648 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *Ë
p
);

651 i‡(! 
∫
)

652  
NULL
;

655 
	`rouã_u∆ock_node
 (
∫
);

657 
	`RNODE_FOREACH_RIB
 (
∫
, 
m©ch
)

659 i‡(
	`CHECK_FLAG
 (
m©ch
->
°©us
, 
RIB_ENTRY_REMOVED
))

661 i‡(
	`CHECK_FLAG
 (
m©ch
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

665 i‡(! 
m©ch
 || m©ch->
ty≥
 =
ZEBRA_ROUTE_BGP
)

666  
NULL
;

668 i‡(
m©ch
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

669  
m©ch
;

671 
√xth›
 = 
m©ch
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

672 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

673  
m©ch
;

675  
NULL
;

676 
	}
}

691 
	$rib_lookup_ùv4_rouã
 (
¥efix_ùv4
 *
p
, 
sockuni⁄
 * 
qg©e
)

693 
rouã_èbÀ
 *
èbÀ
;

694 
rouã_node
 *
∫
;

695 
rib
 *
m©ch
;

696 
√xth›
 *nexthop;

699 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

700 i‡(! 
èbÀ
)

701  
ZEBRA_RIB_LOOKUP_ERROR
;

704 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *Ë
p
);

707 i‡(! 
∫
)

708  
ZEBRA_RIB_NOTFOUND
;

711 
	`rouã_u∆ock_node
 (
∫
);

714 
	`RNODE_FOREACH_RIB
 (
∫
, 
m©ch
)

716 i‡(
	`CHECK_FLAG
 (
m©ch
->
°©us
, 
RIB_ENTRY_REMOVED
))

718 i‡(
	`CHECK_FLAG
 (
m©ch
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

723 i‡(!
m©ch
)

724  
ZEBRA_RIB_NOTFOUND
;

726 i‡(
m©ch
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

727  
ZEBRA_RIB_FOUND_CONNECTED
;

730 
√xth›
 = 
m©ch
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

731 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

734 i‡(
√xth›
->
g©e
.
ùv4
.
s_addr
 =
	`sockuni⁄2ù
 (
qg©e
) ||

735 
√xth›
->
rg©e
.
ùv4
.
s_addr
 =
	`sockuni⁄2ù
 (
qg©e
))

736  
ZEBRA_RIB_FOUND_EXACT
;

739 i‡(
IS_ZEBRA_DEBUG_RIB
)

741 
g©e_buf
[
INET_ADDRSTRLEN
], 
rg©e_buf
[INET_ADDRSTRLEN], 
qg©e_buf
[INET_ADDRSTRLEN];

742 
	`öë_¡›
 (
AF_INET
, &
√xth›
->
g©e
.
ùv4
.
s_addr
, 
g©e_buf
, 
INET_ADDRSTRLEN
);

743 
	`öë_¡›
 (
AF_INET
, &
√xth›
->
rg©e
.
ùv4
.
s_addr
, 
rg©e_buf
, 
INET_ADDRSTRLEN
);

744 
	`öë_¡›
 (
AF_INET
, &
	`sockuni⁄2ù
 (
qg©e
), 
qg©e_buf
, 
INET_ADDRSTRLEN
);

745 
	`zlog_debug
 ("%s: qg©ê=%s, g©ê=%s,Ñg©ê=%s", 
__func__
, 
qg©e_buf
, 
g©e_buf
, 
rg©e_buf
);

747  
ZEBRA_RIB_FOUND_NOGATE
;

751  
ZEBRA_RIB_NOTFOUND
;

752 
	}
}

754 #ifde‡
HAVE_IPV6


755 
rib
 *

756 
	$rib_m©ch_ùv6
 (
ö6_addr
 *
addr
)

758 
¥efix_ùv6
 
p
;

759 
rouã_èbÀ
 *
èbÀ
;

760 
rouã_node
 *
∫
;

761 
rib
 *
m©ch
;

762 
√xth›
 *
√wh›
;

765 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

766 i‡(! 
èbÀ
)

769 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv6
));

770 
p
.
Ámûy
 = 
AF_INET6
;

771 
p
.
¥efixÀn
 = 
IPV6_MAX_PREFIXLEN
;

772 
	`IPV6_ADDR_COPY
 (&
p
.
¥efix
, 
addr
);

774 
∫
 = 
	`rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

776 
∫
)

778 
	`rouã_u∆ock_node
 (
∫
);

781 
	`RNODE_FOREACH_RIB
 (
∫
, 
m©ch
)

783 i‡(
	`CHECK_FLAG
 (
m©ch
->
°©us
, 
RIB_ENTRY_REMOVED
))

785 i‡(
	`CHECK_FLAG
 (
m©ch
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

791 i‡(! 
m©ch


792 || 
m©ch
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

795 
∫
 =Ñn->
∑ª¡
;

796 } 
∫
 &&Ñn->
öfo
 =
NULL
);

797 i‡(
∫
)

798 
	`rouã_lock_node
 (
∫
);

802 i‡(
m©ch
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

804  
m©ch
;

807 
√wh›
 = 
m©ch
->
√xth›
;Çewh›;Çewh› =Çewh›->
√xt
)

808 i‡(
	`CHECK_FLAG
 (
√wh›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

809  
m©ch
;

810  
NULL
;

814  
NULL
;

815 
	}
}

818 
	#RIB_SYSTEM_ROUTE
(
R
) \

819 ((
R
)->
ty≥
 =
ZEBRA_ROUTE_KERNEL
 || (R)->ty≥ =
ZEBRA_ROUTE_CONNECT
)

	)

832 
	$√xth›_a˘ive_check
 (
rouã_node
 *
∫
, 
rib
 *rib,

833 
√xth›
 *√xth›, 
£t
)

835 
öãrÁ˚
 *
iÂ
;

836 
rouã_m≠_ªsu…_t
 
ªt
 = 
RMAP_MATCH
;

837 *
¥Ÿo_rm
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
+1];

838 
rouã_m≠
 *
rm≠
;

839 
Ámûy
;

841 
Ámûy
 = 0;

842 
√xth›
->
ty≥
)

844 
NEXTHOP_TYPE_IFINDEX
:

845 
iÂ
 = 
	`if_lookup_by_ödex
 (
√xth›
->
ifödex
);

846 i‡(
iÂ
 && 
	`if_is_›î©ive
(ifp))

847 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

849 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

851 
NEXTHOP_TYPE_IPV6_IFNAME
:

852 
Ámûy
 = 
AFI_IP6
;

853 
NEXTHOP_TYPE_IFNAME
:

854 
iÂ
 = 
	`if_lookup_by_«me
 (
√xth›
->
i‚ame
);

855 i‡(
iÂ
 && 
	`if_is_›î©ive
(ifp))

857 i‡(
£t
)

858 
√xth›
->
ifödex
 = 
iÂ
->ifindex;

859 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

863 i‡(
£t
)

864 
√xth›
->
ifödex
 = 0;

865 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

868 
NEXTHOP_TYPE_IPV4
:

869 
NEXTHOP_TYPE_IPV4_IFINDEX
:

870 
Ámûy
 = 
AFI_IP
;

871 i‡(
	`√xth›_a˘ive_ùv4
 (
rib
, 
√xth›
, 
£t
, 
∫
))

872 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

874 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

876 #ifde‡
HAVE_IPV6


877 
NEXTHOP_TYPE_IPV6
:

878 
Ámûy
 = 
AFI_IP6
;

879 i‡(
	`√xth›_a˘ive_ùv6
 (
rib
, 
√xth›
, 
£t
, 
∫
))

880 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

882 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

884 
NEXTHOP_TYPE_IPV6_IFINDEX
:

885 
Ámûy
 = 
AFI_IP6
;

886 i‡(
	`IN6_IS_ADDR_LINKLOCAL
 (&
√xth›
->
g©e
.
ùv6
))

888 
iÂ
 = 
	`if_lookup_by_ödex
 (
√xth›
->
ifödex
);

889 i‡(
iÂ
 && 
	`if_is_›î©ive
(ifp))

890 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

892 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

896 i‡(
	`√xth›_a˘ive_ùv6
 (
rib
, 
√xth›
, 
£t
, 
∫
))

897 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

899 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

903 
NEXTHOP_TYPE_BLACKHOLE
:

904 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

909 i‡(! 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

912 i‡(
	`RIB_SYSTEM_ROUTE
(
rib
) ||

913 (
Ámûy
 =
AFI_IP
 && 
∫
->
p
.Ámûy !
AF_INET
) ||

914 (
Ámûy
 =
AFI_IP6
 && 
∫
->
p
.Ámûy !
AF_INET6
))

915  
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

917 
rm≠
 = 0;

918 i‡(
rib
->
ty≥
 >0 &&Ñib->ty≥ < 
ZEBRA_ROUTE_MAX
 &&

919 
¥Ÿo_rm
[
Ámûy
][
rib
->
ty≥
])

920 
rm≠
 = 
	`rouã_m≠_lookup_by_«me
 (
¥Ÿo_rm
[
Ámûy
][
rib
->
ty≥
]);

921 i‡(!
rm≠
 && 
¥Ÿo_rm
[
Ámûy
][
ZEBRA_ROUTE_MAX
])

922 
rm≠
 = 
	`rouã_m≠_lookup_by_«me
 (
¥Ÿo_rm
[
Ámûy
][
ZEBRA_ROUTE_MAX
]);

923 i‡(
rm≠
) {

924 
ªt
 = 
	`rouã_m≠_≠∂y
(
rm≠
, &
∫
->
p
, 
RMAP_ZEBRA
, 
√xth›
);

927 i‡(
ªt
 =
RMAP_DENYMATCH
)

928 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

929  
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

930 
	}
}

942 
	$√xth›_a˘ive_upd©e
 (
rouã_node
 *
∫
, 
rib
 *rib, 
£t
)

944 
√xth›
 *nexthop;

945 
¥ev_a˘ive
, 
¥ev_ödex
, 
√w_a˘ive
;

947 
rib
->
√xth›_a˘ive_num
 = 0;

948 
	`UNSET_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_CHANGED
);

950 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

952 
¥ev_a˘ive
 = 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
);

953 
¥ev_ödex
 = 
√xth›
->
ifödex
;

954 i‡((
√w_a˘ive
 = 
	`√xth›_a˘ive_check
 (
∫
, 
rib
, 
√xth›
, 
£t
)))

955 
rib
->
√xth›_a˘ive_num
++;

956 i‡(
¥ev_a˘ive
 !
√w_a˘ive
 ||

957 
¥ev_ödex
 !
√xth›
->
ifödex
)

958 
	`SET_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_CHANGED
);

960  
rib
->
√xth›_a˘ive_num
;

961 
	}
}

966 
	$rib_ö°Æl_kî√l
 (
rouã_node
 *
∫
, 
rib
 *rib)

968 
ªt
 = 0;

969 
√xth›
 *nexthop;

975 
	`zÂm_åiggî_upd©e
 (
∫
, "installing in kernel");

976 
	`PREFIX_FAMILY
 (&
∫
->
p
))

978 
AF_INET
:

979 
ªt
 = 
	`kî√l_add_ùv4
 (&
∫
->
p
, 
rib
);

981 #ifde‡
HAVE_IPV6


982 
AF_INET6
:

983 
ªt
 = 
	`kî√l_add_ùv6
 (&
∫
->
p
, 
rib
);

989 i‡(
ªt
 < 0)

991 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

992 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

994 
	}
}

998 
	$rib_unö°Æl_kî√l
 (
rouã_node
 *
∫
, 
rib
 *rib)

1000 
ªt
 = 0;

1001 
√xth›
 *nexthop;

1007 
	`zÂm_åiggî_upd©e
 (
∫
, "uninstalling from kernel");

1009 
	`PREFIX_FAMILY
 (&
∫
->
p
))

1011 
AF_INET
:

1012 
ªt
 = 
	`kî√l_dñëe_ùv4
 (&
∫
->
p
, 
rib
);

1014 #ifde‡
HAVE_IPV6


1015 
AF_INET6
:

1016 
ªt
 = 
	`kî√l_dñëe_ùv6
 (&
∫
->
p
, 
rib
);

1021 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1022 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

1024  
ªt
;

1025 
	}
}

1029 
	$rib_unö°Æl
 (
rouã_node
 *
∫
, 
rib
 *rib)

1031 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

1033 
	`zÂm_åiggî_upd©e
 (
∫
, "rib_uninstall");

1035 
	`ªdi°ribuã_dñëe
 (&
∫
->
p
, 
rib
);

1036 i‡(! 
	`RIB_SYSTEM_ROUTE
 (
rib
))

1037 
	`rib_unö°Æl_kî√l
 (
∫
, 
rib
);

1038 
	`UNSET_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
);

1040 
	}
}

1042 
rib_u∆ök
 (
rouã_node
 *, 
rib
 *);

1050 
	$rib_ˇn_dñëe_de°
 (
rib_de°_t
 *
de°
)

1052 i‡(
de°
->
rouãs
)

1061 i‡(
	`CHECK_FLAG
 (
de°
->
Êags
, 
RIB_DEST_UPDATE_FPM
) ||

1062 
	`CHECK_FLAG
 (
de°
->
Êags
, 
RIB_DEST_SENT_TO_FPM
))

1066 
	}
}

1077 
	$rib_gc_de°
 (
rouã_node
 *
∫
)

1079 
rib_de°_t
 *
de°
;

1080 
buf
[
INET6_ADDRSTRLEN
];

1082 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫
);

1083 i‡(!
de°
)

1086 i‡(!
	`rib_ˇn_dñëe_de°
 (
de°
))

1089 i‡(
IS_ZEBRA_DEBUG_RIB
)

1091 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
,  (buf));

1092 
	`zlog_debug
 ("%s: %s/%d:Ñemovög de° fromÅabÀ", 
__func__
,

1093 
buf
, 
∫
->
p
.
¥efixÀn
);

1096 
de°
->
∫ode
 = 
NULL
;

1097 
	`XFREE
 (
MTYPE_RIB_DEST
, 
de°
);

1098 
∫
->
öfo
 = 
NULL
;

1103 
	`rouã_u∆ock_node
 (
∫
);

1105 
	}
}

1109 
	$rib_¥o˚ss
 (
rouã_node
 *
∫
)

1111 
rib
 *rib;

1112 
rib
 *
√xt
;

1113 
rib
 *
fib
 = 
NULL
;

1114 
rib
 *
£À˘
 = 
NULL
;

1115 
rib
 *
dñ
 = 
NULL
;

1116 
ö°ÆÀd
 = 0;

1117 
√xth›
 *√xth› = 
NULL
;

1118 
buf
[
INET6_ADDRSTRLEN
];

1120 
	`as£π
 (
∫
);

1122 i‡(
IS_ZEBRA_DEBUG_RIB
 || 
IS_ZEBRA_DEBUG_RIB_Q
)

1123 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
);

1125 
	`RNODE_FOREACH_RIB_SAFE
 (
∫
, 
rib
, 
√xt
)

1128 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

1130 
	`as£π
 (
fib
 =
NULL
);

1131 
fib
 = 
rib
;

1137 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

1139 i‡(
rib
 !
fib
)

1141 i‡(
IS_ZEBRA_DEBUG_RIB
)

1142 
	`zlog_debug
 ("%s: %s/%d:Ñ¿%p,ÑemovögÑib %p", 
__func__
,

1143 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn, 
rib
);

1144 
	`rib_u∆ök
 (
∫
, 
rib
);

1147 
dñ
 = 
rib
;

1153 i‡(! 
	`√xth›_a˘ive_upd©e
 (
∫
, 
rib
, 0))

1157 i‡(
rib
->
di°™˚
 =
DISTANCE_INFINITY
)

1161 i‡(!
£À˘
)

1163 
£À˘
 = 
rib
;

1177 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

1179 i‡(
£À˘
->
ty≥
 !
ZEBRA_ROUTE_CONNECT


1180 || 
rib
->
mëric
 <
£À˘
->metric)

1181 
£À˘
 = 
rib
;

1184 i‡(
£À˘
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
)

1188 i‡(
rib
->
di°™˚
 > 
£À˘
->distance)

1192 i‡(
rib
->
di°™˚
 < 
£À˘
->distance)

1194 
£À˘
 = 
rib
;

1199 i‡(
rib
->
mëric
 <
£À˘
->metric)

1200 
£À˘
 = 
rib
;

1211 i‡(
£À˘
 && sñe˘ =
fib
)

1213 i‡(
IS_ZEBRA_DEBUG_RIB
)

1214 
	`zlog_debug
 ("%s: %s/%d: UpdatingÉxistingÑoute, select %p, fib %p",

1215 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
, 
£À˘
, 
fib
);

1216 i‡(
	`CHECK_FLAG
 (
£À˘
->
Êags
, 
ZEBRA_FLAG_CHANGED
))

1218 
	`zÂm_åiggî_upd©e
 (
∫
, "updatingÉxistingÑoute");

1220 
	`ªdi°ribuã_dñëe
 (&
∫
->
p
, 
£À˘
);

1221 i‡(! 
	`RIB_SYSTEM_ROUTE
 (
£À˘
))

1222 
	`rib_unö°Æl_kî√l
 (
∫
, 
£À˘
);

1225 
	`√xth›_a˘ive_upd©e
 (
∫
, 
£À˘
, 1);

1227 i‡(! 
	`RIB_SYSTEM_ROUTE
 (
£À˘
))

1228 
	`rib_ö°Æl_kî√l
 (
∫
, 
£À˘
);

1229 
	`ªdi°ribuã_add
 (&
∫
->
p
, 
£À˘
);

1231 i‡(! 
	`RIB_SYSTEM_ROUTE
 (
£À˘
))

1240 
√xth›
 = 
£À˘
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1241 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

1243 
ö°ÆÀd
 = 1;

1246 i‡(! 
ö°ÆÀd
)

1247 
	`rib_ö°Æl_kî√l
 (
∫
, 
£À˘
);

1249 
íd
;

1256 i‡(
fib
)

1258 i‡(
IS_ZEBRA_DEBUG_RIB
)

1259 
	`zlog_debug
 ("%s: %s/%d: RemovögÉxi°ögÑouã, fib %p", 
__func__
,

1260 
buf
, 
∫
->
p
.
¥efixÀn
, 
fib
);

1262 
	`zÂm_åiggî_upd©e
 (
∫
, "removingÉxistingÑoute");

1264 
	`ªdi°ribuã_dñëe
 (&
∫
->
p
, 
fib
);

1265 i‡(! 
	`RIB_SYSTEM_ROUTE
 (
fib
))

1266 
	`rib_unö°Æl_kî√l
 (
∫
, 
fib
);

1267 
	`UNSET_FLAG
 (
fib
->
Êags
, 
ZEBRA_FLAG_SELECTED
);

1270 
	`√xth›_a˘ive_upd©e
 (
∫
, 
fib
, 1);

1277 i‡(
£À˘
)

1279 i‡(
IS_ZEBRA_DEBUG_RIB
)

1280 
	`zlog_debug
 ("%s: %s/%d: AddögÑouã, sñe˘ %p", 
__func__
, 
buf
,

1281 
∫
->
p
.
¥efixÀn
, 
£À˘
);

1283 
	`zÂm_åiggî_upd©e
 (
∫
, "newÑoute selected");

1286 
	`√xth›_a˘ive_upd©e
 (
∫
, 
£À˘
, 1);

1288 i‡(! 
	`RIB_SYSTEM_ROUTE
 (
£À˘
))

1289 
	`rib_ö°Æl_kî√l
 (
∫
, 
£À˘
);

1290 
	`SET_FLAG
 (
£À˘
->
Êags
, 
ZEBRA_FLAG_SELECTED
);

1291 
	`ªdi°ribuã_add
 (&
∫
->
p
, 
£À˘
);

1295 i‡(
dñ
)

1297 i‡(
IS_ZEBRA_DEBUG_RIB
)

1298 
	`zlog_debug
 ("%s: %s/%d: Dñëög fib %p,Ñ¿%p", 
__func__
, 
buf
,

1299 
∫
->
p
.
¥efixÀn
, 
dñ
,Ñn);

1300 
	`rib_u∆ök
 (
∫
, 
dñ
);

1303 
íd
:

1304 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

1305 
	`zlog_debug
 ("%s: %s/%d:Ñ¿%∞dequeued", 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn);

1310 
	`rib_gc_de°
 (
∫
);

1311 
	}
}

1318 
	$¥o˚ss_subq
 (
li°
 * 
subq
, 
u_ch¨
 
qödex
)

1320 
li°node
 *
 ode
 = 
	`li°hód
 (
subq
);

1321 
rouã_node
 *
∫ode
;

1323 i‡(!
 ode
)

1326 
∫ode
 = 
	`li°gëd©a
 (
 ode
);

1327 
	`rib_¥o˚ss
 (
∫ode
);

1329 i‡(
∫ode
->
öfo
)

1330 
	`UNSET_FLAG
 (
	`rib_de°_‰om_∫ode
 (
∫ode
)->
Êags
, 
	`RIB_ROUTE_QUEUED
 (
qödex
));

1335 
	`zlog_debug
 ("%s: called forÑoute_node (%p, %d) withÇoÑibs",

1336 
__func__
, 
∫ode
,Ñnode->
lock
);

1337 
	`zlog_backåa˚
(
LOG_DEBUG
);

1340 
	`rouã_u∆ock_node
 (
∫ode
);

1341 
	`li°_dñëe_node
 (
subq
, 
 ode
);

1343 
	}
}

1349 
wq_ôem_°©us


1350 
	$mëa_queue_¥o˚ss
 (
w‹k_queue
 *
dummy
, *
d©a
)

1352 
mëa_queue
 * 
mq
 = 
d©a
;

1353 
i
;

1355 
i
 = 0; i < 
MQ_SIZE
; i++)

1356 i‡(
	`¥o˚ss_subq
 (
mq
->
subq
[
i
], i))

1358 
mq
->
size
--;

1361  
mq
->
size
 ? 
WQ_REQUEUE
 : 
WQ_SUCCESS
;

1362 
	}
}

1367 c⁄° 
u_ch¨
 
	gmëa_queue_m≠
[
ZEBRA_ROUTE_MAX
] = {

1368 [
ZEBRA_ROUTE_SYSTEM
] = 4,

1369 [
ZEBRA_ROUTE_KERNEL
] = 0,

1370 [
ZEBRA_ROUTE_CONNECT
] = 0,

1371 [
ZEBRA_ROUTE_STATIC
] = 1,

1372 [
ZEBRA_ROUTE_RIP
] = 2,

1373 [
ZEBRA_ROUTE_RIPNG
] = 2,

1374 [
ZEBRA_ROUTE_OSPF
] = 2,

1375 [
ZEBRA_ROUTE_OSPF6
] = 2,

1376 [
ZEBRA_ROUTE_ISIS
] = 2,

1377 [
ZEBRA_ROUTE_BGP
] = 3,

1378 [
ZEBRA_ROUTE_HSLS
] = 4,

1379 [
ZEBRA_ROUTE_BABEL
] = 2,

1386 
	$rib_mëa_queue_add
 (
mëa_queue
 *
mq
, 
rouã_node
 *
∫
)

1388 
rib
 *rib;

1389 
buf
[
INET6_ADDRSTRLEN
];

1391 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

1392 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
);

1394 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1396 
u_ch¨
 
qödex
 = 
mëa_queue_m≠
[
rib
->
ty≥
];

1399 i‡(
	`CHECK_FLAG
 (
	`rib_de°_‰om_∫ode
 (
∫
)->
Êags
,

1400 
	`RIB_ROUTE_QUEUED
 (
qödex
)))

1402 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

1403 
	`zlog_debug
 ("%s: %s/%d:Ñn %p isálready queued in sub-queue %u",

1404 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn, 
qödex
);

1408 
	`SET_FLAG
 (
	`rib_de°_‰om_∫ode
 (
∫
)->
Êags
, 
	`RIB_ROUTE_QUEUED
 (
qödex
));

1409 
	`li°node_add
 (
mq
->
subq
[
qödex
], 
∫
);

1410 
	`rouã_lock_node
 (
∫
);

1411 
mq
->
size
++;

1413 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

1414 
	`zlog_debug
 ("%s: %s/%d: queuedÑn %p into sub-queue %u",

1415 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn, 
qödex
);

1417 
	}
}

1421 
	$rib_queue_add
 (
zebø_t
 *
zebø
, 
rouã_node
 *
∫
)

1423 
buf
[
INET_ADDRSTRLEN
];

1424 
	`as£π
 (
zebø
 && 
∫
);

1426 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

1427 
	`öë_¡›
 (
AF_INET
, &
∫
->
p
.
u
.
¥efix
, 
buf
, 
INET_ADDRSTRLEN
);

1430 i‡(!
	`∫ode_to_ribs
 (
∫
))

1432 
	`zlog_debug
 ("%s: called forÑoute_node (%p, %d) withÇoÑibs",

1433 
__func__
, 
∫
,Ñn->
lock
);

1434 
	`zlog_backåa˚
(
LOG_DEBUG
);

1438 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

1439 
	`zlog_öfo
 ("%s: %s/%d: w‹k queuêadded", 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
);

1441 
	`as£π
 (
zebø
);

1443 i‡(
zebø
->
ribq
 =
NULL
)

1445 
	`zlog_îr
 ("%s: w‹k_queuêd€†nŸÉxi°!", 
__func__
);

1457 i‡(!
zebø
->
ribq
->
ôems
->
cou¡
)

1458 
	`w‹k_queue_add
 (
zebø
->
ribq
, zebø->
mq
);

1460 
	`rib_mëa_queue_add
 (
zebø
->
mq
, 
∫
);

1462 i‡(
IS_ZEBRA_DEBUG_RIB_Q
)

1463 
	`zlog_debug
 ("%s: %s/%d:Ñ¿%∞queued", 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn);

1466 
	}
}

1471 
mëa_queue
 *

1472 
	$mëa_queue_√w
 ()

1474 
mëa_queue
 *
√w
;

1475 
i
;

1477 
√w
 = 
	`XCALLOC
 (
MTYPE_WORK_QUEUE
,  (
mëa_queue
));

1478 
	`as£π
(
√w
);

1480 
i
 = 0; i < 
MQ_SIZE
; i++)

1482 
√w
->
subq
[
i
] = 
	`li°_√w
 ();

1483 
	`as£π
(
√w
->
subq
[
i
]);

1486  
√w
;

1487 
	}
}

1491 
	$rib_queue_öô
 (
zebø_t
 *
zebø
)

1493 
	`as£π
 (
zebø
);

1495 i‡(! (
zebø
->
ribq
 = 
	`w‹k_queue_√w
 (zebø->
ma°î
,

1498 
	`zlog_îr
 ("%s: couldÇŸ inôüli£ w‹k queue!", 
__func__
);

1503 
zebø
->
ribq
->
•ec
.
w‹kfunc
 = &
mëa_queue_¥o˚ss
;

1504 
zebø
->
ribq
->
•ec
.
îr‹func
 = 
NULL
;

1506 
zebø
->
ribq
->
•ec
.
max_ªåõs
 = 3;

1507 
zebø
->
ribq
->
•ec
.
hﬁd
 = 
rib_¥o˚ss_hﬁd_time
;

1509 i‡(!(
zebø
->
mq
 = 
	`mëa_queue_√w
 ()))

1511 
	`zlog_îr
 ("%s: couldÇŸ inôüli£ më®queue!", 
__func__
);

1515 
	}
}

1556 
	$rib_lök
 (
rouã_node
 *
∫
, 
rib
 *rib)

1558 
rib
 *
hód
;

1559 
rib_de°_t
 *
de°
;

1560 
buf
[
INET6_ADDRSTRLEN
];

1562 
	`as£π
 (
rib
 && 
∫
);

1564 i‡(
IS_ZEBRA_DEBUG_RIB
)

1566 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
);

1567 
	`zlog_debug
 ("%s: %s/%d:Ñ¿%p,Ñib %p", 
__func__
,

1568 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn, 
rib
);

1571 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫
);

1572 i‡(!
de°
)

1574 i‡(
IS_ZEBRA_DEBUG_RIB
)

1576 
	`zlog_debug
 ("%s: %s/%d:áddög de°ÅÿèbÀ", 
__func__
,

1577 
buf
, 
∫
->
p
.
¥efixÀn
);

1580 
de°
 = 
	`XCALLOC
 (
MTYPE_RIB_DEST
,  (
rib_de°_t
));

1581 
	`rouã_lock_node
 (
∫
);

1582 
∫
->
öfo
 = 
de°
;

1583 
de°
->
∫ode
 = 
∫
;

1586 
hód
 = 
de°
->
rouãs
;

1587 i‡(
hód
)

1589 
hód
->
¥ev
 = 
rib
;

1591 
rib
->
√xt
 = 
hód
;

1592 
de°
->
rouãs
 = 
rib
;

1593 
	`rib_queue_add
 (&
zebød
, 
∫
);

1594 
	}
}

1597 
	$rib_addnode
 (
rouã_node
 *
∫
, 
rib
 *rib)

1602 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

1604 i‡(
IS_ZEBRA_DEBUG_RIB
)

1606 
buf
[
INET6_ADDRSTRLEN
];

1607 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
);

1608 
	`zlog_debug
 ("%s: %s/%d:Ñn %p, un-removedÑib %p",

1609 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn, 
rib
);

1611 
	`UNSET_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
);

1614 
	`rib_lök
 (
∫
, 
rib
);

1615 
	}
}

1627 
	$rib_u∆ök
 (
rouã_node
 *
∫
, 
rib
 *rib)

1629 
√xth›
 *√xth›, *
√xt
;

1630 
buf
[
INET6_ADDRSTRLEN
];

1631 
rib_de°_t
 *
de°
;

1633 
	`as£π
 (
∫
 && 
rib
);

1635 i‡(
IS_ZEBRA_DEBUG_RIB
)

1637 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
);

1638 
	`zlog_debug
 ("%s: %s/%d:Ñn %p,Ñib %p",

1639 
__func__
, 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn, 
rib
);

1642 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫
);

1644 i‡(
rib
->
√xt
)

1645 
rib
->
√xt
->
¥ev
 =Ñib->prev;

1647 i‡(
rib
->
¥ev
)

1648 
rib
->
¥ev
->
√xt
 =Ñib->next;

1651 
de°
->
rouãs
 = 
rib
->
√xt
;

1655 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› = 
√xt
)

1657 
√xt
 = 
√xth›
->next;

1658 
	`√xth›_‰ì
 (
√xth›
);

1660 
	`XFREE
 (
MTYPE_RIB
, 
rib
);

1662 
	}
}

1665 
	$rib_dñnode
 (
rouã_node
 *
∫
, 
rib
 *rib)

1667 i‡(
IS_ZEBRA_DEBUG_RIB
)

1669 
buf
[
INET6_ADDRSTRLEN
];

1670 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &∫->p.
u
.
¥efix
, 
buf
, 
INET6_ADDRSTRLEN
);

1671 
	`zlog_debug
 ("%s: %s/%d:Ñ¿%p,Ñib %p,Ñemovög", 
__func__
,

1672 
buf
, 
∫
->
p
.
¥efixÀn
,Ñn, 
rib
);

1674 
	`SET_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
);

1675 
	`rib_queue_add
 (&
zebød
, 
∫
);

1676 
	}
}

1679 
	$rib_add_ùv4
 (
ty≥
, 
Êags
, 
¥efix_ùv4
 *
p
,

1680 
ö_addr
 *
g©e
, ö_add∏*
§c
,

1681 
ifödex
, 
u_öt32_t
 
vrf_id
,

1682 
u_öt32_t
 
mëric
, 
u_ch¨
 
di°™˚
, 
ßfi_t
 
ßfi
)

1684 
rib
 *rib;

1685 
rib
 *
ßme
 = 
NULL
;

1686 
rouã_èbÀ
 *
èbÀ
;

1687 
rouã_node
 *
∫
;

1688 
√xth›
 *nexthop;

1691 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
ßfi
, 0);

1692 i‡(! 
èbÀ
)

1696 
	`≠∂y_mask_ùv4
 (
p
);

1699 i‡(
di°™˚
 == 0)

1701 i‡(()
ty≥
 >
	`¨øy_size
(
rouã_öfo
))

1702 
di°™˚
 = 150;

1704 
di°™˚
 = 
rouã_öfo
[
ty≥
].distance;

1707 i‡(
ty≥
 =
ZEBRA_ROUTE_BGP
 && 
	`CHECK_FLAG
 (
Êags
, 
ZEBRA_FLAG_IBGP
))

1708 
di°™˚
 = 200;

1712 
∫
 = 
	`rouã_node_gë
 (
èbÀ
, (
¥efix
 *Ë
p
);

1716 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1718 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

1721 i‡(
rib
->
ty≥
 !=Åype)

1723 i‡(
rib
->
ty≥
 !
ZEBRA_ROUTE_CONNECT
)

1725 
ßme
 = 
rib
;

1729 i‡((
√xth›
 = 
rib
->nexthop) &&

1730 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX
 &&

1731 
√xth›
->
ifödex
 == ifindex &&

1732 !
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

1734 
rib
->
ªf˙t
++;

1740 
rib
 = 
	`XCALLOC
 (
MTYPE_RIB
,  (rib));

1741 
rib
->
ty≥
 =Åype;

1742 
rib
->
di°™˚
 = distance;

1743 
rib
->
Êags
 = flags;

1744 
rib
->
mëric
 = metric;

1745 
rib
->
èbÀ
 = 
vrf_id
;

1746 
rib
->
√xth›_num
 = 0;

1747 
rib
->
u±ime
 = 
	`time
 (
NULL
);

1750 i‡(
g©e
)

1752 i‡(
ifödex
)

1753 
	`√xth›_ùv4_ifödex_add
 (
rib
, 
g©e
, 
§c
, 
ifödex
);

1755 
	`√xth›_ùv4_add
 (
rib
, 
g©e
, 
§c
);

1758 
	`√xth›_ifödex_add
 (
rib
, 
ifödex
);

1761 i‡(
ty≥
 =
ZEBRA_ROUTE_KERNEL
 ||Åy≥ =
ZEBRA_ROUTE_CONNECT
)

1762 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1763 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

1766 i‡(
IS_ZEBRA_DEBUG_RIB
)

1767 
	`zlog_debug
 ("%s: cÆlögÑib_addnodê(%p, %p)", 
__func__
, 
∫
, 
rib
);

1768 
	`rib_addnode
 (
∫
, 
rib
);

1771 i‡(
ßme
)

1773 i‡(
IS_ZEBRA_DEBUG_RIB
)

1774 
	`zlog_debug
 ("%s: cÆlögÑib_dñnodê(%p, %p)", 
__func__
, 
∫
, 
rib
);

1775 
	`rib_dñnode
 (
∫
, 
ßme
);

1778 
	`rouã_u∆ock_node
 (
∫
);

1780 
	}
}

1787 
	$rib_dump
 (c⁄° * 
func
, c⁄° 
¥efix_ùv4
 * 
p
, c⁄° 
rib
 *Ñib)

1789 
°øddr1
[
INET_ADDRSTRLEN
], 
°øddr2
[INET_ADDRSTRLEN];

1790 
√xth›
 *nexthop;

1792 
	`öë_¡›
 (
AF_INET
, &
p
->
¥efix
, 
°øddr1
, 
INET_ADDRSTRLEN
);

1793 
	`zlog_debug
 ("%s: dumpög RIBÉ¡ry %∞f‹ %s/%d", 
func
, 
rib
, 
°øddr1
, 
p
->
¥efixÀn
);

1794 
zlog_debug


1797 
func
,

1798 
rib
->
ªf˙t
,

1799 (Ë
rib
->
u±ime
,

1800 
rib
->
ty≥
,

1801 
rib
->
èbÀ


1803 
zlog_debug


1806 
func
,

1807 
rib
->
mëric
,

1808 
rib
->
di°™˚
,

1809 
rib
->
Êags
,

1810 
rib
->
°©us


1812 
zlog_debug


1815 
func
,

1816 
rib
->
√xth›_num
,

1817 
rib
->
√xth›_a˘ive_num
,

1818 
rib
->
√xth›_fib_num


1820 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1822 
	`öë_¡›
 (
AF_INET
, &
√xth›
->
g©e
.
ùv4
.
s_addr
, 
°øddr1
, 
INET_ADDRSTRLEN
);

1823 
	`öë_¡›
 (
AF_INET
, &
√xth›
->
rg©e
.
ùv4
.
s_addr
, 
°øddr2
, 
INET_ADDRSTRLEN
);

1824 
zlog_debug


1827 
func
,

1828 
°øddr1
,

1829 
°øddr2
,

1830 (
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
) ? "ACTIVE " : ""),

1831 (
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
) ? "FIB " : ""),

1832 (
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
) ? "RECURSIVE" : "")

1835 
	`zlog_debug
 ("%s: dum∞com∂ëe", 
func
);

1836 
	}
}

1842 
	$rib_lookup_™d_dump
 (
¥efix_ùv4
 * 
p
)

1844 
rouã_èbÀ
 *
èbÀ
;

1845 
rouã_node
 *
∫
;

1846 
rib
 *rib;

1847 
¥efix_buf
[
INET_ADDRSTRLEN
];

1850 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

1851 i‡(! 
èbÀ
)

1853 
	`zlog_îr
 ("%s: vrf_èbÀ(Ëªtu∫ed NULL", 
__func__
);

1857 
	`öë_¡›
 (
AF_INET
, &
p
->
¥efix
.
s_addr
, 
¥efix_buf
, 
INET_ADDRSTRLEN
);

1859 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *Ë
p
);

1862 i‡(! 
∫
)

1864 
	`zlog_debug
 ("%s:Üooku∞Áûed f‹ %s/%d", 
__func__
, 
¥efix_buf
, 
p
->
¥efixÀn
);

1869 
	`rouã_u∆ock_node
 (
∫
);

1872 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1874 
zlog_debug


1877 
__func__
,

1878 
∫
,

1879 
rib
,

1880 (
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
) ? "removed" : "NOTÑemoved"),

1881 (
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
) ? "selected" : "NOT selected")

1883 
	`rib_dump
 (
__func__
, 
p
, 
rib
);

1885 
	}
}

1892 
	$rib_lookup_™d_pushup
 (
¥efix_ùv4
 * 
p
)

1894 
rouã_èbÀ
 *
èbÀ
;

1895 
rouã_node
 *
∫
;

1896 
rib
 *rib;

1897 
ch™ged
 = 0;

1899 i‡(
NULL
 =(
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0)))

1901 
	`zlog_îr
 ("%s: vrf_èbÀ(Ëªtu∫ed NULL", 
__func__
);

1906 i‡(
NULL
 =(
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *Ë
p
)))

1910 
	`rouã_u∆ock_node
 (
∫
);

1919 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1921 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
) &&

1922 ! 
	`RIB_SYSTEM_ROUTE
 (
rib
))

1924 
ch™ged
 = 1;

1925 i‡(
IS_ZEBRA_DEBUG_RIB
)

1927 
buf
[
INET_ADDRSTRLEN
];

1928 
	`öë_¡›
 (
∫
->
p
.
Ámûy
, &p->
¥efix
, 
buf
, 
INET_ADDRSTRLEN
);

1929 
	`zlog_debug
 ("%s: fªeög way f‹ c⁄√˘edÖªfix %s/%d", 
__func__
, 
buf
, 
p
->
¥efixÀn
);

1930 
	`rib_dump
 (
__func__
, (
¥efix_ùv4
 *)&
∫
->
p
, 
rib
);

1932 
	`rib_unö°Æl
 (
∫
, 
rib
);

1935 i‡(
ch™ged
)

1936 
	`rib_queue_add
 (&
zebød
, 
∫
);

1937 
	}
}

1940 
	$rib_add_ùv4_mu…ù©h
 (
¥efix_ùv4
 *
p
, 
rib
 *rib, 
ßfi_t
 
ßfi
)

1942 
rouã_èbÀ
 *
èbÀ
;

1943 
rouã_node
 *
∫
;

1944 
rib
 *
ßme
;

1945 
√xth›
 *nexthop;

1948 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
ßfi
, 0);

1949 i‡(! 
èbÀ
)

1953 
	`≠∂y_mask_ùv4
 (
p
);

1956 i‡(
rib
->
di°™˚
 == 0)

1958 
rib
->
di°™˚
 = 
rouã_öfo
[rib->
ty≥
].distance;

1961 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_BGP


1962 && 
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_IBGP
))

1963 
rib
->
di°™˚
 = 200;

1967 
∫
 = 
	`rouã_node_gë
 (
èbÀ
, (
¥efix
 *Ë
p
);

1971 
	`RNODE_FOREACH_RIB
 (
∫
, 
ßme
)

1973 i‡(
	`CHECK_FLAG
 (
ßme
->
°©us
, 
RIB_ENTRY_REMOVED
))

1976 i‡(
ßme
->
ty≥
 =
rib
->ty≥ && same->
èbÀ
 ==Ñib->table

1977 && 
ßme
->
ty≥
 !
ZEBRA_ROUTE_CONNECT
)

1982 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_KERNEL
 ||Ñib->ty≥ =
ZEBRA_ROUTE_CONNECT
)

1983 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1984 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

1987 
	`rib_addnode
 (
∫
, 
rib
);

1988 i‡(
IS_ZEBRA_DEBUG_RIB
)

1990 
	`zlog_debug
 ("%s: calledÑib_addnode (%p, %p) onÇew RIBÉntry",

1991 
__func__
, 
∫
, 
rib
);

1992 
	`rib_dump
 (
__func__
, 
p
, 
rib
);

1996 i‡(
ßme
)

1998 i‡(
IS_ZEBRA_DEBUG_RIB
)

2000 
	`zlog_debug
 ("%s: callingÑib_delnode (%p, %p) onÉxisting RIBÉntry",

2001 
__func__
, 
∫
, 
ßme
);

2002 
	`rib_dump
 (
__func__
, 
p
, 
ßme
);

2004 
	`rib_dñnode
 (
∫
, 
ßme
);

2007 
	`rouã_u∆ock_node
 (
∫
);

2009 
	}
}

2013 
	$rib_dñëe_ùv4
 (
ty≥
, 
Êags
, 
¥efix_ùv4
 *
p
,

2014 
ö_addr
 *
g©e
, 
ifödex
, 
u_öt32_t
 
vrf_id
, 
ßfi_t
 
ßfi
)

2016 
rouã_èbÀ
 *
èbÀ
;

2017 
rouã_node
 *
∫
;

2018 
rib
 *rib;

2019 
rib
 *
fib
 = 
NULL
;

2020 
rib
 *
ßme
 = 
NULL
;

2021 
√xth›
 *nexthop;

2022 
buf1
[
INET_ADDRSTRLEN
];

2023 
buf2
[
INET_ADDRSTRLEN
];

2026 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
ßfi
, 0);

2027 i‡(! 
èbÀ
)

2031 
	`≠∂y_mask_ùv4
 (
p
);

2033 i‡(
IS_ZEBRA_DEBUG_KERNEL
 && 
g©e
)

2034 
	`zlog_debug
 ("rib_delete_ipv4():Ñoute delete %s/%d via %s ifindex %d",

2035 
	`öë_¡›
 (
AF_INET
, &
p
->
¥efix
, 
buf1
, 
INET_ADDRSTRLEN
),

2036 
p
->
¥efixÀn
,

2037 
	`öë_¡ﬂ
 (*
g©e
),

2038 
ifödex
);

2041 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *Ë
p
);

2042 i‡(! 
∫
)

2044 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

2046 i‡(
g©e
)

2047 
	`zlog_debug
 ("route %s/%d via %s ifindex %d doesn'tÉxist inÑib",

2048 
	`öë_¡›
 (
AF_INET
, &
p
->
¥efix
, 
buf1
, 
INET_ADDRSTRLEN
),

2049 
p
->
¥efixÀn
,

2050 
	`öë_¡›
 (
AF_INET
, 
g©e
, 
buf2
, 
INET_ADDRSTRLEN
),

2051 
ifödex
);

2053 
	`zlog_debug
 ("route %s/%d ifindex %d doesn'tÉxist inÑib",

2054 
	`öë_¡›
 (
AF_INET
, &
p
->
¥efix
, 
buf1
, 
INET_ADDRSTRLEN
),

2055 
p
->
¥efixÀn
,

2056 
ifödex
);

2058  
ZEBRA_ERR_RTNOEXIST
;

2062 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2064 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

2067 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

2068 
fib
 = 
rib
;

2070 i‡(
rib
->
ty≥
 !=Åype)

2072 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
 && (
√xth›
 =Ñib->nexthop) &&

2073 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX
)

2075 i‡(
√xth›
->
ifödex
 != ifindex)

2077 i‡(
rib
->
ªf˙t
)

2079 
rib
->
ªf˙t
--;

2080 
	`rouã_u∆ock_node
 (
∫
);

2081 
	`rouã_u∆ock_node
 (
∫
);

2084 
ßme
 = 
rib
;

2088 i‡(
g©e
 =
NULL
 ||

2089 ((
√xth›
 = 
rib
->nexthop) &&

2090 (
	`IPV4_ADDR_SAME
 (&
√xth›
->
g©e
.
ùv4
, gate) ||

2091 
	`IPV4_ADDR_SAME
 (&
√xth›
->
rg©e
.
ùv4
, 
g©e
))))

2093 
ßme
 = 
rib
;

2100 i‡(! 
ßme
)

2102 i‡(
fib
 && 
ty≥
 =
ZEBRA_ROUTE_KERNEL
)

2105 
√xth›
 = 
fib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

2106 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

2108 
	`UNSET_FLAG
 (
fib
->
Êags
, 
ZEBRA_FLAG_SELECTED
);

2112 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

2114 i‡(
g©e
)

2115 
	`zlog_debug
 ("route %s/%d via %s ifindex %dÅype %d doesn'tÉxist inÑib",

2116 
	`öë_¡›
 (
AF_INET
, &
p
->
¥efix
, 
buf1
, 
INET_ADDRSTRLEN
),

2117 
p
->
¥efixÀn
,

2118 
	`öë_¡›
 (
AF_INET
, 
g©e
, 
buf2
, 
INET_ADDRSTRLEN
),

2119 
ifödex
,

2120 
ty≥
);

2122 
	`zlog_debug
 ("route %s/%d ifindex %dÅype %d doesn'tÉxist inÑib",

2123 
	`öë_¡›
 (
AF_INET
, &
p
->
¥efix
, 
buf1
, 
INET_ADDRSTRLEN
),

2124 
p
->
¥efixÀn
,

2125 
ifödex
,

2126 
ty≥
);

2128 
	`rouã_u∆ock_node
 (
∫
);

2129  
ZEBRA_ERR_RTNOEXIST
;

2133 i‡(
ßme
)

2134 
	`rib_dñnode
 (
∫
, 
ßme
);

2136 
	`rouã_u∆ock_node
 (
∫
);

2138 
	}
}

2142 
	$°©ic_ö°Æl_ùv4
 (
¥efix
 *
p
, 
°©ic_ùv4
 *
si
)

2144 
rib
 *rib;

2145 
rouã_node
 *
∫
;

2146 
rouã_èbÀ
 *
èbÀ
;

2149 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

2150 i‡(! 
èbÀ
)

2154 
∫
 = 
	`rouã_node_gë
 (
èbÀ
, 
p
);

2155 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2157 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

2160 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_STATIC
 &&Ñib->
di°™˚
 =
si
->distance)

2164 i‡(
rib
)

2168 
	`rouã_u∆ock_node
 (
∫
);

2169 
si
->
ty≥
)

2171 
STATIC_IPV4_GATEWAY
:

2172 
	`√xth›_ùv4_add
 (
rib
, &
si
->
g©e
.
ùv4
, 
NULL
);

2174 
STATIC_IPV4_IFNAME
:

2175 
	`√xth›_i‚ame_add
 (
rib
, 
si
->
g©e
.
i‚ame
);

2177 
STATIC_IPV4_BLACKHOLE
:

2178 
	`√xth›_bœckhﬁe_add
 (
rib
);

2181 
	`rib_queue_add
 (&
zebød
, 
∫
);

2186 
rib
 = 
	`XCALLOC
 (
MTYPE_RIB
,  (rib));

2188 
rib
->
ty≥
 = 
ZEBRA_ROUTE_STATIC
;

2189 
rib
->
di°™˚
 = 
si
->distance;

2190 
rib
->
mëric
 = 0;

2191 
rib
->
èbÀ
 = 
zebød
.
πm_èbÀ_deÁu…
;

2192 
rib
->
√xth›_num
 = 0;

2194 
si
->
ty≥
)

2196 
STATIC_IPV4_GATEWAY
:

2197 
	`√xth›_ùv4_add
 (
rib
, &
si
->
g©e
.
ùv4
, 
NULL
);

2199 
STATIC_IPV4_IFNAME
:

2200 
	`√xth›_i‚ame_add
 (
rib
, 
si
->
g©e
.
i‚ame
);

2202 
STATIC_IPV4_BLACKHOLE
:

2203 
	`√xth›_bœckhﬁe_add
 (
rib
);

2208 
rib
->
Êags
 = 
si
->flags;

2211 
	`rib_addnode
 (
∫
, 
rib
);

2213 
	}
}

2216 
	$°©ic_ùv4_√xth›_ßme
 (
√xth›
 *√xth›, 
°©ic_ùv4
 *
si
)

2218 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV4


2219 && 
si
->
ty≥
 =
STATIC_IPV4_GATEWAY


2220 && 
	`IPV4_ADDR_SAME
 (&
√xth›
->
g©e
.
ùv4
, &
si
->gate.ipv4))

2222 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


2223 && 
si
->
ty≥
 =
STATIC_IPV4_IFNAME


2224 && 
	`°rcmp
 (
√xth›
->
i‚ame
, 
si
->
g©e
.ifname) == 0)

2226 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_BLACKHOLE


2227 && 
si
->
ty≥
 =
STATIC_IPV4_BLACKHOLE
)

2230 
	}
}

2234 
	$°©ic_unö°Æl_ùv4
 (
¥efix
 *
p
, 
°©ic_ùv4
 *
si
)

2236 
rouã_node
 *
∫
;

2237 
rib
 *rib;

2238 
√xth›
 *nexthop;

2239 
rouã_èbÀ
 *
èbÀ
;

2242 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

2243 i‡(! 
èbÀ
)

2247 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, 
p
);

2248 i‡(! 
∫
)

2251 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2253 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

2256 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_STATIC
 &&Ñib->
di°™˚
 =
si
->distance)

2260 i‡(! 
rib
)

2262 
	`rouã_u∆ock_node
 (
∫
);

2267 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

2268 i‡(
	`°©ic_ùv4_√xth›_ßme
 (
√xth›
, 
si
))

2272 i‡(! 
√xth›
)

2274 
	`rouã_u∆ock_node
 (
∫
);

2279 i‡(
rib
->
√xth›_num
 == 1)

2280 
	`rib_dñnode
 (
∫
, 
rib
);

2283 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

2284 
	`rib_unö°Æl
 (
∫
, 
rib
);

2285 
	`√xth›_dñëe
 (
rib
, 
√xth›
);

2286 
	`√xth›_‰ì
 (
√xth›
);

2287 
	`rib_queue_add
 (&
zebød
, 
∫
);

2290 
	`rouã_u∆ock_node
 (
∫
);

2291 
	}
}

2295 
	$°©ic_add_ùv4
 (
¥efix
 *
p
, 
ö_addr
 *
g©e
, c⁄° *
i‚ame
,

2296 
u_ch¨
 
Êags
, u_ch¨ 
di°™˚
, 
u_öt32_t
 
vrf_id
)

2298 
u_ch¨
 
ty≥
 = 0;

2299 
rouã_node
 *
∫
;

2300 
°©ic_ùv4
 *
si
;

2301 
°©ic_ùv4
 *
µ
;

2302 
°©ic_ùv4
 *
˝
;

2303 
°©ic_ùv4
 *
upd©e
 = 
NULL
;

2304 
rouã_èbÀ
 *
°abÀ
;

2307 
°abÀ
 = 
	`vrf_°©ic_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 
vrf_id
);

2308 i‡(! 
°abÀ
)

2312 
∫
 = 
	`rouã_node_gë
 (
°abÀ
, 
p
);

2315 i‡(
g©e
)

2316 
ty≥
 = 
STATIC_IPV4_GATEWAY
;

2317 i‡(
i‚ame
)

2318 
ty≥
 = 
STATIC_IPV4_IFNAME
;

2320 
ty≥
 = 
STATIC_IPV4_BLACKHOLE
;

2323 
si
 = 
∫
->
öfo
; si; sòsi->
√xt
)

2325 i‡(
ty≥
 =
si
->type

2326 && (! 
g©e
 || 
	`IPV4_ADDR_SAME
 (g©e, &
si
->g©e.
ùv4
))

2327 && (! 
i‚ame
 || 
	`°rcmp
 (i‚ame, 
si
->
g©e
.ifname) == 0))

2329 i‡(
di°™˚
 =
si
->distance)

2331 
	`rouã_u∆ock_node
 (
∫
);

2335 
upd©e
 = 
si
;

2340 i‡(
upd©e
)

2341 
	`°©ic_dñëe_ùv4
 (
p
, 
g©e
, 
i‚ame
, 
upd©e
->
di°™˚
, 
vrf_id
);

2344 
si
 = 
	`XCALLOC
 (
MTYPE_STATIC_IPV4
,  (
°©ic_ùv4
));

2346 
si
->
ty≥
 =Åype;

2347 
si
->
di°™˚
 = distance;

2348 
si
->
Êags
 = flags;

2350 i‡(
g©e
)

2351 
si
->
g©e
.
ùv4
 = *gate;

2352 i‡(
i‚ame
)

2353 
si
->
g©e
.
i‚ame
 = 
	`XSTRDUP
 (0, ifname);

2357 
µ
 = 
NULL
, 
˝
 = 
∫
->
öfo
; cp;Ö∞˝, c∞˝->
√xt
)

2359 i‡(
si
->
di°™˚
 < 
˝
->distance)

2361 i‡(
si
->
di°™˚
 > 
˝
->distance)

2363 i‡(
si
->
ty≥
 =
STATIC_IPV4_GATEWAY
 && 
˝
->type == STATIC_IPV4_GATEWAY)

2365 i‡(
	`¡ohl
 (
si
->
g©e
.
ùv4
.
s_addr
Ë<Çtoh»(
˝
->gate.ipv4.s_addr))

2367 i‡(
	`¡ohl
 (
si
->
g©e
.
ùv4
.
s_addr
Ë>Çtoh»(
˝
->gate.ipv4.s_addr))

2373 i‡(
µ
)

2374 
µ
->
√xt
 = 
si
;

2376 
∫
->
öfo
 = 
si
;

2377 i‡(
˝
)

2378 
˝
->
¥ev
 = 
si
;

2379 
si
->
¥ev
 = 
µ
;

2380 
si
->
√xt
 = 
˝
;

2383 
	`°©ic_ö°Æl_ùv4
 (
p
, 
si
);

2386 
	}
}

2390 
	$°©ic_dñëe_ùv4
 (
¥efix
 *
p
, 
ö_addr
 *
g©e
, c⁄° *
i‚ame
,

2391 
u_ch¨
 
di°™˚
, 
u_öt32_t
 
vrf_id
)

2393 
u_ch¨
 
ty≥
 = 0;

2394 
rouã_node
 *
∫
;

2395 
°©ic_ùv4
 *
si
;

2396 
rouã_èbÀ
 *
°abÀ
;

2399 
°abÀ
 = 
	`vrf_°©ic_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 
vrf_id
);

2400 i‡(! 
°abÀ
)

2404 
∫
 = 
	`rouã_node_lookup
 (
°abÀ
, 
p
);

2405 i‡(! 
∫
)

2409 i‡(
g©e
)

2410 
ty≥
 = 
STATIC_IPV4_GATEWAY
;

2411 i‡(
i‚ame
)

2412 
ty≥
 = 
STATIC_IPV4_IFNAME
;

2414 
ty≥
 = 
STATIC_IPV4_BLACKHOLE
;

2417 
si
 = 
∫
->
öfo
; si; sòsi->
√xt
)

2418 i‡(
ty≥
 =
si
->type

2419 && (! 
g©e
 || 
	`IPV4_ADDR_SAME
 (g©e, &
si
->g©e.
ùv4
))

2420 && (! 
i‚ame
 || 
	`°rcmp
 (i‚ame, 
si
->
g©e
.ifname) == 0))

2424 i‡(! 
si
)

2426 
	`rouã_u∆ock_node
 (
∫
);

2431 
	`°©ic_unö°Æl_ùv4
 (
p
, 
si
);

2434 i‡(
si
->
¥ev
)

2435 
si
->
¥ev
->
√xt
 = si->next;

2437 
∫
->
öfo
 = 
si
->
√xt
;

2438 i‡(
si
->
√xt
)

2439 
si
->
√xt
->
¥ev
 = si->prev;

2440 
	`rouã_u∆ock_node
 (
∫
);

2443 i‡(
i‚ame
)

2444 
	`XFREE
 (0, 
si
->
g©e
.
i‚ame
);

2445 
	`XFREE
 (
MTYPE_STATIC_IPV4
, 
si
);

2447 
	`rouã_u∆ock_node
 (
∫
);

2450 
	}
}

2453 #ifde‡
HAVE_IPV6


2455 
	$rib_bogus_ùv6
 (
ty≥
, 
¥efix_ùv6
 *
p
,

2456 
ö6_addr
 *
g©e
, 
ifödex
, 
èbÀ
)

2458 i‡(
ty≥
 =
ZEBRA_ROUTE_CONNECT
 && 
	`IN6_IS_ADDR_UNSPECIFIED
 (&
p
->
¥efix
)) {

2459 #i‡
	`deföed
 (
MUSICA
Ë|| deföed (
LINUX
)

2461 i‡(
p
->
¥efixÀn
 == 96)

2466 i‡(
ty≥
 =
ZEBRA_ROUTE_KERNEL
 && 
	`IN6_IS_ADDR_UNSPECIFIED
 (&
p
->
¥efix
)

2467 && 
p
->
¥efixÀn
 =96 && 
g©e
 && 
	`IN6_IS_ADDR_UNSPECIFIED
 (gate))

2469 
	`kî√l_dñëe_ùv6_ﬁd
 (
p
, 
g©e
, 
ifödex
, 0, 
èbÀ
);

2473 
	}
}

2476 
	$rib_add_ùv6
 (
ty≥
, 
Êags
, 
¥efix_ùv6
 *
p
,

2477 
ö6_addr
 *
g©e
, 
ifödex
, 
u_öt32_t
 
vrf_id
,

2478 
u_öt32_t
 
mëric
, 
u_ch¨
 
di°™˚
, 
ßfi_t
 
ßfi
)

2480 
rib
 *rib;

2481 
rib
 *
ßme
 = 
NULL
;

2482 
rouã_èbÀ
 *
èbÀ
;

2483 
rouã_node
 *
∫
;

2484 
√xth›
 *nexthop;

2487 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
ßfi
, 0);

2488 i‡(! 
èbÀ
)

2492 
	`≠∂y_mask_ùv6
 (
p
);

2495 i‡(!
di°™˚
)

2496 
di°™˚
 = 
rouã_öfo
[
ty≥
].distance;

2498 i‡(
ty≥
 =
ZEBRA_ROUTE_BGP
 && 
	`CHECK_FLAG
 (
Êags
, 
ZEBRA_FLAG_IBGP
))

2499 
di°™˚
 = 200;

2502 i‡(
	`rib_bogus_ùv6
 (
ty≥
, 
p
, 
g©e
, 
ifödex
, 0))

2506 
∫
 = 
	`rouã_node_gë
 (
èbÀ
, (
¥efix
 *Ë
p
);

2510 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2512 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

2515 i‡(
rib
->
ty≥
 !=Åype)

2517 i‡(
rib
->
ty≥
 !
ZEBRA_ROUTE_CONNECT
)

2519 
ßme
 = 
rib
;

2522 i‡((
√xth›
 = 
rib
->nexthop) &&

2523 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX
 &&

2524 
√xth›
->
ifödex
 == ifindex)

2526 
rib
->
ªf˙t
++;

2532 
rib
 = 
	`XCALLOC
 (
MTYPE_RIB
,  (rib));

2534 
rib
->
ty≥
 =Åype;

2535 
rib
->
di°™˚
 = distance;

2536 
rib
->
Êags
 = flags;

2537 
rib
->
mëric
 = metric;

2538 
rib
->
èbÀ
 = 
vrf_id
;

2539 
rib
->
√xth›_num
 = 0;

2540 
rib
->
u±ime
 = 
	`time
 (
NULL
);

2543 i‡(
g©e
)

2545 i‡(
ifödex
)

2546 
	`√xth›_ùv6_ifödex_add
 (
rib
, 
g©e
, 
ifödex
);

2548 
	`√xth›_ùv6_add
 (
rib
, 
g©e
);

2551 
	`√xth›_ifödex_add
 (
rib
, 
ifödex
);

2554 i‡(
ty≥
 =
ZEBRA_ROUTE_KERNEL
 ||Åy≥ =
ZEBRA_ROUTE_CONNECT
)

2555 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

2556 
	`SET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

2559 
	`rib_addnode
 (
∫
, 
rib
);

2562 i‡(
ßme
)

2563 
	`rib_dñnode
 (
∫
, 
ßme
);

2565 
	`rouã_u∆ock_node
 (
∫
);

2567 
	}
}

2571 
	$rib_dñëe_ùv6
 (
ty≥
, 
Êags
, 
¥efix_ùv6
 *
p
,

2572 
ö6_addr
 *
g©e
, 
ifödex
, 
u_öt32_t
 
vrf_id
, 
ßfi_t
 
ßfi
)

2574 
rouã_èbÀ
 *
èbÀ
;

2575 
rouã_node
 *
∫
;

2576 
rib
 *rib;

2577 
rib
 *
fib
 = 
NULL
;

2578 
rib
 *
ßme
 = 
NULL
;

2579 
√xth›
 *nexthop;

2580 
buf1
[
INET6_ADDRSTRLEN
];

2581 
buf2
[
INET6_ADDRSTRLEN
];

2584 
	`≠∂y_mask_ùv6
 (
p
);

2587 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
ßfi
, 0);

2588 i‡(! 
èbÀ
)

2592 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *Ë
p
);

2593 i‡(! 
∫
)

2595 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

2597 i‡(
g©e
)

2598 
	`zlog_debug
 ("route %s/%d via %s ifindex %d doesn'tÉxist inÑib",

2599 
	`öë_¡›
 (
AF_INET6
, &
p
->
¥efix
, 
buf1
, 
INET6_ADDRSTRLEN
),

2600 
p
->
¥efixÀn
,

2601 
	`öë_¡›
 (
AF_INET6
, 
g©e
, 
buf2
, 
INET6_ADDRSTRLEN
),

2602 
ifödex
);

2604 
	`zlog_debug
 ("route %s/%d ifindex %d doesn'tÉxist inÑib",

2605 
	`öë_¡›
 (
AF_INET6
, &
p
->
¥efix
, 
buf1
, 
INET6_ADDRSTRLEN
),

2606 
p
->
¥efixÀn
,

2607 
ifödex
);

2609  
ZEBRA_ERR_RTNOEXIST
;

2613 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2615 i‡(
	`CHECK_FLAG
(
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

2618 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

2619 
fib
 = 
rib
;

2621 i‡(
rib
->
ty≥
 !=Åype)

2623 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_CONNECT
 && (
√xth›
 =Ñib->nexthop) &&

2624 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX
)

2626 i‡(
√xth›
->
ifödex
 != ifindex)

2628 i‡(
rib
->
ªf˙t
)

2630 
rib
->
ªf˙t
--;

2631 
	`rouã_u∆ock_node
 (
∫
);

2632 
	`rouã_u∆ock_node
 (
∫
);

2635 
ßme
 = 
rib
;

2639 i‡(
g©e
 =
NULL
 ||

2640 ((
√xth›
 = 
rib
->nexthop) &&

2641 (
	`IPV6_ADDR_SAME
 (&
√xth›
->
g©e
.
ùv6
, gate) ||

2642 
	`IPV6_ADDR_SAME
 (&
√xth›
->
rg©e
.
ùv6
, 
g©e
))))

2644 
ßme
 = 
rib
;

2651 i‡(! 
ßme
)

2653 i‡(
fib
 && 
ty≥
 =
ZEBRA_ROUTE_KERNEL
)

2656 
√xth›
 = 
fib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

2657 
	`UNSET_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
);

2659 
	`UNSET_FLAG
 (
fib
->
Êags
, 
ZEBRA_FLAG_SELECTED
);

2663 i‡(
IS_ZEBRA_DEBUG_KERNEL
)

2665 i‡(
g©e
)

2666 
	`zlog_debug
 ("route %s/%d via %s ifindex %dÅype %d doesn'tÉxist inÑib",

2667 
	`öë_¡›
 (
AF_INET6
, &
p
->
¥efix
, 
buf1
, 
INET6_ADDRSTRLEN
),

2668 
p
->
¥efixÀn
,

2669 
	`öë_¡›
 (
AF_INET6
, 
g©e
, 
buf2
, 
INET6_ADDRSTRLEN
),

2670 
ifödex
,

2671 
ty≥
);

2673 
	`zlog_debug
 ("route %s/%d ifindex %dÅype %d doesn'tÉxist inÑib",

2674 
	`öë_¡›
 (
AF_INET6
, &
p
->
¥efix
, 
buf1
, 
INET6_ADDRSTRLEN
),

2675 
p
->
¥efixÀn
,

2676 
ifödex
,

2677 
ty≥
);

2679 
	`rouã_u∆ock_node
 (
∫
);

2680  
ZEBRA_ERR_RTNOEXIST
;

2684 i‡(
ßme
)

2685 
	`rib_dñnode
 (
∫
, 
ßme
);

2687 
	`rouã_u∆ock_node
 (
∫
);

2689 
	}
}

2693 
	$°©ic_ö°Æl_ùv6
 (
¥efix
 *
p
, 
°©ic_ùv6
 *
si
)

2695 
rib
 *rib;

2696 
rouã_èbÀ
 *
èbÀ
;

2697 
rouã_node
 *
∫
;

2700 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

2701 i‡(! 
èbÀ
)

2705 
∫
 = 
	`rouã_node_gë
 (
èbÀ
, 
p
);

2706 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2708 i‡(
	`CHECK_FLAG
(
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

2711 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_STATIC
 &&Ñib->
di°™˚
 =
si
->distance)

2715 i‡(
rib
)

2719 
	`rouã_u∆ock_node
 (
∫
);

2721 
si
->
ty≥
)

2723 
STATIC_IPV6_GATEWAY
:

2724 
	`√xth›_ùv6_add
 (
rib
, &
si
->
ùv6
);

2726 
STATIC_IPV6_IFNAME
:

2727 
	`√xth›_i‚ame_add
 (
rib
, 
si
->
i‚ame
);

2729 
STATIC_IPV6_GATEWAY_IFNAME
:

2730 
	`√xth›_ùv6_i‚ame_add
 (
rib
, &
si
->
ùv6
, si->
i‚ame
);

2733 
	`rib_queue_add
 (&
zebød
, 
∫
);

2738 
rib
 = 
	`XCALLOC
 (
MTYPE_RIB
,  (rib));

2740 
rib
->
ty≥
 = 
ZEBRA_ROUTE_STATIC
;

2741 
rib
->
di°™˚
 = 
si
->distance;

2742 
rib
->
mëric
 = 0;

2743 
rib
->
√xth›_num
 = 0;

2745 
si
->
ty≥
)

2747 
STATIC_IPV6_GATEWAY
:

2748 
	`√xth›_ùv6_add
 (
rib
, &
si
->
ùv6
);

2750 
STATIC_IPV6_IFNAME
:

2751 
	`√xth›_i‚ame_add
 (
rib
, 
si
->
i‚ame
);

2753 
STATIC_IPV6_GATEWAY_IFNAME
:

2754 
	`√xth›_ùv6_i‚ame_add
 (
rib
, &
si
->
ùv6
, si->
i‚ame
);

2759 
rib
->
Êags
 = 
si
->flags;

2762 
	`rib_addnode
 (
∫
, 
rib
);

2764 
	}
}

2767 
	$°©ic_ùv6_√xth›_ßme
 (
√xth›
 *√xth›, 
°©ic_ùv6
 *
si
)

2769 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6


2770 && 
si
->
ty≥
 =
STATIC_IPV6_GATEWAY


2771 && 
	`IPV6_ADDR_SAME
 (&
√xth›
->
g©e
.
ùv6
, &
si
->ipv6))

2773 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME


2774 && 
si
->
ty≥
 =
STATIC_IPV6_IFNAME


2775 && 
	`°rcmp
 (
√xth›
->
i‚ame
, 
si
->ifname) == 0)

2777 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME


2778 && 
si
->
ty≥
 =
STATIC_IPV6_GATEWAY_IFNAME


2779 && 
	`IPV6_ADDR_SAME
 (&
√xth›
->
g©e
.
ùv6
, &
si
->ipv6)

2780 && 
	`°rcmp
 (
√xth›
->
i‚ame
, 
si
->ifname) == 0)

2783 
	}
}

2786 
	$°©ic_unö°Æl_ùv6
 (
¥efix
 *
p
, 
°©ic_ùv6
 *
si
)

2788 
rouã_èbÀ
 *
èbÀ
;

2789 
rouã_node
 *
∫
;

2790 
rib
 *rib;

2791 
√xth›
 *nexthop;

2794 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

2795 i‡(! 
èbÀ
)

2799 
∫
 = 
	`rouã_node_lookup
 (
èbÀ
, (
¥efix
 *Ë
p
);

2800 i‡(! 
∫
)

2803 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2805 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

2808 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_STATIC
 &&Ñib->
di°™˚
 =
si
->distance)

2812 i‡(! 
rib
)

2814 
	`rouã_u∆ock_node
 (
∫
);

2819 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

2820 i‡(
	`°©ic_ùv6_√xth›_ßme
 (
√xth›
, 
si
))

2824 i‡(! 
√xth›
)

2826 
	`rouã_u∆ock_node
 (
∫
);

2831 i‡(
rib
->
√xth›_num
 == 1)

2833 
	`rib_dñnode
 (
∫
, 
rib
);

2837 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

2838 
	`rib_unö°Æl
 (
∫
, 
rib
);

2839 
	`√xth›_dñëe
 (
rib
, 
√xth›
);

2840 
	`√xth›_‰ì
 (
√xth›
);

2841 
	`rib_queue_add
 (&
zebød
, 
∫
);

2844 
	`rouã_u∆ock_node
 (
∫
);

2845 
	}
}

2849 
	$°©ic_add_ùv6
 (
¥efix
 *
p
, 
u_ch¨
 
ty≥
, 
ö6_addr
 *
g©e
,

2850 c⁄° *
i‚ame
, 
u_ch¨
 
Êags
, u_ch¨ 
di°™˚
,

2851 
u_öt32_t
 
vrf_id
)

2853 
rouã_node
 *
∫
;

2854 
°©ic_ùv6
 *
si
;

2855 
°©ic_ùv6
 *
µ
;

2856 
°©ic_ùv6
 *
˝
;

2857 
rouã_èbÀ
 *
°abÀ
;

2860 
°abÀ
 = 
	`vrf_°©ic_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 
vrf_id
);

2861 i‡(! 
°abÀ
)

2864 i‡(!
g©e
 &&

2865 (
ty≥
 =
STATIC_IPV6_GATEWAY
 ||Åy≥ =
STATIC_IPV6_GATEWAY_IFNAME
))

2868 i‡(!
i‚ame
 &&

2869 (
ty≥
 =
STATIC_IPV6_GATEWAY_IFNAME
 ||Åy≥ =
STATIC_IPV6_IFNAME
))

2873 
∫
 = 
	`rouã_node_gë
 (
°abÀ
, 
p
);

2876 
si
 = 
∫
->
öfo
; si; sòsi->
√xt
)

2878 i‡(
di°™˚
 =
si
->distance

2879 && 
ty≥
 =
si
->type

2880 && (! 
g©e
 || 
	`IPV6_ADDR_SAME
 (g©e, &
si
->
ùv6
))

2881 && (! 
i‚ame
 || 
	`°rcmp
 (i‚ame, 
si
->ifname) == 0))

2883 
	`rouã_u∆ock_node
 (
∫
);

2889 
si
 = 
	`XCALLOC
 (
MTYPE_STATIC_IPV6
,  (
°©ic_ùv6
));

2891 
si
->
ty≥
 =Åype;

2892 
si
->
di°™˚
 = distance;

2893 
si
->
Êags
 = flags;

2895 
ty≥
)

2897 
STATIC_IPV6_GATEWAY
:

2898 
si
->
ùv6
 = *
g©e
;

2900 
STATIC_IPV6_IFNAME
:

2901 
si
->
i‚ame
 = 
	`XSTRDUP
 (0, ifname);

2903 
STATIC_IPV6_GATEWAY_IFNAME
:

2904 
si
->
ùv6
 = *
g©e
;

2905 
si
->
i‚ame
 = 
	`XSTRDUP
 (0, ifname);

2911 
µ
 = 
NULL
, 
˝
 = 
∫
->
öfo
; cp;Ö∞˝, c∞˝->
√xt
)

2913 i‡(
si
->
di°™˚
 < 
˝
->distance)

2915 i‡(
si
->
di°™˚
 > 
˝
->distance)

2920 i‡(
µ
)

2921 
µ
->
√xt
 = 
si
;

2923 
∫
->
öfo
 = 
si
;

2924 i‡(
˝
)

2925 
˝
->
¥ev
 = 
si
;

2926 
si
->
¥ev
 = 
µ
;

2927 
si
->
√xt
 = 
˝
;

2930 
	`°©ic_ö°Æl_ùv6
 (
p
, 
si
);

2933 
	}
}

2937 
	$°©ic_dñëe_ùv6
 (
¥efix
 *
p
, 
u_ch¨
 
ty≥
, 
ö6_addr
 *
g©e
,

2938 c⁄° *
i‚ame
, 
u_ch¨
 
di°™˚
, 
u_öt32_t
 
vrf_id
)

2940 
rouã_node
 *
∫
;

2941 
°©ic_ùv6
 *
si
;

2942 
rouã_èbÀ
 *
°abÀ
;

2945 
°abÀ
 = 
	`vrf_°©ic_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 
vrf_id
);

2946 i‡(! 
°abÀ
)

2950 
∫
 = 
	`rouã_node_lookup
 (
°abÀ
, 
p
);

2951 i‡(! 
∫
)

2955 
si
 = 
∫
->
öfo
; si; sòsi->
√xt
)

2956 i‡(
di°™˚
 =
si
->distance

2957 && 
ty≥
 =
si
->type

2958 && (! 
g©e
 || 
	`IPV6_ADDR_SAME
 (g©e, &
si
->
ùv6
))

2959 && (! 
i‚ame
 || 
	`°rcmp
 (i‚ame, 
si
->ifname) == 0))

2963 i‡(! 
si
)

2965 
	`rouã_u∆ock_node
 (
∫
);

2970 
	`°©ic_unö°Æl_ùv6
 (
p
, 
si
);

2973 i‡(
si
->
¥ev
)

2974 
si
->
¥ev
->
√xt
 = si->next;

2976 
∫
->
öfo
 = 
si
->
√xt
;

2977 i‡(
si
->
√xt
)

2978 
si
->
√xt
->
¥ev
 = si->prev;

2981 i‡(
i‚ame
)

2982 
	`XFREE
 (0, 
si
->
i‚ame
);

2983 
	`XFREE
 (
MTYPE_STATIC_IPV6
, 
si
);

2986 
	}
}

2991 
	$rib_upd©e
 ()

2993 
rouã_node
 *
∫
;

2994 
rouã_èbÀ
 *
èbÀ
;

2996 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

2997 i‡(
èbÀ
)

2998 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

2999 i‡(
	`∫ode_to_ribs
 (
∫
))

3000 
	`rib_queue_add
 (&
zebød
, 
∫
);

3002 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

3003 i‡(
èbÀ
)

3004 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

3005 i‡(
	`∫ode_to_ribs
 (
∫
))

3006 
	`rib_queue_add
 (&
zebød
, 
∫
);

3007 
	}
}

3012 
	$rib_wìd_èbÀ
 (
rouã_èbÀ
 *
èbÀ
)

3014 
rouã_node
 *
∫
;

3015 
rib
 *rib;

3016 
rib
 *
√xt
;

3018 i‡(
èbÀ
)

3019 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

3020 
	`RNODE_FOREACH_RIB_SAFE
 (
∫
, 
rib
, 
√xt
)

3022 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

3025 i‡(
rib
->
èbÀ
 !
zebød
.
πm_èbÀ_deÁu…
 &&

3026 
rib
->
èbÀ
 !
RT_TABLE_MAIN
)

3027 
	`rib_dñnode
 (
∫
, 
rib
);

3029 
	}
}

3033 
	$rib_wìd_èbÀs
 ()

3035 
	`rib_wìd_èbÀ
 (
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0));

3036 
	`rib_wìd_èbÀ
 (
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0));

3037 
	}
}

3041 
	$rib_swìp_èbÀ
 (
rouã_èbÀ
 *
èbÀ
)

3043 
rouã_node
 *
∫
;

3044 
rib
 *rib;

3045 
rib
 *
√xt
;

3046 
ªt
 = 0;

3048 i‡(
èbÀ
)

3049 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

3050 
	`RNODE_FOREACH_RIB_SAFE
 (
∫
, 
rib
, 
√xt
)

3052 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

3055 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_KERNEL
 &&

3056 
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELFROUTE
))

3058 
ªt
 = 
	`rib_unö°Æl_kî√l
 (
∫
, 
rib
);

3059 i‡(! 
ªt
)

3060 
	`rib_dñnode
 (
∫
, 
rib
);

3063 
	}
}

3067 
	$rib_swìp_rouã
 ()

3069 
	`rib_swìp_èbÀ
 (
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0));

3070 
	`rib_swìp_èbÀ
 (
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0));

3071 
	}
}

3075 
	$rib_sc‹e_¥Ÿo_èbÀ
 (
u_ch¨
 
¥Ÿo
, 
rouã_èbÀ
 *
èbÀ
)

3077 
rouã_node
 *
∫
;

3078 
rib
 *rib;

3079 
rib
 *
√xt
;

3080 
n
 = 0;

3082 i‡(
èbÀ
)

3083 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

3084 
	`RNODE_FOREACH_RIB_SAFE
 (
∫
, 
rib
, 
√xt
)

3086 i‡(
	`CHECK_FLAG
 (
rib
->
°©us
, 
RIB_ENTRY_REMOVED
))

3088 i‡(
rib
->
ty≥
 =
¥Ÿo
)

3090 
	`rib_dñnode
 (
∫
, 
rib
);

3091 
n
++;

3095  
n
;

3096 
	}
}

3100 
	$rib_sc‹e_¥Ÿo
 (
u_ch¨
 
¥Ÿo
)

3102  
	`rib_sc‹e_¥Ÿo_èbÀ
 (
¥Ÿo
, 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0))

3103 +
	`rib_sc‹e_¥Ÿo_èbÀ
 (
¥Ÿo
, 
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0));

3104 
	}
}

3108 
	$rib_˛o£_èbÀ
 (
rouã_èbÀ
 *
èbÀ
)

3110 
rouã_node
 *
∫
;

3111 
rib
 *rib;

3113 i‡(
èbÀ
)

3114 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

3115 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

3117 i‡(!
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

3120 
	`zÂm_åiggî_upd©e
 (
∫
, 
NULL
);

3122 i‡(! 
	`RIB_SYSTEM_ROUTE
 (
rib
))

3123 
	`rib_unö°Æl_kî√l
 (
∫
, 
rib
);

3125 
	}
}

3129 
	$rib_˛o£
 ()

3131 
	`rib_˛o£_èbÀ
 (
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0));

3132 
	`rib_˛o£_èbÀ
 (
	`vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0));

3133 
	}
}

3137 
	$rib_öô
 ()

3139 
	`rib_queue_öô
 (&
zebød
);

3141 
	`vrf_öô
 ();

3142 
	}
}

3151 
ölöe
 

3152 
	$vrf_id_gë_√xt
 (
uöt32_t
 
id
, uöt32_à*
√xt_id_p
)

3154 ++
id
 < 
	`ve˘‹_a˘ive
 (
vrf_ve˘‹
))

3156 i‡(
	`vrf_lookup
 (
id
))

3158 *
√xt_id_p
 = 
id
;

3164 
	}
}

3171 
rouã_èbÀ
 *

3172 
	$rib_èbÀs_ôî_√xt
 (
rib_èbÀs_ôî_t
 *
ôî
)

3174 
rouã_èbÀ
 *
èbÀ
;

3181 
afi_t
 
afi
;

3182 
ßfi_t
 
ßfi
;

3183 } 
afi_ßfis
[] = {

3184 { 
AFI_IP
, 
SAFI_UNICAST
 },

3185 { 
AFI_IP
, 
SAFI_MULTICAST
 },

3186 { 
AFI_IP6
, 
SAFI_UNICAST
 },

3187 { 
AFI_IP6
, 
SAFI_MULTICAST
 },

3190 
èbÀ
 = 
NULL
;

3192 
ôî
->
°©e
)

3195 
RIB_TABLES_ITER_S_INIT
:

3196 
ôî
->
vrf_id
 = 0;

3197 
ôî
->
afi_ßfi_ix
 = -1;

3201 
RIB_TABLES_ITER_S_ITERATING
:

3202 
ôî
->
afi_ßfi_ix
++;

3206 
ôî
->
afi_ßfi_ix
 < (Ë
	`ZEBRA_NUM_OF
 (
afi_ßfis
))

3208 
èbÀ
 = 
	`vrf_èbÀ
 (
afi_ßfis
[
ôî
->
afi_ßfi_ix
].
afi
,

3209 
afi_ßfis
[
ôî
->
afi_ßfi_ix
].
ßfi
,

3210 
ôî
->
vrf_id
);

3211 i‡(
èbÀ
)

3214 
ôî
->
afi_ßfi_ix
++;

3220 i‡(
èbÀ
)

3227 i‡(!
	`vrf_id_gë_√xt
 (
ôî
->
vrf_id
, &iter->vrf_id))

3230 
ôî
->
afi_ßfi_ix
 = 0;

3235 
RIB_TABLES_ITER_S_DONE
:

3236  
NULL
;

3239 i‡(
èbÀ
)

3240 
ôî
->
°©e
 = 
RIB_TABLES_ITER_S_ITERATING
;

3242 
ôî
->
°©e
 = 
RIB_TABLES_ITER_S_DONE
;

3244  
èbÀ
;

3245 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_routemap.c

22 
	~<zebø.h
>

24 
	~"mem‹y.h
"

25 
	~"¥efix.h
"

26 
	~"rib.h
"

27 
	~"rouãm≠.h
"

28 
	~"comm™d.h
"

29 
	~"fûãr.h
"

30 
	~"∂i°.h
"

32 
	~"zebø/z£rv.h
"

36 
	$zebø_rouã_m©ch_add
(
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

37 c⁄° *
comm™d
, c⁄° *
¨g
)

39 
ªt
;

41 
ªt
 = 
	`rouã_m≠_add_m©ch
 (
ödex
, 
comm™d
, 
¨g
);

42 i‡(
ªt
)

44 
ªt
)

46 
RMAP_RULE_MISSING
:

47 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

48  
CMD_WARNING
;

49 
RMAP_COMPILE_ERROR
:

50 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

51  
CMD_WARNING
;

54  
CMD_SUCCESS
;

55 
	}
}

59 
	$zebø_rouã_m©ch_dñëe
 (
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

60 c⁄° *
comm™d
, c⁄° *
¨g
)

62 
ªt
;

64 
ªt
 = 
	`rouã_m≠_dñëe_m©ch
 (
ödex
, 
comm™d
, 
¨g
);

65 i‡(
ªt
)

67 
ªt
)

69 
RMAP_RULE_MISSING
:

70 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

71  
CMD_WARNING
;

72 
RMAP_COMPILE_ERROR
:

73 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

74  
CMD_WARNING
;

77  
CMD_SUCCESS
;

78 
	}
}

82 
	$zebø_rouã_£t_add
 (
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

83 c⁄° *
comm™d
, c⁄° *
¨g
)

85 
ªt
;

87 
ªt
 = 
	`rouã_m≠_add_£t
 (
ödex
, 
comm™d
, 
¨g
);

88 i‡(
ªt
)

90 
ªt
)

92 
RMAP_RULE_MISSING
:

93 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

94  
CMD_WARNING
;

95 
RMAP_COMPILE_ERROR
:

96 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

97  
CMD_WARNING
;

100  
CMD_SUCCESS
;

101 
	}
}

105 
	$zebø_rouã_£t_dñëe
 (
vty
 *vty, 
rouã_m≠_ödex
 *
ödex
,

106 c⁄° *
comm™d
, c⁄° *
¨g
)

108 
ªt
;

110 
ªt
 = 
	`rouã_m≠_dñëe_£t
 (
ödex
, 
comm™d
, 
¨g
);

111 i‡(
ªt
)

113 
ªt
)

115 
RMAP_RULE_MISSING
:

116 
	`vty_out
 (
vty
, "%% C™'àfödÑuÀ.%s", 
VTY_NEWLINE
);

117  
CMD_WARNING
;

118 
RMAP_COMPILE_ERROR
:

119 
	`vty_out
 (
vty
, "%% Argumíài†mÆf‹med.%s", 
VTY_NEWLINE
);

120  
CMD_WARNING
;

123  
CMD_SUCCESS
;

124 
	}
}

129 
rouã_m≠_ªsu…_t


130 
	$rouã_m©ch_öãrÁ˚
 (*
ruÀ
, 
¥efix
 *prefix,

131 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

133 
√xth›
 *nexthop;

134 *
i‚ame
 = 
ruÀ
;

135 
ifödex
;

137 i‡(
ty≥
 =
RMAP_ZEBRA
)

139 i‡(
	`°rˇ£cmp
(
i‚ame
, "any") == 0)

140  
RMAP_MATCH
;

141 
ifödex
 = 
	`i‚ame2ifödex
(
i‚ame
);

142 i‡(
ifödex
 == 0)

143  
RMAP_NOMATCH
;

144 
√xth›
 = 
obje˘
;

145 i‡(!
√xth›
)

146  
RMAP_NOMATCH
;

147 i‡(
√xth›
->
ifödex
 == ifindex)

148  
RMAP_MATCH
;

150  
RMAP_NOMATCH
;

151 
	}
}

155 
	$rouã_m©ch_öãrÁ˚_compûe
 (c⁄° *
¨g
)

157  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

158 
	}
}

162 
	$rouã_m©ch_öãrÁ˚_‰ì
 (*
ruÀ
)

164 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

165 
	}
}

168 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_öãrÁ˚_cmd
 =

171 
rouã_m©ch_öãrÁ˚
,

172 
rouã_m©ch_öãrÁ˚_compûe
,

173 
rouã_m©ch_öãrÁ˚_‰ì


176 
DEFUN
 (
m©ch_öãrÁ˚
,

177 
m©ch_öãrÁ˚_cmd
,

179 
MATCH_STR


183  
zebø_rouã_m©ch_add
 (
vty
, vty->
ödex
, "öãrÁ˚", 
¨gv
[0]);

186 
DEFUN
 (
no_m©ch_öãrÁ˚
,

187 
no_m©ch_öãrÁ˚_cmd
,

189 
NO_STR


190 
MATCH_STR


193 i‡(
	g¨gc
 == 0)

194  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "öãrÁ˚", 
NULL
);

196  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "öãrÁ˚", 
¨gv
[0]);

199 
ALIAS
 (
no_m©ch_öãrÁ˚
,

200 
no_m©ch_öãrÁ˚_vÆ_cmd
,

202 
NO_STR


203 
MATCH_STR


207 
DEFUN
 (
m©ch_ù_√xt_h›
,

208 
m©ch_ù_√xt_h›_cmd
,

210 
MATCH_STR


211 
IP_STR


217  
zebø_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùÇext-h›", 
¨gv
[0]);

220 
DEFUN
 (
no_m©ch_ù_√xt_h›
,

221 
no_m©ch_ù_√xt_h›_cmd
,

223 
NO_STR


224 
MATCH_STR


225 
IP_STR


228 i‡(
	g¨gc
 == 0)

229  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›", 
NULL
);

231  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›", 
¨gv
[0]);

234 
ALIAS
 (
no_m©ch_ù_√xt_h›
,

235 
no_m©ch_ù_√xt_h›_vÆ_cmd
,

237 
NO_STR


238 
MATCH_STR


239 
IP_STR


245 
DEFUN
 (
m©ch_ù_√xt_h›_¥efix_li°
,

246 
m©ch_ù_√xt_h›_¥efix_li°_cmd
,

248 
MATCH_STR


249 
IP_STR


254  
zebø_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùÇext-h›Öªfix-li°", 
¨gv
[0]);

257 
DEFUN
 (
no_m©ch_ù_√xt_h›_¥efix_li°
,

258 
no_m©ch_ù_√xt_h›_¥efix_li°_cmd
,

260 
NO_STR


261 
MATCH_STR


262 
IP_STR


266 i‡(
	g¨gc
 == 0)

267  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›Öªfix-li°", 
NULL
);

269  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùÇext-h›Öªfix-li°", 
¨gv
[0]);

272 
ALIAS
 (
no_m©ch_ù_√xt_h›_¥efix_li°
,

273 
no_m©ch_ù_√xt_h›_¥efix_li°_vÆ_cmd
,

275 
NO_STR


276 
MATCH_STR


277 
IP_STR


282 
DEFUN
 (
m©ch_ù_addªss
,

283 
m©ch_ù_addªss_cmd
,

285 
MATCH_STR


286 
IP_STR


293  
zebø_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùáddªss", 
¨gv
[0]);

296 
DEFUN
 (
no_m©ch_ù_addªss
,

297 
no_m©ch_ù_addªss_cmd
,

299 
NO_STR


300 
MATCH_STR


301 
IP_STR


304 i‡(
	g¨gc
 == 0)

305  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªss", 
NULL
);

307  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªss", 
¨gv
[0]);

310 
ALIAS
 (
no_m©ch_ù_addªss
,

311 
no_m©ch_ù_addªss_vÆ_cmd
,

313 
NO_STR


314 
MATCH_STR


315 
IP_STR


321 
DEFUN
 (
m©ch_ù_addªss_¥efix_li°
,

322 
m©ch_ù_addªss_¥efix_li°_cmd
,

324 
MATCH_STR


325 
IP_STR


330  
zebø_rouã_m©ch_add
 (
vty
, vty->
ödex
, "ùáddªs†¥efix-li°", 
¨gv
[0]);

333 
DEFUN
 (
no_m©ch_ù_addªss_¥efix_li°
,

334 
no_m©ch_ù_addªss_¥efix_li°_cmd
,

336 
NO_STR


337 
MATCH_STR


338 
IP_STR


342 i‡(
	g¨gc
 == 0)

343  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªs†¥efix-li°", 
NULL
);

345  
zebø_rouã_m©ch_dñëe
 (
vty
, vty->
ödex
, "ùáddªs†¥efix-li°", 
¨gv
[0]);

348 
ALIAS
 (
no_m©ch_ù_addªss_¥efix_li°
,

349 
no_m©ch_ù_addªss_¥efix_li°_vÆ_cmd
,

351 
NO_STR


352 
MATCH_STR


353 
IP_STR


360 
DEFUN
 (
£t_§c
,

361 
£t_§c_cmd
,

363 
SET_STR


367 
ö_addr
 
	g§c
;

368 
öãrÁ˚
 *
	gpif
;

370 i‡(
öë_±⁄
(
AF_INET
, 
¨gv
[0], &
§c
) <= 0)

372 
vty_out
 (
vty
, "%%ÇŸáÜoˇ»addªss%s", 
VTY_NEWLINE
);

373  
	gCMD_WARNING
;

376 
	gpif
 = 
if_lookup_exa˘_addªss
 (
§c
);

377 i‡(!
	gpif
)

379 
vty_out
 (
vty
, "%%ÇŸáÜoˇ»addªss%s", 
VTY_NEWLINE
);

380  
	gCMD_WARNING
;

382  
zebø_rouã_£t_add
 (
vty
, vty->
ödex
, "§c", 
¨gv
[0]);

385 
DEFUN
 (
no_£t_§c
,

386 
no_£t_§c_cmd
,

388 
NO_STR


389 
SET_STR


392 i‡(
	g¨gc
 == 0)

393  
zebø_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "§c", 
NULL
);

395  
zebø_rouã_£t_dñëe
 (
vty
, vty->
ödex
, "§c", 
¨gv
[0]);

398 
ALIAS
 (
no_£t_§c
,

399 
no_£t_§c_vÆ_cmd
,

401 
NO_STR


402 
SET_STR


411 
rouã_m≠_ªsu…_t


412 
	$rouã_m©ch_ù_√xt_h›
 (*
ruÀ
, 
¥efix
 *prefix,

413 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

415 
ac˚ss_li°
 *
Æi°
;

416 
√xth›
 *nexthop;

417 
¥efix_ùv4
 
p
;

419 i‡(
ty≥
 =
RMAP_ZEBRA
)

421 
√xth›
 = 
obje˘
;

422 
√xth›
->
ty≥
) {

423 
NEXTHOP_TYPE_IFINDEX
:

424 
NEXTHOP_TYPE_IFNAME
:

425 
NEXTHOP_TYPE_IPV4_IFINDEX
:

426 
NEXTHOP_TYPE_IPV4_IFNAME
:

427 i‡(
√xth›
->
πy≥
 !
NEXTHOP_TYPE_IPV4
)

428  
RMAP_NOMATCH
;

429 
p
.
Ámûy
 = 
AF_INET
;

430 
p
.
¥efix
 = 
√xth›
->
rg©e
.
ùv4
;

431 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

433 
NEXTHOP_TYPE_IPV4
:

434 
p
.
Ámûy
 = 
AF_INET
;

435 
p
.
¥efix
 = 
√xth›
->
g©e
.
ùv4
;

436 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

439  
RMAP_NOMATCH
;

441 
Æi°
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

442 i‡(
Æi°
 =
NULL
)

443  
RMAP_NOMATCH
;

445  (
	`ac˚ss_li°_≠∂y
 (
Æi°
, &
p
Ë=
FILTER_DENY
 ?

446 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

448  
RMAP_NOMATCH
;

449 
	}
}

454 
	$rouã_m©ch_ù_√xt_h›_compûe
 (c⁄° *
¨g
)

456  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

457 
	}
}

461 
	$rouã_m©ch_ù_√xt_h›_‰ì
 (*
ruÀ
)

463 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

464 
	}
}

467 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_√xt_h›_cmd
 =

470 
rouã_m©ch_ù_√xt_h›
,

471 
rouã_m©ch_ù_√xt_h›_compûe
,

472 
rouã_m©ch_ù_√xt_h›_‰ì


477 
rouã_m≠_ªsu…_t


478 
	$rouã_m©ch_ù_√xt_h›_¥efix_li°
 (*
ruÀ
, 
¥efix
 *prefix,

479 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

481 
¥efix_li°
 *
∂i°
;

482 
√xth›
 *nexthop;

483 
¥efix_ùv4
 
p
;

485 i‡(
ty≥
 =
RMAP_ZEBRA
)

487 
√xth›
 = 
obje˘
;

488 
√xth›
->
ty≥
) {

489 
NEXTHOP_TYPE_IFINDEX
:

490 
NEXTHOP_TYPE_IFNAME
:

491 
NEXTHOP_TYPE_IPV4_IFINDEX
:

492 
NEXTHOP_TYPE_IPV4_IFNAME
:

493 i‡(
√xth›
->
πy≥
 !
NEXTHOP_TYPE_IPV4
)

494  
RMAP_NOMATCH
;

495 
p
.
Ámûy
 = 
AF_INET
;

496 
p
.
¥efix
 = 
√xth›
->
rg©e
.
ùv4
;

497 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

499 
NEXTHOP_TYPE_IPV4
:

500 
p
.
Ámûy
 = 
AF_INET
;

501 
p
.
¥efix
 = 
√xth›
->
g©e
.
ùv4
;

502 
p
.
¥efixÀn
 = 
IPV4_MAX_BITLEN
;

505  
RMAP_NOMATCH
;

507 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

508 i‡(
∂i°
 =
NULL
)

509  
RMAP_NOMATCH
;

511  (
	`¥efix_li°_≠∂y
 (
∂i°
, &
p
Ë=
PREFIX_DENY
 ?

512 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

514  
RMAP_NOMATCH
;

515 
	}
}

518 
	$rouã_m©ch_ù_√xt_h›_¥efix_li°_compûe
 (c⁄° *
¨g
)

520  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

521 
	}
}

524 
	$rouã_m©ch_ù_√xt_h›_¥efix_li°_‰ì
 (*
ruÀ
)

526 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

527 
	}
}

529 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_√xt_h›_¥efix_li°_cmd
 =

532 
rouã_m©ch_ù_√xt_h›_¥efix_li°
,

533 
rouã_m©ch_ù_√xt_h›_¥efix_li°_compûe
,

534 
rouã_m©ch_ù_√xt_h›_¥efix_li°_‰ì


541 
rouã_m≠_ªsu…_t


542 
	$rouã_m©ch_ù_addªss
 (*
ruÀ
, 
¥efix
 *prefix,

543 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

545 
ac˚ss_li°
 *
Æi°
;

547 i‡(
ty≥
 =
RMAP_ZEBRA
)

549 
Æi°
 = 
	`ac˚ss_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

550 i‡(
Æi°
 =
NULL
)

551  
RMAP_NOMATCH
;

553  (
	`ac˚ss_li°_≠∂y
 (
Æi°
, 
¥efix
Ë=
FILTER_DENY
 ?

554 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

556  
RMAP_NOMATCH
;

557 
	}
}

562 
	$rouã_m©ch_ù_addªss_compûe
 (c⁄° *
¨g
)

564  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

565 
	}
}

569 
	$rouã_m©ch_ù_addªss_‰ì
 (*
ruÀ
)

571 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

572 
	}
}

575 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_addªss_cmd
 =

578 
rouã_m©ch_ù_addªss
,

579 
rouã_m©ch_ù_addªss_compûe
,

580 
rouã_m©ch_ù_addªss_‰ì


585 
rouã_m≠_ªsu…_t


586 
	$rouã_m©ch_ù_addªss_¥efix_li°
 (*
ruÀ
, 
¥efix
 *prefix,

587 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

589 
¥efix_li°
 *
∂i°
;

591 i‡(
ty≥
 =
RMAP_ZEBRA
)

593 
∂i°
 = 
	`¥efix_li°_lookup
 (
AFI_IP
, (*Ë
ruÀ
);

594 i‡(
∂i°
 =
NULL
)

595  
RMAP_NOMATCH
;

597  (
	`¥efix_li°_≠∂y
 (
∂i°
, 
¥efix
Ë=
PREFIX_DENY
 ?

598 
RMAP_NOMATCH
 : 
RMAP_MATCH
);

600  
RMAP_NOMATCH
;

601 
	}
}

604 
	$rouã_m©ch_ù_addªss_¥efix_li°_compûe
 (c⁄° *
¨g
)

606  
	`XSTRDUP
 (
MTYPE_ROUTE_MAP_COMPILED
, 
¨g
);

607 
	}
}

610 
	$rouã_m©ch_ù_addªss_¥efix_li°_‰ì
 (*
ruÀ
)

612 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

613 
	}
}

615 
rouã_m≠_ruÀ_cmd
 
	grouã_m©ch_ù_addªss_¥efix_li°_cmd
 =

618 
rouã_m©ch_ù_addªss_¥efix_li°
,

619 
rouã_m©ch_ù_addªss_¥efix_li°_compûe
,

620 
rouã_m©ch_ù_addªss_¥efix_li°_‰ì


627 
rouã_m≠_ªsu…_t


628 
	$rouã_£t_§c
 (*
ruÀ
, 
¥efix
 *prefix,

629 
rouã_m≠_obje˘_t
 
ty≥
, *
obje˘
)

631 i‡(
ty≥
 =
RMAP_ZEBRA
)

633 
√xth›
 *nexthop;

635 
√xth›
 = 
obje˘
;

636 
√xth›
->
§c
 = *(
g_addr
 *)
ruÀ
;

638  
RMAP_OKAY
;

639 
	}
}

643 
	$rouã_£t_§c_compûe
 (c⁄° *
¨g
)

645 
g_addr
 
§c
, *
p§c
;

647 i‡(
	`öë_±⁄
(
AF_INET
, 
¨g
, &
§c
.
ùv4
) != 1

648 #ifde‡
HAVE_IPV6


649 && 
	`öë_±⁄
(
AF_INET6
, 
¨g
, &
§c
.
ùv6
) != 1

652  
NULL
;

654 
p§c
 = 
	`XMALLOC
 (
MTYPE_ROUTE_MAP_COMPILED
,  (
g_addr
));

655 *
p§c
 = 
§c
;

657  
p§c
;

658 
	}
}

662 
	$rouã_£t_§c_‰ì
 (*
ruÀ
)

664 
	`XFREE
 (
MTYPE_ROUTE_MAP_COMPILED
, 
ruÀ
);

665 
	}
}

668 
rouã_m≠_ruÀ_cmd
 
	grouã_£t_§c_cmd
 =

671 
rouã_£t_§c
,

672 
rouã_£t_§c_compûe
,

673 
rouã_£t_§c_‰ì
,

677 
	$zebø_rouã_m≠_öô
 ()

679 
	`rouã_m≠_öô
 ();

680 
	`rouã_m≠_öô_vty
 ();

682 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_öãrÁ˚_cmd
);

683 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_√xt_h›_cmd
);

684 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_√xt_h›_¥efix_li°_cmd
);

685 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_addªss_cmd
);

686 
	`rouã_m≠_ö°Æl_m©ch
 (&
rouã_m©ch_ù_addªss_¥efix_li°_cmd
);

688 
	`rouã_m≠_ö°Æl_£t
 (&
rouã_£t_§c_cmd
);

690 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_öãrÁ˚_cmd
);

691 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_öãrÁ˚_cmd
);

692 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_öãrÁ˚_vÆ_cmd
);

693 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_√xt_h›_cmd
);

694 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_cmd
);

695 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_vÆ_cmd
);

696 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_√xt_h›_¥efix_li°_cmd
);

697 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_¥efix_li°_cmd
);

698 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_√xt_h›_¥efix_li°_vÆ_cmd
);

699 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_addªss_cmd
);

700 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_cmd
);

701 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_vÆ_cmd
);

702 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
m©ch_ù_addªss_¥efix_li°_cmd
);

703 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_¥efix_li°_cmd
);

704 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_m©ch_ù_addªss_¥efix_li°_vÆ_cmd
);

706 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
£t_§c_cmd
);

707 
	`ö°Æl_ñemít
 (
RMAP_NODE
, &
no_£t_§c_cmd
);

708 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_snmp.c

22 
	~<zebø.h
>

24 #ifde‡
HAVE_SNMP


25 
	~<√t-¢mp/√t-¢mp-c⁄fig.h
>

26 
	~<√t-¢mp/√t-¢mp-ö˛udes.h
>

28 
	~"if.h
"

29 
	~"log.h
"

30 
	~"¥efix.h
"

31 
	~"comm™d.h
"

32 
	~"smux.h
"

33 
	~"èbÀ.h
"

35 
	~"zebø/rib.h
"

36 
	~"zebø/z£rv.h
"

38 
	#IPFWMIB
 1,3,6,1,2,1,4,24

	)

41 
	#IPFORWARDDEST
 1

	)

42 
	#IPFORWARDMASK
 2

	)

43 
	#IPFORWARDPOLICY
 3

	)

44 
	#IPFORWARDNEXTHOP
 4

	)

45 
	#IPFORWARDIFINDEX
 5

	)

46 
	#IPFORWARDTYPE
 6

	)

47 
	#IPFORWARDPROTO
 7

	)

48 
	#IPFORWARDAGE
 8

	)

49 
	#IPFORWARDINFO
 9

	)

50 
	#IPFORWARDNEXTHOPAS
 10

	)

51 
	#IPFORWARDMETRIC1
 11

	)

52 
	#IPFORWARDMETRIC2
 12

	)

53 
	#IPFORWARDMETRIC3
 13

	)

54 
	#IPFORWARDMETRIC4
 14

	)

55 
	#IPFORWARDMETRIC5
 15

	)

58 
	#IPCIDRROUTEDEST
 1

	)

59 
	#IPCIDRROUTEMASK
 2

	)

60 
	#IPCIDRROUTETOS
 3

	)

61 
	#IPCIDRROUTENEXTHOP
 4

	)

62 
	#IPCIDRROUTEIFINDEX
 5

	)

63 
	#IPCIDRROUTETYPE
 6

	)

64 
	#IPCIDRROUTEPROTO
 7

	)

65 
	#IPCIDRROUTEAGE
 8

	)

66 
	#IPCIDRROUTEINFO
 9

	)

67 
	#IPCIDRROUTENEXTHOPAS
 10

	)

68 
	#IPCIDRROUTEMETRIC1
 11

	)

69 
	#IPCIDRROUTEMETRIC2
 12

	)

70 
	#IPCIDRROUTEMETRIC3
 13

	)

71 
	#IPCIDRROUTEMETRIC4
 14

	)

72 
	#IPCIDRROUTEMETRIC5
 15

	)

73 
	#IPCIDRROUTESTATUS
 16

	)

75 
	#INTEGER32
 
ASN_INTEGER


	)

76 
	#GAUGE32
 
ASN_GAUGE


	)

77 
	#ENUMERATION
 
ASN_INTEGER


	)

78 
	#ROWSTATUS
 
ASN_INTEGER


	)

79 
	#IPADDRESS
 
ASN_IPADDRESS


	)

80 
	#OBJECTIDENTIFIER
 
ASN_OBJECT_ID


	)

82 
zebø_t
 
zebød
;

84 
oid
 
	gùfw_oid
 [] = { 
IPFWMIB
 };

87 
u_ch¨
 * 
ùFwNumbî
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

88 , 
size_t
 *, 
WrôeMëhod
 **);

89 
u_ch¨
 * 
ùFwTabÀ
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

90 , 
size_t
 *, 
WrôeMëhod
 **);

91 
u_ch¨
 * 
ùCidrNumbî
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

92 , 
size_t
 *, 
WrôeMëhod
 **);

93 
u_ch¨
 * 
ùCidrTabÀ
 (
v¨übÀ
 *, 
oid
 [], 
size_t
 *,

94 , 
size_t
 *, 
WrôeMëhod
 **);

96 
v¨übÀ
 
	gzebø_v¨übÀs
[] =

98 {0, 
GAUGE32
, 
RONLY
, 
ùFwNumbî
, 1, {1}},

99 {
IPFORWARDDEST
, 
IPADDRESS
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 1}},

100 {
IPFORWARDMASK
, 
IPADDRESS
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 2}},

101 {
IPFORWARDPOLICY
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 3}},

102 {
IPFORWARDNEXTHOP
, 
IPADDRESS
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 4}},

103 {
IPFORWARDIFINDEX
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 5}},

104 {
IPFORWARDTYPE
, 
ENUMERATION
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 6}},

105 {
IPFORWARDPROTO
, 
ENUMERATION
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 7}},

106 {
IPFORWARDAGE
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 8}},

107 {
IPFORWARDINFO
, 
OBJECTIDENTIFIER
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 9}},

108 {
IPFORWARDNEXTHOPAS
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 10}},

109 {
IPFORWARDMETRIC1
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 11}},

110 {
IPFORWARDMETRIC2
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 12}},

111 {
IPFORWARDMETRIC3
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 13}},

112 {
IPFORWARDMETRIC4
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 14}},

113 {
IPFORWARDMETRIC5
, 
INTEGER32
, 
RONLY
, 
ùFwTabÀ
, 3, {2, 1, 15}},

114 {0, 
GAUGE32
, 
RONLY
, 
ùCidrNumbî
, 1, {3}},

115 {
IPCIDRROUTEDEST
, 
IPADDRESS
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 1}},

116 {
IPCIDRROUTEMASK
, 
IPADDRESS
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 2}},

117 {
IPCIDRROUTETOS
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 3}},

118 {
IPCIDRROUTENEXTHOP
, 
IPADDRESS
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 4}},

119 {
IPCIDRROUTEIFINDEX
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 5}},

120 {
IPCIDRROUTETYPE
, 
ENUMERATION
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 6}},

121 {
IPCIDRROUTEPROTO
, 
ENUMERATION
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 7}},

122 {
IPCIDRROUTEAGE
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 8}},

123 {
IPCIDRROUTEINFO
, 
OBJECTIDENTIFIER
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 9}},

124 {
IPCIDRROUTENEXTHOPAS
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 10}},

125 {
IPCIDRROUTEMETRIC1
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 11}},

126 {
IPCIDRROUTEMETRIC2
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 12}},

127 {
IPCIDRROUTEMETRIC3
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 13}},

128 {
IPCIDRROUTEMETRIC4
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 14}},

129 {
IPCIDRROUTEMETRIC5
, 
INTEGER32
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 15}},

130 {
IPCIDRROUTESTATUS
, 
ROWSTATUS
, 
RONLY
, 
ùCidrTabÀ
, 3, {4, 1, 16}}

134 
u_ch¨
 *

135 
	$ùFwNumbî
 (
v¨übÀ
 *
v
, 
oid
 
objid
[], 
size_t
 *
objid_Àn
,

136 
exa˘
, 
size_t
 *
vÆ_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

138 
ªsu…
;

139 
rouã_èbÀ
 *
èbÀ
;

140 
rouã_node
 *
∫
;

141 
rib
 *rib;

143 i‡(
	`smux_hódî_gíîic
(
v
, 
objid
, 
objid_Àn
, 
exa˘
, 
vÆ_Àn
, 
wrôe_mëhod
Ë=
MATCH_FAILED
)

144  
NULL
;

146 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

147 i‡(! 
èbÀ
)

148  
NULL
;

151 
ªsu…
 = 0;

152 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

153 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

154 
ªsu…
++;

156  (
u_ch¨
 *)&
ªsu…
;

157 
	}
}

159 
u_ch¨
 *

160 
	$ùCidrNumbî
 (
v¨übÀ
 *
v
, 
oid
 
objid
[], 
size_t
 *
objid_Àn
,

161 
exa˘
, 
size_t
 *
vÆ_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

163 
ªsu…
;

164 
rouã_èbÀ
 *
èbÀ
;

165 
rouã_node
 *
∫
;

166 
rib
 *rib;

168 i‡(
	`smux_hódî_gíîic
(
v
, 
objid
, 
objid_Àn
, 
exa˘
, 
vÆ_Àn
, 
wrôe_mëhod
Ë=
MATCH_FAILED
)

169  
NULL
;

171 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

172 i‡(! 
èbÀ
)

176 
ªsu…
 = 0;

177 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

178 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

179 
ªsu…
++;

181  (
u_ch¨
 *)&
ªsu…
;

182 
	}
}

185 
	$ö_addr_cmp
(
u_ch¨
 *
p1
, u_ch¨ *
p2
)

187 
i
;

189 
i
=0; i<4; i++)

191 i‡(*
p1
 < *
p2
)

193 i‡(*
p1
 > *
p2
)

195 
p1
++; 
p2
++;

198 
	}
}

201 
	$ö_addr_add
(
u_ch¨
 *
p
, 
num
)

203 
i
, 
ù0
;

205 
ù0
 = *
p
;

206 
p
 += 4;

207 
i
 = 3; 0 <= i; i--) {

208 
p
--;

209 i‡(*
p
 + 
num
 > 255) {

210 *
p
 +
num
;

211 
num
 = 1;

213 *
p
 +
num
;

217 i‡(
ù0
 > *
p
) {

223 
	}
}

226 
	$¥Ÿo_å™s
(
ty≥
)

228 
ty≥
)

230 
ZEBRA_ROUTE_SYSTEM
:

232 
ZEBRA_ROUTE_KERNEL
:

234 
ZEBRA_ROUTE_CONNECT
:

236 
ZEBRA_ROUTE_STATIC
:

238 
ZEBRA_ROUTE_RIP
:

240 
ZEBRA_ROUTE_RIPNG
:

242 
ZEBRA_ROUTE_OSPF
:

244 
ZEBRA_ROUTE_OSPF6
:

246 
ZEBRA_ROUTE_BGP
:

251 
	}
}

254 
	$check_ª∂a˚
(
rouã_node
 *
≈2
, 
rib
 *
rib2
,

255 
rouã_node
 **
≈
, 
rib
 **rib)

257 
¥Ÿo
, 
¥Ÿo2
;

259 i‡(!*
≈
)

261 *
≈
 = 
≈2
;

262 *
rib
 = 
rib2
;

266 i‡(
	`ö_addr_cmp
(&(*
≈
)->
p
.
u
.
¥efix
, &
≈2
->p.u.prefix) < 0)

268 i‡(
	`ö_addr_cmp
(&(*
≈
)->
p
.
u
.
¥efix
, &
≈2
->p.u.prefix) > 0)

270 *
≈
 = 
≈2
;

271 *
rib
 = 
rib2
;

275 
¥Ÿo
 = 
	`¥Ÿo_å™s
((*
rib
)->
ty≥
);

276 
¥Ÿo2
 = 
	`¥Ÿo_å™s
(
rib2
->
ty≥
);

278 i‡(
¥Ÿo2
 > 
¥Ÿo
)

280 i‡(
¥Ÿo2
 < 
¥Ÿo
)

282 *
≈
 = 
≈2
;

283 *
rib
 = 
rib2
;

287 i‡(
	`ö_addr_cmp
((
u_ch¨
 *)&(*
rib
)->
√xth›
->
g©e
.
ùv4
,

288 (
u_ch¨
 *)&
rib2
->
√xth›
->
g©e
.
ùv4
) <= 0)

291 *
≈
 = 
≈2
;

292 *
rib
 = 
rib2
;

294 
	}
}

297 
	$gë_fwèbÀ_rouã_node
(
v¨übÀ
 *
v
, 
oid
 
objid
[], 
size_t
 *
objid_Àn
,

298 
exa˘
, 
rouã_node
 **
≈
, 
rib
 **rib)

300 
ö_addr
 
de°
;

301 
rouã_èbÀ
 *
èbÀ
;

302 
rouã_node
 *
≈2
;

303 
rib
 *
rib2
;

304 
¥Ÿo
;

305 
pﬁicy
;

306 
ö_addr
 
√xth›
;

307 
u_ch¨
 *
≤t
;

308 
i
;

312 
≤t
 = (
u_ch¨
 *Ë&
de°
;

313 
i
 = 0; i < 4; i++)

314 *
≤t
++ = 0;

316 
≤t
 = (
u_ch¨
 *Ë&
√xth›
;

317 
i
 = 0; i < 4; i++)

318 *
≤t
++ = 0;

320 
¥Ÿo
 = 0;

321 
pﬁicy
 = 0;

325 *
≈
 = 
NULL
;

326 *
rib
 = 
NULL
;

330 i‡(
exa˘
 && (*
objid_Àn
 !(Ë
v
->
«mñí
 + 10))

333 
èbÀ
 = 
	`vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

334 i‡(! 
èbÀ
)

341 i‡(*
objid_Àn
 > (Ë
v
->
«mñí
)

342 
	`oid2ö_addr
 (
objid
 + 
v
->
«mñí
, 
	`MIN
(4, *
objid_Àn
 - v->«mñí), &
de°
);

344 i‡(*
objid_Àn
 > (Ë
v
->
«mñí
 + 4)

345 
¥Ÿo
 = 
objid
[
v
->
«mñí
 + 4];

347 i‡(*
objid_Àn
 > (Ë
v
->
«mñí
 + 5)

348 
pﬁicy
 = 
objid
[
v
->
«mñí
 + 5];

350 i‡(*
objid_Àn
 > (Ë
v
->
«mñí
 + 6)

351 
	`oid2ö_addr
 (
objid
 + 
v
->
«mñí
 + 6, 
	`MIN
(4, *
objid_Àn
 - v->namelen - 6),

352 &
√xth›
);

356 i‡(!
exa˘
 && (*
objid_Àn
 >(Ë
v
->
«mñí
 + 10))

358 i‡(! 
	`ö_addr_add
((
u_ch¨
 *Ë&
√xth›
, 1))

364 i‡(
exa˘
)

366 i‡(
pﬁicy
)

368 *
≈
 = 
	`rouã_t›
 (
èbÀ
); *≈; *≈ = 
	`rouã_√xt
 (*np))

370 i‡(!
	`ö_addr_cmp
(&(*
≈
)->
p
.
u
.
¥efix
, (
u_ch¨
 *)&
de°
))

372 
	`RNODE_FOREACH_RIB
 (*
≈
, *
rib
)

374 i‡(!
	`ö_addr_cmp
((
u_ch¨
 *)&(*
rib
)->
√xth›
->
g©e
.
ùv4
,

375 (
u_ch¨
 *)&
√xth›
))

376 i‡(
¥Ÿo
 =
	`¥Ÿo_å™s
((*
rib
)->
ty≥
))

386 
≈2
 = 
	`rouã_t›
 (
èbÀ
);Çp2;Çp2 = 
	`rouã_√xt
 (np2))

390 i‡(
	`ö_addr_cmp
(&
≈2
->
p
.
u
.
¥efix
, (
u_ch¨
 *)&
de°
) > 0)

391 
	`RNODE_FOREACH_RIB
 (
≈2
, 
rib2
)

392 
	`check_ª∂a˚
(
≈2
, 
rib2
, 
≈
, 
rib
);

394 i‡(
	`ö_addr_cmp
(&
≈2
->
p
.
u
.
¥efix
, (
u_ch¨
 *)&
de°
) == 0)

396 
	`RNODE_FOREACH_RIB
 (
≈2
, 
rib2
)

398 
¥Ÿo2
, 
pﬁicy2
;

400 
¥Ÿo2
 = 
	`¥Ÿo_å™s
(
rib2
->
ty≥
);

401 
pﬁicy2
 = 0;

403 i‡((
pﬁicy
 < 
pﬁicy2
)

404 || ((
pﬁicy
 =
pﬁicy2
Ë&& (
¥Ÿo
 < 
¥Ÿo2
))

405 || ((
pﬁicy
 =
pﬁicy2
Ë&& (
¥Ÿo
 =
¥Ÿo2
)

406 && (
	`ö_addr_cmp
((
u_ch¨
 *)&
rib2
->
√xth›
->
g©e
.
ùv4
,

407 (
u_ch¨
 *Ë&
√xth›
) >= 0)

409 
	`check_ª∂a˚
(
≈2
, 
rib2
, 
≈
, 
rib
);

414 i‡(!*
rib
)

417 
pﬁicy
 = 0;

418 
¥Ÿo
 = 
	`¥Ÿo_å™s
((*
rib
)->
ty≥
);

420 *
objid_Àn
 = 
v
->
«mñí
 + 10;

421 
≤t
 = (
u_ch¨
 *Ë&(*
≈
)->
p
.
u
.
¥efix
;

422 
i
 = 0; i < 4; i++)

423 
objid
[
v
->
«mñí
 + 
i
] = *
≤t
++;

425 
objid
[
v
->
«mñí
 + 4] = 
¥Ÿo
;

426 
objid
[
v
->
«mñí
 + 5] = 
pﬁicy
;

429 
√xth›
 *nexthop;

431 
√xth›
 = (*
rib
)->nexthop;

432 i‡(
√xth›
)

434 
≤t
 = (
u_ch¨
 *Ë&
√xth›
->
g©e
.
ùv4
;

435 
i
 = 0; i < 4; i++)

436 
objid
[
i
 + 
v
->
«mñí
 + 6] = *
≤t
++;

441 
	}
}

443 
u_ch¨
 *

444 
	$ùFwTabÀ
 (
v¨übÀ
 *
v
, 
oid
 
objid
[], 
size_t
 *
objid_Àn
,

445 
exa˘
, 
size_t
 *
vÆ_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

447 
rouã_node
 *
≈
;

448 
rib
 *rib;

449 
ªsu…
;

450 
ªßº
[2];

451 
ö_addr
 
√tmask
;

452 
√xth›
 *nexthop;

454 i‡(
	`smux_hódî_èbÀ
(
v
, 
objid
, 
objid_Àn
, 
exa˘
, 
vÆ_Àn
, 
wrôe_mëhod
)

455 =
MATCH_FAILED
)

456  
NULL
;

458 
	`gë_fwèbÀ_rouã_node
(
v
, 
objid
, 
objid_Àn
, 
exa˘
, &
≈
, &
rib
);

459 i‡(!
≈
)

460  
NULL
;

462 
√xth›
 = 
rib
->nexthop;

463 i‡(! 
√xth›
)

464  
NULL
;

466 
v
->
magic
)

468 
IPFORWARDDEST
:

469 *
vÆ_Àn
 = 4;

470  &
≈
->
p
.
u
.
¥efix
;

472 
IPFORWARDMASK
:

473 
	`maskÀn2ù
(
≈
->
p
.
¥efixÀn
, &
√tmask
);

474 *
vÆ_Àn
 = 4;

475  (
u_ch¨
 *)&
√tmask
;

477 
IPFORWARDPOLICY
:

478 
ªsu…
 = 0;

479 *
vÆ_Àn
 = ();

480  (
u_ch¨
 *)&
ªsu…
;

482 
IPFORWARDNEXTHOP
:

483 *
vÆ_Àn
 = 4;

484  (
u_ch¨
 *)&
√xth›
->
g©e
.
ùv4
;

486 
IPFORWARDIFINDEX
:

487 *
vÆ_Àn
 = ();

488  (
u_ch¨
 *)&
√xth›
->
ifödex
;

490 
IPFORWARDTYPE
:

491 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFINDEX


492 || 
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IFNAME
)

493 
ªsu…
 = 3;

495 
ªsu…
 = 4;

496 *
vÆ_Àn
 = ();

497  (
u_ch¨
 *)&
ªsu…
;

499 
IPFORWARDPROTO
:

500 
ªsu…
 = 
	`¥Ÿo_å™s
(
rib
->
ty≥
);

501 *
vÆ_Àn
 = ();

502  (
u_ch¨
 *)&
ªsu…
;

504 
IPFORWARDAGE
:

505 
ªsu…
 = 0;

506 *
vÆ_Àn
 = ();

507  (
u_ch¨
 *)&
ªsu…
;

509 
IPFORWARDINFO
:

510 
ªßº
[0] = 0;

511 
ªßº
[1] = 0;

512 *
vÆ_Àn
 = 2 * ();

513  (
u_ch¨
 *)
ªßº
;

515 
IPFORWARDNEXTHOPAS
:

516 
ªsu…
 = -1;

517 *
vÆ_Àn
 = ();

518  (
u_ch¨
 *)&
ªsu…
;

520 
IPFORWARDMETRIC1
:

521 
ªsu…
 = 0;

522 *
vÆ_Àn
 = ();

523  (
u_ch¨
 *)&
ªsu…
;

525 
IPFORWARDMETRIC2
:

526 
ªsu…
 = 0;

527 *
vÆ_Àn
 = ();

528  (
u_ch¨
 *)&
ªsu…
;

530 
IPFORWARDMETRIC3
:

531 
ªsu…
 = 0;

532 *
vÆ_Àn
 = ();

533  (
u_ch¨
 *)&
ªsu…
;

535 
IPFORWARDMETRIC4
:

536 
ªsu…
 = 0;

537 *
vÆ_Àn
 = ();

538  (
u_ch¨
 *)&
ªsu…
;

540 
IPFORWARDMETRIC5
:

541 
ªsu…
 = 0;

542 *
vÆ_Àn
 = ();

543  (
u_ch¨
 *)&
ªsu…
;

546  
NULL
;

549  
NULL
;

550 
	}
}

552 
u_ch¨
 *

553 
	$ùCidrTabÀ
 (
v¨übÀ
 *
v
, 
oid
 
objid
[], 
size_t
 *
objid_Àn
,

554 
exa˘
, 
size_t
 *
vÆ_Àn
, 
WrôeMëhod
 **
wrôe_mëhod
)

556 i‡(
	`smux_hódî_èbÀ
(
v
, 
objid
, 
objid_Àn
, 
exa˘
, 
vÆ_Àn
, 
wrôe_mëhod
)

557 =
MATCH_FAILED
)

558  
NULL
;

560 
v
->
magic
)

562 
IPCIDRROUTEDEST
:

565  
NULL
;

568  
NULL
;

569 
	}
}

572 
	$zebø_¢mp_öô
 ()

574 
	`smux_öô
 (
zebød
.
ma°î
);

575 
	`REGISTER_MIB
("mibII/ùf‹w¨d", 
zebø_v¨übÀs
, 
v¨übÀ
, 
ùfw_oid
);

576 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_vty.c

22 
	~<zebø.h
>

24 
	~"mem‹y.h
"

25 
	~"if.h
"

26 
	~"¥efix.h
"

27 
	~"comm™d.h
"

28 
	~"èbÀ.h
"

29 
	~"rib.h
"

31 
	~"zebø/z£rv.h
"

35 
	$zebø_°©ic_ùv4
 (
vty
 *vty, 
add_cmd
, c⁄° *
de°_°r
,

36 c⁄° *
mask_°r
, c⁄° *
g©e_°r
,

37 c⁄° *
Êag_°r
, c⁄° *
di°™˚_°r
)

39 
ªt
;

40 
u_ch¨
 
di°™˚
;

41 
¥efix
 
p
;

42 
ö_addr
 
g©e
;

43 
ö_addr
 
mask
;

44 c⁄° *
i‚ame
;

45 
u_ch¨
 
Êag
 = 0;

47 
ªt
 = 
	`°r2¥efix
 (
de°_°r
, &
p
);

48 i‡(
ªt
 <= 0)

50 
	`vty_out
 (
vty
, "%% MÆf‹medáddªss%s", 
VTY_NEWLINE
);

51  
CMD_WARNING
;

55 i‡(
mask_°r
)

57 
ªt
 = 
	`öë_©⁄
 (
mask_°r
, &
mask
);

58 i‡(
ªt
 == 0)

60 
	`vty_out
 (
vty
, "%% MÆf‹medáddªss%s", 
VTY_NEWLINE
);

61  
CMD_WARNING
;

63 
p
.
¥efixÀn
 = 
	`ù_maskÀn
 (
mask
);

67 
	`≠∂y_mask
 (&
p
);

70 i‡(
di°™˚_°r
)

71 
di°™˚
 = 
	`©oi
 (
di°™˚_°r
);

73 
di°™˚
 = 
ZEBRA_STATIC_DISTANCE_DEFAULT
;

76 i‡((
g©e_°r
 !
NULL
Ë&& (
	`°∫ˇ£cmp
 (g©e_°r, "NuŒ0", 
	`°æí
 (gate_str)) == 0))

78 i‡(
Êag_°r
)

80 
	`vty_out
 (
vty
, "%% c™ÇŸ havêÊag %†wôh NuŒ0%s", 
Êag_°r
, 
VTY_NEWLINE
);

81  
CMD_WARNING
;

83 i‡(
add_cmd
)

84 
	`°©ic_add_ùv4
 (&
p
, 
NULL
, NULL, 
ZEBRA_FLAG_BLACKHOLE
, 
di°™˚
, 0);

86 
	`°©ic_dñëe_ùv4
 (&
p
, 
NULL
, NULL, 
di°™˚
, 0);

87  
CMD_SUCCESS
;

91 i‡(
Êag_°r
) {

92 
Êag_°r
[0]) {

95 
	`SET_FLAG
 (
Êag
, 
ZEBRA_FLAG_REJECT
);

99 
	`SET_FLAG
 (
Êag
, 
ZEBRA_FLAG_BLACKHOLE
);

102 
	`vty_out
 (
vty
, "%% MÆf‹med fœg %†%s", 
Êag_°r
, 
VTY_NEWLINE
);

103  
CMD_WARNING
;

107 i‡(
g©e_°r
 =
NULL
)

109 i‡(
add_cmd
)

110 
	`°©ic_add_ùv4
 (&
p
, 
NULL
, NULL, 
Êag
, 
di°™˚
, 0);

112 
	`°©ic_dñëe_ùv4
 (&
p
, 
NULL
, NULL, 
di°™˚
, 0);

114  
CMD_SUCCESS
;

119 
ªt
 = 
	`öë_©⁄
 (
g©e_°r
, &
g©e
);

120 i‡(
ªt
)

121 
i‚ame
 = 
NULL
;

123 
i‚ame
 = 
g©e_°r
;

125 i‡(
add_cmd
)

126 
	`°©ic_add_ùv4
 (&
p
, 
i‚ame
 ? 
NULL
 : &
g©e
, i‚ame, 
Êag
, 
di°™˚
, 0);

128 
	`°©ic_dñëe_ùv4
 (&
p
, 
i‚ame
 ? 
NULL
 : &
g©e
, i‚ame, 
di°™˚
, 0);

130  
CMD_SUCCESS
;

131 
	}
}

134 
DEFUN
 (
ù_rouã
,

135 
ù_rouã_cmd
,

137 
IP_STR


144  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0], 
NULL
,árgv[1], NULL, NULL);

147 
DEFUN
 (
ù_rouã_Êags
,

148 
ù_rouã_Êags_cmd
,

150 
IP_STR


158  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0], 
NULL
,árgv[1],árgv[2], NULL);

161 
DEFUN
 (
ù_rouã_Êags2
,

162 
ù_rouã_Êags2_cmd
,

164 
IP_STR


170  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0], 
NULL
, NULL,árgv[1], NULL);

174 
DEFUN
 (
ù_rouã_mask
,

175 
ù_rouã_mask_cmd
,

177 
IP_STR


185  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2], 
NULL
, NULL);

188 
DEFUN
 (
ù_rouã_mask_Êags
,

189 
ù_rouã_mask_Êags_cmd
,

191 
IP_STR


200  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2],árgv[3], 
NULL
);

203 
DEFUN
 (
ù_rouã_mask_Êags2
,

204 
ù_rouã_mask_Êags2_cmd
,

206 
IP_STR


213  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0],árgv[1], 
NULL
,árgv[2], NULL);

217 
DEFUN
 (
ù_rouã_di°™˚
,

218 
ù_rouã_di°™˚_cmd
,

220 
IP_STR


228  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0], 
NULL
,árgv[1], NULL,árgv[2]);

231 
DEFUN
 (
ù_rouã_Êags_di°™˚
,

232 
ù_rouã_Êags_di°™˚_cmd
,

234 
IP_STR


243  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0], 
NULL
,árgv[1],árgv[2],árgv[3]);

246 
DEFUN
 (
ù_rouã_Êags_di°™˚2
,

247 
ù_rouã_Êags_di°™˚2_cmd
,

249 
IP_STR


256  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0], 
NULL
, NULL,árgv[1],árgv[2]);

259 
DEFUN
 (
ù_rouã_mask_di°™˚
,

260 
ù_rouã_mask_di°™˚_cmd
,

262 
IP_STR


271  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2], 
NULL
,árgv[3]);

274 
DEFUN
 (
ù_rouã_mask_Êags_di°™˚
,

275 
ù_rouã_mask_Êags_di°™˚_cmd
,

277 
IP_STR


287  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2],árgv[3],árgv[4]);

290 
DEFUN
 (
ù_rouã_mask_Êags_di°™˚2
,

291 
ù_rouã_mask_Êags_di°™˚2_cmd
,

293 
IP_STR


301  
zebø_°©ic_ùv4
 (
vty
, 1, 
¨gv
[0],árgv[1], 
NULL
,árgv[2],árgv[3]);

304 
DEFUN
 (
no_ù_rouã
,

305 
no_ù_rouã_cmd
,

307 
NO_STR


308 
IP_STR


315  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0], 
NULL
,árgv[1], NULL, NULL);

318 
ALIAS
 (
no_ù_rouã
,

319 
no_ù_rouã_Êags_cmd
,

321 
NO_STR


322 
IP_STR


330 
DEFUN
 (
no_ù_rouã_Êags2
,

331 
no_ù_rouã_Êags2_cmd
,

333 
NO_STR


334 
IP_STR


340  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0], 
NULL
, NULL, NULL, NULL);

343 
DEFUN
 (
no_ù_rouã_mask
,

344 
no_ù_rouã_mask_cmd
,

346 
NO_STR


347 
IP_STR


355  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0],árgv[1],árgv[2], 
NULL
, NULL);

358 
ALIAS
 (
no_ù_rouã_mask
,

359 
no_ù_rouã_mask_Êags_cmd
,

361 
NO_STR


362 
IP_STR


371 
DEFUN
 (
no_ù_rouã_mask_Êags2
,

372 
no_ù_rouã_mask_Êags2_cmd
,

374 
NO_STR


375 
IP_STR


382  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0],árgv[1], 
NULL
, NULL, NULL);

385 
DEFUN
 (
no_ù_rouã_di°™˚
,

386 
no_ù_rouã_di°™˚_cmd
,

388 
NO_STR


389 
IP_STR


397  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0], 
NULL
,árgv[1], NULL,árgv[2]);

400 
DEFUN
 (
no_ù_rouã_Êags_di°™˚
,

401 
no_ù_rouã_Êags_di°™˚_cmd
,

403 
NO_STR


404 
IP_STR


413  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0], 
NULL
,árgv[1],árgv[2],árgv[3]);

416 
DEFUN
 (
no_ù_rouã_Êags_di°™˚2
,

417 
no_ù_rouã_Êags_di°™˚2_cmd
,

419 
NO_STR


420 
IP_STR


427  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0], 
NULL
, NULL,árgv[1],árgv[2]);

430 
DEFUN
 (
no_ù_rouã_mask_di°™˚
,

431 
no_ù_rouã_mask_di°™˚_cmd
,

433 
NO_STR


434 
IP_STR


443  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0],árgv[1],árgv[2], 
NULL
,árgv[3]);

446 
DEFUN
 (
no_ù_rouã_mask_Êags_di°™˚
,

447 
no_ù_rouã_mask_Êags_di°™˚_cmd
,

449 
NO_STR


450 
IP_STR


460  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0],árgv[1],árgv[2],árgv[3],árgv[4]);

463 
DEFUN
 (
no_ù_rouã_mask_Êags_di°™˚2
,

464 
no_ù_rouã_mask_Êags_di°™˚2_cmd
,

466 
NO_STR


467 
IP_STR


475  
zebø_°©ic_ùv4
 (
vty
, 0, 
¨gv
[0],árgv[1], 
NULL
,árgv[2],árgv[3]);

478 *
	g¥Ÿo_rm
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
+1];

480 
DEFUN
 (
ù_¥Ÿocﬁ
,

481 
ù_¥Ÿocﬁ_cmd
,

483 
NO_STR


488 
	gi
;

490 i‡(
°rˇ£cmp
(
¨gv
[0], "any") == 0)

491 
i
 = 
ZEBRA_ROUTE_MAX
;

493 
	gi
 = 
¥Ÿo_«me2num
(
¨gv
[0]);

494 i‡(
	gi
 < 0)

496 
vty_out
 (
vty
, "övÆidÖrŸocﬁÇamê\"%s\"%s", 
¨gv
[0] ?árgv[0] : "",

497 
VTY_NEWLINE
);

498  
	gCMD_WARNING
;

500 i‡(
	g¥Ÿo_rm
[
AFI_IP
][
i
])

501 
XFREE
 (
MTYPE_ROUTE_MAP_NAME
, 
¥Ÿo_rm
[
AFI_IP
][
i
]);

502 
	g¥Ÿo_rm
[
AFI_IP
][
i
] = 
XSTRDUP
 (
MTYPE_ROUTE_MAP_NAME
, 
¨gv
[1]);

503  
	gCMD_SUCCESS
;

506 
DEFUN
 (
no_ù_¥Ÿocﬁ
,

507 
no_ù_¥Ÿocﬁ_cmd
,

509 
NO_STR


513 
	gi
;

515 i‡(
°rˇ£cmp
(
¨gv
[0], "any") == 0)

516 
i
 = 
ZEBRA_ROUTE_MAX
;

518 
	gi
 = 
¥Ÿo_«me2num
(
¨gv
[0]);

519 i‡(
	gi
 < 0)

521 
vty_out
 (
vty
, "övÆidÖrŸocﬁÇamê\"%s\"%s", 
¨gv
[0] ?árgv[0] : "",

522 
VTY_NEWLINE
);

523  
	gCMD_WARNING
;

525 i‡(
	g¥Ÿo_rm
[
AFI_IP
][
i
])

526 
XFREE
 (
MTYPE_ROUTE_MAP_NAME
, 
¥Ÿo_rm
[
AFI_IP
][
i
]);

527 
	g¥Ÿo_rm
[
AFI_IP
][
i
] = 
NULL
;

528  
	gCMD_SUCCESS
;

533 
	$vty_show_ù_rouã_dëaû
 (
vty
 *vty, 
rouã_node
 *
∫
)

535 
rib
 *rib;

536 
√xth›
 *nexthop;

538 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

540 
	`vty_out
 (
vty
, "RoutingÉntry for %s/%d%s",

541 
	`öë_¡ﬂ
 (
∫
->
p
.
u
.
¥efix4
),Ñn->p.
¥efixÀn
,

542 
VTY_NEWLINE
);

543 
	`vty_out
 (
vty
, " Know¿vü \"%s\"", 
	`zebø_rouã_°rög
 (
rib
->
ty≥
));

544 
	`vty_out
 (
vty
, ", di°™˚ %u, mëri¯%u", 
rib
->
di°™˚
,Ñib->
mëric
);

545 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

546 
	`vty_out
 (
vty
, ", best");

547 i‡(
rib
->
ªf˙t
)

548 
	`vty_out
 (
vty
, ",Ñef˙à%ld", 
rib
->
ªf˙t
);

549 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

550 
	`vty_out
 (
vty
, ", blackhole");

551 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_REJECT
))

552 
	`vty_out
 (
vty
, ",Ñeject");

553 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

555 
	#ONE_DAY_SECOND
 60*60*24

	)

556 
	#ONE_WEEK_SECOND
 60*60*24*7

	)

557 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_RIP


558 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_OSPF


559 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BABEL


560 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_ISIS


561 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

563 
time_t
 
u±ime
;

564 
tm
 *tm;

566 
u±ime
 = 
	`time
 (
NULL
);

567 
u±ime
 -
rib
->uptime;

568 
tm
 = 
	`gmtime
 (&
u±ime
);

570 
	`vty_out
 (
vty
, " Last update ");

572 i‡(
u±ime
 < 
ONE_DAY_SECOND
)

573 
	`vty_out
 (
vty
, "%02d:%02d:%02d",

574 
tm
->
tm_hour
,Åm->
tm_mö
,Åm->
tm_£c
);

575 i‡(
u±ime
 < 
ONE_WEEK_SECOND
)

576 
	`vty_out
 (
vty
, "%dd%02dh%02dm",

577 
tm
->
tm_yday
,Åm->
tm_hour
,Åm->
tm_mö
);

579 
	`vty_out
 (
vty
, "%02dw%dd%02dh",

580 
tm
->
tm_yday
/7,

581 
tm
->
tm_yday
 - (—m->tm_yday/7Ë* 7),Åm->
tm_hour
);

582 
	`vty_out
 (
vty
, "ágo%s", 
VTY_NEWLINE
);

585 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

587 
addr°r
[32];

589 
	`vty_out
 (
vty
, " %c",

590 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
) ? '*' : ' ');

592 
√xth›
->
ty≥
)

594 
NEXTHOP_TYPE_IPV4
:

595 
NEXTHOP_TYPE_IPV4_IFINDEX
:

596 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
√xth›
->
g©e
.
ùv4
));

597 i‡(
√xth›
->
ifödex
)

598 
	`vty_out
 (
vty
, ", vü %s", 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

600 
NEXTHOP_TYPE_IFINDEX
:

601 
	`vty_out
 (
vty
, " directly connected, %s",

602 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

604 
NEXTHOP_TYPE_IFNAME
:

605 
	`vty_out
 (
vty
, " dúe˘ly c⁄√˘ed, %s", 
√xth›
->
i‚ame
);

607 
NEXTHOP_TYPE_BLACKHOLE
:

608 
	`vty_out
 (
vty
, " directly connected, Null0");

613 i‡(! 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

614 
	`vty_out
 (
vty
, " inactive");

616 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

618 
	`vty_out
 (
vty
, " (recursive");

620 
√xth›
->
πy≥
)

622 
NEXTHOP_TYPE_IPV4
:

623 
NEXTHOP_TYPE_IPV4_IFINDEX
:

624 
	`vty_out
 (
vty
, " vü %s)", 
	`öë_¡ﬂ
 (
√xth›
->
rg©e
.
ùv4
));

626 
NEXTHOP_TYPE_IFINDEX
:

627 
NEXTHOP_TYPE_IFNAME
:

628 
	`vty_out
 (
vty
, " is directly connected, %s)",

629 
	`ifödex2i‚ame
 (
√xth›
->
rifödex
));

635 
√xth›
->
ty≥
)

637 
NEXTHOP_TYPE_IPV4
:

638 
NEXTHOP_TYPE_IPV4_IFINDEX
:

639 
NEXTHOP_TYPE_IPV4_IFNAME
:

640 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

642 i‡(
	`öë_¡›
(
AF_INET
, &
√xth›
->
§c
.
ùv4
, 
addr°r
,

643  
addr°r
))

644 
	`vty_out
 (
vty
, ", sr¯%s", 
addr°r
);

647 #ifde‡
HAVE_IPV6


648 
NEXTHOP_TYPE_IPV6
:

649 
NEXTHOP_TYPE_IPV6_IFINDEX
:

650 
NEXTHOP_TYPE_IPV6_IFNAME
:

651 i‡(!
	`IPV6_ADDR_SAME
(&
√xth›
->
§c
.
ùv6
, &
ö6addr_™y
))

653 i‡(
	`öë_¡›
(
AF_INET6
, &
√xth›
->
§c
.
ùv6
, 
addr°r
,

654  
addr°r
))

655 
	`vty_out
 (
vty
, ", sr¯%s", 
addr°r
);

662 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

664 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

666 
	}
}

669 
	$vty_show_ù_rouã
 (
vty
 *vty, 
rouã_node
 *
∫
, 
rib
 *rib)

671 
√xth›
 *nexthop;

672 
Àn
 = 0;

673 
buf
[
BUFSIZ
];

676 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

678 i‡(
√xth›
 =
rib
->nexthop)

681 
Àn
 = 
	`vty_out
 (
vty
, "%c%c%c %s/%d",

682 
	`zebø_rouã_ch¨
 (
rib
->
ty≥
),

683 
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
)

685 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

687 
	`öë_¡›
 (
AF_INET
, &
∫
->
p
.
u
.
¥efix
, 
buf
, 
BUFSIZ
),

688 
∫
->
p
.
¥efixÀn
);

691 i‡(
rib
->
ty≥
 !
ZEBRA_ROUTE_CONNECT


692 && 
rib
->
ty≥
 !
ZEBRA_ROUTE_KERNEL
)

693 
Àn
 +
	`vty_out
 (
vty
, " [%d/%d]", 
rib
->
di°™˚
,

694 
rib
->
mëric
);

697 
	`vty_out
 (
vty
, " %c%*c",

698 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

700 
Àn
 - 3, ' ');

702 
√xth›
->
ty≥
)

704 
NEXTHOP_TYPE_IPV4
:

705 
NEXTHOP_TYPE_IPV4_IFINDEX
:

706 
	`vty_out
 (
vty
, " vü %s", 
	`öë_¡ﬂ
 (
√xth›
->
g©e
.
ùv4
));

707 i‡(
√xth›
->
ifödex
)

708 
	`vty_out
 (
vty
, ", %s", 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

710 
NEXTHOP_TYPE_IFINDEX
:

711 
	`vty_out
 (
vty
, " is directly connected, %s",

712 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

714 
NEXTHOP_TYPE_IFNAME
:

715 
	`vty_out
 (
vty
, " i†dúe˘ly c⁄√˘ed, %s", 
√xth›
->
i‚ame
);

717 
NEXTHOP_TYPE_BLACKHOLE
:

718 
	`vty_out
 (
vty
, " is directly connected, Null0");

723 i‡(! 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

724 
	`vty_out
 (
vty
, " inactive");

726 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

728 
	`vty_out
 (
vty
, " (recursive");

730 
√xth›
->
πy≥
)

732 
NEXTHOP_TYPE_IPV4
:

733 
NEXTHOP_TYPE_IPV4_IFINDEX
:

734 
	`vty_out
 (
vty
, " vü %s)", 
	`öë_¡ﬂ
 (
√xth›
->
rg©e
.
ùv4
));

736 
NEXTHOP_TYPE_IFINDEX
:

737 
NEXTHOP_TYPE_IFNAME
:

738 
	`vty_out
 (
vty
, " is directly connected, %s)",

739 
	`ifödex2i‚ame
 (
√xth›
->
rifödex
));

745 
√xth›
->
ty≥
)

747 
NEXTHOP_TYPE_IPV4
:

748 
NEXTHOP_TYPE_IPV4_IFINDEX
:

749 
NEXTHOP_TYPE_IPV4_IFNAME
:

750 i‡(
√xth›
->
§c
.
ùv4
.
s_addr
)

752 i‡(
	`öë_¡›
(
AF_INET
, &
√xth›
->
§c
.
ùv4
, 
buf
,  buf))

753 
	`vty_out
 (
vty
, ", sr¯%s", 
buf
);

756 #ifde‡
HAVE_IPV6


757 
NEXTHOP_TYPE_IPV6
:

758 
NEXTHOP_TYPE_IPV6_IFINDEX
:

759 
NEXTHOP_TYPE_IPV6_IFNAME
:

760 i‡(!
	`IPV6_ADDR_SAME
(&
√xth›
->
§c
.
ùv6
, &
ö6addr_™y
))

762 i‡(
	`öë_¡›
(
AF_INET6
, &
√xth›
->
§c
.
ùv6
, 
buf
,  buf))

763 
	`vty_out
 (
vty
, ", sr¯%s", 
buf
);

771 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

772 
	`vty_out
 (
vty
, ", bh");

773 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_REJECT
))

774 
	`vty_out
 (
vty
, ",Ñej");

776 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_RIP


777 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_OSPF


778 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BABEL


779 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_ISIS


780 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

782 
time_t
 
u±ime
;

783 
tm
 *tm;

785 
u±ime
 = 
	`time
 (
NULL
);

786 
u±ime
 -
rib
->uptime;

787 
tm
 = 
	`gmtime
 (&
u±ime
);

789 
	#ONE_DAY_SECOND
 60*60*24

	)

790 
	#ONE_WEEK_SECOND
 60*60*24*7

	)

792 i‡(
u±ime
 < 
ONE_DAY_SECOND
)

793 
	`vty_out
 (
vty
, ", %02d:%02d:%02d",

794 
tm
->
tm_hour
,Åm->
tm_mö
,Åm->
tm_£c
);

795 i‡(
u±ime
 < 
ONE_WEEK_SECOND
)

796 
	`vty_out
 (
vty
, ", %dd%02dh%02dm",

797 
tm
->
tm_yday
,Åm->
tm_hour
,Åm->
tm_mö
);

799 
	`vty_out
 (
vty
, ", %02dw%dd%02dh",

800 
tm
->
tm_yday
/7,

801 
tm
->
tm_yday
 - (—m->tm_yday/7Ë* 7),Åm->
tm_hour
);

803 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

805 
	}
}

807 
DEFUN
 (
show_ù_rouã
,

808 
show_ù_rouã_cmd
,

810 
SHOW_STR


811 
IP_STR


814 
rouã_èbÀ
 *
	gèbÀ
;

815 
rouã_node
 *
	g∫
;

816 
rib
 *
	grib
;

817 
	gfú°
 = 1;

819 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

820 i‡(! 
	gèbÀ
)

821  
	gCMD_SUCCESS
;

824 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

825 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

827 i‡(
	gfú°
)

829 
vty_out
 (
vty
, 
SHOW_ROUTE_V4_HEADER
);

830 
	gfú°
 = 0;

832 
vty_show_ù_rouã
 (
vty
, 
∫
, 
rib
);

834  
	gCMD_SUCCESS
;

837 
DEFUN
 (
show_ù_rouã_¥efix_l⁄gî
,

838 
show_ù_rouã_¥efix_l⁄gî_cmd
,

840 
SHOW_STR


841 
IP_STR


846 
rouã_èbÀ
 *
	gèbÀ
;

847 
rouã_node
 *
	g∫
;

848 
rib
 *
	grib
;

849 
¥efix
 
	gp
;

850 
	gªt
;

851 
	gfú°
 = 1;

853 
	gªt
 = 
°r2¥efix
 (
¨gv
[0], &
p
);

854 i‡(! 
	gªt
)

856 
vty_out
 (
vty
, "%% MÆf‹med Pªfix%s", 
VTY_NEWLINE
);

857  
	gCMD_WARNING
;

860 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

861 i‡(! 
	gèbÀ
)

862  
	gCMD_SUCCESS
;

865 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

866 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

867 i‡(
¥efix_m©ch
 (&
p
, &
∫
->p))

869 i‡(
	gfú°
)

871 
vty_out
 (
vty
, 
SHOW_ROUTE_V4_HEADER
);

872 
	gfú°
 = 0;

874 
vty_show_ù_rouã
 (
vty
, 
∫
, 
rib
);

876  
	gCMD_SUCCESS
;

879 
DEFUN
 (
show_ù_rouã_su≥∫ës
,

880 
show_ù_rouã_su≥∫ës_cmd
,

882 
SHOW_STR


883 
IP_STR


887 
rouã_èbÀ
 *
	gèbÀ
;

888 
rouã_node
 *
	g∫
;

889 
rib
 *
	grib
;

890 
u_öt32_t
 
	gaddr
;

891 
	gfú°
 = 1;

893 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

894 i‡(! 
	gèbÀ
)

895  
	gCMD_SUCCESS
;

898 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

899 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

901 
	gaddr
 = 
¡ohl
 (
∫
->
p
.
u
.
¥efix4
.
s_addr
);

903 i‡((
IN_CLASSC
 (
addr
Ë&& 
	g∫
->
	gp
.
	g¥efixÀn
 < 24)

904 || (
IN_CLASSB
 (
addr
Ë&& 
	g∫
->
	gp
.
	g¥efixÀn
 < 16)

905 || (
IN_CLASSA
 (
addr
Ë&& 
	g∫
->
	gp
.
	g¥efixÀn
 < 8))

907 i‡(
	gfú°
)

909 
vty_out
 (
vty
, 
SHOW_ROUTE_V4_HEADER
);

910 
	gfú°
 = 0;

912 
vty_show_ù_rouã
 (
vty
, 
∫
, 
rib
);

915  
	gCMD_SUCCESS
;

918 
DEFUN
 (
show_ù_rouã_¥Ÿocﬁ
,

919 
show_ù_rouã_¥Ÿocﬁ_cmd
,

920 "show i∞rouã " 
QUAGGA_IP_REDIST_STR_ZEBRA
,

921 
SHOW_STR


922 
IP_STR


924 
QUAGGA_IP_REDIST_HELP_STR_ZEBRA
)

926 
	gty≥
;

927 
rouã_èbÀ
 *
	gèbÀ
;

928 
rouã_node
 *
	g∫
;

929 
rib
 *
	grib
;

930 
	gfú°
 = 1;

932 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP
, 
¨gv
[0]);

933 i‡(
	gty≥
 < 0)

935 
vty_out
 (
vty
, "Unknow¿rouãÅy≥%s", 
VTY_NEWLINE
);

936  
	gCMD_WARNING
;

939 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

940 i‡(! 
	gèbÀ
)

941  
	gCMD_SUCCESS
;

944 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

945 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

946 i‡(
	grib
->
	gty≥
 =
ty≥
)

948 i‡(
fú°
)

950 
vty_out
 (
vty
, 
SHOW_ROUTE_V4_HEADER
);

951 
	gfú°
 = 0;

953 
vty_show_ù_rouã
 (
vty
, 
∫
, 
rib
);

955  
	gCMD_SUCCESS
;

958 
DEFUN
 (
show_ù_rouã_addr
,

959 
show_ù_rouã_addr_cmd
,

961 
SHOW_STR


962 
IP_STR


966 
	gªt
;

967 
¥efix_ùv4
 
	gp
;

968 
rouã_èbÀ
 *
	gèbÀ
;

969 
rouã_node
 *
	g∫
;

971 
	gªt
 = 
°r2¥efix_ùv4
 (
¨gv
[0], &
p
);

972 i‡(
	gªt
 <= 0)

974 
vty_out
 (
vty
, "%% MÆf‹med IPv4áddªss%s", 
VTY_NEWLINE
);

975  
	gCMD_WARNING
;

978 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

979 i‡(! 
	gèbÀ
)

980  
	gCMD_SUCCESS
;

982 
	g∫
 = 
rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

983 i‡(! 
	g∫
)

985 
vty_out
 (
vty
, "%% Nëw‹kÇŸ i¿èbÀ%s", 
VTY_NEWLINE
);

986  
	gCMD_WARNING
;

989 
vty_show_ù_rouã_dëaû
 (
vty
, 
∫
);

991 
rouã_u∆ock_node
 (
∫
);

993  
	gCMD_SUCCESS
;

996 
DEFUN
 (
show_ù_rouã_¥efix
,

997 
show_ù_rouã_¥efix_cmd
,

999 
SHOW_STR


1000 
IP_STR


1004 
	gªt
;

1005 
¥efix_ùv4
 
	gp
;

1006 
rouã_èbÀ
 *
	gèbÀ
;

1007 
rouã_node
 *
	g∫
;

1009 
	gªt
 = 
°r2¥efix_ùv4
 (
¨gv
[0], &
p
);

1010 i‡(
	gªt
 <= 0)

1012 
vty_out
 (
vty
, "%% MÆf‹med IPv4áddªss%s", 
VTY_NEWLINE
);

1013  
	gCMD_WARNING
;

1016 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

1017 i‡(! 
	gèbÀ
)

1018  
	gCMD_SUCCESS
;

1020 
	g∫
 = 
rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

1021 i‡(! 
	g∫
 ||Ñn->
	gp
.
	g¥efixÀn
 !
p
.
¥efixÀn
)

1023 
vty_out
 (
vty
, "%% Nëw‹kÇŸ i¿èbÀ%s", 
VTY_NEWLINE
);

1024  
	gCMD_WARNING
;

1027 
vty_show_ù_rouã_dëaû
 (
vty
, 
∫
);

1029 
rouã_u∆ock_node
 (
∫
);

1031  
	gCMD_SUCCESS
;

1035 
	$vty_show_ù_rouã_summ¨y
 (
vty
 *vty, 
rouã_èbÀ
 *
èbÀ
)

1037 
rouã_node
 *
∫
;

1038 
rib
 *rib;

1039 
√xth›
 *nexthop;

1040 
	#ZEBRA_ROUTE_IBGP
 
ZEBRA_ROUTE_MAX


	)

1041 
	#ZEBRA_ROUTE_TOTAL
 (
ZEBRA_ROUTE_IBGP
 + 1)

	)

1042 
u_öt32_t
 
rib_˙t
[
ZEBRA_ROUTE_TOTAL
 + 1];

1043 
u_öt32_t
 
fib_˙t
[
ZEBRA_ROUTE_TOTAL
 + 1];

1044 
u_öt32_t
 
i
;

1046 
	`mem£t
 (&
rib_˙t
, 0, (rib_cnt));

1047 
	`mem£t
 (&
fib_˙t
, 0, (fib_cnt));

1048 
∫
 = 
	`rouã_t›
 (
èbÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

1049 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1050 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1052 
rib_˙t
[
ZEBRA_ROUTE_TOTAL
]++;

1053 
rib_˙t
[
rib
->
ty≥
]++;

1054 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

1056 
fib_˙t
[
ZEBRA_ROUTE_TOTAL
]++;

1057 
fib_˙t
[
rib
->
ty≥
]++;

1059 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_BGP
 &&

1060 
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_IBGP
))

1062 
rib_˙t
[
ZEBRA_ROUTE_IBGP
]++;

1063 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

1064 
fib_˙t
[
ZEBRA_ROUTE_IBGP
]++;

1068 
	`vty_out
 (
vty
, "%-20s %-20s %-20s %s",

1069 "Rouã Sour˚", "Rouãs", "FIB", 
VTY_NEWLINE
);

1071 
i
 = 0; i < 
ZEBRA_ROUTE_MAX
; i++)

1073 i‡(
rib_˙t
[
i
] > 0)

1075 i‡(
i
 =
ZEBRA_ROUTE_BGP
)

1077 
	`vty_out
 (
vty
, "%-20s %-20d %-20d %s", "ebgp",

1078 
rib_˙t
[
ZEBRA_ROUTE_BGP
] -Ñib_˙t[
ZEBRA_ROUTE_IBGP
],

1079 
fib_˙t
[
ZEBRA_ROUTE_BGP
] - fib_˙t[
ZEBRA_ROUTE_IBGP
],

1080 
VTY_NEWLINE
);

1081 
	`vty_out
 (
vty
, "%-20s %-20d %-20d %s", "ibgp",

1082 
rib_˙t
[
ZEBRA_ROUTE_IBGP
], 
fib_˙t
[ZEBRA_ROUTE_IBGP],

1083 
VTY_NEWLINE
);

1086 
	`vty_out
 (
vty
, "%-20†%-20d %-20d %s", 
	`zebø_rouã_°rög
(
i
),

1087 
rib_˙t
[
i
], 
fib_˙t
[i], 
VTY_NEWLINE
);

1091 
	`vty_out
 (
vty
, "------%s", 
VTY_NEWLINE
);

1092 
	`vty_out
 (
vty
, "%-20†%-20d %-20d %s", "TŸÆs", 
rib_˙t
[
ZEBRA_ROUTE_TOTAL
],

1093 
fib_˙t
[
ZEBRA_ROUTE_TOTAL
], 
VTY_NEWLINE
);

1094 
	}
}

1097 
DEFUN
 (
show_ù_rouã_summ¨y
,

1098 
show_ù_rouã_summ¨y_cmd
,

1100 
SHOW_STR


1101 
IP_STR


1105 
rouã_èbÀ
 *
	gèbÀ
;

1107 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

1108 i‡(! 
	gèbÀ
)

1109  
	gCMD_SUCCESS
;

1111 
vty_show_ù_rouã_summ¨y
 (
vty
, 
èbÀ
);

1113  
	gCMD_SUCCESS
;

1118 
	$°©ic_c⁄fig_ùv4
 (
vty
 *vty)

1120 
rouã_node
 *
∫
;

1121 
°©ic_ùv4
 *
si
;

1122 
rouã_èbÀ
 *
°abÀ
;

1123 
wrôe
;

1125 
wrôe
 = 0;

1128 
°abÀ
 = 
	`vrf_°©ic_èbÀ
 (
AFI_IP
, 
SAFI_UNICAST
, 0);

1129 i‡(! 
°abÀ
)

1132 
∫
 = 
	`rouã_t›
 (
°abÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

1133 
si
 = 
∫
->
öfo
; si; sòsi->
√xt
)

1135 
	`vty_out
 (
vty
, "ùÑouã %s/%d", 
	`öë_¡ﬂ
 (
∫
->
p
.
u
.
¥efix4
),

1136 
∫
->
p
.
¥efixÀn
);

1138 
si
->
ty≥
)

1140 
STATIC_IPV4_GATEWAY
:

1141 
	`vty_out
 (
vty
, " %s", 
	`öë_¡ﬂ
 (
si
->
g©e
.
ùv4
));

1143 
STATIC_IPV4_IFNAME
:

1144 
	`vty_out
 (
vty
, " %s", 
si
->
g©e
.
i‚ame
);

1146 
STATIC_IPV4_BLACKHOLE
:

1147 
	`vty_out
 (
vty
, " Null0");

1152 i‡(
si
->
ty≥
 !
STATIC_IPV4_BLACKHOLE
)

1154 i‡(
	`CHECK_FLAG
(
si
->
Êags
, 
ZEBRA_FLAG_REJECT
))

1155 
	`vty_out
 (
vty
, " %s", "reject");

1157 i‡(
	`CHECK_FLAG
(
si
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

1158 
	`vty_out
 (
vty
, " %s", "blackhole");

1161 i‡(
si
->
di°™˚
 !
ZEBRA_STATIC_DISTANCE_DEFAULT
)

1162 
	`vty_out
 (
vty
, " %d", 
si
->
di°™˚
);

1164 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1166 
wrôe
 = 1;

1168  
wrôe
;

1169 
	}
}

1171 
DEFUN
 (
show_ù_¥Ÿocﬁ
,

1172 
show_ù_¥Ÿocﬁ_cmd
,

1174 
SHOW_STR


1175 
IP_STR


1178 
	gi
;

1180 
vty_out
(
vty
, "PrŸocﬁ :Ñouã-m≠ %s", 
VTY_NEWLINE
);

1181 
vty_out
(
vty
, "------------------------%s", 
VTY_NEWLINE
);

1182 
	gi
=0;i<
	gZEBRA_ROUTE_MAX
;i++)

1184 i‡(
	g¥Ÿo_rm
[
AFI_IP
][
i
])

1185 
vty_out
 (
vty
, "%-10† : %-10s%s", 
zebø_rouã_°rög
(
i
),

1186 
¥Ÿo_rm
[
AFI_IP
][
i
],

1187 
VTY_NEWLINE
);

1189 
vty_out
 (
vty
, "%-10† :Ç⁄e%s", 
zebø_rouã_°rög
(
i
), 
VTY_NEWLINE
);

1191 i‡(
	g¥Ÿo_rm
[
AFI_IP
][
i
])

1192 
vty_out
 (
vty
, "%-10† : %-10s%s", "™y", 
¥Ÿo_rm
[
AFI_IP
][
i
],

1193 
VTY_NEWLINE
);

1195 
vty_out
 (
vty
, "%-10† :Ç⁄e%s", "™y", 
VTY_NEWLINE
);

1197  
	gCMD_SUCCESS
;

1204 
DEFUN
 (
show_ù_mrouã
,

1205 
show_ù_mrouã_cmd
,

1207 
SHOW_STR


1208 
IP_STR


1211 
rouã_èbÀ
 *
	gèbÀ
;

1212 
rouã_node
 *
	g∫
;

1213 
rib
 *
	grib
;

1214 
	gfú°
 = 1;

1216 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP
, 
SAFI_MULTICAST
, 0);

1217 i‡(! 
	gèbÀ
)

1218  
	gCMD_SUCCESS
;

1221 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

1222 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1224 i‡(
	gfú°
)

1226 
vty_out
 (
vty
, 
SHOW_ROUTE_V4_HEADER
);

1227 
	gfú°
 = 0;

1229 
vty_show_ù_rouã
 (
vty
, 
∫
, 
rib
);

1231  
	gCMD_SUCCESS
;

1235 #ifde‡
HAVE_IPV6


1238 
	$°©ic_ùv6_func
 (
vty
 *vty, 
add_cmd
, c⁄° *
de°_°r
,

1239 c⁄° *
g©e_°r
, c⁄° *
i‚ame
,

1240 c⁄° *
Êag_°r
, c⁄° *
di°™˚_°r
)

1242 
ªt
;

1243 
u_ch¨
 
di°™˚
;

1244 
¥efix
 
p
;

1245 
ö6_addr
 *
g©e
 = 
NULL
;

1246 
ö6_addr
 
g©e_addr
;

1247 
u_ch¨
 
ty≥
 = 0;

1248 
èbÀ
 = 0;

1249 
u_ch¨
 
Êag
 = 0;

1251 
ªt
 = 
	`°r2¥efix
 (
de°_°r
, &
p
);

1252 i‡(
ªt
 <= 0)

1254 
	`vty_out
 (
vty
, "%% MÆf‹medáddªss%s", 
VTY_NEWLINE
);

1255  
CMD_WARNING
;

1259 
	`≠∂y_mask
 (&
p
);

1262 i‡(
Êag_°r
) {

1263 
Êag_°r
[0]) {

1266 
	`SET_FLAG
 (
Êag
, 
ZEBRA_FLAG_REJECT
);

1270 
	`SET_FLAG
 (
Êag
, 
ZEBRA_FLAG_BLACKHOLE
);

1273 
	`vty_out
 (
vty
, "%% MÆf‹med fœg %†%s", 
Êag_°r
, 
VTY_NEWLINE
);

1274  
CMD_WARNING
;

1279 i‡(
di°™˚_°r
)

1280 
di°™˚
 = 
	`©oi
 (
di°™˚_°r
);

1282 
di°™˚
 = 
ZEBRA_STATIC_DISTANCE_DEFAULT
;

1286 
ªt
 = 
	`öë_±⁄
 (
AF_INET6
, 
g©e_°r
, &
g©e_addr
);

1288 i‡(
i‚ame
)

1292 i‡(
ªt
 != 1)

1294 
	`vty_out
 (
vty
, "%% MÆf‹medáddªss%s", 
VTY_NEWLINE
);

1295  
CMD_WARNING
;

1297 
ty≥
 = 
STATIC_IPV6_GATEWAY_IFNAME
;

1298 
g©e
 = &
g©e_addr
;

1302 i‡(
ªt
 == 1)

1304 
ty≥
 = 
STATIC_IPV6_GATEWAY
;

1305 
g©e
 = &
g©e_addr
;

1309 
ty≥
 = 
STATIC_IPV6_IFNAME
;

1310 
i‚ame
 = 
g©e_°r
;

1314 i‡(
add_cmd
)

1315 
	`°©ic_add_ùv6
 (&
p
, 
ty≥
, 
g©e
, 
i‚ame
, 
Êag
, 
di°™˚
, 
èbÀ
);

1317 
	`°©ic_dñëe_ùv6
 (&
p
, 
ty≥
, 
g©e
, 
i‚ame
, 
di°™˚
, 
èbÀ
);

1319  
CMD_SUCCESS
;

1320 
	}
}

1322 
DEFUN
 (
ùv6_rouã
,

1323 
ùv6_rouã_cmd
,

1325 
IP_STR


1331  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1], 
NULL
, NULL, NULL);

1334 
DEFUN
 (
ùv6_rouã_Êags
,

1335 
ùv6_rouã_Êags_cmd
,

1337 
IP_STR


1345  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1], 
NULL
,árgv[2], NULL);

1348 
DEFUN
 (
ùv6_rouã_i‚ame
,

1349 
ùv6_rouã_i‚ame_cmd
,

1351 
IP_STR


1357  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2], 
NULL
, NULL);

1360 
DEFUN
 (
ùv6_rouã_i‚ame_Êags
,

1361 
ùv6_rouã_i‚ame_Êags_cmd
,

1363 
IP_STR


1371  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2],árgv[3], 
NULL
);

1374 
DEFUN
 (
ùv6_rouã_¥ef
,

1375 
ùv6_rouã_¥ef_cmd
,

1377 
IP_STR


1384  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1], 
NULL
, NULL,árgv[2]);

1387 
DEFUN
 (
ùv6_rouã_Êags_¥ef
,

1388 
ùv6_rouã_Êags_¥ef_cmd
,

1390 
IP_STR


1399  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1], 
NULL
,árgv[2],árgv[3]);

1402 
DEFUN
 (
ùv6_rouã_i‚ame_¥ef
,

1403 
ùv6_rouã_i‚ame_¥ef_cmd
,

1405 
IP_STR


1412  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2], 
NULL
,árgv[3]);

1415 
DEFUN
 (
ùv6_rouã_i‚ame_Êags_¥ef
,

1416 
ùv6_rouã_i‚ame_Êags_¥ef_cmd
,

1418 
IP_STR


1427  
°©ic_ùv6_func
 (
vty
, 1, 
¨gv
[0],árgv[1],árgv[2],árgv[3],árgv[4]);

1430 
DEFUN
 (
no_ùv6_rouã
,

1431 
no_ùv6_rouã_cmd
,

1433 
NO_STR


1434 
IP_STR


1440  
°©ic_ùv6_func
 (
vty
, 0, 
¨gv
[0],árgv[1], 
NULL
, NULL, NULL);

1443 
ALIAS
 (
no_ùv6_rouã
,

1444 
no_ùv6_rouã_Êags_cmd
,

1446 
NO_STR


1447 
IP_STR


1455 
DEFUN
 (
no_ùv6_rouã_i‚ame
,

1456 
no_ùv6_rouã_i‚ame_cmd
,

1458 
NO_STR


1459 
IP_STR


1465  
°©ic_ùv6_func
 (
vty
, 0, 
¨gv
[0],árgv[1],árgv[2], 
NULL
, NULL);

1468 
ALIAS
 (
no_ùv6_rouã_i‚ame
,

1469 
no_ùv6_rouã_i‚ame_Êags_cmd
,

1471 
NO_STR


1472 
IP_STR


1480 
DEFUN
 (
no_ùv6_rouã_¥ef
,

1481 
no_ùv6_rouã_¥ef_cmd
,

1483 
NO_STR


1484 
IP_STR


1491  
°©ic_ùv6_func
 (
vty
, 0, 
¨gv
[0],árgv[1], 
NULL
, NULL,árgv[2]);

1494 
DEFUN
 (
no_ùv6_rouã_Êags_¥ef
,

1495 
no_ùv6_rouã_Êags_¥ef_cmd
,

1497 
NO_STR


1498 
IP_STR


1508  
°©ic_ùv6_func
 (
vty
, 0, 
¨gv
[0],árgv[1], 
NULL
,árgv[2],árgv[3]);

1511 
DEFUN
 (
no_ùv6_rouã_i‚ame_¥ef
,

1512 
no_ùv6_rouã_i‚ame_¥ef_cmd
,

1514 
NO_STR


1515 
IP_STR


1522  
°©ic_ùv6_func
 (
vty
, 0, 
¨gv
[0],árgv[1],árgv[2], 
NULL
,árgv[3]);

1525 
DEFUN
 (
no_ùv6_rouã_i‚ame_Êags_¥ef
,

1526 
no_ùv6_rouã_i‚ame_Êags_¥ef_cmd
,

1528 
NO_STR


1529 
IP_STR


1538  
°©ic_ùv6_func
 (
vty
, 0, 
¨gv
[0],árgv[1],árgv[2],árgv[3],árgv[4]);

1543 
	$vty_show_ùv6_rouã_dëaû
 (
vty
 *vty, 
rouã_node
 *
∫
)

1545 
rib
 *rib;

1546 
√xth›
 *nexthop;

1547 
buf
[
BUFSIZ
];

1549 
	`RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1551 
	`vty_out
 (
vty
, "RoutingÉntry for %s/%d%s",

1552 
	`öë_¡›
 (
AF_INET6
, &
∫
->
p
.
u
.
¥efix6
, 
buf
, 
BUFSIZ
),

1553 
∫
->
p
.
¥efixÀn
,

1554 
VTY_NEWLINE
);

1555 
	`vty_out
 (
vty
, " Know¿vü \"%s\"", 
	`zebø_rouã_°rög
 (
rib
->
ty≥
));

1556 
	`vty_out
 (
vty
, ", di°™˚ %u, mëri¯%u", 
rib
->
di°™˚
,Ñib->
mëric
);

1557 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
))

1558 
	`vty_out
 (
vty
, ", best");

1559 i‡(
rib
->
ªf˙t
)

1560 
	`vty_out
 (
vty
, ",Ñef˙à%ld", 
rib
->
ªf˙t
);

1561 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

1562 
	`vty_out
 (
vty
, ", blackhole");

1563 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_REJECT
))

1564 
	`vty_out
 (
vty
, ",Ñeject");

1565 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1567 
	#ONE_DAY_SECOND
 60*60*24

	)

1568 
	#ONE_WEEK_SECOND
 60*60*24*7

	)

1569 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_RIPNG


1570 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_OSPF6


1571 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BABEL


1572 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_ISIS


1573 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

1575 
time_t
 
u±ime
;

1576 
tm
 *tm;

1578 
u±ime
 = 
	`time
 (
NULL
);

1579 
u±ime
 -
rib
->uptime;

1580 
tm
 = 
	`gmtime
 (&
u±ime
);

1582 
	`vty_out
 (
vty
, " Last update ");

1584 i‡(
u±ime
 < 
ONE_DAY_SECOND
)

1585 
	`vty_out
 (
vty
, "%02d:%02d:%02d",

1586 
tm
->
tm_hour
,Åm->
tm_mö
,Åm->
tm_£c
);

1587 i‡(
u±ime
 < 
ONE_WEEK_SECOND
)

1588 
	`vty_out
 (
vty
, "%dd%02dh%02dm",

1589 
tm
->
tm_yday
,Åm->
tm_hour
,Åm->
tm_mö
);

1591 
	`vty_out
 (
vty
, "%02dw%dd%02dh",

1592 
tm
->
tm_yday
/7,

1593 
tm
->
tm_yday
 - (—m->tm_yday/7Ë* 7),Åm->
tm_hour
);

1594 
	`vty_out
 (
vty
, "ágo%s", 
VTY_NEWLINE
);

1597 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1599 
	`vty_out
 (
vty
, " %c",

1600 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
) ? '*' : ' ');

1602 
√xth›
->
ty≥
)

1604 
NEXTHOP_TYPE_IPV6
:

1605 
NEXTHOP_TYPE_IPV6_IFINDEX
:

1606 
NEXTHOP_TYPE_IPV6_IFNAME
:

1607 
	`vty_out
 (
vty
, " %s",

1608 
	`öë_¡›
 (
AF_INET6
, &
√xth›
->
g©e
.
ùv6
, 
buf
, 
BUFSIZ
));

1609 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

1610 
	`vty_out
 (
vty
, ", %s", 
√xth›
->
i‚ame
);

1611 i‡(
√xth›
->
ifödex
)

1612 
	`vty_out
 (
vty
, ", vü %s", 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

1614 
NEXTHOP_TYPE_IFINDEX
:

1615 
	`vty_out
 (
vty
, " directly connected, %s",

1616 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

1618 
NEXTHOP_TYPE_IFNAME
:

1619 
	`vty_out
 (
vty
, " directly connected, %s",

1620 
√xth›
->
i‚ame
);

1625 i‡(! 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

1626 
	`vty_out
 (
vty
, " inactive");

1628 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

1630 
	`vty_out
 (
vty
, " (recursive");

1632 
√xth›
->
πy≥
)

1634 
NEXTHOP_TYPE_IPV6
:

1635 
NEXTHOP_TYPE_IPV6_IFINDEX
:

1636 
NEXTHOP_TYPE_IPV6_IFNAME
:

1637 
	`vty_out
 (
vty
, " via %s)",

1638 
	`öë_¡›
 (
AF_INET6
, &
√xth›
->
rg©e
.
ùv6
,

1639 
buf
, 
BUFSIZ
));

1640 i‡(
√xth›
->
rifödex
)

1641 
	`vty_out
 (
vty
, ", %s", 
	`ifödex2i‚ame
 (
√xth›
->
rifödex
));

1643 
NEXTHOP_TYPE_IFINDEX
:

1644 
NEXTHOP_TYPE_IFNAME
:

1645 
	`vty_out
 (
vty
, " is directly connected, %s)",

1646 
	`ifödex2i‚ame
 (
√xth›
->
rifödex
));

1652 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1654 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1656 
	}
}

1659 
	$vty_show_ùv6_rouã
 (
vty
 *vty, 
rouã_node
 *
∫
,

1660 
rib
 *rib)

1662 
√xth›
 *nexthop;

1663 
Àn
 = 0;

1664 
buf
[
BUFSIZ
];

1667 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

1669 i‡(
√xth›
 =
rib
->nexthop)

1672 
Àn
 = 
	`vty_out
 (
vty
, "%c%c%c %s/%d",

1673 
	`zebø_rouã_ch¨
 (
rib
->
ty≥
),

1674 
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_SELECTED
)

1676 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

1678 
	`öë_¡›
 (
AF_INET6
, &
∫
->
p
.
u
.
¥efix6
, 
buf
, 
BUFSIZ
),

1679 
∫
->
p
.
¥efixÀn
);

1682 i‡(
rib
->
ty≥
 !
ZEBRA_ROUTE_CONNECT


1683 && 
rib
->
ty≥
 !
ZEBRA_ROUTE_KERNEL
)

1684 
Àn
 +
	`vty_out
 (
vty
, " [%d/%d]", 
rib
->
di°™˚
,

1685 
rib
->
mëric
);

1688 
	`vty_out
 (
vty
, " %c%*c",

1689 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
)

1691 
Àn
 - 3, ' ');

1693 
√xth›
->
ty≥
)

1695 
NEXTHOP_TYPE_IPV6
:

1696 
NEXTHOP_TYPE_IPV6_IFINDEX
:

1697 
NEXTHOP_TYPE_IPV6_IFNAME
:

1698 
	`vty_out
 (
vty
, " via %s",

1699 
	`öë_¡›
 (
AF_INET6
, &
√xth›
->
g©e
.
ùv6
, 
buf
, 
BUFSIZ
));

1700 i‡(
√xth›
->
ty≥
 =
NEXTHOP_TYPE_IPV6_IFNAME
)

1701 
	`vty_out
 (
vty
, ", %s", 
√xth›
->
i‚ame
);

1702 i‡(
√xth›
->
ifödex
)

1703 
	`vty_out
 (
vty
, ", %s", 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

1705 
NEXTHOP_TYPE_IFINDEX
:

1706 
	`vty_out
 (
vty
, " is directly connected, %s",

1707 
	`ifödex2i‚ame
 (
√xth›
->
ifödex
));

1709 
NEXTHOP_TYPE_IFNAME
:

1710 
	`vty_out
 (
vty
, " is directly connected, %s",

1711 
√xth›
->
i‚ame
);

1716 i‡(! 
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_ACTIVE
))

1717 
	`vty_out
 (
vty
, " inactive");

1719 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_RECURSIVE
))

1721 
	`vty_out
 (
vty
, " (recursive");

1723 
√xth›
->
πy≥
)

1725 
NEXTHOP_TYPE_IPV6
:

1726 
NEXTHOP_TYPE_IPV6_IFINDEX
:

1727 
NEXTHOP_TYPE_IPV6_IFNAME
:

1728 
	`vty_out
 (
vty
, " via %s)",

1729 
	`öë_¡›
 (
AF_INET6
, &
√xth›
->
rg©e
.
ùv6
,

1730 
buf
, 
BUFSIZ
));

1731 i‡(
√xth›
->
rifödex
)

1732 
	`vty_out
 (
vty
, ", %s", 
	`ifödex2i‚ame
 (
√xth›
->
rifödex
));

1734 
NEXTHOP_TYPE_IFINDEX
:

1735 
NEXTHOP_TYPE_IFNAME
:

1736 
	`vty_out
 (
vty
, " is directly connected, %s)",

1737 
	`ifödex2i‚ame
 (
√xth›
->
rifödex
));

1744 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

1745 
	`vty_out
 (
vty
, ", bh");

1746 i‡(
	`CHECK_FLAG
 (
rib
->
Êags
, 
ZEBRA_FLAG_REJECT
))

1747 
	`vty_out
 (
vty
, ",Ñej");

1749 i‡(
rib
->
ty≥
 =
ZEBRA_ROUTE_RIPNG


1750 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_OSPF6


1751 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BABEL


1752 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_ISIS


1753 || 
rib
->
ty≥
 =
ZEBRA_ROUTE_BGP
)

1755 
time_t
 
u±ime
;

1756 
tm
 *tm;

1758 
u±ime
 = 
	`time
 (
NULL
);

1759 
u±ime
 -
rib
->uptime;

1760 
tm
 = 
	`gmtime
 (&
u±ime
);

1762 
	#ONE_DAY_SECOND
 60*60*24

	)

1763 
	#ONE_WEEK_SECOND
 60*60*24*7

	)

1765 i‡(
u±ime
 < 
ONE_DAY_SECOND
)

1766 
	`vty_out
 (
vty
, ", %02d:%02d:%02d",

1767 
tm
->
tm_hour
,Åm->
tm_mö
,Åm->
tm_£c
);

1768 i‡(
u±ime
 < 
ONE_WEEK_SECOND
)

1769 
	`vty_out
 (
vty
, ", %dd%02dh%02dm",

1770 
tm
->
tm_yday
,Åm->
tm_hour
,Åm->
tm_mö
);

1772 
	`vty_out
 (
vty
, ", %02dw%dd%02dh",

1773 
tm
->
tm_yday
/7,

1774 
tm
->
tm_yday
 - (—m->tm_yday/7Ë* 7),Åm->
tm_hour
);

1776 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

1778 
	}
}

1780 
DEFUN
 (
show_ùv6_rouã
,

1781 
show_ùv6_rouã_cmd
,

1783 
SHOW_STR


1784 
IP_STR


1787 
rouã_èbÀ
 *
	gèbÀ
;

1788 
rouã_node
 *
	g∫
;

1789 
rib
 *
	grib
;

1790 
	gfú°
 = 1;

1792 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

1793 i‡(! 
	gèbÀ
)

1794  
	gCMD_SUCCESS
;

1797 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

1798 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1800 i‡(
	gfú°
)

1802 
vty_out
 (
vty
, 
SHOW_ROUTE_V6_HEADER
);

1803 
	gfú°
 = 0;

1805 
vty_show_ùv6_rouã
 (
vty
, 
∫
, 
rib
);

1807  
	gCMD_SUCCESS
;

1810 
DEFUN
 (
show_ùv6_rouã_¥efix_l⁄gî
,

1811 
show_ùv6_rouã_¥efix_l⁄gî_cmd
,

1813 
SHOW_STR


1814 
IP_STR


1819 
rouã_èbÀ
 *
	gèbÀ
;

1820 
rouã_node
 *
	g∫
;

1821 
rib
 *
	grib
;

1822 
¥efix
 
	gp
;

1823 
	gªt
;

1824 
	gfú°
 = 1;

1826 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

1827 i‡(! 
	gèbÀ
)

1828  
	gCMD_SUCCESS
;

1830 
	gªt
 = 
°r2¥efix
 (
¨gv
[0], &
p
);

1831 i‡(! 
	gªt
)

1833 
vty_out
 (
vty
, "%% MÆf‹med Pªfix%s", 
VTY_NEWLINE
);

1834  
	gCMD_WARNING
;

1838 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

1839 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1840 i‡(
¥efix_m©ch
 (&
p
, &
∫
->p))

1842 i‡(
	gfú°
)

1844 
vty_out
 (
vty
, 
SHOW_ROUTE_V6_HEADER
);

1845 
	gfú°
 = 0;

1847 
vty_show_ùv6_rouã
 (
vty
, 
∫
, 
rib
);

1849  
	gCMD_SUCCESS
;

1852 
DEFUN
 (
show_ùv6_rouã_¥Ÿocﬁ
,

1853 
show_ùv6_rouã_¥Ÿocﬁ_cmd
,

1854 "show ipv6Ñouã " 
QUAGGA_IP6_REDIST_STR_ZEBRA
,

1855 
SHOW_STR


1856 
IP_STR


1858 
QUAGGA_IP6_REDIST_HELP_STR_ZEBRA
)

1860 
	gty≥
;

1861 
rouã_èbÀ
 *
	gèbÀ
;

1862 
rouã_node
 *
	g∫
;

1863 
rib
 *
	grib
;

1864 
	gfú°
 = 1;

1866 
	gty≥
 = 
¥Ÿo_ªdi°num
 (
AFI_IP6
, 
¨gv
[0]);

1867 i‡(
	gty≥
 < 0)

1869 
vty_out
 (
vty
, "Unknow¿rouãÅy≥%s", 
VTY_NEWLINE
);

1870  
	gCMD_WARNING
;

1873 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

1874 i‡(! 
	gèbÀ
)

1875  
	gCMD_SUCCESS
;

1878 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

1879 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

1880 i‡(
	grib
->
	gty≥
 =
ty≥
)

1882 i‡(
fú°
)

1884 
vty_out
 (
vty
, 
SHOW_ROUTE_V6_HEADER
);

1885 
	gfú°
 = 0;

1887 
vty_show_ùv6_rouã
 (
vty
, 
∫
, 
rib
);

1889  
	gCMD_SUCCESS
;

1892 
DEFUN
 (
show_ùv6_rouã_addr
,

1893 
show_ùv6_rouã_addr_cmd
,

1895 
SHOW_STR


1896 
IP_STR


1900 
	gªt
;

1901 
¥efix_ùv6
 
	gp
;

1902 
rouã_èbÀ
 *
	gèbÀ
;

1903 
rouã_node
 *
	g∫
;

1905 
	gªt
 = 
°r2¥efix_ùv6
 (
¨gv
[0], &
p
);

1906 i‡(
	gªt
 <= 0)

1908 
vty_out
 (
vty
, "MÆf‹med IPv6áddªss%s", 
VTY_NEWLINE
);

1909  
	gCMD_WARNING
;

1912 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

1913 i‡(! 
	gèbÀ
)

1914  
	gCMD_SUCCESS
;

1916 
	g∫
 = 
rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

1917 i‡(! 
	g∫
)

1919 
vty_out
 (
vty
, "%% Nëw‹kÇŸ i¿èbÀ%s", 
VTY_NEWLINE
);

1920  
	gCMD_WARNING
;

1923 
vty_show_ùv6_rouã_dëaû
 (
vty
, 
∫
);

1925 
rouã_u∆ock_node
 (
∫
);

1927  
	gCMD_SUCCESS
;

1930 
DEFUN
 (
show_ùv6_rouã_¥efix
,

1931 
show_ùv6_rouã_¥efix_cmd
,

1933 
SHOW_STR


1934 
IP_STR


1938 
	gªt
;

1939 
¥efix_ùv6
 
	gp
;

1940 
rouã_èbÀ
 *
	gèbÀ
;

1941 
rouã_node
 *
	g∫
;

1943 
	gªt
 = 
°r2¥efix_ùv6
 (
¨gv
[0], &
p
);

1944 i‡(
	gªt
 <= 0)

1946 
vty_out
 (
vty
, "MÆf‹med IPv6Öªfix%s", 
VTY_NEWLINE
);

1947  
	gCMD_WARNING
;

1950 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

1951 i‡(! 
	gèbÀ
)

1952  
	gCMD_SUCCESS
;

1954 
	g∫
 = 
rouã_node_m©ch
 (
èbÀ
, (
¥efix
 *Ë&
p
);

1955 i‡(! 
	g∫
 ||Ñn->
	gp
.
	g¥efixÀn
 !
p
.
¥efixÀn
)

1957 
vty_out
 (
vty
, "%% Nëw‹kÇŸ i¿èbÀ%s", 
VTY_NEWLINE
);

1958  
	gCMD_WARNING
;

1961 
vty_show_ùv6_rouã_dëaû
 (
vty
, 
∫
);

1963 
rouã_u∆ock_node
 (
∫
);

1965  
	gCMD_SUCCESS
;

1969 
DEFUN
 (
show_ùv6_rouã_summ¨y
,

1970 
show_ùv6_rouã_summ¨y_cmd
,

1972 
SHOW_STR


1973 
IP_STR


1977 
rouã_èbÀ
 *
	gèbÀ
;

1979 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

1980 i‡(! 
	gèbÀ
)

1981  
	gCMD_SUCCESS
;

1983 
vty_show_ù_rouã_summ¨y
 (
vty
, 
èbÀ
);

1985  
	gCMD_SUCCESS
;

1993 
DEFUN
 (
show_ùv6_mrouã
,

1994 
show_ùv6_mrouã_cmd
,

1996 
SHOW_STR


1997 
IP_STR


2000 
rouã_èbÀ
 *
	gèbÀ
;

2001 
rouã_node
 *
	g∫
;

2002 
rib
 *
	grib
;

2003 
	gfú°
 = 1;

2005 
	gèbÀ
 = 
vrf_èbÀ
 (
AFI_IP6
, 
SAFI_MULTICAST
, 0);

2006 i‡(! 
	gèbÀ
)

2007  
	gCMD_SUCCESS
;

2010 
	g∫
 = 
rouã_t›
 (
èbÀ
);Ñn;Ñ¿
rouã_√xt
 (
∫
))

2011 
RNODE_FOREACH_RIB
 (
∫
, 
rib
)

2013 i‡(
	gfú°
)

2015 
vty_out
 (
vty
, 
SHOW_ROUTE_V6_HEADER
);

2016 
	gfú°
 = 0;

2018 
vty_show_ùv6_rouã
 (
vty
, 
∫
, 
rib
);

2020  
	gCMD_SUCCESS
;

2025 
	$°©ic_c⁄fig_ùv6
 (
vty
 *vty)

2027 
rouã_node
 *
∫
;

2028 
°©ic_ùv6
 *
si
;

2029 
wrôe
;

2030 
buf
[
BUFSIZ
];

2031 
rouã_èbÀ
 *
°abÀ
;

2033 
wrôe
 = 0;

2036 
°abÀ
 = 
	`vrf_°©ic_èbÀ
 (
AFI_IP6
, 
SAFI_UNICAST
, 0);

2037 i‡(! 
°abÀ
)

2040 
∫
 = 
	`rouã_t›
 (
°abÀ
);Ñn;Ñ¿
	`rouã_√xt
 (rn))

2041 
si
 = 
∫
->
öfo
; si; sòsi->
√xt
)

2043 
	`vty_out
 (
vty
, "ipv6Ñoute %s/%d",

2044 
	`öë_¡›
 (
AF_INET6
, &
∫
->
p
.
u
.
¥efix6
, 
buf
, 
BUFSIZ
),

2045 
∫
->
p
.
¥efixÀn
);

2047 
si
->
ty≥
)

2049 
STATIC_IPV6_GATEWAY
:

2050 
	`vty_out
 (
vty
, " %s", 
	`öë_¡›
 (
AF_INET6
, &
si
->
ùv6
, 
buf
, 
BUFSIZ
));

2052 
STATIC_IPV6_IFNAME
:

2053 
	`vty_out
 (
vty
, " %s", 
si
->
i‚ame
);

2055 
STATIC_IPV6_GATEWAY_IFNAME
:

2056 
	`vty_out
 (
vty
, " %s %s",

2057 
	`öë_¡›
 (
AF_INET6
, &
si
->
ùv6
, 
buf
, 
BUFSIZ
), si->
i‚ame
);

2061 i‡(
	`CHECK_FLAG
(
si
->
Êags
, 
ZEBRA_FLAG_REJECT
))

2062 
	`vty_out
 (
vty
, " %s", "reject");

2064 i‡(
	`CHECK_FLAG
(
si
->
Êags
, 
ZEBRA_FLAG_BLACKHOLE
))

2065 
	`vty_out
 (
vty
, " %s", "blackhole");

2067 i‡(
si
->
di°™˚
 !
ZEBRA_STATIC_DISTANCE_DEFAULT
)

2068 
	`vty_out
 (
vty
, " %d", 
si
->
di°™˚
);

2069 
	`vty_out
 (
vty
, "%s", 
VTY_NEWLINE
);

2071 
wrôe
 = 1;

2073  
wrôe
;

2074 
	}
}

2079 
	$zebø_ù_c⁄fig
 (
vty
 *vty)

2081 
wrôe
 = 0;

2083 
wrôe
 +
	`°©ic_c⁄fig_ùv4
 (
vty
);

2084 #ifde‡
HAVE_IPV6


2085 
wrôe
 +
	`°©ic_c⁄fig_ùv6
 (
vty
);

2088  
wrôe
;

2089 
	}
}

2092 
	$c⁄fig_wrôe_¥Ÿocﬁ
(
vty
 *vty)

2094 
i
;

2096 
i
=0;i<
ZEBRA_ROUTE_MAX
;i++)

2098 i‡(
¥Ÿo_rm
[
AFI_IP
][
i
])

2099 
	`vty_out
 (
vty
, "ùÖrŸocﬁ %†rouã-m≠ %s%s", 
	`zebø_rouã_°rög
(
i
),

2100 
¥Ÿo_rm
[
AFI_IP
][
i
], 
VTY_NEWLINE
);

2102 i‡(
¥Ÿo_rm
[
AFI_IP
][
ZEBRA_ROUTE_MAX
])

2103 
	`vty_out
 (
vty
, "ipÖrotocol %sÑoute-map %s%s", "any",

2104 
¥Ÿo_rm
[
AFI_IP
][
ZEBRA_ROUTE_MAX
], 
VTY_NEWLINE
);

2107 
	}
}

2110 
cmd_node
 
	g¥Ÿocﬁ_node
 = { 
PROTOCOL_NODE
, "", 1 };

2113 
cmd_node
 
	gù_node
 = { 
IP_NODE
, "", 1 };

2117 
	$zebø_vty_öô
 ()

2119 
	`ö°Æl_node
 (&
ù_node
, 
zebø_ù_c⁄fig
);

2120 
	`ö°Æl_node
 (&
¥Ÿocﬁ_node
, 
c⁄fig_wrôe_¥Ÿocﬁ
);

2122 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_¥Ÿocﬁ_cmd
);

2123 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_¥Ÿocﬁ_cmd
);

2124 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_¥Ÿocﬁ_cmd
);

2125 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_¥Ÿocﬁ_cmd
);

2126 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_cmd
);

2127 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_Êags_cmd
);

2128 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_Êags2_cmd
);

2129 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_mask_cmd
);

2130 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_mask_Êags_cmd
);

2131 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_mask_Êags2_cmd
);

2132 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_cmd
);

2133 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_Êags_cmd
);

2134 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_Êags2_cmd
);

2135 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_mask_cmd
);

2136 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_mask_Êags_cmd
);

2137 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_mask_Êags2_cmd
);

2138 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_di°™˚_cmd
);

2139 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_Êags_di°™˚_cmd
);

2140 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_Êags_di°™˚2_cmd
);

2141 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_mask_di°™˚_cmd
);

2142 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_mask_Êags_di°™˚_cmd
);

2143 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_rouã_mask_Êags_di°™˚2_cmd
);

2144 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_di°™˚_cmd
);

2145 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_Êags_di°™˚_cmd
);

2146 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_Êags_di°™˚2_cmd
);

2147 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_mask_Êags_di°™˚_cmd
);

2148 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_rouã_mask_Êags_di°™˚2_cmd
);

2150 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_rouã_cmd
);

2151 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_rouã_addr_cmd
);

2152 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_rouã_¥efix_cmd
);

2153 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_rouã_¥efix_l⁄gî_cmd
);

2154 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_rouã_¥Ÿocﬁ_cmd
);

2155 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_rouã_su≥∫ës_cmd
);

2156 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_rouã_summ¨y_cmd
);

2157 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_rouã_cmd
);

2158 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_rouã_addr_cmd
);

2159 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_rouã_¥efix_cmd
);

2160 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_rouã_¥efix_l⁄gî_cmd
);

2161 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_rouã_¥Ÿocﬁ_cmd
);

2162 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_rouã_su≥∫ës_cmd
);

2163 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_rouã_summ¨y_cmd
);

2165 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_mrouã_cmd
);

2166 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_mrouã_cmd
);

2169 #ifde‡
HAVE_IPV6


2170 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_cmd
);

2171 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_Êags_cmd
);

2172 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_i‚ame_cmd
);

2173 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_i‚ame_Êags_cmd
);

2174 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_cmd
);

2175 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_Êags_cmd
);

2176 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_i‚ame_cmd
);

2177 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_i‚ame_Êags_cmd
);

2178 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_¥ef_cmd
);

2179 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_Êags_¥ef_cmd
);

2180 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_i‚ame_¥ef_cmd
);

2181 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_rouã_i‚ame_Êags_¥ef_cmd
);

2182 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_¥ef_cmd
);

2183 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_Êags_¥ef_cmd
);

2184 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_i‚ame_¥ef_cmd
);

2185 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_rouã_i‚ame_Êags_¥ef_cmd
);

2186 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_rouã_cmd
);

2187 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_rouã_summ¨y_cmd
);

2188 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_rouã_¥Ÿocﬁ_cmd
);

2189 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_rouã_addr_cmd
);

2190 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_rouã_¥efix_cmd
);

2191 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_rouã_¥efix_l⁄gî_cmd
);

2192 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_rouã_cmd
);

2193 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_rouã_¥Ÿocﬁ_cmd
);

2194 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_rouã_addr_cmd
);

2195 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_rouã_¥efix_cmd
);

2196 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_rouã_¥efix_l⁄gî_cmd
);

2197 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_rouã_summ¨y_cmd
);

2199 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_mrouã_cmd
);

2200 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_mrouã_cmd
);

2202 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zserv.c

22 
	~<zebø.h
>

24 
	~"¥efix.h
"

25 
	~"comm™d.h
"

26 
	~"if.h
"

27 
	~"thªad.h
"

28 
	~"°ªam.h
"

29 
	~"mem‹y.h
"

30 
	~"èbÀ.h
"

31 
	~"rib.h
"

32 
	~"√tw‹k.h
"

33 
	~"sockuni⁄.h
"

34 
	~"log.h
"

35 
	~"z˛õ¡.h
"

36 
	~"¥ivs.h
"

37 
	~"√tw‹k.h
"

38 
	~"buf„r.h
"

40 
	~"zebø/z£rv.h
"

41 
	~"zebø/rouãr-id.h
"

42 
	~"zebø/ªdi°ribuã.h
"

43 
	~"zebø/debug.h
"

44 
	~"zebø/ùf‹w¨d.h
"

47 
	eevít
 { 
	mZEBRA_SERV
, 
	mZEBRA_READ
, 
	mZEBRA_WRITE
 };

49 
zebø_t
 
zebød
;

51 
zebø_evít
 (
evít
Évít, 
sock
, 
z£rv
 *
˛õ¡
);

53 
zebø_¥ivs_t
 
z£rv_¥ivs
;

55 
zebø_˛õ¡_˛o£
 (
z£rv
 *
˛õ¡
);

58 
	$z£rv_dñayed_˛o£
(
thªad
 *thread)

60 
z£rv
 *
˛õ¡
 = 
	`THREAD_ARG
(
thªad
);

62 
˛õ¡
->
t_suicide
 = 
NULL
;

63 
	`zebø_˛õ¡_˛o£
(
˛õ¡
);

65 
	}
}

74 
	grouã_ty≥_ﬂths
[
ZEBRA_ROUTE_MAX
];

77 
	$z£rv_Êush_d©a
(
thªad
 *thread)

79 
z£rv
 *
˛õ¡
 = 
	`THREAD_ARG
(
thªad
);

81 
˛õ¡
->
t_wrôe
 = 
NULL
;

82 i‡(
˛õ¡
->
t_suicide
)

84 
	`zebø_˛õ¡_˛o£
(
˛õ¡
);

87 
	`buf„r_Êush_avaûabÀ
(
˛õ¡
->
wb
, clõ¡->
sock
))

89 
BUFFER_ERROR
:

90 
	`zlog_w¨n
("%s: buffer_flush_available failed on zserv client fd %d, "

91 "˛osög", 
__func__
, 
˛õ¡
->
sock
);

92 
	`zebø_˛õ¡_˛o£
(
˛õ¡
);

94 
BUFFER_PENDING
:

95 
˛õ¡
->
t_wrôe
 = 
	`thªad_add_wrôe
(
zebød
.
ma°î
, 
z£rv_Êush_d©a
,

96 
˛õ¡
, clõ¡->
sock
);

98 
BUFFER_EMPTY
:

102 
	}
}

105 
	$zebø_£rvî_£nd_mesßge
(
z£rv
 *
˛õ¡
)

107 i‡(
˛õ¡
->
t_suicide
)

109 
	`buf„r_wrôe
(
˛õ¡
->
wb
, clõ¡->
sock
, 
	`STREAM_DATA
(˛õ¡->
obuf
),

110 
	`°ªam_gë_ídp
(
˛õ¡
->
obuf
)))

112 
BUFFER_ERROR
:

113 
	`zlog_w¨n
("%s: buffer_write failedÅo zserv client fd %d, closing",

114 
__func__
, 
˛õ¡
->
sock
);

119 
˛õ¡
->
t_suicide
 = 
	`thªad_add_evít
(
zebød
.
ma°î
, 
z£rv_dñayed_˛o£
,

120 
˛õ¡
, 0);

122 
BUFFER_EMPTY
:

123 
	`THREAD_OFF
(
˛õ¡
->
t_wrôe
);

125 
BUFFER_PENDING
:

126 
	`THREAD_WRITE_ON
(
zebød
.
ma°î
, 
˛õ¡
->
t_wrôe
,

127 
z£rv_Êush_d©a
, 
˛õ¡
, clõ¡->
sock
);

131 
	}
}

134 
	$z£rv_¸óã_hódî
 (
°ªam
 *
s
, 
uöt16_t
 
cmd
)

137 
	`°ªam_putw
 (
s
, 
ZEBRA_HEADER_SIZE
);

138 
	`°ªam_putc
 (
s
, 
ZEBRA_HEADER_MARKER
);

139 
	`°ªam_putc
 (
s
, 
ZSERV_VERSION
);

140 
	`°ªam_putw
 (
s
, 
cmd
);

141 
	}
}

144 
	$z£rv_ícode_öãrÁ˚
 (
°ªam
 *
s
, 
öãrÁ˚
 *
iÂ
)

147 
	`°ªam_put
 (
s
, 
iÂ
->
«me
, 
INTERFACE_NAMSIZ
);

148 
	`°ªam_pué
 (
s
, 
iÂ
->
ifödex
);

149 
	`°ªam_putc
 (
s
, 
iÂ
->
°©us
);

150 
	`°ªam_putq
 (
s
, 
iÂ
->
Êags
);

151 
	`°ªam_pué
 (
s
, 
iÂ
->
mëric
);

152 
	`°ªam_pué
 (
s
, 
iÂ
->
mtu
);

153 
	`°ªam_pué
 (
s
, 
iÂ
->
mtu6
);

154 
	`°ªam_pué
 (
s
, 
iÂ
->
b™dwidth
);

155 #ifde‡
HAVE_STRUCT_SOCKADDR_DL


156 
	`°ªam_put
 (
s
, &
iÂ
->
sdl
,  (iÂ->
sdl_°‹age
));

158 
	`°ªam_pué
 (
s
, 
iÂ
->
hw_addr_Àn
);

159 i‡(
iÂ
->
hw_addr_Àn
)

160 
	`°ªam_put
 (
s
, 
iÂ
->
hw_addr
, iÂ->
hw_addr_Àn
);

164 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

165 
	}
}

179 
	$z£nd_öãrÁ˚_add
 (
z£rv
 *
˛õ¡
, 
öãrÁ˚
 *
iÂ
)

181 
°ªam
 *
s
;

184 i‡(! 
˛õ¡
->
iföfo
)

187 
s
 = 
˛õ¡
->
obuf
;

188 
	`°ªam_ª£t
 (
s
);

190 
	`z£rv_¸óã_hódî
 (
s
, 
ZEBRA_INTERFACE_ADD
);

191 
	`z£rv_ícode_öãrÁ˚
 (
s
, 
iÂ
);

193  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

194 
	}
}

198 
	$z£nd_öãrÁ˚_dñëe
 (
z£rv
 *
˛õ¡
, 
öãrÁ˚
 *
iÂ
)

200 
°ªam
 *
s
;

203 i‡(! 
˛õ¡
->
iföfo
)

206 
s
 = 
˛õ¡
->
obuf
;

207 
	`°ªam_ª£t
 (
s
);

209 
	`z£rv_¸óã_hódî
 (
s
, 
ZEBRA_INTERFACE_DELETE
);

210 
	`z£rv_ícode_öãrÁ˚
 (
s
, 
iÂ
);

212  
	`zebø_£rvî_£nd_mesßge
 (
˛õ¡
);

213 
	}
}

254 
	$z£nd_öãrÁ˚_addªss
 (
cmd
, 
z£rv
 *
˛õ¡
,

255 
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *
ifc
)

257 
bÀn
;

258 
°ªam
 *
s
;

259 
¥efix
 *
p
;

262 i‡(! 
˛õ¡
->
iföfo
)

265 
s
 = 
˛õ¡
->
obuf
;

266 
	`°ªam_ª£t
 (
s
);

268 
	`z£rv_¸óã_hódî
 (
s
, 
cmd
);

269 
	`°ªam_pué
 (
s
, 
iÂ
->
ifödex
);

272 
	`°ªam_putc
 (
s
, 
ifc
->
Êags
);

275 
p
 = 
ifc
->
addªss
;

276 
	`°ªam_putc
 (
s
, 
p
->
Ámûy
);

277 
bÀn
 = 
	`¥efix_bÀn
 (
p
);

278 
	`°ªam_put
 (
s
, &
p
->
u
.
¥efix
, 
bÀn
);

285 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
);

288 
p
 = 
ifc
->
de°ö©i⁄
;

289 i‡(
p
)

290 
	`°ªam_put
 (
s
, &
p
->
u
.
¥efix
, 
bÀn
);

292 
	`°ªam_put
 (
s
, 
NULL
, 
bÀn
);

295 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

297  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

298 
	}
}

311 
	$z£nd_öãrÁ˚_upd©e
 (
cmd
, 
z£rv
 *
˛õ¡
, 
öãrÁ˚
 *
iÂ
)

313 
°ªam
 *
s
;

316 i‡(! 
˛õ¡
->
iföfo
)

319 
s
 = 
˛õ¡
->
obuf
;

320 
	`°ªam_ª£t
 (
s
);

322 
	`z£rv_¸óã_hódî
 (
s
, 
cmd
);

323 
	`z£rv_ícode_öãrÁ˚
 (
s
, 
iÂ
);

325  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

326 
	}
}

352 
	$z£nd_rouã_mu…ù©h
 (
cmd
, 
z£rv
 *
˛õ¡
, 
¥efix
 *
p
,

353 
rib
 *rib)

355 
psize
;

356 
°ªam
 *
s
;

357 
√xth›
 *nexthop;

358 
nhnumm¨k
 = 0, 
messm¨k
 = 0;

359 
nhnum
 = 0;

360 
u_ch¨
 
z≠i_Êags
 = 0;

362 
s
 = 
˛õ¡
->
obuf
;

363 
	`°ªam_ª£t
 (
s
);

365 
	`z£rv_¸óã_hódî
 (
s
, 
cmd
);

368 
	`°ªam_putc
 (
s
, 
rib
->
ty≥
);

369 
	`°ªam_putc
 (
s
, 
rib
->
Êags
);

372 
messm¨k
 = 
	`°ªam_gë_ídp
 (
s
);

373 
	`°ªam_putc
 (
s
, 0);

376 
psize
 = 
	`PSIZE
 (
p
->
¥efixÀn
);

377 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
);

378 
	`°ªam_wrôe
 (
s
, (
u_ch¨
 *Ë& 
p
->
u
.
¥efix
, 
psize
);

390 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

392 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

394 
	`SET_FLAG
 (
z≠i_Êags
, 
ZAPI_MESSAGE_NEXTHOP
);

395 
	`SET_FLAG
 (
z≠i_Êags
, 
ZAPI_MESSAGE_IFINDEX
);

397 i‡(
nhnumm¨k
 == 0)

399 
nhnumm¨k
 = 
	`°ªam_gë_ídp
 (
s
);

400 
	`°ªam_putc
 (
s
, 1);

403 
nhnum
++;

405 
√xth›
->
ty≥
)

407 
NEXTHOP_TYPE_IPV4
:

408 
NEXTHOP_TYPE_IPV4_IFINDEX
:

409 
	`°ªam_put_ö_addr
 (
s
, &
√xth›
->
g©e
.
ùv4
);

411 #ifde‡
HAVE_IPV6


412 
NEXTHOP_TYPE_IPV6
:

413 
NEXTHOP_TYPE_IPV6_IFINDEX
:

414 
NEXTHOP_TYPE_IPV6_IFNAME
:

415 
	`°ªam_wrôe
 (
s
, (
u_ch¨
 *Ë&
√xth›
->
g©e
.
ùv6
, 16);

419 i‡(
cmd
 =
ZEBRA_IPV4_ROUTE_ADD


420 || 
cmd
 =
ZEBRA_IPV4_ROUTE_DELETE
)

422 
ö_addr
 
em±y
;

423 
	`mem£t
 (&
em±y
, 0,  (
ö_addr
));

424 
	`°ªam_wrôe
 (
s
, (
u_ch¨
 *Ë&
em±y
, 
IPV4_MAX_BYTELEN
);

428 
ö6_addr
 
em±y
;

429 
	`mem£t
 (&
em±y
, 0,  (
ö6_addr
));

430 
	`°ªam_wrôe
 (
s
, (
u_ch¨
 *Ë&
em±y
, 
IPV6_MAX_BYTELEN
);

435 
	`°ªam_putc
 (
s
, 1);

436 
	`°ªam_pué
 (
s
, 
√xth›
->
ifödex
);

443 i‡(
cmd
 =
ZEBRA_IPV4_ROUTE_ADD
 || cmd =
ZEBRA_IPV6_ROUTE_ADD
)

445 
	`SET_FLAG
 (
z≠i_Êags
, 
ZAPI_MESSAGE_DISTANCE
);

446 
	`°ªam_putc
 (
s
, 
rib
->
di°™˚
);

447 
	`SET_FLAG
 (
z≠i_Êags
, 
ZAPI_MESSAGE_METRIC
);

448 
	`°ªam_pué
 (
s
, 
rib
->
mëric
);

452 
	`°ªam_putc_©
 (
s
, 
messm¨k
, 
z≠i_Êags
);

455 i‡(
nhnumm¨k
)

456 
	`°ªam_putc_©
 (
s
, 
nhnumm¨k
, 
nhnum
);

459 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

461  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

462 
	}
}

464 #ifde‡
HAVE_IPV6


466 
	$z£nd_ùv6_√xth›_lookup
 (
z£rv
 *
˛õ¡
, 
ö6_addr
 *
addr
)

468 
°ªam
 *
s
;

469 
rib
 *rib;

470 
nump
;

471 
u_ch¨
 
num
;

472 
√xth›
 *nexthop;

475 
rib
 = 
	`rib_m©ch_ùv6
 (
addr
);

478 
s
 = 
˛õ¡
->
obuf
;

479 
	`°ªam_ª£t
 (
s
);

482 
	`z£rv_¸óã_hódî
 (
s
, 
ZEBRA_IPV6_NEXTHOP_LOOKUP
);

483 
	`°ªam_put
 (
s
, &
addr
, 16);

485 i‡(
rib
)

487 
	`°ªam_pué
 (
s
, 
rib
->
mëric
);

488 
num
 = 0;

489 
nump
 = 
	`°ªam_gë_ídp
(
s
);

490 
	`°ªam_putc
 (
s
, 0);

491 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

492 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

494 
	`°ªam_putc
 (
s
, 
√xth›
->
ty≥
);

495 
√xth›
->
ty≥
)

497 
ZEBRA_NEXTHOP_IPV6
:

498 
	`°ªam_put
 (
s
, &
√xth›
->
g©e
.
ùv6
, 16);

500 
ZEBRA_NEXTHOP_IPV6_IFINDEX
:

501 
ZEBRA_NEXTHOP_IPV6_IFNAME
:

502 
	`°ªam_put
 (
s
, &
√xth›
->
g©e
.
ùv6
, 16);

503 
	`°ªam_pué
 (
s
, 
√xth›
->
ifödex
);

505 
ZEBRA_NEXTHOP_IFINDEX
:

506 
ZEBRA_NEXTHOP_IFNAME
:

507 
	`°ªam_pué
 (
s
, 
√xth›
->
ifödex
);

513 
num
++;

515 
	`°ªam_putc_©
 (
s
, 
nump
, 
num
);

519 
	`°ªam_pué
 (
s
, 0);

520 
	`°ªam_putc
 (
s
, 0);

523 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

525  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

526 
	}
}

530 
	$z£nd_ùv4_√xth›_lookup
 (
z£rv
 *
˛õ¡
, 
ö_addr
 
addr
)

532 
°ªam
 *
s
;

533 
rib
 *rib;

534 
nump
;

535 
u_ch¨
 
num
;

536 
√xth›
 *nexthop;

539 
rib
 = 
	`rib_m©ch_ùv4
 (
addr
);

542 
s
 = 
˛õ¡
->
obuf
;

543 
	`°ªam_ª£t
 (
s
);

546 
	`z£rv_¸óã_hódî
 (
s
, 
ZEBRA_IPV4_NEXTHOP_LOOKUP
);

547 
	`°ªam_put_ö_addr
 (
s
, &
addr
);

549 i‡(
rib
)

551 
	`°ªam_pué
 (
s
, 
rib
->
mëric
);

552 
num
 = 0;

553 
nump
 = 
	`°ªam_gë_ídp
(
s
);

554 
	`°ªam_putc
 (
s
, 0);

555 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

556 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

558 
	`°ªam_putc
 (
s
, 
√xth›
->
ty≥
);

559 
√xth›
->
ty≥
)

561 
ZEBRA_NEXTHOP_IPV4
:

562 
	`°ªam_put_ö_addr
 (
s
, &
√xth›
->
g©e
.
ùv4
);

564 
ZEBRA_NEXTHOP_IFINDEX
:

565 
ZEBRA_NEXTHOP_IFNAME
:

566 
	`°ªam_pué
 (
s
, 
√xth›
->
ifödex
);

572 
num
++;

574 
	`°ªam_putc_©
 (
s
, 
nump
, 
num
);

578 
	`°ªam_pué
 (
s
, 0);

579 
	`°ªam_putc
 (
s
, 0);

582 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

584  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

585 
	}
}

588 
	$z£nd_ùv4_imp‹t_lookup
 (
z£rv
 *
˛õ¡
, 
¥efix_ùv4
 *
p
)

590 
°ªam
 *
s
;

591 
rib
 *rib;

592 
nump
;

593 
u_ch¨
 
num
;

594 
√xth›
 *nexthop;

597 
rib
 = 
	`rib_lookup_ùv4
 (
p
);

600 
s
 = 
˛õ¡
->
obuf
;

601 
	`°ªam_ª£t
 (
s
);

604 
	`z£rv_¸óã_hódî
 (
s
, 
ZEBRA_IPV4_IMPORT_LOOKUP
);

605 
	`°ªam_put_ö_addr
 (
s
, &
p
->
¥efix
);

607 i‡(
rib
)

609 
	`°ªam_pué
 (
s
, 
rib
->
mëric
);

610 
num
 = 0;

611 
nump
 = 
	`°ªam_gë_ídp
(
s
);

612 
	`°ªam_putc
 (
s
, 0);

613 
√xth›
 = 
rib
->√xth›;Çexth›;Çexth› =Çexth›->
√xt
)

614 i‡(
	`CHECK_FLAG
 (
√xth›
->
Êags
, 
NEXTHOP_FLAG_FIB
))

616 
	`°ªam_putc
 (
s
, 
√xth›
->
ty≥
);

617 
√xth›
->
ty≥
)

619 
ZEBRA_NEXTHOP_IPV4
:

620 
	`°ªam_put_ö_addr
 (
s
, &
√xth›
->
g©e
.
ùv4
);

622 
ZEBRA_NEXTHOP_IFINDEX
:

623 
ZEBRA_NEXTHOP_IFNAME
:

624 
	`°ªam_pué
 (
s
, 
√xth›
->
ifödex
);

630 
num
++;

632 
	`°ªam_putc_©
 (
s
, 
nump
, 
num
);

636 
	`°ªam_pué
 (
s
, 0);

637 
	`°ªam_putc
 (
s
, 0);

640 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

642  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

643 
	}
}

647 
	$z£nd_rouãr_id_upd©e
 (
z£rv
 *
˛õ¡
, 
¥efix
 *
p
)

649 
°ªam
 *
s
;

650 
bÀn
;

653 i‡(!
˛õ¡
->
ridöfo
)

656 
s
 = 
˛õ¡
->
obuf
;

657 
	`°ªam_ª£t
 (
s
);

660 
	`z£rv_¸óã_hódî
 (
s
, 
ZEBRA_ROUTER_ID_UPDATE
);

663 
	`°ªam_putc
 (
s
, 
p
->
Ámûy
);

664 
bÀn
 = 
	`¥efix_bÀn
 (
p
);

665 
	`°ªam_put
 (
s
, &
p
->
u
.
¥efix
, 
bÀn
);

666 
	`°ªam_putc
 (
s
, 
p
->
¥efixÀn
);

669 
	`°ªam_putw_©
 (
s
, 0, 
	`°ªam_gë_ídp
 (s));

671  
	`zebø_£rvî_£nd_mesßge
(
˛õ¡
);

672 
	}
}

677 
	$zªad_öãrÁ˚_add
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

679 
li°node
 *
i‚ode
, *
i‚node
;

680 
li°node
 *
˙ode
, *
˙node
;

681 
öãrÁ˚
 *
iÂ
;

682 
c⁄√˘ed
 *
c
;

685 
˛õ¡
->
iföfo
 = 1;

687 
	`ALL_LIST_ELEMENTS
 (
iÊi°
, 
i‚ode
, 
i‚node
, 
iÂ
))

690 i‡(! 
	`CHECK_FLAG
 (
iÂ
->
°©us
, 
ZEBRA_INTERFACE_ACTIVE
))

693 i‡(
	`z£nd_öãrÁ˚_add
 (
˛õ¡
, 
iÂ
) < 0)

696 
	`ALL_LIST_ELEMENTS
 (
iÂ
->
c⁄√˘ed
, 
˙ode
, 
˙node
, 
c
))

698 i‡(
	`CHECK_FLAG
 (
c
->
c⁄f
, 
ZEBRA_IFC_REAL
) &&

699 (
	`z£nd_öãrÁ˚_addªss
 (
ZEBRA_INTERFACE_ADDRESS_ADD
, 
˛õ¡
,

700 
iÂ
, 
c
) < 0))

705 
	}
}

709 
	$zªad_öãrÁ˚_dñëe
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

711 
˛õ¡
->
iföfo
 = 0;

713 
	}
}

721 
	$zªad_ùv4_add
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

723 
i
;

724 
rib
 *rib;

725 
¥efix_ùv4
 
p
;

726 
u_ch¨
 
mesßge
;

727 
ö_addr
 
√xth›
;

728 
u_ch¨
 
√xth›_num
;

729 
u_ch¨
 
√xth›_ty≥
;

730 
°ªam
 *
s
;

731 
ifödex
;

732 
u_ch¨
 
i‚ame_Àn
;

733 
ßfi_t
 
ßfi
;

737 
s
 = 
˛õ¡
->
ibuf
;

740 
rib
 = 
	`XCALLOC
 (
MTYPE_RIB
,  (rib));

743 
rib
->
ty≥
 = 
	`°ªam_gëc
 (
s
);

744 
rib
->
Êags
 = 
	`°ªam_gëc
 (
s
);

745 
mesßge
 = 
	`°ªam_gëc
 (
s
);

746 
ßfi
 = 
	`°ªam_gëw
 (
s
);

747 
rib
->
u±ime
 = 
	`time
 (
NULL
);

750 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

751 
p
.
Ámûy
 = 
AF_INET
;

752 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

753 
	`°ªam_gë
 (&
p
.
¥efix
, 
s
, 
	`PSIZE
 (p.
¥efixÀn
));

756 i‡(
	`CHECK_FLAG
 (
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

758 
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

760 
i
 = 0; i < 
√xth›_num
; i++)

762 
√xth›_ty≥
 = 
	`°ªam_gëc
 (
s
);

764 
√xth›_ty≥
)

766 
ZEBRA_NEXTHOP_IFINDEX
:

767 
ifödex
 = 
	`°ªam_gël
 (
s
);

768 
	`√xth›_ifödex_add
 (
rib
, 
ifödex
);

770 
ZEBRA_NEXTHOP_IFNAME
:

771 
i‚ame_Àn
 = 
	`°ªam_gëc
 (
s
);

772 
	`°ªam_f‹w¨d_gëp
 (
s
, 
i‚ame_Àn
);

774 
ZEBRA_NEXTHOP_IPV4
:

775 
√xth›
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

776 
	`√xth›_ùv4_add
 (
rib
, &
√xth›
, 
NULL
);

778 
ZEBRA_NEXTHOP_IPV4_IFINDEX
:

779 
√xth›
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

780 
ifödex
 = 
	`°ªam_gël
 (
s
);

781 
	`√xth›_ùv4_ifödex_add
 (
rib
, &
√xth›
, 
NULL
, 
ifödex
);

783 
ZEBRA_NEXTHOP_IPV6
:

784 
	`°ªam_f‹w¨d_gëp
 (
s
, 
IPV6_MAX_BYTELEN
);

786 
ZEBRA_NEXTHOP_BLACKHOLE
:

787 
	`√xth›_bœckhﬁe_add
 (
rib
);

794 i‡(
	`CHECK_FLAG
 (
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

795 
rib
->
di°™˚
 = 
	`°ªam_gëc
 (
s
);

798 i‡(
	`CHECK_FLAG
 (
mesßge
, 
ZAPI_MESSAGE_METRIC
))

799 
rib
->
mëric
 = 
	`°ªam_gël
 (
s
);

802 
rib
->
èbÀ
=
zebød
.
πm_èbÀ_deÁu…
;

803 
	`rib_add_ùv4_mu…ù©h
 (&
p
, 
rib
, 
ßfi
);

805 
	}
}

809 
	$zªad_ùv4_dñëe
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

811 
i
;

812 
°ªam
 *
s
;

813 
z≠i_ùv4
 
≠i
;

814 
ö_addr
 
√xth›
, *
√xth›_p
;

815 
ifödex
;

816 
¥efix_ùv4
 
p
;

817 
u_ch¨
 
√xth›_num
;

818 
u_ch¨
 
√xth›_ty≥
;

819 
u_ch¨
 
i‚ame_Àn
;

821 
s
 = 
˛õ¡
->
ibuf
;

822 
ifödex
 = 0;

823 
√xth›
.
s_addr
 = 0;

824 
√xth›_p
 = 
NULL
;

827 
≠i
.
ty≥
 = 
	`°ªam_gëc
 (
s
);

828 
≠i
.
Êags
 = 
	`°ªam_gëc
 (
s
);

829 
≠i
.
mesßge
 = 
	`°ªam_gëc
 (
s
);

830 
≠i
.
ßfi
 = 
	`°ªam_gëw
 (
s
);

833 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv4
));

834 
p
.
Ámûy
 = 
AF_INET
;

835 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

836 
	`°ªam_gë
 (&
p
.
¥efix
, 
s
, 
	`PSIZE
 (p.
¥efixÀn
));

839 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

841 
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

843 
i
 = 0; i < 
√xth›_num
; i++)

845 
√xth›_ty≥
 = 
	`°ªam_gëc
 (
s
);

847 
√xth›_ty≥
)

849 
ZEBRA_NEXTHOP_IFINDEX
:

850 
ifödex
 = 
	`°ªam_gël
 (
s
);

852 
ZEBRA_NEXTHOP_IFNAME
:

853 
i‚ame_Àn
 = 
	`°ªam_gëc
 (
s
);

854 
	`°ªam_f‹w¨d_gëp
 (
s
, 
i‚ame_Àn
);

856 
ZEBRA_NEXTHOP_IPV4
:

857 
√xth›
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

858 
√xth›_p
 = &
√xth›
;

860 
ZEBRA_NEXTHOP_IPV4_IFINDEX
:

861 
√xth›
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
s
);

862 
ifödex
 = 
	`°ªam_gël
 (
s
);

864 
ZEBRA_NEXTHOP_IPV6
:

865 
	`°ªam_f‹w¨d_gëp
 (
s
, 
IPV6_MAX_BYTELEN
);

872 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

873 
≠i
.
di°™˚
 = 
	`°ªam_gëc
 (
s
);

875 
≠i
.
di°™˚
 = 0;

878 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
))

879 
≠i
.
mëric
 = 
	`°ªam_gël
 (
s
);

881 
≠i
.
mëric
 = 0;

883 
	`rib_dñëe_ùv4
 (
≠i
.
ty≥
,ápi.
Êags
, &
p
, 
√xth›_p
, 
ifödex
,

884 
˛õ¡
->
πm_èbÀ
, 
≠i
.
ßfi
);

886 
	}
}

890 
	$zªad_ùv4_√xth›_lookup
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

892 
ö_addr
 
addr
;

894 
addr
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
˛õ¡
->
ibuf
);

895  
	`z£nd_ùv4_√xth›_lookup
 (
˛õ¡
, 
addr
);

896 
	}
}

900 
	$zªad_ùv4_imp‹t_lookup
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

902 
¥efix_ùv4
 
p
;

904 
p
.
Ámûy
 = 
AF_INET
;

905 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
˛õ¡
->
ibuf
);

906 
p
.
¥efix
.
s_addr
 = 
	`°ªam_gë_ùv4
 (
˛õ¡
->
ibuf
);

908  
	`z£nd_ùv4_imp‹t_lookup
 (
˛õ¡
, &
p
);

909 
	}
}

911 #ifde‡
HAVE_IPV6


914 
	$zªad_ùv6_add
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

916 
i
;

917 
°ªam
 *
s
;

918 
z≠i_ùv6
 
≠i
;

919 
ö6_addr
 
√xth›
;

920 
ifödex
;

921 
¥efix_ùv6
 
p
;

923 
s
 = 
˛õ¡
->
ibuf
;

924 
ifödex
 = 0;

925 
	`mem£t
 (&
√xth›
, 0,  (
ö6_addr
));

928 
≠i
.
ty≥
 = 
	`°ªam_gëc
 (
s
);

929 
≠i
.
Êags
 = 
	`°ªam_gëc
 (
s
);

930 
≠i
.
mesßge
 = 
	`°ªam_gëc
 (
s
);

931 
≠i
.
ßfi
 = 
	`°ªam_gëw
 (
s
);

934 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv6
));

935 
p
.
Ámûy
 = 
AF_INET6
;

936 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

937 
	`°ªam_gë
 (&
p
.
¥efix
, 
s
, 
	`PSIZE
 (p.
¥efixÀn
));

940 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

942 
u_ch¨
 
√xth›_ty≥
;

944 
≠i
.
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

945 
i
 = 0; i < 
≠i
.
√xth›_num
; i++)

947 
√xth›_ty≥
 = 
	`°ªam_gëc
 (
s
);

949 
√xth›_ty≥
)

951 
ZEBRA_NEXTHOP_IPV6
:

952 
	`°ªam_gë
 (&
√xth›
, 
s
, 16);

954 
ZEBRA_NEXTHOP_IFINDEX
:

955 
ifödex
 = 
	`°ªam_gël
 (
s
);

961 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

962 
≠i
.
di°™˚
 = 
	`°ªam_gëc
 (
s
);

964 
≠i
.
di°™˚
 = 0;

966 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
))

967 
≠i
.
mëric
 = 
	`°ªam_gël
 (
s
);

969 
≠i
.
mëric
 = 0;

971 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
√xth›
))

972 
	`rib_add_ùv6
 (
≠i
.
ty≥
,ápi.
Êags
, &
p
, 
NULL
, 
ifödex
, 
zebød
.
πm_èbÀ_deÁu…
,ápi.
mëric
,

973 
≠i
.
di°™˚
,ápi.
ßfi
);

975 
	`rib_add_ùv6
 (
≠i
.
ty≥
,ápi.
Êags
, &
p
, &
√xth›
, 
ifödex
, 
zebød
.
πm_èbÀ_deÁu…
,ápi.
mëric
,

976 
≠i
.
di°™˚
,ápi.
ßfi
);

978 
	}
}

982 
	$zªad_ùv6_dñëe
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

984 
i
;

985 
°ªam
 *
s
;

986 
z≠i_ùv6
 
≠i
;

987 
ö6_addr
 
√xth›
;

988 
ifödex
;

989 
¥efix_ùv6
 
p
;

991 
s
 = 
˛õ¡
->
ibuf
;

992 
ifödex
 = 0;

993 
	`mem£t
 (&
√xth›
, 0,  (
ö6_addr
));

996 
≠i
.
ty≥
 = 
	`°ªam_gëc
 (
s
);

997 
≠i
.
Êags
 = 
	`°ªam_gëc
 (
s
);

998 
≠i
.
mesßge
 = 
	`°ªam_gëc
 (
s
);

999 
≠i
.
ßfi
 = 
	`°ªam_gëw
 (
s
);

1002 
	`mem£t
 (&
p
, 0,  (
¥efix_ùv6
));

1003 
p
.
Ámûy
 = 
AF_INET6
;

1004 
p
.
¥efixÀn
 = 
	`°ªam_gëc
 (
s
);

1005 
	`°ªam_gë
 (&
p
.
¥efix
, 
s
, 
	`PSIZE
 (p.
¥efixÀn
));

1008 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_NEXTHOP
))

1010 
u_ch¨
 
√xth›_ty≥
;

1012 
≠i
.
√xth›_num
 = 
	`°ªam_gëc
 (
s
);

1013 
i
 = 0; i < 
≠i
.
√xth›_num
; i++)

1015 
√xth›_ty≥
 = 
	`°ªam_gëc
 (
s
);

1017 
√xth›_ty≥
)

1019 
ZEBRA_NEXTHOP_IPV6
:

1020 
	`°ªam_gë
 (&
√xth›
, 
s
, 16);

1022 
ZEBRA_NEXTHOP_IFINDEX
:

1023 
ifödex
 = 
	`°ªam_gël
 (
s
);

1029 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_DISTANCE
))

1030 
≠i
.
di°™˚
 = 
	`°ªam_gëc
 (
s
);

1032 
≠i
.
di°™˚
 = 0;

1033 i‡(
	`CHECK_FLAG
 (
≠i
.
mesßge
, 
ZAPI_MESSAGE_METRIC
))

1034 
≠i
.
mëric
 = 
	`°ªam_gël
 (
s
);

1036 
≠i
.
mëric
 = 0;

1038 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
 (&
√xth›
))

1039 
	`rib_dñëe_ùv6
 (
≠i
.
ty≥
,ápi.
Êags
, &
p
, 
NULL
, 
ifödex
, 
˛õ¡
->
πm_èbÀ
,ápi.
ßfi
);

1041 
	`rib_dñëe_ùv6
 (
≠i
.
ty≥
,ápi.
Êags
, &
p
, &
√xth›
, 
ifödex
, 
˛õ¡
->
πm_èbÀ
,ápi.
ßfi
);

1043 
	}
}

1046 
	$zªad_ùv6_√xth›_lookup
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

1048 
ö6_addr
 
addr
;

1049 
buf
[
BUFSIZ
];

1051 
	`°ªam_gë
 (&
addr
, 
˛õ¡
->
ibuf
, 16);

1052 
	`¥ötf
 ("DEBUG %s\n", 
	`öë_¡›
 (
AF_INET6
, &
addr
, 
buf
, 
BUFSIZ
));

1054  
	`z£nd_ùv6_√xth›_lookup
 (
˛õ¡
, &
addr
);

1055 
	}
}

1060 
	$zªad_rouãr_id_add
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

1062 
¥efix
 
p
;

1065 
˛õ¡
->
ridöfo
 = 1;

1067 
	`rouãr_id_gë
 (&
p
);

1069  
	`z£nd_rouãr_id_upd©e
 (
˛õ¡
,&
p
);

1070 
	}
}

1074 
	$zªad_rouãr_id_dñëe
 (
z£rv
 *
˛õ¡
, 
u_sh‹t
 
Àngth
)

1076 
˛õ¡
->
ridöfo
 = 0;

1078 
	}
}

1082 
	$zªad_hñlo
 (
z£rv
 *
˛õ¡
)

1085 
u_ch¨
 
¥Ÿo
;

1086 
¥Ÿo
 = 
	`°ªam_gëc
 (
˛õ¡
->
ibuf
);

1089 i‡((
¥Ÿo
 < 
ZEBRA_ROUTE_MAX
)

1090 && (
¥Ÿo
 > 
ZEBRA_ROUTE_STATIC
))

1092 
	`zlog_nŸi˚
 ("client %d says helloánd bids fairÅoánnounce only %sÑoutes",

1093 
˛õ¡
->
sock
, 
	`zebø_rouã_°rög
(
¥Ÿo
));

1096 i‡(
rouã_ty≥_ﬂths
[
¥Ÿo
])

1097 
	`zlog_w¨n
 ("sender of %sÑoutes changed %c->%c",

1098 
	`zebø_rouã_°rög
(
¥Ÿo
), 
rouã_ty≥_ﬂths
[proto],

1099 
˛õ¡
->
sock
);

1101 
rouã_ty≥_ﬂths
[
¥Ÿo
] = 
˛õ¡
->
sock
;

1103 
	}
}

1109 
	$zebø_sc‹e_rib
 (
˛õ¡_sock
)

1111 
i
;

1113 
i
 = 
ZEBRA_ROUTE_RIP
; i < 
ZEBRA_ROUTE_MAX
; i++)

1114 i‡(
˛õ¡_sock
 =
rouã_ty≥_ﬂths
[
i
])

1116 
	`zlog_nŸi˚
 ("client %d disconnected. %lu %sÑoutesÑemoved fromÅheÑib",

1117 
˛õ¡_sock
, 
	`rib_sc‹e_¥Ÿo
 (
i
), 
	`zebø_rouã_°rög
 (i));

1118 
rouã_ty≥_ﬂths
[
i
] = 0;

1121 
	}
}

1125 
	$zebø_˛õ¡_˛o£
 (
z£rv
 *
˛õ¡
)

1128 i‡(
˛õ¡
->
sock
)

1130 
	`˛o£
 (
˛õ¡
->
sock
);

1131 
	`zebø_sc‹e_rib
 (
˛õ¡
->
sock
);

1132 
˛õ¡
->
sock
 = -1;

1136 i‡(
˛õ¡
->
ibuf
)

1137 
	`°ªam_‰ì
 (
˛õ¡
->
ibuf
);

1138 i‡(
˛õ¡
->
obuf
)

1139 
	`°ªam_‰ì
 (
˛õ¡
->
obuf
);

1140 i‡(
˛õ¡
->
wb
)

1141 
	`buf„r_‰ì
(
˛õ¡
->
wb
);

1144 i‡(
˛õ¡
->
t_ªad
)

1145 
	`thªad_ˇn˚l
 (
˛õ¡
->
t_ªad
);

1146 i‡(
˛õ¡
->
t_wrôe
)

1147 
	`thªad_ˇn˚l
 (
˛õ¡
->
t_wrôe
);

1148 i‡(
˛õ¡
->
t_suicide
)

1149 
	`thªad_ˇn˚l
 (
˛õ¡
->
t_suicide
);

1152 
	`li°node_dñëe
 (
zebød
.
˛õ¡_li°
, 
˛õ¡
);

1153 
	`XFREE
 (0, 
˛õ¡
);

1154 
	}
}

1158 
	$zebø_˛õ¡_¸óã
 (
sock
)

1160 
z£rv
 *
˛õ¡
;

1162 
˛õ¡
 = 
	`XCALLOC
 (0,  (
z£rv
));

1165 
˛õ¡
->
sock
 = sock;

1166 
˛õ¡
->
ibuf
 = 
	`°ªam_√w
 (
ZEBRA_MAX_PACKET_SIZ
);

1167 
˛õ¡
->
obuf
 = 
	`°ªam_√w
 (
ZEBRA_MAX_PACKET_SIZ
);

1168 
˛õ¡
->
wb
 = 
	`buf„r_√w
(0);

1171 
˛õ¡
->
πm_èbÀ
 = 
zebød
.
πm_èbÀ_deÁu…
;

1174 
	`li°node_add
 (
zebød
.
˛õ¡_li°
, 
˛õ¡
);

1177 
	`zebø_evít
 (
ZEBRA_READ
, 
sock
, 
˛õ¡
);

1178 
	}
}

1182 
	$zebø_˛õ¡_ªad
 (
thªad
 *thread)

1184 
sock
;

1185 
z£rv
 *
˛õ¡
;

1186 
size_t
 
Æªady
;

1187 
uöt16_t
 
Àngth
, 
comm™d
;

1188 
uöt8_t
 
m¨kî
, 
vîsi⁄
;

1191 
sock
 = 
	`THREAD_FD
 (
thªad
);

1192 
˛õ¡
 = 
	`THREAD_ARG
 (
thªad
);

1193 
˛õ¡
->
t_ªad
 = 
NULL
;

1195 i‡(
˛õ¡
->
t_suicide
)

1197 
	`zebø_˛õ¡_˛o£
(
˛õ¡
);

1202 i‡((
Æªady
 = 
	`°ªam_gë_ídp
(
˛õ¡
->
ibuf
)Ë< 
ZEBRA_HEADER_SIZE
)

1204 
ssize_t
 
nbyã
;

1205 i‡(((
nbyã
 = 
	`°ªam_ªad_åy
 (
˛õ¡
->
ibuf
, 
sock
,

1206 
ZEBRA_HEADER_SIZE
-
Æªady
)) == 0) ||

1207 (
nbyã
 == -1))

1209 i‡(
IS_ZEBRA_DEBUG_EVENT
)

1210 
	`zlog_debug
 ("c⁄√˘i⁄ clo£d sockë [%d]", 
sock
);

1211 
	`zebø_˛õ¡_˛o£
 (
˛õ¡
);

1214 i‡(
nbyã
 !(
ssize_t
)(
ZEBRA_HEADER_SIZE
-
Æªady
))

1217 
	`zebø_evít
 (
ZEBRA_READ
, 
sock
, 
˛õ¡
);

1220 
Æªady
 = 
ZEBRA_HEADER_SIZE
;

1224 
	`°ªam_£t_gëp
(
˛õ¡
->
ibuf
, 0);

1227 
Àngth
 = 
	`°ªam_gëw
 (
˛õ¡
->
ibuf
);

1228 
m¨kî
 = 
	`°ªam_gëc
 (
˛õ¡
->
ibuf
);

1229 
vîsi⁄
 = 
	`°ªam_gëc
 (
˛õ¡
->
ibuf
);

1230 
comm™d
 = 
	`°ªam_gëw
 (
˛õ¡
->
ibuf
);

1232 i‡(
m¨kî
 !
ZEBRA_HEADER_MARKER
 || 
vîsi⁄
 !
ZSERV_VERSION
)

1234 
	`zlog_îr
("%s: socket %d version mismatch, marker %d, version %d",

1235 
__func__
, 
sock
, 
m¨kî
, 
vîsi⁄
);

1236 
	`zebø_˛õ¡_˛o£
 (
˛õ¡
);

1239 i‡(
Àngth
 < 
ZEBRA_HEADER_SIZE
)

1241 
	`zlog_w¨n
("%s: socket %d messageÜength %u isÜessÅhan header size %d",

1242 
__func__
, 
sock
, 
Àngth
, 
ZEBRA_HEADER_SIZE
);

1243 
	`zebø_˛õ¡_˛o£
 (
˛õ¡
);

1246 i‡(
Àngth
 > 
	`STREAM_SIZE
(
˛õ¡
->
ibuf
))

1248 
	`zlog_w¨n
("%s: socket %d messageÜength %uÉxceeds buffer size %lu",

1249 
__func__
, 
sock
, 
Àngth
, (
u_l⁄g
)
	`STREAM_SIZE
(
˛õ¡
->
ibuf
));

1250 
	`zebø_˛õ¡_˛o£
 (
˛õ¡
);

1255 i‡(
Æªady
 < 
Àngth
)

1257 
ssize_t
 
nbyã
;

1258 i‡(((
nbyã
 = 
	`°ªam_ªad_åy
 (
˛õ¡
->
ibuf
, 
sock
,

1259 
Àngth
-
Æªady
)) == 0) ||

1260 (
nbyã
 == -1))

1262 i‡(
IS_ZEBRA_DEBUG_EVENT
)

1263 
	`zlog_debug
 ("c⁄√˘i⁄ clo£d [%d] whíÑódög zebø d©a", 
sock
);

1264 
	`zebø_˛õ¡_˛o£
 (
˛õ¡
);

1267 i‡(
nbyã
 !(
ssize_t
)(
Àngth
-
Æªady
))

1270 
	`zebø_evít
 (
ZEBRA_READ
, 
sock
, 
˛õ¡
);

1275 
Àngth
 -
ZEBRA_HEADER_SIZE
;

1278 i‡(
IS_ZEBRA_DEBUG_EVENT
)

1279 
	`zlog_debug
 ("zebø mesßgêcome†‰om sockë [%d]", 
sock
);

1281 i‡(
IS_ZEBRA_DEBUG_PACKET
 && 
IS_ZEBRA_DEBUG_RECV
)

1282 
	`zlog_debug
 ("zebra messageÑeceived [%s] %d",

1283 
	`z£rv_comm™d_°rög
 (
comm™d
), 
Àngth
);

1285 
comm™d
)

1287 
ZEBRA_ROUTER_ID_ADD
:

1288 
	`zªad_rouãr_id_add
 (
˛õ¡
, 
Àngth
);

1290 
ZEBRA_ROUTER_ID_DELETE
:

1291 
	`zªad_rouãr_id_dñëe
 (
˛õ¡
, 
Àngth
);

1293 
ZEBRA_INTERFACE_ADD
:

1294 
	`zªad_öãrÁ˚_add
 (
˛õ¡
, 
Àngth
);

1296 
ZEBRA_INTERFACE_DELETE
:

1297 
	`zªad_öãrÁ˚_dñëe
 (
˛õ¡
, 
Àngth
);

1299 
ZEBRA_IPV4_ROUTE_ADD
:

1300 
	`zªad_ùv4_add
 (
˛õ¡
, 
Àngth
);

1302 
ZEBRA_IPV4_ROUTE_DELETE
:

1303 
	`zªad_ùv4_dñëe
 (
˛õ¡
, 
Àngth
);

1305 #ifde‡
HAVE_IPV6


1306 
ZEBRA_IPV6_ROUTE_ADD
:

1307 
	`zªad_ùv6_add
 (
˛õ¡
, 
Àngth
);

1309 
ZEBRA_IPV6_ROUTE_DELETE
:

1310 
	`zªad_ùv6_dñëe
 (
˛õ¡
, 
Àngth
);

1313 
ZEBRA_REDISTRIBUTE_ADD
:

1314 
	`zebø_ªdi°ribuã_add
 (
comm™d
, 
˛õ¡
, 
Àngth
);

1316 
ZEBRA_REDISTRIBUTE_DELETE
:

1317 
	`zebø_ªdi°ribuã_dñëe
 (
comm™d
, 
˛õ¡
, 
Àngth
);

1319 
ZEBRA_REDISTRIBUTE_DEFAULT_ADD
:

1320 
	`zebø_ªdi°ribuã_deÁu…_add
 (
comm™d
, 
˛õ¡
, 
Àngth
);

1322 
ZEBRA_REDISTRIBUTE_DEFAULT_DELETE
:

1323 
	`zebø_ªdi°ribuã_deÁu…_dñëe
 (
comm™d
, 
˛õ¡
, 
Àngth
);

1325 
ZEBRA_IPV4_NEXTHOP_LOOKUP
:

1326 
	`zªad_ùv4_√xth›_lookup
 (
˛õ¡
, 
Àngth
);

1328 #ifde‡
HAVE_IPV6


1329 
ZEBRA_IPV6_NEXTHOP_LOOKUP
:

1330 
	`zªad_ùv6_√xth›_lookup
 (
˛õ¡
, 
Àngth
);

1333 
ZEBRA_IPV4_IMPORT_LOOKUP
:

1334 
	`zªad_ùv4_imp‹t_lookup
 (
˛õ¡
, 
Àngth
);

1336 
ZEBRA_HELLO
:

1337 
	`zªad_hñlo
 (
˛õ¡
);

1340 
	`zlog_öfo
 ("ZebøÑe˚ived unknow¿comm™d %d", 
comm™d
);

1344 i‡(
˛õ¡
->
t_suicide
)

1347 
	`zebø_˛õ¡_˛o£
(
˛õ¡
);

1351 
	`°ªam_ª£t
 (
˛õ¡
->
ibuf
);

1352 
	`zebø_evít
 (
ZEBRA_READ
, 
sock
, 
˛õ¡
);

1354 
	}
}

1359 
	$zebø_ac˚±
 (
thªad
 *thread)

1361 
ac˚±_sock
;

1362 
˛õ¡_sock
;

1363 
sockaddr_ö
 
˛õ¡
;

1364 
sockÀn_t
 
Àn
;

1366 
ac˚±_sock
 = 
	`THREAD_FD
 (
thªad
);

1369 
	`zebø_evít
 (
ZEBRA_SERV
, 
ac˚±_sock
, 
NULL
);

1371 
Àn
 =  (
sockaddr_ö
);

1372 
˛õ¡_sock
 = 
	`ac˚±
 (
ac˚±_sock
, (
sockaddr
 *Ë&
˛õ¡
, &
Àn
);

1374 i‡(
˛õ¡_sock
 < 0)

1376 
	`zlog_w¨n
 ("C™'àac˚± zebø sockë: %s", 
	`ß„_°ªº‹
 (
î∫o
));

1381 
	`£t_n⁄blockög
(
˛õ¡_sock
);

1384 
	`zebø_˛õ¡_¸óã
 (
˛õ¡_sock
);

1387 
	}
}

1389 #ifde‡
HAVE_TCP_ZEBRA


1392 
	$zebø_£rv
 ()

1394 
ªt
;

1395 
ac˚±_sock
;

1396 
sockaddr_ö
 
addr
;

1398 
ac˚±_sock
 = 
	`sockë
 (
AF_INET
, 
SOCK_STREAM
, 0);

1400 i‡(
ac˚±_sock
 < 0)

1402 
	`zlog_w¨n
 ("Can't create zserv stream socket: %s",

1403 
	`ß„_°ªº‹
 (
î∫o
));

1404 
	`zlog_w¨n
 ("zebra can'tÖrovice full functionality dueÅoáboveÉrror");

1408 
	`mem£t
 (&
rouã_ty≥_ﬂths
, 0,  (route_type_oaths));

1409 
	`mem£t
 (&
addr
, 0,  (
sockaddr_ö
));

1410 
addr
.
sö_Ámûy
 = 
AF_INET
;

1411 
addr
.
sö_p‹t
 = 
	`ht⁄s
 (
ZEBRA_PORT
);

1412 #ifde‡
HAVE_STRUCT_SOCKADDR_IN_SIN_LEN


1413 
addr
.
sö_Àn
 =  (
sockaddr_ö
);

1415 
addr
.
sö_addr
.
s_addr
 = 
	`ht⁄l
 (
INADDR_LOOPBACK
);

1417 
	`sock›t_ªu£addr
 (
ac˚±_sock
);

1418 
	`sock›t_ªu£p‹t
 (
ac˚±_sock
);

1420 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_RAISE
) )

1421 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÑaiseÖrivileges");

1423 
ªt
 = 
	`böd
 (
ac˚±_sock
, (
sockaddr
 *)&
addr
,

1424  (
sockaddr_ö
));

1425 i‡(
ªt
 < 0)

1427 
	`zlog_w¨n
 ("Can't bindÅo stream socket: %s",

1428 
	`ß„_°ªº‹
 (
î∫o
));

1429 
	`zlog_w¨n
 ("zebra can'tÖrovice full functionality dueÅoáboveÉrror");

1430 
	`˛o£
 (
ac˚±_sock
);

1434 i‡–
z£rv_¥ivs
.
	`ch™ge
(
ZPRIVS_LOWER
) )

1435 
	`zlog
 (
NULL
, 
LOG_ERR
, "Can'tÜowerÖrivileges");

1437 
ªt
 = 
	`li°í
 (
ac˚±_sock
, 1);

1438 i‡(
ªt
 < 0)

1440 
	`zlog_w¨n
 ("Can'tÜistenÅo stream socket: %s",

1441 
	`ß„_°ªº‹
 (
î∫o
));

1442 
	`zlog_w¨n
 ("zebra can'tÖrovice full functionality dueÅoáboveÉrror");

1443 
	`˛o£
 (
ac˚±_sock
);

1447 
	`zebø_evít
 (
ZEBRA_SERV
, 
ac˚±_sock
, 
NULL
);

1448 
	}
}

1452 
	~<sys/un.h
>

1456 
	$zebø_£rv_un
 (c⁄° *
∑th
)

1458 
ªt
;

1459 
sock
, 
Àn
;

1460 
sockaddr_un
 
£rv
;

1461 
mode_t
 
ﬁd_mask
;

1464 
	`u∆ök
 (
∑th
);

1467 
ﬁd_mask
 = 
	`umask
 (0077);

1470 
sock
 = 
	`sockë
 (
AF_UNIX
, 
SOCK_STREAM
, 0);

1471 i‡(
sock
 < 0)

1473 
	`zlog_w¨n
 ("Can't create zserv unix socket: %s",

1474 
	`ß„_°ªº‹
 (
î∫o
));

1475 
	`zlog_w¨n
 ("zebra can'tÖrovide full functionality dueÅoáboveÉrror");

1479 
	`mem£t
 (&
rouã_ty≥_ﬂths
, 0,  (route_type_oaths));

1482 
	`mem£t
 (&
£rv
, 0,  (
sockaddr_un
));

1483 
£rv
.
sun_Ámûy
 = 
AF_UNIX
;

1484 
	`°∫˝y
 (
£rv
.
sun_∑th
, 
∑th
, 
	`°æí
 (path));

1485 #ifde‡
HAVE_STRUCT_SOCKADDR_UN_SUN_LEN


1486 
Àn
 = 
£rv
.
sun_Àn
 = 
	`SUN_LEN
(&serv);

1488 
Àn
 =  (
£rv
.
sun_Ámûy
Ë+ 
	`°æí
 (£rv.
sun_∑th
);

1491 
ªt
 = 
	`böd
 (
sock
, (
sockaddr
 *Ë&
£rv
, 
Àn
);

1492 i‡(
ªt
 < 0)

1494 
	`zlog_w¨n
 ("Can't bindÅo unix socket %s: %s",

1495 
∑th
, 
	`ß„_°ªº‹
 (
î∫o
));

1496 
	`zlog_w¨n
 ("zebra can'tÖrovide full functionality dueÅoáboveÉrror");

1497 
	`˛o£
 (
sock
);

1501 
ªt
 = 
	`li°í
 (
sock
, 5);

1502 i‡(
ªt
 < 0)

1504 
	`zlog_w¨n
 ("Can'tÜistenÅo unix socket %s: %s",

1505 
∑th
, 
	`ß„_°ªº‹
 (
î∫o
));

1506 
	`zlog_w¨n
 ("zebra can'tÖrovide full functionality dueÅoáboveÉrror");

1507 
	`˛o£
 (
sock
);

1511 
	`umask
 (
ﬁd_mask
);

1513 
	`zebø_evít
 (
ZEBRA_SERV
, 
sock
, 
NULL
);

1514 
	}
}

1518 
	$zebø_evít
 (
evít
Évít, 
sock
, 
z£rv
 *
˛õ¡
)

1520 
evít
)

1522 
ZEBRA_SERV
:

1523 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
zebø_ac˚±
, 
˛õ¡
, 
sock
);

1525 
ZEBRA_READ
:

1526 
˛õ¡
->
t_ªad
 =

1527 
	`thªad_add_ªad
 (
zebød
.
ma°î
, 
zebø_˛õ¡_ªad
, 
˛õ¡
, 
sock
);

1529 
ZEBRA_WRITE
:

1533 
	}
}

1536 
DEFUN
 (
show_èbÀ
,

1537 
show_èbÀ_cmd
,

1539 
SHOW_STR


1542 
vty_out
 (
vty
, "èbÀ %d%s", 
zebød
.
πm_èbÀ_deÁu…
,

1543 
VTY_NEWLINE
);

1544  
	gCMD_SUCCESS
;

1547 
DEFUN
 (
c⁄fig_èbÀ
,

1548 
c⁄fig_èbÀ_cmd
,

1553 
	gzebød
.
	gπm_èbÀ_deÁu…
 = 
°πﬁ
 (
¨gv
[0], (**)0, 10);

1554  
	gCMD_SUCCESS
;

1557 
DEFUN
 (
ù_f‹w¨dög
,

1558 
ù_f‹w¨dög_cmd
,

1560 
IP_STR


1563 
	gªt
;

1565 
	gªt
 = 
ùf‹w¨d
 ();

1566 i‡(
	gªt
 == 0)

1567 
ªt
 = 
ùf‹w¨d_⁄
 ();

1569 i‡(
	gªt
 == 0)

1571 
vty_out
 (
vty
, "C™'àtu∫ o¿IP f‹w¨dög%s", 
VTY_NEWLINE
);

1572  
	gCMD_WARNING
;

1575  
	gCMD_SUCCESS
;

1578 
DEFUN
 (
no_ù_f‹w¨dög
,

1579 
no_ù_f‹w¨dög_cmd
,

1581 
NO_STR


1582 
IP_STR


1585 
	gªt
;

1587 
	gªt
 = 
ùf‹w¨d
 ();

1588 i‡(
	gªt
 != 0)

1589 
ªt
 = 
ùf‹w¨d_off
 ();

1591 i‡(
	gªt
 != 0)

1593 
vty_out
 (
vty
, "C™'àtu∫ of‡IP f‹w¨dög%s", 
VTY_NEWLINE
);

1594  
	gCMD_WARNING
;

1597  
	gCMD_SUCCESS
;

1601 
DEFUN
 (
show_zebø_˛õ¡
,

1602 
show_zebø_˛õ¡_cmd
,

1604 
SHOW_STR


1608 
li°node
 *
	gnode
;

1609 
z£rv
 *
	g˛õ¡
;

1611 
ALL_LIST_ELEMENTS_RO
 (
zebød
.
˛õ¡_li°
, 
node
, 
˛õ¡
))

1612 
vty_out
 (
vty
, "Clõ¡ fd %d%s", 
˛õ¡
->
sock
, 
VTY_NEWLINE
);

1614  
	gCMD_SUCCESS
;

1619 
	$c⁄fig_wrôe_èbÀ
 (
vty
 *vty)

1621 i‡(
zebød
.
πm_èbÀ_deÁu…
)

1622 
	`vty_out
 (
vty
, "èbÀ %d%s", 
zebød
.
πm_èbÀ_deÁu…
,

1623 
VTY_NEWLINE
);

1625 
	}
}

1628 
cmd_node
 
	gèbÀ_node
 =

1630 
TABLE_NODE
,

1636 
DEFUN
 (
show_ù_f‹w¨dög
,

1637 
show_ù_f‹w¨dög_cmd
,

1639 
SHOW_STR


1640 
IP_STR


1643 
	gªt
;

1645 
	gªt
 = 
ùf‹w¨d
 ();

1647 i‡(
	gªt
 == 0)

1648 
vty_out
 (
vty
, "IP f‹w¨dög i†off%s", 
VTY_NEWLINE
);

1650 
vty_out
 (
vty
, "IP f‹w¨dög i†⁄%s", 
VTY_NEWLINE
);

1651  
	gCMD_SUCCESS
;

1654 #ifde‡
HAVE_IPV6


1656 
DEFUN
 (
show_ùv6_f‹w¨dög
,

1657 
show_ùv6_f‹w¨dög_cmd
,

1659 
SHOW_STR


1663 
	gªt
;

1665 
	gªt
 = 
ùf‹w¨d_ùv6
 ();

1667 
	gªt
)

1670 
vty_out
 (
vty
, "ùv6 f‹w¨dög i†unknown%s", 
VTY_NEWLINE
);

1673 
vty_out
 (
vty
, "ùv6 f‹w¨dög i†%s%s", "off", 
VTY_NEWLINE
);

1676 
vty_out
 (
vty
, "ùv6 f‹w¨dög i†%s%s", "⁄", 
VTY_NEWLINE
);

1679 
vty_out
 (
vty
, "ùv6 f‹w¨dög i†%s%s", "off", 
VTY_NEWLINE
);

1682  
	gCMD_SUCCESS
;

1685 
DEFUN
 (
ùv6_f‹w¨dög
,

1686 
ùv6_f‹w¨dög_cmd
,

1688 
IPV6_STR


1691 
	gªt
;

1693 
	gªt
 = 
ùf‹w¨d_ùv6
 ();

1694 i‡(
	gªt
 == 0)

1695 
ªt
 = 
ùf‹w¨d_ùv6_⁄
 ();

1697 i‡(
	gªt
 == 0)

1699 
vty_out
 (
vty
, "C™'àtu∫ o¿IPv6 f‹w¨dög%s", 
VTY_NEWLINE
);

1700  
	gCMD_WARNING
;

1703  
	gCMD_SUCCESS
;

1706 
DEFUN
 (
no_ùv6_f‹w¨dög
,

1707 
no_ùv6_f‹w¨dög_cmd
,

1709 
NO_STR


1710 
IPV6_STR


1713 
	gªt
;

1715 
	gªt
 = 
ùf‹w¨d_ùv6
 ();

1716 i‡(
	gªt
 != 0)

1717 
ªt
 = 
ùf‹w¨d_ùv6_off
 ();

1719 i‡(
	gªt
 != 0)

1721 
vty_out
 (
vty
, "C™'àtu∫ of‡IPv6 f‹w¨dög%s", 
VTY_NEWLINE
);

1722  
	gCMD_WARNING
;

1725  
	gCMD_SUCCESS
;

1732 
	$c⁄fig_wrôe_f‹w¨dög
 (
vty
 *vty)

1735 
	`rouãr_id_wrôe
 (
vty
);

1737 i‡(
	`ùf‹w¨d
 ())

1738 
	`vty_out
 (
vty
, "ù f‹w¨dög%s", 
VTY_NEWLINE
);

1739 #ifde‡
HAVE_IPV6


1740 i‡(
	`ùf‹w¨d_ùv6
 ())

1741 
	`vty_out
 (
vty
, "ùv6 f‹w¨dög%s", 
VTY_NEWLINE
);

1743 
	`vty_out
 (
vty
, "!%s", 
VTY_NEWLINE
);

1745 
	}
}

1748 
cmd_node
 
	gf‹w¨dög_node
 =

1750 
FORWARDING_NODE
,

1758 
	$zebø_öô
 ()

1761 
zebød
.
˛õ¡_li°
 = 
	`li°_√w
 ();

1764 
	`ö°Æl_node
 (&
èbÀ_node
, 
c⁄fig_wrôe_èbÀ
);

1765 
	`ö°Æl_node
 (&
f‹w¨dög_node
, 
c⁄fig_wrôe_f‹w¨dög
);

1767 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ù_f‹w¨dög_cmd
);

1768 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ù_f‹w¨dög_cmd
);

1769 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ù_f‹w¨dög_cmd
);

1770 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ù_f‹w¨dög_cmd
);

1771 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_zebø_˛õ¡_cmd
);

1773 #ifde‡
HAVE_NETLINK


1774 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_èbÀ_cmd
);

1775 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_èbÀ_cmd
);

1776 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
c⁄fig_èbÀ_cmd
);

1779 #ifde‡
HAVE_IPV6


1780 
	`ö°Æl_ñemít
 (
VIEW_NODE
, &
show_ùv6_f‹w¨dög_cmd
);

1781 
	`ö°Æl_ñemít
 (
ENABLE_NODE
, &
show_ùv6_f‹w¨dög_cmd
);

1782 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
ùv6_f‹w¨dög_cmd
);

1783 
	`ö°Æl_ñemít
 (
CONFIG_NODE
, &
no_ùv6_f‹w¨dög_cmd
);

1787 
	`zebø_rouã_m≠_öô
 ();

1788 
	}
}

1792 
	$zebø_z£rv_sockë_öô
 (*
∑th
)

1794 #ifde‡
HAVE_TCP_ZEBRA


1795 
	`zebø_£rv
 ();

1797 
	`zebø_£rv_un
 (
∑th
 ?Ö©h : 
ZEBRA_SERV_PATH
);

1799 
	}
}

	@/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zserv.h

22 #i‚de‡
_ZEBRA_ZSERV_H


23 
	#_ZEBRA_ZSERV_H


	)

25 
	~"rib.h
"

26 
	~"if.h
"

27 
	~"w‹kqueue.h
"

30 
	#ZEBRA_VTY_PORT
 2601

	)

33 
	#DEFAULT_CONFIG_FILE
 "zebø.c⁄f"

	)

36 
	sz£rv


39 
	msock
;

42 
°ªam
 *
	mibuf
;

43 
°ªam
 *
	mobuf
;

46 
buf„r
 *
	mwb
;

49 
thªad
 *
	mt_ªad
;

50 
thªad
 *
	mt_wrôe
;

53 
thªad
 *
	mt_suicide
;

56 
	mπm_èbÀ
;

59 
u_ch¨
 
	mªdi°
[
ZEBRA_ROUTE_MAX
];

62 
u_ch¨
 
	mªdi°_deÁu…
;

65 
u_ch¨
 
	miföfo
;

68 
u_ch¨
 
	mridöfo
;

72 
	szebø_t


75 
thªad_ma°î
 *
	mma°î
;

76 
li°
 *
	m˛õ¡_li°
;

79 
	mπm_èbÀ_deÁu…
;

82 
w‹k_queue
 *
	mribq
;

83 
mëa_queue
 *
	mmq
;

87 
	#PSIZE
(
a
Ë((◊Ë+ 7Ë/ (8))

	)

90 
zebø_öô
 ();

91 
zebø_if_öô
 ();

92 
zebø_z£rv_sockë_öô
 (*
∑th
);

93 
ho°öfo_gë
 ();

94 
rib_öô
 ();

95 
öãrÁ˚_li°
 ();

96 
kî√l_öô
 ();

97 
rouã_ªad
 ();

98 
zebø_rouã_m≠_öô
 ();

99 
zebø_¢mp_öô
 ();

100 
zebø_vty_öô
 ();

102 
z£nd_öãrÁ˚_add
 (
z£rv
 *, 
öãrÁ˚
 *);

103 
z£nd_öãrÁ˚_dñëe
 (
z£rv
 *, 
öãrÁ˚
 *);

104 
z£nd_öãrÁ˚_addªss
 (, 
z£rv
 *, 
öãrÁ˚
 *,

105 
c⁄√˘ed
 *);

106 
z£nd_öãrÁ˚_upd©e
 (, 
z£rv
 *, 
öãrÁ˚
 *);

107 
z£nd_rouã_mu…ù©h
 (, 
z£rv
 *, 
¥efix
 *,

108 
rib
 *);

109 
z£nd_rouãr_id_upd©e
(
z£rv
 *, 
¥efix
 *);

111 
pid_t
 
pid
;

	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/arpa/inet.h

18 #i‚de‡
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<√töë/ö.h
>

25 #i‚de‡
__sockÀn_t_deföed


26 
__sockÀn_t
 
	tsockÀn_t
;

27 
	#__sockÀn_t_deföed


	)

30 
__BEGIN_DECLS


34 
ö_addr_t
 
	$öë_addr
 (c⁄° *
__˝
Ë
__THROW
;

37 
ö_addr_t
 
	$öë_ aof
 (
ö_addr
 
__ö
Ë
__THROW
;

41 
ö_addr
 
	$öë_makóddr
 (
ö_addr_t
 
__√t
, in_addr_à
__ho°
)

42 
__THROW
;

45 
ö_addr_t
 
	$öë_√tof
 (
ö_addr
 
__ö
Ë
__THROW
;

49 
ö_addr_t
 
	$öë_√tw‹k
 (c⁄° *
__˝
Ë
__THROW
;

53 *
	$öë_¡ﬂ
 (
ö_addr
 
__ö
Ë
__THROW
;

58 
	$öë_±⁄
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

59 *
__ª°ri˘
 
__buf
Ë
__THROW
;

64 c⁄° *
	$öë_¡›
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

65 *
__ª°ri˘
 
__buf
, 
sockÀn_t
 
__Àn
)

66 
__THROW
;

70 #ifde‡
__USE_MISC


73 
	$öë_©⁄
 (c⁄° *
__˝
, 
ö_addr
 *
__öp
Ë
__THROW
;

77 *
	$öë_√è
 (
ö_addr_t
 
__√t
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

82 *
	$öë_√t_¡›
 (
__af
, c⁄° *
__˝
, 
__bôs
,

83 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

88 
	$öë_√t_±⁄
 (
__af
, c⁄° *
__˝
,

89 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

94 
	$öë_nßp_addr
 (c⁄° *
__˝
,

95 *
__buf
, 
__Àn
Ë
__THROW
;

99 *
	$öë_nßp_¡ﬂ
 (
__Àn
, c⁄° *
__˝
,

100 *
__buf
Ë
__THROW
;

103 
__END_DECLS


	@/usr/include/arpa/telnet.h

32 #i‚de‡
_ARPA_TELNET_H


33 
	#_ARPA_TELNET_H
 1

	)

38 
	#IAC
 255

	)

39 
	#DONT
 254

	)

40 
	#DO
 253

	)

41 
	#WONT
 252

	)

42 
	#WILL
 251

	)

43 
	#SB
 250

	)

44 
	#GA
 249

	)

45 
	#EL
 248

	)

46 
	#EC
 247

	)

47 
	#AYT
 246

	)

48 
	#AO
 245

	)

49 
	#IP
 244

	)

50 
	#BREAK
 243

	)

51 
	#DM
 242

	)

52 
	#NOP
 241

	)

53 
	#SE
 240

	)

54 
	#EOR
 239

	)

55 
	#ABORT
 238

	)

56 
	#SUSP
 237

	)

57 
	#xEOF
 236

	)

59 
	#SYNCH
 242

	)

61 #ifde‡
TELCMDS


62 *
	gãlcmds
[] = {

68 *
ãlcmds
[];

71 
	#TELCMD_FIRST
 
xEOF


	)

72 
	#TELCMD_LAST
 
IAC


	)

73 
	#TELCMD_OK
(
x
Ë(()(xË<
TELCMD_LAST
 && \

74 ()(
x
Ë>
TELCMD_FIRST
)

	)

75 
	#TELCMD
(
x
Ë
ãlcmds
[(x)-
TELCMD_FIRST
]

	)

78 
	#TELOPT_BINARY
 0

	)

79 
	#TELOPT_ECHO
 1

	)

80 
	#TELOPT_RCP
 2

	)

81 
	#TELOPT_SGA
 3

	)

82 
	#TELOPT_NAMS
 4

	)

83 
	#TELOPT_STATUS
 5

	)

84 
	#TELOPT_TM
 6

	)

85 
	#TELOPT_RCTE
 7

	)

86 
	#TELOPT_NAOL
 8

	)

87 
	#TELOPT_NAOP
 9

	)

88 
	#TELOPT_NAOCRD
 10

	)

89 
	#TELOPT_NAOHTS
 11

	)

90 
	#TELOPT_NAOHTD
 12

	)

91 
	#TELOPT_NAOFFD
 13

	)

92 
	#TELOPT_NAOVTS
 14

	)

93 
	#TELOPT_NAOVTD
 15

	)

94 
	#TELOPT_NAOLFD
 16

	)

95 
	#TELOPT_XASCII
 17

	)

96 
	#TELOPT_LOGOUT
 18

	)

97 
	#TELOPT_BM
 19

	)

98 
	#TELOPT_DET
 20

	)

99 
	#TELOPT_SUPDUP
 21

	)

100 
	#TELOPT_SUPDUPOUTPUT
 22

	)

101 
	#TELOPT_SNDLOC
 23

	)

102 
	#TELOPT_TTYPE
 24

	)

103 
	#TELOPT_EOR
 25

	)

104 
	#TELOPT_TUID
 26

	)

105 
	#TELOPT_OUTMRK
 27

	)

106 
	#TELOPT_TTYLOC
 28

	)

107 
	#TELOPT_3270REGIME
 29

	)

108 
	#TELOPT_X3PAD
 30

	)

109 
	#TELOPT_NAWS
 31

	)

110 
	#TELOPT_TSPEED
 32

	)

111 
	#TELOPT_LFLOW
 33

	)

112 
	#TELOPT_LINEMODE
 34

	)

113 
	#TELOPT_XDISPLOC
 35

	)

114 
	#TELOPT_OLD_ENVIRON
 36

	)

115 
	#TELOPT_AUTHENTICATION
 37

	)

116 
	#TELOPT_ENCRYPT
 38

	)

117 
	#TELOPT_NEW_ENVIRON
 39

	)

118 
	#TELOPT_EXOPL
 255

	)

121 
	#NTELOPTS
 (1+
TELOPT_NEW_ENVIRON
)

	)

122 #ifde‡
TELOPTS


123 *
	gãl›ts
[
NTELOPTS
+1] = {

136 
	#TELOPT_FIRST
 
TELOPT_BINARY


	)

137 
	#TELOPT_LAST
 
TELOPT_NEW_ENVIRON


	)

138 
	#TELOPT_OK
(
x
Ë(()(xË<
TELOPT_LAST
)

	)

139 
	#TELOPT
(
x
Ë
ãl›ts
[(x)-
TELOPT_FIRST
]

	)

143 
	#TELQUAL_IS
 0

	)

144 
	#TELQUAL_SEND
 1

	)

145 
	#TELQUAL_INFO
 2

	)

146 
	#TELQUAL_REPLY
 2

	)

147 
	#TELQUAL_NAME
 3

	)

149 
	#LFLOW_OFF
 0

	)

150 
	#LFLOW_ON
 1

	)

151 
	#LFLOW_RESTART_ANY
 2

	)

152 
	#LFLOW_RESTART_XON
 3

	)

158 
	#LM_MODE
 1

	)

159 
	#LM_FORWARDMASK
 2

	)

160 
	#LM_SLC
 3

	)

162 
	#MODE_EDIT
 0x01

	)

163 
	#MODE_TRAPSIG
 0x02

	)

164 
	#MODE_ACK
 0x04

	)

165 
	#MODE_SOFT_TAB
 0x08

	)

166 
	#MODE_LIT_ECHO
 0x10

	)

168 
	#MODE_MASK
 0x1f

	)

171 
	#MODE_FLOW
 0x0100

	)

172 
	#MODE_ECHO
 0x0200

	)

173 
	#MODE_INBIN
 0x0400

	)

174 
	#MODE_OUTBIN
 0x0800

	)

175 
	#MODE_FORCE
 0x1000

	)

177 
	#SLC_SYNCH
 1

	)

178 
	#SLC_BRK
 2

	)

179 
	#SLC_IP
 3

	)

180 
	#SLC_AO
 4

	)

181 
	#SLC_AYT
 5

	)

182 
	#SLC_EOR
 6

	)

183 
	#SLC_ABORT
 7

	)

184 
	#SLC_EOF
 8

	)

185 
	#SLC_SUSP
 9

	)

186 
	#SLC_EC
 10

	)

187 
	#SLC_EL
 11

	)

188 
	#SLC_EW
 12

	)

189 
	#SLC_RP
 13

	)

190 
	#SLC_LNEXT
 14

	)

191 
	#SLC_XON
 15

	)

192 
	#SLC_XOFF
 16

	)

193 
	#SLC_FORW1
 17

	)

194 
	#SLC_FORW2
 18

	)

196 
	#NSLC
 18

	)

202 
	#SLC_NAMELIST
 "0", "SYNCH", "BRK", "IP", "AO", "AYT", "EOR", \

204 "LNEXT", "XON", "XOFF", "FORW1", "FORW2", 0,

	)

205 #ifdef 
SLC_NAMES


206 *
	g¶c_«mes
[] = {

207 
SLC_NAMELIST


210 *
¶c_«mes
[];

211 
	#SLC_NAMES
 
SLC_NAMELIST


	)

214 
	#SLC_NAME_OK
(
x
Ë(()(xË<
NSLC
)

	)

215 
	#SLC_NAME
(
x
Ë
¶c_«mes
[x]

	)

217 
	#SLC_NOSUPPORT
 0

	)

218 
	#SLC_CANTCHANGE
 1

	)

219 
	#SLC_VARIABLE
 2

	)

220 
	#SLC_DEFAULT
 3

	)

221 
	#SLC_LEVELBITS
 0x03

	)

223 
	#SLC_FUNC
 0

	)

224 
	#SLC_FLAGS
 1

	)

225 
	#SLC_VALUE
 2

	)

227 
	#SLC_ACK
 0x80

	)

228 
	#SLC_FLUSHIN
 0x40

	)

229 
	#SLC_FLUSHOUT
 0x20

	)

231 
	#OLD_ENV_VAR
 1

	)

232 
	#OLD_ENV_VALUE
 0

	)

233 
	#NEW_ENV_VAR
 0

	)

234 
	#NEW_ENV_VALUE
 1

	)

235 
	#ENV_ESC
 2

	)

236 
	#ENV_USERVAR
 3

	)

245 
	#AUTH_WHO_CLIENT
 0

	)

246 
	#AUTH_WHO_SERVER
 1

	)

247 
	#AUTH_WHO_MASK
 1

	)

252 
	#AUTH_HOW_ONE_WAY
 0

	)

253 
	#AUTH_HOW_MUTUAL
 2

	)

254 
	#AUTH_HOW_MASK
 2

	)

256 
	#AUTHTYPE_NULL
 0

	)

257 
	#AUTHTYPE_KERBEROS_V4
 1

	)

258 
	#AUTHTYPE_KERBEROS_V5
 2

	)

259 
	#AUTHTYPE_SPX
 3

	)

260 
	#AUTHTYPE_MINK
 4

	)

261 
	#AUTHTYPE_CNT
 5

	)

263 
	#AUTHTYPE_TEST
 99

	)

265 #ifdef 
AUTH_NAMES


266 *
	gauthty≥_«mes
[] = {

270 *
authty≥_«mes
[];

273 
	#AUTHTYPE_NAME_OK
(
x
Ë(()(xË< 
AUTHTYPE_CNT
)

	)

274 
	#AUTHTYPE_NAME
(
x
Ë
authty≥_«mes
[x]

	)

279 
	#ENCRYPT_IS
 0

	)

280 
	#ENCRYPT_SUPPORT
 1

	)

281 
	#ENCRYPT_REPLY
 2

	)

282 
	#ENCRYPT_START
 3

	)

283 
	#ENCRYPT_END
 4

	)

284 
	#ENCRYPT_REQSTART
 5

	)

285 
	#ENCRYPT_REQEND
 6

	)

286 
	#ENCRYPT_ENC_KEYID
 7

	)

287 
	#ENCRYPT_DEC_KEYID
 8

	)

288 
	#ENCRYPT_CNT
 9

	)

290 
	#ENCTYPE_ANY
 0

	)

291 
	#ENCTYPE_DES_CFB64
 1

	)

292 
	#ENCTYPE_DES_OFB64
 2

	)

293 
	#ENCTYPE_CNT
 3

	)

295 #ifdef 
ENCRYPT_NAMES


296 *
	gí¸y±_«mes
[] = {

301 *
	gí˘y≥_«mes
[] = {

305 *
í¸y±_«mes
[];

306 *
í˘y≥_«mes
[];

310 
	#ENCRYPT_NAME_OK
(
x
Ë(()(xË< 
ENCRYPT_CNT
)

	)

311 
	#ENCRYPT_NAME
(
x
Ë
í¸y±_«mes
[x]

	)

313 
	#ENCTYPE_NAME_OK
(
x
Ë(()(xË< 
ENCTYPE_CNT
)

	)

314 
	#ENCTYPE_NAME
(
x
Ë
í˘y≥_«mes
[x]

	)

	@/usr/include/asm/types.h

1 #i‚de‡
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-gíîic/ty≥s.h
>

	@/usr/include/ctype.h

23 #i‚def 
_CTYPE_H


24 
	#_CTYPE_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 
	g__BEGIN_DECLS


31 #i‚de‡
_ISbô


40 
	~<ídün.h
>

41 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


42 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

44 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

49 
	m_ISuµî
 = 
_ISbô
 (0),

50 
	m_ISlowî
 = 
_ISbô
 (1),

51 
	m_ISÆpha
 = 
_ISbô
 (2),

52 
	m_ISdigô
 = 
_ISbô
 (3),

53 
	m_ISxdigô
 = 
_ISbô
 (4),

54 
	m_IS•a˚
 = 
_ISbô
 (5),

55 
	m_IS¥öt
 = 
_ISbô
 (6),

56 
	m_ISgøph
 = 
_ISbô
 (7),

57 
	m_ISbœnk
 = 
_ISbô
 (8),

58 
	m_IS˙ål
 = 
_ISbô
 (9),

59 
	m_ISpun˘
 = 
_ISbô
 (10),

60 
	m_ISÆnum
 = 
_ISbô
 (11)

80 c⁄° **
	$__˘y≥_b_loc
 ()

81 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

82 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

83 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

84 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

85 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

88 #i‚de‡
__˝lu•lus


89 
	#__is˘y≥
(
c
, 
ty≥
) \

90 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

91 #ñi‡
deföed
 
__USE_EXTERN_INLINES


92 
	#__is˘y≥_f
(
ty≥
) \

93 
__exã∫_ölöe
 \

94 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

96  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

97 
	}

	)
}

100 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

101 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

103 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

105 
__BEGIN_NAMESPACE_STD


111 
__ex˘y≥
 (
iß um
);

112 
__ex˘y≥
 (
ißÕha
);

113 
__ex˘y≥
 (
is˙ål
);

114 
__ex˘y≥
 (
isdigô
);

115 
__ex˘y≥
 (
i¶owî
);

116 
__ex˘y≥
 (
isgøph
);

117 
__ex˘y≥
 (
i•röt
);

118 
__ex˘y≥
 (
i•un˘
);

119 
__ex˘y≥
 (
is•a˚
);

120 
__ex˘y≥
 (
isuµî
);

121 
__ex˘y≥
 (
isxdigô
);

125 
	$tﬁowî
 (
__c
Ë
__THROW
;

128 
	$touµî
 (
__c
Ë
__THROW
;

130 
__END_NAMESPACE_STD


134 #ifdef 
__USE_ISOC99


135 
__BEGIN_NAMESPACE_C99


137 
	`__ex˘y≥
 (
isbœnk
);

139 
__END_NAMESPACE_C99


142 #ifde‡
__USE_GNU


144 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

147 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


151 
	$ißscii
 (
__c
Ë
__THROW
;

155 
	$tﬂscii
 (
__c
Ë
__THROW
;

159 
	`__ex˘y≥
 (
_touµî
);

160 
	`__ex˘y≥
 (
_tﬁowî
);

164 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

165 (
__exãnsi⁄__
 \

166 ({ 
__ªs
; \

167 i‡( (
c
) > 1) \

169 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

171 
__c
 = (
c
); \

172 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

175 
__ªs
 = 
f
 
¨gs
; \

178 
__ªs
 = (
a
)[(Ë(
c
)]; \

179 
__ªs
; 
	}
}))

	)

181 #i‡!
deföed
 
__NO_CTYPE


182 #ifde‡
__is˘y≥_f


183 
	$__is˘y≥_f
 (
Ænum
)

184 
	$__is˘y≥_f
 (
Æpha
)

185 
	$__is˘y≥_f
 (
˙ål
)

186 
	$__is˘y≥_f
 (
digô
)

187 
	$__is˘y≥_f
 (
lowî
)

188 
	$__is˘y≥_f
 (
gøph
)

189 
	$__is˘y≥_f
 (
¥öt
)

190 
	$__is˘y≥_f
 (
pun˘
)

191 
	$__is˘y≥_f
 (
•a˚
)

192 
	$__is˘y≥_f
 (
uµî
)

193 
	$__is˘y≥_f
 (
xdigô
)

194 #ifde‡
__USE_ISOC99


195 
	$__is˘y≥_f
 (
bœnk
)

197 #ñi‡
deföed
 
__is˘y≥


198 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

199 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

200 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

201 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

202 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

203 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

204 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

205 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

206 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

207 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

208 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

209 #ifde‡
__USE_ISOC99


210 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

214 #ifde‡
__USE_EXTERN_INLINES


215 
__exã∫_ölöe
 

216 
	`__NTH
 (
	$tﬁowî
 (
__c
))

218  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

219 
	}
}

221 
__exã∫_ölöe
 

222 
__NTH
 (
	$touµî
 (
__c
))

224  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

225 
	}
}

228 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


229 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

230 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

233 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


234 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

235 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

237 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

238 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

244 #ifde‡
__USE_XOPEN2K8


258 
	~<xloˇÀ.h
>

262 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

263 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

265 
	#__ex˘y≥_l
(
«me
) \

266 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

272 
__ex˘y≥_l
 (
iß um_l
);

273 
__ex˘y≥_l
 (
ißÕha_l
);

274 
__ex˘y≥_l
 (
is˙ål_l
);

275 
__ex˘y≥_l
 (
isdigô_l
);

276 
__ex˘y≥_l
 (
i¶owî_l
);

277 
__ex˘y≥_l
 (
isgøph_l
);

278 
__ex˘y≥_l
 (
i•röt_l
);

279 
__ex˘y≥_l
 (
i•un˘_l
);

280 
__ex˘y≥_l
 (
is•a˚_l
);

281 
__ex˘y≥_l
 (
isuµî_l
);

282 
__ex˘y≥_l
 (
isxdigô_l
);

284 
__ex˘y≥_l
 (
isbœnk_l
);

288 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

289 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

293 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

295 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


296 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

297 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

298 
	#__touµî_l
(
c
, 
loˇÀ
) \

299 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

300 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

301 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

305 #i‚de‡
__NO_CTYPE


306 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

307 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

308 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

309 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

310 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

311 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

312 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

313 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

314 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

315 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

316 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

318 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

320 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


321 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

322 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

325 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

326 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

327 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

328 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

329 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

330 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

331 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

332 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

333 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

334 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

335 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

337 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

339 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


340 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

341 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

348 
__END_DECLS


	@/usr/include/errno.h

22 #i‚def 
_ERRNO_H


26 #i‚def 
__√ed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


35 
	~<bôs/î∫o.h
>

36 #unde‡
__√ed_Em©h


38 #ifdef 
_ERRNO_H


45 #i‚def 
î∫o


46 
î∫o
;

49 #ifde‡
__USE_GNU


54 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

58 
	g__END_DECLS


66 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


67 #i‚de‡
__îr‹_t_deföed


68 
	tîr‹_t
;

69 
	#__îr‹_t_deföed
 1

	)

71 #unde‡
__√ed_îr‹_t


	@/usr/include/execinfo.h

18 #i‚de‡
_EXECINFO_H


19 
	#_EXECINFO_H
 1

	)

21 
	~<„©uªs.h
>

23 
__BEGIN_DECLS


27 
	$backåa˚
 (**
__¨øy
, 
__size
Ë
	`__n⁄nuŒ
 ((1));

32 **
	$backåa˚_symbﬁs
 (*c⁄° *
__¨øy
, 
__size
)

33 
__THROW
 
	`__n⁄nuŒ
 ((1));

38 
	$backåa˚_symbﬁs_fd
 (*c⁄° *
__¨øy
, 
__size
, 
__fd
)

39 
__THROW
 
	`__n⁄nuŒ
 ((1));

41 
__END_DECLS


	@/usr/include/fcntl.h

22 #i‚def 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

35 
	~<bôs/f˙é.h
>

39 #ifde‡
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oÊag
) \

41 (((
oÊag
Ë& 
O_CREAT
Ë!0 || ((oÊagË& 
__O_TMPFILE
Ë=__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oÊag
Ë(((oÊagË& 
O_CREAT
Ë!0)

	)

49 #i‚de‡
__mode_t_deföed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_deföed


	)

54 #i‚de‡
__off_t_deföed


55 #i‚de‡
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_deföed


	)

63 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_deföed


	)

68 #i‚de‡
__pid_t_deföed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_deföed


	)

74 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


75 
	#__√ed_time•ec


	)

76 
	~<time.h
>

77 
	~<bôs/°©.h
>

79 
	#S_IFMT
 
__S_IFMT


	)

80 
	#S_IFDIR
 
__S_IFDIR


	)

81 
	#S_IFCHR
 
__S_IFCHR


	)

82 
	#S_IFBLK
 
__S_IFBLK


	)

83 
	#S_IFREG
 
__S_IFREG


	)

84 #ifde‡
__S_IFIFO


85 
	#S_IFIFO
 
__S_IFIFO


	)

87 #ifde‡
__S_IFLNK


88 
	#S_IFLNK
 
__S_IFLNK


	)

90 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


91 
	#S_IFSOCK
 
__S_IFSOCK


	)

96 
	#S_ISUID
 
__S_ISUID


	)

97 
	#S_ISGID
 
__S_ISGID


	)

99 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


101 
	#S_ISVTX
 
__S_ISVTX


	)

104 
	#S_IRUSR
 
__S_IREAD


	)

105 
	#S_IWUSR
 
__S_IWRITE


	)

106 
	#S_IXUSR
 
__S_IEXEC


	)

108 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

110 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

111 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

112 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

114 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

116 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

117 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

118 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

120 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

123 #ifdef 
__USE_MISC


124 #i‚de‡
R_OK


127 
	#R_OK
 4

	)

128 
	#W_OK
 2

	)

129 
	#X_OK
 1

	)

130 
	#F_OK
 0

	)

135 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


136 
	#SEEK_SET
 0

	)

137 
	#SEEK_CUR
 1

	)

138 
	#SEEK_END
 2

	)

141 #ifde‡
__USE_ATFILE


142 
	#AT_FDCWD
 -100

	)

145 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

146 
	#AT_REMOVEDIR
 0x200

	)

148 
	#AT_SYMLINK_FOLLOW
 0x400

	)

149 #ifde‡
__USE_GNU


150 
	#AT_NO_AUTOMOUNT
 0x800

	)

152 
	#AT_EMPTY_PATH
 0x1000

	)

154 
	#AT_EACCESS
 0x200

	)

163 
f˙é
 (
__fd
, 
__cmd
, ...);

172 #i‚de‡
__USE_FILE_OFFSET64


173 
	$›í
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

175 #ifde‡
__REDIRECT


176 
	`__REDIRECT
 (
›í
, (c⁄° *
__fûe
, 
__oÊag
, ...), 
›í64
)

177 
	`__n⁄nuŒ
 ((1));

179 
	#›í
 
›í64


	)

182 #ifde‡
__USE_LARGEFILE64


183 
	$›í64
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

186 #ifde‡
__USE_ATFILE


196 #i‚de‡
__USE_FILE_OFFSET64


197 
	$›í©
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

198 
	`__n⁄nuŒ
 ((2));

200 #ifde‡
__REDIRECT


201 
	`__REDIRECT
 (
›í©
, (
__fd
, c⁄° *
__fûe
, 
__oÊag
,

202 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

204 
	#›í©
 
›í©64


	)

207 #ifde‡
__USE_LARGEFILE64


208 
	$›í©64
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

209 
	`__n⁄nuŒ
 ((2));

218 #i‚de‡
__USE_FILE_OFFSET64


219 
	$¸ót
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

221 #ifde‡
__REDIRECT


222 
	`__REDIRECT
 (
¸ót
, (c⁄° *
__fûe
, 
mode_t
 
__mode
),

223 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

225 
	#¸ót
 
¸ót64


	)

228 #ifde‡
__USE_LARGEFILE64


229 
	$¸ót64
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

232 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

233 && !
deföed
 
__USE_POSIX
))

242 
	#F_ULOCK
 0

	)

243 
	#F_LOCK
 1

	)

244 
	#F_TLOCK
 2

	)

245 
	#F_TEST
 3

	)

247 #i‚de‡
__USE_FILE_OFFSET64


248 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Àn
);

250 #ifde‡
__REDIRECT


251 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

253 
	#lockf
 
lockf64


	)

256 #ifde‡
__USE_LARGEFILE64


257 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Àn
);

261 #ifde‡
__USE_XOPEN2K


264 #i‚de‡
__USE_FILE_OFFSET64


265 
	$posix_Ádvi£
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
,

266 
__advi£
Ë
__THROW
;

268 #ifde‡
__REDIRECT_NTH


269 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

270 
__off64_t
 
__Àn
, 
__advi£
),

271 
posix_Ádvi£64
);

273 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

276 #ifde‡
__USE_LARGEFILE64


277 
	$posix_Ádvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
,

278 
__advi£
Ë
__THROW
;

286 #i‚de‡
__USE_FILE_OFFSET64


287 
	`posix_ÁŒoˇã
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
);

289 #ifde‡
__REDIRECT


290 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

291 
__off64_t
 
__Àn
),

292 
posix_ÁŒoˇã64
);

294 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

297 #ifde‡
__USE_LARGEFILE64


298 
	`posix_ÁŒoˇã64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
);

304 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
 \

305 && 
deföed
 
__va_¨g_∑ck_Àn


306 
	~<bôs/f˙é2.h
>

309 
__END_DECLS


	@/usr/include/getopt.h

20 #i‚de‡
_GETOPT_H


22 #i‚de‡
__√ed_gë›t


23 
	#_GETOPT_H
 1

	)

33 #i‡!
deföed
 
__GNU_LIBRARY__


34 
	~<˘y≥.h
>

37 #i‚de‡
__THROW


38 #i‚de‡
__GNUC_PREREQ


39 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

41 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

42 
	#__THROW
 
	`throw
 ()

	)

44 
	#__THROW


	)

48 #ifdef 
__˝lu•lus


58 *
›èrg
;

72 
›töd
;

77 
›ãº
;

81 
›t›t
;

83 #i‚de‡
__√ed_gë›t


105 
	s›ti⁄


107 c⁄° *
	g«me
;

110 
	ghas_¨g
;

111 *
	gÊag
;

112 
	gvÆ
;

117 
	#no_¨gumít
 0

	)

118 
	#ªquúed_¨gumít
 1

	)

119 
	#›ti⁄Æ_¨gumít
 2

	)

147 #ifde‡
__GNU_LIBRARY__


151 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

152 
__THROW
;

154 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

155 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


159 #ifde‡
__REDIRECT


160 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

161 c⁄° *
__sh‹t›ts
),

162 
__posix_gë›t
);

164 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

165 c⁄° *
__sh‹t›ts
Ë
__THROW
;

166 
	#gë›t
 
__posix_gë›t


	)

170 
gë›t
 ();

173 #i‚de‡
__√ed_gë›t


174 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

175 c⁄° *
__sh‹t›ts
,

176 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

177 
__THROW
;

178 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

179 c⁄° *
__sh‹t›ts
,

180 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

181 
__THROW
;

185 #ifdef 
__˝lu•lus


190 #unde‡
__√ed_gë›t


	@/usr/include/gnu-versions.h

19 #i‚de‡
_GNU_VERSIONS_H


20 
	#_GNU_VERSIONS_H
 1

	)

46 
	#_GNU_OBSTACK_INTERFACE_VERSION
 1

	)

47 
	#_GNU_REGEX_INTERFACE_VERSION
 1

	)

48 
	#_GNU_GLOB_INTERFACE_VERSION
 1

	)

49 
	#_GNU_GETOPT_INTERFACE_VERSION
 2

	)

	@/usr/include/grp.h

23 #i‚def 
_GRP_H


24 
	#_GRP_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<bôs/ty≥s.h
>

32 
	#__√ed_size_t


	)

33 
	~<°ddef.h
>

37 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K
Ë&& !deföed 
__gid_t_deföed


38 
__gid_t
 
	tgid_t
;

39 
	#__gid_t_deföed


	)

43 
	sgroup


45 *
	mgr_«me
;

46 *
	mgr_∑sswd
;

47 
__gid_t
 
	mgr_gid
;

48 **
	mgr_mem
;

52 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_GNU


53 
	#__√ed_FILE


	)

54 
	~<°dio.h
>

58 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


63 
£tgª¡
 ();

66 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

67 || 
deföed
 
__USE_XOPEN2K8


72 
ídgª¡
 ();

78 
group
 *
gëgª¡
 ();

81 #ifdef 
__USE_SVID


88 
group
 *
fgëgª¡
 (
FILE
 *
__°ªam
);

91 #ifde‡
__USE_GNU


98 
putgª¡
 (c⁄° 
group
 *
__ª°ri˘
 
__p
,

99 
FILE
 *
__ª°ri˘
 
__f
);

106 
group
 *
gëgrgid
 (
__gid_t
 
__gid
);

112 
group
 *
gëg∫am
 (c⁄° *
__«me
);

114 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


116 #ifde‡
__USE_MISC


119 
	#NSS_BUFLEN_GROUP
 1024

	)

135 #ifde‡
__USE_GNU


136 
gëgª¡_r
 (
group
 *
__ª°ri˘
 
__ªsu…buf
,

137 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

138 
group
 **
__ª°ri˘
 
__ªsu…
);

145 
gëgrgid_r
 (
__gid_t
 
__gid
, 
group
 *
__ª°ri˘
 
__ªsu…buf
,

146 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

147 
group
 **
__ª°ri˘
 
__ªsu…
);

153 
gëg∫am_r
 (c⁄° *
__ª°ri˘
 
__«me
,

154 
group
 *
__ª°ri˘
 
__ªsu…buf
,

155 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

156 
group
 **
__ª°ri˘
 
__ªsu…
);

158 #ifdef 
__USE_SVID


166 
fgëgª¡_r
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

167 
group
 *
__ª°ri˘
 
__ªsu…buf
,

168 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

169 
group
 **
__ª°ri˘
 
__ªsu…
);

175 #ifdef 
__USE_BSD


177 
	#__√ed_size_t


	)

178 
	~<°ddef.h
>

181 
	$£tgroups
 (
size_t
 
__n
, c⁄° 
__gid_t
 *
__groups
Ë
__THROW
;

191 
	`gëgrou∂i°
 (c⁄° *
__u£r
, 
__gid_t
 
__group
,

192 
__gid_t
 *
__groups
, *
__ngroups
);

202 
	`öôgroups
 (c⁄° *
__u£r
, 
__gid_t
 
__group
);

206 
__END_DECLS


	@/usr/include/ifaddrs.h

19 #i‚de‡
_IFADDRS_H


20 
	#_IFADDRS_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<sys/sockë.h
>

25 
__BEGIN_DECLS


29 
	siÁddrs


31 
iÁddrs
 *
	miÁ_√xt
;

33 *
	miÁ_«me
;

34 
	miÁ_Êags
;

36 
sockaddr
 *
	miÁ_addr
;

37 
sockaddr
 *
	miÁ_√tmask
;

44 
sockaddr
 *
	mifu_brﬂdaddr
;

45 
sockaddr
 *
	mifu_d°addr
;

46 } 
	miÁ_ifu
;

49 #i‚de‡
iÁ_brﬂdaddr


50 
	#iÁ_brﬂdaddr
 
iÁ_ifu
.
ifu_brﬂdaddr


	)

52 #i‚de‡
iÁ_d°addr


53 
	#iÁ_d°addr
 
iÁ_ifu
.
ifu_d°addr


	)

56 *
	miÁ_d©a
;

66 
	$gëiÁddrs
 (
iÁddrs
 **
__iÁp
Ë
__THROW
;

69 
	$‰ìiÁddrs
 (
iÁddrs
 *
__iÁ
Ë
__THROW
;

71 
__END_DECLS


	@/usr/include/inttypes.h

22 #i‚de‡
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<°döt.h
>

30 #i‚de‡
____gwch¨_t_deföed


31 #ifde‡
__˝lu•lus


32 
	#__gwch¨_t
 
wch¨_t


	)

33 #ñi‡
deföed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¨_t
;

36 
	#__√ed_wch¨_t


	)

37 
	~<°ddef.h
>

38 
wch¨_t
 
	t__gwch¨_t
;

40 
	#____gwch¨_t_deföed
 1

	)

44 #i‡
__WORDSIZE
 == 64

45 
	#__PRI64_PREFIX
 "l"

	)

46 
	#__PRIPTR_PREFIX
 "l"

	)

48 
	#__PRI64_PREFIX
 "Œ"

	)

49 
	#__PRIPTR_PREFIX


	)

55 
	#PRId8
 "d"

	)

56 
	#PRId16
 "d"

	)

57 
	#PRId32
 "d"

	)

58 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

60 
	#PRIdLEAST8
 "d"

	)

61 
	#PRIdLEAST16
 "d"

	)

62 
	#PRIdLEAST32
 "d"

	)

63 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

65 
	#PRIdFAST8
 "d"

	)

66 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

68 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

71 
	#PRIi8
 "i"

	)

72 
	#PRIi16
 "i"

	)

73 
	#PRIi32
 "i"

	)

74 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

76 
	#PRIiLEAST8
 "i"

	)

77 
	#PRIiLEAST16
 "i"

	)

78 
	#PRIiLEAST32
 "i"

	)

79 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

81 
	#PRIiFAST8
 "i"

	)

82 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

84 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

87 
	#PRIo8
 "o"

	)

88 
	#PRIo16
 "o"

	)

89 
	#PRIo32
 "o"

	)

90 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

92 
	#PRIoLEAST8
 "o"

	)

93 
	#PRIoLEAST16
 "o"

	)

94 
	#PRIoLEAST32
 "o"

	)

95 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

97 
	#PRIoFAST8
 "o"

	)

98 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

100 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

103 
	#PRIu8
 "u"

	)

104 
	#PRIu16
 "u"

	)

105 
	#PRIu32
 "u"

	)

106 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

108 
	#PRIuLEAST8
 "u"

	)

109 
	#PRIuLEAST16
 "u"

	)

110 
	#PRIuLEAST32
 "u"

	)

111 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

113 
	#PRIuFAST8
 "u"

	)

114 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

116 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

119 
	#PRIx8
 "x"

	)

120 
	#PRIx16
 "x"

	)

121 
	#PRIx32
 "x"

	)

122 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

124 
	#PRIxLEAST8
 "x"

	)

125 
	#PRIxLEAST16
 "x"

	)

126 
	#PRIxLEAST32
 "x"

	)

127 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

129 
	#PRIxFAST8
 "x"

	)

130 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

132 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

135 
	#PRIX8
 "X"

	)

136 
	#PRIX16
 "X"

	)

137 
	#PRIX32
 "X"

	)

138 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

140 
	#PRIXLEAST8
 "X"

	)

141 
	#PRIXLEAST16
 "X"

	)

142 
	#PRIXLEAST32
 "X"

	)

143 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

145 
	#PRIXFAST8
 "X"

	)

146 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

148 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

152 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

153 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

154 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

155 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

156 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

157 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

161 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

162 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

163 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

164 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

165 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

166 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

172 
	#SCNd8
 "hhd"

	)

173 
	#SCNd16
 "hd"

	)

174 
	#SCNd32
 "d"

	)

175 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

177 
	#SCNdLEAST8
 "hhd"

	)

178 
	#SCNdLEAST16
 "hd"

	)

179 
	#SCNdLEAST32
 "d"

	)

180 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

182 
	#SCNdFAST8
 "hhd"

	)

183 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

185 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

188 
	#SCNi8
 "hhi"

	)

189 
	#SCNi16
 "hi"

	)

190 
	#SCNi32
 "i"

	)

191 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

193 
	#SCNiLEAST8
 "hhi"

	)

194 
	#SCNiLEAST16
 "hi"

	)

195 
	#SCNiLEAST32
 "i"

	)

196 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

198 
	#SCNiFAST8
 "hhi"

	)

199 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

201 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

204 
	#SCNu8
 "hhu"

	)

205 
	#SCNu16
 "hu"

	)

206 
	#SCNu32
 "u"

	)

207 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

209 
	#SCNuLEAST8
 "hhu"

	)

210 
	#SCNuLEAST16
 "hu"

	)

211 
	#SCNuLEAST32
 "u"

	)

212 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

214 
	#SCNuFAST8
 "hhu"

	)

215 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

217 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

220 
	#SCNo8
 "hho"

	)

221 
	#SCNo16
 "ho"

	)

222 
	#SCNo32
 "o"

	)

223 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

225 
	#SCNoLEAST8
 "hho"

	)

226 
	#SCNoLEAST16
 "ho"

	)

227 
	#SCNoLEAST32
 "o"

	)

228 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

230 
	#SCNoFAST8
 "hho"

	)

231 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

233 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

236 
	#SCNx8
 "hhx"

	)

237 
	#SCNx16
 "hx"

	)

238 
	#SCNx32
 "x"

	)

239 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

241 
	#SCNxLEAST8
 "hhx"

	)

242 
	#SCNxLEAST16
 "hx"

	)

243 
	#SCNxLEAST32
 "x"

	)

244 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

246 
	#SCNxFAST8
 "hhx"

	)

247 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

249 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

253 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

254 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

255 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

256 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

257 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

260 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

261 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

262 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

263 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

264 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

267 
	g__BEGIN_DECLS


269 #i‡
__WORDSIZE
 == 64

274 
	mquŸ
;

275 
	mªm
;

276 } 
	timaxdiv_t
;

283 
	mquŸ
;

284 
	mªm
;

285 } 
	timaxdiv_t
;

291 
ötmax_t
 
	$imaxabs
 (
ötmax_t
 
__n
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

294 
imaxdiv_t
 
	$imaxdiv
 (
ötmax_t
 
__numî
, i¡max_à
__díom
)

295 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

298 
ötmax_t
 
	$°πoimax
 (c⁄° *
__ª°ri˘
 
__≈å
,

299 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

302 
uötmax_t
 
	$°πoumax
 (c⁄° *
__ª°ri˘
 
__≈å
,

303 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

306 
ötmax_t
 
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

307 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

308 
__THROW
;

311 
uötmax_t
 
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

312 
__gwch¨_t
 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
)

313 
__THROW
;

315 #ifde‡
__USE_EXTERN_INLINES


317 #i‡
__WORDSIZE
 == 64

319 
	$__°πﬁ_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

320 **
__ª°ri˘
 
__íd±r
,

321 
__ba£
, 
__group
)

322 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

324 
__exã∫_ölöe
 
ötmax_t


325 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

326 
ba£
))

328  
	`__°πﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

329 
	}
}

331 
	$__°πoul_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

332 ** 
__ª°ri˘
 
__íd±r
,

333 
__ba£
, 
__group
)

334 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

336 
__exã∫_ölöe
 
uötmax_t


337 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

338 
ba£
))

340  
	`__°πoul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

341 
	}
}

343 
	$__wc°ﬁ_öã∫Æ
 (c⁄° 
__gwch¨_t
 * 
__ª°ri˘
 
__≈å
,

344 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

345 
__ba£
, 
__group
)

346 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

348 
__exã∫_ölöe
 
ötmax_t


349 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

350 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

352  
	`__wc°ﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

353 
	}
}

355 
	$__wc°oul_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

356 
__ª°ri˘
 
__≈å
,

357 
__gwch¨_t
 **

358 
__ª°ri˘
 
__íd±r
,

359 
__ba£
, 
__group
)

360 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

362 
__exã∫_ölöe
 
uötmax_t


363 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

364 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

366  
	`__wc°oul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

367 
	}
}

371 
__exãnsi⁄__


372 
	$__°πﬁl_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

373 **
__ª°ri˘
 
__íd±r
,

374 
__ba£
, 
__group
)

375 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

377 
__exã∫_ölöe
 
ötmax_t


378 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

379 
ba£
))

381  
	`__°πﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

382 
	}
}

384 
__exãnsi⁄__


385 
	$__°πouŒ_öã∫Æ
 (const *

386 
__ª°ri˘
 
__≈å
,

388 
__ª°ri˘
 
__íd±r
,

389 
__ba£
,

390 
__group
)

391 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

393 
__exã∫_ölöe
 
uötmax_t


394 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

395 
ba£
))

397  
	`__°πouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

398 
	}
}

400 
__exãnsi⁄__


401 
	$__wc°ﬁl_öã∫Æ
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

402 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

403 
__ba£
, 
__group
)

404 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

406 
__exã∫_ölöe
 
ötmax_t


407 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

408 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

410  
	`__wc°ﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

411 
	}
}

414 
__exãnsi⁄__


415 
	$__wc°ouŒ_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

416 
__ª°ri˘
 
__≈å
,

417 
__gwch¨_t
 **

418 
__ª°ri˘
 
__íd±r
,

419 
__ba£
,

420 
__group
)

421 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

423 
__exã∫_ölöe
 
uötmax_t


424 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

425 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

427  
	`__wc°ouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

428 
	}
}

433 
	g__END_DECLS


	@/usr/include/libintl.h

20 #i‚de‡
_LIBINTL_H


21 
	#_LIBINTL_H
 1

	)

23 
	~<„©uªs.h
>

27 
	#__USE_GNU_GETTEXT
 1

	)

31 
	#__GNU_GETTEXT_SUPPORTED_REVISION
(
maj‹
) \

32 ((
maj‹
Ë=0 ? 1 : -1)

	)

34 
__BEGIN_DECLS


39 *
	$gëãxt
 (c⁄° *
__msgid
)

40 
__THROW
 
	`__©åibuã_f‹m©_¨g__
 (1);

44 *
	$dgëãxt
 (c⁄° *
__domaö«me
, c⁄° *
__msgid
)

45 
__THROW
 
	`__©åibuã_f‹m©_¨g__
 (2);

46 *
	$__dgëãxt
 (c⁄° *
__domaö«me
, c⁄° *
__msgid
)

47 
__THROW
 
	`__©åibuã_f‹m©_¨g__
 (2);

51 *
	$dcgëãxt
 (c⁄° *
__domaö«me
,

52 c⁄° *
__msgid
, 
__ˇãg‹y
)

53 
__THROW
 
	`__©åibuã_f‹m©_¨g__
 (2);

54 *
	$__dcgëãxt
 (c⁄° *
__domaö«me
,

55 c⁄° *
__msgid
, 
__ˇãg‹y
)

56 
__THROW
 
	`__©åibuã_f‹m©_¨g__
 (2);

61 *
	$ngëãxt
 (c⁄° *
__msgid1
, c⁄° *
__msgid2
,

62 
__n
)

63 
__THROW
 
	$__©åibuã_f‹m©_¨g__
 (1Ë
	`__©åibuã_f‹m©_¨g__
 (2);

67 *
	$dngëãxt
 (c⁄° *
__domaö«me
, c⁄° *
__msgid1
,

68 c⁄° *
__msgid2
, 
__n
)

69 
__THROW
 
	$__©åibuã_f‹m©_¨g__
 (2Ë
	`__©åibuã_f‹m©_¨g__
 (3);

73 *
	$d˙gëãxt
 (c⁄° *
__domaö«me
, c⁄° *
__msgid1
,

74 c⁄° *
__msgid2
, 
__n
,

75 
__ˇãg‹y
)

76 
__THROW
 
	$__©åibuã_f‹m©_¨g__
 (2Ë
	`__©åibuã_f‹m©_¨g__
 (3);

82 *
	$ãxtdomaö
 (c⁄° *
__domaö«me
Ë
__THROW
;

86 *
	$bödãxtdomaö
 (c⁄° *
__domaö«me
,

87 c⁄° *
__dú«me
Ë
__THROW
;

91 *
	$böd_ãxtdomaö_code£t
 (c⁄° *
__domaö«me
,

92 c⁄° *
__code£t
Ë
__THROW
;

96 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


99 
	#__√ed_NULL


	)

100 
	~<°ddef.h
>

103 
	~<loˇÀ.h
>

109 
	#gëãxt
(
msgid
Ë
	`dgëãxt
 (
NULL
, msgid)

	)

111 
	#dgëãxt
(
domaö«me
, 
msgid
) \

112 
	`dcgëãxt
 (
domaö«me
, 
msgid
, 
LC_MESSAGES
)

	)

114 
	#ngëãxt
(
msgid1
, 
msgid2
, 
n
Ë
	`dngëãxt
 (
NULL
, msgid1, msgid2,Ç)

	)

116 
	#dngëãxt
(
domaö«me
, 
msgid1
, 
msgid2
, 
n
) \

117 
	`d˙gëãxt
 (
domaö«me
, 
msgid1
, 
msgid2
, 
n
, 
LC_MESSAGES
)

	)

121 
__END_DECLS


	@/usr/include/limits.h

23 #i‚de‡
_LIBC_LIMITS_H_


24 
	#_LIBC_LIMITS_H_
 1

	)

26 
	~<„©uªs.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

42 #i‚de‡
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<bôs/w‹dsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifde‡
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #i‡
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #i‡
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifde‡
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


124 #ö˛ude_√xà<
limôs
.
h
>

130 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__


131 #i‚de‡
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #i‚de‡
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #i‚de‡
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

142 #ifdef 
__USE_POSIX


144 
	~<bôs/posix1_lim.h
>

147 #ifdef 
__USE_POSIX2


148 
	~<bôs/posix2_lim.h
>

151 #ifdef 
__USE_XOPEN


152 
	~<bôs/x›í_lim.h
>

	@/usr/include/linux/filter.h

5 #i‚de‡
__LINUX_FILTER_H__


6 
	#__LINUX_FILTER_H__


	)

9 
	~<löux/ty≥s.h
>

10 
	~<löux/bpf_comm⁄.h
>

15 
	#BPF_MAJOR_VERSION
 1

	)

16 
	#BPF_MINOR_VERSION
 1

	)

23 
	ssock_fûãr
 {

24 
__u16
 
	mcode
;

25 
__u8
 
	mjt
;

26 
__u8
 
	mjf
;

27 
__u32
 
	mk
;

30 
	ssock_Ârog
 {

31 
	mÀn
;

32 
sock_fûãr
 *
	mfûãr
;

36 
	#BPF_RVAL
(
code
Ë((codeË& 0x18)

	)

37 
	#BPF_A
 0x10

	)

40 
	#BPF_MISCOP
(
code
Ë((codeË& 0xf8)

	)

41 
	#BPF_TAX
 0x00

	)

42 
	#BPF_TXA
 0x80

	)

47 #i‚de‡
BPF_STMT


48 
	#BPF_STMT
(
code
, 
k
Ë{ ()(code), 0, 0, k }

	)

50 #i‚de‡
BPF_JUMP


51 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
Ë{ ()(code), jt, jf, k }

	)

57 
	#BPF_MEMWORDS
 16

	)

64 
	#SKF_AD_OFF
 (-0x1000)

	)

65 
	#SKF_AD_PROTOCOL
 0

	)

66 
	#SKF_AD_PKTTYPE
 4

	)

67 
	#SKF_AD_IFINDEX
 8

	)

68 
	#SKF_AD_NLATTR
 12

	)

69 
	#SKF_AD_NLATTR_NEST
 16

	)

70 
	#SKF_AD_MARK
 20

	)

71 
	#SKF_AD_QUEUE
 24

	)

72 
	#SKF_AD_HATYPE
 28

	)

73 
	#SKF_AD_RXHASH
 32

	)

74 
	#SKF_AD_CPU
 36

	)

75 
	#SKF_AD_ALU_XOR_X
 40

	)

76 
	#SKF_AD_VLAN_TAG
 44

	)

77 
	#SKF_AD_VLAN_TAG_PRESENT
 48

	)

78 
	#SKF_AD_PAY_OFFSET
 52

	)

79 
	#SKF_AD_MAX
 56

	)

80 
	#SKF_NET_OFF
 (-0x100000)

	)

81 
	#SKF_LL_OFF
 (-0x200000)

	)

	@/usr/include/linux/ipv6_route.h

13 #i‚de‡
_LINUX_IPV6_ROUTE_H


14 
	#_LINUX_IPV6_ROUTE_H


	)

16 
	~<löux/ty≥s.h
>

18 
	#RTF_DEFAULT
 0x00010000

	)

19 
	#RTF_ALLONLINK
 0x00020000

	)

21 
	#RTF_ADDRCONF
 0x00040000

	)

22 
	#RTF_PREFIX_RT
 0x00080000

	)

23 
	#RTF_ANYCAST
 0x00100000

	)

25 
	#RTF_NONEXTHOP
 0x00200000

	)

26 
	#RTF_EXPIRES
 0x00400000

	)

28 
	#RTF_ROUTEINFO
 0x00800000

	)

30 
	#RTF_CACHE
 0x01000000

	)

31 
	#RTF_FLOW
 0x02000000

	)

32 
	#RTF_POLICY
 0x04000000

	)

34 
	#RTF_PREF
(
¥ef
Ë(’ªfË<< 27)

	)

35 
	#RTF_PREF_MASK
 0x18000000

	)

37 
	#RTF_PCPU
 0x40000000

	)

38 
	#RTF_LOCAL
 0x80000000

	)

41 
	sö6_πmsg
 {

42 
ö6_addr
 
	mπmsg_d°
;

43 
ö6_addr
 
	mπmsg_§c
;

44 
ö6_addr
 
	mπmsg_g©eway
;

45 
__u32
 
	mπmsg_ty≥
;

46 
__u16
 
	mπmsg_d°_Àn
;

47 
__u16
 
	mπmsg_§c_Àn
;

48 
__u32
 
	mπmsg_mëric
;

49 
	mπmsg_öfo
;

50 
__u32
 
	mπmsg_Êags
;

51 
	mπmsg_ifödex
;

54 
	#RTMSG_NEWDEVICE
 0x11

	)

55 
	#RTMSG_DELDEVICE
 0x12

	)

56 
	#RTMSG_NEWROUTE
 0x21

	)

57 
	#RTMSG_DELROUTE
 0x22

	)

59 
	#IP6_RT_PRIO_USER
 1024

	)

60 
	#IP6_RT_PRIO_ADDRCONF
 256

	)

	@/usr/include/linux/netlink.h

1 #i‚de‡
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<löux/kî√l.h
>

5 
	~<löux/sockë.h
>

6 
	~<löux/ty≥s.h
>

8 
	#NETLINK_ROUTE
 0

	)

9 
	#NETLINK_UNUSED
 1

	)

10 
	#NETLINK_USERSOCK
 2

	)

11 
	#NETLINK_FIREWALL
 3

	)

12 
	#NETLINK_SOCK_DIAG
 4

	)

13 
	#NETLINK_NFLOG
 5

	)

14 
	#NETLINK_XFRM
 6

	)

15 
	#NETLINK_SELINUX
 7

	)

16 
	#NETLINK_ISCSI
 8

	)

17 
	#NETLINK_AUDIT
 9

	)

18 
	#NETLINK_FIB_LOOKUP
 10

	)

19 
	#NETLINK_CONNECTOR
 11

	)

20 
	#NETLINK_NETFILTER
 12

	)

21 
	#NETLINK_IP6_FW
 13

	)

22 
	#NETLINK_DNRTMSG
 14

	)

23 
	#NETLINK_KOBJECT_UEVENT
 15

	)

24 
	#NETLINK_GENERIC
 16

	)

26 
	#NETLINK_SCSITRANSPORT
 18

	)

27 
	#NETLINK_ECRYPTFS
 19

	)

28 
	#NETLINK_RDMA
 20

	)

29 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

33 
	#MAX_LINKS
 32

	)

35 
	ssockaddr_∆
 {

36 
__kî√l_ß_Ámûy_t
 
	m∆_Ámûy
;

37 
	m∆_∑d
;

38 
__u32
 
	m∆_pid
;

39 
__u32
 
	m∆_groups
;

42 
	s∆msghdr
 {

43 
__u32
 
	m∆msg_Àn
;

44 
__u16
 
	m∆msg_ty≥
;

45 
__u16
 
	m∆msg_Êags
;

46 
__u32
 
	m∆msg_£q
;

47 
__u32
 
	m∆msg_pid
;

52 
	#NLM_F_REQUEST
 1

	)

53 
	#NLM_F_MULTI
 2

	)

54 
	#NLM_F_ACK
 4

	)

55 
	#NLM_F_ECHO
 8

	)

56 
	#NLM_F_DUMP_INTR
 16

	)

59 
	#NLM_F_ROOT
 0x100

	)

60 
	#NLM_F_MATCH
 0x200

	)

61 
	#NLM_F_ATOMIC
 0x400

	)

62 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

65 
	#NLM_F_REPLACE
 0x100

	)

66 
	#NLM_F_EXCL
 0x200

	)

67 
	#NLM_F_CREATE
 0x400

	)

68 
	#NLM_F_APPEND
 0x800

	)

79 
	#NLMSG_ALIGNTO
 4U

	)

80 
	#NLMSG_ALIGN
(
Àn
Ë–(÷í)+
NLMSG_ALIGNTO
-1Ë& ~(NLMSG_ALIGNTO-1Ë)

	)

81 
	#NLMSG_HDRLEN
 ((Ë
	`NLMSG_ALIGN
((
∆msghdr
)))

	)

82 
	#NLMSG_LENGTH
(
Àn
Ë(÷íË+ 
NLMSG_HDRLEN
)

	)

83 
	#NLMSG_SPACE
(
Àn
Ë
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
÷í))

	)

84 
	#NLMSG_DATA
(
∆h
Ë((*)(((*ÍlhË+ 
	`NLMSG_LENGTH
(0)))

	)

85 
	#NLMSG_NEXT
(
∆h
,
Àn
Ë(÷íË-
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
), \

86 (
∆msghdr
*)(((*)(
∆h
)Ë+ 
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
)))

	)

87 
	#NLMSG_OK
(
∆h
,
Àn
Ë(÷íË>()(
∆msghdr
) && \

88 (
∆h
)->
∆msg_Àn
 >(
∆msghdr
) && \

89 (
∆h
)->
∆msg_Àn
 <(
Àn
))

	)

90 
	#NLMSG_PAYLOAD
(
∆h
,
Àn
Ë(“lh)->
∆msg_Àn
 - 
	`NLMSG_SPACE
(÷í)))

	)

92 
	#NLMSG_NOOP
 0x1

	)

93 
	#NLMSG_ERROR
 0x2

	)

94 
	#NLMSG_DONE
 0x3

	)

95 
	#NLMSG_OVERRUN
 0x4

	)

97 
	#NLMSG_MIN_TYPE
 0x10

	)

99 
	s∆msgîr
 {

100 
	mîr‹
;

101 
∆msghdr
 
	mmsg
;

104 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

105 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

106 
	#NETLINK_PKTINFO
 3

	)

107 
	#NETLINK_BROADCAST_ERROR
 4

	)

108 
	#NETLINK_NO_ENOBUFS
 5

	)

109 
	#NETLINK_RX_RING
 6

	)

110 
	#NETLINK_TX_RING
 7

	)

111 
	#NETLINK_LISTEN_ALL_NSID
 8

	)

113 
	s∆_pktöfo
 {

114 
__u32
 
	mgroup
;

117 
	s∆_mm≠_ªq
 {

118 
	mnm_block_size
;

119 
	mnm_block_ƒ
;

120 
	mnm_‰ame_size
;

121 
	mnm_‰ame_ƒ
;

124 
	s∆_mm≠_hdr
 {

125 
	mnm_°©us
;

126 
	mnm_Àn
;

127 
__u32
 
	mnm_group
;

129 
__u32
 
	mnm_pid
;

130 
__u32
 
	mnm_uid
;

131 
__u32
 
	mnm_gid
;

134 
	e∆_mm≠_°©us
 {

135 
	mNL_MMAP_STATUS_UNUSED
,

136 
	mNL_MMAP_STATUS_RESERVED
,

137 
	mNL_MMAP_STATUS_VALID
,

138 
	mNL_MMAP_STATUS_COPY
,

139 
	mNL_MMAP_STATUS_SKIP
,

142 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

143 
	#NL_MMAP_MSG_ALIGN
(
sz
Ë
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

144 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
∆_mm≠_hdr
))

	)

146 
	#NET_MAJOR
 36

	)

149 
	mNETLINK_UNCONNECTED
 = 0,

150 
	mNETLINK_CONNECTED
,

162 
	s∆©å
 {

163 
__u16
 
	m∆a_Àn
;

164 
__u16
 
	m∆a_ty≥
;

177 
	#NLA_F_NESTED
 (1 << 15)

	)

178 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

179 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

181 
	#NLA_ALIGNTO
 4

	)

182 
	#NLA_ALIGN
(
Àn
Ë((÷íË+ 
NLA_ALIGNTO
 - 1Ë& ~(NLA_ALIGNTO - 1))

	)

183 
	#NLA_HDRLEN
 ((Ë
	`NLA_ALIGN
((
∆©å
)))

	)

198 
	s∆a_bôfõld32
 {

199 
__u32
 
	mvÆue
;

200 
__u32
 
	m£À˘‹
;

	@/usr/include/linux/rtnetlink.h

1 #i‚de‡
__LINUX_RTNETLINK_H


2 
	#__LINUX_RTNETLINK_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

6 
	~<löux/if_lök.h
>

7 
	~<löux/if_addr.h
>

8 
	~<löux/√ighbour.h
>

13 
	#RTNL_FAMILY_IPMR
 128

	)

14 
	#RTNL_FAMILY_IP6MR
 129

	)

15 
	#RTNL_FAMILY_MAX
 129

	)

24 
	mRTM_BASE
 = 16,

25 
	#RTM_BASE
 
RTM_BASE


	)

27 
	mRTM_NEWLINK
 = 16,

28 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

29 
	mRTM_DELLINK
,

30 
	#RTM_DELLINK
 
RTM_DELLINK


	)

31 
	mRTM_GETLINK
,

32 
	#RTM_GETLINK
 
RTM_GETLINK


	)

33 
	mRTM_SETLINK
,

34 
	#RTM_SETLINK
 
RTM_SETLINK


	)

36 
	mRTM_NEWADDR
 = 20,

37 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

38 
	mRTM_DELADDR
,

39 
	#RTM_DELADDR
 
RTM_DELADDR


	)

40 
	mRTM_GETADDR
,

41 
	#RTM_GETADDR
 
RTM_GETADDR


	)

43 
	mRTM_NEWROUTE
 = 24,

44 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

45 
	mRTM_DELROUTE
,

46 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

47 
	mRTM_GETROUTE
,

48 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

50 
	mRTM_NEWNEIGH
 = 28,

51 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

52 
	mRTM_DELNEIGH
,

53 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

54 
	mRTM_GETNEIGH
,

55 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

57 
	mRTM_NEWRULE
 = 32,

58 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

59 
	mRTM_DELRULE
,

60 
	#RTM_DELRULE
 
RTM_DELRULE


	)

61 
	mRTM_GETRULE
,

62 
	#RTM_GETRULE
 
RTM_GETRULE


	)

64 
	mRTM_NEWQDISC
 = 36,

65 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

66 
	mRTM_DELQDISC
,

67 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

68 
	mRTM_GETQDISC
,

69 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

71 
	mRTM_NEWTCLASS
 = 40,

72 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

73 
	mRTM_DELTCLASS
,

74 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

75 
	mRTM_GETTCLASS
,

76 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

78 
	mRTM_NEWTFILTER
 = 44,

79 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

80 
	mRTM_DELTFILTER
,

81 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

82 
	mRTM_GETTFILTER
,

83 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

85 
	mRTM_NEWACTION
 = 48,

86 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

87 
	mRTM_DELACTION
,

88 
	#RTM_DELACTION
 
RTM_DELACTION


	)

89 
	mRTM_GETACTION
,

90 
	#RTM_GETACTION
 
RTM_GETACTION


	)

92 
	mRTM_NEWPREFIX
 = 52,

93 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

95 
	mRTM_GETMULTICAST
 = 58,

96 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

98 
	mRTM_GETANYCAST
 = 62,

99 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

101 
	mRTM_NEWNEIGHTBL
 = 64,

102 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

103 
	mRTM_GETNEIGHTBL
 = 66,

104 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

105 
	mRTM_SETNEIGHTBL
,

106 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

108 
	mRTM_NEWNDUSEROPT
 = 68,

109 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

111 
	mRTM_NEWADDRLABEL
 = 72,

112 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

113 
	mRTM_DELADDRLABEL
,

114 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

115 
	mRTM_GETADDRLABEL
,

116 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

118 
	mRTM_GETDCB
 = 78,

119 
	#RTM_GETDCB
 
RTM_GETDCB


	)

120 
	mRTM_SETDCB
,

121 
	#RTM_SETDCB
 
RTM_SETDCB


	)

123 
	mRTM_NEWNETCONF
 = 80,

124 
	#RTM_NEWNETCONF
 
RTM_NEWNETCONF


	)

125 
	mRTM_GETNETCONF
 = 82,

126 
	#RTM_GETNETCONF
 
RTM_GETNETCONF


	)

128 
	mRTM_NEWMDB
 = 84,

129 
	#RTM_NEWMDB
 
RTM_NEWMDB


	)

130 
	mRTM_DELMDB
 = 85,

131 
	#RTM_DELMDB
 
RTM_DELMDB


	)

132 
	mRTM_GETMDB
 = 86,

133 
	#RTM_GETMDB
 
RTM_GETMDB


	)

135 
	mRTM_NEWNSID
 = 88,

136 
	#RTM_NEWNSID
 
RTM_NEWNSID


	)

137 
	mRTM_DELNSID
 = 89,

138 
	#RTM_DELNSID
 
RTM_DELNSID


	)

139 
	mRTM_GETNSID
 = 90,

140 
	#RTM_GETNSID
 
RTM_GETNSID


	)

142 
	mRTM_NEWSTATS
 = 92,

143 
	#RTM_NEWSTATS
 
RTM_NEWSTATS


	)

144 
	mRTM_GETSTATS
 = 94,

145 
	#RTM_GETSTATS
 
RTM_GETSTATS


	)

147 
	m__RTM_MAX
,

148 
	#RTM_MAX
 (((
__RTM_MAX
 + 3Ë& ~3Ë- 1)

	)

151 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

152 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

153 
	#RTM_FAM
(
cmd
Ë(((cmdË- 
RTM_BASE
Ë>> 2)

	)

161 
	sπ©å
 {

162 
	mπa_Àn
;

163 
	mπa_ty≥
;

168 
	#RTA_ALIGNTO
 4

	)

169 
	#RTA_ALIGN
(
Àn
Ë–(÷í)+
RTA_ALIGNTO
-1Ë& ~(RTA_ALIGNTO-1Ë)

	)

170 
	#RTA_OK
(
πa
,
Àn
Ë(÷íË>()(
π©å
) && \

171 (
πa
)->
πa_Àn
 >(
π©å
) && \

172 (
πa
)->
πa_Àn
 <(
Àn
))

	)

173 
	#RTA_NEXT
(
πa
,
©åÀn
Ë(◊âæíË-
	`RTA_ALIGN
(‘è)->
πa_Àn
), \

174 (
π©å
*)(((*)(
πa
)Ë+ 
	`RTA_ALIGN
(‘è)->
πa_Àn
)))

	)

175 
	#RTA_LENGTH
(
Àn
Ë(
	`RTA_ALIGN
((
π©å
)Ë+ (Àn))

	)

176 
	#RTA_SPACE
(
Àn
Ë
	`RTA_ALIGN
(
	`RTA_LENGTH
÷í))

	)

177 
	#RTA_DATA
(
πa
Ë((*)(((*)‘è)Ë+ 
	`RTA_LENGTH
(0)))

	)

178 
	#RTA_PAYLOAD
(
πa
Ë(()(‘è)->
πa_Àn
Ë- 
	`RTA_LENGTH
(0))

	)

187 
	sπmsg
 {

188 
	mπm_Ámûy
;

189 
	mπm_d°_Àn
;

190 
	mπm_§c_Àn
;

191 
	mπm_tos
;

193 
	mπm_èbÀ
;

194 
	mπm_¥Ÿocﬁ
;

195 
	mπm_sc›e
;

196 
	mπm_ty≥
;

198 
	mπm_Êags
;

204 
	mRTN_UNSPEC
,

205 
	mRTN_UNICAST
,

206 
	mRTN_LOCAL
,

207 
	mRTN_BROADCAST
,

209 
	mRTN_ANYCAST
,

211 
	mRTN_MULTICAST
,

212 
	mRTN_BLACKHOLE
,

213 
	mRTN_UNREACHABLE
,

214 
	mRTN_PROHIBIT
,

215 
	mRTN_THROW
,

216 
	mRTN_NAT
,

217 
	mRTN_XRESOLVE
,

218 
	m__RTN_MAX


221 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

226 
	#RTPROT_UNSPEC
 0

	)

227 
	#RTPROT_REDIRECT
 1

	)

229 
	#RTPROT_KERNEL
 2

	)

230 
	#RTPROT_BOOT
 3

	)

231 
	#RTPROT_STATIC
 4

	)

240 
	#RTPROT_GATED
 8

	)

241 
	#RTPROT_RA
 9

	)

242 
	#RTPROT_MRT
 10

	)

243 
	#RTPROT_ZEBRA
 11

	)

244 
	#RTPROT_BIRD
 12

	)

245 
	#RTPROT_DNROUTED
 13

	)

246 
	#RTPROT_XORP
 14

	)

247 
	#RTPROT_NTK
 15

	)

248 
	#RTPROT_DHCP
 16

	)

249 
	#RTPROT_MROUTED
 17

	)

262 
	eπ_sc›e_t
 {

263 
	mRT_SCOPE_UNIVERSE
=0,

265 
	mRT_SCOPE_SITE
=200,

266 
	mRT_SCOPE_LINK
=253,

267 
	mRT_SCOPE_HOST
=254,

268 
	mRT_SCOPE_NOWHERE
=255

273 
	#RTM_F_NOTIFY
 0x100

	)

274 
	#RTM_F_CLONED
 0x200

	)

275 
	#RTM_F_EQUALIZE
 0x400

	)

276 
	#RTM_F_PREFIX
 0x800

	)

280 
	eπ_˛ass_t
 {

281 
	mRT_TABLE_UNSPEC
=0,

283 
	mRT_TABLE_COMPAT
=252,

284 
	mRT_TABLE_DEFAULT
=253,

285 
	mRT_TABLE_MAIN
=254,

286 
	mRT_TABLE_LOCAL
=255,

287 
	mRT_TABLE_MAX
=0xFFFFFFFF

293 
	eπ©å_ty≥_t
 {

294 
	mRTA_UNSPEC
,

295 
	mRTA_DST
,

296 
	mRTA_SRC
,

297 
	mRTA_IIF
,

298 
	mRTA_OIF
,

299 
	mRTA_GATEWAY
,

300 
	mRTA_PRIORITY
,

301 
	mRTA_PREFSRC
,

302 
	mRTA_METRICS
,

303 
	mRTA_MULTIPATH
,

304 
	mRTA_PROTOINFO
,

305 
	mRTA_FLOW
,

306 
	mRTA_CACHEINFO
,

307 
	mRTA_SESSION
,

308 
	mRTA_MP_ALGO
,

309 
	mRTA_TABLE
,

310 
	mRTA_MARK
,

311 
	mRTA_MFC_STATS
,

312 
	m__RH_RESERVED_RTA_VIA
,

313 
	m__RH_RESERVED_RTA_NEWDST
,

314 
	mRTA_PREF
,

315 
	mRTA_ENCAP_TYPE
,

316 
	mRTA_ENCAP
,

317 
	mRTA_EXPIRES
,

318 
	mRTA_PAD
,

319 
	m__RTA_MAX


322 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

324 
	#RTM_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
πmsg
))))

	)

325 
	#RTM_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
πmsg
))

	)

336 
	sπ√xth›
 {

337 
	mπnh_Àn
;

338 
	mπnh_Êags
;

339 
	mπnh_h›s
;

340 
	mπnh_ifödex
;

345 
	#RTNH_F_DEAD
 1

	)

346 
	#RTNH_F_PERVASIVE
 2

	)

347 
	#RTNH_F_ONLINK
 4

	)

348 
	#RTNH_F_OFFLOAD
 8

	)

352 
	#RTNH_ALIGNTO
 4

	)

353 
	#RTNH_ALIGN
(
Àn
Ë–(÷í)+
RTNH_ALIGNTO
-1Ë& ~(RTNH_ALIGNTO-1Ë)

	)

354 
	#RTNH_OK
(
πnh
,
Àn
Ë(‘äh)->
πnh_Àn
 >(
π√xth›
) && \

355 (()(
πnh
)->
πnh_Àn
Ë<(
Àn
))

	)

356 
	#RTNH_NEXT
(
πnh
Ë((
π√xth›
*)(((*)‘äh)Ë+ 
	`RTNH_ALIGN
(‘äh)->
πnh_Àn
)))

	)

357 
	#RTNH_LENGTH
(
Àn
Ë(
	`RTNH_ALIGN
((
π√xth›
)Ë+ (Àn))

	)

358 
	#RTNH_SPACE
(
Àn
Ë
	`RTNH_ALIGN
(
	`RTNH_LENGTH
÷í))

	)

359 
	#RTNH_DATA
(
πnh
Ë((
π©å
*)(((*)‘äh)Ë+ 
	`RTNH_LENGTH
(0)))

	)

363 
	sπa_ˇcheöfo
 {

364 
__u32
 
	mπa_˛¡ªf
;

365 
__u32
 
	mπa_œ°u£
;

366 
__s32
 
	mπa_expúes
;

367 
__u32
 
	mπa_îr‹
;

368 
__u32
 
	mπa_u£d
;

370 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

371 
__u32
 
	mπa_id
;

372 
__u32
 
	mπa_ts
;

373 
__u32
 
	mπa_tßge
;

379 
	mRTAX_UNSPEC
,

380 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

381 
	mRTAX_LOCK
,

382 
	#RTAX_LOCK
 
RTAX_LOCK


	)

383 
	mRTAX_MTU
,

384 
	#RTAX_MTU
 
RTAX_MTU


	)

385 
	mRTAX_WINDOW
,

386 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

387 
	mRTAX_RTT
,

388 
	#RTAX_RTT
 
RTAX_RTT


	)

389 
	mRTAX_RTTVAR
,

390 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

391 
	mRTAX_SSTHRESH
,

392 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

393 
	mRTAX_CWND
,

394 
	#RTAX_CWND
 
RTAX_CWND


	)

395 
	mRTAX_ADVMSS
,

396 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

397 
	mRTAX_REORDERING
,

398 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

399 
	mRTAX_HOPLIMIT
,

400 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

401 
	mRTAX_INITCWND
,

402 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

403 
	mRTAX_FEATURES
,

404 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

405 
	mRTAX_RTO_MIN
,

406 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

407 
	mRTAX_INITRWND
,

408 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

409 
	mRTAX_QUICKACK
,

410 
	#RTAX_QUICKACK
 
RTAX_QUICKACK


	)

411 
	mRTAX_CC_ALGO
,

412 
	#RTAX_CC_ALGO
 
RTAX_CC_ALGO


	)

413 
	mRTAX_RESERVED2
,

414 
	mRTAX_RESERVED3
,

415 
	mRTAX_RESERVED4
,

416 
	mRTAX_RESERVED5
,

417 
	mRTAX_RESERVED6
,

418 
	mRTAX_RESERVED7
,

419 
	mRTAX_RESERVED8
,

420 
	m__RTAX_MAX


423 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

425 
	#RTAX_FEATURE_ECN
 (1 << 0)

	)

426 
	#RTAX_FEATURE_SACK
 (1 << 1)

	)

427 
	#RTAX_FEATURE_TIMESTAMP
 (1 << 2)

	)

428 
	#RTAX_FEATURE_ALLFRAG
 (1 << 3)

	)

430 
	#RTAX_FEATURE_MASK
 (
RTAX_FEATURE_ECN
 | 
RTAX_FEATURE_SACK
 | \

431 
RTAX_FEATURE_TIMESTAMP
 | 
RTAX_FEATURE_ALLFRAG
)

	)

433 
	sπa_£ssi⁄
 {

434 
__u8
 
	m¥Ÿo
;

435 
__u8
 
	m∑d1
;

436 
__u16
 
	m∑d2
;

440 
__u16
 
	m•‹t
;

441 
__u16
 
	mdp‹t
;

442 } 
	mp‹ts
;

445 
__u8
 
	mty≥
;

446 
__u8
 
	mcode
;

447 
__u16
 
	midít
;

448 } 
	micm±
;

450 
__u32
 
	m•i
;

451 } 
	mu
;

454 
	sπa_mfc_°©s
 {

455 
__u64
 
	mmfcs_∑ckës
;

456 
__u64
 
	mmfcs_byãs
;

457 
__u64
 
	mmfcs_wr⁄g_if
;

464 
	sπgímsg
 {

465 
	mπgí_Ámûy
;

477 
	siföfomsg
 {

478 
	mifi_Ámûy
;

479 
	m__ifi_∑d
;

480 
	mifi_ty≥
;

481 
	mifi_ödex
;

482 
	mifi_Êags
;

483 
	mifi_ch™ge
;

490 
	s¥efixmsg
 {

491 
	m¥efix_Ámûy
;

492 
	m¥efix_∑d1
;

493 
	m¥efix_∑d2
;

494 
	m¥efix_ifödex
;

495 
	m¥efix_ty≥
;

496 
	m¥efix_Àn
;

497 
	m¥efix_Êags
;

498 
	m¥efix_∑d3
;

503 
	mPREFIX_UNSPEC
,

504 
	mPREFIX_ADDRESS
,

505 
	mPREFIX_CACHEINFO
,

506 
	m__PREFIX_MAX


509 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

511 
	s¥efix_ˇcheöfo
 {

512 
__u32
 
	m¥e„ºed_time
;

513 
__u32
 
	mvÆid_time
;

521 
	stcmsg
 {

522 
	mtcm_Ámûy
;

523 
	mtcm__∑d1
;

524 
	mtcm__∑d2
;

525 
	mtcm_ifödex
;

526 
__u32
 
	mtcm_h™dÀ
;

527 
__u32
 
	mtcm_∑ª¡
;

531 
	#tcm_block_ödex
 
tcm_∑ª¡


	)

532 
__u32
 
	mtcm_öfo
;

539 
	#TCM_IFINDEX_MAGIC_BLOCK
 (0xFFFFFFFFU)

	)

542 
	mTCA_UNSPEC
,

543 
	mTCA_KIND
,

544 
	mTCA_OPTIONS
,

545 
	mTCA_STATS
,

546 
	mTCA_XSTATS
,

547 
	mTCA_RATE
,

548 
	mTCA_FCNT
,

549 
	mTCA_STATS2
,

550 
	mTCA_STAB
,

551 
	mTCA_PAD
,

552 
	mTCA_DUMP_INVISIBLE
,

553 
	mTCA_CHAIN
,

554 
	mTCA_HW_OFFLOAD
,

555 
	mTCA_INGRESS_BLOCK
,

556 
	mTCA_EGRESS_BLOCK
,

557 
	m__TCA_MAX


560 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

562 
	#TCA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

563 
	#TCA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
tcmsg
))

	)

569 
	sndu£r›tmsg
 {

570 
	mndu£r›t_Ámûy
;

571 
	mndu£r›t_∑d1
;

572 
	mndu£r›t_›ts_Àn
;

573 
	mndu£r›t_ifödex
;

574 
__u8
 
	mndu£r›t_icmp_ty≥
;

575 
__u8
 
	mndu£r›t_icmp_code
;

576 
	mndu£r›t_∑d2
;

577 
	mndu£r›t_∑d3
;

582 
	mNDUSEROPT_UNSPEC
,

583 
	mNDUSEROPT_SRCADDR
,

584 
	m__NDUSEROPT_MAX


587 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

590 
	#RTMGRP_LINK
 1

	)

591 
	#RTMGRP_NOTIFY
 2

	)

592 
	#RTMGRP_NEIGH
 4

	)

593 
	#RTMGRP_TC
 8

	)

595 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

596 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

597 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

598 
	#RTMGRP_IPV4_RULE
 0x80

	)

600 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

601 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

602 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

603 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

605 
	#RTMGRP_DEC√t_IFADDR
 0x1000

	)

606 
	#RTMGRP_DEC√t_ROUTE
 0x4000

	)

608 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

611 
	eπ√éök_groups
 {

612 
	mRTNLGRP_NONE
,

613 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

614 
	mRTNLGRP_LINK
,

615 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

616 
	mRTNLGRP_NOTIFY
,

617 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

618 
	mRTNLGRP_NEIGH
,

619 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

620 
	mRTNLGRP_TC
,

621 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

622 
	mRTNLGRP_IPV4_IFADDR
,

623 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

624 
	mRTNLGRP_IPV4_MROUTE
,

625 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

626 
	mRTNLGRP_IPV4_ROUTE
,

627 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

628 
	mRTNLGRP_IPV4_RULE
,

629 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

630 
	mRTNLGRP_IPV6_IFADDR
,

631 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

632 
	mRTNLGRP_IPV6_MROUTE
,

633 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

634 
	mRTNLGRP_IPV6_ROUTE
,

635 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

636 
	mRTNLGRP_IPV6_IFINFO
,

637 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

638 
	mRTNLGRP_DEC√t_IFADDR
,

639 
	#RTNLGRP_DEC√t_IFADDR
 
RTNLGRP_DEC√t_IFADDR


	)

640 
	mRTNLGRP_NOP2
,

641 
	mRTNLGRP_DEC√t_ROUTE
,

642 
	#RTNLGRP_DEC√t_ROUTE
 
RTNLGRP_DEC√t_ROUTE


	)

643 
	mRTNLGRP_DEC√t_RULE
,

644 
	#RTNLGRP_DEC√t_RULE
 
RTNLGRP_DEC√t_RULE


	)

645 
	mRTNLGRP_NOP4
,

646 
	mRTNLGRP_IPV6_PREFIX
,

647 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

648 
	mRTNLGRP_IPV6_RULE
,

649 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

650 
	mRTNLGRP_ND_USEROPT
,

651 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

652 
	mRTNLGRP_PHONET_IFADDR
,

653 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

654 
	mRTNLGRP_PHONET_ROUTE
,

655 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

656 
	mRTNLGRP_DCB
,

657 
	#RTNLGRP_DCB
 
RTNLGRP_DCB


	)

658 
	mRTNLGRP_IPV4_NETCONF
,

659 
	#RTNLGRP_IPV4_NETCONF
 
RTNLGRP_IPV4_NETCONF


	)

660 
	mRTNLGRP_IPV6_NETCONF
,

661 
	#RTNLGRP_IPV6_NETCONF
 
RTNLGRP_IPV6_NETCONF


	)

662 
	mRTNLGRP_MDB
,

663 
	#RTNLGRP_MDB
 
RTNLGRP_MDB


	)

664 
	m__RH_RESERVED_RTNLGRP_MPLS_ROUTE
,

665 
	mRTNLGRP_NSID
,

666 
	#RTNLGRP_NSID
 
RTNLGRP_NSID


	)

667 
	m__RTNLGRP_MAX


669 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

672 
	stˇmsg
 {

673 
	mtˇ_Ámûy
;

674 
	mtˇ__∑d1
;

675 
	mtˇ__∑d2
;

679 
	mTCA_ROOT_UNSPEC
,

680 
	mTCA_ROOT_TAB
,

681 
	#TCA_ACT_TAB
 
TCA_ROOT_TAB


	)

682 
	#TCAA_MAX
 
TCA_ROOT_TAB


	)

683 
	mTCA_ROOT_FLAGS
,

684 
	mTCA_ROOT_COUNT
,

685 
	mTCA_ROOT_TIME_DELTA
,

686 
	m__TCA_ROOT_MAX
,

687 
	#TCA_ROOT_MAX
 (
__TCA_ROOT_MAX
 - 1)

	)

690 
	#TA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
tˇmsg
))))

	)

691 
	#TA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
tˇmsg
))

	)

699 
	#TCA_FLAG_LARGE_DUMP_ON
 (1 << 0)

	)

702 
	#RTEXT_FILTER_VF
 (1 << 0)

	)

703 
	#RTEXT_FILTER_BRVLAN
 (1 << 1)

	)

704 
	#RTEXT_FILTER_BRVLAN_COMPRESSED
 (1 << 2)

	)

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

46 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

48 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 199168

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
Ë((◊Ë<< 16Ë+ ((bË<< 8Ë+ (c))

	)

3 
	#RHEL_MAJOR
 7

	)

4 
	#RHEL_MINOR
 6

	)

5 
	#RHEL_RELEASE_VERSION
(
a
,
b
Ë((◊Ë<< 8Ë+ (b))

	)

6 
	#RHEL_RELEASE_CODE
 1798

	)

7 
	#RHEL_RELEASE
 "957.5.1"

	)

8 
	#KERNEL_HEADERS_CHECKSUM
 "37ØÁ9e1˚9776ed27088e0d7a51412óìó89"

	)

	@/usr/include/malloc.h

20 #i‚de‡
_MALLOC_H


21 
	#_MALLOC_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<°ddef.h
>

25 
	~<°dio.h
>

26 
	#__mÆloc_±r_t
 *

	)

29 
	#__mÆloc_size_t
 
size_t


	)

30 
	#__mÆloc_±rdiff_t
 
±rdiff_t


	)

32 #ifde‡
__GNUC__


34 
	#__MALLOC_P
(
¨gs
Ë¨g†
__THROW


	)

37 
	#__MALLOC_PMT
(
¨gs
Ë
	)
¨gs

39 #ifde‡
_LIBC


40 
	#__MALLOC_HOOK_VOLATILE


	)

41 
	#__MALLOC_DEPRECATED


	)

43 
	#__MALLOC_HOOK_VOLATILE
 vﬁ©ûe

	)

44 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

49 
	#__MALLOC_P
(
¨gs
Ë
	)
¨gs

50 
	#__MALLOC_PMT
(
¨gs
Ë
	)
¨gs

51 
	#__MALLOC_HOOK_VOLATILE


	)

52 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

57 
__BEGIN_DECLS


60 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

63 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

64 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

71 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

72 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

75 
	$‰ì
 (*
__±r
Ë
__THROW
;

78 
	$c‰ì
 (*
__±r
Ë
__THROW
;

81 *
	$memÆign
 (
size_t
 
__Æignmít
, size_à
__size
)

82 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

85 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

89 * 
	$pvÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

93 *(*
__m‹ec‹e
Ë(
±rdiff_t
 
__size
);

96 *
	$__deÁu…_m‹ec‹e
 (
±rdiff_t
 
__size
)

97 
__THROW
 
__©åibuã_mÆloc__
;

101 
	smÆlöfo


103 
¨ía
;

104 
‹dblks
;

105 
smblks
;

106 
hblks
;

107 
hblkhd
;

108 
usmblks
;

109 
fsmblks
;

110 
u‹dblks
;

111 
f‹dblks
;

112 
kìpco°
;

116 
mÆlöfo
 
	$mÆlöfo
 (Ë
__THROW
;

119 #i‚de‡
M_MXFAST


120 
	#M_MXFAST
 1

	)

122 #i‚de‡
M_NLBLKS


123 
	#M_NLBLKS
 2

	)

125 #i‚de‡
M_GRAIN


126 
	#M_GRAIN
 3

	)

128 #i‚de‡
M_KEEP


129 
	#M_KEEP
 4

	)

133 
	#M_TRIM_THRESHOLD
 -1

	)

134 
	#M_TOP_PAD
 -2

	)

135 
	#M_MMAP_THRESHOLD
 -3

	)

136 
	#M_MMAP_MAX
 -4

	)

137 
	#M_CHECK_ACTION
 -5

	)

138 
	#M_PERTURB
 -6

	)

139 
	#M_ARENA_TEST
 -7

	)

140 
	#M_ARENA_MAX
 -8

	)

143 
	$mÆl›t
 (
__∑øm
, 
__vÆ
Ë
__THROW
;

147 
	$mÆloc_åim
 (
size_t
 
__∑d
Ë
__THROW
;

151 
size_t
 
	$mÆloc_ußbÀ_size
 (*
__±r
Ë
__THROW
;

154 
	$mÆloc_°©s
 (Ë
__THROW
;

157 
	$mÆloc_öfo
 (
__›ti⁄s
, 
FILE
 *
__Â
Ë
__THROW
;

160 *
	$mÆloc_gë_°©e
 (Ë
__THROW
;

164 
	$mÆloc_£t_°©e
 (*
__±r
Ë
__THROW
;

169 (*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_öôülize_hook
) ()

170 
__MALLOC_DEPRECATED
;

172 (*
__MALLOC_HOOK_VOLATILE
 
__‰ì_hook
Ë(*
__±r
,

173 c⁄° 
__mÆloc_±r_t
)

174 
__MALLOC_DEPRECATED
;

175 *(*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_hook
Ë(
size_t
 
__size
,

176 c⁄° 
__mÆloc_±r_t
)

177 
__MALLOC_DEPRECATED
;

178 *(*
__MALLOC_HOOK_VOLATILE
 
__ªÆloc_hook
Ë(*
__±r
,

179 
size_t
 
__size
,

180 c⁄° 
__mÆloc_±r_t
)

181 
__MALLOC_DEPRECATED
;

182 *(*
__MALLOC_HOOK_VOLATILE
 
__memÆign_hook
Ë(
size_t
 
__Æignmít
,

183 
size_t
 
__size
,

184 c⁄° 
__mÆloc_±r_t
)

185 
__MALLOC_DEPRECATED
;

186 (*
__MALLOC_HOOK_VOLATILE
 
__a·î_m‹ec‹e_hook
) ();

189 
	$__mÆloc_check_öô
 (Ë
__THROW
 
__MALLOC_DEPRECATED
;

192 
__END_DECLS


	@/usr/include/math.h

24 #i‚def 
_MATH_H


25 
	#_MATH_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 
	~<bôs/huge_vÆ.h
>

34 #ifde‡
__USE_ISOC99


35 
	~<bôs/huge_vÆf.h
>

36 
	~<bôs/huge_vÆl.h
>

39 
	~<bôs/öf.h
>

42 
	~<bôs/«n.h
>

46 
	~<bôs/m©hdef.h
>

53 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

54 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

55 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

56 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

57 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

58 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

59 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

60 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

61 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

62 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

63 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

64 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

66 
	#_MdoubÀ_
 

	)

67 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

68 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

69 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

70 
	~<bôs/m©hˇŒs.h
>

71 #unde‡
_MdoubÀ_


72 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


73 #unde‡
_MdoubÀ_END_NAMESPACE


74 #unde‡
__MATH_PRECNAME


76 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


82 #i‚de‡
_MÊﬂt_


83 
	#_MÊﬂt_
 

	)

85 
	#_MdoubÀ_
 
_MÊﬂt_


	)

86 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

87 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

88 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

89 
	~<bôs/m©hˇŒs.h
>

90 #unde‡
_MdoubÀ_


91 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


92 #unde‡
_MdoubÀ_END_NAMESPACE


93 #unde‡
__MATH_PRECNAME


95 #i‡!(
deföed
 
__NO_LONG_DOUBLE_MATH
 && deföed 
_LIBC
) \

96 || 
deföed
 
__LDBL_COMPAT


97 #ifde‡
__LDBL_COMPAT


99 #ifde‡
__USE_ISOC99


100 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

101 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

102 #ifde‡
__REDIRECT_NTH


103 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

104 
__∆dbl_√xâow¨df
)

105 
	`__©åibuã__
 ((
__c⁄°__
));

106 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

107 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

108 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

109 (
__x
, 
__y
),

110 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

114 #unde‡
__MATHDECL_1


115 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

116 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

117 
¨gs
, 
Æüs
)

	)

118 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

119 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

125 #i‚de‡
_Ml⁄g_doubÀ_


126 
	#_Ml⁄g_doubÀ_
 

	)

128 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

129 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

130 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

131 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

132 
	#__MATH_DECLARE_LDOUBLE
 1

	)

133 
	~<bôs/m©hˇŒs.h
>

134 #unde‡
_MdoubÀ_


135 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


136 #unde‡
_MdoubÀ_END_NAMESPACE


137 #unde‡
__MATH_PRECNAME


142 #unde‡
__MATHDECL_1


143 #unde‡
__MATHDECL


144 #unde‡
__MATHCALL


147 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


149 
signgam
;

154 #ifde‡
__USE_ISOC99


192 
FP_NAN
 =

193 
	#FP_NAN
 0

	)

194 
FP_NAN
,

195 
FP_INFINITE
 =

196 
	#FP_INFINITE
 1

	)

197 
FP_INFINITE
,

198 
FP_ZERO
 =

199 
	#FP_ZERO
 2

	)

200 
FP_ZERO
,

201 
FP_SUBNORMAL
 =

202 
	#FP_SUBNORMAL
 3

	)

203 
FP_SUBNORMAL
,

204 
FP_NORMAL
 =

205 
	#FP_NORMAL
 4

	)

206 
FP_NORMAL


210 #ifde‡
__NO_LONG_DOUBLE_MATH


211 
	#Â˛assify
(
x
) \

212 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

214 
	#Â˛assify
(
x
) \

215 ( (
x
) ==  () \

216 ? 
	`__Â˛assifyf
 (
x
) \

217 :  (
x
) ==  () \

218 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

222 #ifde‡
__NO_LONG_DOUBLE_MATH


223 
	#signbô
(
x
) \

224 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

226 
	#signbô
(
x
) \

227 ( (
x
) ==  () \

228 ? 
	`__signbôf
 (
x
) \

229 :  (
x
) ==  () \

230 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

234 #ifde‡
__NO_LONG_DOUBLE_MATH


235 
	#isföôe
(
x
) \

236 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

238 
	#isföôe
(
x
) \

239 ( (
x
) ==  () \

240 ? 
	`__föôef
 (
x
) \

241 :  (
x
) ==  () \

242 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

246 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

250 #ifde‡
__NO_LONG_DOUBLE_MATH


251 
	#i¢™
(
x
) \

252 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

254 
	#i¢™
(
x
) \

255 ( (
x
) ==  () \

256 ? 
	`__i¢™f
 (
x
) \

257 :  (
x
) ==  () \

258 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

262 #ifde‡
__NO_LONG_DOUBLE_MATH


263 
	#isöf
(
x
) \

264 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

266 
	#isöf
(
x
) \

267 ( (
x
) ==  () \

268 ? 
	`__isöff
 (
x
) \

269 :  (
x
) ==  () \

270 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

274 
	#MATH_ERRNO
 1

	)

275 
	#MATH_ERREXCEPT
 2

	)

280 #i‚de‡
__FAST_MATH__


281 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

286 #ifdef 
__USE_MISC


290 
_IEEE_
 = -1,

291 
_SVID_
,

292 
_XOPEN_
,

293 
_POSIX_
,

294 
_ISOC_


295 } 
	t_LIB_VERSION_TYPE
;

300 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

304 #ifde‡
__USE_SVID


310 #ifde‡
__˝lu•lus


311 
__ex˚±i⁄


313 
ex˚±i⁄


316 
ty≥
;

317 *
«me
;

318 
¨g1
;

319 
¨g2
;

320 
ªtvÆ
;

321 
	}
};

323 #ifde‡
__˝lu•lus


324 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

326 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

329 
	#X_TLOSS
 1.41484755040568800000e+16

	)

332 
	#DOMAIN
 1

	)

333 
	#SING
 2

	)

334 
	#OVERFLOW
 3

	)

335 
	#UNDERFLOW
 4

	)

336 
	#TLOSS
 5

	)

337 
	#PLOSS
 6

	)

340 
	#HUGE
 3.40282347e+38F

	)

344 #ifde‡
__USE_XOPEN


346 
	#MAXFLOAT
 3.40282347e+38F

	)

353 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


354 
	#M_E
 2.7182818284590452354

	)

355 
	#M_LOG2E
 1.4426950408889634074

	)

356 
	#M_LOG10E
 0.43429448190325182765

	)

357 
	#M_LN2
 0.69314718055994530942

	)

358 
	#M_LN10
 2.30258509299404568402

	)

359 
	#M_PI
 3.14159265358979323846

	)

360 
	#M_PI_2
 1.57079632679489661923

	)

361 
	#M_PI_4
 0.78539816339744830962

	)

362 
	#M_1_PI
 0.31830988618379067154

	)

363 
	#M_2_PI
 0.63661977236758134308

	)

364 
	#M_2_SQRTPI
 1.12837916709551257390

	)

365 
	#M_SQRT2
 1.41421356237309504880

	)

366 
	#M_SQRT1_2
 0.70710678118654752440

	)

372 #ifde‡
__USE_GNU


373 
	#M_El
 2.718281828459045235360287471352662498L

	)

374 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

375 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

376 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

377 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

378 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

379 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

380 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

381 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

382 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

383 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

384 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

385 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

392 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


393 
	#__NO_MATH_INLINES
 1

	)

396 #i‡
deföed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

403 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

404 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

405 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

406 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

407 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

408 
	#isun‹dîed
(
u
, 
v
Ë
	`__buûtö_isun‹dîed
(u, v)

	)

412 #ifde‡
__USE_EXTERN_INLINES


413 
	~<bôs/m©hölöe.h
>

418 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

419 
	~<bôs/m©h-föôe.h
>

422 #ifde‡
__USE_ISOC99


426 #i‚de‡
isgª©î


427 
	#isgª©î
(
x
, 
y
) \

428 (
__exãnsi⁄__
 \

429 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

430 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

434 #i‚de‡
isgª©îequÆ


435 
	#isgª©îequÆ
(
x
, 
y
) \

436 (
__exãnsi⁄__
 \

437 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

438 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

442 #i‚de‡
i¶ess


443 
	#i¶ess
(
x
, 
y
) \

444 (
__exãnsi⁄__
 \

445 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

446 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

450 #i‚de‡
i¶es£quÆ


451 
	#i¶es£quÆ
(
x
, 
y
) \

452 (
__exãnsi⁄__
 \

453 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

454 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

458 #i‚de‡
i¶essgª©î


459 
	#i¶essgª©î
(
x
, 
y
) \

460 (
__exãnsi⁄__
 \

461 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

462 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

466 #i‚de‡
isun‹dîed


467 
	#isun‹dîed
(
u
, 
v
) \

468 (
__exãnsi⁄__
 \

469 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

470 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

475 
	g__END_DECLS


	@/usr/include/memory.h

22 #i‚def 
_MEMORY_H


23 
	#_MEMORY_H
 1

	)

25 
	~<„©uªs.h
>

28 #i‚def 
_STRING_H


29 
	~<°rög.h
>

	@/usr/include/net-snmp/agent/net-snmp-agent-includes.h

6 #i‚de‡
NET_SNMP_AGENT_INCLUDES_H


7 
	#NET_SNMP_AGENT_INCLUDES_H


	)

9 
	~<√t-¢mp/agít/mib_moduÀ_c⁄fig.h
>

10 
	~<√t-¢mp/agít/agít_moduÀ_c⁄fig.h
>

12 
	~<√t-¢mp/agít/¢mp_agít.h
>

13 
	~<√t-¢mp/agít/¢mp_v¨s.h
>

14 
	~<√t-¢mp/agít/ds_agít.h
>

15 
	~<√t-¢mp/agít/agít_h™dÀr.h
>

16 
	~<√t-¢mp/agít/agít_ªad_c⁄fig.h
>

17 
	~<√t-¢mp/agít/agít_å≠.h
>

18 
	~<√t-¢mp/agít/agít_h™dÀr.h
>

19 
	~<√t-¢mp/agít/Æl_hñ≥rs.h
>

20 
	~<√t-¢mp/agít/v¨_°ru˘.h
>

	@/usr/include/net-snmp/agent/snmp_vars.h

6 #i‚de‡
_SNMP_VARS_H_


7 
	#_SNMP_VARS_H_


	)

9 #ifde‡
__˝lu•lus


46 
v¨übÀ
;

63 
v¨übÀ
 *
√t¢mp_du∂iˇã_v¨übÀ
(v¨übÀ *
v¨
);

68 (
WrôeMëhod
Ë(
	ta˘i⁄
,

69 
	tu_ch¨
 * 
	tv¨_vÆ
,

70 
	tu_ch¨
 
	tv¨_vÆ_ty≥
,

71 
	tsize_t
 
	tv¨_vÆ_Àn
,

72 
	tu_ch¨
 * 
	t°©P
,

73 
	toid
 * 
	t«me
, 
	tsize_t
 
	tÀngth
);

78 
u_ch¨
 *(
	tFödV¨Mëhod
Ë(
	tv¨übÀ
 * 
	tvp
,

79 
	toid
 * 
	t«me
,

80 
	tsize_t
 * 
	tÀngth
,

81 
	texa˘
,

82 
	tsize_t
 * 
	tv¨_Àn
,

83 
	tWrôeMëhod
 ** 
	twrôe_mëhod
);

88 (
AddV¨Mëhod
Ë(
	t√t¢mp_agít_£ssi⁄
 *
	ta•
,

89 
	t√t¢mp_v¨übÀ_li°
 * 
	tvbp
);

91 
∆i°
;

93 
l⁄g_ªtu∫
;

94 
u_ch¨
 
ªtu∫_buf
[];

96 
oid
 
nuŒOid
[];

97 
nuŒOidLí
;

99 
	#INST
 0xFFFFFFFF

	)

101 
	sv¨übÀ
 {

102 
u_ch¨
 
	gmagic
;

103 
	gty≥
;

107 
u_sh‹t
 
	ga˛
;

108 
FödV¨Mëhod
 *
	gfödV¨
;

109 
u_ch¨
 
	g«mñí
;

110 
oid
 
	g«me
[
MAX_OID_LEN
];

113 
öô_agít
(const *);

114 
shutdown_agít
();

116 
should_öô
(c⁄° *
moduÀ_«me
);

117 
add_to_öô_li°
(*
moduÀ_li°
);

119 #ifde‡
USING_AGENTX_SUBAGENT_MODULE


120 
√t¢mp_íabÀ_subagít
();

123 #i‚de‡
_AGENT_REGISTRY_H


124 
	~<√t-¢mp/agít/agít_h™dÀr.h
>

125 
	~<√t-¢mp/agít/v¨_°ru˘.h
>

126 
	~<√t-¢mp/agít/agít_ªgi°ry.h
>

132 
	#MATCH_FAILED
 (-1)

	)

133 
	#MATCH_SUCCEEDED
 0

	)

135 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/net-snmp-config.h

7 #ifde‡
√t_¢mp_c⁄fig_mu…ûib_ªdúe˘i⁄_h


10 
	#√t_¢mp_c⁄fig_mu…ûib_ªdúe˘i⁄_h


	)

12 #i‡
deföed
(
__i386__
)

13 
	~"√t-¢mp-c⁄fig-i386.h
"

14 #ñi‡
deföed
(
__ü64__
)

15 
	~"√t-¢mp-c⁄fig-ü64.h
"

16 #ñi‡
deföed
(
__powîpc64__
)

17 
	~"√t-¢mp-c⁄fig-µc64.h
"

18 #ñi‡
deföed
(
__powîpc__
)

19 
	~"√t-¢mp-c⁄fig-µc.h
"

20 #ñi‡
deföed
(
__s390x__
)

21 
	~"√t-¢mp-c⁄fig-s390x.h
"

22 #ñi‡
deföed
(
__s390__
)

23 
	~"√t-¢mp-c⁄fig-s390.h
"

24 #ñi‡
deföed
(
__x86_64__
)

25 
	~"√t-¢mp-c⁄fig-x86_64.h
"

26 #ñi‡
deföed
(
__Æpha__
)

27 
	~"√t-¢mp-c⁄fig-Æpha.h
"

28 #ñi‡
deföed
(
__•¨c__
Ë&& deföed (
__¨ch64__
)

29 
	~"√t-¢mp-c⁄fig-•¨c64.h
"

30 #ñi‡
deföed
(
__•¨c__
)

31 
	~"√t-¢mp-c⁄fig-•¨c.h
"

36 #unde‡
√t_¢mp_c⁄fig_mu…ûib_ªdúe˘i⁄_h


	@/usr/include/net-snmp/net-snmp-includes.h

1 #i‚de‡
NET_SNMP_INCLUDES_H


2 
	#NET_SNMP_INCLUDES_H


	)

14 
	~<°dio.h
>

15 
	~<sys/ty≥s.h
>

16 #ifde‡
HAVE_STDINT_H


17 
	~<°döt.h
>

20 #i‚de‡
NET_SNMP_CONFIG_H


24 #i‡
HAVE_STRING_H


25 
	~<°rög.h
>

27 
	~<°rögs.h
>

30 #i‡
HAVE_STDLIB_H


31 
	~<°dlib.h
>

33 #i‡
HAVE_UNISTD_H


34 
	~<uni°d.h
>

36 #i‡
HAVE_NETINET_IN_H


37 
	~<√töë/ö.h
>

40 #i‡
TIME_WITH_SYS_TIME


41 
	~<sys/time.h
>

42 
	~<time.h
>

44 #i‡
HAVE_SYS_TIME_H


45 
	~<sys/time.h
>

47 
	~<time.h
>

54 #i‡
HAVE_DMALLOC_H


55 
	~<dmÆloc.h
>

67 
	~<√t-¢mp/deföôi⁄s.h
>

68 
	~<√t-¢mp/ty≥s.h
>

70 
	~<√t-¢mp/libøry/gë›t.h
>

71 
	~<√t-¢mp/utûôõs.h
>

72 
	~<√t-¢mp/£ssi⁄_≠i.h
>

73 
	~<√t-¢mp/pdu_≠i.h
>

74 
	~<√t-¢mp/mib_≠i.h
>

75 
	~<√t-¢mp/v¨böd_≠i.h
>

76 
	~<√t-¢mp/c⁄fig_≠i.h
>

77 
	~<√t-¢mp/ouçut_≠i.h
>

78 
	~<√t-¢mp/¢mpv3_≠i.h
>

	@/usr/include/net/if.h

19 #i‚de‡
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<„©uªs.h
>

24 #ifde‡
__USE_MISC


25 
	~<sys/ty≥s.h
>

26 
	~<sys/sockë.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_«meödex


35 
	mif_ödex
;

36 *
	mif_«me
;

40 #ifde‡
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siÁddr


90 
sockaddr
 
	miÁ_addr
;

93 
sockaddr
 
	mifu_brﬂdaddr
;

94 
sockaddr
 
	mifu_d°addr
;

95 } 
	miÁ_ifu
;

96 
iÁ˚
 *
	miÁ_iÂ
;

97 
iÁddr
 *
	miÁ_√xt
;

100 
	#iÁ_brﬂdaddr
 
iÁ_ifu
.
ifu_brﬂdaddr


	)

101 
	#iÁ_d°addr
 
iÁ_ifu
.
ifu_d°addr


	)

111 
	sifm≠


113 
	mmem_°¨t
;

114 
	mmem_íd
;

115 
	mba£_addr
;

116 
	múq
;

117 
	mdma
;

118 
	mp‹t
;

126 
	si‰eq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	mi‰n_«me
[
IFNAMSIZ
];

133 } 
	mi‰_i‰n
;

137 
sockaddr
 
	mi‰u_addr
;

138 
sockaddr
 
	mi‰u_d°addr
;

139 
sockaddr
 
	mi‰u_brﬂdaddr
;

140 
sockaddr
 
	mi‰u_√tmask
;

141 
sockaddr
 
	mi‰u_hwaddr
;

142 
	mi‰u_Êags
;

143 
	mi‰u_ivÆue
;

144 
	mi‰u_mtu
;

145 
ifm≠
 
	mi‰u_m≠
;

146 
	mi‰u_¶ave
[
IFNAMSIZ
];

147 
	mi‰u_√w«me
[
IFNAMSIZ
];

148 
__ˇddr_t
 
	mi‰u_d©a
;

149 } 
	mi‰_i‰u
;

151 
	#i‰_«me
 
i‰_i‰n
.
i‰n_«me


	)

152 
	#i‰_hwaddr
 
i‰_i‰u
.
i‰u_hwaddr


	)

153 
	#i‰_addr
 
i‰_i‰u
.
i‰u_addr


	)

154 
	#i‰_d°addr
 
i‰_i‰u
.
i‰u_d°addr


	)

155 
	#i‰_brﬂdaddr
 
i‰_i‰u
.
i‰u_brﬂdaddr


	)

156 
	#i‰_√tmask
 
i‰_i‰u
.
i‰u_√tmask


	)

157 
	#i‰_Êags
 
i‰_i‰u
.
i‰u_Êags


	)

158 
	#i‰_mëric
 
i‰_i‰u
.
i‰u_ivÆue


	)

159 
	#i‰_mtu
 
i‰_i‰u
.
i‰u_mtu


	)

160 
	#i‰_m≠
 
i‰_i‰u
.
i‰u_m≠


	)

161 
	#i‰_¶ave
 
i‰_i‰u
.
i‰u_¶ave


	)

162 
	#i‰_d©a
 
i‰_i‰u
.
i‰u_d©a


	)

163 
	#i‰_ifödex
 
i‰_i‰u
.
i‰u_ivÆue


	)

164 
	#i‰_b™dwidth
 
i‰_i‰u
.
i‰u_ivÆue


	)

165 
	#i‰_qÀn
 
i‰_i‰u
.
i‰u_ivÆue


	)

166 
	#i‰_√w«me
 
i‰_i‰u
.
i‰u_√w«me


	)

167 
	#_IOT_i‰eq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_i‰eq_sh‹t
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_i‰eq_öt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifc⁄f


178 
	mifc_Àn
;

181 
__ˇddr_t
 
	mifcu_buf
;

182 
i‰eq
 *
	mifcu_ªq
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_ªq
 
ifc_ifcu
.
ifcu_ªq


	)

187 
	#_IOT_ifc⁄f
 
	`_IOT
(
	`_IOTS
(
ifc⁄f
),1,0,0,0,0Ë

	)

190 
__BEGIN_DECLS


193 
	$if_«mëoödex
 (c⁄° *
__i‚ame
Ë
__THROW
;

194 *
	$if_ödext⁄ame
 (
__ifödex
, *
__i‚ame
Ë
__THROW
;

197 
if_«meödex
 *
	$if_«meödex
 (Ë
__THROW
;

200 
	$if_‰ì«meödex
 (
if_«meödex
 *
__±r
Ë
__THROW
;

202 
__END_DECLS


	@/usr/include/net/route.h

20 #i‚de‡
_NET_ROUTE_H


21 
	#_NET_ROUTE_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<sys/sockë.h
>

25 
	~<sys/ty≥s.h
>

26 
	~<√töë/ö.h
>

27 
	~<bôs/w‹dsize.h
>

31 
	sπíåy


33 
	mπ_∑d1
;

34 
sockaddr
 
	mπ_d°
;

35 
sockaddr
 
	mπ_g©eway
;

36 
sockaddr
 
	mπ_gímask
;

37 
	mπ_Êags
;

38 
	mπ_∑d2
;

39 
	mπ_∑d3
;

40 
	mπ_tos
;

41 
	mπ_˛ass
;

42 #i‡
__WORDSIZE
 == 64

43 
	mπ_∑d4
[3];

45 
	mπ_∑d4
;

47 
	mπ_mëric
;

48 *
	mπ_dev
;

49 
	mπ_mtu
;

50 
	mπ_wödow
;

51 
	mπ_úâ
;

54 
	#π_mss
 
π_mtu


	)

57 
	sö6_πmsg


59 
ö6_addr
 
	mπmsg_d°
;

60 
ö6_addr
 
	mπmsg_§c
;

61 
ö6_addr
 
	mπmsg_g©eway
;

62 
u_öt32_t
 
	mπmsg_ty≥
;

63 
u_öt16_t
 
	mπmsg_d°_Àn
;

64 
u_öt16_t
 
	mπmsg_§c_Àn
;

65 
u_öt32_t
 
	mπmsg_mëric
;

66 
	mπmsg_öfo
;

67 
u_öt32_t
 
	mπmsg_Êags
;

68 
	mπmsg_ifödex
;

72 
	#RTF_UP
 0x0001

	)

73 
	#RTF_GATEWAY
 0x0002

	)

75 
	#RTF_HOST
 0x0004

	)

76 
	#RTF_REINSTATE
 0x0008

	)

77 
	#RTF_DYNAMIC
 0x0010

	)

78 
	#RTF_MODIFIED
 0x0020

	)

79 
	#RTF_MTU
 0x0040

	)

80 
	#RTF_MSS
 
RTF_MTU


	)

81 
	#RTF_WINDOW
 0x0080

	)

82 
	#RTF_IRTT
 0x0100

	)

83 
	#RTF_REJECT
 0x0200

	)

84 
	#RTF_STATIC
 0x0400

	)

85 
	#RTF_XRESOLVE
 0x0800

	)

86 
	#RTF_NOFORWARD
 0x1000

	)

87 
	#RTF_THROW
 0x2000

	)

88 
	#RTF_NOPMTUDISC
 0x4000

	)

91 
	#RTF_DEFAULT
 0x00010000

	)

92 
	#RTF_ALLONLINK
 0x00020000

	)

93 
	#RTF_ADDRCONF
 0x00040000

	)

95 
	#RTF_LINKRT
 0x00100000

	)

96 
	#RTF_NONEXTHOP
 0x00200000

	)

98 
	#RTF_CACHE
 0x01000000

	)

99 
	#RTF_FLOW
 0x02000000

	)

100 
	#RTF_POLICY
 0x04000000

	)

102 
	#RTCF_VALVE
 0x00200000

	)

103 
	#RTCF_MASQ
 0x00400000

	)

104 
	#RTCF_NAT
 0x00800000

	)

105 
	#RTCF_DOREDIRECT
 0x01000000

	)

106 
	#RTCF_LOG
 0x02000000

	)

107 
	#RTCF_DIRECTSRC
 0x04000000

	)

109 
	#RTF_LOCAL
 0x80000000

	)

110 
	#RTF_INTERFACE
 0x40000000

	)

111 
	#RTF_MULTICAST
 0x20000000

	)

112 
	#RTF_BROADCAST
 0x10000000

	)

113 
	#RTF_NAT
 0x08000000

	)

115 
	#RTF_ADDRCLASSMASK
 0xF8000000

	)

116 
	#RT_ADDRCLASS
(
Êags
Ë((
__u_öt32_t
ËÊag†>> 23)

	)

118 
	#RT_TOS
(
tos
Ë(—osË& 
IPTOS_TOS_MASK
)

	)

120 
	#RT_LOCALADDR
(
Êags
Ë((Êag†& 
RTF_ADDRCLASSMASK
) \

121 =(
RTF_LOCAL
|
RTF_INTERFACE
))

	)

123 
	#RT_CLASS_UNSPEC
 0

	)

124 
	#RT_CLASS_DEFAULT
 253

	)

126 
	#RT_CLASS_MAIN
 254

	)

127 
	#RT_CLASS_LOCAL
 255

	)

128 
	#RT_CLASS_MAX
 255

	)

131 
	#RTMSG_ACK
 
NLMSG_ACK


	)

132 
	#RTMSG_OVERRUN
 
NLMSG_OVERRUN


	)

134 
	#RTMSG_NEWDEVICE
 0x11

	)

135 
	#RTMSG_DELDEVICE
 0x12

	)

136 
	#RTMSG_NEWROUTE
 0x21

	)

137 
	#RTMSG_DELROUTE
 0x22

	)

138 
	#RTMSG_NEWRULE
 0x31

	)

139 
	#RTMSG_DELRULE
 0x32

	)

140 
	#RTMSG_CONTROL
 0x40

	)

142 
	#RTMSG_AR_FAILED
 0x51

	)

	@/usr/include/netdb.h

22 #i‚def 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<√töë/ö.h
>

28 
	~<°döt.h
>

29 #ifde‡
__USE_MISC


32 
	~<Ωc/√tdb.h
>

35 #ifde‡
__USE_GNU


36 
	#__√ed_sigevít_t


	)

37 
	~<bôs/sigöfo.h
>

38 
	#__√ed_time•ec


	)

39 
	~<time.h
>

42 
	~<bôs/√tdb.h
>

45 
	#_PATH_HEQUIV
 "/ëc/ho°s.equiv"

	)

46 
	#_PATH_HOSTS
 "/ëc/ho°s"

	)

47 
	#_PATH_NETWORKS
 "/ëc/√tw‹ks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/ëc/nsswôch.c⁄f"

	)

49 
	#_PATH_PROTOCOLS
 "/ëc/¥Ÿocﬁs"

	)

50 
	#_PATH_SERVICES
 "/ëc/£rvi˚s"

	)

53 
	g__BEGIN_DECLS


55 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


58 
	#h_î∫o
 (*
	`__h_î∫o_loˇti⁄
 ())

	)

61 *
	$__h_î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifde‡
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifde‡
__USE_MISC


92 
	$hîr‹
 (c⁄° *
__°r
Ë
__THROW
;

95 c⁄° *
	$h°ªº‹
 (
__îr_num
Ë
__THROW
;

100 
	sho°ít


102 *
h_«me
;

103 **
h_Æü£s
;

104 
h_addπy≥
;

105 
h_Àngth
;

106 **
h_addr_li°
;

107 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


108 
	#h_addr
 
h_addr_li°
[0]

	)

117 
	`£tho°ít
 (
__°ay_›í
);

123 
	`ídho°ít
 ();

130 
ho°ít
 *
	`gëho°ít
 ();

137 
ho°ít
 *
	`gëho°byaddr
 (c⁄° *
__addr
, 
__sockÀn_t
 
__Àn
,

138 
__ty≥
);

144 
ho°ít
 *
	`gëho°by«me
 (c⁄° *
__«me
);

146 #ifde‡
__USE_MISC


155 
ho°ít
 *
	`gëho°by«me2
 (c⁄° *
__«me
, 
__af
);

167 
	`gëho°ít_r
 (
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

168 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

169 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

170 *
__ª°ri˘
 
__h_î∫›
);

172 
	`gëho°byaddr_r
 (c⁄° *
__ª°ri˘
 
__addr
, 
__sockÀn_t
 
__Àn
,

173 
__ty≥
,

174 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

175 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

176 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

177 *
__ª°ri˘
 
__h_î∫›
);

179 
	`gëho°by«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

180 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

181 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

182 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

183 *
__ª°ri˘
 
__h_î∫›
);

185 
	`gëho°by«me2_r
 (c⁄° *
__ª°ri˘
 
__«me
, 
__af
,

186 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

187 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

188 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

189 *
__ª°ri˘
 
__h_î∫›
);

198 
	`£äëít
 (
__°ay_›í
);

204 
	`íd√ã¡
 ();

211 
√ã¡
 *
	`gë√ã¡
 ();

218 
√ã¡
 *
	`gë√tbyaddr
 (
uöt32_t
 
__√t
, 
__ty≥
);

224 
√ã¡
 *
	`gë√tby«me
 (c⁄° *
__«me
);

226 #ifdef 
__USE_MISC


237 
	`gë√ã¡_r
 (
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

238 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

239 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

240 *
__ª°ri˘
 
__h_î∫›
);

242 
	`gë√tbyaddr_r
 (
uöt32_t
 
__√t
, 
__ty≥
,

243 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

244 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

245 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

246 *
__ª°ri˘
 
__h_î∫›
);

248 
	`gë√tby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

249 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

250 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

251 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

252 *
__ª°ri˘
 
__h_î∫›
);

257 
	s£rvít


259 *
s_«me
;

260 **
s_Æü£s
;

261 
s_p‹t
;

262 *
s_¥Ÿo
;

270 
	`£t£rvít
 (
__°ay_›í
);

276 
	`íd£rvít
 ();

283 
£rvít
 *
	`gë£rvít
 ();

290 
£rvít
 *
	`gë£rvby«me
 (c⁄° *
__«me
, c⁄° *
__¥Ÿo
);

297 
£rvít
 *
	`gë£rvbyp‹t
 (
__p‹t
, c⁄° *
__¥Ÿo
);

300 #ifdef 
__USE_MISC


308 
	`gë£rvít_r
 (
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

309 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

310 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

312 
	`gë£rvby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

313 c⁄° *
__ª°ri˘
 
__¥Ÿo
,

314 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

315 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

316 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

318 
	`gë£rvbyp‹t_r
 (
__p‹t
, c⁄° *
__ª°ri˘
 
__¥Ÿo
,

319 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

320 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

321 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

326 
	s¥Ÿ€¡


328 *
p_«me
;

329 **
p_Æü£s
;

330 
p_¥Ÿo
;

338 
	`£çrŸ€¡
 (
__°ay_›í
);

344 
	`íd¥Ÿ€¡
 ();

351 
¥Ÿ€¡
 *
	`gë¥Ÿ€¡
 ();

357 
¥Ÿ€¡
 *
	`gë¥Ÿoby«me
 (c⁄° *
__«me
);

363 
¥Ÿ€¡
 *
	`gë¥Ÿobynumbî
 (
__¥Ÿo
);

366 #ifdef 
__USE_MISC


374 
	`gë¥Ÿ€¡_r
 (
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

375 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

376 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

378 
	`gë¥Ÿoby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

379 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

380 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

381 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

383 
	`gë¥Ÿobynumbî_r
 (
__¥Ÿo
,

384 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

385 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

386 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

395 
	`£äëgª¡
 (c⁄° *
__√tgroup
);

403 
	`íd√tgª¡
 ();

412 
	`gë√tgª¡
 (**
__ª°ri˘
 
__ho°p
,

413 **
__ª°ri˘
 
__u£Ω
,

414 **
__ª°ri˘
 
__domaöp
);

423 
	`ö√tgr
 (c⁄° *
__√tgroup
, c⁄° *
__ho°
,

424 c⁄° *
__u£r
, c⁄° *
__domaö
);

432 
	`gë√tgª¡_r
 (**
__ª°ri˘
 
__ho°p
,

433 **
__ª°ri˘
 
__u£Ω
,

434 **
__ª°ri˘
 
__domaöp
,

435 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
);

439 #ifde‡
__USE_BSD


451 
	`rcmd
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

452 c⁄° *
__ª°ri˘
 
__locu£r
,

453 c⁄° *
__ª°ri˘
 
__ªmu£r
,

454 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

463 
	`rcmd_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

464 c⁄° *
__ª°ri˘
 
__locu£r
,

465 c⁄° *
__ª°ri˘
 
__ªmu£r
,

466 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

467 
ß_Ámûy_t
 
__af
);

479 
	`ªxec
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

480 c⁄° *
__ª°ri˘
 
__«me
,

481 c⁄° *
__ª°ri˘
 
__∑ss
,

482 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

491 
	`ªxec_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

492 c⁄° *
__ª°ri˘
 
__«me
,

493 c⁄° *
__ª°ri˘
 
__∑ss
,

494 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

495 
ß_Ámûy_t
 
__af
);

505 
	`ru£rok
 (c⁄° *
__rho°
, 
__su£r
,

506 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

515 
	`ru£rok_af
 (c⁄° *
__rho°
, 
__su£r
,

516 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

517 
ß_Ámûy_t
 
__af
);

528 
	`úu£rok
 (
uöt32_t
 
__øddr
, 
__su£r
,

529 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

539 
	`úu£rok_af
 (c⁄° *
__øddr
, 
__su£r
,

540 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

541 
ß_Ámûy_t
 
__af
);

551 
	`ºesvp‹t
 (*
__Æp‹t
);

560 
	`ºesvp‹t_af
 (*
__Æp‹t
, 
ß_Ámûy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddröfo


569 
ai_Êags
;

570 
ai_Ámûy
;

571 
ai_sockty≥
;

572 
ai_¥Ÿocﬁ
;

573 
sockÀn_t
 
ai_addæí
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ˇn⁄«me
;

576 
addröfo
 *
ai_√xt
;

579 #ifde‡
__USE_GNU


581 
	sgaicb


583 c⁄° *
¨_«me
;

584 c⁄° *
¨_£rvi˚
;

585 c⁄° 
addröfo
 *
¨_ªque°
;

586 
addröfo
 *
¨_ªsu…
;

588 
__ªtu∫
;

589 
__unu£d
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifde‡
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifde‡
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifde‡
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifde‡
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`gëaddröfo
 (c⁄° *
__ª°ri˘
 
__«me
,

663 c⁄° *
__ª°ri˘
 
__£rvi˚
,

664 c⁄° 
addröfo
 *
__ª°ri˘
 
__ªq
,

665 
addröfo
 **
__ª°ri˘
 
__∑i
);

668 
	$‰ìaddröfo
 (
addröfo
 *
__ai
Ë
__THROW
;

671 c⁄° *
	$gai_°ªº‹
 (
__ecode
Ë
__THROW
;

677 
	`gë«meöfo
 (c⁄° 
sockaddr
 *
__ª°ri˘
 
__ß
,

678 
sockÀn_t
 
__ßÀn
, *
__ª°ri˘
 
__ho°
,

679 
sockÀn_t
 
__ho°Àn
, *
__ª°ri˘
 
__£rv
,

680 
sockÀn_t
 
__£rvÀn
, 
__Êags
);

683 #ifde‡
__USE_GNU


692 
	`gëaddröfo_a
 (
__mode
, 
gaicb
 *
__li°
[
__ª°ri˘_¨r
],

693 
__ít
, 
sigevít
 *
__ª°ri˘
 
__sig
);

703 
	`gai_su•íd
 (c⁄° 
gaicb
 *c⁄° 
__li°
[], 
__ít
,

704 c⁄° 
time•ec
 *
__timeout
);

707 
	$gai_îr‹
 (
gaicb
 *
__ªq
Ë
__THROW
;

710 
	$gai_ˇn˚l
 (
gaicb
 *
__gaicbp
Ë
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/icmp6.h

18 #i‚de‡
_NETINET_ICMP6_H


19 
	#_NETINET_ICMP6_H
 1

	)

21 
	~<öây≥s.h
>

22 
	~<°rög.h
>

23 
	~<sys/ty≥s.h
>

24 
	~<√töë/ö.h
>

26 
	#ICMP6_FILTER
 1

	)

28 
	#ICMP6_FILTER_BLOCK
 1

	)

29 
	#ICMP6_FILTER_PASS
 2

	)

30 
	#ICMP6_FILTER_BLOCKOTHERS
 3

	)

31 
	#ICMP6_FILTER_PASSONLY
 4

	)

33 
	sicmp6_fûãr


35 
uöt32_t
 
	micmp6_fût
[8];

38 
	sicmp6_hdr


40 
uöt8_t
 
	micmp6_ty≥
;

41 
uöt8_t
 
	micmp6_code
;

42 
uöt16_t
 
	micmp6_cksum
;

45 
uöt32_t
 
	micmp6_un_d©a32
[1];

46 
uöt16_t
 
	micmp6_un_d©a16
[2];

47 
uöt8_t
 
	micmp6_un_d©a8
[4];

48 } 
	micmp6_d©aun
;

51 
	#icmp6_d©a32
 
icmp6_d©aun
.
icmp6_un_d©a32


	)

52 
	#icmp6_d©a16
 
icmp6_d©aun
.
icmp6_un_d©a16


	)

53 
	#icmp6_d©a8
 
icmp6_d©aun
.
icmp6_un_d©a8


	)

54 
	#icmp6_µå
 
icmp6_d©a32
[0]

	)

55 
	#icmp6_mtu
 
icmp6_d©a32
[0]

	)

56 
	#icmp6_id
 
icmp6_d©a16
[0]

	)

57 
	#icmp6_£q
 
icmp6_d©a16
[1]

	)

58 
	#icmp6_maxdñay
 
icmp6_d©a16
[0]

	)

60 
	#ICMP6_DST_UNREACH
 1

	)

61 
	#ICMP6_PACKET_TOO_BIG
 2

	)

62 
	#ICMP6_TIME_EXCEEDED
 3

	)

63 
	#ICMP6_PARAM_PROB
 4

	)

65 
	#ICMP6_INFOMSG_MASK
 0x80

	)

67 
	#ICMP6_ECHO_REQUEST
 128

	)

68 
	#ICMP6_ECHO_REPLY
 129

	)

69 
	#MLD_LISTENER_QUERY
 130

	)

70 
	#MLD_LISTENER_REPORT
 131

	)

71 
	#MLD_LISTENER_REDUCTION
 132

	)

73 
	#ICMP6_DST_UNREACH_NOROUTE
 0

	)

74 
	#ICMP6_DST_UNREACH_ADMIN
 1

	)

76 
	#ICMP6_DST_UNREACH_BEYONDSCOPE
 2

	)

77 
	#ICMP6_DST_UNREACH_ADDR
 3

	)

78 
	#ICMP6_DST_UNREACH_NOPORT
 4

	)

80 
	#ICMP6_TIME_EXCEED_TRANSIT
 0

	)

81 
	#ICMP6_TIME_EXCEED_REASSEMBLY
 1

	)

83 
	#ICMP6_PARAMPROB_HEADER
 0

	)

84 
	#ICMP6_PARAMPROB_NEXTHEADER
 1

	)

85 
	#ICMP6_PARAMPROB_OPTION
 2

	)

87 
	#ICMP6_FILTER_WILLPASS
(
ty≥
, 
fûãΩ
) \

88 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë& (1 << (—y≥Ë& 31))Ë=0)

	)

90 
	#ICMP6_FILTER_WILLBLOCK
(
ty≥
, 
fûãΩ
) \

91 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë& (1 << (—y≥Ë& 31))Ë!0)

	)

93 
	#ICMP6_FILTER_SETPASS
(
ty≥
, 
fûãΩ
) \

94 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë&~(1 << (—y≥Ë& 31))))

	)

96 
	#ICMP6_FILTER_SETBLOCK
(
ty≥
, 
fûãΩ
) \

97 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë|(1 << (—y≥Ë& 31))))

	)

99 
	#ICMP6_FILTER_SETPASSALL
(
fûãΩ
) \

100 
	`mem£t
 (
fûãΩ
, 0,  (
icmp6_fûãr
));

	)

102 
	#ICMP6_FILTER_SETBLOCKALL
(
fûãΩ
) \

103 
	`mem£t
 (
fûãΩ
, 0xFF,  (
icmp6_fûãr
));

	)

105 
	#ND_ROUTER_SOLICIT
 133

	)

106 
	#ND_ROUTER_ADVERT
 134

	)

107 
	#ND_NEIGHBOR_SOLICIT
 135

	)

108 
	#ND_NEIGHBOR_ADVERT
 136

	)

109 
	#ND_REDIRECT
 137

	)

111 
	snd_rouãr_sﬁicô


113 
icmp6_hdr
 
	mnd_rs_hdr
;

117 
	#nd_rs_ty≥
 
nd_rs_hdr
.
icmp6_ty≥


	)

118 
	#nd_rs_code
 
nd_rs_hdr
.
icmp6_code


	)

119 
	#nd_rs_cksum
 
nd_rs_hdr
.
icmp6_cksum


	)

120 
	#nd_rs_ª£rved
 
nd_rs_hdr
.
icmp6_d©a32
[0]

	)

122 
	snd_rouãr_advît


124 
icmp6_hdr
 
	mnd_ø_hdr
;

125 
uöt32_t
 
	mnd_ø_ªachabÀ
;

126 
uöt32_t
 
	mnd_ø_ªå™smô
;

130 
	#nd_ø_ty≥
 
nd_ø_hdr
.
icmp6_ty≥


	)

131 
	#nd_ø_code
 
nd_ø_hdr
.
icmp6_code


	)

132 
	#nd_ø_cksum
 
nd_ø_hdr
.
icmp6_cksum


	)

133 
	#nd_ø_curh›limô
 
nd_ø_hdr
.
icmp6_d©a8
[0]

	)

134 
	#nd_ø_Êags_ª£rved
 
nd_ø_hdr
.
icmp6_d©a8
[1]

	)

135 
	#ND_RA_FLAG_MANAGED
 0x80

	)

136 
	#ND_RA_FLAG_OTHER
 0x40

	)

137 
	#ND_RA_FLAG_HOME_AGENT
 0x20

	)

138 
	#nd_ø_rouãr_li„time
 
nd_ø_hdr
.
icmp6_d©a16
[1]

	)

140 
	snd_√ighb‹_sﬁicô


142 
icmp6_hdr
 
	mnd_ns_hdr
;

143 
ö6_addr
 
	mnd_ns_èrgë
;

147 
	#nd_ns_ty≥
 
nd_ns_hdr
.
icmp6_ty≥


	)

148 
	#nd_ns_code
 
nd_ns_hdr
.
icmp6_code


	)

149 
	#nd_ns_cksum
 
nd_ns_hdr
.
icmp6_cksum


	)

150 
	#nd_ns_ª£rved
 
nd_ns_hdr
.
icmp6_d©a32
[0]

	)

152 
	snd_√ighb‹_advît


154 
icmp6_hdr
 
	mnd_«_hdr
;

155 
ö6_addr
 
	mnd_«_èrgë
;

159 
	#nd_«_ty≥
 
nd_«_hdr
.
icmp6_ty≥


	)

160 
	#nd_«_code
 
nd_«_hdr
.
icmp6_code


	)

161 
	#nd_«_cksum
 
nd_«_hdr
.
icmp6_cksum


	)

162 
	#nd_«_Êags_ª£rved
 
nd_«_hdr
.
icmp6_d©a32
[0]

	)

163 #i‡ 
BYTE_ORDER
 =
BIG_ENDIAN


164 
	#ND_NA_FLAG_ROUTER
 0x80000000

	)

165 
	#ND_NA_FLAG_SOLICITED
 0x40000000

	)

166 
	#ND_NA_FLAG_OVERRIDE
 0x20000000

	)

168 
	#ND_NA_FLAG_ROUTER
 0x00000080

	)

169 
	#ND_NA_FLAG_SOLICITED
 0x00000040

	)

170 
	#ND_NA_FLAG_OVERRIDE
 0x00000020

	)

173 
	snd_ªdúe˘


175 
icmp6_hdr
 
	mnd_rd_hdr
;

176 
ö6_addr
 
	mnd_rd_èrgë
;

177 
ö6_addr
 
	mnd_rd_d°
;

181 
	#nd_rd_ty≥
 
nd_rd_hdr
.
icmp6_ty≥


	)

182 
	#nd_rd_code
 
nd_rd_hdr
.
icmp6_code


	)

183 
	#nd_rd_cksum
 
nd_rd_hdr
.
icmp6_cksum


	)

184 
	#nd_rd_ª£rved
 
nd_rd_hdr
.
icmp6_d©a32
[0]

	)

186 
	snd_›t_hdr


188 
uöt8_t
 
	mnd_›t_ty≥
;

189 
uöt8_t
 
	mnd_›t_Àn
;

193 
	#ND_OPT_SOURCE_LINKADDR
 1

	)

194 
	#ND_OPT_TARGET_LINKADDR
 2

	)

195 
	#ND_OPT_PREFIX_INFORMATION
 3

	)

196 
	#ND_OPT_REDIRECTED_HEADER
 4

	)

197 
	#ND_OPT_MTU
 5

	)

198 
	#ND_OPT_RTR_ADV_INTERVAL
 7

	)

199 
	#ND_OPT_HOME_AGENT_INFO
 8

	)

201 
	snd_›t_¥efix_öfo


203 
uöt8_t
 
	mnd_›t_pi_ty≥
;

204 
uöt8_t
 
	mnd_›t_pi_Àn
;

205 
uöt8_t
 
	mnd_›t_pi_¥efix_Àn
;

206 
uöt8_t
 
	mnd_›t_pi_Êags_ª£rved
;

207 
uöt32_t
 
	mnd_›t_pi_vÆid_time
;

208 
uöt32_t
 
	mnd_›t_pi_¥e„ºed_time
;

209 
uöt32_t
 
	mnd_›t_pi_ª£rved2
;

210 
ö6_addr
 
	mnd_›t_pi_¥efix
;

213 
	#ND_OPT_PI_FLAG_ONLINK
 0x80

	)

214 
	#ND_OPT_PI_FLAG_AUTO
 0x40

	)

215 
	#ND_OPT_PI_FLAG_RADDR
 0x20

	)

217 
	snd_›t_rd_hdr


219 
uöt8_t
 
	mnd_›t_rh_ty≥
;

220 
uöt8_t
 
	mnd_›t_rh_Àn
;

221 
uöt16_t
 
	mnd_›t_rh_ª£rved1
;

222 
uöt32_t
 
	mnd_›t_rh_ª£rved2
;

226 
	snd_›t_mtu


228 
uöt8_t
 
	mnd_›t_mtu_ty≥
;

229 
uöt8_t
 
	mnd_›t_mtu_Àn
;

230 
uöt16_t
 
	mnd_›t_mtu_ª£rved
;

231 
uöt32_t
 
	mnd_›t_mtu_mtu
;

234 
	smld_hdr


236 
icmp6_hdr
 
	mmld_icmp6_hdr
;

237 
ö6_addr
 
	mmld_addr
;

240 
	#mld_ty≥
 
mld_icmp6_hdr
.
icmp6_ty≥


	)

241 
	#mld_code
 
mld_icmp6_hdr
.
icmp6_code


	)

242 
	#mld_cksum
 
mld_icmp6_hdr
.
icmp6_cksum


	)

243 
	#mld_maxdñay
 
mld_icmp6_hdr
.
icmp6_d©a16
[0]

	)

244 
	#mld_ª£rved
 
mld_icmp6_hdr
.
icmp6_d©a16
[1]

	)

246 
	#ICMP6_ROUTER_RENUMBERING
 138

	)

248 
	sicmp6_rouãr_ªnum


250 
icmp6_hdr
 
	mº_hdr
;

251 
uöt8_t
 
	mº_£gnum
;

252 
uöt8_t
 
	mº_Êags
;

253 
uöt16_t
 
	mº_maxdñay
;

254 
uöt32_t
 
	mº_ª£rved
;

257 
	#º_ty≥
 
º_hdr
.
icmp6_ty≥


	)

258 
	#º_code
 
º_hdr
.
icmp6_code


	)

259 
	#º_cksum
 
º_hdr
.
icmp6_cksum


	)

260 
	#º_£qnum
 
º_hdr
.
icmp6_d©a32
[0]

	)

263 
	#ICMP6_RR_FLAGS_TEST
 0x80

	)

264 
	#ICMP6_RR_FLAGS_REQRESULT
 0x40

	)

265 
	#ICMP6_RR_FLAGS_FORCEAPPLY
 0x20

	)

266 
	#ICMP6_RR_FLAGS_SPECSITE
 0x10

	)

267 
	#ICMP6_RR_FLAGS_PREVDONE
 0x08

	)

269 
	sº_pco_m©ch


271 
uöt8_t
 
	mΩm_code
;

272 
uöt8_t
 
	mΩm_Àn
;

273 
uöt8_t
 
	mΩm_‹döÆ
;

274 
uöt8_t
 
	mΩm_m©chÀn
;

275 
uöt8_t
 
	mΩm_möÀn
;

276 
uöt8_t
 
	mΩm_maxÀn
;

277 
uöt16_t
 
	mΩm_ª£rved
;

278 
ö6_addr
 
	mΩm_¥efix
;

282 
	#RPM_PCO_ADD
 1

	)

283 
	#RPM_PCO_CHANGE
 2

	)

284 
	#RPM_PCO_SETGLOBAL
 3

	)

286 
	sº_pco_u£


288 
uöt8_t
 
	mΩu_u£Àn
;

289 
uöt8_t
 
	mΩu_kì∂í
;

290 
uöt8_t
 
	mΩu_ømask
;

291 
uöt8_t
 
	mΩu_øÊags
;

292 
uöt32_t
 
	mΩu_v…ime
;

293 
uöt32_t
 
	mΩu_∂time
;

294 
uöt32_t
 
	mΩu_Êags
;

295 
ö6_addr
 
	mΩu_¥efix
;

298 
	#ICMP6_RR_PCOUSE_RAFLAGS_ONLINK
 0x20

	)

299 
	#ICMP6_RR_PCOUSE_RAFLAGS_AUTO
 0x10

	)

301 #i‡
BYTE_ORDER
 =
BIG_ENDIAN


302 
	#ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME
 0x80000000

	)

303 
	#ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME
 0x40000000

	)

304 #ñi‡
BYTE_ORDER
 =
LITTLE_ENDIAN


305 
	#ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME
 0x80

	)

306 
	#ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME
 0x40

	)

309 
	sº_ªsu…


311 
uöt16_t
 
	mºr_Êags
;

312 
uöt8_t
 
	mºr_‹döÆ
;

313 
uöt8_t
 
	mºr_m©chedÀn
;

314 
uöt32_t
 
	mºr_ifid
;

315 
ö6_addr
 
	mºr_¥efix
;

318 #i‡
BYTE_ORDER
 =
BIG_ENDIAN


319 
	#ICMP6_RR_RESULT_FLAGS_OOB
 0x0002

	)

320 
	#ICMP6_RR_RESULT_FLAGS_FORBIDDEN
 0x0001

	)

321 #ñi‡
BYTE_ORDER
 =
LITTLE_ENDIAN


322 
	#ICMP6_RR_RESULT_FLAGS_OOB
 0x0200

	)

323 
	#ICMP6_RR_RESULT_FLAGS_FORBIDDEN
 0x0100

	)

327 
	snd_›t_adv_öãrvÆ


329 
uöt8_t
 
	mnd_›t_adv_öãrvÆ_ty≥
;

330 
uöt8_t
 
	mnd_›t_adv_öãrvÆ_Àn
;

331 
uöt16_t
 
	mnd_›t_adv_öãrvÆ_ª£rved
;

332 
uöt32_t
 
	mnd_›t_adv_öãrvÆ_ivÆ
;

336 
	snd_›t_home_agít_öfo


338 
uöt8_t
 
	mnd_›t_home_agít_öfo_ty≥
;

339 
uöt8_t
 
	mnd_›t_home_agít_öfo_Àn
;

340 
uöt16_t
 
	mnd_›t_home_agít_öfo_ª£rved
;

341 
uöt16_t
 
	mnd_›t_home_agít_öfo_¥e„ªn˚
;

342 
uöt16_t
 
	mnd_›t_home_agít_öfo_li„time
;

	@/usr/include/netinet/in.h

19 #i‚def 
_NETINET_IN_H


20 
	#_NETINET_IN_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<°döt.h
>

24 
	~<sys/sockë.h
>

25 
	~<bôs/ty≥s.h
>

28 
__BEGIN_DECLS


31 
uöt32_t
 
	tö_addr_t
;

32 
	sö_addr


34 
ö_addr_t
 
	ms_addr
;

38 
	~<bôs/ö.h
>

43 
	mIPPROTO_IP
 = 0,

44 
	#IPPROTO_IP
 
IPPROTO_IP


	)

45 
	mIPPROTO_ICMP
 = 1,

46 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

47 
	mIPPROTO_IGMP
 = 2,

48 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

49 
	mIPPROTO_IPIP
 = 4,

50 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

51 
	mIPPROTO_TCP
 = 6,

52 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

53 
	mIPPROTO_EGP
 = 8,

54 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

55 
	mIPPROTO_PUP
 = 12,

56 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

57 
	mIPPROTO_UDP
 = 17,

58 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

59 
	mIPPROTO_IDP
 = 22,

60 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

61 
	mIPPROTO_TP
 = 29,

62 
	#IPPROTO_TP
 
IPPROTO_TP


	)

63 
	mIPPROTO_DCCP
 = 33,

64 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

65 
	mIPPROTO_IPV6
 = 41,

66 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

67 
	mIPPROTO_RSVP
 = 46,

68 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

69 
	mIPPROTO_GRE
 = 47,

70 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

71 
	mIPPROTO_ESP
 = 50,

72 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

73 
	mIPPROTO_AH
 = 51,

74 
	#IPPROTO_AH
 
IPPROTO_AH


	)

75 
	mIPPROTO_MTP
 = 92,

76 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

77 
	mIPPROTO_BEETPH
 = 94,

78 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

79 
	mIPPROTO_ENCAP
 = 98,

80 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

81 
	mIPPROTO_PIM
 = 103,

82 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

83 
	mIPPROTO_COMP
 = 108,

84 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

85 
	mIPPROTO_SCTP
 = 132,

86 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

87 
	mIPPROTO_UDPLITE
 = 136,

88 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

89 
	mIPPROTO_RAW
 = 255,

90 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

91 
	mIPPROTO_MAX


97 #i‡!
__USE_KERNEL_IPV6_DEFS


100 
	mIPPROTO_HOPOPTS
 = 0,

101 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

102 
	mIPPROTO_ROUTING
 = 43,

103 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

104 
	mIPPROTO_FRAGMENT
 = 44,

105 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

106 
	mIPPROTO_ICMPV6
 = 58,

107 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

108 
	mIPPROTO_NONE
 = 59,

109 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

110 
	mIPPROTO_DSTOPTS
 = 60,

111 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

112 
	mIPPROTO_MH
 = 135

113 
	#IPPROTO_MH
 
IPPROTO_MH


	)

118 
uöt16_t
 
	tö_p‹t_t
;

123 
	mIPPORT_ECHO
 = 7,

124 
	mIPPORT_DISCARD
 = 9,

125 
	mIPPORT_SYSTAT
 = 11,

126 
	mIPPORT_DAYTIME
 = 13,

127 
	mIPPORT_NETSTAT
 = 15,

128 
	mIPPORT_FTP
 = 21,

129 
	mIPPORT_TELNET
 = 23,

130 
	mIPPORT_SMTP
 = 25,

131 
	mIPPORT_TIMESERVER
 = 37,

132 
	mIPPORT_NAMESERVER
 = 42,

133 
	mIPPORT_WHOIS
 = 43,

134 
	mIPPORT_MTP
 = 57,

136 
	mIPPORT_TFTP
 = 69,

137 
	mIPPORT_RJE
 = 77,

138 
	mIPPORT_FINGER
 = 79,

139 
	mIPPORT_TTYLINK
 = 87,

140 
	mIPPORT_SUPDUP
 = 95,

143 
	mIPPORT_EXECSERVER
 = 512,

144 
	mIPPORT_LOGINSERVER
 = 513,

145 
	mIPPORT_CMDSERVER
 = 514,

146 
	mIPPORT_EFSSERVER
 = 520,

149 
	mIPPORT_BIFFUDP
 = 512,

150 
	mIPPORT_WHOSERVER
 = 513,

151 
	mIPPORT_ROUTESERVER
 = 520,

154 
	mIPPORT_RESERVED
 = 1024,

157 
	mIPPORT_USERRESERVED
 = 5000

165 
	#IN_CLASSA
(
a
Ë((((
ö_addr_t
)◊)Ë& 0x80000000Ë=0)

	)

166 
	#IN_CLASSA_NET
 0xff000000

	)

167 
	#IN_CLASSA_NSHIFT
 24

	)

168 
	#IN_CLASSA_HOST
 (0xfffffff‡& ~
IN_CLASSA_NET
)

	)

169 
	#IN_CLASSA_MAX
 128

	)

171 
	#IN_CLASSB
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xc0000000Ë=0x80000000)

	)

172 
	#IN_CLASSB_NET
 0xffff0000

	)

173 
	#IN_CLASSB_NSHIFT
 16

	)

174 
	#IN_CLASSB_HOST
 (0xfffffff‡& ~
IN_CLASSB_NET
)

	)

175 
	#IN_CLASSB_MAX
 65536

	)

177 
	#IN_CLASSC
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xc0000000)

	)

178 
	#IN_CLASSC_NET
 0xffffff00

	)

179 
	#IN_CLASSC_NSHIFT
 8

	)

180 
	#IN_CLASSC_HOST
 (0xfffffff‡& ~
IN_CLASSC_NET
)

	)

182 
	#IN_CLASSD
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xe0000000)

	)

183 
	#IN_MULTICAST
(
a
Ë
	`IN_CLASSD
◊)

	)

185 
	#IN_EXPERIMENTAL
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xe0000000)

	)

186 
	#IN_BADCLASS
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xf0000000)

	)

189 
	#INADDR_ANY
 ((
ö_addr_t
Ë0x00000000)

	)

191 
	#INADDR_BROADCAST
 ((
ö_addr_t
Ë0xffffffff)

	)

193 
	#INADDR_NONE
 ((
ö_addr_t
Ë0xffffffff)

	)

196 
	#IN_LOOPBACKNET
 127

	)

198 #i‚de‡
INADDR_LOOPBACK


199 
	#INADDR_LOOPBACK
 ((
ö_addr_t
Ë0x7f000001Ë

	)

203 
	#INADDR_UNSPEC_GROUP
 ((
ö_addr_t
Ë0xe0000000Ë

	)

204 
	#INADDR_ALLHOSTS_GROUP
 ((
ö_addr_t
Ë0xe0000001Ë

	)

205 
	#INADDR_ALLRTRS_GROUP
 ((
ö_addr_t
Ë0xe0000002Ë

	)

206 
	#INADDR_MAX_LOCAL_GROUP
 ((
ö_addr_t
Ë0xe00000ffË

	)

208 #i‡!
__USE_KERNEL_IPV6_DEFS


210 
	sö6_addr


214 
uöt8_t
 
	m__u6_addr8
[16];

215 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


216 
uöt16_t
 
	m__u6_addr16
[8];

217 
uöt32_t
 
	m__u6_addr32
[4];

219 } 
	m__ö6_u
;

220 
	#s6_addr
 
__ö6_u
.
__u6_addr8


	)

221 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


222 
	#s6_addr16
 
__ö6_u
.
__u6_addr16


	)

223 
	#s6_addr32
 
__ö6_u
.
__u6_addr32


	)

228 c⁄° 
ö6_addr
 
ö6addr_™y
;

229 c⁄° 
ö6_addr
 
ö6addr_lo›back
;

230 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

231 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

233 
	#INET_ADDRSTRLEN
 16

	)

234 
	#INET6_ADDRSTRLEN
 46

	)

238 
	ssockaddr_ö


240 
__SOCKADDR_COMMON
 (
sö_
);

241 
ö_p‹t_t
 
	msö_p‹t
;

242 
ö_addr
 
	msö_addr
;

245 
	msö_zîo
[ (
sockaddr
) -

246 
__SOCKADDR_COMMON_SIZE
 -

247  (
ö_p‹t_t
) -

248  (
ö_addr
)];

251 #i‡!
__USE_KERNEL_IPV6_DEFS


253 
	ssockaddr_ö6


255 
__SOCKADDR_COMMON
 (
sö6_
);

256 
ö_p‹t_t
 
	msö6_p‹t
;

257 
uöt32_t
 
	msö6_Êowöfo
;

258 
ö6_addr
 
	msö6_addr
;

259 
uöt32_t
 
	msö6_sc›e_id
;

263 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


265 
	sù_mªq


268 
ö_addr
 
	mimr_mu…üddr
;

271 
ö_addr
 
	mimr_öãrÁ˚
;

274 
	sù_mªq_sour˚


277 
ö_addr
 
	mimr_mu…üddr
;

280 
ö_addr
 
	mimr_öãrÁ˚
;

283 
ö_addr
 
	mimr_sour˚addr
;

287 #i‡!
__USE_KERNEL_IPV6_DEFS


289 
	sùv6_mªq


292 
ö6_addr
 
	mùv6mr_mu…üddr
;

295 
	mùv6mr_öãrÁ˚
;

299 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


301 
	sgroup_ªq


304 
uöt32_t
 
	mgr_öãrÁ˚
;

307 
sockaddr_°‹age
 
	mgr_group
;

310 
	sgroup_sour˚_ªq


313 
uöt32_t
 
	mg§_öãrÁ˚
;

316 
sockaddr_°‹age
 
	mg§_group
;

319 
sockaddr_°‹age
 
	mg§_sour˚
;

324 
	sù_msfûãr


327 
ö_addr
 
	mimsf_mu…üddr
;

330 
ö_addr
 
	mimsf_öãrÁ˚
;

333 
uöt32_t
 
	mimsf_fmode
;

336 
uöt32_t
 
	mimsf_num§c
;

338 
ö_addr
 
	mimsf_¶i°
[1];

341 
	#IP_MSFILTER_SIZE
(
num§c
Ë( (
ù_msfûãr
) \

342 -  (
ö_addr
) \

343 + (
num§c
Ë*  (
ö_addr
))

	)

345 
	sgroup_fûãr


348 
uöt32_t
 
	mgf_öãrÁ˚
;

351 
sockaddr_°‹age
 
	mgf_group
;

354 
uöt32_t
 
	mgf_fmode
;

357 
uöt32_t
 
	mgf_num§c
;

359 
sockaddr_°‹age
 
	mgf_¶i°
[1];

362 
	#GROUP_FILTER_SIZE
(
num§c
Ë( (
group_fûãr
) \

363 -  (
sockaddr_°‹age
) \

364 + ((
num§c
) \

365 *  (
sockaddr_°‹age
)))

	)

375 
uöt32_t
 
	$¡ohl
 (
uöt32_t
 
__√é⁄g
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

376 
uöt16_t
 
	$¡ohs
 (
uöt16_t
 
__√tsh‹t
)

377 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

378 
uöt32_t
 
	$ht⁄l
 (
uöt32_t
 
__ho°l⁄g
)

379 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

380 
uöt16_t
 
	$ht⁄s
 (
uöt16_t
 
__ho°sh‹t
)

381 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

383 
	~<ídün.h
>

386 
	~<bôs/byãsw≠.h
>

388 #ifde‡
__OPTIMIZE__


392 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


395 
	#¡ohl
(
x
Ë(x)

	)

396 
	#¡ohs
(
x
Ë(x)

	)

397 
	#ht⁄l
(
x
Ë(x)

	)

398 
	#ht⁄s
(
x
Ë(x)

	)

400 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


401 
	#¡ohl
(
x
Ë
	`__bsw≠_32
 (x)

	)

402 
	#¡ohs
(
x
Ë
	`__bsw≠_16
 (x)

	)

403 
	#ht⁄l
(
x
Ë
	`__bsw≠_32
 (x)

	)

404 
	#ht⁄s
(
x
Ë
	`__bsw≠_16
 (x)

	)

409 #ifde‡
__GNUC__


410 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

411 (
__exãnsi⁄__
 \

412 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

413 
__a
->
s6_addr32
[0] == 0 \

414 && 
__a
->
s6_addr32
[1] == 0 \

415 && 
__a
->
s6_addr32
[2] == 0 \

416 && 
__a
->
s6_addr32
[3] =0; 
	}
}))

	)

418 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

419 (
__exãnsi⁄__
 \

420 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

421 
__a
->
s6_addr32
[0] == 0 \

422 && 
__a
->
s6_addr32
[1] == 0 \

423 && 
__a
->
s6_addr32
[2] == 0 \

424 && 
__a
->
s6_addr32
[3] =
	`ht⁄l
 (1); }))

	)

426 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

427 (
__exãnsi⁄__
 \

428 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

429 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„800000); }))

	)

431 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

432 (
__exãnsi⁄__
 \

433 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

434 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„c00000); }))

	)

436 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

437 (
__exãnsi⁄__
 \

438 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

439 
__a
->
s6_addr32
[0] == 0 \

440 && 
__a
->
s6_addr32
[1] == 0 \

441 && 
__a
->
s6_addr32
[2] =
	`ht⁄l
 (0xffff); }))

	)

443 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

444 (
__exãnsi⁄__
 \

445 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

446 
__a
->
s6_addr32
[0] == 0 \

447 && 
__a
->
s6_addr32
[1] == 0 \

448 && 
__a
->
s6_addr32
[2] == 0 \

449 && 
	`¡ohl
 (
__a
->
s6_addr32
[3]Ë> 1; }))

	)

451 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

452 (
__exãnsi⁄__
 \

453 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

454 c⁄° 
ö6_addr
 *
__b
 = (c⁄° ö6_add∏*Ë(
b
); \

455 
__a
->
s6_addr32
[0] =
__b
->s6_addr32[0] \

456 && 
__a
->
s6_addr32
[1] =
__b
->s6_addr32[1] \

457 && 
__a
->
s6_addr32
[2] =
__b
->s6_addr32[2] \

458 && 
__a
->
s6_addr32
[3] =
__b
->s6_addr32[3]; }))

	)

460 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

461 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

462 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

463 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

464 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =0)

	)

466 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

467 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

468 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

469 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

470 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =
	`ht⁄l
 (1))

	)

472 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

473 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

474 =
	`ht⁄l
 (0x„800000))

	)

476 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

477 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

478 =
	`ht⁄l
 (0x„c00000))

	)

480 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

481 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

482 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

483 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =
	`ht⁄l
 (0xffff)))

	)

485 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

486 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

487 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

488 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0) \

489 && (
	`¡ohl
 (((c⁄° 
uöt32_t
 *Ë(
a
))[3]Ë> 1))

	)

491 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

492 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] =((c⁄° uöt32_à*Ë(
b
))[0]) \

493 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] =((c⁄° uöt32_à*Ë(
b
))[1]) \

494 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =((c⁄° uöt32_à*Ë(
b
))[2]) \

495 && (((c⁄° 
uöt32_t
 *Ë(
a
))[3] =((c⁄° uöt32_à*Ë(
b
))[3]))

	)

498 
	#IN6_IS_ADDR_MULTICAST
(
a
Ë(((c⁄° 
uöt8_t
 *Ë◊))[0] =0xff)

	)

500 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


502 
	$bödªsvp‹t
 (
__sockfd
, 
sockaddr_ö
 *
__sock_ö
Ë
__THROW
;

505 
	$bödªsvp‹t6
 (
__sockfd
, 
sockaddr_ö6
 *
__sock_ö
)

506 
__THROW
;

510 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

511 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

512 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x1))

	)

514 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

515 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

516 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x2))

	)

518 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

519 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

520 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x5))

	)

522 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

523 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

524 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x8))

	)

526 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

527 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

528 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0xe))

	)

531 #ifde‡
__USE_GNU


532 
cmsghdr
;

534 #i‡!
__USE_KERNEL_IPV6_DEFS


536 
	sö6_pktöfo


538 
ö6_addr
 
ùi6_addr
;

539 
ùi6_ifödex
;

543 
	sù6_mtuöfo


545 
sockaddr_ö6
 
ù6m_addr
;

546 
uöt32_t
 
ù6m_mtu
;

551 
	$öë6_›ti⁄_•a˚
 (
__nbyãs
)

552 
__THROW
 
__©åibuã_dïªˇãd__
;

553 
	$öë6_›ti⁄_öô
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

554 
__ty≥
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

555 
	$öë6_›ti⁄_≠≥nd
 (
cmsghdr
 *
__cmsg
,

556 c⁄° 
uöt8_t
 *
__ty≥p
, 
__mu…x
,

557 
__∂usy
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

558 
uöt8_t
 *
	$öë6_›ti⁄_Æloc
 (
cmsghdr
 *
__cmsg
, 
__d©Æí
,

559 
__mu…x
, 
__∂usy
)

560 
__THROW
 
__©åibuã_dïªˇãd__
;

561 
	$öë6_›ti⁄_√xt
 (c⁄° 
cmsghdr
 *
__cmsg
,

562 
uöt8_t
 **
__çåp
)

563 
__THROW
 
__©åibuã_dïªˇãd__
;

564 
	$öë6_›ti⁄_föd
 (c⁄° 
cmsghdr
 *
__cmsg
,

565 
uöt8_t
 **
__çåp
, 
__ty≥
)

566 
__THROW
 
__©åibuã_dïªˇãd__
;

570 
	$öë6_›t_öô
 (*
__extbuf
, 
sockÀn_t
 
__exéí
Ë
__THROW
;

571 
	$öë6_›t_≠≥nd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

572 
uöt8_t
 
__ty≥
, 
sockÀn_t
 
__Àn
, uöt8_à
__Æign
,

573 **
__d©abuÂ
Ë
__THROW
;

574 
	$öë6_›t_föish
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
)

575 
__THROW
;

576 
	$öë6_›t_£t_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

577 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

578 
	$öë6_›t_√xt
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

579 
uöt8_t
 *
__ty≥p
, 
sockÀn_t
 *
__À≈
,

580 **
__d©abuÂ
Ë
__THROW
;

581 
	$öë6_›t_föd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

582 
uöt8_t
 
__ty≥
, 
sockÀn_t
 *
__À≈
,

583 **
__d©abuÂ
Ë
__THROW
;

584 
	$öë6_›t_gë_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

585 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

589 
sockÀn_t
 
	$öë6_πh_•a˚
 (
__ty≥
, 
__£gmíts
Ë
__THROW
;

590 *
	$öë6_πh_öô
 (*
__bp
, 
sockÀn_t
 
__bp_Àn
, 
__ty≥
,

591 
__£gmíts
Ë
__THROW
;

592 
	$öë6_πh_add
 (*
__bp
, c⁄° 
ö6_addr
 *
__addr
Ë
__THROW
;

593 
	$öë6_πh_ªvî£
 (c⁄° *
__ö
, *
__out
Ë
__THROW
;

594 
	$öë6_πh_£gmíts
 (c⁄° *
__bp
Ë
__THROW
;

595 
ö6_addr
 *
	$öë6_πh_gëaddr
 (c⁄° *
__bp
, 
__ödex
)

596 
__THROW
;

602 
	$gëùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

603 
ö_addr
 
__group
, 
uöt32_t
 *
__fmode
,

604 
uöt32_t
 *
__num§c
, 
ö_addr
 *
__¶i°
)

605 
__THROW
;

608 
	$£tùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

609 
ö_addr
 
__group
, 
uöt32_t
 
__fmode
,

610 
uöt32_t
 
__num§c
,

611 c⁄° 
ö_addr
 *
__¶i°
)

612 
__THROW
;

616 
	$gësour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

617 c⁄° 
sockaddr
 *
__group
,

618 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 *
__fmode
,

619 
uöt32_t
 *
__num§c
,

620 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

623 
	$£tsour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

624 c⁄° 
sockaddr
 *
__group
,

625 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 
__fmode
,

626 
uöt32_t
 
__num§c
,

627 c⁄° 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

630 
__END_DECLS


	@/usr/include/netinet/in_systm.h

19 #i‚de‡
_NETINET_IN_SYSTM_H


20 
	#_NETINET_IN_SYSTM_H
 1

	)

22 
	~<sys/cdefs.h
>

23 
	~<sys/ty≥s.h
>

25 
__BEGIN_DECLS


34 
u_öt16_t
 
	tn_sh‹t
;

35 
u_öt32_t
 
	tn_l⁄g
;

36 
u_öt32_t
 
	tn_time
;

38 
	g__END_DECLS


	@/usr/include/netinet/ip.h

18 #i‚de‡
__NETINET_IP_H


19 
	#__NETINET_IP_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<sys/ty≥s.h
>

24 
	~<√töë/ö.h
>

26 
__BEGIN_DECLS


28 
	stime°amp


30 
u_öt8_t
 
	mÀn
;

31 
u_öt8_t
 
	m±r
;

32 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


33 
	mÊags
:4;

34 
	movîÊow
:4;

35 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


36 
	movîÊow
:4;

37 
	mÊags
:4;

41 
u_öt32_t
 
	md©a
[9];

44 
	sùhdr


46 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


47 
	mihl
:4;

48 
	mvîsi⁄
:4;

49 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


50 
	mvîsi⁄
:4;

51 
	mihl
:4;

55 
u_öt8_t
 
	mtos
;

56 
u_öt16_t
 
	mtŸ_Àn
;

57 
u_öt16_t
 
	mid
;

58 
u_öt16_t
 
	m‰ag_off
;

59 
u_öt8_t
 
	mâl
;

60 
u_öt8_t
 
	m¥Ÿocﬁ
;

61 
u_öt16_t
 
	mcheck
;

62 
u_öt32_t
 
	mßddr
;

63 
u_öt32_t
 
	mdaddr
;

67 #ifde‡
__USE_BSD


107 
	sù


109 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


110 
	mù_hl
:4;

111 
	mù_v
:4;

113 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


114 
	mù_v
:4;

115 
	mù_hl
:4;

117 
u_öt8_t
 
	mù_tos
;

118 
u_sh‹t
 
	mù_Àn
;

119 
u_sh‹t
 
	mù_id
;

120 
u_sh‹t
 
	mù_off
;

121 
	#IP_RF
 0x8000

	)

122 
	#IP_DF
 0x4000

	)

123 
	#IP_MF
 0x2000

	)

124 
	#IP_OFFMASK
 0x1ff‡

	)

125 
u_öt8_t
 
	mù_âl
;

126 
u_öt8_t
 
	mù_p
;

127 
u_sh‹t
 
	mù_sum
;

128 
ö_addr
 
	mù_§c
, 
	mù_d°
;

134 
	sù_time°amp


136 
u_öt8_t
 
	mùt_code
;

137 
u_öt8_t
 
	mùt_Àn
;

138 
u_öt8_t
 
	mùt_±r
;

139 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


140 
	mùt_Êg
:4;

141 
	mùt_oÊw
:4;

143 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


144 
	mùt_oÊw
:4;

145 
	mùt_Êg
:4;

147 
u_öt32_t
 
	md©a
[9];

151 
	#IPVERSION
 4

	)

152 
	#IP_MAXPACKET
 65535

	)

160 
	#IPTOS_ECN_MASK
 0x03

	)

161 
	#IPTOS_ECN
(
x
Ë((xË& 
IPTOS_ECN_MASK
)

	)

162 
	#IPTOS_ECN_NOT_ECT
 0x00

	)

163 
	#IPTOS_ECN_ECT1
 0x01

	)

164 
	#IPTOS_ECN_ECT0
 0x02

	)

165 
	#IPTOS_ECN_CE
 0x03

	)

173 
	#IPTOS_DSCP_MASK
 0xfc

	)

174 
	#IPTOS_DSCP
(
x
Ë((xË& 
IPTOS_DSCP_MASK
)

	)

175 
	#IPTOS_DSCP_AF11
 0x28

	)

176 
	#IPTOS_DSCP_AF12
 0x30

	)

177 
	#IPTOS_DSCP_AF13
 0x38

	)

178 
	#IPTOS_DSCP_AF21
 0x48

	)

179 
	#IPTOS_DSCP_AF22
 0x50

	)

180 
	#IPTOS_DSCP_AF23
 0x58

	)

181 
	#IPTOS_DSCP_AF31
 0x68

	)

182 
	#IPTOS_DSCP_AF32
 0x70

	)

183 
	#IPTOS_DSCP_AF33
 0x78

	)

184 
	#IPTOS_DSCP_AF41
 0x88

	)

185 
	#IPTOS_DSCP_AF42
 0x90

	)

186 
	#IPTOS_DSCP_AF43
 0x98

	)

187 
	#IPTOS_DSCP_EF
 0xb8

	)

194 
	#IPTOS_CLASS_MASK
 0xe0

	)

195 
	#IPTOS_CLASS
(
˛ass
Ë((˛assË& 
IPTOS_CLASS_MASK
)

	)

196 
	#IPTOS_CLASS_CS0
 0x00

	)

197 
	#IPTOS_CLASS_CS1
 0x20

	)

198 
	#IPTOS_CLASS_CS2
 0x40

	)

199 
	#IPTOS_CLASS_CS3
 0x60

	)

200 
	#IPTOS_CLASS_CS4
 0x80

	)

201 
	#IPTOS_CLASS_CS5
 0xa0

	)

202 
	#IPTOS_CLASS_CS6
 0xc0

	)

203 
	#IPTOS_CLASS_CS7
 0xe0

	)

205 
	#IPTOS_CLASS_DEFAULT
 
IPTOS_CLASS_CS0


	)

211 
	#IPTOS_TOS_MASK
 0x1E

	)

212 
	#IPTOS_TOS
(
tos
Ë(—osË& 
IPTOS_TOS_MASK
)

	)

213 
	#IPTOS_LOWDELAY
 0x10

	)

214 
	#IPTOS_THROUGHPUT
 0x08

	)

215 
	#IPTOS_RELIABILITY
 0x04

	)

216 
	#IPTOS_LOWCOST
 0x02

	)

217 
	#IPTOS_MINCOST
 
IPTOS_LOWCOST


	)

222 
	#IPTOS_PREC_MASK
 
IPTOS_CLASS_MASK


	)

223 
	#IPTOS_PREC
(
tos
Ë
	`IPTOS_CLASS
—os)

	)

224 
	#IPTOS_PREC_NETCONTROL
 
IPTOS_CLASS_CS7


	)

225 
	#IPTOS_PREC_INTERNETCONTROL
 
IPTOS_CLASS_CS6


	)

226 
	#IPTOS_PREC_CRITIC_ECP
 
IPTOS_CLASS_CS5


	)

227 
	#IPTOS_PREC_FLASHOVERRIDE
 
IPTOS_CLASS_CS4


	)

228 
	#IPTOS_PREC_FLASH
 
IPTOS_CLASS_CS3


	)

229 
	#IPTOS_PREC_IMMEDIATE
 
IPTOS_CLASS_CS2


	)

230 
	#IPTOS_PREC_PRIORITY
 
IPTOS_CLASS_CS1


	)

231 
	#IPTOS_PREC_ROUTINE
 
IPTOS_CLASS_CS0


	)

236 
	#IPOPT_COPY
 0x80

	)

237 
	#IPOPT_CLASS_MASK
 0x60

	)

238 
	#IPOPT_NUMBER_MASK
 0x1f

	)

240 
	#IPOPT_COPIED
(
o
Ë((oË& 
IPOPT_COPY
)

	)

241 
	#IPOPT_CLASS
(
o
Ë((oË& 
IPOPT_CLASS_MASK
)

	)

242 
	#IPOPT_NUMBER
(
o
Ë((oË& 
IPOPT_NUMBER_MASK
)

	)

244 
	#IPOPT_CONTROL
 0x00

	)

245 
	#IPOPT_RESERVED1
 0x20

	)

246 
	#IPOPT_DEBMEAS
 0x40

	)

247 
	#IPOPT_MEASUREMENT
 
IPOPT_DEBMEAS


	)

248 
	#IPOPT_RESERVED2
 0x60

	)

250 
	#IPOPT_EOL
 0

	)

251 
	#IPOPT_END
 
IPOPT_EOL


	)

252 
	#IPOPT_NOP
 1

	)

253 
	#IPOPT_NOOP
 
IPOPT_NOP


	)

255 
	#IPOPT_RR
 7

	)

256 
	#IPOPT_TS
 68

	)

257 
	#IPOPT_TIMESTAMP
 
IPOPT_TS


	)

258 
	#IPOPT_SECURITY
 130

	)

259 
	#IPOPT_SEC
 
IPOPT_SECURITY


	)

260 
	#IPOPT_LSRR
 131

	)

261 
	#IPOPT_SATID
 136

	)

262 
	#IPOPT_SID
 
IPOPT_SATID


	)

263 
	#IPOPT_SSRR
 137

	)

264 
	#IPOPT_RA
 148

	)

269 
	#IPOPT_OPTVAL
 0

	)

270 
	#IPOPT_OLEN
 1

	)

271 
	#IPOPT_OFFSET
 2

	)

272 
	#IPOPT_MINOFF
 4

	)

274 
	#MAX_IPOPTLEN
 40

	)

277 
	#IPOPT_TS_TSONLY
 0

	)

278 
	#IPOPT_TS_TSANDADDR
 1

	)

279 
	#IPOPT_TS_PRESPEC
 3

	)

282 
	#IPOPT_SECUR_UNCLASS
 0x0000

	)

283 
	#IPOPT_SECUR_CONFID
 0xf135

	)

284 
	#IPOPT_SECUR_EFTO
 0x789a

	)

285 
	#IPOPT_SECUR_MMMM
 0xbc4d

	)

286 
	#IPOPT_SECUR_RESTR
 0xaf13

	)

287 
	#IPOPT_SECUR_SECRET
 0xd788

	)

288 
	#IPOPT_SECUR_TOPSECRET
 0x6bc5

	)

293 
	#MAXTTL
 255

	)

294 
	#IPDEFTTL
 64

	)

295 
	#IPFRAGTTL
 60

	)

296 
	#IPTTLDEC
 1

	)

298 
	#IP_MSS
 576

	)

300 
	g__END_DECLS


	@/usr/include/netinet/ip_icmp.h

18 #i‚de‡
__NETINET_IP_ICMP_H


19 
	#__NETINET_IP_ICMP_H
 1

	)

21 
	~<sys/cdefs.h
>

22 
	~<sys/ty≥s.h
>

24 
__BEGIN_DECLS


26 
	sicmphdr


28 
u_öt8_t
 
	mty≥
;

29 
u_öt8_t
 
	mcode
;

30 
u_öt16_t
 
	mchecksum
;

35 
u_öt16_t
 
	mid
;

36 
u_öt16_t
 
	m£quí˚
;

37 } 
	mecho
;

38 
u_öt32_t
 
	mg©eway
;

41 
u_öt16_t
 
	m__unu£d
;

42 
u_öt16_t
 
	mmtu
;

43 } 
	m‰ag
;

44 } 
	mun
;

47 
	#ICMP_ECHOREPLY
 0

	)

48 
	#ICMP_DEST_UNREACH
 3

	)

49 
	#ICMP_SOURCE_QUENCH
 4

	)

50 
	#ICMP_REDIRECT
 5

	)

51 
	#ICMP_ECHO
 8

	)

52 
	#ICMP_TIME_EXCEEDED
 11

	)

53 
	#ICMP_PARAMETERPROB
 12

	)

54 
	#ICMP_TIMESTAMP
 13

	)

55 
	#ICMP_TIMESTAMPREPLY
 14

	)

56 
	#ICMP_INFO_REQUEST
 15

	)

57 
	#ICMP_INFO_REPLY
 16

	)

58 
	#ICMP_ADDRESS
 17

	)

59 
	#ICMP_ADDRESSREPLY
 18

	)

60 
	#NR_ICMP_TYPES
 18

	)

64 
	#ICMP_NET_UNREACH
 0

	)

65 
	#ICMP_HOST_UNREACH
 1

	)

66 
	#ICMP_PROT_UNREACH
 2

	)

67 
	#ICMP_PORT_UNREACH
 3

	)

68 
	#ICMP_FRAG_NEEDED
 4

	)

69 
	#ICMP_SR_FAILED
 5

	)

70 
	#ICMP_NET_UNKNOWN
 6

	)

71 
	#ICMP_HOST_UNKNOWN
 7

	)

72 
	#ICMP_HOST_ISOLATED
 8

	)

73 
	#ICMP_NET_ANO
 9

	)

74 
	#ICMP_HOST_ANO
 10

	)

75 
	#ICMP_NET_UNR_TOS
 11

	)

76 
	#ICMP_HOST_UNR_TOS
 12

	)

77 
	#ICMP_PKT_FILTERED
 13

	)

78 
	#ICMP_PREC_VIOLATION
 14

	)

79 
	#ICMP_PREC_CUTOFF
 15

	)

80 
	#NR_ICMP_UNREACH
 15

	)

83 
	#ICMP_REDIR_NET
 0

	)

84 
	#ICMP_REDIR_HOST
 1

	)

85 
	#ICMP_REDIR_NETTOS
 2

	)

86 
	#ICMP_REDIR_HOSTTOS
 3

	)

89 
	#ICMP_EXC_TTL
 0

	)

90 
	#ICMP_EXC_FRAGTIME
 1

	)

93 #ifde‡
__USE_BSD


125 
	~<√töë/ö.h
>

126 
	~<√töë/ù.h
>

131 
	sicmp_ø_addr


133 
u_öt32_t
 
	múa_addr
;

134 
u_öt32_t
 
	múa_¥e„ªn˚
;

137 
	sicmp


139 
u_öt8_t
 
	micmp_ty≥
;

140 
u_öt8_t
 
	micmp_code
;

141 
u_öt16_t
 
	micmp_cksum
;

144 
u_ch¨
 
	mih_µå
;

145 
ö_addr
 
	mih_gwaddr
;

146 
	sih_id£q


148 
u_öt16_t
 
	micd_id
;

149 
u_öt16_t
 
	micd_£q
;

150 } 
	mih_id£q
;

151 
u_öt32_t
 
	mih_void
;

154 
	sih_pmtu


156 
u_öt16_t
 
	mùm_void
;

157 
u_öt16_t
 
	mùm_√xtmtu
;

158 } 
	mih_pmtu
;

160 
	sih_πødv


162 
u_öt8_t
 
	mút_num_addrs
;

163 
u_öt8_t
 
	mút_w∑
;

164 
u_öt16_t
 
	mút_li„time
;

165 } 
	mih_πødv
;

166 } 
	micmp_hun
;

167 
	#icmp_µå
 
icmp_hun
.
ih_µå


	)

168 
	#icmp_gwaddr
 
icmp_hun
.
ih_gwaddr


	)

169 
	#icmp_id
 
icmp_hun
.
ih_id£q
.
icd_id


	)

170 
	#icmp_£q
 
icmp_hun
.
ih_id£q
.
icd_£q


	)

171 
	#icmp_void
 
icmp_hun
.
ih_void


	)

172 
	#icmp_pmvoid
 
icmp_hun
.
ih_pmtu
.
ùm_void


	)

173 
	#icmp_√xtmtu
 
icmp_hun
.
ih_pmtu
.
ùm_√xtmtu


	)

174 
	#icmp_num_addrs
 
icmp_hun
.
ih_πødv
.
út_num_addrs


	)

175 
	#icmp_w∑
 
icmp_hun
.
ih_πødv
.
út_w∑


	)

176 
	#icmp_li„time
 
icmp_hun
.
ih_πødv
.
út_li„time


	)

181 
u_öt32_t
 
	môs_Ÿime
;

182 
u_öt32_t
 
	môs_πime
;

183 
u_öt32_t
 
	môs_âime
;

184 } 
	mid_ts
;

187 
ù
 
	midi_ù
;

189 } 
	mid_ù
;

190 
icmp_ø_addr
 
	mid_ødv
;

191 
u_öt32_t
 
	mid_mask
;

192 
u_öt8_t
 
	mid_d©a
[1];

193 } 
	micmp_dun
;

194 
	#icmp_Ÿime
 
icmp_dun
.
id_ts
.
ôs_Ÿime


	)

195 
	#icmp_πime
 
icmp_dun
.
id_ts
.
ôs_πime


	)

196 
	#icmp_âime
 
icmp_dun
.
id_ts
.
ôs_âime


	)

197 
	#icmp_ù
 
icmp_dun
.
id_ù
.
idi_ù


	)

198 
	#icmp_ødv
 
icmp_dun
.
id_ødv


	)

199 
	#icmp_mask
 
icmp_dun
.
id_mask


	)

200 
	#icmp_d©a
 
icmp_dun
.
id_d©a


	)

211 
	#ICMP_MINLEN
 8

	)

212 
	#ICMP_TSLEN
 (8 + 3 *  (
n_time
)Ë

	)

213 
	#ICMP_MASKLEN
 12

	)

214 
	#ICMP_ADVLENMIN
 (8 +  (
ù
Ë+ 8Ë

	)

215 #i‚de‡
_IP_VHL


216 
	#ICMP_ADVLEN
(
p
Ë(8 + (’)->
icmp_ù
.
ù_hl
 << 2Ë+ 8)

	)

219 
	#ICMP_ADVLEN
(
p
Ë(8 + (
	`IP_VHL_HL
(’)->
icmp_ù
.
ù_vhl
Ë<< 2Ë+ 8)

	)

225 
	#ICMP_UNREACH
 3

	)

226 
	#ICMP_SOURCEQUENCH
 4

	)

227 
	#ICMP_ROUTERADVERT
 9

	)

228 
	#ICMP_ROUTERSOLICIT
 10

	)

229 
	#ICMP_TIMXCEED
 11

	)

230 
	#ICMP_PARAMPROB
 12

	)

231 
	#ICMP_TSTAMP
 13

	)

232 
	#ICMP_TSTAMPREPLY
 14

	)

233 
	#ICMP_IREQ
 15

	)

234 
	#ICMP_IREQREPLY
 16

	)

235 
	#ICMP_MASKREQ
 17

	)

236 
	#ICMP_MASKREPLY
 18

	)

238 
	#ICMP_MAXTYPE
 18

	)

241 
	#ICMP_UNREACH_NET
 0

	)

242 
	#ICMP_UNREACH_HOST
 1

	)

243 
	#ICMP_UNREACH_PROTOCOL
 2

	)

244 
	#ICMP_UNREACH_PORT
 3

	)

245 
	#ICMP_UNREACH_NEEDFRAG
 4

	)

246 
	#ICMP_UNREACH_SRCFAIL
 5

	)

247 
	#ICMP_UNREACH_NET_UNKNOWN
 6

	)

248 
	#ICMP_UNREACH_HOST_UNKNOWN
 7

	)

249 
	#ICMP_UNREACH_ISOLATED
 8

	)

250 
	#ICMP_UNREACH_NET_PROHIB
 9

	)

251 
	#ICMP_UNREACH_HOST_PROHIB
 10

	)

252 
	#ICMP_UNREACH_TOSNET
 11

	)

253 
	#ICMP_UNREACH_TOSHOST
 12

	)

254 
	#ICMP_UNREACH_FILTER_PROHIB
 13

	)

255 
	#ICMP_UNREACH_HOST_PRECEDENCE
 14

	)

256 
	#ICMP_UNREACH_PRECEDENCE_CUTOFF
 15

	)

259 
	#ICMP_REDIRECT_NET
 0

	)

260 
	#ICMP_REDIRECT_HOST
 1

	)

261 
	#ICMP_REDIRECT_TOSNET
 2

	)

262 
	#ICMP_REDIRECT_TOSHOST
 3

	)

265 
	#ICMP_TIMXCEED_INTRANS
 0

	)

266 
	#ICMP_TIMXCEED_REASS
 1

	)

269 
	#ICMP_PARAMPROB_OPTABSENT
 1

	)

271 
	#ICMP_INFOTYPE
(
ty≥
) \

272 ((
ty≥
Ë=
ICMP_ECHOREPLY
 || (ty≥Ë=
ICMP_ECHO
 || \

273 (
ty≥
Ë=
ICMP_ROUTERADVERT
 || (ty≥Ë=
ICMP_ROUTERSOLICIT
 || \

274 (
ty≥
Ë=
ICMP_TSTAMP
 || (ty≥Ë=
ICMP_TSTAMPREPLY
 || \

275 (
ty≥
Ë=
ICMP_IREQ
 || (ty≥Ë=
ICMP_IREQREPLY
 || \

276 (
ty≥
Ë=
ICMP_MASKREQ
 || (ty≥Ë=
ICMP_MASKREPLY
)

	)

280 
	g__END_DECLS


	@/usr/include/netinet/tcp.h

32 #i‚de‡
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<„©uªs.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

65 #ifde‡
__USE_MISC


66 
	~<sys/ty≥s.h
>

67 
	~<sys/sockë.h
>

69 #ifde‡
__FAVOR_BSD


70 
u_öt32_t
 
	tt˝_£q
;

75 
	st˝hdr


77 
u_öt16_t
 
	mth_•‹t
;

78 
u_öt16_t
 
	mth_dp‹t
;

79 
t˝_£q
 
	mth_£q
;

80 
t˝_£q
 
	mth_ack
;

81 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


82 
u_öt8_t
 
	mth_x2
:4;

83 
u_öt8_t
 
	mth_off
:4;

85 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


86 
u_öt8_t
 
	mth_off
:4;

87 
u_öt8_t
 
	mth_x2
:4;

89 
u_öt8_t
 
	mth_Êags
;

90 
	#TH_FIN
 0x01

	)

91 
	#TH_SYN
 0x02

	)

92 
	#TH_RST
 0x04

	)

93 
	#TH_PUSH
 0x08

	)

94 
	#TH_ACK
 0x10

	)

95 
	#TH_URG
 0x20

	)

96 
u_öt16_t
 
	mth_wö
;

97 
u_öt16_t
 
	mth_sum
;

98 
u_öt16_t
 
	mth_uΩ
;

102 
	st˝hdr


104 
u_öt16_t
 
	msour˚
;

105 
u_öt16_t
 
	mde°
;

106 
u_öt32_t
 
	m£q
;

107 
u_öt32_t
 
	mack_£q
;

108 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


109 
u_öt16_t
 
	mªs1
:4;

110 
u_öt16_t
 
	mdoff
:4;

111 
u_öt16_t
 
	mfö
:1;

112 
u_öt16_t
 
	msyn
:1;

113 
u_öt16_t
 
	mr°
:1;

114 
u_öt16_t
 
	mpsh
:1;

115 
u_öt16_t
 
	mack
:1;

116 
u_öt16_t
 
	murg
:1;

117 
u_öt16_t
 
	mªs2
:2;

118 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


119 
u_öt16_t
 
	mdoff
:4;

120 
u_öt16_t
 
	mªs1
:4;

121 
u_öt16_t
 
	mªs2
:2;

122 
u_öt16_t
 
	murg
:1;

123 
u_öt16_t
 
	mack
:1;

124 
u_öt16_t
 
	mpsh
:1;

125 
u_öt16_t
 
	mr°
:1;

126 
u_öt16_t
 
	msyn
:1;

127 
u_öt16_t
 
	mfö
:1;

131 
u_öt16_t
 
	mwödow
;

132 
u_öt16_t
 
	mcheck
;

133 
u_öt16_t
 
	murg_±r
;

139 
	mTCP_ESTABLISHED
 = 1,

140 
	mTCP_SYN_SENT
,

141 
	mTCP_SYN_RECV
,

142 
	mTCP_FIN_WAIT1
,

143 
	mTCP_FIN_WAIT2
,

144 
	mTCP_TIME_WAIT
,

145 
	mTCP_CLOSE
,

146 
	mTCP_CLOSE_WAIT
,

147 
	mTCP_LAST_ACK
,

148 
	mTCP_LISTEN
,

149 
	mTCP_CLOSING


152 
	#TCPOPT_EOL
 0

	)

153 
	#TCPOPT_NOP
 1

	)

154 
	#TCPOPT_MAXSEG
 2

	)

155 
	#TCPOLEN_MAXSEG
 4

	)

156 
	#TCPOPT_WINDOW
 3

	)

157 
	#TCPOLEN_WINDOW
 3

	)

158 
	#TCPOPT_SACK_PERMITTED
 4

	)

159 
	#TCPOLEN_SACK_PERMITTED
 2

	)

160 
	#TCPOPT_SACK
 5

	)

161 
	#TCPOPT_TIMESTAMP
 8

	)

162 
	#TCPOLEN_TIMESTAMP
 10

	)

163 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2Ë

	)

165 
	#TCPOPT_TSTAMP_HDR
 \

166 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

174 
	#TCP_MSS
 512

	)

176 
	#TCP_MAXWIN
 65535

	)

178 
	#TCP_MAX_WINSHIFT
 14

	)

180 
	#SOL_TCP
 6

	)

183 
	#TCPI_OPT_TIMESTAMPS
 1

	)

184 
	#TCPI_OPT_SACK
 2

	)

185 
	#TCPI_OPT_WSCALE
 4

	)

186 
	#TCPI_OPT_ECN
 8

	)

189 
	et˝_ˇ_°©e


191 
	mTCP_CA_O≥n
 = 0,

192 
	mTCP_CA_Dis‹dî
 = 1,

193 
	mTCP_CA_CWR
 = 2,

194 
	mTCP_CA_Recovîy
 = 3,

195 
	mTCP_CA_Loss
 = 4

198 
	st˝_öfo


200 
u_öt8_t
 
	mt˝i_°©e
;

201 
u_öt8_t
 
	mt˝i_ˇ_°©e
;

202 
u_öt8_t
 
	mt˝i_ªå™smôs
;

203 
u_öt8_t
 
	mt˝i_¥obes
;

204 
u_öt8_t
 
	mt˝i_backoff
;

205 
u_öt8_t
 
	mt˝i_›ti⁄s
;

206 
u_öt8_t
 
	mt˝i_¢d_wsˇÀ
 : 4, 
	mt˝i_rcv_wsˇÀ
 : 4;

208 
u_öt32_t
 
	mt˝i_πo
;

209 
u_öt32_t
 
	mt˝i_©o
;

210 
u_öt32_t
 
	mt˝i_¢d_mss
;

211 
u_öt32_t
 
	mt˝i_rcv_mss
;

213 
u_öt32_t
 
	mt˝i_u«cked
;

214 
u_öt32_t
 
	mt˝i_ßcked
;

215 
u_öt32_t
 
	mt˝i_lo°
;

216 
u_öt32_t
 
	mt˝i_ªå™s
;

217 
u_öt32_t
 
	mt˝i_Áckës
;

220 
u_öt32_t
 
	mt˝i_œ°_d©a_£¡
;

221 
u_öt32_t
 
	mt˝i_œ°_ack_£¡
;

222 
u_öt32_t
 
	mt˝i_œ°_d©a_ªcv
;

223 
u_öt32_t
 
	mt˝i_œ°_ack_ªcv
;

226 
u_öt32_t
 
	mt˝i_pmtu
;

227 
u_öt32_t
 
	mt˝i_rcv_s°hªsh
;

228 
u_öt32_t
 
	mt˝i_πt
;

229 
u_öt32_t
 
	mt˝i_πtv¨
;

230 
u_öt32_t
 
	mt˝i_¢d_s°hªsh
;

231 
u_öt32_t
 
	mt˝i_¢d_cwnd
;

232 
u_öt32_t
 
	mt˝i_advmss
;

233 
u_öt32_t
 
	mt˝i_ª‹dîög
;

235 
u_öt32_t
 
	mt˝i_rcv_πt
;

236 
u_öt32_t
 
	mt˝i_rcv_•a˚
;

238 
u_öt32_t
 
	mt˝i_tŸÆ_ªå™s
;

243 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

245 
	st˝_md5sig


247 
sockaddr_°‹age
 
	mt˝m_addr
;

248 
u_öt16_t
 
	m__t˝m_∑d1
;

249 
u_öt16_t
 
	mt˝m_keyÀn
;

250 
u_öt32_t
 
	m__t˝m_∑d2
;

251 
u_öt8_t
 
	mt˝m_key
[
TCP_MD5SIG_MAXKEYLEN
];

255 
	st˝_ª∑ú_›t


257 
u_öt32_t
 
	m›t_code
;

258 
u_öt32_t
 
	m›t_vÆ
;

264 
	mTCP_NO_QUEUE
,

265 
	mTCP_RECV_QUEUE
,

266 
	mTCP_SEND_QUEUE
,

267 
	mTCP_QUEUES_NR
,

271 
	#TCP_COOKIE_MIN
 8

	)

272 
	#TCP_COOKIE_MAX
 16

	)

273 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

276 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0Ë

	)

277 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1Ë

	)

281 
	#TCP_S_DATA_IN
 (1 << 2Ë

	)

282 
	#TCP_S_DATA_OUT
 (1 << 3Ë

	)

284 
	#TCP_MSS_DEFAULT
 536U

	)

285 
	#TCP_MSS_DESIRED
 1220U

	)

287 
	st˝_cookõ_å™ß˘i⁄s


289 
u_öt16_t
 
	mt˝˘_Êags
;

290 
u_öt8_t
 
	m__t˝˘_∑d1
;

291 
u_öt8_t
 
	mt˝˘_cookõ_desúed
;

292 
u_öt16_t
 
	mt˝˘_s_d©a_desúed
;

293 
u_öt16_t
 
	mt˝˘_u£d
;

294 
u_öt8_t
 
	mt˝˘_vÆue
[
TCP_MSS_DEFAULT
];

	@/usr/include/pcreposix.h

5 #i‚de‡
_PCREPOSIX_H


6 
	#_PCREPOSIX_H


	)

45 
	~<°dlib.h
>

49 #ifde‡
__˝lu•lus


55 
	#REG_ICASE
 0x0001

	)

56 
	#REG_NEWLINE
 0x0002

	)

57 
	#REG_NOTBOL
 0x0004

	)

58 
	#REG_NOTEOL
 0x0008

	)

59 
	#REG_DOTALL
 0x0010

	)

60 
	#REG_NOSUB
 0x0020

	)

61 
	#REG_UTF8
 0x0040

	)

62 
	#REG_STARTEND
 0x0080

	)

63 
	#REG_NOTEMPTY
 0x0100

	)

64 
	#REG_UNGREEDY
 0x0200

	)

65 
	#REG_UCP
 0x0400

	)

70 
	#REG_EXTENDED
 0

	)

75 
REG_ASSERT
 = 1,

76 
REG_BADBR
,

77 
REG_BADPAT
,

78 
REG_BADRPT
,

79 
REG_EBRACE
,

80 
REG_EBRACK
,

81 
REG_ECOLLATE
,

82 
REG_ECTYPE
,

83 
REG_EESCAPE
,

84 
REG_EMPTY
,

85 
REG_EPAREN
,

86 
REG_ERANGE
,

87 
REG_ESIZE
,

88 
REG_ESPACE
,

89 
REG_ESUBREG
,

90 
REG_INVARG
,

91 
REG_NOMATCH


98 *
ª_p¸e
;

99 
size_t
 
ª_nsub
;

100 
size_t
 
ª_îroff£t
;

101 } 
	tªgex_t
;

105 
	tªgoff_t
;

108 
ªgoff_t
 
rm_so
;

109 
ªgoff_t
 
rm_eo
;

110 } 
	tªgm©ch_t
;

117 #i‡
deföed
(
_WIN32
Ë&& !deföed(
PCRE_STATIC
Ë&& !deföed(
PCREPOSIX_EXP_DECL
)

118 
	#PCREPOSIX_EXP_DECL
 
	`__de˛•ec
(
dŒimp‹t
)

	)

119 
	#PCREPOSIX_EXP_DEFN
 
	`__de˛•ec
(
dŒimp‹t
)

	)

124 #i‚de‡
PCREPOSIX_EXP_DECL


125 #ifde‡
__˝lu•lus


126 
	#PCREPOSIX_EXP_DECL
 "C"

	)

127 
	#PCREPOSIX_EXP_DEFN
 "C"

	)

129 
	#PCREPOSIX_EXP_DECL
 

	)

130 
	#PCREPOSIX_EXP_DEFN
 

	)

136 
PCREPOSIX_EXP_DECL
 
ªgcomp
(
ªgex_t
 *, const *, );

137 
PCREPOSIX_EXP_DECL
 
ªgexec
(c⁄° 
ªgex_t
 *, c⁄° *, 
size_t
,

138 
ªgm©ch_t
 *, );

139 
PCREPOSIX_EXP_DECL
 
size_t
 
ªgîr‹
(, c⁄° 
ªgex_t
 *, *, size_t);

140 
PCREPOSIX_EXP_DECL
 
ªg‰ì
(
ªgex_t
 *);

142 #ifde‡
__˝lu•lus


	@/usr/include/pwd.h

23 #i‚def 
_PWD_H


24 
	#_PWD_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<bôs/ty≥s.h
>

32 
	#__√ed_size_t


	)

33 
	~<°ddef.h
>

35 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


38 #i‚de‡
__gid_t_deföed


39 
__gid_t
 
	tgid_t
;

40 
	#__gid_t_deföed


	)

43 #i‚de‡
__uid_t_deföed


44 
__uid_t
 
	tuid_t
;

45 
	#__uid_t_deföed


	)

50 
	s∑sswd


52 *
	mpw_«me
;

53 *
	mpw_∑sswd
;

54 
__uid_t
 
	mpw_uid
;

55 
__gid_t
 
	mpw_gid
;

56 *
	mpw_gecos
;

57 *
	mpw_dú
;

58 *
	mpw_shñl
;

62 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_GNU


63 
	#__√ed_FILE


	)

64 
	~<°dio.h
>

68 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


73 
£çwít
 ();

79 
ídpwít
 ();

85 
∑sswd
 *
gëpwít
 ();

88 #ifdef 
__USE_SVID


95 
∑sswd
 *
fgëpwít
 (
FILE
 *
__°ªam
);

103 
puçwít
 (c⁄° 
∑sswd
 *
__ª°ri˘
 
__p
,

104 
FILE
 *
__ª°ri˘
 
__f
);

111 
∑sswd
 *
gëpwuid
 (
__uid_t
 
__uid
);

117 
∑sswd
 *
gëpw«m
 (c⁄° *
__«me
);

119 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


121 #ifde‡
__USE_MISC


124 
	#NSS_BUFLEN_PASSWD
 1024

	)

135 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


140 
gëpwít_r
 (
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

141 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

142 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

145 
gëpwuid_r
 (
__uid_t
 
__uid
,

146 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

147 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

148 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

150 
gëpw«m_r
 (c⁄° *
__ª°ri˘
 
__«me
,

151 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

152 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

153 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

156 #ifdef 
__USE_SVID


164 
fgëpwít_r
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

165 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

166 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

167 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

172 #ifde‡
__USE_GNU


181 
gëpw
 (
__uid_t
 
__uid
, *
__buf„r
);

184 
	g__END_DECLS


	@/usr/include/readline/history.h

22 #i‚de‡
_HISTORY_H_


23 
	#_HISTORY_H_


	)

25 #ifde‡
__˝lu•lus


29 
	~<time.h
>

31 #i‡
deföed
 
READLINE_LIBRARY


32 
	~"æ°dc.h
"

33 
	~"æty≥defs.h
"

35 
	~<ªadlöe/æ°dc.h
>

36 
	~<ªadlöe/æty≥defs.h
>

39 #ifde‡
__STDC__


40 *
	thi°d©a_t
;

42 *
	thi°d©a_t
;

46 
	s_hi°_íåy
 {

47 *
löe
;

48 *
time°amp
;

49 
hi°d©a_t
 
d©a
;

50 } 
	tHIST_ENTRY
;

53 
	#HISTENT_BYTES
(
hs
Ë(
	`°æí
 ((hs)->
löe
Ë+ såÀ¿((hs)->
time°amp
))

	)

56 
	s_hi°_°©e
 {

57 
HIST_ENTRY
 **
íåõs
;

58 
off£t
;

59 
Àngth
;

60 
size
;

61 
Êags
;

62 } 
	tHISTORY_STATE
;

65 
	#HS_STIFLED
 0x01

	)

71 
usög_hi°‹y
 
PARAMS
(());

74 
HISTORY_STATE
 *
hi°‹y_gë_hi°‹y_°©e
 
PARAMS
(());

77 
hi°‹y_£t_hi°‹y_°©e
 
PARAMS
((
HISTORY_STATE
 *));

83 
add_hi°‹y
 
PARAMS
((const *));

87 
add_hi°‹y_time
 
PARAMS
((const *));

92 
HIST_ENTRY
 *
ªmove_hi°‹y
 
PARAMS
(());

96 
hi°d©a_t
 
‰ì_hi°‹y_íåy
 
PARAMS
((
HIST_ENTRY
 *));

101 
HIST_ENTRY
 *
ª∂a˚_hi°‹y_íåy
 
PARAMS
((, c⁄° *, 
hi°d©a_t
));

104 
˛ór_hi°‹y
 
PARAMS
(());

107 
°iÊe_hi°‹y
 
PARAMS
(());

112 
un°iÊe_hi°‹y
 
PARAMS
(());

115 
hi°‹y_is_°iÊed
 
PARAMS
(());

122 
HIST_ENTRY
 **
hi°‹y_li°
 
PARAMS
(());

126 
whîe_hi°‹y
 
PARAMS
(());

130 
HIST_ENTRY
 *
cuºít_hi°‹y
 
PARAMS
(());

134 
HIST_ENTRY
 *
hi°‹y_gë
 
PARAMS
(());

138 
time_t
 
hi°‹y_gë_time
 
PARAMS
((
HIST_ENTRY
 *));

142 
hi°‹y_tŸÆ_byãs
 
PARAMS
(());

147 
hi°‹y_£t_pos
 
PARAMS
(());

152 
HIST_ENTRY
 *
¥evious_hi°‹y
 
PARAMS
(());

157 
HIST_ENTRY
 *
√xt_hi°‹y
 
PARAMS
(());

167 
hi°‹y_£¨ch
 
PARAMS
((const *, ));

172 
hi°‹y_£¨ch_¥efix
 
PARAMS
((const *, ));

179 
hi°‹y_£¨ch_pos
 
PARAMS
((const *, , ));

186 
ªad_hi°‹y
 
PARAMS
((const *));

193 
ªad_hi°‹y_ønge
 
PARAMS
((const *, , ));

198 
wrôe_hi°‹y
 
PARAMS
((const *));

202 
≠≥nd_hi°‹y
 
PARAMS
((, const *));

205 
hi°‹y_åunˇã_fûe
 
PARAMS
((const *, ));

221 
hi°‹y_ex∑nd
 
PARAMS
((*, **));

226 *
hi°‹y_¨g_exåa˘
 
PARAMS
((, , const *));

234 *
gë_hi°‹y_evít
 
PARAMS
((const *, *, ));

238 **
hi°‹y_tokíize
 
PARAMS
((const *));

241 
hi°‹y_ba£
;

242 
hi°‹y_Àngth
;

243 
hi°‹y_max_íåõs
;

244 
hi°‹y_ex∑nsi⁄_ch¨
;

245 
hi°‹y_sub°_ch¨
;

246 *
hi°‹y_w‹d_dñimôîs
;

247 
hi°‹y_commít_ch¨
;

248 *
hi°‹y_no_ex∑nd_ch¨s
;

249 *
hi°‹y_£¨ch_dñimôî_ch¨s
;

250 
hi°‹y_quŸes_öhibô_ex∑nsi⁄
;

252 
hi°‹y_wrôe_time°amps
;

255 
max_öput_hi°‹y
;

260 
æ_löebuf_func_t
 *
hi°‹y_öhibô_ex∑nsi⁄_fun˘i⁄
;

262 #ifde‡
__˝lu•lus


	@/usr/include/readline/readline.h

22 #i‡!
deföed
 (
_READLINE_H_
)

23 
	#_READLINE_H_


	)

25 #ifde‡
__˝lu•lus


29 #i‡
deföed
 (
READLINE_LIBRARY
)

30 
	~"æ°dc.h
"

31 
	~"æty≥defs.h
"

32 
	~"keym≠s.h
"

33 
	~"tûde.h
"

35 
	~<ªadlöe/æ°dc.h
>

36 
	~<ªadlöe/æty≥defs.h
>

37 
	~<ªadlöe/keym≠s.h
>

38 
	~<ªadlöe/tûde.h
>

42 
	#RL_READLINE_VERSION
 0x0602

	)

43 
	#RL_VERSION_MAJOR
 6

	)

44 
	#RL_VERSION_MINOR
 2

	)

54 
	eundo_code
 { 
UNDO_DELETE
, 
UNDO_INSERT
, 
UNDO_BEGIN
, 
UNDO_END
 };

57 
	sundo_li°
 {

58 
undo_li°
 *
√xt
;

59 
°¨t
, 
íd
;

60 *
ãxt
;

61 
undo_code
 
wh©
;

62 } 
	tUNDO_LIST
;

65 
UNDO_LIST
 *
æ_undo_li°
;

68 
	s_funm≠
 {

69 c⁄° *
	g«me
;

70 
æ_comm™d_func_t
 *
	gfun˘i⁄
;

71 } 
	tFUNMAP
;

73 
FUNMAP
 **
funm≠
;

82 
æ_digô_¨gumít
 
PARAMS
((, ));

83 
æ_univîßl_¨gumít
 
PARAMS
((, ));

86 
æ_f‹w¨d_byã
 
PARAMS
((, ));

87 
æ_f‹w¨d_ch¨
 
PARAMS
((, ));

88 
æ_f‹w¨d
 
PARAMS
((, ));

89 
æ_backw¨d_byã
 
PARAMS
((, ));

90 
æ_backw¨d_ch¨
 
PARAMS
((, ));

91 
æ_backw¨d
 
PARAMS
((, ));

92 
æ_beg_of_löe
 
PARAMS
((, ));

93 
æ_íd_of_löe
 
PARAMS
((, ));

94 
æ_f‹w¨d_w‹d
 
PARAMS
((, ));

95 
æ_backw¨d_w‹d
 
PARAMS
((, ));

96 
æ_ª‰esh_löe
 
PARAMS
((, ));

97 
æ_˛ór_s¸ìn
 
PARAMS
((, ));

98 
æ_skù_csi_£quí˚
 
PARAMS
((, ));

99 
æ_¨row_keys
 
PARAMS
((, ));

102 
æ_ö£π
 
PARAMS
((, ));

103 
æ_quŸed_ö£π
 
PARAMS
((, ));

104 
æ_èb_ö£π
 
PARAMS
((, ));

105 
æ_√wlöe
 
PARAMS
((, ));

106 
æ_do_lowîˇ£_vîsi⁄
 
PARAMS
((, ));

107 
æ_rubout
 
PARAMS
((, ));

108 
æ_dñëe
 
PARAMS
((, ));

109 
æ_rubout_‹_dñëe
 
PARAMS
((, ));

110 
æ_dñëe_h‹iz⁄èl_•a˚
 
PARAMS
((, ));

111 
æ_dñëe_‹_show_com∂ëi⁄s
 
PARAMS
((, ));

112 
æ_ö£π_commít
 
PARAMS
((, ));

115 
æ_upˇ£_w‹d
 
PARAMS
((, ));

116 
æ_downˇ£_w‹d
 
PARAMS
((, ));

117 
æ_ˇpôÆize_w‹d
 
PARAMS
((, ));

120 
æ_å™•o£_w‹ds
 
PARAMS
((, ));

121 
æ_å™•o£_ch¨s
 
PARAMS
((, ));

124 
æ_ch¨_£¨ch
 
PARAMS
((, ));

125 
æ_backw¨d_ch¨_£¨ch
 
PARAMS
((, ));

128 
æ_begönög_of_hi°‹y
 
PARAMS
((, ));

129 
æ_íd_of_hi°‹y
 
PARAMS
((, ));

130 
æ_gë_√xt_hi°‹y
 
PARAMS
((, ));

131 
æ_gë_¥evious_hi°‹y
 
PARAMS
((, ));

134 
æ_£t_m¨k
 
PARAMS
((, ));

135 
æ_exch™ge_poöt_™d_m¨k
 
PARAMS
((, ));

138 
æ_vi_edôög_mode
 
PARAMS
((, ));

139 
æ_emacs_edôög_mode
 
PARAMS
((, ));

142 
æ_ovîwrôe_mode
 
PARAMS
((, ));

145 
æ_ª_ªad_öô_fûe
 
PARAMS
((, ));

146 
æ_dump_fun˘i⁄s
 
PARAMS
((, ));

147 
æ_dump_ma¸os
 
PARAMS
((, ));

148 
æ_dump_v¨übÀs
 
PARAMS
((, ));

151 
æ_com∂ëe
 
PARAMS
((, ));

152 
æ_possibÀ_com∂ëi⁄s
 
PARAMS
((, ));

153 
æ_ö£π_com∂ëi⁄s
 
PARAMS
((, ));

154 
æ_ﬁd_míu_com∂ëe
 
PARAMS
((, ));

155 
æ_míu_com∂ëe
 
PARAMS
((, ));

156 
æ_backw¨d_míu_com∂ëe
 
PARAMS
((, ));

159 
æ_kûl_w‹d
 
PARAMS
((, ));

160 
æ_backw¨d_kûl_w‹d
 
PARAMS
((, ));

161 
æ_kûl_löe
 
PARAMS
((, ));

162 
æ_backw¨d_kûl_löe
 
PARAMS
((, ));

163 
æ_kûl_fuŒ_löe
 
PARAMS
((, ));

164 
æ_unix_w‹d_rubout
 
PARAMS
((, ));

165 
æ_unix_fûíame_rubout
 
PARAMS
((, ));

166 
æ_unix_löe_disˇrd
 
PARAMS
((, ));

167 
æ_c›y_ªgi⁄_to_kûl
 
PARAMS
((, ));

168 
æ_kûl_ªgi⁄
 
PARAMS
((, ));

169 
æ_c›y_f‹w¨d_w‹d
 
PARAMS
((, ));

170 
æ_c›y_backw¨d_w‹d
 
PARAMS
((, ));

171 
æ_y™k
 
PARAMS
((, ));

172 
æ_y™k_p›
 
PARAMS
((, ));

173 
æ_y™k_¡h_¨g
 
PARAMS
((, ));

174 
æ_y™k_œ°_¨g
 
PARAMS
((, ));

176 #ifde‡
__CYGWIN__


177 
æ_∑°e_‰om_˛ùbﬂrd
 
PARAMS
((, ));

181 
æ_ªvî£_£¨ch_hi°‹y
 
PARAMS
((, ));

182 
æ_f‹w¨d_£¨ch_hi°‹y
 
PARAMS
((, ));

185 
æ_°¨t_kbd_ma¸o
 
PARAMS
((, ));

186 
æ_íd_kbd_ma¸o
 
PARAMS
((, ));

187 
æ_ˇŒ_œ°_kbd_ma¸o
 
PARAMS
((, ));

190 
æ_ªvît_löe
 
PARAMS
((, ));

191 
æ_undo_comm™d
 
PARAMS
((, ));

194 
æ_tûde_ex∑nd
 
PARAMS
((, ));

197 
æ_ª°¨t_ouçut
 
PARAMS
((, ));

198 
æ_°›_ouçut
 
PARAMS
((, ));

201 
æ_ab‹t
 
PARAMS
((, ));

202 
æ_ây_°©us
 
PARAMS
((, ));

205 
æ_hi°‹y_£¨ch_f‹w¨d
 
PARAMS
((, ));

206 
æ_hi°‹y_£¨ch_backw¨d
 
PARAMS
((, ));

207 
æ_n⁄öc_f‹w¨d_£¨ch
 
PARAMS
((, ));

208 
æ_n⁄öc_ªvî£_£¨ch
 
PARAMS
((, ));

209 
æ_n⁄öc_f‹w¨d_£¨ch_agaö
 
PARAMS
((, ));

210 
æ_n⁄öc_ªvî£_£¨ch_agaö
 
PARAMS
((, ));

213 
æ_ö£π_˛o£
 
PARAMS
((, ));

216 
æ_ˇŒback_h™dÀr_ö°Æl
 
PARAMS
((c⁄° *, 
æ_v˝func_t
 *));

217 
æ_ˇŒback_ªad_ch¨
 
PARAMS
(());

218 
æ_ˇŒback_h™dÀr_ªmove
 
PARAMS
(());

222 
æ_vi_ªdo
 
PARAMS
((, ));

223 
æ_vi_undo
 
PARAMS
((, ));

224 
æ_vi_y™k_¨g
 
PARAMS
((, ));

225 
æ_vi_„tch_hi°‹y
 
PARAMS
((, ));

226 
æ_vi_£¨ch_agaö
 
PARAMS
((, ));

227 
æ_vi_£¨ch
 
PARAMS
((, ));

228 
æ_vi_com∂ëe
 
PARAMS
((, ));

229 
æ_vi_tûde_ex∑nd
 
PARAMS
((, ));

230 
æ_vi_¥ev_w‹d
 
PARAMS
((, ));

231 
æ_vi_√xt_w‹d
 
PARAMS
((, ));

232 
æ_vi_íd_w‹d
 
PARAMS
((, ));

233 
æ_vi_ö£π_beg
 
PARAMS
((, ));

234 
æ_vi_≠≥nd_mode
 
PARAMS
((, ));

235 
æ_vi_≠≥nd_eﬁ
 
PARAMS
((, ));

236 
æ_vi_eof_maybe
 
PARAMS
((, ));

237 
æ_vi_ö£πi⁄_mode
 
PARAMS
((, ));

238 
æ_vi_ö£π_mode
 
PARAMS
((, ));

239 
æ_vi_movemít_mode
 
PARAMS
((, ));

240 
æ_vi_¨g_digô
 
PARAMS
((, ));

241 
æ_vi_ch™ge_ˇ£
 
PARAMS
((, ));

242 
æ_vi_put
 
PARAMS
((, ));

243 
æ_vi_cﬁumn
 
PARAMS
((, ));

244 
æ_vi_dñëe_to
 
PARAMS
((, ));

245 
æ_vi_ch™ge_to
 
PARAMS
((, ));

246 
æ_vi_y™k_to
 
PARAMS
((, ));

247 
æ_vi_rubout
 
PARAMS
((, ));

248 
æ_vi_dñëe
 
PARAMS
((, ));

249 
æ_vi_back_to_ödít
 
PARAMS
((, ));

250 
æ_vi_fú°_¥öt
 
PARAMS
((, ));

251 
æ_vi_ch¨_£¨ch
 
PARAMS
((, ));

252 
æ_vi_m©ch
 
PARAMS
((, ));

253 
æ_vi_ch™ge_ch¨
 
PARAMS
((, ));

254 
æ_vi_sub°
 
PARAMS
((, ));

255 
æ_vi_ovî°rike
 
PARAMS
((, ));

256 
æ_vi_ovî°rike_dñëe
 
PARAMS
((, ));

257 
æ_vi_ª∂a˚
 
PARAMS
((, ));

258 
æ_vi_£t_m¨k
 
PARAMS
((, ));

259 
æ_vi_gŸo_m¨k
 
PARAMS
((, ));

262 
æ_vi_check
 
PARAMS
(());

263 
æ_vi_domove
 
PARAMS
((, *));

264 
æ_vi_bøckty≥
 
PARAMS
(());

266 
æ_vi_°¨t_ö£πög
 
PARAMS
((, , ));

269 
æ_vi_fW‹d
 
PARAMS
((, ));

270 
æ_vi_bW‹d
 
PARAMS
((, ));

271 
æ_vi_eW‹d
 
PARAMS
((, ));

272 
æ_vi_fw‹d
 
PARAMS
((, ));

273 
æ_vi_bw‹d
 
PARAMS
((, ));

274 
æ_vi_ew‹d
 
PARAMS
((, ));

284 *
ªadlöe
 
PARAMS
((const *));

286 
æ_£t_¥om±
 
PARAMS
((const *));

287 
æ_ex∑nd_¥om±
 
PARAMS
((*));

289 
æ_öôülize
 
PARAMS
(());

292 
æ_disˇrd_¨gumít
 
PARAMS
(());

295 
æ_add_defun
 
PARAMS
((c⁄° *, 
æ_comm™d_func_t
 *, ));

296 
æ_böd_key
 
PARAMS
((, 
æ_comm™d_func_t
 *));

297 
æ_böd_key_ö_m≠
 
PARAMS
((, 
æ_comm™d_func_t
 *, 
Keym≠
));

298 
æ_unböd_key
 
PARAMS
(());

299 
æ_unböd_key_ö_m≠
 
PARAMS
((, 
Keym≠
));

300 
æ_böd_key_if_unbound
 
PARAMS
((, 
æ_comm™d_func_t
 *));

301 
æ_böd_key_if_unbound_ö_m≠
 
PARAMS
((, 
æ_comm™d_func_t
 *, 
Keym≠
));

302 
æ_unböd_fun˘i⁄_ö_m≠
 
PARAMS
((
æ_comm™d_func_t
 *, 
Keym≠
));

303 
æ_unböd_comm™d_ö_m≠
 
PARAMS
((c⁄° *, 
Keym≠
));

304 
æ_böd_key£q
 
PARAMS
((c⁄° *, 
æ_comm™d_func_t
 *));

305 
æ_böd_key£q_ö_m≠
 
PARAMS
((c⁄° *, 
æ_comm™d_func_t
 *, 
Keym≠
));

306 
æ_böd_key£q_if_unbound
 
PARAMS
((c⁄° *, 
æ_comm™d_func_t
 *));

307 
æ_böd_key£q_if_unbound_ö_m≠
 
PARAMS
((c⁄° *, 
æ_comm™d_func_t
 *, 
Keym≠
));

308 
æ_gíîic_böd
 
PARAMS
((, c⁄° *, *, 
Keym≠
));

310 *
æ_v¨übÀ_vÆue
 
PARAMS
((const *));

311 
æ_v¨übÀ_böd
 
PARAMS
((const *, const *));

314 
æ_£t_key
 
PARAMS
((c⁄° *, 
æ_comm™d_func_t
 *, 
Keym≠
));

317 
æ_ma¸o_böd
 
PARAMS
((c⁄° *, c⁄° *, 
Keym≠
));

320 
æ_å™¶©e_key£q
 
PARAMS
((const *, *, *));

321 *
æ_u¡øn¶©e_key£q
 
PARAMS
(());

323 
æ_comm™d_func_t
 *
æ_«med_fun˘i⁄
 
PARAMS
((const *));

324 
æ_comm™d_func_t
 *
æ_fun˘i⁄_of_key£q
 
PARAMS
((c⁄° *, 
Keym≠
, *));

326 
æ_li°_funm≠_«mes
 
PARAMS
(());

327 **
æ_övokög_key£qs_ö_m≠
 
PARAMS
((
æ_comm™d_func_t
 *, 
Keym≠
));

328 **
æ_övokög_key£qs
 
PARAMS
((
æ_comm™d_func_t
 *));

330 
æ_fun˘i⁄_dum≥r
 
PARAMS
(());

331 
æ_ma¸o_dum≥r
 
PARAMS
(());

332 
æ_v¨übÀ_dum≥r
 
PARAMS
(());

334 
æ_ªad_öô_fûe
 
PARAMS
((const *));

335 
æ_∑r£_™d_böd
 
PARAMS
((*));

338 
Keym≠
 
æ_make_b¨e_keym≠
 
PARAMS
(());

339 
Keym≠
 
æ_c›y_keym≠
 
PARAMS
((Keymap));

340 
Keym≠
 
æ_make_keym≠
 
PARAMS
(());

341 
æ_disˇrd_keym≠
 
PARAMS
((
Keym≠
));

343 
Keym≠
 
æ_gë_keym≠_by_«me
 
PARAMS
((const *));

344 *
æ_gë_keym≠_«me
 
PARAMS
((
Keym≠
));

345 
æ_£t_keym≠
 
PARAMS
((
Keym≠
));

346 
Keym≠
 
æ_gë_keym≠
 
PARAMS
(());

348 
æ_£t_keym≠_‰om_edô_mode
 
PARAMS
(());

349 *
æ_gë_keym≠_«me_‰om_edô_mode
 
PARAMS
(());

352 
æ_add_funm≠_íåy
 
PARAMS
((c⁄° *, 
æ_comm™d_func_t
 *));

353 c⁄° **
æ_funm≠_«mes
 
PARAMS
(());

356 
æ_öôülize_funm≠
 
PARAMS
(());

359 
æ_push_ma¸o_öput
 
PARAMS
((*));

362 
æ_add_undo
 
PARAMS
((
undo_code
, , , *));

363 
æ_‰ì_undo_li°
 
PARAMS
(());

364 
æ_do_undo
 
PARAMS
(());

365 
æ_begö_undo_group
 
PARAMS
(());

366 
æ_íd_undo_group
 
PARAMS
(());

367 
æ_modifyög
 
PARAMS
((, ));

370 
æ_ªdi•œy
 
PARAMS
(());

371 
æ_⁄_√w_löe
 
PARAMS
(());

372 
æ_⁄_√w_löe_wôh_¥om±
 
PARAMS
(());

373 
æ_f‹˚d_upd©e_di•œy
 
PARAMS
(());

374 
æ_˛ór_mesßge
 
PARAMS
(());

375 
æ_ª£t_löe_°©e
 
PARAMS
(());

376 
æ_¸lf
 
PARAMS
(());

378 #i‡
deföed
 (
USE_VARARGS
Ë&& deföed (
PREFER_STDARG
)

379 
æ_mesßge
 (c⁄° *, ...Ë
__©åibuã__
((
__f‹m©__
 (
¥ötf
, 1, 2)));

381 
æ_mesßge
 ();

384 
æ_show_ch¨
 
PARAMS
(());

387 
æ_ch¨a˘î_Àn
 
PARAMS
((, ));

390 
æ_ßve_¥om±
 
PARAMS
(());

391 
æ_ª°‹e_¥om±
 
PARAMS
(());

394 
æ_ª∂a˚_löe
 
PARAMS
((const *, ));

395 
æ_ö£π_ãxt
 
PARAMS
((const *));

396 
æ_dñëe_ãxt
 
PARAMS
((, ));

397 
æ_kûl_ãxt
 
PARAMS
((, ));

398 *
æ_c›y_ãxt
 
PARAMS
((, ));

401 
æ_¥ï_ãrmöÆ
 
PARAMS
(());

402 
æ_dïªp_ãrmöÆ
 
PARAMS
(());

403 
æ_ây_£t_deÁu…_bödögs
 
PARAMS
((
Keym≠
));

404 
æ_ây_un£t_deÁu…_bödögs
 
PARAMS
((
Keym≠
));

406 
æ_ª£t_ãrmöÆ
 
PARAMS
((const *));

407 
æ_ªsize_ãrmöÆ
 
PARAMS
(());

408 
æ_£t_s¸ìn_size
 
PARAMS
((, ));

409 
æ_gë_s¸ìn_size
 
PARAMS
((*, *));

410 
æ_ª£t_s¸ìn_size
 
PARAMS
(());

412 *
æ_gë_ãrmˇp
 
PARAMS
((const *));

415 
æ_°uff_ch¨
 
PARAMS
(());

416 
æ_execuã_√xt
 
PARAMS
(());

417 
æ_˛ór_≥ndög_öput
 
PARAMS
(());

418 
æ_ªad_key
 
PARAMS
(());

419 
æ_gëc
 
PARAMS
((
FILE
 *));

420 
æ_£t_keybﬂrd_öput_timeout
 
PARAMS
(());

423 
æ_exãnd_löe_buf„r
 
PARAMS
(());

424 
æ_dög
 
PARAMS
(());

425 
æ_Æphabëic
 
PARAMS
(());

426 
æ_‰ì
 
PARAMS
((*));

429 
æ_£t_sig«ls
 
PARAMS
(());

430 
æ_˛ór_sig«ls
 
PARAMS
(());

431 
æ_˛ónup_a·î_sig«l
 
PARAMS
(());

432 
æ_ª£t_a·î_sig«l
 
PARAMS
(());

433 
æ_‰ì_löe_°©e
 
PARAMS
(());

435 
æ_echo_sig«l_ch¨
 
PARAMS
(());

437 
æ_£t_∑ªn_blök_timeout
 
PARAMS
(());

440 
æ_maybe_ßve_löe
 
PARAMS
(());

441 
æ_maybe_unßve_löe
 
PARAMS
(());

442 
æ_maybe_ª∂a˚_löe
 
PARAMS
(());

445 
æ_com∂ëe_öã∫Æ
 
PARAMS
(());

446 
æ_di•œy_m©ch_li°
 
PARAMS
((**, , ));

448 **
æ_com∂ëi⁄_m©ches
 
PARAMS
((c⁄° *, 
æ_com≥¡ry_func_t
 *));

449 *
æ_u£∫ame_com∂ëi⁄_fun˘i⁄
 
PARAMS
((const *, ));

450 *
æ_fûíame_com∂ëi⁄_fun˘i⁄
 
PARAMS
((const *, ));

452 
æ_com∂ëi⁄_mode
 
PARAMS
((
æ_comm™d_func_t
 *));

456 
‰ì_undo_li°
 
PARAMS
(());

457 
maybe_ßve_löe
 
PARAMS
(());

458 
maybe_unßve_löe
 
PARAMS
(());

459 
maybe_ª∂a˚_löe
 
PARAMS
(());

461 
dög
 
PARAMS
(());

462 
Æphabëic
 
PARAMS
(());

463 
¸lf
 
PARAMS
(());

465 **
com∂ëi⁄_m©ches
 
PARAMS
((*, 
æ_com≥¡ry_func_t
 *));

466 *
u£∫ame_com∂ëi⁄_fun˘i⁄
 
PARAMS
((const *, ));

467 *
fûíame_com∂ëi⁄_fun˘i⁄
 
PARAMS
((const *, ));

477 c⁄° *
æ_libøry_vîsi⁄
;

478 
æ_ªadlöe_vîsi⁄
;

481 
æ_gnu_ªadlöe_p
;

484 
æ_ªadlöe_°©e
;

488 
æ_edôög_mode
;

492 
æ_ö£π_mode
;

496 c⁄° *
æ_ªadlöe_«me
;

500 *
æ_¥om±
;

504 *
æ_di•œy_¥om±
;

507 *
æ_löe_buf„r
;

510 
æ_poöt
;

511 
æ_íd
;

514 
æ_m¨k
;

518 
æ_d⁄e
;

521 
æ_≥ndög_öput
;

526 
æ_di•©chög
;

530 
æ_ex∂icô_¨g
;

533 
æ_numîic_¨g
;

536 
æ_comm™d_func_t
 *
æ_œ°_func
;

539 c⁄° *
æ_ãrmöÆ_«me
;

542 
FILE
 *
æ_ö°ªam
;

543 
FILE
 *
æ_out°ªam
;

548 
æ_¥e„r_ív_wösize
;

552 
æ_hook_func_t
 *
æ_°¨tup_hook
;

557 
æ_hook_func_t
 *
æ_¥e_öput_hook
;

561 
æ_hook_func_t
 *
æ_evít_hook
;

565 
æ_gëc_func_t
 *
æ_gëc_fun˘i⁄
;

567 
æ_voidfunc_t
 *
æ_ªdi•œy_fun˘i⁄
;

569 
æ_vötfunc_t
 *
æ_¥ï_ãrm_fun˘i⁄
;

570 
æ_voidfunc_t
 *
æ_dïªp_ãrm_fun˘i⁄
;

573 
Keym≠
 
æ_executög_keym≠
;

574 
Keym≠
 
æ_bödög_keym≠
;

580 
æ_îa£_em±y_löe
;

585 
æ_Æªady_¥om±ed
;

589 
æ_num_ch¨s_to_ªad
;

592 *
æ_executög_ma¸o
;

597 
æ_ˇtch_sig«ls
;

604 
æ_ˇtch_sigwöch
;

610 
æ_com≥¡ry_func_t
 *
æ_com∂ëi⁄_íåy_fun˘i⁄
;

614 
æ_com≥¡ry_func_t
 *
æ_míu_com∂ëi⁄_íåy_fun˘i⁄
;

622 
æ_compign‹e_func_t
 *
æ_ign‹e_some_com∂ëi⁄s_fun˘i⁄
;

631 
æ_com∂ëi⁄_func_t
 *
æ_©ãm±ed_com∂ëi⁄_fun˘i⁄
;

636 c⁄° *
æ_basic_w‹d_bªak_ch¨a˘îs
;

641 *
æ_com∂ëî_w‹d_bªak_ch¨a˘îs
;

646 
æ_˝vfunc_t
 *
æ_com∂ëi⁄_w‹d_bªak_hook
;

652 c⁄° *
æ_com∂ëî_quŸe_ch¨a˘îs
;

655 c⁄° *
æ_basic_quŸe_ch¨a˘îs
;

658 c⁄° *
æ_fûíame_quŸe_ch¨a˘îs
;

663 c⁄° *
æ_•ecül_¥efixes
;

674 
æ_i˝pfunc_t
 *
æ_dúe˘‹y_com∂ëi⁄_hook
;

687 
æ_i˝pfunc_t
 *
æ_dúe˘‹y_ªwrôe_hook
;

698 
æ_dequŸe_func_t
 *
æ_fûíame_ªwrôe_hook
;

701 
	#æ_symbﬁic_lök_hook
 
æ_dúe˘‹y_com∂ëi⁄_hook


	)

710 
æ_compdi•_func_t
 *
æ_com∂ëi⁄_di•œy_m©ches_hook
;

715 
æ_fûíame_com∂ëi⁄_desúed
;

722 
æ_fûíame_quŸög_desúed
;

728 
æ_quŸe_func_t
 *
æ_fûíame_quŸög_fun˘i⁄
;

733 
æ_dequŸe_func_t
 *
æ_fûíame_dequŸög_fun˘i⁄
;

738 
æ_löebuf_func_t
 *
æ_ch¨_is_quŸed_p
;

742 
æ_©ãm±ed_com∂ëi⁄_ovî
;

747 
æ_com∂ëi⁄_ty≥
;

750 
æ_com∂ëi⁄_övokög_key
;

755 
æ_com∂ëi⁄_quîy_ôems
;

759 
æ_com∂ëi⁄_≠≥nd_ch¨a˘î
;

763 
æ_com∂ëi⁄_suµªss_≠≥nd
;

767 
æ_com∂ëi⁄_quŸe_ch¨a˘î
;

771 
æ_com∂ëi⁄_found_quŸe
;

776 
æ_com∂ëi⁄_suµªss_quŸe
;

779 
æ_s‹t_com∂ëi⁄_m©ches
;

790 
æ_com∂ëi⁄_m¨k_symlök_dús
;

793 
æ_ign‹e_com∂ëi⁄_du∂iˇãs
;

797 
æ_öhibô_com∂ëi⁄
;

801 
	#READERR
 (-2)

	)

804 
	#RL_PROMPT_START_IGNORE
 '\001'

	)

805 
	#RL_PROMPT_END_IGNORE
 '\002'

	)

809 
	#NO_MATCH
 0

	)

810 
	#SINGLE_MATCH
 1

	)

811 
	#MULT_MATCH
 2

	)

814 
	#RL_STATE_NONE
 0x000000

	)

816 
	#RL_STATE_INITIALIZING
 0x0000001

	)

817 
	#RL_STATE_INITIALIZED
 0x0000002

	)

818 
	#RL_STATE_TERMPREPPED
 0x0000004

	)

819 
	#RL_STATE_READCMD
 0x0000008

	)

820 
	#RL_STATE_METANEXT
 0x0000010

	)

821 
	#RL_STATE_DISPATCHING
 0x0000020

	)

822 
	#RL_STATE_MOREINPUT
 0x0000040

	)

823 
	#RL_STATE_ISEARCH
 0x0000080

	)

824 
	#RL_STATE_NSEARCH
 0x0000100

	)

825 
	#RL_STATE_SEARCH
 0x0000200

	)

826 
	#RL_STATE_NUMERICARG
 0x0000400

	)

827 
	#RL_STATE_MACROINPUT
 0x0000800

	)

828 
	#RL_STATE_MACRODEF
 0x0001000

	)

829 
	#RL_STATE_OVERWRITE
 0x0002000

	)

830 
	#RL_STATE_COMPLETING
 0x0004000

	)

831 
	#RL_STATE_SIGHANDLER
 0x0008000

	)

832 
	#RL_STATE_UNDOING
 0x0010000

	)

833 
	#RL_STATE_INPUTPENDING
 0x0020000

	)

834 
	#RL_STATE_TTYCSAVED
 0x0040000

	)

835 
	#RL_STATE_CALLBACK
 0x0080000

	)

836 
	#RL_STATE_VIMOTION
 0x0100000

	)

837 
	#RL_STATE_MULTIKEY
 0x0200000

	)

838 
	#RL_STATE_VICMDONCE
 0x0400000

	)

839 
	#RL_STATE_REDISPLAYING
 0x0800000

	)

841 
	#RL_STATE_DONE
 0x1000000

	)

843 
	#RL_STATE_FEDORA_GDB
 0x2000000

	)

845 
	#RL_SETSTATE
(
x
Ë(
æ_ªadlöe_°©e
 |(x))

	)

846 
	#RL_UNSETSTATE
(
x
Ë(
æ_ªadlöe_°©e
 &~(x))

	)

847 
	#RL_ISSTATE
(
x
Ë(
æ_ªadlöe_°©e
 & (x))

	)

849 
	sªadlöe_°©e
 {

851 
	gpoöt
;

852 
	gíd
;

853 
	gm¨k
;

854 *
	gbuf„r
;

855 
	gbuÊí
;

856 
UNDO_LIST
 *
	gul
;

857 *
	g¥om±
;

860 
	gæ°©e
;

861 
	gd⁄e
;

862 
Keym≠
 
	gkm≠
;

865 
æ_comm™d_func_t
 *
	gœ°func
;

866 
	gösmode
;

867 
	gedmode
;

868 
	gk£qÀn
;

869 
FILE
 *
	göf
;

870 
FILE
 *
	goutf
;

871 
	g≥ndögö
;

872 *
	gma¸o
;

875 
	gˇtchsigs
;

876 
	gˇtchsigwöch
;

885 
	gª£rved
[64];

888 
æ_ßve_°©e
 
PARAMS
((
ªadlöe_°©e
 *));

889 
æ_ª°‹e_°©e
 
PARAMS
((
ªadlöe_°©e
 *));

891 #ifde‡
__˝lu•lus


	@/usr/include/regex.h

21 #i‚de‡
_REGEX_H


22 
	#_REGEX_H
 1

	)

24 
	~<sys/ty≥s.h
>

27 #ifde‡
__˝lu•lus


35 
	ts_ªg_t
;

36 
	ta˘ive_ªg_t
;

43 
	tªg_sy¡ax_t
;

45 #ifde‡
__USE_GNU


48 
	#RE_BACKSLASH_ESCAPE_IN_LISTS
 ((Ë1)

	)

53 
	#RE_BK_PLUS_QM
 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 << 1)

	)

59 
	#RE_CHAR_CLASSES
 (
RE_BK_PLUS_QM
 << 1)

	)

73 
	#RE_CONTEXT_INDEP_ANCHORS
 (
RE_CHAR_CLASSES
 << 1)

	)

81 
	#RE_CONTEXT_INDEP_OPS
 (
RE_CONTEXT_INDEP_ANCHORS
 << 1)

	)

85 
	#RE_CONTEXT_INVALID_OPS
 (
RE_CONTEXT_INDEP_OPS
 << 1)

	)

89 
	#RE_DOT_NEWLINE
 (
RE_CONTEXT_INVALID_OPS
 << 1)

	)

93 
	#RE_DOT_NOT_NULL
 (
RE_DOT_NEWLINE
 << 1)

	)

97 
	#RE_HAT_LISTS_NOT_NEWLINE
 (
RE_DOT_NOT_NULL
 << 1)

	)

102 
	#RE_INTERVALS
 (
RE_HAT_LISTS_NOT_NEWLINE
 << 1)

	)

106 
	#RE_LIMITED_OPS
 (
RE_INTERVALS
 << 1)

	)

110 
	#RE_NEWLINE_ALT
 (
RE_LIMITED_OPS
 << 1)

	)

115 
	#RE_NO_BK_BRACES
 (
RE_NEWLINE_ALT
 << 1)

	)

119 
	#RE_NO_BK_PARENS
 (
RE_NO_BK_BRACES
 << 1)

	)

123 
	#RE_NO_BK_REFS
 (
RE_NO_BK_PARENS
 << 1)

	)

127 
	#RE_NO_BK_VBAR
 (
RE_NO_BK_REFS
 << 1)

	)

133 
	#RE_NO_EMPTY_RANGES
 (
RE_NO_BK_VBAR
 << 1)

	)

137 
	#RE_UNMATCHED_RIGHT_PAREN_ORD
 (
RE_NO_EMPTY_RANGES
 << 1)

	)

141 
	#RE_NO_POSIX_BACKTRACKING
 (
RE_UNMATCHED_RIGHT_PAREN_ORD
 << 1)

	)

145 
	#RE_NO_GNU_OPS
 (
RE_NO_POSIX_BACKTRACKING
 << 1)

	)

153 
	#RE_DEBUG
 (
RE_NO_GNU_OPS
 << 1)

	)

158 
	#RE_INVALID_INTERVAL_ORD
 (
RE_DEBUG
 << 1)

	)

162 
	#RE_ICASE
 (
RE_INVALID_INTERVAL_ORD
 << 1)

	)

167 
	#RE_CARET_ANCHORS_HERE
 (
RE_ICASE
 << 1)

	)

171 
	#RE_CONTEXT_INVALID_DUP
 (
RE_CARET_ANCHORS_HERE
 << 1)

	)

175 
	#RE_NO_SUB
 (
RE_CONTEXT_INVALID_DUP
 << 1)

	)

182 
ªg_sy¡ax_t
 
ª_sy¡ax_›ti⁄s
;

184 #ifde‡
__USE_GNU


189 
	#RE_SYNTAX_EMACS
 0

	)

191 
	#RE_SYNTAX_AWK
 \

192 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 | 
RE_DOT_NOT_NULL
 \

193 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

194 | 
RE_NO_BK_VBAR
 | 
RE_NO_EMPTY_RANGES
 \

195 | 
RE_DOT_NEWLINE
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

196 | 
RE_CHAR_CLASSES
 \

197 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
 | 
RE_NO_GNU_OPS
)

	)

199 
	#RE_SYNTAX_GNU_AWK
 \

200 ((
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

201 | 
RE_INVALID_INTERVAL_ORD
) \

202 & ~(
RE_DOT_NOT_NULL
 | 
RE_CONTEXT_INDEP_OPS
 \

203 | 
RE_CONTEXT_INVALID_OPS
 ))

	)

205 
	#RE_SYNTAX_POSIX_AWK
 \

206 (
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

207 | 
RE_INTERVALS
 | 
RE_NO_GNU_OPS
 \

208 | 
RE_INVALID_INTERVAL_ORD
)

	)

210 
	#RE_SYNTAX_GREP
 \

211 (
RE_BK_PLUS_QM
 | 
RE_CHAR_CLASSES
 \

212 | 
RE_HAT_LISTS_NOT_NEWLINE
 | 
RE_INTERVALS
 \

213 | 
RE_NEWLINE_ALT
)

	)

215 
	#RE_SYNTAX_EGREP
 \

216 (
RE_CHAR_CLASSES
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

217 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_HAT_LISTS_NOT_NEWLINE
 \

218 | 
RE_NEWLINE_ALT
 | 
RE_NO_BK_PARENS
 \

219 | 
RE_NO_BK_VBAR
)

	)

221 
	#RE_SYNTAX_POSIX_EGREP
 \

222 (
RE_SYNTAX_EGREP
 | 
RE_INTERVALS
 | 
RE_NO_BK_BRACES
 \

223 | 
RE_INVALID_INTERVAL_ORD
)

	)

226 
	#RE_SYNTAX_ED
 
RE_SYNTAX_POSIX_BASIC


	)

228 
	#RE_SYNTAX_SED
 
RE_SYNTAX_POSIX_BASIC


	)

231 
	#_RE_SYNTAX_POSIX_COMMON
 \

232 (
RE_CHAR_CLASSES
 | 
RE_DOT_NEWLINE
 | 
RE_DOT_NOT_NULL
 \

233 | 
RE_INTERVALS
 | 
RE_NO_EMPTY_RANGES
)

	)

235 
	#RE_SYNTAX_POSIX_BASIC
 \

236 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
 | 
RE_CONTEXT_INVALID_DUP
)

	)

241 
	#RE_SYNTAX_POSIX_MINIMAL_BASIC
 \

242 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_LIMITED_OPS
)

	)

244 
	#RE_SYNTAX_POSIX_EXTENDED
 \

245 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

246 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_NO_BK_BRACES
 \

247 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_VBAR
 \

248 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

252 
	#RE_SYNTAX_POSIX_MINIMAL_EXTENDED
 \

253 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

254 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_NO_BK_BRACES
 \

255 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

256 | 
RE_NO_BK_VBAR
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

262 #ifde‡
RE_DUP_MAX


263 #unde‡
RE_DUP_MAX


266 
	#RE_DUP_MAX
 (0x7fff)

	)

274 
	#REG_EXTENDED
 1

	)

278 
	#REG_ICASE
 (
REG_EXTENDED
 << 1)

	)

283 
	#REG_NEWLINE
 (
REG_ICASE
 << 1)

	)

287 
	#REG_NOSUB
 (
REG_NEWLINE
 << 1)

	)

297 
	#REG_NOTBOL
 1

	)

300 
	#REG_NOTEOL
 (1 << 1)

	)

304 
	#REG_STARTEND
 (1 << 2)

	)

311 #i‡
deföed
 
_XOPEN_SOURCE
 || deföed 
__USE_XOPEN2K


312 
	gREG_ENOSYS
 = -1,

315 
	gREG_NOERROR
 = 0,

316 
	gREG_NOMATCH
,

320 
	gREG_BADPAT
,

321 
	gREG_ECOLLATE
,

322 
	gREG_ECTYPE
,

323 
	gREG_EESCAPE
,

324 
	gREG_ESUBREG
,

325 
	gREG_EBRACK
,

326 
	gREG_EPAREN
,

327 
	gREG_EBRACE
,

328 
	gREG_BADBR
,

329 
	gREG_ERANGE
,

330 
	gREG_ESPACE
,

331 
	gREG_BADRPT
,

334 
	gREG_EEND
,

335 
	gREG_ESIZE
,

336 
	gREG_ERPAREN


337 } 
	tªg_îrcode_t
;

345 #i‚de‡
RE_TRANSLATE_TYPE


346 
	#__RE_TRANSLATE_TYPE
 *

	)

347 #ifde‡
__USE_GNU


348 
	#RE_TRANSLATE_TYPE
 
__RE_TRANSLATE_TYPE


	)

352 #ifde‡
__USE_GNU


353 
	#__REPB_PREFIX
(
«me
Ë
	)
«me

355 
	#__REPB_PREFIX
(
«me
Ë
__
##
	)
«me

358 
	sª_∑âîn_buf„r


363 *
__REPB_PREFIX
(
buf„r
);

366 
__REPB_PREFIX
(
Æloˇãd
);

369 
__REPB_PREFIX
(
u£d
);

372 
ªg_sy¡ax_t
 
__REPB_PREFIX
(
sy¡ax
);

377 *
__REPB_PREFIX
(
Á°m≠
);

383 
__RE_TRANSLATE_TYPE
 
__REPB_PREFIX
(
å™¶©e
);

386 
size_t
 
	gª_nsub
;

392 
__REPB_PREFIX
(
ˇn_be_nuŒ
) : 1;

398 #ifde‡
__USE_GNU


399 
	#REGS_UNALLOCATED
 0

	)

400 
	#REGS_REALLOCATE
 1

	)

401 
	#REGS_FIXED
 2

	)

403 
__REPB_PREFIX
(
ªgs_Æloˇãd
) : 2;

407 
__REPB_PREFIX
(
Á°m≠_accuøã
) : 1;

411 
__REPB_PREFIX
(
no_sub
) : 1;

415 
__REPB_PREFIX
(
nŸ_bﬁ
) : 1;

418 
__REPB_PREFIX
(
nŸ_eﬁ
) : 1;

421 
__REPB_PREFIX
(
√wlöe_™ch‹
) : 1;

424 
ª_∑âîn_buf„r
 
	tªgex_t
;

427 
	tªgoff_t
;

430 #ifde‡
__USE_GNU


433 
	sª_ªgi°îs


435 
	gnum_ªgs
;

436 
ªgoff_t
 *
	g°¨t
;

437 
ªgoff_t
 *
	gíd
;

444 #i‚de‡
RE_NREGS


445 
	#RE_NREGS
 30

	)

455 
ªgoff_t
 
	grm_so
;

456 
ªgoff_t
 
	grm_eo
;

457 } 
	tªgm©ch_t
;

461 #ifde‡
__USE_GNU


464 
ªg_sy¡ax_t
 
ª_£t_sy¡ax
 (ªg_sy¡ax_à
__sy¡ax
);

474 c⁄° *
ª_compûe_∑âîn
 (c⁄° *
__∑âîn
, 
size_t
 
__Àngth
,

475 
ª_∑âîn_buf„r
 *
__buf„r
);

481 
ª_compûe_Á°m≠
 (
ª_∑âîn_buf„r
 *
__buf„r
);

489 
ª_£¨ch
 (
ª_∑âîn_buf„r
 *
__buf„r
, c⁄° *
__°rög
,

490 
__Àngth
, 
__°¨t
, 
__ønge
,

491 
ª_ªgi°îs
 *
__ªgs
);

496 
ª_£¨ch_2
 (
ª_∑âîn_buf„r
 *
__buf„r
,

497 c⁄° *
__°rög1
, 
__Àngth1
,

498 c⁄° *
__°rög2
, 
__Àngth2
, 
__°¨t
,

499 
__ønge
, 
ª_ªgi°îs
 *
__ªgs
, 
__°›
);

504 
ª_m©ch
 (
ª_∑âîn_buf„r
 *
__buf„r
, c⁄° *
__°rög
,

505 
__Àngth
, 
__°¨t
, 
ª_ªgi°îs
 *
__ªgs
);

509 
ª_m©ch_2
 (
ª_∑âîn_buf„r
 *
__buf„r
,

510 c⁄° *
__°rög1
, 
__Àngth1
,

511 c⁄° *
__°rög2
, 
__Àngth2
, 
__°¨t
,

512 
ª_ªgi°îs
 *
__ªgs
, 
__°›
);

527 
ª_£t_ªgi°îs
 (
ª_∑âîn_buf„r
 *
__buf„r
,

528 
ª_ªgi°îs
 *
__ªgs
,

529 
__num_ªgs
,

530 
ªgoff_t
 *
__°¨ts
,Ñegoff_à*
__íds
);

533 #i‡
deföed
 
_REGEX_RE_COMP
 || (deföed 
_LIBC
 && deföed 
__USE_BSD
)

534 #i‚de‡
_CRAY


536 *
ª_comp
 (const *);

537 
ª_exec
 (const *);

543 #i‚de‡
__ª°ri˘


544 #i‡! (2 < 
__GNUC__
 || (2 =__GNUC__ && 95 <
__GNUC_MINOR__
))

545 #i‡
deföed
 
ª°ri˘
 || 199901L <
__STDC_VERSION__


546 
	#__ª°ri˘
 
ª°ri˘


	)

548 
	#__ª°ri˘


	)

553 #i‚de‡
__ª°ri˘_¨r


554 #i‡(
__GNUC__
 > 3 || (__GNUC__ =3 && 
__GNUC_MINOR__
 >= 1)) \

555 && !
deföed
 
	g__GNUG__


556 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

558 
	#__ª°ri˘_¨r


	)

563 
ªgcomp
 (
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

564 c⁄° *
__ª°ri˘
 
__∑âîn
,

565 
__cÊags
);

567 
ªgexec
 (c⁄° 
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

568 c⁄° *
__ª°ri˘
 
__°rög
, 
size_t
 
__nm©ch
,

569 
ªgm©ch_t
 
__pm©ch
[
__ª°ri˘_¨r
],

570 
__eÊags
);

572 
size_t
 
ªgîr‹
 (
__îrcode
, c⁄° 
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

573 *
__ª°ri˘
 
__îrbuf
, 
size_t
 
__îrbuf_size
);

575 
ªg‰ì
 (
ªgex_t
 *
__¥eg
);

578 #ifde‡
__˝lu•lus


	@/usr/include/setjmp.h

22 #i‚def 
_SETJMP_H


23 
	#_SETJMP_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/£tjmp.h
>

30 
	~<bôs/sig£t.h
>

34 
	s__jmp_buf_èg


40 
__jmp_buf
 
	m__jmpbuf
;

41 
	m__mask_was_ßved
;

42 
__sig£t_t
 
	m__ßved_mask
;

46 
__BEGIN_NAMESPACE_STD


48 
__jmp_buf_èg
 
	tjmp_buf
[1];

52 
	$£tjmp
 (
jmp_buf
 
__ív
Ë
__THROWNL
;

54 
__END_NAMESPACE_STD


59 
	$__sig£tjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__ßvemask
Ë
__THROWNL
;

61 #i‚def 
__FAVOR_BSD


64 
	$_£tjmp
 (
__jmp_buf_èg
 
__ív
[1]Ë
__THROWNL
;

68 
	#£tjmp
(
ív
Ë
	`_£tjmp
 (ív)

	)

73 
	#£tjmp
(
ív
Ë
	`£tjmp
 (ív)

	)

77 
__BEGIN_NAMESPACE_STD


81 
	$l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

82 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

84 
__END_NAMESPACE_STD


86 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


90 
	$_l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

91 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

95 #ifdef 
__USE_POSIX


99 
__jmp_buf_èg
 
	tsigjmp_buf
[1];

103 
	#sig£tjmp
(
ív
, 
ßvemask
Ë
	`__sig£tjmp
 (ív, savemask)

	)

109 
	$sigl⁄gjmp
 (
sigjmp_buf
 
__ív
, 
__vÆ
)

110 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

115 #i‡
__USE_FORTIFY_LEVEL
 > 0

116 
	~<bôs/£tjmp2.h
>

119 
__END_DECLS


	@/usr/include/signal.h

22 #i‚def 
_SIGNAL_H


24 #i‡!
deföed
 
__√ed_sig_©omic_t
 && !deföed 
__√ed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	~<bôs/sig£t.h
>

36 #i‡
deföed
 
__√ed_sig_©omic_t
 || deföed 
_SIGNAL_H


37 #i‚de‡
__sig_©omic_t_deföed


38 
	#__sig_©omic_t_deföed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #unde‡
__√ed_sig_©omic_t


46 #i‡
deföed
 
__√ed_sig£t_t
 || (deföed 
_SIGNAL_H
 && deföed 
__USE_POSIX
)

47 #i‚de‡
__sig£t_t_deföed


48 
	#__sig£t_t_deföed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #unde‡
__√ed_sig£t_t


54 #ifde‡
_SIGNAL_H


56 
	~<bôs/ty≥s.h
>

57 
	~<bôs/signum.h
>

59 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


60 #i‚de‡
__pid_t_deföed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_deföed


	)

64 #ifde‡
__USE_XOPEN


66 #i‚de‡
__uid_t_deföed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_deföed


	)

72 #ifde‡
__USE_POSIX199309


74 
	#__√ed_time•ec


	)

75 
	~<time.h
>

78 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_XOPEN_EXTENDED


80 
	~<bôs/sigöfo.h
>

85 (*
	t__sigh™dÀr_t
) ();

90 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

91 
__THROW
;

92 #ifde‡
__USE_GNU


93 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifde‡
__USE_BSD


102 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

103 
__THROW
;

106 #ifde‡
__REDIRECT_NTH


107 
__sigh™dÀr_t
 
	`__REDIRECT_NTH
 (
sig«l
,

108 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
),

109 
__sysv_sig«l
);

111 
	#sig«l
 
__sysv_sig«l


	)

114 
__END_NAMESPACE_STD


116 #ifde‡
__USE_XOPEN


119 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

120 
__THROW
;

126 #ifde‡
__USE_POSIX


127 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

130 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


134 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$øi£
 (
__sig
Ë
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifde‡
__USE_SVID


144 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

145 
__THROW
;

146 
	$gsig«l
 (
__sig
Ë
__THROW
;

149 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K


151 
	`psig«l
 (
__sig
, c⁄° *
__s
);

154 #ifde‡
__USE_XOPEN2K


156 
	`psigöfo
 (c⁄° 
sigöfo_t
 *
__pöfo
, c⁄° *
__s
);

169 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

171 #ifde‡
__FAVOR_BSD


174 
	$sig∑u£
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

176 #ifde‡
__USE_XOPEN


177 #ifde‡
__GNUC__


178 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

181 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

187 #ifde‡
__USE_BSD


194 
	#sigmask
(
sig
Ë
	`__sigmask
(sig)

	)

197 
	$sigblock
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

200 
	$sig£tmask
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

203 
	$siggëmask
 (Ë
__THROW
 
__©åibuã_dïªˇãd__
;

207 #ifde‡
__USE_MISC


208 
	#NSIG
 
_NSIG


	)

211 #ifde‡
__USE_GNU


212 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

216 #ifde‡
__USE_BSD


217 
__sigh™dÀr_t
 
	tsig_t
;

220 #ifde‡
__USE_POSIX


223 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

226 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

229 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

232 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

235 
	$sigismembî
 (c⁄° 
sig£t_t
 *
__£t
, 
__signo
)

236 
__THROW
 
	`__n⁄nuŒ
 ((1));

238 #ifde‡
__USE_GNU


240 
	$sigi£m±y£t
 (c⁄° 
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

243 
	$sig™d£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

244 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

247 
	$sig‹£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

248 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

253 
	~<bôs/siga˘i⁄.h
>

256 
	$sig¥ocmask
 (
__how
, c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

257 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

264 
	$sigsu•íd
 (c⁄° 
sig£t_t
 *
__£t
Ë
	`__n⁄nuŒ
 ((1));

267 
	$siga˘i⁄
 (
__sig
, c⁄° 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

268 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

271 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

278 
	$sigwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
)

279 
	`__n⁄nuŒ
 ((1, 2));

281 #ifde‡
__USE_POSIX199309


286 
	$sigwaôöfo
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

287 
sigöfo_t
 *
__ª°ri˘
 
__öfo
Ë
	`__n⁄nuŒ
 ((1));

294 
	$sigtimedwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

295 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

296 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
)

297 
	`__n⁄nuŒ
 ((1));

301 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, c⁄° 
sigvÆ
 
__vÆ
)

302 
__THROW
;

307 #ifde‡
__USE_BSD


311 c⁄° *c⁄° 
_sys_sigli°
[
_NSIG
];

312 c⁄° *c⁄° 
sys_sigli°
[
_NSIG
];

315 
	ssigvec


317 
__sigh™dÀr_t
 
sv_h™dÀr
;

318 
sv_mask
;

320 
sv_Êags
;

321 
	#sv_⁄°ack
 
sv_Êags


	)

325 
	#SV_ONSTACK
 (1 << 0)

	)

326 
	#SV_INTERRUPT
 (1 << 1)

	)

327 
	#SV_RESETHAND
 (1 << 2)

	)

335 
	$sigvec
 (
__sig
, c⁄° 
sigvec
 *
__vec
,

336 
sigvec
 *
__ovec
Ë
__THROW
;

340 
	~<bôs/sigc⁄ãxt.h
>

343 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

348 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


349 
	#__√ed_size_t


	)

350 
	~<°ddef.h
>

355 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

357 
	~<bôs/sig°ack.h
>

358 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


360 
	~<sys/uc⁄ãxt.h
>

366 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
)

367 
__THROW
 
__©åibuã_dïªˇãd__
;

371 
	$sigÆt°ack
 (c⁄° 
sigÆt°ack
 *
__ª°ri˘
 
__ss
,

372 
sigÆt°ack
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

376 #ifde‡
__USE_XOPEN_EXTENDED


380 
	$sighﬁd
 (
__sig
Ë
__THROW
;

383 
	$sigªl£
 (
__sig
Ë
__THROW
;

386 
	$sigign‹e
 (
__sig
Ë
__THROW
;

389 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

392 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


395 
	~<bôs/±hªadty≥s.h
>

396 
	~<bôs/sigthªad.h
>

403 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

405 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

409 
__END_DECLS


	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


25 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	#__√ed_FILE


	)

37 
	#__√ed___FILE


	)

41 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

51 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

52 || 
deföed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_deföed
 1

	)

58 #unde‡
__√ed_FILE


61 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_deföed
 1

	)

68 #unde‡
__√ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


77 #ifde‡
__GNUC__


78 #i‚de‡
_VA_LIST_DEFINED


79 
_G_va_li°
 
	tva_li°
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<°d¨g.h
>

87 #ifde‡
__USE_XOPEN2K8


88 #i‚de‡
__off_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_deföed


	)

96 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_deföed


	)

101 #i‚de‡
__ssize_t_deföed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_deföed


	)

108 
__BEGIN_NAMESPACE_STD


109 #i‚de‡
__USE_FILE_OFFSET64


110 
_G_Âos_t
 
	tÂos_t
;

112 
_G_Âos64_t
 
	tÂos_t
;

114 
__END_NAMESPACE_STD


115 #ifde‡
__USE_LARGEFILE64


116 
_G_Âos64_t
 
	tÂos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #i‚de‡
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #i‚de‡
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde‡
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


151 
	#P_tmpdú
 "/tmp"

	)

164 
	~<bôs/°dio_lim.h
>

168 
_IO_FILE
 *
°dö
;

169 
_IO_FILE
 *
°dout
;

170 
_IO_FILE
 *
°dîr
;

172 
	#°dö
 
°dö


	)

173 
	#°dout
 
°dout


	)

174 
	#°dîr
 
°dîr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

180 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde‡
__USE_ATFILE


185 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

186 c⁄° *
__√w
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #i‚de‡
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

197 #ifde‡
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

200 
	#tmpfûe
 
tmpfûe64


	)

204 #ifde‡
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

209 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde‡
__USE_MISC


215 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

219 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


227 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

228 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`f˛o£
 (
FILE
 *
__°ªam
);

242 
	`fÊush
 (
FILE
 *
__°ªam
);

243 
__END_NAMESPACE_STD


245 #ifde‡
__USE_MISC


252 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

255 #ifde‡
__USE_GNU


262 
	`f˛o£Æl
 ();

266 
__BEGIN_NAMESPACE_STD


267 #i‚de‡
__USE_FILE_OFFSET64


272 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

278 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

279 c⁄° *
__ª°ri˘
 
__modes
,

280 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

282 #ifde‡
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

284 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

287 c⁄° *
__ª°ri˘
 
__modes
,

288 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

289 
__wur
;

291 
	#f›í
 
f›í64


	)

292 
	#‰e›í
 
‰e›í64


	)

295 
__END_NAMESPACE_STD


296 #ifde‡
__USE_LARGEFILE64


297 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

298 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

299 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

300 c⁄° *
__ª°ri˘
 
__modes
,

301 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

313 c⁄° *
__ª°ri˘
 
__modes
,

314 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

317 #ifde‡
__USE_XOPEN2K8


319 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

337 
__modes
, 
size_t
 
__n
Ë
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

344 
size_t
 
__size
Ë
__THROW
;

347 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

357 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

362 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

364 
	$•rötf
 (*
__ª°ri˘
 
__s
,

365 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

371 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

372 
_G_va_li°
 
__¨g
);

377 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

379 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

380 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

387 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

388 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

390 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

391 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

392 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde‡
__USE_GNU


399 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

400 
_G_va_li°
 
__¨g
)

401 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

402 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

403 c⁄° *
__ª°ri˘
 
__fmt
, ...)

404 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

405 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

406 c⁄° *
__ª°ri˘
 
__fmt
, ...)

407 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

410 #ifde‡
__USE_XOPEN2K8


412 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

413 
_G_va_li°
 
__¨g
)

414 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

415 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

431 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

434 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

436 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

444 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

445 
__isoc99_fsˇnf
Ë
__wur
;

446 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_sˇnf
Ë
__wur
;

448 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

449 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

450 
__isoc99_ssˇnf
);

452 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

454 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

455 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

456 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

457 
	#fsˇnf
 
__isoc99_fsˇnf


	)

458 
	#sˇnf
 
__isoc99_sˇnf


	)

459 
	#ssˇnf
 
__isoc99_ssˇnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

472 
_G_va_li°
 
__¨g
)

473 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

479 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

483 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

484 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

485 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

487 #i‡!
deföed
 
__USE_GNU
 \

488 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

489 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

490 #ifde‡
__REDIRECT


494 
	`__REDIRECT
 (
vfsˇnf
,

495 (
FILE
 *
__ª°ri˘
 
__s
,

496 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

497 
__isoc99_vfsˇnf
)

498 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

499 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

500 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

501 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

502 
	`__REDIRECT_NTH
 (
vssˇnf
,

503 (c⁄° *
__ª°ri˘
 
__s
,

504 c⁄° *
__ª°ri˘
 
__f‹m©
,

505 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

506 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

508 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

509 c⁄° *
__ª°ri˘
 
__f‹m©
,

510 
_G_va_li°
 
__¨g
Ë
__wur
;

511 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

514 c⁄° *
__ª°ri˘
 
__f‹m©
,

515 
_G_va_li°
 
__¨g
Ë
__THROW
;

516 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

517 
	#vsˇnf
 
__isoc99_vsˇnf


	)

518 
	#vssˇnf
 
__isoc99_vssˇnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgëc
 (
FILE
 *
__°ªam
);

532 
	`gëc
 (
FILE
 *
__°ªam
);

538 
	`gëch¨
 ();

539 
__END_NAMESPACE_STD


543 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

545 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


550 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

551 
	`gëch¨_u∆ocked
 ();

554 #ifde‡
__USE_MISC


561 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

565 
__BEGIN_NAMESPACE_STD


573 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

574 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putch¨
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

587 #ifde‡
__USE_MISC


594 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

597 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


602 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 
	`putch¨_u∆ocked
 (
__c
);

607 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

608 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

610 
	`gëw
 (
FILE
 *
__°ªam
);

613 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

623 
__wur
;

625 #i‡!
deföed
 
__USE_ISOC11
 \

626 || (
deföed
 
__˝lu•lus
 && __cplusplus <= 201103L)

638 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

640 
__END_NAMESPACE_STD


642 #ifde‡
__USE_GNU


649 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

650 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

668 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

669 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

670 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

678 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

679 
size_t
 *
__ª°ri˘
 
__n
,

680 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

695 
	`puts
 (c⁄° *
__s
);

702 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

709 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

715 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde‡
__USE_GNU


726 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

727 
FILE
 *
__ª°ri˘
 
__°ªam
);

730 #ifde‡
__USE_MISC


737 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

739 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

754 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

759 
	`ªwöd
 (
FILE
 *
__°ªam
);

760 
__END_NAMESPACE_STD


767 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


768 #i‚de‡
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

778 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

780 #ifde‡
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#·ñlo
 
·ñlo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #i‚de‡
__USE_FILE_OFFSET64


798 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

803 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

805 #ifde‡
__REDIRECT


806 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

807 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

808 
	`__REDIRECT
 (
f£ços
,

809 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

811 
	#fgëpos
 
fgëpos64


	)

812 
	#f£ços
 
f£ços64


	)

815 
__END_NAMESPACE_STD


817 #ifde‡
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

819 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

820 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

821 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

828 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde‡
__USE_MISC


835 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

836 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

837 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`≥º‹
 (c⁄° *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bôs/sys_îæi°.h
>

856 #ifdef 
__USE_POSIX


858 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

861 #ifde‡
__USE_MISC


863 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

867 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

868 
deföed
 
__USE_MISC
)

873 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

879 
	`p˛o£
 (
FILE
 *
__°ªam
);

883 #ifdef 
__USE_POSIX


885 *
	$˘îmid
 (*
__s
Ë
__THROW
;

889 #ifde‡
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob°ack
;

899 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

901 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

902 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

903 c⁄° *
__ª°ri˘
 
__f‹m©
,

904 
_G_va_li°
 
__¨gs
)

905 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

909 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


913 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

917 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

920 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

923 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


927 
	#__√ed_gë›t


	)

928 
	~<gë›t.h
>

933 #ifde‡
__USE_EXTERN_INLINES


934 
	~<bôs/°dio.h
>

936 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


937 
	~<bôs/°dio2.h
>

939 #ifde‡
__LDBL_COMPAT


940 
	~<bôs/°dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__a
;

422 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

423 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

424 
	$î™d48_r
 (
__xsubi
[3],

425 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

426 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

429 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

430 *
__ª°ri˘
 
__ªsu…
)

431 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

432 
	$ƒ™d48_r
 (
__xsubi
[3],

433 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

434 *
__ª°ri˘
 
__ªsu…
)

435 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

439 *
__ª°ri˘
 
__ªsu…
)

440 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

441 
	$jønd48_r
 (
__xsubi
[3],

442 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

443 *
__ª°ri˘
 
__ªsu…
)

444 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

448 
__THROW
 
	`__n⁄nuŒ
 ((2));

450 
	$£ed48_r
 (
__£ed16v
[3],

451 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$lc⁄g48_r
 (
__∑øm
[7],

454 
dønd48_d©a
 *
__buf„r
)

455 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

461 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


462 
	#__mÆloc_™d_ˇŒoc_deföed


	)

463 
__BEGIN_NAMESPACE_STD


465 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

467 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

468 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

469 
__END_NAMESPACE_STD


472 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


473 
__BEGIN_NAMESPACE_STD


479 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

480 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

482 
	$‰ì
 (*
__±r
Ë
__THROW
;

483 
__END_NAMESPACE_STD


485 #ifdef 
__USE_MISC


487 
	$c‰ì
 (*
__±r
Ë
__THROW
;

490 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


491 
	~<Æloˇ.h
>

494 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

495 || 
deföed
 
__USE_BSD


497 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

500 #ifde‡
__USE_XOPEN2K


502 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

503 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

506 #ifde‡
__USE_ISOC11


508 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

509 
__THROW
 
__wur
 
	`__©åibuã__
 ((
__mÆloc__
, 
	`__Æloc_size__
 (2)));

512 
__BEGIN_NAMESPACE_STD


514 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

518 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

520 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


522 #ifde‡
__˝lu•lus


523 "C++" 
	`©_quick_exô
 ((*
__func
) ())

524 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

526 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

529 
__END_NAMESPACE_STD


531 #ifdef 
__USE_MISC


534 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

535 
__THROW
 
	`__n⁄nuŒ
 ((1));

538 
__BEGIN_NAMESPACE_STD


542 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

544 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


548 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

550 
__END_NAMESPACE_STD


552 #ifde‡
__USE_ISOC99


553 
__BEGIN_NAMESPACE_C99


556 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

557 
__END_NAMESPACE_C99


561 
__BEGIN_NAMESPACE_STD


563 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

564 
__END_NAMESPACE_STD


566 #ifde‡
__USE_GNU


569 *
	$£cuª_gëív
 (c⁄° *
__«me
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

573 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


577 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

580 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


583 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

584 
__THROW
 
	`__n⁄nuŒ
 ((2));

587 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

590 #ifdef 
__USE_MISC


594 
	$˛óªnv
 (Ë
__THROW
;

598 #i‡
deföed
 
__USE_MISC
 \

599 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

605 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

609 || 
deföed
 
__USE_XOPEN2K8


618 #i‚de‡
__USE_FILE_OFFSET64


619 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

621 #ifde‡
__REDIRECT


622 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

623 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

625 
	#mk°emp
 
mk°emp64


	)

628 #ifde‡
__USE_LARGEFILE64


629 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_MISC


640 #i‚de‡
__USE_FILE_OFFSET64


641 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

643 #ifde‡
__REDIRECT


644 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

645 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

647 
	#mk°emps
 
mk°emps64


	)

650 #ifde‡
__USE_LARGEFILE64


651 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

652 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

656 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


662 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

665 #ifde‡
__USE_GNU


672 #i‚de‡
__USE_FILE_OFFSET64


673 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

675 #ifde‡
__REDIRECT


676 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

677 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

679 
	#mko°emp
 
mko°emp64


	)

682 #ifde‡
__USE_LARGEFILE64


683 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

692 #i‚de‡
__USE_FILE_OFFSET64


693 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

694 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

696 #ifde‡
__REDIRECT


697 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

698 
__Êags
), 
mko°emps64
)

699 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

701 
	#mko°emps
 
mko°emps64


	)

704 #ifde‡
__USE_LARGEFILE64


705 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

706 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

724 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

727 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


733 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

734 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

739 #i‚de‡
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com∑r_‚_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

747 #ifde‡
__USE_GNU


748 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

755 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

756 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

760 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

761 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

762 #ifde‡
__USE_GNU


763 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

764 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

765 
	`__n⁄nuŒ
 ((1, 4));

770 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

771 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

772 
__END_NAMESPACE_STD


774 #ifde‡
__USE_ISOC99


775 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

776 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

780 
__BEGIN_NAMESPACE_STD


784 
div_t
 
	$div
 (
__numî
, 
__díom
)

785 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

786 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

787 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

788 
__END_NAMESPACE_STD


790 #ifde‡
__USE_ISOC99


791 
__BEGIN_NAMESPACE_C99


792 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

793 
__díom
)

794 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

795 
__END_NAMESPACE_C99


799 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

800 || 
deföed
 
__USE_SVID


807 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

808 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

813 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

814 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

819 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

820 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

823 #ifde‡
__USE_MISC


825 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

826 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

827 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

828 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

829 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

830 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

831 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

837 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

838 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

839 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

840 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

841 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

842 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

844 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

845 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

846 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

847 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

848 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

849 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

850 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

851 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

856 
__BEGIN_NAMESPACE_STD


859 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

862 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

863 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

866 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

870 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

871 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

873 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

874 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

875 
__THROW
;

876 
__END_NAMESPACE_STD


879 #ifde‡
__USE_SVID


884 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

888 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


895 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

896 *c⁄° *
__ª°ri˘
 
__tokís
,

897 **
__ª°ri˘
 
__vÆuï
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

902 #ifde‡
__USE_XOPEN


904 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

910 #ifde‡
__USE_XOPEN2KXSI


912 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

915 #ifde‡
__USE_XOPEN


920 
	$gø¡±
 (
__fd
Ë
__THROW
;

924 
	$u∆ock±
 (
__fd
Ë
__THROW
;

929 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

932 #ifde‡
__USE_GNU


936 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

937 
__THROW
 
	`__n⁄nuŒ
 ((2));

940 
	`gë±
 ();

943 #ifde‡
__USE_BSD


947 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

948 
__THROW
 
	`__n⁄nuŒ
 ((1));

951 
	~<bôs/°dlib-Êﬂt.h
>

954 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


955 
	~<bôs/°dlib.h
>

957 #ifde‡
__LDBL_COMPAT


958 
	~<bôs/°dlib-ldbl.h
>

962 #unde‡
__√ed_mÆloc_™d_ˇŒoc


964 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

35 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


54 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

65 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

69 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

74 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 #ifde‡
__OPTIMIZE__


78 
__exã∫_Æways_ölöe
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


81  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

84 
__exã∫_Æways_ölöe
 const *

85 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


87  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifde‡
__USE_GNU


100 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

107 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

128 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

129 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

133 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

137 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

141 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

151 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
 
	`__n⁄nuŒ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifde‡
__USE_XOPEN2K8


159 
	~<xloˇÀ.h
>

162 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

163 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

165 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

166 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

169 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

170 || 
deföed
 
__USE_XOPEN2K8


172 *
	$°rdup
 (c⁄° *
__s
)

173 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

179 #i‡
deföed
 
__USE_XOPEN2K8


180 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

181 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

184 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


186 
	#°rdu∑
(
s
) \

187 (
__exãnsi⁄__
 \

189 c⁄° *
__ﬁd
 = (
s
); \

190 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

191 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

192 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

193 
	}
}))

	)

196 
	#°∫du∑
(
s
, 
n
) \

197 (
__exãnsi⁄__
 \

199 c⁄° *
__ﬁd
 = (
s
); \

200 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

201 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

202 
__√w
[
__Àn
] = '\0'; \

203 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

204 }))

	)

207 
	g__BEGIN_NAMESPACE_STD


209 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


212 *
°rchr
 (*
__s
, 
__c
)

213 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

214 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

215 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

217 #ifde‡
__OPTIMIZE__


218 
__exã∫_Æways_ölöe
 *

219 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


221  
__buûtö_°rchr
 (
__s
, 
__c
);

224 
__exã∫_Æways_ölöe
 const *

225 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


227  
__buûtö_°rchr
 (
__s
, 
__c
);

232 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

233 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

236 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


239 *
	`°ºchr
 (*
__s
, 
__c
)

240 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

241 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

242 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

244 #ifde‡
__OPTIMIZE__


245 
__exã∫_Æways_ölöe
 *

246 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


248  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

251 
__exã∫_Æways_ölöe
 const *

252 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


254  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

257 
	}
}

259 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

260 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 
__END_NAMESPACE_STD


264 #ifde‡
__USE_GNU


267 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


268 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

269 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

270 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

271 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

273 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

274 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

278 
__BEGIN_NAMESPACE_STD


281 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

282 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

285 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

288 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


291 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

292 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

293 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

294 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

296 #ifde‡
__OPTIMIZE__


297 
__exã∫_Æways_ölöe
 *

298 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


300  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

303 
__exã∫_Æways_ölöe
 const *

304 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


306  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

309 
	}
}

311 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

312 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

315 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


318 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

319 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

320 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

321 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

323 #ifde‡
__OPTIMIZE__


324 
__exã∫_Æways_ölöe
 *

325 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


327  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

330 
__exã∫_Æways_ölöe
 const *

331 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


333  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

336 
	}
}

338 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

339 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

344 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

345 
__THROW
 
	`__n⁄nuŒ
 ((2));

346 
__END_NAMESPACE_STD


350 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

351 c⁄° *
__ª°ri˘
 
__dñim
,

352 **
__ª°ri˘
 
__ßve_±r
)

353 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

354 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


355 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

360 #ifde‡
__USE_GNU


362 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


363 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

364 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

365 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

366 c⁄° *
__√edÀ
)

367 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

374 #ifde‡
__USE_GNU


378 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

379 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

380 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

384 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

385 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

386 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

387 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

388 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

389 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

393 
__BEGIN_NAMESPACE_STD


395 
size_t
 
	$°æí
 (c⁄° *
__s
)

396 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

397 
__END_NAMESPACE_STD


399 #ifdef 
__USE_XOPEN2K8


402 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

403 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

407 
__BEGIN_NAMESPACE_STD


409 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

410 
__END_NAMESPACE_STD


411 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


419 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


422 #ifde‡
__REDIRECT_NTH


423 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

424 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

425 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

427 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

428 
__THROW
 
	`__n⁄nuŒ
 ((2));

429 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

434 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

435 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

439 #ifde‡
__USE_XOPEN2K8


441 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

447 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

449 #ifde‡
__USE_BSD


451 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

455 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

458 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

459 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

462 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


465 *
	`ödex
 (*
__s
, 
__c
)

466 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

467 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

468 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

470 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


471 
__exã∫_Æways_ölöe
 *

472 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


474  
	`__buûtö_ödex
 (
__s
, 
__c
);

477 
__exã∫_Æways_ölöe
 const *

478 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


480  
	`__buûtö_ödex
 (
__s
, 
__c
);

483 
	}
}

485 *
	$ödex
 (c⁄° *
__s
, 
__c
)

486 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

490 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


493 *
	`rödex
 (*
__s
, 
__c
)

494 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

495 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

496 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

498 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


499 
__exã∫_Æways_ölöe
 *

500 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


502  
	`__buûtö_rödex
 (
__s
, 
__c
);

505 
__exã∫_Æways_ölöe
 const *

506 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


508  
	`__buûtö_rödex
 (
__s
, 
__c
);

511 
	}
}

513 *
	$rödex
 (c⁄° *
__s
, 
__c
)

514 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

519 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

523 #ifdef 
__USE_GNU


524 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

525 #ifde‡
__GNUC__


526 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

527 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

532 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

533 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

536 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

537 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

540 #ifdef 
__USE_GNU


543 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

544 
__loˇÀ_t
 
__loc
)

545 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

547 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

548 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

549 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

552 #ifdef 
__USE_BSD


555 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

556 c⁄° *
__ª°ri˘
 
__dñim
)

557 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

560 #ifdef 
__USE_XOPEN2K8


562 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

565 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

566 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

567 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

572 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

573 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

575 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

576 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

577 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

580 #ifdef 
__USE_GNU


582 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

583 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

586 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

589 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #i‚de‡
ba£«me


596 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


597 "C++" *
	$ba£«me
 (*
__fûíame
)

598 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

599 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

602 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

609 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

610 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


630 
	~<bôs/°rög.h
>

633 
	~<bôs/°rög2.h
>

636 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


638 
	~<bôs/°rög3.h
>

642 
__END_DECLS


	@/usr/include/strings.h

19 #i‚def 
_STRINGS_H


20 
	#_STRINGS_H
 1

	)

25 #i‡!
deföed
 
_STRING_H
 || !deföed 
__USE_BSD


27 
	~<„©uªs.h
>

28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

32 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

33 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

36 
	g__BEGIN_DECLS


38 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


40 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

41 
__THROW
 
__©åibuã_puª__
;

44 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
Ë
__THROW
;

47 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
;

50 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


53 *
	`ödex
 (*
__s
, 
__c
)

54 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

55 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

56 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

58 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRING_H_PROTO


59 
__exã∫_Æways_ölöe
 *

60 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


62  
	`__buûtö_ödex
 (
__s
, 
__c
);

65 
__exã∫_Æways_ölöe
 const *

66 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


68  
	`__buûtö_ödex
 (
__s
, 
__c
);

71 
	}
}

73 *
	$ödex
 (c⁄° *
__s
, 
__c
)

74 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


81 *
	`rödex
 (*
__s
, 
__c
)

82 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

83 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

84 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

86 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRING_H_PROTO


87 
__exã∫_Æways_ölöe
 *

88 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


90  
	`__buûtö_rödex
 (
__s
, 
__c
);

93 
__exã∫_Æways_ölöe
 const *

94 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


96  
	`__buûtö_rödex
 (
__s
, 
__c
);

99 
	}
}

101 *
	$rödex
 (c⁄° *
__s
, 
__c
)

102 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8
 || deföed 
__USE_XOPEN2K8XSI


109 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((const));

113 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

114 
__THROW
 
__©åibuã_puª__
;

117 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

118 
__THROW
 
__©åibuã_puª__
;

120 #ifdef 
__USE_XOPEN2K8


124 
	~<xloˇÀ.h
>

128 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__loc
)

129 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

131 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

132 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

133 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

136 
__END_DECLS


	@/usr/include/sys/cdefs.h

19 #i‚def 
_SYS_CDEFS_H


20 
	#_SYS_CDEFS_H
 1

	)

23 #i‚de‡
_FEATURES_H


24 
	~<„©uªs.h
>

30 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


35 #unde‡
__P


36 #unde‡
__PMT


38 #ifde‡
__GNUC__


42 #i‡
__GNUC_PREREQ
 (4, 6Ë&& !
deföed
 
_LIBC


43 
	#__LEAF
 , 
__Àaf__


	)

44 
	#__LEAF_ATTR
 
	`__©åibuã__
 ((
__Àaf__
))

	)

46 
	#__LEAF


	)

47 
	#__LEAF_ATTR


	)

55 #i‡!
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (3, 3)

56 
	#__THROW
 
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
))

	)

57 
	#__THROWNL
 
	`__©åibuã__
 ((
__nŸhrow__
))

	)

58 
	#__NTH
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
)Ë
	)
f˘

60 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
f˘
Ë
__LEAF_ATTR
 f˘ 
	`throw
 ()

	)

65 
	#__THROW


	)

66 
	#__THROWNL


	)

67 
	#__NTH
(
f˘
Ë
	)
f˘

73 
	#__ölöe


	)

75 
	#__THROW


	)

76 
	#__THROWNL


	)

77 
	#__NTH
(
f˘
Ë
	)
f˘

83 
	#__P
(
¨gs
Ë
	)
¨gs

84 
	#__PMT
(
¨gs
Ë
	)
¨gs

89 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

90 
	#__STRING
(
x
Ë#x

	)

93 
	#__±r_t
 *

	)

94 
	#__l⁄g_doubÀ_t
 

	)

98 #ifdef 
__˝lu•lus


99 
	#__BEGIN_DECLS
 "C" {

	)

100 
	#__END_DECLS
 }

	)

102 
	#__BEGIN_DECLS


	)

103 
	#__END_DECLS


	)

112 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES


113 
	#__BEGIN_NAMESPACE_STD
 
«me•a˚
 
°d
 {

	)

114 
	#__END_NAMESPACE_STD
 }

	)

115 
	#__USING_NAMESPACE_STD
(
«me
Ë
usög
 
°d
::«me;

	)

116 
	#__BEGIN_NAMESPACE_C99
 
«me•a˚
 
__c99
 {

	)

117 
	#__END_NAMESPACE_C99
 }

	)

118 
	#__USING_NAMESPACE_C99
(
«me
Ë
usög
 
__c99
::«me;

	)

123 
	#__BEGIN_NAMESPACE_STD


	)

124 
	#__END_NAMESPACE_STD


	)

125 
	#__USING_NAMESPACE_STD
(
«me
)

	)

126 
	#__BEGIN_NAMESPACE_C99


	)

127 
	#__END_NAMESPACE_C99


	)

128 
	#__USING_NAMESPACE_C99
(
«me
)

	)

133 #i‚de‡
__BOUNDED_POINTERS__


134 
	#__bounded


	)

135 
	#__unbounded


	)

136 
	#__±rvÆue


	)

141 
	#__bos
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

142 
	#__bos0
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 0)

	)

144 #i‡
__GNUC_PREREQ
 (4,3)

145 
	#__w¨nde˛
(
«me
, 
msg
) \

146 
	`«me
 (Ë
	`__©åibuã__
((
	`__w¨nög__
 (
msg
)))

	)

147 
	#__w¨«âr
(
msg
Ë
	`__©åibuã__
((
	`__w¨nög__
 (msg)))

	)

148 
	#__îr‹de˛
(
«me
, 
msg
) \

149 
	`«me
 (Ë
	`__©åibuã__
((
	`__îr‹__
 (
msg
)))

	)

151 
	#__w¨nde˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

152 
	#__w¨«âr
(
msg
)

	)

153 
	#__îr‹de˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

157 #i‡
__GNUC_PREREQ
 (2,97)

159 
	#__Êex¨r
 []

	)

161 #ifde‡
__GNUC__


162 
	#__Êex¨r
 [0]

	)

164 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

165 
	#__Êex¨r
 []

	)

168 
	#__Êex¨r
 [1]

	)

184 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

186 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

187 #ifde‡
__˝lu•lus


188 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

189 
«me
 
¥Ÿo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

190 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

191 
«me
 
¥Ÿo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

193 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

194 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROW


	)

195 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

196 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROWNL


	)

198 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

199 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
˙ame

212 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

213 
	#__©åibuã__
(
xyz
Ë

	)

219 #i‡
__GNUC_PREREQ
 (2,96)

220 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

222 
	#__©åibuã_mÆloc__


	)

228 #i‡
__GNUC_PREREQ
 (2,96)

229 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

231 
	#__©åibuã_puª__


	)

235 #i‡
__GNUC_PREREQ
 (2,5)

236 
	#__©åibuã_c⁄°__
 
	`__©åibuã__
 ((
__c⁄°__
))

	)

238 
	#__©åibuã_c⁄°__


	)

244 #i‡
__GNUC_PREREQ
 (3,1)

245 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

246 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

248 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

249 
	#__©åibuã_noölöe__


	)

253 #i‡
__GNUC_PREREQ
 (3,2)

254 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

256 
	#__©åibuã_dïªˇãd__


	)

265 #i‡
__GNUC_PREREQ
 (2,8)

266 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

268 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

275 #i‡
__GNUC_PREREQ
 (2,97)

276 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

277 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

279 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

284 #i‡
__GNUC_PREREQ
 (3,3)

285 
	#__n⁄nuŒ
(
∑øms
Ë
	`__©åibuã__
 ((
__n⁄nuŒ__
Ö¨ams))

	)

287 
	#__n⁄nuŒ
(
∑øms
)

	)

292 #i‡
__GNUC_PREREQ
 (3,4)

293 
	#__©åibuã_w¨n_unu£d_ªsu…__
 \

294 
	`__©åibuã__
 ((
__w¨n_unu£d_ªsu…__
))

	)

295 #i‡
__USE_FORTIFY_LEVEL
 > 0

296 
	#__wur
 
__©åibuã_w¨n_unu£d_ªsu…__


	)

299 
	#__©åibuã_w¨n_unu£d_ªsu…__


	)

301 #i‚de‡
__wur


302 
	#__wur


	)

306 #i‡
__GNUC_PREREQ
 (3,2)

307 
	#__Æways_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__Æways_ölöe__
))

	)

309 
	#__Æways_ölöe
 
__ölöe


	)

314 #i‡
__GNUC_PREREQ
 (4,3)

315 
	#__©åibuã_¨tificül__
 
	`__©åibuã__
 ((
__¨tificül__
))

	)

317 
	#__©åibuã_¨tificül__


	)

329 #i‡(!
deföed
 
__˝lu•lus
 || 
__GNUC_PREREQ
 (4,3) \

330 || (
deföed
 
__˛™g__
 && (deföed 
__GNUC_STDC_INLINE__
 \

331 || 
deföed
 
__GNUC_GNU_INLINE__
)))

332 #i‡
deföed
 
__GNUC_STDC_INLINE__
 || deföed 
__˝lu•lus


333 
	#__exã∫_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

334 
	#__exã∫_Æways_ölöe
 \

335 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

337 
	#__exã∫_ölöe
 
__ölöe


	)

338 
	#__exã∫_Æways_ölöe
 
__Æways_ölöe


	)

342 #ifde‡
__exã∫_Æways_ölöe


343 
	#__f‹tify_fun˘i⁄
 
__exã∫_Æways_ölöe
 
__©åibuã_¨tificül__


	)

348 #i‡
__GNUC_PREREQ
 (4,3)

349 
	#__va_¨g_∑ck
(Ë
	`__buûtö_va_¨g_∑ck
 ()

	)

350 
	#__va_¨g_∑ck_Àn
(Ë
	`__buûtö_va_¨g_∑ck_Àn
 ()

	)

357 #i‡!
__GNUC_PREREQ
 (2,8)

358 
	#__exãnsi⁄__


	)

362 #i‡!
__GNUC_PREREQ
 (2,92)

363 
	#__ª°ri˘


	)

369 #i‡
__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


370 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

372 #ifde‡
__GNUC__


373 
	#__ª°ri˘_¨r


	)

375 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

376 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

379 
	#__ª°ri˘_¨r


	)

384 #i‡
__GNUC__
 >= 3

385 
	#__glibc_u∆ikñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
((c⁄d), 0)

	)

386 
	#__glibc_likñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
((c⁄d), 1)

	)

388 
	#__glibc_u∆ikñy
(
c⁄d
Ë(c⁄d)

	)

389 
	#__glibc_likñy
(
c⁄d
Ë(c⁄d)

	)

392 
	~<bôs/w‹dsize.h
>

394 #i‡
deföed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && deföed 
__NO_LONG_DOUBLE_MATH


395 
	#__LDBL_COMPAT
 1

	)

396 #ifde‡
__REDIRECT


397 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

398 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
) \

399 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

400 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT_NTH
 («me,ÖrŸo,álüs)

	)

401 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
) \

402 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

403 
	#__LDBL_REDIR1_DECL
(
«me
, 
Æüs
) \

404 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 (#Æüs));

	)

405 
	#__LDBL_REDIR_DECL
(
«me
) \

406 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 ("__∆dbl_" #«me));

	)

407 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

408 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

409 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

410 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

413 #i‡!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT


414 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê
	)
¥Ÿo

415 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
Ë«mê
	)
¥Ÿo

416 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
__THROW


	)

417 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
Ë«mê¥Ÿÿ
__THROW


	)

418 
	#__LDBL_REDIR_DECL
(
«me
)

	)

419 #ifde‡
__REDIRECT


420 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

421 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

422 
	`__REDIRECT_NTH
 (
«me
, 
¥Ÿo
, 
Æüs
)

	)

	@/usr/include/sys/fcntl.h

1 
	~<f˙é.h
>

	@/usr/include/sys/ioctl.h

18 #i‚def 
_SYS_IOCTL_H


19 
	#_SYS_IOCTL_H
 1

	)

21 
	~<„©uªs.h
>

23 
	g__BEGIN_DECLS


26 
	~<bôs/io˘ls.h
>

29 
	~<bôs/io˘l-ty≥s.h
>

36 
	~<sys/âydeÁu…s.h
>

41 
	$io˘l
 (
__fd
, 
__ªque°
, ...Ë
__THROW
;

43 
__END_DECLS


	@/usr/include/sys/param.h

19 #i‚de‡
_SYS_PARAM_H


20 
	#_SYS_PARAM_H
 1

	)

22 
	#__√ed_NULL


	)

23 
	~<°ddef.h
>

25 
	~<sys/ty≥s.h
>

26 
	~<limôs.h
>

27 
	~<ídün.h
>

28 
	~<sig«l.h
>

31 
	~<bôs/∑øm.h
>

36 
	#NBBY
 
CHAR_BIT


	)

38 #i‡!
deföed
 
NGROUPS
 && deföed 
NGROUPS_MAX


39 
	#NGROUPS
 
NGROUPS_MAX


	)

41 #i‡!
deföed
 
MAXSYMLINKS
 && deföed 
SYMLOOP_MAX


42 
	#MAXSYMLINKS
 
SYMLOOP_MAX


	)

44 #i‡!
deföed
 
CANBSIZ
 && deföed 
MAX_CANON


45 
	#CANBSIZ
 
MAX_CANON


	)

47 #i‡!
deföed
 
MAXPATHLEN
 && deföed 
PATH_MAX


48 
	#MAXPATHLEN
 
PATH_MAX


	)

50 #i‡!
deföed
 
NOFILE
 && deföed 
OPEN_MAX


51 
	#NOFILE
 
OPEN_MAX


	)

53 #i‚de‡
NCARGS


54 #ifde‡
ARG_MAX


55 
	#NCARGS
 
ARG_MAX


	)

59 
	#NCARGS
 
INT_MAX


	)

65 #i‚de‡
NOGROUP


66 
	#NOGROUP
 65535

	)

68 #i‚de‡
NODEV


69 
	#NODEV
 ((
dev_t
Ë-1Ë

	)

74 
	#DEV_BSIZE
 512

	)

78 
	#£tbô
(
a
,
i
Ë(◊)[(i)/
NBBY
] |1<<((i)%NBBY))

	)

79 
	#˛rbô
(
a
,
i
Ë(◊)[(i)/
NBBY
] &~(1<<((i)%NBBY)))

	)

80 
	#is£t
(
a
,
i
Ë(◊)[(i)/
NBBY
] & (1<<((i)%NBBY)))

	)

81 
	#is˛r
(
a
,
i
Ë((◊)[(i)/
NBBY
] & (1<<((i)%NBBY))Ë=0)

	)

84 #i‚de‡
howm™y


85 
	#howm™y
(
x
, 
y
Ë(((xË+ ((yË- 1)Ë/ (y))

	)

87 #ifde‡
__GNUC__


88 
	#roundup
(
x
, 
y
Ë(
	`__buûtö_c⁄°™t_p
 (yË&& 
	`powîof2
 (y) \

89 ? (((
x
Ë+ (
y
) - 1) & ~((y) - 1)) \

90 : ((((
x
Ë+ ((
y
Ë- 1)Ë/ (y)Ë* (y)))

	)

92 
	#roundup
(
x
, 
y
Ë((((xË+ ((yË- 1)Ë/ (y)Ë* (y))

	)

94 
	#powîof2
(
x
Ë((((xË- 1Ë& (x)Ë=0)

	)

97 
	#MIN
(
a
,
b
Ë((◊)<(b))?◊):(b))

	)

98 
	#MAX
(
a
,
b
Ë((◊)>(b))?◊):(b))

	)

	@/usr/include/sys/prctl.h

18 #i‚de‡
_SYS_PRCTL_H


19 
	#_SYS_PRCTL_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<löux/¥˘l.h
>

24 
__BEGIN_DECLS


27 
	$¥˘l
 (
__›ti⁄
, ...Ë
__THROW
;

29 
__END_DECLS


	@/usr/include/sys/resource.h

19 #i‚def 
_SYS_RESOURCE_H


20 
	#_SYS_RESOURCE_H
 1

	)

22 
	~<„©uªs.h
>

25 
	~<bôs/ªsour˚.h
>

27 #i‚de‡
__id_t_deföed


28 
__id_t
 
	tid_t
;

29 
	#__id_t_deföed


	)

32 
	g__BEGIN_DECLS


38 #i‡
deföed
 
__USE_GNU
 && !deföed 
__˝lu•lus


39 
__æimô_ªsour˚
 
	t__æimô_ªsour˚_t
;

40 
__rußge_who
 
	t__rußge_who_t
;

41 
__¥i‹ôy_which
 
	t__¥i‹ôy_which_t
;

43 
	t__æimô_ªsour˚_t
;

44 
	t__rußge_who_t
;

45 
	t__¥i‹ôy_which_t
;

50 #i‚de‡
__USE_FILE_OFFSET64


51 
	$gëæimô
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

52 
æimô
 *
__æimôs
Ë
__THROW
;

54 #ifde‡
__REDIRECT_NTH


55 
	`__REDIRECT_NTH
 (
gëæimô
, (
__æimô_ªsour˚_t
 
__ªsour˚
,

56 
æimô
 *
__æimôs
), 
gëæimô64
);

58 
	#gëæimô
 
gëæimô64


	)

61 #ifde‡
__USE_LARGEFILE64


62 
	$gëæimô64
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

63 
æimô64
 *
__æimôs
Ë
__THROW
;

69 #i‚de‡
__USE_FILE_OFFSET64


70 
	$£ålimô
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

71 c⁄° 
æimô
 *
__æimôs
Ë
__THROW
;

73 #ifde‡
__REDIRECT_NTH


74 
	`__REDIRECT_NTH
 (
£ålimô
, (
__æimô_ªsour˚_t
 
__ªsour˚
,

75 c⁄° 
æimô
 *
__æimôs
),

76 
£ålimô64
);

78 
	#£ålimô
 
£ålimô64


	)

81 #ifde‡
__USE_LARGEFILE64


82 
	$£ålimô64
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

83 c⁄° 
æimô64
 *
__æimôs
Ë
__THROW
;

88 
	$gërußge
 (
__rußge_who_t
 
__who
, 
rußge
 *
__ußge
Ë
__THROW
;

94 
	$gë¥i‹ôy
 (
__¥i‹ôy_which_t
 
__which
, 
id_t
 
__who
Ë
__THROW
;

98 
	$£çri‹ôy
 (
__¥i‹ôy_which_t
 
__which
, 
id_t
 
__who
, 
__¥io
)

99 
__THROW
;

101 
__END_DECLS


	@/usr/include/sys/select.h

21 #i‚de‡
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

30 
	~<bôs/£À˘.h
>

33 
	~<bôs/sig£t.h
>

35 #i‚de‡
__sig£t_t_deföed


36 
	#__sig£t_t_deföed


	)

37 
__sig£t_t
 
	tsig£t_t
;

41 
	#__√ed_time_t


	)

42 
	#__√ed_time•ec


	)

43 
	~<time.h
>

44 
	#__√ed_timevÆ


	)

45 
	~<bôs/time.h
>

47 #i‚de‡
__su£c⁄ds_t_deföed


48 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

49 
	#__su£c⁄ds_t_deföed


	)

54 
	t__fd_mask
;

57 #unde‡
__NFDBITS


59 
	#__NFDBITS
 (8 * (Ë (
__fd_mask
))

	)

60 
	#__FD_ELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

61 
	#__FD_MASK
(
d
Ë((
__fd_mask
Ë1 << ((dË% 
__NFDBITS
))

	)

68 #ifde‡
__USE_XOPEN


69 
__fd_mask
 
	mfds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

70 
	#__FDS_BITS
(
£t
Ë((£t)->
fds_bôs
)

	)

72 
__fd_mask
 
	m__fds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
Ë((£t)->
__fds_bôs
)

	)

75 } 
	tfd_£t
;

78 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

80 #ifde‡
__USE_MISC


82 
__fd_mask
 
	tfd_mask
;

85 
	#NFDBITS
 
__NFDBITS


	)

90 
	#FD_SET
(
fd
, 
fd£ç
Ë
	`__FD_SET
 (fd, fd£ç)

	)

91 
	#FD_CLR
(
fd
, 
fd£ç
Ë
	`__FD_CLR
 (fd, fd£ç)

	)

92 
	#FD_ISSET
(
fd
, 
fd£ç
Ë
	`__FD_ISSET
 (fd, fd£ç)

	)

93 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
 (fd£ç)

	)

96 
__BEGIN_DECLS


106 
£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

107 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

108 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

109 
timevÆ
 *
__ª°ri˘
 
__timeout
);

111 #ifde‡
__USE_XOPEN2K


118 
p£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

119 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

120 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

121 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
,

122 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__sigmask
);

127 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__GNUC__


128 
	~<bôs/£À˘2.h
>

131 
	g__END_DECLS


	@/usr/include/sys/socket.h

20 #i‚def 
_SYS_SOCKET_H


21 
	#_SYS_SOCKET_H
 1

	)

23 
	~<„©uªs.h
>

25 
	g__BEGIN_DECLS


27 
	~<sys/uio.h
>

28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

30 #ifde‡
__USE_GNU


32 
	~<bôs/sig£t.h
>

39 
	~<bôs/sockë.h
>

41 #ifde‡
__USE_BSD


44 
	sosockaddr


46 
	mß_Ámûy
;

47 
	mß_d©a
[14];

55 
	mSHUT_RD
 = 0,

56 
	#SHUT_RD
 
SHUT_RD


	)

57 
	mSHUT_WR
,

58 
	#SHUT_WR
 
SHUT_WR


	)

59 
	mSHUT_RDWR


60 
	#SHUT_RDWR
 
SHUT_RDWR


	)

69 #i‡
deföed
 
__˝lu•lus
 || !
__GNUC_PREREQ
 (2, 7Ë|| !deföed 
__USE_GNU


70 
	#__SOCKADDR_ARG
 
sockaddr
 *
__ª°ri˘


	)

71 
	#__CONST_SOCKADDR_ARG
 c⁄° 
sockaddr
 *

	)

75 
	#__SOCKADDR_ALLTYPES
 \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

77 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

78 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

79 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

80 
	`__SOCKADDR_ONETYPE
 (
sockaddr_e⁄
) \

81 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö
) \

82 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö6
) \

83 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö¨p
) \

84 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ùx
) \

85 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

86 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

87 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

88 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

90 
	#__SOCKADDR_ONETYPE
(
ty≥
Ëty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

91 uni⁄ { 
	m__SOCKADDR_ALLTYPES


92 } 
	t__SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

93 #unde‡
__SOCKADDR_ONETYPE


94 
	#__SOCKADDR_ONETYPE
(
ty≥
Ëc⁄° ty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

95 uni⁄ { 
	m__SOCKADDR_ALLTYPES


96 } 
	t__CONST_SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

97 #unde‡
__SOCKADDR_ONETYPE


100 #ifde‡
__USE_GNU


102 
	smmsghdr


104 
msghdr
 
	mmsg_hdr
;

105 
	mmsg_Àn
;

114 
	$sockë
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
Ë
__THROW
;

120 
	$sockë∑ú
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
,

121 
__fds
[2]Ë
__THROW
;

124 
	$böd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
)

125 
__THROW
;

128 
	$gësock«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

129 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

138 
	`c⁄√˘
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
);

142 
	$gë≥î«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

143 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

150 
ssize_t
 
	`£nd
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
, 
__Êags
);

157 
ssize_t
 
	`ªcv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__Êags
);

164 
ssize_t
 
	`£ndto
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

165 
__Êags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

166 
sockÀn_t
 
__addr_Àn
);

175 
ssize_t
 
	`ªcv‰om
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

176 
__Êags
, 
__SOCKADDR_ARG
 
__addr
,

177 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

185 
ssize_t
 
	`£ndmsg
 (
__fd
, c⁄° 
msghdr
 *
__mesßge
,

186 
__Êags
);

188 #ifde‡
__USE_GNU


194 
	`£ndmmsg
 (
__fd
, 
mmsghdr
 *
__vmesßges
,

195 
__vÀn
, 
__Êags
);

203 
ssize_t
 
	`ªcvmsg
 (
__fd
, 
msghdr
 *
__mesßge
, 
__Êags
);

205 #ifde‡
__USE_GNU


211 
	`ªcvmmsg
 (
__fd
, 
mmsghdr
 *
__vmesßges
,

212 
__vÀn
, 
__Êags
,

213 c⁄° 
time•ec
 *
__tmo
);

220 
	$gësock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

221 *
__ª°ri˘
 
__›tvÆ
,

222 
sockÀn_t
 *
__ª°ri˘
 
__›éí
Ë
__THROW
;

227 
	$£tsock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

228 c⁄° *
__›tvÆ
, 
sockÀn_t
 
__›éí
Ë
__THROW
;

234 
	$li°í
 (
__fd
, 
__n
Ë
__THROW
;

244 
	`ac˚±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

245 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

247 #ifde‡
__USE_GNU


252 
	`ac˚±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

253 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
, 
__Êags
);

262 
	$shutdown
 (
__fd
, 
__how
Ë
__THROW
;

265 #ifde‡
__USE_XOPEN2K


267 
	$sock©m¨k
 (
__fd
Ë
__THROW
;

271 #ifde‡
__USE_MISC


275 
	$isfdty≥
 (
__fd
, 
__fdty≥
Ë
__THROW
;

280 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


281 
	~<bôs/sockë2.h
>

284 
__END_DECLS


	@/usr/include/sys/stat.h

23 #i‚def 
_SYS_STAT_H


24 
	#_SYS_STAT_H
 1

	)

26 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

30 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K
 || deföed 
__USE_MISC
 \

31 || 
deföed
 
	g__USE_ATFILE


32 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


33 
	#__√ed_time_t


	)

35 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ATFILE


36 
	#__√ed_time•ec


	)

38 
	~<time.h
>

41 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


44 #i‚de‡
__dev_t_deföed


45 
__dev_t
 
	tdev_t
;

46 
	#__dev_t_deföed


	)

49 #i‚de‡
__gid_t_deföed


50 
__gid_t
 
	tgid_t
;

51 
	#__gid_t_deföed


	)

54 #i‚de‡
__öo_t_deföed


55 #i‚de‡
__USE_FILE_OFFSET64


56 
__öo_t
 
	töo_t
;

58 
__öo64_t
 
	töo_t
;

60 
	#__öo_t_deföed


	)

63 #i‚de‡
__mode_t_deföed


64 
__mode_t
 
	tmode_t
;

65 
	#__mode_t_deföed


	)

68 #i‚de‡
__∆ök_t_deföed


69 
__∆ök_t
 
	t∆ök_t
;

70 
	#__∆ök_t_deföed


	)

73 #i‚de‡
__off_t_deföed


74 #i‚de‡
__USE_FILE_OFFSET64


75 
__off_t
 
	toff_t
;

77 
__off64_t
 
	toff_t
;

79 
	#__off_t_deföed


	)

82 #i‚de‡
__uid_t_deföed


83 
__uid_t
 
	tuid_t
;

84 
	#__uid_t_deföed


	)

88 #ifde‡
__USE_UNIX98


89 #i‚de‡
__blk˙t_t_deföed


90 #i‚de‡
__USE_FILE_OFFSET64


91 
__blk˙t_t
 
	tblk˙t_t
;

93 
__blk˙t64_t
 
	tblk˙t_t
;

95 
	#__blk˙t_t_deföed


	)

98 #i‚de‡
__blksize_t_deföed


99 
__blksize_t
 
	tblksize_t
;

100 
	#__blksize_t_deföed


	)

104 
	g__BEGIN_DECLS


106 
	~<bôs/°©.h
>

108 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


109 
	#S_IFMT
 
__S_IFMT


	)

110 
	#S_IFDIR
 
__S_IFDIR


	)

111 
	#S_IFCHR
 
__S_IFCHR


	)

112 
	#S_IFBLK
 
__S_IFBLK


	)

113 
	#S_IFREG
 
__S_IFREG


	)

114 #ifde‡
__S_IFIFO


115 
	#S_IFIFO
 
__S_IFIFO


	)

117 #ifde‡
__S_IFLNK


118 
	#S_IFLNK
 
__S_IFLNK


	)

120 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_UNIX98
) \

121 && 
deföed
 
	g__S_IFSOCK


122 
	#S_IFSOCK
 
__S_IFSOCK


	)

128 
	#__S_ISTYPE
(
mode
, 
mask
Ë(((modeË& 
__S_IFMT
Ë=(mask))

	)

130 
	#S_ISDIR
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

131 
	#S_ISCHR
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

132 
	#S_ISBLK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

133 
	#S_ISREG
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

134 #ifde‡
__S_IFIFO


135 
	#S_ISFIFO
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

137 #ifde‡
__S_IFLNK


138 
	#S_ISLNK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

141 #i‡
deföed
 
__USE_BSD
 && !deföed 
__S_IFLNK


142 
	#S_ISLNK
(
mode
Ë0

	)

145 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K
) \

146 && 
deföed
 
	g__S_IFSOCK


147 
	#S_ISSOCK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

148 #ñi‡
deföed
 
__USE_XOPEN2K


149 
	#S_ISSOCK
(
mode
Ë0

	)

156 #ifdef 
__USE_POSIX199309


157 
	#S_TYPEISMQ
(
buf
Ë
	`__S_TYPEISMQ
(buf)

	)

158 
	#S_TYPEISSEM
(
buf
Ë
	`__S_TYPEISSEM
(buf)

	)

159 
	#S_TYPEISSHM
(
buf
Ë
	`__S_TYPEISSHM
(buf)

	)

165 
	#S_ISUID
 
__S_ISUID


	)

166 
	#S_ISGID
 
__S_ISGID


	)

168 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


170 
	#S_ISVTX
 
__S_ISVTX


	)

173 
	#S_IRUSR
 
__S_IREAD


	)

174 
	#S_IWUSR
 
__S_IWRITE


	)

175 
	#S_IXUSR
 
__S_IEXEC


	)

177 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

179 #i‡
deföed
 
__USE_MISC
 && deföed 
__USE_BSD


180 
	#S_IREAD
 
S_IRUSR


	)

181 
	#S_IWRITE
 
S_IWUSR


	)

182 
	#S_IEXEC
 
S_IXUSR


	)

185 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

186 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

187 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

189 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

191 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

192 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

193 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

195 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

198 #ifdef 
__USE_BSD


200 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
Ë

	)

201 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

202 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

204 
	#S_BLKSIZE
 512

	)

208 #i‚de‡
__USE_FILE_OFFSET64


210 
	$°©
 (c⁄° *
__ª°ri˘
 
__fûe
,

211 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

215 
	$f°©
 (
__fd
, 
°©
 *
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

217 #ifde‡
__REDIRECT_NTH


218 
	`__REDIRECT_NTH
 (
°©
, (c⁄° *
__ª°ri˘
 
__fûe
,

219 
°©
 *
__ª°ri˘
 
__buf
), 
°©64
)

220 
	`__n⁄nuŒ
 ((1, 2));

221 
	`__REDIRECT_NTH
 (
f°©
, (
__fd
, 
°©
 *
__buf
), 
f°©64
)

222 
	`__n⁄nuŒ
 ((2));

224 
	#°©
 
°©64


	)

225 
	#f°©
 
f°©64


	)

228 #ifde‡
__USE_LARGEFILE64


229 
	$°©64
 (c⁄° *
__ª°ri˘
 
__fûe
,

230 
°©64
 *
__ª°ri˘
 
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

231 
	$f°©64
 (
__fd
, 
°©64
 *
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

234 #ifde‡
__USE_ATFILE


238 #i‚de‡
__USE_FILE_OFFSET64


239 
	$f°©©
 (
__fd
, c⁄° *
__ª°ri˘
 
__fûe
,

240 
°©
 *
__ª°ri˘
 
__buf
, 
__Êag
)

241 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

243 #ifde‡
__REDIRECT_NTH


244 
	`__REDIRECT_NTH
 (
f°©©
, (
__fd
, c⁄° *
__ª°ri˘
 
__fûe
,

245 
°©
 *
__ª°ri˘
 
__buf
,

246 
__Êag
),

247 
f°©©64
Ë
	`__n⁄nuŒ
 ((2, 3));

249 
	#f°©©
 
f°©©64


	)

253 #ifde‡
__USE_LARGEFILE64


254 
	$f°©©64
 (
__fd
, c⁄° *
__ª°ri˘
 
__fûe
,

255 
°©64
 *
__ª°ri˘
 
__buf
, 
__Êag
)

256 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

260 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


261 #i‚de‡
__USE_FILE_OFFSET64


264 
	$l°©
 (c⁄° *
__ª°ri˘
 
__fûe
,

265 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

267 #ifde‡
__REDIRECT_NTH


268 
	`__REDIRECT_NTH
 (
l°©
,

269 (c⁄° *
__ª°ri˘
 
__fûe
,

270 
°©
 *
__ª°ri˘
 
__buf
), 
l°©64
)

271 
	`__n⁄nuŒ
 ((1, 2));

273 
	#l°©
 
l°©64


	)

276 #ifde‡
__USE_LARGEFILE64


277 
	$l°©64
 (c⁄° *
__ª°ri˘
 
__fûe
,

278 
°©64
 *
__ª°ri˘
 
__buf
)

279 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

285 
	$chmod
 (c⁄° *
__fûe
, 
__mode_t
 
__mode
)

286 
__THROW
 
	`__n⁄nuŒ
 ((1));

288 #ifde‡
__USE_BSD


292 
	$lchmod
 (c⁄° *
__fûe
, 
__mode_t
 
__mode
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

297 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_POSIX


298 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
Ë
__THROW
;

301 #ifde‡
__USE_ATFILE


304 
	$fchmod©
 (
__fd
, c⁄° *
__fûe
, 
__mode_t
 
__mode
,

305 
__Êag
)

306 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

313 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
Ë
__THROW
;

315 #ifdef 
__USE_GNU


318 
__mode_t
 
	$gëumask
 (Ë
__THROW
;

322 
	$mkdú
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
)

323 
__THROW
 
	`__n⁄nuŒ
 ((1));

325 #ifde‡
__USE_ATFILE


329 
	$mkdú©
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
)

330 
__THROW
 
	`__n⁄nuŒ
 ((2));

336 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


337 
	$mknod
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

338 
__THROW
 
	`__n⁄nuŒ
 ((1));

340 #ifde‡
__USE_ATFILE


344 
	$mknod©
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
,

345 
__dev_t
 
__dev
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

351 
	$mkfifo
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
)

352 
__THROW
 
	`__n⁄nuŒ
 ((1));

354 #ifde‡
__USE_ATFILE


358 
	$mkfifﬂt
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
)

359 
__THROW
 
	`__n⁄nuŒ
 ((2));

362 #ifde‡
__USE_ATFILE


365 
	$utimíßt
 (
__fd
, c⁄° *
__∑th
,

366 c⁄° 
time•ec
 
__times
[2],

367 
__Êags
)

368 
__THROW
 
	`__n⁄nuŒ
 ((2));

371 #ifde‡
__USE_XOPEN2K8


373 
	$futimís
 (
__fd
, c⁄° 
time•ec
 
__times
[2]Ë
__THROW
;

391 #i‚de‡
_STAT_VER


392 
	#_STAT_VER
 0

	)

394 #i‚de‡
_MKNOD_VER


395 
	#_MKNOD_VER
 0

	)

399 #i‚de‡
__USE_FILE_OFFSET64


400 
	$__fx°©
 (
__vî
, 
__fûdes
, 
°©
 *
__°©_buf
)

401 
__THROW
 
	`__n⁄nuŒ
 ((3));

402 
	$__x°©
 (
__vî
, c⁄° *
__fûíame
,

403 
°©
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

404 
	$__lx°©
 (
__vî
, c⁄° *
__fûíame
,

405 
°©
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

406 
	$__fx°©©
 (
__vî
, 
__fûdes
, c⁄° *
__fûíame
,

407 
°©
 *
__°©_buf
, 
__Êag
)

408 
__THROW
 
	`__n⁄nuŒ
 ((3, 4));

410 #ifde‡
__REDIRECT_NTH


411 
	`__REDIRECT_NTH
 (
__fx°©
, (
__vî
, 
__fûdes
,

412 
°©
 *
__°©_buf
), 
__fx°©64
)

413 
	`__n⁄nuŒ
 ((3));

414 
	`__REDIRECT_NTH
 (
__x°©
, (
__vî
, c⁄° *
__fûíame
,

415 
°©
 *
__°©_buf
), 
__x°©64
)

416 
	`__n⁄nuŒ
 ((2, 3));

417 
	`__REDIRECT_NTH
 (
__lx°©
, (
__vî
, c⁄° *
__fûíame
,

418 
°©
 *
__°©_buf
), 
__lx°©64
)

419 
	`__n⁄nuŒ
 ((2, 3));

420 
	`__REDIRECT_NTH
 (
__fx°©©
, (
__vî
, 
__fûdes
,

421 c⁄° *
__fûíame
,

422 
°©
 *
__°©_buf
, 
__Êag
),

423 
__fx°©©64
Ë
	`__n⁄nuŒ
 ((3, 4));

426 
	#__fx°©
 
__fx°©64


	)

427 
	#__x°©
 
__x°©64


	)

428 
	#__lx°©
 
__lx°©64


	)

432 #ifde‡
__USE_LARGEFILE64


433 
	$__fx°©64
 (
__vî
, 
__fûdes
, 
°©64
 *
__°©_buf
)

434 
__THROW
 
	`__n⁄nuŒ
 ((3));

435 
	$__x°©64
 (
__vî
, c⁄° *
__fûíame
,

436 
°©64
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

437 
	$__lx°©64
 (
__vî
, c⁄° *
__fûíame
,

438 
°©64
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

439 
	$__fx°©©64
 (
__vî
, 
__fûdes
, c⁄° *
__fûíame
,

440 
°©64
 *
__°©_buf
, 
__Êag
)

441 
__THROW
 
	`__n⁄nuŒ
 ((3, 4));

443 
	$__xmknod
 (
__vî
, c⁄° *
__∑th
, 
__mode_t
 
__mode
,

444 
__dev_t
 *
__dev
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

446 
	$__xmknod©
 (
__vî
, 
__fd
, c⁄° *
__∑th
,

447 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

448 
__THROW
 
	`__n⁄nuŒ
 ((3, 5));

450 #i‡
deföed
 
__GNUC__
 && __GNUC__ >2 && deföed 
__USE_EXTERN_INLINES


453 
__exã∫_ölöe
 

454 
	`__NTH
 (
	$°©
 (c⁄° *
__∑th
, 
°©
 *
__°©buf
))

456  
	`__x°©
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

457 
	}
}

459 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


460 
__exã∫_ölöe
 

461 
__NTH
 (
	$l°©
 (c⁄° *
__∑th
, 
°©
 *
__°©buf
))

463  
	`__lx°©
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

464 
	}
}

467 
__exã∫_ölöe
 

468 
__NTH
 (
	$f°©
 (
__fd
, 
°©
 *
__°©buf
))

470  
	`__fx°©
 (
_STAT_VER
, 
__fd
, 
__°©buf
);

471 
	}
}

473 #ifde‡
__USE_ATFILE


474 
__exã∫_ölöe
 

475 
__NTH
 (
	$f°©©
 (
__fd
, c⁄° *
__fûíame
, 
°©
 *
__°©buf
,

476 
__Êag
))

478  
	`__fx°©©
 (
_STAT_VER
, 
__fd
, 
__fûíame
, 
__°©buf
, 
__Êag
);

479 
	}
}

482 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_BSD


483 
__exã∫_ölöe
 

484 
__NTH
 (
	$mknod
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

486  
	`__xmknod
 (
_MKNOD_VER
, 
__∑th
, 
__mode
, &
__dev
);

487 
	}
}

490 #ifde‡
__USE_ATFILE


491 
__exã∫_ölöe
 

492 
__NTH
 (
	$mknod©
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
,

493 
__dev_t
 
__dev
))

495  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__∑th
, 
__mode
, &
__dev
);

496 
	}
}

499 #i‡
deföed
 
__USE_LARGEFILE64
 \

500 && (! 
deföed
 
	g__USE_FILE_OFFSET64
 \

501 || (
deföed
 
	g__REDIRECT_NTH
 && deföed 
	g__OPTIMIZE__
))

502 
__exã∫_ölöe
 

503 
__NTH
 (
	$°©64
 (c⁄° *
__∑th
, 
°©64
 *
__°©buf
))

505  
	`__x°©64
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

506 
	}
}

508 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


509 
__exã∫_ölöe
 

510 
__NTH
 (
	$l°©64
 (c⁄° *
__∑th
, 
°©64
 *
__°©buf
))

512  
	`__lx°©64
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

513 
	}
}

516 
__exã∫_ölöe
 

517 
__NTH
 (
	$f°©64
 (
__fd
, 
°©64
 *
__°©buf
))

519  
	`__fx°©64
 (
_STAT_VER
, 
__fd
, 
__°©buf
);

520 
	}
}

522 #ifde‡
__USE_ATFILE


523 
__exã∫_ölöe
 

524 
__NTH
 (
	$f°©©64
 (
__fd
, c⁄° *
__fûíame
, 
°©64
 *
__°©buf
,

525 
__Êag
))

527  
	`__fx°©©64
 (
_STAT_VER
, 
__fd
, 
__fûíame
, 
__°©buf
, 
__Êag
);

528 
	}
}

535 
	g__END_DECLS


	@/usr/include/sys/sysctl.h

18 #i‚def 
_SYS_SYSCTL_H


19 
	#_SYS_SYSCTL_H
 1

	)

21 
	~<„©uªs.h
>

22 
	#__√ed_size_t


	)

23 
	~<°ddef.h
>

25 #i‚de‡
_LINUX_KERNEL_H


26 
	#_LINUX_KERNEL_H
 1

	)

27 
	#__undef_LINUX_KERNEL_H


	)

29 #i‚de‡
_LINUX_TYPES_H


30 
	#_LINUX_TYPES_H
 1

	)

31 
	#__undef_LINUX_TYPES_H


	)

33 #i‚de‡
_LINUX_LIST_H


34 
	#_LINUX_LIST_H
 1

	)

35 
	#__undef_LINUX_LIST_H


	)

37 #i‚de‡
__LINUX_COMPILER_H


38 
	#__LINUX_COMPILER_H
 1

	)

39 
	#__u£r


	)

40 
	#__undef__LINUX_COMPILER_H


	)

43 
	~<löux/sys˘l.h
>

45 #ifde‡
__undef_LINUX_KERNEL_H


46 #unde‡
_LINUX_KERNEL_H


47 #unde‡
__undef_LINUX_KERNEL_H


49 #ifde‡
__undef_LINUX_TYPES_H


50 #unde‡
_LINUX_TYPES_H


51 #unde‡
__undef_LINUX_TYPES_H


53 #ifde‡
__undef_LINUX_LIST_H


54 #unde‡
_LINUX_LIST_H


55 #unde‡
__undef_LINUX_LIST_H


57 #ifde‡
__undef__LINUX_COMPILER_H


58 #unde‡
__LINUX_COMPILER_H


59 #unde‡
__u£r


60 #unde‡
__undef__LINUX_COMPILER_H


63 
	~<bôs/sys˘l.h
>

65 
__BEGIN_DECLS


68 
	$sys˘l
 (*
__«me
, 
__∆í
, *
__ﬁdvÆ
,

69 
size_t
 *
__ﬁdÀ≈
, *
__√wvÆ
, size_à
__√wÀn
Ë
__THROW
;

71 
__END_DECLS


	@/usr/include/sys/time.h

19 #i‚de‡
_SYS_TIME_H


20 
	#_SYS_TIME_H
 1

	)

22 
	~<„©uªs.h
>

24 
	~<bôs/ty≥s.h
>

25 
	#__√ed_time_t


	)

26 
	~<time.h
>

27 
	#__√ed_timevÆ


	)

28 
	~<bôs/time.h
>

30 
	~<sys/£À˘.h
>

32 #i‚de‡
__su£c⁄ds_t_deföed


33 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

34 
	#__su£c⁄ds_t_deföed


	)

38 
	g__BEGIN_DECLS


40 #ifde‡
__USE_GNU


42 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

43 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

44 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

45 }

	)

46 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

47 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

48 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

49 }

	)

53 #ifde‡
__USE_BSD


56 
	stimez⁄e


58 
	mtz_möuãswe°
;

59 
	mtz_d°time
;

62 
timez⁄e
 *
	t__ª°ri˘
 
	t__timez⁄e_±r_t
;

64 *
	t__ª°ri˘
 
	t__timez⁄e_±r_t
;

72 
	$gëtimeofday
 (
timevÆ
 *
__ª°ri˘
 
__tv
,

73 
__timez⁄e_±r_t
 
__tz
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

75 #ifde‡
__USE_BSD


78 
	$£âimeofday
 (c⁄° 
timevÆ
 *
__tv
,

79 c⁄° 
timez⁄e
 *
__tz
)

80 
__THROW
;

86 
	$adjtime
 (c⁄° 
timevÆ
 *
__dñè
,

87 
timevÆ
 *
__ﬁddñè
Ë
__THROW
;

92 
	e__ôimî_which


95 
ITIMER_REAL
 = 0,

96 
	#ITIMER_REAL
 
ITIMER_REAL


	)

98 
ITIMER_VIRTUAL
 = 1,

99 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

102 
ITIMER_PROF
 = 2

103 
	#ITIMER_PROF
 
ITIMER_PROF


	)

108 
	sôimîvÆ


111 
timevÆ
 
ô_öãrvÆ
;

113 
timevÆ
 
ô_vÆue
;

116 #i‡
deföed
 
__USE_GNU
 && !deföed 
__˝lu•lus


119 
__ôimî_which
 
	t__ôimî_which_t
;

121 
	t__ôimî_which_t
;

126 
	$gëôimî
 (
__ôimî_which_t
 
__which
,

127 
ôimîvÆ
 *
__vÆue
Ë
__THROW
;

132 
	$£tôimî
 (
__ôimî_which_t
 
__which
,

133 c⁄° 
ôimîvÆ
 *
__ª°ri˘
 
__√w
,

134 
ôimîvÆ
 *
__ª°ri˘
 
__ﬁd
Ë
__THROW
;

139 
	$utimes
 (c⁄° *
__fûe
, c⁄° 
timevÆ
 
__tvp
[2])

140 
__THROW
 
	`__n⁄nuŒ
 ((1));

142 #ifde‡
__USE_BSD


144 
	$lutimes
 (c⁄° *
__fûe
, c⁄° 
timevÆ
 
__tvp
[2])

145 
__THROW
 
	`__n⁄nuŒ
 ((1));

148 
	$futimes
 (
__fd
, c⁄° 
timevÆ
 
__tvp
[2]Ë
__THROW
;

151 #ifde‡
__USE_GNU


155 
	$futimeßt
 (
__fd
, c⁄° *
__fûe
,

156 c⁄° 
timevÆ
 
__tvp
[2]Ë
__THROW
;

160 #ifde‡
__USE_BSD


163 
	#timîis£t
(
tvp
Ë(—vp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

164 
	#timî˛ór
(
tvp
Ë(—vp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

165 
	#timîcmp
(
a
, 
b
, 
CMP
) \

166 (((
a
)->
tv_£c
 =(
b
)->tv_sec) ? \

167 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

168 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

169 
	#timîadd
(
a
, 
b
, 
ªsu…
) \

171 (
ªsu…
)->
tv_£c
 = (
a
)->tv_£¯+ (
b
)->tv_sec; \

172 (
ªsu…
)->
tv_u£c
 = (
a
)->tv_u£¯+ (
b
)->tv_usec; \

173 i‡((
ªsu…
)->
tv_u£c
 >= 1000000) \

175 ++(
ªsu…
)->
tv_£c
; \

176 (
ªsu…
)->
tv_u£c
 -= 1000000; \

178 
	}
} 0)

	)

179 
	#timîsub
(
a
, 
b
, 
ªsu…
) \

181 (
ªsu…
)->
tv_£c
 = (
a
)->tv_£¯- (
b
)->tv_sec; \

182 (
ªsu…
)->
tv_u£c
 = (
a
)->tv_u£¯- (
b
)->tv_usec; \

183 i‡((
ªsu…
)->
tv_u£c
 < 0) { \

184 --(
ªsu…
)->
tv_£c
; \

185 (
ªsu…
)->
tv_u£c
 += 1000000; \

187 } 0)

	)

190 
	g__END_DECLS


	@/usr/include/sys/types.h

22 #i‚def 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 #ifdef 
__USE_BSD


32 #i‚de‡
__u_ch¨_deföed


33 
__u_ch¨
 
	tu_ch¨
;

34 
__u_sh‹t
 
	tu_sh‹t
;

35 
__u_öt
 
	tu_öt
;

36 
__u_l⁄g
 
	tu_l⁄g
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¨_deföed


	)

44 
__loff_t
 
	tloff_t
;

46 #i‚de‡
__öo_t_deföed


47 #i‚de‡
__USE_FILE_OFFSET64


48 
__öo_t
 
	töo_t
;

50 
__öo64_t
 
	töo_t
;

52 
	#__öo_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


55 
__öo64_t
 
	töo64_t
;

56 
	#__öo64_t_deföed


	)

59 #i‚de‡
__dev_t_deföed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_deföed


	)

64 #i‚de‡
__gid_t_deföed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_deföed


	)

69 #i‚de‡
__mode_t_deföed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_deföed


	)

74 #i‚de‡
__∆ök_t_deföed


75 
__∆ök_t
 
	t∆ök_t
;

76 
	#__∆ök_t_deföed


	)

79 #i‚de‡
__uid_t_deföed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_deföed


	)

84 #i‚de‡
__off_t_deföed


85 #i‚de‡
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_deföed


	)

92 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_deföed


	)

97 #i‚de‡
__pid_t_deföed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_deföed


	)

102 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
) \

103 && !
deföed
 
__id_t_deföed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_deföed


	)

108 #i‚de‡
__ssize_t_deföed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_deföed


	)

113 #ifdef 
__USE_BSD


114 #i‚de‡
__daddr_t_deföed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ˇddr_t
 
	tˇddr_t
;

117 
	#__daddr_t_deföed


	)

121 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__key_t_deföed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_deföed


	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#__√ed_˛ock_t


	)

129 
	#__√ed_time_t


	)

130 
	#__√ed_timî_t


	)

131 
	#__√ed_˛ockid_t


	)

132 
	~<time.h
>

134 #ifde‡
__USE_XOPEN


135 #i‚de‡
__u£c⁄ds_t_deföed


136 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

137 
	#__u£c⁄ds_t_deföed


	)

139 #i‚de‡
__su£c⁄ds_t_deföed


140 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

141 
	#__su£c⁄ds_t_deföed


	)

145 
	#__√ed_size_t


	)

146 
	~<°ddef.h
>

148 #ifde‡
__USE_MISC


150 
	tul⁄g
;

151 
	tush‹t
;

152 
	tuöt
;

157 #i‡!
__GNUC_PREREQ
 (2, 7)

160 #i‚de‡
__öt8_t_deföed


161 
	#__öt8_t_deföed


	)

162 
	töt8_t
;

163 
	töt16_t
;

164 
	töt32_t
;

165 #i‡
__WORDSIZE
 == 64

166 
	töt64_t
;

167 #ñi‡
__GLIBC_HAVE_LONG_LONG


168 
__exãnsi⁄__
 
	töt64_t
;

173 
	tu_öt8_t
;

174 
	tu_öt16_t
;

175 
	tu_öt32_t
;

176 #i‡
__WORDSIZE
 == 64

177 
	tu_öt64_t
;

178 #ñi‡
__GLIBC_HAVE_LONG_LONG


179 
__exãnsi⁄__
 
	tu_öt64_t
;

182 
	tªgi°î_t
;

187 
	#__ötN_t
(
N
, 
MODE
) \

188 ##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

189 
	t__u_ötN_t
(
	tN
, 
	tMODE
) \

190 
	tu_öt
##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

192 #i‚de‡
	t__öt8_t_deföed


193 
	t__öt8_t_deföed


	)

194 
	t__ötN_t
 (8, 
	t__QI__
);

195 
__ötN_t
 (16, 
__HI__
);

196 
__ötN_t
 (32, 
__SI__
);

197 
__ötN_t
 (64, 
__DI__
);

200 
__u_ötN_t
 (8, 
__QI__
);

201 
__u_ötN_t
 (16, 
__HI__
);

202 
__u_ötN_t
 (32, 
__SI__
);

203 
__u_ötN_t
 (64, 
__DI__
);

205 
	tªgi°î_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__w‹d__
)));

211 
	#__BIT_TYPES_DEFINED__
 1

	)

214 #ifdef 
__USE_BSD


216 
	~<ídün.h
>

219 
	~<sys/£À˘.h
>

222 
	~<sys/sysma¸os.h
>

226 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
) \

227 && !
deföed
 
__blksize_t_deföed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_deföed


	)

233 #i‚de‡
__USE_FILE_OFFSET64


234 #i‚de‡
__blk˙t_t_deföed


235 
__blk˙t_t
 
	tblk˙t_t
;

236 
	#__blk˙t_t_deföed


	)

238 #i‚de‡
__fsblk˙t_t_deföed


239 
__fsblk˙t_t
 
	tfsblk˙t_t
;

240 
	#__fsblk˙t_t_deföed


	)

242 #i‚de‡
__fsfû˙t_t_deföed


243 
__fsfû˙t_t
 
	tfsfû˙t_t
;

244 
	#__fsfû˙t_t_deföed


	)

247 #i‚de‡
__blk˙t_t_deföed


248 
__blk˙t64_t
 
	tblk˙t_t
;

249 
	#__blk˙t_t_deföed


	)

251 #i‚de‡
__fsblk˙t_t_deföed


252 
__fsblk˙t64_t
 
	tfsblk˙t_t
;

253 
	#__fsblk˙t_t_deföed


	)

255 #i‚de‡
__fsfû˙t_t_deföed


256 
__fsfû˙t64_t
 
	tfsfû˙t_t
;

257 
	#__fsfû˙t_t_deföed


	)

261 #ifde‡
__USE_LARGEFILE64


262 
__blk˙t64_t
 
	tblk˙t64_t
;

263 
__fsblk˙t64_t
 
	tfsblk˙t64_t
;

264 
__fsfû˙t64_t
 
	tfsfû˙t64_t
;

269 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


270 
	~<bôs/±hªadty≥s.h
>

273 
	g__END_DECLS


	@/usr/include/sys/uio.h

19 #i‚de‡
_SYS_UIO_H


20 
	#_SYS_UIO_H
 1

	)

22 
	~<„©uªs.h
>

24 
	~<sys/ty≥s.h
>

26 
	g__BEGIN_DECLS


29 
	~<bôs/uio.h
>

40 
ssize_t
 
	$ªadv
 (
__fd
, c⁄° 
iovec
 *
__iovec
, 
__cou¡
)

41 
__wur
;

51 
ssize_t
 
	$wrôev
 (
__fd
, c⁄° 
iovec
 *
__iovec
, 
__cou¡
)

52 
__wur
;

55 #ifde‡
__USE_BSD


56 #i‚de‡
__USE_FILE_OFFSET64


66 
ssize_t
 
	$¥ódv
 (
__fd
, c⁄° 
iovec
 *
__iovec
, 
__cou¡
,

67 
__off_t
 
__off£t
Ë
__wur
;

78 
ssize_t
 
	$pwrôev
 (
__fd
, c⁄° 
iovec
 *
__iovec
, 
__cou¡
,

79 
__off_t
 
__off£t
Ë
__wur
;

81 #ifde‡
__REDIRECT


82 
ssize_t
 
	`__REDIRECT
 (
¥ódv
, (
__fd
, c⁄° 
iovec
 *
__iovec
,

83 
__cou¡
, 
__off64_t
 
__off£t
),

84 
¥ódv64
Ë
__wur
;

85 
ssize_t
 
	`__REDIRECT
 (
pwrôev
, (
__fd
, c⁄° 
iovec
 *
__iovec
,

86 
__cou¡
, 
__off64_t
 
__off£t
),

87 
pwrôev64
Ë
__wur
;

89 
	#¥ódv
 
¥ódv64


	)

90 
	#pwrôev
 
pwrôev64


	)

94 #ifde‡
__USE_LARGEFILE64


104 
ssize_t
 
	$¥ódv64
 (
__fd
, c⁄° 
iovec
 *
__iovec
, 
__cou¡
,

105 
__off64_t
 
__off£t
Ë
__wur
;

116 
ssize_t
 
	$pwrôev64
 (
__fd
, c⁄° 
iovec
 *
__iovec
, 
__cou¡
,

117 
__off64_t
 
__off£t
Ë
__wur
;

121 
__END_DECLS


	@/usr/include/sys/un.h

18 #i‚def 
_SYS_UN_H


19 
	#_SYS_UN_H
 1

	)

21 
	~<sys/cdefs.h
>

24 
	~<bôs/sockaddr.h
>

26 
__BEGIN_DECLS


29 
	ssockaddr_un


31 
__SOCKADDR_COMMON
 (
sun_
);

32 
	msun_∑th
[108];

36 #ifde‡
__USE_MISC


37 
	~<°rög.h
>

40 
	#SUN_LEN
(
±r
Ë((
size_t
Ë(((
sockaddr_un
 *Ë0)->
sun_∑th
) \

41 + 
	`°æí
 ((
±r
)->
sun_∑th
))

	)

44 
	g__END_DECLS


	@/usr/include/sys/utsname.h

22 #i‚def 
_SYS_UTSNAME_H


23 
	#_SYS_UTSNAME_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ut¢ame.h
>

31 #i‚de‡
_UTSNAME_SYSNAME_LENGTH


32 
	#_UTSNAME_SYSNAME_LENGTH
 
_UTSNAME_LENGTH


	)

34 #i‚de‡
_UTSNAME_NODENAME_LENGTH


35 
	#_UTSNAME_NODENAME_LENGTH
 
_UTSNAME_LENGTH


	)

37 #i‚de‡
_UTSNAME_RELEASE_LENGTH


38 
	#_UTSNAME_RELEASE_LENGTH
 
_UTSNAME_LENGTH


	)

40 #i‚de‡
_UTSNAME_VERSION_LENGTH


41 
	#_UTSNAME_VERSION_LENGTH
 
_UTSNAME_LENGTH


	)

43 #i‚de‡
_UTSNAME_MACHINE_LENGTH


44 
	#_UTSNAME_MACHINE_LENGTH
 
_UTSNAME_LENGTH


	)

48 
	sut¢ame


51 
	msy¢ame
[
_UTSNAME_SYSNAME_LENGTH
];

54 
	mnodíame
[
_UTSNAME_NODENAME_LENGTH
];

57 
	mªÀa£
[
_UTSNAME_RELEASE_LENGTH
];

59 
	mvîsi⁄
[
_UTSNAME_VERSION_LENGTH
];

62 
	mmachöe
[
_UTSNAME_MACHINE_LENGTH
];

64 #i‡
_UTSNAME_DOMAIN_LENGTH
 - 0

66 #ifde‡
__USE_GNU


67 
	mdomaö«me
[
_UTSNAME_DOMAIN_LENGTH
];

69 
	m__domaö«me
[
_UTSNAME_DOMAIN_LENGTH
];

74 #ifde‡
__USE_SVID


76 
	#SYS_NMLN
 
_UTSNAME_LENGTH


	)

81 
	$u«me
 (
ut¢ame
 *
__«me
Ë
__THROW
;

84 
__END_DECLS


	@/usr/include/sys/wait.h

23 #i‚def 
_SYS_WAIT_H


24 
	#_SYS_WAIT_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<sig«l.h
>

33 #i‡!
deföed
 
_STDLIB_H
 || (!deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K8
)

36 
	~<bôs/waôÊags.h
>

38 #ifdef 
__USE_BSD


43 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


44 
	#__WAIT_INT
(
°©us
) \

45 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

46 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

48 
	#__WAIT_INT
(
°©us
Ë(*(c⁄° *Ë&(°©us))

	)

56 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


57 
	#__WAIT_STATUS
 *

	)

58 
	#__WAIT_STATUS_DEFN
 *

	)

63 
waô
 *
	m__u±r
;

64 *
	m__ùå
;

65 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

66 
	#__WAIT_STATUS_DEFN
 *

	)

71 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

72 
	#__WAIT_STATUS
 *

	)

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	~<bôs/waô°©us.h
>

80 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

81 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

82 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

83 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

84 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

86 #ifde‡
__WIFCONTINUED


87 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

91 #ifdef 
__USE_BSD


92 
	#WCOREFLAG
 
__WCOREFLAG


	)

93 
	#WCOREDUMP
(
°©us
Ë
	`__WCOREDUMP
 (
	`__WAIT_INT
 (°©us))

	)

94 
	#W_EXITCODE
(
ªt
, 
sig
Ë
	`__W_EXITCODE
 (ªt, sig)

	)

95 
	#W_STOPCODE
(
sig
Ë
	`__W_STOPCODE
 (sig)

	)

99 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


102 
	mP_ALL
,

103 
	mP_PID
,

104 
	mP_PGID


105 } 
	tidty≥_t
;

114 
__pid_t
 
waô
 (
__WAIT_STATUS
 
__°©_loc
);

116 #ifdef 
__USE_BSD


118 
	#WAIT_ANY
 (-1Ë

	)

119 
	#WAIT_MYPGRP
 0

	)

137 
__pid_t
 
waôpid
 (__pid_à
__pid
, *
__°©_loc
, 
__›ti⁄s
);

139 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


140 #i‚de‡
__id_t_deföed


141 
	~<bôs/ty≥s.h
>

142 
__id_t
 
	tid_t
;

143 
	#__id_t_deföed


	)

146 
	#__√ed_sigöfo_t


	)

147 
	~<bôs/sigöfo.h
>

160 
waôid
 (
idty≥_t
 
__idty≥
, 
__id_t
 
__id
, 
sigöfo_t
 *
__öf›
,

161 
__›ti⁄s
);

164 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


167 
	grußge
;

174 
__pid_t
 
	$waô3
 (
__WAIT_STATUS
 
__°©_loc
, 
__›ti⁄s
,

175 
rußge
 * 
__ußge
Ë
__THROWNL
;

178 #ifde‡
__USE_BSD


180 
__pid_t
 
	$waô4
 (
__pid_t
 
__pid
, 
__WAIT_STATUS
 
__°©_loc
, 
__›ti⁄s
,

181 
rußge
 *
__ußge
Ë
__THROWNL
;

185 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¶og.h
>

	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/ucontext.h

20 #i‚de‡
_UCONTEXT_H


21 
	#_UCONTEXT_H
 1

	)

23 
	~<„©uªs.h
>

26 
	~<sys/uc⁄ãxt.h
>

28 
__BEGIN_DECLS


31 
	$gëc⁄ãxt
 (
uc⁄ãxt_t
 *
__u˝
Ë
__THROWNL
;

34 
	$£tc⁄ãxt
 (c⁄° 
uc⁄ãxt_t
 *
__u˝
Ë
__THROWNL
;

38 
	$sw≠c⁄ãxt
 (
uc⁄ãxt_t
 *
__ª°ri˘
 
__ou˝
,

39 c⁄° 
uc⁄ãxt_t
 *
__ª°ri˘
 
__u˝
Ë
__THROWNL
;

47 
	`makec⁄ãxt
 (
uc⁄ãxt_t
 *
__u˝
, (*
__func
) (),

48 
__¨gc
, ...Ë
__THROW
;

50 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifde‡
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #ñi‡
deföed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #ñi‡
deföed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<bôs/posix_›t.h
>

205 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


206 
	~<bôs/ívú⁄míts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<bôs/ty≥s.h
>

219 #i‚def 
__ssize_t_deföed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_deföed


	)

224 
	#__√ed_size_t


	)

225 
	#__√ed_NULL


	)

226 
	~<°ddef.h
>

228 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


231 #i‚de‡
__gid_t_deföed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_deföed


	)

236 #i‚de‡
__uid_t_deföed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_deföed


	)

241 #i‚de‡
__off_t_deföed


242 #i‚de‡
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_deföed


	)

249 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_deföed


	)

254 #i‚de‡
__u£c⁄ds_t_deföed


255 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

256 
	#__u£c⁄ds_t_deföed


	)

259 #i‚de‡
__pid_t_deföed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_deföed


	)

265 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


266 #i‚de‡
__öçå_t_deföed


267 
__öçå_t
 
	töçå_t
;

268 
	#__öçå_t_deföed


	)

272 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


273 #i‚de‡
__sockÀn_t_deföed


274 
__sockÀn_t
 
	tsockÀn_t
;

275 
	#__sockÀn_t_deföed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

289 #ifde‡
__USE_GNU


292 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1));

300 #ifde‡
__USE_ATFILE


304 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

305 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

310 #i‚def 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifde‡
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #i‚de‡
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

336 #ifde‡
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifde‡
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

346 
__THROW
;

353 
	`˛o£
 (
__fd
);

360 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

366 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

368 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


369 #i‚de‡
__USE_FILE_OFFSET64


376 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

377 
__off_t
 
__off£t
Ë
__wur
;

384 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
Ë
__wur
;

387 #ifde‡
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

389 
__off64_t
 
__off£t
),

390 
¥ód64
Ë
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

392 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

393 
pwrôe64
Ë
__wur
;

395 
	#¥ód
 
¥ód64


	)

396 
	#pwrôe
 
pwrôe64


	)

400 #ifde‡
__USE_LARGEFILE64


404 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

405 
__off64_t
 
__off£t
Ë
__wur
;

408 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
Ë
__wur
;

417 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

419 #ifde‡
__USE_GNU


422 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

432 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

444 
	`¶ìp
 (
__£c⁄ds
);

446 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

447 || 
deföed
 
__USE_BSD


452 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

453 
__THROW
;

460 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

469 
	`∑u£
 ();

473 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

476 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

483 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

488 #ifde‡
__USE_ATFILE


491 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

492 
__gid_t
 
__group
, 
__Êag
)

493 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

497 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

499 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


501 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

511 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

520 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

521 || 
deföed
 
__USE_BSD


525 *
	$gëwd
 (*
__buf
)

526 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

531 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

536 #ifde‡
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

543 **
__ívú⁄
;

544 #ifde‡
__USE_GNU


545 **
ívú⁄
;

551 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

552 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

554 #ifde‡
__USE_XOPEN2K8


557 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

558 
__THROW
 
	`__n⁄nuŒ
 ((2));

563 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

564 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

568 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

569 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

573 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

578 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

585 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 #ifde‡
__USE_GNU


590 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

591 *c⁄° 
__ívp
[])

592 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

596 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


598 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

603 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

609 
	~<bôs/c⁄‚ame.h
>

612 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

613 
__THROW
 
	`__n⁄nuŒ
 ((1));

616 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

619 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

628 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

631 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

635 #i‚de‡
__FAVOR_BSD


636 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

638 #ifde‡
__REDIRECT_NTH


639 
__pid_t
 
	`__REDIRECT_NTH
 (
gëpgΩ
, (__pid_à
__pid
), 
__gëpgid
);

641 
	#gëpgΩ
 
__gëpgid


	)

646 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

647 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


648 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

655 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

657 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


668 #i‚de‡
__FAVOR_BSD


672 
	$£çgΩ
 (Ë
__THROW
;

677 #ifde‡
__REDIRECT_NTH


678 
	`__REDIRECT_NTH
 (
£çgΩ
, (
__pid_t
 
__pid
, __pid_à
__pgΩ
), 
£çgid
);

680 
	#£çgΩ
 
£çgid


	)

689 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

691 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


693 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

697 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

700 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

703 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

706 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

711 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

713 #ifdef 
__USE_GNU


715 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

722 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

724 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


727 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

730 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


732 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

739 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

741 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


744 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

747 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


749 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

752 #ifde‡
__USE_GNU


755 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

756 
__THROW
;

760 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

761 
__THROW
;

765 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

766 
__THROW
 
__wur
;

770 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

771 
__THROW
 
__wur
;

778 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

780 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

781 || 
deföed
 
__USE_BSD


786 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

792 *
	$ây«me
 (
__fd
Ë
__THROW
;

796 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

797 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

801 
	$ißây
 (
__fd
Ë
__THROW
;

803 #i‡
deföed
 
__USE_BSD
 \

804 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

807 
	$ây¶Ÿ
 (Ë
__THROW
;

812 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

813 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

815 #ifde‡
__USE_ATFILE


818 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

819 c⁄° *
__to
, 
__Êags
)

820 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

823 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


825 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

826 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

831 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

832 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

833 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

836 #ifde‡
__USE_ATFILE


838 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

839 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

842 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

843 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

844 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

848 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

850 #ifde‡
__USE_ATFILE


852 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

853 
__THROW
 
	`__n⁄nuŒ
 ((2));

857 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

861 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

864 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

871 *
	`gëlogö
 ();

872 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


879 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

882 #ifdef 
__USE_BSD


884 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

888 #ifdef 
__USE_POSIX2


892 
	#__√ed_gë›t


	)

893 
	~<gë›t.h
>

897 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


901 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

905 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

908 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

909 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

913 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

919 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

920 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

921 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

922 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

928 
	$vh™gup
 (Ë
__THROW
;

931 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

939 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

940 
size_t
 
__off£t
, 
__sˇÀ
)

941 
__THROW
 
	`__n⁄nuŒ
 ((1));

947 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

951 *
	$gëu£rshñl
 (Ë
__THROW
;

952 
	$ídu£rshñl
 (Ë
__THROW
;

953 
	$£tu£rshñl
 (Ë
__THROW
;

959 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

963 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

966 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

970 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

978 
	`fsync
 (
__fd
);

981 #ifde‡
__USE_GNU


984 
	$syncfs
 (
__fd
Ë
__THROW
;

988 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


991 
	`gëho°id
 ();

994 
	$sync
 (Ë
__THROW
;

997 #i‡
deföed
 
__USE_BSD
 || !deföed 
__USE_XOPEN2K


1000 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

1005 
	$gëdèbÀsize
 (Ë
__THROW
;

1011 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


1014 #i‚de‡
__USE_FILE_OFFSET64


1015 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

1016 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1018 #ifde‡
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
åunˇã
,

1020 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

1021 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1023 
	#åunˇã
 
åunˇã64


	)

1026 #ifde‡
__USE_LARGEFILE64


1027 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1028 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1033 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_POSIX199309
 \

1034 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1037 #i‚de‡
__USE_FILE_OFFSET64


1038 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1040 #ifde‡
__REDIRECT_NTH


1041 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1042 
·runˇã64
Ë
__wur
;

1044 
	#·runˇã
 
·runˇã64


	)

1047 #ifde‡
__USE_LARGEFILE64


1048 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1054 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1055 || 
deföed
 
__USE_MISC


1059 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1065 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1069 #ifde‡
__USE_MISC


1080 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1085 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1097 
	#F_ULOCK
 0

	)

1098 
	#F_LOCK
 1

	)

1099 
	#F_TLOCK
 2

	)

1100 
	#F_TEST
 3

	)

1102 #i‚de‡
__USE_FILE_OFFSET64


1103 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1105 #ifde‡
__REDIRECT


1106 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1107 
lockf64
Ë
__wur
;

1109 
	#lockf
 
lockf64


	)

1112 #ifde‡
__USE_LARGEFILE64


1113 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1118 #ifde‡
__USE_GNU


1123 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1124 (
__exãnsi⁄__
 \

1125 ({ 
__ªsu…
; \

1126 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1127 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1128 
__ªsu…
; 
	}
}))

	)

1131 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1134 
fd©async
 (
__fûdes
);

1140 #ifdef 
__USE_XOPEN


1142 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1143 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1147 
	$í¸y±
 (*
__block
, 
__edÊag
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1154 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1155 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1161 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1163 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1168 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1169 
	~<bôs/uni°d.h
>

1172 
__END_DECLS


	@/usr/include/uthash.h

24 #i‚de‡
UTHASH_H


25 
	#UTHASH_H


	)

27 
	#UTHASH_VERSION
 2.0.2

	)

29 
	~<°rög.h
>

30 
	~<°ddef.h
>

31 
	~<°dlib.h
>

37 #i‡
deföed
(
_MSC_VER
)

38 #i‡
_MSC_VER
 >1600 && 
deföed
(
__˝lu•lus
)

39 
	#DECLTYPE
(
x
Ë(
	`de˛ty≥
(x))

	)

41 
	#NO_DECLTYPE


	)

42 
	#DECLTYPE
(
x
)

	)

44 #ñi‡
deföed
(
__BORLANDC__
Ë|| deföed(
__LCC__
Ë|| deföed(
__WATCOMC__
)

45 
	#NO_DECLTYPE


	)

46 
	#DECLTYPE
(
x
)

	)

48 
	#DECLTYPE
(
x
Ë(
	`__ty≥of
(x))

	)

51 #ifde‡
NO_DECLTYPE


52 
	#DECLTYPE_ASSIGN
(
d°
,
§c
) \

54 **
_da_d°
 = (**)(&(
d°
)); \

55 *
_da_d°
 = (*)(
§c
); \

56 } 0)

	)

58 
	#DECLTYPE_ASSIGN
(
d°
,
§c
) \

60 (
d°
Ë
	`DECLTYPE
(d°)(
§c
); \

61 } 0)

	)

65 #i‡
deföed
(
_WIN32
)

66 #i‡
deföed
(
_MSC_VER
) && _MSC_VER >= 1600

67 
	~<°döt.h
>

68 #ñi‡
deföed
(
__WATCOMC__
Ë|| deföed(
__MINGW32__
Ë|| deföed(
__CYGWIN__
)

69 
	~<°döt.h
>

71 
	tuöt32_t
;

72 
	tuöt8_t
;

74 #ñi‡
deföed
(
__GNUC__
Ë&& !deföed(
__VXWORKS__
)

75 
	~<°döt.h
>

77 
	tuöt32_t
;

78 
	tuöt8_t
;

81 #i‚de‡
uthash_Áèl


82 
	#uthash_Áèl
(
msg
Ë
	`exô
(-1Ë

	)

84 #i‚de‡
uthash_mÆloc


85 
	#uthash_mÆloc
(
sz
Ë
	`mÆloc
(szË

	)

87 #i‚de‡
uthash_‰ì


88 
	#uthash_‰ì
(
±r
,
sz
Ë
	`‰ì
’åË

	)

90 #i‚de‡
uthash_°æí


91 
	#uthash_°æí
(
s
Ë
	`°æí
(s)

	)

93 #i‚de‡
uthash_memcmp


94 
	#uthash_memcmp
(
a
,
b
,
n
Ë
	`memcmp
◊,b,n)

	)

97 #i‚de‡
uthash_n€x∑nd_fyi


98 
	#uthash_n€x∑nd_fyi
(
tbl
Ë

	)

100 #i‚de‡
uthash_ex∑nd_fyi


101 
	#uthash_ex∑nd_fyi
(
tbl
Ë

	)

105 
	#HASH_INITIAL_NUM_BUCKETS
 32U

	)

106 
	#HASH_INITIAL_NUM_BUCKETS_LOG2
 5U

	)

107 
	#HASH_BKT_CAPACITY_THRESH
 10U

	)

110 
	#ELMT_FROM_HH
(
tbl
,
hhp
Ë((*)(((*)(hhp)Ë- (—bl)->
hho
)))

	)

112 
	#HH_FROM_ELMT
(
tbl
,
ñp
Ë((
UT_hash_h™dÀ
 *)(((*)”Õ)Ë+ (—bl)->
hho
)))

	)

114 
	#HASH_VALUE
(
key±r
,
keyÀn
,
hashv
) \

116 
	`HASH_FCN
(
key±r
, 
keyÀn
, 
hashv
); \

117 } 0)

	)

119 
	#HASH_FIND_BYHASHVALUE
(
hh
,
hód
,
key±r
,
keyÀn
,
hashvÆ
,
out
) \

121 (
out
Ë
NULL
; \

122 i‡(
hód
) { \

123 
_hf_bkt
; \

124 
	`HASH_TO_BKT
(
hashvÆ
, (
hód
)->
hh
.
tbl
->
num_buckës
, 
_hf_bkt
); \

125 i‡(
	`HASH_BLOOM_TEST
((
hód
)->
hh
.
tbl
, 
hashvÆ
) != 0) { \

126 
	`HASH_FIND_IN_BKT
((
hód
)->
hh
.
tbl
, hh, (hód)->hh.tbl->
buckës
[ 
_hf_bkt
 ], 
key±r
, 
keyÀn
, 
hashvÆ
, 
out
); \

129 } 0)

	)

131 
	#HASH_FIND
(
hh
,
hód
,
key±r
,
keyÀn
,
out
) \

133 
_hf_hashv
; \

134 
	`HASH_VALUE
(
key±r
, 
keyÀn
, 
_hf_hashv
); \

135 
	`HASH_FIND_BYHASHVALUE
(
hh
, 
hód
, 
key±r
, 
keyÀn
, 
_hf_hashv
, 
out
); \

136 } 0)

	)

138 #ifde‡
HASH_BLOOM


139 
	#HASH_BLOOM_BITLEN
 (1UL << 
HASH_BLOOM
)

	)

140 
	#HASH_BLOOM_BYTELEN
 (
HASH_BLOOM_BITLEN
/8ULË+ (((HASH_BLOOM_BITLEN%8UL)!=0ULË? 1UL : 0UL)

	)

141 
	#HASH_BLOOM_MAKE
(
tbl
) \

143 (
tbl
)->
bloom_nbôs
 = 
HASH_BLOOM
; \

144 (
tbl
)->
bloom_bv
 = (
uöt8_t
*)
	`uthash_mÆloc
(
HASH_BLOOM_BYTELEN
); \

145 i‡(!((
tbl
)->
bloom_bv
)Ë{ 
	`uthash_Áèl
( "out of memory"); } \

146 
	`mem£t
((
tbl
)->
bloom_bv
, 0, 
HASH_BLOOM_BYTELEN
); \

147 (
tbl
)->
bloom_sig
 = 
HASH_BLOOM_SIGNATURE
; \

148 } 0)

	)

150 
	#HASH_BLOOM_FREE
(
tbl
) \

152 
	`uthash_‰ì
((
tbl
)->
bloom_bv
, 
HASH_BLOOM_BYTELEN
); \

153 } 0)

	)

155 
	#HASH_BLOOM_BITSET
(
bv
,
idx
Ë(bv[(idx)/8U] |(1U << ((idx)%8U)))

	)

156 
	#HASH_BLOOM_BITTEST
(
bv
,
idx
Ë(bv[(idx)/8U] & (1U << ((idx)%8U)))

	)

158 
	#HASH_BLOOM_ADD
(
tbl
,
hashv
) \

159 
	`HASH_BLOOM_BITSET
((
tbl
)->
bloom_bv
, (
hashv
 & (
uöt32_t
)((1ULL << (tbl)->
bloom_nbôs
Ë- 1U)))

	)

161 
	#HASH_BLOOM_TEST
(
tbl
,
hashv
) \

162 
	`HASH_BLOOM_BITTEST
((
tbl
)->
bloom_bv
, (
hashv
 & (
uöt32_t
)((1ULL << (tbl)->
bloom_nbôs
Ë- 1U)))

	)

165 
	#HASH_BLOOM_MAKE
(
tbl
)

	)

166 
	#HASH_BLOOM_FREE
(
tbl
)

	)

167 
	#HASH_BLOOM_ADD
(
tbl
,
hashv
)

	)

168 
	#HASH_BLOOM_TEST
(
tbl
,
hashv
Ë(1)

	)

169 
	#HASH_BLOOM_BYTELEN
 0U

	)

172 
	#HASH_MAKE_TABLE
(
hh
,
hód
) \

174 (
hód
)->
hh
.
tbl
 = (
UT_hash_èbÀ
*)
	`uthash_mÆloc
( \

175 (
UT_hash_èbÀ
)); \

176 i‡(!((
hód
)->
hh
.
tbl
)Ë{ 
	`uthash_Áèl
( "out of memory"); } \

177 
	`mem£t
((
hód
)->
hh
.
tbl
, 0, (
UT_hash_èbÀ
)); \

178 (
hód
)->
hh
.
tbl
->
èû
 = &((head)->hh); \

179 (
hód
)->
hh
.
tbl
->
num_buckës
 = 
HASH_INITIAL_NUM_BUCKETS
; \

180 (
hód
)->
hh
.
tbl
->
log2_num_buckës
 = 
HASH_INITIAL_NUM_BUCKETS_LOG2
; \

181 (
hód
)->
hh
.
tbl
->
hho
 = (*)(&(head)->hh) - (*)(head); \

182 (
hód
)->
hh
.
tbl
->
buckës
 = (
UT_hash_buckë
*)
	`uthash_mÆloc
( \

183 
HASH_INITIAL_NUM_BUCKETS
*(
UT_hash_buckë
)); \

184 i‡(! (
hód
)->
hh
.
tbl
->
buckës
Ë{ 
	`uthash_Áèl
( "out of memory"); } \

185 
	`mem£t
((
hód
)->
hh
.
tbl
->
buckës
, 0, \

186 
HASH_INITIAL_NUM_BUCKETS
*(
UT_hash_buckë
)); \

187 
	`HASH_BLOOM_MAKE
((
hód
)->
hh
.
tbl
); \

188 (
hód
)->
hh
.
tbl
->
sig«tuª
 = 
HASH_SIGNATURE
; \

189 } 0)

	)

191 
	#HASH_REPLACE_BYHASHVALUE_INORDER
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
hashvÆ
,
add
,
ª∂a˚d
,
cmpf˙
) \

193 (
ª∂a˚d
Ë
NULL
; \

194 
	`HASH_FIND_BYHASHVALUE
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
, 
hashvÆ
, 
ª∂a˚d
); \

195 i‡(
ª∂a˚d
) { \

196 
	`HASH_DELETE
(
hh
, 
hód
, 
ª∂a˚d
); \

198 
	`HASH_ADD_KEYPTR_BYHASHVALUE_INORDER
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
, 
hashvÆ
,ádd, 
cmpf˙
); \

199 } 0)

	)

201 
	#HASH_REPLACE_BYHASHVALUE
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
hashvÆ
,
add
,
ª∂a˚d
) \

203 (
ª∂a˚d
Ë
NULL
; \

204 
	`HASH_FIND_BYHASHVALUE
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
, 
hashvÆ
, 
ª∂a˚d
); \

205 i‡(
ª∂a˚d
) { \

206 
	`HASH_DELETE
(
hh
, 
hód
, 
ª∂a˚d
); \

208 
	`HASH_ADD_KEYPTR_BYHASHVALUE
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
, 
hashvÆ
,ádd); \

209 } 0)

	)

211 
	#HASH_REPLACE
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
add
,
ª∂a˚d
) \

213 
_hr_hashv
; \

214 
	`HASH_VALUE
(&((
add
)->
fõld«me
), 
keyÀn_ö
, 
_hr_hashv
); \

215 
	`HASH_REPLACE_BYHASHVALUE
(
hh
, 
hód
, 
fõld«me
, 
keyÀn_ö
, 
_hr_hashv
, 
add
, 
ª∂a˚d
); \

216 } 0)

	)

218 
	#HASH_REPLACE_INORDER
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
add
,
ª∂a˚d
,
cmpf˙
) \

220 
_hr_hashv
; \

221 
	`HASH_VALUE
(&((
add
)->
fõld«me
), 
keyÀn_ö
, 
_hr_hashv
); \

222 
	`HASH_REPLACE_BYHASHVALUE_INORDER
(
hh
, 
hód
, 
fõld«me
, 
keyÀn_ö
, 
_hr_hashv
, 
add
, 
ª∂a˚d
, 
cmpf˙
); \

223 } 0)

	)

225 
	#HASH_APPEND_LIST
(
hh
, 
hód
, 
add
) \

227 (
add
)->
hh
.
√xt
 = 
NULL
; \

228 (
add
)->
hh
.
¥ev
 = 
	`ELMT_FROM_HH
((
hód
)->hh.
tbl
, (hód)->hh.tbl->
èû
); \

229 (
hód
)->
hh
.
tbl
->
èû
->
√xt
 = (
add
); \

230 (
hód
)->
hh
.
tbl
->
èû
 = &((
add
)->hh); \

231 } 0)

	)

233 
	#HASH_ADD_KEYPTR_BYHASHVALUE_INORDER
(
hh
,
hód
,
key±r
,
keyÀn_ö
,
hashvÆ
,
add
,
cmpf˙
) \

235 
_ha_bkt
; \

236 (
add
)->
hh
.
hashv
 = (
hashvÆ
); \

237 (
add
)->
hh
.
key
 = (*Ë(
key±r
); \

238 (
add
)->
hh
.
keyÀn
 = (Ë(
keyÀn_ö
); \

239 i‡(!(
hód
)) { \

240 (
add
)->
hh
.
√xt
 = 
NULL
; \

241 (
add
)->
hh
.
¥ev
 = 
NULL
; \

242 (
hód
Ë(
add
); \

243 
	`HASH_MAKE_TABLE
(
hh
, 
hód
); \

245 *
_hs_ôî
 = (
hód
); \

246 (
add
)->
hh
.
tbl
 = (
hód
)->hh.tbl; \

248 i‡(
	`cmpf˙
(
	`DECLTYPE
(
hód
)(
_hs_ôî
), 
add
) > 0) \

250 } (
_hs_ôî
 = 
	`HH_FROM_ELMT
((
hód
)->
hh
.
tbl
, _hs_ôî)->
√xt
)); \

251 i‡(
_hs_ôî
) { \

252 (
add
)->
hh
.
√xt
 = 
_hs_ôî
; \

253 i‡(((
add
)->
hh
.
¥ev
 = 
	`HH_FROM_ELMT
((
hód
)->hh.
tbl
, 
_hs_ôî
)->prev)) { \

254 
	`HH_FROM_ELMT
((
hód
)->
hh
.
tbl
, (
add
)->hh.
¥ev
)->
√xt
 = (add); \

256 (
hód
Ë(
add
); \

258 
	`HH_FROM_ELMT
((
hód
)->
hh
.
tbl
, 
_hs_ôî
)->
¥ev
 = (
add
); \

260 
	`HASH_APPEND_LIST
(
hh
, 
hód
, 
add
); \

263 (
hód
)->
hh
.
tbl
->
num_ôems
++; \

264 
	`HASH_TO_BKT
(
hashvÆ
, (
hód
)->
hh
.
tbl
->
num_buckës
, 
_ha_bkt
); \

265 
	`HASH_ADD_TO_BKT
((
hód
)->
hh
.
tbl
->
buckës
[
_ha_bkt
], &(
add
)->hh); \

266 
	`HASH_BLOOM_ADD
((
hód
)->
hh
.
tbl
, 
hashvÆ
); \

267 
	`HASH_EMIT_KEY
(
hh
, 
hód
, 
key±r
, 
keyÀn_ö
); \

268 
	`HASH_FSCK
(
hh
, 
hód
); \

269 } 0)

	)

271 
	#HASH_ADD_KEYPTR_INORDER
(
hh
,
hód
,
key±r
,
keyÀn_ö
,
add
,
cmpf˙
) \

273 
_hs_hashv
; \

274 
	`HASH_VALUE
(
key±r
, 
keyÀn_ö
, 
_hs_hashv
); \

275 
	`HASH_ADD_KEYPTR_BYHASHVALUE_INORDER
(
hh
, 
hód
, 
key±r
, 
keyÀn_ö
, 
_hs_hashv
, 
add
, 
cmpf˙
); \

276 } 0)

	)

278 
	#HASH_ADD_BYHASHVALUE_INORDER
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
hashvÆ
,
add
,
cmpf˙
) \

279 
	`HASH_ADD_KEYPTR_BYHASHVALUE_INORDER
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
, 
hashvÆ
,ádd, 
cmpf˙
)

	)

281 
	#HASH_ADD_INORDER
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
add
,
cmpf˙
) \

282 
	`HASH_ADD_KEYPTR_INORDER
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
,ádd, 
cmpf˙
)

	)

284 
	#HASH_ADD_KEYPTR_BYHASHVALUE
(
hh
,
hód
,
key±r
,
keyÀn_ö
,
hashvÆ
,
add
) \

286 
_ha_bkt
; \

287 (
add
)->
hh
.
hashv
 = (
hashvÆ
); \

288 (
add
)->
hh
.
key
 = (*Ë(
key±r
); \

289 (
add
)->
hh
.
keyÀn
 = (Ë(
keyÀn_ö
); \

290 i‡(!(
hód
)) { \

291 (
add
)->
hh
.
√xt
 = 
NULL
; \

292 (
add
)->
hh
.
¥ev
 = 
NULL
; \

293 (
hód
Ë(
add
); \

294 
	`HASH_MAKE_TABLE
(
hh
, 
hód
); \

296 (
add
)->
hh
.
tbl
 = (
hód
)->hh.tbl; \

297 
	`HASH_APPEND_LIST
(
hh
, 
hód
, 
add
); \

299 (
hód
)->
hh
.
tbl
->
num_ôems
++; \

300 
	`HASH_TO_BKT
(
hashvÆ
, (
hód
)->
hh
.
tbl
->
num_buckës
, 
_ha_bkt
); \

301 
	`HASH_ADD_TO_BKT
((
hód
)->
hh
.
tbl
->
buckës
[
_ha_bkt
], &(
add
)->hh); \

302 
	`HASH_BLOOM_ADD
((
hód
)->
hh
.
tbl
, 
hashvÆ
); \

303 
	`HASH_EMIT_KEY
(
hh
, 
hód
, 
key±r
, 
keyÀn_ö
); \

304 
	`HASH_FSCK
(
hh
, 
hód
); \

305 } 0)

	)

307 
	#HASH_ADD_KEYPTR
(
hh
,
hód
,
key±r
,
keyÀn_ö
,
add
) \

309 
_ha_hashv
; \

310 
	`HASH_VALUE
(
key±r
, 
keyÀn_ö
, 
_ha_hashv
); \

311 
	`HASH_ADD_KEYPTR_BYHASHVALUE
(
hh
, 
hód
, 
key±r
, 
keyÀn_ö
, 
_ha_hashv
, 
add
); \

312 } 0)

	)

314 
	#HASH_ADD_BYHASHVALUE
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
hashvÆ
,
add
) \

315 
	`HASH_ADD_KEYPTR_BYHASHVALUE
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
, 
hashvÆ
,ádd)

	)

317 
	#HASH_ADD
(
hh
,
hód
,
fõld«me
,
keyÀn_ö
,
add
) \

318 
	`HASH_ADD_KEYPTR
(
hh
, 
hód
, &((
add
)->
fõld«me
), 
keyÀn_ö
,ádd)

	)

320 
	#HASH_TO_BKT
(
hashv
,
num_bkts
,
bkt
) \

322 
bkt
 = ((
hashv
Ë& ((
num_bkts
) - 1U)); \

323 } 0)

	)

337 
	#HASH_DELETE
(
hh
,
hód
,
dñ±r
) \

339 
UT_hash_h™dÀ
 *
_hd_hh_dñ
; \

340 i‡–((
dñ±r
)->
hh
.
¥ev
 =
NULL
Ë&& ((dñ±r)->hh.
√xt
 == NULL) ) { \

341 
	`uthash_‰ì
((
hód
)->
hh
.
tbl
->
buckës
, \

342 (
hód
)->
hh
.
tbl
->
num_buckës
*(
UT_hash_buckë
) ); \

343 
	`HASH_BLOOM_FREE
((
hód
)->
hh
.
tbl
); \

344 
	`uthash_‰ì
((
hód
)->
hh
.
tbl
, (
UT_hash_èbÀ
)); \

345 
hód
 = 
NULL
; \

347 
_hd_bkt
; \

348 
_hd_hh_dñ
 = &((
dñ±r
)->
hh
); \

349 i‡((
dñ±r
Ë=
	`ELMT_FROM_HH
((
hód
)->
hh
.
tbl
,(hód)->hh.tbl->
èû
)) { \

350 (
hód
)->
hh
.
tbl
->
èû
 = \

351 (
UT_hash_h™dÀ
*)((
±rdiff_t
)((
dñ±r
)->
hh
.
¥ev
) + \

352 (
hód
)->
hh
.
tbl
->
hho
); \

354 i‡((
dñ±r
)->
hh
.
¥ev
 !
NULL
) { \

355 ((
UT_hash_h™dÀ
*)((
±rdiff_t
)((
dñ±r
)->
hh
.
¥ev
) + \

356 (
hód
)->
hh
.
tbl
->
hho
))->
√xt
 = (
dñ±r
)->hh.next; \

358 
	`DECLTYPE_ASSIGN
(
hód
,(
dñ±r
)->
hh
.
√xt
); \

360 i‡(
_hd_hh_dñ
->
√xt
 !
NULL
) { \

361 ((
UT_hash_h™dÀ
*)((
±rdiff_t
)
_hd_hh_dñ
->
√xt
 + \

362 (
hód
)->
hh
.
tbl
->
hho
))->
¥ev
 = \

363 
_hd_hh_dñ
->
¥ev
; \

365 
	`HASH_TO_BKT
–
_hd_hh_dñ
->
hashv
, (
hód
)->
hh
.
tbl
->
num_buckës
, 
_hd_bkt
); \

366 
	`HASH_DEL_IN_BKT
(
hh
,(
hód
)->hh.
tbl
->
buckës
[
_hd_bkt
], 
_hd_hh_dñ
); \

367 (
hód
)->
hh
.
tbl
->
num_ôems
--; \

369 
	`HASH_FSCK
(
hh
,
hód
); \

370 } 0)

	)

374 
	#HASH_FIND_STR
(
hód
,
föd°r
,
out
) \

375 
	`HASH_FIND
(
hh
,
hód
,
föd°r
,()
	`uthash_°æí
(föd°r),
out
)

	)

376 
	#HASH_ADD_STR
(
hód
,
°rfõld
,
add
) \

377 
	`HASH_ADD
(
hh
,
hód
,
°rfõld
[0],()
	`uthash_°æí
(
add
->°rfõld),add)

	)

378 
	#HASH_REPLACE_STR
(
hód
,
°rfõld
,
add
,
ª∂a˚d
) \

379 
	`HASH_REPLACE
(
hh
,
hód
,
°rfõld
[0],()
	`uthash_°æí
(
add
->°rfõld),add,
ª∂a˚d
)

	)

380 
	#HASH_FIND_INT
(
hód
,
födöt
,
out
) \

381 
	`HASH_FIND
(
hh
,
hód
,
födöt
,(),
out
)

	)

382 
	#HASH_ADD_INT
(
hód
,
ötfõld
,
add
) \

383 
	`HASH_ADD
(
hh
,
hód
,
ötfõld
,(),
add
)

	)

384 
	#HASH_REPLACE_INT
(
hód
,
ötfõld
,
add
,
ª∂a˚d
) \

385 
	`HASH_REPLACE
(
hh
,
hód
,
ötfõld
,(),
add
,
ª∂a˚d
)

	)

386 
	#HASH_FIND_PTR
(
hód
,
föd±r
,
out
) \

387 
	`HASH_FIND
(
hh
,
hód
,
föd±r
,(*),
out
)

	)

388 
	#HASH_ADD_PTR
(
hód
,
±rfõld
,
add
) \

389 
	`HASH_ADD
(
hh
,
hód
,
±rfõld
,(*),
add
)

	)

390 
	#HASH_REPLACE_PTR
(
hód
,
±rfõld
,
add
,
ª∂a˚d
) \

391 
	`HASH_REPLACE
(
hh
,
hód
,
±rfõld
,(*),
add
,
ª∂a˚d
)

	)

392 
	#HASH_DEL
(
hód
,
dñ±r
) \

393 
	`HASH_DELETE
(
hh
,
hód
,
dñ±r
)

	)

398 #ifde‡
HASH_DEBUG


399 
	#HASH_OOPS
(...Ëdÿ{ 
	`Ârötf
(
°dîr
,
__VA_ARGS__
); 
	`exô
(-1); } 0)

	)

400 
	#HASH_FSCK
(
hh
,
hód
) \

402 
UT_hash_h™dÀ
 *
_thh
; \

403 i‡(
hód
) { \

404 
_bkt_i
; \

405 
_cou¡
; \

406 *
_¥ev
; \

407 
_cou¡
 = 0; \

408  
_bkt_i
 = 0; _bkt_ò< (
hód
)->
hh
.
tbl
->
num_buckës
; _bkt_i++) { \

409 
_bkt_cou¡
 = 0; \

410 
_thh
 = (
hód
)->
hh
.
tbl
->
buckës
[
_bkt_i
].
hh_hód
; \

411 
_¥ev
 = 
NULL
; \

412 
_thh
) { \

413 i‡(
_¥ev
 !(*)(
_thh
->
hh_¥ev
)) { \

414 
	`HASH_OOPS
("invalid hh_prev %p,áctual %p\n", \

415 
_thh
->
hh_¥ev
, 
_¥ev
 ); \

417 
_bkt_cou¡
++; \

418 
_¥ev
 = (*)(
_thh
); \

419 
_thh
 = _thh->
hh_√xt
; \

421 
_cou¡
 +
_bkt_cou¡
; \

422 i‡((
hód
)->
hh
.
tbl
->
buckës
[
_bkt_i
].
cou¡
 !
_bkt_cou¡
) { \

423 
	`HASH_OOPS
("invalid bucket count %u,áctual %u\n", \

424 (
hód
)->
hh
.
tbl
->
buckës
[
_bkt_i
].
cou¡
, 
_bkt_cou¡
); \

427 i‡(
_cou¡
 !(
hód
)->
hh
.
tbl
->
num_ôems
) { \

428 
	`HASH_OOPS
("invalid hh item count %u,áctual %u\n", \

429 (
hód
)->
hh
.
tbl
->
num_ôems
, 
_cou¡
 ); \

432 
_cou¡
 = 0; \

433 
_¥ev
 = 
NULL
; \

434 
_thh
 = &(
hód
)->
hh
; \

435 
_thh
) { \

436 
_cou¡
++; \

437 i‡(
_¥ev
 !=(*)(
_thh
->
¥ev
)) { \

438 
	`HASH_OOPS
("invalidÖrev %p,áctual %p\n", \

439 
_thh
->
¥ev
, 
_¥ev
 ); \

441 
_¥ev
 = (*)
	`ELMT_FROM_HH
((
hód
)->
hh
.
tbl
, 
_thh
); \

442 
_thh
 = ( _thh->
√xt
 ? (
UT_hash_h™dÀ
*)((*)(_thh->next) + \

443 (
hód
)->
hh
.
tbl
->
hho
Ë: 
NULL
 ); \

445 i‡(
_cou¡
 !(
hód
)->
hh
.
tbl
->
num_ôems
) { \

446 
	`HASH_OOPS
("invalidápp item count %u,áctual %u\n", \

447 (
hód
)->
hh
.
tbl
->
num_ôems
, 
_cou¡
 ); \

450 } 0)

	)

452 
	#HASH_FSCK
(
hh
,
hód
)

	)

458 #ifde‡
HASH_EMIT_KEYS


459 
	#HASH_EMIT_KEY
(
hh
,
hód
,
key±r
,
fõldÀn
) \

461 
_kÀn
 = 
fõldÀn
; \

462 
	`wrôe
(
HASH_EMIT_KEYS
, &
_kÀn
, (_klen)); \

463 
	`wrôe
(
HASH_EMIT_KEYS
, 
key±r
, ()
fõldÀn
); \

464 } 0)

	)

466 
	#HASH_EMIT_KEY
(
hh
,
hód
,
key±r
,
fõldÀn
)

	)

470 #ifde‡
HASH_FUNCTION


471 
	#HASH_FCN
 
HASH_FUNCTION


	)

473 
	#HASH_FCN
 
HASH_JEN


	)

477 
	#HASH_BER
(
key
,
keyÀn
,
hashv
) \

479 
_hb_keyÀn
=()
keyÀn
; \

480 c⁄° *
_hb_key
=(c⁄° *)(
key
); \

481 (
hashv
) = 0; \

482 
_hb_keyÀn
-- != 0U) { \

483 (
hashv
Ë(((hashvË<< 5Ë+ (hashv)Ë+ *
_hb_key
++; \

485 } 0)

	)

490 
	#HASH_SAX
(
key
,
keyÀn
,
hashv
) \

492 
_sx_i
; \

493 c⁄° *
_hs_key
=(c⁄° *)(
key
); \

494 
hashv
 = 0; \

495 
_sx_i
=0; _sx_ò< 
keyÀn
; _sx_i++) { \

496 
hashv
 ^(hashv << 5Ë+ (hashv >> 2Ë+ 
_hs_key
[
_sx_i
]; \

498 } 0)

	)

500 
	#HASH_FNV
(
key
,
keyÀn
,
hashv
) \

502 
_‚_i
; \

503 c⁄° *
_hf_key
=(c⁄° *)(
key
); \

504 
hashv
 = 2166136261U; \

505 
_‚_i
=0; _‚_ò< 
keyÀn
; _fn_i++) { \

506 
hashv
 = hashv ^ 
_hf_key
[
_‚_i
]; \

507 
hashv
 = hashv * 16777619U; \

509 } 0)

	)

511 
	#HASH_OAT
(
key
,
keyÀn
,
hashv
) \

513 
_ho_i
; \

514 c⁄° *
_ho_key
=(c⁄° *)(
key
); \

515 
hashv
 = 0; \

516 
_ho_i
=0; _ho_ò< 
keyÀn
; _ho_i++) { \

517 
hashv
 +
_ho_key
[
_ho_i
]; \

518 
hashv
 += (hashv << 10); \

519 
hashv
 ^= (hashv >> 6); \

521 
hashv
 += (hashv << 3); \

522 
hashv
 ^= (hashv >> 11); \

523 
hashv
 += (hashv << 15); \

524 } 0)

	)

526 
	#HASH_JEN_MIX
(
a
,
b
,
c
) \

528 
a
 -
b
;á -
c
;á ^= ( c >> 13 ); \

529 
b
 -
c
; b -
a
; b ^= (á << 8 ); \

530 
c
 -
a
; c -
b
; c ^= ( b >> 13 ); \

531 
a
 -
b
;á -
c
;á ^= ( c >> 12 ); \

532 
b
 -
c
; b -
a
; b ^= (á << 16 ); \

533 
c
 -
a
; c -
b
; c ^= ( b >> 5 ); \

534 
a
 -
b
;á -
c
;á ^= ( c >> 3 ); \

535 
b
 -
c
; b -
a
; b ^= (á << 10 ); \

536 
c
 -
a
; c -
b
; c ^= ( b >> 15 ); \

537 } 0)

	)

539 
	#HASH_JEN
(
key
,
keyÀn
,
hashv
) \

541 
_hj_i
,
_hj_j
,
_hj_k
; \

542 c⁄° *
_hj_key
=(c⁄° *)(
key
); \

543 
hashv
 = 0xfeedbeefu; \

544 
_hj_i
 = 
_hj_j
 = 0x9e3779b9u; \

545 
_hj_k
 = ()(
keyÀn
); \

546 
_hj_k
 >= 12U) { \

547 
_hj_i
 +(
_hj_key
[0] + ( ()_hj_key[1] << 8 ) \

548 + ( ()
_hj_key
[2] << 16 ) \

549 + ( ()
_hj_key
[3] << 24 ) ); \

550 
_hj_j
 +(
_hj_key
[4] + ( ()_hj_key[5] << 8 ) \

551 + ( ()
_hj_key
[6] << 16 ) \

552 + ( ()
_hj_key
[7] << 24 ) ); \

553 
hashv
 +(
_hj_key
[8] + ( ()_hj_key[9] << 8 ) \

554 + ( ()
_hj_key
[10] << 16 ) \

555 + ( ()
_hj_key
[11] << 24 ) ); \

557 
	`HASH_JEN_MIX
(
_hj_i
, 
_hj_j
, 
hashv
); \

559 
_hj_key
 += 12; \

560 
_hj_k
 -= 12U; \

562 
hashv
 +()(
keyÀn
); \

563  
_hj_k
 ) { \

564 11: 
hashv
 +–()
_hj_key
[10] << 24 ); \

565 10: 
hashv
 +–()
_hj_key
[9] << 16 ); \

566 9: 
hashv
 +–()
_hj_key
[8] << 8 ); \

567 8: 
_hj_j
 +–()
_hj_key
[7] << 24 ); \

568 7: 
_hj_j
 +–()
_hj_key
[6] << 16 ); \

569 6: 
_hj_j
 +–()
_hj_key
[5] << 8 ); \

570 5: 
_hj_j
 +
_hj_key
[4]; \

571 4: 
_hj_i
 +–()
_hj_key
[3] << 24 ); \

572 3: 
_hj_i
 +–()
_hj_key
[2] << 16 ); \

573 2: 
_hj_i
 +–()
_hj_key
[1] << 8 ); \

574 1: 
_hj_i
 +
_hj_key
[0]; \

576 
	`HASH_JEN_MIX
(
_hj_i
, 
_hj_j
, 
hashv
); \

577 } 0)

	)

580 #unde‡
gë16bôs


581 #i‡(
deföed
(
__GNUC__
Ë&& deföed(
__i386__
)Ë|| deföed(
__WATCOMC__
) \

582 || 
deföed
(
_MSC_VER
Ë|| deföed (
__BORLANDC__
Ë|| 
	$deföed
 (
__TURBOC__
)

583 
	#gë16bôs
(
d
Ë(*((c⁄° 
uöt16_t
 *Ë(d)))

	)

586 #i‡!
	`deföed
 (
gë16bôs
)

587 
	#gë16bôs
(
d
Ë((((
uöt32_t
)(((c⁄° 
uöt8_t
 *)(d))[1])) << 8) \

588 +(
uöt32_t
)(((c⁄° 
uöt8_t
 *)(
d
))[0]Ë)

	)

590 
	#HASH_SFH
(
key
,
keyÀn
,
hashv
) \

592 c⁄° *
_sfh_key
=(c⁄° *)(
key
); \

593 
uöt32_t
 
_sfh_tmp
, 
_sfh_Àn
 = (uöt32_t)
keyÀn
; \

595 
_sfh_ªm
 = 
_sfh_Àn
 & 3U; \

596 
_sfh_Àn
 >>= 2; \

597 
hashv
 = 0xcafebabeu; \

600 ;
_sfh_Àn
 > 0U; _sfh_len--) { \

601 
hashv
 +
	`gë16bôs
 (
_sfh_key
); \

602 
_sfh_tmp
 = ((
uöt32_t
)(
	`gë16bôs
 (
_sfh_key
+2)Ë<< 11Ë^ 
hashv
; \

603 
hashv
 = (hashv << 16Ë^ 
_sfh_tmp
; \

604 
_sfh_key
 +2U* (
uöt16_t
); \

605 
hashv
 += hashv >> 11; \

609 
_sfh_ªm
) { \

610 3: 
hashv
 +
	`gë16bôs
 (
_sfh_key
); \

611 
hashv
 ^= hashv << 16; \

612 
hashv
 ^(
uöt32_t
)(
_sfh_key
[ (
uöt16_t
)]) << 18; \

613 
hashv
 += hashv >> 11; \

615 2: 
hashv
 +
	`gë16bôs
 (
_sfh_key
); \

616 
hashv
 ^= hashv << 11; \

617 
hashv
 += hashv >> 17; \

619 1: 
hashv
 +*
_sfh_key
; \

620 
hashv
 ^= hashv << 10; \

621 
hashv
 += hashv >> 1; \

625 
hashv
 ^= hashv << 3; \

626 
hashv
 += hashv >> 5; \

627 
hashv
 ^= hashv << 4; \

628 
hashv
 += hashv >> 17; \

629 
hashv
 ^= hashv << 25; \

630 
hashv
 += hashv >> 6; \

631 
	}
} 0)

	)

633 #ifde‡
HASH_USING_NO_STRICT_ALIASING


643 #i‡(
deföed
(
__i386__
Ë|| deföed(
__x86_64__
Ë|| deföed(
_M_IX86
))

644 
	#MUR_GETBLOCK
(
p
,
i
Ëp[i]

	)

646 
	#MUR_PLUS0_ALIGNED
(
p
Ë(((Ì & 3ULË=0UL)

	)

647 
	#MUR_PLUS1_ALIGNED
(
p
Ë(((Ì & 3ULË=1UL)

	)

648 
	#MUR_PLUS2_ALIGNED
(
p
Ë(((Ì & 3ULË=2UL)

	)

649 
	#MUR_PLUS3_ALIGNED
(
p
Ë(((Ì & 3ULË=3UL)

	)

650 
	#WP
(
p
Ë((
uöt32_t
*)(()’Ë& ~3UL))

	)

651 #i‡(
deföed
(
__BIG_ENDIAN__
Ë|| deföed(
SPARC
Ë|| deföed(
__µc__
Ë|| deföed(
__µc64__
))

652 
	#MUR_THREE_ONE
(
p
Ë((((*
	`WP
’))&0x00ffffffË<< 8Ë| (((*(WP’)+1))&0xff000000Ë>> 24))

	)

653 
	#MUR_TWO_TWO
(
p
Ë((((*
	`WP
’))&0x0000ffffË<<16Ë| (((*(WP’)+1))&0xffff0000Ë>> 16))

	)

654 
	#MUR_ONE_THREE
(
p
Ë((((*
	`WP
’))&0x000000ffË<<24Ë| (((*(WP’)+1))&0xffffff00Ë>> 8))

	)

656 
	#MUR_THREE_ONE
(
p
Ë((((*
	`WP
’))&0xffffff00Ë>> 8Ë| (((*(WP’)+1))&0x000000ffË<< 24))

	)

657 
	#MUR_TWO_TWO
(
p
Ë((((*
	`WP
’))&0xffff0000Ë>>16Ë| (((*(WP’)+1))&0x0000ffffË<< 16))

	)

658 
	#MUR_ONE_THREE
(
p
Ë((((*
	`WP
’))&0xff000000Ë>>24Ë| (((*(WP’)+1))&0x00ffffffË<< 8))

	)

660 
	#MUR_GETBLOCK
(
p
,
i
Ë(
	`MUR_PLUS0_ALIGNED
(p) ? ((p)[i]) : \

661 (
	`MUR_PLUS1_ALIGNED
(
p
Ë? 
	`MUR_THREE_ONE
(p) : \

662 (
	`MUR_PLUS2_ALIGNED
(
p
Ë? 
	`MUR_TWO_TWO
(p) : \

663 
	`MUR_ONE_THREE
(
p
))))

	)

665 
	#MUR_ROTL32
(
x
,
r
Ë(((xË<< (r)Ë| ((xË>> (32 - (r))))

	)

666 
	#MUR_FMIX
(
_h
) \

668 
_h
 ^= _h >> 16; \

669 
_h
 *= 0x85ebca6bu; \

670 
_h
 ^= _h >> 13; \

671 
_h
 *= 0xc2b2ae35u; \

672 
_h
 ^= _h >> 16; \

673 } 0)

	)

675 
	#HASH_MUR
(
key
,
keyÀn
,
hashv
) \

677 c⁄° 
uöt8_t
 *
_mur_d©a
 = (c⁄° uöt8_t*)(
key
); \

678 c⁄° 
_mur_nblocks
 = ()(
keyÀn
) / 4; \

679 
uöt32_t
 
_mur_h1
 = 0xf88D5353u; \

680 
uöt32_t
 
_mur_c1
 = 0xcc9e2d51u; \

681 
uöt32_t
 
_mur_c2
 = 0x1b873593u; \

682 
uöt32_t
 
_mur_k1
 = 0; \

683 c⁄° 
uöt8_t
 *
_mur_èû
; \

684 c⁄° 
uöt32_t
 *
_mur_blocks
 = (c⁄° uöt32_t*)(
_mur_d©a
+(
_mur_nblocks
*4)); \

685 
_mur_i
; \

686 
_mur_i
 = -
_mur_nblocks
; _mur_i!=0; _mur_i++) { \

687 
_mur_k1
 = 
	`MUR_GETBLOCK
(
_mur_blocks
,
_mur_i
); \

688 
_mur_k1
 *
_mur_c1
; \

689 
_mur_k1
 = 
	`MUR_ROTL32
(_mur_k1,15); \

690 
_mur_k1
 *
_mur_c2
; \

692 
_mur_h1
 ^
_mur_k1
; \

693 
_mur_h1
 = 
	`MUR_ROTL32
(_mur_h1,13); \

694 
_mur_h1
 = (_mur_h1*5U) + 0xe6546b64u; \

696 
_mur_èû
 = (c⁄° 
uöt8_t
*)(
_mur_d©a
 + (
_mur_nblocks
*4)); \

697 
_mur_k1
=0; \

698 (
keyÀn
) & 3U) { \

699 3: 
_mur_k1
 ^(
uöt32_t
)
_mur_èû
[2] << 16; \

700 2: 
_mur_k1
 ^(
uöt32_t
)
_mur_èû
[1] << 8; \

701 1: 
_mur_k1
 ^(
uöt32_t
)
_mur_èû
[0]; \

702 
_mur_k1
 *
_mur_c1
; \

703 
_mur_k1
 = 
	`MUR_ROTL32
(_mur_k1,15); \

704 
_mur_k1
 *
_mur_c2
; \

705 
_mur_h1
 ^
_mur_k1
; \

707 
_mur_h1
 ^(
uöt32_t
)(
keyÀn
); \

708 
	`MUR_FMIX
(
_mur_h1
); \

709 
hashv
 = 
_mur_h1
; \

710 } 0)

	)

714 
	#HASH_FIND_IN_BKT
(
tbl
,
hh
,
hód
,
key±r
,
keyÀn_ö
,
hashvÆ
,
out
) \

716 i‡((
hód
).
hh_hód
 !
NULL
) { \

717 
	`DECLTYPE_ASSIGN
(
out
, 
	`ELMT_FROM_HH
(
tbl
, (
hód
).
hh_hód
)); \

719 (
out
Ë
NULL
; \

721 (
out
Ë!
NULL
) { \

722 i‡((
out
)->
hh
.
hashv
 =(
hashvÆ
Ë&& (out)->hh.
keyÀn
 =(
keyÀn_ö
)) { \

723 i‡(
	`uthash_memcmp
((
out
)->
hh
.
key
, 
key±r
, 
keyÀn_ö
) == 0) { \

727 i‡((
out
)->
hh
.
hh_√xt
 !
NULL
) { \

728 
	`DECLTYPE_ASSIGN
(
out
, 
	`ELMT_FROM_HH
(
tbl
, (out)->
hh
.
hh_√xt
)); \

730 (
out
Ë
NULL
; \

733 } 0)

	)

736 
	#HASH_ADD_TO_BKT
(
hód
,
addhh
) \

738 
hód
.
cou¡
++; \

739 (
addhh
)->
hh_√xt
 = 
hód
.
hh_hód
; \

740 (
addhh
)->
hh_¥ev
 = 
NULL
; \

741 i‡(
hód
.
hh_hód
 !
NULL
Ë{ (hód).hh_hód->
hh_¥ev
 = (
addhh
); } \

742 (
hód
).
hh_hód
=
addhh
; \

743 i‡((
hód
.
cou¡
 >((hód.
ex∑nd_mu…
+1UË* 
HASH_BKT_CAPACITY_THRESH
)) \

744 && ((
addhh
)->
tbl
->
n€x∑nd
 != 1U)) { \

745 
	`HASH_EXPAND_BUCKETS
((
addhh
)->
tbl
); \

747 } 0)

	)

750 
	#HASH_DEL_IN_BKT
(
hh
,
hód
,
hh_dñ
) \

751 (
hód
).
cou¡
--; \

752 i‡((
hód
).
hh_hód
 =
hh_dñ
) { \

753 (
hód
).
hh_hód
 = 
hh_dñ
->
hh_√xt
; \

755 i‡(
hh_dñ
->
hh_¥ev
) { \

756 
hh_dñ
->
hh_¥ev
->
hh_√xt
 = hh_del->hh_next; \

758 i‡(
hh_dñ
->
hh_√xt
) { \

759 
hh_dñ
->
hh_√xt
->
hh_¥ev
 = hh_del->hh_prev; \

760 }

	)

791 
	#HASH_EXPAND_BUCKETS
(
tbl
) \

793 
_he_bkt
; \

794 
_he_bkt_i
; \

795 
UT_hash_h™dÀ
 *
_he_thh
, *
_he_hh_nxt
; \

796 
UT_hash_buckë
 *
_he_√w_buckës
, *
_he_√wbkt
; \

797 
_he_√w_buckës
 = (
UT_hash_buckë
*)
	`uthash_mÆloc
( \

798 2UL * 
tbl
->
num_buckës
 * (
UT_hash_buckë
)); \

799 i‡(!
_he_√w_buckës
Ë{ 
	`uthash_Áèl
( "out of memory"); } \

800 
	`mem£t
(
_he_√w_buckës
, 0, \

801 2UL * 
tbl
->
num_buckës
 * (
UT_hash_buckë
)); \

802 
tbl
->
idól_chaö_maxÀn
 = \

803 (
tbl
->
num_ôems
 >> (tbl->
log2_num_buckës
+1U)) + \

804 (((
tbl
->
num_ôems
 & (—bl->
num_buckës
*2U)-1U)) != 0U) ? 1U : 0U); \

805 
tbl
->
n⁄idól_ôems
 = 0; \

806 
_he_bkt_i
 = 0; _he_bkt_ò< 
tbl
->
num_buckës
; _he_bkt_i++) \

808 
_he_thh
 = 
tbl
->
buckës
[ 
_he_bkt_i
 ].
hh_hód
; \

809 
_he_thh
 !
NULL
) { \

810 
_he_hh_nxt
 = 
_he_thh
->
hh_√xt
; \

811 
	`HASH_TO_BKT
–
_he_thh
->
hashv
, 
tbl
->
num_buckës
*2U, 
_he_bkt
); \

812 
_he_√wbkt
 = &(
_he_√w_buckës
[ 
_he_bkt
 ]); \

813 i‡(++(
_he_√wbkt
->
cou¡
Ë> 
tbl
->
idól_chaö_maxÀn
) { \

814 
tbl
->
n⁄idól_ôems
++; \

815 
_he_√wbkt
->
ex∑nd_mu…
 = _he_√wbkt->
cou¡
 / \

816 
tbl
->
idól_chaö_maxÀn
; \

818 
_he_thh
->
hh_¥ev
 = 
NULL
; \

819 
_he_thh
->
hh_√xt
 = 
_he_√wbkt
->
hh_hód
; \

820 i‡(
_he_√wbkt
->
hh_hód
 !
NULL
Ë{ _he_√wbkt->hh_hód->
hh_¥ev
 = \

821 
_he_thh
; } \

822 
_he_√wbkt
->
hh_hód
 = 
_he_thh
; \

823 
_he_thh
 = 
_he_hh_nxt
; \

826 
	`uthash_‰ì
–
tbl
->
buckës
,Åbl->
num_buckës
*(
UT_hash_buckë
) ); \

827 
tbl
->
num_buckës
 *= 2U; \

828 
tbl
->
log2_num_buckës
++; \

829 
tbl
->
buckës
 = 
_he_√w_buckës
; \

830 
tbl
->
öeff_ex∑nds
 = (tbl->
n⁄idól_ôems
 > (tbl->
num_ôems
 >> 1)) ? \

831 (
tbl
->
öeff_ex∑nds
+1U) : 0U; \

832 i‡(
tbl
->
öeff_ex∑nds
 > 1U) { \

833 
tbl
->
n€x∑nd
=1; \

834 
	`uthash_n€x∑nd_fyi
(
tbl
); \

836 
	`uthash_ex∑nd_fyi
(
tbl
); \

837 } 0)

	)

843 
	#HASH_SORT
(
hód
,
cmpf˙
Ë
	`HASH_SRT
(
hh
,hód,cmpf˙)

	)

844 
	#HASH_SRT
(
hh
,
hód
,
cmpf˙
) \

846 
_hs_i
; \

847 
_hs_lo›ög
,
_hs_nmîges
,
_hs_ösize
,
_hs_psize
,
_hs_qsize
; \

848 
UT_hash_h™dÀ
 *
_hs_p
, *
_hs_q
, *
_hs_e
, *
_hs_li°
, *
_hs_èû
; \

849 i‡(
hód
 !
NULL
) { \

850 
_hs_ösize
 = 1; \

851 
_hs_lo›ög
 = 1; \

852 
_hs_li°
 = &((
hód
)->
hh
); \

853 
_hs_lo›ög
 != 0U) { \

854 
_hs_p
 = 
_hs_li°
; \

855 
_hs_li°
 = 
NULL
; \

856 
_hs_èû
 = 
NULL
; \

857 
_hs_nmîges
 = 0; \

858 
_hs_p
 !
NULL
) { \

859 
_hs_nmîges
++; \

860 
_hs_q
 = 
_hs_p
; \

861 
_hs_psize
 = 0; \

862  
_hs_i
 = 0; _hs_ò< 
_hs_ösize
; _hs_i++ ) { \

863 
_hs_psize
++; \

864 
_hs_q
 = (
UT_hash_h™dÀ
*)((_hs_q->
√xt
 !
NULL
) ? \

865 ((*)((*)(
_hs_q
->
√xt
) + \

866 (
hód
)->
hh
.
tbl
->
hho
)Ë: 
NULL
); \

867 i‡(! (
_hs_q
) ) { ; } \

869 
_hs_qsize
 = 
_hs_ösize
; \

870 (
_hs_psize
 > 0UË|| ((
_hs_qsize
 > 0UË&& (
_hs_q
 !
NULL
))) {\

871 i‡(
_hs_psize
 == 0U) { \

872 
_hs_e
 = 
_hs_q
; \

873 
_hs_q
 = (
UT_hash_h™dÀ
*)((_hs_q->
√xt
 !
NULL
) ? \

874 ((*)((*)(
_hs_q
->
√xt
) + \

875 (
hód
)->
hh
.
tbl
->
hho
)Ë: 
NULL
); \

876 
_hs_qsize
--; \

877 } i‡–(
_hs_qsize
 =0UË|| (
_hs_q
 =
NULL
) ) { \

878 
_hs_e
 = 
_hs_p
; \

879 i‡(
_hs_p
 !
NULL
){ \

880 
_hs_p
 = (
UT_hash_h™dÀ
*)((_hs_p->
√xt
 !
NULL
) ? \

881 ((*)((*)(
_hs_p
->
√xt
) + \

882 (
hód
)->
hh
.
tbl
->
hho
)Ë: 
NULL
); \

884 
_hs_psize
--; \

886 
	`cmpf˙
(
	`DECLTYPE
(
hód
)(
	`ELMT_FROM_HH
((hód)->
hh
.
tbl
,
_hs_p
)), \

887 
	`DECLTYPE
(
hód
)(
	`ELMT_FROM_HH
((hód)->
hh
.
tbl
,
_hs_q
))) \

889 
_hs_e
 = 
_hs_p
; \

890 i‡(
_hs_p
 !
NULL
){ \

891 
_hs_p
 = (
UT_hash_h™dÀ
*)((_hs_p->
√xt
 !
NULL
) ? \

892 ((*)((*)(
_hs_p
->
√xt
) + \

893 (
hód
)->
hh
.
tbl
->
hho
)Ë: 
NULL
); \

895 
_hs_psize
--; \

897 
_hs_e
 = 
_hs_q
; \

898 
_hs_q
 = (
UT_hash_h™dÀ
*)((_hs_q->
√xt
 !
NULL
) ? \

899 ((*)((*)(
_hs_q
->
√xt
) + \

900 (
hód
)->
hh
.
tbl
->
hho
)Ë: 
NULL
); \

901 
_hs_qsize
--; \

903 i‡–
_hs_èû
 !
NULL
 ) { \

904 
_hs_èû
->
√xt
 = ((
_hs_e
 !
NULL
) ? \

905 
	`ELMT_FROM_HH
((
hód
)->
hh
.
tbl
,
_hs_e
Ë: 
NULL
); \

907 
_hs_li°
 = 
_hs_e
; \

909 i‡(
_hs_e
 !
NULL
) { \

910 
_hs_e
->
¥ev
 = ((
_hs_èû
 !
NULL
) ? \

911 
	`ELMT_FROM_HH
((
hód
)->
hh
.
tbl
,
_hs_èû
Ë: 
NULL
); \

913 
_hs_èû
 = 
_hs_e
; \

915 
_hs_p
 = 
_hs_q
; \

917 i‡(
_hs_èû
 !
NULL
){ \

918 
_hs_èû
->
√xt
 = 
NULL
; \

920 i‡–
_hs_nmîges
 <= 1U ) { \

921 
_hs_lo›ög
=0; \

922 (
hód
)->
hh
.
tbl
->
èû
 = 
_hs_èû
; \

923 
	`DECLTYPE_ASSIGN
(
hód
,
	`ELMT_FROM_HH
((hód)->
hh
.
tbl
, 
_hs_li°
)); \

925 
_hs_ösize
 *= 2U; \

927 
	`HASH_FSCK
(
hh
,
hód
); \

929 } 0)

	)

936 
	#HASH_SELECT
(
hh_d°
, 
d°
, 
hh_§c
, 
§c
, 
c⁄d
) \

938 
_§c_bkt
, 
_d°_bkt
; \

939 *
_œ°_ñt
=
NULL
, *
_ñt
; \

940 
UT_hash_h™dÀ
 *
_§c_hh
, *
_d°_hh
, *
_œ°_ñt_hh
=
NULL
; \

941 
±rdiff_t
 
_d°_hho
 = ((*)(&(
d°
)->
hh_d°
) - (*)(dst)); \

942 i‡(
§c
 !
NULL
) { \

943 
_§c_bkt
=0; _§c_bkà< (
§c
)->
hh_§c
.
tbl
->
num_buckës
; _src_bkt++) { \

944 
_§c_hh
 = (
§c
)->
hh_§c
.
tbl
->
buckës
[
_§c_bkt
].
hh_hód
; \

945 
_§c_hh
 !
NULL
; \

946 
_§c_hh
 = _§c_hh->
hh_√xt
) { \

947 
_ñt
 = 
	`ELMT_FROM_HH
((
§c
)->
hh_§c
.
tbl
, 
_§c_hh
); \

948 i‡(
	`c⁄d
(
_ñt
)) { \

949 
_d°_hh
 = (
UT_hash_h™dÀ
*)(((*)
_ñt
Ë+ 
_d°_hho
); \

950 
_d°_hh
->
key
 = 
_§c_hh
->key; \

951 
_d°_hh
->
keyÀn
 = 
_§c_hh
->keylen; \

952 
_d°_hh
->
hashv
 = 
_§c_hh
->hashv; \

953 
_d°_hh
->
¥ev
 = 
_œ°_ñt
; \

954 
_d°_hh
->
√xt
 = 
NULL
; \

955 i‡(
_œ°_ñt_hh
 !
NULL
Ë{ _œ°_ñt_hh->
√xt
 = 
_ñt
; } \

956 i‡(
d°
 =
NULL
) { \

957 
	`DECLTYPE_ASSIGN
(
d°
,
_ñt
); \

958 
	`HASH_MAKE_TABLE
(
hh_d°
,
d°
); \

960 
_d°_hh
->
tbl
 = (
d°
)->
hh_d°
.tbl; \

962 
	`HASH_TO_BKT
(
_d°_hh
->
hashv
, _d°_hh->
tbl
->
num_buckës
, 
_d°_bkt
); \

963 
	`HASH_ADD_TO_BKT
(
_d°_hh
->
tbl
->
buckës
[
_d°_bkt
],_dst_hh); \

964 (
d°
)->
hh_d°
.
tbl
->
num_ôems
++; \

965 
_œ°_ñt
 = 
_ñt
; \

966 
_œ°_ñt_hh
 = 
_d°_hh
; \

971 
	`HASH_FSCK
(
hh_d°
,
d°
); \

972 } 0)

	)

974 
	#HASH_CLEAR
(
hh
,
hód
) \

976 i‡(
hód
 !
NULL
) { \

977 
	`uthash_‰ì
((
hód
)->
hh
.
tbl
->
buckës
, \

978 (
hód
)->
hh
.
tbl
->
num_buckës
*(
UT_hash_buckë
)); \

979 
	`HASH_BLOOM_FREE
((
hód
)->
hh
.
tbl
); \

980 
	`uthash_‰ì
((
hód
)->
hh
.
tbl
, (
UT_hash_èbÀ
)); \

981 (
hód
)=
NULL
; \

983 } 0)

	)

985 
	#HASH_OVERHEAD
(
hh
,
hód
) \

986 ((
hód
 !
NULL
) ? ( \

987 (
size_t
)(((
hód
)->
hh
.
tbl
->
num_ôems
 * (
UT_hash_h™dÀ
)) + \

988 ((
hód
)->
hh
.
tbl
->
num_buckës
 * (
UT_hash_buckë
)) + \

989 (
UT_hash_èbÀ
) + \

990 (
HASH_BLOOM_BYTELEN
))Ë: 0U)

	)

992 #ifde‡
NO_DECLTYPE


993 
	#HASH_ITER
(
hh
,
hód
,
ñ
,
tmp
) \

994 ((
ñ
)=(
hód
)), ((*(**)(&(
tmp
)))=(*)((hód!=
NULL
)?(hód)->
hh
.
√xt
:NULL)); \

995 (
ñ
Ë!
NULL
; (”l)=(
tmp
)), ((*(**)(&—mp)))=(*)(—mp!=NULL)?—mp)->
hh
.
√xt
:NULL)))

	)

997 
	#HASH_ITER
(
hh
,
hód
,
ñ
,
tmp
) \

998 ((
ñ
)=(
hód
)), ((
tmp
)=
	`DECLTYPE
”l)((hód!=
NULL
)?(hód)->
hh
.
√xt
:NULL)); \

999 (
ñ
Ë!
NULL
; (”l)=(
tmp
)), (—mp)=
	`DECLTYPE
”l)(—mp!=NULL)?—mp)->
hh
.
√xt
:NULL)))

	)

1003 
	#HASH_COUNT
(
hód
Ë
	`HASH_CNT
(
hh
,hód)

	)

1004 
	#HASH_CNT
(
hh
,
hód
Ë((hód !
NULL
)?((hód)->hh.
tbl
->
num_ôems
):0U)

	)

1006 
	sUT_hash_buckë
 {

1007 
UT_hash_h™dÀ
 *
	mhh_hód
;

1008 
	mcou¡
;

1022 
	mex∑nd_mu…
;

1024 } 
	tUT_hash_buckë
;

1027 
	#HASH_SIGNATURE
 0xa0111„1u

	)

1028 
	#HASH_BLOOM_SIGNATURE
 0xb12220f2u

	)

1030 
	sUT_hash_èbÀ
 {

1031 
UT_hash_buckë
 *
	mbuckës
;

1032 
	mnum_buckës
, 
	mlog2_num_buckës
;

1033 
	mnum_ôems
;

1034 
UT_hash_h™dÀ
 *
	mèû
;

1035 
±rdiff_t
 
	mhho
;

1039 
	midól_chaö_maxÀn
;

1044 
	mn⁄idól_ôems
;

1052 
	möeff_ex∑nds
, 
	mn€x∑nd
;

1054 
uöt32_t
 
	msig«tuª
;

1055 #ifde‡
HASH_BLOOM


1056 
uöt32_t
 
	mbloom_sig
;

1057 
uöt8_t
 *
	mbloom_bv
;

1058 
uöt8_t
 
	mbloom_nbôs
;

1061 } 
	tUT_hash_èbÀ
;

1063 
	sUT_hash_h™dÀ
 {

1064 
UT_hash_èbÀ
 *
	mtbl
;

1065 *
	m¥ev
;

1066 *
	m√xt
;

1067 
UT_hash_h™dÀ
 *
	mhh_¥ev
;

1068 
UT_hash_h™dÀ
 *
	mhh_√xt
;

1069 *
	mkey
;

1070 
	mkeyÀn
;

1071 
	mhashv
;

1072 } 
	tUT_hash_h™dÀ
;

	@/usr/include/wchar.h

23 #i‚de‡
_WCHAR_H


25 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<„©uªs.h
>

30 #ifde‡
_WCHAR_H


32 
	#__√ed___FILE


	)

33 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


34 
	#__√ed_FILE


	)

36 
	~<°dio.h
>

38 
	#__√ed___va_li°


	)

39 
	~<°d¨g.h
>

41 
	~<bôs/wch¨.h
>

44 
	#__√ed_size_t


	)

45 
	#__√ed_wch¨_t


	)

46 
	#__√ed_NULL


	)

48 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


49 #unde‡
__√ed_wöt_t


50 
	#__√ed_wöt_t


	)

51 
	~<°ddef.h
>

55 #i‚de‡
_WINT_T


60 
	#_WINT_T


	)

61 
	twöt_t
;

65 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
deföed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twöt_t
;

69 
	g__END_NAMESPACE_STD


74 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
____mb°©e_t_deföed


80 
	#____mb°©e_t_deföed
 1

	)

84 
	m__cou¡
;

87 #ifde‡
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wöt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vÆue
;

94 } 
	t__mb°©e_t
;

96 #unde‡
__√ed_mb°©e_t


101 #ifde‡
_WCHAR_H


103 #i‚de‡
__mb°©e_t_deföed


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb°©e_t_deföed
 1

	)

111 #ifde‡
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

115 #i‚de‡
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #i‚de‡
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


128 
	~<w˘y≥.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

150 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

151 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

158 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

159 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
)

164 
__THROW
 
__©åibuã_puª__
;

166 
	$wc¢cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©åibuã_puª__
;

168 
__END_NAMESPACE_STD


170 #ifde‡
__USE_XOPEN2K8


172 
	$wcsˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

175 
	$wc¢ˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

176 
size_t
 
__n
Ë
__THROW
;

180 
	~<xloˇÀ.h
>

182 
	$wcsˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

183 
__loˇÀ_t
 
__loc
Ë
__THROW
;

185 
	$wc¢ˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

186 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscﬁl
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

196 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

197 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifde‡
__USE_XOPEN2K8


206 
	$wcscﬁl_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

207 
__loˇÀ_t
 
__loc
Ë
__THROW
;

212 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

213 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

216 
wch¨_t
 *
	$wcsdup
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 "C++" c⁄° 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

227 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

228 
__THROW
 
__©åibuã_puª__
;

231 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

233 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 "C++" c⁄° 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

237 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

238 
__THROW
 
__©åibuã_puª__
;

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_GNU


245 
wch¨_t
 *
	$wcsch∫ul
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__wc
)

246 
__THROW
 
__©åibuã_puª__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ªje˘
)

253 
__THROW
 
__©åibuã_puª__
;

256 
size_t
 
	$wcs•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

257 
__THROW
 
__©åibuã_puª__
;

259 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

262 "C++" c⁄° 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
,

263 c⁄° 
wch¨_t
 *
__ac˚±
)

264 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

266 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

267 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

273 "C++" c⁄° 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
,

274 c⁄° 
wch¨_t
 *
__√edÀ
)

275 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

277 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

278 
__THROW
 
__©åibuã_puª__
;

282 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

283 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

284 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

287 
size_t
 
	$wc¶í
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

288 
__END_NAMESPACE_STD


290 #ifde‡
__USE_XOPEN


292 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

295 "C++" c⁄° 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
,

296 c⁄° 
wch¨_t
 *
__√edÀ
)

297 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

299 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

300 
__THROW
 
__©åibuã_puª__
;

304 #ifde‡
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Àn
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

307 
__THROW
 
__©åibuã_puª__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

316 "C++" c⁄° 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

320 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©åibuã_puª__
;

325 
	$wmemcmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©åibuã_puª__
;

329 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

330 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

334 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifde‡
__USE_GNU


344 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

345 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

357 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

361 
	$mbsöô
 (c⁄° 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

365 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

366 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

367 
mb°©e_t
 *
__ª°ri˘
 
__p
Ë
__THROW
;

370 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

371 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$__mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
size_t
 
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

377 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifde‡
__USE_EXTERN_INLINES


386 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

387 
__exã∫_ölöe
 
wöt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

392 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

393 
__exã∫_ölöe
 

394 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

395 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

396 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

398 
__exã∫_ölöe
 
size_t


399 
__NTH
 (
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

400 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

401 {  (
__ps
 !
NULL


402 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

409 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

410 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

415 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

416 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

424 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

425 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

429 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

430 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

431 
size_t
 
__nwc
, size_à
__Àn
,

432 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

437 #ifde‡
__USE_XOPEN


439 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

443 
	$wcswidth
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc°od
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

451 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifde‡
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc°of
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
	$wc°ﬁd
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

460 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc°ﬁ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

469 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

473 
	$wc°oul
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

474 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GNUC__
 && deföed 
__USE_GNU
)

479 
__BEGIN_NAMESPACE_C99


482 
__exãnsi⁄__


483 
	$wc°ﬁl
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

485 
__THROW
;

489 
__exãnsi⁄__


490 
	$wc°ouŒ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

491 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

492 
__ba£
Ë
__THROW
;

493 
__END_NAMESPACE_C99


496 #i‡
deföed
 
__GNUC__
 && deföed 
__USE_GNU


499 
__exãnsi⁄__


500 
	$wc°oq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

502 
__THROW
;

506 
__exãnsi⁄__


507 
	$wc°ouq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
Ë
__THROW
;

512 #ifde‡
__USE_GNU


526 
	~<xloˇÀ.h
>

530 
	$wc°ﬁ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

531 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

532 
__loˇÀ_t
 
__loc
Ë
__THROW
;

534 
	$wc°oul_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

535 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

536 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

538 
__exãnsi⁄__


539 
	$wc°ﬁl_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

540 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

541 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

543 
__exãnsi⁄__


544 
	$wc°ouŒ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

545 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

546 
__ba£
, 
__loˇÀ_t
 
__loc
)

547 
__THROW
;

549 
	$wc°od_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

550 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
;

553 
	$wc°of_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

554 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

555 
__THROW
;

557 
	$wc°ﬁd_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__loˇÀ_t
 
__loc
Ë
__THROW
;

563 #ifde‡
__USE_XOPEN2K8


566 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

567 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

571 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

572 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

583 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

594 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

595 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	`w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

605 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

606 
__THROW
 ;

612 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

613 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

614 
__gnuc_va_li°
 
__¨g
)

620 
	`vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

621 
__gnuc_va_li°
 
__¨g
)

625 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

626 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

627 
__gnuc_va_li°
 
__¨g
)

628 
__THROW
 ;

635 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

636 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	`wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
	$swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

646 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

647 
__THROW
 ;

649 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

650 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

651 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

652 #ifde‡
__REDIRECT


656 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

657 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_fwsˇnf
)

660 
	`__REDIRECT
 (
wsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

661 
__isoc99_wsˇnf
)

663 
	`__REDIRECT_NTH
 (
swsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

664 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

665 ...), 
__isoc99_swsˇnf
)

668 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

669 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

670 
	`__isoc99_wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

671 
	$__isoc99_swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

672 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

673 
__THROW
;

674 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

675 
	#wsˇnf
 
__isoc99_wsˇnf


	)

676 
	#swsˇnf
 
__isoc99_swsˇnf


	)

680 
__END_NAMESPACE_STD


683 #ifde‡
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

690 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

691 
__gnuc_va_li°
 
__¨g
)

697 
	`vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

698 
__gnuc_va_li°
 
__¨g
)

701 
	$vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

702 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

703 
__gnuc_va_li°
 
__¨g
)

704 
__THROW
 ;

706 #i‡!
deföed
 
__USE_GNU
 \

707 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

708 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

711 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

714 
	`__REDIRECT
 (
vwsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

715 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

717 
	`__REDIRECT_NTH
 (
vswsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

718 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

719 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

722 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

723 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	`__isoc99_vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
);

727 
	$__isoc99_vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

728 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

729 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

730 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

731 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

732 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

746 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

752 
wöt_t
 
	`gëwch¨
 ();

759 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

760 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

766 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

774 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

775 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

789 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

790 
__END_NAMESPACE_STD


793 #ifde‡
__USE_GNU


801 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

802 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

810 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

818 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

827 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

828 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

837 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

838 
__FILE
 *
__ª°ri˘
 
__°ªam
);

846 
	`Âutws_u∆ocked
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

847 
__FILE
 *
__ª°ri˘
 
__°ªam
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

856 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

857 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifde‡
__USE_GNU


861 
	~<xloˇÀ.h
>

865 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

866 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

867 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

868 
__loˇÀ_t
 
__loc
Ë
__THROW
;

877 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


878 
	#__√ed_iswxxx


	)

879 
	~<w˘y≥.h
>

883 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


884 
	~<bôs/wch¨2.h
>

887 #ifde‡
__LDBL_COMPAT


888 
	~<bôs/wch¨-ldbl.h
>

891 
__END_DECLS


899 #unde‡
__√ed_mb°©e_t


900 #unde‡
__√ed_wöt_t


	@/usr/include/wctype.h

23 #i‚de‡
_WCTYPE_H


25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 #i‚de‡
__√ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__√ed_wöt_t


	)

33 
	~<wch¨.h
>

37 #i‚de‡
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde‡
__√ed_iswxxx


46 #i‚de‡
__iswxxx_deföed


47 
	#__iswxxx_deföed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	tw˘y≥_t
;

53 
	g__END_NAMESPACE_C99


55 #i‚de‡
_ISwbô


60 
	~<ídün.h
>

61 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

64 
	#_ISwbô
(
bô
) \

65 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

73 
	m__ISwuµî
 = 0,

74 
	m__ISwlowî
 = 1,

75 
	m__ISwÆpha
 = 2,

76 
	m__ISwdigô
 = 3,

77 
	m__ISwxdigô
 = 4,

78 
	m__ISw•a˚
 = 5,

79 
	m__ISw¥öt
 = 6,

80 
	m__ISwgøph
 = 7,

81 
	m__ISwbœnk
 = 8,

82 
	m__ISw˙ål
 = 9,

83 
	m__ISwpun˘
 = 10,

84 
	m__ISwÆnum
 = 11,

86 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

87 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

88 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

89 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

90 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

91 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

92 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

93 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

94 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

95 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

96 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

97 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

117 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

120 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

124 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

128 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

133 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

136 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

141 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

146 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

161 #ifde‡
__USE_ISOC99


162 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
w˘y≥_t
 
	$w˘y≥
 (c⁄° *
__¥›îty
Ë
__THROW
;

175 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 c⁄° 
	t__öt32_t
 *
	tw˘øns_t
;

187 
__END_NAMESPACE_C99


188 #ifde‡
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

197 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde‡
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
w˘øns_t
 
	$w˘øns
 (c⁄° *
__¥›îty
Ë
__THROW
;

221 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde‡
__USE_XOPEN2K8


226 
	~<xloˇÀ.h
>

230 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

236 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

239 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

243 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

247 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

252 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

255 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

260 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

265 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

284 
w˘y≥_t
 
	$w˘y≥_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

285 
__THROW
;

289 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

290 
__THROW
;

298 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

301 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

305 
w˘øns_t
 
	$w˘øns_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

306 
__THROW
;

309 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

310 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

314 
__END_DECLS


	@bgpd/bgp_advertise.h

21 #i‚de‡
_QUAGGA_BGP_ADVERTISE_H


22 
	#_QUAGGA_BGP_ADVERTISE_H


	)

25 
	sbgp_advîti£_fifo


27 
bgp_advîti£
 *
	m√xt
;

28 
bgp_advîti£
 *
	m¥ev
;

32 
	sbgp_advîti£_©å


35 
bgp_advîti£
 *
	madv
;

38 
	mªf˙t
;

41 
©å
 *
	m©å
;

44 
	sbgp_advîti£


47 
bgp_advîti£_fifo
 
	mfifo
;

50 
bgp_advîti£
 *
	m√xt
;

51 
bgp_advîti£
 *
	m¥ev
;

54 
bgp_node
 *
	m∫
;

57 
bgp_adj_out
 *
	madj
;

60 
bgp_advîti£_©å
 *
	mbØ
;

63 
bgp_öfo
 *
	mböfo
;

67 
	sbgp_adj_out


70 
bgp_adj_out
 *
	m√xt
;

71 
bgp_adj_out
 *
	m¥ev
;

74 
≥î
 *
	m≥î
;

77 
©å
 *
	m©å
;

80 
bgp_advîti£
 *
	madv
;

84 
	sbgp_adj_ö


87 
bgp_adj_ö
 *
	m√xt
;

88 
bgp_adj_ö
 *
	m¥ev
;

91 
≥î
 *
	m≥î
;

94 
©å
 *
	m©å
;

98 
	sbgp_synchr⁄ize


100 
bgp_advîti£_fifo
 
	mupd©e
;

101 
bgp_advîti£_fifo
 
	mwôhdøw
;

102 
bgp_advîti£_fifo
 
	mwôhdøw_low
;

106 
	#BGP_INFO_ADD
(
N
,
A
,
TYPE
) \

108 (
A
)->
¥ev
 = 
NULL
; \

109 (
A
)->
√xt
 = (
N
)->
TYPE
; \

110 i‡((
N
)->
TYPE
) \

111 (
N
)->
TYPE
->
¥ev
 = (
A
); \

112 (
N
)->
TYPE
 = (
A
); \

113 } 0)

	)

115 
	#BGP_INFO_DEL
(
N
,
A
,
TYPE
) \

117 i‡((
A
)->
√xt
) \

118 (
A
)->
√xt
->
¥ev
 = (A)->prev; \

119 i‡((
A
)->
¥ev
) \

120 (
A
)->
¥ev
->
√xt
 = (A)->next; \

122 (
N
)->
TYPE
 = (
A
)->
√xt
; \

123 } 0)

	)

125 
	#BGP_ADJ_IN_ADD
(
N
,
A
Ë
	`BGP_INFO_ADD
(N,A,
adj_ö
)

	)

126 
	#BGP_ADJ_IN_DEL
(
N
,
A
Ë
	`BGP_INFO_DEL
(N,A,
adj_ö
)

	)

127 
	#BGP_ADJ_OUT_ADD
(
N
,
A
Ë
	`BGP_INFO_ADD
(N,A,
adj_out
)

	)

128 
	#BGP_ADJ_OUT_DEL
(
N
,
A
Ë
	`BGP_INFO_DEL
(N,A,
adj_out
)

	)

131 
bgp_adj_out_£t
 (
bgp_node
 *, 
≥î
 *, 
¥efix
 *,

132 
©å
 *, 
afi_t
, 
ßfi_t
, 
bgp_öfo
 *);

133 
bgp_adj_out_un£t
 (
bgp_node
 *, 
≥î
 *, 
¥efix
 *,

134 
afi_t
, 
ßfi_t
);

135 
bgp_adj_out_ªmove
 (
bgp_node
 *, 
bgp_adj_out
 *,

136 
≥î
 *, 
afi_t
, 
ßfi_t
);

137 
bgp_adj_out_lookup
 (
≥î
 *, 
¥efix
 *, 
afi_t
, 
ßfi_t
,

138 
bgp_node
 *);

140 
bgp_adj_ö_£t
 (
bgp_node
 *, 
≥î
 *, 
©å
 *);

141 
bgp_adj_ö_un£t
 (
bgp_node
 *, 
≥î
 *);

142 
bgp_adj_ö_ªmove
 (
bgp_node
 *, 
bgp_adj_ö
 *);

144 
bgp_advîti£
 *

145 
bgp_advîti£_˛ón
 (
≥î
 *, 
bgp_adj_out
 *, 
afi_t
, 
ßfi_t
);

147 
bgp_sync_öô
 (
≥î
 *);

148 
bgp_sync_dñëe
 (
≥î
 *);

	@bgpd/bgp_aspath.h

21 #i‚de‡
_QUAGGA_BGP_ASPATH_H


22 
	#_QUAGGA_BGP_ASPATH_H


	)

25 
	#AS_SET
 1

	)

26 
	#AS_SEQUENCE
 2

	)

27 
	#AS_CONFED_SEQUENCE
 3

	)

28 
	#AS_CONFED_SET
 4

	)

31 
	#BGP_PRIVATE_AS_MIN
 64512U

	)

32 
	#BGP_PRIVATE_AS_MAX
 65535U

	)

35 
	#BGP_AS_MAX
 65535U

	)

36 
	#BGP_AS4_MAX
 4294967295U

	)

38 
	#BGP_AS_TRANS
 23456U

	)

41 
	sas£gmít


43 
as£gmít
 *
	m√xt
;

44 
as_t
 *
	mas
;

45 
u_sh‹t
 
	mÀngth
;

46 
u_ch¨
 
	mty≥
;

50 
	sa•©h


53 
	mªf˙t
;

56 
as£gmít
 *
	m£gmíts
;

60 *
	m°r
;

61 
	m°r_Àn
;

64 
	#ASPATH_STR_DEFAULT_LEN
 32

	)

67 
a•©h_öô
 ();

68 
a•©h_föish
 ();

69 
a•©h
 *
a•©h_∑r£
 (
°ªam
 *, 
size_t
, );

70 
a•©h
 *
a•©h_dup
 (aspath *);

71 
a•©h
 *
a•©h_aggªg©e
 (aspath *, aspath *);

72 
a•©h
 *
a•©h_¥ïíd
 (aspath *, aspath *);

73 
a•©h
 *
a•©h_fûãr_ex˛ude
 (aspath *, aspath *);

74 
a•©h
 *
a•©h_add_£q
 (a•©h *, 
as_t
);

75 
a•©h
 *
a•©h_add_c⁄„d_£q
 (a•©h *, 
as_t
);

76 
a•©h_cmp
 (const *, const *);

77 
a•©h_cmp_À·
 (c⁄° 
a•©h
 *, const aspath *);

78 
a•©h_cmp_À·_c⁄„d
 (c⁄° 
a•©h
 *, const aspath *);

79 
a•©h
 *
a•©h_dñëe_c⁄„d_£q
 (aspath *);

80 
a•©h
 *
a•©h_em±y
 ();

81 
a•©h
 *
a•©h_em±y_gë
 ();

82 
a•©h
 *
a•©h_°r2a•©h
 (const *);

83 
a•©h_‰ì
 (
a•©h
 *);

84 
a•©h
 *
a•©h_öã∫
 (aspath *);

85 
a•©h_unöã∫
 (
a•©h
 **);

86 c⁄° *
a•©h_¥öt
 (
a•©h
 *);

87 
a•©h_¥öt_vty
 (
vty
 *, c⁄° *, 
a•©h
 *, const *);

88 
a•©h_¥öt_Æl_vty
 (
vty
 *);

89 
a•©h_key_make
 (*);

90 
a•©h_lo›_check
 (
a•©h
 *, 
as_t
);

91 
a•©h_¥iv©e_as_check
 (
a•©h
 *);

92 
a•©h_fú°as_check
 (
a•©h
 *, 
as_t
);

93 
a•©h_c⁄„d_check
 (
a•©h
 *);

94 
a•©h_À·_c⁄„d_check
 (
a•©h
 *);

95 
a•©h_cou¡
 ();

96 
a•©h_cou¡_h›s
 (
a•©h
 *);

97 
a•©h_cou¡_c⁄„ds
 (
a•©h
 *);

98 
a•©h_size
 (
a•©h
 *);

99 
as_t
 
a•©h_highe°
 (
a•©h
 *);

100 
size_t
 
a•©h_put
 (
°ªam
 *, 
a•©h
 *, );

102 
a•©h
 *
a•©h_ªc⁄cûe_as4
 (aspath *, aspath *);

103 
a•©h_has_as4
 (
a•©h
 *);

106 
u_ch¨
 *
a•©h_¢mp_∑th£g
 (
a•©h
 *, 
size_t
 *);

108 #ifde‡
USE_SRX


109 
as_t
 
a•©h_‹igö_as
 (
a•©h
 *);

	@bgpd/bgp_attr.h

21 #i‚de‡
_QUAGGA_BGP_ATTR_H


22 
	#_QUAGGA_BGP_ATTR_H


	)

24 #ifde‡
USE_SRX


25 
	~<§x/§x¸y±ﬂpi.h
>

29 
	#BITMAP_NBBY
 8

	)

31 
	#SET_BITMAP
(
MAP
, 
NUM
) \

32 
	`SET_FLAG
 (
MAP
[(
NUM
Ë/ 
BITMAP_NBBY
], 1 << ((NUMË% BITMAP_NBBY))

	)

34 
	#CHECK_BITMAP
(
MAP
, 
NUM
) \

35 
	`CHECK_FLAG
 (
MAP
[(
NUM
Ë/ 
BITMAP_NBBY
], 1 << ((NUMË% BITMAP_NBBY))

	)

37 
	#BGP_MED_MAX
 
UINT32_MAX


	)

41 
	#BGP_ATTR_TYPE_RANGE
 256

	)

42 
	#BGP_ATTR_BITMAP_SIZE
 (
BGP_ATTR_TYPE_RANGE
 / 
BITMAP_NBBY
)

	)

45 
	#BGP_ATTR_FLAG_OPTIONAL
 0x80

	)

46 
	#BGP_ATTR_FLAG_TRANS
 0x40

	)

47 
	#BGP_ATTR_FLAG_PARTIAL
 0x20

	)

48 
	#BGP_ATTR_FLAG_EXTLEN
 0x10

	)

51 
	#BGP_ATTR_MIN_LEN
 3

	)

52 
	#BGP_ATTR_DEFAULT_WEIGHT
 32768

	)

58 
	s©å_exåa


61 #ifde‡
HAVE_IPV6


62 
ö6_addr
 
	mmp_√xth›_globÆ
;

63 
ö6_addr
 
	mmp_√xth›_loˇl
;

67 
ecommunôy
 *
	mecommunôy
;

70 
˛u°î_li°
 *
	m˛u°î
;

73 
å™sô
 *
	må™sô
;

75 
ö_addr
 
	mmp_√xth›_globÆ_ö
;

76 
ö_addr
 
	mmp_√xth›_loˇl_ö
;

79 
ö_addr
 
	maggªg©‹_addr
;

82 
ö_addr
 
	m‹igö©‹_id
;

85 
u_öt32_t
 
	mweight
;

88 
as_t
 
	maggªg©‹_as
;

91 
u_ch¨
 
	mmp_√xth›_Àn
;

96 
	s©å


99 
a•©h
 *
	ma•©h
;

102 
communôy
 *
	mcommunôy
;

105 
©å_exåa
 *
	mexåa
;

108 
	mªf˙t
;

111 
u_öt32_t
 
	mÊag
;

114 
ö_addr
 
	m√xth›
;

115 
u_öt32_t
 
	mmed
;

116 
u_öt32_t
 
	mloˇl_¥ef
;

119 
u_ch¨
 
	m‹igö
;

121 #ifde‡
USE_SRX


122 
Bgp£cP©hAâr
 *
	mbgp£cP©hAâr
;

124 
SCA_BGPSecVÆid©i⁄D©a
* 
	mbgp£c_vÆid©i⁄D©a
;

129 
	s˛u°î_li°


131 
	mªf˙t
;

132 
	mÀngth
;

133 
ö_addr
 *
	mli°
;

137 
	så™sô


139 
	mªf˙t
;

140 
	mÀngth
;

141 
u_ch¨
 *
	mvÆ
;

144 
	#ATTR_FLAG_BIT
(
X
Ë(1 << ((XË- 1))

	)

147 
	mBGP_ATTR_PARSE_PROCEED
 = 0,

148 
	mBGP_ATTR_PARSE_ERROR
 = -1,

149 
	mBGP_ATTR_PARSE_WITHDRAW
 = -2,

150 } 
	tbgp_©å_∑r£_ªt_t
;

153 
bgp_©å_öô
 ();

154 
bgp_©å_föish
 ();

155 
bgp_©å_∑r£_ªt_t
 
bgp_©å_∑r£
 (
≥î
 *, 
©å
 *,

156 
bgp_size_t
, 
bgp_∆ri
 *,

157 
bgp_∆ri
 *);

158 
bgp_©å_check
 (
≥î
 *, 
©å
 *);

159 
©å_exåa
 *
bgp_©å_exåa_gë
 (
©å
 *);

160 
bgp_©å_exåa_‰ì
 (
©å
 *);

161 
bgp_©å_dup
 (
©å
 *, attr *);

162 
©å
 *
bgp_©å_öã∫
 (attr *attr);

163 
bgp_©å_unöã∫_sub
 (
©å
 *);

164 
bgp_©å_unöã∫
 (
©å
 **);

165 
bgp_©å_Êush
 (
©å
 *);

166 
©å
 *
bgp_©å_deÁu…_£t
 (©å *©å, 
u_ch¨
);

167 
©å
 *
bgp_©å_deÁu…_öã∫
 (
u_ch¨
);

168 
©å
 *
bgp_©å_aggªg©e_öã∫
 (
bgp
 *, 
u_ch¨
,

169 
a•©h
 *,

170 
communôy
 *, 
as_£t
);

171 #ifde‡
USE_SRX


174 
bgp_size_t
 
bgp_∑ckë_©åibuã
 (
bgp
 *bgp, 
≥î
 *,

175 
°ªam
 *, 
©å
 *,

176 
¥efix
 *, 
afi_t
, 
ßfi_t
,

177 
≥î
 *, 
¥efix_rd
 *, 
u_ch¨
 *,

178 
boﬁ
* 
fSëA•©h
);

180 
bgp_size_t
 
bgp_∑ckë_©åibuã
 (
bgp
 *bgp, 
≥î
 *,

181 
°ªam
 *, 
©å
 *,

182 
¥efix
 *, 
afi_t
, 
ßfi_t
,

183 
≥î
 *, 
¥efix_rd
 *, 
u_ch¨
 *);

185 
bgp_size_t
 
bgp_∑ckë_wôhdøw
 (
≥î
 *≥î, 
°ªam
 *
s
,

186 
¥efix
 *
p
, 
afi_t
, 
ßfi_t
,

187 
¥efix_rd
 *, 
u_ch¨
 *);

188 
bgp_dump_rouãs_©å
 (
°ªam
 *, 
©å
 *,

189 
¥efix
 *);

190 
©åhash_cmp
 (const *, const *);

191 
©åhash_key_make
 (*);

192 
©å_show_Æl
 (
vty
 *);

193 
©å_cou¡
 ();

194 
©å_unknown_cou¡
 ();

197 
˛u°î_lo›_check
 (
˛u°î_li°
 *, 
ö_addr
);

198 
˛u°î_unöã∫
 (
˛u°î_li°
 *);

201 
å™sô_unöã∫
 (
å™sô
 *);

204 
	sbgp_©å_∑r£r_¨gs
 {

205 
≥î
 *
	m≥î
;

206 
bgp_size_t
 
	mÀngth
;

207 
bgp_size_t
 
	mtŸÆ
;

208 
©å
 *
	m©å
;

209 
u_öt8_t
 
	mty≥
;

210 
u_öt8_t
 
	mÊags
;

211 
u_ch¨
 *
	m°¨ç
;

213 
bgp_mp_ªach_∑r£
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

214 
bgp_∆ri
 *);

215 
bgp_mp_uƒóch_∑r£
 (
bgp_©å_∑r£r_¨gs
 *
¨gs
,

216 
bgp_∆ri
 *);

	@bgpd/bgp_clist.h

21 #i‚de‡
_QUAGGA_BGP_CLIST_H


22 
	#_QUAGGA_BGP_CLIST_H


	)

25 
	#COMMUNITY_LIST_MASTER
 0

	)

26 
	#EXTCOMMUNITY_LIST_MASTER
 1

	)

29 
	#COMMUNITY_DENY
 0

	)

30 
	#COMMUNITY_PERMIT
 1

	)

33 
	#COMMUNITY_LIST_STRING
 0

	)

34 
	#COMMUNITY_LIST_NUMBER
 1

	)

37 
	#COMMUNITY_LIST_STANDARD
 0

	)

38 
	#COMMUNITY_LIST_EXPANDED
 1

	)

39 
	#EXTCOMMUNITY_LIST_STANDARD
 2

	)

40 
	#EXTCOMMUNITY_LIST_EXPANDED
 3

	)

43 
	scommunôy_li°


46 *
	m«me
;

49 
	ms‹t
;

52 
communôy_li°_li°
 *
	m∑ª¡
;

55 
communôy_li°
 *
	m√xt
;

56 
communôy_li°
 *
	m¥ev
;

59 
communôy_íåy
 *
	mhód
;

60 
communôy_íåy
 *
	mèû
;

64 
	scommunôy_íåy


66 
communôy_íåy
 *
	m√xt
;

67 
communôy_íåy
 *
	m¥ev
;

70 
u_ch¨
 
	mdúe˘
;

73 
u_ch¨
 
	m°yÀ
;

76 
u_ch¨
 
	m™y
;

81 
communôy
 *
	mcom
;

82 
ecommunôy
 *
	mecom
;

83 } 
	mu
;

86 *
	mc⁄fig
;

89 
ªgex_t
 *
	mªg
;

93 
	scommunôy_li°_li°


95 
communôy_li°
 *
	mhód
;

96 
communôy_li°
 *
	mèû
;

100 
	scommunôy_li°_ma°î


102 
communôy_li°_li°
 
	mnum
;

103 
communôy_li°_li°
 
	m°r
;

108 
	scommunôy_li°_h™dÀr


111 
communôy_li°_ma°î
 
	mcommunôy_li°
;

114 
communôy_li°_ma°î
 
	mextcommunôy_li°
;

118 
	#COMMUNITY_LIST_ERR_CANT_FIND_LIST
 -1

	)

119 
	#COMMUNITY_LIST_ERR_MALFORMED_VAL
 -2

	)

120 
	#COMMUNITY_LIST_ERR_STANDARD_CONFLICT
 -3

	)

121 
	#COMMUNITY_LIST_ERR_EXPANDED_CONFLICT
 -4

	)

124 
communôy_li°_h™dÀr
 *
bgp_˛i°
;

127 
communôy_li°_h™dÀr
 *
communôy_li°_öô
 ();

128 
communôy_li°_ãrmö©e
 (
communôy_li°_h™dÀr
 *);

130 
communôy_li°_£t
 (
communôy_li°_h™dÀr
 *
ch
,

131 c⁄° *
«me
, c⁄° *
°r
, 
dúe˘
,

132 
°yÀ
);

133 
communôy_li°_un£t
 (
communôy_li°_h™dÀr
 *
ch
,

134 c⁄° *
«me
, c⁄° *
°r
,

135 
dúe˘
, 
°yÀ
);

136 
extcommunôy_li°_£t
 (
communôy_li°_h™dÀr
 *
ch
,

137 c⁄° *
«me
, c⁄° *
°r
,

138 
dúe˘
, 
°yÀ
);

139 
extcommunôy_li°_un£t
 (
communôy_li°_h™dÀr
 *
ch
,

140 c⁄° *
«me
, c⁄° *
°r
,

141 
dúe˘
, 
°yÀ
);

143 
communôy_li°_ma°î
 *

144 
communôy_li°_ma°î_lookup
 (
communôy_li°_h™dÀr
 *, );

146 
communôy_li°
 *

147 
communôy_li°_lookup
 (
communôy_li°_h™dÀr
 *, const *, );

149 
communôy_li°_m©ch
 (
communôy
 *, 
communôy_li°
 *);

150 
ecommunôy_li°_m©ch
 (
ecommunôy
 *, 
communôy_li°
 *);

151 
communôy_li°_exa˘_m©ch
 (
communôy
 *,

152 
communôy_li°
 *);

153 
communôy
 *

154 
communôy_li°_m©ch_dñëe
 (
communôy
 *, 
communôy_li°
 *);

	@bgpd/bgp_community.h

21 #i‚de‡
_QUAGGA_BGP_COMMUNITY_H


22 
	#_QUAGGA_BGP_COMMUNITY_H


	)

25 
	scommunôy


28 
	mªf˙t
;

31 
	msize
;

34 
u_öt32_t
 *
	mvÆ
;

38 *
	m°r
;

42 
	#COMMUNITY_INTERNET
 0x0

	)

43 
	#COMMUNITY_NO_EXPORT
 0xFFFFFF01

	)

44 
	#COMMUNITY_NO_ADVERTISE
 0xFFFFFF02

	)

45 
	#COMMUNITY_NO_EXPORT_SUBCONFED
 0xFFFFFF03

	)

46 
	#COMMUNITY_LOCAL_AS
 0xFFFFFF03

	)

49 
	#com_Àngth
(
X
Ë((X)->
size
 * 4)

	)

50 
	#com_œ°vÆ
(
X
Ë((X)->
vÆ
 + (X)->
size
 - 1)

	)

51 
	#com_¡hvÆ
(
X
,
n
Ë((X)->
vÆ
 + (n))

	)

54 
communôy_öô
 ();

55 
communôy_föish
 ();

56 
communôy_‰ì
 (
communôy
 *);

57 
communôy
 *
communôy_uniq_s‹t
 (community *);

58 
communôy
 *
communôy_∑r£
 (
u_öt32_t
 *, 
u_sh‹t
);

59 
communôy
 *
communôy_öã∫
 (community *);

60 
communôy_unöã∫
 (
communôy
 **);

61 *
communôy_°r
 (
communôy
 *);

62 
communôy_hash_make
 (
communôy
 *);

63 
communôy
 *
communôy_°r2com
 (const *);

64 
communôy_m©ch
 (c⁄° 
communôy
 *, const community *);

65 
communôy_cmp
 (c⁄° 
communôy
 *, const community *);

66 
communôy
 *
communôy_mîge
 (community *, community *);

67 
communôy
 *
communôy_dñëe
 (community *, community *);

68 
communôy
 *
communôy_dup
 (community *);

69 
communôy_ö˛ude
 (
communôy
 *, 
u_öt32_t
);

70 
communôy_dñ_vÆ
 (
communôy
 *, 
u_öt32_t
 *);

71 
communôy_cou¡
 ();

72 
hash
 *
communôy_hash
 ();

	@bgpd/bgp_damp.h

21 #i‚de‡
_QUAGGA_BGP_DAMP_H


22 
	#_QUAGGA_BGP_DAMP_H


	)

25 
	sbgp_damp_öfo


29 
bgp_damp_öfo
 *
	m√xt
;

30 
bgp_damp_öfo
 *
	m¥ev
;

33 
	m≥«…y
;

36 
	mÊ≠
;

39 
time_t
 
	m°¨t_time
;

42 
time_t
 
	mt_upd©ed
;

45 
time_t
 
	msuµªss_time
;

48 
bgp_öfo
 *
	mböfo
;

51 
bgp_node
 *
	m∫
;

54 
	mödex
;

57 
u_ch¨
 
	mœ°ªc‹d
;

58 
	#BGP_RECORD_UPDATE
 1U

	)

59 
	#BGP_RECORD_WITHDRAW
 2U

	)

61 
afi_t
 
	mafi
;

62 
ßfi_t
 
	mßfi
;

66 
	sbgp_damp_c⁄fig


69 
	msuµªss_vÆue
;

72 
	mªu£_limô
;

75 
time_t
 
	mmax_suµªss_time
;

78 
time_t
 
	mhÆf_li„
;

83 
time_t
 
	mtmax
;

84 
	mªu£_li°_size
;

85 
	mªu£_ödex_size
;

90 
	m˚ûög
;

91 
	mdeˇy_øã_≥r_tick
;

92 
	mdeˇy_¨øy_size
;

93 
	msˇÀ_Á˘‹
;

94 
	mªu£_sˇÀ_Á˘‹
;

97 *
	mdeˇy_¨øy
;

100 *
	mªu£_ödex
;

103 
bgp_damp_öfo
 **
	mªu£_li°
;

104 
	mªu£_off£t
;

107 
bgp_damp_öfo
 *
	mno_ªu£_li°
;

110 
thªad
* 
	mt_ªu£
;

113 
	#BGP_DAMP_NONE
 0

	)

114 
	#BGP_DAMP_USED
 1

	)

115 
	#BGP_DAMP_SUPPRESSED
 2

	)

118 
	#DELTA_REUSE
 10

	)

121 
	#DELTA_T
 5

	)

123 
	#DEFAULT_PENALTY
 1000

	)

125 
	#DEFAULT_HALF_LIFE
 15

	)

126 
	#DEFAULT_REUSE
 750

	)

127 
	#DEFAULT_SUPPRESS
 2000

	)

129 
	#REUSE_LIST_SIZE
 256

	)

130 
	#REUSE_ARRAY_SIZE
 1024

	)

132 
bgp_damp_íabÀ
 (
bgp
 *, 
afi_t
, 
ßfi_t
, 
time_t
, ,

133 , 
time_t
);

134 
bgp_damp_dißbÀ
 (
bgp
 *, 
afi_t
, 
ßfi_t
);

135 
bgp_damp_wôhdøw
 (
bgp_öfo
 *, 
bgp_node
 *,

136 
afi_t
, 
ßfi_t
, );

137 
bgp_damp_upd©e
 (
bgp_öfo
 *, 
bgp_node
 *, 
afi_t
, 
ßfi_t
);

138 
bgp_damp_sˇn
 (
bgp_öfo
 *, 
afi_t
, 
ßfi_t
);

139 
bgp_damp_öfo_‰ì
 (
bgp_damp_öfo
 *, );

140 
bgp_damp_öfo_˛ón
 ();

141 
bgp_damp_deˇy
 (
time_t
, );

142 
bgp_c⁄fig_wrôe_damp
 (
vty
 *);

143 
bgp_damp_öfo_vty
 (
vty
 *, 
bgp_öfo
 *);

144 c⁄° * 
bgp_damp_ªu£_time_vty
 (
vty
 *, 
bgp_öfo
 *,

145 *, 
size_t
);

	@bgpd/bgp_debug.h

21 #i‚de‡
_QUAGGA_BGP_DEBUG_H


22 
	#_QUAGGA_BGP_DEBUG_H


	)

24 
	~"bgp_©å.h
"

27 
	#DUMP_ON
 1

	)

28 
	#DUMP_SEND
 2

	)

29 
	#DUMP_RECV
 4

	)

32 
	#DUMP_WITHDRAW
 8

	)

33 
	#DUMP_NLRI
 16

	)

36 
	#DUMP_DETAIL
 32

	)

38 
dump_›í
;

39 
dump_upd©e
;

40 
dump_kì∑live
;

41 
dump_nŸify
;

43 
Debug_Evít
;

44 
Debug_Kì∑live
;

45 
Debug_Upd©e
;

46 
Debug_Radix
;

48 
	#NLRI
 1

	)

49 
	#WITHDRAW
 2

	)

50 
	#NO_OPT
 3

	)

51 
	#SEND
 4

	)

52 
	#RECV
 5

	)

53 
	#DETAIL
 6

	)

56 
bgp_debug_öô
 ();

57 
bgp_∑ckë_dump
 (
°ªam
 *);

59 
debug
 (
›ti⁄
);

61 
c⁄f_bgp_debug_as4
;

62 
c⁄f_bgp_debug_fsm
;

63 
c⁄f_bgp_debug_evíts
;

64 
c⁄f_bgp_debug_∑ckë
;

65 
c⁄f_bgp_debug_fûãr
;

66 
c⁄f_bgp_debug_kì∑live
;

67 
c⁄f_bgp_debug_upd©e
;

68 
c⁄f_bgp_debug_n‹mÆ
;

69 
c⁄f_bgp_debug_zebø
;

71 
ãrm_bgp_debug_as4
;

72 
ãrm_bgp_debug_fsm
;

73 
ãrm_bgp_debug_evíts
;

74 
ãrm_bgp_debug_∑ckë
;

75 
ãrm_bgp_debug_fûãr
;

76 
ãrm_bgp_debug_kì∑live
;

77 
ãrm_bgp_debug_upd©e
;

78 
ãrm_bgp_debug_n‹mÆ
;

79 
ãrm_bgp_debug_zebø
;

80 #ifde‡
USE_SRX


81 
ãrm_bgp_debug_bgp£c
;

84 
	#BGP_DEBUG_AS4
 0x01

	)

85 
	#BGP_DEBUG_AS4_SEGMENT
 0x02

	)

87 
	#BGP_DEBUG_FSM
 0x01

	)

88 
	#BGP_DEBUG_EVENTS
 0x01

	)

89 
	#BGP_DEBUG_PACKET
 0x01

	)

90 
	#BGP_DEBUG_FILTER
 0x01

	)

91 
	#BGP_DEBUG_KEEPALIVE
 0x01

	)

92 
	#BGP_DEBUG_UPDATE_IN
 0x01

	)

93 
	#BGP_DEBUG_UPDATE_OUT
 0x02

	)

94 
	#BGP_DEBUG_NORMAL
 0x01

	)

95 
	#BGP_DEBUG_ZEBRA
 0x01

	)

96 #ifde‡
USE_SRX


97 
	#BGP_DEBUG_BGPSEC_DETAIL
 0x01

	)

98 
	#BGP_DEBUG_BGPSEC
 0x01

99 
	#BGP_DEBUG_BGPSEC_IN
 0x02

	)

100 
	#BGP_DEBUG_BGPSEC_OUT
 0x04

	)

103 
	#BGP_DEBUG_PACKET_SEND
 0x01

	)

104 
	#BGP_DEBUG_PACKET_SEND_DETAIL
 0x02

	)

106 
	#BGP_DEBUG_PACKET_RECV
 0x01

	)

107 
	#BGP_DEBUG_PACKET_RECV_DETAIL
 0x02

	)

109 
	#CONF_DEBUG_ON
(
a
, 
b
Ë(
c⁄f_bgp_debug_
 ##á |(
BGP_DEBUG_
 ## b))

	)

110 
	#CONF_DEBUG_OFF
(
a
, 
b
Ë(
c⁄f_bgp_debug_
 ##á &~(
BGP_DEBUG_
 ## b))

	)

112 
	#TERM_DEBUG_ON
(
a
, 
b
Ë(
ãrm_bgp_debug_
 ##á |(
BGP_DEBUG_
 ## b))

	)

113 
	#TERM_DEBUG_OFF
(
a
, 
b
Ë(
ãrm_bgp_debug_
 ##á &~(
BGP_DEBUG_
 ## b))

	)

115 
	#DEBUG_ON
(
a
, 
b
) \

117 
	`CONF_DEBUG_ON
(
a
, 
b
); \

118 
	`TERM_DEBUG_ON
(
a
, 
b
); \

119 } 0)

	)

120 
	#DEBUG_OFF
(
a
, 
b
) \

122 
	`CONF_DEBUG_OFF
(
a
, 
b
); \

123 
	`TERM_DEBUG_OFF
(
a
, 
b
); \

124 } 0)

	)

126 
	#BGP_DEBUG
(
a
, 
b
Ë(
ãrm_bgp_debug_
 ##á & 
BGP_DEBUG_
 ## b)

	)

127 
	#CONF_BGP_DEBUG
(
a
, 
b
Ë(
c⁄f_bgp_debug_
 ##á & 
BGP_DEBUG_
 ## b)

	)

129 c⁄° *
bgp_ty≥_°r
[];

131 
bgp_dump_©å
 (
≥î
 *, 
©å
 *, *, 
size_t
);

132 
bgp_nŸify_¥öt
 (
≥î
 *, 
bgp_nŸify
 *, const *);

134 c⁄° 
mesßge
 
bgp_°©us_msg
[];

135 c⁄° 
bgp_°©us_msg_max
;

	@bgpd/bgp_dump.h

21 #i‚de‡
_QUAGGA_BGP_DUMP_H


22 
	#_QUAGGA_BGP_DUMP_H


	)

26 
	#MSG_PROTOCOL_BGP4MP
 16

	)

28 
	#BGP4MP_STATE_CHANGE
 0

	)

29 
	#BGP4MP_MESSAGE
 1

	)

30 
	#BGP4MP_ENTRY
 2

	)

31 
	#BGP4MP_SNAPSHOT
 3

	)

32 
	#BGP4MP_MESSAGE_AS4
 4

	)

33 
	#BGP4MP_STATE_CHANGE_AS4
 5

	)

35 
	#BGP_DUMP_HEADER_SIZE
 12

	)

36 
	#BGP_DUMP_MSG_HEADER
 40

	)

38 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE
 1

	)

39 
	#TABLE_DUMP_V2_RIB_IPV4_UNICAST
 2

	)

40 
	#TABLE_DUMP_V2_RIB_IPV4_MULTICAST
 3

	)

41 
	#TABLE_DUMP_V2_RIB_IPV6_UNICAST
 4

	)

42 
	#TABLE_DUMP_V2_RIB_IPV6_MULTICAST
 5

	)

43 
	#TABLE_DUMP_V2_RIB_GENERIC
 6

	)

45 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_IP
 0

	)

46 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_IP6
 1

	)

47 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_AS2
 0

	)

48 
	#TABLE_DUMP_V2_PEER_INDEX_TABLE_AS4
 2

	)

50 
bgp_dump_öô
 ();

51 
bgp_dump_föish
 ();

52 
bgp_dump_°©e
 (
≥î
 *, , );

53 
bgp_dump_∑ckë
 (
≥î
 *, , 
°ªam
 *);

	@bgpd/bgp_ecommunity.h

21 #i‚de‡
_QUAGGA_BGP_ECOMMUNITY_H


22 
	#_QUAGGA_BGP_ECOMMUNITY_H


	)

25 
	#ECOMMUNITY_ENCODE_AS
 0x00

	)

26 
	#ECOMMUNITY_ENCODE_IP
 0x01

	)

27 
	#ECOMMUNITY_ENCODE_AS4
 0x02

	)

28 #ifde‡
USE_SRX


29 
	#ECOMMUNITY_ENCODE_BGPSEC
 0x43

	)

30 
	#ECOMMUNITY_ENCODE_TRANSITIVE_BGPSEC
 0x03

	)

35 
	#ECOMMUNITY_ROUTE_TARGET
 0x02

	)

36 
	#ECOMMUNITY_SITE_ORIGIN
 0x03

	)

37 #ifde‡
USE_SRX


38 
	#ECOMMUNITY_BGPSEC_SUB
 0x00

	)

42 
	#ECOMMUNITY_FORMAT_ROUTE_MAP
 0

	)

43 
	#ECOMMUNITY_FORMAT_COMMUNITY_LIST
 1

	)

44 
	#ECOMMUNITY_FORMAT_DISPLAY
 2

	)

47 
	#ECOMMUNITY_SIZE
 8

	)

50 
	#ECOMMUNITY_FLAG_NON_TRANSITIVE
 0x40

	)

53 #ifde‡
USE_SRX


63 
	#ECOMMUNITY_BGPSEC_VALID
 0

	)

64 
	#ECOMMUNITY_BGPSEC_NOT_FOUND
 1

	)

65 
	#ECOMMUNITY_BGPSEC_INVALID
 2

	)

66 
	#ECOMMUNITY_BGPSEC_UNDEFINED
 3

	)

70 
	secommunôy


73 
	mªf˙t
;

76 
	msize
;

79 
u_öt8_t
 *
	mvÆ
;

82 *
	m°r
;

86 
	secommunôy_vÆ


88 
	mvÆ
[
ECOMMUNITY_SIZE
];

91 
	#ecom_Àngth
(
X
Ë((X)->
size
 * 
ECOMMUNITY_SIZE
)

	)

93 
ecommunôy_öô
 ();

94 
ecommunôy_föish
 ();

95 
ecommunôy_‰ì
 (
ecommunôy
 **);

96 
ecommunôy
 *
ecommunôy_∑r£
 (
u_öt8_t
 *, 
u_sh‹t
);

97 
ecommunôy
 *
ecommunôy_dup
 (ecommunity *);

98 
ecommunôy
 *
ecommunôy_mîge
 (ecommunity *, ecommunity *);

99 
ecommunôy
 *
ecommunôy_uniq_s‹t
 (ecommunity *);

100 
ecommunôy
 *
ecommunôy_öã∫
 (ecommunity *);

101 
ecommunôy_cmp
 (const *, const *);

102 
ecommunôy_unöã∫
 (
ecommunôy
 **);

103 
ecommunôy_hash_make
 (*);

104 
ecommunôy
 *
ecommunôy_°r2com
 (const *, , );

105 #ifde‡
USE_SRX


106 
ecommunôy
 *
ecommunôy_bgp£c_°r2com
(, );

108 *
ecommunôy_ecom2°r
 (
ecommunôy
 *, );

109 
ecommunôy_m©ch
 (c⁄° 
ecommunôy
 *, const ecommunity *);

110 *
ecommunôy_°r
 (
ecommunôy
 *);

	@bgpd/bgp_filter.h

21 #i‚de‡
_QUAGGA_BGP_FILTER_H


22 
	#_QUAGGA_BGP_FILTER_H


	)

24 
	eas_fûãr_ty≥


26 
	mAS_FILTER_DENY
,

27 
	mAS_FILTER_PERMIT


30 
bgp_fûãr_öô
 ();

31 
bgp_fûãr_ª£t
 ();

33 
as_fûãr_ty≥
 
as_li°_≠∂y
 (
as_li°
 *, *);

35 
as_li°
 *
as_li°_lookup
 (const *);

36 
as_li°_add_hook
 ((*
func
) ());

37 
	`as_li°_dñëe_hook
 ((*
func
) ());

	@bgpd/bgp_fsm.h

22 #i‚de‡
_QUAGGA_BGP_FSM_H


23 
	#_QUAGGA_BGP_FSM_H


	)

26 
	#BGP_READ_ON
(
T
,
F
,
V
) \

28 i‡(!(
T
Ë&& (
≥î
->
°©us
 !
Dñëed
)) \

29 
	`THREAD_READ_ON
(
ma°î
,
T
,
F
,
≥î
,
V
); \

30 } 0)

	)

32 
	#BGP_READ_OFF
(
T
) \

34 i‡(
T
) \

35 
	`THREAD_READ_OFF
(
T
); \

36 } 0)

	)

38 
	#BGP_WRITE_ON
(
T
,
F
,
V
) \

40 i‡(!(
T
Ë&& (
≥î
->
°©us
 !
Dñëed
)) \

41 
	`THREAD_WRITE_ON
(
ma°î
,(
T
),(
F
),
≥î
,(
V
)); \

42 } 0)

	)

44 
	#BGP_WRITE_OFF
(
T
) \

46 i‡(
T
) \

47 
	`THREAD_WRITE_OFF
(
T
); \

48 } 0)

	)

50 
	#BGP_TIMER_ON
(
T
,
F
,
V
) \

52 i‡(!(
T
Ë&& (
≥î
->
°©us
 !
Dñëed
)) \

53 
	`THREAD_TIMER_ON
(
ma°î
,(
T
),(
F
),
≥î
,(
V
)); \

54 } 0)

	)

56 
	#BGP_TIMER_OFF
(
T
) \

58 i‡(
T
) \

59 
	`THREAD_TIMER_OFF
(
T
); \

60 } 0)

	)

62 
	#BGP_EVENT_ADD
(
P
,
E
) \

64 i‡((
P
)->
°©us
 !
Dñëed
) \

65 
	`thªad_add_evít
 (
ma°î
, 
bgp_evít
, (
P
), (
E
)); \

66 } 0)

	)

68 
	#BGP_EVENT_FLUSH
(
P
) \

70 
	`as£π
 (
≥î
); \

71 
	`thªad_ˇn˚l_evít
 (
ma°î
, (
P
)); \

72 } 0)

	)

75 
bgp_evít
 (
thªad
 *);

76 
bgp_°›
 (
≥î
 *peer);

77 
bgp_timî_£t
 (
≥î
 *);

78 
bgp_fsm_ch™ge_°©us
 (
≥î
 *≥î, 
°©us
);

79 c⁄° *
≥î_down_°r
[];

	@bgpd/bgp_info_hash.h

32 
	~<zebø.h
>

34 #i‚de‡
_QUAGGA_BGP_INFO_HASH_H


35 
	#_QUAGGA_BGP_INFO_HASH_H


	)

37 #ifde‡
USE_SRX


39 
	~<uthash.h
>

41 
	sbgp_öfo_hash_ôem
 {

42 
uöt32_t
 
	midítifõr
;

43 
bgp_öfo
 *
	möfo
;

44 
UT_hash_h™dÀ
 
	mhh
;

47 
	sbgp_öfo_hash
 {

48 
bgp_öfo_hash_ôem
 *
	mèbÀ
;

53 
bgp_Æl_öfo_hashes_öô
 ();

56 
bgp_öfo_hash
* 
bgp_öfo_hash_öô
 ();

57 
bgp_öfo_hash_föish
 (
bgp_öfo_hash
 **);

61 
bgp_öfo_ªgi°î
 (
bgp_öfo_hash
 *, 
bgp_öfo
 *,

62 
uöt32_t
);

63 
bgp_öfo_uƒegi°î
 (
bgp_öfo_hash
 *, 
uöt32_t
);

64 
bgp_öfo
 * 
bgp_öfo_„tch
 (
bgp_öfo_hash
 *, 
uöt32_t
);

	@bgpd/bgp_mpath.h

24 #i‚de‡
_QUAGGA_BGP_MPATH_H


25 
	#_QUAGGA_BGP_MPATH_H


	)

28 
	#BGP_DEFAULT_MAXPATHS
 1

	)

33 
	sbgp_öfo_m∑th


36 
bgp_öfo_m∑th
 *
	mmp_√xt
;

39 
bgp_öfo_m∑th
 *
	mmp_¥ev
;

42 
bgp_öfo
 *
	mmp_öfo
;

45 
u_öt32_t
 
	mmp_cou¡
;

48 
©å
 *
	mmp_©å
;

52 
bgp_maximum_∑ths_£t
 (
bgp
 *, 
afi_t
, 
ßfi_t
, , 
u_öt16_t
);

53 
bgp_maximum_∑ths_un£t
 (
bgp
 *, 
afi_t
, 
ßfi_t
, );

58 
bgp_mp_li°_öô
 (
li°
 *);

59 
bgp_mp_li°_˛ór
 (
li°
 *);

60 
bgp_mp_li°_add
 (
li°
 *, 
bgp_öfo
 *);

61 
bgp_mp_dmed_de£À˘
 (
bgp_öfo
 *);

62 
bgp_öfo_m∑th_upd©e
 (
bgp_node
 *, 
bgp_öfo
 *,

63 
bgp_öfo
 *, 
li°
 *,

64 
bgp_max∑ths_cfg
 *);

65 
bgp_öfo_m∑th_aggªg©e_upd©e
 (
bgp_öfo
 *,

66 
bgp_öfo
 *);

69 
bgp_öfo_m∑th_dequeue
 (
bgp_öfo
 *);

70 
bgp_öfo_m∑th_‰ì
 (
bgp_öfo_m∑th
 **);

73 
bgp_öfo
 *
bgp_öfo_m∑th_fú°
 (bgp_info *);

74 
bgp_öfo
 *
bgp_öfo_m∑th_√xt
 (bgp_info *);

77 
u_öt32_t
 
bgp_öfo_m∑th_cou¡
 (
bgp_öfo
 *);

78 
©å
 *
bgp_öfo_m∑th_©å
 (
bgp_öfo
 *);

	@bgpd/bgp_mplsvpn.h

21 #i‚de‡
_QUAGGA_BGP_MPLSVPN_H


22 
	#_QUAGGA_BGP_MPLSVPN_H


	)

24 
	#RD_TYPE_AS
 0

	)

25 
	#RD_TYPE_IP
 1

	)

27 
	#RD_ADDRSTRLEN
 28

	)

29 
	srd_as


31 
u_öt16_t
 
	mty≥
;

32 
as_t
 
	mas
;

33 
u_öt32_t
 
	mvÆ
;

36 
	srd_ù


38 
u_öt16_t
 
	mty≥
;

39 
ö_addr
 
	mù
;

40 
u_öt16_t
 
	mvÆ
;

43 
bgp_m∂sv≤_öô
 ();

44 
bgp_∆ri_∑r£_v≤v4
 (
≥î
 *, 
©å
 *, 
bgp_∆ri
 *);

45 
u_öt32_t
 
decode_œbñ
 (
u_ch¨
 *);

46 
°r2¥efix_rd
 (c⁄° *, 
¥efix_rd
 *);

47 
°r2èg
 (c⁄° *, 
u_ch¨
 *);

48 *
¥efix_rd2°r
 (
¥efix_rd
 *, *, 
size_t
);

	@bgpd/bgp_network.h

21 #i‚de‡
_QUAGGA_BGP_NETWORK_H


22 
	#_QUAGGA_BGP_NETWORK_H


	)

24 
bgp_sockë
 (, const *);

25 
bgp_˛o£
 ();

26 
bgp_c⁄√˘
 (
≥î
 *);

27 
bgp_gësock«me
 (
≥î
 *);

29 
bgp_md5_£t
 (
≥î
 *);

	@bgpd/bgp_nexthop.h

21 #i‚de‡
_QUAGGA_BGP_NEXTHOP_H


22 
	#_QUAGGA_BGP_NEXTHOP_H


	)

24 
	~"if.h
"

26 
	#BGP_SCAN_INTERVAL_DEFAULT
 60

	)

27 
	#BGP_IMPORT_INTERVAL_DEFAULT
 15

	)

30 
	sbgp_√xth›_ˇche


33 
u_ch¨
 
	mvÆid
;

36 
u_ch¨
 
	mch™ged
;

39 
u_ch¨
 
	mmëricch™ged
;

42 
u_öt32_t
 
	mmëric
;

45 
u_ch¨
 
	m√xth›_num
;

46 
√xth›
 *
	m√xth›
;

49 
bgp_sˇn_öô
 ();

50 
bgp_sˇn_föish
 ();

51 
bgp_√xth›_lookup
 (
afi_t
, 
≥î
 *≥î, 
bgp_öfo
 *,

53 
bgp_c⁄√˘ed_add
 (
c⁄√˘ed
 *
c
);

54 
bgp_c⁄√˘ed_dñëe
 (
c⁄√˘ed
 *
c
);

55 
bgp_mu…üc˚ss_check_v4
 (
ö_addr
, *);

56 
bgp_c⁄fig_wrôe_sˇn_time
 (
vty
 *);

57 
bgp_√xth›_⁄lök
 (
afi_t
, 
©å
 *);

58 
bgp_√xth›_£lf
 (
©å
 *);

59 
bgp_addªss_öô
 ();

	@bgpd/bgp_open.h

21 #i‚de‡
_QUAGGA_BGP_OPEN_H


22 
	#_QUAGGA_BGP_OPEN_H


	)

25 
	sˇ∑bûôy_hódî


27 
u_ch¨
 
	mcode
;

28 
u_ch¨
 
	mÀngth
;

32 
	sˇ∑bûôy_mp_d©a


34 
afi_t
 
	mafi
;

35 
u_ch¨
 
	mª£rved
;

36 
ßfi_t
 
	mßfi
;

39 #¥agm®
∑ck
(1)

40 
	sˇ∑bûôy_‹f_íåy


42 
ˇ∑bûôy_mp_d©a
 
	mmpc
;

43 
u_ch¨
 
	mnum
;

45 
u_ch¨
 
	mty≥
;

46 
u_ch¨
 
	mmode
;

47 } 
	m‹fs
[];

48 } 
__©åibuã__
 ((
∑cked
));

49 #¥agm®
∑ck
()

51 
	sˇ∑bûôy_as4


53 
uöt32_t
 
	mas4
;

56 #ifde‡
USE_SRX


58 
	sBgp£cC≠VÆ


60 
uöt8_t
 
	mvîsi⁄_dú
;

61 
	#BGPSEC_CAP_VERSION
 (0 << 4Ë

	)

62 
	#BGPSEC_CAP_DIR_RECV
 (0 << 3)

	)

63 
	#BGPSEC_CAP_DIR_SEND
 (1 << 3)

	)

66 
uöt16_t
 
	mafi
;

67 
	#BGPSEC_CAP_AFI_IPv4
 1

	)

68 
	#BGPSEC_CAP_AFI_IPv6
 2

	)

72 
	sgø˚ful_ª°¨t_af


74 
afi_t
 
	mafi
;

75 
ßfi_t
 
	mßfi
;

76 
u_ch¨
 
	mÊag
;

79 
	sˇ∑bûôy_gr


81 
u_öt16_t
 
	mª°¨t_Êag_time
;

82 
gø˚ful_ª°¨t_af
 
	mgr
[];

86 
	#CAPABILITY_CODE_MP
 1

	)

87 
	#CAPABILITY_CODE_REFRESH
 2

	)

88 
	#CAPABILITY_CODE_ORF
 3

	)

89 #ifde‡
USE_SRX


90 
	#CAPABILITY_CODE_EXTENDED
 6

	)

92 
	#CAPABILITY_CODE_RESTART
 64

	)

93 
	#CAPABILITY_CODE_AS4
 65

	)

94 
	#CAPABILITY_CODE_DYNAMIC
 66

	)

95 
	#CAPABILITY_CODE_REFRESH_OLD
 128

	)

96 
	#CAPABILITY_CODE_ORF_OLD
 130

	)

97 #i‡
deföed
(
USE_SRX
Ë&& !deföed(
CAPABILITY_CODE_BGPSEC
)

98 
	#CAPABILITY_CODE_BGPSEC
 7

	)

102 
	#CAPABILITY_CODE_MP_LEN
 4

	)

103 
	#CAPABILITY_CODE_REFRESH_LEN
 0

	)

104 
	#CAPABILITY_CODE_DYNAMIC_LEN
 0

	)

105 
	#CAPABILITY_CODE_RESTART_LEN
 2

	)

106 
	#CAPABILITY_CODE_AS4_LEN
 4

	)

107 #ifde‡
USE_SRX


108 
	#CAPABILITY_CODE_BGPSEC_LEN
 3

	)

109 
	#CAPABILITY_CODE_EXTENDED_LEN
 0

	)

115 
	#ORF_TYPE_PREFIX
 64

	)

116 
	#ORF_TYPE_PREFIX_OLD
 128

	)

119 
	#ORF_MODE_RECEIVE
 1

	)

120 
	#ORF_MODE_SEND
 2

	)

121 
	#ORF_MODE_BOTH
 3

	)

124 
	#CAPABILITY_ACTION_SET
 0

	)

125 
	#CAPABILITY_ACTION_UNSET
 1

	)

128 
	#RESTART_R_BIT
 0x8000

	)

129 
	#RESTART_F_BIT
 0x80

	)

131 
bgp_›í_›ti⁄_∑r£
 (
≥î
 *, 
u_ch¨
, *);

132 
bgp_›í_ˇ∑bûôy
 (
°ªam
 *, 
≥î
 *);

133 
bgp_ˇ∑bûôy_vty_out
 (
vty
 *, 
≥î
 *);

134 
as_t
 
≥ek_f‹_as4_ˇ∑bûôy
 (
≥î
 *, 
u_ch¨
);

135 
bgp_afi_ßfi_vÆid_ödi˚s
 (
afi_t
, 
ßfi_t
 *);

136 
makeBgp£cC≠abûôy
(
°ªam
* 
s
, 
uöt8_t
 
vîsi⁄
, uöt8_à
dú
, 
uöt16_t
 
afi
);

	@bgpd/bgp_packet.h

21 #i‚de‡
_QUAGGA_BGP_PACKET_H


22 
	#_QUAGGA_BGP_PACKET_H


	)

24 
	#BGP_NLRI_LENGTH
 1U

	)

25 
	#BGP_TOTAL_ATTR_LEN
 2U

	)

26 
	#BGP_UNFEASIBLE_LEN
 2U

	)

27 
	#BGP_WRITE_PACKET_MAX
 10U

	)

30 
	#REFRESH_IMMEDIATE
 1

	)

31 
	#REFRESH_DEFER
 2

	)

34 
	#ORF_COMMON_PART_ADD
 0x00

	)

35 
	#ORF_COMMON_PART_REMOVE
 0x80

	)

36 
	#ORF_COMMON_PART_REMOVE_ALL
 0xC0

	)

37 
	#ORF_COMMON_PART_PERMIT
 0x00

	)

38 
	#ORF_COMMON_PART_DENY
 0x20

	)

41 
bgp_ªad
 (
thªad
 *);

42 #ifde‡
USE_SRX


43 
bgp_ªad2
 (
thªad
 *);

44 
ecommunôy
* 
§xEcommunôyCh™ge
(
bgp
 *, 
©å
 *, 
bgp_öfo
 *);

45 
§xEcommunôyRe°‹e
(
©å
 *, 
ecommunôy
* );

47 
bgp_wrôe
 (
thªad
 *);

49 
bgp_kì∑live_£nd
 (
≥î
 *);

50 
bgp_›í_£nd
 (
≥î
 *);

51 
bgp_nŸify_£nd
 (
≥î
 *, 
u_öt8_t
, u_int8_t);

52 
bgp_nŸify_£nd_wôh_d©a
 (
≥î
 *, 
u_öt8_t
, u_int8_t,

53 
u_öt8_t
 *, 
size_t
);

54 
bgp_rouã_ª‰esh_£nd
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_ch¨
, u_char, );

55 
bgp_ˇ∑bûôy_£nd
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , );

56 
bgp_deÁu…_upd©e_£nd
 (
≥î
 *, 
©å
 *,

57 
afi_t
, 
ßfi_t
, 
≥î
 *);

58 
bgp_deÁu…_wôhdøw_£nd
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

60 
bgp_ˇ∑bûôy_ª˚ive
 (
≥î
 *, 
bgp_size_t
);

	@bgpd/bgp_regex.h

21 #i‚de‡
_QUAGGA_BGP_REGEX_H


22 
	#_QUAGGA_BGP_REGEX_H


	)

24 
	~<zebø.h
>

26 #ifde‡
HAVE_LIBPCREPOSIX


27 
	~<p¸ïosix.h
>

29 #ifde‡
HAVE_GNU_REGEX


30 
	~<ªgex.h
>

32 
	~"ªgex-gnu.h
"

36 
bgp_ªgex_‰ì
 (
ªgex_t
 *
ªgex
);

37 
ªgex_t
 *
bgp_ªgcomp
 (c⁄° *
°r
);

38 
bgp_ªgexec
 (
ªgex_t
 *
ªgex
, 
a•©h
 *aspath);

	@bgpd/bgp_route.h

21 #i‚de‡
_QUAGGA_BGP_ROUTE_H


22 
	#_QUAGGA_BGP_ROUTE_H


	)

24 
	~"bgp_èbÀ.h
"

25 #ifde‡
USE_SRX


26 
	~"bgp_öfo_hash.h
"

27 
	~<§x/§x_≠i.h
>

34 
	sbgp_öfo_exåa


37 
bgp_damp_öfo
 *
	mdamp_öfo
;

40 
	msuµªss
;

43 
u_öt32_t
 
	migpmëric
;

46 
u_ch¨
 
	mèg
[3];

49 
	sbgp_öfo


52 
bgp_öfo
 *
	m√xt
;

53 
bgp_öfo
 *
	m¥ev
;

56 
≥î
 *
	m≥î
;

59 
©å
 *
	m©å
;

62 
bgp_öfo_exåa
 *
	mexåa
;

66 
bgp_öfo_m∑th
 *
	mm∑th
;

69 
time_t
 
	mu±ime
;

72 
	mlock
;

75 
u_öt16_t
 
	mÊags
;

76 
	#BGP_INFO_IGP_CHANGED
 (1 << 0)

	)

77 
	#BGP_INFO_DAMPED
 (1 << 1)

	)

78 
	#BGP_INFO_HISTORY
 (1 << 2)

	)

79 
	#BGP_INFO_SELECTED
 (1 << 3)

	)

80 
	#BGP_INFO_VALID
 (1 << 4)

	)

81 
	#BGP_INFO_ATTR_CHANGED
 (1 << 5)

	)

82 
	#BGP_INFO_DMED_CHECK
 (1 << 6)

	)

83 
	#BGP_INFO_DMED_SELECTED
 (1 << 7)

	)

84 
	#BGP_INFO_STALE
 (1 << 8)

	)

85 
	#BGP_INFO_REMOVED
 (1 << 9)

	)

86 
	#BGP_INFO_COUNTED
 (1 << 10)

	)

87 
	#BGP_INFO_MULTIPATH
 (1 << 11)

	)

88 
	#BGP_INFO_MULTIPATH_CHG
 (1 << 12)

	)

89 #ifde‡
USE_SRX


90 
	#BGP_INFO_IGNORE
 (1 << 13)

	)

94 
u_ch¨
 
	mty≥
;

98 
u_ch¨
 
	msub_ty≥
;

99 
	#BGP_ROUTE_NORMAL
 0

	)

100 
	#BGP_ROUTE_STATIC
 1

	)

101 
	#BGP_ROUTE_AGGREGATE
 2

	)

102 
	#BGP_ROUTE_REDISTRIBUTE
 3

	)

104 #ifde‡
USE_SRX


105 
bgp_node
 *
	mnode
;

107 
bgp_öfo_hash
 *
	möfo_hash
;

108 
SRxUpd©eID
 
	mupd©eID
;

109 
uöt32_t
 
	mloˇlID
;

110 
SRxVÆid©i⁄Resu…VÆ
 
	mvÆ_ªs_ROA
;

111 
SRxVÆid©i⁄Resu…VÆ
 
	mvÆ_ªs_BGPSEC
;

116 
	sbgp_°©ic


119 
	mbackdo‹
;

122 
u_ch¨
 
	mvÆid
;

125 
u_öt32_t
 
	migpmëric
;

128 
ö_addr
 
	mig≤exth›
;

131 
u_öt32_t
 
	m©omic
;

136 *
	m«me
;

137 
rouã_m≠
 *
	mm≠
;

138 } 
	mrm≠
;

141 
u_ch¨
 
	mèg
[3];

144 #ifde‡
USE_SRX


146 
	sSRxThªad


148 
	msock
;

149 
thªad
 *
	mt_ªad
;

150 * 
	m˛c⁄√˘i⁄H™dÀr
;

151 
	m˛õ¡FD
;

152 
	m¥evClõ¡FD
;

153 * 
	m¥oxy
;

158 
SRxThªad
 *
	gg_rq
;

165 * 
	gÊagDoC⁄√˘Srx
;

168 
	#BGP_INFO_UNUSEABLE
 \

169 (
BGP_INFO_HISTORY
|
BGP_INFO_DAMPED
|
BGP_INFO_REMOVED
|
BGP_INFO_IGNORE
)

	)

174 
	#BGP_INFO_UNUSEABLE
 \

175 (
BGP_INFO_HISTORY
|
BGP_INFO_DAMPED
|
BGP_INFO_REMOVED
)

	)

183 
	#BGP_INFO_HOLDDOWN
(
BI
) \

184 (! 
	`CHECK_FLAG
 ((
BI
)->
Êags
, 
BGP_INFO_VALID
) \

185 || 
	`CHECK_FLAG
 ((
BI
)->
Êags
, 
BGP_INFO_UNUSEABLE
))

	)

187 
	#DISTRIBUTE_IN_NAME
(
F
Ë((F)->
dli°
[
FILTER_IN
].
«me
)

	)

188 
	#DISTRIBUTE_IN
(
F
Ë((F)->
dli°
[
FILTER_IN
].
Æi°
)

	)

189 
	#DISTRIBUTE_OUT_NAME
(
F
Ë((F)->
dli°
[
FILTER_OUT
].
«me
)

	)

190 
	#DISTRIBUTE_OUT
(
F
Ë((F)->
dli°
[
FILTER_OUT
].
Æi°
)

	)

192 
	#PREFIX_LIST_IN_NAME
(
F
Ë((F)->
∂i°
[
FILTER_IN
].
«me
)

	)

193 
	#PREFIX_LIST_IN
(
F
Ë((F)->
∂i°
[
FILTER_IN
].∂i°)

	)

194 
	#PREFIX_LIST_OUT_NAME
(
F
Ë((F)->
∂i°
[
FILTER_OUT
].
«me
)

	)

195 
	#PREFIX_LIST_OUT
(
F
Ë((F)->
∂i°
[
FILTER_OUT
].∂i°)

	)

197 
	#FILTER_LIST_IN_NAME
(
F
Ë((F)->
a¶i°
[
FILTER_IN
].
«me
)

	)

198 
	#FILTER_LIST_IN
(
F
Ë((F)->
a¶i°
[
FILTER_IN
].a¶i°)

	)

199 
	#FILTER_LIST_OUT_NAME
(
F
Ë((F)->
a¶i°
[
FILTER_OUT
].
«me
)

	)

200 
	#FILTER_LIST_OUT
(
F
Ë((F)->
a¶i°
[
FILTER_OUT
].a¶i°)

	)

202 
	#ROUTE_MAP_IN_NAME
(
F
Ë((F)->
m≠
[
RMAP_IN
].
«me
)

	)

203 
	#ROUTE_MAP_IN
(
F
Ë((F)->
m≠
[
RMAP_IN
].m≠)

	)

204 
	#ROUTE_MAP_OUT_NAME
(
F
Ë((F)->
m≠
[
RMAP_OUT
].
«me
)

	)

205 
	#ROUTE_MAP_OUT
(
F
Ë((F)->
m≠
[
RMAP_OUT
].m≠)

	)

207 
	#ROUTE_MAP_IMPORT_NAME
(
F
Ë((F)->
m≠
[
RMAP_IMPORT
].
«me
)

	)

208 
	#ROUTE_MAP_IMPORT
(
F
Ë((F)->
m≠
[
RMAP_IMPORT
].m≠)

	)

209 
	#ROUTE_MAP_EXPORT_NAME
(
F
Ë((F)->
m≠
[
RMAP_EXPORT
].
«me
)

	)

210 
	#ROUTE_MAP_EXPORT
(
F
Ë((F)->
m≠
[
RMAP_EXPORT
].m≠)

	)

212 
	#UNSUPPRESS_MAP_NAME
(
F
Ë((F)->
usm≠
.
«me
)

	)

213 
	#UNSUPPRESS_MAP
(
F
Ë((F)->
usm≠
.
m≠
)

	)

215 
	ebgp_˛ór_rouã_ty≥


217 
	mBGP_CLEAR_ROUTE_NORMAL
,

218 
	mBGP_CLEAR_ROUTE_MY_RSCLIENT


222 
bgp_rouã_öô
 ();

223 
bgp_rouã_föish
 ();

224 
bgp_˛ónup_rouãs
 ();

225 
bgp_™noun˚_rouã
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

226 
bgp_™noun˚_rouã_Æl
 (
≥î
 *);

227 
bgp_deÁu…_‹igö©e
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

228 
bgp_so·_ªc⁄fig_ö
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

229 
bgp_so·_ªc⁄fig_rs˛õ¡
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

230 
bgp_check_loˇl_rouãs_rs˛õ¡
 (
≥î
 *
rs˛õ¡
, 
afi_t
 
afi
, 
ßfi_t
 
ßfi
);

231 
bgp_˛ór_rouã
 (
≥î
 *, 
afi_t
, 
ßfi_t
,

232 
bgp_˛ór_rouã_ty≥
);

233 
bgp_˛ór_rouã_Æl
 (
≥î
 *);

234 
bgp_˛ór_adj_ö
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

235 
bgp_˛ór_°Æe_rouã
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

237 
bgp_öfo
 *
bgp_öfo_lock
 (bgp_info *);

238 
bgp_öfo
 *
bgp_öfo_u∆ock
 (bgp_info *);

239 
bgp_öfo_add
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
);

240 
bgp_öfo_dñëe
 (
bgp_node
 *
∫
, 
bgp_öfo
 *
ri
);

241 
bgp_öfo_exåa
 *
bgp_öfo_exåa_gë
 (
bgp_öfo
 *);

242 
bgp_öfo_£t_Êag
 (
bgp_node
 *, 
bgp_öfo
 *, 
u_öt32_t
);

243 
bgp_öfo_un£t_Êag
 (
bgp_node
 *, 
bgp_öfo
 *, 
u_öt32_t
);

244 #ifde‡
USE_SRX


245 
bgp_öfo_£t_ign‹e_Êag
(
bgp_öfo
 *);

246 
§x_bgp_ªqueue_upd©e
(
bgp_öfo
 *);

247 
§x_bgp_ªqueue_Æl
(
bgp
 *);

248 
bgp_öfo_£t_vÆid©i⁄_ªsu…
 (
bgp_öfo
 *,

249 
VÆid©i⁄Resu…Ty≥
 
ªsTy≥
,

250 
uöt8_t
 
rﬂResu…
, uöt8_à
bgp£cResu…
);

251 
vîify_upd©e
 (
bgp
 *bgp, 
bgp_öfo
 *
öfo
,

252 
SRxDeÁu…Resu…
* 
defResu…
, 
boﬁ
 
doRegi°îLoˇlID
);

253 
§x_ˇlc_vÆid©i⁄_°©e
(
bgp
 *, 
bgp_öfo
 *);

254 
SRxThªad
* 
§x_thªad_¨g_√w
();

255 
checkClõ¡C⁄√˘i⁄
(
thªad
 *
t
);

256 
öôUnSockë
(
thªad
 *
t
);

257 
checkSídQueue
(
thªad
 *
t
);

258 
thªadC⁄åﬁCÆl
(
ty≥
);

259 
§x_£t_deÁu…
(
bgp
 *bgp);

260 
checkEcomSRxVÆid
(
©å
*áttr);

261 
uöt32_t
 
gëNextLoˇlID
();

265 
bgp_∆ri_ßnôy_check
 (
≥î
 *, , 
u_ch¨
 *, 
bgp_size_t
);

266 
bgp_∆ri_∑r£
 (
≥î
 *, 
©å
 *, 
bgp_∆ri
 *);

268 
bgp_maximum_¥efix_ovîÊow
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

270 
bgp_ªdi°ribuã_add
 (
¥efix
 *, c⁄° 
ö_addr
 *,

271 c⁄° 
ö6_addr
 *,

272 
u_öt32_t
, 
u_ch¨
);

273 
bgp_ªdi°ribuã_dñëe
 (
¥efix
 *, 
u_ch¨
);

274 
bgp_ªdi°ribuã_wôhdøw
 (
bgp
 *, 
afi_t
, );

276 
bgp_°©ic_dñëe
 (
bgp
 *);

277 
bgp_°©ic_upd©e
 (
bgp
 *, 
¥efix
 *, 
bgp_°©ic
 *,

278 
afi_t
, 
ßfi_t
);

279 
bgp_°©ic_wôhdøw
 (
bgp
 *, 
¥efix
 *, 
afi_t
, 
ßfi_t
);

281 
bgp_°©ic_£t_v≤v4
 (
vty
 *vty, const *,

284 
bgp_°©ic_un£t_v≤v4
 (
vty
 *, const *,

288 
bgp_upd©e
 (
≥î
 *, 
¥efix
 *, 
©å
 *,

289 
afi_t
, 
ßfi_t
, , , 
¥efix_rd
 *,

290 
u_ch¨
 *, );

291 
bgp_wôhdøw
 (
≥î
 *, 
¥efix
 *, 
©å
 *,

292 
afi_t
, 
ßfi_t
, , , 
¥efix_rd
 *, 
u_ch¨
 *);

295 
bgp_¥o˚ss
 (
bgp
 *, 
bgp_node
 *, 
afi_t
, 
ßfi_t
);

296 
bgp_c⁄fig_wrôe_√tw‹k
 (
vty
 *, 
bgp
 *, 
afi_t
, 
ßfi_t
, *);

297 
bgp_c⁄fig_wrôe_di°™˚
 (
vty
 *, 
bgp
 *);

299 
bgp_aggªg©e_ö¸emít
 (
bgp
 *, 
¥efix
 *, 
bgp_öfo
 *,

300 
afi_t
, 
ßfi_t
);

301 
bgp_aggªg©e_de¸emít
 (
bgp
 *, 
¥efix
 *, 
bgp_öfo
 *,

302 
afi_t
, 
ßfi_t
);

304 
u_ch¨
 
bgp_di°™˚_≠∂y
 (
¥efix
 *, 
bgp_öfo
 *, 
bgp
 *);

306 
afi_t
 
bgp_node_afi
 (
vty
 *);

307 
ßfi_t
 
bgp_node_ßfi
 (
vty
 *);

309 
rouã_vty_out
 (
vty
 *, 
¥efix
 *, 
bgp_öfo
 *, , 
ßfi_t
);

310 
rouã_vty_out_èg
 (
vty
 *, 
¥efix
 *, 
bgp_öfo
 *, , 
ßfi_t
);

311 
rouã_vty_out_tmp
 (
vty
 *, 
¥efix
 *, 
©å
 *, 
ßfi_t
);

	@bgpd/bgp_snmp.h

21 #i‚de‡
_QUAGGA_BGP_SNMP_H


22 
	#_QUAGGA_BGP_SNMP_H


	)

24 
bgp_¢mp_öô
 ();

25 
bgpTøpE°ablished
 (
≥î
 *);

26 
bgpTøpBackw¨dTønsôi⁄
 (
≥î
 *);

	@bgpd/bgp_table.h

21 #i‚de‡
_QUAGGA_BGP_TABLE_H


22 
	#_QUAGGA_BGP_TABLE_H


	)

24 
	~"èbÀ.h
"

28 
	mBGP_TABLE_MAIN
,

29 
	mBGP_TABLE_RSCLIENT
,

30 } 
	tbgp_èbÀ_t
;

32 
	sbgp_èbÀ


34 
bgp_èbÀ_t
 
	mty≥
;

37 
afi_t
 
	mafi
;

38 
ßfi_t
 
	mßfi
;

40 
	mlock
;

43 
≥î
 *
	mow√r
;

45 
rouã_èbÀ
 *
	mrouã_èbÀ
;

48 
	sbgp_node


58 
	mROUTE_NODE_FIELDS
;

60 
bgp_adj_out
 *
	madj_out
;

62 
bgp_adj_ö
 *
	madj_ö
;

64 
bgp_node
 *
	m¥n
;

66 
u_ch¨
 
	mÊags
;

67 
	#BGP_NODE_PROCESS_SCHEDULED
 (1 << 0)

	)

75 
	sbgp_èbÀ_ôî_t_


77 
bgp_èbÀ
 *
	mèbÀ
;

78 
rouã_èbÀ_ôî_t
 
	mπ_ôî
;

79 } 
	tbgp_èbÀ_ôî_t
;

81 
bgp_èbÀ
 *
bgp_èbÀ_öô
 (
afi_t
, 
ßfi_t
);

82 
bgp_èbÀ_lock
 (
bgp_èbÀ
 *);

83 
bgp_èbÀ_u∆ock
 (
bgp_èbÀ
 *);

84 
bgp_èbÀ_föish
 (
bgp_èbÀ
 **);

92 
ölöe
 
bgp_node
 *

93 
	$bgp_node_‰om_∫ode
 (
rouã_node
 *
∫ode
)

95  (
bgp_node
 *Ë
∫ode
;

96 
	}
}

103 
ölöe
 
rouã_node
 *

104 
	$bgp_node_to_∫ode
 (
bgp_node
 *
node
)

106  (
rouã_node
 *Ë
node
;

107 
	}
}

114 
ölöe
 
bgp_èbÀ
 *

115 
	$bgp_node_èbÀ
 (
bgp_node
 *
node
)

117  
	`bgp_node_to_∫ode
 (
node
)->
èbÀ
->
öfo
;

118 
	}
}

125 
ölöe
 *

126 
	$bgp_node_öfo
 (c⁄° 
bgp_node
 *
node
)

128  
node
->
öfo
;

129 
	}
}

134 
ölöe
 

135 
	$bgp_node_£t_öfo
 (
bgp_node
 *
node
, *
öfo
)

137 
node
->
öfo
 = info;

138 
	}
}

143 
ölöe
 
¥efix
 *

144 
	$bgp_node_¥efix
 (
bgp_node
 *
node
)

146  &
node
->
p
;

147 
	}
}

152 
ölöe
 
u_ch¨


153 
	$bgp_node_¥efixÀn
 (
bgp_node
 *
node
)

155  
	`bgp_node_¥efix
 (
node
)->
¥efixÀn
;

156 
	}
}

163 
ölöe
 
bgp_node
 *

164 
	$bgp_node_∑ª¡_nﬁock
 (
bgp_node
 *
node
)

166  
	`bgp_node_‰om_∫ode
 (
node
->
∑ª¡
);

167 
	}
}

172 
ölöe
 

173 
	$bgp_u∆ock_node
 (
bgp_node
 *
node
)

175 
	`rouã_u∆ock_node
 (
	`bgp_node_to_∫ode
 (
node
));

176 
	}
}

185 
ölöe
 
bgp_node
 *

186 
	$bgp_èbÀ_t›_nﬁock
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
)

188  
	`bgp_node_‰om_∫ode
 (
èbÀ
->
rouã_èbÀ
->
t›
);

189 
	}
}

194 
ölöe
 
bgp_node
 *

195 
	$bgp_èbÀ_t›
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
)

197  
	`bgp_node_‰om_∫ode
 (
	`rouã_t›
 (
èbÀ
->
rouã_èbÀ
));

198 
	}
}

203 
ölöe
 
bgp_node
 *

204 
	$bgp_rouã_√xt
 (
bgp_node
 *
node
)

206  
	`bgp_node_‰om_∫ode
 (
	`rouã_√xt
 (
	`bgp_node_to_∫ode
 (
node
)));

207 
	}
}

212 
ölöe
 
bgp_node
 *

213 
	$bgp_rouã_√xt_u¡û
 (
bgp_node
 *
node
, bgp_nodê*
limô
)

215 
rouã_node
 *
∫ode
;

217 
∫ode
 = 
	`rouã_√xt_u¡û
 (
	`bgp_node_to_∫ode
 (
node
),

218 
	`bgp_node_to_∫ode
 (
limô
));

219  
	`bgp_node_‰om_∫ode
 (
∫ode
);

220 
	}
}

225 
ölöe
 
bgp_node
 *

226 
	$bgp_node_gë
 (
bgp_èbÀ
 *c⁄° 
èbÀ
, 
¥efix
 *
p
)

228  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_gë
 (
èbÀ
->
rouã_èbÀ
, 
p
));

229 
	}
}

234 
ölöe
 
bgp_node
 *

235 
	$bgp_node_lookup
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
, 
¥efix
 *
p
)

237  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_lookup
 (
èbÀ
->
rouã_èbÀ
, 
p
));

238 
	}
}

243 
ölöe
 
bgp_node
 *

244 
	$bgp_lock_node
 (
bgp_node
 *
node
)

246  
	`bgp_node_‰om_∫ode
 (
	`rouã_lock_node
 (
	`bgp_node_to_∫ode
 (
node
)));

247 
	}
}

252 
ölöe
 
bgp_node
 *

253 
	$bgp_node_m©ch
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
¥efix
 *
p
)

255  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_m©ch
 (
èbÀ
->
rouã_èbÀ
, 
p
));

256 
	}
}

261 
ölöe
 
bgp_node
 *

262 
	$bgp_node_m©ch_ùv4
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
ö_addr
 *
addr
)

264  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_m©ch_ùv4
 (
èbÀ
->
rouã_èbÀ
,

265 
addr
));

266 
	}
}

268 #ifde‡
HAVE_IPV6


273 
ölöe
 
bgp_node
 *

274 
	$bgp_node_m©ch_ùv6
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
ö6_addr
 *
addr
)

276  
	`bgp_node_‰om_∫ode
 (
	`rouã_node_m©ch_ùv6
 (
èbÀ
->
rouã_èbÀ
,

277 
addr
));

278 
	}
}

282 
ölöe
 

283 
	$bgp_èbÀ_cou¡
 (c⁄° 
bgp_èbÀ
 *c⁄° 
èbÀ
)

285  
	`rouã_èbÀ_cou¡
 (
èbÀ
->
rouã_èbÀ
);

286 
	}
}

291 
ölöe
 
bgp_node
 *

292 
	$bgp_èbÀ_gë_√xt
 (c⁄° 
bgp_èbÀ
 *
èbÀ
, 
¥efix
 *
p
)

294  
	`bgp_node_‰om_∫ode
 (
	`rouã_èbÀ_gë_√xt
 (
èbÀ
->
rouã_èbÀ
, 
p
));

295 
	}
}

300 
ölöe
 

301 
	$bgp_èbÀ_ôî_öô
 (
bgp_èbÀ_ôî_t
 * 
ôî
, 
bgp_èbÀ
 *
èbÀ
)

303 
	`bgp_èbÀ_lock
 (
èbÀ
);

304 
ôî
->
èbÀ
 =Åable;

305 
	`rouã_èbÀ_ôî_öô
 (&
ôî
->
π_ôî
, 
èbÀ
->
rouã_èbÀ
);

306 
	}
}

311 
ölöe
 
bgp_node
 *

312 
	$bgp_èbÀ_ôî_√xt
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

314  
	`bgp_node_‰om_∫ode
 (
	`rouã_èbÀ_ôî_√xt
 (&
ôî
->
π_ôî
));

315 
	}
}

320 
ölöe
 

321 
	$bgp_èbÀ_ôî_˛ónup
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

323 
	`rouã_èbÀ_ôî_˛ónup
 (&
ôî
->
π_ôî
);

324 
	`bgp_èbÀ_u∆ock
 (
ôî
->
èbÀ
);

325 
ôî
->
èbÀ
 = 
NULL
;

326 
	}
}

331 
ölöe
 

332 
	$bgp_èbÀ_ôî_∑u£
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

334 
	`rouã_èbÀ_ôî_∑u£
 (&
ôî
->
π_ôî
);

335 
	}
}

340 
ölöe
 

341 
	$bgp_èbÀ_ôî_is_d⁄e
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

343  
	`rouã_èbÀ_ôî_is_d⁄e
 (&
ôî
->
π_ôî
);

344 
	}
}

349 
ölöe
 

350 
	$bgp_èbÀ_ôî_°¨ãd
 (
bgp_èbÀ_ôî_t
 * 
ôî
)

352  
	`rouã_èbÀ_ôî_°¨ãd
 (&
ôî
->
π_ôî
);

353 
	}
}

	@bgpd/bgp_validate.h

35 #i‚de‡
_QUAGGA_BGP_VALIDATE_H


36 
	#_QUAGGA_BGP_VALIDATE_H


	)

38 #ifde‡
USE_SRX


40 
	#BGPSEC_SKI_LENGTH
 20

	)

41 
	#BGPSEC_ALGO_ID
 1

	)

42 
	#BGPSEC_ALGO_ID_LENGTH
 1

	)

43 
	#BGPSEC_MAX_SIG_LENGTH
 128

	)

44 
	#BGPSEC_AFI_LENGTH
 1

	)

45 
	#BGPSEC_MAX_INFO_ATTR_LENGTH
 0

	)

48 
	#BGPSEC_SUCCESS
 0

	)

49 
	#BGPSEC_FAILURE
 -1

	)

51 
	#BGPSEC_ALGORITHM_SHA256_ECDSA_P_256
 1

	)

52 
	#BGPSEC_OPENSSL_ID_SHA256_ECDSA_P_256
 
NID_X9_62_¥ime256v1


	)

53 
	#BGPSEC_DEFAULT_CURVE
 
BGPSEC_ALGORITHM_SHA256_ECDSA_P_256


	)

56 
	#BGPSEC_VERIFY_ERROR
 -1

	)

57 
	#BGPSEC_VERIFY_INVALID
 0

	)

58 
	#BGPSEC_VERIFY_SUCCESS
 1

	)

60 
	#BGPSEC_MAX_SIGBLOCK
 2

	)

62 
	#OCTET_SECURE_PATH_SEGMENT
 6

	)

63 
	#OCTET_SECURE_PATH_LEN
 2

	)

64 
	#OCTET_ALGORITHM_ID
 1

	)

65 
	#OCTET_SIG_BLOCK_LEN
 2

	)

66 
	#OCTET_SIGNATURE_LEN
 2

	)

69 
	sP©hSegmít


71 
P©hSegmít
 *
	m√xt
;

72 
u_öt32_t
 
	mas
;

73 
u_öt8_t
 
	mpCou¡
;

74 
u_öt8_t
 
	mÊags
;

75 
	mªf˙t
;

78 
	sSigSegmít


80 
SigSegmít
 *
	m√xt
;

81 
u_ch¨
 *
	mski
;

82 
u_öt16_t
 
	msigLí
;

83 
u_ch¨
 *
	msig«tuª
;

84 
	mªf˙t
;

87 
	sSigBlock


89 
SigBlock
 *
	m√xt
;

90 
u_öt16_t
 
	msigBlockLí
;

91 
u_öt8_t
 
	mÆgoSuôeId
;

92 
SigSegmít
 *
	msigSegmíts
;

93 
	mªf˙t
;

97 
	sBgp£cP©hAâr


99 
size_t
 
	m£cuªP©hLí
;

102 
P©hSegmít
 *
	m∑thSegmíts
;

103 
SigBlock
 *
	msigBlocks
;

106 
	mªf˙t
;

111 
	sBgp£cPdu


113 
size_t
 
	mÀn_SecuªP©h
;

114 
u_öt8_t
 
	mpCou¡
;

115 
u_öt8_t
 
	mÊags
;

116 
u_öt32_t
 
	masNum
;

117 
u_öt16_t
 
	mÀn_SigBlock
;

118 
u_öt8_t
 
	mÆgoSuôeId
;

119 
u_ch¨
 *
	mski
;

120 
u_öt16_t
 
	mÀn_Sig
;

121 
u_ch¨
 *
	msig«tuª
;

125 
ölöe
 

126 
	$put_u32
(*
p
, 
u_öt32_t
 
x
)

128 
x
 = 
	`ht⁄l
(x);

129 
	`mem˝y
(
p
, &
x
, 4);

130 
	}
}

132 
bgp£cSignD©aWôhAsciiSKI
();

133 
Bgp£cP©hAâr
 *
bgp£c_∑th_öã∫
 (Bgp£cP©hAâ∏*
b∑
);

134 
bgp£c_∑th_unöã∫
 (
Bgp£cP©hAâr
 **
pb∑
);

135 
bgp£c_∑th_‰ì
 (
Bgp£cP©hAâr
 *
b∑
);

136 
bgp£c_∑th_©å_föish
 ();

137 
bgp£c_∑th_©å_öô
 ();

143 
SRxCry±oAPI
* 
gëSrxCAPI
();

144 
bgp£c_∑th_©å_cmp
 (c⁄° *
¨g1
, c⁄° *
¨g2
);

145 
bgp£c_∑th_©å_key_make
 (*
p
);

157 
Bgp£cP©hAâr
 * 
bgp£cDup
(Bgp£cP©hAâ∏*
‹ig
, 
boﬁ
 
√wIfNULL
);

159 
c⁄ˇtP©hSegmít
(
P©hSegmít
 * const , PathSegment * const);

160 
c⁄ˇtSigSegmít
(
SigSegmít
* const , SigSegment * const);

161 
c⁄ˇtSigBlock
(
SigBlock
* const , SigBlock * const);

174 
bgp£cVîifyCÆÀr
(
≥î
 *≥î, 
©å
 *attr,

175 
¥efix
 
p
, 
sˇ_°©us_t
* 
°©us
);

192 
c⁄°ru˘BGPSecP©hAâribuã
(
bgp
 *bgp, 
≥î
 *peer,

193 
a•©h
 *a•©h, 
¥efix
* 
p
,

194 
°ªam
 *
s
, 
©å
 *attr,

195 
u_öt8_t
 
Êags
, u_öt8_à
pCou¡
,

196 
SCA_Sig«tuª
** 
sig«tuª
, 
numSig«tuªs
);

198 
bgp£cS™ôyCheck
(
Bgp£cP©hAâr
 *);

213 
Bgp£cP©hAâr
* 
bgp£c_∑r£
(
©å
 *©å, 
≥î
 *peer,

214 
°ªam
* 
s
, 
size_t
 
Àngth
);

233 
SCA_Sig«tuª
* 
signBGPSecP©hAâr
(
bgp
* bgp, 
≥î
*Öeer,

234 
¥efix
* 
pfx
, 
©å
*áttr,

235 
u_öt8_t
 
pCou¡
, u_öt8_à
Êags
);

245 
‰ìSCA_HashMesßge
(
SCA_HashMesßge
* 
mesßge
);

249 
ã°_¥öt
(
Bgp£cPdu
 , 
size_t
 *, *, * , size_t );

250 
¥öt_sig«tuª
(
Bgp£cP©hAâr
 *);

251 
hex2bö_byã
(* );

254 
	#GEN_SKI_ASCII
(
buf
, 
ski
, 
ski_Àn
) \

256 * 
˝
 = 
buf
; \

257 
i
; \

258 
i
=0; i<
ski_Àn
; i++) { \

259 
	`•rötf
(
˝
, "%02X", (
u_öt8_t
)
ski
[
i
]); \

260 
˝
+=2; \

262 
buf
[(buf)-1] = '\0'; \

263 } 0)

	)

	@bgpd/bgp_vty.h

21 #i‚de‡
_QUAGGA_BGP_VTY_H


22 
	#_QUAGGA_BGP_VTY_H


	)

24 
	#CMD_AS_RANGE
 "<1-4294967295>"

	)

26 
bgp_vty_öô
 ();

27 c⁄° *
afi_ßfi_¥öt
 (
afi_t
, 
ßfi_t
);

	@bgpd/bgp_zebra.h

21 #i‚de‡
_QUAGGA_BGP_ZEBRA_H


22 
	#_QUAGGA_BGP_ZEBRA_H


	)

24 
	#BGP_NEXTHOP_BUF_SIZE
 (8 *  (
ö_addr
 *))

	)

26 
°ªam
 *
bgp_√xth›_buf
;

28 
bgp_zebø_öô
 ();

29 
bgp_if_upd©e_Æl
 ();

30 
bgp_c⁄fig_wrôe_max∑ths
 (
vty
 *, 
bgp
 *, 
afi_t
,

31 
ßfi_t
, *);

32 
bgp_c⁄fig_wrôe_ªdi°ribuã
 (
vty
 *, 
bgp
 *, 
afi_t
, 
ßfi_t
,

34 
bgp_zebø_™noun˚
 (
¥efix
 *, 
bgp_öfo
 *, 
bgp
 *, 
ßfi_t
);

35 
bgp_zebø_wôhdøw
 (
¥efix
 *, 
bgp_öfo
 *, 
ßfi_t
);

37 
bgp_ªdi°ribuã_£t
 (
bgp
 *, 
afi_t
, );

38 
bgp_ªdi°ribuã_rm≠_£t
 (
bgp
 *, 
afi_t
, , const *);

39 
bgp_ªdi°ribuã_mëric_£t
 (
bgp
 *, 
afi_t
, , 
u_öt32_t
);

40 
bgp_ªdi°ribuã_un£t
 (
bgp
 *, 
afi_t
, );

41 
bgp_ªdi°ribuã_rouãm≠_un£t
 (
bgp
 *, 
afi_t
, );

42 
bgp_ªdi°ribuã_mëric_un£t
 (
bgp
 *, 
afi_t
, );

44 
öãrÁ˚
 *
if_lookup_by_ùv4
 (
ö_addr
 *);

45 
öãrÁ˚
 *
if_lookup_by_ùv4_exa˘
 (
ö_addr
 *);

46 #ifde‡
HAVE_IPV6


47 
öãrÁ˚
 *
if_lookup_by_ùv6
 (
ö6_addr
 *);

48 
öãrÁ˚
 *
if_lookup_by_ùv6_exa˘
 (
ö6_addr
 *);

	@bgpd/bgpd.h

21 #i‚de‡
_QUAGGA_BGPD_H


22 
	#_QUAGGA_BGPD_H


	)

25 
	~"sockuni⁄.h
"

27 #ifde‡
USE_SRX


28 
	~<§x/§x_≠i.h
>

29 
	~<§x/§x¸y±ﬂpi.h
>

30 
	~"bgp_öfo_hash.h
"

33 
	#SRX_PRINT_HEX
(
DATA
, 
DLEN
) \

35 
•h_idx
 = 0; \

36 
•h_idx
 < 
DLEN
) \

38 i‡(
•h_idx
 % 16 == 0) \

40 
	`¥ötf
 ("\n"); \

42 i‡(
•h_idx
 % 8 == 0) \

44 
	`¥ötf
 (" "); \

46 
	`¥ötf
(" %02X", 
DATA
[
•h_idx
]); \

47 
•h_idx
++; \

49 
	`¥ötf
 ("\n"); \

50 }

	)

54 
	#SRX_MAX_PRIVKEYS
 2

	)

56 
	#SRX_VTY_HLP_STR
 "SRx c⁄figuøti⁄ sëtög\n"

	)

58 
	#SRX_VTY_EVAL_ORIGIN_ONLY
 "‹igö_⁄ly"

	)

59 
	#SRX_VTY_EVAL_BGPSEC
 "bgp£c"

	)

61 
	#SRX_VTY_PARAM_CONNECT_SRV
 0

	)

62 
	#SRX_VTY_PARAM_CONNECT_PORT
 1

	)

63 
	#SRX_VTY_CMD_CONNECT_SHORT
 "§x c⁄√˘"

	)

64 
	#SRX_VTY_HLP_CONNECT_SHORT
 
SRX_VTY_HLP_STR
 \

65 "C⁄√˘Åhêrouã∏wôh SRx sîvî\n"

	)

66 
	#SRX_VTY_CMD_CONNECT
 
SRX_VTY_CMD_CONNECT_SHORT
 " .LINE <0-65535>"

	)

67 
	#SRX_VTY_OUT_CONNECT
 "§x c⁄√˘ %†%d%s"

	)

68 
	#SRX_VTY_HLP_CONNECT
 
SRX_VTY_HLP_CONNECT_SHORT
 \

70 "S≥cifõ†SRx sîvîÖ‹t\n"

	)

72 
	#SRX_VTY_CMD_DISCONNECT
 "§x disc⁄√˘"

	)

73 
	#SRX_VTY_HLP_DISCONNECT
 
SRX_VTY_HLP_STR
 \

74 "Disc⁄√˘ fromÅhêSRx sîvî\n"

	)

76 
	#SRX_VTY_CMD_DISPLAY
 "§x di•œy"

	)

77 
	#SRX_VTY_OUT_DISPLAY
 "§x dü∂ay%s"

	)

78 
	#SRX_VTY_HLP_DISPLAY
 
SRX_VTY_HLP_STR
 \

80 " comm™ds\n"

	)

81 
	#SRX_VTY_HLP_DISPLAY_NO
 
SRX_VTY_HLP_STR
 \

83 " comm™ds\n"

	)

85 
	#SRX_VTY_CMD_EVALUATE
 "§xÉvÆu©i⁄ (" 
SRX_VTY_EVAL_ORIGIN_ONLY
 \

86 "|" 
SRX_VTY_EVAL_BGPSEC
 ")"

	)

87 
	#SRX_VTY_OUT_EVALUATE
 "§xÉvÆu©i⁄ %s%s"

	)

88 
	#SRX_VTY_HLP_EVALUATE
 
SRX_VTY_HLP_STR
 \

93 " ROA'†™dÖ©h vÆid©i⁄\n"

	)

94 
	#SRX_VTY_CMD_NO_EVALUATE
 "nÿ§xÉvÆu©i⁄"

	)

95 
	#SRX_VTY_HLP_NO_EVALUATE
 
NO_STR
 
SRX_VTY_HLP_STR
 \

97 

	)

99 
	#SRX_VTY_CMD_EVAL_WITHSRX
 "§xÉvÆu©i⁄ " 
SRX_VTY_EVAL_BGPSEC
 \

100 " di°ribuãd"

	)

101 
	#SRX_VTY_OUT_EVAL_WITHSRX
 "§xÉvÆu©i⁄ " 
SRX_VTY_EVAL_BGPSEC
 \

102 " di°ribuãd%s"

	)

103 
	#SRX_VTY_HLP_EVAL_WITHSRX
 
SRX_VTY_HLP_STR
 \

107 "Pîf‹mÖ©h vÆid©i⁄ usög srx-£rvî.\n"

	)

109 
	#SRX_VTY_CMD_KEEPWINDOW_SHORT
 "§x kìp-wödow"

	)

110 
	#SRX_VTY_CMD_KEEPWINDOW
 
SRX_VTY_CMD_KEEPWINDOW_SHORT
 " <0-65535>"

	)

111 
	#SRX_VTY_HLP_KEEPWINDOW
 
SRX_VTY_HLP_STR
 \

115 "Timêö sec⁄d†\'0\' dißbÀ†thi†„©uª!\n"

	)

118 
	#SRX_VTY_CMD_SET_SERVER_SHORT
 "§x së-£rvî"

	)

119 
	#SRX_VTY_CMD_SET_SERVER
 
SRX_VTY_CMD_SET_SERVER_SHORT
 " .LINE <0-65535>"

	)

120 
	#SRX_VTY_HLP_SET_SERVER
 
SRX_VTY_HLP_STR
 \

121 "SëÅhêSRx sîvî c⁄√˘i⁄Ö¨amëîs\n"

	)

123 
	#SRX_VTY_CMD_PROXYID
 "§x së-¥oxy-id A.B.C.D"

	)

124 
	#SRX_VTY_HLP_PROXYID
 
SRX_VTY_HLP_STR
 \

129 "ö IPv4 f‹m©.\n"

	)

131 
	#SRX_VTY_CMD_SHOW_CONFIG
 "show srx-c⁄fig"

	)

132 
	#SRX_VTY_HLP_SHOW_CONFIG
 
SHOW_STR
 "SRx-BGP Rouã∏c⁄figuøti⁄\n"

	)

135 
	#SRX_VTY_PARAM_ORIGIN_VALUE
 0

	)

136 
	#SRX_VTY_PARAM_PATH_VALUE
 1

	)

138 
	#SRX_VTY_PARAM_BGPSEC_MIN_ALGOID
 1

	)

139 
	#SRX_VTY_PARAM_BGPSEC_MAX_ALGOID
 254

	)

142 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "§x së-‹igö-vÆuê"

	)

143 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_VALID
 \

144 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "vÆid\n"

	)

145 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_NOTFOUND
 \

146 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "nŸfound\n"

	)

147 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_INVALID
 \

148 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "övÆid\n"

	)

149 
	#SRX_VTY_CMD_CONF_DEF_ROA_RES_UNDEFINED
 \

150 
SRX_VTY_CMD_CONF_DEF_ROA_RES_STR
 "undeföed\n"

	)

152 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 
SRX_VTY_HLP_STR
 \

156 "vÆuêi†"

	)

157 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_VALID
 \

158 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "vÆid\n"

	)

159 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_NOTFOUND
 \

160 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "nŸfound\n"

	)

161 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_INVALID
 \

162 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "övÆid\n"

	)

163 
	#SRX_VTY_HLP_CONF_DEF_ROA_RES_UNDEFINED
 \

164 
SRX_VTY_HLP_CONF_DEF_ROA_RES_STR
 "undeföed\n"

	)

167 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "§x së-∑th-vÆuê"

	)

168 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_VALID
 \

169 
SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "vÆid\n"

	)

170 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_INVALID
 \

171 
SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "övÆid\n"

	)

172 
	#SRX_VTY_CMD_CONF_DEF_PATH_RES_UNDEFINED
 \

173 
SRX_VTY_CMD_CONF_DEF_PATH_RES_STR
 "undeföed\n"

	)

175 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 
SRX_VTY_HLP_STR
 \

179 "vÆuêi†"

	)

180 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_VALID
 \

181 
SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 "vÆid\n"

	)

182 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_INVALID
 \

183 
SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 "övÆid\n"

	)

184 
	#SRX_VTY_HLP_CONF_DEF_PATH_RES_UNDEFINED
 \

185 
SRX_VTY_HLP_CONF_DEF_PATH_RES_STR
 "undeföed\n"

	)

188 
	#SRX_VTY_CMD_APPLY_POLICY
 "§xáµly-pﬁicy"

	)

189 
	#SRX_VTY_HLP_APPLY_POLICY
 
SRX_VTY_HLP_STR
 \

191 "ÅhêRIB.\n"

	)

194 
	#SRX_VTY_HLP_POLICY
 "EvÆu©i⁄Öﬁicy comm™d\n"

	)

195 
	#SRX_VTY_HLP_ORIGIN_ONLY
 "(" 
SRX_VTY_EVAL_ORIGIN_ONLY
 "Ë"

	)

198 
	#SRX_VTY_CMD_POL_IGNORE_NOTFOUND
 "§xÖﬁicy ign‹e-nŸfound"

	)

199 
	#SRX_VTY_HLP_POL_IGNORE_NOTFOUND
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

200 
SRX_VTY_HLP_ORIGIN_ONLY
 \

202 "ªsu… = UNKNOWN.\n"

	)

204 
	#SRX_VTY_CMD_POL_IGNORE_INVALID
 "§xÖﬁicy ign‹e-övÆid"

	)

205 
	#SRX_VTY_HLP_POL_IGNORE_INVALID
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

207 "Ñesu… = INVALID.\n"

	)

209 
	#SRX_VTY_CMD_POL_IGNORE_UNDEFINED
 "§xÖﬁicy ign‹e-undeföed"

	)

210 
	#SRX_VTY_HLP_POL_IGNORE_UNDEFINED
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

212 " vÆid©i⁄Ñesu…ávaûabÀ.\n"

	)

215 
	#SRX_VTY_HLP_POL_LOCP
 "M™ùuœãÜoˇ»¥e„ªn˚\n"

	)

216 
	#SRX_VTY_HLP_POL_LOCP_V
 "Pﬁicy f‹ vÆid©i⁄Ñesu… = VALID\n"

	)

217 
	#SRX_VTY_HLP_POL_LOCP_U
 
SRX_VTY_HLP_ORIGIN_ONLY
 "Policy for " \

218 "vÆid©i⁄Ñesu… = UNKNOWN\n"

	)

219 
	#SRX_VTY_HLP_POL_LOCP_I
 "Pﬁicy f‹ vÆid©i⁄Ñesu… = INVALID\n"

	)

221 
	#SRX_VTY_HLP_POL_LOCP_A
 "TÿbêaddedÅÿthêgivíÜoˇ»¥ef\n"

	)

222 
	#SRX_VTY_HLP_POL_LOCP_S
 "Tÿbêsubåa˘ed fromÅhêgivíÜoˇ»¥ef\n"

	)

224 
	#SRX_VTY_CMD_POL_LOCP
 "§xÖﬁicyÜoˇl-¥e„ªn˚"

	)

225 
	#SRX_VTY_CMD_POL_LOCP_FIX
 
SRX_VTY_CMD_POL_LOCP
 \

226 " (vÆid|nŸfound|övÆidË<0-4294967295>"

	)

227 
	#SRX_VTY_HLP_POL_LOCP_FIX
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

228 
SRX_VTY_HLP_POL_LOCP
 \

229 
SRX_VTY_HLP_POL_LOCP_V
 \

230 
SRX_VTY_HLP_POL_LOCP_U
 \

231 
SRX_VTY_HLP_POL_LOCP_I
 \

232 "Thêloˇ»¥e„ªn˚ vÆue.\n"

	)

234 
	#SRX_VTY_CMD_POL_LOCP_VAR
 
SRX_VTY_CMD_POL_LOCP_FIX
 \

235 " (add|subåa˘)"

	)

236 
	#SRX_VTY_HLP_POL_LOCP_VAR
 
SRX_VTY_HLP_POL_LOCP_FIX
 \

237 
SRX_VTY_HLP_POL_LOCP_A
 \

238 
SRX_VTY_HLP_POL_LOCP_S


	)

240 
	#SRX_VTY_CMD_NO_POL_LOCP
 "nÿ" 
SRX_VTY_CMD_POL_LOCP
 \

241 " (vÆid|nŸfound|övÆid)"

	)

242 
	#SRX_VTY_HLP_NO_POL_LOCP
 
NO_STR
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

243 
SRX_VTY_HLP_POL_LOCP
 \

244 
SRX_VTY_HLP_POL_LOCP_V
 \

245 
SRX_VTY_HLP_POL_LOCP_U
 \

246 
SRX_VTY_HLP_POL_LOCP_I
 \

247 

	)

249 
	#SRX_VTY_CMD_POL_PREFV
 "§xÖﬁicyÖª„r-vÆid"

	)

250 
	#SRX_VTY_OUT_POL_PREFV
 
SRX_VTY_CMD_POL_PREFV
 "%s"

	)

251 
	#SRX_VTY_HLP_POL_PREFV
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_POLICY
 \

253 " wôh vÆid >ány othî\n"

	)

256 
	#SRX_VTY_CMD_EXT_CSTR
 "§xÉxtcommunôy <0-255>"

	)

257 
	#SRX_VTY_HLP_EXT_CSTR
 
SRX_VTY_HLP_STR
 "Configure community string for" \

259 "Thêsub codêo‡thêexãnded communôy.\n"

	)

261 
	#SRX_VTY_CMD_EXT_CSTR_EBGP
 
SRX_VTY_CMD_EXT_CSTR
 " (ö˛ude_ebgp|⁄ly_ibgp)"

	)

262 
	#SRX_VTY_HLP_EXT_CSTR_EBGP
 
SRX_VTY_HLP_EXT_CSTR
 \

264 "O∆y iBGPÖìr†-álsÿu£dÅÿtu∫ of‡eBGPÖìrs\n"

	)

266 
	#SRX_VTY_CMD_NO_EXT_CSTR
 "nÿ§xÉxtcommunôy"

	)

267 
	#SRX_VTY_HLP_NO_EXT_CSTR
 
NO_STR
 
SRX_VTY_HLP_STR
 \

269 "Ñesu…Åøns„r.\n"

	)

272 
	#SRX_VTY_HLP_BGPSEC
 "BGPSEC s≥cifi¯c⁄figuøti⁄\n"

	)

274 
	#SRX_VTY_CMD_BGPSEC_SKI_PRNT
 "§x bgp£¯skò(0|1Ë<1-254>"

	)

275 
	#SRX_VTY_CMD_BGPSEC_SKI
 
SRX_VTY_CMD_BGPSEC_SKI_PRNT
 " WORD"

	)

276 
	#SRX_VTY_OUT_BGPSEC_SKI
 "§x bgp£¯skò%u %s%s"

	)

277 
	#SRX_VTY_HLP_BGPSEC_SKI
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_BGPSEC
 \

280 "ThêSKI,á 20 byã vÆuêa†40 byã HEX såög o‡thêSKI"

	)

282 
	#SRX_VTY_CMD_BGPSEC_ACTIVE_SKI
 "§x bgp£¯a˘ivê(0|1)"

	)

283 
	#SRX_VTY_OUT_BGPSEC_ACTIVE_SKI
 "§x bgp£¯a˘ivê%u%s"

	)

284 
	#SRX_VTY_HLP_BGPSEC_ACTIVE_SKI
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_BGPSEC
 \

285 "C⁄figuª which key i†a˘ive"

	)

287 
	#SRX_VTY_CMD_BGPSEC_REGISTER_P_KEYS
 "§x bgp£¯ªgi°î keys"

	)

288 
	#SRX_VTY_HLP_BGPSEC_REGISTER_P_KEYS
 
SRX_VTY_HLP_STR
 
SRX_VTY_HLP_BGPSEC
 \

291 "ªgi°øti⁄ faûed!\n"

	)

294 
	#SRX_VTY_HLP_BGPSEC_DEP
 "PÀa£ u£Åhêª∂a˚míà'§x bgp£¯...'\n"

	)

295 
	#SRX_VTY_CMD_BGPSEC_DEP_SKI_PRNT
 "bgp£¯ski"

	)

296 
	#SRX_VTY_CMD_BGPSEC_DEP_SKI
 
SRX_VTY_CMD_BGPSEC_DEP_SKI_PRNT
 " WORD"

	)

297 
	#SRX_VTY_HLP_BGPSEC_DEP_SKI
 
SRX_VTY_HLP_BGPSEC_DEP
 \

299 "U£ '" 
SRX_VTY_CMD_BGPSEC_SKI_PRNT
 \

300 " <ski>' in°ód!\n"

	)

302 
	#SRX_VTY_CMD_BGPSEC_DEP_SIGN
 "bgp£¯sig¿(key|id)"

	)

303 
	#SRX_VTY_HLP_BGPSEC_DEP_SIGN
 
SRX_VTY_HLP_BGPSEC_DEP
 \

304 "Thi†comm™d i†ªmoved!\n"

	)

307 
	#SRX_VTY_CMD_NEIGHBOR_BGPSEC
 
NEIGHBOR_CMD2
 "bgp£¯"

	)

308 
	#SRX_VTY_HLP_NEIGHBOR_BGPSEC
 
NEIGHBOR_STR
 
NEIGHBOR_ADDR_STR2
 \

309 "C⁄figuªÅhêbgp£¯ˇ∑bûôyÅÿthê≥î\n"

	)

311 
	#SRX_VTY_CMD_NEIGHBOR_BGPSEC_MODE
 
SRX_VTY_CMD_NEIGHBOR_BGPSEC
 \

312 "(¢d|ªc|bŸh)"

	)

314 
	#SRX_VTY_HLP_NEIGHBOR_BGPSEC_MODE
 
SRX_VTY_HLP_NEIGHBOR_BGPSEC
 \

317 "Síd BGPSECándÑe˚ivêBGPSEC\n"

	)

323 
	#SRX_VTY_CMD_NO_NEIGHBOR_BGPSEC_MODE
 
NO_NEIGHBOR_CMD2
 "bgpsec " \

324 "(¢d|ªc|bŸh)"

	)

326 
	#SRX_VTY_HLP_NO_NEIGHBOR_BGPSEC_MODE
 
NO_STR
 
SRX_VTY_HLP_NEIGHBOR_BGPSEC
 \

329 "Síd BGPSECándÑe˚ivêBGPSEC\n"

	)

341 
u_öt32_t
 
	tas_t
;

342 
u_öt16_t
 
	tas16_t
;

343 
u_öt16_t
 
	tbgp_size_t
;

346 
	sbgp_ma°î


349 
li°
 *
	mbgp
;

352 
thªad_ma°î
 *
	mma°î
;

355 
w‹k_queue
 *
	m¥o˚ss_maö_queue
;

356 
w‹k_queue
 *
	m¥o˚ss_rs˛õ¡_queue
;

359 
li°
 *
	mli°í_sockës
;

362 
u_öt16_t
 
	mp‹t
;

365 *
	maddªss
;

368 
time_t
 
	m°¨t_time
;

371 
u_ch¨
 
	m›ti⁄s
;

372 
	#BGP_OPT_NO_FIB
 (1 << 0)

	)

373 
	#BGP_OPT_MULTIPLE_INSTANCE
 (1 << 1)

	)

374 
	#BGP_OPT_CONFIG_CISCO
 (1 << 2)

	)

375 
	#BGP_OPT_NO_LISTEN
 (1 << 3)

	)

378 #ifde‡
USE_SRX


382 
	s§x_loˇl_¥ef
 {

384 
	mis_£t
;

386 
	mªœtive
;

388 
uöt32_t
 
	mvÆue
;

393 
	sbgp


396 
as_t
 
	mas
;

399 *
	m«me
;

402 
	mlock
;

405 
≥î
 *
	m≥î_£lf
;

408 
li°
 *
	m≥î
;

411 
li°
 *
	mgroup
;

414 
li°
 *
	mrs˛õ¡
;

417 
u_öt16_t
 
	mc⁄fig
;

418 
	#BGP_CONFIG_ROUTER_ID
 (1 << 0)

	)

419 
	#BGP_CONFIG_CLUSTER_ID
 (1 << 1)

	)

420 
	#BGP_CONFIG_CONFEDERATION
 (1 << 2)

	)

421 #ifde‡
USE_SRX


422 
	#BGP_CONFIG_SRX
 (1 << 3)

	)

425 
u_öt16_t
 
	m§x_c⁄fig
;

426 
	#SRX_CONFIG_EVAL_ORIGIN
 (1 << 1)

	)

428 
	#SRX_CONFIG_EVAL_PATH
 (1 << 2)

	)

429 
	#SRX_CONFIG_EVALUATE
 (
SRX_CONFIG_EVAL_ORIGIN
 | 
SRX_CONFIG_EVAL_PATH
)

	)

431 
	#SRX_CONFIG_EVAL_DISTR
 ((1 << 3Ë| 
SRX_CONFIG_EVALUATE
)

	)

432 
	#SRX_CONFIG_DISPLAY_INFO
 (1 << 4)

	)

436 
ö_addr
 
	mrouãr_id
;

437 
ö_addr
 
	mrouãr_id_°©ic
;

440 
ö_addr
 
	m˛u°î_id
;

443 
as_t
 
	mc⁄„d_id
;

444 
as_t
 *
	mc⁄„d_≥îs
;

445 
	mc⁄„d_≥îs_˙t
;

448 
u_öt16_t
 
	mÊags
;

449 
	#BGP_FLAG_ALWAYS_COMPARE_MED
 (1 << 0)

	)

450 
	#BGP_FLAG_DETERMINISTIC_MED
 (1 << 1)

	)

451 
	#BGP_FLAG_MED_MISSING_AS_WORST
 (1 << 2)

	)

452 
	#BGP_FLAG_MED_CONFED
 (1 << 3)

	)

453 
	#BGP_FLAG_NO_DEFAULT_IPV4
 (1 << 4)

	)

454 
	#BGP_FLAG_NO_CLIENT_TO_CLIENT
 (1 << 5)

	)

455 
	#BGP_FLAG_ENFORCE_FIRST_AS
 (1 << 6)

	)

456 
	#BGP_FLAG_COMPARE_ROUTER_ID
 (1 << 7)

	)

457 
	#BGP_FLAG_ASPATH_IGNORE
 (1 << 8)

	)

458 
	#BGP_FLAG_IMPORT_CHECK
 (1 << 9)

	)

459 
	#BGP_FLAG_NO_FAST_EXT_FAILOVER
 (1 << 10)

	)

460 
	#BGP_FLAG_LOG_NEIGHBOR_CHANGES
 (1 << 11)

	)

461 
	#BGP_FLAG_GRACEFUL_RESTART
 (1 << 12)

	)

462 
	#BGP_FLAG_ASPATH_CONFED
 (1 << 13)

	)

465 
u_öt16_t
 
	maf_Êags
[
AFI_MAX
][
SAFI_MAX
];

466 
	#BGP_CONFIG_DAMPENING
 (1 << 0)

	)

469 
bgp_èbÀ
 *
	mrouã
[
AFI_MAX
][
SAFI_MAX
];

472 
bgp_èbÀ
 *
	maggªg©e
[
AFI_MAX
][
SAFI_MAX
];

475 
bgp_èbÀ
 *
	mrib
[
AFI_MAX
][
SAFI_MAX
];

478 
u_ch¨
 
	mªdi°
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

481 
u_ch¨
 
	mªdi°_mëric_Êag
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

482 
u_öt32_t
 
	mªdi°_mëric
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

487 *
	m«me
;

488 
rouã_m≠
 *
	mm≠
;

489 } 
	mrm≠
[
AFI_MAX
][
ZEBRA_ROUTE_MAX
];

492 
u_ch¨
 
	mdi°™˚_ebgp
;

493 
u_ch¨
 
	mdi°™˚_ibgp
;

494 
u_ch¨
 
	mdi°™˚_loˇl
;

497 
u_öt32_t
 
	mdeÁu…_loˇl_¥ef
;

500 
u_öt32_t
 
	mdeÁu…_hﬁdtime
;

501 
u_öt32_t
 
	mdeÁu…_kì∑live
;

504 
u_öt32_t
 
	mª°¨t_time
;

505 
u_öt32_t
 
	m°Æï©h_time
;

508 
	sbgp_max∑ths_cfg
 {

509 
u_öt16_t
 
	mmax∑ths_ebgp
;

510 
u_öt16_t
 
	mmax∑ths_ibgp
;

511 } 
	mmax∑ths
[
AFI_MAX
][
SAFI_MAX
];

513 #ifde‡
USE_SRX


517 *
	m§x_ho°
;

518 
	m§x_p‹t
;

519 
	#SRX_HANDHAKE_TIMEOUT
 30

	)

520 
	#SRX_KEEP_WINDOW
 900

	)

523 
	m§x_h™dshakeTimeout
;

525 
	m§x_kìpWödow
;

526 
uöt32_t
 
	m§x_¥oxyID
;

528 
§x_loˇl_¥ef
 
	m§x_vÆ_loˇl_¥ef
[3];

529 
	#VAL_LOCPRF_VALID
 0

	)

530 
	#VAL_LOCPRF_NOTFOUND
 1

	)

531 
	#VAL_LOCPRF_INVALID
 2

	)

534 
uöt16_t
 
	m§x_vÆ_pﬁicy
;

535 
	#SRX_VAL_POLICY_PREFER_VALID
 (1 << 0)

	)

536 
	#SRX_VAL_POLICY_IGNORE_NOTFOUND
 (1 << 1)

	)

537 
	#SRX_VAL_POLICY_IGNORE_INVALID
 (1 << 2)

	)

538 
	#SRX_VAL_POLICY_IGNORE_UNDEFINED
 (1 << 3)

	)

540 
uöt16_t
 
	m§x_deÁu…_rﬂVÆ
;

541 
uöt16_t
 
	m§x_deÁu…_bgp£cVÆ
;

544 
SRxProxy
* 
	m§xProxy
;

546 
bgp_öfo_hash
* 
	möfo_uid_hash
;

548 
bgp_öfo_hash
* 
	möfo_lid_hash
;

551 
SRxCry±oAPI
* 
	m§xCAPI
;

554 
BGPSecKey
 
	m§x_bgp£c_key
[
SRX_MAX_PRIVKEYS
];

556 
u_öt8_t
 
	m§x_bgp£c_a˘ive_key
;

559 
	#SRX_BGP_FLAG_ECOMMUNITY
 (1 << 0)

	)

560 
	#SRX_BGP_FLAG_ECOMMUNITY_EBGP
 (1 << 1)

	)

561 
u_öt8_t
 
	m§x_ecommunôy_Êags
;

562 
u_öt8_t
 
	m§x_ecommunôy_subcode
;

567 
	s≥î_group


570 *
	m«me
;

573 
bgp
 *
	mbgp
;

576 
li°
 *
	m≥î
;

579 
≥î
 *
	mc⁄f
;

583 
	sbgp_nŸify


585 
u_ch¨
 
	mcode
;

586 
u_ch¨
 
	msubcode
;

587 *
	md©a
;

588 
bgp_size_t
 
	mÀngth
;

592 
	sbgp_√xth›


594 
öãrÁ˚
 *
	miÂ
;

595 
ö_addr
 
	mv4
;

596 #ifde‡
HAVE_IPV6


597 
ö6_addr
 
	mv6_globÆ
;

598 
ö6_addr
 
	mv6_loˇl
;

603 
	#BGP_RD_SIZE
 8

	)

605 
	sbgp_rd


607 
u_ch¨
 
	mvÆ
[
BGP_RD_SIZE
];

610 
	#RMAP_IN
 0

	)

611 
	#RMAP_OUT
 1

	)

612 
	#RMAP_IMPORT
 2

	)

613 
	#RMAP_EXPORT
 3

	)

614 
	#RMAP_MAX
 4

	)

617 
	sbgp_fûãr


622 *
	m«me
;

623 
ac˚ss_li°
 *
	mÆi°
;

624 } 
	mdli°
[
FILTER_MAX
];

629 *
	m«me
;

630 
¥efix_li°
 *
	m∂i°
;

631 } 
	m∂i°
[
FILTER_MAX
];

636 *
	m«me
;

637 
as_li°
 *
	ma¶i°
;

638 } 
	ma¶i°
[
FILTER_MAX
];

643 *
	m«me
;

644 
rouã_m≠
 *
	mm≠
;

645 } 
	mm≠
[
RMAP_MAX
];

650 *
	m«me
;

651 
rouã_m≠
 *
	mm≠
;

652 } 
	musm≠
;

659 
	mBGP_PEER_IBGP
 = 1,

660 
	mBGP_PEER_EBGP
,

661 
	mBGP_PEER_INTERNAL
,

662 
	mBGP_PEER_CONFED
,

663 } 
	tbgp_≥î_s‹t_t
;

666 
	s≥î


669 
bgp
 *
	mbgp
;

676 
	mlock
;

679 
≥î_group
 *
	mgroup
;

680 
u_ch¨
 
	maf_group
[
AFI_MAX
][
SAFI_MAX
];

683 
as_t
 
	mas
;

686 
as_t
 
	mloˇl_as
;

688 
bgp_≥î_s‹t_t
 
	ms‹t
;

691 
as_t
 
	mch™ge_loˇl_as
;

694 
ö_addr
 
	mªmŸe_id
;

697 
ö_addr
 
	mloˇl_id
;

700 
bgp_èbÀ
 *
	mrib
[
AFI_MAX
][
SAFI_MAX
];

703 
°ªam
 *
	mibuf
;

704 
°ªam_fifo
 *
	mobuf
;

705 
°ªam
 *
	mw‹k
;

708 
	m°©us
;

709 
	mo°©us
;

712 
uöt16_t
 
	mèbÀ_dump_ödex
;

715 
	mfd
;

716 
	mâl
;

717 
	mgtsm_h›s
;

718 *
	mdesc
;

719 
	mp‹t
;

720 *
	mho°
;

721 
sockuni⁄
 
	msu
;

722 
time_t
 
	mu±ime
;

723 
time_t
 
	mªadtime
;

724 
time_t
 
	mª£âime
;

726 
	mifödex
;

727 *
	mi‚ame
;

728 *
	mupd©e_if
;

729 
sockuni⁄
 *
	mupd©e_sour˚
;

730 
zlog
 *
	mlog
;

732 
sockuni⁄
 *
	msu_loˇl
;

733 
sockuni⁄
 *
	msu_ªmŸe
;

734 
	msh¨ed_√tw‹k
;

735 
bgp_√xth›
 
	m√xth›
;

738 
u_ch¨
 
	mafc
[
AFI_MAX
][
SAFI_MAX
];

739 
u_ch¨
 
	mafc_√go
[
AFI_MAX
][
SAFI_MAX
];

740 
u_ch¨
 
	mafc_adv
[
AFI_MAX
][
SAFI_MAX
];

741 
u_ch¨
 
	mafc_ªcv
[
AFI_MAX
][
SAFI_MAX
];

744 
u_öt16_t
 
	mˇp
;

745 
	#PEER_CAP_REFRESH_ADV
 (1 << 0Ë

	)

746 
	#PEER_CAP_REFRESH_OLD_RCV
 (1 << 1Ë

	)

747 
	#PEER_CAP_REFRESH_NEW_RCV
 (1 << 2Ë

	)

748 
	#PEER_CAP_DYNAMIC_ADV
 (1 << 3Ë

	)

749 
	#PEER_CAP_DYNAMIC_RCV
 (1 << 4Ë

	)

750 
	#PEER_CAP_RESTART_ADV
 (1 << 5Ë

	)

751 
	#PEER_CAP_RESTART_RCV
 (1 << 6Ë

	)

752 
	#PEER_CAP_AS4_ADV
 (1 << 7Ë

	)

753 
	#PEER_CAP_AS4_RCV
 (1 << 8Ë

	)

754 #ifde‡
USE_SRX


755 
	#PEER_CAP_EXTENDED_MSG_SUPPORT
 (1 << 13)

	)

756 
	#PEER_CAP_BGPSEC_ADV_SEND
 (1 << 14)

	)

757 
	#PEER_CAP_BGPSEC_ADV
 (1 << 15)

	)

761 
u_öt16_t
 
	maf_ˇp
[
AFI_MAX
][
SAFI_MAX
];

762 
	#PEER_CAP_ORF_PREFIX_SM_ADV
 (1 << 0Ë

	)

763 
	#PEER_CAP_ORF_PREFIX_RM_ADV
 (1 << 1Ë

	)

764 
	#PEER_CAP_ORF_PREFIX_SM_RCV
 (1 << 2Ë

	)

765 
	#PEER_CAP_ORF_PREFIX_RM_RCV
 (1 << 3Ë

	)

766 
	#PEER_CAP_ORF_PREFIX_SM_OLD_RCV
 (1 << 4Ë

	)

767 
	#PEER_CAP_ORF_PREFIX_RM_OLD_RCV
 (1 << 5Ë

	)

768 
	#PEER_CAP_RESTART_AF_RCV
 (1 << 6Ë

	)

769 
	#PEER_CAP_RESTART_AF_PRESERVE_RCV
 (1 << 7Ë

	)

772 
u_öt32_t
 
	mÊags
;

773 
	#PEER_FLAG_PASSIVE
 (1 << 0Ë

	)

774 
	#PEER_FLAG_SHUTDOWN
 (1 << 1Ë

	)

775 
	#PEER_FLAG_DONT_CAPABILITY
 (1 << 2Ë

	)

776 
	#PEER_FLAG_OVERRIDE_CAPABILITY
 (1 << 3Ë

	)

777 
	#PEER_FLAG_STRICT_CAP_MATCH
 (1 << 4Ë

	)

778 
	#PEER_FLAG_DYNAMIC_CAPABILITY
 (1 << 5Ë

	)

779 
	#PEER_FLAG_DISABLE_CONNECTED_CHECK
 (1 << 6Ë

	)

780 
	#PEER_FLAG_LOCAL_AS_NO_PREPEND
 (1 << 7Ë

	)

781 
	#PEER_FLAG_LOCAL_AS_REPLACE_AS
 (1 << 8Ë

	)

782 #ifde‡
USE_SRX


783 
	#PEER_FLAG_EXTENDED_MESSAGE_SUPPORT
 (1 << 9Ë

	)

784 
	#PEER_FLAG_BGPSEC_MPE_IPV4
 (1 << 10Ë

	)

786 
	#PEER_FLAG_BGPSEC_MIGRATE
 (1 << 11Ë

	)

787 
	#PEER_FLAG_BGPSEC_ROUTE_SERVER
 (1 << 12Ë

	)

788 
	#PEER_FLAG_EXTENDED_MESSAGE_LIBERAL
 (1 << 13Ë

	)

789 
	#PEER_FLAG_BGPSEC_CAPABILITY_RECV
 (1 << 14)

	)

790 
	#PEER_FLAG_BGPSEC_CAPABILITY_SEND
 (1 << 15)

	)

791 
	#PEER_FLAG_BGPSEC_CAPABILITY
 (1 << 15)

	)

795 
u_ch¨
 
	mnsf
[
AFI_MAX
][
SAFI_MAX
];

798 
u_öt32_t
 
	maf_Êags
[
AFI_MAX
][
SAFI_MAX
];

799 
	#PEER_FLAG_SEND_COMMUNITY
 (1 << 0Ë

	)

800 
	#PEER_FLAG_SEND_EXT_COMMUNITY
 (1 << 1Ë

	)

801 
	#PEER_FLAG_NEXTHOP_SELF
 (1 << 2Ë

	)

802 
	#PEER_FLAG_REFLECTOR_CLIENT
 (1 << 3Ë

	)

803 
	#PEER_FLAG_RSERVER_CLIENT
 (1 << 4Ë

	)

804 
	#PEER_FLAG_SOFT_RECONFIG
 (1 << 5Ë

	)

805 
	#PEER_FLAG_AS_PATH_UNCHANGED
 (1 << 6Ë

	)

806 
	#PEER_FLAG_NEXTHOP_UNCHANGED
 (1 << 7Ë

	)

807 
	#PEER_FLAG_MED_UNCHANGED
 (1 << 8Ë

	)

808 
	#PEER_FLAG_DEFAULT_ORIGINATE
 (1 << 9Ë

	)

809 
	#PEER_FLAG_REMOVE_PRIVATE_AS
 (1 << 10Ë

	)

810 
	#PEER_FLAG_ALLOWAS_IN
 (1 << 11Ë

	)

811 
	#PEER_FLAG_ORF_PREFIX_SM
 (1 << 12Ë

	)

812 
	#PEER_FLAG_ORF_PREFIX_RM
 (1 << 13Ë

	)

813 
	#PEER_FLAG_MAX_PREFIX
 (1 << 14Ë

	)

814 
	#PEER_FLAG_MAX_PREFIX_WARNING
 (1 << 15Ë

	)

815 
	#PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED
 (1 << 16Ë

	)

818 *
	m∑ssw‹d
;

823 *
	m«me
;

824 
rouã_m≠
 *
	mm≠
;

825 } 
	mdeÁu…_rm≠
[
AFI_MAX
][
SAFI_MAX
];

828 
u_öt16_t
 
	msÊags
;

829 
	#PEER_STATUS_ACCEPT_PEER
 (1 << 0Ë

	)

830 
	#PEER_STATUS_PREFIX_OVERFLOW
 (1 << 1Ë

	)

831 
	#PEER_STATUS_CAPABILITY_OPEN
 (1 << 2Ë

	)

832 
	#PEER_STATUS_HAVE_ACCEPT
 (1 << 3Ë

	)

833 
	#PEER_STATUS_GROUP
 (1 << 4Ë

	)

834 
	#PEER_STATUS_NSF_MODE
 (1 << 5Ë

	)

835 
	#PEER_STATUS_NSF_WAIT
 (1 << 6Ë

	)

838 
u_öt16_t
 
	maf_sÊags
[
AFI_MAX
][
SAFI_MAX
];

839 
	#PEER_STATUS_ORF_PREFIX_SEND
 (1 << 0Ë

	)

840 
	#PEER_STATUS_ORF_WAIT_REFRESH
 (1 << 1Ë

	)

841 
	#PEER_STATUS_DEFAULT_ORIGINATE
 (1 << 2Ë

	)

842 
	#PEER_STATUS_PREFIX_THRESHOLD
 (1 << 3Ë

	)

843 
	#PEER_STATUS_PREFIX_LIMIT
 (1 << 4Ë

	)

844 
	#PEER_STATUS_EOR_SEND
 (1 << 5Ë

	)

845 
	#PEER_STATUS_EOR_RECEIVED
 (1 << 6Ë

	)

848 
u_öt32_t
 
	mc⁄fig
;

849 
	#PEER_CONFIG_WEIGHT
 (1 << 0Ë

	)

850 
	#PEER_CONFIG_TIMER
 (1 << 1Ë

	)

851 
	#PEER_CONFIG_CONNECT
 (1 << 2Ë

	)

852 
	#PEER_CONFIG_ROUTEADV
 (1 << 3Ë

	)

853 
u_öt32_t
 
	mweight
;

854 
u_öt32_t
 
	mhﬁdtime
;

855 
u_öt32_t
 
	mkì∑live
;

856 
u_öt32_t
 
	mc⁄√˘
;

857 
u_öt32_t
 
	mrouãadv
;

860 
u_öt32_t
 
	mv_°¨t
;

861 
u_öt32_t
 
	mv_c⁄√˘
;

862 
u_öt32_t
 
	mv_hﬁdtime
;

863 
u_öt32_t
 
	mv_kì∑live
;

864 
u_öt32_t
 
	mv_as‹ig
;

865 
u_öt32_t
 
	mv_rouãadv
;

866 
u_öt32_t
 
	mv_pmax_ª°¨t
;

867 
u_öt32_t
 
	mv_gr_ª°¨t
;

870 
thªad
 *
	mt_ªad
;

871 
thªad
 *
	mt_wrôe
;

872 
thªad
 *
	mt_°¨t
;

873 
thªad
 *
	mt_c⁄√˘
;

874 
thªad
 *
	mt_hﬁdtime
;

875 
thªad
 *
	mt_kì∑live
;

876 
thªad
 *
	mt_as‹ig
;

877 
thªad
 *
	mt_rouãadv
;

878 
thªad
 *
	mt_pmax_ª°¨t
;

879 
thªad
 *
	mt_gr_ª°¨t
;

880 
thªad
 *
	mt_gr_°Æe
;

883 
w‹k_queue
 *
	m˛ór_node_queue
;

886 
u_öt32_t
 
	m›í_ö
;

887 
u_öt32_t
 
	m›í_out
;

888 
u_öt32_t
 
	mupd©e_ö
;

889 
u_öt32_t
 
	mupd©e_out
;

890 
time_t
 
	mupd©e_time
;

891 
u_öt32_t
 
	mkì∑live_ö
;

892 
u_öt32_t
 
	mkì∑live_out
;

893 
u_öt32_t
 
	mnŸify_ö
;

894 
u_öt32_t
 
	mnŸify_out
;

895 
u_öt32_t
 
	mª‰esh_ö
;

896 
u_öt32_t
 
	mª‰esh_out
;

897 
u_öt32_t
 
	mdy«mic_ˇp_ö
;

898 
u_öt32_t
 
	mdy«mic_ˇp_out
;

901 
u_öt32_t
 
	me°ablished
;

902 
u_öt32_t
 
	mdr›≥d
;

905 
bgp_synchr⁄ize
 *
	msync
[
AFI_MAX
][
SAFI_MAX
];

906 
time_t
 
	msyn˘ime
;

909 
	mscou¡
[
AFI_MAX
][
SAFI_MAX
];

912 
hash
 *
	mhash
[
AFI_MAX
][
SAFI_MAX
];

915 
bgp_nŸify
 
	mnŸify
;

918 
	m∑ckë_size
;

921 
bgp_fûãr
 
	mfûãr
[
AFI_MAX
][
SAFI_MAX
];

924 
¥efix_li°
 *
	m‹f_∂i°
[
AFI_MAX
][
SAFI_MAX
];

926 #ifde‡
USE_SRX


929 
boﬁ
 
	mbgp£c_migøã
;

933 
	mpcou¡
[
AFI_MAX
][
SAFI_MAX
];

936 
	mpmax
[
AFI_MAX
][
SAFI_MAX
];

937 
u_ch¨
 
	mpmax_thªshﬁd
[
AFI_MAX
][
SAFI_MAX
];

938 
u_öt16_t
 
	mpmax_ª°¨t
[
AFI_MAX
][
SAFI_MAX
];

939 
	#MAXIMUM_PREFIX_THRESHOLD_DEFAULT
 75

	)

942 
	mÆlowas_ö
[
AFI_MAX
][
SAFI_MAX
];

945 
	mœ°_ª£t
;

946 
	#PEER_DOWN_RID_CHANGE
 1

	)

947 
	#PEER_DOWN_REMOTE_AS_CHANGE
 2

	)

948 
	#PEER_DOWN_LOCAL_AS_CHANGE
 3

	)

949 
	#PEER_DOWN_CLID_CHANGE
 4

	)

950 
	#PEER_DOWN_CONFED_ID_CHANGE
 5

	)

951 
	#PEER_DOWN_CONFED_PEER_CHANGE
 6

	)

952 
	#PEER_DOWN_RR_CLIENT_CHANGE
 7

	)

953 
	#PEER_DOWN_RS_CLIENT_CHANGE
 8

	)

954 
	#PEER_DOWN_UPDATE_SOURCE_CHANGE
 9

	)

955 
	#PEER_DOWN_AF_ACTIVATE
 10

	)

956 
	#PEER_DOWN_USER_SHUTDOWN
 11

	)

957 
	#PEER_DOWN_USER_RESET
 12

	)

958 
	#PEER_DOWN_NOTIFY_RECEIVED
 13

	)

959 
	#PEER_DOWN_NOTIFY_SEND
 14

	)

960 
	#PEER_DOWN_CLOSE_SESSION
 15

	)

961 
	#PEER_DOWN_NEIGHBOR_DELETE
 16

	)

962 
	#PEER_DOWN_RMAP_BIND
 17

	)

963 
	#PEER_DOWN_RMAP_UNBIND
 18

	)

964 
	#PEER_DOWN_CAPABILITY_CHANGE
 19

	)

965 
	#PEER_DOWN_PASSIVE_CHANGE
 20

	)

966 
	#PEER_DOWN_MULTIHOP_CHANGE
 21

	)

967 
	#PEER_DOWN_NSF_CLOSE_SESSION
 22

	)

970 
u_ch¨
 
	mrm≠_ty≥
;

971 
	#PEER_RMAP_TYPE_IN
 (1 << 0Ë

	)

972 
	#PEER_RMAP_TYPE_OUT
 (1 << 1Ë

	)

973 
	#PEER_RMAP_TYPE_NETWORK
 (1 << 2Ë

	)

974 
	#PEER_RMAP_TYPE_REDISTRIBUTE
 (1 << 3Ë

	)

975 
	#PEER_RMAP_TYPE_DEFAULT
 (1 << 4Ë

	)

976 
	#PEER_RMAP_TYPE_NOSET
 (1 << 5Ë

	)

977 
	#PEER_RMAP_TYPE_IMPORT
 (1 << 6Ë

	)

978 
	#PEER_RMAP_TYPE_EXPORT
 (1 << 7Ë

	)

981 
	#PEER_PASSWORD_MINLEN
 (1)

	)

982 
	#PEER_PASSWORD_MAXLEN
 (80)

	)

986 
	sbgp_∆ri


989 
afi_t
 
	mafi
;

992 
ßfi_t
 
	mßfi
;

995 
u_ch¨
 *
	m∆ri
;

998 
bgp_size_t
 
	mÀngth
;

1002 
	#BGP_VERSION_4
 4

	)

1005 
	#BGP_PORT_DEFAULT
 179

	)

1008 
	#BGP_MARKER_SIZE
 16

	)

1009 
	#BGP_HEADER_SIZE
 19

	)

1010 
	#BGP_MAX_PACKET_SIZE
 4096

	)

1011 #ifde‡
USE_SRX


1012 
	#BGP_MAX_PACKET_SIZE_EXTENDED
 65535

	)

1016 
	#BGP_MSG_OPEN_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 10)

	)

1017 
	#BGP_MSG_UPDATE_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 4)

	)

1018 
	#BGP_MSG_NOTIFY_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 2)

	)

1019 
	#BGP_MSG_KEEPALIVE_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 0)

	)

1020 
	#BGP_MSG_ROUTE_REFRESH_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 4)

	)

1021 
	#BGP_MSG_CAPABILITY_MIN_SIZE
 (
BGP_HEADER_SIZE
 + 3)

	)

1024 
	#BGP_MSG_OPEN
 1

	)

1025 
	#BGP_MSG_UPDATE
 2

	)

1026 
	#BGP_MSG_NOTIFY
 3

	)

1027 
	#BGP_MSG_KEEPALIVE
 4

	)

1028 
	#BGP_MSG_ROUTE_REFRESH_NEW
 5

	)

1029 
	#BGP_MSG_CAPABILITY
 6

	)

1030 
	#BGP_MSG_ROUTE_REFRESH_OLD
 128

	)

1033 
	#BGP_OPEN_OPT_AUTH
 1

	)

1034 
	#BGP_OPEN_OPT_CAP
 2

	)

1037 
	#BGP_ATTR_ORIGIN
 1

	)

1038 
	#BGP_ATTR_AS_PATH
 2

	)

1039 
	#BGP_ATTR_NEXT_HOP
 3

	)

1040 
	#BGP_ATTR_MULTI_EXIT_DISC
 4

	)

1041 
	#BGP_ATTR_LOCAL_PREF
 5

	)

1042 
	#BGP_ATTR_ATOMIC_AGGREGATE
 6

	)

1043 
	#BGP_ATTR_AGGREGATOR
 7

	)

1044 
	#BGP_ATTR_COMMUNITIES
 8

	)

1045 
	#BGP_ATTR_ORIGINATOR_ID
 9

	)

1046 
	#BGP_ATTR_CLUSTER_LIST
 10

	)

1047 
	#BGP_ATTR_DPA
 11

	)

1048 
	#BGP_ATTR_ADVERTISER
 12

	)

1049 
	#BGP_ATTR_RCID_PATH
 13

	)

1050 
	#BGP_ATTR_MP_REACH_NLRI
 14

	)

1051 
	#BGP_ATTR_MP_UNREACH_NLRI
 15

	)

1052 
	#BGP_ATTR_EXT_COMMUNITIES
 16

	)

1053 
	#BGP_ATTR_AS4_PATH
 17

	)

1054 
	#BGP_ATTR_AS4_AGGREGATOR
 18

	)

1055 
	#BGP_ATTR_AS_PATHLIMIT
 21

	)

1056 #i‡
deföed
(
USE_SRX
Ë&& !deföed(
BGP_ATTR_BGPSEC
)

1057 
	#BGP_ATTR_BGPSEC
 33

	)

1061 
	#BGP_ORIGIN_IGP
 0

	)

1062 
	#BGP_ORIGIN_EGP
 1

	)

1063 
	#BGP_ORIGIN_INCOMPLETE
 2

	)

1066 
	#BGP_NOTIFY_HEADER_ERR
 1

	)

1067 
	#BGP_NOTIFY_OPEN_ERR
 2

	)

1068 
	#BGP_NOTIFY_UPDATE_ERR
 3

	)

1069 
	#BGP_NOTIFY_HOLD_ERR
 4

	)

1070 
	#BGP_NOTIFY_FSM_ERR
 5

	)

1071 
	#BGP_NOTIFY_CEASE
 6

	)

1072 
	#BGP_NOTIFY_CAPABILITY_ERR
 7

	)

1073 
	#BGP_NOTIFY_MAX
 8

	)

1075 
	#BGP_NOTIFY_SUBCODE_UNSPECIFIC
 0

	)

1078 
	#BGP_NOTIFY_HEADER_NOT_SYNC
 1

	)

1079 
	#BGP_NOTIFY_HEADER_BAD_MESLEN
 2

	)

1080 
	#BGP_NOTIFY_HEADER_BAD_MESTYPE
 3

	)

1081 
	#BGP_NOTIFY_HEADER_MAX
 4

	)

1084 
	#BGP_NOTIFY_OPEN_UNSUP_VERSION
 1

	)

1085 
	#BGP_NOTIFY_OPEN_BAD_PEER_AS
 2

	)

1086 
	#BGP_NOTIFY_OPEN_BAD_BGP_IDENT
 3

	)

1087 
	#BGP_NOTIFY_OPEN_UNSUP_PARAM
 4

	)

1088 
	#BGP_NOTIFY_OPEN_AUTH_FAILURE
 5

	)

1089 
	#BGP_NOTIFY_OPEN_UNACEP_HOLDTIME
 6

	)

1090 
	#BGP_NOTIFY_OPEN_UNSUP_CAPBL
 7

	)

1091 #ifde‡
USE_SRX


1092 
	#BGP_NOTIFY_OPEN_UNSUP_BGPSEC
 8

	)

1094 
	#BGP_NOTIFY_OPEN_MAX
 9

	)

1097 
	#BGP_NOTIFY_UPDATE_MAL_ATTR
 1

	)

1098 
	#BGP_NOTIFY_UPDATE_UNREC_ATTR
 2

	)

1099 
	#BGP_NOTIFY_UPDATE_MISS_ATTR
 3

	)

1100 
	#BGP_NOTIFY_UPDATE_ATTR_FLAG_ERR
 4

	)

1101 
	#BGP_NOTIFY_UPDATE_ATTR_LENG_ERR
 5

	)

1102 
	#BGP_NOTIFY_UPDATE_INVAL_ORIGIN
 6

	)

1103 
	#BGP_NOTIFY_UPDATE_AS_ROUTE_LOOP
 7

	)

1104 
	#BGP_NOTIFY_UPDATE_INVAL_NEXT_HOP
 8

	)

1105 
	#BGP_NOTIFY_UPDATE_OPT_ATTR_ERR
 9

	)

1106 
	#BGP_NOTIFY_UPDATE_INVAL_NETWORK
 10

	)

1107 
	#BGP_NOTIFY_UPDATE_MAL_AS_PATH
 11

	)

1108 
	#BGP_NOTIFY_UPDATE_MAX
 12

	)

1111 
	#BGP_NOTIFY_CEASE_MAX_PREFIX
 1

	)

1112 
	#BGP_NOTIFY_CEASE_ADMIN_SHUTDOWN
 2

	)

1113 
	#BGP_NOTIFY_CEASE_PEER_UNCONFIG
 3

	)

1114 
	#BGP_NOTIFY_CEASE_ADMIN_RESET
 4

	)

1115 
	#BGP_NOTIFY_CEASE_CONNECT_REJECT
 5

	)

1116 
	#BGP_NOTIFY_CEASE_CONFIG_CHANGE
 6

	)

1117 
	#BGP_NOTIFY_CEASE_COLLISION_RESOLUTION
 7

	)

1118 
	#BGP_NOTIFY_CEASE_OUT_OF_RESOURCE
 8

	)

1119 
	#BGP_NOTIFY_CEASE_MAX
 9

	)

1122 
	#BGP_NOTIFY_CAPABILITY_INVALID_ACTION
 1

	)

1123 
	#BGP_NOTIFY_CAPABILITY_INVALID_LENGTH
 2

	)

1124 
	#BGP_NOTIFY_CAPABILITY_MALFORMED_CODE
 3

	)

1125 
	#BGP_NOTIFY_CAPABILITY_MAX
 4

	)

1128 
	#IdÀ
 1

	)

1129 
	#C⁄√˘
 2

	)

1130 
	#A˘ive
 3

	)

1131 
	#O≥nSít
 4

	)

1132 
	#O≥nC⁄fúm
 5

	)

1133 
	#E°ablished
 6

	)

1134 
	#CÀ¨ög
 7

	)

1135 
	#Dñëed
 8

	)

1136 
	#BGP_STATUS_MAX
 9

	)

1139 
	#BGP_Sèπ
 1

	)

1140 
	#BGP_St›
 2

	)

1141 
	#TCP_c⁄√˘i⁄_›í
 3

	)

1142 
	#TCP_c⁄√˘i⁄_˛o£d
 4

	)

1143 
	#TCP_c⁄√˘i⁄_›í_Áûed
 5

	)

1144 
	#TCP_Áèl_îr‹
 6

	)

1145 
	#C⁄√˘Rëry_timî_expúed
 7

	)

1146 
	#Hﬁd_Timî_expúed
 8

	)

1147 
	#KìpAlive_timî_expúed
 9

	)

1148 
	#Re˚ive_OPEN_mesßge
 10

	)

1149 
	#Re˚ive_KEEPALIVE_mesßge
 11

	)

1150 
	#Re˚ive_UPDATE_mesßge
 12

	)

1151 
	#Re˚ive_NOTIFICATION_mesßge
 13

	)

1152 
	#CÀ¨ög_Com∂ëed
 14

	)

1153 
	#BGP_EVENTS_MAX
 15

	)

1156 
	#BGP_INIT_START_TIMER
 5

	)

1157 
	#BGP_ERROR_START_TIMER
 30

	)

1158 
	#BGP_DEFAULT_HOLDTIME
 180

	)

1159 
	#BGP_DEFAULT_KEEPALIVE
 60

	)

1160 
	#BGP_DEFAULT_ASORIGINATE
 15

	)

1161 
	#BGP_DEFAULT_EBGP_ROUTEADV
 30

	)

1162 
	#BGP_DEFAULT_IBGP_ROUTEADV
 5

	)

1163 
	#BGP_CLEAR_CONNECT_RETRY
 20

	)

1164 
	#BGP_DEFAULT_CONNECT_RETRY
 120

	)

1167 
	#BGP_DEFAULT_LOCAL_PREF
 100

	)

1170 
	#BGP_DEFAULT_RESTART_TIME
 120

	)

1171 
	#BGP_DEFAULT_STALEPATH_TIME
 360

	)

1174 
	#SAFI_MPLS_LABELED_VPN
 128

	)

1177 
	#TTL_MAX
 255

	)

1180 
	#BGP_UPTIME_LEN
 25

	)

1183 
	#BGP_VTY_PORT
 2605

	)

1184 
	#BGP_DEFAULT_CONFIG
 "bgpd.c⁄f"

	)

1190 
	ebgp_˛ór_ty≥


1192 
	mBGP_CLEAR_SOFT_NONE
,

1193 
	mBGP_CLEAR_SOFT_OUT
,

1194 
	mBGP_CLEAR_SOFT_IN
,

1195 
	mBGP_CLEAR_SOFT_BOTH
,

1196 
	mBGP_CLEAR_SOFT_IN_ORF_PREFIX
,

1197 
	mBGP_CLEAR_SOFT_RSCLIENT


1201 
	#BGP_INPUT
(
P
Ë((P)->
ibuf
)

	)

1202 
	#BGP_INPUT_PNT
(
P
Ë(
	`STREAM_PNT
(
	`BGP_INPUT
(P)))

	)

1205 
	#PSIZE
(
a
Ë((◊Ë+ 7Ë/ (8))

	)

1208 
	#BGP_SUCCESS
 0

	)

1209 
	#BGP_ERR_INVALID_VALUE
 -1

	)

1210 
	#BGP_ERR_INVALID_FLAG
 -2

	)

1211 
	#BGP_ERR_INVALID_AS
 -3

	)

1212 
	#BGP_ERR_INVALID_BGP
 -4

	)

1213 
	#BGP_ERR_PEER_GROUP_MEMBER
 -5

	)

1214 
	#BGP_ERR_MULTIPLE_INSTANCE_USED
 -6

	)

1215 
	#BGP_ERR_PEER_GROUP_MEMBER_EXISTS
 -7

	)

1216 
	#BGP_ERR_PEER_BELONGS_TO_GROUP
 -8

	)

1217 
	#BGP_ERR_PEER_GROUP_AF_UNCONFIGURED
 -9

	)

1218 
	#BGP_ERR_PEER_GROUP_NO_REMOTE_AS
 -10

	)

1219 
	#BGP_ERR_PEER_GROUP_CANT_CHANGE
 -11

	)

1220 
	#BGP_ERR_PEER_GROUP_MISMATCH
 -12

	)

1221 
	#BGP_ERR_PEER_GROUP_PEER_TYPE_DIFFERENT
 -13

	)

1222 
	#BGP_ERR_MULTIPLE_INSTANCE_NOT_SET
 -14

	)

1223 
	#BGP_ERR_AS_MISMATCH
 -15

	)

1224 
	#BGP_ERR_PEER_INACTIVE
 -16

	)

1225 
	#BGP_ERR_INVALID_FOR_PEER_GROUP_MEMBER
 -17

	)

1226 
	#BGP_ERR_PEER_GROUP_HAS_THE_FLAG
 -18

	)

1227 
	#BGP_ERR_PEER_FLAG_CONFLICT
 -19

	)

1228 
	#BGP_ERR_PEER_GROUP_SHUTDOWN
 -20

	)

1229 
	#BGP_ERR_PEER_FILTER_CONFLICT
 -21

	)

1230 
	#BGP_ERR_NOT_INTERNAL_PEER
 -22

	)

1231 
	#BGP_ERR_REMOVE_PRIVATE_AS
 -23

	)

1232 
	#BGP_ERR_AF_UNCONFIGURED
 -24

	)

1233 
	#BGP_ERR_SOFT_RECONFIG_UNCONFIGURED
 -25

	)

1234 
	#BGP_ERR_INSTANCE_MISMATCH
 -26

	)

1235 
	#BGP_ERR_LOCAL_AS_ALLOWED_ONLY_FOR_EBGP
 -27

	)

1236 
	#BGP_ERR_CANNOT_HAVE_LOCAL_AS_SAME_AS
 -28

	)

1237 
	#BGP_ERR_TCPSIG_FAILED
 -29

	)

1238 
	#BGP_ERR_NO_EBGP_MULTIHOP_WITH_TTLHACK
 -30

	)

1239 
	#BGP_ERR_NO_IBGP_WITH_TTLHACK
 -31

	)

1240 
	#BGP_ERR_MAX
 -32

	)

1241 
	#BGP_ERR_CANNOT_HAVE_LOCAL_AS_SAME_AS_REMOTE_AS
 -33

	)

1243 
bgp_ma°î
 *
bm
;

1245 #i‡
deföed
 (
__TIME_MEASURE__
)

1246 
	gg_mósuªCou¡
;

1249 
thªad_ma°î
 *
ma°î
;

1252 
bgp_ãrmö©e
 ();

1253 
bgp_ª£t
 ();

1254 
time_t
 
bgp_˛ock
 ();

1255 
bgp_z˛õ¡_ª£t
 ();

1256 
bgp_√xth›_£t
 (
sockuni⁄
 *, sockunion *,

1257 
bgp_√xth›
 *, 
≥î
 *);

1258 
bgp
 *
bgp_gë_deÁu…
 ();

1259 
bgp
 *
bgp_lookup
 (
as_t
, const *);

1260 
bgp
 *
bgp_lookup_by_«me
 (const *);

1261 
≥î
 *
≥î_lookup
 (
bgp
 *, 
sockuni⁄
 *);

1262 
≥î_group
 *
≥î_group_lookup
 (
bgp
 *, const *);

1263 
≥î_group
 *
≥î_group_gë
 (
bgp
 *, const *);

1264 
≥î
 *
≥î_lookup_wôh_›í
 (
sockuni⁄
 *, 
as_t
, 
ö_addr
 *,

1266 
≥î
 *
≥î_lock
 (peer *);

1267 
≥î
 *
≥î_u∆ock
 (peer *);

1268 
bgp_≥î_s‹t_t
 
≥î_s‹t
 (
≥î
 *peer);

1269 
≥î_a˘ive
 (
≥î
 *);

1270 
≥î_a˘ive_√go
 (
≥î
 *);

1271 
≥î
 *
≥î_¸óã_ac˚±
 (
bgp
 *);

1272 *
≥î_u±ime
 (
time_t
, *, 
size_t
);

1273 
bgp_c⁄fig_wrôe
 (
vty
 *);

1274 
bgp_c⁄fig_wrôe_Ámûy_hódî
 (
vty
 *, 
afi_t
, 
ßfi_t
, *);

1276 
bgp_ma°î_öô
 ();

1278 
bgp_öô
 ();

1279 
bgp_rouã_m≠_öô
 ();

1281 
bgp_›ti⁄_£t
 ();

1282 
bgp_›ti⁄_un£t
 ();

1283 
bgp_›ti⁄_check
 ();

1285 
bgp_gë
 (
bgp
 **, 
as_t
 *, const *);

1286 
bgp_dñëe
 (
bgp
 *);

1288 
bgp_Êag_£t
 (
bgp
 *, );

1289 
bgp_Êag_un£t
 (
bgp
 *, );

1290 
bgp_Êag_check
 (
bgp
 *, );

1292 
bgp_lock
 (
bgp
 *);

1293 
bgp_u∆ock
 (
bgp
 *);

1295 
bgp_rouãr_id_£t
 (
bgp
 *, 
ö_addr
 *);

1297 
bgp_˛u°î_id_£t
 (
bgp
 *, 
ö_addr
 *);

1298 
bgp_˛u°î_id_un£t
 (
bgp
 *);

1300 
bgp_c⁄„dî©i⁄_id_£t
 (
bgp
 *, 
as_t
);

1301 
bgp_c⁄„dî©i⁄_id_un£t
 (
bgp
 *);

1302 
bgp_c⁄„dî©i⁄_≥îs_check
 (
bgp
 *, 
as_t
);

1304 
bgp_c⁄„dî©i⁄_≥îs_add
 (
bgp
 *, 
as_t
);

1305 
bgp_c⁄„dî©i⁄_≥îs_ªmove
 (
bgp
 *, 
as_t
);

1307 
bgp_timîs_£t
 (
bgp
 *, 
u_öt32_t
, u_int32_t);

1308 
bgp_timîs_un£t
 (
bgp
 *);

1310 
bgp_deÁu…_loˇl_¥e„ªn˚_£t
 (
bgp
 *, 
u_öt32_t
);

1311 
bgp_deÁu…_loˇl_¥e„ªn˚_un£t
 (
bgp
 *);

1313 #ifde‡
USE_SRX


1314 
bgp_§x_£t
 (
bgp
 *, 
vty
 *, c⁄° *, , 
boﬁ
);

1315 
bgp_§x_un£t
 (
bgp
 *bgp);

1318 
bgp_§x_evÆu©i⁄
 (
bgp
 *, );

1319 
bgp_§x_di•œy
 (
bgp
 *bgp, );

1320 
bgp_§x_c⁄f_deÁu…_ªsu…
 (
bgp
 *bgp, , );

1323 
§x_£t_¥oxyID
(
bgp
* , 
uöt32_t
);

1325 
§x_vÆ_loˇl_¥e„ªn˚_£t
 (
bgp
 *, , , 
uöt32_t
);

1326 
§x_vÆ_loˇl_¥e„ªn˚_un£t
 (
bgp
 *, );

1327 
§x_vÆ_pﬁicy_£t
 (
bgp
 *, 
uöt16_t
);

1328 
§x_vÆ_pﬁicy_un£t
 (
bgp
 *, 
uöt16_t
);

1330 
§x_extcommunôy_£t
 (
bgp
 *, 
uöt8_t
, const *);

1331 
§x_extcommunôy_un£t
 (
bgp
 *);

1333 
§x_c⁄fig_check
 (
bgp
 *, 
uöt16_t
);

1335 
§x_c⁄√˘_¥oxy
(
bgp
 *);

1336 
	#DEBUG_TEST


	)

1339 
≥î_rs˛õ¡_a˘ive
 (
≥î
 *);

1341 
≥î_ªmŸe_as
 (
bgp
 *, 
sockuni⁄
 *, 
as_t
 *, 
afi_t
, 
ßfi_t
);

1342 
≥î_group_ªmŸe_as
 (
bgp
 *, c⁄° *, 
as_t
 *);

1343 
≥î_dñëe
 (
≥î
 *peer);

1344 
≥î_group_dñëe
 (
≥î_group
 *);

1345 
≥î_group_ªmŸe_as_dñëe
 (
≥î_group
 *);

1347 
≥î_a˘iv©e
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1348 
≥î_dó˘iv©e
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1350 
≥î_group_böd
 (
bgp
 *, 
sockuni⁄
 *, 
≥î_group
 *,

1351 
afi_t
, 
ßfi_t
, 
as_t
 *);

1352 
≥î_group_unböd
 (
bgp
 *, 
≥î
 *, 
≥î_group
 *,

1353 
afi_t
, 
ßfi_t
);

1355 
≥î_Êag_£t
 (
≥î
 *, 
u_öt32_t
);

1356 
≥î_Êag_un£t
 (
≥î
 *, 
u_öt32_t
);

1358 
≥î_af_Êag_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
);

1359 
≥î_af_Êag_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
);

1360 
≥î_af_Êag_check
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
);

1362 
≥î_ebgp_mu…ih›_£t
 (
≥î
 *, );

1363 
≥î_ebgp_mu…ih›_un£t
 (
≥î
 *);

1365 
≥î_des¸ùti⁄_£t
 (
≥î
 *, *);

1366 
≥î_des¸ùti⁄_un£t
 (
≥î
 *);

1368 
≥î_upd©e_sour˚_if_£t
 (
≥î
 *, const *);

1369 
≥î_upd©e_sour˚_addr_£t
 (
≥î
 *, 
sockuni⁄
 *);

1370 
≥î_upd©e_sour˚_un£t
 (
≥î
 *);

1372 
≥î_deÁu…_‹igö©e_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, const *);

1373 
≥î_deÁu…_‹igö©e_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1375 
≥î_p‹t_£t
 (
≥î
 *, 
u_öt16_t
);

1376 
≥î_p‹t_un£t
 (
≥î
 *);

1378 
≥î_weight_£t
 (
≥î
 *, 
u_öt16_t
);

1379 
≥î_weight_un£t
 (
≥î
 *);

1381 
≥î_timîs_£t
 (
≥î
 *, 
u_öt32_t
, u_int32_t);

1382 
≥î_timîs_un£t
 (
≥î
 *);

1384 
≥î_timîs_c⁄√˘_£t
 (
≥î
 *, 
u_öt32_t
);

1385 
≥î_timîs_c⁄√˘_un£t
 (
≥î
 *);

1387 
≥î_advîti£_öãrvÆ_£t
 (
≥î
 *, 
u_öt32_t
);

1388 
≥î_advîti£_öãrvÆ_un£t
 (
≥î
 *);

1390 
≥î_öãrÁ˚_£t
 (
≥î
 *, const *);

1391 
≥î_öãrÁ˚_un£t
 (
≥î
 *);

1393 
≥î_di°ribuã_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1394 
≥î_di°ribuã_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1396 
≥î_Ælowas_ö_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1397 
≥î_Ælowas_ö_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1399 
≥î_loˇl_as_£t
 (
≥î
 *, 
as_t
, , );

1400 
≥î_loˇl_as_un£t
 (
≥î
 *);

1402 
≥î_¥efix_li°_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1403 
≥î_¥efix_li°_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1405 
≥î_a¶i°_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1406 
≥î_a¶i°_un£t
 (
≥î
 *,
afi_t
, 
ßfi_t
, );

1408 
≥î_rouã_m≠_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, , const *);

1409 
≥î_rouã_m≠_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, );

1411 
≥î_unsuµªss_m≠_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, const *);

1413 
≥î_∑ssw‹d_£t
 (
≥î
 *, const *);

1414 
≥î_∑ssw‹d_un£t
 (
≥î
 *);

1416 
≥î_unsuµªss_m≠_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1418 
≥î_maximum_¥efix_£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
u_öt32_t
, 
u_ch¨
, , 
u_öt16_t
);

1419 
≥î_maximum_¥efix_un£t
 (
≥î
 *, 
afi_t
, 
ßfi_t
);

1421 
≥î_˛ór
 (
≥î
 *);

1422 
≥î_˛ór_so·
 (
≥î
 *, 
afi_t
, 
ßfi_t
, 
bgp_˛ór_ty≥
);

1424 
≥î_âl_£curôy_h›s_£t
 (
≥î
 *, );

1425 
≥î_âl_£curôy_h›s_un£t
 (
≥î
 *);

	@config.h

8 
	#BABEL_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/babñd.vty"

	)

11 
	#BGP_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/bgpd.vty"

	)

17 
	#CONFIGFILE_MASK
 0644

	)

20 
	#CONSUMED_TIME_CHECK
 5000000

	)

23 
	#DAEMON_VTY_DIR
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc"

	)

26 
	#DISABLE_BGP_ANNOUNCE
 0

	)

32 
	#GNU_LINUX


	)

35 
	#HAVE_ALARM
 1

	)

38 
	#HAVE_ARPA_INET_H
 1

	)

41 
	#HAVE_ASM_TYPES_H
 1

	)

62 
	#HAVE_CHOWN
 1

	)

65 
	#HAVE_CLOCK_MONOTONIC


	)

68 
	#HAVE_DAEMON
 1

	)

72 
	#HAVE_DECL_TCP_MD5SIG
 1

	)

75 
	#HAVE_DLFCN_H
 1

	)

81 
	#HAVE_DUP2
 1

	)

84 
	#HAVE_FCNTL
 1

	)

87 
	#HAVE_FCNTL_H
 1

	)

90 
	#HAVE_FNMATCH
 1

	)

93 
	#HAVE_FORK
 1

	)

99 
	#HAVE_FTRUNCATE
 1

	)

102 
	#HAVE_GETADDRINFO
 1

	)

105 
	#HAVE_GETCWD
 1

	)

108 
	#HAVE_GETHOSTBYNAME
 1

	)

111 
	#HAVE_GETIFADDRS
 1

	)

114 
	#HAVE_GETPAGESIZE
 1

	)

117 
	#HAVE_GETTIMEOFDAY
 1

	)

120 
	#HAVE_GLIBC_BACKTRACE


	)

123 
	#HAVE_GNU_REGEX


	)

126 
	#HAVE_IF_INDEXTONAME
 1

	)

129 
	#HAVE_IF_NAMETOINDEX
 1

	)

132 
	#HAVE_INET_ATON
 1

	)

138 
	#HAVE_INET_NTOA
 1

	)

141 
	#HAVE_INET_NTOP


	)

144 
	#HAVE_INET_PTON


	)

147 
	#HAVE_INTTYPES_H
 1

	)

150 
	#HAVE_IPV6
 1

	)

153 
	#HAVE_IRDP


	)

162 
	#HAVE_LIBCRYPT
 1

	)

168 
	#HAVE_LIBM


	)

189 
	#HAVE_LIMITS_H
 1

	)

192 
	#HAVE_LINUX_VERSION_H
 1

	)

195 
	#HAVE_MALLINFO


	)

198 
	#HAVE_MEMCHR
 1

	)

201 
	#HAVE_MEMMOVE
 1

	)

204 
	#HAVE_MEMORY_H
 1

	)

207 
	#HAVE_MEMSET
 1

	)

210 
	#HAVE_NETDB_H
 1

	)

222 
	#HAVE_NETINET_ICMP6_H
 1

	)

228 
	#HAVE_NETINET_IN_H
 1

	)

231 
	#HAVE_NETINET_IN_SYSTM_H
 1

	)

237 
	#HAVE_NETINET_IP_ICMP_H
 1

	)

240 
	#HAVE_NETLINK


	)

246 
	#HAVE_NET_IF_H
 1

	)

255 
	#HAVE_NET_ROUTE_H
 1

	)

261 
	#HAVE_OPAQUE_LSA


	)

267 
	#HAVE_OSPF_TE


	)

273 
	#HAVE_POW
 1

	)

288 
	#HAVE_PR_SET_KEEPCAPS


	)

291 
	#HAVE_RFC3678
 1

	)

294 
	#HAVE_RTADV


	)

297 
	#HAVE_RUSAGE


	)

300 
	#HAVE_SELECT
 1

	)

306 
	#HAVE_SIGNAL_H
 1

	)

312 
	#HAVE_SNPRINTF
 1

	)

315 
	#HAVE_SOCKET
 1

	)

318 
	#HAVE_SOCKLEN_T
 1

	)

324 
	#HAVE_STACK_TRACE


	)

331 
	#HAVE_STDDEF_H
 1

	)

334 
	#HAVE_STDINT_H
 1

	)

337 
	#HAVE_STDLIB_H
 1

	)

340 
	#HAVE_STRCASECMP
 1

	)

343 
	#HAVE_STRCHR
 1

	)

346 
	#HAVE_STRCSPN
 1

	)

349 
	#HAVE_STRDUP
 1

	)

352 
	#HAVE_STRERROR
 1

	)

355 
	#HAVE_STRFTIME
 1

	)

358 
	#HAVE_STRINGS_H
 1

	)

361 
	#HAVE_STRING_H
 1

	)

370 
	#HAVE_STRNCASECMP
 1

	)

373 
	#HAVE_STRNDUP
 1

	)

376 
	#HAVE_STRNLEN
 1

	)

382 
	#HAVE_STRRCHR
 1

	)

385 
	#HAVE_STRSPN
 1

	)

388 
	#HAVE_STRSTR
 1

	)

391 
	#HAVE_STRTOL
 1

	)

394 
	#HAVE_STRTOUL
 1

	)

397 
	#HAVE_STRUCT_ICMPHDR
 1

	)

418 
	#HAVE_STRUCT_IN_PKTINFO
 1

	)

421 
	#HAVE_STRUCT_IP_MREQN_IMR_IFINDEX
 1

	)

424 
	#HAVE_STRUCT_ND_OPT_ADV_INTERVAL
 1

	)

437 
	#HAVE_STRUCT_SOCKADDR
 1

	)

446 
	#HAVE_STRUCT_SOCKADDR_IN
 1

	)

449 
	#HAVE_STRUCT_SOCKADDR_IN6
 1

	)

452 
	#HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID
 1

	)

461 
	#HAVE_STRUCT_SOCKADDR_UN
 1

	)

467 
	#HAVE_SYSLOG_H
 1

	)

476 
	#HAVE_SYS_IOCTL_H
 1

	)

482 
	#HAVE_SYS_PARAM_H
 1

	)

485 
	#HAVE_SYS_SELECT_H
 1

	)

488 
	#HAVE_SYS_SOCKET_H
 1

	)

494 
	#HAVE_SYS_STAT_H
 1

	)

497 
	#HAVE_SYS_SYSCTL_H
 1

	)

500 
	#HAVE_SYS_TIMES_H
 1

	)

503 
	#HAVE_SYS_TIME_H
 1

	)

506 
	#HAVE_SYS_TYPES_H
 1

	)

509 
	#HAVE_SYS_UN_H
 1

	)

512 
	#HAVE_SYS_WAIT_H
 1

	)

515 
	#HAVE_SYS_WEAK_ALIAS
 1

	)

518 
	#HAVE_SYS_WEAK_ALIAS_ATTRIBUTE
 1

	)

524 
	#HAVE_SYS_WEAK_ALIAS_CROSSFILE
 1

	)

531 
	#HAVE_SYS_WEAK_ALIAS_PRAGMA
 1

	)

540 
	#HAVE_TIME_H
 1

	)

543 
	#HAVE_UCONTEXT_H
 1

	)

546 
	#HAVE_UNAME
 1

	)

549 
	#HAVE_UNISTD_H
 1

	)

552 
	#HAVE_VFORK
 1

	)

558 
	#HAVE_VPRINTF
 1

	)

561 
	#HAVE_VSNPRINTF
 1

	)

564 
	#HAVE_WCHAR_H
 1

	)

567 
	#HAVE_WCTYPE_H
 1

	)

570 
	#HAVE_WORKING_FORK
 1

	)

573 
	#HAVE_WORKING_VFORK
 1

	)

582 
	#ISIS_METHOD
 
ISIS_METHOD_PFPACKET


	)

585 
	#ISIS_METHOD_BPF
 3

	)

588 
	#ISIS_METHOD_DLPI
 2

	)

591 
	#ISIS_METHOD_PFPACKET
 1

	)

594 
	#ISIS_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/isisd.vty"

	)

600 
	#LINUX_IPV6
 1

	)

603 
	#LOGFILE_MASK
 0644

	)

607 
	#LSTAT_FOLLOWS_SLASHED_SYMLINK
 1

	)

611 
	#LT_OBJDIR
 ".libs/"

	)

626 
	#OSPF6_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•f6d.vty"

	)

629 
	#OSPF_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•fd.vty"

	)

632 
	#PACKAGE
 "quagga§x"

	)

635 
	#PACKAGE_BUGREPORT
 "hâp://bgp§x.™td.ni°.gov"

	)

638 
	#PACKAGE_NAME
 "QuaggaSRx"

	)

641 
	#PACKAGE_STRING
 "QuaggaSRx 0.4.2.7"

	)

644 
	#PACKAGE_TARNAME
 "quagga§x"

	)

647 
	#PACKAGE_URL
 ""

	)

650 
	#PACKAGE_VERSION
 "0.4.2.7"

	)

656 
	#PATH_BABELD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/babñd.pid"

	)

659 
	#PATH_BGPD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/bgpd.pid"

	)

662 
	#PATH_ISISD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/isisd.pid"

	)

665 
	#PATH_OSPF6D_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•f6d.pid"

	)

668 
	#PATH_OSPFD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/o•fd.pid"

	)

671 
	#PATH_RIPD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùd.pid"

	)

674 
	#PATH_RIPNGD_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùngd.pid"

	)

677 
	#PATH_WATCHQUAGGA_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/w©chquagga.pid"

	)

680 
	#PATH_ZEBRA_PID
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/zebø.pid"

	)

683 
	#QUAGGA_GROUP
 "roŸ"

	)

686 
	#QUAGGA_NO_DEPRECATED_INTERFACES
 1

	)

689 
	#QUAGGA_USER
 "roŸ"

	)

692 
	#RETSIGTYPE
 

	)

695 
	#RIPNG_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùngd.vty"

	)

698 
	#RIP_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/rùd.vty"

	)

701 
	#SELECT_TYPE_ARG1
 

	)

704 
	#SELECT_TYPE_ARG234
 (
fd_£t
 *)

	)

707 
	#SELECT_TYPE_ARG5
 (
timevÆ
 *)

	)

719 
	#STDC_HEADERS
 1

	)

734 
	#TIME_WITH_SYS_TIME
 1

	)

743 
	#USE_GRPC


	)

749 
	#USE_SRX


	)

752 #i‚de‡
_ALL_SOURCE


753 
	#_ALL_SOURCE
 1

	)

756 #i‚de‡
_GNU_SOURCE


757 
	#_GNU_SOURCE
 1

	)

760 #i‚de‡
_POSIX_PTHREAD_SEMANTICS


761 
	#_POSIX_PTHREAD_SEMANTICS
 1

	)

764 #i‚de‡
_TANDEM_SOURCE


765 
	#_TANDEM_SOURCE
 1

	)

768 #i‚de‡
__EXTENSIONS__


769 
	#__EXTENSIONS__
 1

	)

774 
	#VERSION
 "0.4.2.7"

	)

784 #i‡
deföed
 
AC_APPLE_UNIVERSAL_BUILD


785 #i‡
deföed
 
__BIG_ENDIAN__


786 
	#WORDS_BIGENDIAN
 1

	)

789 #i‚de‡
WORDS_BIGENDIAN


795 
	#ZEBRA_SERV_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/z£rv.≠i"

	)

798 
	#ZEBRA_VTYSH_PATH
 "/›t/¥oje˘/gobgp_ã°/gow‹k/§c/§x_gΩc/q§x/ã°_ö°Æl/ëc/zebø.vty"

	)

801 #i‚de‡
_DARWIN_USE_64_BIT_INODE


802 
	#_DARWIN_USE_64_BIT_INODE
 1

	)

829 #i‚de‡
__˝lu•lus


842 
	#ª°ri˘
 
__ª°ri˘


	)

848 #i‡
deföed
 
__SUNPRO_CC
 && !deföed 
__RESTRICT


849 
	#_Re°ri˘


	)

850 
	#__ª°ri˘__


	)

	@fpm/fpm.h

53 #i‚de‡
_FPM_H


54 
	#_FPM_H


	)

90 
	#FPM_DEFAULT_PORT
 2620

	)

95 
	#FPM_MAX_MSG_LEN
 4096

	)

100 
	sÂm_msg_hdr_t_


105 
uöt8_t
 
	mvîsi⁄
;

110 
uöt8_t
 
	mmsg_ty≥
;

120 
uöt16_t
 
	mmsg_Àn
;

121 } 
	tÂm_msg_hdr_t
;

126 
	#FPM_PROTO_VERSION
 1

	)

128 
	eÂm_msg_ty≥_e_
 {

129 
	mFPM_MSG_TYPE_NONE
 = 0,

135 
	mFPM_MSG_TYPE_NETLINK
 = 1,

136 } 
	tÂm_msg_ty≥_e
;

143 
	#FPM_MSG_ALIGNTO
 4

	)

150 
ölöe
 
size_t


151 
	$Âm_msg_Æign
 (
size_t
 
Àn
)

153  (
Àn
 + 
FPM_MSG_ALIGNTO
 - 1) & ~(FPM_MSG_ALIGNTO - 1);

154 
	}
}

160 
	#FPM_MSG_HDR_LEN
 (
	`Âm_msg_Æign
 ( (
Âm_msg_hdr_t
)))

	)

168 
ölöe
 
size_t


169 
	$Âm_d©a_Àn_to_msg_Àn
 (
size_t
 
d©a_Àn
)

171  
	`Âm_msg_Æign
 (
d©a_Àn
Ë+ 
FPM_MSG_HDR_LEN
;

172 
	}
}

179 
ölöe
 *

180 
	$Âm_msg_d©a
 (
Âm_msg_hdr_t
 *
hdr
)

182  ((*Ë
hdr
Ë+ 
FPM_MSG_HDR_LEN
;

183 
	}
}

188 
ölöe
 
size_t


189 
	$Âm_msg_Àn
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
)

191  
	`¡ohs
 (
hdr
->
msg_Àn
);

192 
	}
}

197 
ölöe
 
size_t


198 
	$Âm_msg_d©a_Àn
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
)

200  (
	`Âm_msg_Àn
 (
hdr
Ë- 
FPM_MSG_HDR_LEN
);

201 
	}
}

208 
ölöe
 
Âm_msg_hdr_t
 *

209 
	$Âm_msg_√xt
 (
Âm_msg_hdr_t
 *
hdr
, 
size_t
 *
Àn
)

211 
size_t
 
msg_Àn
;

213 
msg_Àn
 = 
	`Âm_msg_Àn
 (
hdr
);

215 i‡(
Àn
) {

216 i‡(*
Àn
 < 
msg_Àn
)

218 
	`as£π
(0);

219  
NULL
;

221 *
Àn
 -
msg_Àn
;

224  (
Âm_msg_hdr_t
 *Ë(((*Ë
hdr
Ë+ 
msg_Àn
);

225 
	}
}

232 
ölöe
 

233 
	$Âm_msg_hdr_ok
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
)

235 
size_t
 
msg_Àn
;

237 i‡(
hdr
->
msg_ty≥
 =
FPM_MSG_TYPE_NONE
)

240 
msg_Àn
 = 
	`Âm_msg_Àn
 (
hdr
);

242 i‡(
msg_Àn
 < 
FPM_MSG_HDR_LEN
 || msg_À¿> 
FPM_MAX_MSG_LEN
)

245 i‡(
	`Âm_msg_Æign
 (
msg_Àn
) != msg_len)

249 
	}
}

258 
ölöe
 

259 
	$Âm_msg_ok
 (c⁄° 
Âm_msg_hdr_t
 *
hdr
, 
size_t
 
Àn
)

261 i‡(
Àn
 < 
FPM_MSG_HDR_LEN
)

264 i‡(!
	`Âm_msg_hdr_ok
 (
hdr
))

267 i‡(
	`Âm_msg_Àn
 (
hdr
Ë> 
Àn
)

271 
	}
}

	@lib/memtypes.h

4 #i‚de‡
_QUAGGA_MEMTYPES_H


5 
	#_QUAGGA_MEMTYPES_H


	)

9 
	mMTYPE_TMP
 = 1,

10 
	mMTYPE_STRVEC
,

11 
	mMTYPE_VECTOR
,

12 
	mMTYPE_VECTOR_INDEX
,

13 
	mMTYPE_LINK_LIST
,

14 
	mMTYPE_LINK_NODE
,

15 
	mMTYPE_THREAD
,

16 
	mMTYPE_THREAD_MASTER
,

17 
	mMTYPE_THREAD_STATS
,

18 
	mMTYPE_VTY
,

19 
	mMTYPE_VTY_OUT_BUF
,

20 
	mMTYPE_VTY_HIST
,

21 
	mMTYPE_IF
,

22 
	mMTYPE_CONNECTED
,

23 
	mMTYPE_CONNECTED_LABEL
,

24 
	mMTYPE_BUFFER
,

25 
	mMTYPE_BUFFER_DATA
,

26 
	mMTYPE_STREAM
,

27 
	mMTYPE_STREAM_DATA
,

28 
	mMTYPE_STREAM_FIFO
,

29 
	mMTYPE_PREFIX
,

30 
	mMTYPE_PREFIX_IPV4
,

31 
	mMTYPE_PREFIX_IPV6
,

32 
	mMTYPE_HASH
,

33 
	mMTYPE_HASH_BACKET
,

34 
	mMTYPE_HASH_INDEX
,

35 
	mMTYPE_ROUTE_TABLE
,

36 
	mMTYPE_ROUTE_NODE
,

37 
	mMTYPE_DISTRIBUTE
,

38 
	mMTYPE_DISTRIBUTE_IFNAME
,

39 
	mMTYPE_ACCESS_LIST
,

40 
	mMTYPE_ACCESS_LIST_STR
,

41 
	mMTYPE_ACCESS_FILTER
,

42 
	mMTYPE_PREFIX_LIST
,

43 
	mMTYPE_PREFIX_LIST_ENTRY
,

44 
	mMTYPE_PREFIX_LIST_STR
,

45 
	mMTYPE_ROUTE_MAP
,

46 
	mMTYPE_ROUTE_MAP_NAME
,

47 
	mMTYPE_ROUTE_MAP_INDEX
,

48 
	mMTYPE_ROUTE_MAP_RULE
,

49 
	mMTYPE_ROUTE_MAP_RULE_STR
,

50 
	mMTYPE_ROUTE_MAP_COMPILED
,

51 
	mMTYPE_DESC
,

52 
	mMTYPE_KEY
,

53 
	mMTYPE_KEYCHAIN
,

54 
	mMTYPE_IF_RMAP
,

55 
	mMTYPE_IF_RMAP_NAME
,

56 
	mMTYPE_SOCKUNION
,

57 
	mMTYPE_PRIVS
,

58 
	mMTYPE_ZLOG
,

59 
	mMTYPE_ZCLIENT
,

60 
	mMTYPE_WORK_QUEUE
,

61 
	mMTYPE_WORK_QUEUE_ITEM
,

62 
	mMTYPE_WORK_QUEUE_NAME
,

63 
	mMTYPE_PQUEUE
,

64 
	mMTYPE_PQUEUE_DATA
,

65 
	mMTYPE_HOST
,

66 
	mMTYPE_RTADV_PREFIX
,

67 
	mMTYPE_VRF
,

68 
	mMTYPE_VRF_NAME
,

69 
	mMTYPE_NEXTHOP
,

70 
	mMTYPE_RIB
,

71 
	mMTYPE_RIB_QUEUE
,

72 
	mMTYPE_STATIC_IPV4
,

73 
	mMTYPE_STATIC_IPV6
,

74 
	mMTYPE_RIB_DEST
,

75 
	mMTYPE_RIB_TABLE_INFO
,

76 
	mMTYPE_BGP
,

77 
	mMTYPE_BGP_LISTENER
,

78 
	mMTYPE_BGP_PEER
,

79 
	mMTYPE_BGP_PEER_HOST
,

80 
	mMTYPE_PEER_GROUP
,

81 
	mMTYPE_PEER_DESC
,

82 
	mMTYPE_PEER_PASSWORD
,

83 
	mMTYPE_ATTR
,

84 
	mMTYPE_ATTR_EXTRA
,

85 
	mMTYPE_AS_PATH
,

86 
	mMTYPE_AS_SEG
,

87 
	mMTYPE_AS_SEG_DATA
,

88 
	mMTYPE_AS_STR
,

89 
	mMTYPE_BGP_TABLE
,

90 
	mMTYPE_BGP_NODE
,

91 
	mMTYPE_BGP_ROUTE
,

92 
	mMTYPE_BGP_ROUTE_EXTRA
,

93 
	mMTYPE_BGP_CONN
,

94 
	mMTYPE_BGP_STATIC
,

95 
	mMTYPE_BGP_ADVERTISE_ATTR
,

96 
	mMTYPE_BGP_ADVERTISE
,

97 
	mMTYPE_BGP_SYNCHRONISE
,

98 
	mMTYPE_BGP_ADJ_IN
,

99 
	mMTYPE_BGP_ADJ_OUT
,

100 
	mMTYPE_BGP_MPATH_INFO
,

101 
	mMTYPE_AS_LIST
,

102 
	mMTYPE_AS_FILTER
,

103 
	mMTYPE_AS_FILTER_STR
,

104 
	mMTYPE_COMMUNITY
,

105 
	mMTYPE_COMMUNITY_VAL
,

106 
	mMTYPE_COMMUNITY_STR
,

107 
	mMTYPE_ECOMMUNITY
,

108 
	mMTYPE_ECOMMUNITY_VAL
,

109 
	mMTYPE_ECOMMUNITY_STR
,

110 
	mMTYPE_COMMUNITY_LIST
,

111 
	mMTYPE_COMMUNITY_LIST_NAME
,

112 
	mMTYPE_COMMUNITY_LIST_ENTRY
,

113 
	mMTYPE_COMMUNITY_LIST_CONFIG
,

114 
	mMTYPE_COMMUNITY_LIST_HANDLER
,

115 
	mMTYPE_CLUSTER
,

116 
	mMTYPE_CLUSTER_VAL
,

117 
	mMTYPE_BGP_PROCESS_QUEUE
,

118 
	mMTYPE_BGP_CLEAR_NODE_QUEUE
,

119 
	mMTYPE_TRANSIT
,

120 
	mMTYPE_TRANSIT_VAL
,

121 
	mMTYPE_BGP_DISTANCE
,

122 
	mMTYPE_BGP_NEXTHOP_CACHE
,

123 
	mMTYPE_BGP_CONFED_LIST
,

124 
	mMTYPE_PEER_UPDATE_SOURCE
,

125 
	mMTYPE_BGP_DAMP_INFO
,

126 
	mMTYPE_BGP_DAMP_ARRAY
,

127 
	mMTYPE_BGP_REGEXP
,

128 
	mMTYPE_BGP_AGGREGATE
,

129 
	mMTYPE_BGP_ADDR
,

130 #ifde‡
USE_SRX


131 
	mMTYPE_SRX_HOST
,

132 
	mMTYPE_SRX_SCA_CAPI
,

133 
	mMTYPE_BGP_INFO_HASH
,

134 
	mMTYPE_BGP_INFO_HASH_ITEM
,

136 
	mMTYPE_BGP_INFO_HASH_MUTEX
,

137 
	mMTYPE_BGPSEC_PATH
,

138 
	mMTYPE_BGPSEC_SIGNATURE
,

139 
	mMTYPE_BGPSEC_PATH_SEG
,

140 
	mMTYPE_BGPSEC_SIG_SEG
,

141 
	mMTYPE_BGPSEC_SIG_BLK
,

143 
	mMTYPE_RIP
,

144 
	mMTYPE_RIP_INFO
,

145 
	mMTYPE_RIP_INTERFACE
,

146 
	mMTYPE_RIP_PEER
,

147 
	mMTYPE_RIP_OFFSET_LIST
,

148 
	mMTYPE_RIP_DISTANCE
,

149 
	mMTYPE_RIPNG
,

150 
	mMTYPE_RIPNG_ROUTE
,

151 
	mMTYPE_RIPNG_AGGREGATE
,

152 
	mMTYPE_RIPNG_PEER
,

153 
	mMTYPE_RIPNG_OFFSET_LIST
,

154 
	mMTYPE_RIPNG_RTE_DATA
,

155 
	mMTYPE_BABEL
,

156 
	mMTYPE_BABEL_IF
,

157 
	mMTYPE_OSPF_TOP
,

158 
	mMTYPE_OSPF_AREA
,

159 
	mMTYPE_OSPF_AREA_RANGE
,

160 
	mMTYPE_OSPF_NETWORK
,

161 
	mMTYPE_OSPF_NEIGHBOR_STATIC
,

162 
	mMTYPE_OSPF_IF
,

163 
	mMTYPE_OSPF_NEIGHBOR
,

164 
	mMTYPE_OSPF_ROUTE
,

165 
	mMTYPE_OSPF_TMP
,

166 
	mMTYPE_OSPF_LSA
,

167 
	mMTYPE_OSPF_LSA_DATA
,

168 
	mMTYPE_OSPF_LSDB
,

169 
	mMTYPE_OSPF_PACKET
,

170 
	mMTYPE_OSPF_FIFO
,

171 
	mMTYPE_OSPF_VERTEX
,

172 
	mMTYPE_OSPF_VERTEX_PARENT
,

173 
	mMTYPE_OSPF_NEXTHOP
,

174 
	mMTYPE_OSPF_PATH
,

175 
	mMTYPE_OSPF_VL_DATA
,

176 
	mMTYPE_OSPF_CRYPT_KEY
,

177 
	mMTYPE_OSPF_EXTERNAL_INFO
,

178 
	mMTYPE_OSPF_DISTANCE
,

179 
	mMTYPE_OSPF_IF_INFO
,

180 
	mMTYPE_OSPF_IF_PARAMS
,

181 
	mMTYPE_OSPF_MESSAGE
,

182 
	mMTYPE_OSPF6_TOP
,

183 
	mMTYPE_OSPF6_AREA
,

184 
	mMTYPE_OSPF6_IF
,

185 
	mMTYPE_OSPF6_NEIGHBOR
,

186 
	mMTYPE_OSPF6_ROUTE
,

187 
	mMTYPE_OSPF6_PREFIX
,

188 
	mMTYPE_OSPF6_MESSAGE
,

189 
	mMTYPE_OSPF6_LSA
,

190 
	mMTYPE_OSPF6_LSA_SUMMARY
,

191 
	mMTYPE_OSPF6_LSDB
,

192 
	mMTYPE_OSPF6_VERTEX
,

193 
	mMTYPE_OSPF6_SPFTREE
,

194 
	mMTYPE_OSPF6_NEXTHOP
,

195 
	mMTYPE_OSPF6_EXTERNAL_INFO
,

196 
	mMTYPE_OSPF6_OTHER
,

197 
	mMTYPE_ISIS
,

198 
	mMTYPE_ISIS_TMP
,

199 
	mMTYPE_ISIS_CIRCUIT
,

200 
	mMTYPE_ISIS_LSP
,

201 
	mMTYPE_ISIS_ADJACENCY
,

202 
	mMTYPE_ISIS_AREA
,

203 
	mMTYPE_ISIS_AREA_ADDR
,

204 
	mMTYPE_ISIS_TLV
,

205 
	mMTYPE_ISIS_DYNHN
,

206 
	mMTYPE_ISIS_SPFTREE
,

207 
	mMTYPE_ISIS_VERTEX
,

208 
	mMTYPE_ISIS_ROUTE_INFO
,

209 
	mMTYPE_ISIS_NEXTHOP
,

210 
	mMTYPE_ISIS_NEXTHOP6
,

211 
	mMTYPE_ISIS_DICT
,

212 
	mMTYPE_ISIS_DICT_NODE
,

213 
	mMTYPE_VTYSH_CONFIG
,

214 
	mMTYPE_VTYSH_CONFIG_LINE
,

215 
	mMTYPE_MAX
,

218 
mem‹y_li°
 
mem‹y_li°_lib
[];

219 
mem‹y_li°
 
mem‹y_li°_zebø
[];

220 
mem‹y_li°
 
mem‹y_li°_bgp
[];

221 
mem‹y_li°
 
mem‹y_li°_rù
[];

222 
mem‹y_li°
 
mem‹y_li°_rùng
[];

223 
mem‹y_li°
 
mem‹y_li°_babñ
[];

224 
mem‹y_li°
 
mem‹y_li°_o•f
[];

225 
mem‹y_li°
 
mem‹y_li°_o•f6
[];

226 
mem‹y_li°
 
mem‹y_li°_isis
[];

227 
mem‹y_li°
 
mem‹y_li°_vtysh
[];

	@lib/route_types.h

4 #i‚de‡
_QUAGGA_ROUTE_TYPES_H


5 
	#_QUAGGA_ROUTE_TYPES_H


	)

8 
	#ZEBRA_ROUTE_SYSTEM
 0

	)

9 
	#ZEBRA_ROUTE_KERNEL
 1

	)

10 
	#ZEBRA_ROUTE_CONNECT
 2

	)

11 
	#ZEBRA_ROUTE_STATIC
 3

	)

12 
	#ZEBRA_ROUTE_RIP
 4

	)

13 
	#ZEBRA_ROUTE_RIPNG
 5

	)

14 
	#ZEBRA_ROUTE_OSPF
 6

	)

15 
	#ZEBRA_ROUTE_OSPF6
 7

	)

16 
	#ZEBRA_ROUTE_ISIS
 8

	)

17 
	#ZEBRA_ROUTE_BGP
 9

	)

18 
	#ZEBRA_ROUTE_HSLS
 10

	)

19 
	#ZEBRA_ROUTE_OLSR
 11

	)

20 
	#ZEBRA_ROUTE_BABEL
 12

	)

21 
	#ZEBRA_ROUTE_MAX
 13

	)

23 
	#SHOW_ROUTE_V4_HEADER
 \

27 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE, 
	)
VTY_NEWLINE

28 
	#SHOW_ROUTE_V6_HEADER
 \

32 
VTY_NEWLINE
, VTY_NEWLINE, VTY_NEWLINE, 
	)
VTY_NEWLINE

35 
	#QUAGGA_REDIST_STR_BABELD
 \

36 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|isis|bgp)"

	)

37 
	#QUAGGA_REDIST_HELP_STR_BABELD
 \

46 "B‹dî G©eway PrŸocﬁ (BGP)\n"

	)

47 
	#QUAGGA_IP_REDIST_STR_BABELD
 \

48 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|isis|bgp)"

	)

49 
	#QUAGGA_IP_REDIST_HELP_STR_BABELD
 \

56 "B‹dî G©eway PrŸocﬁ (BGP)\n"

	)

57 
	#QUAGGA_IP6_REDIST_STR_BABELD
 \

58 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|isis|bgp)"

	)

59 
	#QUAGGA_IP6_REDIST_HELP_STR_BABELD
 \

66 "B‹dî G©eway PrŸocﬁ (BGP)\n"

	)

69 
	#QUAGGA_REDIST_STR_BGPD
 \

70 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|isis|babñ)"

	)

71 
	#QUAGGA_REDIST_HELP_STR_BGPD
 \

80 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

81 
	#QUAGGA_IP_REDIST_STR_BGPD
 \

82 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|isis|babñ)"

	)

83 
	#QUAGGA_IP_REDIST_HELP_STR_BGPD
 \

90 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

91 
	#QUAGGA_IP6_REDIST_STR_BGPD
 \

92 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|isis|babñ)"

	)

93 
	#QUAGGA_IP6_REDIST_HELP_STR_BGPD
 \

100 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

103 
	#QUAGGA_REDIST_STR_ISISD
 \

104 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|bgp|babñ)"

	)

105 
	#QUAGGA_REDIST_HELP_STR_ISISD
 \

114 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

115 
	#QUAGGA_IP_REDIST_STR_ISISD
 \

116 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|bgp|babñ)"

	)

117 
	#QUAGGA_IP_REDIST_HELP_STR_ISISD
 \

124 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

125 
	#QUAGGA_IP6_REDIST_STR_ISISD
 \

126 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|bgp|babñ)"

	)

127 
	#QUAGGA_IP6_REDIST_HELP_STR_ISISD
 \

134 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

137 
	#QUAGGA_REDIST_STR_OSPF6D
 \

138 "(kî√l|c⁄√˘ed|°©ic|rùng|isis|bgp|babñ)"

	)

139 
	#QUAGGA_REDIST_HELP_STR_OSPF6D
 \

146 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

149 
	#QUAGGA_REDIST_STR_OSPFD
 \

150 "(kî√l|c⁄√˘ed|°©ic|rù|isis|bgp|babñ)"

	)

151 
	#QUAGGA_REDIST_HELP_STR_OSPFD
 \

158 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

161 
	#QUAGGA_REDIST_STR_RIPD
 \

162 "(kî√l|c⁄√˘ed|°©ic|o•f|isis|bgp|babñ)"

	)

163 
	#QUAGGA_REDIST_HELP_STR_RIPD
 \

170 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

173 
	#QUAGGA_REDIST_STR_RIPNGD
 \

174 "(kî√l|c⁄√˘ed|°©ic|o•f6|isis|bgp|babñ)"

	)

175 
	#QUAGGA_REDIST_HELP_STR_RIPNGD
 \

182 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

185 
	#QUAGGA_REDIST_STR_ZEBRA
 \

186 "(kî√l|c⁄√˘ed|°©ic|rù|rùng|o•f|o•f6|isis|bgp|babñ)"

	)

187 
	#QUAGGA_REDIST_HELP_STR_ZEBRA
 \

197 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

198 
	#QUAGGA_IP_REDIST_STR_ZEBRA
 \

199 "(kî√l|c⁄√˘ed|°©ic|rù|o•f|isis|bgp|babñ)"

	)

200 
	#QUAGGA_IP_REDIST_HELP_STR_ZEBRA
 \

208 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

209 
	#QUAGGA_IP6_REDIST_STR_ZEBRA
 \

210 "(kî√l|c⁄√˘ed|°©ic|rùng|o•f6|isis|bgp|babñ)"

	)

211 
	#QUAGGA_IP6_REDIST_HELP_STR_ZEBRA
 \

219 "BabñÑoutögÖrŸocﬁ (Babñ)\n"

	)

222 #ifde‡
QUAGGA_DEFINE_DESC_TABLE


224 
	szebø_desc_èbÀ


226 
	mty≥
;

227 c⁄° *
	m°rög
;

228 
	mchr
;

231 
	#DESC_ENTRY
(
T
,
S
,
C
Ë[(T)] = { (T), (S), (CË}

	)

232 c⁄° 
zebø_desc_èbÀ
 
	grouã_ty≥s
[] = {

233 
DESC_ENTRY
 (
ZEBRA_ROUTE_SYSTEM
, "system", 'X' ),

234 
DESC_ENTRY
 (
ZEBRA_ROUTE_KERNEL
, "kernel", 'K' ),

235 
DESC_ENTRY
 (
ZEBRA_ROUTE_CONNECT
, "connected", 'C' ),

236 
DESC_ENTRY
 (
ZEBRA_ROUTE_STATIC
, "static", 'S' ),

237 
DESC_ENTRY
 (
ZEBRA_ROUTE_RIP
, "rip", 'R' ),

238 
DESC_ENTRY
 (
ZEBRA_ROUTE_RIPNG
, "ripng", 'R' ),

239 
DESC_ENTRY
 (
ZEBRA_ROUTE_OSPF
, "ospf", 'O' ),

240 
DESC_ENTRY
 (
ZEBRA_ROUTE_OSPF6
, "ospf6", 'O' ),

241 
DESC_ENTRY
 (
ZEBRA_ROUTE_ISIS
, "isis", 'I' ),

242 
DESC_ENTRY
 (
ZEBRA_ROUTE_BGP
, "bgp", 'B' ),

243 
DESC_ENTRY
 (
ZEBRA_ROUTE_HSLS
, "hsls", 'H' ),

244 
DESC_ENTRY
 (
ZEBRA_ROUTE_OLSR
, "olsr", 'o' ),

245 
DESC_ENTRY
 (
ZEBRA_ROUTE_BABEL
, "babel", 'A' ),

247 #unde‡
DESC_ENTRY


	@lib/vty.h

21 #i‚de‡
_ZEBRA_VTY_H


22 
	#_ZEBRA_VTY_H


	)

24 
	~"thªad.h
"

25 
	~"log.h
"

26 
	~"sockuni⁄.h
"

28 
	#VTY_BUFSIZ
 512

	)

29 
	#VTY_MAXHIST
 20

	)

32 
	svty


35 
	mfd
;

38 íum {
	mVTY_TERM
, 
	mVTY_FILE
, 
	mVTY_SHELL
, 
	mVTY_SHELL_SERV
} 
	mty≥
;

41 
	mnode
;

44 
	mÁû
;

47 
buf„r
 *
	mobuf
;

50 *
	mbuf
;

53 
	m˝
;

56 
	mÀngth
;

59 
	mmax
;

62 *
	mhi°
[
VTY_MAXHIST
];

65 
	mhp
;

68 
	mhödex
;

72 *
	mödex
;

75 *
	mödex_sub
;

78 
	mesˇ≥
;

81 íum {
	mVTY_NORMAL
, 
	mVTY_CLOSE
, 
	mVTY_MORE
, 
	mVTY_MORELINE
} 
	m°©us
;

86 
	müc
;

89 
	müc_sb_ö_¥ogªss
;

93 
	#TELNET_NAWS_SB_LEN
 5

	)

94 
	msb_buf
[
TELNET_NAWS_SB_LEN
];

97 
size_t
 
	msb_Àn
;

100 
	mwidth
;

101 
	mheight
;

104 
	mlöes
;

107 
	mm⁄ô‹
;

110 
	mc⁄fig
;

113 
thªad
 *
	mt_ªad
;

114 
thªad
 *
	mt_wrôe
;

117 
	mv_timeout
;

118 
thªad
 *
	mt_timeout
;

121 
	maddªss
[
SU_ADDRSTRLEN
];

125 
	#INTEGRATE_DEFAULT_CONFIG
 "Quagga.c⁄f"

	)

128 
	#VTY_NEWLINE
 ((
vty
->
ty≥
 =
VTY_TERM
Ë? "\r\n" : "\n")

	)

131 
	#VTY_TIMEOUT_DEFAULT
 600

	)

134 
	#VTY_READ_BUFSIZ
 512

	)

137 #i‚de‡
DIRECTORY_SEP


138 
	#DIRECTORY_SEP
 '/'

	)

141 #i‚de‡
IS_DIRECTORY_SEP


142 
	#IS_DIRECTORY_SEP
(
c
Ë((cË=
DIRECTORY_SEP
)

	)

146 #ifde‡
__GNUC__


147 
	#PRINTF_ATTRIBUTE
(
a
,
b
Ë
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
,á, b)))

	)

149 
	#PRINTF_ATTRIBUTE
(
a
,
b
)

	)

153 
	#VTY_GET_ULONG
(
NAME
,
V
,
STR
) \

155 *
íd±r
 = 
NULL
; \

156 
î∫o
 = 0; \

157 (
V
Ë
	`°πoul
 ((
STR
), &
íd±r
, 10); \

158 i‡(*(
STR
Ë='-' || *
íd±r
 !'\0' || 
î∫o
) \

160 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
); \

161  
CMD_WARNING
; \

163 } 0)

	)

172 
	#VTY_GET_INTEGER_RANGE_HEART
(
NAME
,
TMPL
,
STR
,
MIN
,
MAX
) \

174 
	`VTY_GET_ULONG
(
NAME
, (
TMPL
), 
STR
); \

175 i‡–((
TMPL
Ë<(
MIN
Ë&& (TMPLË!(MIN)Ë|| (TMPLË> (
MAX
) ) \

177 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
);\

178  
CMD_WARNING
; \

180 } 0)

	)

182 
	#VTY_GET_INTEGER_RANGE
(
NAME
,
V
,
STR
,
MIN
,
MAX
) \

184 
tm∂
; \

185 
	`VTY_GET_INTEGER_RANGE_HEART
(
NAME
,
tm∂
,
STR
,
MIN
,
MAX
); \

186 (
V
Ë
tm∂
; \

187 } 0)

	)

189 
	#VTY_CHECK_INTEGER_RANGE
(
NAME
,
STR
,
MIN
,
MAX
) \

191 
tm∂
; \

192 
	`VTY_GET_INTEGER_RANGE_HEART
(
NAME
,
tm∂
,
STR
,
MIN
,
MAX
); \

193 } 0)

	)

195 
	#VTY_GET_INTEGER
(
NAME
,
V
,
STR
) \

196 
	`VTY_GET_INTEGER_RANGE
(
NAME
,
V
,
STR
,0U,
UINT32_MAX
)

	)

198 
	#VTY_GET_IPV4_ADDRESS
(
NAME
,
V
,
STR
) \

200 
ªtv
; \

201 
ªtv
 = 
	`öë_©⁄
 ((
STR
), &(
V
)); \

202 i‡(!
ªtv
) \

204 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
); \

205  
CMD_WARNING
; \

207 } 0)

	)

209 
	#VTY_GET_IPV4_PREFIX
(
NAME
,
V
,
STR
) \

211 
ªtv
; \

212 
ªtv
 = 
	`°r2¥efix_ùv4
 ((
STR
), &(
V
)); \

213 i‡(
ªtv
 <= 0) \

215 
	`vty_out
 (
vty
, "%% InvÆid %†vÆue%s", 
NAME
, 
VTY_NEWLINE
); \

216  
CMD_WARNING
; \

218 } 0)

	)

221 
öãgøã_deÁu…
[];

224 
vty_öô
 (
thªad_ma°î
 *);

225 
vty_öô_vtysh
 ();

226 
vty_ãrmö©e
 ();

227 
vty_ª£t
 ();

228 
vty
 *
vty_√w
 ();

229 
	$vty_out
 (
vty
 *, c⁄° *, ...Ë
	`PRINTF_ATTRIBUTE
(2, 3);

230 
	`vty_ªad_c⁄fig
 (*, *);

231 
	`vty_time_¥öt
 (
vty
 *, );

232 
	`vty_£rv_sock
 (const *, , const *);

233 
	`vty_˛o£
 (
vty
 *);

234 *
	`vty_gë_cwd
 ();

235 
	`vty_log
 (c⁄° *
Àvñ
, c⁄° *
¥Ÿo
,

236 c⁄° *
fmt
, 
time°amp_c⁄åﬁ
 *, 
va_li°
);

237 
	`vty_c⁄fig_lock
 (
vty
 *);

238 
	`vty_c⁄fig_u∆ock
 (
vty
 *);

239 
	`vty_shñl
 (
vty
 *);

240 
	`vty_shñl_£rv
 (
vty
 *);

241 
	`vty_hñlo
 (
vty
 *);

245 
	`vty_log_fixed
 (c⁄° *
buf
, 
size_t
 
Àn
);

	@vtysh/vtysh.h

22 #i‚de‡
VTYSH_H


23 
	#VTYSH_H


	)

25 
	#VTYSH_ZEBRA
 0x01

	)

26 
	#VTYSH_RIPD
 0x02

	)

27 
	#VTYSH_RIPNGD
 0x04

	)

28 
	#VTYSH_OSPFD
 0x08

	)

29 
	#VTYSH_OSPF6D
 0x10

	)

30 
	#VTYSH_BGPD
 0x20

	)

31 
	#VTYSH_ISISD
 0x40

	)

32 
	#VTYSH_BABELD
 0x80

	)

33 
	#VTYSH_ALL
 
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_RIPNGD
|
VTYSH_OSPFD
|
VTYSH_OSPF6D
|
VTYSH_BGPD
|
VTYSH_ISISD
|
VTYSH_BABELD


	)

34 
	#VTYSH_RMAP
 
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_RIPNGD
|
VTYSH_OSPFD
|
VTYSH_OSPF6D
|
VTYSH_BGPD
|
VTYSH_BABELD


	)

35 
	#VTYSH_INTERFACE
 
VTYSH_ZEBRA
|
VTYSH_RIPD
|
VTYSH_RIPNGD
|
VTYSH_OSPFD
|
VTYSH_OSPF6D
|
VTYSH_ISISD
|
VTYSH_BABELD


	)

38 
	#VTYSH_DEFAULT_CONFIG
 "vtysh.c⁄f"

	)

40 
vtysh_öô_vty
 ();

41 
vtysh_öô_cmd
 ();

42 
vtysh_c⁄√˘_Æl
 (c⁄° *
›ti⁄Æ_d´m⁄_«me
);

43 
vtysh_ªadlöe_öô
 ();

44 
vtysh_u£r_öô
 ();

46 
vtysh_execuã
 (const *);

47 
vtysh_execuã_no_∑gî
 (const *);

49 *
vtysh_¥om±
 ();

51 
vtysh_c⁄fig_wrôe
 ();

53 
vtysh_c⁄fig_‰om_fûe
 (
vty
 *, 
FILE
 *);

55 
vtysh_ªad_c⁄fig
 (*);

57 
vtysh_c⁄fig_∑r£
 (*);

59 
vtysh_c⁄fig_dump
 (
FILE
 *);

61 
vtysh_c⁄fig_öô
 ();

63 
vtysh_∑gî_öô
 ();

66 
execuã_Êag
;

68 
vty
 *vty;

	@vtysh/vtysh_user.h

22 #i‚de‡
_VTYSH_USER_H


23 
	#_VTYSH_USER_H


	)

25 
vtysh_auth
 ();

	@zebra/connected.h

23 #i‚de‡
_ZEBRA_CONNECTED_H


24 
	#_ZEBRA_CONNECTED_H


	)

26 
c⁄√˘ed
 *

27 
c⁄√˘ed_check
 (
öãrÁ˚
 *
iÂ
, 
¥efix
 *
p
);

30 
c⁄√˘ed_add_ùv4
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö_addr
 *
addr
,

31 
u_ch¨
 
¥efixÀn
, 
ö_addr
 *
brﬂd
,

32 c⁄° *
œbñ
);

35 
c⁄√˘ed_dñëe_ùv4
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö_addr
 *
addr
,

36 
u_ch¨
 
¥efixÀn
, 
ö_addr
 *
brﬂd
);

38 
c⁄√˘ed_up_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

39 
c⁄√˘ed_down_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

41 #ifde‡
HAVE_IPV6


43 
c⁄√˘ed_add_ùv6
 (
öãrÁ˚
 *
iÂ
, 
Êags
, 
ö6_addr
 *
addªss
,

44 
u_ch¨
 
¥efixÀn
, 
ö6_addr
 *
brﬂd
,

45 c⁄° *
œbñ
);

47 
c⁄√˘ed_dñëe_ùv6
 (
öãrÁ˚
 *
iÂ
, 
ö6_addr
 *
addªss
,

48 
u_ch¨
 
¥efixÀn
, 
ö6_addr
 *
brﬂd
);

50 
c⁄√˘ed_up_ùv6
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

51 
c⁄√˘ed_down_ùv6
 (
öãrÁ˚
 *
iÂ
, 
c⁄√˘ed
 *);

	@zebra/debug.h

23 #i‚de‡
_ZEBRA_DEBUG_H


24 
	#_ZEBRA_DEBUG_H


	)

27 
	#ZEBRA_DEBUG_EVENT
 0x01

	)

29 
	#ZEBRA_DEBUG_PACKET
 0x01

	)

30 
	#ZEBRA_DEBUG_SEND
 0x20

	)

31 
	#ZEBRA_DEBUG_RECV
 0x40

	)

32 
	#ZEBRA_DEBUG_DETAIL
 0x80

	)

34 
	#ZEBRA_DEBUG_KERNEL
 0x01

	)

36 
	#ZEBRA_DEBUG_RIB
 0x01

	)

37 
	#ZEBRA_DEBUG_RIB_Q
 0x02

	)

39 
	#ZEBRA_DEBUG_FPM
 0x01

	)

42 
	#IS_ZEBRA_DEBUG_EVENT
 (
zebø_debug_evít
 & 
ZEBRA_DEBUG_EVENT
)

	)

44 
	#IS_ZEBRA_DEBUG_PACKET
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_PACKET
)

	)

45 
	#IS_ZEBRA_DEBUG_SEND
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_SEND
)

	)

46 
	#IS_ZEBRA_DEBUG_RECV
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_RECV
)

	)

47 
	#IS_ZEBRA_DEBUG_DETAIL
 (
zebø_debug_∑ckë
 & 
ZEBRA_DEBUG_DETAIL
)

	)

49 
	#IS_ZEBRA_DEBUG_KERNEL
 (
zebø_debug_kî√l
 & 
ZEBRA_DEBUG_KERNEL
)

	)

51 
	#IS_ZEBRA_DEBUG_RIB
 (
zebø_debug_rib
 & 
ZEBRA_DEBUG_RIB
)

	)

52 
	#IS_ZEBRA_DEBUG_RIB_Q
 (
zebø_debug_rib
 & 
ZEBRA_DEBUG_RIB_Q
)

	)

54 
	#IS_ZEBRA_DEBUG_FPM
 (
zebø_debug_Âm
 & 
ZEBRA_DEBUG_FPM
)

	)

56 
zebø_debug_evít
;

57 
zebø_debug_∑ckë
;

58 
zebø_debug_kî√l
;

59 
zebø_debug_rib
;

60 
zebø_debug_Âm
;

62 
zebø_debug_öô
 ();

	@zebra/interface.h

22 #i‚de‡
_ZEBRA_INTERFACE_H


23 
	#_ZEBRA_INTERFACE_H


	)

25 
	~"ªdi°ribuã.h
"

27 #ifde‡
HAVE_IRDP


28 
	~"zebø/údp.h
"

32 
	#IF_ZEBRA_MULTICAST_UNSPEC
 0

	)

33 
	#IF_ZEBRA_MULTICAST_ON
 1

	)

34 
	#IF_ZEBRA_MULTICAST_OFF
 2

	)

37 
	#IF_ZEBRA_SHUTDOWN_UNSPEC
 0

	)

38 
	#IF_ZEBRA_SHUTDOWN_ON
 1

	)

39 
	#IF_ZEBRA_SHUTDOWN_OFF
 2

	)

42 #i‡(
deföed
(
LINUX_IPV6
Ë&& (deföed(
__GLIBC__
Ë&& __GLIBC__ >2 && 
__GLIBC_MINOR__
 >1)Ë|| deföed(
KAME
)

43 #ifde‡
HAVE_RTADV


44 
	#RTADV


	)

48 #ifde‡
RTADV


50 
	sπadvc⁄f


55 
	mAdvSídAdvîti£míts
;

63 
	mMaxRåAdvI¡îvÆ
;

64 
	#RTADV_MAX_RTR_ADV_INTERVAL
 600000

	)

72 
	mMöRåAdvI¡îvÆ
;

73 
	#RTADV_MIN_RTR_ADV_INTERVAL
 (0.33 * 
RTADV_MAX_RTR_ADV_INTERVAL
)

	)

76 
	mAdvI¡îvÆTimî
;

83 
	mAdvM™agedFœg
;

91 
	mAdvOthîC⁄figFœg
;

97 
	mAdvLökMTU
;

106 
u_öt32_t
 
	mAdvRóchabÀTime
;

107 
	#RTADV_MAX_REACHABLE_TIME
 3600000

	)

115 
	mAdvRëønsTimî
;

124 
	mAdvCurH›Limô
;

133 
	mAdvDeÁu…Li„time
;

134 
	#RTADV_MAX_RTRLIFETIME
 9000

	)

143 
li°
 *
	mAdvPªfixLi°
;

149 
	mAdvHomeAgítFœg
;

150 #i‚de‡
ND_RA_FLAG_HOME_AGENT


151 
	#ND_RA_FLAG_HOME_AGENT
 0x20

	)

157 
	mHomeAgítPª„ªn˚
;

165 
	mHomeAgítLi„time
;

166 
	#RTADV_MAX_HALIFETIME
 65520

	)

172 
	mAdvI¡îvÆO±i⁄
;

178 
	mDeÁu…Pª„ªn˚
;

179 
	#RTADV_PREF_MEDIUM
 0x0

	)

185 
	szebø_if


188 
u_ch¨
 
	mshutdown
;

191 
u_ch¨
 
	mmu…iˇ°
;

194 
u_ch¨
 
	mπadv_íabÀ
;

197 
rouã_èbÀ
 *
	mùv4_sub√ts
;

199 #ifde‡
RTADV


200 
πadvc⁄f
 
	mπadv
;

203 #ifde‡
HAVE_IRDP


204 
údp_öãrÁ˚
 
	múdp
;

207 #ifde‡
SUNOS_5


213 
u_ch¨
 
	m¥im¨y_°©e
;

217 
if_dñëe_upd©e
 (
öãrÁ˚
 *
iÂ
);

218 
if_add_upd©e
 (
öãrÁ˚
 *
iÂ
);

219 
if_up
 (
öãrÁ˚
 *);

220 
if_down
 (
öãrÁ˚
 *);

221 
if_ª‰esh
 (
öãrÁ˚
 *);

222 
if_Êags_upd©e
 (
öãrÁ˚
 *, 
uöt64_t
);

223 
if_sub√t_add
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

224 
if_sub√t_dñëe
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

226 #ifde‡
HAVE_PROC_NET_DEV


227 
if°©_upd©e_¥oc
 ();

229 #ifde‡
HAVE_NET_RT_IFLIST


230 
if°©_upd©e_sys˘l
 ();

233 #ifde‡
HAVE_PROC_NET_DEV


234 
öãrÁ˚_li°_¥oc
 ();

236 #ifde‡
HAVE_PROC_NET_IF_INET6


237 
iÁddr_¥oc_ùv6
 ();

240 #ifde‡
BSDI


241 
if_kvm_gë_mtu
 (
öãrÁ˚
 *);

	@zebra/ioctl.h

23 #i‚de‡
_ZEBRA_IOCTL_H


24 
	#_ZEBRA_IOCTL_H


	)

27 
i‰eq_£t_«me
 (
i‰eq
 *, 
öãrÁ˚
 *);

28 
if_io˘l
 (
u_l⁄g
, 
ˇddr_t
);

30 
if_£t_Êags
 (
öãrÁ˚
 *, 
uöt64_t
);

31 
if_un£t_Êags
 (
öãrÁ˚
 *, 
uöt64_t
);

32 
if_gë_Êags
 (
öãrÁ˚
 *);

34 
if_£t_¥efix
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

35 
if_un£t_¥efix
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

37 
if_gë_mëric
 (
öãrÁ˚
 *);

38 
if_gë_mtu
 (
öãrÁ˚
 *);

40 #ifde‡
HAVE_IPV6


41 
if_¥efix_add_ùv6
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

42 
if_¥efix_dñëe_ùv6
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

45 #ifde‡
SOLARIS_IPV6


46 
if_io˘l_ùv6
(
u_l⁄g
, 
ˇddr_t
);

47 
c⁄√˘ed
 *
if_lookup_lökloˇl
–
öãrÁ˚
 *);

49 
	#AF_IOCTL
(
af
, 
ªque°
, 
buf„r
) \

50 ((
af
Ë=
AF_INET
? 
	`if_io˘l
(
ªque°
, 
buf„r
) : \

51 
	`if_io˘l_ùv6
(
ªque°
, 
buf„r
))

	)

54 
	#AF_IOCTL
(
af
, 
ªque°
, 
buf„r
Ë
	`if_io˘l
‘eque°, buf„r)

	)

	@zebra/ipforward.h

22 #i‚de‡
_ZEBRA_IPFORWARD_H


23 
	#_ZEBRA_IPFORWARD_H


	)

25 
ùf‹w¨d
 ();

26 
ùf‹w¨d_⁄
 ();

27 
ùf‹w¨d_off
 ();

29 #ifde‡
HAVE_IPV6


30 
ùf‹w¨d_ùv6
 ();

31 
ùf‹w¨d_ùv6_⁄
 ();

32 
ùf‹w¨d_ùv6_off
 ();

	@zebra/irdp.h

27 #i‚de‡
_IRDP_H


28 
	#_IRDP_H


	)

30 
	~"lib/vty.h
"

32 
	#TRUE
 1

	)

33 
	#FALSE
 0

	)

36 #i‚de‡
ICMP_ROUTERADVERT


37 
	#ICMP_ROUTERADVERT
 9

	)

40 #i‚de‡
ICMP_ROUTERSOLICIT


41 
	#ICMP_ROUTERSOLICIT
 10

	)

45 #i‚de‡
INADDR_ALLHOSTS_GROUP


46 
	#INADDR_ALLHOSTS_GROUP
 0xe0000001U

	)

49 #i‚de‡
INADDR_ALLRTRS_GROUP


50 
	#INADDR_ALLRTRS_GROUP
 0xe0000002U

	)

54 
	#IRDP_DEFAULT_INTERVAL
 300

	)

57 
	#MAX_INITIAL_ADVERT_INTERVAL
 16

	)

58 
	#MAX_INITIAL_ADVERTISEMENTS
 3

	)

59 
	#MAX_RESPONSE_DELAY
 2

	)

61 
	#IRDP_MAXADVERTINTERVAL
 600

	)

62 
	#IRDP_MINADVERTINTERVAL
 450

	)

63 
	#IRDP_LIFETIME
 1350

	)

64 
	#IRDP_PREFERENCE
 0

	)

66 
	#ICMP_MINLEN
 8

	)

68 
	#IRDP_LAST_ADVERT_MESSAGES
 2

	)

70 
	#IRDP_RX_BUF
 1500

	)

114 
	súdp_öãrÁ˚


116 
	mMaxAdvîtI¡îvÆ
;

117 
	mMöAdvîtI¡îvÆ
;

118 
	mPª„ªn˚
;

120 
u_öt32_t
 
	mÊags
;

122 
	#IF_ACTIVE
 (1<<0Ë

	)

123 
	#IF_BROADCAST
 (1<<1Ë

	)

124 
	#IF_SOLICIT
 (1<<2Ë

	)

125 
	#IF_DEBUG_MESSAGES
 (1<<3)

	)

126 
	#IF_DEBUG_PACKET
 (1<<4)

	)

127 
	#IF_DEBUG_MISC
 (1<<5)

	)

128 
	#IF_SHUTDOWN
 (1<<6)

	)

130 
öãrÁ˚
 *
	miÂ
;

131 
thªad
 *
	mt_advîti£
;

132 
	múdp_£¡
;

133 
u_öt16_t
 
	mLi„time
;

135 
li°
 *
	mAdvPªfLi°
;

139 
	sAdv


141 
ö_addr
 
	mù
;

142 
	m¥ef
;

145 
údp_öô
();

146 
údp_sock_öô
();

147 
údp_föish
();

148 
údp_c⁄fig_wrôe
 (
vty
 *, 
öãrÁ˚
 *);

149 
údp_£nd_thªad
(
thªad
 *
t_advît
);

150 
údp_advît_off
(
öãrÁ˚
 *
iÂ
);

151 
¥o˚ss_sﬁicô
 (
öãrÁ˚
 *
iÂ
);

152 
údp_ªad_øw
(
thªad
 *
r
);

153 
£nd_∑ckë
(
öãrÁ˚
 *
iÂ
, 
°ªam
 *
s
,

154 
u_öt32_t
 
d°
, 
¥efix
 *
p
, u_öt32_à
âl
);

	@zebra/kernel_socket.h

23 #i‚de‡
__ZEBRA_KERNEL_SOCKET_H


24 
	#__ZEBRA_KERNEL_SOCKET_H


	)

26 
πm_ªad
 (
π_msghdr
 *);

27 
iÁm_ªad
 (
iÁ_msghdr
 *);

28 
ifm_ªad
 (
if_msghdr
 *);

29 
πm_wrôe
 (, 
sockuni⁄
 *, sockunion *,

30 
sockuni⁄
 *, , , );

31 c⁄° 
mesßge
 
πm_ty≥_°r
[];

	@zebra/redistribute.h

23 #i‚de‡
_ZEBRA_REDISTRIBUTE_H


24 
	#_ZEBRA_REDISTRIBUTE_H


	)

26 
	~"èbÀ.h
"

27 
	~"z£rv.h
"

29 
zebø_ªdi°ribuã_add
 (, 
z£rv
 *, );

30 
zebø_ªdi°ribuã_dñëe
 (, 
z£rv
 *, );

32 
zebø_ªdi°ribuã_deÁu…_add
 (, 
z£rv
 *, );

33 
zebø_ªdi°ribuã_deÁu…_dñëe
 (, 
z£rv
 *, );

35 
ªdi°ribuã_add
 (
¥efix
 *, 
rib
 *);

36 
ªdi°ribuã_dñëe
 (
¥efix
 *, 
rib
 *);

38 
zebø_öãrÁ˚_up_upd©e
 (
öãrÁ˚
 *);

39 
zebø_öãrÁ˚_down_upd©e
 (
öãrÁ˚
 *);

41 
zebø_öãrÁ˚_add_upd©e
 (
öãrÁ˚
 *);

42 
zebø_öãrÁ˚_dñëe_upd©e
 (
öãrÁ˚
 *);

44 
zebø_öãrÁ˚_addªss_add_upd©e
 (
öãrÁ˚
 *,

45 
c⁄√˘ed
 *);

46 
zebø_öãrÁ˚_addªss_dñëe_upd©e
 (
öãrÁ˚
 *,

47 
c⁄√˘ed
 *
c
);

49 
zebø_check_addr
 (
¥efix
 *);

	@zebra/rib.h

23 #i‚de‡
_ZEBRA_RIB_H


24 
	#_ZEBRA_RIB_H


	)

26 
	~"¥efix.h
"

27 
	~"èbÀ.h
"

28 
	~"queue.h
"

30 
	#DISTANCE_INFINITY
 255

	)

34 
	ug_addr
 {

35 
ö_addr
 
	mùv4
;

36 #ifde‡
HAVE_IPV6


37 
ö6_addr
 
	mùv6
;

41 
	srib


44 
rib
 *
	m√xt
;

45 
rib
 *
	m¥ev
;

48 
√xth›
 *
	m√xth›
;

51 
	mªf˙t
;

54 
time_t
 
	mu±ime
;

57 
	mty≥
;

60 
	mèbÀ
;

63 
u_öt32_t
 
	mmëric
;

66 
u_ch¨
 
	mdi°™˚
;

72 
u_ch¨
 
	mÊags
;

75 
u_ch¨
 
	m°©us
;

76 
	#RIB_ENTRY_REMOVED
 (1 << 0)

	)

79 
u_ch¨
 
	m√xth›_num
;

80 
u_ch¨
 
	m√xth›_a˘ive_num
;

81 
u_ch¨
 
	m√xth›_fib_num
;

91 
	#MQ_SIZE
 5

	)

92 
	smëa_queue


94 
li°
 *
	msubq
[
MQ_SIZE
];

95 
u_öt32_t
 
	msize
;

101 
	srib_de°_t_


108 
rouã_node
 *
	m∫ode
;

113 
rib
 *
	mrouãs
;

118 
u_öt32_t
 
	mÊags
;

123 
TAILQ_ENTRY
(
rib_de°_t_
Ë
	mÂm_q_íåõs
;

125 } 
	trib_de°_t
;

127 
	#RIB_ROUTE_QUEUED
(
x
Ë(1 << (x))

	)

132 
	#ZEBRA_MAX_QINDEX
 (
MQ_SIZE
 - 1)

	)

138 
	#RIB_DEST_SENT_TO_FPM
 (1 << (
ZEBRA_MAX_QINDEX
 + 1))

	)

144 
	#RIB_DEST_UPDATE_FPM
 (1 << (
ZEBRA_MAX_QINDEX
 + 2))

	)

149 
	#RIB_DEST_FOREACH_ROUTE
(
de°
, 
rib
) \

150 (
rib
Ë(
de°
Ë? (de°)->
rouãs
 : 
NULL
; (rib); (ribË‘ib)->
√xt
)

	)

155 
	#RIB_DEST_FOREACH_ROUTE_SAFE
(
de°
, 
rib
, 
√xt
) \

156 (
rib
Ë(
de°
Ë? (de°)->
rouãs
 : 
NULL
; \

157 (
rib
Ë&& ((
√xt
) = (rib)->next, 1); \

158 (
rib
Ë(
√xt
))

	)

160 
	#RNODE_FOREACH_RIB
(
∫
, 
rib
) \

161 
	`RIB_DEST_FOREACH_ROUTE
 (
	`rib_de°_‰om_∫ode
 (
∫
), 
rib
)

	)

163 
	#RNODE_FOREACH_RIB_SAFE
(
∫
, 
rib
, 
√xt
) \

164 
	`RIB_DEST_FOREACH_ROUTE_SAFE
 (
	`rib_de°_‰om_∫ode
 (
∫
), 
rib
, 
√xt
)

	)

167 
	s°©ic_ùv4


170 
°©ic_ùv4
 *
	m¥ev
;

171 
°©ic_ùv4
 *
	m√xt
;

174 
u_ch¨
 
	mdi°™˚
;

177 
u_ch¨
 
	mty≥
;

178 
	#STATIC_IPV4_GATEWAY
 1

	)

179 
	#STATIC_IPV4_IFNAME
 2

	)

180 
	#STATIC_IPV4_BLACKHOLE
 3

	)

185 
ö_addr
 
	mùv4
;

186 *
	mi‚ame
;

187 } 
	mg©e
;

190 
u_ch¨
 
	mÊags
;

197 #ifde‡
HAVE_IPV6


199 
	s°©ic_ùv6


202 
°©ic_ùv6
 *
	m¥ev
;

203 
°©ic_ùv6
 *
	m√xt
;

206 
u_ch¨
 
	mdi°™˚
;

209 
u_ch¨
 
	mty≥
;

210 
	#STATIC_IPV6_GATEWAY
 1

	)

211 
	#STATIC_IPV6_GATEWAY_IFNAME
 2

	)

212 
	#STATIC_IPV6_IFNAME
 3

	)

215 
ö6_addr
 
	mùv6
;

216 *
	mi‚ame
;

219 
u_ch¨
 
	mÊags
;

227 
	e√xth›_ty≥s_t


229 
	mNEXTHOP_TYPE_IFINDEX
 = 1,

230 
	mNEXTHOP_TYPE_IFNAME
,

231 
	mNEXTHOP_TYPE_IPV4
,

232 
	mNEXTHOP_TYPE_IPV4_IFINDEX
,

233 
	mNEXTHOP_TYPE_IPV4_IFNAME
,

234 
	mNEXTHOP_TYPE_IPV6
,

235 
	mNEXTHOP_TYPE_IPV6_IFINDEX
,

236 
	mNEXTHOP_TYPE_IPV6_IFNAME
,

237 
	mNEXTHOP_TYPE_BLACKHOLE
,

241 
	s√xth›


243 
√xth›
 *
	m√xt
;

244 
√xth›
 *
	m¥ev
;

247 *
	mi‚ame
;

248 
	mifödex
;

250 
√xth›_ty≥s_t
 
	mty≥
;

252 
u_ch¨
 
	mÊags
;

253 
	#NEXTHOP_FLAG_ACTIVE
 (1 << 0Ë

	)

254 
	#NEXTHOP_FLAG_FIB
 (1 << 1Ë

	)

255 
	#NEXTHOP_FLAG_RECURSIVE
 (1 << 2Ë

	)

258 
g_addr
 
	mg©e
;

261 
u_ch¨
 
	mπy≥
;

262 
	mrifödex
;

263 
g_addr
 
	mrg©e
;

264 
g_addr
 
	m§c
;

268 
	svrf


271 
u_öt32_t
 
	mid
;

274 *
	m«me
;

277 *
	mdesc
;

280 
u_ch¨
 
	mfib_id
;

283 
rouã_èbÀ
 *
	mèbÀ
[
AFI_MAX
][
SAFI_MAX
];

286 
rouã_èbÀ
 *
	m°abÀ
[
AFI_MAX
][
SAFI_MAX
];

295 
	srib_èbÀ_öfo_t_


301 
vrf
 *
	mvrf
;

302 
afi_t
 
	mafi
;

303 
ßfi_t
 
	mßfi
;

305 } 
	trib_èbÀ_öfo_t
;

309 
	mRIB_TABLES_ITER_S_INIT
,

310 
	mRIB_TABLES_ITER_S_ITERATING
,

311 
	mRIB_TABLES_ITER_S_DONE


312 } 
	trib_èbÀs_ôî_°©e_t
;

318 
	srib_èbÀs_ôî_t_


320 
uöt32_t
 
	mvrf_id
;

321 
	mafi_ßfi_ix
;

323 
rib_èbÀs_ôî_°©e_t
 
	m°©e
;

324 } 
	trib_èbÀs_ôî_t
;

326 c⁄° *
√xth›_ty≥_to_°r
 (
√xth›_ty≥s_t
 
nh_ty≥
);

327 
√xth›
 *
√xth›_ifödex_add
 (
rib
 *, );

328 
√xth›
 *
√xth›_i‚ame_add
 (
rib
 *, *);

329 
√xth›
 *
√xth›_bœckhﬁe_add
 (
rib
 *);

330 
√xth›
 *
√xth›_ùv4_add
 (
rib
 *, 
ö_addr
 *,

331 
ö_addr
 *);

332 
√xth›
 *
√xth›_ùv4_ifödex_add
 (
rib
 *,

333 
ö_addr
 *,

334 
ö_addr
 *,

336 
rib_lookup_™d_dump
 (
¥efix_ùv4
 *);

337 
rib_lookup_™d_pushup
 (
¥efix_ùv4
 *);

338 
rib_dump
 (c⁄° *, c⁄° 
¥efix_ùv4
 *, c⁄° 
rib
 *);

339 
rib_lookup_ùv4_rouã
 (
¥efix_ùv4
 *, 
sockuni⁄
 *);

340 
	#ZEBRA_RIB_LOOKUP_ERROR
 -1

	)

341 
	#ZEBRA_RIB_FOUND_EXACT
 0

	)

342 
	#ZEBRA_RIB_FOUND_NOGATE
 1

	)

343 
	#ZEBRA_RIB_FOUND_CONNECTED
 2

	)

344 
	#ZEBRA_RIB_NOTFOUND
 3

	)

346 #ifde‡
HAVE_IPV6


347 
√xth›
 *
√xth›_ùv6_add
 (
rib
 *, 
ö6_addr
 *);

350 
vrf
 *
vrf_lookup
 (
u_öt32_t
);

351 
rouã_èbÀ
 *
vrf_èbÀ
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
id
);

352 
rouã_èbÀ
 *
vrf_°©ic_èbÀ
 (
afi_t
 
afi
, 
ßfi_t
 
ßfi
, 
u_öt32_t
 
id
);

357 
rib_add_ùv4
 (
ty≥
, 
Êags
, 
¥efix_ùv4
 *
p
,

358 
ö_addr
 *
g©e
, ö_add∏*
§c
,

359 
ifödex
, 
u_öt32_t
 
vrf_id
,

360 
u_öt32_t
, 
u_ch¨
, 
ßfi_t
);

362 
rib_add_ùv4_mu…ù©h
 (
¥efix_ùv4
 *, 
rib
 *, 
ßfi_t
);

364 
rib_dñëe_ùv4
 (
ty≥
, 
Êags
, 
¥efix_ùv4
 *
p
,

365 
ö_addr
 *
g©e
, 
ifödex
,

366 
u_öt32_t
, 
ßfi_t
 
ßfi
);

368 
rib
 *
rib_m©ch_ùv4
 (
ö_addr
);

370 
rib
 *
rib_lookup_ùv4
 (
¥efix_ùv4
 *);

372 
rib_upd©e
 ();

373 
rib_wìd_èbÀs
 ();

374 
rib_swìp_rouã
 ();

375 
rib_˛o£
 ();

376 
rib_öô
 ();

377 
rib_sc‹e_¥Ÿo
 (
u_ch¨
 
¥Ÿo
);

380 
°©ic_add_ùv4
 (
¥efix
 *
p
, 
ö_addr
 *
g©e
, c⁄° *
i‚ame
,

381 
u_ch¨
 
Êags
, u_ch¨ 
di°™˚
, 
u_öt32_t
 
vrf_id
);

384 
°©ic_dñëe_ùv4
 (
¥efix
 *
p
, 
ö_addr
 *
g©e
, c⁄° *
i‚ame
,

385 
u_ch¨
 
di°™˚
, 
u_öt32_t
 
vrf_id
);

387 #ifde‡
HAVE_IPV6


389 
rib_add_ùv6
 (
ty≥
, 
Êags
, 
¥efix_ùv6
 *
p
,

390 
ö6_addr
 *
g©e
, 
ifödex
, 
u_öt32_t
 
vrf_id
,

391 
u_öt32_t
 
mëric
, 
u_ch¨
 
di°™˚
, 
ßfi_t
 
ßfi
);

394 
rib_dñëe_ùv6
 (
ty≥
, 
Êags
, 
¥efix_ùv6
 *
p
,

395 
ö6_addr
 *
g©e
, 
ifödex
, 
u_öt32_t
 
vrf_id
, 
ßfi_t
 
ßfi
);

397 
rib
 *
rib_lookup_ùv6
 (
ö6_addr
 *);

399 
rib
 *
rib_m©ch_ùv6
 (
ö6_addr
 *);

401 
rouã_èbÀ
 *
rib_èbÀ_ùv6
;

404 
°©ic_add_ùv6
 (
¥efix
 *
p
, 
u_ch¨
 
ty≥
, 
ö6_addr
 *
g©e
,

405 c⁄° *
i‚ame
, 
u_ch¨
 
Êags
, u_ch¨ 
di°™˚
,

406 
u_öt32_t
 
vrf_id
);

409 
°©ic_dñëe_ùv6
 (
¥efix
 *
p
, 
u_ch¨
 
ty≥
, 
ö6_addr
 *
g©e
,

410 c⁄° *
i‚ame
, 
u_ch¨
 
di°™˚
, 
u_öt32_t
 
vrf_id
);

414 
rib_gc_de°
 (
rouã_node
 *
∫
);

415 
rouã_èbÀ
 *
rib_èbÀs_ôî_√xt
 (
rib_èbÀs_ôî_t
 *
ôî
);

424 
ölöe
 
rib_èbÀ_öfo_t
 *

425 
	$rib_èbÀ_öfo
 (
rouã_èbÀ
 *
èbÀ
)

427  (
rib_èbÀ_öfo_t
 *Ë
èbÀ
->
öfo
;

428 
	}
}

433 
ölöe
 
rib_de°_t
 *

434 
	$rib_de°_‰om_∫ode
 (
rouã_node
 *
∫
)

436  (
rib_de°_t
 *Ë
∫
->
öfo
;

437 
	}
}

445 
ölöe
 
rib
 *

446 
	$∫ode_to_ribs
 (
rouã_node
 *
∫
)

448 
rib_de°_t
 *
de°
;

450 
de°
 = 
	`rib_de°_‰om_∫ode
 (
∫
);

451 i‡(!
de°
)

452  
NULL
;

454  
de°
->
rouãs
;

455 
	}
}

460 
ölöe
 
¥efix
 *

461 
	$rib_de°_¥efix
 (
rib_de°_t
 *
de°
)

463  &
de°
->
∫ode
->
p
;

464 
	}
}

471 
ölöe
 
u_ch¨


472 
	$rib_de°_af
 (
rib_de°_t
 *
de°
)

474  
de°
->
∫ode
->
p
.
Ámûy
;

475 
	}
}

480 
ölöe
 
rouã_èbÀ
 *

481 
	$rib_de°_èbÀ
 (
rib_de°_t
 *
de°
)

483  
de°
->
∫ode
->
èbÀ
;

484 
	}
}

489 
ölöe
 
vrf
 *

490 
	$rib_de°_vrf
 (
rib_de°_t
 *
de°
)

492  
	`rib_èbÀ_öfo
 (
	`rib_de°_èbÀ
 (
de°
))->
vrf
;

493 
	}
}

498 
ölöe
 

499 
	$rib_èbÀs_ôî_öô
 (
rib_èbÀs_ôî_t
 *
ôî
)

502 
	`mem£t
 (
ôî
, 0,  (*iter));

503 
ôî
->
°©e
 = 
RIB_TABLES_ITER_S_INIT
;

504 
	}
}

512 
ölöe
 

513 
	$rib_èbÀs_ôî_°¨ãd
 (
rib_èbÀs_ôî_t
 *
ôî
)

515  
ôî
->
°©e
 !
RIB_TABLES_ITER_S_INIT
;

516 
	}
}

521 
ölöe
 

522 
	$rib_èbÀs_ôî_˛ónup
 (
rib_èbÀs_ôî_t
 *
ôî
)

524 
ôî
->
°©e
 = 
RIB_TABLES_ITER_S_DONE
;

525 
	}
}

	@zebra/router-id.h

24 #i‚de‡
_ROUTER_ID_H_


25 
	#_ROUTER_ID_H_


	)

27 
	~<zebø.h
>

29 
	~"mem‹y.h
"

30 
	~"¥efix.h
"

31 
	~"z˛õ¡.h
"

32 
	~"if.h
"

34 
rouãr_id_add_addªss
(
c⁄√˘ed
 *);

35 
rouãr_id_dñ_addªss
(
c⁄√˘ed
 *);

36 
rouãr_id_öô
();

37 
rouãr_id_wrôe
(
vty
 *);

38 
rouãr_id_gë
(
¥efix
 *);

	@zebra/rt.h

23 #i‚de‡
_ZEBRA_RT_H


24 
	#_ZEBRA_RT_H


	)

26 
	~"¥efix.h
"

27 
	~"if.h
"

28 
	~"zebø/rib.h
"

30 
kî√l_add_ùv4
 (
¥efix
 *, 
rib
 *);

31 
kî√l_dñëe_ùv4
 (
¥efix
 *, 
rib
 *);

32 
kî√l_add_rouã
 (
¥efix_ùv4
 *, 
ö_addr
 *, , );

33 
kî√l_addªss_add_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

34 
kî√l_addªss_dñëe_ùv4
 (
öãrÁ˚
 *, 
c⁄√˘ed
 *);

36 #ifde‡
HAVE_IPV6


37 
kî√l_add_ùv6
 (
¥efix
 *, 
rib
 *);

38 
kî√l_dñëe_ùv6
 (
¥efix
 *, 
rib
 *);

39 
kî√l_dñëe_ùv6_ﬁd
 (
¥efix_ùv6
 *
de°
, 
ö6_addr
 *
g©e
,

40 
ödex
, 
Êags
, 
èbÀ
);

	@zebra/rtadv.h

23 #i‚de‡
_ZEBRA_RTADV_H


24 
	#_ZEBRA_RTADV_H


	)

26 
	~"vty.h
"

27 
	~"zebø/öãrÁ˚.h
"

30 #ifde‡
RTADV


33 
	sπadv_¥efix


36 
¥efix_ùv6
 
	m¥efix
;

39 
u_öt32_t
 
	mAdvVÆidLi„time
;

40 
	#RTADV_VALID_LIFETIME
 2592000

	)

43 
	mAdvOnLökFœg
;

47 
u_öt32_t
 
	mAdvPª„ºedLi„time
;

48 
	#RTADV_PREFERRED_LIFETIME
 604800

	)

51 
	mAdvAut⁄omousFœg
;

54 
	mAdvRouãrAddªssFœg
;

55 #i‚de‡
ND_OPT_PI_FLAG_RADDR


56 
	#ND_OPT_PI_FLAG_RADDR
 0x20

	)

61 
πadv_c⁄fig_wrôe
 (
vty
 *, 
öãrÁ˚
 *);

62 
πadv_öô
 ();

66 #i‚de‡
ND_OPT_ADV_INTERVAL


67 
	#ND_OPT_ADV_INTERVAL
 7

	)

69 #i‚de‡
ND_OPT_HA_INFORMATION


70 
	#ND_OPT_HA_INFORMATION
 8

	)

73 #i‚de‡
HAVE_STRUCT_ND_OPT_ADV_INTERVAL


74 
	snd_›t_adv_öãrvÆ
 {

75 
uöt8_t
 
	mnd_›t_ai_ty≥
;

76 
uöt8_t
 
	mnd_›t_ai_Àn
;

77 
uöt16_t
 
	mnd_›t_ai_ª£rved
;

78 
uöt32_t
 
	mnd_›t_ai_öãrvÆ
;

79 } 
__©åibuã__
((
__∑cked__
));

81 #i‚de‡
HAVE_STRUCT_ND_OPT_ADV_INTERVAL_ND_OPT_AI_TYPE


83 
	#nd_›t_ai_ty≥
 
nd_›t_adv_öãrvÆ_ty≥


	)

84 
	#nd_›t_ai_Àn
 
nd_›t_adv_öãrvÆ_Àn


	)

85 
	#nd_›t_ai_ª£rved
 
nd_›t_adv_öãrvÆ_ª£rved


	)

86 
	#nd_›t_ai_öãrvÆ
 
nd_›t_adv_öãrvÆ_ivÆ


	)

90 #i‚de‡
HAVE_STRUCT_ND_OPT_HOMEAGENT_INFO


91 
	snd_›t_homógít_öfo
 {

92 
u_öt8_t
 
	mnd_›t_hai_ty≥
;

93 
u_öt8_t
 
	mnd_›t_hai_Àn
;

94 
u_öt16_t
 
	mnd_›t_hai_ª£rved
;

95 
u_öt16_t
 
	mnd_›t_hai_¥e„ªn˚
;

96 
u_öt16_t
 
	mnd_›t_hai_li„time
;

97 } 
__©åibuã__
((
__∑cked__
));

100 c⁄° *
πadv_¥ef_°rs
[];

	@zebra/zebra_fpm.h

25 #i‚de‡
_ZEBRA_FPM_H


26 
	#_ZEBRA_FPM_H


	)

31 
zÂm_öô
 (
thªad_ma°î
 *
ma°î
, 
íabÀ
, 
uöt16_t
 
p‹t
);

32 
zÂm_åiggî_upd©e
 (
rouã_node
 *
∫
, c⁄° *
ªas⁄
);

	@zebra/zserv.h

22 #i‚de‡
_ZEBRA_ZSERV_H


23 
	#_ZEBRA_ZSERV_H


	)

25 
	~"rib.h
"

26 
	~"if.h
"

27 
	~"w‹kqueue.h
"

30 
	#ZEBRA_VTY_PORT
 2601

	)

33 
	#DEFAULT_CONFIG_FILE
 "zebø.c⁄f"

	)

36 
	sz£rv


39 
	msock
;

42 
°ªam
 *
	mibuf
;

43 
°ªam
 *
	mobuf
;

46 
buf„r
 *
	mwb
;

49 
thªad
 *
	mt_ªad
;

50 
thªad
 *
	mt_wrôe
;

53 
thªad
 *
	mt_suicide
;

56 
	mπm_èbÀ
;

59 
u_ch¨
 
	mªdi°
[
ZEBRA_ROUTE_MAX
];

62 
u_ch¨
 
	mªdi°_deÁu…
;

65 
u_ch¨
 
	miföfo
;

68 
u_ch¨
 
	mridöfo
;

72 
	szebø_t


75 
thªad_ma°î
 *
	mma°î
;

76 
li°
 *
	m˛õ¡_li°
;

79 
	mπm_èbÀ_deÁu…
;

82 
w‹k_queue
 *
	mribq
;

83 
mëa_queue
 *
	mmq
;

87 
	#PSIZE
(
a
Ë((◊Ë+ 7Ë/ (8))

	)

90 
zebø_öô
 ();

91 
zebø_if_öô
 ();

92 
zebø_z£rv_sockë_öô
 (*
∑th
);

93 
ho°öfo_gë
 ();

94 
rib_öô
 ();

95 
öãrÁ˚_li°
 ();

96 
kî√l_öô
 ();

97 
rouã_ªad
 ();

98 
zebø_rouã_m≠_öô
 ();

99 
zebø_¢mp_öô
 ();

100 
zebø_vty_öô
 ();

102 
z£nd_öãrÁ˚_add
 (
z£rv
 *, 
öãrÁ˚
 *);

103 
z£nd_öãrÁ˚_dñëe
 (
z£rv
 *, 
öãrÁ˚
 *);

104 
z£nd_öãrÁ˚_addªss
 (, 
z£rv
 *, 
öãrÁ˚
 *,

105 
c⁄√˘ed
 *);

106 
z£nd_öãrÁ˚_upd©e
 (, 
z£rv
 *, 
öãrÁ˚
 *);

107 
z£nd_rouã_mu…ù©h
 (, 
z£rv
 *, 
¥efix
 *,

108 
rib
 *);

109 
z£nd_rouãr_id_upd©e
(
z£rv
 *, 
¥efix
 *);

111 
pid_t
 
pid
;

	@/usr/include/asm-generic/types.h

1 #i‚de‡
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-gíîic/öt-Œ64.h
>

	@/usr/include/bits/byteswap.h

19 #i‡!
deföed
 
_BYTESWAP_H
 && !deföed 
_NETINET_IN_H
 && !deföed 
_ENDIAN_H


23 #i‚de‡
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

28 
	~<bôs/w‹dsize.h
>

31 
	#__bsw≠_c⁄°™t_16
(
x
) \

32 ((Ë((((
x
Ë>> 8Ë& 0xffË| (((xË& 0xffË<< 8)))

	)

35 
	~<bôs/byãsw≠-16.h
>

38 
	#__bsw≠_c⁄°™t_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
Ë& 0x0000ff00Ë<< 8Ë| (((xË& 0x000000ffË<< 24))

	)

42 #ifde‡
__GNUC__


43 #i‡
__GNUC_PREREQ
 (4, 3)

44 
__ölöe
 

45 
	$__bsw≠_32
 (
__bsx
)

47  
	`__buûtö_bsw≠32
 (
__bsx
);

48 
	}
}

49 #ñi‡
__GNUC__
 >= 2

50 #i‡
__WORDSIZE
 =64 || (
deföed
 
__i486__
 || deföed 
__≥¡ium__
 \

51 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

52 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

53 || 
deföed
 
	g__k6__
 || deföed 
	g__noc⁄a__
 \

54 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__geode__
 \

55 || 
deföed
 
	g__amdÁm10__
)

58 
	#__bsw≠_32
(
x
) \

59 (
__exãnsi⁄__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

62 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

64 
	`__asm__
 ("bsw≠ %0" : "Ù" (
__v
Ë: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw≠_32
(
x
) \

68 (
__exãnsi⁄__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

71 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "Ù" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw≠_32
(
x
) \

83 (
__exãnsi⁄__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_32
 (__x); }))

	)

87 
__ölöe
 

88 
	$__bsw≠_32
 (
__bsx
)

90  
	`__bsw≠_c⁄°™t_32
 (
__bsx
);

91 
	}
}

95 #i‡
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw≠_c⁄°™t_64
(
x
) \

98 (
	`__exãnsi⁄__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
Ë& 0x00000000000000ffuŒË<< 56)))

	)

107 #i‡
__GNUC_PREREQ
 (4, 3)

108 
__ölöe
 
__uöt64_t


109 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

111  
	`__buûtö_bsw≠64
 (
__bsx
);

112 
	}
}

113 #ñi‡
__WORDSIZE
 == 64

114 
	#__bsw≠_64
(
x
) \

115 (
__exãnsi⁄__
 \

116 ({ 
__uöt64_t
 
__v
, 
__x
 = (
x
); \

117 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

118 
__v
 = 
	`__bsw≠_c⁄°™t_64
 (
__x
); \

120 
	`__asm__
 ("bsw≠ %q0" : "Ù" (
__v
Ë: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw≠_64
(
x
) \

124 (
__exãnsi⁄__
 \

125 ({ uni⁄ { 
__exãnsi⁄__
 
__uöt64_t
 
__Œ
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 i‡(
	`__buûtö_c⁄°™t_p
 (
x
)) \

128 
__r
.
__Œ
 = 
	`__bsw≠_c⁄°™t_64
 (
x
); \

131 
__w
.
__Œ
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw≠_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw≠_32
 (
__w
.__l[0]); \

135 
__r
.
__Œ
; }))

	)

137 #ñi‡
__GLIBC_HAVE_LONG_LONG


138 
	#__bsw≠_c⁄°™t_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
Ë& 0x00000000000000ffuŒË<< 56))

	)

148 
__ölöe
 
__uöt64_t


149 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

151  
	`__bsw≠_c⁄°™t_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/confname.h

20 #i‚de‡
_UNISTD_H


27 
	m_PC_LINK_MAX
,

28 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

29 
	m_PC_MAX_CANON
,

30 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

31 
	m_PC_MAX_INPUT
,

32 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

33 
	m_PC_NAME_MAX
,

34 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

35 
	m_PC_PATH_MAX
,

36 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

37 
	m_PC_PIPE_BUF
,

38 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

39 
	m_PC_CHOWN_RESTRICTED
,

40 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

41 
	m_PC_NO_TRUNC
,

42 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

43 
	m_PC_VDISABLE
,

44 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

45 
	m_PC_SYNC_IO
,

46 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

47 
	m_PC_ASYNC_IO
,

48 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

49 
	m_PC_PRIO_IO
,

50 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

51 
	m_PC_SOCK_MAXBUF
,

52 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

53 
	m_PC_FILESIZEBITS
,

54 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

55 
	m_PC_REC_INCR_XFER_SIZE
,

56 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

57 
	m_PC_REC_MAX_XFER_SIZE
,

58 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

59 
	m_PC_REC_MIN_XFER_SIZE
,

60 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

61 
	m_PC_REC_XFER_ALIGN
,

62 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

63 
	m_PC_ALLOC_SIZE_MIN
,

64 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

65 
	m_PC_SYMLINK_MAX
,

66 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

67 
	m_PC_2_SYMLINKS


68 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

74 
	m_SC_ARG_MAX
,

75 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

76 
	m_SC_CHILD_MAX
,

77 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

78 
	m_SC_CLK_TCK
,

79 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

80 
	m_SC_NGROUPS_MAX
,

81 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

82 
	m_SC_OPEN_MAX
,

83 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

84 
	m_SC_STREAM_MAX
,

85 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

86 
	m_SC_TZNAME_MAX
,

87 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

88 
	m_SC_JOB_CONTROL
,

89 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

90 
	m_SC_SAVED_IDS
,

91 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

92 
	m_SC_REALTIME_SIGNALS
,

93 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

94 
	m_SC_PRIORITY_SCHEDULING
,

95 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

96 
	m_SC_TIMERS
,

97 
	#_SC_TIMERS
 
_SC_TIMERS


	)

98 
	m_SC_ASYNCHRONOUS_IO
,

99 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

100 
	m_SC_PRIORITIZED_IO
,

101 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

102 
	m_SC_SYNCHRONIZED_IO
,

103 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

104 
	m_SC_FSYNC
,

105 
	#_SC_FSYNC
 
_SC_FSYNC


	)

106 
	m_SC_MAPPED_FILES
,

107 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

108 
	m_SC_MEMLOCK
,

109 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

110 
	m_SC_MEMLOCK_RANGE
,

111 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

112 
	m_SC_MEMORY_PROTECTION
,

113 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

114 
	m_SC_MESSAGE_PASSING
,

115 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

116 
	m_SC_SEMAPHORES
,

117 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

118 
	m_SC_SHARED_MEMORY_OBJECTS
,

119 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

120 
	m_SC_AIO_LISTIO_MAX
,

121 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

122 
	m_SC_AIO_MAX
,

123 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

124 
	m_SC_AIO_PRIO_DELTA_MAX
,

125 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

126 
	m_SC_DELAYTIMER_MAX
,

127 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

128 
	m_SC_MQ_OPEN_MAX
,

129 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

130 
	m_SC_MQ_PRIO_MAX
,

131 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

132 
	m_SC_VERSION
,

133 
	#_SC_VERSION
 
_SC_VERSION


	)

134 
	m_SC_PAGESIZE
,

135 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

136 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

137 
	m_SC_RTSIG_MAX
,

138 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

139 
	m_SC_SEM_NSEMS_MAX
,

140 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

141 
	m_SC_SEM_VALUE_MAX
,

142 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

143 
	m_SC_SIGQUEUE_MAX
,

144 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

145 
	m_SC_TIMER_MAX
,

146 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

150 
	m_SC_BC_BASE_MAX
,

151 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

152 
	m_SC_BC_DIM_MAX
,

153 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

154 
	m_SC_BC_SCALE_MAX
,

155 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

156 
	m_SC_BC_STRING_MAX
,

157 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

158 
	m_SC_COLL_WEIGHTS_MAX
,

159 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

160 
	m_SC_EQUIV_CLASS_MAX
,

161 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

162 
	m_SC_EXPR_NEST_MAX
,

163 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

164 
	m_SC_LINE_MAX
,

165 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

166 
	m_SC_RE_DUP_MAX
,

167 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

168 
	m_SC_CHARCLASS_NAME_MAX
,

169 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

171 
	m_SC_2_VERSION
,

172 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

173 
	m_SC_2_C_BIND
,

174 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

175 
	m_SC_2_C_DEV
,

176 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

177 
	m_SC_2_FORT_DEV
,

178 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

179 
	m_SC_2_FORT_RUN
,

180 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

181 
	m_SC_2_SW_DEV
,

182 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

183 
	m_SC_2_LOCALEDEF
,

184 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

186 
	m_SC_PII
,

187 
	#_SC_PII
 
_SC_PII


	)

188 
	m_SC_PII_XTI
,

189 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

190 
	m_SC_PII_SOCKET
,

191 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

192 
	m_SC_PII_INTERNET
,

193 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

194 
	m_SC_PII_OSI
,

195 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

196 
	m_SC_POLL
,

197 
	#_SC_POLL
 
_SC_POLL


	)

198 
	m_SC_SELECT
,

199 
	#_SC_SELECT
 
_SC_SELECT


	)

200 
	m_SC_UIO_MAXIOV
,

201 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

202 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

203 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

204 
	m_SC_PII_INTERNET_STREAM
,

205 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

206 
	m_SC_PII_INTERNET_DGRAM
,

207 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

208 
	m_SC_PII_OSI_COTS
,

209 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

210 
	m_SC_PII_OSI_CLTS
,

211 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

212 
	m_SC_PII_OSI_M
,

213 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

214 
	m_SC_T_IOV_MAX
,

215 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

218 
	m_SC_THREADS
,

219 
	#_SC_THREADS
 
_SC_THREADS


	)

220 
	m_SC_THREAD_SAFE_FUNCTIONS
,

221 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

222 
	m_SC_GETGR_R_SIZE_MAX
,

223 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

224 
	m_SC_GETPW_R_SIZE_MAX
,

225 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

226 
	m_SC_LOGIN_NAME_MAX
,

227 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

228 
	m_SC_TTY_NAME_MAX
,

229 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

230 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

231 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

232 
	m_SC_THREAD_KEYS_MAX
,

233 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

234 
	m_SC_THREAD_STACK_MIN
,

235 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

236 
	m_SC_THREAD_THREADS_MAX
,

237 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

238 
	m_SC_THREAD_ATTR_STACKADDR
,

239 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

240 
	m_SC_THREAD_ATTR_STACKSIZE
,

241 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

242 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

243 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

244 
	m_SC_THREAD_PRIO_INHERIT
,

245 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

246 
	m_SC_THREAD_PRIO_PROTECT
,

247 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

248 
	m_SC_THREAD_PROCESS_SHARED
,

249 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

251 
	m_SC_NPROCESSORS_CONF
,

252 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

253 
	m_SC_NPROCESSORS_ONLN
,

254 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

255 
	m_SC_PHYS_PAGES
,

256 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

257 
	m_SC_AVPHYS_PAGES
,

258 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

259 
	m_SC_ATEXIT_MAX
,

260 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

261 
	m_SC_PASS_MAX
,

262 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

264 
	m_SC_XOPEN_VERSION
,

265 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

266 
	m_SC_XOPEN_XCU_VERSION
,

267 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

268 
	m_SC_XOPEN_UNIX
,

269 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

270 
	m_SC_XOPEN_CRYPT
,

271 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

272 
	m_SC_XOPEN_ENH_I18N
,

273 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

274 
	m_SC_XOPEN_SHM
,

275 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

277 
	m_SC_2_CHAR_TERM
,

278 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

279 
	m_SC_2_C_VERSION
,

280 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

281 
	m_SC_2_UPE
,

282 
	#_SC_2_UPE
 
_SC_2_UPE


	)

284 
	m_SC_XOPEN_XPG2
,

285 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

286 
	m_SC_XOPEN_XPG3
,

287 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

288 
	m_SC_XOPEN_XPG4
,

289 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

291 
	m_SC_CHAR_BIT
,

292 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

293 
	m_SC_CHAR_MAX
,

294 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

295 
	m_SC_CHAR_MIN
,

296 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

297 
	m_SC_INT_MAX
,

298 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

299 
	m_SC_INT_MIN
,

300 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

301 
	m_SC_LONG_BIT
,

302 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

303 
	m_SC_WORD_BIT
,

304 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

305 
	m_SC_MB_LEN_MAX
,

306 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

307 
	m_SC_NZERO
,

308 
	#_SC_NZERO
 
_SC_NZERO


	)

309 
	m_SC_SSIZE_MAX
,

310 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

311 
	m_SC_SCHAR_MAX
,

312 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

313 
	m_SC_SCHAR_MIN
,

314 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

315 
	m_SC_SHRT_MAX
,

316 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

317 
	m_SC_SHRT_MIN
,

318 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

319 
	m_SC_UCHAR_MAX
,

320 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

321 
	m_SC_UINT_MAX
,

322 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

323 
	m_SC_ULONG_MAX
,

324 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

325 
	m_SC_USHRT_MAX
,

326 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

328 
	m_SC_NL_ARGMAX
,

329 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

330 
	m_SC_NL_LANGMAX
,

331 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

332 
	m_SC_NL_MSGMAX
,

333 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

334 
	m_SC_NL_NMAX
,

335 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

336 
	m_SC_NL_SETMAX
,

337 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

338 
	m_SC_NL_TEXTMAX
,

339 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

341 
	m_SC_XBS5_ILP32_OFF32
,

342 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

343 
	m_SC_XBS5_ILP32_OFFBIG
,

344 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

345 
	m_SC_XBS5_LP64_OFF64
,

346 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

347 
	m_SC_XBS5_LPBIG_OFFBIG
,

348 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

350 
	m_SC_XOPEN_LEGACY
,

351 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

352 
	m_SC_XOPEN_REALTIME
,

353 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

354 
	m_SC_XOPEN_REALTIME_THREADS
,

355 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

357 
	m_SC_ADVISORY_INFO
,

358 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

359 
	m_SC_BARRIERS
,

360 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

361 
	m_SC_BASE
,

362 
	#_SC_BASE
 
_SC_BASE


	)

363 
	m_SC_C_LANG_SUPPORT
,

364 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

365 
	m_SC_C_LANG_SUPPORT_R
,

366 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

367 
	m_SC_CLOCK_SELECTION
,

368 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

369 
	m_SC_CPUTIME
,

370 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

371 
	m_SC_THREAD_CPUTIME
,

372 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

373 
	m_SC_DEVICE_IO
,

374 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

375 
	m_SC_DEVICE_SPECIFIC
,

376 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

377 
	m_SC_DEVICE_SPECIFIC_R
,

378 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

379 
	m_SC_FD_MGMT
,

380 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

381 
	m_SC_FIFO
,

382 
	#_SC_FIFO
 
_SC_FIFO


	)

383 
	m_SC_PIPE
,

384 
	#_SC_PIPE
 
_SC_PIPE


	)

385 
	m_SC_FILE_ATTRIBUTES
,

386 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

387 
	m_SC_FILE_LOCKING
,

388 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

389 
	m_SC_FILE_SYSTEM
,

390 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

391 
	m_SC_MONOTONIC_CLOCK
,

392 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

393 
	m_SC_MULTI_PROCESS
,

394 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

395 
	m_SC_SINGLE_PROCESS
,

396 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

397 
	m_SC_NETWORKING
,

398 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

399 
	m_SC_READER_WRITER_LOCKS
,

400 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

401 
	m_SC_SPIN_LOCKS
,

402 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

403 
	m_SC_REGEXP
,

404 
	#_SC_REGEXP
 
_SC_REGEXP


	)

405 
	m_SC_REGEX_VERSION
,

406 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

407 
	m_SC_SHELL
,

408 
	#_SC_SHELL
 
_SC_SHELL


	)

409 
	m_SC_SIGNALS
,

410 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

411 
	m_SC_SPAWN
,

412 
	#_SC_SPAWN
 
_SC_SPAWN


	)

413 
	m_SC_SPORADIC_SERVER
,

414 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

415 
	m_SC_THREAD_SPORADIC_SERVER
,

416 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

417 
	m_SC_SYSTEM_DATABASE
,

418 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

419 
	m_SC_SYSTEM_DATABASE_R
,

420 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

421 
	m_SC_TIMEOUTS
,

422 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

423 
	m_SC_TYPED_MEMORY_OBJECTS
,

424 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

425 
	m_SC_USER_GROUPS
,

426 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

427 
	m_SC_USER_GROUPS_R
,

428 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

429 
	m_SC_2_PBS
,

430 
	#_SC_2_PBS
 
_SC_2_PBS


	)

431 
	m_SC_2_PBS_ACCOUNTING
,

432 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

433 
	m_SC_2_PBS_LOCATE
,

434 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

435 
	m_SC_2_PBS_MESSAGE
,

436 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

437 
	m_SC_2_PBS_TRACK
,

438 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

439 
	m_SC_SYMLOOP_MAX
,

440 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

441 
	m_SC_STREAMS
,

442 
	#_SC_STREAMS
 
_SC_STREAMS


	)

443 
	m_SC_2_PBS_CHECKPOINT
,

444 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

446 
	m_SC_V6_ILP32_OFF32
,

447 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

448 
	m_SC_V6_ILP32_OFFBIG
,

449 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

450 
	m_SC_V6_LP64_OFF64
,

451 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

452 
	m_SC_V6_LPBIG_OFFBIG
,

453 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

455 
	m_SC_HOST_NAME_MAX
,

456 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

457 
	m_SC_TRACE
,

458 
	#_SC_TRACE
 
_SC_TRACE


	)

459 
	m_SC_TRACE_EVENT_FILTER
,

460 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

461 
	m_SC_TRACE_INHERIT
,

462 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

463 
	m_SC_TRACE_LOG
,

464 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

466 
	m_SC_LEVEL1_ICACHE_SIZE
,

467 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

468 
	m_SC_LEVEL1_ICACHE_ASSOC
,

469 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

470 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

471 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

472 
	m_SC_LEVEL1_DCACHE_SIZE
,

473 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

474 
	m_SC_LEVEL1_DCACHE_ASSOC
,

475 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

476 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

477 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

478 
	m_SC_LEVEL2_CACHE_SIZE
,

479 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

480 
	m_SC_LEVEL2_CACHE_ASSOC
,

481 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

482 
	m_SC_LEVEL2_CACHE_LINESIZE
,

483 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

484 
	m_SC_LEVEL3_CACHE_SIZE
,

485 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

486 
	m_SC_LEVEL3_CACHE_ASSOC
,

487 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

488 
	m_SC_LEVEL3_CACHE_LINESIZE
,

489 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

490 
	m_SC_LEVEL4_CACHE_SIZE
,

491 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

492 
	m_SC_LEVEL4_CACHE_ASSOC
,

493 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

494 
	m_SC_LEVEL4_CACHE_LINESIZE
,

495 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

498 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

499 
	#_SC_IPV6
 
_SC_IPV6


	)

500 
	m_SC_RAW_SOCKETS
,

501 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

503 
	m_SC_V7_ILP32_OFF32
,

504 
	#_SC_V7_ILP32_OFF32
 
_SC_V7_ILP32_OFF32


	)

505 
	m_SC_V7_ILP32_OFFBIG
,

506 
	#_SC_V7_ILP32_OFFBIG
 
_SC_V7_ILP32_OFFBIG


	)

507 
	m_SC_V7_LP64_OFF64
,

508 
	#_SC_V7_LP64_OFF64
 
_SC_V7_LP64_OFF64


	)

509 
	m_SC_V7_LPBIG_OFFBIG
,

510 
	#_SC_V7_LPBIG_OFFBIG
 
_SC_V7_LPBIG_OFFBIG


	)

512 
	m_SC_SS_REPL_MAX
,

513 
	#_SC_SS_REPL_MAX
 
_SC_SS_REPL_MAX


	)

515 
	m_SC_TRACE_EVENT_NAME_MAX
,

516 
	#_SC_TRACE_EVENT_NAME_MAX
 
_SC_TRACE_EVENT_NAME_MAX


	)

517 
	m_SC_TRACE_NAME_MAX
,

518 
	#_SC_TRACE_NAME_MAX
 
_SC_TRACE_NAME_MAX


	)

519 
	m_SC_TRACE_SYS_MAX
,

520 
	#_SC_TRACE_SYS_MAX
 
_SC_TRACE_SYS_MAX


	)

521 
	m_SC_TRACE_USER_EVENT_MAX
,

522 
	#_SC_TRACE_USER_EVENT_MAX
 
_SC_TRACE_USER_EVENT_MAX


	)

524 
	m_SC_XOPEN_STREAMS
,

525 
	#_SC_XOPEN_STREAMS
 
_SC_XOPEN_STREAMS


	)

527 
	m_SC_THREAD_ROBUST_PRIO_INHERIT
,

528 
	#_SC_THREAD_ROBUST_PRIO_INHERIT
 
_SC_THREAD_ROBUST_PRIO_INHERIT


	)

529 
	m_SC_THREAD_ROBUST_PRIO_PROTECT


530 
	#_SC_THREAD_ROBUST_PRIO_PROTECT
 
_SC_THREAD_ROBUST_PRIO_PROTECT


	)

536 
	m_CS_PATH
,

537 
	#_CS_PATH
 
_CS_PATH


	)

539 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

540 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

541 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

543 
	m_CS_GNU_LIBC_VERSION
,

544 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

545 
	m_CS_GNU_LIBPTHREAD_VERSION
,

546 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

548 
	m_CS_V5_WIDTH_RESTRICTED_ENVS
,

549 
	#_CS_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

550 
	#_CS_POSIX_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

552 
	m_CS_V7_WIDTH_RESTRICTED_ENVS
,

553 
	#_CS_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

554 
	#_CS_POSIX_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

556 
	m_CS_LFS_CFLAGS
 = 1000,

557 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

558 
	m_CS_LFS_LDFLAGS
,

559 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

560 
	m_CS_LFS_LIBS
,

561 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

562 
	m_CS_LFS_LINTFLAGS
,

563 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

564 
	m_CS_LFS64_CFLAGS
,

565 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

566 
	m_CS_LFS64_LDFLAGS
,

567 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

568 
	m_CS_LFS64_LIBS
,

569 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

570 
	m_CS_LFS64_LINTFLAGS
,

571 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

573 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

574 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

575 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

576 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

577 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

578 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

579 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

580 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

581 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

582 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

583 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

584 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

585 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

586 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

587 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

588 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

589 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

590 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

591 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

592 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

593 
	m_CS_XBS5_LP64_OFF64_LIBS
,

594 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

595 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

596 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

597 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

598 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

599 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

600 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

601 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

602 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

603 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

604 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

606 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

607 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

608 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

609 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

610 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

611 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

612 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

613 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

614 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

615 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

616 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

617 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

618 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

619 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

620 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

621 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

622 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

623 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

624 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

625 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

626 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

627 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

628 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

629 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

630 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

631 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

632 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

633 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

634 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

635 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

636 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
,

637 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

639 
	m_CS_POSIX_V7_ILP32_OFF32_CFLAGS
,

640 
	#_CS_POSIX_V7_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_CFLAGS


	)

641 
	m_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
,

642 
	#_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LDFLAGS


	)

643 
	m_CS_POSIX_V7_ILP32_OFF32_LIBS
,

644 
	#_CS_POSIX_V7_ILP32_OFF32_LIBS
 
_CS_POSIX_V7_ILP32_OFF32_LIBS


	)

645 
	m_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
,

646 
	#_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS


	)

647 
	m_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
,

648 
	#_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS


	)

649 
	m_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
,

650 
	#_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS


	)

651 
	m_CS_POSIX_V7_ILP32_OFFBIG_LIBS
,

652 
	#_CS_POSIX_V7_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V7_ILP32_OFFBIG_LIBS


	)

653 
	m_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
,

654 
	#_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS


	)

655 
	m_CS_POSIX_V7_LP64_OFF64_CFLAGS
,

656 
	#_CS_POSIX_V7_LP64_OFF64_CFLAGS
 
_CS_POSIX_V7_LP64_OFF64_CFLAGS


	)

657 
	m_CS_POSIX_V7_LP64_OFF64_LDFLAGS
,

658 
	#_CS_POSIX_V7_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LDFLAGS


	)

659 
	m_CS_POSIX_V7_LP64_OFF64_LIBS
,

660 
	#_CS_POSIX_V7_LP64_OFF64_LIBS
 
_CS_POSIX_V7_LP64_OFF64_LIBS


	)

661 
	m_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
,

662 
	#_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LINTFLAGS


	)

663 
	m_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
,

664 
	#_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS


	)

665 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
,

666 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS


	)

667 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
,

668 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LIBS


	)

669 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
,

670 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


	)

672 
	m_CS_V6_ENV
,

673 
	#_CS_V6_ENV
 
_CS_V6_ENV


	)

674 
	m_CS_V7_ENV


675 
	#_CS_V7_ENV
 
_CS_V7_ENV


	)

	@/usr/include/bits/environments.h

18 #i‚de‡
_UNISTD_H


22 
	~<bôs/w‹dsize.h
>

42 #i‡
__WORDSIZE
 == 64

56 
	#_POSIX_V7_LPBIG_OFFBIG
 -1

	)

57 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

58 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

61 
	#_POSIX_V7_LP64_OFF64
 1

	)

62 
	#_POSIX_V6_LP64_OFF64
 1

	)

63 
	#_XBS5_LP64_OFF64
 1

	)

69 
	#_POSIX_V7_ILP32_OFF32
 1

	)

70 
	#_POSIX_V7_ILP32_OFFBIG
 1

	)

71 
	#_POSIX_V6_ILP32_OFF32
 1

	)

72 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

73 
	#_XBS5_ILP32_OFF32
 1

	)

74 
	#_XBS5_ILP32_OFFBIG
 1

	)

91 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

92 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

93 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

94 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

95 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

96 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/errno.h

19 #ifde‡
_ERRNO_H


21 #unde‡
EDOM


22 #unde‡
EILSEQ


23 #unde‡
ERANGE


24 
	~<löux/î∫o.h
>

27 
	#ENOTSUP
 
EOPNOTSUPP


	)

30 #i‚de‡
ECANCELED


31 
	#ECANCELED
 125

	)

35 #i‚de‡
EOWNERDEAD


36 
	#EOWNERDEAD
 130

	)

37 
	#ENOTRECOVERABLE
 131

	)

40 #i‚de‡
ERFKILL


41 
	#ERFKILL
 132

	)

44 #i‚de‡
EHWPOISON


45 
	#EHWPOISON
 133

	)

48 #i‚de‡
__ASSEMBLER__


50 *
	$__î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

52 #i‡!
deföed
 
_LIBC
 || deföed 
_LIBC_REENTRANT


54 
	#î∫o
 (*
	`__î∫o_loˇti⁄
 ())

	)

59 #i‡!
deföed
 
_ERRNO_H
 && deföed 
__√ed_Em©h


63 
	#EDOM
 33

	)

64 
	#EILSEQ
 84

	)

65 
	#ERANGE
 34

	)

	@/usr/include/bits/fcntl.h

19 #i‚de‡
_FCNTL_H


23 #ifde‡
__x86_64__


24 
	#__O_LARGEFILE
 0

	)

27 #ifde‡
__x86_64__


29 
	#F_GETLK64
 5

	)

30 
	#F_SETLK64
 6

	)

31 
	#F_SETLKW64
 7

	)

35 
	sÊock


37 
	ml_ty≥
;

38 
	ml_whí˚
;

39 #i‚de‡
__USE_FILE_OFFSET64


40 
__off_t
 
	ml_°¨t
;

41 
__off_t
 
	ml_Àn
;

43 
__off64_t
 
	ml_°¨t
;

44 
__off64_t
 
	ml_Àn
;

46 
__pid_t
 
	ml_pid
;

49 #ifde‡
__USE_LARGEFILE64


50 
	sÊock64


52 
	ml_ty≥
;

53 
	ml_whí˚
;

54 
__off64_t
 
	ml_°¨t
;

55 
__off64_t
 
	ml_Àn
;

56 
__pid_t
 
	ml_pid
;

61 
	~<bôs/f˙é-löux.h
>

	@/usr/include/bits/fcntl2.h

19 #i‚def 
_FCNTL_H


25 #i‚de‡
__USE_FILE_OFFSET64


26 
	$__›í_2
 (c⁄° *
__∑th
, 
__oÊag
Ë
	`__n⁄nuŒ
 ((1));

27 
	`__REDIRECT
 (
__›í_Æüs
, (c⁄° *
__∑th
, 
__oÊag
, ...),

28 
›í
Ë
	`__n⁄nuŒ
 ((1));

30 
	`__REDIRECT
 (
__›í_2
, (c⁄° *
__∑th
, 
__oÊag
),

31 
__›í64_2
Ë
	`__n⁄nuŒ
 ((1));

32 
	`__REDIRECT
 (
__›í_Æüs
, (c⁄° *
__∑th
, 
__oÊag
, ...),

33 
›í64
Ë
	`__n⁄nuŒ
 ((1));

35 
	`__îr‹de˛
 (
__›í_too_m™y_¨gs
,

37 
	`__îr‹de˛
 (
__›í_missög_mode
,

40 
__f‹tify_fun˘i⁄
 

41 
	$›í
 (c⁄° *
__∑th
, 
__oÊag
, ...)

43 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

44 
	`__›í_too_m™y_¨gs
 ();

46 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

48 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

50 
	`__›í_missög_mode
 ();

51  
	`__›í_2
 (
__∑th
, 
__oÊag
);

53  
	`__›í_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

56 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

57  
	`__›í_2
 (
__∑th
, 
__oÊag
);

59  
	`__›í_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

60 
	}
}

63 #ifde‡
__USE_LARGEFILE64


64 
	$__›í64_2
 (c⁄° *
__∑th
, 
__oÊag
Ë
	`__n⁄nuŒ
 ((1));

65 
	`__REDIRECT
 (
__›í64_Æüs
, (c⁄° *
__∑th
, 
__oÊag
,

66 ...), 
›í64
Ë
	`__n⁄nuŒ
 ((1));

67 
	`__îr‹de˛
 (
__›í64_too_m™y_¨gs
,

69 
	`__îr‹de˛
 (
__›í64_missög_mode
,

72 
__f‹tify_fun˘i⁄
 

73 
	$›í64
 (c⁄° *
__∑th
, 
__oÊag
, ...)

75 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

76 
	`__›í64_too_m™y_¨gs
 ();

78 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

80 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

82 
	`__›í64_missög_mode
 ();

83  
	`__›í64_2
 (
__∑th
, 
__oÊag
);

85  
	`__›í64_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

88 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

89  
	`__›í64_2
 (
__∑th
, 
__oÊag
);

91  
	`__›í64_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

92 
	}
}

96 #ifde‡
__USE_ATFILE


97 #i‚de‡
__USE_FILE_OFFSET64


98 
	$__›í©_2
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
)

99 
	`__n⁄nuŒ
 ((2));

100 
	`__REDIRECT
 (
__›í©_Æüs
, (
__fd
, c⁄° *
__∑th
,

101 
__oÊag
, ...), 
›í©
)

102 
	`__n⁄nuŒ
 ((2));

104 
	`__REDIRECT
 (
__›í©_2
, (
__fd
, c⁄° *
__∑th
,

105 
__oÊag
), 
__›í©64_2
)

106 
	`__n⁄nuŒ
 ((2));

107 
	`__REDIRECT
 (
__›í©_Æüs
, (
__fd
, c⁄° *
__∑th
,

108 
__oÊag
, ...), 
›í©64
)

109 
	`__n⁄nuŒ
 ((2));

111 
	`__îr‹de˛
 (
__›í©_too_m™y_¨gs
,

113 
	`__îr‹de˛
 (
__›í©_missög_mode
,

116 
__f‹tify_fun˘i⁄
 

117 
	$›í©
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
, ...)

119 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

120 
	`__›í©_too_m™y_¨gs
 ();

122 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

124 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

126 
	`__›í©_missög_mode
 ();

127  
	`__›í©_2
 (
__fd
, 
__∑th
, 
__oÊag
);

129  
	`__›í©_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

132 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

133  
	`__›í©_2
 (
__fd
, 
__∑th
, 
__oÊag
);

135  
	`__›í©_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

136 
	}
}

139 #ifde‡
__USE_LARGEFILE64


140 
	$__›í©64_2
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
)

141 
	`__n⁄nuŒ
 ((2));

142 
	`__REDIRECT
 (
__›í©64_Æüs
, (
__fd
, c⁄° *
__∑th
,

143 
__oÊag
, ...), 
›í©64
)

144 
	`__n⁄nuŒ
 ((2));

145 
	`__îr‹de˛
 (
__›í©64_too_m™y_¨gs
,

147 
	`__îr‹de˛
 (
__›í©64_missög_mode
,

150 
__f‹tify_fun˘i⁄
 

151 
	$›í©64
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
, ...)

153 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

154 
	`__›í©64_too_m™y_¨gs
 ();

156 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

158 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

160 
	`__›í©64_missög_mode
 ();

161  
	`__›í©64_2
 (
__fd
, 
__∑th
, 
__oÊag
);

163  
	`__›í©64_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

166 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

167  
	`__›í©64_2
 (
__fd
, 
__∑th
, 
__oÊag
);

169  
	`__›í©64_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

170 
	}
}

	@/usr/include/bits/huge_val.h

21 #i‚de‡
_MATH_H


27 #i‡
__GNUC_PREREQ
(3,3)

28 
	#HUGE_VAL
 (
	`__buûtö_huge_vÆ
())

	)

29 #ñi‡
__GNUC_PREREQ
(2,96)

30 
	#HUGE_VAL
 (
__exãnsi⁄__
 0x1.0
p2047
)

	)

31 #ñi‡
deföed
 
__GNUC__


33 
	#HUGE_VAL
 \

34 (
__exãnsi⁄__
 \

35 ((uni⁄ { 
__l
 
	`__©åibuã__
((
	`__mode__
(
__DI__
))); 
__d
; }) \

36 { 
__l
: 0x7ff0000000000000ULL }).
__d
)

	)

40 
	~<ídün.h
>

42 uni⁄ { 
	m__c
[8]; 
	m__d
; } 
	t__huge_vÆ_t
;

44 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


45 
	#__HUGE_VAL_byãs
 { 0x7f, 0xf0, 0, 0, 0, 0, 0, 0 }

	)

47 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


48 
	#__HUGE_VAL_byãs
 { 0, 0, 0, 0, 0, 0, 0xf0, 0x7‡}

	)

51 
__huge_vÆ_t
 
	g__huge_vÆ
 = { 
__HUGE_VAL_byãs
 };

52 
	#HUGE_VAL
 (
__huge_vÆ
.
__d
)

	)

	@/usr/include/bits/huge_valf.h

21 #i‚de‡
_MATH_H


27 #i‡
__GNUC_PREREQ
(3,3)

28 
	#HUGE_VALF
 (
	`__buûtö_huge_vÆf
())

	)

29 #ñi‡
__GNUC_PREREQ
(2,96)

30 
	#HUGE_VALF
 (
__exãnsi⁄__
 0x1.0
p255f
)

	)

31 #ñi‡
deföed
 
__GNUC__


33 
	#HUGE_VALF
 \

34 (
__exãnsi⁄__
 \

35 ((uni⁄ { 
__l
 
	`__©åibuã__
((
	`__mode__
(
__SI__
))); 
__d
; }) \

36 { 
__l
: 0x7f800000UL }).
__d
)

	)

40 uni⁄ { 
	m__c
[4]; 
	m__f
; } 
	t__huge_vÆf_t
;

42 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


43 
	#__HUGE_VALF_byãs
 { 0x7f, 0x80, 0, 0 }

	)

45 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


46 
	#__HUGE_VALF_byãs
 { 0, 0, 0x80, 0x7‡}

	)

49 
__huge_vÆf_t
 
	g__huge_vÆf
 = { 
__HUGE_VALF_byãs
 };

50 
	#HUGE_VALF
 (
__huge_vÆf
.
__f
)

	)

	@/usr/include/bits/huge_vall.h

21 #i‚de‡
_MATH_H


25 #i‡
__GNUC_PREREQ
(3,3)

26 
	#HUGE_VALL
 (
	`__buûtö_huge_vÆl
())

	)

27 #ñi‡
__GNUC_PREREQ
(2,96)

28 
	#HUGE_VALL
 (
__exãnsi⁄__
 0x1.0
p32767L
)

	)

31 
	#__HUGE_VALL_byãs
 { 0, 0, 0, 0, 0, 0, 0, 0x80, 0xff, 0x7f, 0, 0 }

	)

33 
	#__huge_vÆl_t
 uni⁄ { 
__c
[12]; 
__ld
; }

	)

34 #ifde‡
__GNUC__


35 
	#HUGE_VALL
 (
__exãnsi⁄__
 \

36 ((
__huge_vÆl_t
Ë{ 
__c
: 
__HUGE_VALL_byãs
 }).
__ld
)

	)

38 
__huge_vÆl_t
 
	g__huge_vÆl
 = { 
__HUGE_VALL_byãs
 };

39 
	#HUGE_VALL
 (
__huge_vÆl
.
__ld
)

	)

	@/usr/include/bits/in.h

20 #i‚de‡
_NETINET_IN_H


32 #i‡
deföed
 
_UAPI_LINUX_IN6_H
 \

33 || 
deföed
 
	g_UAPI_IPV6_H
 \

34 || 
deföed
 
	g_LINUX_IN6_H
 \

35 || 
deföed
 
	g_IPV6_H


39 
	#__USE_KERNEL_IPV6_DEFS
 1

	)

41 
	#__USE_KERNEL_IPV6_DEFS
 0

	)

47 
	#IP_OPTIONS
 4

	)

48 
	#IP_HDRINCL
 3

	)

49 
	#IP_TOS
 1

	)

50 
	#IP_TTL
 2

	)

51 
	#IP_RECVOPTS
 6

	)

53 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

54 
	#IP_RETOPTS
 7

	)

55 
	#IP_MULTICAST_IF
 32

	)

56 
	#IP_MULTICAST_TTL
 33

	)

57 
	#IP_MULTICAST_LOOP
 34

	)

58 
	#IP_ADD_MEMBERSHIP
 35

	)

59 
	#IP_DROP_MEMBERSHIP
 36

	)

60 
	#IP_UNBLOCK_SOURCE
 37

	)

61 
	#IP_BLOCK_SOURCE
 38

	)

62 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

63 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

64 
	#IP_MSFILTER
 41

	)

65 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


66 
	#MCAST_JOIN_GROUP
 42

	)

67 
	#MCAST_BLOCK_SOURCE
 43

	)

68 
	#MCAST_UNBLOCK_SOURCE
 44

	)

69 
	#MCAST_LEAVE_GROUP
 45

	)

70 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

71 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

72 
	#MCAST_MSFILTER
 48

	)

73 
	#IP_MULTICAST_ALL
 49

	)

74 
	#IP_UNICAST_IF
 50

	)

76 
	#MCAST_EXCLUDE
 0

	)

77 
	#MCAST_INCLUDE
 1

	)

80 
	#IP_ROUTER_ALERT
 5

	)

81 
	#IP_PKTINFO
 8

	)

82 
	#IP_PKTOPTIONS
 9

	)

83 
	#IP_PMTUDISC
 10

	)

84 
	#IP_MTU_DISCOVER
 10

	)

85 
	#IP_RECVERR
 11

	)

86 
	#IP_RECVTTL
 12

	)

87 
	#IP_RECVTOS
 13

	)

88 
	#IP_MTU
 14

	)

89 
	#IP_FREEBIND
 15

	)

90 
	#IP_IPSEC_POLICY
 16

	)

91 
	#IP_XFRM_POLICY
 17

	)

92 
	#IP_PASSSEC
 18

	)

93 
	#IP_TRANSPARENT
 19

	)

94 
	#IP_MULTICAST_ALL
 49

	)

97 
	#IP_ORIGDSTADDR
 20

	)

98 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

100 
	#IP_MINTTL
 21

	)

104 
	#IP_PMTUDISC_DONT
 0

	)

105 
	#IP_PMTUDISC_WANT
 1

	)

106 
	#IP_PMTUDISC_DO
 2

	)

107 
	#IP_PMTUDISC_PROBE
 3

	)

110 
	#SOL_IP
 0

	)

112 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

113 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

114 
	#IP_MAX_MEMBERSHIPS
 20

	)

116 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


120 
	sù_›ts


122 
ö_addr
 
	mù_d°
;

123 
	mù_›ts
[40];

127 
	sù_mªqn


129 
ö_addr
 
	mimr_mu…üddr
;

130 
ö_addr
 
	mimr_addªss
;

131 
	mimr_ifödex
;

135 
	sö_pktöfo


137 
	mùi_ifödex
;

138 
ö_addr
 
	mùi_•ec_d°
;

139 
ö_addr
 
	mùi_addr
;

146 
	#IPV6_ADDRFORM
 1

	)

147 
	#IPV6_2292PKTINFO
 2

	)

148 
	#IPV6_2292HOPOPTS
 3

	)

149 
	#IPV6_2292DSTOPTS
 4

	)

150 
	#IPV6_2292RTHDR
 5

	)

151 
	#IPV6_2292PKTOPTIONS
 6

	)

152 
	#IPV6_CHECKSUM
 7

	)

153 
	#IPV6_2292HOPLIMIT
 8

	)

155 
	#SCM_SRCRT
 
IPV6_RXSRCRT


	)

157 
	#IPV6_NEXTHOP
 9

	)

158 
	#IPV6_AUTHHDR
 10

	)

159 
	#IPV6_UNICAST_HOPS
 16

	)

160 
	#IPV6_MULTICAST_IF
 17

	)

161 
	#IPV6_MULTICAST_HOPS
 18

	)

162 
	#IPV6_MULTICAST_LOOP
 19

	)

163 
	#IPV6_JOIN_GROUP
 20

	)

164 
	#IPV6_LEAVE_GROUP
 21

	)

165 
	#IPV6_ROUTER_ALERT
 22

	)

166 
	#IPV6_MTU_DISCOVER
 23

	)

167 
	#IPV6_MTU
 24

	)

168 
	#IPV6_RECVERR
 25

	)

169 
	#IPV6_V6ONLY
 26

	)

170 
	#IPV6_JOIN_ANYCAST
 27

	)

171 
	#IPV6_LEAVE_ANYCAST
 28

	)

172 
	#IPV6_IPSEC_POLICY
 34

	)

173 
	#IPV6_XFRM_POLICY
 35

	)

175 
	#IPV6_RECVPKTINFO
 49

	)

176 
	#IPV6_PKTINFO
 50

	)

177 
	#IPV6_RECVHOPLIMIT
 51

	)

178 
	#IPV6_HOPLIMIT
 52

	)

179 
	#IPV6_RECVHOPOPTS
 53

	)

180 
	#IPV6_HOPOPTS
 54

	)

181 
	#IPV6_RTHDRDSTOPTS
 55

	)

182 
	#IPV6_RECVRTHDR
 56

	)

183 
	#IPV6_RTHDR
 57

	)

184 
	#IPV6_RECVDSTOPTS
 58

	)

185 
	#IPV6_DSTOPTS
 59

	)

187 
	#IPV6_RECVTCLASS
 66

	)

188 
	#IPV6_TCLASS
 67

	)

191 #i‡!
__USE_KERNEL_IPV6_DEFS


192 
	#IPV6_ADD_MEMBERSHIP
 
IPV6_JOIN_GROUP


	)

193 
	#IPV6_DROP_MEMBERSHIP
 
IPV6_LEAVE_GROUP


	)

195 
	#IPV6_RXHOPOPTS
 
IPV6_HOPOPTS


	)

196 
	#IPV6_RXDSTOPTS
 
IPV6_DSTOPTS


	)

199 
	#IPV6_PMTUDISC_DONT
 0

	)

200 
	#IPV6_PMTUDISC_WANT
 1

	)

201 
	#IPV6_PMTUDISC_DO
 2

	)

202 
	#IPV6_PMTUDISC_PROBE
 3

	)

205 
	#SOL_IPV6
 41

	)

206 
	#SOL_ICMPV6
 58

	)

209 
	#IPV6_RTHDR_LOOSE
 0

	)

210 
	#IPV6_RTHDR_STRICT
 1

	)

212 
	#IPV6_RTHDR_TYPE_0
 0

	)

	@/usr/include/bits/inf.h

19 #i‚de‡
_MATH_H


25 #i‡
__GNUC_PREREQ
(3,3)

26 
	#INFINITY
 (
	`__buûtö_öff
())

	)

28 
	#INFINITY
 
HUGE_VALF


	)

	@/usr/include/bits/ioctl-types.h

19 #i‚de‡
_SYS_IOCTL_H


24 
	~<asm/io˘ls.h
>

27 
	swösize


29 
	mws_row
;

30 
	mws_cﬁ
;

31 
	mws_xpixñ
;

32 
	mws_ypixñ
;

35 
	#NCC
 8

	)

36 
	sãrmio


38 
	mc_iÊag
;

39 
	mc_oÊag
;

40 
	mc_cÊag
;

41 
	mc_lÊag
;

42 
	mc_löe
;

43 
	mc_cc
[
NCC
];

47 
	#TIOCM_LE
 0x001

	)

48 
	#TIOCM_DTR
 0x002

	)

49 
	#TIOCM_RTS
 0x004

	)

50 
	#TIOCM_ST
 0x008

	)

51 
	#TIOCM_SR
 0x010

	)

52 
	#TIOCM_CTS
 0x020

	)

53 
	#TIOCM_CAR
 0x040

	)

54 
	#TIOCM_RNG
 0x080

	)

55 
	#TIOCM_DSR
 0x100

	)

56 
	#TIOCM_CD
 
TIOCM_CAR


	)

57 
	#TIOCM_RI
 
TIOCM_RNG


	)

62 
	#N_TTY
 0

	)

63 
	#N_SLIP
 1

	)

64 
	#N_MOUSE
 2

	)

65 
	#N_PPP
 3

	)

66 
	#N_STRIP
 4

	)

67 
	#N_AX25
 5

	)

68 
	#N_X25
 6

	)

69 
	#N_6PACK
 7

	)

70 
	#N_MASC
 8

	)

71 
	#N_R3964
 9

	)

72 
	#N_PROFIBUS_FDL
 10

	)

73 
	#N_IRDA
 11

	)

74 
	#N_SMSBLOCK
 12

	)

75 
	#N_HDLC
 13

	)

76 
	#N_SYNC_PPP
 14

	)

77 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

18 #i‚de‡
_SYS_IOCTL_H


23 
	~<asm/io˘ls.h
>

26 
	#SIOCADDRT
 0x890B

	)

27 
	#SIOCDELRT
 0x890C

	)

28 
	#SIOCRTMSG
 0x890D

	)

31 
	#SIOCGIFNAME
 0x8910

	)

32 
	#SIOCSIFLINK
 0x8911

	)

33 
	#SIOCGIFCONF
 0x8912

	)

34 
	#SIOCGIFFLAGS
 0x8913

	)

35 
	#SIOCSIFFLAGS
 0x8914

	)

36 
	#SIOCGIFADDR
 0x8915

	)

37 
	#SIOCSIFADDR
 0x8916

	)

38 
	#SIOCGIFDSTADDR
 0x8917

	)

39 
	#SIOCSIFDSTADDR
 0x8918

	)

40 
	#SIOCGIFBRDADDR
 0x8919

	)

41 
	#SIOCSIFBRDADDR
 0x891®

	)

42 
	#SIOCGIFNETMASK
 0x891b

	)

43 
	#SIOCSIFNETMASK
 0x891¯

	)

44 
	#SIOCGIFMETRIC
 0x891d

	)

45 
	#SIOCSIFMETRIC
 0x891ê

	)

46 
	#SIOCGIFMEM
 0x891‡

	)

47 
	#SIOCSIFMEM
 0x8920

	)

48 
	#SIOCGIFMTU
 0x8921

	)

49 
	#SIOCSIFMTU
 0x8922

	)

50 
	#SIOCSIFNAME
 0x8923

	)

51 
	#SIOCSIFHWADDR
 0x8924

	)

52 
	#SIOCGIFENCAP
 0x8925

	)

53 
	#SIOCSIFENCAP
 0x8926

	)

54 
	#SIOCGIFHWADDR
 0x8927

	)

55 
	#SIOCGIFSLAVE
 0x8929

	)

56 
	#SIOCSIFSLAVE
 0x8930

	)

57 
	#SIOCADDMULTI
 0x8931

	)

58 
	#SIOCDELMULTI
 0x8932

	)

59 
	#SIOCGIFINDEX
 0x8933

	)

60 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

61 
	#SIOCSIFPFLAGS
 0x8934

	)

62 
	#SIOCGIFPFLAGS
 0x8935

	)

63 
	#SIOCDIFADDR
 0x8936

	)

64 
	#SIOCSIFHWBROADCAST
 0x8937

	)

65 
	#SIOCGIFCOUNT
 0x8938

	)

67 
	#SIOCGIFBR
 0x8940

	)

68 
	#SIOCSIFBR
 0x8941

	)

70 
	#SIOCGIFTXQLEN
 0x8942

	)

71 
	#SIOCSIFTXQLEN
 0x8943

	)

76 
	#SIOCDARP
 0x8953

	)

77 
	#SIOCGARP
 0x8954

	)

78 
	#SIOCSARP
 0x8955

	)

81 
	#SIOCDRARP
 0x8960

	)

82 
	#SIOCGRARP
 0x8961

	)

83 
	#SIOCSRARP
 0x8962

	)

87 
	#SIOCGIFMAP
 0x8970

	)

88 
	#SIOCSIFMAP
 0x8971

	)

92 
	#SIOCADDDLCI
 0x8980

	)

93 
	#SIOCDELDLCI
 0x8981

	)

102 
	#SIOCDEVPRIVATE
 0x89F0

	)

108 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/math-finite.h

19 #i‚de‡
_MATH_H


24 
__REDIRECT_NTH
 (
acos
, (), 
__acos_föôe
);

25 
__REDIRECT_NTH
 (
acosf
, (), 
__acosf_föôe
);

26 #ifde‡
__MATH_DECLARE_LDOUBLE


27 #ifde‡
__NO_LONG_DOUBLE_MATH


28 
__REDIRECT_NTH
 (
aco¶
, (), 
__acos_föôe
);

30 
__REDIRECT_NTH
 (
aco¶
, (), 
__aco¶_föôe
);

34 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


36 
__REDIRECT_NTH
 (
acosh
, (), 
__acosh_föôe
);

37 
__REDIRECT_NTH
 (
acoshf
, (), 
__acoshf_föôe
);

38 #ifde‡
__MATH_DECLARE_LDOUBLE


39 #ifde‡
__NO_LONG_DOUBLE_MATH


40 
__REDIRECT_NTH
 (
acoshl
, (), 
__acosh_föôe
);

42 
__REDIRECT_NTH
 (
acoshl
, (), 
__acoshl_föôe
);

48 
__REDIRECT_NTH
 (
asö
, (), 
__asö_föôe
);

49 
__REDIRECT_NTH
 (
asöf
, (), 
__asöf_föôe
);

50 #ifde‡
__MATH_DECLARE_LDOUBLE


51 #ifde‡
__NO_LONG_DOUBLE_MATH


52 
__REDIRECT_NTH
 (
asöl
, (), 
__asö_föôe
);

54 
__REDIRECT_NTH
 (
asöl
, (), 
__asöl_föôe
);

59 
__REDIRECT_NTH
 (
©™2
, (, ), 
__©™2_föôe
);

60 
__REDIRECT_NTH
 (
©™2f
, (, ), 
__©™2f_föôe
);

61 #ifde‡
__MATH_DECLARE_LDOUBLE


62 #ifde‡
__NO_LONG_DOUBLE_MATH


63 
__REDIRECT_NTH
 (
©™2l
, (, ),

64 
__©™2_föôe
);

66 
__REDIRECT_NTH
 (
©™2l
, (, ),

67 
__©™2l_föôe
);

71 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


73 
__REDIRECT_NTH
 (
©™h
, (), 
__©™h_föôe
);

74 
__REDIRECT_NTH
 (
©™hf
, (), 
__©™hf_föôe
);

75 #ifde‡
__MATH_DECLARE_LDOUBLE


76 #ifde‡
__NO_LONG_DOUBLE_MATH


77 
__REDIRECT_NTH
 (
©™hl
, (), 
__©™h_föôe
);

79 
__REDIRECT_NTH
 (
©™hl
, (), 
__©™hl_föôe
);

85 
__REDIRECT_NTH
 (
cosh
, (), 
__cosh_föôe
);

86 
__REDIRECT_NTH
 (
coshf
, (), 
__coshf_föôe
);

87 #ifde‡
__MATH_DECLARE_LDOUBLE


88 #ifde‡
__NO_LONG_DOUBLE_MATH


89 
__REDIRECT_NTH
 (
coshl
, (), 
__cosh_föôe
);

91 
__REDIRECT_NTH
 (
coshl
, (), 
__coshl_föôe
);

96 
__REDIRECT_NTH
 (
exp
, (), 
__exp_föôe
);

97 
__REDIRECT_NTH
 (
expf
, (), 
__expf_föôe
);

98 #ifde‡
__MATH_DECLARE_LDOUBLE


99 #ifde‡
__NO_LONG_DOUBLE_MATH


100 
__REDIRECT_NTH
 (
ex∂
, (), 
__exp_föôe
);

102 
__REDIRECT_NTH
 (
ex∂
, (), 
__ex∂_föôe
);

106 #ifde‡
__USE_GNU


108 
__REDIRECT_NTH
 (
exp10
, (), 
__exp10_föôe
);

109 
__REDIRECT_NTH
 (
exp10f
, (), 
__exp10f_föôe
);

110 #ifde‡
__MATH_DECLARE_LDOUBLE


111 #ifde‡
__NO_LONG_DOUBLE_MATH


112 
__REDIRECT_NTH
 (
exp10l
, (), 
__exp10_föôe
);

114 
__REDIRECT_NTH
 (
exp10l
, (), 
__exp10l_föôe
);

119 
__REDIRECT_NTH
 (
pow10
, (), 
__exp10_föôe
);

120 
__REDIRECT_NTH
 (
pow10f
, (), 
__exp10f_föôe
);

121 #ifde‡
__MATH_DECLARE_LDOUBLE


122 #ifde‡
__NO_LONG_DOUBLE_MATH


123 
__REDIRECT_NTH
 (
pow10l
, (), 
__exp10_föôe
);

125 
__REDIRECT_NTH
 (
pow10l
, (), 
__exp10l_föôe
);

130 #ifde‡
__USE_ISOC99


132 
__REDIRECT_NTH
 (
exp2
, (), 
__exp2_föôe
);

133 
__REDIRECT_NTH
 (
exp2f
, (), 
__exp2f_föôe
);

134 #ifde‡
__MATH_DECLARE_LDOUBLE


135 #ifde‡
__NO_LONG_DOUBLE_MATH


136 
__REDIRECT_NTH
 (
exp2l
, (), 
__exp2_föôe
);

138 
__REDIRECT_NTH
 (
exp2l
, (), 
__exp2l_föôe
);

144 
__REDIRECT_NTH
 (
fmod
, (, ), 
__fmod_föôe
);

145 
__REDIRECT_NTH
 (
fmodf
, (, ), 
__fmodf_föôe
);

146 #ifde‡
__MATH_DECLARE_LDOUBLE


147 #ifde‡
__NO_LONG_DOUBLE_MATH


148 
__REDIRECT_NTH
 (
fmodl
, (, ),

149 
__fmod_föôe
);

151 
__REDIRECT_NTH
 (
fmodl
, (, ),

152 
__fmodl_föôe
);

156 #ifde‡
__USE_ISOC99


158 
__REDIRECT_NTH
 (
hypŸ
, (, ), 
__hypŸ_föôe
);

159 
__REDIRECT_NTH
 (
hypŸf
, (, ), 
__hypŸf_föôe
);

160 #ifde‡
__MATH_DECLARE_LDOUBLE


161 #ifde‡
__NO_LONG_DOUBLE_MATH


162 
__REDIRECT_NTH
 (
hypŸl
, (, ),

163 
__hypŸ_föôe
);

165 
__REDIRECT_NTH
 (
hypŸl
, (, ),

166 
__hypŸl_föôe
);

171 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


173 
__REDIRECT_NTH
 (
j0
, (), 
__j0_föôe
);

174 
__REDIRECT_NTH
 (
j0f
, (), 
__j0f_föôe
);

175 #ifde‡
__MATH_DECLARE_LDOUBLE


176 #ifde‡
__NO_LONG_DOUBLE_MATH


177 
__REDIRECT_NTH
 (
j0l
, (), 
__j0_föôe
);

179 
__REDIRECT_NTH
 (
j0l
, (), 
__j0l_föôe
);

184 
__REDIRECT_NTH
 (
y0
, (), 
__y0_föôe
);

185 
__REDIRECT_NTH
 (
y0f
, (), 
__y0f_föôe
);

186 #ifde‡
__MATH_DECLARE_LDOUBLE


187 #ifde‡
__NO_LONG_DOUBLE_MATH


188 
__REDIRECT_NTH
 (
y0l
, (), 
__y0_föôe
);

190 
__REDIRECT_NTH
 (
y0l
, (), 
__y0l_föôe
);

195 
__REDIRECT_NTH
 (
j1
, (), 
__j1_föôe
);

196 
__REDIRECT_NTH
 (
j1f
, (), 
__j1f_föôe
);

197 #ifde‡
__MATH_DECLARE_LDOUBLE


198 #ifde‡
__NO_LONG_DOUBLE_MATH


199 
__REDIRECT_NTH
 (
j1l
, (), 
__j1_föôe
);

201 
__REDIRECT_NTH
 (
j1l
, (), 
__j1l_föôe
);

206 
__REDIRECT_NTH
 (
y1
, (), 
__y1_föôe
);

207 
__REDIRECT_NTH
 (
y1f
, (), 
__y1f_föôe
);

208 #ifde‡
__MATH_DECLARE_LDOUBLE


209 #ifde‡
__NO_LONG_DOUBLE_MATH


210 
__REDIRECT_NTH
 (
y1l
, (), 
__y1_föôe
);

212 
__REDIRECT_NTH
 (
y1l
, (), 
__y1l_föôe
);

217 
__REDIRECT_NTH
 (
jn
, (, ), 
__jn_föôe
);

218 
__REDIRECT_NTH
 (
jnf
, (, ), 
__jnf_föôe
);

219 #ifde‡
__MATH_DECLARE_LDOUBLE


220 #ifde‡
__NO_LONG_DOUBLE_MATH


221 
__REDIRECT_NTH
 (
j∆
, (, ), 
__jn_föôe
);

223 
__REDIRECT_NTH
 (
j∆
, (, ), 
__j∆_föôe
);

228 
__REDIRECT_NTH
 (
yn
, (, ), 
__yn_föôe
);

229 
__REDIRECT_NTH
 (
ynf
, (, ), 
__ynf_föôe
);

230 #ifde‡
__MATH_DECLARE_LDOUBLE


231 #ifde‡
__NO_LONG_DOUBLE_MATH


232 
__REDIRECT_NTH
 (
y∆
, (, ), 
__yn_föôe
);

234 
__REDIRECT_NTH
 (
y∆
, (, ), 
__y∆_föôe
);

239 #ifde‡
__USE_MISC


241 
__REDIRECT_NTH
 (
lgamma_r
, (, *), 
__lgamma_r_föôe
);

242 
__REDIRECT_NTH
 (
lgammaf_r
, (, *), 
__lgammaf_r_föôe
);

243 #ifde‡
__MATH_DECLARE_LDOUBLE


244 #ifde‡
__NO_LONG_DOUBLE_MATH


245 
__REDIRECT_NTH
 (
lgammÆ_r
, (, *),

246 
__lgamma_r_föôe
);

248 
__REDIRECT_NTH
 (
lgammÆ_r
, (, *),

249 
__lgammÆ_r_föôe
);

254 #i‡((
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99
) \

255 && 
deföed
 
	g__exã∫_Æways_ölöe
)

257 
__exã∫_Æways_ölöe
 
__NTH
 (
	$lgamma
 (
__d
))

259 #ifde‡
__USE_ISOC99


260 
__loˇl_signgam
 = 0;

261  
	`lgamma_r
 (
__d
, &
__loˇl_signgam
);

263  
	`lgamma_r
 (
__d
, &
signgam
);

265 
	}
}

266 
__exã∫_Æways_ölöe
 
__NTH
 (
	$lgammaf
 (
__d
))

268 #ifde‡
__USE_ISOC99


269 
__loˇl_signgam
 = 0;

270  
	`lgammaf_r
 (
__d
, &
__loˇl_signgam
);

272  
	`lgammaf_r
 (
__d
, &
signgam
);

274 
	}
}

275 #ifde‡
__MATH_DECLARE_LDOUBLE


276 
__exã∫_Æways_ölöe
 
__NTH
 (
	$lgammÆ
 (
__d
))

278 #ifde‡
__USE_ISOC99


279 
__loˇl_signgam
 = 0;

280  
	`lgammÆ_r
 (
__d
, &
__loˇl_signgam
);

282  
	`lgammÆ_r
 (
__d
, &
signgam
);

284 
	}
}

288 #i‡((
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
) \

289 && 
deföed
 
	g__exã∫_Æways_ölöe
)

291 
__exã∫_Æways_ölöe
 
__NTH
 (
	$gamma
 (
__d
))

293 #ifde‡
__USE_ISOC99


294 
__loˇl_signgam
 = 0;

295  
	`lgamma_r
 (
__d
, &
__loˇl_signgam
);

297  
	`lgamma_r
 (
__d
, &
signgam
);

299 
	}
}

300 
__exã∫_Æways_ölöe
 
__NTH
 (
	$gammaf
 (
__d
))

302 #ifde‡
__USE_ISOC99


303 
__loˇl_signgam
 = 0;

304  
	`lgammaf_r
 (
__d
, &
__loˇl_signgam
);

306  
	`lgammaf_r
 (
__d
, &
signgam
);

308 
	}
}

309 #ifde‡
__MATH_DECLARE_LDOUBLE


310 
__exã∫_Æways_ölöe
 
__NTH
 (
	$gammÆ
 (
__d
))

312 #ifde‡
__USE_ISOC99


313 
__loˇl_signgam
 = 0;

314  
	`lgammÆ_r
 (
__d
, &
__loˇl_signgam
);

316  
	`lgammÆ_r
 (
__d
, &
signgam
);

318 
	}
}

323 
__REDIRECT_NTH
 (
log
, (), 
__log_föôe
);

324 
__REDIRECT_NTH
 (
logf
, (), 
__logf_föôe
);

325 #ifde‡
__MATH_DECLARE_LDOUBLE


326 #ifde‡
__NO_LONG_DOUBLE_MATH


327 
__REDIRECT_NTH
 (
logl
, (), 
__log_föôe
);

329 
__REDIRECT_NTH
 (
logl
, (), 
__logl_föôe
);

334 
__REDIRECT_NTH
 (
log10
, (), 
__log10_föôe
);

335 
__REDIRECT_NTH
 (
log10f
, (), 
__log10f_föôe
);

336 #ifde‡
__MATH_DECLARE_LDOUBLE


337 #ifde‡
__NO_LONG_DOUBLE_MATH


338 
__REDIRECT_NTH
 (
log10l
, (), 
__log10_föôe
);

340 
__REDIRECT_NTH
 (
log10l
, (), 
__log10l_föôe
);

344 #ifde‡
__USE_ISOC99


346 
__REDIRECT_NTH
 (
log2
, (), 
__log2_föôe
);

347 
__REDIRECT_NTH
 (
log2f
, (), 
__log2f_föôe
);

348 #ifde‡
__MATH_DECLARE_LDOUBLE


349 #ifde‡
__NO_LONG_DOUBLE_MATH


350 
__REDIRECT_NTH
 (
log2l
, (), 
__log2_föôe
);

352 
__REDIRECT_NTH
 (
log2l
, (), 
__log2l_föôe
);

358 
__REDIRECT_NTH
 (
ldexp
, (, ), 
sˇlbn
);

359 
__REDIRECT_NTH
 (
ldexpf
, (, ), 
sˇlbnf
);

360 #ifde‡
__MATH_DECLARE_LDOUBLE


361 
__REDIRECT_NTH
 (
ldex∂
, (, ), 
sˇlb∆
);

365 
__REDIRECT_NTH
 (
pow
, (, ), 
__pow_föôe
);

366 
__REDIRECT_NTH
 (
powf
, (, ), 
__powf_föôe
);

367 #ifde‡
__MATH_DECLARE_LDOUBLE


368 #ifde‡
__NO_LONG_DOUBLE_MATH


369 
__REDIRECT_NTH
 (
powl
, (, ),

370 
__pow_föôe
);

372 
__REDIRECT_NTH
 (
powl
, (, ),

373 
__powl_föôe
);

378 
__REDIRECT_NTH
 (
ªmaödî
, (, ), 
__ªmaödî_föôe
);

379 
__REDIRECT_NTH
 (
ªmaödîf
, (, ), 
__ªmaödîf_föôe
);

380 #ifde‡
__MATH_DECLARE_LDOUBLE


381 #ifde‡
__NO_LONG_DOUBLE_MATH


382 
__REDIRECT_NTH
 (
ªmaödîl
, (, ),

383 
__ªmaödî_föôe
);

385 
__REDIRECT_NTH
 (
ªmaödîl
, (, ),

386 
__ªmaödîl_föôe
);

390 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


392 
__REDIRECT_NTH
 (
sˇlb
, (, ), 
__sˇlb_föôe
);

393 
__REDIRECT_NTH
 (
sˇlbf
, (, ), 
__sˇlbf_föôe
);

394 #ifde‡
__MATH_DECLARE_LDOUBLE


395 #ifde‡
__NO_LONG_DOUBLE_MATH


396 
__REDIRECT_NTH
 (
sˇlbl
, (, ),

397 
__sˇlb_föôe
);

399 
__REDIRECT_NTH
 (
sˇlbl
, (, ),

400 
__sˇlbl_föôe
);

406 
__REDIRECT_NTH
 (
söh
, (), 
__söh_föôe
);

407 
__REDIRECT_NTH
 (
söhf
, (), 
__söhf_föôe
);

408 #ifde‡
__MATH_DECLARE_LDOUBLE


409 #ifde‡
__NO_LONG_DOUBLE_MATH


410 
__REDIRECT_NTH
 (
söhl
, (), 
__söh_föôe
);

412 
__REDIRECT_NTH
 (
söhl
, (), 
__söhl_föôe
);

417 
__REDIRECT_NTH
 (
sqπ
, (), 
__sqπ_föôe
);

418 
__REDIRECT_NTH
 (
sqπf
, (), 
__sqπf_föôe
);

419 #ifde‡
__MATH_DECLARE_LDOUBLE


420 #ifde‡
__NO_LONG_DOUBLE_MATH


421 
__REDIRECT_NTH
 (
sqπl
, (), 
__sqπ_föôe
);

423 
__REDIRECT_NTH
 (
sqπl
, (), 
__sqπl_föôe
);

427 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__exã∫_Æways_ölöe


429 
__gamma_r_föôe
 (, *);

430 
__exã∫_Æways_ölöe
 
__NTH
 (
	$tgamma
 (
__d
))

432 
__loˇl_signgam
 = 0;

433 
__ªs
 = 
	`__gamma_r_föôe
 (
__d
, &
__loˇl_signgam
);

434  
__loˇl_signgam
 < 0 ? -
__ªs
 : __res;

435 
	}
}

436 
__gammaf_r_föôe
 (, *);

437 
__exã∫_Æways_ölöe
 
__NTH
 (
	$tgammaf
 (
__d
))

439 
__loˇl_signgam
 = 0;

440 
__ªs
 = 
	`__gammaf_r_föôe
 (
__d
, &
__loˇl_signgam
);

441  
__loˇl_signgam
 < 0 ? -
__ªs
 : __res;

442 
	}
}

443 #ifde‡
__MATH_DECLARE_LDOUBLE


444 
__gammÆ_r_föôe
 (, *);

445 
__exã∫_Æways_ölöe
 
__NTH
 (
	$tgammÆ
 (
__d
))

447 
__loˇl_signgam
 = 0;

448 #ifde‡
__NO_LONG_DOUBLE_MATH


449 
__ªs
 = 
	`__gamma_r_föôe
 (
__d
, &
__loˇl_signgam
);

451 
__ªs
 = 
	`__gammÆ_r_föôe
 (
__d
, &
__loˇl_signgam
);

453  
__loˇl_signgam
 < 0 ? -
__ªs
 : __res;

454 
	}
}

	@/usr/include/bits/mathcalls.h

45 #i‚de‡
_MATH_H


52 
_MdoubÀ_BEGIN_NAMESPACE


54 
__MATHCALL
 (
acos
,, (
_MdoubÀ_
 
__x
));

56 
__MATHCALL
 (
asö
,, (
_MdoubÀ_
 
__x
));

58 
__MATHCALL
 (
©™
,, (
_MdoubÀ_
 
__x
));

60 
__MATHCALL
 (
©™2
,, (
_MdoubÀ_
 
__y
, _MdoubÀ_ 
__x
));

63 
__MATHCALL
 (
cos
,, (
_MdoubÀ_
 
__x
));

65 
__MATHCALL
 (
sö
,, (
_MdoubÀ_
 
__x
));

67 
__MATHCALL
 (
èn
,, (
_MdoubÀ_
 
__x
));

72 
__MATHCALL
 (
cosh
,, (
_MdoubÀ_
 
__x
));

74 
__MATHCALL
 (
söh
,, (
_MdoubÀ_
 
__x
));

76 
__MATHCALL
 (
ènh
,, (
_MdoubÀ_
 
__x
));

77 
	g_MdoubÀ_END_NAMESPACE


79 #ifde‡
__USE_GNU


81 
__MATHDECL
 (,
söcos
,,

82 (
_MdoubÀ_
 
__x
, _MdoubÀ_ *
__söx
, _MdoubÀ_ *
__cosx
));

85 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


86 
__BEGIN_NAMESPACE_C99


88 
__MATHCALL
 (
acosh
,, (
_MdoubÀ_
 
__x
));

90 
__MATHCALL
 (
asöh
,, (
_MdoubÀ_
 
__x
));

92 
__MATHCALL
 (
©™h
,, (
_MdoubÀ_
 
__x
));

93 
	g__END_NAMESPACE_C99


98 
_MdoubÀ_BEGIN_NAMESPACE


100 
__MATHCALL
 (
exp
,, (
_MdoubÀ_
 
__x
));

103 
__MATHCALL
 (
‰exp
,, (
_MdoubÀ_
 
__x
, *
__exp⁄ít
));

106 
__MATHCALL
 (
ldexp
,, (
_MdoubÀ_
 
__x
, 
__exp⁄ít
));

109 
__MATHCALL
 (
log
,, (
_MdoubÀ_
 
__x
));

112 
__MATHCALL
 (
log10
,, (
_MdoubÀ_
 
__x
));

115 
__MATHCALL
 (
modf
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ *
__ùå
))

116 
__©åibuã__
 ((
__n⁄nuŒ__
 (2)));

117 
	g_MdoubÀ_END_NAMESPACE


119 #ifde‡
__USE_GNU


121 
__MATHCALL
 (
exp10
,, (
_MdoubÀ_
 
__x
));

123 
__MATHCALL
 (
pow10
,, (
_MdoubÀ_
 
__x
));

126 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


127 
__BEGIN_NAMESPACE_C99


129 
__MATHCALL
 (
expm1
,, (
_MdoubÀ_
 
__x
));

132 
__MATHCALL
 (
log1p
,, (
_MdoubÀ_
 
__x
));

135 
__MATHCALL
 (
logb
,, (
_MdoubÀ_
 
__x
));

136 
	g__END_NAMESPACE_C99


139 #ifde‡
__USE_ISOC99


140 
__BEGIN_NAMESPACE_C99


142 
__MATHCALL
 (
exp2
,, (
_MdoubÀ_
 
__x
));

145 
__MATHCALL
 (
log2
,, (
_MdoubÀ_
 
__x
));

146 
	g__END_NAMESPACE_C99


152 
_MdoubÀ_BEGIN_NAMESPACE


154 
__MATHCALL
 (
pow
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

157 
__MATHCALL
 (
sqπ
,, (
_MdoubÀ_
 
__x
));

158 
	g_MdoubÀ_END_NAMESPACE


160 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99


161 
__BEGIN_NAMESPACE_C99


163 
__MATHCALL
 (
hypŸ
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

164 
	g__END_NAMESPACE_C99


167 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


168 
__BEGIN_NAMESPACE_C99


170 
__MATHCALL
 (
cbπ
,, (
_MdoubÀ_
 
__x
));

171 
	g__END_NAMESPACE_C99


177 
_MdoubÀ_BEGIN_NAMESPACE


179 
__MATHCALLX
 (
˚û
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

182 
__MATHCALLX
 (
Ábs
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

185 
__MATHCALLX
 (
Êo‹
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

188 
__MATHCALL
 (
fmod
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

193 
__MATHDECL_1
 (,
__isöf
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

196 
__MATHDECL_1
 (,
__föôe
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

197 
	g_MdoubÀ_END_NAMESPACE


199 #ifde‡
__USE_MISC


202 
__MATHDECL_1
 (,
isöf
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

205 
__MATHDECL_1
 (,
föôe
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

208 
__MATHCALL
 (
dªm
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

212 
__MATHCALL
 (
signifiˇnd
,, (
_MdoubÀ_
 
__x
));

215 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


216 
__BEGIN_NAMESPACE_C99


218 
__MATHCALLX
 (
c›ysign
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

219 
	g__END_NAMESPACE_C99


222 #ifde‡
__USE_ISOC99


223 
__BEGIN_NAMESPACE_C99


225 
__MATHCALLX
 (
«n
,, (c⁄° *
__ègb
), (
__c⁄°__
));

226 
	g__END_NAMESPACE_C99


231 
__MATHDECL_1
 (,
__i¢™
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

233 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


235 
__MATHDECL_1
 (,
i¢™
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

238 
__MATHCALL
 (
j0
,, (
_MdoubÀ_
));

239 
__MATHCALL
 (
j1
,, (
_MdoubÀ_
));

240 
__MATHCALL
 (
jn
,, (, 
_MdoubÀ_
));

241 
__MATHCALL
 (
y0
,, (
_MdoubÀ_
));

242 
__MATHCALL
 (
y1
,, (
_MdoubÀ_
));

243 
__MATHCALL
 (
yn
,, (, 
_MdoubÀ_
));

247 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99


248 
__BEGIN_NAMESPACE_C99


250 
__MATHCALL
 (
îf
,, (
_MdoubÀ_
));

251 
__MATHCALL
 (
îfc
,, (
_MdoubÀ_
));

252 
__MATHCALL
 (
lgamma
,, (
_MdoubÀ_
));

253 
	g__END_NAMESPACE_C99


256 #ifde‡
__USE_ISOC99


257 
__BEGIN_NAMESPACE_C99


259 
__MATHCALL
 (
tgamma
,, (
_MdoubÀ_
));

260 
	g__END_NAMESPACE_C99


263 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


265 
__MATHCALL
 (
gamma
,, (
_MdoubÀ_
));

268 #ifde‡
__USE_MISC


272 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubÀ_
, *
__signgamp
));

276 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


277 
__BEGIN_NAMESPACE_C99


280 
__MATHCALL
 (
röt
,, (
_MdoubÀ_
 
__x
));

283 
__MATHCALLX
 (
√xè·î
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

284 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__LDBL_COMPAT


285 
__MATHCALLX
 (
√xâow¨d
,, (
_MdoubÀ_
 
__x
, 
__y
), (
__c⁄°__
));

289 
__MATHCALL
 (
ªmaödî
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

291 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


293 
__MATHCALL
 (
sˇlbn
,, (
_MdoubÀ_
 
__x
, 
__n
));

297 
__MATHDECL
 (,
ûogb
,, (
_MdoubÀ_
 
__x
));

300 #ifde‡
__USE_ISOC99


302 
__MATHCALL
 (
sˇlb 
,, (
_MdoubÀ_
 
__x
, 
__n
));

306 
__MATHCALL
 (
√¨byöt
,, (
_MdoubÀ_
 
__x
));

310 
__MATHCALLX
 (
round
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

314 
__MATHCALLX
 (
åunc
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

319 
__MATHCALL
 (
ªmquo
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
, *
__quo
));

326 
__MATHDECL
 (,
Ãöt
,, (
_MdoubÀ_
 
__x
));

327 
__MATHDECL
 (,
Œröt
,, (
_MdoubÀ_
 
__x
));

331 
__MATHDECL
 (,
Ãound
,, (
_MdoubÀ_
 
__x
));

332 
__MATHDECL
 (,
Œround
,, (
_MdoubÀ_
 
__x
));

336 
__MATHCALL
 (
fdim
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

339 
__MATHCALLX
 (
fmax
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

342 
__MATHCALLX
 (
fmö
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

346 
__MATHDECL_1
 (, 
__Â˛assify
,, (
_MdoubÀ_
 
__vÆue
))

347 
__©åibuã__
 ((
__c⁄°__
));

350 
__MATHDECL_1
 (, 
__signbô
,, (
_MdoubÀ_
 
__vÆue
))

351 
__©åibuã__
 ((
__c⁄°__
));

355 
__MATHCALL
 (
fma
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
, _MdoubÀ_ 
__z
));

358 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


359 
	g__END_NAMESPACE_C99


362 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


364 
__MATHCALL
 (
sˇlb
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__n
));

	@/usr/include/bits/mathdef.h

18 #i‡!
deföed
 
_MATH_H
 && !deföed 
_COMPLEX_H


22 #i‡
deföed
 
__USE_ISOC99
 && deföed 
_MATH_H
 && !deföed 
_MATH_H_MATHDEF


23 
	#_MATH_H_MATHDEF
 1

	)

25 #i‡
deföed
 
__x86_64__
 || (deföed 
__FLT_EVAL_METHOD__
 && __FLT_EVAL_METHOD__ == 0)

28 
	tÊﬂt_t
;

29 
	tdoubÀ_t
;

35 
	tÊﬂt_t
;

37 
	tdoubÀ_t
;

42 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

43 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

47 #ifde‡
__FP_FAST_FMA


48 
	#FP_FAST_FMA
 1

	)

51 #ifde‡
__FP_FAST_FMAF


52 
	#FP_FAST_FMAF
 1

	)

55 #ifde‡
__FP_FAST_FMAL


56 
	#FP_FAST_FMAL
 1

	)

	@/usr/include/bits/mathinline.h

19 #i‚de‡
_MATH_H


23 #i‚de‡
__exã∫_Æways_ölöe


24 
	#__MATH_INLINE
 
__ölöe


	)

26 
	#__MATH_INLINE
 
__exã∫_Æways_ölöe


	)

30 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__
 && __GNUC__ >= 2

32 #i‡!
__GNUC_PREREQ
 (2,97)

37 #unde‡
isgª©î


38 #unde‡
isgª©îequÆ


39 #unde‡
i¶ess


40 #unde‡
i¶es£quÆ


41 #unde‡
i¶essgª©î


42 #unde‡
isun‹dîed


43 #ifde‡
__i686__


46 
	#isgª©î
(
x
, 
y
) \

47 ({ 
__ªsu…
; \

48 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

49 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

50 
__ªsu…
; })

	)

51 
	#isgª©îequÆ
(
x
, 
y
) \

52 ({ 
__ªsu…
; \

53 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

54 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

55 
__ªsu…
; })

	)

57 
	#i¶ess
(
x
, 
y
) \

58 ({ 
__ªsu…
; \

59 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

60 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st"); \

61 
__ªsu…
; })

	)

63 
	#i¶es£quÆ
(
x
, 
y
) \

64 ({ 
__ªsu…
; \

65 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

66 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st"); \

67 
__ªsu…
; })

	)

69 
	#i¶essgª©î
(
x
, 
y
) \

70 ({ 
__ªsu…
; \

71 
	`__asm__
 ("fucomip %%st(1), %%st; setne %%al" \

72 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

73 
__ªsu…
; })

	)

75 
	#isun‹dîed
(
x
, 
y
) \

76 ({ 
__ªsu…
; \

77 
	`__asm__
 ("fucomip %%st(1), %%st; setp %%al" \

78 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

79 
__ªsu…
; })

	)

82 
	#isgª©î
(
x
, 
y
) \

83 ({ 
__ªsu…
; \

84 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x45, %%ah; setz %%al" \

85 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

86 
__ªsu…
; })

	)

88 
	#isgª©îequÆ
(
x
, 
y
) \

89 ({ 
__ªsu…
; \

90 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x05, %%ah; setz %%al" \

91 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

92 
__ªsu…
; })

	)

94 
	#i¶ess
(
x
, 
y
) \

95 ({ 
__ªsu…
; \

96 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x45, %%ah; setz %%al" \

97 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

98 
__ªsu…
; })

	)

100 
	#i¶es£quÆ
(
x
, 
y
) \

101 ({ 
__ªsu…
; \

102 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x05, %%ah; setz %%al" \

103 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

104 
__ªsu…
; })

	)

106 
	#i¶essgª©î
(
x
, 
y
) \

107 ({ 
__ªsu…
; \

108 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x44, %%ah; setz %%al" \

109 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

110 
__ªsu…
; })

	)

112 
	#isun‹dîed
(
x
, 
y
) \

113 ({ 
__ªsu…
; \

114 
	`__asm__
 ("fucompp; fnstsw; sahf; setp %%al" \

115 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

116 
__ªsu…
; })

	)

122 #i‡
__GNUC_PREREQ
 (2, 8)

123 
__BEGIN_NAMESPACE_C99


126 
__MATH_INLINE
 

127 
__NTH
 (
	$__signbôf
 (
__x
))

129 #ifde‡
__SSE2_MATH__


130 
__m
;

131 
	`__asm
 ("pmovmskb %1, %0" : "Ù" (
__m
Ë: "x" (
__x
));

132  (
__m
 & 0x8) != 0;

134 
__exãnsi⁄__
 uni⁄ { 
__f
; 
__i
; } 
__u
 = { __f: 
__x
 };

135  
__u
.
__i
 < 0;

137 
	}
}

138 
__MATH_INLINE
 

139 
__NTH
 (
	$__signbô
 (
__x
))

141 #ifde‡
__SSE2_MATH__


142 
__m
;

143 
	`__asm
 ("pmovmskb %1, %0" : "Ù" (
__m
Ë: "x" (
__x
));

144  (
__m
 & 0x80) != 0;

146 
__exãnsi⁄__
 uni⁄ { 
__d
; 
__i
[2]; } 
__u
 = { __d: 
__x
 };

147  
__u
.
__i
[1] < 0;

149 
	}
}

150 
__MATH_INLINE
 

151 
__NTH
 (
	$__signbôl
 (
__x
))

153 
__exãnsi⁄__
 uni⁄ { 
__l
; 
__i
[3]; } 
__u
 = { __l: 
__x
 };

154  (
__u
.
__i
[2] & 0x8000) != 0;

155 
	}
}

157 
	g__END_NAMESPACE_C99


164 #i‡
__GNUC_PREREQ
 (2, 8)

165 #i‡!
__GNUC_PREREQ
 (3, 4Ë&& !
deföed
 
__NO_MATH_INLINES
 \

166 && 
deföed
 
	g__OPTIMIZE__


170 #ifde‡
__USE_ISOC99


171 
	g__BEGIN_NAMESPACE_C99


174 #ifde‡
__SSE_MATH__


175 
__MATH_INLINE
 

176 
__NTH
 (
	$Ãötf
 (
__x
))

178 
__ªs
;

183 
__asm
 
	`__vﬁ©ûe__
 ("cvtss2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

184  
__ªs
;

185 
	}
}

187 #ifde‡
__SSE2_MATH__


188 
__MATH_INLINE
 

189 
__NTH
 (
	$Ãöt
 (
__x
))

191 
__ªs
;

196 
__asm
 
	`__vﬁ©ûe__
 ("cvtsd2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

197  
__ªs
;

198 
	}
}

200 #ifde‡
__x86_64__


201 
__MATH_INLINE
 

202 
__NTH
 (
	$Œrötf
 (
__x
))

204 
__ªs
;

209 
__asm
 
	`__vﬁ©ûe__
 ("cvtss2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

210  
__ªs
;

211 
	}
}

212 
__MATH_INLINE
 

213 
__NTH
 (
	$Œröt
 (
__x
))

215 
__ªs
;

220 
__asm
 
	`__vﬁ©ûe__
 ("cvtsd2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

221  
__ªs
;

222 
	}
}

225 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0 \

226 && 
deföed
 
__SSE2_MATH__


228 
__MATH_INLINE
 

229 
__NTH
 (
	$fmaxf
 (
__x
, 
__y
))

231 #ifde‡
__AVX__


232 
__ªs
;

233 
	`__asm
 ("vmaxs†%2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

234  
__ªs
;

236 
	`__asm
 ("maxs†%1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

237  
__x
;

239 
	}
}

240 
__MATH_INLINE
 

241 
__NTH
 (
	$fmax
 (
__x
, 
__y
))

243 #ifde‡
__AVX__


244 
__ªs
;

245 
	`__asm
 ("vmaxsd %2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

246  
__ªs
;

248 
	`__asm
 ("maxsd %1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

249  
__x
;

251 
	}
}

254 
__MATH_INLINE
 

255 
__NTH
 (
	$fmöf
 (
__x
, 
__y
))

257 #ifde‡
__AVX__


258 
__ªs
;

259 
	`__asm
 ("vmös†%2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

260  
__ªs
;

262 
	`__asm
 ("mös†%1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

263  
__x
;

265 
	}
}

266 
__MATH_INLINE
 

267 
__NTH
 (
	$fmö
 (
__x
, 
__y
))

269 #ifde‡
__AVX__


270 
__ªs
;

271 
	`__asm
 ("vmösd %2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

272  
__ªs
;

274 
	`__asm
 ("mösd %1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

275  
__x
;

277 
	}
}

280 
	g__END_NAMESPACE_C99


283 #i‡
deföed
 
__SSE4_1__
 && deföed 
__SSE2_MATH__


284 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


285 
__BEGIN_NAMESPACE_C99


288 
__MATH_INLINE
 

289 
__NTH
 (
	$röt
 (
__x
))

291 
__ªs
;

296 
__asm
 
	`__vﬁ©ûe__
 ("roundsd $4, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

297  
__ªs
;

298 
	}
}

299 
__MATH_INLINE
 

300 
__NTH
 (
	$rötf
 (
__x
))

302 
__ªs
;

307 
__asm
 
	`__vﬁ©ûe__
 ("rounds†$4, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

308  
__ªs
;

309 
	}
}

311 #ifde‡
__USE_ISOC99


313 
__MATH_INLINE
 

314 
__NTH
 (
	$√¨byöt
 (
__x
))

316 
__ªs
;

321 
__asm
 
	`__vﬁ©ûe__
 ("roundsd $0xc, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

322  
__ªs
;

323 
	}
}

324 
__MATH_INLINE
 

325 
__NTH
 (
	$√¨byötf
 (
__x
))

327 
__ªs
;

332 
__asm
 
	`__vﬁ©ûe__
 ("rounds†$0xc, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

333  
__ªs
;

334 
	}
}

337 
	g__END_NAMESPACE_C99


340 
__BEGIN_NAMESPACE_STD


342 
__MATH_INLINE
 

343 
__NTH
 (
	$˚û
 (
__x
))

345 
__ªs
;

346 
	`__asm
 ("roundsd $2, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

347  
__ªs
;

348 
	}
}

349 
__END_NAMESPACE_STD


351 
__BEGIN_NAMESPACE_C99


352 
__MATH_INLINE
 

353 
__NTH
 (
	$˚ûf
 (
__x
))

355 
__ªs
;

356 
	`__asm
 ("rounds†$2, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

357  
__ªs
;

358 
	}
}

359 
__END_NAMESPACE_C99


361 
__BEGIN_NAMESPACE_STD


363 
__MATH_INLINE
 

364 
__NTH
 (
	$Êo‹
 (
__x
))

366 
__ªs
;

367 
	`__asm
 ("roundsd $1, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

368  
__ªs
;

369 
	}
}

370 
__END_NAMESPACE_STD


372 
__BEGIN_NAMESPACE_C99


373 
__MATH_INLINE
 

374 
__NTH
 (
	$Êo‹f
 (
__x
))

376 
__ªs
;

377 
	`__asm
 ("rounds†$1, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

378  
__ªs
;

379 
	}
}

380 
	g__END_NAMESPACE_C99


385 #i‚de‡
__x86_64__


386 #i‡((!
deföed
 
__NO_MATH_INLINES
 || deföed 
__LIBC_INTERNAL_MATH_INLINES
) \

387 && 
deföed
 
	g__OPTIMIZE__
)

391 #unde‡
m©h_îrh™dlög


400 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


401 
	#__ölöe_m©h›
(
func
, 
›
) \

402 
	`__ölöe_m©h›_
 (, 
func
, 
›
) \

403 
	`__ölöe_m©h›_
 (, 
	`__CONCAT
(
func
,
f
), 
›
) \

404 
	`__ölöe_m©h›_
 (, 
	`__CONCAT
(
func
,
l
), 
›
)

	)

405 
	#__ölöe_m©h›NP
(
func
, 
›
) \

406 
	`__ölöe_m©h›NP_
 (, 
func
, 
›
) \

407 
	`__ölöe_m©h›NP_
 (, 
	`__CONCAT
(
func
,
f
), 
›
) \

408 
	`__ölöe_m©h›NP_
 (, 
	`__CONCAT
(
func
,
l
), 
›
)

	)

410 
	#__ölöe_m©h›
(
func
, 
›
) \

411 
	`__ölöe_m©h›_
 (, 
func
, 
›
)

	)

412 
	#__ölöe_m©h›NP
(
func
, 
›
) \

413 
	`__ölöe_m©h›NP_
 (, 
func
, 
›
)

	)

416 
	#__ölöe_m©h›_
(
Êﬂt_ty≥
, 
func
, 
›
) \

417 
	`__ölöe_m©h›_de˛_
 (
Êﬂt_ty≥
, 
func
, 
›
, "0" (
__x
))

	)

418 
	#__ölöe_m©h›NP_
(
Êﬂt_ty≥
, 
func
, 
›
) \

419 
	`__ölöe_m©h›_de˛NP_
 (
Êﬂt_ty≥
, 
func
, 
›
, "0" (
__x
))

	)

422 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


423 
	#__ölöe_m©h›_de˛
(
func
, 
›
, 
∑øms
...) \

424 
	`__ölöe_m©h›_de˛_
 (, 
func
, 
›
, 
∑øms
) \

425 
	`__ölöe_m©h›_de˛_
 (, 
	`__CONCAT
(
func
,
f
), 
›
, 
∑øms
) \

426 
	`__ölöe_m©h›_de˛_
 (, 
	`__CONCAT
(
func
,
l
), 
›
, 
∑øms
)

	)

427 
	#__ölöe_m©h›_de˛NP
(
func
, 
›
, 
∑øms
...) \

428 
	`__ölöe_m©h›_de˛NP_
 (, 
func
, 
›
, 
∑øms
) \

429 
	`__ölöe_m©h›_de˛NP_
 (, 
	`__CONCAT
(
func
,
f
), 
›
, 
∑øms
) \

430 
	`__ölöe_m©h›_de˛NP_
 (, 
	`__CONCAT
(
func
,
l
), 
›
, 
∑øms
)

	)

432 
	#__ölöe_m©h›_de˛
(
func
, 
›
, 
∑øms
...) \

433 
	`__ölöe_m©h›_de˛_
 (, 
func
, 
›
, 
∑øms
)

	)

434 
	#__ölöe_m©h›_de˛NP
(
func
, 
›
, 
∑øms
...) \

435 
	`__ölöe_m©h›_de˛NP_
 (, 
func
, 
›
, 
∑øms
)

	)

438 
	#__ölöe_m©h›_de˛_
(
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
...) \

439 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥Ë
__THROW
; \

440 
	`__ölöe_m©h›_de˛NP_
 (
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
)

	)

442 
	#__ölöe_m©h›_de˛NP_
(
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
...) \

443 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
__x
)) \

445 
Êﬂt_ty≥
 
__ªsu…
; \

446 
__asm
 
	`__vﬁ©ûe__
 (
›
 : "Ò" (
__ªsu…
Ë: 
∑øms
); \

447  
__ªsu…
; \

448 }

	)

451 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


452 
	#__ölöe_m©hcode
(
func
, 
¨g
, 
code
) \

453 
	`__ölöe_m©hcode_
 (, 
func
, 
¨g
, 
code
) \

454 
	`__ölöe_m©hcode_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g
, 
code
) \

455 
	`__ölöe_m©hcode_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g
, 
code
)

	)

456 
	#__ölöe_m©hcodeNP
(
func
, 
¨g
, 
code
) \

457 
	`__ölöe_m©hcodeNP_
 (, 
func
, 
¨g
, 
code
) \

458 
	`__ölöe_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g
, 
code
) \

459 
	`__ölöe_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g
, 
code
)

	)

460 
	#__ölöe_m©hcode2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

461 
	`__ölöe_m©hcode2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
) \

462 
	`__ölöe_m©hcode2_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
code
) \

463 
	`__ölöe_m©hcode2_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
code
)

	)

464 
	#__ölöe_m©hcodeNP2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

465 
	`__ölöe_m©hcodeNP2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
) \

466 
	`__ölöe_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
code
) \

467 
	`__ölöe_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
code
)

	)

468 
	#__ölöe_m©hcode3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

469 
	`__ölöe_m©hcode3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

470 
	`__ölöe_m©hcode3_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

471 
	`__ölöe_m©hcode3_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

472 
	#__ölöe_m©hcodeNP3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

473 
	`__ölöe_m©hcodeNP3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

474 
	`__ölöe_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

475 
	`__ölöe_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

477 
	#__ölöe_m©hcode
(
func
, 
¨g
, 
code
) \

478 
	`__ölöe_m©hcode_
 (, 
func
, (
¨g
), 
code
)

	)

479 
	#__ölöe_m©hcodeNP
(
func
, 
¨g
, 
code
) \

480 
	`__ölöe_m©hcodeNP_
 (, 
func
, (
¨g
), 
code
)

	)

481 
	#__ölöe_m©hcode2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

482 
	`__ölöe_m©hcode2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

483 
	#__ölöe_m©hcodeNP2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

484 
	`__ölöe_m©hcodeNP2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

485 
	#__ölöe_m©hcode3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

486 
	`__ölöe_m©hcode3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

487 
	#__ölöe_m©hcodeNP3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

488 
	`__ölöe_m©hcodeNP3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

491 
	#__ölöe_m©hcode_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
) \

492 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥Ë
__THROW
; \

493 
	`__ölöe_m©hcodeNP_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
)

	)

495 
	#__ölöe_m©hcodeNP_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
) \

496 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
¨g
)) \

498 
code
; \

499 }

	)

502 
	#__ölöe_m©hcode2_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
) \

503 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥, flﬂt_ty≥Ë
__THROW
; \

504 
	`__ölöe_m©hcodeNP2_
 (
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

506 
	#__ölöe_m©hcodeNP2_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
) \

507 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
¨g1
, flﬂt_ty≥ 
¨g2
)) \

509 
code
; \

510 }

	)

512 
	#__ölöe_m©hcode3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

513 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥, flﬂt_ty≥, flﬂt_ty≥Ë
__THROW
; \

514 
	`__ölöe_m©hcodeNP3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

516 
	#__ölöe_m©hcodeNP3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

517 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
¨g1
, flﬂt_ty≥ 
¨g2
, \

518 
Êﬂt_ty≥
 
¨g3
)) \

520 
code
; \

521 }

	)

525 #i‡!
deföed
 
__NO_MATH_INLINES
 && deföed 
__OPTIMIZE__


529 #ifde‡
__FAST_MATH__


530 #ifde‡
__USE_GNU


531 
	#__söcos_code
 \

532 
__co§
; \

533 
__sör
; \

534 
__swtmp
; \

535 
__asm
 
__vﬁ©ûe__
 \

550 : "Ò" (
__co§
), "=u" (
__sör
), "˜" (
__swtmp
Ë: "0" (
__x
)); \

551 *
__söx
 = 
__sör
; \

552 *
__cosx
 = 
__co§


	)

554 
__MATH_INLINE
 

555 
__NTH
 (
	$__söcos
 (
__x
, *
__söx
, *
__cosx
))

557 
__söcos_code
;

558 
	}
}

560 
__MATH_INLINE
 

561 
__NTH
 (
	$__söcosf
 (
__x
, *
__söx
, *
__cosx
))

563 
__söcos_code
;

564 
	}
}

566 
__MATH_INLINE
 

567 
__NTH
 (
	$__söco¶
 (
__x
, *
__söx
, *
__cosx
))

569 
__söcos_code
;

570 
	}
}

577 #i‡
__GNUC_PREREQ
 (3, 5)

578 
	#__expm1_code
 \

579 
__ãmp
; \

580 
__ãmp
 = 
	`__buûtö_expm1l
 (
__x
); \

581  
__ãmp
 ? __ãm∞: 
__x


	)

583 
	#__expm1_code
 \

584 
__vÆue
; \

585 
__exp⁄ít
; \

586 
__ãmp
; \

587 
__asm
 
__vﬁ©ûe__
 \

596 : "Ò" (
__vÆue
), "=u" (
__exp⁄ít
Ë: "0" (
__x
)); \

597 
__asm
 
__vﬁ©ûe__
 \

599 : "Ò" (
__ãmp
Ë: "0" (1.0), "u" (
__exp⁄ít
)); \

600 
__ãmp
 -= 1.0; \

601 
__ãmp
 +
__vÆue
; \

602  
__ãmp
 ? __ãm∞: 
__x


	)

604 
	$__ölöe_m©hcodeNP_
 (, 
__expm1l
, 
__x
, 
__expm1_code
)

606 #i‡
	`__GNUC_PREREQ
 (3, 4)

607 
	`__ölöe_m©hcodeNP_
 (, 
__ex∂
, 
__x
,  
	$__buûtö_ex∂
 (
__x
))

609 
	#__exp_code
 \

610 
__vÆue
; \

611 
__exp⁄ít
; \

612 
__asm
 
__vﬁ©ûe__
 \

620 : "Ò" (
__vÆue
), "=u" (
__exp⁄ít
Ë: "0" (
__x
)); \

621 
__vÆue
 += 1.0; \

622 
__asm
 
__vﬁ©ûe__
 \

624 : "Ò" (
__vÆue
Ë: "0" (__vÆue), "u" (
__exp⁄ít
)); \

625  
__vÆue


	)

626 
	$__ölöe_m©hcodeNP
 (
exp
, 
__x
, 
__exp_code
)

627 
	$__ölöe_m©hcodeNP_
 (, 
__ex∂
, 
__x
, 
__exp_code
)

631 #i‡!
	`__GNUC_PREREQ
 (3, 5)

632 
	`__ölöe_m©hcodeNP
 (
èn
, 
__x
, \

633 
__vÆue
; \

634 
__vÆue2
 
	`__©åibuã__
 ((
__unu£d__
)); \

635 
__asm
 
__vﬁ©ûe__
 \

637 : "Ò" (
__vÆue2
), "=u" (
__vÆue
Ë: "0" (
__x
)); \

638  
__vÆue
)

643 #i‡
	`__GNUC_PREREQ
 (3, 4)

644 
	`__ölöe_m©hcodeNP2_
 (, 
__©™2l
, 
__y
, 
__x
,

645  
	$__buûtö_©™2l
 (
__y
, 
__x
))

647 
	#__©™2_code
 \

648 
__vÆue
; \

649 
__asm
 
__vﬁ©ûe__
 \

651 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" (
__y
) : "st(1)"); \

652  
__vÆue


	)

653 #ifde‡
__FAST_MATH__


654 
	$__ölöe_m©hcodeNP2
 (
©™2
, 
__y
, 
__x
, 
__©™2_code
)

656 
	$__ölöe_m©hcodeNP2_
 (, 
__©™2l
, 
__y
, 
__x
, 
__©™2_code
)

660 #i‡
deföed
 
__FAST_MATH__
 && !
	`__GNUC_PREREQ
 (3, 5)

661 
	`__ölöe_m©hcodeNP2
 (
fmod
, 
__x
, 
__y
, \

662 
__vÆue
; \

663 
__asm
 
__vﬁ©ûe__
 \

668 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" (
__y
) : "ax", "cc"); \

669  
__vÆue
)

673 #ifde‡
__FAST_MATH__


674 #i‡!
	`__GNUC_PREREQ
 (3,3)

675 
	`__ölöe_m©h›NP
 (
sqπ
, "fsqrt")

676 
	`__ölöe_m©h›NP_
 (, 
__sqπl
, "fsqrt")

677 
	#__libc_sqπl
(
n
Ë
	`__sqπl
 (n)

	)

679 
	#__libc_sqπl
(
n
Ë
	`__buûtö_sqπl
 (n)

	)

683 #i‡
	`__GNUC_PREREQ
 (2, 8)

684 
	`__ölöe_m©hcodeNP_
 (, 
Ábs
, 
__x
,  
	$__buûtö_Ábs
 (
__x
))

685 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


686 
	`__ölöe_m©hcodeNP_
 (, 
Ábsf
, 
__x
,  
	$__buûtö_Ábsf
 (
__x
))

687 
	`__ölöe_m©hcodeNP_
 (, 
Áb¶
, 
__x
,  
	$__buûtö_Áb¶
 (
__x
))

689 
	`__ölöe_m©hcodeNP_
 (, 
__Áb¶
, 
__x
,  
	$__buûtö_Áb¶
 (
__x
))

691 
	`__ölöe_m©h›
 (
Ábs
, "fabs")

692 
	`__ölöe_m©h›_
 (, 
__Áb¶
, "fabs")

695 #ifde‡
__FAST_MATH__


696 #i‡!
	`__GNUC_PREREQ
 (3, 4)

698 
	`__ölöe_m©h›NP
 (
sö
, "fsin")

700 
	`__ölöe_m©h›NP
 (
cos
, "fcos")

702 
	`__ölöe_m©h›_de˛NP
 (
log
, "Êd 2; fxch; fyl2x", "0" (
__x
) : "st(1)")

705 #i‡!
	`__GNUC_PREREQ
 (3, 5)

706 
	`__ölöe_m©h›_de˛NP
 (
log10
, "Êdlg2; fxch; fyl2x", "0" (
__x
) : "st(1)")

708 
	`__ölöe_m©hcodeNP
 (
asö
, 
__x
,  
	`__©™2l
 (__x, 
	`__libc_sqπl
 (1.0 - __x * __x)))

709 
	`__ölöe_m©hcodeNP
 (
acos
, 
__x
,  
	`__©™2l
 (
	`__libc_sqπl
 (1.0 - __x * __x), __x))

712 #i‡!
	`__GNUC_PREREQ
 (3, 4)

713 
	`__ölöe_m©h›_de˛NP
 (
©™
, "Êd1; f∑èn", "0" (
__x
) : "st(1)")

717 
	`__ölöe_m©hcode_
 (, 
__sgn1l
, 
__x
, \

718 
__exãnsi⁄__
 uni⁄ { 
__xld
; 
__xi
[3]; } 
__n
 = \

719 { 
__xld
: 
__x
 
	}
}; \

720 
	g__n
.
	g__xi
[2] = (
__n
.
__xi
[2] & 0x8000) | 0x3fff; \

721 
	g__n
.
	g__xi
[1] = 0x80000000; \

722 
	g__n
.
	g__xi
[0] = 0; \

723  
	g__n
.
	g__xld
)

726 #ifde‡
__FAST_MATH__


728 
__ölöe_m©hcodeNP
 (
söh
, 
__x
, \

729 
__exm1
 = 
__expm1l
 (
__Áb¶
 (
__x
)); \

730  0.5 * (
__exm1
 / (__exm1 + 1.0Ë+ __exm1Ë* 
	$__sgn1l
 (
__x
))

732 
	`__ölöe_m©hcodeNP
 (
cosh
, 
__x
, \

733 
__ex
 = 
	`__ex∂
 (
__x
); \

734  0.5 * (
__ex
 + 1.0 / __ex))

736 
	`__ölöe_m©hcodeNP
 (
ènh
, 
__x
, \

737 
__exm1
 = 
	`__expm1l
 (-
	`__Áb¶
 (
__x
 + __x)); \

738  
__exm1
 / (__exm1 + 2.0Ë* 
	`__sgn1l
 (-
__x
))

741 
	`__ölöe_m©hcodeNP
 (
Êo‹
, 
__x
, \

742 
__vÆue
; \

743 
__ign‹e
; \

744 
__cw
; \

745 
__cwtmp
; \

746 
__asm
 
	`__vﬁ©ûe
 ("fnstcw %3\n\t" \

754 : "Ò" (
__vÆue
), "=&q" (
__ign‹e
), "=m" (
__cwtmp
), \

755 "=m" (
__cw
) \

756 : "0" (
__x
)); \

757  
__vÆue
)

759 
	`__ölöe_m©hcodeNP
 (
˚û
, 
__x
, \

760 
__vÆue
; \

761 
__ign‹e
; \

762 
__cw
; \

763 
__cwtmp
; \

764 
__asm
 
	`__vﬁ©ûe
 ("fnstcw %3\n\t" \

772 : "Ò" (
__vÆue
), "=&q" (
__ign‹e
), "=m" (
__cwtmp
), \

773 "=m" (
__cw
) \

774 : "0" (
__x
)); \

775  
__vÆue
)

777 #ifde‡
__FAST_MATH__


778 
	#__ldexp_code
 \

779 
__vÆue
; \

780 
__asm
 
__vﬁ©ûe__
 \

782 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" ((Ë
__y
)); \

783  
__vÆue


	)

785 
__MATH_INLINE
 

786 
	`__NTH
 (
	$ldexp
 (
__x
, 
__y
))

788 
__ldexp_code
;

789 
	}
}

794 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


796 #ifde‡
__FAST_MATH__


797 
	$__ölöe_m©hcodeNP
 (
expm1
, 
__x
, 
__expm1_code
)

801 
	#__M_SQRT2
 1.41421356237309504880L

	)

803 #i‡!
	`__GNUC_PREREQ
 (3, 5)

804 
	`__ölöe_m©hcodeNP
 (
log1p
, 
__x
, \

805 
__vÆue
; \

806 i‡(
	`__Áb¶
 (
__x
Ë>1.0 - 0.5 * 
__M_SQRT2
) \

807 
__vÆue
 = 
	`logl
 (1.0 + 
__x
); \

809 
__asm
 
__vﬁ©ûe__
 \

813 : "Ò" (
__vÆue
Ë: "0" (
__x
) : "st(1)"); \

814  
__vÆue
)

819 
	`__ölöe_m©hcodeNP
 (
asöh
, 
__x
, \

820 
__y
 = 
	`__Áb¶
 (
__x
); \

821  (
	`log1∂
 (
__y
 * __y / (
	`__libc_sqπl
 (__y * __y + 1.0) + 1.0) + __y) \

822 * 
	$__sgn1l
 (
__x
)))

824 
	`__ölöe_m©hcodeNP
 (
acosh
, 
__x
, \

825  
	`logl
 (
__x
 + 
	`__libc_sqπl
 (__x - 1.0) * __libc_sqrtl (__x + 1.0)))

827 
	`__ölöe_m©hcodeNP
 (
©™h
, 
__x
, \

828 
__y
 = 
	`__Áb¶
 (
__x
); \

829  -0.5 * 
	`log1∂
 (-(
__y
 + __yË/ (1.0 + __y)Ë* 
	$__sgn1l
 (
__x
))

832 
	`__ölöe_m©hcodeNP2
 (
hypŸ
, 
__x
, 
__y
,

833  
	`__libc_sqπl
 (
__x
 * __x + 
__y
 * __y))

835 #i‡!
	`__GNUC_PREREQ
 (3, 5)

836 
	`__ölöe_m©hcodeNP
(
logb
, 
__x
, \

837 
__vÆue
; \

838 
__junk
; \

839 
__asm
 
__vﬁ©ûe__
 \

841 : "Ò" (
__junk
), "=u" (
__vÆue
Ë: "0" (
__x
)); \

842  
__vÆue
)

848 #ifde‡
__USE_ISOC99


849 #ifde‡
__FAST_MATH__


851 #i‡!
	`__GNUC_PREREQ
 (3, 5)

852 
	`__ölöe_m©h›_de˛NP
 (
log2
, "Êd1; fxch; fyl2x", "0" (
__x
) : "st(1)")

855 
__MATH_INLINE
 

856 
	`__NTH
 (
	$ldexpf
 (
__x
, 
__y
))

858 
__ldexp_code
;

859 
	}
}

861 
__MATH_INLINE
 

862 
__NTH
 (
	$ldex∂
 (
__x
, 
__y
))

864 
__ldexp_code
;

865 
	}
}

867 
__ölöe_m©h›NP
 (
röt
, "frndint")

870 
	#__Ãöt_code
 \

871 
__Ãöåes
; \

872 
__asm__
 
__vﬁ©ûe__
 \

874 : "=m" (
__Ãöåes
Ë: "t" (
__x
) : "st"); \

875  
__Ãöåes


	)

876 
__MATH_INLINE
 

877 
__NTH
 (
	$Ãötf
 (
__x
))

879 
__Ãöt_code
;

880 
	}
}

881 
__MATH_INLINE
 

882 
__NTH
 (
	$Ãöt
 (
__x
))

884 
__Ãöt_code
;

885 
	}
}

886 
__MATH_INLINE
 

887 
__NTH
 (
	$Ãöé
 (
__x
))

889 
__Ãöt_code
;

890 
	}
}

891 #unde‡
__Ãöt_code


893 
	#__Œröt_code
 \

894 
__Œröåes
; \

895 
__asm__
 
__vﬁ©ûe__
 \

897 : "=m" (
__Œröåes
Ë: "t" (
__x
) : "st"); \

898  
__Œröåes


	)

899 
__MATH_INLINE
 

900 
__NTH
 (
	$Œrötf
 (
__x
))

902 
__Œröt_code
;

903 
	}
}

904 
__MATH_INLINE
 

905 
__NTH
 (
	$Œröt
 (
__x
))

907 
__Œröt_code
;

908 
	}
}

909 
__MATH_INLINE
 

910 
__NTH
 (
	$Œröé
 (
__x
))

912 
__Œröt_code
;

913 
	}
}

914 #unde‡
__Œröt_code


919 #ifde‡
__USE_MISC


921 #i‡
deföed
 
__FAST_MATH__
 && !
__GNUC_PREREQ
 (3, 5)

922 
__ölöe_m©hcodeNP2
 (
dªm
, 
__x
, 
__y
, \

923 
__vÆue
; \

924 
__˛obbîed
; \

925 
__asm
 
__vﬁ©ûe__
 \

930 : "Ò" (
__vÆue
), "=&a" (
__˛obbîed
Ë: "0" (
__x
), "u" (
__y
) : "cc"); \

931  
__vÆue
)

936 
__MATH_INLINE
 

937 
__NTH
 (
	$__föôe
 (
__x
))

939  (
__exãnsi⁄__


940 (((((uni⁄ { 
__d
; 
__i
[2]; }Ë{__d: 
__x
}).__i[1]

942 
	}
}

947 #unde‡
__©™2_code


948 #ifde‡
__FAST_MATH__


949 #unde‡
__expm1_code


950 #unde‡
__exp_code


951 #unde‡
__söcos_code


958 #ifde‡
__LIBC_INTERNAL_MATH_INLINES


959 
__ölöe_m©h›
 (
__õì754_sqπ
, "fsqrt")

960 
__ölöe_m©hcode2
 (
__õì754_©™2
, 
__y
, 
__x
,

961 
__vÆue
;

962 
__asm
 
__vﬁ©ûe__
 ("fpatan\n\t"

963 : "Ò" (
__vÆue
)

964 : "0" (
__x
), "u" (
__y
) : "st(1)");

965  
__vÆue
;)

	@/usr/include/bits/nan.h

19 #i‚de‡
_MATH_H


26 #i‡
__GNUC_PREREQ
(3,3)

28 
	#NAN
 (
	`__buûtö_«nf
 (""))

	)

30 #ñi‡
deföed
 
__GNUC__


32 
	#NAN
 \

33 (
__exãnsi⁄__
 \

34 ((uni⁄ { 
__l
 
	`__©åibuã__
 ((
	`__mode__
 (
__SI__
))); 
__d
; }) \

35 { 
__l
: 0x7fc00000UL }).
__d
)

	)

39 
	~<ídün.h
>

41 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


42 
	#__«n_byãs
 { 0x7f, 0xc0, 0, 0 }

	)

44 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


45 
	#__«n_byãs
 { 0, 0, 0xc0, 0x7‡}

	)

48 uni⁄ { 
	m__c
[4]; 
	m__d
; } 
__«n_uni⁄


49 
	g__©åibuã_u£d__
 = { 
__«n_byãs
 };

50 
	#NAN
 (
__«n_uni⁄
.
__d
)

	)

	@/usr/include/bits/netdb.h

18 #i‚de‡
_NETDB_H


26 
	s√ã¡


28 *
	mn_«me
;

29 **
	mn_Æü£s
;

30 
	mn_addπy≥
;

31 
uöt32_t
 
	mn_√t
;

	@/usr/include/bits/param.h

19 #i‚de‡
_SYS_PARAM_H


23 #i‚de‡
ARG_MAX


24 
	#__undef_ARG_MAX


	)

27 
	~<löux/limôs.h
>

28 
	~<löux/∑øm.h
>

31 #ifde‡
__undef_ARG_MAX


32 #unde‡
ARG_MAX


33 #unde‡
__undef_ARG_MAX


36 
	#MAXSYMLINKS
 20

	)

41 
	#NOFILE
 256

	)

42 
	#NCARGS
 131072

	)

	@/usr/include/bits/posix1_lim.h

24 #i‚def 
_BITS_POSIX1_LIM_H


25 
	#_BITS_POSIX1_LIM_H
 1

	)

31 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

34 
	#_POSIX_AIO_MAX
 1

	)

37 
	#_POSIX_ARG_MAX
 4096

	)

40 #ifde‡
__USE_XOPEN2K


41 
	#_POSIX_CHILD_MAX
 25

	)

43 
	#_POSIX_CHILD_MAX
 6

	)

47 
	#_POSIX_DELAYTIMER_MAX
 32

	)

51 
	#_POSIX_HOST_NAME_MAX
 255

	)

54 
	#_POSIX_LINK_MAX
 8

	)

57 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

60 
	#_POSIX_MAX_CANON
 255

	)

64 
	#_POSIX_MAX_INPUT
 255

	)

67 
	#_POSIX_MQ_OPEN_MAX
 8

	)

70 
	#_POSIX_MQ_PRIO_MAX
 32

	)

73 
	#_POSIX_NAME_MAX
 14

	)

76 #ifde‡
__USE_XOPEN2K


77 
	#_POSIX_NGROUPS_MAX
 8

	)

79 
	#_POSIX_NGROUPS_MAX
 0

	)

83 #ifde‡
__USE_XOPEN2K


84 
	#_POSIX_OPEN_MAX
 20

	)

86 
	#_POSIX_OPEN_MAX
 16

	)

89 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

96 
	#_POSIX_PATH_MAX
 256

	)

99 
	#_POSIX_PIPE_BUF
 512

	)

103 
	#_POSIX_RE_DUP_MAX
 255

	)

106 
	#_POSIX_RTSIG_MAX
 8

	)

109 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

112 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

115 
	#_POSIX_SIGQUEUE_MAX
 32

	)

118 
	#_POSIX_SSIZE_MAX
 32767

	)

121 
	#_POSIX_STREAM_MAX
 8

	)

124 
	#_POSIX_SYMLINK_MAX
 255

	)

128 
	#_POSIX_SYMLOOP_MAX
 8

	)

131 
	#_POSIX_TIMER_MAX
 32

	)

134 
	#_POSIX_TTY_NAME_MAX
 9

	)

137 #ifde‡
__USE_XOPEN2K


138 
	#_POSIX_TZNAME_MAX
 6

	)

140 
	#_POSIX_TZNAME_MAX
 3

	)

143 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


145 
	#_POSIX_QLIMIT
 1

	)

149 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

152 
	#_POSIX_UIO_MAXIOV
 16

	)

156 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

160 
	~<bôs/loˇl_lim.h
>

163 #i‚def 
SSIZE_MAX


164 
	#SSIZE_MAX
 
LONG_MAX


	)

171 #i‚def 
NGROUPS_MAX


172 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

22 #i‚def 
_BITS_POSIX2_LIM_H


23 
	#_BITS_POSIX2_LIM_H
 1

	)

27 
	#_POSIX2_BC_BASE_MAX
 99

	)

30 
	#_POSIX2_BC_DIM_MAX
 2048

	)

33 
	#_POSIX2_BC_SCALE_MAX
 99

	)

36 
	#_POSIX2_BC_STRING_MAX
 1000

	)

40 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

44 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

47 
	#_POSIX2_LINE_MAX
 2048

	)

51 
	#_POSIX2_RE_DUP_MAX
 255

	)

55 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

62 #i‚def 
BC_BASE_MAX


63 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

65 #i‚def 
BC_DIM_MAX


66 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

68 #i‚def 
BC_SCALE_MAX


69 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

71 #i‚def 
BC_STRING_MAX


72 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

74 #i‚def 
COLL_WEIGHTS_MAX


75 
	#COLL_WEIGHTS_MAX
 255

	)

77 #i‚def 
EXPR_NEST_MAX


78 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

80 #i‚def 
LINE_MAX


81 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

83 #i‚def 
CHARCLASS_NAME_MAX


84 
	#CHARCLASS_NAME_MAX
 2048

	)

88 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/posix_opt.h

19 #i‚def 
_BITS_POSIX_OPT_H


20 
	#_BITS_POSIX_OPT_H
 1

	)

23 
	#_POSIX_JOB_CONTROL
 1

	)

26 
	#_POSIX_SAVED_IDS
 1

	)

29 
	#_POSIX_PRIORITY_SCHEDULING
 200809L

	)

32 
	#_POSIX_SYNCHRONIZED_IO
 200809L

	)

35 
	#_POSIX_FSYNC
 200809L

	)

38 
	#_POSIX_MAPPED_FILES
 200809L

	)

41 
	#_POSIX_MEMLOCK
 200809L

	)

44 
	#_POSIX_MEMLOCK_RANGE
 200809L

	)

47 
	#_POSIX_MEMORY_PROTECTION
 200809L

	)

50 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

54 
	#_POSIX_VDISABLE
 '\0'

	)

57 
	#_POSIX_NO_TRUNC
 1

	)

60 
	#_XOPEN_REALTIME
 1

	)

63 
	#_XOPEN_REALTIME_THREADS
 1

	)

66 
	#_XOPEN_SHM
 1

	)

69 
	#_POSIX_THREADS
 200809L

	)

72 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

73 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200809L

	)

76 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200809L

	)

79 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200809L

	)

82 
	#_POSIX_THREAD_ATTR_STACKADDR
 200809L

	)

85 
	#_POSIX_THREAD_PRIO_INHERIT
 200809L

	)

89 
	#_POSIX_THREAD_PRIO_PROTECT
 200809L

	)

91 #ifde‡
__USE_XOPEN2K8


93 
	#_POSIX_THREAD_ROBUST_PRIO_INHERIT
 200809L

	)

96 
	#_POSIX_THREAD_ROBUST_PRIO_PROTECT
 -1

	)

100 
	#_POSIX_SEMAPHORES
 200809L

	)

103 
	#_POSIX_REALTIME_SIGNALS
 200809L

	)

106 
	#_POSIX_ASYNCHRONOUS_IO
 200809L

	)

107 
	#_POSIX_ASYNC_IO
 1

	)

109 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

111 
	#_POSIX_PRIORITIZED_IO
 200809L

	)

114 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

117 
	#_LFS_LARGEFILE
 1

	)

118 
	#_LFS64_LARGEFILE
 1

	)

119 
	#_LFS64_STDIO
 1

	)

122 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200809L

	)

125 
	#_POSIX_CPUTIME
 0

	)

128 
	#_POSIX_THREAD_CPUTIME
 0

	)

131 
	#_POSIX_REGEXP
 1

	)

134 
	#_POSIX_READER_WRITER_LOCKS
 200809L

	)

137 
	#_POSIX_SHELL
 1

	)

140 
	#_POSIX_TIMEOUTS
 200809L

	)

143 
	#_POSIX_SPIN_LOCKS
 200809L

	)

146 
	#_POSIX_SPAWN
 200809L

	)

149 
	#_POSIX_TIMERS
 200809L

	)

152 
	#_POSIX_BARRIERS
 200809L

	)

155 
	#_POSIX_MESSAGE_PASSING
 200809L

	)

158 
	#_POSIX_THREAD_PROCESS_SHARED
 200809L

	)

161 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

164 
	#_POSIX_CLOCK_SELECTION
 200809L

	)

167 
	#_POSIX_ADVISORY_INFO
 200809L

	)

170 
	#_POSIX_IPV6
 200809L

	)

173 
	#_POSIX_RAW_SOCKETS
 200809L

	)

176 
	#_POSIX2_CHAR_TERM
 200809L

	)

179 
	#_POSIX_SPORADIC_SERVER
 -1

	)

180 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

183 
	#_POSIX_TRACE
 -1

	)

184 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

185 
	#_POSIX_TRACE_INHERIT
 -1

	)

186 
	#_POSIX_TRACE_LOG
 -1

	)

189 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

192 
	#_XOPEN_STREAMS
 -1

	)

	@/usr/include/bits/pthreadtypes.h

18 #i‚de‡
_BITS_PTHREADTYPES_H


19 
	#_BITS_PTHREADTYPES_H
 1

	)

21 
	~<bôs/w‹dsize.h
>

23 #ifde‡
__x86_64__


24 #i‡
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

26 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

27 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

28 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

29 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

30 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

31 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

32 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

33 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

35 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

36 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

37 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

38 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

39 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

40 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

41 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

43 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

46 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

47 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

48 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

49 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

50 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

51 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

52 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

53 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

54 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

60 
	t±hªad_t
;

63 
	u±hªad_©å_t


65 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

66 
	m__Æign
;

68 #i‚de‡
__have_±hªad_©å_t


69 
±hªad_©å_t
 
	t±hªad_©å_t
;

70 
	#__have_±hªad_©å_t
 1

	)

74 #ifde‡
__x86_64__


75 
	s__±hªad_öã∫Æ_li°


77 
__±hªad_öã∫Æ_li°
 *
	m__¥ev
;

78 
__±hªad_öã∫Æ_li°
 *
	m__√xt
;

79 } 
	t__±hªad_li°_t
;

81 
	s__±hªad_öã∫Æ_¶i°


83 
__±hªad_öã∫Æ_¶i°
 *
	m__√xt
;

84 } 
	t__±hªad_¶i°_t
;

92 
	s__±hªad_muãx_s


94 
	m__lock
;

95 
	m__cou¡
;

96 
	m__ow√r
;

97 #ifde‡
__x86_64__


98 
	m__nu£rs
;

102 
	m__köd
;

103 #ifde‡
__x86_64__


104 
	m__•ös
;

105 
	m__ñisi⁄
;

106 
__±hªad_li°_t
 
	m__li°
;

107 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

109 
	#__PTHREAD_SPINS
 0, 0

	)

111 
	m__nu£rs
;

112 
__exãnsi⁄__
 union

116 
	m__e•ös
;

117 
	m__ñisi⁄
;

118 
	#__•ös
 
__ñisi⁄_d©a
.
__e•ös


	)

119 
	#__ñisi⁄
 
__ñisi⁄_d©a
.
__ñisi⁄


	)

120 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

121 } 
	m__ñisi⁄_d©a
;

122 
__±hªad_¶i°_t
 
	m__li°
;

125 } 
	m__d©a
;

126 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

127 
	m__Æign
;

128 } 
	t±hªad_muãx_t
;

132 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

133 
	m__Æign
;

134 } 
	t±hªad_muãx©å_t
;

143 
	m__lock
;

144 
	m__fuãx
;

145 
__exãnsi⁄__
 
	m__tŸÆ_£q
;

146 
__exãnsi⁄__
 
	m__wakeup_£q
;

147 
__exãnsi⁄__
 
	m__wokí_£q
;

148 *
	m__muãx
;

149 
	m__nwaôîs
;

150 
	m__brﬂdˇ°_£q
;

151 } 
	m__d©a
;

152 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

153 
__exãnsi⁄__
 
	m__Æign
;

154 } 
	t±hªad_c⁄d_t
;

158 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

159 
	m__Æign
;

160 } 
	t±hªad_c⁄d©å_t
;

164 
	t±hªad_key_t
;

168 
	t±hªad_⁄˚_t
;

171 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


176 #ifde‡
__x86_64__


179 
	m__lock
;

180 
	m__ƒ_ªadîs
;

181 
	m__ªadîs_wakeup
;

182 
	m__wrôî_wakeup
;

183 
	m__ƒ_ªadîs_queued
;

184 
	m__ƒ_wrôîs_queued
;

185 
	m__wrôî
;

186 
	m__sh¨ed
;

187 
	m__∑d1
;

188 
	m__∑d2
;

191 
	m__Êags
;

192 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

193 } 
	m__d©a
;

197 
	m__lock
;

198 
	m__ƒ_ªadîs
;

199 
	m__ªadîs_wakeup
;

200 
	m__wrôî_wakeup
;

201 
	m__ƒ_ªadîs_queued
;

202 
	m__ƒ_wrôîs_queued
;

205 
	m__Êags
;

206 
	m__sh¨ed
;

207 
	m__∑d1
;

208 
	m__∑d2
;

209 
	m__wrôî
;

210 } 
	m__d©a
;

212 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

213 
	m__Æign
;

214 } 
	t±hªad_rwlock_t
;

218 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

219 
	m__Æign
;

220 } 
	t±hªad_rwlock©å_t
;

224 #ifde‡
__USE_XOPEN2K


226 vﬁ©ûê
	t±hªad_•ölock_t
;

233 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

234 
	m__Æign
;

235 } 
	t±hªad_b¨rõr_t
;

239 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

240 
	m__Æign
;

241 } 
	t±hªad_b¨rõøâr_t
;

245 #i‚de‡
__x86_64__


247 
	#__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
	`__ªg∑rm__
 (1)))

	)

	@/usr/include/bits/resource.h

19 #i‚de‡
_SYS_RESOURCE_H


23 
	~<bôs/ty≥s.h
>

31 
	e__æimô_ªsour˚


34 
	mRLIMIT_CPU
 = 0,

35 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

38 
	mRLIMIT_FSIZE
 = 1,

39 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

42 
	mRLIMIT_DATA
 = 2,

43 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

46 
	mRLIMIT_STACK
 = 3,

47 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

50 
	mRLIMIT_CORE
 = 4,

51 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

57 
	m__RLIMIT_RSS
 = 5,

58 
	#RLIMIT_RSS
 
__RLIMIT_RSS


	)

61 
	mRLIMIT_NOFILE
 = 7,

62 
	m__RLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

63 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

64 
	#RLIMIT_OFILE
 
__RLIMIT_OFILE


	)

67 
	mRLIMIT_AS
 = 9,

68 
	#RLIMIT_AS
 
RLIMIT_AS


	)

71 
	m__RLIMIT_NPROC
 = 6,

72 
	#RLIMIT_NPROC
 
__RLIMIT_NPROC


	)

75 
	m__RLIMIT_MEMLOCK
 = 8,

76 
	#RLIMIT_MEMLOCK
 
__RLIMIT_MEMLOCK


	)

79 
	m__RLIMIT_LOCKS
 = 10,

80 
	#RLIMIT_LOCKS
 
__RLIMIT_LOCKS


	)

83 
	m__RLIMIT_SIGPENDING
 = 11,

84 
	#RLIMIT_SIGPENDING
 
__RLIMIT_SIGPENDING


	)

87 
	m__RLIMIT_MSGQUEUE
 = 12,

88 
	#RLIMIT_MSGQUEUE
 
__RLIMIT_MSGQUEUE


	)

93 
	m__RLIMIT_NICE
 = 13,

94 
	#RLIMIT_NICE
 
__RLIMIT_NICE


	)

98 
	m__RLIMIT_RTPRIO
 = 14,

99 
	#RLIMIT_RTPRIO
 
__RLIMIT_RTPRIO


	)

104 
	m__RLIMIT_RTTIME
 = 15,

105 
	#RLIMIT_RTTIME
 
__RLIMIT_RTTIME


	)

107 
	m__RLIMIT_NLIMITS
 = 16,

108 
	m__RLIM_NLIMITS
 = 
__RLIMIT_NLIMITS


109 
	#RLIMIT_NLIMITS
 
__RLIMIT_NLIMITS


	)

110 
	#RLIM_NLIMITS
 
__RLIM_NLIMITS


	)

114 #i‚de‡
__USE_FILE_OFFSET64


115 
	#RLIM_INFINITY
 ((
__æim_t
Ë-1)

	)

117 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

120 #ifde‡
__USE_LARGEFILE64


121 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

125 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

126 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

130 #i‚de‡
__USE_FILE_OFFSET64


131 
__æim_t
 
	tæim_t
;

133 
__æim64_t
 
	tæim_t
;

135 #ifde‡
__USE_LARGEFILE64


136 
__æim64_t
 
	tæim64_t
;

139 
	sæimô


142 
æim_t
 
	mæim_cur
;

144 
æim_t
 
	mæim_max
;

147 #ifde‡
__USE_LARGEFILE64


148 
	sæimô64


151 
æim64_t
 
	mæim_cur
;

153 
æim64_t
 
	mæim_max
;

158 
	e__rußge_who


161 
	mRUSAGE_SELF
 = 0,

162 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

165 
	mRUSAGE_CHILDREN
 = -1

166 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

168 #ifde‡
__USE_GNU


171 
	mRUSAGE_THREAD
 = 1

172 
	#RUSAGE_THREAD
 
RUSAGE_THREAD


	)

174 
	#RUSAGE_LWP
 
RUSAGE_THREAD


	)

178 
	#__√ed_timevÆ


	)

179 
	~<bôs/time.h
>

187 
	srußge


190 
timevÆ
 
	mru_utime
;

192 
timevÆ
 
	mru_°ime
;

194 
__exãnsi⁄__
 union

196 
	mru_maxrss
;

197 
__sysˇŒ_¶⁄g_t
 
	m__ru_maxrss_w‹d
;

202 
__exãnsi⁄__
 union

204 
	mru_ixrss
;

205 
__sysˇŒ_¶⁄g_t
 
	m__ru_ixrss_w‹d
;

208 
__exãnsi⁄__
 union

210 
	mru_idrss
;

211 
__sysˇŒ_¶⁄g_t
 
	m__ru_idrss_w‹d
;

214 
__exãnsi⁄__
 union

216 
	mru_i§ss
;

217 
__sysˇŒ_¶⁄g_t
 
	m__ru_i§ss_w‹d
;

221 
__exãnsi⁄__
 union

223 
	mru_möÊt
;

224 
__sysˇŒ_¶⁄g_t
 
	m__ru_möÊt_w‹d
;

227 
__exãnsi⁄__
 union

229 
	mru_majÊt
;

230 
__sysˇŒ_¶⁄g_t
 
	m__ru_majÊt_w‹d
;

233 
__exãnsi⁄__
 union

235 
	mru_nsw≠
;

236 
__sysˇŒ_¶⁄g_t
 
	m__ru_nsw≠_w‹d
;

240 
__exãnsi⁄__
 union

242 
	mru_öblock
;

243 
__sysˇŒ_¶⁄g_t
 
	m__ru_öblock_w‹d
;

246 
__exãnsi⁄__
 union

248 
	mru_oublock
;

249 
__sysˇŒ_¶⁄g_t
 
	m__ru_oublock_w‹d
;

252 
__exãnsi⁄__
 union

254 
	mru_msg¢d
;

255 
__sysˇŒ_¶⁄g_t
 
	m__ru_msg¢d_w‹d
;

258 
__exãnsi⁄__
 union

260 
	mru_msgrcv
;

261 
__sysˇŒ_¶⁄g_t
 
	m__ru_msgrcv_w‹d
;

264 
__exãnsi⁄__
 union

266 
	mru_nsig«ls
;

267 
__sysˇŒ_¶⁄g_t
 
	m__ru_nsig«ls_w‹d
;

272 
__exãnsi⁄__
 union

274 
	mru_nvcsw
;

275 
__sysˇŒ_¶⁄g_t
 
	m__ru_nvcsw_w‹d
;

279 
__exãnsi⁄__
 union

281 
	mru_nivcsw
;

282 
__sysˇŒ_¶⁄g_t
 
	m__ru_nivcsw_w‹d
;

287 
	#PRIO_MIN
 -20

	)

288 
	#PRIO_MAX
 20

	)

292 
	e__¥i‹ôy_which


294 
	mPRIO_PROCESS
 = 0,

295 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

296 
	mPRIO_PGRP
 = 1,

297 
	#PRIO_PGRP
 
PRIO_PGRP


	)

298 
	mPRIO_USER
 = 2

299 
	#PRIO_USER
 
PRIO_USER


	)

303 
	g__BEGIN_DECLS


305 #ifde‡
__USE_GNU


307 #i‚de‡
__USE_FILE_OFFSET64


308 
	$¥limô
 (
__pid_t
 
__pid
, 
__æimô_ªsour˚
 
__ªsour˚
,

309 c⁄° 
æimô
 *
__√w_limô
,

310 
æimô
 *
__ﬁd_limô
Ë
__THROW
;

312 #ifde‡
__REDIRECT_NTH


313 
	`__REDIRECT_NTH
 (
¥limô
, (
__pid_t
 
__pid
,

314 
__æimô_ªsour˚
 
__ªsour˚
,

315 c⁄° 
æimô
 *
__√w_limô
,

316 
æimô
 *
__ﬁd_limô
), 
¥limô64
);

318 
	#¥limô
 
¥limô64


	)

321 #ifde‡
__USE_LARGEFILE64


322 
	$¥limô64
 (
__pid_t
 
__pid
, 
__æimô_ªsour˚
 
__ªsour˚
,

323 c⁄° 
æimô64
 *
__√w_limô
,

324 
æimô64
 *
__ﬁd_limô
Ë
__THROW
;

328 
__END_DECLS


	@/usr/include/bits/select.h

18 #i‚de‡
_SYS_SELECT_H


22 
	~<bôs/w‹dsize.h
>

25 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

27 #i‡
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "°osq"

	)

30 
	#__FD_ZERO_STOS
 "°o¶"

	)

33 
	#__FD_ZERO
(
fd•
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vﬁ©ûe__
 ("˛d;Ñï; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd•
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¨r
 = (
£t
); \

52 
__i
 = 0; __ò<  (
fd_£t
Ë/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¨r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)Ë!0)

	)

	@/usr/include/bits/select2.h

19 #i‚de‡
_SYS_SELECT_H


24 
__fdñt_chk
 (
__d
);

25 
	$__fdñt_w¨n
 (
__d
)

26 
	`__w¨«âr
 ("bit outside of fd_set selected");

27 #unde‡
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__exãnsi⁄__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__buûtö_c⁄°™t_p
 (
__d
) \

32 ? (0 <
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fdñt_w¨n
 (
__d
)) \

35 : 
	`__fdñt_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/setjmp.h

19 #i‚de‡
_BITS_SETJMP_H


20 
	#_BITS_SETJMP_H
 1

	)

22 #i‡!
deföed
 
_SETJMP_H
 && !deföed 
_PTHREAD_H


26 
	~<bôs/w‹dsize.h
>

28 #i‚de‡
_ASM


30 #i‡
__WORDSIZE
 == 64

31 
	t__jmp_buf
[8];

32 #ñi‡
deföed
 
__x86_64__


33 
	t__jmp_buf
[8];

35 
	t__jmp_buf
[6];

	@/usr/include/bits/setjmp2.h

19 #i‚de‡
_SETJMP_H


24 #ifde‡
__REDIRECT_NTH


25 
__REDIRECT_NTHNL
 (
l⁄gjmp
,

26 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
),

27 
__l⁄gjmp_chk
Ë
__©åibuã__
 ((
__n‹ëu∫__
));

28 
__REDIRECT_NTHNL
 (
_l⁄gjmp
,

29 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
),

30 
__l⁄gjmp_chk
Ë
__©åibuã__
 ((
__n‹ëu∫__
));

31 
__REDIRECT_NTHNL
 (
sigl⁄gjmp
,

32 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
),

33 
__l⁄gjmp_chk
Ë
__©åibuã__
 ((
__n‹ëu∫__
));

35 
__l⁄gjmp_chk
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
),

36 
__THROWNL
 
__©åibuã__
 ((
__n‹ëu∫__
));

37 
	#l⁄gjmp
 
__l⁄gjmp_chk


	)

38 
	#_l⁄gjmp
 
__l⁄gjmp_chk


	)

39 
	#sigl⁄gjmp
 
__l⁄gjmp_chk


	)

	@/usr/include/bits/sigaction.h

19 #i‚de‡
_SIGNAL_H


24 
	ssiga˘i⁄


27 #ifde‡
__USE_POSIX199309


31 
__sigh™dÀr_t
 
	mß_h™dÀr
;

33 (*
	mß_siga˘i⁄
Ë(, 
	msigöfo_t
 *, *);

35 
	m__siga˘i⁄_h™dÀr
;

36 
	#ß_h™dÀr
 
__siga˘i⁄_h™dÀr
.
ß_h™dÀr


	)

37 
	#ß_siga˘i⁄
 
__siga˘i⁄_h™dÀr
.
ß_siga˘i⁄


	)

39 
__sigh™dÀr_t
 
	mß_h™dÀr
;

43 
__sig£t_t
 
	mß_mask
;

46 
	mß_Êags
;

49 (*
	mß_ª°‹î
) ();

53 
	#SA_NOCLDSTOP
 1

	)

54 
	#SA_NOCLDWAIT
 2

	)

55 
	#SA_SIGINFO
 4

	)

57 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_MISC


58 
	#SA_ONSTACK
 0x08000000

	)

60 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN2K8


61 
	#SA_RESTART
 0x10000000

	)

62 
	#SA_NODEFER
 0x40000000

	)

64 
	#SA_RESETHAND
 0x80000000

	)

66 #ifde‡
__USE_MISC


67 
	#SA_INTERRUPT
 0x20000000

	)

70 
	#SA_NOMASK
 
SA_NODEFER


	)

71 
	#SA_ONESHOT
 
SA_RESETHAND


	)

72 
	#SA_STACK
 
SA_ONSTACK


	)

76 
	#SIG_BLOCK
 0

	)

77 
	#SIG_UNBLOCK
 1

	)

78 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

18 #i‚de‡
_BITS_SIGCONTEXT_H


19 
	#_BITS_SIGCONTEXT_H
 1

	)

21 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
_SYS_UCONTEXT_H


25 
	#FP_XSTATE_MAGIC1
 0x46505853U

	)

26 
	#FP_XSTATE_MAGIC2
 0x46505845U

	)

27 
	#FP_XSTATE_MAGIC2_SIZE
 (
FP_XSTATE_MAGIC2
)

	)

29 
	s_Âx_sw_byãs


31 
__uöt32_t
 
	mmagic1
;

32 
__uöt32_t
 
	mexãnded_size
;

33 
__uöt64_t
 
	mx°©e_bv
;

34 
__uöt32_t
 
	mx°©e_size
;

35 
__uöt32_t
 
	m∑ddög
[7];

38 
	s_Âªg


40 
	msignifiˇnd
[4];

41 
	mexp⁄ít
;

44 
	s_Âxªg


46 
	msignifiˇnd
[4];

47 
	mexp⁄ít
;

48 
	m∑ddög
[3];

51 
	s_xmmªg


53 
__uöt32_t
 
	mñemít
[4];

58 #i‚de‡
__x86_64__


60 
	s_Â°©e


63 
__uöt32_t
 
	mcw
;

64 
__uöt32_t
 
	msw
;

65 
__uöt32_t
 
	mèg
;

66 
__uöt32_t
 
	mùoff
;

67 
__uöt32_t
 
	mcs£l
;

68 
__uöt32_t
 
	md©aoff
;

69 
__uöt32_t
 
	md©a£l
;

70 
_Âªg
 
	m_°
[8];

71 
	m°©us
;

72 
	mmagic
;

75 
__uöt32_t
 
	m_fx§_ív
[6];

76 
__uöt32_t
 
	mmxc§
;

77 
__uöt32_t
 
	mª£rved
;

78 
_Âxªg
 
	m_fx§_°
[8];

79 
_xmmªg
 
	m_xmm
[8];

80 
__uöt32_t
 
	m∑ddög
[56];

83 #i‚de‡
sigc⁄ãxt_°ru˘


88 
	#sigc⁄ãxt_°ru˘
 
sigc⁄ãxt


	)

91 
	#X86_FXSR_MAGIC
 0x0000

	)

93 
	ssigc⁄ãxt


95 
	mgs
, 
	m__gsh
;

96 
	mfs
, 
	m__fsh
;

97 
	mes
, 
	m__esh
;

98 
	mds
, 
	m__dsh
;

99 
	medi
;

100 
	mesi
;

101 
	mebp
;

102 
	me•
;

103 
	mebx
;

104 
	medx
;

105 
	mecx
;

106 
	móx
;

107 
	må≠no
;

108 
	mîr
;

109 
	meù
;

110 
	mcs
, 
	m__csh
;

111 
	meÊags
;

112 
	me•_©_sig«l
;

113 
	mss
, 
	m__ssh
;

114 
_Â°©e
 * 
	mÂ°©e
;

115 
	mﬁdmask
;

116 
	m¸2
;

121 
	s_Â°©e


124 
__uöt16_t
 
	mcwd
;

125 
__uöt16_t
 
	mswd
;

126 
__uöt16_t
 
	m·w
;

127 
__uöt16_t
 
	mf›
;

128 
__uöt64_t
 
	mrù
;

129 
__uöt64_t
 
	mrdp
;

130 
__uöt32_t
 
	mmxc§
;

131 
__uöt32_t
 
	mmx¸_mask
;

132 
_Âxªg
 
	m_°
[8];

133 
_xmmªg
 
	m_xmm
[16];

134 
__uöt32_t
 
	m∑ddög
[24];

137 
	ssigc⁄ãxt


139 
__uöt64_t
 
	mr8
;

140 
__uöt64_t
 
	mr9
;

141 
__uöt64_t
 
	mr10
;

142 
__uöt64_t
 
	mr11
;

143 
__uöt64_t
 
	mr12
;

144 
__uöt64_t
 
	mr13
;

145 
__uöt64_t
 
	mr14
;

146 
__uöt64_t
 
	mr15
;

147 
__uöt64_t
 
	mrdi
;

148 
__uöt64_t
 
	mrsi
;

149 
__uöt64_t
 
	mrbp
;

150 
__uöt64_t
 
	mrbx
;

151 
__uöt64_t
 
	mrdx
;

152 
__uöt64_t
 
	møx
;

153 
__uöt64_t
 
	mrcx
;

154 
__uöt64_t
 
	mr•
;

155 
__uöt64_t
 
	mrù
;

156 
__uöt64_t
 
	meÊags
;

157 
	mcs
;

158 
	mgs
;

159 
	mfs
;

160 
	m__∑d0
;

161 
__uöt64_t
 
	mîr
;

162 
__uöt64_t
 
	må≠no
;

163 
__uöt64_t
 
	mﬁdmask
;

164 
__uöt64_t
 
	m¸2
;

165 
__exãnsi⁄__
 union

167 
_Â°©e
 * 
	mÂ°©e
;

168 
__uöt64_t
 
	m__Â°©e_w‹d
;

170 
__uöt64_t
 
	m__ª£rved1
 [8];

175 
	s_xßve_hdr


177 
__uöt64_t
 
	mx°©e_bv
;

178 
__uöt64_t
 
	mª£rved1
[2];

179 
__uöt64_t
 
	mª£rved2
[5];

182 
	s_ymmh_°©e


184 
__uöt32_t
 
	mymmh_•a˚
[64];

187 
	s_x°©e


189 
_Â°©e
 
	mÂ°©e
;

190 
_xßve_hdr
 
	mx°©e_hdr
;

191 
_ymmh_°©e
 
	mymmh
;

	@/usr/include/bits/siginfo.h

19 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
__√ed_sigöfo_t
 \

20 && !
deföed
 
	g__√ed_sigevít_t


24 
	~<bôs/w‹dsize.h
>

26 #i‡(!
deföed
 
__have_sigvÆ_t
 \

27 && (
deföed
 
	g_SIGNAL_H
 || deföed 
	g__√ed_sigöfo_t
 \

28 || 
deföed
 
	g__√ed_sigevít_t
))

29 
	#__have_sigvÆ_t
 1

	)

32 
	usigvÆ


34 
	msivÆ_öt
;

35 *
	msivÆ_±r
;

36 } 
	tsigvÆ_t
;

39 #i‡(!
deföed
 
__have_sigöfo_t
 \

40 && (
deföed
 
	g_SIGNAL_H
 || deföed 
	g__√ed_sigöfo_t
))

41 
	#__have_sigöfo_t
 1

	)

43 
	#__SI_MAX_SIZE
 128

	)

44 #i‡
__WORDSIZE
 == 64

45 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()Ë- 4)

	)

47 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()Ë- 3)

	)

50 #i‡
deföed
 
__x86_64__
 && 
__WORDSIZE
 == 32

55 
__˛ock_t
 
	t__©åibuã__
 ((
	t__Æig√d__
 (4))Ë
	t__sigchld_˛ock_t
;

56 
	#__SI_ALIGNMENT
 
	`__©åibuã__
 ((
	`__Æig√d__
 (8)))

	)

58 
__˛ock_t
 
	t__sigchld_˛ock_t
;

59 
	#__SI_ALIGNMENT


	)

64 
si_signo
;

65 
si_î∫o
;

67 
si_code
;

71 
_∑d
[
__SI_PAD_SIZE
];

76 
__pid_t
 
si_pid
;

77 
__uid_t
 
si_uid
;

78 } 
_kûl
;

83 
si_tid
;

84 
si_ovîrun
;

85 
sigvÆ_t
 
si_sigvÆ
;

86 } 
_timî
;

91 
__pid_t
 
si_pid
;

92 
__uid_t
 
si_uid
;

93 
sigvÆ_t
 
si_sigvÆ
;

94 } 
_π
;

99 
__pid_t
 
si_pid
;

100 
__uid_t
 
si_uid
;

101 
si_°©us
;

102 
__sigchld_˛ock_t
 
si_utime
;

103 
__sigchld_˛ock_t
 
si_°ime
;

104 } 
_sigchld
;

109 *
si_addr
;

110 } 
_sigÁu…
;

115 
si_b™d
;

116 
si_fd
;

117 } 
_sigpﬁl
;

122 *
_ˇŒ_addr
;

123 
_sysˇŒ
;

124 
_¨ch
;

125 } 
_sigsys
;

126 } 
_sifõlds
;

127 } 
	tsigöfo_t
 
	t__SI_ALIGNMENT
;

131 
	#si_pid
 
_sifõlds
.
_kûl
.
si_pid


	)

132 
	#si_uid
 
_sifõlds
.
_kûl
.
si_uid


	)

133 
	#si_timîid
 
_sifõlds
.
_timî
.
si_tid


	)

134 
	#si_ovîrun
 
_sifõlds
.
_timî
.
si_ovîrun


	)

135 
	#si_°©us
 
_sifõlds
.
_sigchld
.
si_°©us


	)

136 
	#si_utime
 
_sifõlds
.
_sigchld
.
si_utime


	)

137 
	#si_°ime
 
_sifõlds
.
_sigchld
.
si_°ime


	)

138 
	#si_vÆue
 
_sifõlds
.
_π
.
si_sigvÆ


	)

139 
	#si_öt
 
_sifõlds
.
_π
.
si_sigvÆ
.
sivÆ_öt


	)

140 
	#si_±r
 
_sifõlds
.
_π
.
si_sigvÆ
.
sivÆ_±r


	)

141 
	#si_addr
 
_sifõlds
.
_sigÁu…
.
si_addr


	)

142 
	#si_b™d
 
_sifõlds
.
_sigpﬁl
.
si_b™d


	)

143 
	#si_fd
 
_sifõlds
.
_sigpﬁl
.
si_fd


	)

144 
	#si_ˇŒ_addr
 
_sifõlds
.
_sigsys
.
_ˇŒ_addr


	)

145 
	#si_sysˇŒ
 
_sifõlds
.
_sigsys
.
_sysˇŒ


	)

146 
	#si_¨ch
 
_sifõlds
.
_sigsys
.
_¨ch


	)

153 
SI_ASYNCNL
 = -60,

154 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

155 
SI_TKILL
 = -6,

156 
	#SI_TKILL
 
SI_TKILL


	)

157 
SI_SIGIO
,

158 
	#SI_SIGIO
 
SI_SIGIO


	)

159 
SI_ASYNCIO
,

160 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

161 
SI_MESGQ
,

162 
	#SI_MESGQ
 
SI_MESGQ


	)

163 
SI_TIMER
,

164 
	#SI_TIMER
 
SI_TIMER


	)

165 
SI_QUEUE
,

166 
	#SI_QUEUE
 
SI_QUEUE


	)

167 
SI_USER
,

168 
	#SI_USER
 
SI_USER


	)

169 
SI_KERNEL
 = 0x80

170 
	#SI_KERNEL
 
SI_KERNEL


	)

177 
ILL_ILLOPC
 = 1,

178 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

179 
ILL_ILLOPN
,

180 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

181 
ILL_ILLADR
,

182 
	#ILL_ILLADR
 
ILL_ILLADR


	)

183 
ILL_ILLTRP
,

184 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

185 
ILL_PRVOPC
,

186 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

187 
ILL_PRVREG
,

188 
	#ILL_PRVREG
 
ILL_PRVREG


	)

189 
ILL_COPROC
,

190 
	#ILL_COPROC
 
ILL_COPROC


	)

191 
ILL_BADSTK


192 
	#ILL_BADSTK
 
ILL_BADSTK


	)

198 
FPE_INTDIV
 = 1,

199 
	#FPE_INTDIV
 
FPE_INTDIV


	)

200 
FPE_INTOVF
,

201 
	#FPE_INTOVF
 
FPE_INTOVF


	)

202 
FPE_FLTDIV
,

203 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

204 
FPE_FLTOVF
,

205 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

206 
FPE_FLTUND
,

207 
	#FPE_FLTUND
 
FPE_FLTUND


	)

208 
FPE_FLTRES
,

209 
	#FPE_FLTRES
 
FPE_FLTRES


	)

210 
FPE_FLTINV
,

211 
	#FPE_FLTINV
 
FPE_FLTINV


	)

212 
FPE_FLTSUB


213 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

219 
SEGV_MAPERR
 = 1,

220 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

221 
SEGV_ACCERR


222 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

228 
BUS_ADRALN
 = 1,

229 
	#BUS_ADRALN
 
BUS_ADRALN


	)

230 
BUS_ADRERR
,

231 
	#BUS_ADRERR
 
BUS_ADRERR


	)

232 
BUS_OBJERR


233 
	#BUS_OBJERR
 
BUS_OBJERR


	)

239 
TRAP_BRKPT
 = 1,

240 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

241 
TRAP_TRACE


242 
	#TRAP_TRACE
 
TRAP_TRACE


	)

248 
CLD_EXITED
 = 1,

249 
	#CLD_EXITED
 
CLD_EXITED


	)

250 
CLD_KILLED
,

251 
	#CLD_KILLED
 
CLD_KILLED


	)

252 
CLD_DUMPED
,

253 
	#CLD_DUMPED
 
CLD_DUMPED


	)

254 
CLD_TRAPPED
,

255 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

256 
CLD_STOPPED
,

257 
	#CLD_STOPPED
 
CLD_STOPPED


	)

258 
CLD_CONTINUED


259 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

265 
POLL_IN
 = 1,

266 
	#POLL_IN
 
POLL_IN


	)

267 
POLL_OUT
,

268 
	#POLL_OUT
 
POLL_OUT


	)

269 
POLL_MSG
,

270 
	#POLL_MSG
 
POLL_MSG


	)

271 
POLL_ERR
,

272 
	#POLL_ERR
 
POLL_ERR


	)

273 
POLL_PRI
,

274 
	#POLL_PRI
 
POLL_PRI


	)

275 
POLL_HUP


276 
	#POLL_HUP
 
POLL_HUP


	)

279 #unde‡
__√ed_sigöfo_t


283 #i‡(
deföed
 
_SIGNAL_H
 || deföed 
__√ed_sigevít_t
) \

284 && !
deföed
 
__have_sigevít_t


285 
	#__have_sigevít_t
 1

	)

288 
	#__SIGEV_MAX_SIZE
 64

	)

289 #i‡
__WORDSIZE
 == 64

290 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()Ë- 4)

	)

292 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()Ë- 3)

	)

296 #i‚de‡
__have_±hªad_©å_t


297 
±hªad_©å_t
 
	t±hªad_©å_t
;

298 
	#__have_±hªad_©å_t
 1

	)

301 
	ssigevít


303 
sigvÆ_t
 
sigev_vÆue
;

304 
sigev_signo
;

305 
sigev_nŸify
;

309 
_∑d
[
__SIGEV_PAD_SIZE
];

313 
__pid_t
 
_tid
;

317 (*
_fun˘i⁄
Ë(
sigvÆ_t
);

318 
±hªad_©å_t
 *
_©åibuã
;

319 } 
_sigev_thªad
;

320 } 
_sigev_un
;

321 } 
	tsigevít_t
;

324 
	#sigev_nŸify_fun˘i⁄
 
_sigev_un
.
_sigev_thªad
.
_fun˘i⁄


	)

325 
	#sigev_nŸify_©åibuãs
 
_sigev_un
.
_sigev_thªad
.
_©åibuã


	)

330 
SIGEV_SIGNAL
 = 0,

331 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

332 
SIGEV_NONE
,

333 
	#SIGEV_NONE
 
SIGEV_NONE


	)

334 
SIGEV_THREAD
,

335 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

337 
SIGEV_THREAD_ID
 = 4

338 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

19 #ifdef 
_SIGNAL_H


22 
	#SIG_ERR
 ((
__sigh™dÀr_t
Ë-1Ë

	)

23 
	#SIG_DFL
 ((
__sigh™dÀr_t
Ë0Ë

	)

24 
	#SIG_IGN
 ((
__sigh™dÀr_t
Ë1Ë

	)

26 #ifde‡
__USE_UNIX98


27 
	#SIG_HOLD
 ((
__sigh™dÀr_t
Ë2Ë

	)

32 
	#SIGHUP
 1

	)

33 
	#SIGINT
 2

	)

34 
	#SIGQUIT
 3

	)

35 
	#SIGILL
 4

	)

36 
	#SIGTRAP
 5

	)

37 
	#SIGABRT
 6

	)

38 
	#SIGIOT
 6

	)

39 
	#SIGBUS
 7

	)

40 
	#SIGFPE
 8

	)

41 
	#SIGKILL
 9

	)

42 
	#SIGUSR1
 10

	)

43 
	#SIGSEGV
 11

	)

44 
	#SIGUSR2
 12

	)

45 
	#SIGPIPE
 13

	)

46 
	#SIGALRM
 14

	)

47 
	#SIGTERM
 15

	)

48 
	#SIGSTKFLT
 16

	)

49 
	#SIGCLD
 
SIGCHLD


	)

50 
	#SIGCHLD
 17

	)

51 
	#SIGCONT
 18

	)

52 
	#SIGSTOP
 19

	)

53 
	#SIGTSTP
 20

	)

54 
	#SIGTTIN
 21

	)

55 
	#SIGTTOU
 22

	)

56 
	#SIGURG
 23

	)

57 
	#SIGXCPU
 24

	)

58 
	#SIGXFSZ
 25

	)

59 
	#SIGVTALRM
 26

	)

60 
	#SIGPROF
 27

	)

61 
	#SIGWINCH
 28

	)

62 
	#SIGPOLL
 
SIGIO


	)

63 
	#SIGIO
 29

	)

64 
	#SIGPWR
 30

	)

65 
	#SIGSYS
 31

	)

66 
	#SIGUNUSED
 31

	)

68 
	#_NSIG
 65

	)

71 
	#SIGRTMIN
 (
	`__libc_cuºít_sigπmö
 ())

	)

72 
	#SIGRTMAX
 (
	`__libc_cuºít_sigπmax
 ())

	)

76 
	#__SIGRTMIN
 32

	)

77 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigset.h

20 #i‚def 
_SIGSET_H_ty≥s


21 
	#_SIGSET_H_ty≥s
 1

	)

23 
	t__sig_©omic_t
;

27 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

30 
	m__vÆ
[
_SIGSET_NWORDS
];

31 } 
	t__sig£t_t
;

42 #i‡!
deföed
 
_SIGSET_H_‚s
 && deföed 
_SIGNAL_H


43 
	#_SIGSET_H_‚s
 1

	)

45 #i‚de‡
_EXTERN_INLINE


46 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

50 
	#__sigmask
(
sig
) \

51 (((Ë1Ë<< (((
sig
Ë- 1Ë% (8 *  ())))

	)

54 
	#__sigw‹d
(
sig
Ë(((sigË- 1Ë/ (8 *  ()))

	)

56 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

57 
	#__sigem±y£t
(
£t
) \

58 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

59 
sig£t_t
 *
__£t
 = (
£t
); \

60 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = 0; \

61 0; }))

	)

62 
	#__sigfûl£t
(
£t
) \

63 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

64 
sig£t_t
 *
__£t
 = (
£t
); \

65 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = ~0UL; \

66 0; }))

	)

68 #ifde‡
__USE_GNU


72 
	#__sigi£m±y£t
(
£t
) \

73 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

74 c⁄° 
sig£t_t
 *
__£t
 = (
£t
); \

75 
__ªt
 = 
__£t
->
__vÆ
[--
__˙t
]; \

76 !
__ªt
 && --
__˙t
 >= 0) \

77 
__ªt
 = 
__£t
->
__vÆ
[
__˙t
]; \

78 
__ªt
 =0; }))

	)

79 
	#__sig™d£t
(
de°
, 
À·
, 
right
) \

80 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

81 
sig£t_t
 *
__de°
 = (
de°
); \

82 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

83 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

84 --
__˙t
 >= 0) \

85 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

86 & 
__right
->
__vÆ
[
__˙t
]); \

87 0; }))

	)

88 
	#__sig‹£t
(
de°
, 
À·
, 
right
) \

89 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

90 
sig£t_t
 *
__de°
 = (
de°
); \

91 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

92 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

93 --
__˙t
 >= 0) \

94 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

95 | 
__right
->
__vÆ
[
__˙t
]); \

96 0; }))

	)

103 
__sigismembî
 (c⁄° 
__sig£t_t
 *, );

104 
__sigadd£t
 (
__sig£t_t
 *, );

105 
__sigdñ£t
 (
__sig£t_t
 *, );

107 #ifde‡
__USE_EXTERN_INLINES


108 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

109 
_EXTERN_INLINE
 \

110 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

112 
__mask
 = 
	`__sigmask
 (
__sig
); \

113 
__w‹d
 = 
	`__sigw‹d
 (
__sig
); \

114  
BODY
; \

115 }

	)

117 
__SIGSETFN
 (
__sigismembî
, (
__£t
->
__vÆ
[
__w‹d
] & 
__mask
) ? 1 : 0, const)

118 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__vÆ
[
__w‹d
] |
__mask
), 0), )

119 
__SIGSETFN
 (
__sigdñ£t
, ((
__£t
->
__vÆ
[
__w‹d
] &~
__mask
), 0), )

121 #unde‡
__SIGSETFN


	@/usr/include/bits/sigstack.h

19 #i‚de‡
_SIGNAL_H


25 
	ssig°ack


27 *
	mss_•
;

28 
	mss_⁄°ack
;

35 
	mSS_ONSTACK
 = 1,

36 
	#SS_ONSTACK
 
SS_ONSTACK


	)

37 
	mSS_DISABLE


38 
	#SS_DISABLE
 
SS_DISABLE


	)

42 
	#MINSIGSTKSZ
 2048

	)

45 
	#SIGSTKSZ
 8192

	)

49 
	ssigÆt°ack


51 *
	mss_•
;

52 
	mss_Êags
;

53 
size_t
 
	mss_size
;

54 } 
	t°ack_t
;

	@/usr/include/bits/sigthread.h

19 #i‚de‡
_BITS_SIGTHREAD_H


20 
	#_BITS_SIGTHREAD_H
 1

	)

22 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
_PTHREAD_H


30 
	$±hªad_sigmask
 (
__how
,

31 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__√wmask
,

32 
__sig£t_t
 *
__ª°ri˘
 
__ﬁdmask
)
__THROW
;

35 
	$±hªad_kûl
 (
±hªad_t
 
__thªadid
, 
__signo
Ë
__THROW
;

37 #ifde‡
__USE_GNU


39 
	$±hªad_sigqueue
 (
±hªad_t
 
__thªadid
, 
__signo
,

40 c⁄° 
sigvÆ
 
__vÆue
Ë
__THROW
;

	@/usr/include/bits/sockaddr.h

23 #i‚de‡
_BITS_SOCKADDR_H


24 
	#_BITS_SOCKADDR_H
 1

	)

28 
	tß_Ámûy_t
;

34 
	#__SOCKADDR_COMMON
(
ß_¥efix
) \

35 
ß_Ámûy_t
 
ß_¥efix
##
Ámûy


	)

37 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

40 
	#_SS_SIZE
 128

	)

	@/usr/include/bits/socket.h

20 #i‚de‡
__BITS_SOCKET_H


21 
	#__BITS_SOCKET_H


	)

23 #i‚de‡
_SYS_SOCKET_H


27 
	#__√ed_size_t


	)

28 
	~<°ddef.h
>

30 
	~<sys/ty≥s.h
>

33 #i‚de‡
__sockÀn_t_deföed


34 
__sockÀn_t
 
	tsockÀn_t
;

35 
	#__sockÀn_t_deföed


	)

39 
	~<bôs/sockë_ty≥.h
>

42 
	#PF_UNSPEC
 0

	)

43 
	#PF_LOCAL
 1

	)

44 
	#PF_UNIX
 
PF_LOCAL


	)

45 
	#PF_FILE
 
PF_LOCAL


	)

46 
	#PF_INET
 2

	)

47 
	#PF_AX25
 3

	)

48 
	#PF_IPX
 4

	)

49 
	#PF_APPLETALK
 5

	)

50 
	#PF_NETROM
 6

	)

51 
	#PF_BRIDGE
 7

	)

52 
	#PF_ATMPVC
 8

	)

53 
	#PF_X25
 9

	)

54 
	#PF_INET6
 10

	)

55 
	#PF_ROSE
 11

	)

56 
	#PF_DEC√t
 12

	)

57 
	#PF_NETBEUI
 13

	)

58 
	#PF_SECURITY
 14

	)

59 
	#PF_KEY
 15

	)

60 
	#PF_NETLINK
 16

	)

61 
	#PF_ROUTE
 
PF_NETLINK


	)

62 
	#PF_PACKET
 17

	)

63 
	#PF_ASH
 18

	)

64 
	#PF_ECONET
 19

	)

65 
	#PF_ATMSVC
 20

	)

66 
	#PF_RDS
 21

	)

67 
	#PF_SNA
 22

	)

68 
	#PF_IRDA
 23

	)

69 
	#PF_PPPOX
 24

	)

70 
	#PF_WANPIPE
 25

	)

71 
	#PF_LLC
 26

	)

72 
	#PF_CAN
 29

	)

73 
	#PF_TIPC
 30

	)

74 
	#PF_BLUETOOTH
 31

	)

75 
	#PF_IUCV
 32

	)

76 
	#PF_RXRPC
 33

	)

77 
	#PF_ISDN
 34

	)

78 
	#PF_PHONET
 35

	)

79 
	#PF_IEEE802154
 36

	)

80 
	#PF_CAIF
 37

	)

81 
	#PF_ALG
 38

	)

82 
	#PF_NFC
 39

	)

83 
	#PF_VSOCK
 40

	)

84 
	#PF_MAX
 41

	)

87 
	#AF_UNSPEC
 
PF_UNSPEC


	)

88 
	#AF_LOCAL
 
PF_LOCAL


	)

89 
	#AF_UNIX
 
PF_UNIX


	)

90 
	#AF_FILE
 
PF_FILE


	)

91 
	#AF_INET
 
PF_INET


	)

92 
	#AF_AX25
 
PF_AX25


	)

93 
	#AF_IPX
 
PF_IPX


	)

94 
	#AF_APPLETALK
 
PF_APPLETALK


	)

95 
	#AF_NETROM
 
PF_NETROM


	)

96 
	#AF_BRIDGE
 
PF_BRIDGE


	)

97 
	#AF_ATMPVC
 
PF_ATMPVC


	)

98 
	#AF_X25
 
PF_X25


	)

99 
	#AF_INET6
 
PF_INET6


	)

100 
	#AF_ROSE
 
PF_ROSE


	)

101 
	#AF_DEC√t
 
PF_DEC√t


	)

102 
	#AF_NETBEUI
 
PF_NETBEUI


	)

103 
	#AF_SECURITY
 
PF_SECURITY


	)

104 
	#AF_KEY
 
PF_KEY


	)

105 
	#AF_NETLINK
 
PF_NETLINK


	)

106 
	#AF_ROUTE
 
PF_ROUTE


	)

107 
	#AF_PACKET
 
PF_PACKET


	)

108 
	#AF_ASH
 
PF_ASH


	)

109 
	#AF_ECONET
 
PF_ECONET


	)

110 
	#AF_ATMSVC
 
PF_ATMSVC


	)

111 
	#AF_RDS
 
PF_RDS


	)

112 
	#AF_SNA
 
PF_SNA


	)

113 
	#AF_IRDA
 
PF_IRDA


	)

114 
	#AF_PPPOX
 
PF_PPPOX


	)

115 
	#AF_WANPIPE
 
PF_WANPIPE


	)

116 
	#AF_LLC
 
PF_LLC


	)

117 
	#AF_CAN
 
PF_CAN


	)

118 
	#AF_TIPC
 
PF_TIPC


	)

119 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

120 
	#AF_IUCV
 
PF_IUCV


	)

121 
	#AF_RXRPC
 
PF_RXRPC


	)

122 
	#AF_ISDN
 
PF_ISDN


	)

123 
	#AF_PHONET
 
PF_PHONET


	)

124 
	#AF_IEEE802154
 
PF_IEEE802154


	)

125 
	#AF_CAIF
 
PF_CAIF


	)

126 
	#AF_ALG
 
PF_ALG


	)

127 
	#AF_NFC
 
PF_NFC


	)

128 
	#AF_VSOCK
 
PF_VSOCK


	)

129 
	#AF_MAX
 
PF_MAX


	)

135 
	#SOL_RAW
 255

	)

136 
	#SOL_DECNET
 261

	)

137 
	#SOL_X25
 262

	)

138 
	#SOL_PACKET
 263

	)

139 
	#SOL_ATM
 264

	)

140 
	#SOL_AAL
 265

	)

141 
	#SOL_IRDA
 266

	)

144 
	#SOMAXCONN
 128

	)

147 
	~<bôs/sockaddr.h
>

150 
	ssockaddr


152 
__SOCKADDR_COMMON
 (
ß_
);

153 
	mß_d©a
[14];

159 
	#__ss_Æig¡y≥
 

	)

160 
	#_SS_PADSIZE
 \

161 (
_SS_SIZE
 - 
__SOCKADDR_COMMON_SIZE
 -  (
__ss_Æig¡y≥
))

	)

163 
	ssockaddr_°‹age


165 
__SOCKADDR_COMMON
 (
ss_
);

166 
	m__ss_∑ddög
[
_SS_PADSIZE
];

167 
__ss_Æig¡y≥
 
	m__ss_Æign
;

174 
	mMSG_OOB
 = 0x01,

175 
	#MSG_OOB
 
MSG_OOB


	)

176 
	mMSG_PEEK
 = 0x02,

177 
	#MSG_PEEK
 
MSG_PEEK


	)

178 
	mMSG_DONTROUTE
 = 0x04,

179 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

180 #ifde‡
__USE_GNU


182 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

183 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

185 
	mMSG_CTRUNC
 = 0x08,

186 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

187 
	mMSG_PROXY
 = 0x10,

188 
	#MSG_PROXY
 
MSG_PROXY


	)

189 
	mMSG_TRUNC
 = 0x20,

190 
	#MSG_TRUNC
 
MSG_TRUNC


	)

191 
	mMSG_DONTWAIT
 = 0x40,

192 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

193 
	mMSG_EOR
 = 0x80,

194 
	#MSG_EOR
 
MSG_EOR


	)

195 
	mMSG_WAITALL
 = 0x100,

196 
	#MSG_WAITALL
 
MSG_WAITALL


	)

197 
	mMSG_FIN
 = 0x200,

198 
	#MSG_FIN
 
MSG_FIN


	)

199 
	mMSG_SYN
 = 0x400,

200 
	#MSG_SYN
 
MSG_SYN


	)

201 
	mMSG_CONFIRM
 = 0x800,

202 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

203 
	mMSG_RST
 = 0x1000,

204 
	#MSG_RST
 
MSG_RST


	)

205 
	mMSG_ERRQUEUE
 = 0x2000,

206 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

207 
	mMSG_NOSIGNAL
 = 0x4000,

208 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

209 
	mMSG_MORE
 = 0x8000,

210 
	#MSG_MORE
 
MSG_MORE


	)

211 
	mMSG_WAITFORONE
 = 0x10000,

212 
	#MSG_WAITFORONE
 
MSG_WAITFORONE


	)

213 
	mMSG_FASTOPEN
 = 0x20000000,

214 
	#MSG_FASTOPEN
 
MSG_FASTOPEN


	)

216 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

219 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

225 
	smsghdr


227 *
	mmsg_«me
;

228 
sockÀn_t
 
	mmsg_«mñí
;

230 
iovec
 *
	mmsg_iov
;

231 
size_t
 
	mmsg_iovÀn
;

233 *
	mmsg_c⁄åﬁ
;

234 
size_t
 
	mmsg_c⁄åﬁÀn
;

239 
	mmsg_Êags
;

243 
	scmsghdr


245 
size_t
 
	mcmsg_Àn
;

250 
	mcmsg_Àvñ
;

251 
	mcmsg_ty≥
;

252 #i‡(!
deföed
 
__STRICT_ANSI__
 && 
__GNUC__
 >2Ë|| 
__STDC_VERSION__
 >= 199901L

253 
__exãnsi⁄__
 
__cmsg_d©a
 
	m__Êex¨r
;

258 #i‡(!
deföed
 
__STRICT_ANSI__
 && 
__GNUC__
 >2Ë|| 
__STDC_VERSION__
 >= 199901L

259 
	#CMSG_DATA
(
cmsg
Ë((cmsg)->
__cmsg_d©a
)

	)

261 
	#CMSG_DATA
(
cmsg
Ë((*Ë((
cmsghdr
 *Ë(cmsgË+ 1))

	)

263 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
Ë
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

264 
	#CMSG_FIRSTHDR
(
mhdr
) \

265 ((
size_t
Ë(
mhdr
)->
msg_c⁄åﬁÀn
 > (
cmsghdr
) \

266 ? (
cmsghdr
 *Ë(
mhdr
)->
msg_c⁄åﬁ
 : (cmsghd∏*Ë0)

	)

267 
	#CMSG_ALIGN
(
Àn
Ë((÷íË+  (
size_t
) - 1) \

268 & (
size_t
Ë~( (size_tË- 1))

	)

269 
	#CMSG_SPACE
(
Àn
Ë(
	`CMSG_ALIGN
 (len) \

270 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

271 
	#CMSG_LEN
(
Àn
Ë(
	`CMSG_ALIGN
 ( (
cmsghdr
)Ë+ (Àn))

	)

273 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

274 
cmsghdr
 *
__cmsg
Ë
__THROW
;

275 #ifde‡
__USE_EXTERN_INLINES


276 #i‚de‡
_EXTERN_INLINE


277 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

279 
_EXTERN_INLINE
 
cmsghdr
 *

280 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

282 i‡((
size_t
Ë
__cmsg
->
cmsg_Àn
 <  (
cmsghdr
))

284  (
cmsghdr
 *) 0;

286 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

287 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Àn
));

288 i‡((*Ë(
__cmsg
 + 1Ë> ((*Ë
__mhdr
->
msg_c⁄åﬁ


289 + 
__mhdr
->
msg_c⁄åﬁÀn
)

290 || ((*Ë
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Àn
)

291 > ((*Ë
__mhdr
->
msg_c⁄åﬁ
 + __mhdr->
msg_c⁄åﬁÀn
)))

293  (
cmsghdr
 *) 0;

294  
__cmsg
;

295 
	}
}

302 
	mSCM_RIGHTS
 = 0x01

303 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

304 #ifde‡
__USE_GNU


305 , 
	mSCM_CREDENTIALS
 = 0x02

306 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

310 #ifde‡
__USE_GNU


312 
	su¸ed


314 
pid_t
 
	mpid
;

315 
uid_t
 
	muid
;

316 
gid_t
 
	mgid
;

321 #i‡!
deföed
 
__USE_MISC
 && !deföed 
__USE_GNU


322 #i‚de‡
FIOGETOWN


323 
	#__SYS_SOCKET_H_undef_FIOGETOWN


	)

325 #i‚de‡
FIOSETOWN


326 
	#__SYS_SOCKET_H_undef_FIOSETOWN


	)

328 #i‚de‡
SIOCATMARK


329 
	#__SYS_SOCKET_H_undef_SIOCATMARK


	)

331 #i‚de‡
SIOCGPGRP


332 
	#__SYS_SOCKET_H_undef_SIOCGPGRP


	)

334 #i‚de‡
SIOCGSTAMP


335 
	#__SYS_SOCKET_H_undef_SIOCGSTAMP


	)

337 #i‚de‡
SIOCGSTAMPNS


338 
	#__SYS_SOCKET_H_undef_SIOCGSTAMPNS


	)

340 #i‚de‡
SIOCSPGRP


341 
	#__SYS_SOCKET_H_undef_SIOCSPGRP


	)

346 
	~<asm/sockë.h
>

348 #i‡!
deföed
 
__USE_MISC
 && !deföed 
__USE_GNU


349 #ifde‡
__SYS_SOCKET_H_undef_FIOGETOWN


350 #unde‡
__SYS_SOCKET_H_undef_FIOGETOWN


351 #unde‡
FIOGETOWN


353 #ifde‡
__SYS_SOCKET_H_undef_FIOSETOWN


354 #unde‡
__SYS_SOCKET_H_undef_FIOSETOWN


355 #unde‡
FIOSETOWN


357 #ifde‡
__SYS_SOCKET_H_undef_SIOCATMARK


358 #unde‡
__SYS_SOCKET_H_undef_SIOCATMARK


359 #unde‡
SIOCATMARK


361 #ifde‡
__SYS_SOCKET_H_undef_SIOCGPGRP


362 #unde‡
__SYS_SOCKET_H_undef_SIOCGPGRP


363 #unde‡
SIOCGPGRP


365 #ifde‡
__SYS_SOCKET_H_undef_SIOCGSTAMP


366 #unde‡
__SYS_SOCKET_H_undef_SIOCGSTAMP


367 #unde‡
SIOCGSTAMP


369 #ifde‡
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


370 #unde‡
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


371 #unde‡
SIOCGSTAMPNS


373 #ifde‡
__SYS_SOCKET_H_undef_SIOCSPGRP


374 #unde‡
__SYS_SOCKET_H_undef_SIOCSPGRP


375 #unde‡
SIOCSPGRP


380 
	slögî


382 
	ml_⁄off
;

383 
	ml_lögî
;

	@/usr/include/bits/socket2.h

19 #i‚de‡
_SYS_SOCKET_H


23 
ssize_t
 
__ªcv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_à
__buÊí
,

24 
__Êags
);

25 
ssize_t
 
__REDIRECT
 (
__ªcv_Æüs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

26 
__Êags
), 
ªcv
);

27 
ssize_t
 
__REDIRECT
 (
__ªcv_chk_w¨n
,

28 (
__fd
, *
__buf
, 
size_t
 
__n
, size_à
__buÊí
,

29 
__Êags
), 
__ªcv_chk
)

30 
__w¨«âr
 ("recv called with biggerÜengthÅhan size of destination "

33 
__f‹tify_fun˘i⁄
 
ssize_t


34 
	$ªcv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__Êags
)

36 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

38 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

39  
	`__ªcv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
);

41 i‡(
__n
 > 
	`__bos0
 (
__buf
))

42  
	`__ªcv_chk_w¨n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
);

44  
	`__ªcv_Æüs
 (
__fd
, 
__buf
, 
__n
, 
__Êags
);

45 
	}
}

47 
ssize_t
 
__ªcv‰om_chk
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

48 
size_t
 
__buÊí
, 
__Êags
,

49 
__SOCKADDR_ARG
 
__addr
,

50 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

51 
ssize_t
 
__REDIRECT
 (
__ªcv‰om_Æüs
,

52 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

53 
__Êags
, 
__SOCKADDR_ARG
 
__addr
,

54 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
), 
ªcv‰om
);

55 
ssize_t
 
__REDIRECT
 (
__ªcv‰om_chk_w¨n
,

56 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

57 
size_t
 
__buÊí
, 
__Êags
,

58 
__SOCKADDR_ARG
 
__addr
,

59 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
), 
__ªcv‰om_chk
)

60 
__w¨«âr
 ("recvfrom called with biggerÜengthÅhan size of "

63 
__f‹tify_fun˘i⁄
 
ssize_t


64 
	$ªcv‰om
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
, 
__Êags
,

65 
__SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
)

67 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

69 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

70  
	`__ªcv‰om_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
,

71 
__addr
, 
__addr_Àn
);

72 i‡(
__n
 > 
	`__bos0
 (
__buf
))

73  
	`__ªcv‰om_chk_w¨n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
,

74 
__addr
, 
__addr_Àn
);

76  
	`__ªcv‰om_Æüs
 (
__fd
, 
__buf
, 
__n
, 
__Êags
, 
__addr
, 
__addr_Àn
);

77 
	}
}

	@/usr/include/bits/stat.h

18 #i‡!
deföed
 
_SYS_STAT_H
 && !deföed 
_FCNTL_H


22 #i‚de‡
_BITS_STAT_H


23 
	#_BITS_STAT_H
 1

	)

26 #i‚de‡
__x86_64__


27 
	#_STAT_VER_LINUX_OLD
 1

	)

28 
	#_STAT_VER_KERNEL
 1

	)

29 
	#_STAT_VER_SVR4
 2

	)

30 
	#_STAT_VER_LINUX
 3

	)

33 
	#_MKNOD_VER_LINUX
 1

	)

34 
	#_MKNOD_VER_SVR4
 2

	)

35 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

37 
	#_STAT_VER_KERNEL
 0

	)

38 
	#_STAT_VER_LINUX
 1

	)

41 
	#_MKNOD_VER_LINUX
 0

	)

44 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

46 
	s°©


48 
__dev_t
 
	m°_dev
;

49 #i‚de‡
__x86_64__


50 
	m__∑d1
;

52 #i‡
deföed
 
__x86_64__
 || !deföed 
__USE_FILE_OFFSET64


53 
__öo_t
 
	m°_öo
;

55 
__öo_t
 
	m__°_öo
;

57 #i‚de‡
__x86_64__


58 
__mode_t
 
	m°_mode
;

59 
__∆ök_t
 
	m°_∆ök
;

61 
__∆ök_t
 
	m°_∆ök
;

62 
__mode_t
 
	m°_mode
;

64 
__uid_t
 
	m°_uid
;

65 
__gid_t
 
	m°_gid
;

66 #ifde‡
__x86_64__


67 
	m__∑d0
;

69 
__dev_t
 
	m°_rdev
;

70 #i‚de‡
__x86_64__


71 
	m__∑d2
;

73 #i‡
deföed
 
__x86_64__
 || !deföed 
__USE_FILE_OFFSET64


74 
__off_t
 
	m°_size
;

76 
__off64_t
 
	m°_size
;

78 
__blksize_t
 
	m°_blksize
;

79 #i‡
deföed
 
__x86_64__
 || !deföed 
__USE_FILE_OFFSET64


80 
__blk˙t_t
 
	m°_blocks
;

82 
__blk˙t64_t
 
	m°_blocks
;

84 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K8


91 
time•ec
 
	m°_©im
;

92 
time•ec
 
	m°_mtim
;

93 
time•ec
 
	m°_˘im
;

94 
	#°_©ime
 
°_©im
.
tv_£c


	)

95 
	#°_mtime
 
°_mtim
.
tv_£c


	)

96 
	#°_˘ime
 
°_˘im
.
tv_£c


	)

98 
__time_t
 
	m°_©ime
;

99 
__sysˇŒ_ul⁄g_t
 
	m°_©imí£c
;

100 
__time_t
 
	m°_mtime
;

101 
__sysˇŒ_ul⁄g_t
 
	m°_mtimí£c
;

102 
__time_t
 
	m°_˘ime
;

103 
__sysˇŒ_ul⁄g_t
 
	m°_˘imí£c
;

105 #ifde‡
__x86_64__


106 
__sysˇŒ_¶⁄g_t
 
	m__unu£d
[3];

108 #i‚de‡
__USE_FILE_OFFSET64


109 
	m__unu£d4
;

110 
	m__unu£d5
;

112 
__öo64_t
 
	m°_öo
;

117 #ifde‡
__USE_LARGEFILE64


119 
	s°©64


121 
__dev_t
 
	m°_dev
;

122 #ifde‡
__x86_64__


123 
__öo64_t
 
	m°_öo
;

124 
__∆ök_t
 
	m°_∆ök
;

125 
__mode_t
 
	m°_mode
;

127 
	m__∑d1
;

128 
__öo_t
 
	m__°_öo
;

129 
__mode_t
 
	m°_mode
;

130 
__∆ök_t
 
	m°_∆ök
;

132 
__uid_t
 
	m°_uid
;

133 
__gid_t
 
	m°_gid
;

134 #ifde‡
__x86_64__


135 
	m__∑d0
;

136 
__dev_t
 
	m°_rdev
;

137 
__off_t
 
	m°_size
;

139 
__dev_t
 
	m°_rdev
;

140 
	m__∑d2
;

141 
__off64_t
 
	m°_size
;

143 
__blksize_t
 
	m°_blksize
;

144 
__blk˙t64_t
 
	m°_blocks
;

145 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K8


152 
time•ec
 
	m°_©im
;

153 
time•ec
 
	m°_mtim
;

154 
time•ec
 
	m°_˘im
;

156 
__time_t
 
	m°_©ime
;

157 
__sysˇŒ_ul⁄g_t
 
	m°_©imí£c
;

158 
__time_t
 
	m°_mtime
;

159 
__sysˇŒ_ul⁄g_t
 
	m°_mtimí£c
;

160 
__time_t
 
	m°_˘ime
;

161 
__sysˇŒ_ul⁄g_t
 
	m°_˘imí£c
;

163 #ifde‡
__x86_64__


164 
__sysˇŒ_¶⁄g_t
 
	m__unu£d
[3];

166 
__öo64_t
 
	m°_öo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ifde‡
__USE_ATFILE


206 
	#UTIME_NOW
 ((1»<< 30Ë- 1l)

	)

207 
	#UTIME_OMIT
 ((1»<< 30Ë- 2l)

	)

	@/usr/include/bits/stdio-ldbl.h

19 #i‚de‡
_STDIO_H


23 
__BEGIN_NAMESPACE_STD


24 
	$__LDBL_REDIR_DECL
 (
Ârötf
)

25 
	$__LDBL_REDIR_DECL
 (
¥ötf
)

26 
	$__LDBL_REDIR_DECL
 (
•rötf
)

27 
	$__LDBL_REDIR_DECL
 (
vÂrötf
)

28 
	$__LDBL_REDIR_DECL
 (
v¥ötf
)

29 
	$__LDBL_REDIR_DECL
 (
v•rötf
)

30 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

31 && !
deföed
 
__REDIRECT
 \

32 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

33 
	$__LDBL_REDIR1_DECL
 (
fsˇnf
, 
__∆dbl___isoc99_fsˇnf
)

34 
	$__LDBL_REDIR1_DECL
 (
sˇnf
, 
__∆dbl___isoc99_sˇnf
)

35 
	$__LDBL_REDIR1_DECL
 (
ssˇnf
, 
__∆dbl___isoc99_ssˇnf
)

37 
	$__LDBL_REDIR_DECL
 (
fsˇnf
)

38 
	$__LDBL_REDIR_DECL
 (
sˇnf
)

39 
	$__LDBL_REDIR_DECL
 (
ssˇnf
)

41 
__END_NAMESPACE_STD


43 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


44 
__BEGIN_NAMESPACE_C99


45 
	$__LDBL_REDIR_DECL
 (
¢¥ötf
)

46 
	$__LDBL_REDIR_DECL
 (
v¢¥ötf
)

47 
__END_NAMESPACE_C99


50 #ifdef 
__USE_ISOC99


51 
__BEGIN_NAMESPACE_C99


52 #i‡!
deföed
 
__USE_GNU
 && !deföed 
__REDIRECT
 \

53 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

54 
	$__LDBL_REDIR1_DECL
 (
vfsˇnf
, 
__∆dbl___isoc99_vfsˇnf
)

55 
	$__LDBL_REDIR1_DECL
 (
vsˇnf
, 
__∆dbl___isoc99_vsˇnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vssˇnf
, 
__∆dbl___isoc99_vssˇnf
)

58 
	$__LDBL_REDIR_DECL
 (
vfsˇnf
)

59 
	$__LDBL_REDIR_DECL
 (
vssˇnf
)

60 
	$__LDBL_REDIR_DECL
 (
vsˇnf
)

62 
__END_NAMESPACE_C99


65 #ifde‡
__USE_XOPEN2K8


66 
	$__LDBL_REDIR_DECL
 (
vd¥ötf
)

67 
	$__LDBL_REDIR_DECL
 (
d¥ötf
)

70 #ifde‡
__USE_GNU


71 
	$__LDBL_REDIR_DECL
 (
va•rötf
)

72 
	$__LDBL_REDIR_DECL
 (
__a•rötf
)

73 
	$__LDBL_REDIR_DECL
 (
a•rötf
)

74 
	$__LDBL_REDIR_DECL
 (
ob°ack_¥ötf
)

75 
	$__LDBL_REDIR_DECL
 (
ob°ack_v¥ötf
)

78 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


79 
	$__LDBL_REDIR_DECL
 (
__•rötf_chk
)

80 
	$__LDBL_REDIR_DECL
 (
__v•rötf_chk
)

81 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


82 
	$__LDBL_REDIR_DECL
 (
__¢¥ötf_chk
)

83 
	$__LDBL_REDIR_DECL
 (
__v¢¥ötf_chk
)

85 #i‡
__USE_FORTIFY_LEVEL
 > 1

86 
	$__LDBL_REDIR_DECL
 (
__Ârötf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__¥ötf_chk
)

88 
	$__LDBL_REDIR_DECL
 (
__vÂrötf_chk
)

89 
	$__LDBL_REDIR_DECL
 (
__v¥ötf_chk
)

90 #ifde‡
__USE_XOPEN2K8


91 
	$__LDBL_REDIR_DECL
 (
__d¥ötf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__vd¥ötf_chk
)

94 #ifde‡
__USE_GNU


95 
	$__LDBL_REDIR_DECL
 (
__a•rötf_chk
)

96 
	$__LDBL_REDIR_DECL
 (
__va•rötf_chk
)

97 
	$__LDBL_REDIR_DECL
 (
__ob°ack_¥ötf_chk
)

98 
	$__LDBL_REDIR_DECL
 (
__ob°ack_v¥ötf_chk
)

	@/usr/include/bits/stdio.h

19 #i‚de‡
_STDIO_H


23 #i‚de‡
__exã∫_ölöe


24 
	#__STDIO_INLINE
 
ölöe


	)

26 
	#__STDIO_INLINE
 
__exã∫_ölöe


	)

30 #ifde‡
__USE_EXTERN_INLINES


33 #i‡!(
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
)

35 
__STDIO_INLINE
 

36 
	$v¥ötf
 (c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

38  
	`vÂrötf
 (
°dout
, 
__fmt
, 
__¨g
);

39 
	}
}

43 
__STDIO_INLINE
 

44 
	$gëch¨
 ()

46  
	`_IO_gëc
 (
°dö
);

47 
	}
}

50 #ifde‡
__USE_MISC


52 
__STDIO_INLINE
 

53 
	$fgëc_u∆ocked
 (
FILE
 *
__Â
)

55  
	`_IO_gëc_u∆ocked
 (
__Â
);

56 
	}
}

60 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


62 
__STDIO_INLINE
 

63 
	$gëc_u∆ocked
 (
FILE
 *
__Â
)

65  
	`_IO_gëc_u∆ocked
 (
__Â
);

66 
	}
}

69 
__STDIO_INLINE
 

70 
	$gëch¨_u∆ocked
 ()

72  
	`_IO_gëc_u∆ocked
 (
°dö
);

73 
	}
}

78 
__STDIO_INLINE
 

79 
	$putch¨
 (
__c
)

81  
	`_IO_putc
 (
__c
, 
°dout
);

82 
	}
}

85 #ifde‡
__USE_MISC


87 
__STDIO_INLINE
 

88 
	$Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

90  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

91 
	}
}

95 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


97 
__STDIO_INLINE
 

98 
	$putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

100  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

101 
	}
}

104 
__STDIO_INLINE
 

105 
	$putch¨_u∆ocked
 (
__c
)

107  
	`_IO_putc_u∆ocked
 (
__c
, 
°dout
);

108 
	}
}

112 #ifdef 
__USE_GNU


114 
__STDIO_INLINE
 
_IO_ssize_t


115 
	$gëlöe
 (**
__löïå
, 
size_t
 *
__n
, 
FILE
 *
__°ªam
)

117  
	`__gëdñim
 (
__löïå
, 
__n
, '\n', 
__°ªam
);

118 
	}
}

122 #ifde‡
__USE_MISC


124 
__STDIO_INLINE
 

125 
__NTH
 (
	$„of_u∆ocked
 (
FILE
 *
__°ªam
))

127  
	`_IO_„of_u∆ocked
 (
__°ªam
);

128 
	}
}

131 
__STDIO_INLINE
 

132 
__NTH
 (
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
))

134  
	`_IO_„º‹_u∆ocked
 (
__°ªam
);

135 
	}
}

141 #i‡
deföed
 
__USE_MISC
 && deföed 
__GNUC__
 && deföed 
__OPTIMIZE__
 \

142 && !
deföed
 
	g__˝lu•lus


144 
	#‰ód_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

145 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

146 && (
size_t
Ë(
size
Ë* (size_tË(
n
) <= 8 \

147 && (
size_t
Ë(
size
) != 0) \

148 ? ({ *
__±r
 = (*Ë(
±r
); \

149 
FILE
 *
__°ªam
 = (
°ªam
); \

150 
size_t
 
__˙t
; \

151 
__˙t
 = (
size_t
Ë(
size
Ë* (size_tË(
n
); \

152 
__˙t
 > 0; --__cnt) \

154 
__c
 = 
	`_IO_gëc_u∆ocked
 (
__°ªam
); \

155 i‡(
__c
 =
EOF
) \

157 *
__±r
++ = 
__c
; \

159 ((
size_t
Ë(
size
Ë* (size_tË(
n
Ë- 
__˙t
) \

160 / (
size_t
Ë(
size
); }) \

161 : (((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& (
size_t
) (size) == 0) \

162 || (
	`__buûtö_c⁄°™t_p
 (
n
Ë&& (
size_t
) (n) == 0)) \

164 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), \

165 (Ë(
n
), (
size_t
) 0) \

166 : 
	`‰ód_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

168 
	#fwrôe_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

169 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

170 && (
size_t
Ë(
size
Ë* (size_tË(
n
) <= 8 \

171 && (
size_t
Ë(
size
) != 0) \

172 ? ({ c⁄° *
__±r
 = (c⁄° *Ë(
±r
); \

173 
FILE
 *
__°ªam
 = (
°ªam
); \

174 
size_t
 
__˙t
; \

175 
__˙t
 = (
size_t
Ë(
size
Ë* (size_tË(
n
); \

176 
__˙t
 > 0; --__cnt) \

177 i‡(
	`_IO_putc_u∆ocked
 (*
__±r
++, 
__°ªam
Ë=
EOF
) \

179 ((
size_t
Ë(
size
Ë* (size_tË(
n
Ë- 
__˙t
) \

180 / (
size_t
Ë(
size
); }) \

181 : (((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& (
size_t
) (size) == 0) \

182 || (
	`__buûtö_c⁄°™t_p
 (
n
Ë&& (
size_t
) (n) == 0)) \

184 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), \

185 (Ë(
n
), (
size_t
) 0) \

186 : 
	`fwrôe_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

190 #unde‡
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

19 #i‚de‡
_STDIO_H


23 
	$__•rötf_chk
 (*
__ª°ri˘
 
__s
, 
__Êag
, 
size_t
 
__¶í
,

24 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

25 
	$__v•rötf_chk
 (*
__ª°ri˘
 
__s
, 
__Êag
, 
size_t
 
__¶í
,

26 c⁄° *
__ª°ri˘
 
__f‹m©
,

27 
_G_va_li°
 
__≠
Ë
__THROW
;

29 #ifde‡
__va_¨g_∑ck


30 
__f‹tify_fun˘i⁄
 

31 
	`__NTH
 (
	$•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__fmt
, ...))

33  
	`__buûtö___•rötf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

34 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¨g_∑ck
 ());

35 
	}
}

36 #ñi‡!
deföed
 
__˝lu•lus


37 
	#•rötf
(
°r
, ...) \

38 
	`__buûtö___•rötf_chk
 (
°r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

39 
__VA_ARGS__
)

	)

42 
__f‹tify_fun˘i⁄
 

43 
__NTH
 (
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__fmt
,

44 
_G_va_li°
 
__≠
))

46  
	`__buûtö___v•rötf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

47 
	`__bos
 (
__s
), 
__fmt
, 
__≠
);

48 
	}
}

50 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


52 
	$__¢¥ötf_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
, 
__Êag
,

53 
size_t
 
__¶í
, c⁄° *
__ª°ri˘
 
__f‹m©
,

54 ...Ë
__THROW
;

55 
	$__v¢¥ötf_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
, 
__Êag
,

56 
size_t
 
__¶í
, c⁄° *
__ª°ri˘
 
__f‹m©
,

57 
_G_va_li°
 
__≠
Ë
__THROW
;

59 #ifde‡
__va_¨g_∑ck


60 
__f‹tify_fun˘i⁄
 

61 
	`__NTH
 (
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
,

62 c⁄° *
__ª°ri˘
 
__fmt
, ...))

64  
	`__buûtö___¢¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

65 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¨g_∑ck
 ());

66 
	}
}

67 #ñi‡!
deföed
 
__˝lu•lus


68 
	#¢¥ötf
(
°r
, 
Àn
, ...) \

69 
	`__buûtö___¢¥ötf_chk
 (
°r
, 
Àn
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

70 
__VA_ARGS__
)

	)

73 
__f‹tify_fun˘i⁄
 

74 
__NTH
 (
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
,

75 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
))

77  
	`__buûtö___v¢¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

78 
	`__bos
 (
__s
), 
__fmt
, 
__≠
);

79 
	}
}

83 #i‡
__USE_FORTIFY_LEVEL
 > 1

85 
__Ârötf_chk
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

86 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

87 
__¥ötf_chk
 (
__Êag
, c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

88 
__vÂrötf_chk
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

89 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__≠
);

90 
__v¥ötf_chk
 (
__Êag
, c⁄° *
__ª°ri˘
 
__f‹m©
,

91 
_G_va_li°
 
__≠
);

93 #ifde‡
__va_¨g_∑ck


94 
__f‹tify_fun˘i⁄
 

95 
	$Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, c⁄° *__ª°ri˘ 
__fmt
, ...)

97  
	`__Ârötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

98 
	`__va_¨g_∑ck
 ());

99 
	}
}

101 
__f‹tify_fun˘i⁄
 

102 
	$¥ötf
 (c⁄° *
__ª°ri˘
 
__fmt
, ...)

104  
	`__¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¨g_∑ck
 ());

105 
	}
}

106 #ñi‡!
deföed
 
__˝lu•lus


107 
	#¥ötf
(...) \

108 
	`__¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

109 
	#Ârötf
(
°ªam
, ...) \

110 
	`__Ârötf_chk
 (
°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

113 
__f‹tify_fun˘i⁄
 

114 
	$v¥ötf
 (c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

116 #ifde‡
__USE_EXTERN_INLINES


117  
	`__vÂrötf_chk
 (
°dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

119  
	`__v¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

121 
	}
}

123 
__f‹tify_fun˘i⁄
 

124 
	$vÂrötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

125 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

127  
	`__vÂrötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

128 
	}
}

130 #ifde‡
__USE_XOPEN2K8


131 
	$__d¥ötf_chk
 (
__fd
, 
__Êag
, c⁄° *
__ª°ri˘
 
__fmt
,

132 ...Ë
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

133 
	$__vd¥ötf_chk
 (
__fd
, 
__Êag
,

134 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

135 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

137 #ifde‡
__va_¨g_∑ck


138 
__f‹tify_fun˘i⁄
 

139 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

141  
	`__d¥ötf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

142 
	`__va_¨g_∑ck
 ());

143 
	}
}

144 #ñi‡!
deföed
 
__˝lu•lus


145 
	#d¥ötf
(
fd
, ...) \

146 
	`__d¥ötf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

149 
__f‹tify_fun˘i⁄
 

150 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

152  
	`__vd¥ötf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

153 
	}
}

156 #ifde‡
__USE_GNU


158 
	$__a•rötf_chk
 (**
__ª°ri˘
 
__±r
, 
__Êag
,

159 c⁄° *
__ª°ri˘
 
__fmt
, ...)

160 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 3, 4))Ë
__wur
;

161 
	$__va•rötf_chk
 (**
__ª°ri˘
 
__±r
, 
__Êag
,

162 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

163 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 3, 0))Ë
__wur
;

164 
	$__ob°ack_¥ötf_chk
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

165 
__Êag
, c⁄° *
__ª°ri˘
 
__f‹m©
,

167 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

168 
	$__ob°ack_v¥ötf_chk
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

169 
__Êag
,

170 c⁄° *
__ª°ri˘
 
__f‹m©
,

171 
_G_va_li°
 
__¨gs
)

172 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

174 #ifde‡
__va_¨g_∑ck


175 
__f‹tify_fun˘i⁄
 

176 
	`__NTH
 (
	$a•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__fmt
, ...))

178  
	`__a•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

179 
	`__va_¨g_∑ck
 ());

180 
	}
}

182 
__f‹tify_fun˘i⁄
 

183 
__NTH
 (
	$__a•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__fmt
,

186  
	`__a•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

187 
	`__va_¨g_∑ck
 ());

188 
	}
}

190 
__f‹tify_fun˘i⁄
 

191 
__NTH
 (
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

192 c⁄° *
__ª°ri˘
 
__fmt
, ...))

194  
	`__ob°ack_¥ötf_chk
 (
__ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

195 
	`__va_¨g_∑ck
 ());

196 
	}
}

197 #ñi‡!
deföed
 
__˝lu•lus


198 
	#a•rötf
(
±r
, ...) \

199 
	`__a•rötf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

200 
	#__a•rötf
(
±r
, ...) \

201 
	`__a•rötf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

202 
	#ob°ack_¥ötf
(
ob°ack
, ...) \

203 
	`__ob°ack_¥ötf_chk
 (
ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

206 
__f‹tify_fun˘i⁄
 

207 
__NTH
 (
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__fmt
,

208 
_G_va_li°
 
__≠
))

210  
	`__va•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

211 
	}
}

213 
__f‹tify_fun˘i⁄
 

214 
__NTH
 (
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

215 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
))

217  
	`__ob°ack_v¥ötf_chk
 (
__ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

218 
__≠
);

219 
	}
}

225 #i‡!
deföed
 
__USE_ISOC11
 \

226 || (
deföed
 
	g__˝lu•lus
 && __˝lu•lu†<201103L && !deföed 
__USE_GNU
)

227 *
	$__gës_chk
 (*
__°r
, 
size_t
Ë
__wur
;

228 *
	`__REDIRECT
 (
__gës_w¨n
, (*
__°r
), 
gës
)

229 
__wur
 
	`__w¨«âr
 ("please use fgets or getline instead, gets can't "

232 
__f‹tify_fun˘i⁄
 
__wur
 *

233 
	$gës
 (*
__°r
)

235 i‡(
	`__bos
 (
__°r
Ë!(
size_t
) -1)

236  
	`__gës_chk
 (
__°r
, 
	`__bos
 (__str));

237  
	`__gës_w¨n
 (
__°r
);

238 
	}
}

241 *
	$__fgës_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

242 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

243 *
	`__REDIRECT
 (
__fgës_Æüs
,

244 (*
__ª°ri˘
 
__s
, 
__n
,

245 
FILE
 *
__ª°ri˘
 
__°ªam
), 
fgës
Ë
__wur
;

246 *
	`__REDIRECT
 (
__fgës_chk_w¨n
,

247 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

248 
FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgës_chk
)

249 
__wur
 
	`__w¨«âr
 ("fgets called with bigger sizeÅhanÜength "

252 
__f‹tify_fun˘i⁄
 
__wur
 *

253 
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

255 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

257 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

258  
	`__fgës_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

260 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
))

261  
	`__fgës_chk_w¨n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

263  
	`__fgës_Æüs
 (
__s
, 
__n
, 
__°ªam
);

264 
	}
}

266 
size_t
 
	$__‰ód_chk
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

267 
size_t
 
__size
, size_à
__n
,

268 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

269 
size_t
 
	`__REDIRECT
 (
__‰ód_Æüs
,

270 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

271 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
),

272 
‰ód
Ë
__wur
;

273 
size_t
 
	`__REDIRECT
 (
__‰ód_chk_w¨n
,

274 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

275 
size_t
 
__size
, size_à
__n
,

276 
FILE
 *
__ª°ri˘
 
__°ªam
),

277 
__‰ód_chk
)

278 
__wur
 
	`__w¨«âr
 ("fread called with bigger size *ÇmembÅhanÜength "

281 
__f‹tify_fun˘i⁄
 
__wur
 
size_t


282 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
, size_à
__n
,

283 
FILE
 *
__ª°ri˘
 
__°ªam
)

285 i‡(
	`__bos0
 (
__±r
Ë!(
size_t
) -1)

287 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
)

288 || !
	`__buûtö_c⁄°™t_p
 (
__n
)

289 || (
__size
 | 
__n
Ë>(((
size_t
) 1) << (8 *  (size_t) / 2)))

290  
	`__‰ód_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__°ªam
);

292 i‡(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

293  
	`__‰ód_chk_w¨n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__°ªam
);

295  
	`__‰ód_Æüs
 (
__±r
, 
__size
, 
__n
, 
__°ªam
);

296 
	}
}

298 #ifde‡
__USE_GNU


299 *
	$__fgës_u∆ocked_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
,

300 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

301 *
	`__REDIRECT
 (
__fgës_u∆ocked_Æüs
,

302 (*
__ª°ri˘
 
__s
, 
__n
,

303 
FILE
 *
__ª°ri˘
 
__°ªam
), 
fgës_u∆ocked
Ë
__wur
;

304 *
	`__REDIRECT
 (
__fgës_u∆ocked_chk_w¨n
,

305 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

306 
FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgës_u∆ocked_chk
)

307 
__wur
 
	`__w¨«âr
 ("fgets_unlocked called with bigger sizeÅhanÜength "

310 
__f‹tify_fun˘i⁄
 
__wur
 *

311 
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

313 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

315 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

316  
	`__fgës_u∆ocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

318 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
))

319  
	`__fgës_u∆ocked_chk_w¨n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

321  
	`__fgës_u∆ocked_Æüs
 (
__s
, 
__n
, 
__°ªam
);

322 
	}
}

325 #ifde‡
__USE_MISC


326 #unde‡
‰ód_u∆ocked


327 
size_t
 
	$__‰ód_u∆ocked_chk
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

328 
size_t
 
__size
, size_à
__n
,

329 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

330 
size_t
 
	`__REDIRECT
 (
__‰ód_u∆ocked_Æüs
,

331 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

332 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
),

333 
‰ód_u∆ocked
Ë
__wur
;

334 
size_t
 
	`__REDIRECT
 (
__‰ód_u∆ocked_chk_w¨n
,

335 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

336 
size_t
 
__size
, size_à
__n
,

337 
FILE
 *
__ª°ri˘
 
__°ªam
),

338 
__‰ód_u∆ocked_chk
)

339 
__wur
 
	`__w¨«âr
 ("fread_unlocked called with bigger size *ÇmembÅhan "

342 
__f‹tify_fun˘i⁄
 
__wur
 
size_t


343 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
, size_à
__n
,

344 
FILE
 *
__ª°ri˘
 
__°ªam
)

346 i‡(
	`__bos0
 (
__±r
Ë!(
size_t
) -1)

348 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
)

349 || !
	`__buûtö_c⁄°™t_p
 (
__n
)

350 || (
__size
 | 
__n
Ë>(((
size_t
) 1) << (8 *  (size_t) / 2)))

351  
	`__‰ód_u∆ocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

352 
__°ªam
);

354 i‡(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

355  
	`__‰ód_u∆ocked_chk_w¨n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

356 
__°ªam
);

359 #ifde‡
__USE_EXTERN_INLINES


360 i‡(
	`__buûtö_c⁄°™t_p
 (
__size
)

361 && 
	`__buûtö_c⁄°™t_p
 (
__n
)

362 && (
__size
 | 
__n
Ë< (((
size_t
) 1) << (8 *  (size_t) / 2))

363 && 
__size
 * 
__n
 <= 8)

365 
size_t
 
__˙t
 = 
__size
 * 
__n
;

366 *
__˝å
 = (*Ë
__±r
;

367 i‡(
__˙t
 == 0)

370 ; 
__˙t
 > 0; --__cnt)

372 
__c
 = 
	`_IO_gëc_u∆ocked
 (
__°ªam
);

373 i‡(
__c
 =
EOF
)

375 *
__˝å
++ = 
__c
;

377  (
__˝å
 - (*Ë
__±r
Ë/ 
__size
;

380  
	`__‰ód_u∆ocked_Æüs
 (
__±r
, 
__size
, 
__n
, 
__°ªam
);

381 
	}
}

	@/usr/include/bits/stdio_lim.h

18 #i‡!
deföed
 
_STDIO_H
 && !deföed 
__√ed_FOPEN_MAX
 && !deföed 
__√ed_IOV_MAX


22 #ifde‡
_STDIO_H


23 
	#L_tm≤am
 20

	)

24 
	#TMP_MAX
 238328

	)

25 
	#FILENAME_MAX
 4096

	)

27 #ifde‡
__USE_POSIX


28 
	#L_˘îmid
 9

	)

29 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


30 
	#L_cu£rid
 9

	)

35 #i‡
deföed
 
__√ed_FOPEN_MAX
 || deföed 
_STDIO_H


36 #unde‡
FOPEN_MAX


37 
	#FOPEN_MAX
 16

	)

40 #i‡
deföed
 
__√ed_IOV_MAX
 && !deföed 
IOV_MAX


41 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/stdlib-float.h

19 #i‚de‡
_STDLIB_H


23 #ifde‡
__USE_EXTERN_INLINES


24 
__BEGIN_NAMESPACE_STD


25 
__exã∫_ölöe
 

26 
__NTH
 (
	$©of
 (c⁄° *
__≈å
))

28  
	`°πod
 (
__≈å
, (**Ë
NULL
);

29 
	}
}

30 
	g__END_NAMESPACE_STD


	@/usr/include/bits/stdlib-ldbl.h

19 #i‚de‡
_STDLIB_H


23 #ifdef 
__USE_ISOC99


24 
__BEGIN_NAMESPACE_C99


25 
	$__LDBL_REDIR1_DECL
 (
°πﬁd
, 
°πod
)

26 
__END_NAMESPACE_C99


29 #ifde‡
__USE_GNU


30 
	$__LDBL_REDIR1_DECL
 (
°πﬁd_l
, 
°πod_l
)

33 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


34 #ifde‡
__USE_MISC


35 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

36 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

39 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

19 #i‚de‡
_STDLIB_H


23 *
	$__ªÆ∑th_chk
 (c⁄° *
__ª°ri˘
 
__«me
,

24 *
__ª°ri˘
 
__ªsﬁved
,

25 
size_t
 
__ªsﬁvedÀn
Ë
__THROW
 
__wur
;

26 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_Æüs
,

27 (c⁄° *
__ª°ri˘
 
__«me
,

28 *
__ª°ri˘
 
__ªsﬁved
), 
ªÆ∑th
Ë
__wur
;

29 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_chk_w¨n
,

30 (c⁄° *
__ª°ri˘
 
__«me
,

31 *
__ª°ri˘
 
__ªsﬁved
,

32 
size_t
 
__ªsﬁvedÀn
), 
__ªÆ∑th_chk
Ë
__wur


33 
	`__w¨«âr
 ("secondárgument ofÑealpath must beÉither NULL orát "

36 
__f‹tify_fun˘i⁄
 
__wur
 *

37 
	`__NTH
 (
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
, *__ª°ri˘ 
__ªsﬁved
))

39 i‡(
	`__bos
 (
__ªsﬁved
Ë!(
size_t
) -1)

41 #i‡
deföed
 
_LIBC_LIMITS_H_
 && deföed 
PATH_MAX


42 i‡(
	`__bos
 (
__ªsﬁved
Ë< 
PATH_MAX
)

43  
	`__ªÆ∑th_chk_w¨n
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

45  
	`__ªÆ∑th_chk
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

48  
	`__ªÆ∑th_Æüs
 (
__«me
, 
__ªsﬁved
);

49 
	}
}

52 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

53 
size_t
 
__ƒól
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

54 
	`__REDIRECT_NTH
 (
__±¢ame_r_Æüs
, (
__fd
, *
__buf
,

55 
size_t
 
__buÊí
), 
±¢ame_r
)

56 
	`__n⁄nuŒ
 ((2));

57 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¨n
,

58 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

59 
size_t
 
__ƒól
), 
__±¢ame_r_chk
)

60 
	`__n⁄nuŒ
 ((2)Ë
	`__w¨«âr
 ("ptsname_r called with buflen biggerÅhan "

63 
__f‹tify_fun˘i⁄
 

64 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
))

66 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

68 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

69  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

70 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

71  
	`__±¢ame_r_chk_w¨n
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

73  
	`__±¢ame_r_Æüs
 (
__fd
, 
__buf
, 
__buÊí
);

74 
	}
}

77 
	$__w˘omb_chk
 (*
__s
, 
wch¨_t
 
__wch¨
, 
size_t
 
__buÊí
)

78 
__THROW
 
__wur
;

79 
	`__REDIRECT_NTH
 (
__w˘omb_Æüs
, (*
__s
, 
wch¨_t
 
__wch¨
),

80 
w˘omb
Ë
__wur
;

82 
__f‹tify_fun˘i⁄
 
__wur
 

83 
	`__NTH
 (
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
))

88 
	#__STDLIB_MB_LEN_MAX
 16

	)

89 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__STDLIB_MB_LEN_MAX


92 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

93  
	`__w˘omb_chk
 (
__s
, 
__wch¨
, 
	`__bos
 (__s));

94  
	`__w˘omb_Æüs
 (
__s
, 
__wch¨
);

95 
	}
}

98 
size_t
 
	$__mb°owcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

99 c⁄° *
__ª°ri˘
 
__§c
,

100 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

101 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_Æüs
,

102 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

103 c⁄° *
__ª°ri˘
 
__§c
,

104 
size_t
 
__Àn
), 
mb°owcs
);

105 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_chk_w¨n
,

106 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

107 c⁄° *
__ª°ri˘
 
__§c
,

108 
size_t
 
__Àn
, size_à
__d°Àn
), 
__mb°owcs_chk
)

109 
	`__w¨«âr
 ("mbstowcs called with dst buffer smallerÅhanÜen "

112 
__f‹tify_fun˘i⁄
 
size_t


113 
	`__NTH
 (
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° *__ª°ri˘ 
__§c
,

114 
size_t
 
__Àn
))

116 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

118 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

119  
	`__mb°owcs_chk
 (
__d°
, 
__§c
, 
__Àn
,

120 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

122 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

123  
	`__mb°owcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
,

124 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

126  
	`__mb°owcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

127 
	}
}

130 
size_t
 
	$__wc°ombs_chk
 (*
__ª°ri˘
 
__d°
,

131 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

132 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

133 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_Æüs
,

134 (*
__ª°ri˘
 
__d°
,

135 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

136 
size_t
 
__Àn
), 
wc°ombs
);

137 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_chk_w¨n
,

138 (*
__ª°ri˘
 
__d°
,

139 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

140 
size_t
 
__Àn
, size_à
__d°Àn
), 
__wc°ombs_chk
)

141 
	`__w¨«âr
 ("wcstombs called with dst buffer smallerÅhanÜen");

143 
__f‹tify_fun˘i⁄
 
size_t


144 
	`__NTH
 (
	$wc°ombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 *__ª°ri˘ 
__§c
,

145 
size_t
 
__Àn
))

147 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

149 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

150  
	`__wc°ombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

151 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

152  
	`__wc°ombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

154  
	`__wc°ombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

155 
	}
}

	@/usr/include/bits/string.h

19 #i‚de‡
_STRING_H


24 
	#_STRING_ARCH_u«lig√d
 1

	)

28 #i‡!
deföed
 
__x86_64__
 && (deföed 
__i486__
 || deföed 
__≥¡ium__
 \

29 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

30 || 
deföed
 
	g__noc⁄a__
 || deföed 
	g__©om__
 \

31 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__c‹ei7__
 \

32 || 
deföed
 
	g__k6__
 || deföed 
	g__geode__
 \

33 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

34 || 
deföed
 
	g__amdÁm10__
)

38 #i‡!
deföed
 
__NO_STRING_INLINES
 && deföed 
__USE_STRING_INLINES
 \

39 && 
deföed
 
	g__GNUC__
 && __GNUC__ >= 2

41 #i‚de‡
__STRING_INLINE


42 #i‚de‡
__exã∫_ölöe


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

50 
	#__STRING_SMALL_GET16
(
§c
, 
idx
) \

51 ((((c⁄° *Ë(
§c
))[
idx
 + 1] << 8) \

52 | ((c⁄° *Ë(
§c
))[
idx
])

	)

53 
	#__STRING_SMALL_GET32
(
§c
, 
idx
) \

54 (((((c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

55 | ((c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

56 | ((c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

57 | ((c⁄° *Ë(
§c
))[
idx
])

	)

61 
	#_HAVE_STRING_ARCH_mem˝y
 1

	)

62 
	#mem˝y
(
de°
, 
§c
, 
n
) \

63 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

64 ? 
	`__mem˝y_c
 ((
de°
), (
§c
), (
n
)) \

65 : 
	`__mem˝y_g
 ((
de°
), (
§c
), (
n
))))

	)

66 
	#__mem˝y_c
(
de°
, 
§c
, 
n
) \

67 ((
n
) == 0 \

68 ? (
de°
) \

69 : (((
n
) % 4 == 0) \

70 ? 
	`__mem˝y_by4
 (
de°
, 
§c
, 
n
) \

71 : (((
n
) % 2 == 0) \

72 ? 
	`__mem˝y_by2
 (
de°
, 
§c
, 
n
) \

73 : 
	`__mem˝y_g
 (
de°
, 
§c
, 
n
))))

	)

75 
__STRING_INLINE
 *
__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
,

76 
size_t
 
__n
);

78 
__STRING_INLINE
 *

79 
	$__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

81 
__d0
, 
__d1
;

82 *
__tmp
 = 
__de°
;

83 
__asm__
 
__vﬁ©ûe__


91 : "=&r" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

92 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 4)

94  
__de°
;

95 
	}
}

97 
__STRING_INLINE
 *
__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
,

98 
size_t
 
__n
);

100 
__STRING_INLINE
 *

101 
	$__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

103 
__d0
, 
__d1
;

104 *
__tmp
 = 
__de°
;

105 
__asm__
 
__vﬁ©ûe__


118 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

119 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 2)

121  
__de°
;

122 
	}
}

124 
__STRING_INLINE
 *
__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
);

126 
__STRING_INLINE
 *

127 
	$__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

129 
__d0
, 
__d1
, 
__d2
;

130 *
__tmp
 = 
__de°
;

131 
__asm__
 
__vﬁ©ûe__


142 : "=&c" (
__d0
), "=&D" (
__d1
), "=&S" (
__d2
),

143 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

144 : "0" (
__n
), "1" (
__tmp
), "2" (
__§c
),

145 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
)

147  
__de°
;

148 
	}
}

150 
	#_HAVE_STRING_ARCH_memmove
 1

	)

151 #i‚de‡
_FORCE_INLINES


154 
	#memmove
(
de°
, 
§c
, 
n
Ë
	`__memmove_g
 (de°, src,Ç)

	)

156 
__STRING_INLINE
 *
	$__memmove_g
 (*, c⁄° *, 
size_t
)

157 
	`__asm__
 ("memmove");

159 
__STRING_INLINE
 *

160 
	$__memmove_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

162 
__d0
, 
__d1
, 
__d2
;

163 *
__tmp
 = 
__de°
;

164 i‡(
__de°
 < 
__§c
)

165 
__asm__
 
__vﬁ©ûe__


168 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

169 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

170 : "0" (
__n
), "1" (
__§c
), "2" (
__tmp
),

171 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

173 
__asm__
 
__vﬁ©ûe__


177 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

178 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

179 : "0" (
__n
), "1" (__¿- 1 + (c⁄° *Ë
__§c
),

180 "2" (
__n
 - 1 + (*Ë
__tmp
),

181 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

182  
__de°
;

183 
	}
}

187 
	#_HAVE_STRING_ARCH_memcmp
 1

	)

188 #i‚de‡
_FORCE_INLINES


189 #i‚de‡
__PIC__


191 
__STRING_INLINE
 

192 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

194 
__d0
, 
__d1
, 
__d2
;

195 
__ªs
;

196 
__asm__
 
__vﬁ©ûe__


204 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

205 : "0" (0), "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

206 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

207 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

209  
__ªs
;

210 
	}
}

215 
	#_HAVE_STRING_ARCH_mem£t
 1

	)

216 
	#_USE_STRING_ARCH_mem£t
 1

	)

217 
	#mem£t
(
s
, 
c
, 
n
) \

218 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

219 ? ((
n
) == 1 \

220 ? 
	`__mem£t_c1
 ((
s
), (
c
)) \

221 : 
	`__mem£t_gc
 ((
s
), (
c
), (
n
))) \

222 : (
	`__buûtö_c⁄°™t_p
 (
c
) \

223 ? (
	`__buûtö_c⁄°™t_p
 (
n
) \

224 ? 
	`__mem£t_c˙
 ((
s
), (
c
), (
n
)) \

225 : 
	`mem£t
 ((
s
), (
c
), (
n
))) \

226 : (
	`__buûtö_c⁄°™t_p
 (
n
) \

227 ? 
	`__mem£t_g˙
 ((
s
), (
c
), (
n
)) \

228 : 
	`mem£t
 ((
s
), (
c
), (
n
))))))

	)

230 
	#__mem£t_c1
(
s
, 
c
Ë({ *
__s
 = (s); \

231 *((*Ë
__s
Ë(Ë(
c
); \

232 
__s
; })

	)

234 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

235 ({ *
__s
 = (
s
); \

237 
__ui
; \

238 
__usi
; \

239 
__uc
; \

240 } *
__u
 = 
__s
; \

241 
__c
 = ((Ë((Ë(
c
))) * 0x01010101; \

247 i‡((
n
) == 3 || (n) >= 5) \

248 
__asm__
 
	`__vﬁ©ûe__
 ("" : "Ù" (
__c
) : "0" (__c)); \

251 
n
) \

254 
__u
->
__ui
 = 
__c
; \

255 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

257 
__u
->
__ui
 = 
__c
; \

258 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

260 
__u
->
__ui
 = 
__c
; \

261 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

263 
__u
->
__usi
 = (Ë
__c
; \

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

265 
__u
->
__uc
 = (Ë
__c
; \

269 
__u
->
__ui
 = 
__c
; \

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

272 
__u
->
__ui
 = 
__c
; \

273 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

275 
__u
->
__ui
 = 
__c
; \

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

278 
__u
->
__usi
 = (Ë
__c
; \

282 
__u
->
__ui
 = 
__c
; \

283 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

285 
__u
->
__ui
 = 
__c
; \

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

288 
__u
->
__ui
 = 
__c
; \

289 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

291 
__u
->
__uc
 = (Ë
__c
; \

295 
__u
->
__ui
 = 
__c
; \

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

298 
__u
->
__ui
 = 
__c
; \

299 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

301 
__u
->
__ui
 = 
__c
; \

302 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

304 
__u
->
__ui
 = 
__c
; \

309 
__s
; })

	)

311 
	#__mem£t_c˙
(
s
, 
c
, 
n
) \

312 (((
n
) % 4 == 0) \

313 ? 
	`__mem£t_c˙_by4
 (
s
, ((Ë((Ë(
c
))) * 0x01010101,\

314 
n
) \

315 : (((
n
) % 2 == 0) \

316 ? 
	`__mem£t_c˙_by2
 (
s
, \

317 ((Ë((Ë(
c
))) * 0x01010101,\

318 
n
) \

319 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

321 
__STRING_INLINE
 *
__mem£t_c˙_by4
 (*
__s
, 
__c
,

322 
size_t
 
__n
);

324 
__STRING_INLINE
 *

325 
	$__mem£t_c˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

327 *
__tmp
 = 
__s
;

328 
__d0
;

329 #ifde‡
__i686__


330 
__asm__
 
__vﬁ©ûe__


333 : "=&a" (
__c
), "=&D" (
__tmp
), "=&c" (
__d0
),

334 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

335 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

338 
__asm__
 
__vﬁ©ûe__


344 : "=&r" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

345 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

346 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

349  
__s
;

350 
	}
}

352 
__STRING_INLINE
 *
__mem£t_c˙_by2
 (*
__s
, 
__c
,

353 
size_t
 
__n
);

355 
__STRING_INLINE
 *

356 
	$__mem£t_c˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

358 
__d0
, 
__d1
;

359 *
__tmp
 = 
__s
;

360 #ifde‡
__i686__


361 
__asm__
 
__vﬁ©ûe__


365 : "=&a" (
__d0
), "=&D" (
__tmp
), "=&c" (
__d1
),

366 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

367 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

370 
__asm__
 
__vﬁ©ûe__


376 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

377 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

378 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

381  
__s
;

382 
	}
}

384 
	#__mem£t_g˙
(
s
, 
c
, 
n
) \

385 (((
n
) % 4 == 0) \

386 ? 
	`__mem£t_g˙_by4
 (
s
, 
c
, 
n
) \

387 : (((
n
) % 2 == 0) \

388 ? 
	`__mem£t_g˙_by2
 (
s
, 
c
, 
n
) \

389 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

391 
__STRING_INLINE
 *
__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
);

393 
__STRING_INLINE
 *

394 
	$__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

396 *
__tmp
 = 
__s
;

397 
__d0
;

398 
__asm__
 
__vﬁ©ûe__


408 : "=&q" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

409 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

410 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

412  
__s
;

413 
	}
}

415 
__STRING_INLINE
 *
__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
);

417 
__STRING_INLINE
 *

418 
	$__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

420 
__d0
, 
__d1
;

421 *
__tmp
 = 
__s
;

422 
__asm__
 
__vﬁ©ûe__


433 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

434 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

435 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

437  
__s
;

438 
	}
}

442 
	#_HAVE_STRING_ARCH_memchr
 1

	)

443 #i‚de‡
_FORCE_INLINES


444 
__STRING_INLINE
 *

445 
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

447 
__d0
;

448 #ifde‡
__i686__


449 
__d1
;

451 *
__ªs
;

452 i‡(
__n
 == 0)

453  
NULL
;

454 #ifde‡
__i686__


455 
__asm__
 
__vﬁ©ûe__


459 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

460 : "a" (
__c
), "0" (
__s
), "1" (
__n
), "2" (1),

461 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

464 
__asm__
 
__vﬁ©ûe__


470 : "=D" (
__ªs
), "=&c" (
__d0
)

471 : "a" (
__c
), "0" (
__s
), "1" (
__n
),

472 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

475  
__ªs
 - 1;

476 
	}
}

479 
	#_HAVE_STRING_ARCH_memrchr
 1

	)

480 #i‚de‡
_FORCE_INLINES


481 
__STRING_INLINE
 *
__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
);

483 
__STRING_INLINE
 *

484 
	$__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

486 
__d0
;

487 #ifde‡
__i686__


488 
__d1
;

490 *
__ªs
;

491 i‡(
__n
 == 0)

492  
NULL
;

493 #ifde‡
__i686__


494 
__asm__
 
__vﬁ©ûe__


500 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

501 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n), "2" (-1),

502 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

505 
__asm__
 
__vﬁ©ûe__


512 : "=D" (
__ªs
), "=&c" (
__d0
)

513 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n),

514 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

517  
__ªs
;

518 
	}
}

519 #ifde‡
__USE_GNU


520 
	#memrchr
(
s
, 
c
, 
n
Ë
	`__memrchr
 ((s), (c), (n))

	)

525 
	#_HAVE_STRING_ARCH_øwmemchr
 1

	)

526 
__STRING_INLINE
 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

528 #i‚de‡
_FORCE_INLINES


529 
__STRING_INLINE
 *

530 
	$__øwmemchr
 (c⁄° *
__s
, 
__c
)

532 
__d0
;

533 *
__ªs
;

534 
__asm__
 
__vﬁ©ûe__


537 : "=D" (
__ªs
), "=&c" (
__d0
)

538 : "a" (
__c
), "0" (
__s
), "1" (0xffffffff),

539 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

541  
__ªs
 - 1;

542 
	}
}

543 #ifde‡
__USE_GNU


544 
__STRING_INLINE
 *

545 
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

547  
	`__øwmemchr
 (
__s
, 
__c
);

548 
	}
}

554 
	#_HAVE_STRING_ARCH_°æí
 1

	)

555 
	#°æí
(
°r
) \

556 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
°r
) \

557 ? 
	`__buûtö_°æí
 (
°r
) \

558 : 
	`__°æí_g
 (
°r
)))

	)

559 
__STRING_INLINE
 
size_t
 
__°æí_g
 (c⁄° *
__°r
);

561 
__STRING_INLINE
 
size_t


562 
	$__°æí_g
 (c⁄° *
__°r
)

564 
__dummy
;

565 c⁄° *
__tmp
 = 
__°r
;

566 
__asm__
 
__vﬁ©ûe__


572 : "Ù" (
__tmp
), "=&q" (
__dummy
)

573 : "0" (
__°r
),

574 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__°r
)

576  
__tmp
 - 
__°r
 - 1;

577 
	}
}

581 
	#_HAVE_STRING_ARCH_°r˝y
 1

	)

582 
	#°r˝y
(
de°
, 
§c
) \

583 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

584 ? ( ((
§c
)[0]Ë=1 && 
	`°æí
 (src) + 1 <= 8 \

585 ? 
	`__°r˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

586 : (*Ë
	`mem˝y
 ((*Ë(
de°
), \

587 (c⁄° *Ë(
§c
), \

588 
	`°æí
 (
§c
) + 1)) \

589 : 
	`__°r˝y_g
 ((
de°
), (
§c
))))

	)

591 
	#__°r˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

592 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

594 
__ui
; \

595 
__usi
; \

596 
__uc
; \

597 
__c
; \

598 } *
__u
 = (*Ë
__de°
; \

599 
§˛í
) \

602 
__u
->
__uc
 = '\0'; \

605 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

608 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

609 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

610 
__u
->
__uc
 = '\0'; \

613 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

616 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

617 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

618 
__u
->
__uc
 = '\0'; \

621 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

622 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

623 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

626 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

627 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

628 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

629 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

630 
__u
->
__uc
 = '\0'; \

633 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

635 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

638 (*Ë
__de°
; }))

	)

640 
__STRING_INLINE
 *
__°r˝y_g
 (*
__de°
, c⁄° *
__§c
);

642 
__STRING_INLINE
 *

643 
	$__°r˝y_g
 (*
__de°
, c⁄° *
__§c
)

645 *
__tmp
 = 
__de°
;

646 
__dummy
;

647 
__asm__
 
__vﬁ©ûe__


656 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
),

657 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

658 : "0" (
__§c
), "1" (
__tmp
),

659 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

661  
__de°
;

662 
	}
}

665 #ifde‡
__USE_GNU


666 
	#_HAVE_STRING_ARCH_°p˝y
 1

	)

668 
	#__°p˝y
(
de°
, 
§c
) \

669 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

670 ? (
	`°æí
 (
§c
) + 1 <= 8 \

671 ? 
	`__°p˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

672 : 
	`__°p˝y_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1)) \

673 : 
	`__°p˝y_g
 ((
de°
), (
§c
))))

	)

674 
	#__°p˝y_c
(
de°
, 
§c
, 
§˛í
) \

675 ((
§˛í
) % 4 == 0 \

676 ? 
	`__memp˝y_by4
 (
de°
, 
§c
, 
§˛í
) - 1 \

677 : ((
§˛í
) % 2 == 0 \

678 ? 
	`__memp˝y_by2
 (
de°
, 
§c
, 
§˛í
) - 1 \

679 : 
	`__memp˝y_byn
 (
de°
, 
§c
, 
§˛í
Ë- 1))

	)

682 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 ((de°), (§c))

	)

684 
	#__°p˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

685 (
	`__exãnsi⁄__
 ({ union { \

686 
__ui
; \

687 
__usi
; \

688 
__uc
; \

689 
__c
; \

690 } *
__u
 = (*Ë(
de°
); \

691 
§˛í
) \

694 
__u
->
__uc
 = '\0'; \

697 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

698 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

701 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

702 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

703 
__u
->
__uc
 = '\0'; \

706 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

707 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

710 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

711 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

712 
__u
->
__uc
 = '\0'; \

715 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

716 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

717 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

718 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

721 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

722 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

723 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

724 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

725 
__u
->
__uc
 = '\0'; \

728 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

729 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

730 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

731 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

734 (*Ë
__u
; }))

	)

736 
__STRING_INLINE
 *
__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
,

737 
size_t
 
__§˛í
);

739 
__STRING_INLINE
 *

740 
	$__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

742 *
__tmp
 = 
__de°
;

743 
__d0
, 
__d1
;

744 
__asm__
 
__vﬁ©ûe__


752 : "=&r" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

753 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4)

755  
__tmp
;

756 
	}
}

758 
__STRING_INLINE
 *
__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
,

759 
size_t
 
__§˛í
);

761 
__STRING_INLINE
 *

762 
	$__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

764 *
__tmp
 = 
__de°
;

765 
__d0
, 
__d1
;

766 
__asm__
 
__vﬁ©ûe__


779 : "=&q" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
),

780 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

781 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

782 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

784  
__tmp
 + 2;

785 
	}
}

787 
__STRING_INLINE
 *
__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
,

788 
size_t
 
__§˛í
);

790 
__STRING_INLINE
 *

791 
	$__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

793 
__d0
, 
__d1
;

794 *
__tmp
 = 
__de°
;

795 
__asm__
 
__vﬁ©ûe__


806 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

807 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

808 : "0" (
__tmp
), "1" (
__§˛í
), "2" (
__§c
),

809 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

811  
__tmp
;

812 
	}
}

814 
__STRING_INLINE
 *
__°p˝y_g
 (*
__de°
, c⁄° *
__§c
);

816 
__STRING_INLINE
 *

817 
	$__°p˝y_g
 (*
__de°
, c⁄° *
__§c
)

819 *
__tmp
 = 
__de°
;

820 
__dummy
;

821 
__asm__
 
__vﬁ©ûe__


830 : "=&r" (
__§c
), "Ù" (
__tmp
), "=&q" (
__dummy
),

831 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

832 : "0" (
__§c
), "1" (
__tmp
),

833 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

835  
__tmp
 - 1;

836 
	}
}

841 
	#_HAVE_STRING_ARCH_°∫˝y
 1

	)

842 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

843 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

844 ? ((
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

845 ? (*Ë
	`mem˝y
 ((*Ë(
de°
), \

846 (c⁄° *Ë(
§c
), 
n
) \

847 : 
	`__°∫˝y_cg
 ((
de°
), (
§c
), 
	`°æí
 (§cË+ 1, 
n
))) \

848 : 
	`__°∫˝y_gg
 ((
de°
), (
§c
), 
n
)))

	)

849 
	#__°∫˝y_cg
(
de°
, 
§c
, 
§˛í
, 
n
) \

850 (((
§˛í
) % 4 == 0) \

851 ? 
	`__°∫˝y_by4
 (
de°
, 
§c
, 
§˛í
, 
n
) \

852 : (((
§˛í
) % 2 == 0) \

853 ? 
	`__°∫˝y_by2
 (
de°
, 
§c
, 
§˛í
, 
n
) \

854 : 
	`__°∫˝y_byn
 (
de°
, 
§c
, 
§˛í
, 
n
)))

	)

856 
__STRING_INLINE
 *
__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[],

857 
size_t
 
__§˛í
, size_à
__n
);

859 
__STRING_INLINE
 *

860 
	$__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

862 *
__tmp
 = 
__de°
;

863 
__dummy1
, 
__dummy2
;

864 
__asm__
 
__vﬁ©ûe__


872 : "=&r" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

873 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

874 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4),

875 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

877 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

878  
__de°
;

879 
	}
}

881 
__STRING_INLINE
 *
__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[],

882 
size_t
 
__§˛í
, size_à
__n
);

884 
__STRING_INLINE
 *

885 
	$__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

887 *
__tmp
 = 
__de°
;

888 
__dummy1
, 
__dummy2
;

889 
__asm__
 
__vﬁ©ûe__


902 : "=&q" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

903 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

904 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

905 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

907 (Ë
	`mem£t
 (
__tmp
 + 2, '\0', 
__n
 - 
__§˛í
);

908  
__de°
;

909 
	}
}

911 
__STRING_INLINE
 *
__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[],

912 
size_t
 
__§˛í
, size_à
__n
);

914 
__STRING_INLINE
 *

915 
	$__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

917 
__d0
, 
__d1
;

918 *
__tmp
 = 
__de°
;

919 
__asm__
 
__vﬁ©ûe__


930 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

931 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

932 : "1" (
__§˛í
), "0" (
__tmp
),"2" (
__§c
),

933 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

935 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

936  
__de°
;

937 
	}
}

939 
__STRING_INLINE
 *
__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
,

940 
size_t
 
__n
);

942 
__STRING_INLINE
 *

943 
	$__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

945 *
__tmp
 = 
__de°
;

946 
__dummy
;

947 i‡(
__n
 > 0)

948 
__asm__
 
__vﬁ©ûe__


964 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
), "=&r" (
__n
)

965 : "0" (
__§c
), "1" (
__tmp
), "3" (
__n
)

968  
__de°
;

969 
	}
}

973 
	#_HAVE_STRING_ARCH_°rˇt
 1

	)

974 
	#°rˇt
(
de°
, 
§c
) \

975 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

976 ? 
	`__°rˇt_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

977 : 
	`__°rˇt_g
 ((
de°
), (
§c
))))

	)

979 
__STRING_INLINE
 *
__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[],

980 
size_t
 
__§˛í
);

982 
__STRING_INLINE
 *

983 
	$__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
)

985 #ifde‡
__i686__


986 
__d0
;

987 *
__tmp
;

988 
__asm__
 
__vﬁ©ûe__


990 : "=D" (
__tmp
), "=&c" (
__d0
),

991 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

992 : "0" (
__de°
), "1" (0xffffffff), "a" (0),

993 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

995 --
__tmp
;

997 *
__tmp
 = 
__de°
 - 1;

998 
__asm__
 
__vﬁ©ûe__


1003 : "Ù" (
__tmp
),

1004 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1005 : "0" (
__tmp
),

1006 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

1009 (Ë
	`mem˝y
 (
__tmp
, 
__§c
, 
__§˛í
);

1010  
__de°
;

1011 
	}
}

1013 
__STRING_INLINE
 *
__°rˇt_g
 (*
__de°
, c⁄° *
__§c
);

1015 
__STRING_INLINE
 *

1016 
	$__°rˇt_g
 (*
__de°
, c⁄° *
__§c
)

1018 *
__tmp
 = 
__de°
 - 1;

1019 
__dummy
;

1020 
__asm__
 
__vﬁ©ûe__


1032 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
),

1033 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1034 : "1" (
__tmp
), "2" (
__§c
),

1035 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

1037  
__de°
;

1038 
	}
}

1042 
	#_HAVE_STRING_ARCH_°∫ˇt
 1

	)

1043 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

1044 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

1045 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

1046 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

1047 ? 
	`°rˇt
 (
__de°
, (
§c
)) \

1048 : (*(*)
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

1049 (c⁄° *Ë(
§c
), \

1050 (
n
)Ë0, 
__de°
)) \

1051 : 
	`__°∫ˇt_g
 (
__de°
, (
§c
), (
n
)); }))

	)

1053 
__STRING_INLINE
 *
__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[],

1054 
size_t
 
__n
);

1056 
__STRING_INLINE
 *

1057 
	$__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__n
)

1059 *
__tmp
 = 
__de°
;

1060 
__dummy
;

1061 #ifde‡
__i686__


1062 
__asm__
 
__vﬁ©ûe__


1076 : "=&a" (
__dummy
), "=&D" (
__tmp
), "=&S" (
__§c
), "=&c" (
__n
)

1077 : "g" (
__n
), "0" (0), "1" (
__tmp
), "2" (
__§c
), "3" (0xffffffff)

1080 --
__tmp
;

1081 
__asm__
 
__vﬁ©ûe__


1098 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__n
)

1099 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
)

1102  
__de°
;

1103 
	}
}

1107 
	#_HAVE_STRING_ARCH_°rcmp
 1

	)

1108 
	#°rcmp
(
s1
, 
s2
) \

1109 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

1110 && ( ((
s1
)[0]Ë!1 || 
	`°æí
 (s1) >= 4) \

1111 && ( ((
s2
)[0]Ë!1 || 
	`°æí
 (s2) >= 4) \

1112 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

1113 (
	`°æí
 (
s1
Ë< såÀ¿(
s2
) \

1114 ? 
	`°æí
 (
s1
Ë: såÀ¿(
s2
)) + 1) \

1115 : (
	`__buûtö_c⁄°™t_p
 (
s1
) &&  ((s1)[0]) == 1 \

1116 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (
s1
) < 4 \

1117 ? (
	`__buûtö_c⁄°™t_p
 (
s2
) &&  ((s2)[0]) == 1 \

1118 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1119 (c⁄° *Ë(
s2
), \

1120 
	`°æí
 (
s1
)) \

1121 : 
	`__°rcmp_cg
 ((c⁄° *Ë(
s1
), \

1122 (c⁄° *Ë(
s2
), \

1123 
	`°æí
 (
s1
))) \

1124 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&&  ((
s1
)[0]) == 1 \

1125 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (s2) < 4 \

1126 ? (
	`__buûtö_c⁄°™t_p
 (
s1
) \

1127 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1128 (c⁄° *Ë(
s2
), \

1129 
	`°æí
 (
s2
)) \

1130 : 
	`__°rcmp_gc
 ((c⁄° *Ë(
s1
), \

1131 (c⁄° *Ë(
s2
), \

1132 
	`°æí
 (
s2
))) \

1133 : 
	`__°rcmp_gg
 ((
s1
), (
s2
))))))

	)

1135 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

1136 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = (
s1
)[0] - (
s2
)[0]; \

1137 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

1139 
__ªsu…
 = (
s1
)[1] - (
s2
)[1]; \

1140 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

1142 
__ªsu…
 = (
s1
)[2] - (
s2
)[2]; \

1143 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

1144 
__ªsu…
 = (
s1
)[3] - (
s2
)[3]; \

1147 
__ªsu…
; }))

	)

1149 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

1150 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = (
s2
); \

1151 
__ªsu…
 = (
s1
)[0] - 
__s2
[0]; \

1152 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

1154 
__ªsu…
 = (
s1
)[1] - 
__s2
[1]; \

1155 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

1157 
__ªsu…
 = (
s1
)[2] - 
__s2
[2]; \

1158 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

1159 
__ªsu…
 = (
s1
)[3] - 
__s2
[3]; \

1162 
__ªsu…
; }))

	)

1164 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

1165 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = (
s1
); \

1166 
__ªsu…
 = 
__s1
[0] - (
s2
)[0]; \

1167 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

1169 
__ªsu…
 = 
__s1
[1] - (
s2
)[1]; \

1170 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

1172 
__ªsu…
 = 
__s1
[2] - (
s2
)[2]; \

1173 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

1174 
__ªsu…
 = 
__s1
[3] - (
s2
)[3]; \

1177 
__ªsu…
; }))

	)

1179 
__STRING_INLINE
 
__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
);

1181 
__STRING_INLINE
 

1182 
	$__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
)

1184 
__ªs
;

1185 
__asm__
 
__vﬁ©ûe__


1201 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
)

1202 : "1" (
__s1
), "2" (
__s2
),

1203 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s1
),

1204 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s2
)

1206  
__ªs
;

1207 
	}
}

1211 
	#_HAVE_STRING_ARCH_°∫cmp
 1

	)

1212 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

1213 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`°æí
 (s1Ë< ((
size_t
Ë(
n
)) \

1214 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1215 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`°æí
 (s2Ë< ((
size_t
Ë(
n
))\

1216 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1217 : 
	`__°∫cmp_g
 ((
s1
), (
s2
), (
n
)))))

	)

1219 
__STRING_INLINE
 
__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
,

1220 
size_t
 
__n
);

1222 
__STRING_INLINE
 

1223 
	$__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

1225 
__ªs
;

1226 
__asm__
 
__vﬁ©ûe__


1245 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
), "=&r" (
__n
)

1246 : "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

1247 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

1248 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

1250  
__ªs
;

1251 
	}
}

1255 
	#_HAVE_STRING_ARCH_°rchr
 1

	)

1256 
	#_USE_STRING_ARCH_°rchr
 1

	)

1257 
	#°rchr
(
s
, 
c
) \

1258 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1259 ? ((
c
) == '\0' \

1260 ? (*Ë
	`__øwmemchr
 ((
s
), (
c
)) \

1261 : 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1262 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1264 
__STRING_INLINE
 *
__°rchr_c
 (c⁄° *
__s
, 
__c
);

1266 
__STRING_INLINE
 *

1267 
	$__°rchr_c
 (c⁄° *
__s
, 
__c
)

1269 
__d0
;

1270 *
__ªs
;

1271 
__asm__
 
__vﬁ©ûe__


1281 : "Ù" (
__ªs
), "=&a" (
__d0
)

1282 : "0" (
__s
), "1" (
__c
),

1283 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1285  
__ªs
;

1286 
	}
}

1288 
__STRING_INLINE
 *
__°rchr_g
 (c⁄° *
__s
, 
__c
);

1290 
__STRING_INLINE
 *

1291 
	$__°rchr_g
 (c⁄° *
__s
, 
__c
)

1293 
__d0
;

1294 *
__ªs
;

1295 
__asm__
 
__vﬁ©ûe__


1306 : "Ù" (
__ªs
), "=&a" (
__d0
)

1307 : "0" (
__s
), "1" (
__c
),

1308 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1310  
__ªs
;

1311 
	}
}

1315 
	#_HAVE_STRING_ARCH_°rch∫ul
 1

	)

1316 
	#__°rch∫ul
(
s
, 
c
) \

1317 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1318 ? ((
c
) == '\0' \

1319 ? (*Ë
	`__øwmemchr
 ((
s
), 
c
) \

1320 : 
	`__°rch∫ul_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1321 : 
	`__°rch∫ul_g
 ((
s
), 
c
)))

	)

1323 
__STRING_INLINE
 *
__°rch∫ul_c
 (c⁄° *
__s
, 
__c
);

1325 
__STRING_INLINE
 *

1326 
	$__°rch∫ul_c
 (c⁄° *
__s
, 
__c
)

1328 
__d0
;

1329 *
__ªs
;

1330 
__asm__
 
__vﬁ©ûe__


1340 : "Ù" (
__ªs
), "=&a" (
__d0
)

1341 : "0" (
__s
), "1" (
__c
),

1342 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1344  
__ªs
;

1345 
	}
}

1347 
__STRING_INLINE
 *
__°rch∫ul_g
 (c⁄° *
__s
, 
__c
);

1349 
__STRING_INLINE
 *

1350 
	$__°rch∫ul_g
 (c⁄° *
__s
, 
__c
)

1352 
__d0
;

1353 *
__ªs
;

1354 
__asm__
 
__vﬁ©ûe__


1365 : "Ù" (
__ªs
), "=&a" (
__d0
)

1366 : "0" (
__s
), "1" (
__c
),

1367 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1369  
__ªs
;

1370 
	}
}

1371 #ifde‡
__USE_GNU


1372 
	#°rch∫ul
(
s
, 
c
Ë
	`__°rch∫ul
 ((s), (c))

	)

1376 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1378 
	#_HAVE_STRING_ARCH_ödex
 1

	)

1379 
	#ödex
(
s
, 
c
) \

1380 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1381 ? 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1382 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1387 
	#_HAVE_STRING_ARCH_°ºchr
 1

	)

1388 
	#°ºchr
(
s
, 
c
) \

1389 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1390 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1391 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1393 #ifde‡
__i686__


1394 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1396 
__STRING_INLINE
 *

1397 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1399 
__d0
, 
__d1
;

1400 *
__ªs
;

1401 
__asm__
 
__vﬁ©ûe__


1409 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1410 : "0" (1), "1" (
__s
), "2" (
__c
),

1411 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1413  
__ªs
 - 1;

1414 
	}
}

1416 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1418 
__STRING_INLINE
 *

1419 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1421 
__d0
, 
__d1
;

1422 *
__ªs
;

1423 
__asm__
 
__vﬁ©ûe__


1432 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1433 : "0" (1), "1" (
__s
), "2" (
__c
),

1434 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1436  
__ªs
 - 1;

1437 
	}
}

1439 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1441 
__STRING_INLINE
 *

1442 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1444 
__d0
, 
__d1
;

1445 *
__ªs
;

1446 
__asm__
 
__vﬁ©ûe__


1456 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1457 : "0" (0), "1" (
__s
), "2" (
__c
),

1458 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1460  
__ªs
;

1461 
	}
}

1463 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1465 
__STRING_INLINE
 *

1466 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1468 
__d0
, 
__d1
;

1469 *
__ªs
;

1470 
__asm__
 
__vﬁ©ûe__


1481 : "Ù" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1482 : "0" (0), "1" (
__s
), "2" (
__c
),

1483 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1485  
__ªs
;

1486 
	}
}

1490 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1492 
	#_HAVE_STRING_ARCH_rödex
 1

	)

1493 
	#rödex
(
s
, 
c
) \

1494 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1495 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1496 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1502 
	#_HAVE_STRING_ARCH_°rc•n
 1

	)

1503 
	#°rc•n
(
s
, 
ªje˘
) \

1504 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
) &&  ((reject)[0]) == 1 \

1505 ? ((
ªje˘
)[0] == '\0' \

1506 ? 
	`°æí
 (
s
) \

1507 : ((
ªje˘
)[1] == '\0' \

1508 ? 
	`__°rc•n_c1
 ((
s
), (((
ªje˘
)[0] << 8) & 0xff00)) \

1509 : 
	`__°rc•n_cg
 ((
s
), (
ªje˘
), 
	`°æí
 (reject)))) \

1510 : 
	`__°rc•n_g
 ((
s
), (
ªje˘
))))

	)

1512 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

1514 #i‚de‡
_FORCE_INLINES


1515 
__STRING_INLINE
 
size_t


1516 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

1518 
__d0
;

1519 *
__ªs
;

1520 
__asm__
 
__vﬁ©ûe__


1529 : "Ù" (
__ªs
), "=&a" (
__d0
)

1530 : "0" (
__s
), "1" (
__ªje˘
),

1531 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1533  (
__ªs
 - 1Ë- 
__s
;

1534 
	}
}

1537 
__STRING_INLINE
 
size_t
 
__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[],

1538 
size_t
 
__ªje˘_Àn
);

1540 
__STRING_INLINE
 
size_t


1541 
	$__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[], 
size_t
 
__ªje˘_Àn
)

1543 
__d0
, 
__d1
, 
__d2
;

1544 c⁄° *
__ªs
;

1545 
__asm__
 
__vﬁ©ûe__


1556 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1557 : "0" (
__s
), "d" (
__ªje˘
), "g" (
__ªje˘_Àn
)

1559  (
__ªs
 - 1Ë- 
__s
;

1560 
	}
}

1562 
__STRING_INLINE
 
size_t
 
__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
);

1563 #ifde‡
__PIC__


1565 
__STRING_INLINE
 
size_t


1566 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1568 
__d0
, 
__d1
, 
__d2
;

1569 c⁄° *
__ªs
;

1570 
__asm__
 
__vﬁ©ûe__


1587 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1588 : "r" (
__ªje˘
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1590  (
__ªs
 - 1Ë- 
__s
;

1591 
	}
}

1593 
__STRING_INLINE
 
size_t


1594 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1596 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1597 c⁄° *
__ªs
;

1598 
__asm__
 
__vﬁ©ûe__


1612 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1613 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ªje˘
), "b" (__reject)

1616  (
__ªs
 - 1Ë- 
__s
;

1617 
	}
}

1623 
	#_HAVE_STRING_ARCH_°r•n
 1

	)

1624 
	#°r•n
(
s
, 
ac˚±
) \

1625 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1626 ? ((
ac˚±
)[0] == '\0' \

1627 ? ((Ë(
s
), 0) \

1628 : ((
ac˚±
)[1] == '\0' \

1629 ? 
	`__°r•n_c1
 ((
s
), (((
ac˚±
)[0] << 8 ) & 0xff00)) \

1630 : 
	`__°r•n_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1631 : 
	`__°r•n_g
 ((
s
), (
ac˚±
))))

	)

1633 #i‚de‡
_FORCE_INLINES


1634 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1636 
__STRING_INLINE
 
size_t


1637 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1639 
__d0
;

1640 *
__ªs
;

1642 
__asm__
 
__vﬁ©ûe__


1648 : "Ù" (
__ªs
), "=&q" (
__d0
)

1649 : "0" (
__s
), "1" (
__ac˚±
),

1650 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1652  (
__ªs
 - 1Ë- 
__s
;

1653 
	}
}

1656 
__STRING_INLINE
 
size_t
 
__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1657 
size_t
 
__ac˚±_Àn
);

1659 
__STRING_INLINE
 
size_t


1660 
	$__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1662 
__d0
, 
__d1
, 
__d2
;

1663 c⁄° *
__ªs
;

1664 
__asm__
 
__vﬁ©ûe__


1675 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1676 : "0" (
__s
), "g" (
__ac˚±
), "g" (
__ac˚±_Àn
),

1679 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
),

1680 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__ac˚±_Àn
]; } *)
__ac˚±
)

1682  (
__ªs
 - 1Ë- 
__s
;

1683 
	}
}

1685 
__STRING_INLINE
 
size_t
 
__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1686 #ifde‡
__PIC__


1688 
__STRING_INLINE
 
size_t


1689 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1691 
__d0
, 
__d1
, 
__d2
;

1692 c⁄° *
__ªs
;

1693 
__asm__
 
__vﬁ©ûe__


1709 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1710 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (__accept)

1712  (
__ªs
 - 1Ë- 
__s
;

1713 
	}
}

1715 
__STRING_INLINE
 
size_t


1716 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1718 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1719 c⁄° *
__ªs
;

1720 
__asm__
 
__vﬁ©ûe__


1734 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1735 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ac˚±
), "b" (__accept)

1737  (
__ªs
 - 1Ë- 
__s
;

1738 
	}
}

1743 
	#_HAVE_STRING_ARCH_°Ωbrk
 1

	)

1744 
	#°Ωbrk
(
s
, 
ac˚±
) \

1745 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1746 ? ((
ac˚±
)[0] == '\0' \

1747 ? ((Ë(
s
), (*) 0) \

1748 : ((
ac˚±
)[1] == '\0' \

1749 ? 
	`°rchr
 ((
s
), (
ac˚±
)[0]) \

1750 : 
	`__°Ωbrk_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1751 : 
	`__°Ωbrk_g
 ((
s
), (
ac˚±
))))

	)

1753 
__STRING_INLINE
 *
__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1754 
size_t
 
__ac˚±_Àn
);

1756 
__STRING_INLINE
 *

1757 
	$__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1759 
__d0
, 
__d1
, 
__d2
;

1760 *
__ªs
;

1761 
__asm__
 
__vﬁ©ûe__


1776 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1777 : "0" (
__s
), "d" (
__ac˚±
), "g" (
__ac˚±_Àn
)

1779  
__ªs
;

1780 
	}
}

1782 
__STRING_INLINE
 *
__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1783 #ifde‡
__PIC__


1785 
__STRING_INLINE
 *

1786 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1788 
__d0
, 
__d1
, 
__d2
;

1789 *
__ªs
;

1790 
__asm__
 
__vﬁ©ûe__


1811 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1812 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1814  
__ªs
;

1815 
	}
}

1817 
__STRING_INLINE
 *

1818 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1820 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1821 *
__ªs
;

1822 
__asm__
 
__vﬁ©ûe__


1841 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

1842 : "0" (
__s
), "1" (0), "2" (0xffffffff), "b" (
__ac˚±
)

1844  
__ªs
;

1845 
	}
}

1850 
	#_HAVE_STRING_ARCH_°r°r
 1

	)

1851 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1852 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
) &&  ((needle)[0]) == 1 \

1853 ? ((
√edÀ
)[0] == '\0' \

1854 ? (
hay°ack
) \

1855 : ((
√edÀ
)[1] == '\0' \

1856 ? 
	`°rchr
 ((
hay°ack
), (
√edÀ
)[0]) \

1857 : 
	`__°r°r_cg
 ((
hay°ack
), (
√edÀ
), \

1858 
	`°æí
 (
√edÀ
)))) \

1859 : 
	`__°r°r_g
 ((
hay°ack
), (
√edÀ
))))

	)

1863 
__STRING_INLINE
 *
__°r°r_cg
 (c⁄° *
__hay°ack
,

1864 c⁄° 
__√edÀ
[],

1865 
size_t
 
__√edÀ_Àn
);

1867 
__STRING_INLINE
 *

1868 
	$__°r°r_cg
 (c⁄° *
__hay°ack
, c⁄° 
__√edÀ
[],

1869 
size_t
 
__√edÀ_Àn
)

1871 
__d0
, 
__d1
, 
__d2
;

1872 *
__ªs
;

1873 
__asm__
 
__vﬁ©ûe__


1886 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

1887 : "g" (
__√edÀ_Àn
), "1" (
__hay°ack
), "d" (
__√edÀ
)

1889  
__ªs
;

1890 
	}
}

1892 
__STRING_INLINE
 *
__°r°r_g
 (c⁄° *
__hay°ack
,

1893 c⁄° *
__√edÀ
);

1894 #ifde‡
__PIC__


1896 
__STRING_INLINE
 *

1897 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1899 
__d0
, 
__d1
, 
__d2
;

1900 *
__ªs
;

1901 
__asm__
 
__vﬁ©ûe__


1920 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

1921 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1922 "d" (
__√edÀ
)

1924  
__ªs
;

1925 
	}
}

1927 
__STRING_INLINE
 *

1928 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1930 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1931 *
__ªs
;

1932 
__asm__
 
__vﬁ©ûe__


1949 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1950 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1951 "b" (
__√edÀ
)

1953  
__ªs
;

1954 
	}
}

1960 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1961 #ifde‡
__i686__


1962 
	#_HAVE_STRING_ARCH_ffs
 1

	)

1963 
	#ffs
(
w‹d
Ë(
	`__buûtö_c⁄°™t_p
 (word) \

1964 ? 
	`__buûtö_ffs
 (
w‹d
) \

1965 : ({ 
__˙t
, 
__tmp
; \

1966 
__asm__
 
__vﬁ©ûe__
 \

1969 : "=&r" (
__˙t
), "Ù" (
__tmp
) \

1970 : "rm" (
w‹d
), "1" (-1)); \

1971 
__˙t
 + 1; }))

	)

1973 #i‚de‡
ff¶


1974 
	#ff¶
(
w‹d
Ë
	`ffs
(w‹d)

	)

1979 #i‚de‡
_FORCE_INLINES


1980 #unde‡
__STRING_INLINE


	@/usr/include/bits/string2.h

20 #i‚de‡
_STRING_H


24 #i‚de‡
__NO_STRING_INLINES


41 #i‚de‡
__STRING_INLINE


42 #ifde‡
__˝lu•lus


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

49 #i‡
_STRING_ARCH_u«lig√d


51 
	~<ídün.h
>

52 
	~<bôs/ty≥s.h
>

54 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


55 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

56 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1] << 8 \

57 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

58 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

59 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

60 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

61 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

62 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

64 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

65 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

66 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1])

	)

67 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

68 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

69 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

70 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

71 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3])

	)

76 
	#__STRING2_COPY_TYPE
(
N
) \

77 °ru˘ { 
__¨r
[
N
]; } \

78 
	t__©åibuã__
 ((
	t__∑cked__
)Ë
	t__STRING2_COPY_ARR
##
	tN


	)

79 
	t__STRING2_COPY_TYPE
 (2);

80 
__STRING2_COPY_TYPE
 (3);

81 
__STRING2_COPY_TYPE
 (4);

82 
__STRING2_COPY_TYPE
 (5);

83 
__STRING2_COPY_TYPE
 (6);

84 
__STRING2_COPY_TYPE
 (7);

85 
__STRING2_COPY_TYPE
 (8);

86 #unde‡
__STRING2_COPY_TYPE


92 
	#__°rög2_1b±r_p
(
__x
) \

93 ((
size_t
)(c⁄° *)((
__x
Ë+ 1Ë- (size_t)(c⁄° *)(__xË=1)

	)

96 #i‡!
deföed
 
_HAVE_STRING_ARCH_mem£t


97 #i‡!
__GNUC_PREREQ
 (3, 0)

98 #i‡
_STRING_ARCH_u«lig√d


99 
	#mem£t
(
s
, 
c
, 
n
) \

100 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

101 ? ((
n
) == 1 \

102 ? 
	`__mem£t_1
 (
s
, 
c
) \

103 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

104 : (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

105 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

106 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

108 
	#__mem£t_1
(
s
, 
c
Ë({ *
__s
 = (s); \

109 *((
__uöt8_t
 *Ë
__s
Ë(__uöt8_tË
c
; __s; })

	)

111 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

112 ({ *
__s
 = (
s
); \

114 
__ui
; \

115 
__usi
; \

116 
__uc
; \

117 } *
__u
 = 
__s
; \

118 
__uöt8_t
 
__c
 = (__uöt8_tË(
c
); \

121 (Ë(
n
)) \

124 
__u
->
__ui
 = 
__c
 * 0x01010101; \

125 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

127 
__u
->
__ui
 = 
__c
 * 0x01010101; \

128 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

130 
__u
->
__ui
 = 
__c
 * 0x01010101; \

131 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

133 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

134 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

135 
__u
->
__uc
 = (Ë
__c
; \

139 
__u
->
__ui
 = 
__c
 * 0x01010101; \

140 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

142 
__u
->
__ui
 = 
__c
 * 0x01010101; \

143 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

145 
__u
->
__ui
 = 
__c
 * 0x01010101; \

146 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

148 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

152 
__u
->
__ui
 = 
__c
 * 0x01010101; \

153 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

155 
__u
->
__ui
 = 
__c
 * 0x01010101; \

156 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

158 
__u
->
__ui
 = 
__c
 * 0x01010101; \

159 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

161 
__u
->
__uc
 = (Ë
__c
; \

165 
__u
->
__ui
 = 
__c
 * 0x01010101; \

166 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

168 
__u
->
__ui
 = 
__c
 * 0x01010101; \

169 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

171 
__u
->
__ui
 = 
__c
 * 0x01010101; \

172 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

174 
__u
->
__ui
 = 
__c
 * 0x01010101; \

179 
__s
; })

	)

181 
	#mem£t
(
s
, 
c
, 
n
) \

182 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

183 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

184 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

193 #i‡
__GNUC_PREREQ
 (2, 91)

194 
	#__bzîo
(
s
, 
n
Ë
	`__buûtö_mem£t
 (s, '\0',Ç)

	)

202 #ifde‡
__USE_GNU


203 #i‡!
deföed
 
_HAVE_STRING_ARCH_memp˝y
 || deföed 
_FORCE_INLINES


204 #i‚de‡
_HAVE_STRING_ARCH_memp˝y


205 #i‡
__GNUC_PREREQ
 (3, 4)

206 
	#__memp˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_memp˝y
 (de°, src,Ç)

	)

207 #ñi‡
__GNUC_PREREQ
 (3, 0)

208 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

209 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

210 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

211 ? 
	`__buûtö_mem˝y
 (
de°
, 
§c
, 
n
) + (n) \

212 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

214 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

215 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

216 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

217 ? 
	`__memp˝y_smÆl
 (
de°
, 
	`__memp˝y_¨gs
 (
§c
), 
n
) \

218 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

222 
	#memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y
 (de°, src,Ç)

	)

225 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


226 #i‡
_STRING_ARCH_u«lig√d


227 #i‚de‡
_FORCE_INLINES


228 
	#__memp˝y_¨gs
(
§c
) \

229 ((c⁄° *Ë(
§c
))[0], ((const *) (src))[2], \

230 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[6], \

231 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

232 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

233 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

234 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

236 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , , , ,

237 
__uöt16_t
, __uöt16_t, 
__uöt32_t
,

238 
__uöt32_t
, 
size_t
);

239 
__STRING_INLINE
 *

240 
	$__memp˝y_smÆl
 (*
__de°1
,

241 
__§c0_1
, 
__§c2_1
, 
__§c4_1
, 
__§c6_1
,

242 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

243 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

244 
size_t
 
__§˛í
)

247 
__uöt32_t
 
__ui
;

248 
__uöt16_t
 
__usi
;

249 
__uc
;

250 
__c
;

251 } *
__u
 = 
__de°1
;

252 (Ë
__§˛í
)

255 
__u
->
__c
 = 
__§c0_1
;

256 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

259 
__u
->
__usi
 = 
__§c0_2
;

260 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

263 
__u
->
__usi
 = 
__§c0_2
;

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

265 
__u
->
__c
 = 
__§c2_1
;

266 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

269 
__u
->
__ui
 = 
__§c0_4
;

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

273 
__u
->
__ui
 = 
__§c0_4
;

274 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

275 
__u
->
__c
 = 
__§c4_1
;

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

279 
__u
->
__ui
 = 
__§c0_4
;

280 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

281 
__u
->
__usi
 = 
__§c4_2
;

282 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

285 
__u
->
__ui
 = 
__§c0_4
;

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

287 
__u
->
__usi
 = 
__§c4_2
;

288 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

289 
__u
->
__c
 = 
__§c6_1
;

290 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

293 
__u
->
__ui
 = 
__§c0_4
;

294 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

295 
__u
->
__ui
 = 
__§c4_4
;

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

299  (*Ë
__u
;

300 
	}
}

302 #i‚de‡
_FORCE_INLINES


303 
	#__memp˝y_¨gs
(
§c
) \

304 ((c⁄° *Ë(
§c
))[0], \

305 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

306 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1] } }), \

307 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

308 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

309 ((c⁄° *Ë(
§c
))[2] } }), \

310 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

311 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

312 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3] } }), \

313 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

314 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

315 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

316 ((c⁄° *Ë(
§c
))[4] } }), \

317 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

318 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

319 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

320 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5] } }), \

321 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

322 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

323 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

324 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

325 ((c⁄° *Ë(
§c
))[6] } }), \

326 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

327 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

328 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

329 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

330 ((c⁄° *Ë(
§c
))[6], ((c⁄° *Ë(§c))[7] } })

	)

332 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , 
__STRING2_COPY_ARR2
,

333 
__STRING2_COPY_ARR3
,

334 
__STRING2_COPY_ARR4
,

335 
__STRING2_COPY_ARR5
,

336 
__STRING2_COPY_ARR6
,

337 
__STRING2_COPY_ARR7
,

338 
__STRING2_COPY_ARR8
, 
size_t
);

339 
__STRING_INLINE
 *

340 
	$__memp˝y_smÆl
 (*
__de°
, 
__§c1
,

341 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

342 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

343 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

344 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

347 
__c
;

348 
__STRING2_COPY_ARR2
 
__sˇ2
;

349 
__STRING2_COPY_ARR3
 
__sˇ3
;

350 
__STRING2_COPY_ARR4
 
__sˇ4
;

351 
__STRING2_COPY_ARR5
 
__sˇ5
;

352 
__STRING2_COPY_ARR6
 
__sˇ6
;

353 
__STRING2_COPY_ARR7
 
__sˇ7
;

354 
__STRING2_COPY_ARR8
 
__sˇ8
;

355 } *
__u
 = 
__de°
;

356 (Ë
__§˛í
)

359 
__u
->
__c
 = 
__§c1
;

362 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

365 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

368 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

371 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

374 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

377 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

380 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

383  
	`__exãnsi⁄__
 ((*Ë
__u
 + 
__§˛í
);

384 
	}
}

392 #i‚de‡
_HAVE_STRING_ARCH_°rchr


393 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

394 #i‡
__GNUC_PREREQ
 (3, 2)

395 
	#°rchr
(
s
, 
c
) \

396 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
Ë&& !__buûtö_c⁄°™t_∞(
s
) \

397 && (
c
) == '\0' \

398 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

399 : 
	`__buûtö_°rchr
 (
s
, 
c
)))

	)

401 
	#°rchr
(
s
, 
c
) \

402 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

403 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

404 : 
	`°rchr
 (
s
, 
c
)))

	)

410 #i‡(!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)) \

411 || 
deföed
 
	g_FORCE_INLINES


412 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)

413 
	#°r˝y
(
de°
, 
§c
) \

414 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

415 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

416 ? 
	`__°r˝y_smÆl
 (
de°
, 
	`__°r˝y_¨gs
 (
§c
), \

417 
	`°æí
 (
§c
) + 1) \

418 : (*Ë
	`mem˝y
 (
de°
, 
§c
, 
	`°æí
 (src) + 1)) \

419 : 
	`°r˝y
 (
de°
, 
§c
)))

	)

422 #i‡
_STRING_ARCH_u«lig√d


423 #i‚de‡
_FORCE_INLINES


424 
	#__°r˝y_¨gs
(
§c
) \

425 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

426 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

427 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

428 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

430 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

431 
__uöt32_t
, __uöt32_t, 
size_t
);

432 
__STRING_INLINE
 *

433 
	$__°r˝y_smÆl
 (*
__de°
,

434 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

435 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

436 
size_t
 
__§˛í
)

439 
__uöt32_t
 
__ui
;

440 
__uöt16_t
 
__usi
;

441 
__uc
;

442 } *
__u
 = (*Ë
__de°
;

443 (Ë
__§˛í
)

446 
__u
->
__uc
 = '\0';

449 
__u
->
__usi
 = 
__§c0_2
;

452 
__u
->
__usi
 = 
__§c0_2
;

453 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

454 
__u
->
__uc
 = '\0';

457 
__u
->
__ui
 = 
__§c0_4
;

460 
__u
->
__ui
 = 
__§c0_4
;

461 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

462 
__u
->
__uc
 = '\0';

465 
__u
->
__ui
 = 
__§c0_4
;

466 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

467 
__u
->
__usi
 = 
__§c4_2
;

470 
__u
->
__ui
 = 
__§c0_4
;

471 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

472 
__u
->
__usi
 = 
__§c4_2
;

473 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

474 
__u
->
__uc
 = '\0';

477 
__u
->
__ui
 = 
__§c0_4
;

478 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

479 
__u
->
__ui
 = 
__§c4_4
;

482  
__de°
;

483 
	}
}

485 #i‚de‡
_FORCE_INLINES


486 
	#__°r˝y_¨gs
(
§c
) \

487 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

488 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

489 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

490 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

492 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

493 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

494 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

495 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

496 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

497 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

499 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

500 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

501 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

502 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

503 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

504 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

505 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

506 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

508 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

509 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

510 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

511 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

512 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

514 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

515 
__STRING2_COPY_ARR3
,

516 
__STRING2_COPY_ARR4
,

517 
__STRING2_COPY_ARR5
,

518 
__STRING2_COPY_ARR6
,

519 
__STRING2_COPY_ARR7
,

520 
__STRING2_COPY_ARR8
, 
size_t
);

521 
__STRING_INLINE
 *

522 
	$__°r˝y_smÆl
 (*
__de°
,

523 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

524 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

525 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

526 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

529 
__c
;

530 
__STRING2_COPY_ARR2
 
__sˇ2
;

531 
__STRING2_COPY_ARR3
 
__sˇ3
;

532 
__STRING2_COPY_ARR4
 
__sˇ4
;

533 
__STRING2_COPY_ARR5
 
__sˇ5
;

534 
__STRING2_COPY_ARR6
 
__sˇ6
;

535 
__STRING2_COPY_ARR7
 
__sˇ7
;

536 
__STRING2_COPY_ARR8
 
__sˇ8
;

537 } *
__u
 = (*Ë
__de°
;

538 (Ë
__§˛í
)

541 
__u
->
__c
 = '\0';

544 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

547 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

550 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

553 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

556 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

559 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

562 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

565  
__de°
;

566 
	}
}

572 #ifde‡
__USE_GNU


573 #i‡!
deföed
 
_HAVE_STRING_ARCH_°p˝y
 || deföed 
_FORCE_INLINES


574 #i‚de‡
_HAVE_STRING_ARCH_°p˝y


575 #i‡
__GNUC_PREREQ
 (3, 4)

576 
	#__°p˝y
(
de°
, 
§c
Ë
	`__buûtö_°p˝y
 (de°, src)

	)

577 #ñi‡
__GNUC_PREREQ
 (3, 0)

578 
	#__°p˝y
(
de°
, 
§c
) \

579 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

580 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

581 ? 
	`__buûtö_°r˝y
 (
de°
, 
§c
Ë+ 
	`°æí
 (src) \

582 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

584 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

586 
	#__°p˝y
(
de°
, 
§c
) \

587 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

588 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

589 ? 
	`__°p˝y_smÆl
 (
de°
, 
	`__°p˝y_¨gs
 (
§c
), \

590 
	`°æí
 (
§c
) + 1) \

591 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

593 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

597 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 (de°, src)

	)

600 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


601 #i‡
_STRING_ARCH_u«lig√d


602 #i‚de‡
_FORCE_INLINES


603 
	#__°p˝y_¨gs
(
§c
) \

604 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

605 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

606 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

607 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

609 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

610 
__uöt32_t
, __uöt32_t, 
size_t
);

611 
__STRING_INLINE
 *

612 
	$__°p˝y_smÆl
 (*
__de°
,

613 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

614 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

615 
size_t
 
__§˛í
)

618 
__ui
;

619 
__usi
;

620 
__uc
;

621 
__c
;

622 } *
__u
 = (*Ë
__de°
;

623 (Ë
__§˛í
)

626 
__u
->
__uc
 = '\0';

629 
__u
->
__usi
 = 
__§c0_2
;

630 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

633 
__u
->
__usi
 = 
__§c0_2
;

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

635 
__u
->
__uc
 = '\0';

638 
__u
->
__ui
 = 
__§c0_4
;

639 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

642 
__u
->
__ui
 = 
__§c0_4
;

643 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

644 
__u
->
__uc
 = '\0';

647 
__u
->
__ui
 = 
__§c0_4
;

648 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

649 
__u
->
__usi
 = 
__§c4_2
;

650 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

653 
__u
->
__ui
 = 
__§c0_4
;

654 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

655 
__u
->
__usi
 = 
__§c4_2
;

656 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

657 
__u
->
__uc
 = '\0';

660 
__u
->
__ui
 = 
__§c0_4
;

661 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

662 
__u
->
__ui
 = 
__§c4_4
;

663 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

666  &
__u
->
__c
;

667 
	}
}

669 #i‚de‡
_FORCE_INLINES


670 
	#__°p˝y_¨gs
(
§c
) \

671 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

672 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

673 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

674 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

676 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

677 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

678 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

679 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

680 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

681 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

683 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

684 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

685 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

686 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

687 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

688 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

689 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

690 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

692 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

693 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

694 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

695 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

696 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

698 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

699 
__STRING2_COPY_ARR3
,

700 
__STRING2_COPY_ARR4
,

701 
__STRING2_COPY_ARR5
,

702 
__STRING2_COPY_ARR6
,

703 
__STRING2_COPY_ARR7
,

704 
__STRING2_COPY_ARR8
, 
size_t
);

705 
__STRING_INLINE
 *

706 
	$__°p˝y_smÆl
 (*
__de°
,

707 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

708 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

709 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

710 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

713 
__c
;

714 
__STRING2_COPY_ARR2
 
__sˇ2
;

715 
__STRING2_COPY_ARR3
 
__sˇ3
;

716 
__STRING2_COPY_ARR4
 
__sˇ4
;

717 
__STRING2_COPY_ARR5
 
__sˇ5
;

718 
__STRING2_COPY_ARR6
 
__sˇ6
;

719 
__STRING2_COPY_ARR7
 
__sˇ7
;

720 
__STRING2_COPY_ARR8
 
__sˇ8
;

721 } *
__u
 = (*Ë
__de°
;

722 (Ë
__§˛í
)

725 
__u
->
__c
 = '\0';

728 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

731 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

734 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

737 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

740 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

743 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

746 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

749  
__de°
 + 
__§˛í
 - 1;

750 
	}
}

758 #i‚de‡
_HAVE_STRING_ARCH_°∫˝y


759 #i‡
__GNUC_PREREQ
 (3, 2)

760 
	#°∫˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫˝y
 (de°, src,Ç)

	)

762 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

763 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

764 ? (
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

765 ? (*Ë
	`mem˝y
 (
de°
, 
§c
, 
n
) \

766 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)) \

767 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)))

	)

773 #i‚de‡
_HAVE_STRING_ARCH_°∫ˇt


774 #ifde‡
_USE_STRING_ARCH_°rchr


775 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

776 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

777 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

778 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

779 ? 
	`°rˇt
 (
__de°
, 
§c
) \

780 : (*((*Ë
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

781 
§c
, 
n
)Ë'\0', 
__de°
)) \

782 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
); }))

	)

783 #ñi‡
__GNUC_PREREQ
 (3, 2)

784 
	#°∫ˇt
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫ˇt
 (de°, src,Ç)

	)

786 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

787 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

788 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

789 ? 
	`°rˇt
 (
de°
, 
§c
) \

790 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)) \

791 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)))

	)

797 #i‚de‡
_HAVE_STRING_ARCH_°rcmp


798 #i‡
__GNUC_PREREQ
 (3, 2)

799 
	#°rcmp
(
s1
, 
s2
) \

800 
__exãnsi⁄__
 \

801 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

802 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

803 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

804 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

805 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

806 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

807 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

808 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

809 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

810 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

811 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

812 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

813 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

814 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

815 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

816 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

817 : 
	`__buûtö_°rcmp
 (
s1
, 
s2
)))); })

	)

819 
	#°rcmp
(
s1
, 
s2
) \

820 
__exãnsi⁄__
 \

821 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

822 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

823 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

824 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

825 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

826 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

827 (
__s1_Àn
 < 
__s2_Àn
 ? __s1_len : __s2_len) + 1) \

828 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

829 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

830 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

831 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s1_Àn
) \

832 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

833 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

834 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

835 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

836 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s2_Àn
) \

837 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

838 : 
	`°rcmp
 (
s1
, 
s2
)))); })

	)

841 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

842 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = \

843 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

844 - ((c⁄° *Ë(c⁄° *)(
s2
))[0]); \

845 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

847 
__ªsu…
 = (((const *) \

848 (c⁄° *Ë(
s1
))[1] \

850 (c⁄° *Ë(
s2
))[1]); \

851 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

853 
__ªsu…
 = \

855 (c⁄° *Ë(
s1
))[2] \

857 (c⁄° *Ë(
s2
))[2]); \

858 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

859 
__ªsu…
 = \

861 (c⁄° *Ë(
s1
))[3] \

863 (c⁄° *Ë(
s2
))[3]); \

866 
__ªsu…
; }))

	)

868 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

869 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = \

870 (c⁄° *Ë(c⁄° *Ë(
s2
); \

871 
__ªsu…
 = \

872 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

873 - 
__s2
[0]); \

874 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

876 
__ªsu…
 = (((const *) \

877 (c⁄° *Ë(
s1
))[1] - 
__s2
[1]); \

878 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

880 
__ªsu…
 = (((const *) \

881 (c⁄° *Ë(
s1
))[2] - 
__s2
[2]); \

882 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

883 
__ªsu…
 = (((const *) \

884 (c⁄° *Ë(
s1
))[3] \

885 - 
__s2
[3]); \

888 
__ªsu…
; }))

	)

890 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

891 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = \

892 (c⁄° *Ë(c⁄° *Ë(
s1
); \

893 
__ªsu…
 = \

894 
__s1
[0] - ((const *) \

895 (c⁄° *Ë(
s2
))[0]; \

896 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

898 
__ªsu…
 = (
__s1
[1] \

900 (c⁄° *Ë(
s2
))[1]); \

901 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

903 
__ªsu…
 = \

904 (
__s1
[2] - ((const *) \

905 (c⁄° *Ë(
s2
))[2]); \

906 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

907 
__ªsu…
 = \

908 (
__s1
[3] \

910 (c⁄° *Ë(
s2
))[3]); \

913 
__ªsu…
; }))

	)

918 #i‚de‡
_HAVE_STRING_ARCH_°∫cmp


919 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

920 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

921 && ((
	`__buûtö_c⁄°™t_p
 (
s1
) \

922 && 
	`°æí
 (
s1
Ë< ((
size_t
Ë(
n
))) \

923 || (
	`__buûtö_c⁄°™t_p
 (
s2
) \

924 && 
	`°æí
 (
s2
Ë< ((
size_t
Ë(
n
)))) \

925 ? 
	`°rcmp
 (
s1
, 
s2
Ë: 
	`°∫cmp
 (s1, s2, 
n
)))

	)

931 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rc•n
 || deföed 
_FORCE_INLINES


932 #i‚de‡
_HAVE_STRING_ARCH_°rc•n


933 #i‡
__GNUC_PREREQ
 (3, 2)

934 
	#°rc•n
(
s
, 
ªje˘
) \

935 
__exãnsi⁄__
 \

936 ({ 
__r0
, 
__r1
, 
__r2
; \

937 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

938 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

939 ? 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
) \

940 : ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

941 ? 
	`°æí
 (
s
) \

942 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

943 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

944 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

945 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

946 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

947 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

948 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)))))) \

949 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)); })

	)

951 
	#°rc•n
(
s
, 
ªje˘
) \

952 
__exãnsi⁄__
 \

953 ({ 
__r0
, 
__r1
, 
__r2
; \

954 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

955 ? ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

956 ? 
	`°æí
 (
s
) \

957 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

958 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

959 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

960 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

961 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

962 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

963 : 
	`°rc•n
 (
s
, 
ªje˘
))))) \

964 : 
	`°rc•n
 (
s
, 
ªje˘
)); })

	)

968 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

969 
__STRING_INLINE
 
size_t


970 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

972 
size_t
 
__ªsu…
 = 0;

973 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘
)

974 ++
__ªsu…
;

975  
__ªsu…
;

976 
	}
}

978 
__STRING_INLINE
 
size_t
 
__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
,

979 
__ªje˘2
);

980 
__STRING_INLINE
 
size_t


981 
	$__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
)

983 
size_t
 
__ªsu…
 = 0;

984 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


985 && 
__s
[
__ªsu…
] !
__ªje˘2
)

986 ++
__ªsu…
;

987  
__ªsu…
;

988 
	}
}

990 
__STRING_INLINE
 
size_t
 
__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
,

991 
__ªje˘2
, 
__ªje˘3
);

992 
__STRING_INLINE
 
size_t


993 
	$__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
,

994 
__ªje˘3
)

996 
size_t
 
__ªsu…
 = 0;

997 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


998 && 
__s
[
__ªsu…
] !
__ªje˘2
 && __s[__ªsu…] !
__ªje˘3
)

999 ++
__ªsu…
;

1000  
__ªsu…
;

1001 
	}
}

1007 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r•n
 || deföed 
_FORCE_INLINES


1008 #i‚de‡
_HAVE_STRING_ARCH_°r•n


1009 #i‡
__GNUC_PREREQ
 (3, 2)

1010 
	#°r•n
(
s
, 
ac˚±
) \

1011 
__exãnsi⁄__
 \

1012 ({ 
__a0
, 
__a1
, 
__a2
; \

1013 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1014 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1015 ? 
	`__buûtö_°r•n
 (
s
, 
ac˚±
) \

1016 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1017 ? ((Ë(
s
), (
size_t
) 0) \

1018 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1019 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1020 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1021 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1022 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1023 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1024 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)))))) \

1025 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)); })

	)

1027 
	#°r•n
(
s
, 
ac˚±
) \

1028 
__exãnsi⁄__
 \

1029 ({ 
__a0
, 
__a1
, 
__a2
; \

1030 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1031 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1032 ? ((Ë(
s
), (
size_t
) 0) \

1033 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1034 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1035 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1036 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1037 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1038 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1039 : 
	`°r•n
 (
s
, 
ac˚±
))))) \

1040 : 
	`°r•n
 (
s
, 
ac˚±
)); })

	)

1044 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1045 
__STRING_INLINE
 
size_t


1046 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1048 
size_t
 
__ªsu…
 = 0;

1050 
__s
[
__ªsu…
] =
__ac˚±
)

1051 ++
__ªsu…
;

1052  
__ªsu…
;

1053 
	}
}

1055 
__STRING_INLINE
 
size_t
 
__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1056 
__ac˚±2
);

1057 
__STRING_INLINE
 
size_t


1058 
	$__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1060 
size_t
 
__ªsu…
 = 0;

1062 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2
)

1063 ++
__ªsu…
;

1064  
__ªsu…
;

1065 
	}
}

1067 
__STRING_INLINE
 
size_t
 
__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1068 
__ac˚±2
, 
__ac˚±3
);

1069 
__STRING_INLINE
 
size_t


1070 
	$__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1072 
size_t
 
__ªsu…
 = 0;

1074 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2


1075 || 
__s
[
__ªsu…
] =
__ac˚±3
)

1076 ++
__ªsu…
;

1077  
__ªsu…
;

1078 
	}
}

1083 #i‡!
deföed
 
_HAVE_STRING_ARCH_°Ωbrk
 || deföed 
_FORCE_INLINES


1084 #i‚de‡
_HAVE_STRING_ARCH_°Ωbrk


1085 #i‡
__GNUC_PREREQ
 (3, 2)

1086 
	#°Ωbrk
(
s
, 
ac˚±
) \

1087 
__exãnsi⁄__
 \

1088 ({ 
__a0
, 
__a1
, 
__a2
; \

1089 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1090 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1091 ? 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
) \

1092 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1093 ? ((Ë(
s
), (*Ë
NULL
) \

1094 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1095 ? 
	`__buûtö_°rchr
 (
s
, 
__a0
) \

1096 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1097 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1098 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1099 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1100 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)))))) \

1101 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1103 
	#°Ωbrk
(
s
, 
ac˚±
) \

1104 
__exãnsi⁄__
 \

1105 ({ 
__a0
, 
__a1
, 
__a2
; \

1106 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1107 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1108 ? ((Ë(
s
), (*Ë
NULL
) \

1109 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1110 ? 
	`°rchr
 (
s
, 
__a0
) \

1111 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1112 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1113 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1114 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1115 : 
	`°Ωbrk
 (
s
, 
ac˚±
))))) \

1116 : 
	`°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1120 
__STRING_INLINE
 *
__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1121 
__ac˚±2
);

1122 
__STRING_INLINE
 *

1123 
	$__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1126 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2
)

1127 ++
__s
;

1128  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1129 
	}
}

1131 
__STRING_INLINE
 *
__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1132 
__ac˚±2
, 
__ac˚±3
);

1133 
__STRING_INLINE
 *

1134 
	$__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1137 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2


1138 && *
__s
 !
__ac˚±3
)

1139 ++
__s
;

1140  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1141 
	}
}

1147 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r°r
 && !
__GNUC_PREREQ
 (2, 97)

1148 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1149 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
Ë&& 
	`__°rög2_1b±r_p
 (needle) \

1150 ? (((c⁄° *Ë(
√edÀ
))[0] == '\0' \

1151 ? (*Ë(
size_t
Ë(
hay°ack
) \

1152 : (((c⁄° *Ë(
√edÀ
))[1] == '\0' \

1153 ? 
	`°rchr
 (
hay°ack
, \

1154 ((c⁄° *Ë(
√edÀ
))[0]) \

1155 : 
	`°r°r
 (
hay°ack
, 
√edÀ
))) \

1156 : 
	`°r°r
 (
hay°ack
, 
√edÀ
)))

	)

1160 #i‡!
deföed
 
_HAVE_STRING_ARCH_°πok_r
 || deföed 
_FORCE_INLINES


1161 #i‚de‡
_HAVE_STRING_ARCH_°πok_r


1162 
	#__°πok_r
(
s
, 
£p
, 
√xç
) \

1163 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
£p
Ë&& 
	`__°rög2_1b±r_p
 (sep) \

1164 && ((c⁄° *Ë(
£p
))[0] != '\0' \

1165 && ((c⁄° *Ë(
£p
))[1] == '\0' \

1166 ? 
	`__°πok_r_1c
 (
s
, ((c⁄° *Ë(
£p
))[0], 
√xç
) \

1167 : 
	`__°πok_r
 (
s
, 
£p
, 
√xç
)))

	)

1170 
__STRING_INLINE
 *
__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
);

1171 
__STRING_INLINE
 *

1172 
	$__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
)

1174 *
__ªsu…
;

1175 i‡(
__s
 =
NULL
)

1176 
__s
 = *
__√xç
;

1177 *
__s
 =
__£p
)

1178 ++
__s
;

1179 
__ªsu…
 = 
NULL
;

1180 i‡(*
__s
 != '\0')

1182 
__ªsu…
 = 
__s
++;

1183 *
__s
 != '\0')

1184 i‡(*
__s
++ =
__£p
)

1186 
__s
[-1] = '\0';

1190 *
__√xç
 = 
__s
;

1191  
__ªsu…
;

1192 
	}
}

1193 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


1194 
	#°πok_r
(
s
, 
£p
, 
√xç
Ë
	`__°πok_r
 (s, sï,Çexç)

	)

1199 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r£p
 || deföed 
_FORCE_INLINES


1200 #i‚de‡
_HAVE_STRING_ARCH_°r£p


1202 *
__°r£p_g
 (**
__°rögp
, c⁄° *
__dñim
);

1203 
	#__°r£p
(
s
, 
ªje˘
) \

1204 
__exãnsi⁄__
 \

1205 ({ 
__r0
, 
__r1
, 
__r2
; \

1206 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

1207 && (
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], \

1208 ((c⁄° *Ë(
ªje˘
))[0] != '\0') \

1209 ? ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], \

1210 ((c⁄° *Ë(
ªje˘
))[1] == '\0') \

1211 ? 
	`__°r£p_1c
 (
s
, 
__r0
) \

1212 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

1213 ? 
	`__°r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1214 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

1215 ? 
	`__°r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1216 : 
	`__°r£p_g
 (
s
, 
ªje˘
)))) \

1217 : 
	`__°r£p_g
 (
s
, 
ªje˘
)); })

	)

1220 
__STRING_INLINE
 *
__°r£p_1c
 (**
__s
, 
__ªje˘
);

1221 
__STRING_INLINE
 *

1222 
	$__°r£p_1c
 (**
__s
, 
__ªje˘
)

1224 *
__ªtvÆ
 = *
__s
;

1225 i‡(
__ªtvÆ
 !
NULL
 && (*
__s
 = 
	`°rchr
 (__ªtvÆ, 
__ªje˘
)) != NULL)

1226 *(*
__s
)++ = '\0';

1227  
__ªtvÆ
;

1228 
	}
}

1230 
__STRING_INLINE
 *
__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
);

1231 
__STRING_INLINE
 *

1232 
	$__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
)

1234 *
__ªtvÆ
 = *
__s
;

1235 i‡(
__ªtvÆ
 !
NULL
)

1237 *
__˝
 = 
__ªtvÆ
;

1240 i‡(*
__˝
 == '\0')

1242 
__˝
 = 
NULL
;

1245 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
)

1247 *
__˝
++ = '\0';

1250 ++
__˝
;

1252 *
__s
 = 
__˝
;

1254  
__ªtvÆ
;

1255 
	}
}

1257 
__STRING_INLINE
 *
__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
,

1258 
__ªje˘3
);

1259 
__STRING_INLINE
 *

1260 
	$__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
, 
__ªje˘3
)

1262 *
__ªtvÆ
 = *
__s
;

1263 i‡(
__ªtvÆ
 !
NULL
)

1265 *
__˝
 = 
__ªtvÆ
;

1268 i‡(*
__˝
 == '\0')

1270 
__˝
 = 
NULL
;

1273 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
 || *__˝ =
__ªje˘3
)

1275 *
__˝
++ = '\0';

1278 ++
__˝
;

1280 *
__s
 = 
__˝
;

1282  
__ªtvÆ
;

1283 
	}
}

1284 #ifde‡
__USE_BSD


1285 
	#°r£p
(
s
, 
ªje˘
Ë
	`__°r£p
 (s,Ñeje˘)

	)

1292 #ifde‡
__USE_MISC


1294 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rdup
 || !deföed 
_HAVE_STRING_ARCH_°∫dup


1295 
	#__√ed_mÆloc_™d_ˇŒoc


	)

1296 
	~<°dlib.h
>

1299 #i‚de‡
_HAVE_STRING_ARCH_°rdup


1301 *
	$__°rdup
 (c⁄° *
__°rög
Ë
__THROW
 
__©åibuã_mÆloc__
;

1302 
	#__°rdup
(
s
) \

1303 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1304 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1305 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1306 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1307 *
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1308 i‡(
__ªtvÆ
 !
NULL
) \

1309 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, 
__Àn
); \

1310 
__ªtvÆ
; 
	}
})) \

1311 : 
	`__°rdup
 (
s
)))

	)

1313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1314 
	#°rdup
(
s
Ë
	`__°rdup
 (s)

	)

1318 #i‚de‡
_HAVE_STRING_ARCH_°∫dup


1320 *
	$__°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

1321 
__THROW
 
__©åibuã_mÆloc__
;

1322 
	#__°∫dup
(
s
, 
n
) \

1323 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1324 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1325 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1326 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1327 
size_t
 
__n
 = (
n
); \

1328 *
__ªtvÆ
; \

1329 i‡(
__n
 < 
__Àn
) \

1330 
__Àn
 = 
__n
 + 1; \

1331 
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1332 i‡(
__ªtvÆ
 !
NULL
) \

1334 
__ªtvÆ
[
__Àn
 - 1] = '\0'; \

1335 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, \

1336 
__Àn
 - 1); \

1338 
__ªtvÆ
; 
	}
})) \

1339 : 
	`__°∫dup
 (
s
, 
n
)))

	)

1341 #ifde‡
__USE_GNU


1342 
	#°∫dup
(
s
, 
n
Ë
	`__°∫dup
 (s,Ç)

	)

1348 #i‚de‡
_FORCE_INLINES


1349 #unde‡
__STRING_INLINE


	@/usr/include/bits/string3.h

18 #i‚de‡
_STRING_H


22 
__w¨nde˛
 (
__w¨n_mem£t_zîo_Àn
,

25 #i‚de‡
__˝lu•lus


29 #unde‡
mem˝y


30 #unde‡
memmove


31 #unde‡
mem£t


32 #unde‡
°rˇt


33 #unde‡
°r˝y


34 #unde‡
°∫ˇt


35 #unde‡
°∫˝y


36 #ifde‡
__USE_GNU


37 #unde‡
memp˝y


38 #unde‡
°p˝y


40 #ifde‡
__USE_BSD


41 #unde‡
bc›y


42 #unde‡
bzîo


47 
__f‹tify_fun˘i⁄
 *

48 
__NTH
 (
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

49 
size_t
 
__Àn
))

51  
	`__buûtö___mem˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

52 
	}
}

54 
__f‹tify_fun˘i⁄
 *

55 
__NTH
 (
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__Àn
))

57  
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

58 
	}
}

60 #ifde‡
__USE_GNU


61 
__f‹tify_fun˘i⁄
 *

62 
__NTH
 (
	$memp˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

63 
size_t
 
__Àn
))

65  
	`__buûtö___memp˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

66 
	}
}

75 
__f‹tify_fun˘i⁄
 *

76 
__NTH
 (
	$mem£t
 (*
__de°
, 
__ch
, 
size_t
 
__Àn
))

78 i‡(
	`__buûtö_c⁄°™t_p
 (
__Àn
) && __len == 0

79 && (!
	`__buûtö_c⁄°™t_p
 (
__ch
) || __ch != 0))

81 
	`__w¨n_mem£t_zîo_Àn
 ();

82  
__de°
;

84  
	`__buûtö___mem£t_chk
 (
__de°
, 
__ch
, 
__Àn
, 
	`__bos0
 (__dest));

85 
	}
}

87 #ifde‡
__USE_BSD


88 
__f‹tify_fun˘i⁄
 

89 
__NTH
 (
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__Àn
))

91 (Ë
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

92 
	}
}

94 
__f‹tify_fun˘i⁄
 

95 
__NTH
 (
	$bzîo
 (*
__de°
, 
size_t
 
__Àn
))

97 (Ë
	`__buûtö___mem£t_chk
 (
__de°
, '\0', 
__Àn
, 
	`__bos0
 (__dest));

98 
	}
}

101 
__f‹tify_fun˘i⁄
 *

102 
__NTH
 (
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

104  
	`__buûtö___°r˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

105 
	}
}

107 #ifde‡
__USE_GNU


108 
__f‹tify_fun˘i⁄
 *

109 
__NTH
 (
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

111  
	`__buûtö___°p˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

112 
	}
}

116 
__f‹tify_fun˘i⁄
 *

117 
__NTH
 (
	$°∫˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

118 
size_t
 
__Àn
))

120  
	`__buûtö___°∫˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

121 
	}
}

124 *
	$__°≤˝y_chk
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

125 
size_t
 
__de°Àn
Ë
__THROW
;

126 *
	`__REDIRECT_NTH
 (
__°≤˝y_Æüs
, (*
__de°
, c⁄° *
__§c
,

127 
size_t
 
__n
), 
°≤˝y
);

129 
__f‹tify_fun˘i⁄
 *

130 
	`__NTH
 (
	$°≤˝y
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
))

132 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1

133 && (!
	`__buûtö_c⁄°™t_p
 (
__n
Ë|| __¿<
	`__bos
 (
__de°
)))

134  
	`__°≤˝y_chk
 (
__de°
, 
__§c
, 
__n
, 
	`__bos
 (__dest));

135  
	`__°≤˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

136 
	}
}

139 
__f‹tify_fun˘i⁄
 *

140 
__NTH
 (
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

142  
	`__buûtö___°rˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

143 
	}
}

146 
__f‹tify_fun˘i⁄
 *

147 
__NTH
 (
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

148 
size_t
 
__Àn
))

150  
	`__buûtö___°∫ˇt_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

151 
	}
}

	@/usr/include/bits/sys_errlist.h

19 #i‚de‡
_STDIO_H


25 #ifde‡ 
__USE_BSD


26 
sys_√º
;

27 c⁄° *c⁄° 
sys_îæi°
[];

29 #ifde‡ 
__USE_GNU


30 
_sys_√º
;

31 c⁄° *c⁄° 
_sys_îæi°
[];

	@/usr/include/bits/sysctl.h

18 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


	@/usr/include/bits/time.h

23 #i‡
deföed
 
__√ed_timevÆ
 || deföed 
__USE_GNU


24 #i‚de‡
_STRUCT_TIMEVAL


25 
	#_STRUCT_TIMEVAL
 1

	)

26 
	~<bôs/ty≥s.h
>

30 
	stimevÆ


32 
__time_t
 
	mtv_£c
;

33 
__su£c⁄ds_t
 
	mtv_u£c
;

38 #i‚de‡
__√ed_timevÆ


39 #i‚de‡
_BITS_TIME_H


40 
	#_BITS_TIME_H
 1

	)

48 
	#CLOCKS_PER_SEC
 1000000l

	)

50 #i‡(!
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_POSIX
) \

51 && !
deföed
 
	g__USE_XOPEN2K


54 
	~<bôs/ty≥s.h
>

55 
__sysc⁄f
 ();

56 
	#CLK_TCK
 ((
__˛ock_t
Ë
	`__sysc⁄f
 (2)Ë

	)

59 #ifde‡
__USE_POSIX199309


61 
	#CLOCK_REALTIME
 0

	)

63 
	#CLOCK_MONOTONIC
 1

	)

65 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

67 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

69 
	#CLOCK_MONOTONIC_RAW
 4

	)

71 
	#CLOCK_REALTIME_COARSE
 5

	)

73 
	#CLOCK_MONOTONIC_COARSE
 6

	)

75 
	#CLOCK_BOOTTIME
 7

	)

77 
	#CLOCK_REALTIME_ALARM
 8

	)

79 
	#CLOCK_BOOTTIME_ALARM
 9

	)

81 
	#CLOCK_TAI
 11

	)

84 
	#TIMER_ABSTIME
 1

	)

87 #ifde‡
__USE_GNU


88 
	~<bôs/timex.h
>

90 
__BEGIN_DECLS


93 
	$˛ock_adjtime
 (
__˛ockid_t
 
__˛ock_id
, 
timex
 *
__utx
Ë
__THROW
;

95 
__END_DECLS


101 #unde‡
__√ed_timevÆ


	@/usr/include/bits/types.h

23 #i‚def 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/w‹dsize.h
>

30 
	t__u_ch¨
;

31 
	t__u_sh‹t
;

32 
	t__u_öt
;

33 
	t__u_l⁄g
;

36 sig√d 
	t__öt8_t
;

37 
	t__uöt8_t
;

38 sig√d 
	t__öt16_t
;

39 
	t__uöt16_t
;

40 sig√d 
	t__öt32_t
;

41 
	t__uöt32_t
;

42 #i‡
__WORDSIZE
 == 64

43 sig√d 
	t__öt64_t
;

44 
	t__uöt64_t
;

45 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


46 
__exãnsi⁄__
 sig√d 
	t__öt64_t
;

47 
__exãnsi⁄__
 
	t__uöt64_t
;

51 #i‡
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

54 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


55 
__exãnsi⁄__
 
	t__quad_t
;

56 
__exãnsi⁄__
 
	t__u_quad_t
;

60 
	m__vÆ
[2];

61 } 
	t__quad_t
;

64 
__u_l⁄g
 
	m__vÆ
[2];

65 } 
	t__u_quad_t
;

98 
	#__S16_TYPE
 

	)

99 
	#__U16_TYPE
 

	)

100 
	#__S32_TYPE
 

	)

101 
	#__U32_TYPE
 

	)

102 
	#__SLONGWORD_TYPE
 

	)

103 
	#__ULONGWORD_TYPE
 

	)

104 #i‡
__WORDSIZE
 == 32

105 
	#__SQUAD_TYPE
 
__quad_t


	)

106 
	#__UQUAD_TYPE
 
__u_quad_t


	)

107 
	#__SWORD_TYPE
 

	)

108 
	#__UWORD_TYPE
 

	)

109 
	#__SLONG32_TYPE
 

	)

110 
	#__ULONG32_TYPE
 

	)

111 
	#__S64_TYPE
 
__quad_t


	)

112 
	#__U64_TYPE
 
__u_quad_t


	)

115 
	#__STD_TYPE
 
__exãnsi⁄__
 

	)

116 #ñi‡
__WORDSIZE
 == 64

117 
	t__SQUAD_TYPE
 

	)

118 
	t__UQUAD_TYPE
 

	)

119 
	t__SWORD_TYPE
 

	)

120 
	t__UWORD_TYPE
 

	)

121 
	t__SLONG32_TYPE
 

	)

122 
	t__ULONG32_TYPE
 

	)

123 
	t__S64_TYPE
 

	)

124 
	t__U64_TYPE
 

	)

126 
	t__STD_TYPE
 

	)

130 
	~<bôs/ty≥sizes.h
>

133 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

134 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

135 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

136 
__STD_TYPE
 
__INO_T_TYPE
 
	g__öo_t
;

137 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__öo64_t
;

138 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

139 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__∆ök_t
;

140 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

141 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

142 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

143 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

144 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__˛ock_t
;

145 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__æim_t
;

146 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__æim64_t
;

147 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

148 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

149 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£c⁄ds_t
;

150 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£c⁄ds_t
;

152 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

153 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

156 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__˛ockid_t
;

159 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__timî_t
;

162 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

167 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blk˙t_t
;

168 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blk˙t64_t
;

171 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblk˙t_t
;

172 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblk˙t64_t
;

175 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfû˙t_t
;

176 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfû˙t64_t
;

179 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fsw‹d_t
;

181 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysˇŒ_¶⁄g_t
;

186 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysˇŒ_ul⁄g_t
;

190 
__off64_t
 
	t__loff_t
;

191 
__quad_t
 *
	t__qaddr_t
;

192 *
	t__ˇddr_t
;

195 
__STD_TYPE
 
__SWORD_TYPE
 
	g__öçå_t
;

198 
__STD_TYPE
 
__U32_TYPE
 
	g__sockÀn_t
;

201 #unde‡
__STD_TYPE


	@/usr/include/bits/uio.h

18 #i‡!
deföed
 
_SYS_UIO_H
 && !deföed 
_FCNTL_H


22 #i‚de‡
_BITS_UIO_H


23 
	#_BITS_UIO_H
 1

	)

25 
	~<sys/ty≥s.h
>

39 
	#UIO_MAXIOV
 1024

	)

43 
	siovec


45 *
	miov_ba£
;

46 
size_t
 
	miov_Àn
;

52 #ifde‡
__USE_GNU


53 #i‡
deföed
 
_SYS_UIO_H
 && !deföed 
_BITS_UIO_H_FOR_SYS_UIO_H


54 
	#_BITS_UIO_H_FOR_SYS_UIO_H
 1

	)

56 
__BEGIN_DECLS


59 
ssize_t
 
	$¥o˚ss_vm_ªadv
 (
pid_t
 
__pid
, c⁄° 
iovec
 *
__lvec
,

60 
__liov˙t
,

61 c⁄° 
iovec
 *
__rvec
,

62 
__riov˙t
,

63 
__Êags
)

64 
__THROW
;

67 
ssize_t
 
	$¥o˚ss_vm_wrôev
 (
pid_t
 
__pid
, c⁄° 
iovec
 *
__lvec
,

68 
__liov˙t
,

69 c⁄° 
iovec
 *
__rvec
,

70 
__riov˙t
,

71 
__Êags
)

72 
__THROW
;

74 
__END_DECLS


	@/usr/include/bits/unistd.h

19 #i‚de‡
_UNISTD_H


23 
ssize_t
 
	$__ªad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

24 
size_t
 
__buÊí
Ë
__wur
;

25 
ssize_t
 
	`__REDIRECT
 (
__ªad_Æüs
, (
__fd
, *
__buf
,

26 
size_t
 
__nbyãs
), 
ªad
Ë
__wur
;

27 
ssize_t
 
	`__REDIRECT
 (
__ªad_chk_w¨n
,

28 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

29 
size_t
 
__buÊí
), 
__ªad_chk
)

30 
__wur
 
	`__w¨«âr
 ("read called with biggerÜengthÅhan size of "

33 
__f‹tify_fun˘i⁄
 
__wur
 
ssize_t


34 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
)

36 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

38 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

39  
	`__ªad_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
	`__bos0
 (__buf));

41 i‡(
__nbyãs
 > 
	`__bos0
 (
__buf
))

42  
	`__ªad_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
	`__bos0
 (__buf));

44  
	`__ªad_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
);

45 
	}
}

47 #ifde‡
__USE_UNIX98


48 
ssize_t
 
	$__¥ód_chk
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

49 
__off_t
 
__off£t
, 
size_t
 
__bufsize
Ë
__wur
;

50 
ssize_t
 
	$__¥ód64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

51 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
Ë
__wur
;

52 
ssize_t
 
	`__REDIRECT
 (
__¥ód_Æüs
,

53 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

54 
__off_t
 
__off£t
), 
¥ód
Ë
__wur
;

55 
ssize_t
 
	`__REDIRECT
 (
__¥ód64_Æüs
,

56 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

57 
__off64_t
 
__off£t
), 
¥ód64
Ë
__wur
;

58 
ssize_t
 
	`__REDIRECT
 (
__¥ód_chk_w¨n
,

59 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

60 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__¥ód_chk
)

61 
__wur
 
	`__w¨«âr
 ("pread called with biggerÜengthÅhan size of "

63 
ssize_t
 
	`__REDIRECT
 (
__¥ód64_chk_w¨n
,

64 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

65 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

66 
__¥ód64_chk
)

67 
__wur
 
	`__w¨«âr
 ("pread64 called with biggerÜengthÅhan size of "

70 #i‚de‡
__USE_FILE_OFFSET64


71 
__f‹tify_fun˘i⁄
 
__wur
 
ssize_t


72 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
, 
__off_t
 
__off£t
)

74 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

76 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

77  
	`__¥ód_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
, 
	`__bos0
 (__buf));

79 i‡–
__nbyãs
 > 
	`__bos0
 (
__buf
))

80  
	`__¥ód_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
,

81 
	`__bos0
 (
__buf
));

83  
	`__¥ód_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
);

84 
	}
}

86 
__f‹tify_fun˘i⁄
 
__wur
 
ssize_t


87 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
)

89 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

91 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

92  
	`__¥ód64_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
, 
	`__bos0
 (__buf));

94 i‡–
__nbyãs
 > 
	`__bos0
 (
__buf
))

95  
	`__¥ód64_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
,

96 
	`__bos0
 (
__buf
));

99  
	`__¥ód64_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
);

100 
	}
}

103 #ifde‡
__USE_LARGEFILE64


104 
__f‹tify_fun˘i⁄
 
__wur
 
ssize_t


105 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
)

107 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

109 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

110  
	`__¥ód64_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
, 
	`__bos0
 (__buf));

112 i‡–
__nbyãs
 > 
	`__bos0
 (
__buf
))

113  
	`__¥ód64_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
,

114 
	`__bos0
 (
__buf
));

117  
	`__¥ód64_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
);

118 
	}
}

122 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


123 
ssize_t
 
	$__ªadlök_chk
 (c⁄° *
__ª°ri˘
 
__∑th
,

124 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

125 
size_t
 
__buÊí
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

127 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök_Æüs
,

128 (c⁄° *
__ª°ri˘
 
__∑th
,

129 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
), 
ªadlök
)

130 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

131 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök_chk_w¨n
,

132 (c⁄° *
__ª°ri˘
 
__∑th
,

133 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

134 
size_t
 
__buÊí
), 
__ªadlök_chk
)

135 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
 
	`__w¨«âr
 ("readlink called with biggerÜength "

138 
__f‹tify_fun˘i⁄
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
 
ssize_t


139 
	`__NTH
 (
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
, *__ª°ri˘ 
__buf
,

140 
size_t
 
__Àn
))

142 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

144 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

145  
	`__ªadlök_chk
 (
__∑th
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

147 i‡–
__Àn
 > 
	`__bos
 (
__buf
))

148  
	`__ªadlök_chk_w¨n
 (
__∑th
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

150  
	`__ªadlök_Æüs
 (
__∑th
, 
__buf
, 
__Àn
);

151 
	}
}

154 #ifde‡
__USE_ATFILE


155 
ssize_t
 
	$__ªadlök©_chk
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

156 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

157 
size_t
 
__buÊí
)

158 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

159 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök©_Æüs
,

160 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

161 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
),

162 
ªadlök©
)

163 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

164 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök©_chk_w¨n
,

165 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

166 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

167 
size_t
 
__buÊí
), 
__ªadlök©_chk
)

168 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
 
	`__w¨«âr
 ("readlinkat called with bigger "

172 
__f‹tify_fun˘i⁄
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
 
ssize_t


173 
	`__NTH
 (
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

174 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
))

176 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

178 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

179  
	`__ªadlök©_chk
 (
__fd
, 
__∑th
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

181 i‡(
__Àn
 > 
	`__bos
 (
__buf
))

182  
	`__ªadlök©_chk_w¨n
 (
__fd
, 
__∑th
, 
__buf
, 
__Àn
,

183 
	`__bos
 (
__buf
));

185  
	`__ªadlök©_Æüs
 (
__fd
, 
__∑th
, 
__buf
, 
__Àn
);

186 
	}
}

189 *
	$__gëcwd_chk
 (*
__buf
, 
size_t
 
__size
, size_à
__buÊí
)

190 
__THROW
 
__wur
;

191 *
	`__REDIRECT_NTH
 (
__gëcwd_Æüs
,

192 (*
__buf
, 
size_t
 
__size
), 
gëcwd
Ë
__wur
;

193 *
	`__REDIRECT_NTH
 (
__gëcwd_chk_w¨n
,

194 (*
__buf
, 
size_t
 
__size
, size_à
__buÊí
),

195 
__gëcwd_chk
)

196 
__wur
 
	`__w¨«âr
 ("getcwd caller with biggerÜengthÅhan size of "

199 
__f‹tify_fun˘i⁄
 
__wur
 *

200 
	`__NTH
 (
	$gëcwd
 (*
__buf
, 
size_t
 
__size
))

202 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

204 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
))

205  
	`__gëcwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

207 i‡(
__size
 > 
	`__bos
 (
__buf
))

208  
	`__gëcwd_chk_w¨n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

210  
	`__gëcwd_Æüs
 (
__buf
, 
__size
);

211 
	}
}

213 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


214 *
	$__gëwd_chk
 (*
__buf
, 
size_t
 
buÊí
)

215 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

216 *
	`__REDIRECT_NTH
 (
__gëwd_w¨n
, (*
__buf
), 
gëwd
)

217 
	`__n⁄nuŒ
 ((1)Ë
__wur
 
	`__w¨«âr
 ("please use getcwd instead,ás getwd "

220 
__f‹tify_fun˘i⁄
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
 *

221 
	`__NTH
 (
	$gëwd
 (*
__buf
))

223 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

224  
	`__gëwd_chk
 (
__buf
, 
	`__bos
 (__buf));

225  
	`__gëwd_w¨n
 (
__buf
);

226 
	}
}

229 
size_t
 
	$__c⁄f°r_chk
 (
__«me
, *
__buf
, 
size_t
 
__Àn
,

230 
size_t
 
__buÊí
Ë
__THROW
;

231 
size_t
 
	`__REDIRECT_NTH
 (
__c⁄f°r_Æüs
, (
__«me
, *
__buf
,

232 
size_t
 
__Àn
), 
c⁄f°r
);

233 
size_t
 
	`__REDIRECT_NTH
 (
__c⁄f°r_chk_w¨n
,

234 (
__«me
, *
__buf
, 
size_t
 
__Àn
,

235 
size_t
 
__buÊí
), 
__c⁄f°r_chk
)

236 
	`__w¨«âr
 ("confstr called with biggerÜengthÅhan size of destination "

239 
__f‹tify_fun˘i⁄
 
size_t


240 
	`__NTH
 (
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
))

242 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

244 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

245  
	`__c⁄f°r_chk
 (
__«me
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

247 i‡(
	`__bos
 (
__buf
Ë< 
__Àn
)

248  
	`__c⁄f°r_chk_w¨n
 (
__«me
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

250  
	`__c⁄f°r_Æüs
 (
__«me
, 
__buf
, 
__Àn
);

251 
	}
}

254 
	$__gëgroups_chk
 (
__size
, 
__gid_t
 
__li°
[], 
size_t
 
__li°Àn
)

255 
__THROW
 
__wur
;

256 
	`__REDIRECT_NTH
 (
__gëgroups_Æüs
, (
__size
, 
__gid_t
 
__li°
[]),

257 
gëgroups
Ë
__wur
;

258 
	`__REDIRECT_NTH
 (
__gëgroups_chk_w¨n
,

259 (
__size
, 
__gid_t
 
__li°
[], 
size_t
 
__li°Àn
),

260 
__gëgroups_chk
)

261 
__wur
 
	`__w¨«âr
 ("getgroups called with bigger group countÅhan what "

264 
__f‹tify_fun˘i⁄
 

265 
	`__NTH
 (
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]))

267 i‡(
	`__bos
 (
__li°
Ë!(
size_t
) -1)

269 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
) || __size < 0)

270  
	`__gëgroups_chk
 (
__size
, 
__li°
, 
	`__bos
 (__list));

272 i‡(
__size
 *  (
__gid_t
Ë> 
	`__bos
 (
__li°
))

273  
	`__gëgroups_chk_w¨n
 (
__size
, 
__li°
, 
	`__bos
 (__list));

275  
	`__gëgroups_Æüs
 (
__size
, 
__li°
);

276 
	}
}

279 
	$__ây«me_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

280 
size_t
 
__ƒól
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

281 
	`__REDIRECT_NTH
 (
__ây«me_r_Æüs
, (
__fd
, *
__buf
,

282 
size_t
 
__buÊí
), 
ây«me_r
)

283 
	`__n⁄nuŒ
 ((2));

284 
	`__REDIRECT_NTH
 (
__ây«me_r_chk_w¨n
,

285 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

286 
size_t
 
__ƒól
), 
__ây«me_r_chk
)

287 
	`__n⁄nuŒ
 ((2)Ë
	`__w¨«âr
 ("ttyname_r called with bigger buflenÅhan "

290 
__f‹tify_fun˘i⁄
 

291 
	`__NTH
 (
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
))

293 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

295 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

296  
	`__ây«me_r_chk
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

298 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

299  
	`__ây«me_r_chk_w¨n
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

301  
	`__ây«me_r_Æüs
 (
__fd
, 
__buf
, 
__buÊí
);

302 
	}
}

305 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


306 
	$__gëlogö_r_chk
 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
)

307 
	`__n⁄nuŒ
 ((1));

308 
	`__REDIRECT
 (
__gëlogö_r_Æüs
, (*
__buf
, 
size_t
 
__buÊí
),

309 
gëlogö_r
Ë
	`__n⁄nuŒ
 ((1));

310 
	`__REDIRECT
 (
__gëlogö_r_chk_w¨n
,

311 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
),

312 
__gëlogö_r_chk
)

313 
	`__n⁄nuŒ
 ((1)Ë
	`__w¨«âr
 ("getlogin_r called with bigger buflenÅhan "

316 
__f‹tify_fun˘i⁄
 

317 
	$gëlogö_r
 (*
__buf
, 
size_t
 
__buÊí
)

319 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

321 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

322  
	`__gëlogö_r_chk
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

324 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

325  
	`__gëlogö_r_chk_w¨n
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

327  
	`__gëlogö_r_Æüs
 (
__buf
, 
__buÊí
);

328 
	}
}

332 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98


333 
	$__gëho°«me_chk
 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
)

334 
__THROW
 
	`__n⁄nuŒ
 ((1));

335 
	`__REDIRECT_NTH
 (
__gëho°«me_Æüs
, (*
__buf
, 
size_t
 
__buÊí
),

336 
gëho°«me
Ë
	`__n⁄nuŒ
 ((1));

337 
	`__REDIRECT_NTH
 (
__gëho°«me_chk_w¨n
,

338 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
),

339 
__gëho°«me_chk
)

340 
	`__n⁄nuŒ
 ((1)Ë
	`__w¨«âr
 ("gethostname called with bigger buflenÅhan "

343 
__f‹tify_fun˘i⁄
 

344 
	`__NTH
 (
	$gëho°«me
 (*
__buf
, 
size_t
 
__buÊí
))

346 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

348 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

349  
	`__gëho°«me_chk
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

351 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

352  
	`__gëho°«me_chk_w¨n
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

354  
	`__gëho°«me_Æüs
 (
__buf
, 
__buÊí
);

355 
	}
}

359 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

360 
	$__gëdomaö«me_chk
 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
)

361 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

362 
	`__REDIRECT_NTH
 (
__gëdomaö«me_Æüs
, (*
__buf
,

363 
size_t
 
__buÊí
),

364 
gëdomaö«me
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

365 
	`__REDIRECT_NTH
 (
__gëdomaö«me_chk_w¨n
,

366 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
),

367 
__gëdomaö«me_chk
)

368 
	`__n⁄nuŒ
 ((1)Ë
__wur
 
	`__w¨«âr
 ("getdomainname called with bigger "

372 
__f‹tify_fun˘i⁄
 

373 
	`__NTH
 (
	$gëdomaö«me
 (*
__buf
, 
size_t
 
__buÊí
))

375 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

377 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

378  
	`__gëdomaö«me_chk
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

380 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

381  
	`__gëdomaö«me_chk_w¨n
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

383  
	`__gëdomaö«me_Æüs
 (
__buf
, 
__buÊí
);

384 
	}
}

	@/usr/include/bits/utsname.h

18 #i‚de‡
_SYS_UTSNAME_H


23 
	#_UTSNAME_LENGTH
 65

	)

28 
	#_UTSNAME_DOMAIN_LENGTH
 
_UTSNAME_LENGTH


	)

	@/usr/include/bits/waitflags.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


25 
	#WNOHANG
 1

	)

26 
	#WUNTRACED
 2

	)

29 
	#WSTOPPED
 2

	)

30 
	#WEXITED
 4

	)

31 
	#WCONTINUED
 8

	)

32 
	#WNOWAIT
 0x01000000

	)

34 
	#__WNOTHREAD
 0x20000000

	)

36 
	#__WALL
 0x40000000

	)

37 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


28 
	#__WEXITSTATUS
(
°©us
Ë(((°©usË& 0xff00Ë>> 8)

	)

31 
	#__WTERMSIG
(
°©us
Ë((°©usË& 0x7f)

	)

34 
	#__WSTOPSIG
(
°©us
Ë
	`__WEXITSTATUS
(°©us)

	)

37 
	#__WIFEXITED
(
°©us
Ë(
	`__WTERMSIG
(°©usË=0)

	)

40 
	#__WIFSIGNALED
(
°©us
) \

41 (((sig√d Ë(((
°©us
Ë& 0x7fË+ 1Ë>> 1Ë> 0)

	)

44 
	#__WIFSTOPPED
(
°©us
Ë(((°©usË& 0xffË=0x7f)

	)

48 #ifde‡
WCONTINUED


49 
	#__WIFCONTINUED
(
°©us
Ë((°©usË=
__W_CONTINUED
)

	)

53 
	#__WCOREDUMP
(
°©us
Ë((°©usË& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
ªt
, 
sig
Ë(‘ëË<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
Ë((sigË<< 8 | 0x7f)

	)

58 
	#__W_CONTINUED
 0xffff

	)

59 
	#__WCOREFLAG
 0x80

	)

62 #ifdef 
__USE_BSD


64 
	~<ídün.h
>

66 
	uwaô


68 
	mw_°©us
;

71 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


72 
	m__w_ãrmsig
:7;

73 
	m__w_c‹edump
:1;

74 
	m__w_ªtcode
:8;

77 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


79 
	m__w_ªtcode
:8;

80 
	m__w_c‹edump
:1;

81 
	m__w_ãrmsig
:7;

83 } 
	m__waô_ãrmö©ed
;

86 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


87 
	m__w_°›vÆ
:8;

88 
	m__w_°›sig
:8;

91 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


93 
	m__w_°›sig
:8;

94 
	m__w_°›vÆ
:8;

96 } 
	m__waô_°›≥d
;

99 
	#w_ãrmsig
 
__waô_ãrmö©ed
.
__w_ãrmsig


	)

100 
	#w_c‹edump
 
__waô_ãrmö©ed
.
__w_c‹edump


	)

101 
	#w_ªtcode
 
__waô_ãrmö©ed
.
__w_ªtcode


	)

102 
	#w_°›sig
 
__waô_°›≥d
.
__w_°›sig


	)

103 
	#w_°›vÆ
 
__waô_°›≥d
.
__w_°›vÆ


	)

	@/usr/include/bits/wchar-ldbl.h

19 #i‚de‡
_WCHAR_H


23 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


24 
__BEGIN_NAMESPACE_C99


25 
__LDBL_REDIR_DECL
 (
fw¥ötf
);

26 
__LDBL_REDIR_DECL
 (
w¥ötf
);

27 
__LDBL_REDIR_DECL
 (
sw¥ötf
);

28 
__LDBL_REDIR_DECL
 (
vfw¥ötf
);

29 
__LDBL_REDIR_DECL
 (
vw¥ötf
);

30 
__LDBL_REDIR_DECL
 (
vsw¥ötf
);

31 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

32 && !
deföed
 
	g__REDIRECT
 \

33 && (
deföed
 
	g__STRICT_ANSI__
 || deföed 
	g__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fwsˇnf
, 
__∆dbl___isoc99_fwsˇnf
)

35 
	$__LDBL_REDIR1_DECL
 (
wsˇnf
, 
__∆dbl___isoc99_wsˇnf
)

36 
	$__LDBL_REDIR1_DECL
 (
swsˇnf
, 
__∆dbl___isoc99_swsˇnf
)

38 
	`__LDBL_REDIR_DECL
 (
fwsˇnf
);

39 
	`__LDBL_REDIR_DECL
 (
wsˇnf
);

40 
	`__LDBL_REDIR_DECL
 (
swsˇnf
);

42 
__END_NAMESPACE_C99


45 #ifde‡
__USE_ISOC99


46 
__BEGIN_NAMESPACE_C99


47 
	`__LDBL_REDIR1_DECL
 (
wc°ﬁd
, 
wc°od
);

48 #i‡!
deföed
 
__USE_GNU
 && !deföed 
__REDIRECT
 \

49 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

50 
	$__LDBL_REDIR1_DECL
 (
vfwsˇnf
, 
__∆dbl___isoc99_vfwsˇnf
)

51 
	$__LDBL_REDIR1_DECL
 (
vwsˇnf
, 
__∆dbl___isoc99_vwsˇnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vswsˇnf
, 
__∆dbl___isoc99_vswsˇnf
)

54 
	`__LDBL_REDIR_DECL
 (
vfwsˇnf
);

55 
	`__LDBL_REDIR_DECL
 (
vwsˇnf
);

56 
	`__LDBL_REDIR_DECL
 (
vswsˇnf
);

58 
__END_NAMESPACE_C99


61 #ifde‡
__USE_GNU


62 
	`__LDBL_REDIR1_DECL
 (
wc°ﬁd_l
, 
wc°od_l
);

65 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


66 
	$__LDBL_REDIR_DECL
 (
__sw¥ötf_chk
)

67 
	$__LDBL_REDIR_DECL
 (
__vsw¥ötf_chk
)

68 #i‡
__USE_FORTIFY_LEVEL
 > 1

69 
	$__LDBL_REDIR_DECL
 (
__fw¥ötf_chk
)

70 
	$__LDBL_REDIR_DECL
 (
__w¥ötf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__vfw¥ötf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vw¥ötf_chk
)

	@/usr/include/bits/wchar.h

19 #i‚de‡
_BITS_WCHAR_H


20 
	#_BITS_WCHAR_H
 1

	)

22 
	~<bôs/w‹dsize.h
>

24 #i‡
__WORDSIZE
 == 64

25 
	#__WCHAR_MIN
 (-2147483647 - 1)

	)

26 
	#__WCHAR_MAX
 (2147483647)

	)

28 
	#__WCHAR_MIN
 (-2147483647»- 1l)

	)

29 
	#__WCHAR_MAX
 (2147483647l)

	)

	@/usr/include/bits/wchar2.h

19 #i‚de‡
_WCHAR_H


24 
wch¨_t
 *
	$__wmem˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

25 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

26 
size_t
 
__ns1
Ë
__THROW
;

27 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem˝y_Æüs
,

28 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

29 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
),

30 
wmem˝y
);

31 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem˝y_chk_w¨n
,

32 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

33 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

34 
size_t
 
__ns1
), 
__wmem˝y_chk
)

35 
	`__w¨«âr
 ("wmemcpy called withÜength biggerÅhan size of destination "

38 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

39 
	`__NTH
 (
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
, c⁄° wch¨_à*__ª°ri˘ 
__s2
,

40 
size_t
 
__n
))

42 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

44 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

45  
	`__wmem˝y_chk
 (
__s1
, 
__s2
, 
__n
,

46 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

48 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

49  
	`__wmem˝y_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

50 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

52  
	`__wmem˝y_Æüs
 (
__s1
, 
__s2
, 
__n
);

53 
	}
}

56 
wch¨_t
 *
	$__wmemmove_chk
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

57 
size_t
 
__n
, size_à
__ns1
Ë
__THROW
;

58 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_Æüs
, (wch¨_à*
__s1
,

59 c⁄° 
wch¨_t
 *
__s2
,

60 
size_t
 
__n
), 
wmemmove
);

61 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¨n
,

62 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

63 
size_t
 
__n
, size_à
__ns1
), 
__wmemmove_chk
)

64 
	`__w¨«âr
 ("wmemmove called withÜength biggerÅhan size of destination "

67 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

68 
	`__NTH
 (
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
))

70 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

72 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

73  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

74 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

76 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

77  
	`__wmemmove_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

78 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

80  
	`__wmemmove_Æüs
 (
__s1
, 
__s2
, 
__n
);

81 
	}
}

84 #ifde‡
__USE_GNU


85 
wch¨_t
 *
	$__wmemp˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

86 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

87 
size_t
 
__ns1
Ë
__THROW
;

88 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemp˝y_Æüs
,

89 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

90 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
,

91 
size_t
 
__n
), 
wmemp˝y
);

92 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemp˝y_chk_w¨n
,

93 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

94 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

95 
size_t
 
__ns1
), 
__wmemp˝y_chk
)

96 
	`__w¨«âr
 ("wmempcpy called withÜength biggerÅhan size of destination "

99 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

100 
	`__NTH
 (
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
, c⁄° wch¨_à*__ª°ri˘ 
__s2
,

101 
size_t
 
__n
))

103 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

105 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

106  
	`__wmemp˝y_chk
 (
__s1
, 
__s2
, 
__n
,

107 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

109 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

110  
	`__wmemp˝y_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

111 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

113  
	`__wmemp˝y_Æüs
 (
__s1
, 
__s2
, 
__n
);

114 
	}
}

118 
wch¨_t
 *
	$__wmem£t_chk
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
,

119 
size_t
 
__ns
Ë
__THROW
;

120 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_Æüs
, (wch¨_à*
__s
, wch¨_à
__c
,

121 
size_t
 
__n
), 
wmem£t
);

122 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¨n
,

123 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
,

124 
size_t
 
__ns
), 
__wmem£t_chk
)

125 
	`__w¨«âr
 ("wmemset called withÜength biggerÅhan size of destination "

128 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

129 
	`__NTH
 (
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
))

131 i‡(
	`__bos0
 (
__s
Ë!(
size_t
) -1)

133 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

134  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sË/  (
wch¨_t
));

136 i‡(
__n
 > 
	`__bos0
 (
__s
Ë/  (
wch¨_t
))

137  
	`__wmem£t_chk_w¨n
 (
__s
, 
__c
, 
__n
,

138 
	`__bos0
 (
__s
Ë/  (
wch¨_t
));

140  
	`__wmem£t_Æüs
 (
__s
, 
__c
, 
__n
);

141 
	}
}

144 
wch¨_t
 *
	$__wcs˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

145 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

146 
size_t
 
__n
Ë
__THROW
;

147 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wcs˝y_Æüs
,

148 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

149 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
wcs˝y
);

151 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

152 
	`__NTH
 (
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
))

154 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

155  
	`__wcs˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

156  
	`__wcs˝y_Æüs
 (
__de°
, 
__§c
);

157 
	}
}

160 
wch¨_t
 *
	$__w˝˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

161 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

162 
size_t
 
__de°Àn
Ë
__THROW
;

163 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝˝y_Æüs
,

164 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

165 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
w˝˝y
);

167 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

168 
	`__NTH
 (
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
))

170 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

171  
	`__w˝˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

172  
	`__w˝˝y_Æüs
 (
__de°
, 
__§c
);

173 
	}
}

176 
wch¨_t
 *
	$__wc¢˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

177 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
,

178 
size_t
 
__de°Àn
Ë
__THROW
;

179 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢˝y_Æüs
,

180 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

181 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

182 
size_t
 
__n
), 
wc¢˝y
);

183 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢˝y_chk_w¨n
,

184 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

185 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

186 
size_t
 
__n
, size_à
__de°Àn
), 
__wc¢˝y_chk
)

187 
	`__w¨«âr
 ("wcsncpy called withÜength biggerÅhan size of destination "

190 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

191 
	`__NTH
 (
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
,

192 
size_t
 
__n
))

194 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

196 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

197  
	`__wc¢˝y_chk
 (
__de°
, 
__§c
, 
__n
,

198 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

199 i‡(
__n
 > 
	`__bos
 (
__de°
Ë/  (
wch¨_t
))

200  
	`__wc¢˝y_chk_w¨n
 (
__de°
, 
__§c
, 
__n
,

201 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

203  
	`__wc¢˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

204 
	}
}

207 
wch¨_t
 *
	$__w˝n˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

208 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
,

209 
size_t
 
__de°Àn
Ë
__THROW
;

210 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝n˝y_Æüs
,

211 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

212 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

213 
size_t
 
__n
), 
w˝n˝y
);

214 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝n˝y_chk_w¨n
,

215 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

216 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

217 
size_t
 
__n
, size_à
__de°Àn
), 
__w˝n˝y_chk
)

218 
	`__w¨«âr
 ("wcpncpy called withÜength biggerÅhan size of destination "

221 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

222 
	`__NTH
 (
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
,

223 
size_t
 
__n
))

225 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

227 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

228  
	`__w˝n˝y_chk
 (
__de°
, 
__§c
, 
__n
,

229 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

230 i‡(
__n
 > 
	`__bos
 (
__de°
Ë/  (
wch¨_t
))

231  
	`__w˝n˝y_chk_w¨n
 (
__de°
, 
__§c
, 
__n
,

232 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

234  
	`__w˝n˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

235 
	}
}

238 
wch¨_t
 *
	$__wcsˇt_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

239 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

240 
size_t
 
__de°Àn
Ë
__THROW
;

241 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wcsˇt_Æüs
,

242 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

243 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
wcsˇt
);

245 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

246 
	`__NTH
 (
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
))

248 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

249  
	`__wcsˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

250  
	`__wcsˇt_Æüs
 (
__de°
, 
__§c
);

251 
	}
}

254 
wch¨_t
 *
	$__wc¢ˇt_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

255 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

256 
size_t
 
__n
, size_à
__de°Àn
Ë
__THROW
;

257 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢ˇt_Æüs
,

258 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

259 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

260 
size_t
 
__n
), 
wc¢ˇt
);

262 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

263 
	`__NTH
 (
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
,

264 
size_t
 
__n
))

266 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

267  
	`__wc¢ˇt_chk
 (
__de°
, 
__§c
, 
__n
,

268 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

269  
	`__wc¢ˇt_Æüs
 (
__de°
, 
__§c
, 
__n
);

270 
	}
}

273 
	$__sw¥ötf_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

274 
__Êag
, 
size_t
 
__s_Àn
,

275 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

276 
__THROW
 ;

278 
	`__REDIRECT_NTH_LDBL
 (
__sw¥ötf_Æüs
,

279 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

280 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...),

281 
sw¥ötf
);

283 #ifde‡
__va_¨g_∑ck


284 
__f‹tify_fun˘i⁄
 

285 
	`__NTH
 (
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

286 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...))

288 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1)

289  
	`__sw¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

290 
	`__bos
 (
__s
Ë/  (
wch¨_t
),

291 
__fmt
, 
	`__va_¨g_∑ck
 ());

292  
	`__sw¥ötf_Æüs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¨g_∑ck
 ());

293 
	}
}

294 #ñi‡!
deföed
 
__˝lu•lus


296 
	#sw¥ötf
(
s
, 
n
, ...) \

297 (
	`__bos
 (
s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

298 ? 
	`__sw¥ötf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

299 
	`__bos
 (
s
Ë/  (
wch¨_t
), 
__VA_ARGS__
) \

300 : 
	`sw¥ötf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

303 
	$__vsw¥ötf_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

304 
__Êag
, 
size_t
 
__s_Àn
,

305 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

306 
__gnuc_va_li°
 
__¨g
)

307 
__THROW
 ;

309 
	`__REDIRECT_NTH_LDBL
 (
__vsw¥ötf_Æüs
,

310 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

311 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
,

312 
__gnuc_va_li°
 
__≠
), 
vsw¥ötf
);

314 
__f‹tify_fun˘i⁄
 

315 
	`__NTH
 (
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

316 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
))

318 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1)

319  
	`__vsw¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

320 
	`__bos
 (
__s
Ë/  (
wch¨_t
), 
__fmt
, 
__≠
);

321  
	`__vsw¥ötf_Æüs
 (
__s
, 
__n
, 
__fmt
, 
__≠
);

322 
	}
}

325 #i‡
__USE_FORTIFY_LEVEL
 > 1

327 
__fw¥ötf_chk
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

328 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

329 
__w¥ötf_chk
 (
__Êag
, c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

331 
__vfw¥ötf_chk
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

332 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

333 
__gnuc_va_li°
 
__≠
);

334 
__vw¥ötf_chk
 (
__Êag
, c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

335 
__gnuc_va_li°
 
__≠
);

337 #ifde‡
__va_¨g_∑ck


338 
__f‹tify_fun˘i⁄
 

339 
	$w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...)

341  
	`__w¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¨g_∑ck
 ());

342 
	}
}

344 
__f‹tify_fun˘i⁄
 

345 
	$fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, c⁄° 
wch¨_t
 *__ª°ri˘ 
__fmt
, ...)

347  
	`__fw¥ötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

348 
	`__va_¨g_∑ck
 ());

349 
	}
}

350 #ñi‡!
deföed
 
__˝lu•lus


351 
	#w¥ötf
(...) \

352 
	`__w¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

353 
	#fw¥ötf
(
°ªam
, ...) \

354 
	`__fw¥ötf_chk
 (
°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

357 
__f‹tify_fun˘i⁄
 

358 
	$vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
)

360  
	`__vw¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

361 
	}
}

363 
__f‹tify_fun˘i⁄
 

364 
	$vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

365 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
)

367  
	`__vfw¥ötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

368 
	}
}

372 
wch¨_t
 *
	$__fgëws_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

373 
__FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

374 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_Æüs
,

375 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
,

376 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
fgëws
Ë
__wur
;

377 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_chk_w¨n
,

378 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

379 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgëws_chk
)

380 
__wur
 
	`__w¨«âr
 ("fgetws called with bigger sizeÅhanÜength "

383 
__f‹tify_fun˘i⁄
 
__wur
 
wch¨_t
 *

384 
	$fgëws
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
, 
__FILE
 *__ª°ri˘ 
__°ªam
)

386 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

388 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

389  
	`__fgëws_chk
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

390 
__n
, 
__°ªam
);

392 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
Ë/  (
wch¨_t
))

393  
	`__fgëws_chk_w¨n
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

394 
__n
, 
__°ªam
);

396  
	`__fgëws_Æüs
 (
__s
, 
__n
, 
__°ªam
);

397 
	}
}

399 #ifde‡
__USE_GNU


400 
wch¨_t
 *
	$__fgëws_u∆ocked_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
,

401 
__n
, 
__FILE
 *
__ª°ri˘
 
__°ªam
)

402 
__wur
;

403 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_u∆ocked_Æüs
,

404 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
,

405 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
fgëws_u∆ocked
)

406 
__wur
;

407 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_u∆ocked_chk_w¨n
,

408 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

409 
__FILE
 *
__ª°ri˘
 
__°ªam
),

410 
__fgëws_u∆ocked_chk
)

411 
__wur
 
	`__w¨«âr
 ("fgetws_unlocked called with bigger sizeÅhanÜength "

414 
__f‹tify_fun˘i⁄
 
__wur
 
wch¨_t
 *

415 
	$fgëws_u∆ocked
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
, 
__FILE
 *__ª°ri˘ 
__°ªam
)

417 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

419 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

420  
	`__fgëws_u∆ocked_chk
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

421 
__n
, 
__°ªam
);

423 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
Ë/  (
wch¨_t
))

424  
	`__fgëws_u∆ocked_chk_w¨n
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

425 
__n
, 
__°ªam
);

427  
	`__fgëws_u∆ocked_Æüs
 (
__s
, 
__n
, 
__°ªam
);

428 
	}
}

432 
size_t
 
	$__w¸tomb_chk
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wch¨
,

433 
mb°©e_t
 *
__ª°ri˘
 
__p
,

434 
size_t
 
__buÊí
Ë
__THROW
 
__wur
;

435 
size_t
 
	`__REDIRECT_NTH
 (
__w¸tomb_Æüs
,

436 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wch¨
,

437 
mb°©e_t
 *
__ª°ri˘
 
__ps
), 
w¸tomb
Ë
__wur
;

439 
__f‹tify_fun˘i⁄
 
__wur
 
size_t


440 
	`__NTH
 (
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wch¨
,

441 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

446 
	#__WCHAR_MB_LEN_MAX
 16

	)

447 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__WCHAR_MB_LEN_MAX


450 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

451  
	`__w¸tomb_chk
 (
__s
, 
__wch¨
, 
__ps
, 
	`__bos
 (__s));

452  
	`__w¸tomb_Æüs
 (
__s
, 
__wch¨
, 
__ps
);

453 
	}
}

456 
size_t
 
	$__mb§towcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

457 c⁄° **
__ª°ri˘
 
__§c
,

458 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

459 
size_t
 
__d°Àn
Ë
__THROW
;

460 
size_t
 
	`__REDIRECT_NTH
 (
__mb§towcs_Æüs
,

461 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

462 c⁄° **
__ª°ri˘
 
__§c
,

463 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

464 
mb§towcs
);

465 
size_t
 
	`__REDIRECT_NTH
 (
__mb§towcs_chk_w¨n
,

466 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

467 c⁄° **
__ª°ri˘
 
__§c
,

468 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

469 
size_t
 
__d°Àn
), 
__mb§towcs_chk
)

470 
	`__w¨«âr
 ("mbsrtowcs called with dst buffer smallerÅhanÜen "

473 
__f‹tify_fun˘i⁄
 
size_t


474 
	`__NTH
 (
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° **__ª°ri˘ 
__§c
,

475 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

477 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

479 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

480  
	`__mb§towcs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
,

481 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

483 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

484  
	`__mb§towcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
,

485 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

487  
	`__mb§towcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
);

488 
	}
}

491 
size_t
 
	$__wc§tombs_chk
 (*
__ª°ri˘
 
__d°
,

492 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

493 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

494 
size_t
 
__d°Àn
Ë
__THROW
;

495 
size_t
 
	`__REDIRECT_NTH
 (
__wc§tombs_Æüs
,

496 (*
__ª°ri˘
 
__d°
,

497 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

498 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

499 
wc§tombs
);

500 
size_t
 
	`__REDIRECT_NTH
 (
__wc§tombs_chk_w¨n
,

501 (*
__ª°ri˘
 
__d°
,

502 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

503 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

504 
size_t
 
__d°Àn
), 
__wc§tombs_chk
)

505 
	`__w¨«âr
 ("wcsrtombs called with dst buffer smallerÅhanÜen");

507 
__f‹tify_fun˘i⁄
 
size_t


508 
	`__NTH
 (
	$wc§tombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 **__ª°ri˘ 
__§c
,

509 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

511 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

513 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

514  
	`__wc§tombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
, 
	`__bos
 (__dst));

516 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

517  
	`__wc§tombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
, 
	`__bos
 (__dst));

519  
	`__wc§tombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
);

520 
	}
}

523 #ifde‡
__USE_GNU


524 
size_t
 
	$__mb¢πowcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

525 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

526 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

527 
size_t
 
__d°Àn
Ë
__THROW
;

528 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢πowcs_Æüs
,

529 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

530 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

531 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

532 
mb¢πowcs
);

533 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢πowcs_chk_w¨n
,

534 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

535 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

536 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

537 
size_t
 
__d°Àn
), 
__mb¢πowcs_chk
)

538 
	`__w¨«âr
 ("mbsnrtowcs called with dst buffer smallerÅhanÜen "

541 
__f‹tify_fun˘i⁄
 
size_t


542 
	`__NTH
 (
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° **__ª°ri˘ 
__§c
,

543 
size_t
 
__nmc
, size_à
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

545 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

547 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

548  
	`__mb¢πowcs_chk
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
,

549 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

551 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

552  
	`__mb¢πowcs_chk_w¨n
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
,

553 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

555  
	`__mb¢πowcs_Æüs
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
);

556 
	}
}

559 
size_t
 
	$__wc¢πombs_chk
 (*
__ª°ri˘
 
__d°
,

560 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

561 
size_t
 
__nwc
, size_à
__Àn
,

562 
mb°©e_t
 *
__ª°ri˘
 
__ps
, 
size_t
 
__d°Àn
)

563 
__THROW
;

564 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢πombs_Æüs
,

565 (*
__ª°ri˘
 
__d°
,

566 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

567 
size_t
 
__nwc
, size_à
__Àn
,

568 
mb°©e_t
 *
__ª°ri˘
 
__ps
), 
wc¢πombs
);

569 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢πombs_chk_w¨n
,

570 (*
__ª°ri˘
 
__d°
,

571 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

572 
size_t
 
__nwc
, size_à
__Àn
,

573 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

574 
size_t
 
__d°Àn
), 
__wc¢πombs_chk
)

575 
	`__w¨«âr
 ("wcsnrtombs called with dst buffer smallerÅhanÜen");

577 
__f‹tify_fun˘i⁄
 
size_t


578 
	`__NTH
 (
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 **__ª°ri˘ 
__§c
,

579 
size_t
 
__nwc
, size_à
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

581 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

583 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

584  
	`__wc¢πombs_chk
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
,

585 
	`__bos
 (
__d°
));

587 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

588  
	`__wc¢πombs_chk_w¨n
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
,

589 
	`__bos
 (
__d°
));

591  
	`__wc¢πombs_Æüs
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
);

592 
	}
}

	@/usr/include/bits/wordsize.h

3 #i‡
deföed
 
__x86_64__
 && !deföed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

9 #ifde‡
__x86_64__


10 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

12 
	#__SYSCALL_WORDSIZE
 64

	)

	@/usr/include/bits/xopen_lim.h

29 #i‚de‡
_XOPEN_LIM_H


30 
	#_XOPEN_LIM_H
 1

	)

32 
	#__√ed_IOV_MAX


	)

33 
	~<bôs/°dio_lim.h
>

65 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

70 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

73 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

76 
	#NL_MSGMAX
 
INT_MAX


	)

80 
	#NL_NMAX
 
INT_MAX


	)

83 
	#NL_SETMAX
 
INT_MAX


	)

86 
	#NL_TEXTMAX
 
INT_MAX


	)

89 
	#NZERO
 20

	)

93 #ifde‡
INT_MAX


94 #i‡
INT_MAX
 == 32767

95 
	#WORD_BIT
 16

	)

97 #i‡
INT_MAX
 == 2147483647

98 
	#WORD_BIT
 32

	)

101 
	#WORD_BIT
 64

	)

104 #ñi‡
deföed
 
__INT_MAX__


105 #i‡
__INT_MAX__
 == 32767

106 
	#WORD_BIT
 16

	)

108 #i‡
__INT_MAX__
 == 2147483647

109 
	#WORD_BIT
 32

	)

112 
	#WORD_BIT
 64

	)

116 
	#WORD_BIT
 32

	)

120 #ifde‡
LONG_MAX


121 #i‡
LONG_MAX
 == 2147483647

122 
	#LONG_BIT
 32

	)

125 
	#LONG_BIT
 64

	)

127 #ñi‡
deföed
 
__LONG_MAX__


128 #i‡
__LONG_MAX__
 == 2147483647

129 
	#LONG_BIT
 32

	)

132 
	#LONG_BIT
 64

	)

135 
	~<bôs/w‹dsize.h
>

136 #i‡
__WORDSIZE
 == 64

137 
	#LONG_BIT
 64

	)

139 
	#LONG_BIT
 32

	)

	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 #i‡
__GLIBC_HAVE_LONG_LONG


74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

81 
	#htobe16
(
x
Ë(x)

	)

82 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

83 
	#be16toh
(
x
Ë(x)

	)

84 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

86 
	#htobe32
(
x
Ë(x)

	)

87 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

88 
	#be32toh
(
x
Ë(x)

	)

89 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

91 #i‡
__GLIBC_HAVE_LONG_LONG


92 
	#htobe64
(
x
Ë(x)

	)

93 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

94 
	#be64toh
(
x
Ë(x)

	)

95 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

98 #unde‡
__USE_ISOC11


99 #unde‡
__USE_ISOC99


100 #unde‡
__USE_ISOC95


101 #unde‡
__USE_ISOCXX11


102 #unde‡
__USE_POSIX


103 #unde‡
__USE_POSIX2


104 #unde‡
__USE_POSIX199309


105 #unde‡
__USE_POSIX199506


106 #unde‡
__USE_XOPEN


107 #unde‡
__USE_XOPEN_EXTENDED


108 #unde‡
__USE_UNIX98


109 #unde‡
__USE_XOPEN2K


110 #unde‡
__USE_XOPEN2KXSI


111 #unde‡
__USE_XOPEN2K8


112 #unde‡
__USE_XOPEN2K8XSI


113 #unde‡
__USE_LARGEFILE


114 #unde‡
__USE_LARGEFILE64


115 #unde‡
__USE_FILE_OFFSET64


116 #unde‡
__USE_BSD


117 #unde‡
__USE_SVID


118 #unde‡
__USE_MISC


119 #unde‡
__USE_ATFILE


120 #unde‡
__USE_GNU


121 #unde‡
__USE_REENTRANT


122 #unde‡
__USE_FORTIFY_LEVEL


123 #unde‡
__FAVOR_BSD


124 #unde‡
__KERNEL_STRICT_NAMES


128 #i‚de‡
_LOOSE_KERNEL_NAMES


129 
	#__KERNEL_STRICT_NAMES


	)

133 
	#__USE_ANSI
 1

	)

142 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


143 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

144 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

146 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

151 #i‡
deföed
 
_BSD_SOURCE
 && \

152 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

153 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

154 
	#__FAVOR_BSD
 1

	)

158 #ifde‡
_GNU_SOURCE


159 #unde‡
_ISOC95_SOURCE


160 
	#_ISOC95_SOURCE
 1

	)

161 #unde‡
_ISOC99_SOURCE


162 
	#_ISOC99_SOURCE
 1

	)

163 #unde‡
_ISOC11_SOURCE


164 
	#_ISOC11_SOURCE
 1

	)

165 #unde‡
_POSIX_SOURCE


166 
	#_POSIX_SOURCE
 1

	)

167 #unde‡
_POSIX_C_SOURCE


168 
	#_POSIX_C_SOURCE
 200809L

	)

169 #unde‡
_XOPEN_SOURCE


170 
	#_XOPEN_SOURCE
 700

	)

171 #unde‡
_XOPEN_SOURCE_EXTENDED


172 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

173 #unde‡
_LARGEFILE64_SOURCE


174 
	#_LARGEFILE64_SOURCE
 1

	)

175 #unde‡
_BSD_SOURCE


176 
	#_BSD_SOURCE
 1

	)

177 #unde‡
_SVID_SOURCE


178 
	#_SVID_SOURCE
 1

	)

179 #unde‡
_ATFILE_SOURCE


180 
	#_ATFILE_SOURCE
 1

	)

185 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

186 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

187 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

188 
	#_BSD_SOURCE
 1

	)

189 
	#_SVID_SOURCE
 1

	)

193 #i‡(
deföed
 
_ISOC11_SOURCE
 \

194 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

195 
	#__USE_ISOC11
 1

	)

199 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

200 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

201 
	#__USE_ISOC99
 1

	)

205 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

206 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

207 
	#__USE_ISOC95
 1

	)

214 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

215 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

216 
	#__USE_ISOCXX11
 1

	)

221 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

222 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

223 
	#_POSIX_SOURCE
 1

	)

224 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

225 
	#_POSIX_C_SOURCE
 2

	)

226 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

227 
	#_POSIX_C_SOURCE
 199506L

	)

228 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

229 
	#_POSIX_C_SOURCE
 200112L

	)

231 
	#_POSIX_C_SOURCE
 200809L

	)

233 
	#__USE_POSIX_IMPLICITLY
 1

	)

236 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


237 
	#__USE_POSIX
 1

	)

240 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


241 
	#__USE_POSIX2
 1

	)

244 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

245 
	#__USE_POSIX199309
 1

	)

248 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

249 
	#__USE_POSIX199506
 1

	)

252 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

253 
	#__USE_XOPEN2K
 1

	)

254 #unde‡
__USE_ISOC95


255 
	#__USE_ISOC95
 1

	)

256 #unde‡
__USE_ISOC99


257 
	#__USE_ISOC99
 1

	)

260 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

261 
	#__USE_XOPEN2K8
 1

	)

262 #unde‡
_ATFILE_SOURCE


263 
	#_ATFILE_SOURCE
 1

	)

266 #ifdef 
_XOPEN_SOURCE


267 
	#__USE_XOPEN
 1

	)

268 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

269 
	#__USE_XOPEN_EXTENDED
 1

	)

270 
	#__USE_UNIX98
 1

	)

271 #unde‡
_LARGEFILE_SOURCE


272 
	#_LARGEFILE_SOURCE
 1

	)

273 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

274 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

275 
	#__USE_XOPEN2K8
 1

	)

276 
	#__USE_XOPEN2K8XSI
 1

	)

278 
	#__USE_XOPEN2K
 1

	)

279 
	#__USE_XOPEN2KXSI
 1

	)

280 #unde‡
__USE_ISOC95


281 
	#__USE_ISOC95
 1

	)

282 #unde‡
__USE_ISOC99


283 
	#__USE_ISOC99
 1

	)

286 #ifde‡
_XOPEN_SOURCE_EXTENDED


287 
	#__USE_XOPEN_EXTENDED
 1

	)

292 #ifde‡
_LARGEFILE_SOURCE


293 
	#__USE_LARGEFILE
 1

	)

296 #ifde‡
_LARGEFILE64_SOURCE


297 
	#__USE_LARGEFILE64
 1

	)

300 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

301 
	#__USE_FILE_OFFSET64
 1

	)

304 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


305 
	#__USE_MISC
 1

	)

308 #ifdef 
_BSD_SOURCE


309 
	#__USE_BSD
 1

	)

312 #ifdef 
_SVID_SOURCE


313 
	#__USE_SVID
 1

	)

316 #ifdef 
_ATFILE_SOURCE


317 
	#__USE_ATFILE
 1

	)

320 #ifdef 
_GNU_SOURCE


321 
	#__USE_GNU
 1

	)

324 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


325 
	#__USE_REENTRANT
 1

	)

328 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0

329 #i‡!
deföed
 
__OPTIMIZE__
 || __OPTIMIZE__ <= 0

330 #w¨nög 
_FORTIFY_SOURCE
 
ªquúes
 
compûög
 
wôh
 
›timiz©i⁄
 (-
O
)

331 #ñi‡!
__GNUC_PREREQ
 (4, 1)

332 #w¨nög 
_FORTIFY_SOURCE
 
ªquúes
 
GCC
 4.1 
‹
 
œãr


333 #ñi‡
_FORTIFY_SOURCE
 > 1

334 
	#__USE_FORTIFY_LEVEL
 2

	)

336 
	#__USE_FORTIFY_LEVEL
 1

	)

339 #i‚de‡
__USE_FORTIFY_LEVEL


340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<°dc-¥edef.h
>

353 #unde‡
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 17

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

362 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

365 #i‡
deföed
 
__GNUC__
 \

366 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

367 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

368 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

369 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

373 #i‚de‡
__ASSEMBLER__


374 #i‚de‡
_SYS_CDEFS_H


375 
	~<sys/cdefs.h
>

380 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


381 
	#__USE_LARGEFILE
 1

	)

382 
	#__USE_LARGEFILE64
 1

	)

388 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

389 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

390 && 
deföed
 
	g__exã∫_ölöe


391 
	#__USE_EXTERN_INLINES
 1

	)

399 
	~<gnu/°ubs.h
>

	@/usr/include/libio.h

29 #i‚de‡
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_c⁄fig.h
>

34 
	#_IO_Âos_t
 
_G_Âos_t


	)

35 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

36 
	#_IO_size_t
 
size_t


	)

37 
	#_IO_ssize_t
 
__ssize_t


	)

38 
	#_IO_off_t
 
__off_t


	)

39 
	#_IO_off64_t
 
__off64_t


	)

40 
	#_IO_pid_t
 
__pid_t


	)

41 
	#_IO_uid_t
 
__uid_t


	)

42 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

43 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

44 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

45 
	#_IO_va_li°
 
_G_va_li°


	)

46 
	#_IO_wöt_t
 
wöt_t


	)

49 
	#__√ed___va_li°


	)

50 
	~<°d¨g.h
>

51 #ifde‡
__GNUC_VA_LIST


52 #unde‡
_IO_va_li°


53 
	#_IO_va_li°
 
__gnuc_va_li°


	)

56 #i‚de‡
__P


57 
	~<sys/cdefs.h
>

60 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

62 #i‚de‡
EOF


63 
	#EOF
 (-1)

	)

65 #i‚de‡
NULL


66 #i‡
deföed
 
__GNUG__
 && \

67 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

68 
	#NULL
 (
__nuŒ
)

	)

70 #i‡!
deföed
(
__˝lu•lus
)

71 
	#NULL
 ((*)0)

	)

73 
	#NULL
 (0)

	)

78 
	#_IOS_INPUT
 1

	)

79 
	#_IOS_OUTPUT
 2

	)

80 
	#_IOS_ATEND
 4

	)

81 
	#_IOS_APPEND
 8

	)

82 
	#_IOS_TRUNC
 16

	)

83 
	#_IOS_NOCREATE
 32

	)

84 
	#_IOS_NOREPLACE
 64

	)

85 
	#_IOS_BIN
 128

	)

93 
	#_IO_MAGIC
 0xFBAD0000

	)

94 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

95 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

96 
	#_IO_USER_BUF
 1

	)

97 
	#_IO_UNBUFFERED
 2

	)

98 
	#_IO_NO_READS
 4

	)

99 
	#_IO_NO_WRITES
 8

	)

100 
	#_IO_EOF_SEEN
 0x10

	)

101 
	#_IO_ERR_SEEN
 0x20

	)

102 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

103 
	#_IO_LINKED
 0x80

	)

104 
	#_IO_IN_BACKUP
 0x100

	)

105 
	#_IO_LINE_BUF
 0x200

	)

106 
	#_IO_TIED_PUT_GET
 0x400

	)

107 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

108 
	#_IO_IS_APPENDING
 0x1000

	)

109 
	#_IO_IS_FILEBUF
 0x2000

	)

110 
	#_IO_BAD_SEEN
 0x4000

	)

111 
	#_IO_USER_LOCK
 0x8000

	)

113 
	#_IO_FLAGS2_MMAP
 1

	)

114 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

115 #ifde‡
_LIBC


116 
	#_IO_FLAGS2_FORTIFY
 4

	)

118 
	#_IO_FLAGS2_USER_WBUF
 8

	)

119 #ifde‡
_LIBC


120 
	#_IO_FLAGS2_SCANF_STD
 16

	)

121 
	#_IO_FLAGS2_NOCLOSE
 32

	)

122 
	#_IO_FLAGS2_CLOEXEC
 64

	)

126 
	#_IO_SKIPWS
 01

	)

127 
	#_IO_LEFT
 02

	)

128 
	#_IO_RIGHT
 04

	)

129 
	#_IO_INTERNAL
 010

	)

130 
	#_IO_DEC
 020

	)

131 
	#_IO_OCT
 040

	)

132 
	#_IO_HEX
 0100

	)

133 
	#_IO_SHOWBASE
 0200

	)

134 
	#_IO_SHOWPOINT
 0400

	)

135 
	#_IO_UPPERCASE
 01000

	)

136 
	#_IO_SHOWPOS
 02000

	)

137 
	#_IO_SCIENTIFIC
 04000

	)

138 
	#_IO_FIXED
 010000

	)

139 
	#_IO_UNITBUF
 020000

	)

140 
	#_IO_STDIO
 040000

	)

141 
	#_IO_DONT_CLOSE
 0100000

	)

142 
	#_IO_BOOLALPHA
 0200000

	)

145 
_IO_jump_t
; 
	g_IO_FILE
;

148 #ifde‡
_IO_MTSAFE_IO


149 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

150 
	~<bôs/°dio-lock.h
>

155 
	t_IO_lock_t
;

161 
	s_IO_m¨kî
 {

162 
_IO_m¨kî
 *
	m_√xt
;

163 
_IO_FILE
 *
	m_sbuf
;

167 
	m_pos
;

169 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

170 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

171 
	mpublic
:

172 
°ªamm¨kî
(
°ªambuf
 *
sb
);

173 ~
°ªamm¨kî
();

174 
ßvög
(Ë{  
	m_•os
 == -2; }

175 
dñè
(
°ªamm¨kî
&);

176 
dñè
();

181 
	e__codecvt_ªsu…


183 
	m__codecvt_ok
,

184 
	m__codecvt_∑πül
,

185 
	m__codecvt_îr‹
,

186 
	m__codecvt_noc⁄v


189 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


192 
	s_IO_codecvt


194 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

195 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

196 
	m__mb°©e_t
 *,

197 c⁄° 
	mwch¨_t
 *,

198 c⁄° 
	mwch¨_t
 *,

199 c⁄° 
	mwch¨_t
 **, *,

201 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

202 
	m__mb°©e_t
 *, *,

204 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

205 
	m__mb°©e_t
 *,

207 c⁄° **, 
	mwch¨_t
 *,

208 
	mwch¨_t
 *, wchar_t **);

209 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

211 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

212 c⁄° *, c⁄° *, 
	m_IO_size_t
);

213 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

215 
_IO_ic⁄v_t
 
	m__cd_ö
;

216 
_IO_ic⁄v_t
 
	m__cd_out
;

220 
	s_IO_wide_d©a


222 
wch¨_t
 *
	m_IO_ªad_±r
;

223 
wch¨_t
 *
	m_IO_ªad_íd
;

224 
wch¨_t
 *
	m_IO_ªad_ba£
;

225 
wch¨_t
 *
	m_IO_wrôe_ba£
;

226 
wch¨_t
 *
	m_IO_wrôe_±r
;

227 
wch¨_t
 *
	m_IO_wrôe_íd
;

228 
wch¨_t
 *
	m_IO_buf_ba£
;

229 
wch¨_t
 *
	m_IO_buf_íd
;

231 
wch¨_t
 *
	m_IO_ßve_ba£
;

232 
wch¨_t
 *
	m_IO_backup_ba£
;

234 
wch¨_t
 *
	m_IO_ßve_íd
;

236 
__mb°©e_t
 
	m_IO_°©e
;

237 
__mb°©e_t
 
	m_IO_œ°_°©e
;

238 
_IO_codecvt
 
	m_codecvt
;

240 
wch¨_t
 
	m_sh‹tbuf
[1];

242 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

246 
	s_IO_FILE
 {

247 
	m_Êags
;

248 
	#_IO_fûe_Êags
 
_Êags


	)

252 * 
	m_IO_ªad_±r
;

253 * 
	m_IO_ªad_íd
;

254 * 
	m_IO_ªad_ba£
;

255 * 
	m_IO_wrôe_ba£
;

256 * 
	m_IO_wrôe_±r
;

257 * 
	m_IO_wrôe_íd
;

258 * 
	m_IO_buf_ba£
;

259 * 
	m_IO_buf_íd
;

261 *
	m_IO_ßve_ba£
;

262 *
	m_IO_backup_ba£
;

263 *
	m_IO_ßve_íd
;

265 
_IO_m¨kî
 *
	m_m¨kîs
;

267 
_IO_FILE
 *
	m_chaö
;

269 
	m_fûío
;

271 
	m_blksize
;

273 
	m_Êags2
;

275 
_IO_off_t
 
	m_ﬁd_off£t
;

277 
	#__HAVE_COLUMN


	)

279 
	m_cur_cﬁumn
;

280 sig√d 
	m_vèbÀ_off£t
;

281 
	m_sh‹tbuf
[1];

285 
_IO_lock_t
 *
	m_lock
;

286 #ifde‡
_IO_USE_OLD_IO_FILE


289 
	s_IO_FILE_com∂ëe


291 
_IO_FILE
 
	m_fûe
;

293 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

294 
_IO_off64_t
 
	m_off£t
;

295 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


297 
_IO_codecvt
 *
	m_codecvt
;

298 
_IO_wide_d©a
 *
	m_wide_d©a
;

299 
_IO_FILE
 *
	m_‰ìªs_li°
;

300 *
	m_‰ìªs_buf
;

301 
size_t
 
	m_‰ìªs_size
;

303 *
	m__∑d1
;

304 *
	m__∑d2
;

305 *
	m__∑d3
;

306 *
	m__∑d4
;

307 
size_t
 
	m__∑d5
;

309 
	m_mode
;

311 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

315 #i‚de‡
__˝lu•lus


316 
_IO_FILE
 
	t_IO_FILE
;

319 
	g_IO_FILE_∂us
;

321 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

322 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

323 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

324 #i‚de‡
_LIBC


325 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

326 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

327 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

329 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

330 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

331 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

339 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

347 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, c⁄° *
	t__buf
,

348 
	tsize_t
 
	t__n
);

356 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

359 
	t__io_˛o£_‚
 (*
	t__cookõ
);

362 #ifde‡
_GNU_SOURCE


364 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

365 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

366 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

367 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

372 
__io_ªad_‚
 *
	mªad
;

373 
__io_wrôe_‚
 *
	mwrôe
;

374 
__io_£ek_‚
 *
	m£ek
;

375 
__io_˛o£_‚
 *
	m˛o£
;

376 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

377 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

379 
	g_IO_cookõ_fûe
;

382 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

383 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

387 #ifde‡
__˝lu•lus


391 
__undîÊow
 (
_IO_FILE
 *);

392 
__uÊow
 (
_IO_FILE
 *);

393 
__ovîÊow
 (
_IO_FILE
 *, );

394 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


395 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

396 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

397 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

400 #i‡ 
__GNUC__
 >= 3

401 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

403 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

406 
	#_IO_gëc_u∆ocked
(
_Â
) \

407 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

408 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

409 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

410 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

411 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

412 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

413 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

414 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

415 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

416 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

418 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


419 
	#_IO_gëwc_u∆ocked
(
_Â
) \

420 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

421 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

422 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

423 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

424 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

425 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

426 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

427 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

428 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

429 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

432 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

433 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

435 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

436 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

437 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

438 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

440 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

443 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

444 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

446 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

447 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

448 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

450 #ifde‡
_IO_MTSAFE_IO


451 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

452 
	#_IO_Êockfûe
(
_Â
) \

453 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

454 
	#_IO_fu∆ockfûe
(
_Â
) \

455 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

457 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

458 
	#_IO_Êockfûe
(
_Â
Ë

	)

459 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

460 
	#_IO_·rylockfûe
(
_Â
Ë

	)

461 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

462 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

465 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

466 
_IO_va_li°
, *
__ª°ri˘
);

467 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

468 
_IO_va_li°
);

469 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

470 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

472 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

473 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

475 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

477 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


478 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

479 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

480 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

481 #i‡
__GNUC__
 >= 2

484 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


485 
	~<shlib-com∑t.h
>

486 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

487 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

488 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

489 c⁄° 
_IO_°dö_u£d
;

490 
wók_exã∫
 (
_IO_°dö_u£d
);

493 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


494 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

498 
	#_IO_fwide
(
__Â
, 
__mode
) \

499 ({ 
__ªsu…
 = (
__mode
); \

500 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

502 i‡((
__Â
)->
_mode
 == 0) \

504 (
__Â
)->
_mode
 = -1; \

505 
__ªsu…
 = (
__Â
)->
_mode
; \

507 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

508 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

510 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

511 
__ªsu…
; })

	)

514 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

515 
_IO_va_li°
, *
__ª°ri˘
);

516 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

517 
_IO_va_li°
);

518 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

519 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

522 #ifde‡
__LDBL_COMPAT


523 
	~<bôs/libio-ldbl.h
>

526 #ifde‡
__˝lu•lus


	@/usr/include/linux/bpf_common.h

1 #i‚de‡
__LINUX_BPF_COMMON_H__


2 
	#__LINUX_BPF_COMMON_H__


	)

5 
	#BPF_CLASS
(
code
Ë((codeË& 0x07)

	)

6 
	#BPF_LD
 0x00

	)

7 
	#BPF_LDX
 0x01

	)

8 
	#BPF_ST
 0x02

	)

9 
	#BPF_STX
 0x03

	)

10 
	#BPF_ALU
 0x04

	)

11 
	#BPF_JMP
 0x05

	)

12 
	#BPF_RET
 0x06

	)

13 
	#BPF_MISC
 0x07

	)

16 
	#BPF_SIZE
(
code
Ë((codeË& 0x18)

	)

17 
	#BPF_W
 0x00

	)

18 
	#BPF_H
 0x08

	)

19 
	#BPF_B
 0x10

	)

20 
	#BPF_MODE
(
code
Ë((codeË& 0xe0)

	)

21 
	#BPF_IMM
 0x00

	)

22 
	#BPF_ABS
 0x20

	)

23 
	#BPF_IND
 0x40

	)

24 
	#BPF_MEM
 0x60

	)

25 
	#BPF_LEN
 0x80

	)

26 
	#BPF_MSH
 0xa0

	)

29 
	#BPF_OP
(
code
Ë((codeË& 0xf0)

	)

30 
	#BPF_ADD
 0x00

	)

31 
	#BPF_SUB
 0x10

	)

32 
	#BPF_MUL
 0x20

	)

33 
	#BPF_DIV
 0x30

	)

34 
	#BPF_OR
 0x40

	)

35 
	#BPF_AND
 0x50

	)

36 
	#BPF_LSH
 0x60

	)

37 
	#BPF_RSH
 0x70

	)

38 
	#BPF_NEG
 0x80

	)

39 
	#BPF_MOD
 0x90

	)

40 
	#BPF_XOR
 0xa0

	)

42 
	#BPF_JA
 0x00

	)

43 
	#BPF_JEQ
 0x10

	)

44 
	#BPF_JGT
 0x20

	)

45 
	#BPF_JGE
 0x30

	)

46 
	#BPF_JSET
 0x40

	)

47 
	#BPF_SRC
(
code
Ë((codeË& 0x08)

	)

48 
	#BPF_K
 0x00

	)

49 
	#BPF_X
 0x08

	)

51 #i‚de‡
BPF_MAXINSNS


52 
	#BPF_MAXINSNS
 4096

	)

	@/usr/include/linux/if_addr.h

1 #i‚de‡
__LINUX_IF_ADDR_H


2 
	#__LINUX_IF_ADDR_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

7 
	siÁddrmsg
 {

8 
__u8
 
	miÁ_Ámûy
;

9 
__u8
 
	miÁ_¥efixÀn
;

10 
__u8
 
	miÁ_Êags
;

11 
__u8
 
	miÁ_sc›e
;

12 
__u32
 
	miÁ_ödex
;

26 
	mIFA_UNSPEC
,

27 
	mIFA_ADDRESS
,

28 
	mIFA_LOCAL
,

29 
	mIFA_LABEL
,

30 
	mIFA_BROADCAST
,

31 
	mIFA_ANYCAST
,

32 
	mIFA_CACHEINFO
,

33 
	mIFA_MULTICAST
,

34 
	mIFA_FLAGS
,

35 
	m__IFA_MAX
,

38 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

41 
	#IFA_F_SECONDARY
 0x01

	)

42 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

44 
	#IFA_F_NODAD
 0x02

	)

45 
	#IFA_F_OPTIMISTIC
 0x04

	)

46 
	#IFA_F_DADFAILED
 0x08

	)

47 
	#IFA_F_HOMEADDRESS
 0x10

	)

48 
	#IFA_F_DEPRECATED
 0x20

	)

49 
	#IFA_F_TENTATIVE
 0x40

	)

50 
	#IFA_F_PERMANENT
 0x80

	)

51 
	#IFA_F_MANAGETEMPADDR
 0x100

	)

52 
	#IFA_F_NOPREFIXROUTE
 0x200

	)

53 
	#IFA_F_MCAUTOJOIN
 0x400

	)

54 
	#IFA_F_STABLE_PRIVACY
 0x800

	)

56 
	siÁ_ˇcheöfo
 {

57 
__u32
 
	miÁ_¥e„ªd
;

58 
__u32
 
	miÁ_vÆid
;

59 
__u32
 
	mc°amp
;

60 
__u32
 
	mt°amp
;

64 
	#IFA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iÁddrmsg
))))

	)

65 
	#IFA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iÁddrmsg
))

	)

	@/usr/include/linux/if_link.h

1 #i‚de‡
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

8 
	sπ∆_lök_°©s
 {

9 
__u32
 
	mrx_∑ckës
;

10 
__u32
 
	mtx_∑ckës
;

11 
__u32
 
	mrx_byãs
;

12 
__u32
 
	mtx_byãs
;

13 
__u32
 
	mrx_îr‹s
;

14 
__u32
 
	mtx_îr‹s
;

15 
__u32
 
	mrx_dr›≥d
;

16 
__u32
 
	mtx_dr›≥d
;

17 
__u32
 
	mmu…iˇ°
;

18 
__u32
 
	mcﬁlisi⁄s
;

21 
__u32
 
	mrx_Àngth_îr‹s
;

22 
__u32
 
	mrx_ovî_îr‹s
;

23 
__u32
 
	mrx_¸c_îr‹s
;

24 
__u32
 
	mrx_‰ame_îr‹s
;

25 
__u32
 
	mrx_fifo_îr‹s
;

26 
__u32
 
	mrx_mis£d_îr‹s
;

29 
__u32
 
	mtx_ab‹ãd_îr‹s
;

30 
__u32
 
	mtx_ˇºõr_îr‹s
;

31 
__u32
 
	mtx_fifo_îr‹s
;

32 
__u32
 
	mtx_hóπbót_îr‹s
;

33 
__u32
 
	mtx_wödow_îr‹s
;

36 
__u32
 
	mrx_com¥es£d
;

37 
__u32
 
	mtx_com¥es£d
;

39 #i‚de‡
__GENKSYMS__


40 
__u32
 
	mrx_noh™dÀr
;

45 
	sπ∆_lök_°©s64
 {

46 
__u64
 
	mrx_∑ckës
;

47 
__u64
 
	mtx_∑ckës
;

48 
__u64
 
	mrx_byãs
;

49 
__u64
 
	mtx_byãs
;

50 
__u64
 
	mrx_îr‹s
;

51 
__u64
 
	mtx_îr‹s
;

52 
__u64
 
	mrx_dr›≥d
;

53 
__u64
 
	mtx_dr›≥d
;

54 
__u64
 
	mmu…iˇ°
;

55 
__u64
 
	mcﬁlisi⁄s
;

58 
__u64
 
	mrx_Àngth_îr‹s
;

59 
__u64
 
	mrx_ovî_îr‹s
;

60 
__u64
 
	mrx_¸c_îr‹s
;

61 
__u64
 
	mrx_‰ame_îr‹s
;

62 
__u64
 
	mrx_fifo_îr‹s
;

63 
__u64
 
	mrx_mis£d_îr‹s
;

66 
__u64
 
	mtx_ab‹ãd_îr‹s
;

67 
__u64
 
	mtx_ˇºõr_îr‹s
;

68 
__u64
 
	mtx_fifo_îr‹s
;

69 
__u64
 
	mtx_hóπbót_îr‹s
;

70 
__u64
 
	mtx_wödow_îr‹s
;

73 
__u64
 
	mrx_com¥es£d
;

74 
__u64
 
	mtx_com¥es£d
;

76 #i‚de‡
__GENKSYMS__


77 
__u64
 
	mrx_noh™dÀr
;

82 
	sπ∆_lök_ifm≠
 {

83 
__u64
 
	mmem_°¨t
;

84 
__u64
 
	mmem_íd
;

85 
__u64
 
	mba£_addr
;

86 
__u16
 
	múq
;

87 
__u8
 
	mdma
;

88 
__u8
 
	mp‹t
;

110 
	mIFLA_UNSPEC
,

111 
	mIFLA_ADDRESS
,

112 
	mIFLA_BROADCAST
,

113 
	mIFLA_IFNAME
,

114 
	mIFLA_MTU
,

115 
	mIFLA_LINK
,

116 
	mIFLA_QDISC
,

117 
	mIFLA_STATS
,

118 
	mIFLA_COST
,

119 
	#IFLA_COST
 
IFLA_COST


	)

120 
	mIFLA_PRIORITY
,

121 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

122 
	mIFLA_MASTER
,

123 
	#IFLA_MASTER
 
IFLA_MASTER


	)

124 
	mIFLA_WIRELESS
,

125 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

126 
	mIFLA_PROTINFO
,

127 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

128 
	mIFLA_TXQLEN
,

129 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

130 
	mIFLA_MAP
,

131 
	#IFLA_MAP
 
IFLA_MAP


	)

132 
	mIFLA_WEIGHT
,

133 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

134 
	mIFLA_OPERSTATE
,

135 
	mIFLA_LINKMODE
,

136 
	mIFLA_LINKINFO
,

137 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

138 
	mIFLA_NET_NS_PID
,

139 
	mIFLA_IFALIAS
,

140 
	mIFLA_NUM_VF
,

141 
	mIFLA_VFINFO_LIST
,

142 
	mIFLA_STATS64
,

143 
	mIFLA_VF_PORTS
,

144 
	mIFLA_PORT_SELF
,

145 
	mIFLA_AF_SPEC
,

146 
	mIFLA_GROUP
,

147 
	mIFLA_NET_NS_FD
,

148 
	mIFLA_EXT_MASK
,

149 
	mIFLA_PROMISCUITY
,

150 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

151 
	mIFLA_NUM_TX_QUEUES
,

152 
	mIFLA_NUM_RX_QUEUES
,

153 
	mIFLA_CARRIER
,

154 
	mIFLA_PHYS_PORT_ID
,

155 
	mIFLA_CARRIER_CHANGES
,

156 
	mIFLA_PHYS_SWITCH_ID
,

157 
	mIFLA_LINK_NETNSID
,

158 
	mIFLA_PHYS_PORT_NAME
,

159 
	mIFLA_PROTO_DOWN
,

160 
	mIFLA_GSO_MAX_SEGS
,

161 
	mIFLA_GSO_MAX_SIZE
,

162 
	mIFLA_PAD
,

163 
	m__RH_RESERVED_IFLA_XDP
,

164 
	mIFLA_EVENT
,

165 
	mIFLA_NEW_NETNSID
,

166 
	mIFLA_IF_NETNSID
,

167 
	m__RH_RESERVED_IFLA_CARRIER_UP_COUNT
,

168 
	m__RH_RESERVED_IFLA_CARRIER_DOWN_COUNT
,

169 
	mIFLA_NEW_IFINDEX
,

170 
	m__IFLA_MAX


174 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

177 
	#IFLA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iföfomsg
))))

	)

178 
	#IFLA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iföfomsg
))

	)

181 
	mIFLA_INET_UNSPEC
,

182 
	mIFLA_INET_CONF
,

183 
	m__IFLA_INET_MAX
,

186 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

219 
	mIFLA_INET6_UNSPEC
,

220 
	mIFLA_INET6_FLAGS
,

221 
	mIFLA_INET6_CONF
,

222 
	mIFLA_INET6_STATS
,

223 
	mIFLA_INET6_MCAST
,

224 
	mIFLA_INET6_CACHEINFO
,

225 
	mIFLA_INET6_ICMP6STATS
,

226 
	mIFLA_INET6_TOKEN
,

227 
	mIFLA_INET6_ADDR_GEN_MODE
,

228 
	m__IFLA_INET6_MAX


231 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

233 
	eö6_addr_gí_mode
 {

234 
	mIN6_ADDR_GEN_MODE_EUI64
,

235 
	mIN6_ADDR_GEN_MODE_NONE
,

236 
	mIN6_ADDR_GEN_MODE_STABLE_PRIVACY
,

237 
	mIN6_ADDR_GEN_MODE_RANDOM
,

243 
	mIFLA_BR_UNSPEC
,

244 
	mIFLA_BR_FORWARD_DELAY
,

245 
	mIFLA_BR_HELLO_TIME
,

246 
	mIFLA_BR_MAX_AGE
,

247 
	mIFLA_BR_AGEING_TIME
,

248 
	mIFLA_BR_STP_STATE
,

249 
	mIFLA_BR_PRIORITY
,

250 
	mIFLA_BR_VLAN_FILTERING
,

251 
	mIFLA_BR_VLAN_PROTOCOL
,

252 
	mIFLA_BR_GROUP_FWD_MASK
,

253 
	mIFLA_BR_ROOT_ID
,

254 
	mIFLA_BR_BRIDGE_ID
,

255 
	mIFLA_BR_ROOT_PORT
,

256 
	mIFLA_BR_ROOT_PATH_COST
,

257 
	mIFLA_BR_TOPOLOGY_CHANGE
,

258 
	mIFLA_BR_TOPOLOGY_CHANGE_DETECTED
,

259 
	mIFLA_BR_HELLO_TIMER
,

260 
	mIFLA_BR_TCN_TIMER
,

261 
	mIFLA_BR_TOPOLOGY_CHANGE_TIMER
,

262 
	mIFLA_BR_GC_TIMER
,

263 
	mIFLA_BR_GROUP_ADDR
,

264 
	mIFLA_BR_FDB_FLUSH
,

265 
	mIFLA_BR_MCAST_ROUTER
,

266 
	mIFLA_BR_MCAST_SNOOPING
,

267 
	mIFLA_BR_MCAST_QUERY_USE_IFADDR
,

268 
	mIFLA_BR_MCAST_QUERIER
,

269 
	mIFLA_BR_MCAST_HASH_ELASTICITY
,

270 
	mIFLA_BR_MCAST_HASH_MAX
,

271 
	mIFLA_BR_MCAST_LAST_MEMBER_CNT
,

272 
	mIFLA_BR_MCAST_STARTUP_QUERY_CNT
,

273 
	mIFLA_BR_MCAST_LAST_MEMBER_INTVL
,

274 
	mIFLA_BR_MCAST_MEMBERSHIP_INTVL
,

275 
	mIFLA_BR_MCAST_QUERIER_INTVL
,

276 
	mIFLA_BR_MCAST_QUERY_INTVL
,

277 
	mIFLA_BR_MCAST_QUERY_RESPONSE_INTVL
,

278 
	mIFLA_BR_MCAST_STARTUP_QUERY_INTVL
,

279 
	mIFLA_BR_NF_CALL_IPTABLES
,

280 
	mIFLA_BR_NF_CALL_IP6TABLES
,

281 
	mIFLA_BR_NF_CALL_ARPTABLES
,

282 
	mIFLA_BR_VLAN_DEFAULT_PVID
,

283 
	mIFLA_BR_PAD
,

284 
	mIFLA_BR_VLAN_STATS_ENABLED
,

285 
	mIFLA_BR_MCAST_STATS_ENABLED
,

286 
	mIFLA_BR_MCAST_IGMP_VERSION
,

287 
	mIFLA_BR_MCAST_MLD_VERSION
,

288 
	m__IFLA_BR_MAX
,

291 
	#IFLA_BR_MAX
 (
__IFLA_BR_MAX
 - 1)

	)

293 
	siÊa_bridge_id
 {

294 
__u8
 
	m¥io
[2];

295 
__u8
 
	maddr
[6];

299 
	mBRIDGE_MODE_UNSPEC
,

300 
	mBRIDGE_MODE_HAIRPIN
,

304 
	mIFLA_BRPORT_UNSPEC
,

305 
	mIFLA_BRPORT_STATE
,

306 
	mIFLA_BRPORT_PRIORITY
,

307 
	mIFLA_BRPORT_COST
,

308 
	mIFLA_BRPORT_MODE
,

309 
	mIFLA_BRPORT_GUARD
,

310 
	mIFLA_BRPORT_PROTECT
,

311 
	mIFLA_BRPORT_FAST_LEAVE
,

312 
	mIFLA_BRPORT_LEARNING
,

313 
	mIFLA_BRPORT_UNICAST_FLOOD
,

314 
	mIFLA_BRPORT_PROXYARP
,

315 
	mIFLA_BRPORT_LEARNING_SYNC
,

316 
	mIFLA_BRPORT_PROXYARP_WIFI
,

317 
	mIFLA_BRPORT_ROOT_ID
,

318 
	mIFLA_BRPORT_BRIDGE_ID
,

319 
	mIFLA_BRPORT_DESIGNATED_PORT
,

320 
	mIFLA_BRPORT_DESIGNATED_COST
,

321 
	mIFLA_BRPORT_ID
,

322 
	mIFLA_BRPORT_NO
,

323 
	mIFLA_BRPORT_TOPOLOGY_CHANGE_ACK
,

324 
	mIFLA_BRPORT_CONFIG_PENDING
,

325 
	mIFLA_BRPORT_MESSAGE_AGE_TIMER
,

326 
	mIFLA_BRPORT_FORWARD_DELAY_TIMER
,

327 
	mIFLA_BRPORT_HOLD_TIMER
,

328 
	mIFLA_BRPORT_FLUSH
,

329 
	mIFLA_BRPORT_MULTICAST_ROUTER
,

330 
	mIFLA_BRPORT_PAD
,

331 
	mIFLA_BRPORT_MCAST_FLOOD
,

332 
	mIFLA_BRPORT_MCAST_TO_UCAST
,

333 
	mIFLA_BRPORT_VLAN_TUNNEL
,

334 
	mIFLA_BRPORT_BCAST_FLOOD
,

335 
	m__IFLA_BRPORT_MAX


337 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

339 
	siÊa_ˇcheöfo
 {

340 
__u32
 
	mmax_ªasm_Àn
;

341 
__u32
 
	mt°amp
;

342 
__u32
 
	mªachabÀ_time
;

343 
__u32
 
	mªå™s_time
;

347 
	mIFLA_INFO_UNSPEC
,

348 
	mIFLA_INFO_KIND
,

349 
	mIFLA_INFO_DATA
,

350 
	mIFLA_INFO_XSTATS
,

351 
	mIFLA_INFO_SLAVE_KIND
,

352 
	mIFLA_INFO_SLAVE_DATA
,

353 
	m__IFLA_INFO_MAX
,

356 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

361 
	mIFLA_VLAN_UNSPEC
,

362 
	mIFLA_VLAN_ID
,

363 
	mIFLA_VLAN_FLAGS
,

364 
	mIFLA_VLAN_EGRESS_QOS
,

365 
	mIFLA_VLAN_INGRESS_QOS
,

366 
	mIFLA_VLAN_PROTOCOL
,

367 
	m__IFLA_VLAN_MAX
,

370 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

372 
	siÊa_vœn_Êags
 {

373 
__u32
 
	mÊags
;

374 
__u32
 
	mmask
;

378 
	mIFLA_VLAN_QOS_UNSPEC
,

379 
	mIFLA_VLAN_QOS_MAPPING
,

380 
	m__IFLA_VLAN_QOS_MAX


383 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

385 
	siÊa_vœn_qos_m≠pög
 {

386 
__u32
 
	m‰om
;

387 
__u32
 
	mto
;

392 
	mIFLA_MACVLAN_UNSPEC
,

393 
	mIFLA_MACVLAN_MODE
,

394 
	mIFLA_MACVLAN_FLAGS
,

395 
	m__IFLA_MACVLAN_MAX
,

398 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

400 
	emacvœn_mode
 {

401 
	mMACVLAN_MODE_PRIVATE
 = 1,

402 
	mMACVLAN_MODE_VEPA
 = 2,

403 
	mMACVLAN_MODE_BRIDGE
 = 4,

404 
	mMACVLAN_MODE_PASSTHRU
 = 8,

407 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

411 
	mIFLA_MACSEC_UNSPEC
,

412 
	mIFLA_MACSEC_SCI
,

413 
	mIFLA_MACSEC_PORT
,

414 
	mIFLA_MACSEC_ICV_LEN
,

415 
	mIFLA_MACSEC_CIPHER_SUITE
,

416 
	mIFLA_MACSEC_WINDOW
,

417 
	mIFLA_MACSEC_ENCODING_SA
,

418 
	mIFLA_MACSEC_ENCRYPT
,

419 
	mIFLA_MACSEC_PROTECT
,

420 
	mIFLA_MACSEC_INC_SCI
,

421 
	mIFLA_MACSEC_ES
,

422 
	mIFLA_MACSEC_SCB
,

423 
	mIFLA_MACSEC_REPLAY_PROTECT
,

424 
	mIFLA_MACSEC_VALIDATION
,

425 
	mIFLA_MACSEC_PAD
,

426 
	m__IFLA_MACSEC_MAX
,

429 
	#IFLA_MACSEC_MAX
 (
__IFLA_MACSEC_MAX
 - 1)

	)

431 
	emac£c_vÆid©i⁄_ty≥
 {

432 
	mMACSEC_VALIDATE_DISABLED
 = 0,

433 
	mMACSEC_VALIDATE_CHECK
 = 1,

434 
	mMACSEC_VALIDATE_STRICT
 = 2,

435 
	m__MACSEC_VALIDATE_END
,

436 
	mMACSEC_VALIDATE_MAX
 = 
__MACSEC_VALIDATE_END
 - 1,

441 
	mIFLA_VXLAN_UNSPEC
,

442 
	mIFLA_VXLAN_ID
,

443 
	mIFLA_VXLAN_GROUP
,

444 
	mIFLA_VXLAN_LINK
,

445 
	mIFLA_VXLAN_LOCAL
,

446 
	mIFLA_VXLAN_TTL
,

447 
	mIFLA_VXLAN_TOS
,

448 
	mIFLA_VXLAN_LEARNING
,

449 
	mIFLA_VXLAN_AGEING
,

450 
	mIFLA_VXLAN_LIMIT
,

451 
	mIFLA_VXLAN_PORT_RANGE
,

452 
	mIFLA_VXLAN_PROXY
,

453 
	mIFLA_VXLAN_RSC
,

454 
	mIFLA_VXLAN_L2MISS
,

455 
	mIFLA_VXLAN_L3MISS
,

456 
	mIFLA_VXLAN_PORT
,

457 
	mIFLA_VXLAN_GROUP6
,

458 
	mIFLA_VXLAN_LOCAL6
,

459 
	mIFLA_VXLAN_UDP_CSUM
,

460 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_TX
,

461 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_RX
,

462 
	mIFLA_VXLAN_REMCSUM_TX
,

463 
	mIFLA_VXLAN_REMCSUM_RX
,

464 
	mIFLA_VXLAN_GBP
,

465 
	mIFLA_VXLAN_REMCSUM_NOPARTIAL
,

466 
	mIFLA_VXLAN_COLLECT_METADATA
,

467 
	mIFLA_VXLAN_LABEL
,

468 
	mIFLA_VXLAN_GPE
,

469 
	mIFLA_VXLAN_TTL_INHERIT
,

470 
	m__IFLA_VXLAN_MAX


472 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

474 
	siÊa_vxœn_p‹t_ønge
 {

475 
__be16
 
	mlow
;

476 
__be16
 
	mhigh
;

481 
	mIFLA_GENEVE_UNSPEC
,

482 
	mIFLA_GENEVE_ID
,

483 
	mIFLA_GENEVE_REMOTE
,

484 
	mIFLA_GENEVE_TTL
,

485 
	mIFLA_GENEVE_TOS
,

486 
	mIFLA_GENEVE_PORT
,

487 
	mIFLA_GENEVE_COLLECT_METADATA
,

488 
	mIFLA_GENEVE_REMOTE6
,

489 
	mIFLA_GENEVE_UDP_CSUM
,

490 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_TX
,

491 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_RX
,

492 
	mIFLA_GENEVE_LABEL
,

493 
	m__IFLA_GENEVE_MAX


495 
	#IFLA_GENEVE_MAX
 (
__IFLA_GENEVE_MAX
 - 1)

	)

500 
	mIFLA_BOND_UNSPEC
,

501 
	mIFLA_BOND_MODE
,

502 
	mIFLA_BOND_ACTIVE_SLAVE
,

503 
	mIFLA_BOND_MIIMON
,

504 
	mIFLA_BOND_UPDELAY
,

505 
	mIFLA_BOND_DOWNDELAY
,

506 
	mIFLA_BOND_USE_CARRIER
,

507 
	mIFLA_BOND_ARP_INTERVAL
,

508 
	mIFLA_BOND_ARP_IP_TARGET
,

509 
	mIFLA_BOND_ARP_VALIDATE
,

510 
	mIFLA_BOND_ARP_ALL_TARGETS
,

511 
	mIFLA_BOND_PRIMARY
,

512 
	mIFLA_BOND_PRIMARY_RESELECT
,

513 
	mIFLA_BOND_FAIL_OVER_MAC
,

514 
	mIFLA_BOND_XMIT_HASH_POLICY
,

515 
	mIFLA_BOND_RESEND_IGMP
,

516 
	mIFLA_BOND_NUM_PEER_NOTIF
,

517 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

518 
	mIFLA_BOND_MIN_LINKS
,

519 
	mIFLA_BOND_LP_INTERVAL
,

520 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

521 
	mIFLA_BOND_AD_LACP_RATE
,

522 
	mIFLA_BOND_AD_SELECT
,

523 
	mIFLA_BOND_AD_INFO
,

524 
	mIFLA_BOND_AD_ACTOR_SYS_PRIO
,

525 
	mIFLA_BOND_AD_USER_PORT_KEY
,

526 
	mIFLA_BOND_AD_ACTOR_SYSTEM
,

527 
	mIFLA_BOND_TLB_DYNAMIC_LB
,

528 
	m__IFLA_BOND_MAX
,

531 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

534 
	mIFLA_BOND_AD_INFO_UNSPEC
,

535 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

536 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

537 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

538 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

539 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

540 
	m__IFLA_BOND_AD_INFO_MAX
,

543 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

546 
	mIFLA_BOND_SLAVE_UNSPEC
,

547 
	mIFLA_BOND_SLAVE_STATE
,

548 
	mIFLA_BOND_SLAVE_MII_STATUS
,

549 
	mIFLA_BOND_SLAVE_LINK_FAILURE_COUNT
,

550 
	mIFLA_BOND_SLAVE_PERM_HWADDR
,

551 
	mIFLA_BOND_SLAVE_QUEUE_ID
,

552 
	mIFLA_BOND_SLAVE_AD_AGGREGATOR_ID
,

553 
	mIFLA_BOND_SLAVE_AD_ACTOR_OPER_PORT_STATE
,

554 
	mIFLA_BOND_SLAVE_AD_PARTNER_OPER_PORT_STATE
,

555 
	m__IFLA_BOND_SLAVE_MAX
,

558 
	#IFLA_BOND_SLAVE_MAX
 (
__IFLA_BOND_SLAVE_MAX
 - 1)

	)

563 
	mIFLA_VF_INFO_UNSPEC
,

564 
	mIFLA_VF_INFO
,

565 
	m__IFLA_VF_INFO_MAX
,

568 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

571 
	mIFLA_VF_UNSPEC
,

572 
	mIFLA_VF_MAC
,

573 
	mIFLA_VF_VLAN
,

574 
	mIFLA_VF_TX_RATE
,

575 
	mIFLA_VF_SPOOFCHK
,

576 
	mIFLA_VF_LINK_STATE
,

577 
	mIFLA_VF_RATE
,

578 
	mIFLA_VF_RSS_QUERY_EN
,

581 
	mIFLA_VF_STATS
,

582 
	mIFLA_VF_TRUST
,

583 
	mIFLA_VF_IB_NODE_GUID
,

584 
	mIFLA_VF_IB_PORT_GUID
,

585 
	mIFLA_VF_VLAN_LIST
,

586 
	m__IFLA_VF_MAX
,

589 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

591 
	siÊa_vf_mac
 {

592 
__u32
 
	mvf
;

593 
__u8
 
	mmac
[32];

596 
	siÊa_vf_vœn
 {

597 
__u32
 
	mvf
;

598 
__u32
 
	mvœn
;

599 
__u32
 
	mqos
;

603 
	mIFLA_VF_VLAN_INFO_UNSPEC
,

604 
	mIFLA_VF_VLAN_INFO
,

605 
	m__IFLA_VF_VLAN_INFO_MAX
,

608 
	#IFLA_VF_VLAN_INFO_MAX
 (
__IFLA_VF_VLAN_INFO_MAX
 - 1)

	)

609 
	#MAX_VLAN_LIST_LEN
 1

	)

611 
	siÊa_vf_vœn_öfo
 {

612 
__u32
 
	mvf
;

613 
__u32
 
	mvœn
;

614 
__u32
 
	mqos
;

615 
__be16
 
	mvœn_¥Ÿo
;

618 
	siÊa_vf_tx_øã
 {

619 
__u32
 
	mvf
;

620 
__u32
 
	møã
;

623 
	siÊa_vf_øã
 {

624 
__u32
 
	mvf
;

625 
__u32
 
	mmö_tx_øã
;

626 
__u32
 
	mmax_tx_øã
;

629 
	siÊa_vf_•oofchk
 {

630 
__u32
 
	mvf
;

631 
__u32
 
	m£âög
;

634 
	siÊa_vf_guid
 {

635 
__u32
 
	mvf
;

636 
__u64
 
	mguid
;

640 
	mIFLA_VF_LINK_STATE_AUTO
,

641 
	mIFLA_VF_LINK_STATE_ENABLE
,

642 
	mIFLA_VF_LINK_STATE_DISABLE
,

643 
	m__IFLA_VF_LINK_STATE_MAX
,

646 
	siÊa_vf_lök_°©e
 {

647 
__u32
 
	mvf
;

648 
__u32
 
	mlök_°©e
;

651 
	siÊa_vf_rss_quîy_í
 {

652 
__u32
 
	mvf
;

653 
__u32
 
	m£âög
;

657 
	mIFLA_VF_STATS_RX_PACKETS
,

658 
	mIFLA_VF_STATS_TX_PACKETS
,

659 
	mIFLA_VF_STATS_RX_BYTES
,

660 
	mIFLA_VF_STATS_TX_BYTES
,

661 
	mIFLA_VF_STATS_BROADCAST
,

662 
	mIFLA_VF_STATS_MULTICAST
,

663 
	mIFLA_VF_STATS_PAD
,

664 
	mIFLA_VF_STATS_RX_DROPPED
,

665 
	mIFLA_VF_STATS_TX_DROPPED
,

666 
	m__IFLA_VF_STATS_MAX
,

669 
	#IFLA_VF_STATS_MAX
 (
__IFLA_VF_STATS_MAX
 - 1)

	)

671 
	siÊa_vf_åu°
 {

672 
__u32
 
	mvf
;

673 
__u32
 
	m£âög
;

692 
	mIFLA_VF_PORT_UNSPEC
,

693 
	mIFLA_VF_PORT
,

694 
	m__IFLA_VF_PORT_MAX
,

697 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

700 
	mIFLA_PORT_UNSPEC
,

701 
	mIFLA_PORT_VF
,

702 
	mIFLA_PORT_PROFILE
,

703 
	mIFLA_PORT_VSI_TYPE
,

704 
	mIFLA_PORT_INSTANCE_UUID
,

705 
	mIFLA_PORT_HOST_UUID
,

706 
	mIFLA_PORT_REQUEST
,

707 
	mIFLA_PORT_RESPONSE
,

708 
	m__IFLA_PORT_MAX
,

711 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

713 
	#PORT_PROFILE_MAX
 40

	)

714 
	#PORT_UUID_MAX
 16

	)

715 
	#PORT_SELF_VF
 -1

	)

718 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

719 
	mPORT_REQUEST_PREASSOCIATE_RR
,

720 
	mPORT_REQUEST_ASSOCIATE
,

721 
	mPORT_REQUEST_DISASSOCIATE
,

725 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

726 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

727 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

728 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

729 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

730 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

731 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

733 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

734 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

735 
	mPORT_PROFILE_RESPONSE_INVALID
,

736 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

737 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

738 
	mPORT_PROFILE_RESPONSE_ERROR
,

741 
	siÊa_p‹t_vsi
 {

742 
__u8
 
	mvsi_mgr_id
;

743 
__u8
 
	mvsi_ty≥_id
[3];

744 
__u8
 
	mvsi_ty≥_vîsi⁄
;

745 
__u8
 
	m∑d
[3];

752 
	mIFLA_IPOIB_UNSPEC
,

753 
	mIFLA_IPOIB_PKEY
,

754 
	mIFLA_IPOIB_MODE
,

755 
	mIFLA_IPOIB_UMCAST
,

756 
	m__IFLA_IPOIB_MAX


760 
	mIPOIB_MODE_DATAGRAM
 = 0,

761 
	mIPOIB_MODE_CONNECTED
 = 1,

764 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

768 
	sif_°©s_msg
 {

769 
__u8
 
	mÁmûy
;

770 
__u8
 
	m∑d1
;

771 
__u16
 
	m∑d2
;

772 
__u32
 
	mifödex
;

773 
__u32
 
	mfûãr_mask
;

780 
	mIFLA_STATS_UNSPEC
,

781 
	mIFLA_STATS_LINK_64
,

782 
	mIFLA_STATS_LINK_XSTATS
,

783 
	mIFLA_STATS_LINK_XSTATS_SLAVE
,

784 
	mIFLA_STATS_LINK_OFFLOAD_XSTATS
,

785 
	m__IFLA_STATS_MAX
,

788 
	#IFLA_STATS_MAX
 (
__IFLA_STATS_MAX
 - 1)

	)

790 
	#IFLA_STATS_FILTER_BIT
(
ATTR
Ë(1 << (ATTR - 1))

	)

798 
	mLINK_XSTATS_TYPE_UNSPEC
,

799 
	mLINK_XSTATS_TYPE_BRIDGE
,

800 
	m__LINK_XSTATS_TYPE_MAX


802 
	#LINK_XSTATS_TYPE_MAX
 (
__LINK_XSTATS_TYPE_MAX
 - 1)

	)

806 
	mIFLA_OFFLOAD_XSTATS_UNSPEC
,

807 
	mIFLA_OFFLOAD_XSTATS_CPU_HIT
,

808 
	m__IFLA_OFFLOAD_XSTATS_MAX


810 
	#IFLA_OFFLOAD_XSTATS_MAX
 (
__IFLA_OFFLOAD_XSTATS_MAX
 - 1)

	)

813 
	mIFLA_EVENT_NONE
,

814 
	mIFLA_EVENT_REBOOT
,

815 
	mIFLA_EVENT_FEATURES
,

816 
	mIFLA_EVENT_BONDING_FAILOVER
,

817 
	mIFLA_EVENT_NOTIFY_PEERS
,

818 
	mIFLA_EVENT_IGMP_RESEND
,

819 
	mIFLA_EVENT_BONDING_OPTIONS
,

825 
	mIFLA_TUN_UNSPEC
,

826 
	mIFLA_TUN_OWNER
,

827 
	mIFLA_TUN_GROUP
,

828 
	mIFLA_TUN_TYPE
,

829 
	mIFLA_TUN_PI
,

830 
	mIFLA_TUN_VNET_HDR
,

831 
	mIFLA_TUN_PERSIST
,

832 
	mIFLA_TUN_MULTI_QUEUE
,

833 
	mIFLA_TUN_NUM_QUEUES
,

834 
	mIFLA_TUN_NUM_DISABLED_QUEUES
,

835 
	m__IFLA_TUN_MAX
,

838 
	#IFLA_TUN_MAX
 (
__IFLA_TUN_MAX
 - 1)

	)

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<löux/sysöfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`ty≥of
(x))◊Ë- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

12 
	#__KERNEL_DIV_ROUND_UP
(
n
, 
d
Ë((“Ë+ (dË- 1Ë/ (d))

	)

	@/usr/include/linux/neighbour.h

1 #i‚de‡
__LINUX_NEIGHBOUR_H


2 
	#__LINUX_NEIGHBOUR_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

7 
	sndmsg
 {

8 
__u8
 
	mndm_Ámûy
;

9 
__u8
 
	mndm_∑d1
;

10 
__u16
 
	mndm_∑d2
;

11 
__s32
 
	mndm_ifödex
;

12 
__u16
 
	mndm_°©e
;

13 
__u8
 
	mndm_Êags
;

14 
__u8
 
	mndm_ty≥
;

18 
	mNDA_UNSPEC
,

19 
	mNDA_DST
,

20 
	mNDA_LLADDR
,

21 
	mNDA_CACHEINFO
,

22 
	mNDA_PROBES
,

23 
	mNDA_VLAN
,

24 
	mNDA_PORT
,

25 
	mNDA_VNI
,

26 
	mNDA_IFINDEX
,

27 
	mNDA_MASTER
,

28 
	mNDA_LINK_NETNSID
,

29 
	mNDA_SRC_VNI
,

30 
	m__NDA_MAX


33 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

39 
	#NTF_USE
 0x01

	)

40 
	#NTF_SELF
 0x02

	)

41 
	#NTF_MASTER
 0x04

	)

42 
	#NTF_PROXY
 0x08

	)

43 
	#NTF_EXT_LEARNED
 0x10

	)

44 
	#NTF_OFFLOADED
 0x20

	)

45 
	#NTF_ROUTER
 0x80

	)

51 
	#NUD_INCOMPLETE
 0x01

	)

52 
	#NUD_REACHABLE
 0x02

	)

53 
	#NUD_STALE
 0x04

	)

54 
	#NUD_DELAY
 0x08

	)

55 
	#NUD_PROBE
 0x10

	)

56 
	#NUD_FAILED
 0x20

	)

59 
	#NUD_NOARP
 0x40

	)

60 
	#NUD_PERMANENT
 0x80

	)

61 
	#NUD_NONE
 0x00

	)

68 
	snda_ˇcheöfo
 {

69 
__u32
 
	mndm_c⁄fúmed
;

70 
__u32
 
	mndm_u£d
;

71 
__u32
 
	mndm_upd©ed
;

72 
__u32
 
	mndm_ªf˙t
;

100 
	sndt_°©s
 {

101 
__u64
 
	mndts_Ælocs
;

102 
__u64
 
	mndts_de°roys
;

103 
__u64
 
	mndts_hash_grows
;

104 
__u64
 
	mndts_ªs_Áûed
;

105 
__u64
 
	mndts_lookups
;

106 
__u64
 
	mndts_hôs
;

107 
__u64
 
	mndts_rcv_¥obes_mˇ°
;

108 
__u64
 
	mndts_rcv_¥obes_uˇ°
;

109 
__u64
 
	mndts_≥riodic_gc_runs
;

110 
__u64
 
	mndts_f‹˚d_gc_runs
;

114 
	mNDTPA_UNSPEC
,

115 
	mNDTPA_IFINDEX
,

116 
	mNDTPA_REFCNT
,

117 
	mNDTPA_REACHABLE_TIME
,

118 
	mNDTPA_BASE_REACHABLE_TIME
,

119 
	mNDTPA_RETRANS_TIME
,

120 
	mNDTPA_GC_STALETIME
,

121 
	mNDTPA_DELAY_PROBE_TIME
,

122 
	mNDTPA_QUEUE_LEN
,

123 
	mNDTPA_APP_PROBES
,

124 
	mNDTPA_UCAST_PROBES
,

125 
	mNDTPA_MCAST_PROBES
,

126 
	mNDTPA_ANYCAST_DELAY
,

127 
	mNDTPA_PROXY_DELAY
,

128 
	mNDTPA_PROXY_QLEN
,

129 
	mNDTPA_LOCKTIME
,

130 
	mNDTPA_QUEUE_LENBYTES
,

131 
	m__RH_RESERVED_NDTPA_MCAST_REPROBES
,

132 
	mNDTPA_PAD
,

133 
	m__NDTPA_MAX


135 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

137 
	sndtmsg
 {

138 
__u8
 
	mndtm_Ámûy
;

139 
__u8
 
	mndtm_∑d1
;

140 
__u16
 
	mndtm_∑d2
;

143 
	sndt_c⁄fig
 {

144 
__u16
 
	mndtc_key_Àn
;

145 
__u16
 
	mndtc_íåy_size
;

146 
__u32
 
	mndtc_íåõs
;

147 
__u32
 
	mndtc_œ°_Êush
;

148 
__u32
 
	mndtc_œ°_ønd
;

149 
__u32
 
	mndtc_hash_∫d
;

150 
__u32
 
	mndtc_hash_mask
;

151 
__u32
 
	mndtc_hash_chaö_gc
;

152 
__u32
 
	mndtc_¥oxy_qÀn
;

156 
	mNDTA_UNSPEC
,

157 
	mNDTA_NAME
,

158 
	mNDTA_THRESH1
,

159 
	mNDTA_THRESH2
,

160 
	mNDTA_THRESH3
,

161 
	mNDTA_CONFIG
,

162 
	mNDTA_PARMS
,

163 
	mNDTA_STATS
,

164 
	mNDTA_GC_INTERVAL
,

165 
	mNDTA_PAD
,

166 
	m__NDTA_MAX


168 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_bôs
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__kî√l_fd_£t
;

29 (*
	t__kî√l_sigh™dÀr_t
)();

32 
	t__kî√l_key_t
;

33 
	t__kî√l_mqd_t
;

35 
	~<asm/posix_ty≥s.h
>

	@/usr/include/linux/prctl.h

1 #i‚de‡
_LINUX_PRCTL_H


2 
	#_LINUX_PRCTL_H


	)

4 
	~<löux/ty≥s.h
>

8 
	#PR_SET_PDEATHSIG
 1

	)

9 
	#PR_GET_PDEATHSIG
 2

	)

12 
	#PR_GET_DUMPABLE
 3

	)

13 
	#PR_SET_DUMPABLE
 4

	)

16 
	#PR_GET_UNALIGN
 5

	)

17 
	#PR_SET_UNALIGN
 6

	)

18 
	#PR_UNALIGN_NOPRINT
 1

	)

19 
	#PR_UNALIGN_SIGBUS
 2

	)

23 
	#PR_GET_KEEPCAPS
 7

	)

24 
	#PR_SET_KEEPCAPS
 8

	)

27 
	#PR_GET_FPEMU
 9

	)

28 
	#PR_SET_FPEMU
 10

	)

29 
	#PR_FPEMU_NOPRINT
 1

	)

30 
	#PR_FPEMU_SIGFPE
 2

	)

33 
	#PR_GET_FPEXC
 11

	)

34 
	#PR_SET_FPEXC
 12

	)

35 
	#PR_FP_EXC_SW_ENABLE
 0x80

	)

36 
	#PR_FP_EXC_DIV
 0x010000

	)

37 
	#PR_FP_EXC_OVF
 0x020000

	)

38 
	#PR_FP_EXC_UND
 0x040000

	)

39 
	#PR_FP_EXC_RES
 0x080000

	)

40 
	#PR_FP_EXC_INV
 0x100000

	)

41 
	#PR_FP_EXC_DISABLED
 0

	)

42 
	#PR_FP_EXC_NONRECOV
 1

	)

43 
	#PR_FP_EXC_ASYNC
 2

	)

44 
	#PR_FP_EXC_PRECISE
 3

	)

48 
	#PR_GET_TIMING
 13

	)

49 
	#PR_SET_TIMING
 14

	)

50 
	#PR_TIMING_STATISTICAL
 0

	)

52 
	#PR_TIMING_TIMESTAMP
 1

	)

55 
	#PR_SET_NAME
 15

	)

56 
	#PR_GET_NAME
 16

	)

59 
	#PR_GET_ENDIAN
 19

	)

60 
	#PR_SET_ENDIAN
 20

	)

61 
	#PR_ENDIAN_BIG
 0

	)

62 
	#PR_ENDIAN_LITTLE
 1

	)

63 
	#PR_ENDIAN_PPC_LITTLE
 2

	)

66 
	#PR_GET_SECCOMP
 21

	)

67 
	#PR_SET_SECCOMP
 22

	)

70 
	#PR_CAPBSET_READ
 23

	)

71 
	#PR_CAPBSET_DROP
 24

	)

74 
	#PR_GET_TSC
 25

	)

75 
	#PR_SET_TSC
 26

	)

76 
	#PR_TSC_ENABLE
 1

	)

77 
	#PR_TSC_SIGSEGV
 2

	)

80 
	#PR_GET_SECUREBITS
 27

	)

81 
	#PR_SET_SECUREBITS
 28

	)

87 
	#PR_SET_TIMERSLACK
 29

	)

88 
	#PR_GET_TIMERSLACK
 30

	)

90 
	#PR_TASK_PERF_EVENTS_DISABLE
 31

	)

91 
	#PR_TASK_PERF_EVENTS_ENABLE
 32

	)

97 
	#PR_MCE_KILL
 33

	)

98 
	#PR_MCE_KILL_CLEAR
 0

	)

99 
	#PR_MCE_KILL_SET
 1

	)

101 
	#PR_MCE_KILL_LATE
 0

	)

102 
	#PR_MCE_KILL_EARLY
 1

	)

103 
	#PR_MCE_KILL_DEFAULT
 2

	)

105 
	#PR_MCE_KILL_GET
 34

	)

110 
	#PR_SET_MM
 35

	)

111 
	#PR_SET_MM_START_CODE
 1

	)

112 
	#PR_SET_MM_END_CODE
 2

	)

113 
	#PR_SET_MM_START_DATA
 3

	)

114 
	#PR_SET_MM_END_DATA
 4

	)

115 
	#PR_SET_MM_START_STACK
 5

	)

116 
	#PR_SET_MM_START_BRK
 6

	)

117 
	#PR_SET_MM_BRK
 7

	)

118 
	#PR_SET_MM_ARG_START
 8

	)

119 
	#PR_SET_MM_ARG_END
 9

	)

120 
	#PR_SET_MM_ENV_START
 10

	)

121 
	#PR_SET_MM_ENV_END
 11

	)

122 
	#PR_SET_MM_AUXV
 12

	)

123 
	#PR_SET_MM_EXE_FILE
 13

	)

124 
	#PR_SET_MM_MAP
 14

	)

125 
	#PR_SET_MM_MAP_SIZE
 15

	)

133 
	s¥˘l_mm_m≠
 {

134 
__u64
 
	m°¨t_code
;

135 
__u64
 
	míd_code
;

136 
__u64
 
	m°¨t_d©a
;

137 
__u64
 
	míd_d©a
;

138 
__u64
 
	m°¨t_brk
;

139 
__u64
 
	mbrk
;

140 
__u64
 
	m°¨t_°ack
;

141 
__u64
 
	m¨g_°¨t
;

142 
__u64
 
	m¨g_íd
;

143 
__u64
 
	mív_°¨t
;

144 
__u64
 
	mív_íd
;

145 
__u64
 *
	mauxv
;

146 
__u32
 
	mauxv_size
;

147 
__u32
 
	mexe_fd
;

154 
	#PR_SET_PTRACER
 0x59616d61

	)

155 
	#PR_SET_PTRACER_ANY
 (()-1)

	)

157 
	#PR_SET_CHILD_SUBREAPER
 36

	)

158 
	#PR_GET_CHILD_SUBREAPER
 37

	)

174 
	#PR_SET_NO_NEW_PRIVS
 38

	)

175 
	#PR_GET_NO_NEW_PRIVS
 39

	)

177 
	#PR_GET_TID_ADDRESS
 40

	)

179 
	#PR_SET_THP_DISABLE
 41

	)

180 
	#PR_GET_THP_DISABLE
 42

	)

185 
	#PR_MPX_ENABLE_MANAGEMENT
 43

	)

186 
	#PR_MPX_DISABLE_MANAGEMENT
 44

	)

189 
	#PR_CAP_AMBIENT
 47

	)

190 
	#PR_CAP_AMBIENT_IS_SET
 1

	)

191 
	#PR_CAP_AMBIENT_RAISE
 2

	)

192 
	#PR_CAP_AMBIENT_LOWER
 3

	)

193 
	#PR_CAP_AMBIENT_CLEAR_ALL
 4

	)

196 
	#PR_GET_SPECULATION_CTRL
 52

	)

197 
	#PR_SET_SPECULATION_CTRL
 53

	)

199 
	#PR_SPEC_STORE_BYPASS
 0

	)

201 
	#PR_SPEC_NOT_AFFECTED
 0

	)

202 
	#PR_SPEC_PRCTL
 (1UL << 0)

	)

203 
	#PR_SPEC_ENABLE
 (1UL << 1)

	)

204 
	#PR_SPEC_DISABLE
 (1UL << 2)

	)

205 
	#PR_SPEC_FORCE_DISABLE
 (1UL << 3)

	)

	@/usr/include/linux/socket.h

1 #i‚de‡
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__Æignof__
 (
sockaddr
 *))

	)

11 
	t__kî√l_ß_Ámûy_t
;

13 
	s__kî√l_sockaddr_°‹age
 {

14 
__kî√l_ß_Ámûy_t
 
	mss_Ámûy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©åibuã__
 ((
Æig√d
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/sysctl.h

22 #i‚de‡
_LINUX_SYSCTL_H


23 
	#_LINUX_SYSCTL_H


	)

25 
	~<löux/kî√l.h
>

26 
	~<löux/ty≥s.h
>

29 
	gcom∂ëi⁄
;

31 
	#CTL_MAXNAME
 10

	)

36 
	s__sys˘l_¨gs
 {

37 *
	m«me
;

38 
	m∆í
;

39 *
	mﬁdvÆ
;

40 
size_t
 *
	mﬁdÀ≈
;

41 *
	m√wvÆ
;

42 
size_t
 
	m√wÀn
;

43 
	m__unu£d
[4];

52 
	mCTL_KERN
=1,

53 
	mCTL_VM
=2,

54 
	mCTL_NET
=3,

55 
	mCTL_PROC
=4,

56 
	mCTL_FS
=5,

57 
	mCTL_DEBUG
=6,

58 
	mCTL_DEV
=7,

59 
	mCTL_BUS
=8,

60 
	mCTL_ABI
=9,

61 
	mCTL_CPU
=10,

62 
	mCTL_ARLAN
=254,

63 
	mCTL_S390DBF
=5677,

64 
	mCTL_SUNRPC
=7249,

65 
	mCTL_PM
=9899,

66 
	mCTL_FRV
=9898,

72 
	mCTL_BUS_ISA
=1

78 
	mINOTIFY_MAX_USER_INSTANCES
=1,

79 
	mINOTIFY_MAX_USER_WATCHES
=2,

80 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

86 
	mKERN_OSTYPE
=1,

87 
	mKERN_OSRELEASE
=2,

88 
	mKERN_OSREV
=3,

89 
	mKERN_VERSION
=4,

90 
	mKERN_SECUREMASK
=5,

91 
	mKERN_PROF
=6,

92 
	mKERN_NODENAME
=7,

93 
	mKERN_DOMAINNAME
=8,

95 
	mKERN_PANIC
=15,

96 
	mKERN_REALROOTDEV
=16,

98 
	mKERN_SPARC_REBOOT
=21,

99 
	mKERN_CTLALTDEL
=22,

100 
	mKERN_PRINTK
=23,

101 
	mKERN_NAMETRANS
=24,

102 
	mKERN_PPC_HTABRECLAIM
=25,

103 
	mKERN_PPC_ZEROPAGED
=26,

104 
	mKERN_PPC_POWERSAVE_NAP
=27,

105 
	mKERN_MODPROBE
=28,

106 
	mKERN_SG_BIG_BUFF
=29,

107 
	mKERN_ACCT
=30,

108 
	mKERN_PPC_L2CR
=31,

110 
	mKERN_RTSIGNR
=32,

111 
	mKERN_RTSIGMAX
=33,

113 
	mKERN_SHMMAX
=34,

114 
	mKERN_MSGMAX
=35,

115 
	mKERN_MSGMNB
=36,

116 
	mKERN_MSGPOOL
=37,

117 
	mKERN_SYSRQ
=38,

118 
	mKERN_MAX_THREADS
=39,

119 
	mKERN_RANDOM
=40,

120 
	mKERN_SHMALL
=41,

121 
	mKERN_MSGMNI
=42,

122 
	mKERN_SEM
=43,

123 
	mKERN_SPARC_STOP_A
=44,

124 
	mKERN_SHMMNI
=45,

125 
	mKERN_OVERFLOWUID
=46,

126 
	mKERN_OVERFLOWGID
=47,

127 
	mKERN_SHMPATH
=48,

128 
	mKERN_HOTPLUG
=49,

129 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

130 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

131 
	mKERN_CORE_USES_PID
=52,

132 
	mKERN_TAINTED
=53,

133 
	mKERN_CADPID
=54,

134 
	mKERN_PIDMAX
=55,

135 
	mKERN_CORE_PATTERN
=56,

136 
	mKERN_PANIC_ON_OOPS
=57,

137 
	mKERN_HPPA_PWRSW
=58,

138 
	mKERN_HPPA_UNALIGNED
=59,

139 
	mKERN_PRINTK_RATELIMIT
=60,

140 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

141 
	mKERN_PTY
=62,

142 
	mKERN_NGROUPS_MAX
=63,

143 
	mKERN_SPARC_SCONS_PWROFF
=64,

144 
	mKERN_HZ_TIMER
=65,

145 
	mKERN_UNKNOWN_NMI_PANIC
=66,

146 
	mKERN_BOOTLOADER_TYPE
=67,

147 
	mKERN_RANDOMIZE
=68,

148 
	mKERN_SETUID_DUMPABLE
=69,

149 
	mKERN_SPIN_RETRY
=70,

150 
	mKERN_ACPI_VIDEO_FLAGS
=71,

151 
	mKERN_IA64_UNALIGNED
=72,

152 
	mKERN_COMPAT_LOG
=73,

153 
	mKERN_MAX_LOCK_DEPTH
=74,

154 
	mKERN_NMI_WATCHDOG
=75,

155 
	mKERN_PANIC_ON_NMI
=76,

156 
	mKERN_PANIC_ON_WARN
=77,

164 
	mVM_UNUSED1
=1,

165 
	mVM_UNUSED2
=2,

166 
	mVM_UNUSED3
=3,

167 
	mVM_UNUSED4
=4,

168 
	mVM_OVERCOMMIT_MEMORY
=5,

169 
	mVM_UNUSED5
=6,

170 
	mVM_UNUSED7
=7,

171 
	mVM_UNUSED8
=8,

172 
	mVM_UNUSED9
=9,

173 
	mVM_PAGE_CLUSTER
=10,

174 
	mVM_DIRTY_BACKGROUND
=11,

175 
	mVM_DIRTY_RATIO
=12,

176 
	mVM_DIRTY_WB_CS
=13,

177 
	mVM_DIRTY_EXPIRE_CS
=14,

178 
	mVM_NR_PDFLUSH_THREADS
=15,

179 
	mVM_OVERCOMMIT_RATIO
=16,

180 
	mVM_PAGEBUF
=17,

181 
	mVM_HUGETLB_PAGES
=18,

182 
	mVM_SWAPPINESS
=19,

183 
	mVM_LOWMEM_RESERVE_RATIO
=20,

184 
	mVM_MIN_FREE_KBYTES
=21,

185 
	mVM_MAX_MAP_COUNT
=22,

186 
	mVM_LAPTOP_MODE
=23,

187 
	mVM_BLOCK_DUMP
=24,

188 
	mVM_HUGETLB_GROUP
=25,

189 
	mVM_VFS_CACHE_PRESSURE
=26,

190 
	mVM_LEGACY_VA_LAYOUT
=27,

191 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

192 
	mVM_DROP_PAGECACHE
=29,

193 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

194 
	mVM_ZONE_RECLAIM_MODE
=31,

195 
	mVM_MIN_UNMAPPED
=32,

196 
	mVM_PANIC_ON_OOM
=33,

197 
	mVM_VDSO_ENABLED
=34,

198 
	mVM_MIN_SLAB
=35,

205 
	mNET_CORE
=1,

206 
	mNET_ETHER
=2,

207 
	mNET_802
=3,

208 
	mNET_UNIX
=4,

209 
	mNET_IPV4
=5,

210 
	mNET_IPX
=6,

211 
	mNET_ATALK
=7,

212 
	mNET_NETROM
=8,

213 
	mNET_AX25
=9,

214 
	mNET_BRIDGE
=10,

215 
	mNET_ROSE
=11,

216 
	mNET_IPV6
=12,

217 
	mNET_X25
=13,

218 
	mNET_TR
=14,

219 
	mNET_DECNET
=15,

220 
	mNET_ECONET
=16,

221 
	mNET_SCTP
=17,

222 
	mNET_LLC
=18,

223 
	mNET_NETFILTER
=19,

224 
	mNET_DCCP
=20,

225 
	mNET_IRDA
=412,

231 
	mRANDOM_POOLSIZE
=1,

232 
	mRANDOM_ENTROPY_COUNT
=2,

233 
	mRANDOM_READ_THRESH
=3,

234 
	mRANDOM_WRITE_THRESH
=4,

235 
	mRANDOM_BOOT_ID
=5,

236 
	mRANDOM_UUID
=6

242 
	mPTY_MAX
=1,

243 
	mPTY_NR
=2

249 
	mBUS_ISA_MEM_BASE
=1,

250 
	mBUS_ISA_PORT_BASE
=2,

251 
	mBUS_ISA_PORT_SHIFT
=3

257 
	mNET_CORE_WMEM_MAX
=1,

258 
	mNET_CORE_RMEM_MAX
=2,

259 
	mNET_CORE_WMEM_DEFAULT
=3,

260 
	mNET_CORE_RMEM_DEFAULT
=4,

262 
	mNET_CORE_MAX_BACKLOG
=6,

263 
	mNET_CORE_FASTROUTE
=7,

264 
	mNET_CORE_MSG_COST
=8,

265 
	mNET_CORE_MSG_BURST
=9,

266 
	mNET_CORE_OPTMEM_MAX
=10,

267 
	mNET_CORE_HOT_LIST_LENGTH
=11,

268 
	mNET_CORE_DIVERT_VERSION
=12,

269 
	mNET_CORE_NO_CONG_THRESH
=13,

270 
	mNET_CORE_NO_CONG
=14,

271 
	mNET_CORE_LO_CONG
=15,

272 
	mNET_CORE_MOD_CONG
=16,

273 
	mNET_CORE_DEV_WEIGHT
=17,

274 
	mNET_CORE_SOMAXCONN
=18,

275 
	mNET_CORE_BUDGET
=19,

276 
	mNET_CORE_AEVENT_ETIME
=20,

277 
	mNET_CORE_AEVENT_RSEQTH
=21,

278 
	mNET_CORE_WARNINGS
=22,

289 
	mNET_UNIX_DESTROY_DELAY
=1,

290 
	mNET_UNIX_DELETE_DELAY
=2,

291 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

297 
	mNET_NF_CONNTRACK_MAX
=1,

298 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

299 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

300 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

301 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

302 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

304 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

305 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

306 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

307 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

308 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

309 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

310 
	mNET_NF_CONNTRACK_BUCKETS
=14,

311 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

312 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

313 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

314 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

315 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

316 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

317 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

318 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

319 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

320 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

321 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

322 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

323 
	mNET_NF_CONNTRACK_COUNT
=27,

324 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

325 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

326 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

327 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

328 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

335 
	mNET_IPV4_FORWARD
=8,

336 
	mNET_IPV4_DYNADDR
=9,

338 
	mNET_IPV4_CONF
=16,

339 
	mNET_IPV4_NEIGH
=17,

340 
	mNET_IPV4_ROUTE
=18,

341 
	mNET_IPV4_FIB_HASH
=19,

342 
	mNET_IPV4_NETFILTER
=20,

344 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

345 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

346 
	mNET_IPV4_TCP_SACK
=35,

347 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

348 
	mNET_IPV4_DEFAULT_TTL
=37,

349 
	mNET_IPV4_AUTOCONFIG
=38,

350 
	mNET_IPV4_NO_PMTU_DISC
=39,

351 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

352 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

353 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

354 
	mNET_IPV4_IPFRAG_TIME
=43,

355 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

356 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

357 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

358 
	mNET_IPV4_TCP_RETRIES1
=47,

359 
	mNET_IPV4_TCP_RETRIES2
=48,

360 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

361 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

362 
	mNET_TCP_SYNCOOKIES
=51,

363 
	mNET_TCP_STDURG
=52,

364 
	mNET_TCP_RFC1337
=53,

365 
	mNET_TCP_SYN_TAILDROP
=54,

366 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

367 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

368 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

369 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

370 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

371 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

372 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

373 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

374 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

375 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

376 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

377 
	mNET_TCP_TW_RECYCLE
=66,

378 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

379 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

380 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

381 
	mNET_IPV4_INET_PEER_MINTTL
=70,

382 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

383 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

384 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

385 
	mNET_TCP_ORPHAN_RETRIES
=74,

386 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

387 
	mNET_TCP_SYNACK_RETRIES
=76,

388 
	mNET_TCP_MAX_ORPHANS
=77,

389 
	mNET_TCP_MAX_TW_BUCKETS
=78,

390 
	mNET_TCP_FACK
=79,

391 
	mNET_TCP_REORDERING
=80,

392 
	mNET_TCP_ECN
=81,

393 
	mNET_TCP_DSACK
=82,

394 
	mNET_TCP_MEM
=83,

395 
	mNET_TCP_WMEM
=84,

396 
	mNET_TCP_RMEM
=85,

397 
	mNET_TCP_APP_WIN
=86,

398 
	mNET_TCP_ADV_WIN_SCALE
=87,

399 
	mNET_IPV4_NONLOCAL_BIND
=88,

400 
	mNET_IPV4_ICMP_RATELIMIT
=89,

401 
	mNET_IPV4_ICMP_RATEMASK
=90,

402 
	mNET_TCP_TW_REUSE
=91,

403 
	mNET_TCP_FRTO
=92,

404 
	mNET_TCP_LOW_LATENCY
=93,

405 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

406 
	mNET_IPV4_IGMP_MAX_MSF
=96,

407 
	mNET_TCP_NO_METRICS_SAVE
=97,

408 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

409 
	mNET_TCP_MODERATE_RCVBUF
=106,

410 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

411 
	mNET_TCP_BIC_BETA
=108,

412 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

413 
	mNET_TCP_CONG_CONTROL
=110,

414 
	mNET_TCP_ABC
=111,

415 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

416 
	mNET_TCP_MTU_PROBING
=113,

417 
	mNET_TCP_BASE_MSS
=114,

418 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

419 
	mNET_TCP_DMA_COPYBREAK
=116,

420 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

421 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

422 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

423 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

424 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

425 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

426 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

427 
	mNET_TCP_MAX_SSTHRESH
=124,

428 
	mNET_TCP_FRTO_RESPONSE
=125,

432 
	mNET_IPV4_ROUTE_FLUSH
=1,

433 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

434 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

435 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

436 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

437 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

438 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

439 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

440 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

441 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

442 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

443 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

444 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

445 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

446 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

447 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

448 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

449 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

450 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

455 
	mNET_PROTO_CONF_ALL
=-2,

456 
	mNET_PROTO_CONF_DEFAULT
=-3

463 
	mNET_IPV4_CONF_FORWARDING
=1,

464 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

465 
	mNET_IPV4_CONF_PROXY_ARP
=3,

466 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

467 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

468 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

469 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

470 
	mNET_IPV4_CONF_RP_FILTER
=8,

471 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

472 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

473 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

474 
	mNET_IPV4_CONF_TAG
=12,

475 
	mNET_IPV4_CONF_ARPFILTER
=13,

476 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

477 
	mNET_IPV4_CONF_NOXFRM
=15,

478 
	mNET_IPV4_CONF_NOPOLICY
=16,

479 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

480 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

481 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

482 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

483 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

484 
	mNET_IPV4_CONF_ARP_NOTIFY
=22,

490 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

491 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

492 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

493 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

494 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

495 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

496 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

497 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

498 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

499 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

500 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

501 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

502 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

503 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

504 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

505 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

506 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

507 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

508 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

509 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

510 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

511 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

512 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

513 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

514 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

515 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

516 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

517 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

522 
	mNET_IPV6_CONF
=16,

523 
	mNET_IPV6_NEIGH
=17,

524 
	mNET_IPV6_ROUTE
=18,

525 
	mNET_IPV6_ICMP
=19,

526 
	mNET_IPV6_BINDV6ONLY
=20,

527 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

528 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

529 
	mNET_IPV6_IP6FRAG_TIME
=23,

530 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

531 
	mNET_IPV6_MLD_MAX_MSF
=25,

535 
	mNET_IPV6_ROUTE_FLUSH
=1,

536 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

537 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

538 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

539 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

540 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

541 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

542 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

543 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

544 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

548 
	mNET_IPV6_FORWARDING
=1,

549 
	mNET_IPV6_HOP_LIMIT
=2,

550 
	mNET_IPV6_MTU
=3,

551 
	mNET_IPV6_ACCEPT_RA
=4,

552 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

553 
	mNET_IPV6_AUTOCONF
=6,

554 
	mNET_IPV6_DAD_TRANSMITS
=7,

555 
	mNET_IPV6_RTR_SOLICITS
=8,

556 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

557 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

558 
	mNET_IPV6_USE_TEMPADDR
=11,

559 
	mNET_IPV6_TEMP_VALID_LFT
=12,

560 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

561 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

562 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

563 
	mNET_IPV6_MAX_ADDRESSES
=16,

564 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

565 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

566 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

567 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

568 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

569 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

570 
	mNET_IPV6_PROXY_NDP
=23,

571 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

572 
	m__NET_IPV6_MAX


577 
	mNET_IPV6_ICMP_RATELIMIT
=1

582 
	mNET_NEIGH_MCAST_SOLICIT
=1,

583 
	mNET_NEIGH_UCAST_SOLICIT
=2,

584 
	mNET_NEIGH_APP_SOLICIT
=3,

585 
	mNET_NEIGH_RETRANS_TIME
=4,

586 
	mNET_NEIGH_REACHABLE_TIME
=5,

587 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

588 
	mNET_NEIGH_GC_STALE_TIME
=7,

589 
	mNET_NEIGH_UNRES_QLEN
=8,

590 
	mNET_NEIGH_PROXY_QLEN
=9,

591 
	mNET_NEIGH_ANYCAST_DELAY
=10,

592 
	mNET_NEIGH_PROXY_DELAY
=11,

593 
	mNET_NEIGH_LOCKTIME
=12,

594 
	mNET_NEIGH_GC_INTERVAL
=13,

595 
	mNET_NEIGH_GC_THRESH1
=14,

596 
	mNET_NEIGH_GC_THRESH2
=15,

597 
	mNET_NEIGH_GC_THRESH3
=16,

598 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

599 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

604 
	mNET_DCCP_DEFAULT
=1,

609 
	mNET_IPX_PPROP_BROADCASTING
=1,

610 
	mNET_IPX_FORWARDING
=2

615 
	mNET_LLC2
=1,

616 
	mNET_LLC_STATION
=2,

621 
	mNET_LLC2_TIMEOUT
=1,

626 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

631 
	mNET_LLC2_ACK_TIMEOUT
=1,

632 
	mNET_LLC2_P_TIMEOUT
=2,

633 
	mNET_LLC2_REJ_TIMEOUT
=3,

634 
	mNET_LLC2_BUSY_TIMEOUT
=4,

639 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

640 
	mNET_ATALK_AARP_TICK_TIME
=2,

641 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

642 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

648 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

649 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

650 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

651 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

652 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

653 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

654 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

655 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

656 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

657 
	mNET_NETROM_ROUTING_CONTROL
=10,

658 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

659 
	mNET_NETROM_RESET
=12

664 
	mNET_AX25_IP_DEFAULT_MODE
=1,

665 
	mNET_AX25_DEFAULT_MODE
=2,

666 
	mNET_AX25_BACKOFF_TYPE
=3,

667 
	mNET_AX25_CONNECT_MODE
=4,

668 
	mNET_AX25_STANDARD_WINDOW
=5,

669 
	mNET_AX25_EXTENDED_WINDOW
=6,

670 
	mNET_AX25_T1_TIMEOUT
=7,

671 
	mNET_AX25_T2_TIMEOUT
=8,

672 
	mNET_AX25_T3_TIMEOUT
=9,

673 
	mNET_AX25_IDLE_TIMEOUT
=10,

674 
	mNET_AX25_N2
=11,

675 
	mNET_AX25_PACLEN
=12,

676 
	mNET_AX25_PROTOCOL
=13,

677 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

682 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

683 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

684 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

685 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

686 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

687 
	mNET_ROSE_ROUTING_CONTROL
=6,

688 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

689 
	mNET_ROSE_MAX_VCS
=8,

690 
	mNET_ROSE_WINDOW_SIZE
=9,

691 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

696 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

697 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

698 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

699 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

700 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

701 
	mNET_X25_FORWARD
=6

707 
	mNET_TR_RIF_TIMEOUT
=1

712 
	mNET_DECNET_NODE_TYPE
 = 1,

713 
	mNET_DECNET_NODE_ADDRESS
 = 2,

714 
	mNET_DECNET_NODE_NAME
 = 3,

715 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

716 
	mNET_DECNET_TIME_WAIT
 = 5,

717 
	mNET_DECNET_DN_COUNT
 = 6,

718 
	mNET_DECNET_DI_COUNT
 = 7,

719 
	mNET_DECNET_DR_COUNT
 = 8,

720 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

721 
	mNET_DECNET_CONF
 = 10,

722 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

723 
	mNET_DECNET_MEM
 = 12,

724 
	mNET_DECNET_RMEM
 = 13,

725 
	mNET_DECNET_WMEM
 = 14,

726 
	mNET_DECNET_DEBUG_LEVEL
 = 255

731 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

732 
	mNET_DECNET_CONF_DDCMP
 = -3,

733 
	mNET_DECNET_CONF_PPP
 = -4,

734 
	mNET_DECNET_CONF_X25
 = -5,

735 
	mNET_DECNET_CONF_GRE
 = -6,

736 
	mNET_DECNET_CONF_ETHER
 = -7

743 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

744 
	mNET_DECNET_CONF_DEV_T1
 = 2,

745 
	mNET_DECNET_CONF_DEV_T2
 = 3,

746 
	mNET_DECNET_CONF_DEV_T3
 = 4,

747 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

748 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

749 
	mNET_DECNET_CONF_DEV_STATE
 = 7

754 
	mNET_SCTP_RTO_INITIAL
 = 1,

755 
	mNET_SCTP_RTO_MIN
 = 2,

756 
	mNET_SCTP_RTO_MAX
 = 3,

757 
	mNET_SCTP_RTO_ALPHA
 = 4,

758 
	mNET_SCTP_RTO_BETA
 = 5,

759 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

760 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

761 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

762 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

763 
	mNET_SCTP_HB_INTERVAL
 = 10,

764 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

765 
	mNET_SCTP_MAX_BURST
 = 12,

766 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

767 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

768 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

769 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

770 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

775 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

776 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

777 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

778 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

779 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

784 
	mNET_IRDA_DISCOVERY
=1,

785 
	mNET_IRDA_DEVNAME
=2,

786 
	mNET_IRDA_DEBUG
=3,

787 
	mNET_IRDA_FAST_POLL
=4,

788 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

789 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

790 
	mNET_IRDA_SLOT_TIMEOUT
=7,

791 
	mNET_IRDA_MAX_BAUD_RATE
=8,

792 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

793 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

794 
	mNET_IRDA_MAX_TX_WINDOW
=11,

795 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

796 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

797 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

804 
	mFS_NRINODE
=1,

805 
	mFS_STATINODE
=2,

806 
	mFS_MAXINODE
=3,

807 
	mFS_NRDQUOT
=4,

808 
	mFS_MAXDQUOT
=5,

809 
	mFS_NRFILE
=6,

810 
	mFS_MAXFILE
=7,

811 
	mFS_DENTRY
=8,

812 
	mFS_NRSUPER
=9,

813 
	mFS_MAXSUPER
=10,

814 
	mFS_OVERFLOWUID
=11,

815 
	mFS_OVERFLOWGID
=12,

816 
	mFS_LEASES
=13,

817 
	mFS_DIR_NOTIFY
=14,

818 
	mFS_LEASE_TIME
=15,

819 
	mFS_DQSTATS
=16,

820 
	mFS_XFS
=17,

821 
	mFS_AIO_NR
=18,

822 
	mFS_AIO_MAX_NR
=19,

823 
	mFS_INOTIFY
=20,

824 
	mFS_OCFS2
=988,

829 
	mFS_DQ_LOOKUPS
 = 1,

830 
	mFS_DQ_DROPS
 = 2,

831 
	mFS_DQ_READS
 = 3,

832 
	mFS_DQ_WRITES
 = 4,

833 
	mFS_DQ_CACHE_HITS
 = 5,

834 
	mFS_DQ_ALLOCATED
 = 6,

835 
	mFS_DQ_FREE
 = 7,

836 
	mFS_DQ_SYNCS
 = 8,

837 
	mFS_DQ_WARNINGS
 = 9,

844 
	mDEV_CDROM
=1,

845 
	mDEV_HWMON
=2,

846 
	mDEV_PARPORT
=3,

847 
	mDEV_RAID
=4,

848 
	mDEV_MAC_HID
=5,

849 
	mDEV_SCSI
=6,

850 
	mDEV_IPMI
=7,

855 
	mDEV_CDROM_INFO
=1,

856 
	mDEV_CDROM_AUTOCLOSE
=2,

857 
	mDEV_CDROM_AUTOEJECT
=3,

858 
	mDEV_CDROM_DEBUG
=4,

859 
	mDEV_CDROM_LOCK
=5,

860 
	mDEV_CDROM_CHECK_MEDIA
=6

865 
	mDEV_PARPORT_DEFAULT
=-3

870 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

871 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

876 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

877 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

882 
	mDEV_PARPORT_SPINTIME
=1,

883 
	mDEV_PARPORT_BASE_ADDR
=2,

884 
	mDEV_PARPORT_IRQ
=3,

885 
	mDEV_PARPORT_DMA
=4,

886 
	mDEV_PARPORT_MODES
=5,

887 
	mDEV_PARPORT_DEVICES
=6,

888 
	mDEV_PARPORT_AUTOPROBE
=16

893 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

898 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

903 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

904 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

905 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

906 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

907 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

908 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

913 
	mDEV_SCSI_LOGGING_LEVEL
=1,

918 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

924 
	mABI_DEFHANDLER_COFF
=1,

925 
	mABI_DEFHANDLER_ELF
=2,

926 
	mABI_DEFHANDLER_LCALL7
=3,

927 
	mABI_DEFHANDLER_LIBCSO
=4,

928 
	mABI_TRACE
=5,

929 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/locale.h

23 #i‚def 
_LOCALE_H


24 
	#_LOCALE_H
 1

	)

26 
	~<„©uªs.h
>

28 
	#__√ed_NULL


	)

29 
	~<°ddef.h
>

30 
	~<bôs/loˇÀ.h
>

32 
	g__BEGIN_DECLS


36 
	#LC_CTYPE
 
__LC_CTYPE


	)

37 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

38 
	#LC_TIME
 
__LC_TIME


	)

39 
	#LC_COLLATE
 
__LC_COLLATE


	)

40 
	#LC_MONETARY
 
__LC_MONETARY


	)

41 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

42 
	#LC_ALL
 
__LC_ALL


	)

43 
	#LC_PAPER
 
__LC_PAPER


	)

44 
	#LC_NAME
 
__LC_NAME


	)

45 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

46 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

47 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

48 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

51 
__BEGIN_NAMESPACE_STD


54 
	slc⁄v


58 *
	mdecimÆ_poöt
;

59 *
	mthoußnds_£p
;

65 *
	mgroupög
;

71 *
	möt_cuº_symbﬁ
;

72 *
	mcuºícy_symbﬁ
;

73 *
	mm⁄_decimÆ_poöt
;

74 *
	mm⁄_thoußnds_£p
;

75 *
	mm⁄_groupög
;

76 *
	mposôive_sign
;

77 *
	m√g©ive_sign
;

78 
	möt_‰ac_digôs
;

79 
	m‰ac_digôs
;

81 
	mp_cs_¥e˚des
;

83 
	mp_£p_by_•a˚
;

85 
	mn_cs_¥e˚des
;

87 
	mn_£p_by_•a˚
;

94 
	mp_sign_po¢
;

95 
	mn_sign_po¢
;

96 #ifde‡
__USE_ISOC99


98 
	möt_p_cs_¥e˚des
;

100 
	möt_p_£p_by_•a˚
;

102 
	möt_n_cs_¥e˚des
;

104 
	möt_n_£p_by_•a˚
;

111 
	möt_p_sign_po¢
;

112 
	möt_n_sign_po¢
;

114 
	m__öt_p_cs_¥e˚des
;

115 
	m__öt_p_£p_by_•a˚
;

116 
	m__öt_n_cs_¥e˚des
;

117 
	m__öt_n_£p_by_•a˚
;

118 
	m__öt_p_sign_po¢
;

119 
	m__öt_n_sign_po¢
;

125 *
	$£éoˇÀ
 (
__ˇãg‹y
, c⁄° *
__loˇÀ
Ë
__THROW
;

128 
lc⁄v
 *
	$loˇÀc⁄v
 (Ë
__THROW
;

130 
__END_NAMESPACE_STD


133 #ifdef 
__USE_XOPEN2K8


146 
	~<xloˇÀ.h
>

152 
__loˇÀ_t
 
	$√wloˇÀ
 (
__ˇãg‹y_mask
, c⁄° *
__loˇÀ
,

153 
__loˇÀ_t
 
__ba£
Ë
__THROW
;

159 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

160 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

161 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

162 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

163 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

164 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

165 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

166 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

167 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

168 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

169 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

170 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

171 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

172 | 
LC_NUMERIC_MASK
 \

173 | 
LC_TIME_MASK
 \

174 | 
LC_COLLATE_MASK
 \

175 | 
LC_MONETARY_MASK
 \

176 | 
LC_MESSAGES_MASK
 \

177 | 
LC_PAPER_MASK
 \

178 | 
LC_NAME_MASK
 \

179 | 
LC_ADDRESS_MASK
 \

180 | 
LC_TELEPHONE_MASK
 \

181 | 
LC_MEASUREMENT_MASK
 \

182 | 
LC_IDENTIFICATION_MASK
 \

183 )

	)

187 
__loˇÀ_t
 
	$du∂oˇÀ
 (
__loˇÀ_t
 
__d©a£t
Ë
__THROW
;

191 
	$‰ìloˇÀ
 (
__loˇÀ_t
 
__d©a£t
Ë
__THROW
;

198 
__loˇÀ_t
 
	$u£loˇÀ
 (
__loˇÀ_t
 
__d©a£t
Ë
__THROW
;

202 
	#LC_GLOBAL_LOCALE
 ((
__loˇÀ_t
Ë-1L)

	)

206 
__END_DECLS


	@/usr/include/net-snmp/agent/agent_handler.h

11 #i‚de‡
AGENT_HANDLER_H


12 
	#AGENT_HANDLER_H


	)

14 #ifde‡
__˝lu•lus


25 
√t¢mp_h™dÀr_ªgi°øti⁄_s
;

32 
	#MIB_HANDLER_AUTO_NEXT
 0x00000001

	)

33 
	#MIB_HANDLER_AUTO_NEXT_OVERRIDE_ONCE
 0x00000002

	)

34 
	#MIB_HANDLER_INSTANCE
 0x00000004

	)

36 
	#MIB_HANDLER_CUSTOM4
 0x10000000

	)

37 
	#MIB_HANDLER_CUSTOM3
 0x20000000

	)

38 
	#MIB_HANDLER_CUSTOM2
 0x40000000

	)

39 
	#MIB_HANDLER_CUSTOM1
 0x80000000

	)

48 
	s√t¢mp_mib_h™dÀr_s
 {

49 *
h™dÀr_«me
;

51 *
myvoid
;

53 
Êags
;

58 (*
ac˚ss_mëhod
Ë(
√t¢mp_mib_h™dÀr_s
 *,

60 
√t¢mp_h™dÀr_ªgi°øti⁄_s
 *,

62 
√t¢mp_agít_ªque°_öfo_s
 *,

63 
√t¢mp_ªque°_öfo_s
 *);

70 *(*
d©a_˛⁄e
)(*
myvoid
);

75 (*
d©a_‰ì
)(*
myvoid
);

77 
√t¢mp_mib_h™dÀr_s
 *
√xt
;

78 
√t¢mp_mib_h™dÀr_s
 *
¥ev
;

79 } 
	t√t¢mp_mib_h™dÀr
;

84 
	#HANDLER_CAN_GETANDGETNEXT
 0x01

	)

85 
	#HANDLER_CAN_SET
 0x02

	)

86 
	#HANDLER_CAN_GETBULK
 0x04

	)

87 
	#HANDLER_CAN_NOT_CREATE
 0x08

	)

88 
	#HANDLER_CAN_BABY_STEP
 0x10

	)

89 
	#HANDLER_CAN_STASH
 0x20

	)

92 
	#HANDLER_CAN_RONLY
 (
HANDLER_CAN_GETANDGETNEXT
)

	)

93 
	#HANDLER_CAN_RWRITE
 (
HANDLER_CAN_GETANDGETNEXT
 | 
HANDLER_CAN_SET
)

	)

94 
	#HANDLER_CAN_SET_ONLY
 (
HANDLER_CAN_SET
 | 
HANDLER_CAN_NOT_CREATE
)

	)

95 
	#HANDLER_CAN_DEFAULT
 (
HANDLER_CAN_RONLY
 | 
HANDLER_CAN_NOT_CREATE
)

	)

106 
	s√t¢mp_h™dÀr_ªgi°øti⁄_s
 {

109 *
h™dÀrName
;

111 *
c⁄ãxtName
;

116 
oid
 *
roŸoid
;

117 
size_t
 
roŸoid_Àn
;

122 
√t¢mp_mib_h™dÀr
 *
h™dÀr
;

123 
modes
;

128 
¥i‹ôy
;

129 
ønge_subid
;

130 
oid
 
ønge_ubound
;

131 
timeout
;

132 
globÆ_ˇcheid
;

137 * 
my_ªg_void
;

139 } 
	t√t¢mp_h™dÀr_ªgi°øti⁄
;

145 (
Në¢mp_Node_H™dÀr
Ë(
	t√t¢mp_mib_h™dÀr
 *
	th™dÀr
,

147 
	t√t¢mp_h™dÀr_ªgi°øti⁄
 *
	tªgöfo
,

149 
	t√t¢mp_agít_ªque°_öfo
 *
	tªqöfo
,

150 
	t√t¢mp_ªque°_öfo
 *
	tªque°s
);

152 
	s√t¢mp_h™dÀr_¨gs_s
 {

153 
√t¢mp_mib_h™dÀr
 *
h™dÀr
;

154 
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
;

155 
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
;

156 
√t¢mp_ªque°_öfo
 *
ªque°s
;

157 } 
	t√t¢mp_h™dÀr_¨gs
;

159 
	s√t¢mp_dñeg©ed_ˇche_s
 {

160 
å™ß˘i⁄_id
;

161 
√t¢mp_mib_h™dÀr
 *
h™dÀr
;

162 
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
;

163 
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
;

164 
√t¢mp_ªque°_öfo
 *
ªque°s
;

165 *
loˇlöfo
;

166 } 
	t√t¢mp_dñeg©ed_ˇche
;

171 
√t¢mp_öô_h™dÀr_c⁄f
();

172 
√t¢mp_ªgi°î_h™dÀr
(
√t¢mp_h™dÀr_ªgi°øti⁄


173 *
ªgöfo
);

174 
√t¢mp_uƒegi°î_h™dÀr
(
√t¢mp_h™dÀr_ªgi°øti⁄


175 *
ªgöfo
);

177 
√t¢mp_ªgi°î_h™dÀr_noˇŒback
(
√t¢mp_h™dÀr_ªgi°øti⁄


178 *
ªgöfo
);

179 
√t¢mp_öje˘_h™dÀr
(
√t¢mp_h™dÀr_ªgi°øti⁄


180 *
ªgöfo
,

181 
√t¢mp_mib_h™dÀr
 *
h™dÀr
);

183 
√t¢mp_öje˘_h™dÀr_bef‹e
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

184 
√t¢mp_mib_h™dÀr
 *
h™dÀr
,

185 c⁄° *
bef‹e_wh©
);

186 
√t¢mp_mib_h™dÀr


187 *
√t¢mp_föd_h™dÀr_by_«me
(
√t¢mp_h™dÀr_ªgi°øti⁄


188 *
ªgöfo
, c⁄° *
«me
);

190 *
√t¢mp_föd_h™dÀr_d©a_by_«me
(
√t¢mp_h™dÀr_ªgi°øti⁄


191 *
ªgöfo
, c⁄° *
«me
);

192 
√t¢mp_ˇŒ_h™dÀrs
(
√t¢mp_h™dÀr_ªgi°øti⁄


193 *
ªgöfo
,

194 
√t¢mp_agít_ªque°_öfo


195 *
ªqöfo
,

196 
√t¢mp_ªque°_öfo
 *
ªque°s
);

197 
√t¢mp_ˇŒ_h™dÀr
(
√t¢mp_mib_h™dÀr
 *
√xt_h™dÀr
,

198 
√t¢mp_h™dÀr_ªgi°øti⁄


199 *
ªgöfo
,

200 
√t¢mp_agít_ªque°_öfo


201 *
ªqöfo
,

202 
√t¢mp_ªque°_öfo
 *
ªque°s
);

203 
√t¢mp_ˇŒ_√xt_h™dÀr
(
√t¢mp_mib_h™dÀr
 *
cuºít
,

204 
√t¢mp_h™dÀr_ªgi°øti⁄


205 *
ªgöfo
,

206 
√t¢mp_agít_ªque°_öfo


207 *
ªqöfo
,

208 
√t¢mp_ªque°_öfo


209 *
ªque°s
);

210 
√t¢mp_ˇŒ_√xt_h™dÀr_⁄e_ªque°
(
√t¢mp_mib_h™dÀr
 *
cuºít
,

211 
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

212 
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
,

213 
√t¢mp_ªque°_öfo
 *
ªque°s
);

215 
√t¢mp_mib_h™dÀr
 *
√t¢mp_¸óã_h™dÀr
(c⁄° *
«me
,

216 
Në¢mp_Node_H™dÀr
 *

217 
h™dÀr_ac˚ss_mëhod
);

218 
√t¢mp_h™dÀr_ªgi°øti⁄
 *

219 
√t¢mp_h™dÀr_ªgi°øti⁄_¸óã
(c⁄° *
«me
,

220 
√t¢mp_mib_h™dÀr
 *
h™dÀr
,

221 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

222 
modes
);

223 
√t¢mp_h™dÀr_ªgi°øti⁄
 *

224 
√t¢mp_¸óã_h™dÀr_ªgi°øti⁄
(c⁄° *
«me
, 
Në¢mp_Node_H™dÀr
*

225 
h™dÀr_ac˚ss_mëhod
,

226 c⁄° 
oid
 *
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

227 
modes
);

229 
√t¢mp_dñeg©ed_ˇche


230 *
√t¢mp_¸óã_dñeg©ed_ˇche
(
√t¢mp_mib_h™dÀr
 *,

231 
√t¢mp_h™dÀr_ªgi°øti⁄
 *,

232 
√t¢mp_agít_ªque°_öfo
 *,

233 
√t¢mp_ªque°_öfo
 *, *);

234 
√t¢mp_‰ì_dñeg©ed_ˇche
(
√t¢mp_dñeg©ed_ˇche
 *
dˇche
);

235 
√t¢mp_dñeg©ed_ˇche


236 *
√t¢mp_h™dÀr_check_ˇche
(
√t¢mp_dñeg©ed_ˇche
 *
dˇche
);

237 
√t¢mp_ªgi°î_h™dÀr_by_«me
(const *,

238 
√t¢mp_mib_h™dÀr


241 
√t¢mp_˛ór_h™dÀr_li°
();

244 
√t¢mp_ªque°_add_li°_d©a
(
√t¢mp_ªque°_öfo
 *
ªque°
,

245 
√t¢mp_d©a_li°
 *
node
);

246 
√t¢mp_ªque°_ªmove_li°_d©a
(
√t¢mp_ªque°_öfo
 *
ªque°
,

247 c⁄° *
«me
);

250 
√t¢mp_ªque°_ªmove_li°_d©a
(
√t¢mp_ªque°_öfo
 *
ªque°
,

251 c⁄° *
«me
);

253 *
√t¢mp_ªque°_gë_li°_d©a
(
√t¢mp_ªque°_öfo


254 *
ªque°
,

255 c⁄° *
«me
);

258 
√t¢mp_‰ì_ªque°_d©a_£t
(
√t¢mp_ªque°_öfo
 *
ªque°
);

261 
√t¢mp_‰ì_ªque°_d©a_£ts
(
√t¢mp_ªque°_öfo
 *
ªque°
);

263 
√t¢mp_h™dÀr_‰ì
(
√t¢mp_mib_h™dÀr
 *);

264 
√t¢mp_mib_h™dÀr
 *
√t¢mp_h™dÀr_dup
(netsnmp_mib_handler *);

265 
√t¢mp_h™dÀr_ªgi°øti⁄


266 *
√t¢mp_h™dÀr_ªgi°øti⁄_dup
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *);

268 
√t¢mp_h™dÀr_ªgi°øti⁄_‰ì
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *);

270 
	#REQUEST_IS_DELEGATED
 1

	)

271 
	#REQUEST_IS_NOT_DELEGATED
 0

	)

273 
√t¢mp_h™dÀr_m¨k_ªque°s_as_dñeg©ed
(
√t¢mp_ªque°_öfo
 *,

275 *
√t¢mp_h™dÀr_gë_∑ª¡_d©a
(
√t¢mp_ªque°_öfo
 *,

278 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/agent_module_config.h

3 
	#USING_AGENTX_MASTER_MODULE
 1

	)

6 
	#USING_AGENTX_SUBAGENT_MODULE
 1

	)

9 
	#USING_SMUX_SMUX_MODULE
 1

	)

12 
	#USING_AGENTX_PROTOCOL_MODULE
 1

	)

15 
	#USING_AGENTX_CLIENT_MODULE
 1

	)

18 
	#USING_AGENTX_MASTER_ADMIN_MODULE
 1

	)

21 
	#USING_AGENTX_AGENTX_CONFIG_MODULE
 1

	)

24 
	#USING_SNMPV3_USMCONF_MODULE
 1

	)

27 
	#USING_UTILITIES_EXECUTE_MODULE
 1

	)

30 
	#USING_UTILITIES_IQUERY_MODULE
 1

	)

33 
	#USING_MIBII_VACM_CONF_MODULE
 1

	)

	@/usr/include/net-snmp/agent/agent_read_config.h

5 #i‚de‡
_AGENT_READ_CONFIG_H


6 
	#_AGENT_READ_CONFIG_H


	)

8 #ifde‡
__˝lu•lus


12 
öô_agít_ªad_c⁄fig
(const *);

13 
upd©e_c⁄fig
();

14 
¢mpd_ªgi°î_c⁄fig_h™dÀr
(c⁄° *
tokí
,

15 (*
∑r£r
) (const

18 (*
ªÀa£r
) (),

19 c⁄° *
hñp
);

20 
¢mpd_ªgi°î_c⁄°_c⁄fig_h™dÀr
(

22 (*
∑r£r
) (const *, const *),

23 (*
ªÀa£r
) (),

25 
¢mpd_uƒegi°î_c⁄fig_h™dÀr
(const *);

26 
¢mpd_°‹e_c⁄fig
(const *);

28 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/agent_registry.h

1 #i‚de‡
AGENT_REGISTRY_H


2 
	#AGENT_REGISTRY_H


	)

10 
	~<√t-¢mp/agít/¢mp_agít.h
>

11 
	~<√t-¢mp/libøry/fd_evít_m™agî.h
>

13 #ifde‡
__˝lu•lus


26 
	svõw_∑ømëîs
 {

27 
√t¢mp_pdu
 *
pdu
;

28 
oid
 *
«me
;

29 
size_t
 
«mñí
;

30 
ã°
;

31 
îr‹code
;

34 
check_subåì
;

37 
	sªgi°î_∑ømëîs
 {

38 
oid
 *
«me
;

39 
size_t
 
«mñí
;

40 
¥i‹ôy
;

41 
ønge_subid
;

42 
oid
 
ønge_ubound
;

43 
timeout
;

44 
u_ch¨
 
Êags
;

45 c⁄° *
c⁄ãxtName
;

46 
√t¢mp_£ssi⁄
 *
£ssi⁄
;

47 
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
;

50 
	ssubåì_c⁄ãxt_ˇche_s
 {

51 c⁄° *
c⁄ãxt_«me
;

52 
√t¢mp_subåì_s
 *
fú°_subåì
;

53 
subåì_c⁄ãxt_ˇche_s
 *
√xt
;

54 } 
	tsubåì_c⁄ãxt_ˇche
;

58 
£tup_åì
 ();

59 
shutdown_åì
 ();

62 
√t¢mp_subåì
 *
√t¢mp_subåì_föd
 (c⁄° 
oid
 *, 
size_t
,

63 
√t¢mp_subåì
 *,

64 c⁄° *
c⁄ãxt_«me
);

66 
√t¢mp_subåì
 *
√t¢mp_subåì_föd_√xt
(c⁄° 
oid
 *, 
size_t
,

67 
√t¢mp_subåì
 *,

68 c⁄° *
c⁄ãxt_«me
);

70 
√t¢mp_subåì
 *
√t¢mp_subåì_föd_¥ev
(c⁄° 
oid
 *, 
size_t
,

71 
√t¢mp_subåì
 *,

72 c⁄° *
c⁄ãxt_«me
);

74 
√t¢mp_subåì
 *
√t¢mp_subåì_föd_fú°
(c⁄° *
c⁄ãxt_«me
);

76 
√t¢mp_£ssi⁄
 *
gë_£ssi⁄_f‹_oid
 (c⁄° 
oid
 *, 
size_t
,

77 c⁄° *
c⁄ãxt_«me
);

79 
subåì_c⁄ãxt_ˇche
 *
gë_t›_c⁄ãxt_ˇche
();

81 
√t¢mp_£t_lookup_ˇche_size
(
√wsize
);

82 
√t¢mp_gë_lookup_ˇche_size
();

84 
	#MIB_REGISTERED_OK
 0

	)

85 
	#MIB_DUPLICATE_REGISTRATION
 -1

	)

86 
	#MIB_REGISTRATION_FAILED
 -2

	)

87 
	#MIB_UNREGISTERED_OK
 0

	)

88 
	#MIB_NO_SUCH_REGISTRATION
 -1

	)

89 
	#MIB_UNREGISTRATION_FAILED
 -2

	)

90 
	#DEFAULT_MIB_PRIORITY
 127

	)

92 
ªgi°î_mib
 (c⁄° *, 
v¨übÀ
 *,

93 
size_t
, size_t, c⁄° 
oid
 *,

94 
size_t
);

96 
ªgi°î_mib_¥i‹ôy
 (c⁄° *, 
v¨übÀ
 *,

97 
size_t
, size_t, c⁄° 
oid
 *, size_t,

100 
ªgi°î_mib_ønge
 (c⁄° *, 
v¨übÀ
 *,

101 
size_t
, size_t, c⁄° 
oid
 *,

102 
size_t
, , , 
oid
,

103 
√t¢mp_£ssi⁄
 *);

105 
ªgi°î_mib_c⁄ãxt
 (c⁄° *, 
v¨übÀ
 *,

106 
size_t
, size_t, c⁄° 
oid
 *, size_t,

107 , , 
oid
, 
√t¢mp_£ssi⁄
 *,

110 
√t¢mp_ªgi°î_mib_èbÀ_row
 (c⁄° *, 
v¨übÀ
 *,

111 
size_t
, size_t, 
oid
 *,

112 
size_t
, , , 
√t¢mp_£ssi⁄
 *,

115 
uƒegi°î_mib
 (
oid
 *, 
size_t
);

117 
uƒegi°î_mib_¥i‹ôy
 (
oid
 *, 
size_t
, );

118 
uƒegi°î_mib_ønge
 (
oid
 *, 
size_t
, , , oid);

119 
uƒegi°î_mib_c⁄ãxt
 (
oid
 *, 
size_t
, , , oid,

121 
˛ór_c⁄ãxt
 ();

122 
uƒegi°î_mibs_by_£ssi⁄
 (
√t¢mp_£ssi⁄
 *);

123 
√t¢mp_uƒegi°î_mib_èbÀ_row
 (
oid
 *
mibloc
, 
size_t
 
miblo˛í
,

124 
¥i‹ôy
, 
v¨_subid
,

125 
oid
 
ønge_ubound
,

126 c⁄° *
c⁄ãxt
);

128 
com∑ª_åì
 (c⁄° 
oid
 *, 
size_t
,

129 c⁄° 
oid
 *, 
size_t
);

130 
ö_a_võw
 (
oid
 *, 
size_t
 *,

131 
√t¢mp_pdu
 *, );

132 
check_ac˚ss
 (
√t¢mp_pdu
 *
pdu
);

133 
√t¢mp_acm_check_subåì
 (
√t¢mp_pdu
 *, 
oid
 *, 
size_t
);

134 
ªgi°î_mib_ª©èch
 ();

135 
ªgi°î_mib_dëach
 ();

147 
	#REGISTER_MIB
(
des¸
, 
v¨
, 
v¨ty≥
, 
theoid
) \

148 i‡(
	`ªgi°î_mib
(
des¸
, (
v¨übÀ
 *Ë
v¨
, (
v¨ty≥
), \

149 (
v¨
)/(
v¨ty≥
), \

150 
theoid
, —heoid)/(
oid
)Ë!
MIB_REGISTERED_OK
 ) \

151 
	`DEBUGMSGTL
(("ªgi°î_mib", "%†ªgi°øti⁄ faûed\n", 
des¸
));

	)

154 
	#NUM_EXTERNAL_SIGS
 32

	)

155 
	#SIG_REGISTERED_OK
 0

	)

156 
	#SIG_REGISTRATION_FAILED
 -2

	)

157 
	#SIG_UNREGISTERED_OK
 0

	)

159 
exã∫Æ_sig«l_scheduÀd
[
NUM_EXTERNAL_SIGS
];

160 (*
exã∫Æ_sig«l_h™dÀr
[
NUM_EXTERNAL_SIGS
])();

162 
ªgi°î_sig«l
(, (*
func
)());

163 
uƒegi°î_sig«l
();

171 
	g√t¢mp_h™dÀr_ªgi°øti⁄_s
;

173 
√t¢mp_ªgi°î_mib
(c⁄° *, 
v¨übÀ
 *,

174 
size_t
, size_t, 
oid
 *, size_t,

175 , , 
oid
, 
√t¢mp_£ssi⁄
 *,

177 
√t¢mp_h™dÀr_ªgi°øti⁄_s
 *,

180 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/agent_trap.h

1 #i‚de‡
AGENT_TRAP_H


2 
	#AGENT_TRAP_H


	)

4 #ifde‡
__˝lu•lus


8 
	sagít_add_å≠_¨gs
 {

9 
√t¢mp_£ssi⁄
 *
ss
;

10 
c⁄fúm
;

13 
öô_å≠s
();

14 
£nd_ósy_å≠
(, );

15 
£nd_å≠_pdu
(
√t¢mp_pdu
 *);

16 
£nd_v2å≠
(
√t¢mp_v¨übÀ_li°
 *);

17 
£nd_v3å≠
(
√t¢mp_v¨übÀ_li°
 *
v¨s
, c⁄° *
c⁄ãxt
);

18 
£nd_å≠_v¨s
(, , 
√t¢mp_v¨übÀ_li°
 *);

19 
£nd_å≠_v¨s_wôh_c⁄ãxt
(
å≠
, 
•ecific
,

20 
√t¢mp_v¨übÀ_li°
 *
v¨s
,

21 c⁄° *
c⁄ãxt
);

22 
£nd_íãΩri£_å≠_v¨s
(
å≠
, 
•ecific
,

23 c⁄° 
oid
 * 
íãΩri£
,

24 
íãΩri£_Àngth
,

25 
√t¢mp_v¨übÀ_li°
 * 
v¨s
);

26 
√t¢mp_£nd_å≠s
(
å≠
, 
•ecific
,

27 c⁄° 
oid
 * 
íãΩri£
, 
íãΩri£_Àngth
,

28 
√t¢mp_v¨übÀ_li°
 * 
v¨s
,

30 c⁄° * 
c⁄ãxt
, 
Êags
);

31 
¢mpd_∑r£_c⁄fig_authå≠
(const *, *);

32 
¢mpd_∑r£_c⁄fig_å≠sök
(const *, *);

33 
¢mpd_∑r£_c⁄fig_å≠2sök
(const *, *);

34 
¢mpd_∑r£_c⁄fig_öf‹msök
(const *, *);

35 
¢mpd_∑r£_c⁄fig_å≠£ss
(const *, *);

36 
¢mpd_‰ì_å≠söks
();

37 
¢mpd_∑r£_c⁄fig_å≠communôy
(const *, *);

38 
¢mpd_‰ì_å≠communôy
();

39 
£nd_å≠_to_£ss
(
√t¢mp_£ssi⁄
 * 
£ss
,

40 
√t¢mp_pdu
 *
ãm∂©e_pdu
);

42 
¸óã_å≠_£ssi⁄
(*, 
u_sh‹t
, *, , );

43 
add_å≠_£ssi⁄
(
√t¢mp_£ssi⁄
 *, , , );

44 
ªmove_å≠_£ssi⁄
(
√t¢mp_£ssi⁄
 *);

46 
c⁄vît_v2_to_v1
(
√t¢mp_v¨übÀ_li°
 *, 
√t¢mp_pdu
 *);

47 
√t¢mp_v¨übÀ_li°
 *
c⁄vît_v1_to_v2
(
√t¢mp_pdu
 *);

48 
√t¢mp_pdu
 *
c⁄vît_v2pdu_to_v1
(netsnmp_pdu *);

49 
√t¢mp_pdu
 *
c⁄vît_v1pdu_to_v2
(netsnmp_pdu *);

51 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/all_helpers.h

1 #i‚de‡
ALL_HANDLERS_H


2 
	#ALL_HANDLERS_H


	)

4 #ifde‡
__˝lu•lus


8 
	~<√t-¢mp/agít/ö°™˚.h
>

9 
	~<√t-¢mp/agít/baby_°ïs.h
>

10 
	~<√t-¢mp/agít/sˇœr.h
>

11 
	~<√t-¢mp/agít/sˇœr_group.h
>

12 
	~<√t-¢mp/agít/w©chî.h
>

13 
	~<√t-¢mp/agít/mu…ùÀxî.h
>

14 
	~<√t-¢mp/agít/nuŒ.h
>

15 
	~<√t-¢mp/agít/debug_h™dÀr.h
>

16 
	~<√t-¢mp/agít/ˇche_h™dÀr.h
>

17 
	~<√t-¢mp/agít/ﬁd_≠i.h
>

18 
	~<√t-¢mp/agít/ªad_⁄ly.h
>

19 
	~<√t-¢mp/agít/row_mîge.h
>

20 
	~<√t-¢mp/agít/£rülize.h
>

21 
	~<√t-¢mp/agít/bulk_to_√xt.h
>

22 
	~<√t-¢mp/agít/mode_íd_ˇŒ.h
>

26 
	~<√t-¢mp/agít/èbÀ.h
>

27 
	~<√t-¢mp/agít/èbÀ_d©a.h
>

28 
	~<√t-¢mp/agít/èbÀ_d©a£t.h
>

29 
	~<√t-¢mp/agít/èbÀ_td©a.h
>

30 
	~<√t-¢mp/agít/èbÀ_ôî©‹.h
>

31 
	~<√t-¢mp/agít/èbÀ_c⁄èöî.h
>

32 
	~<√t-¢mp/agít/èbÀ_¨øy.h
>

34 
	~<√t-¢mp/agít/mfd.h
>

35 
	~<√t-¢mp/agít/¢mp_gë_°©i°ic.h
>

38 
√t¢mp_öô_hñ≥rs
();

40 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/ds_agent.h

1 #i‚de‡
NETSNMP_DS_AGENT_H


2 
	#NETSNMP_DS_AGENT_H


	)

16 
	#NETSNMP_DS_AGENT_VERBOSE
 0

	)

17 
	#NETSNMP_DS_AGENT_ROLE
 1

	)

18 
	#NETSNMP_DS_AGENT_NO_ROOT_ACCESS
 2

	)

19 
	#NETSNMP_DS_AGENT_AGENTX_MASTER
 3

	)

20 
	#NETSNMP_DS_AGENT_QUIT_IMMEDIATELY
 4

	)

21 
	#NETSNMP_DS_AGENT_DISABLE_PERL
 5

	)

22 
	#NETSNMP_DS_AGENT_NO_CONNECTION_WARNINGS
 6

	)

23 
	#NETSNMP_DS_AGENT_LEAVE_PIDFILE
 7

	)

24 
	#NETSNMP_DS_AGENT_NO_CACHING
 8

	)

25 
	#NETSNMP_DS_AGENT_STRICT_DISMAN
 9

	)

26 
	#NETSNMP_DS_AGENT_DONT_RETAIN_NOTIFICATIONS
 10

	)

27 
	#NETSNMP_DS_AGENT_DONT_LOG_TCPWRAPPERS_CONNECTS
 12

	)

28 
	#NETSNMP_DS_APP_DONT_LOG
 
NETSNMP_DS_AGENT_DONT_RETAIN_NOTIFICATIONS


	)

29 
	#NETSNMP_DS_AGENT_SKIPNFSINHOSTRESOURCES
 13

	)

30 
	#NETSNMP_DS_AGENT_REALSTORAGEUNITS
 14

	)

33 
	#NETSNMP_DS_APP_NUMERIC_IP
 16

	)

34 
	#NETSNMP_DS_APP_NO_AUTHORIZATION
 17

	)

36 
	#NETSNMP_DS_AGENT_DISKIO_NO_FD
 18

	)

37 
	#NETSNMP_DS_AGENT_DISKIO_NO_LOOP
 19

	)

38 
	#NETSNMP_DS_AGENT_DISKIO_NO_RAM
 20

	)

46 
	#NETSNMP_DS_AGENT_PROGNAME
 0

	)

47 
	#NETSNMP_DS_AGENT_X_SOCKET
 1

	)

48 
	#NETSNMP_DS_AGENT_PORTS
 2

	)

49 
	#NETSNMP_DS_AGENT_INTERNAL_SECNAME
 3

	)

50 
	#NETSNMP_DS_AGENT_PERL_INIT_FILE
 4

	)

51 
	#NETSNMP_DS_SMUX_SOCKET
 5

	)

52 
	#NETSNMP_DS_NOTIF_LOG_CTX
 6

	)

53 
	#NETSNMP_DS_AGENT_TRAP_ADDR
 7

	)

58 
	#NETSNMP_DS_AGENT_FLAGS
 0

	)

59 
	#NETSNMP_DS_AGENT_USERID
 1

	)

60 
	#NETSNMP_DS_AGENT_GROUPID
 2

	)

61 
	#NETSNMP_DS_AGENT_AGENTX_PING_INTERVAL
 3

	)

62 
	#NETSNMP_DS_AGENT_AGENTX_TIMEOUT
 4

	)

63 
	#NETSNMP_DS_AGENT_AGENTX_RETRIES
 5

	)

64 
	#NETSNMP_DS_AGENT_X_SOCK_PERM
 6

	)

65 
	#NETSNMP_DS_AGENT_X_DIR_PERM
 7

	)

66 
	#NETSNMP_DS_AGENT_X_SOCK_USER
 8

	)

67 
	#NETSNMP_DS_AGENT_X_SOCK_GROUP
 9

	)

68 
	#NETSNMP_DS_AGENT_CACHE_TIMEOUT
 10

	)

69 
	#NETSNMP_DS_AGENT_INTERNAL_VERSION
 11

	)

70 
	#NETSNMP_DS_AGENT_INTERNAL_SECLEVEL
 12

	)

71 
	#NETSNMP_DS_AGENT_MAX_GETBULKREPEATS
 13

	)

72 
	#NETSNMP_DS_AGENT_MAX_GETBULKRESPONSES
 14

	)

	@/usr/include/net-snmp/agent/mib_module_config.h

3 
	#USING_HOST_MODULE
 1

	)

6 
	#USING_AGENTX_MODULE
 1

	)

9 
	#USING_SMUX_MODULE
 1

	)

12 
	#USING_UCD_SNMP_DISKIO_MODULE
 1

	)

15 
	#USING_TCP_MIB_MODULE
 1

	)

18 
	#USING_UDP_MIB_MODULE
 1

	)

21 
	#USING_MIBII_MTA_SENDMAIL_MODULE
 1

	)

24 
	#USING_IP_MIB_IPV4INTERFACETABLE_MODULE
 1

	)

27 
	#USING_IP_MIB_IPV6INTERFACETABLE_MODULE
 1

	)

30 
	#USING_IP_MIB_IPADDRESSPREFIXTABLE_IPADDRESSPREFIXTABLE_MODULE
 1

	)

33 
	#USING_IP_MIB_IPDEFAULTROUTERTABLE_IPDEFAULTROUTERTABLE_MODULE
 1

	)

36 
	#USING_IP_MIB_IPV6SCOPEZONEINDEXTABLE_MODULE
 1

	)

39 
	#USING_IP_MIB_IPIFSTATSTABLE_MODULE
 1

	)

42 
	#USING_SCTP_MIB_MODULE
 1

	)

45 
	#USING_RMON_MIB_MODULE
 1

	)

48 
	#USING_ETHERLIKE_MIB_MODULE
 1

	)

51 
	#USING_UCD_SNMP_LMSENSORSMIB_MODULE
 1

	)

54 
	#USING_DEFAULT_MODULES_MODULE
 1

	)

57 
	#USING_HOST_HRH_STORAGE_MODULE
 1

	)

60 
	#USING_HOST_HRH_FILESYS_MODULE
 1

	)

63 
	#USING_HOST_HRSWINSTALLEDTABLE_MODULE
 1

	)

66 
	#USING_HOST_HRSWRUNTABLE_MODULE
 1

	)

69 
	#USING_HOST_HR_SYSTEM_MODULE
 1

	)

72 
	#USING_HOST_HR_DEVICE_MODULE
 1

	)

75 
	#USING_HOST_HR_OTHER_MODULE
 1

	)

78 
	#USING_HOST_HR_PROC_MODULE
 1

	)

81 
	#USING_HOST_HR_NETWORK_MODULE
 1

	)

84 
	#USING_HOST_HR_PRINT_MODULE
 1

	)

87 
	#USING_HOST_HR_DISK_MODULE
 1

	)

90 
	#USING_HOST_HR_PARTITION_MODULE
 1

	)

93 
	#USING_UTIL_FUNCS_HEADER_SIMPLE_TABLE_MODULE
 1

	)

96 
	#USING_TCP_MIB_TCPCONNECTIONTABLE_MODULE
 1

	)

99 
	#USING_TCP_MIB_TCPLISTENERTABLE_MODULE
 1

	)

102 
	#USING_UDP_MIB_UDPENDPOINTTABLE_MODULE
 1

	)

105 
	#USING_IP_MIB_IPV4INTERFACETABLE_IPV4INTERFACETABLE_MODULE
 1

	)

108 
	#USING_IP_MIB_IPV6INTERFACETABLE_IPV6INTERFACETABLE_MODULE
 1

	)

111 
	#USING_IP_MIB_IPADDRESSTABLE_IPADDRESSTABLE_MODULE
 1

	)

114 
	#USING_IP_MIB_IPADDRESSPREFIXTABLE_IPADDRESSPREFIXTABLE_INTERFACE_MODULE
 1

	)

117 
	#USING_IP_MIB_IPADDRESSPREFIXTABLE_IPADDRESSPREFIXTABLE_DATA_ACCESS_MODULE
 1

	)

120 
	#USING_IP_MIB_DATA_ACCESS_DEFAULTROUTER_MODULE
 1

	)

123 
	#USING_IP_MIB_IPDEFAULTROUTERTABLE_IPDEFAULTROUTERTABLE_INTERFACE_MODULE
 1

	)

126 
	#USING_IP_MIB_IPDEFAULTROUTERTABLE_IPDEFAULTROUTERTABLE_DATA_ACCESS_MODULE
 1

	)

129 
	#USING_IP_MIB_IPDEFAULTROUTERTABLE_IPDEFAULTROUTERTABLE_DATA_GET_MODULE
 1

	)

132 
	#USING_IP_MIB_IPV6SCOPEZONEINDEXTABLE_IPV6SCOPEZONEINDEXTABLE_MODULE
 1

	)

135 
	#USING_IP_MIB_DATA_ACCESS_SYSTEMSTATS_MODULE
 1

	)

138 
	#USING_IP_MIB_IPIFSTATSTABLE_IPIFSTATSTABLE_MODULE
 1

	)

141 
	#USING_IP_MIB_IPIFSTATSTABLE_IPIFSTATSTABLE_INTERFACE_MODULE
 1

	)

144 
	#USING_IP_MIB_IPIFSTATSTABLE_IPIFSTATSTABLE_DATA_ACCESS_MODULE
 1

	)

147 
	#USING_SCTP_MIB_SCTPSCALARS_MODULE
 1

	)

150 
	#USING_SCTP_MIB_SCTPTABLES_MODULE
 1

	)

153 
	#USING_RMON_MIB_ETHERSTATSTABLE_MODULE
 1

	)

156 
	#USING_ETHERLIKE_MIB_DOT3STATSTABLE_MODULE
 1

	)

159 
	#USING_HARDWARE_SENSORS_MODULE
 1

	)

162 
	#USING_SNMPV3MIBS_MODULE
 1

	)

165 
	#USING_MIBII_MODULE
 1

	)

168 
	#USING_UCD_SNMP_MODULE
 1

	)

171 
	#USING_NOTIFICATION_MODULE
 1

	)

174 
	#USING_NOTIFICATION_LOG_MIB_MODULE
 1

	)

177 
	#USING_TARGET_MODULE
 1

	)

180 
	#USING_AGENT_MIBS_MODULE
 1

	)

183 
	#USING_DISMAN_EVENT_MODULE
 1

	)

186 
	#USING_DISMAN_SCHEDULE_MODULE
 1

	)

189 
	#USING_UTILITIES_MODULE
 1

	)

192 
	#USING_HARDWARE_MEMORY_MODULE
 1

	)

195 
	#USING_HARDWARE_FSYS_MODULE
 1

	)

198 
	#USING_HOST_DATA_ACCESS_SWINST_MODULE
 1

	)

201 
	#USING_HOST_DATA_ACCESS_SWRUN_MODULE
 1

	)

204 
	#USING_HOST_HRSWRUNPERFTABLE_MODULE
 1

	)

207 
	#USING_HARDWARE_CPU_MODULE
 1

	)

210 
	#USING_MIBII_IFTABLE_MODULE
 1

	)

213 
	#USING_UTIL_FUNCS_MODULE
 1

	)

216 
	#USING_TCP_MIB_DATA_ACCESS_TCPCONN_MODULE
 1

	)

219 
	#USING_TCP_MIB_TCPCONNECTIONTABLE_TCPCONNECTIONTABLE_MODULE
 1

	)

222 
	#USING_TCP_MIB_TCPLISTENERTABLE_TCPLISTENERTABLE_MODULE
 1

	)

225 
	#USING_UDP_MIB_UDPENDPOINTTABLE_UDPENDPOINTTABLE_MODULE
 1

	)

228 
	#USING_IF_MIB_DATA_ACCESS_INTERFACE_MODULE
 1

	)

231 
	#USING_IF_MIB_IFTABLE_IFTABLE_INTERFACE_MODULE
 1

	)

234 
	#USING_IF_MIB_IFTABLE_IFTABLE_DATA_ACCESS_MODULE
 1

	)

237 
	#USING_IF_MIB_IFTABLE_IFTABLE_MODULE
 1

	)

240 
	#USING_IP_MIB_IPV4INTERFACETABLE_IPV4INTERFACETABLE_INTERFACE_MODULE
 1

	)

243 
	#USING_IP_MIB_IPV4INTERFACETABLE_IPV4INTERFACETABLE_DATA_ACCESS_MODULE
 1

	)

246 
	#USING_IP_MIB_IPV6INTERFACETABLE_IPV6INTERFACETABLE_INTERFACE_MODULE
 1

	)

249 
	#USING_IP_MIB_IPV6INTERFACETABLE_IPV6INTERFACETABLE_DATA_ACCESS_MODULE
 1

	)

252 
	#USING_IP_MIB_DATA_ACCESS_IPADDRESS_MODULE
 1

	)

255 
	#USING_IP_MIB_IPADDRESSTABLE_IPADDRESSTABLE_INTERFACE_MODULE
 1

	)

258 
	#USING_IP_MIB_IPADDRESSTABLE_IPADDRESSTABLE_DATA_ACCESS_MODULE
 1

	)

261 
	#USING_IP_MIB_DATA_ACCESS_DEFAULTROUTER_COMMON_MODULE
 1

	)

264 
	#USING_IP_MIB_DATA_ACCESS_DEFAULTROUTER_LINUX_MODULE
 1

	)

267 
	#USING_IP_MIB_DATA_ACCESS_IPV6SCOPEZONE_MODULE
 1

	)

270 
	#USING_IP_MIB_IPV6SCOPEZONEINDEXTABLE_IPV6SCOPEZONEINDEXTABLE_INTERFACE_MODULE
 1

	)

273 
	#USING_IP_MIB_IPV6SCOPEZONEINDEXTABLE_IPV6SCOPEZONEINDEXTABLE_DATA_ACCESS_MODULE
 1

	)

276 
	#USING_IP_MIB_DATA_ACCESS_SYSTEMSTATS_COMMON_MODULE
 1

	)

279 
	#USING_IP_MIB_DATA_ACCESS_SYSTEMSTATS_LINUX_MODULE
 1

	)

282 
	#USING_IP_MIB_IPIFSTATSTABLE_IPIFSTATSTABLE_DATA_GET_MODULE
 1

	)

285 
	#USING_SCTP_MIB_SCTPSCALARS_COMMON_MODULE
 1

	)

288 
	#USING_SCTP_MIB_SCTPSCALARS_LINUX_MODULE
 1

	)

291 
	#USING_SCTP_MIB_SCTPTABLES_COMMON_MODULE
 1

	)

294 
	#USING_SCTP_MIB_SCTPASSOCREMADDRTABLE_MODULE
 1

	)

297 
	#USING_SCTP_MIB_SCTPASSOCLOCALADDRTABLE_MODULE
 1

	)

300 
	#USING_SCTP_MIB_SCTPLOOKUPLOCALPORTTABLE_MODULE
 1

	)

303 
	#USING_SCTP_MIB_SCTPLOOKUPREMPORTTABLE_MODULE
 1

	)

306 
	#USING_SCTP_MIB_SCTPLOOKUPREMHOSTNAMETABLE_MODULE
 1

	)

309 
	#USING_SCTP_MIB_SCTPLOOKUPREMPRIMIPADDRTABLE_MODULE
 1

	)

312 
	#USING_SCTP_MIB_SCTPLOOKUPREMIPADDRTABLE_MODULE
 1

	)

315 
	#USING_SCTP_MIB_SCTPASSOCTABLE_MODULE
 1

	)

318 
	#USING_SCTP_MIB_SCTPTABLES_LINUX_MODULE
 1

	)

321 
	#USING_UTIL_FUNCS_GET_PID_FROM_INODE_MODULE
 1

	)

324 
	#USING_RMON_MIB_DATA_ACCESS_ETHERSTATS_MODULE
 1

	)

327 
	#USING_RMON_MIB_ETHERSTATSTABLE_ETHERSTATSTABLE_MODULE
 1

	)

330 
	#USING_RMON_MIB_ETHERSTATSTABLE_ETHERSTATSTABLE_DATA_GET_MODULE
 1

	)

333 
	#USING_RMON_MIB_ETHERSTATSTABLE_ETHERSTATSTABLE_DATA_SET_MODULE
 1

	)

336 
	#USING_RMON_MIB_ETHERSTATSTABLE_ETHERSTATSTABLE_DATA_ACCESS_MODULE
 1

	)

339 
	#USING_RMON_MIB_ETHERSTATSTABLE_ETHERSTATSTABLE_INTERFACE_MODULE
 1

	)

342 
	#USING_ETHERLIKE_MIB_DATA_ACCESS_DOT3STATS_MODULE
 1

	)

345 
	#USING_ETHERLIKE_MIB_DOT3STATSTABLE_DOT3STATSTABLE_MODULE
 1

	)

348 
	#USING_ETHERLIKE_MIB_DOT3STATSTABLE_DOT3STATSTABLE_DATA_GET_MODULE
 1

	)

351 
	#USING_ETHERLIKE_MIB_DOT3STATSTABLE_DOT3STATSTABLE_DATA_SET_MODULE
 1

	)

354 
	#USING_ETHERLIKE_MIB_DOT3STATSTABLE_DOT3STATSTABLE_DATA_ACCESS_MODULE
 1

	)

357 
	#USING_ETHERLIKE_MIB_DOT3STATSTABLE_DOT3STATSTABLE_INTERFACE_MODULE
 1

	)

360 
	#USING_HARDWARE_SENSORS_HW_SENSORS_MODULE
 1

	)

363 
	#USING_HARDWARE_SENSORS_LMSENSORS_V3_MODULE
 1

	)

366 
	#USING_SNMPV3_SNMPMPDSTATS_5_5_MODULE
 1

	)

369 
	#USING_SNMPV3_USMSTATS_5_5_MODULE
 1

	)

372 
	#USING_SNMPV3_SNMPENGINE_MODULE
 1

	)

375 
	#USING_SNMPV3_USMUSER_MODULE
 1

	)

378 
	#USING_MIBII_SNMP_MIB_5_5_MODULE
 1

	)

381 
	#USING_MIBII_SYSTEM_MIB_MODULE
 1

	)

384 
	#USING_MIBII_SYSORTABLE_MODULE
 1

	)

387 
	#USING_MIBII_AT_MODULE
 1

	)

390 
	#USING_MIBII_IP_MODULE
 1

	)

393 
	#USING_MIBII_TCP_MODULE
 1

	)

396 
	#USING_MIBII_ICMP_MODULE
 1

	)

399 
	#USING_MIBII_UDP_MODULE
 1

	)

402 
	#USING_MIBII_VACM_VARS_MODULE
 1

	)

405 
	#USING_MIBII_SETSERIALNO_MODULE
 1

	)

408 
	#USING_MIBII_IPV6_MODULE
 1

	)

411 
	#USING_IF_MIB_MODULE
 1

	)

414 
	#USING_IP_MIB_MODULE
 1

	)

417 
	#USING_IP_FORWARD_MIB_MODULE
 1

	)

420 
	#USING_UCD_SNMP_DISK_HW_MODULE
 1

	)

423 
	#USING_UCD_SNMP_PROC_MODULE
 1

	)

426 
	#USING_UCD_SNMP_VERSIONINFO_MODULE
 1

	)

429 
	#USING_UCD_SNMP_PASS_MODULE
 1

	)

432 
	#USING_UCD_SNMP_PASS_PERSIST_MODULE
 1

	)

435 
	#USING_UCD_SNMP_LOADAVE_MODULE
 1

	)

438 
	#USING_AGENT_EXTEND_MODULE
 1

	)

441 
	#USING_UCD_SNMP_ERRORMIB_MODULE
 1

	)

444 
	#USING_UCD_SNMP_FILE_MODULE
 1

	)

447 
	#USING_UCD_SNMP_DLMOD_MODULE
 1

	)

450 
	#USING_UCD_SNMP_PROXY_MODULE
 1

	)

453 
	#USING_UCD_SNMP_LOGMATCH_MODULE
 1

	)

456 
	#USING_UCD_SNMP_MEMORY_MODULE
 1

	)

459 
	#USING_UCD_SNMP_VMSTAT_MODULE
 1

	)

462 
	#USING_NOTIFICATION_SNMPNOTIFYTABLE_MODULE
 1

	)

465 
	#USING_SNMP_NOTIFICATION_MIB_SNMPNOTIFYFILTERTABLE_MODULE
 1

	)

468 
	#USING_NOTIFICATION_SNMPNOTIFYFILTERPROFILETABLE_MODULE
 1

	)

471 
	#USING_NOTIFICATION_LOG_MIB_NOTIFICATION_LOG_MODULE
 1

	)

474 
	#USING_TARGET_TARGET_COUNTERS_5_5_MODULE
 1

	)

477 
	#USING_TARGET_SNMPTARGETADDRENTRY_MODULE
 1

	)

480 
	#USING_TARGET_SNMPTARGETPARAMSENTRY_MODULE
 1

	)

483 
	#USING_TARGET_TARGET_MODULE
 1

	)

486 
	#USING_AGENT_NSTRANSACTIONTABLE_MODULE
 1

	)

489 
	#USING_AGENT_NSMODULETABLE_MODULE
 1

	)

492 
	#USING_AGENT_NSDEBUG_MODULE
 1

	)

495 
	#USING_AGENT_NSCACHE_MODULE
 1

	)

498 
	#USING_AGENT_NSLOGGING_MODULE
 1

	)

501 
	#USING_AGENT_NSVACMACCESSTABLE_MODULE
 1

	)

504 
	#USING_DISMAN_EVENT_MTESCALARS_MODULE
 1

	)

507 
	#USING_DISMAN_EVENT_MTETRIGGER_MODULE
 1

	)

510 
	#USING_DISMAN_EVENT_MTETRIGGERTABLE_MODULE
 1

	)

513 
	#USING_DISMAN_EVENT_MTETRIGGERDELTATABLE_MODULE
 1

	)

516 
	#USING_DISMAN_EVENT_MTETRIGGEREXISTENCETABLE_MODULE
 1

	)

519 
	#USING_DISMAN_EVENT_MTETRIGGERBOOLEANTABLE_MODULE
 1

	)

522 
	#USING_DISMAN_EVENT_MTETRIGGERTHRESHOLDTABLE_MODULE
 1

	)

525 
	#USING_DISMAN_EVENT_MTETRIGGERCONF_MODULE
 1

	)

528 
	#USING_DISMAN_EVENT_MTEEVENT_MODULE
 1

	)

531 
	#USING_DISMAN_EVENT_MTEEVENTTABLE_MODULE
 1

	)

534 
	#USING_DISMAN_EVENT_MTEEVENTSETTABLE_MODULE
 1

	)

537 
	#USING_DISMAN_EVENT_MTEEVENTNOTIFICATIONTABLE_MODULE
 1

	)

540 
	#USING_DISMAN_EVENT_MTEEVENTCONF_MODULE
 1

	)

543 
	#USING_DISMAN_EVENT_MTEOBJECTS_MODULE
 1

	)

546 
	#USING_DISMAN_EVENT_MTEOBJECTSTABLE_MODULE
 1

	)

549 
	#USING_DISMAN_EVENT_MTEOBJECTSCONF_MODULE
 1

	)

552 
	#USING_DISMAN_SCHEDULE_SCHEDCORE_MODULE
 1

	)

555 
	#USING_DISMAN_SCHEDULE_SCHEDCONF_MODULE
 1

	)

558 
	#USING_DISMAN_SCHEDULE_SCHEDTABLE_MODULE
 1

	)

561 
	#USING_UTILITIES_OVERRIDE_MODULE
 1

	)

564 
	#USING_HARDWARE_MEMORY_HW_MEM_MODULE
 1

	)

567 
	#USING_HARDWARE_MEMORY_MEMORY_LINUX_MODULE
 1

	)

570 
	#USING_HARDWARE_FSYS_HW_FSYS_MODULE
 1

	)

573 
	#USING_HARDWARE_FSYS_FSYS_MNTENT_MODULE
 1

	)

576 
	#USING_HOST_DATA_ACCESS_SWINST_RPM_MODULE
 1

	)

579 
	#USING_HOST_DATA_ACCESS_SWRUN_PROCFS_STATUS_MODULE
 1

	)

582 
	#USING_HARDWARE_CPU_CPU_MODULE
 1

	)

585 
	#USING_HARDWARE_CPU_CPU_LINUX_MODULE
 1

	)

588 
	#USING_IF_MIB_IFTABLE_MODULE
 1

	)

591 
	#USING_UTIL_FUNCS_HEADER_GENERIC_MODULE
 1

	)

594 
	#USING_TCP_MIB_DATA_ACCESS_TCPCONN_COMMON_MODULE
 1

	)

597 
	#USING_TCP_MIB_DATA_ACCESS_TCPCONN_LINUX_MODULE
 1

	)

600 
	#USING_TCP_MIB_TCPCONNECTIONTABLE_TCPCONNECTIONTABLE_INTERFACE_MODULE
 1

	)

603 
	#USING_TCP_MIB_TCPCONNECTIONTABLE_TCPCONNECTIONTABLE_DATA_ACCESS_MODULE
 1

	)

606 
	#USING_TCP_MIB_TCPLISTENERTABLE_TCPLISTENERTABLE_INTERFACE_MODULE
 1

	)

609 
	#USING_TCP_MIB_TCPLISTENERTABLE_TCPLISTENERTABLE_DATA_ACCESS_MODULE
 1

	)

612 
	#USING_UDP_MIB_DATA_ACCESS_UDP_ENDPOINT_MODULE
 1

	)

615 
	#USING_UDP_MIB_UDPENDPOINTTABLE_UDPENDPOINTTABLE_INTERFACE_MODULE
 1

	)

618 
	#USING_UDP_MIB_UDPENDPOINTTABLE_UDPENDPOINTTABLE_DATA_ACCESS_MODULE
 1

	)

621 
	#USING_IF_MIB_DATA_ACCESS_INTERFACE_LINUX_MODULE
 1

	)

624 
	#USING_IF_MIB_DATA_ACCESS_INTERFACE_IOCTL_MODULE
 1

	)

627 
	#USING_IP_MIB_DATA_ACCESS_IPADDRESS_COMMON_MODULE
 1

	)

630 
	#USING_IP_MIB_DATA_ACCESS_IPADDRESS_LINUX_MODULE
 1

	)

633 
	#USING_IP_MIB_DATA_ACCESS_IPV6SCOPEZONE_COMMON_MODULE
 1

	)

636 
	#USING_IP_MIB_DATA_ACCESS_IPV6SCOPEZONE_LINUX_MODULE
 1

	)

639 
	#USING_RMON_MIB_DATA_ACCESS_ETHERSTATS_LINUX_MODULE
 1

	)

642 
	#USING_ETHERLIKE_MIB_DATA_ACCESS_DOT3STATS_LINUX_MODULE
 1

	)

645 
	#USING_MIBII_UPDATES_MODULE
 1

	)

648 
	#USING_MIBII_KERNEL_LINUX_MODULE
 1

	)

651 
	#USING_MIBII_IPADDR_MODULE
 1

	)

654 
	#USING_MIBII_VAR_ROUTE_MODULE
 1

	)

657 
	#USING_MIBII_ROUTE_WRITE_MODULE
 1

	)

660 
	#USING_MIBII_TCPTABLE_MODULE
 1

	)

663 
	#USING_MIBII_UDPTABLE_MODULE
 1

	)

666 
	#USING_MIBII_VACM_CONTEXT_MODULE
 1

	)

669 
	#USING_IF_MIB_IFXTABLE_MODULE
 1

	)

672 
	#USING_IP_MIB_IPADDRESSTABLE_MODULE
 1

	)

675 
	#USING_IP_MIB_IPADDRESSPREFIXTABLE_MODULE
 1

	)

678 
	#USING_IP_MIB_IPDEFAULTROUTERTABLE_MODULE
 1

	)

681 
	#USING_IP_MIB_INETNETTOMEDIATABLE_MODULE
 1

	)

684 
	#USING_IP_MIB_IPSYSTEMSTATSTABLE_MODULE
 1

	)

687 
	#USING_IP_MIB_IP_SCALARS_MODULE
 1

	)

690 
	#USING_IP_FORWARD_MIB_IPCIDRROUTETABLE_MODULE
 1

	)

693 
	#USING_IP_FORWARD_MIB_INETCIDRROUTETABLE_MODULE
 1

	)

696 
	#USING_UTIL_FUNCS_RESTART_MODULE
 1

	)

699 
	#USING_UCD_SNMP_PASS_COMMON_MODULE
 1

	)

702 
	#USING_HEADER_COMPLEX_MODULE
 1

	)

705 
	#USING_SNMP_NOTIFICATION_MIB_SNMPNOTIFYFILTERTABLE_SNMPNOTIFYFILTERTABLE_MODULE
 1

	)

708 
	#USING_UDP_MIB_DATA_ACCESS_UDP_ENDPOINT_COMMON_MODULE
 1

	)

711 
	#USING_UDP_MIB_DATA_ACCESS_UDP_ENDPOINT_LINUX_MODULE
 1

	)

714 
	#USING_IP_MIB_DATA_ACCESS_IPADDRESS_IOCTL_MODULE
 1

	)

717 
	#USING_IF_MIB_IFXTABLE_IFXTABLE_MODULE
 1

	)

720 
	#USING_IP_MIB_DATA_ACCESS_ARP_MODULE
 1

	)

723 
	#USING_IP_MIB_INETNETTOMEDIATABLE_INETNETTOMEDIATABLE_MODULE
 1

	)

726 
	#USING_IP_MIB_INETNETTOMEDIATABLE_INETNETTOMEDIATABLE_INTERFACE_MODULE
 1

	)

729 
	#USING_IP_MIB_INETNETTOMEDIATABLE_INETNETTOMEDIATABLE_DATA_ACCESS_MODULE
 1

	)

732 
	#USING_IP_MIB_IPSYSTEMSTATSTABLE_IPSYSTEMSTATSTABLE_MODULE
 1

	)

735 
	#USING_IP_MIB_IPSYSTEMSTATSTABLE_IPSYSTEMSTATSTABLE_INTERFACE_MODULE
 1

	)

738 
	#USING_IP_MIB_IPSYSTEMSTATSTABLE_IPSYSTEMSTATSTABLE_DATA_ACCESS_MODULE
 1

	)

741 
	#USING_IP_MIB_DATA_ACCESS_SCALARS_COMMON_MODULE
 1

	)

744 
	#USING_IP_FORWARD_MIB_IPCIDRROUTETABLE_IPCIDRROUTETABLE_MODULE
 1

	)

747 
	#USING_IP_FORWARD_MIB_INETCIDRROUTETABLE_INETCIDRROUTETABLE_MODULE
 1

	)

750 
	#USING_SNMP_NOTIFICATION_MIB_SNMPNOTIFYFILTERTABLE_SNMPNOTIFYFILTERTABLE_INTERFACE_MODULE
 1

	)

753 
	#USING_SNMP_NOTIFICATION_MIB_SNMPNOTIFYFILTERTABLE_SNMPNOTIFYFILTERTABLE_DATA_ACCESS_MODULE
 1

	)

756 
	#USING_IF_MIB_IFXTABLE_IFXTABLE_INTERFACE_MODULE
 1

	)

759 
	#USING_IF_MIB_IFXTABLE_IFXTABLE_DATA_ACCESS_MODULE
 1

	)

762 
	#USING_IP_MIB_DATA_ACCESS_ARP_COMMON_MODULE
 1

	)

765 
	#USING_IP_MIB_DATA_ACCESS_ARP_NETLINK_MODULE
 1

	)

768 
	#USING_IP_MIB_DATA_ACCESS_SCALARS_LINUX_MODULE
 1

	)

771 
	#USING_IP_FORWARD_MIB_DATA_ACCESS_ROUTE_MODULE
 1

	)

774 
	#USING_IP_FORWARD_MIB_IPCIDRROUTETABLE_IPCIDRROUTETABLE_INTERFACE_MODULE
 1

	)

777 
	#USING_IP_FORWARD_MIB_IPCIDRROUTETABLE_IPCIDRROUTETABLE_DATA_ACCESS_MODULE
 1

	)

780 
	#USING_IP_FORWARD_MIB_INETCIDRROUTETABLE_INETCIDRROUTETABLE_INTERFACE_MODULE
 1

	)

783 
	#USING_IP_FORWARD_MIB_INETCIDRROUTETABLE_INETCIDRROUTETABLE_DATA_ACCESS_MODULE
 1

	)

786 
	#USING_IP_FORWARD_MIB_DATA_ACCESS_ROUTE_COMMON_MODULE
 1

	)

789 
	#USING_IP_FORWARD_MIB_DATA_ACCESS_ROUTE_LINUX_MODULE
 1

	)

792 
	#USING_IP_FORWARD_MIB_DATA_ACCESS_ROUTE_IOCTL_MODULE
 1

	)

	@/usr/include/net-snmp/agent/snmp_agent.h

21 #i‚de‡
SNMP_AGENT_H


22 
	#SNMP_AGENT_H


	)

24 #ifde‡
__˝lu•lus


28 
	~<√t-¢mp/libøry/¢mp_im∂.h
>

29 
	~<√t-¢mp/libøry/toﬁs.h
>

30 
	~<√t-¢mp/libøry/d©a_li°.h
>

32 
	#SNMP_MAX_PDU_SIZE
 64000

	)

35 
	#SNMP_AGENT_FLAGS_NONE
 0x0

	)

36 
	#SNMP_AGENT_FLAGS_CANCEL_IN_PROGRESS
 0x1

	)

43 
log_addªs£s
;

49 
œ°AddrAge
;

57 
	s√t¢mp_ªque°_öfo_s
 {

61 
√t¢mp_v¨übÀ_li°
 *
	gªque°vb
;

67 
√t¢mp_d©a_li°
 *
	g∑ª¡_d©a
;

72 
√t¢mp_agít_ªque°_öfo_s
 *
	gagít_ªq_öfo
;

75 
oid
 *
	gønge_íd
;

76 
size_t
 
	gønge_íd_Àn
;

81 
	gdñeg©ed
;

82 
	g¥o˚s£d
;

83 
	gö˛usive
;

85 
	g°©us
;

87 
	gödex
;

90 
	gª≥©
;

91 
	g‹ig_ª≥©
;

92 
√t¢mp_v¨übÀ_li°
 *
	gªque°vb_°¨t
;

95 
√t¢mp_ªque°_öfo_s
 *
	g√xt
;

96 
√t¢mp_ªque°_öfo_s
 *
	g¥ev
;

97 
√t¢mp_subåì_s
 *
	gsubåì
;

98 } 
	t√t¢mp_ªque°_öfo
;

100 
	s√t¢mp_£t_öfo_s
 {

101 
	ga˘i⁄
;

102 *
	g°©eRef
;

107 **
	gﬁdD©a
;

108 
	g£tCÀ™upFœgs
;

109 
	#AUTO_FREE_STATEREF
 0x01

	)

110 
	#AUTO_FREE_OLDDATA
 0x02

	)

111 
	#AUTO_UNDO
 0x03

	)

112 } 
	t√t¢mp_£t_öfo
;

114 
	s√t¢mp_åì_ˇche_s
 {

115 
√t¢mp_subåì_s
 *
	gsubåì
;

116 
√t¢mp_ªque°_öfo
 *
	gªque°s_begö
;

117 
√t¢mp_ªque°_öfo
 *
	gªque°s_íd
;

118 } 
	t√t¢mp_åì_ˇche
;

120 
	#MODE_GET
 
SNMP_MSG_GET


	)

121 
	#MODE_GETNEXT
 
SNMP_MSG_GETNEXT


	)

122 
	#MODE_GETBULK
 
SNMP_MSG_GETBULK


	)

123 
	#MODE_GET_STASH
 
SNMP_MSG_INTERNAL_GET_STASH


	)

124 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


125 
	#MODE_IS_GET
(
x
Ë((x >128Ë&& (x !-1Ë&& (x !
SNMP_MSG_SET
))

	)

127 
	#MODE_IS_GET
(
x
Ë((x >128Ë&& (x !-1))

	)

132 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


133 
	#MODE_SET_BEGIN
 
SNMP_MSG_INTERNAL_SET_BEGIN


	)

134 
	#MODE_SET_RESERVE1
 
SNMP_MSG_INTERNAL_SET_RESERVE1


	)

135 
	#MODE_SET_RESERVE2
 
SNMP_MSG_INTERNAL_SET_RESERVE2


	)

136 
	#MODE_SET_ACTION
 
SNMP_MSG_INTERNAL_SET_ACTION


	)

137 
	#MODE_SET_COMMIT
 
SNMP_MSG_INTERNAL_SET_COMMIT


	)

138 
	#MODE_SET_FREE
 
SNMP_MSG_INTERNAL_SET_FREE


	)

139 
	#MODE_SET_UNDO
 
SNMP_MSG_INTERNAL_SET_UNDO


	)

140 
	#MODE_IS_SET
(
x
Ë((x < 128Ë|| (x =-1Ë|| (x =
SNMP_MSG_SET
))

	)

144 
	#MODE_BSTEP_PRE_REQUEST
 
SNMP_MSG_INTERNAL_PRE_REQUEST


	)

145 
	#MODE_BSTEP_POST_REQUEST
 
SNMP_MSG_INTERNAL_POST_REQUEST


	)

147 
	#MODE_BSTEP_OBJECT_LOOKUP
 
SNMP_MSG_INTERNAL_OBJECT_LOOKUP


	)

148 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


149 
	#MODE_BSTEP_CHECK_VALUE
 
SNMP_MSG_INTERNAL_CHECK_VALUE


	)

150 
	#MODE_BSTEP_ROW_CREATE
 
SNMP_MSG_INTERNAL_ROW_CREATE


	)

151 
	#MODE_BSTEP_UNDO_SETUP
 
SNMP_MSG_INTERNAL_UNDO_SETUP


	)

152 
	#MODE_BSTEP_SET_VALUE
 
SNMP_MSG_INTERNAL_SET_VALUE


	)

153 
	#MODE_BSTEP_CHECK_CONSISTENCY
 
SNMP_MSG_INTERNAL_CHECK_CONSISTENCY


	)

154 
	#MODE_BSTEP_UNDO_SET
 
SNMP_MSG_INTERNAL_UNDO_SET


	)

155 
	#MODE_BSTEP_COMMIT
 
SNMP_MSG_INTERNAL_COMMIT


	)

156 
	#MODE_BSTEP_UNDO_COMMIT
 
SNMP_MSG_INTERNAL_UNDO_COMMIT


	)

157 
	#MODE_BSTEP_IRREVERSIBLE_COMMIT
 
SNMP_MSG_INTERNAL_IRREVERSIBLE_COMMIT


	)

158 
	#MODE_BSTEP_UNDO_CLEANUP
 
SNMP_MSG_INTERNAL_UNDO_CLEANUP


	)

169 
	s√t¢mp_agít_ªque°_öfo_s
 {

170 
	gmode
;

173 
√t¢mp_agít_£ssi⁄_s
 *
	ga•
;

178 
√t¢mp_d©a_li°
 *
	gagít_d©a
;

179 } 
	t√t¢mp_agít_ªque°_öfo
;

181 
	s√t¢mp_ˇchem≠_s
 {

182 
	gglobÆid
;

183 
	gˇcheid
;

184 
√t¢mp_ˇchem≠_s
 *
	g√xt
;

185 } 
	t√t¢mp_ˇchem≠
;

187 
	s√t¢mp_agít_£ssi⁄_s
 {

188 
	gmode
;

189 
√t¢mp_£ssi⁄
 *
	g£ssi⁄
;

190 
√t¢mp_pdu
 *
	gpdu
;

191 
√t¢mp_pdu
 *
	g‹ig_pdu
;

192 
	grw
;

193 
	gexa˘
;

194 
	g°©us
;

195 
	gödex
;

196 
	gﬁdmode
;

198 
√t¢mp_agít_£ssi⁄_s
 *
	g√xt
;

203 
√t¢mp_agít_ªque°_öfo
 *
	gªqöfo
;

204 
√t¢mp_ªque°_öfo
 *
	gªque°s
;

205 
√t¢mp_åì_ˇche
 *
	gåìˇche
;

206 
√t¢mp_v¨übÀ_li°
 **
	gbulkˇche
;

207 
	gåìˇche_Àn
;

208 
	gåìˇche_num
;

209 
√t¢mp_ˇchem≠
 *
	gˇche_°‹e
;

210 
	gvbcou¡
;

211 
	gÊags
;

212 } 
	t√t¢mp_agít_£ssi⁄
;

218 
√t¢mp_addrˇche_öôüli£
();

219 
√t¢mp_addrˇche_de°roy
();

220 
√t¢mp_addrˇche_age
();

226 
h™dÀ_¢mp_∑ckë
(, 
√t¢mp_£ssi⁄
 *, ,

227 
√t¢mp_pdu
 *, *);

228 
¢mp_agít_∑r£_c⁄fig
(*, *);

229 
√t¢mp_agít_£ssi⁄
 *
öô_agít_¢mp_£ssi⁄
(
√t¢mp_£ssi⁄
 *,

230 
√t¢mp_pdu
 *);

231 
‰ì_agít_¢mp_£ssi⁄
(
√t¢mp_agít_£ssi⁄
 *);

233 
√t¢mp_ªmove_™d_‰ì_agít_¢mp_£ssi⁄
(
√t¢mp_agít_£ssi⁄


234 *
a•
);

235 #ifde‡
SNMP_NEED_REQUEST_LIST


237 
√t¢mp_‰ì_agít_¢mp_£ssi⁄_by_£ssi⁄
(
√t¢mp_£ssi⁄
 * 
£ss
,

238 (*
‰ì_ªque°
)

239 (
√t¢mp_ªque°_li°


242 
gëNextSessID
();

243 
dump_£ss_li°
();

244 
öô_ma°î_agít
();

245 
shutdown_ma°î_agít
();

246 
agít_check_™d_¥o˚ss
(
block
);

247 
√t¢mp_check_dñeg©ed_ªque°s
();

248 
√t¢mp_check_out°™dög_agít_ªque°s
();

250 
√t¢mp_ªque°_£t_îr‹
(
√t¢mp_ªque°_öfo
 *
ªque°
,

251 
îr‹_vÆue
);

252 
√t¢mp_check_ªque°s_îr‹
(
√t¢mp_ªque°_öfo
 *
ªqs
);

253 
√t¢mp_check_Æl_ªque°s_îr‹
(
√t¢mp_agít_£ssi⁄
 *
a•
,

254 
look_f‹_•ecific
);

256 
√t¢mp_£t_Æl_ªque°s_îr‹
(
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
,

257 
√t¢mp_ªque°_öfo
 *
ªque°s
,

258 
îr‹_vÆue
);

259 
√t¢mp_ªque°_£t_îr‹_idx
(
√t¢mp_ªque°_öfo
 *
ªque°s
,

260 
îr‹_vÆue
, 
idx
);

262 
√t¢mp_ªque°_£t_îr‹_Æl
(
√t¢mp_ªque°_öfo
 *
ªque°s
,

263 
îr‹_vÆue
);

266 
√t¢mp_£t_ªque°_îr‹
(
√t¢mp_agít_ªque°_öfo


267 *
ªqöfo
,

268 
√t¢mp_ªque°_öfo


269 *
ªque°
, 
îr‹_vÆue
);

271 
√t¢mp_£t_mode_ªque°_îr‹
(
mode
,

272 
√t¢mp_ªque°_öfo


273 *
ªque°
,

274 
îr‹_vÆue
);

276 
u_l⁄g
 
√t¢mp_m¨kî_u±ime
(
m¨kî_t
 
pm
);

277 
u_l⁄g
 
√t¢mp_timevÆ_u±ime
(
timevÆ
 *
tv
);

278 
c⁄°_m¨kî_t
 
√t¢mp_gë_agít_°¨âime
();

279 
uöt64_t
 
√t¢mp_gë_agít_ru¡ime
();

280 
√t¢mp_£t_agít_°¨âime
(
m¨kî_t
 
s
);

281 
u_l⁄g
 
√t¢mp_gë_agít_u±ime
();

282 
√t¢mp_£t_agít_u±ime
(
u_l⁄g
 
h£c
);

283 
√t¢mp_check_å™ß˘i⁄_id
(
å™ß˘i⁄_id
);

284 
√t¢mp_agít_check_∑ckë
(
√t¢mp_£ssi⁄
 *,

285 
√t¢mp_å™•‹t_s


287 
√t¢mp_agít_check_∑r£
(
√t¢mp_£ssi⁄
 *,

288 
√t¢mp_pdu
 *, );

289 
√t¢mp_Æloˇã_globÆˇcheid
();

291 
√t¢mp_ªmove_dñeg©ed_ªque°s_f‹_£ssi⁄
(
√t¢mp_£ssi⁄
 *
£ss
);

297 
	g√t¢mp_å™•‹t_s
;

299 
√t¢mp_ªgi°î_agít_nßp
(
√t¢mp_å™•‹t_s


300 *
t
);

301 
√t¢mp_dîegi°î_agít_nßp
(
h™dÀ
);

304 
√t¢mp_agít_add_li°_d©a
(
√t¢mp_agít_ªque°_öfo
 *
agít
,

305 
√t¢mp_d©a_li°
 *
node
);

308 
√t¢mp_agít_ªmove_li°_d©a
(
√t¢mp_agít_ªque°_öfo
 *
¨i
,

309 c⁄° * 
«me
);

312 
√t¢mp_agít_gë_li°_d©a
(
√t¢mp_agít_ªque°_öfo


313 *
agít
, c⁄° *
«me
);

316 
√t¢mp_‰ì_agít_d©a_£t
(
√t¢mp_agít_ªque°_öfo
 *
agít
);

319 
√t¢mp_‰ì_agít_d©a_£ts
(
√t¢mp_agít_ªque°_öfo
 *
agít
);

321 
√t¢mp_‰ì_agít_ªque°_öfo
(
√t¢mp_agít_ªque°_öfo
 *
¨i
);

323 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/var_struct.h

1 #i‚de‡
VAR_STRUCT_H


2 
	#VAR_STRUCT_H


	)

13 
	#UCD_REGISTRY_OID_MAX_LEN
 128

	)

18 
	#FULLY_QUALIFIED_INSTANCE
 0x01

	)

19 
	#SUBTREE_ATTACHED
 0x02

	)

21 
	s√t¢mp_subåì_s
 {

22 
oid
 *
	m«me_a
;

23 
u_ch¨
 
	m«mñí
;

24 
oid
 *
	m°¨t_a
;

25 
u_ch¨
 
	m°¨t_Àn
;

26 
oid
 *
	míd_a
;

27 
u_ch¨
 
	míd_Àn
;

28 
v¨übÀ
 *
	mv¨übÀs
;

29 
	mv¨übÀs_Àn
;

30 
	mv¨übÀs_width
;

31 *
	mœbñ_a
;

32 
√t¢mp_£ssi⁄
 *
	m£ssi⁄
;

33 
u_ch¨
 
	mÊags
;

34 
u_ch¨
 
	m¥i‹ôy
;

35 
	mtimeout
;

36 
√t¢mp_subåì_s
 *
	m√xt
;

37 
√t¢mp_subåì_s
 *
	m¥ev
;

38 
√t¢mp_subåì_s
 *
	mchûdªn
;

39 
	mønge_subid
;

40 
oid
 
	mønge_ubound
;

41 
√t¢mp_h™dÀr_ªgi°øti⁄
 *
	mªgöfo
;

42 
	mˇcheid
;

43 
	mglobÆ_ˇcheid
;

44 
size_t
 
	moid_off
;

45 } 
	t√t¢mp_subåì
;

54 
	sv¨übÀ1
 {

55 
u_ch¨
 
	mmagic
;

56 
u_ch¨
 
	mty≥
;

57 
u_sh‹t
 
	ma˛
;

58 
FödV¨Mëhod
 *
	mfödV¨
;

59 
u_ch¨
 
	m«mñí
;

60 
oid
 
	m«me
[1];

63 
	sv¨übÀ2
 {

64 
u_ch¨
 
	mmagic
;

65 
u_ch¨
 
	mty≥
;

66 
u_sh‹t
 
	ma˛
;

67 
FödV¨Mëhod
 *
	mfödV¨
;

68 
u_ch¨
 
	m«mñí
;

69 
oid
 
	m«me
[2];

72 
	sv¨übÀ3
 {

73 
u_ch¨
 
	mmagic
;

74 
u_ch¨
 
	mty≥
;

75 
u_sh‹t
 
	ma˛
;

76 
FödV¨Mëhod
 *
	mfödV¨
;

77 
u_ch¨
 
	m«mñí
;

78 
oid
 
	m«me
[3];

81 
	sv¨übÀ4
 {

82 
u_ch¨
 
	mmagic
;

83 
u_ch¨
 
	mty≥
;

84 
u_sh‹t
 
	ma˛
;

85 
FödV¨Mëhod
 *
	mfödV¨
;

86 
u_ch¨
 
	m«mñí
;

87 
oid
 
	m«me
[4];

90 
	sv¨übÀ7
 {

91 
u_ch¨
 
	mmagic
;

92 
u_ch¨
 
	mty≥
;

93 
u_sh‹t
 
	ma˛
;

94 
FödV¨Mëhod
 *
	mfödV¨
;

95 
u_ch¨
 
	m«mñí
;

96 
oid
 
	m«me
[7];

99 
	sv¨übÀ8
 {

100 
u_ch¨
 
	mmagic
;

101 
u_ch¨
 
	mty≥
;

102 
u_sh‹t
 
	ma˛
;

103 
FödV¨Mëhod
 *
	mfödV¨
;

104 
u_ch¨
 
	m«mñí
;

105 
oid
 
	m«me
[8];

108 
	sv¨übÀ13
 {

109 
u_ch¨
 
	mmagic
;

110 
u_ch¨
 
	mty≥
;

111 
u_sh‹t
 
	ma˛
;

112 
FödV¨Mëhod
 *
	mfödV¨
;

113 
u_ch¨
 
	m«mñí
;

114 
oid
 
	m«me
[13];

	@/usr/include/net-snmp/config_api.h

1 #i‚de‡
NET_SNMP_CONFIG_API_H


2 
	#NET_SNMP_CONFIG_API_H


	)

9 
	~<√t-¢mp/ty≥s.h
>

11 #ifde‡
__˝lu•lus


16 
NETSNMP_IMPORT


17 
c⁄fig_löe
 *
ªgi°î_c⁄fig_h™dÀr
(c⁄° *
fûePªfix
,

18 c⁄° *
tokí
,

19 (*
∑r£r
) (const *, *),

20 (*
ªÀa£r
) (),

21 c⁄° *
ußgeLöe
);

22 
NETSNMP_IMPORT


23 
c⁄fig_löe
 *
ªgi°î_c⁄°_c⁄fig_h™dÀr
(c⁄° *
fûePªfix
,

24 c⁄° *
tokí
,

25 (*
∑r£r
) (const *, const *),

26 (*
ªÀa£r
) (),

27 c⁄° *
ußgeLöe
);

28 
NETSNMP_IMPORT


29 
c⁄fig_löe
 *
ªgi°î_¥íë¢mp_mib_h™dÀr
(c⁄° *
fûePªfix
,

30 c⁄° *
tokí
,

31 (*
∑r£r
) (const *, *),

32 (*
ªÀa£r
) (),

33 c⁄° *
ußgeLöe
);

34 
NETSNMP_IMPORT


35 
uƒegi°î_c⁄fig_h™dÀr
(c⁄° *
fûePªfix
, c⁄° *
tokí
);

38 
ªgi°î_mib_h™dÀrs
();

39 
uƒegi°î_Æl_c⁄fig_h™dÀrs
();

42 
NETSNMP_IMPORT


43 
c⁄fig_löe
 *
ªgi°î_≠p_c⁄fig_h™dÀr
(

44 c⁄° *
tokí
,

45 (*
∑r£r
) (const *, *),

46 (*
ªÀa£r
) (),

47 c⁄° *
ußgeLöe
);

49 
NETSNMP_IMPORT


50 
c⁄fig_löe
 *
ªgi°î_≠p_¥íë¢mp_mib_h™dÀr
(

51 c⁄° *
tokí
,

52 (*
∑r£r
) (const *, *),

53 (*
ªÀa£r
) (),

54 c⁄° *
ußgeLöe
);

55 
NETSNMP_IMPORT


56 
uƒegi°î_≠p_c⁄fig_h™dÀr
–c⁄° *
tokí
);

59 
NETSNMP_IMPORT


60 
ªad_c⁄figs
();

61 
NETSNMP_IMPORT


62 
ªad_¥emib_c⁄figs
();

65 
NETSNMP_IMPORT


66 
ªad_c⁄fig_¥öt_ußge
(c⁄° *
Àad
);

67 
NETSNMP_IMPORT


68 
c⁄fig_≥º‹
(const *);

69 
NETSNMP_IMPORT


70 
c⁄fig_pw¨n
(const *);

72 #ifde‡
__˝lu•lus


90 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

92 
	~<√t-¢mp/libøry/ªad_c⁄fig.h
>

93 
	~<√t-¢mp/libøry/deÁu…_°‹e.h
>

95 
	~<°dio.h
>

96 
	~<√t-¢mp/libøry/¢mp_∑r£_¨gs.h
>

97 
	~<√t-¢mp/libøry/¢mp_íum.h
>

98 
	~<√t-¢mp/libøry/vacm.h
>

	@/usr/include/net-snmp/definitions.h

1 #i‚de‡
NET_SNMP_DEFINITIONS_H


2 
	#NET_SNMP_DEFINITIONS_H


	)

8 
	#MAX_OID_LEN
 128

	)

10 
	#ONE_SEC
 1000000L

	)

22 
	~<√t-¢mp/ty≥s.h
>

23 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

24 
	~<√t-¢mp/libøry/a¢1.h
>

25 
	~<√t-¢mp/libøry/¢mp_im∂.h
>

26 
	~<√t-¢mp/libøry/¢mp.h
>

27 
	~<√t-¢mp/libøry/¢mp-tc.h
>

	@/usr/include/net-snmp/library/getopt.h

1 #i‚de‡
_GETOPT_H_


2 
	#_GETOPT_H_
 1

	)

4 #i‚de‡
NET_SNMP_CONFIG_H


5 #îr‹ <
√t
-
¢mp
/√t-¢mp-
c⁄fig
.
h
> 
mu°
 
be
 
ö˛uded
 
bef‹e
 <√t-¢mp/
libøry
/
gë›t
.h>.

8 #i‡!
deföed
(
HAVE_GETOPT_H
)

10 #ifde‡
__˝lu•lus


14 
NETSNMP_IMPORT
 
gë›t
(, *const *, const *);

15 
NETSNMP_IMPORT
 *
›èrg
;

16 
NETSNMP_IMPORT
 
›töd
, 
›ãº
, 
›t›t
, 
›åe£t
;

18 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/mib_api.h

1 #i‚de‡
NET_SNMP_MIB_API_H


2 
	#NET_SNMP_MIB_API_H


	)

8 
	~<√t-¢mp/ty≥s.h
>

10 #ifde‡
__˝lu•lus


15 
NETSNMP_IMPORT


16 
add_mibdú
(const *);

18 
NETSNMP_IMPORT


19 
√t¢mp_öô_mib
();

20 #i‚de‡
NETSNMP_NO_LEGACY_DEFINITIONS


21 
NETSNMP_IMPORT


22 
öô_mib
();

23 
NETSNMP_IMPORT


24 
öô_mib_öã∫Æs
();

26 
NETSNMP_IMPORT


27 
shutdown_mib
();

30 
NETSNMP_IMPORT


31 
åì
 *
√t¢mp_ªad_moduÀ
(const *);

32 #i‚de‡
NETSNMP_NO_LEGACY_DEFINITIONS


33 
NETSNMP_IMPORT


34 
åì
 *
ªad_moduÀ
(const *);

37 
NETSNMP_IMPORT


38 
åì
 *
ªad_mib
(const *);

39 
NETSNMP_IMPORT


40 
åì
 *
ªad_Æl_mibs
();

42 
NETSNMP_IMPORT


43 
add_moduÀ_ª∂a˚mít
(const *, const *,

47 
NETSNMP_IMPORT


48 
¢mp_£t_mib_w¨nögs
();

49 
NETSNMP_IMPORT


50 
¢mp_£t_mib_îr‹s
();

51 
NETSNMP_IMPORT


52 
¢mp_£t_ßve_des¸ùti⁄s
();

56 
NETSNMP_IMPORT


57 
ªad_objid
(c⁄° *, 
oid
 *, 
size_t
 *);

58 
NETSNMP_IMPORT


59 
oid
 *
¢mp_∑r£_oid
(c⁄° *, oid *, 
size_t
 *);

60 
NETSNMP_IMPORT


61 
gë_moduÀ_node
(c⁄° *, c⁄° *, 
oid
 *, 
size_t
 *);

64 
NETSNMP_IMPORT


65 
¥öt_mib
(
FILE
 * 
Â
);

67 
NETSNMP_IMPORT


68 
¥öt_objid
(c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
);

69 
NETSNMP_IMPORT


70 
Âröt_objid
(
FILE
 * 
Â
,

71 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
);

72 
NETSNMP_IMPORT


73 
¢¥öt_objid
(*
buf
, 
size_t
 
buf_Àn
,

74 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
);

76 
NETSNMP_IMPORT


77 
¥öt_des¸ùti⁄
(
oid
 * 
objid
, 
size_t
 
objidÀn
, 
width
);

78 
NETSNMP_IMPORT


79 
Âröt_des¸ùti⁄
(
FILE
 * 
Â
,

80 
oid
 * 
objid
, 
size_t
 
objidÀn
, 
width
);

81 
NETSNMP_IMPORT


82 
¢¥öt_des¸ùti⁄
(*
buf
, 
size_t
 
buf_Àn
,

83 
oid
 * 
objid
, 
size_t
 
objidÀn
, 
width
);

85 #ifde‡
__˝lu•lus


104 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

105 
	~<√t-¢mp/libøry/mib.h
>

106 #i‚de‡
NETSNMP_DISABLE_MIB_LOADING


107 
	~<√t-¢mp/libøry/∑r£.h
>

109 
	~<√t-¢mp/libøry/ˇŒback.h
>

110 
	~<√t-¢mp/libøry/oid_°ash.h
>

111 
	~<√t-¢mp/libøry/ucd_com∑t.h
>

	@/usr/include/net-snmp/output_api.h

1 #i‚de‡
NET_SNMP_OUTPUT_API_H


2 
	#NET_SNMP_OUTPUT_API_H


	)

9 
	~<√t-¢mp/ty≥s.h
>

10 
	~<°d¨g.h
>

12 #ifde‡
__˝lu•lus


17 
NETSNMP_IMPORT


18 
¢mp_îr‹
(
√t¢mp_£ssi⁄
 *
£ss
, *
˛ib_îr‹no
,

19 *
¢mp_îr‹no
, **
îr°rög
);

20 
NETSNMP_IMPORT


21 
¢mp_£ss_îr‹
–*
£ss
, *
˛ib_îr‹no
,

22 *
¢mp_îr‹no
, **
îr°rög
);

24 
NETSNMP_IMPORT


25 c⁄° *
¢mp_≠i_îr°rög
(
¢mp_îr‹no
);

26 
NETSNMP_IMPORT


27 c⁄° *
¢mp_îr°rög
(
¢mp_îr‹no
);

29 
NETSNMP_IMPORT


30 
¢mp_≥º‹
(c⁄° *
msg
);

32 
NETSNMP_IMPORT


33 
¢mp_£ss_≥º‹
(c⁄° *
msg
, 
√t¢mp_£ssi⁄
 *
£ss
);

35 
NETSNMP_IMPORT


36 
¢mp_log_≥º‹
(c⁄° *
msg
);

41 #i‡!
deföed
(
__GNUC__
Ë|| __GNUC__ < 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 < 8)

42 
	#_LOG_ATTR


	)

44 
	#_LOG_ATTR
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)))

	)

47 
NETSNMP_IMPORT


48 
¢mp_log
–
¥i‹ôy
, c⁄° *
f‹m©
, ...Ë
_LOG_ATTR
;

49 
NETSNMP_IMPORT


50 
¢mp_vlog
(
¥i‹ôy
, c⁄° *
f‹m©
, 
va_li°
 
≠
);

51 
NETSNMP_IMPORT


52 
¢mp_gë_do_loggög
( );

53 
NETSNMP_IMPORT


54 
√t¢mp_loggög_ª°¨t
();

55 
NETSNMP_IMPORT


56 
¢mp_dißbÀ_log
( );

57 
NETSNMP_IMPORT


58 
shutdown_¢mp_loggög
( );

60 #unde‡
_LOG_ATTR


63 #i‚de‡
NETSNMP_NO_DEBUGGING


64 
	~<√t-¢mp/libøry/¢mp_debug.h
>

65 
	#DEBUGMSG
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
debugmsg
 x;} }0)

	)

66 
	#DEBUGMSGT
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGT
(x);} }0)

	)

67 
	#DEBUGTRACE
 dÿ{i‡(
_DBG_IF_
Ë{
__DBGTRACE
;} }0)

	)

68 
	#DEBUGTRACETOK
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGTRACETOK
(x);} }0)

	)

69 
	#DEBUGMSGL
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGL
(x);} }0)

	)

70 
	#DEBUGMSGTL
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGTL
(x);} }0)

	)

71 
	#DEBUGMSGOID
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGOID
(x);} }0)

	)

72 
	#DEBUGMSGSUBOID
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGSUBOID
(x);} }0)

	)

73 
	#DEBUGMSGVAR
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGVAR
(x);} }0)

	)

74 
	#DEBUGMSGOIDRANGE
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGOIDRANGE
(x);} }0)

	)

75 
	#DEBUGMSGHEX
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGHEX
(x);} }0)

	)

76 
	#DEBUGMSGHEXTLI
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGMSGHEXTLI
(x);} }0)

	)

77 
	#DEBUGINDENTADD
(
x
Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGINDENTADD
(x);} }0)

	)

78 
	#DEBUGINDENTMORE
(Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGINDENTMORE
();} }0)

	)

79 
	#DEBUGINDENTLESS
(Ëdÿ{i‡(
_DBG_IF_
Ë{
	`__DBGINDENTLESS
();} }0)

	)

80 
	#DEBUGPRINTINDENT
(
tokí
) \

81 dÿ{i‡(
_DBG_IF_
Ë{
	`__DBGPRINTINDENT
(
tokí
);} }0)

	)

82 
	#DEBUGDUMPHEADER
(
tokí
,
x
) \

83 dÿ{i‡(
_DBG_IF_
Ë{
	`__DBGDUMPHEADER
(
tokí
,
x
);} }0)

	)

84 
	#DEBUGDUMPSECTION
(
tokí
,
x
) \

85 dÿ{i‡(
_DBG_IF_
Ë{
	`__DBGDUMPSECTION
(
tokí
,
x
);} }0)

	)

86 
	#DEBUGDUMPSETUP
(
tokí
,
buf
,
Àn
) \

87 dÿ{i‡(
_DBG_IF_
Ë{
	`__DBGDUMPSETUP
(
tokí
,
buf
,
Àn
);} }0)

	)

88 
	#DEBUGMSG_NC
(
x
Ëdÿ{ 
	`__DBGMSG_NC
(x); }0)

	)

89 
	#DEBUGMSGT_NC
(
x
Ëdÿ{ 
	`__DBGMSGT_NC
(x); }0)

	)

93 
	#DEBUGMSG
(
x
)

	)

94 
	#DEBUGMSGT
(
x
)

	)

95 
	#DEBUGTRACE


	)

96 
	#DEBUGTRACETOK
(
x
)

	)

97 
	#DEBUGMSGL
(
x
)

	)

98 
	#DEBUGMSGTL
(
x
)

	)

99 
	#DEBUGMSGOID
(
x
)

	)

100 
	#DEBUGMSGSUBOID
(
x
)

	)

101 
	#DEBUGMSGVAR
(
x
)

	)

102 
	#DEBUGMSGOIDRANGE
(
x
)

	)

103 
	#DEBUGMSGHEX
(
x
)

	)

104 
	#DEBUGIF
(
x
Ëif(0)

	)

105 
	#DEBUGDUMP
(
t
,
b
,
l
,
p
)

	)

106 
	#DEBUGINDENTMORE
()

	)

107 
	#DEBUGINDENTLESS
()

	)

108 
	#DEBUGINDENTADD
(
x
)

	)

109 
	#DEBUGMSGHEXTLI
(
x
)

	)

110 
	#DEBUGPRINTINDENT
(
tokí
)

	)

111 
	#DEBUGDUMPHEADER
(
tokí
,
x
)

	)

112 
	#DEBUGDUMPSECTION
(
tokí
,
x
)

	)

113 
	#DEBUGDUMPSETUP
(
tokí
, 
buf
, 
Àn
)

	)

115 
	#DEBUGMSG_NC
(
x
)

	)

116 
	#DEBUGMSGT_NC
(
x
)

	)

120 
NETSNMP_IMPORT


121 
debug_ªgi°î_tokís
(c⁄° *
tokís
);

122 
NETSNMP_IMPORT


123 
debug_is_tokí_ªgi°îed
(c⁄° *
tokí
);

124 
NETSNMP_IMPORT


125 
¢mp_£t_do_debuggög
();

126 
NETSNMP_IMPORT


127 
¢mp_gë_do_debuggög
();

144 #ifde‡
__˝lu•lus


148 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

149 
	~<√t-¢mp/libøry/¢mp_˛õ¡.h
>

150 
	~<√t-¢mp/libøry/¢mp_debug.h
>

151 
	~<√t-¢mp/libøry/¢mp_loggög.h
>

153 #i‚de‡
ERROR_MSG


154 
	#ERROR_MSG
(
°rög
Ë
	`¢mp_£t_dëaû
(°rög)

	)

	@/usr/include/net-snmp/pdu_api.h

1 #i‚de‡
NET_SNMP_PDU_API_H


2 
	#NET_SNMP_PDU_API_H


	)

8 
	~<√t-¢mp/ty≥s.h
>

10 #ifde‡
__˝lu•lus


14 
NETSNMP_IMPORT


15 
√t¢mp_pdu
 *
¢mp_pdu_¸óã
(
ty≥
);

16 
NETSNMP_IMPORT


17 
√t¢mp_pdu
 *
¢mp_˛⁄e_pdu
“ë¢mp_pdu *
pdu
);

18 
NETSNMP_IMPORT


19 
√t¢mp_pdu
 *
¢mp_fix_pdu
–√t¢mp_pdu *
pdu
, 
idx
);

20 
NETSNMP_IMPORT


21 
¢mp_‰ì_pdu
–
√t¢mp_pdu
 *
pdu
);

23 #ifde‡
__˝lu•lus


42 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

43 
	~<√t-¢mp/libøry/¢mp_˛õ¡.h
>

44 
	~<√t-¢mp/libøry/a¢1.h
>

	@/usr/include/net-snmp/session_api.h

1 #i‚de‡
NET_SNMP_SESSION_API_H


2 
	#NET_SNMP_SESSION_API_H


	)

9 
	~<√t-¢mp/ty≥s.h
>

11 #ifde‡
__˝lu•lus


15 
NETSNMP_IMPORT


16 
¢mp_£ss_öô
(
√t¢mp_£ssi⁄
 *);

28 
NETSNMP_IMPORT


29 
√t¢mp_£ssi⁄
 *
¢mp_›í
(netsnmp_session *);

41 
NETSNMP_IMPORT


42 
¢mp_˛o£
(
√t¢mp_£ssi⁄
 *);

43 
NETSNMP_IMPORT


44 
¢mp_˛o£_£ssi⁄s
();

60 
NETSNMP_IMPORT


61 
¢mp_£nd
(
√t¢mp_£ssi⁄
 *, 
√t¢mp_pdu
 *);

79 
NETSNMP_IMPORT


80 
¢mp_async_£nd
(
√t¢mp_£ssi⁄
 *, 
√t¢mp_pdu
 *,

81 
√t¢mp_ˇŒback
, *);

94 
NETSNMP_IMPORT


95 
¢mp_ªad
(
fd_£t
 *);

102 
NETSNMP_IMPORT


103 
¢mp_ªad2
(
√t¢mp_œrge_fd_£t
 *);

106 
NETSNMP_IMPORT


107 
¢mp_synch_ª•⁄£
(
√t¢mp_£ssi⁄
 *, 
√t¢mp_pdu
 *,

108 
√t¢mp_pdu
 **);

137 
NETSNMP_IMPORT


138 
¢mp_£À˘_öfo
(*, 
fd_£t
 *, 
timevÆ
 *,

146 
NETSNMP_IMPORT


147 
¢mp_£À˘_öfo2
(*, 
√t¢mp_œrge_fd_£t
 *,

148 
timevÆ
 *, *);

150 
	#NETSNMP_SELECT_NOFLAGS
 0x00

	)

151 
	#NETSNMP_SELECT_NOALARMS
 0x01

	)

152 
NETSNMP_IMPORT


153 
¢mp_£ss_£À˘_öfo_Êags
(*, *, 
fd_£t
 *,

154 
timevÆ
 *, *, );

155 
¢mp_£ss_£À˘_öfo2_Êags
(*, *,

156 
√t¢mp_œrge_fd_£t
 *,

157 
timevÆ
 *, *, );

171 
NETSNMP_IMPORT


172 
¢mp_timeout
();

212 
NETSNMP_IMPORT


213 *
¢mp_£ss_›í
(
√t¢mp_£ssi⁄
 *);

214 
NETSNMP_IMPORT


215 *
¢mp_£ss_poöãr
(
√t¢mp_£ssi⁄
 *);

216 
NETSNMP_IMPORT


217 
√t¢mp_£ssi⁄
 *
¢mp_£ss_£ssi⁄
(*);

218 
NETSNMP_IMPORT


219 
√t¢mp_£ssi⁄
 *
¢mp_£ss_£ssi⁄_lookup
(*);

226 
NETSNMP_IMPORT


227 
¢mp_£ss_£nd
(*, 
√t¢mp_pdu
 *);

228 
NETSNMP_IMPORT


229 
¢mp_£ss_async_£nd
(*, 
√t¢mp_pdu
 *,

230 
√t¢mp_ˇŒback
, *);

231 
NETSNMP_IMPORT


232 
¢mp_£ss_£À˘_öfo
(*, *, 
fd_£t
 *,

233 
timevÆ
 *, *);

234 
NETSNMP_IMPORT


235 
¢mp_£ss_£À˘_öfo2
(*, *,

236 
√t¢mp_œrge_fd_£t
 *,

237 
timevÆ
 *, *);

241 
NETSNMP_IMPORT


242 
¢mp_£ss_ªad
(*, 
fd_£t
 *);

247 
NETSNMP_IMPORT


248 
¢mp_£ss_ªad2
(*,

249 
√t¢mp_œrge_fd_£t
 *);

250 
NETSNMP_IMPORT


251 
¢mp_£ss_timeout
(*);

252 
NETSNMP_IMPORT


253 
¢mp_£ss_˛o£
(*);

255 
NETSNMP_IMPORT


256 
¢mp_£ss_synch_ª•⁄£
(*, 
√t¢mp_pdu
 *,

257 
√t¢mp_pdu
 **);

259 #ifde‡
__˝lu•lus


279 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

280 
	~<√t-¢mp/libøry/¢mp_˛õ¡.h
>

281 
	~<√t-¢mp/libøry/a¢1.h
>

282 
	~<√t-¢mp/libøry/ˇŒback.h
>

284 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

285 
	~<√t-¢mp/libøry/¢mp_£rvi˚.h
>

286 
	~<√t-¢mp/libøry/¢mpCÆlbackDomaö.h
>

287 #ifde‡
NETSNMP_TRANSPORT_UNIX_DOMAIN


288 
	~<√t-¢mp/libøry/¢mpUnixDomaö.h
>

290 #ifde‡
NETSNMP_TRANSPORT_UDP_DOMAIN


291 
	~<√t-¢mp/libøry/¢mpUDPDomaö.h
>

293 #ifde‡
NETSNMP_TRANSPORT_TCP_DOMAIN


294 
	~<√t-¢mp/libøry/¢mpTCPDomaö.h
>

296 #ifde‡
NETSNMP_TRANSPORT_UDPIPV6_DOMAIN


297 
	~<√t-¢mp/libøry/¢mpUDPIPv6Domaö.h
>

299 #ifde‡
NETSNMP_TRANSPORT_TCPIPV6_DOMAIN


300 
	~<√t-¢mp/libøry/¢mpTCPIPv6Domaö.h
>

302 #ifde‡
NETSNMP_TRANSPORT_IPX_DOMAIN


303 
	~<√t-¢mp/libøry/¢mpIPXDomaö.h
>

305 #ifde‡
NETSNMP_TRANSPORT_AAL5PVC_DOMAIN


306 
	~<√t-¢mp/libøry/¢mpAAL5PVCDomaö.h
>

309 
	~<√t-¢mp/libøry/ucd_com∑t.h
>

	@/usr/include/net-snmp/snmpv3_api.h

1 #i‚de‡
NET_SNMP_SNMPV3_H


2 
	#NET_SNMP_SNMPV3_H


	)

11 
	~<√t-¢mp/ty≥s.h
>

23 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

25 
	~<√t-¢mp/libøry/ˇŒback.h
>

26 
	~<√t-¢mp/libøry/¢mpv3.h
>

27 
	~<√t-¢mp/libøry/å™sf‹m_oids.h
>

28 
	~<√t-¢mp/libøry/keytoﬁs.h
>

29 
	~<√t-¢mp/libøry/sˇpi.h
>

30 
	~<√t-¢mp/libøry/lcd_time.h
>

31 #ifde‡
NETSNMP_USE_INTERNAL_MD5


32 
	~<√t-¢mp/libøry/md5.h
>

35 
	~<√t-¢mp/libøry/¢mp_£cmod.h
>

36 
	~<√t-¢mp/libøry/¢mpv3-£curôy-ö˛udes.h
>

	@/usr/include/net-snmp/types.h

1 #i‚de‡
NET_SNMP_TYPES_H


2 
	#NET_SNMP_TYPES_H


	)

8 
	~<°dio.h
>

10 #i‚de‡
NET_SNMP_CONFIG_H


17 #i‡
TIME_WITH_SYS_TIME


18 
	~<sys/time.h
>

19 
	~<time.h
>

21 #i‡
HAVE_SYS_TIME_H


22 
	~<sys/time.h
>

24 
	~<time.h
>

28 #ifde‡
HAVE_INTTYPES_H


29 
	~<öây≥s.h
>

31 
	~<sys/ty≥s.h
>

37 #i‡
deföed
(
HAVE_WINSOCK2_H
Ë&& deföed(
HAVE_WS2TCPIP_H
)

38 #i‡!
deföed
(
HAVE_WIN32_PLATFORM_SDK
Ë&& 
_MSC_VER
 -0 <= 1200 \

39 && 
	g_WIN32_WINNT
 -0 >= 0x0400

47 
	~<wödows.h
>

49 
	~<wösock2.h
>

51 
	~<ws2t˝ù.h
>

52 #ñi‡
deföed
(
HAVE_WINSOCK_H
)

53 
	~<wösock.h
>

57 #i‡
deföed
(
WIN32
Ë&& !deföed(
cygwö
)

58 
HANDLE
 
	t√t¢mp_pid_t
;

59 
	#NETSNMP_NO_SUCH_PROCESS
 
INVALID_HANDLE_VALUE


	)

66 
pid_t
 
	t√t¢mp_pid_t
;

67 
	#NETSNMP_NO_SUCH_PROCESS
 -1

	)

70 #i‡
HAVE_NETINET_IN_H


71 
	~<√töë/ö.h
>

74 
	~<√t-¢mp/libøry/oid.h
>

76 #ifde‡
__˝lu•lus


80 #i‚de‡
HAVE_SOCKLEN_T


81 
u_öt
 
	tsockÀn_t
;

84 #i‚de‡
HAVE_IN_ADDR_T


89 
u_l⁄g
 
	tö_addr_t
;

92 #i‚de‡
HAVE_SSIZE_T


93 #i‡
deföed
(
__INT_MAX__
) && __INT_MAX__ == 2147483647

94 
	tssize_t
;

96 
	tssize_t
;

100 #i‚de‡
HAVE_NFDS_T


101 
	tnfds_t
;

115 *
	göãgî
;

116 
u_ch¨
 *
	g°rög
;

117 
oid
 *
	gobjid
;

118 
u_ch¨
 *
	gbô°rög
;

119 
cou¡î64
 *
	gcou¡î64
;

120 #ifde‡
NETSNMP_WITH_OPAQUE_SPECIAL_TYPES


121 *
	gÊﬂtVÆ
;

122 *
	gdoubÀVÆ
;

127 } 
	t√t¢mp_v¨d©a
;

130 
	#MAX_OID_LEN
 128

	)

138 
	sv¨übÀ_li°
 {

140 
v¨übÀ_li°
 *
	g√xt_v¨übÀ
;

142 
oid
 *
	g«me
;

144 
size_t
 
	g«me_Àngth
;

146 
u_ch¨
 
	gty≥
;

148 
√t¢mp_v¨d©a
 
	gvÆ
;

150 
size_t
 
	gvÆ_Àn
;

152 
oid
 
	g«me_loc
[
MAX_OID_LEN
];

154 
u_ch¨
 
	gbuf
[40];

156 *
	gd©a
;

158 (*
	gd©aFªeHook
)(*);

159 
	gödex
;

160 } 
	t√t¢mp_v¨übÀ_li°
;

168 
	s¢mp_pdu
 {

170 
	#n⁄_ª≥©îs
 
îr°©


	)

171 
	#max_ª≥tôi⁄s
 
îrödex


	)

177 
	gvîsi⁄
;

179 
	gcomm™d
;

181 
	gªqid
;

183 
	gmsgid
;

185 
	gå™sid
;

187 
	g£ssid
;

189 
	gîr°©
;

191 
	gîrödex
;

193 
u_l⁄g
 
	gtime
;

194 
u_l⁄g
 
	gÊags
;

196 
	g£curôyModñ
;

198 
	g£curôyLevñ
;

199 
	gmsgP¨£Modñ
;

206 *
	gå™•‹t_d©a
;

207 
	gå™•‹t_d©a_Àngth
;

213 c⁄° 
oid
 *
	gtDomaö
;

214 
size_t
 
	gtDomaöLí
;

216 
√t¢mp_v¨übÀ_li°
 *
	gv¨übÀs
;

223 
u_ch¨
 *
	gcommunôy
;

225 
size_t
 
	gcommunôy_Àn
;

231 
oid
 *
	gíãΩri£
;

232 
size_t
 
	gíãΩri£_Àngth
;

234 
	gå≠_ty≥
;

236 
	g•ecific_ty≥
;

238 
	gagít_addr
[4];

244 
u_ch¨
 *
	gc⁄ãxtEngöeID
;

246 
size_t
 
	gc⁄ãxtEngöeIDLí
;

248 *
	gc⁄ãxtName
;

250 
size_t
 
	gc⁄ãxtNameLí
;

252 
u_ch¨
 *
	g£curôyEngöeID
;

254 
size_t
 
	g£curôyEngöeIDLí
;

256 *
	g£curôyName
;

258 
size_t
 
	g£curôyNameLí
;

264 
	g¥i‹ôy
;

265 
	gønge_subid
;

267 *
	g£curôySèãRef
;

268 } 
	t√t¢mp_pdu
;

273 
	g¢mp_£ssi⁄
;

274 
¢mp_£ssi⁄
 
	t√t¢mp_£ssi⁄
;

276 
	#USM_AUTH_KU_LEN
 32

	)

277 
	#USM_PRIV_KU_LEN
 32

	)

279 (*
	g¢mp_ˇŒback
Ë(, 
	t√t¢mp_£ssi⁄
 *, ,

280 
	t√t¢mp_pdu
 *, *);

281 (*
	g√t¢mp_ˇŒback
Ë(, 
	t√t¢mp_£ssi⁄
 *, ,

282 
	t√t¢mp_pdu
 *, *);

284 
	g√t¢mp_c⁄èöî_s
;

289 
	s¢mp_£ssi⁄
 {

294 
	gvîsi⁄
;

296 
	gªåõs
;

298 
	gtimeout
;

299 
u_l⁄g
 
	gÊags
;

300 
¢mp_£ssi⁄
 *
	gsub£ssi⁄
;

301 
¢mp_£ssi⁄
 *
	g√xt
;

304 *
	g≥î«me
;

306 
u_sh‹t
 
	gªmŸe_p‹t
;

308 *
	gloˇ ame
;

310 
u_sh‹t
 
	gloˇl_p‹t
;

314 
	gu_ch¨
 *(*
	gauthítiˇt‹
Ë(u_ch¨ *, 
	gsize_t
 *, u_char *, size_t);

316 
√t¢mp_ˇŒback
 
	gˇŒback
;

320 *
	gˇŒback_magic
;

322 
	gs_î∫o
;

324 
	gs_¢mp_î∫o
;

326 
	g£ssid
;

332 
u_ch¨
 *
	gcommunôy
;

334 
size_t
 
	gcommunôy_Àn
;

336 
size_t
 
	grcvMsgMaxSize
;

338 
size_t
 
	g¢dMsgMaxSize
;

344 
u_ch¨
 
	gisAuth‹ô©ive
;

346 
u_ch¨
 *
	gc⁄ãxtEngöeID
;

348 
size_t
 
	gc⁄ãxtEngöeIDLí
;

350 
u_öt
 
	gígöeBoŸs
;

352 
u_öt
 
	gígöeTime
;

354 *
	gc⁄ãxtName
;

356 
size_t
 
	gc⁄ãxtNameLí
;

358 
u_ch¨
 *
	g£curôyEngöeID
;

360 
size_t
 
	g£curôyEngöeIDLí
;

362 *
	g£curôyName
;

364 
size_t
 
	g£curôyNameLí
;

367 
oid
 *
	g£curôyAuthPrŸo
;

369 
size_t
 
	g£curôyAuthPrŸoLí
;

371 
u_ch¨
 
	g£curôyAuthKey
[
USM_AUTH_KU_LEN
];

373 
size_t
 
	g£curôyAuthKeyLí
;

375 
u_ch¨
 *
	g£curôyAuthLoˇlKey
;

377 
size_t
 
	g£curôyAuthLoˇlKeyLí
;

380 
oid
 *
	g£curôyPrivPrŸo
;

382 
size_t
 
	g£curôyPrivPrŸoLí
;

384 
u_ch¨
 
	g£curôyPrivKey
[
USM_PRIV_KU_LEN
];

386 
size_t
 
	g£curôyPrivKeyLí
;

388 
u_ch¨
 *
	g£curôyPrivLoˇlKey
;

390 
size_t
 
	g£curôyPrivLoˇlKeyLí
;

393 
	g£curôyModñ
;

395 
	g£curôyLevñ
;

397 *
	g∑ømName
;

402 *
	g£curôyInfo
;

407 
√t¢mp_c⁄èöî_s
 *
	gå™•‹t_c⁄figuøti⁄
;

415 *
	gmyvoid
;

419 
	~<√t-¢mp/libøry/ty≥s.h
>

420 
	~<√t-¢mp/deföôi⁄s.h
>

421 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

423 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/utilities.h

1 #i‚de‡
NET_SNMP_UTILITIES_H


2 
	#NET_SNMP_UTILITIES_H


	)

12 #i‚de‡
NET_SNMP_CONFIG_H


16 
	~<√t-¢mp/ty≥s.h
>

28 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

29 
	~<√t-¢mp/libøry/¢mp_˛õ¡.h
>

30 #i‡
HAVE_GETOPT_H


31 
	~<gë›t.h
>

33 
	~<√t-¢mp/libøry/gë›t.h
>

36 #ifde‡
HAVE_NETINET_IN_H


37 
	~<√töë/ö.h
>

39 
	~<√t-¢mp/libøry/sy°em.h
>

40 
	~<√t-¢mp/libøry/toﬁs.h
>

41 
	~<√t-¢mp/libøry/a¢1.h
>

42 
	~<√t-¢mp/libøry/öt64.h
>

44 
	~<√t-¢mp/libøry/mt_suµ‹t.h
>

46 
	~<√t-¢mp/libøry/¢mp_Æ¨m.h
>

47 
	~<√t-¢mp/libøry/ˇŒback.h
>

48 
	~<√t-¢mp/libøry/d©a_li°.h
>

49 
	~<√t-¢mp/libøry/oid_°ash.h
>

50 
	~<√t-¢mp/libøry/¢mp.h
>

51 
	~<√t-¢mp/libøry/¢mp_im∂.h
>

52 
	~<√t-¢mp/libøry/¢mp-tc.h
>

53 
	~<√t-¢mp/libøry/check_v¨böd.h
>

54 
	~<√t-¢mp/libøry/c⁄èöî.h
>

55 
	~<√t-¢mp/libøry/c⁄èöî_bö¨y_¨øy.h
>

56 
	~<√t-¢mp/libøry/c⁄èöî_li°_s¶l.h
>

57 
	~<√t-¢mp/libøry/c⁄èöî_ôî©‹.h
>

59 
	~<√t-¢mp/libøry/¢mp_as£π.h
>

61 
	~<√t-¢mp/vîsi⁄.h
>

	@/usr/include/net-snmp/varbind_api.h

1 #i‚de‡
NET_SNMP_VARBIND_API_H


2 
	#NET_SNMP_VARBIND_API_H


	)

8 
	~<√t-¢mp/ty≥s.h
>

10 #ifde‡
__˝lu•lus


15 
NETSNMP_IMPORT


16 
√t¢mp_v¨übÀ_li°
 *

17 
¢mp_pdu_add_v¨übÀ
(
√t¢mp_pdu
 *
pdu
,

18 c⁄° 
oid
 * 
«me
, 
size_t
 
«me_Àngth
,

19 
u_ch¨
 
ty≥
,

20 c⁄° * 
vÆue
, 
size_t
 
Àn
);

21 
NETSNMP_IMPORT


22 
√t¢mp_v¨übÀ_li°
 *

23 
¢mp_v¨li°_add_v¨übÀ
(
√t¢mp_v¨übÀ_li°
 ** 
v¨li°
,

24 c⁄° 
oid
 * 
«me
, 
size_t
 
«me_Àngth
,

25 
u_ch¨
 
ty≥
,

26 c⁄° * 
vÆue
, 
size_t
 
Àn
);

27 
NETSNMP_IMPORT


28 
√t¢mp_v¨übÀ_li°
 *

29 
¢mp_add_nuŒ_v¨
(
√t¢mp_pdu
 *
pdu
,

30 c⁄° 
oid
 * 
«me
, 
size_t
 
«me_Àngth
);

31 
NETSNMP_IMPORT


32 
√t¢mp_v¨übÀ_li°
 *

33 
¢mp_˛⁄e_v¨böd
(
√t¢mp_v¨übÀ_li°
 * 
v¨li°
);

36 
NETSNMP_IMPORT


37 
¢mp_£t_v¨_objid
(
√t¢mp_v¨übÀ_li°
 * 
v¨
,

38 c⁄° 
oid
 * 
«me
, 
size_t
 
«me_Àngth
);

39 
NETSNMP_IMPORT


40 
¢mp_£t_v¨_vÆue
(
√t¢mp_v¨übÀ_li°
 * 
v¨
,

41 c⁄° * 
vÆue
, 
size_t
 
Àn
);

42 
NETSNMP_IMPORT


43 
¢mp_£t_v¨_ty≥d_vÆue
(
√t¢mp_v¨übÀ_li°
 * 
v¨
,

44 
u_ch¨
 
ty≥
,

45 c⁄° * 
vÆue
, 
size_t
 
Àn
);

46 
NETSNMP_IMPORT


47 
¢mp_£t_v¨_ty≥d_öãgî
(
√t¢mp_v¨übÀ_li°
 * 
v¨
,

48 
u_ch¨
 
ty≥
, 
vÆ
);

51 
NETSNMP_IMPORT


52 
¥öt_v¨übÀ
(c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

53 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

54 
NETSNMP_IMPORT


55 
Âröt_v¨übÀ
(
FILE
 * 
Â
,

56 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

57 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

58 
NETSNMP_IMPORT


59 
¢¥öt_v¨übÀ
(*
buf
, 
size_t
 
buf_Àn
,

60 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

61 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

63 
NETSNMP_IMPORT


64 
¥öt_vÆue
(c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

65 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

66 
NETSNMP_IMPORT


67 
Âröt_vÆue
(
FILE
 * 
Â
,

68 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

69 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

70 
NETSNMP_IMPORT


71 
¢¥öt_vÆue
(*
buf
, 
size_t
 
buf_Àn
,

72 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

73 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

78 
NETSNMP_IMPORT


79 
¢mp_‰ì_v¨
–
√t¢mp_v¨übÀ_li°
 *
v¨
);

80 
NETSNMP_IMPORT


81 
¢mp_‰ì_v¨böd
(
√t¢mp_v¨übÀ_li°
 *
v¨li°
);

83 #ifde‡
__˝lu•lus


101 
	~<√t-¢mp/libøry/¢mp_≠i.h
>

102 
	~<√t-¢mp/libøry/¢mp_˛õ¡.h
>

103 
	~<√t-¢mp/libøry/mib.h
>

	@/usr/include/readline/keymaps.h

22 #i‚de‡
_KEYMAPS_H_


23 
	#_KEYMAPS_H_


	)

25 #ifde‡
__˝lu•lus


29 #i‡
deföed
 (
READLINE_LIBRARY
)

30 
	~"æ°dc.h
"

31 
	~"ch¨defs.h
"

32 
	~"æty≥defs.h
"

34 
	~<ªadlöe/æ°dc.h
>

35 
	~<ªadlöe/ch¨defs.h
>

36 
	~<ªadlöe/æty≥defs.h
>

44 
	s_keym≠_íåy
 {

45 
ty≥
;

46 
æ_comm™d_func_t
 *
fun˘i⁄
;

47 } 
	tKEYMAP_ENTRY
;

52 
	#KEYMAP_SIZE
 257

	)

53 
	#ANYOTHERKEY
 
KEYMAP_SIZE
-1

	)

55 
KEYMAP_ENTRY
 
	tKEYMAP_ENTRY_ARRAY
[
KEYMAP_SIZE
];

56 
KEYMAP_ENTRY
 *
	tKeym≠
;

59 
	#ISFUNC
 0

	)

60 
	#ISKMAP
 1

	)

61 
	#ISMACR
 2

	)

63 
KEYMAP_ENTRY_ARRAY
 
emacs_°™d¨d_keym≠
, 
emacs_mëa_keym≠
, 
emacs_˘lx_keym≠
;

64 
KEYMAP_ENTRY_ARRAY
 
vi_ö£πi⁄_keym≠
, 
vi_movemít_keym≠
;

68 
Keym≠
 
æ_make_b¨e_keym≠
 
PARAMS
(());

71 
Keym≠
 
æ_c›y_keym≠
 
PARAMS
((Keymap));

76 
Keym≠
 
æ_make_keym≠
 
PARAMS
(());

79 
æ_disˇrd_keym≠
 
PARAMS
((
Keym≠
));

85 
Keym≠
 
æ_gë_keym≠_by_«me
 
PARAMS
((const *));

88 
Keym≠
 
æ_gë_keym≠
 
PARAMS
(());

91 
æ_£t_keym≠
 
PARAMS
((
Keym≠
));

93 #ifde‡
__˝lu•lus


	@/usr/include/readline/rlstdc.h

22 #i‡!
deföed
 (
_RL_STDC_H_
)

23 
	#_RL_STDC_H_


	)

31 #i‡!
deföed
 (
PARAMS
)

32 #i‡
deföed
 (
__STDC__
Ë|| deföed (
__GNUC__
Ë|| deföed (
__˝lu•lus
)

33 
	#PARAMS
(
¥Ÿos
Ë
	)
¥Ÿos

35 
	#PARAMS
(
¥Ÿos
Ë()

	)

39 #i‚de‡
__©åibuã__


40 #i‡
__GNUC__
 < 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 < 8)

41 
	#__©åibuã__
(
x
)

	)

	@/usr/include/readline/rltypedefs.h

22 #i‚de‡
_RL_TYPEDEFS_H_


23 
	#_RL_TYPEDEFS_H_


	)

25 #ifde‡
__˝lu•lus


31 #i‡!
deföed
 (
_FUNCTION_DEF
)

32 
	#_FUNCTION_DEF


	)

34 
	tFun˘i⁄
 ();

35 
	tVFun˘i⁄
 ();

36 *
	tCPFun˘i⁄
 ();

37 **
	tCPPFun˘i⁄
 ();

43 #i‡!
deföed
 (
_RL_FUNCTION_TYPEDEF
)

44 
	#_RL_FUNCTION_TYPEDEF


	)

47 
	tæ_comm™d_func_t
 
	tPARAMS
((, ));

50 *
	tæ_com≥¡ry_func_t
 
	tPARAMS
((const *, ));

51 **
	tæ_com∂ëi⁄_func_t
 
	tPARAMS
((const *, , ));

53 *
	tæ_quŸe_func_t
 
	tPARAMS
((*, , *));

54 *
	tæ_dequŸe_func_t
 
	tPARAMS
((*, ));

56 
	tæ_compign‹e_func_t
 
	tPARAMS
((**));

58 
	tæ_compdi•_func_t
 
	tPARAMS
((**, , ));

61 
	tæ_hook_func_t
 
	tPARAMS
(());

64 
	tæ_gëc_func_t
 
	tPARAMS
((
	tFILE
 *));

69 
	tæ_löebuf_func_t
 
	tPARAMS
((*, ));

72 
	tæ_ötfunc_t
 
	tPARAMS
(());

73 
	#æ_ivoidfunc_t
 
æ_hook_func_t


	)

74 
	tæ_i˝func_t
 
	tPARAMS
((*));

75 
	tæ_i˝pfunc_t
 
	tPARAMS
((**));

77 
	tæ_voidfunc_t
 
	tPARAMS
(());

78 
	tæ_vötfunc_t
 
	tPARAMS
(());

79 
	tæ_v˝func_t
 
	tPARAMS
((*));

80 
	tæ_v˝pfunc_t
 
	tPARAMS
((**));

82 *
	tæ_˝vfunc_t
 
	tPARAMS
(());

83 *
	tæ_˝ifunc_t
 
	tPARAMS
(());

84 *
	tæ_˝˝func_t
 
	tPARAMS
((*));

85 *
	tæ_˝˝pfunc_t
 
	tPARAMS
((**));

89 #ifde‡
__˝lu•lus


	@/usr/include/readline/tilde.h

23 #i‡!
deföed
 (
_TILDE_H_
)

24 
	#_TILDE_H_


	)

26 #ifde‡
__˝lu•lus


34 #i‡!
deföed
 (
PARAMS
)

35 #i‡
deföed
 (
__STDC__
Ë|| deföed (
__GNUC__
Ë|| deföed (
__˝lu•lus
)

36 
	#PARAMS
(
¥Ÿos
Ë
	)
¥Ÿos

38 
	#PARAMS
(
¥Ÿos
Ë()

	)

42 *
	ttûde_hook_func_t
 
	tPARAMS
((*));

48 
tûde_hook_func_t
 *
tûde_ex∑nsi⁄_¥ìx∑nsi⁄_hook
;

54 
tûde_hook_func_t
 *
tûde_ex∑nsi⁄_Áûuª_hook
;

59 **
tûde_addôi⁄Æ_¥efixes
;

64 **
tûde_addôi⁄Æ_suffixes
;

67 *
tûde_ex∑nd
 
PARAMS
((const *));

71 *
tûde_ex∑nd_w‹d
 
PARAMS
((const *));

74 *
tûde_föd_w‹d
 
PARAMS
((const *, , *));

76 #ifde‡
__˝lu•lus


	@/usr/include/rpc/netdb.h

36 #i‚de‡
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<„©uªs.h
>

41 
	#__√ed_size_t


	)

42 
	~<°ddef.h
>

44 
__BEGIN_DECLS


46 
	sΩ˚¡


48 *
	mr_«me
;

49 **
	mr_Æü£s
;

50 
	mr_numbî
;

53 
	$£åp˚¡
 (
__°ay›í
Ë
__THROW
;

54 
	$ídΩ˚¡
 (Ë
__THROW
;

55 
Ω˚¡
 *
	$gëΩcby«me
 (c⁄° *
__«me
Ë
__THROW
;

56 
Ω˚¡
 *
	$gëΩcbynumbî
 (
__numbî
Ë
__THROW
;

57 
Ω˚¡
 *
	$gëΩ˚¡
 (Ë
__THROW
;

59 #ifde‡
__USE_MISC


60 
	$gëΩcby«me_r
 (c⁄° *
__«me
, 
Ω˚¡
 *
__ªsu…_buf
,

61 *
__buf„r
, 
size_t
 
__buÊí
,

62 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

64 
	$gëΩcbynumbî_r
 (
__numbî
, 
Ω˚¡
 *
__ªsu…_buf
,

65 *
__buf„r
, 
size_t
 
__buÊí
,

66 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

68 
	$gëΩ˚¡_r
 (
Ω˚¡
 *
__ªsu…_buf
, *
__buf„r
,

69 
size_t
 
__buÊí
, 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

72 
__END_DECLS


	@/usr/include/stdint.h

22 #i‚de‡
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/wch¨.h
>

27 
	~<bôs/w‹dsize.h
>

34 #i‚de‡
__öt8_t_deföed


35 
	#__öt8_t_deföed


	)

36 sig√d 
	töt8_t
;

37 
	töt16_t
;

38 
	töt32_t
;

39 #i‡
__WORDSIZE
 == 64

40 
	töt64_t
;

42 
__exãnsi⁄__


43 
	töt64_t
;

48 
	tuöt8_t
;

49 
	tuöt16_t
;

50 #i‚de‡
__uöt32_t_deföed


51 
	tuöt32_t
;

52 
	#__uöt32_t_deföed


	)

54 #i‡
__WORDSIZE
 == 64

55 
	tuöt64_t
;

57 
__exãnsi⁄__


58 
	tuöt64_t
;

65 sig√d 
	töt_Àa°8_t
;

66 
	töt_Àa°16_t
;

67 
	töt_Àa°32_t
;

68 #i‡
__WORDSIZE
 == 64

69 
	töt_Àa°64_t
;

71 
__exãnsi⁄__


72 
	töt_Àa°64_t
;

76 
	tuöt_Àa°8_t
;

77 
	tuöt_Àa°16_t
;

78 
	tuöt_Àa°32_t
;

79 #i‡
__WORDSIZE
 == 64

80 
	tuöt_Àa°64_t
;

82 
__exãnsi⁄__


83 
	tuöt_Àa°64_t
;

90 sig√d 
	töt_Á°8_t
;

91 #i‡
__WORDSIZE
 == 64

92 
	töt_Á°16_t
;

93 
	töt_Á°32_t
;

94 
	töt_Á°64_t
;

96 
	töt_Á°16_t
;

97 
	töt_Á°32_t
;

98 
__exãnsi⁄__


99 
	töt_Á°64_t
;

103 
	tuöt_Á°8_t
;

104 #i‡
__WORDSIZE
 == 64

105 
	tuöt_Á°16_t
;

106 
	tuöt_Á°32_t
;

107 
	tuöt_Á°64_t
;

109 
	tuöt_Á°16_t
;

110 
	tuöt_Á°32_t
;

111 
__exãnsi⁄__


112 
	tuöt_Á°64_t
;

117 #i‡
__WORDSIZE
 == 64

118 #i‚de‡
__öçå_t_deföed


119 
	töçå_t
;

120 
	#__öçå_t_deföed


	)

122 
	tuöçå_t
;

124 #i‚de‡
__öçå_t_deföed


125 
	töçå_t
;

126 
	#__öçå_t_deföed


	)

128 
	tuöçå_t
;

133 #i‡
__WORDSIZE
 == 64

134 
	tötmax_t
;

135 
	tuötmax_t
;

137 
__exãnsi⁄__


138 
	tötmax_t
;

139 
__exãnsi⁄__


140 
	tuötmax_t
;

144 #i‡
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
Ë¯## 
L


	)

146 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

148 
	#__INT64_C
(
c
Ë¯## 
LL


	)

149 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #i‡
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #i‡
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #i‡
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #i‡
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #i‡
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #i‡
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 #ifde‡
__WORDSIZE32_SIZE_ULONG


264 
	#SIZE_MAX
 (4294967295UL)

	)

266 
	#SIZE_MAX
 (4294967295U)

	)

271 #i‚de‡
WCHAR_MIN


273 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

274 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

278 
	#WINT_MIN
 (0u)

	)

279 
	#WINT_MAX
 (4294967295u)

	)

283 
	#INT8_C
(
c
Ë
	)
c

284 
	#INT16_C
(
c
Ë
	)
c

285 
	#INT32_C
(
c
Ë
	)
c

286 #i‡
__WORDSIZE
 == 64

287 
	#INT64_C
(
c
Ë¯## 
L


	)

289 
	#INT64_C
(
c
Ë¯## 
LL


	)

293 
	#UINT8_C
(
c
Ë
	)
c

294 
	#UINT16_C
(
c
Ë
	)
c

295 
	#UINT32_C
(
c
Ë¯## 
U


	)

296 #i‡
__WORDSIZE
 == 64

297 
	#UINT64_C
(
c
Ë¯## 
UL


	)

299 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

303 #i‡
__WORDSIZE
 == 64

304 
	#INTMAX_C
(
c
Ë¯## 
L


	)

305 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

307 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

308 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/sys/syslog.h

32 #i‚de‡
_SYS_SYSLOG_H


33 
	#_SYS_SYSLOG_H
 1

	)

35 
	~<„©uªs.h
>

36 
	#__√ed___va_li°


	)

37 
	~<°d¨g.h
>

40 
	~<bôs/sy¶og-∑th.h
>

51 
	#LOG_EMERG
 0

	)

52 
	#LOG_ALERT
 1

	)

53 
	#LOG_CRIT
 2

	)

54 
	#LOG_ERR
 3

	)

55 
	#LOG_WARNING
 4

	)

56 
	#LOG_NOTICE
 5

	)

57 
	#LOG_INFO
 6

	)

58 
	#LOG_DEBUG
 7

	)

60 
	#LOG_PRIMASK
 0x07

	)

62 
	#LOG_PRI
(
p
Ë(’Ë& 
LOG_PRIMASK
)

	)

63 
	#LOG_MAKEPRI
(
Ác
, 
¥i
Ë((ÁcË| (¥i))

	)

65 #ifde‡
SYSLOG_NAMES


66 
	#INTERNAL_NOPRI
 0x10

	)

68 
	#INTERNAL_MARK
 
	`LOG_MAKEPRI
(
LOG_NFACILITIES
 << 3, 0)

	)

69 
	s_code
 {

70 *
	mc_«me
;

71 
	mc_vÆ
;

72 } 
	tCODE
;

74 
CODE
 
	g¥i‹ôy«mes
[] =

76 { "Æît", 
LOG_ALERT
 },

77 { "¸ô", 
LOG_CRIT
 },

78 { "debug", 
LOG_DEBUG
 },

79 { "emîg", 
LOG_EMERG
 },

80 { "îr", 
LOG_ERR
 },

81 { "îr‹", 
LOG_ERR
 },

82 { "öfo", 
LOG_INFO
 },

83 { "n⁄e", 
INTERNAL_NOPRI
 },

84 { "nŸi˚", 
LOG_NOTICE
 },

85 { "∑nic", 
LOG_EMERG
 },

86 { "w¨n", 
LOG_WARNING
 },

87 { "w¨nög", 
LOG_WARNING
 },

88 { 
NULL
, -1 }

93 
	#LOG_KERN
 (0<<3Ë

	)

94 
	#LOG_USER
 (1<<3Ë

	)

95 
	#LOG_MAIL
 (2<<3Ë

	)

96 
	#LOG_DAEMON
 (3<<3Ë

	)

97 
	#LOG_AUTH
 (4<<3Ë

	)

98 
	#LOG_SYSLOG
 (5<<3Ë

	)

99 
	#LOG_LPR
 (6<<3Ë

	)

100 
	#LOG_NEWS
 (7<<3Ë

	)

101 
	#LOG_UUCP
 (8<<3Ë

	)

102 
	#LOG_CRON
 (9<<3Ë

	)

103 
	#LOG_AUTHPRIV
 (10<<3Ë

	)

104 
	#LOG_FTP
 (11<<3Ë

	)

107 
	#LOG_LOCAL0
 (16<<3Ë

	)

108 
	#LOG_LOCAL1
 (17<<3Ë

	)

109 
	#LOG_LOCAL2
 (18<<3Ë

	)

110 
	#LOG_LOCAL3
 (19<<3Ë

	)

111 
	#LOG_LOCAL4
 (20<<3Ë

	)

112 
	#LOG_LOCAL5
 (21<<3Ë

	)

113 
	#LOG_LOCAL6
 (22<<3Ë

	)

114 
	#LOG_LOCAL7
 (23<<3Ë

	)

116 
	#LOG_NFACILITIES
 24

	)

117 
	#LOG_FACMASK
 0x03f8

	)

119 
	#LOG_FAC
(
p
Ë((’Ë& 
LOG_FACMASK
Ë>> 3)

	)

121 #ifde‡
SYSLOG_NAMES


122 
CODE
 
	gÁcûôy«mes
[] =

124 { "auth", 
LOG_AUTH
 },

125 { "auth¥iv", 
LOG_AUTHPRIV
 },

126 { "¸⁄", 
LOG_CRON
 },

127 { "d´m⁄", 
LOG_DAEMON
 },

128 { "·p", 
LOG_FTP
 },

129 { "kîn", 
LOG_KERN
 },

130 { "Õr", 
LOG_LPR
 },

131 { "maû", 
LOG_MAIL
 },

132 { "m¨k", 
INTERNAL_MARK
 },

133 { "√ws", 
LOG_NEWS
 },

134 { "£curôy", 
LOG_AUTH
 },

135 { "sy¶og", 
LOG_SYSLOG
 },

136 { "u£r", 
LOG_USER
 },

137 { "uu˝", 
LOG_UUCP
 },

138 { "loˇl0", 
LOG_LOCAL0
 },

139 { "loˇl1", 
LOG_LOCAL1
 },

140 { "loˇl2", 
LOG_LOCAL2
 },

141 { "loˇl3", 
LOG_LOCAL3
 },

142 { "loˇl4", 
LOG_LOCAL4
 },

143 { "loˇl5", 
LOG_LOCAL5
 },

144 { "loˇl6", 
LOG_LOCAL6
 },

145 { "loˇl7", 
LOG_LOCAL7
 },

146 { 
NULL
, -1 }

153 
	#LOG_MASK
(
¥i
Ë(1 << (¥i)Ë

	)

154 
	#LOG_UPTO
(
¥i
Ë((1 << (’ri)+1)Ë- 1Ë

	)

162 
	#LOG_PID
 0x01

	)

163 
	#LOG_CONS
 0x02

	)

164 
	#LOG_ODELAY
 0x04

	)

165 
	#LOG_NDELAY
 0x08

	)

166 
	#LOG_NOWAIT
 0x10

	)

167 
	#LOG_PERROR
 0x20

	)

169 
__BEGIN_DECLS


175 
˛o£log
 ();

181 
›ílog
 (c⁄° *
__idít
, 
__›ti⁄
, 
__Ácûôy
);

184 
	$£éogmask
 (
__mask
Ë
__THROW
;

190 
	$sy¶og
 (
__¥i
, c⁄° *
__fmt
, ...)

191 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

193 #ifde‡
__USE_BSD


200 
	$vsy¶og
 (
__¥i
, c⁄° *
__fmt
, 
__gnuc_va_li°
 
__≠
)

201 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

206 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


207 
	~<bôs/sy¶og.h
>

209 #ifde‡
__LDBL_COMPAT


210 
	~<bôs/sy¶og-ldbl.h
>

213 
__END_DECLS


	@/usr/include/sys/sysmacros.h

20 #i‚de‡
_SYS_SYSMACROS_H


21 
	#_SYS_SYSMACROS_H
 1

	)

23 
	~<„©uªs.h
>

28 #ifde‡
__GLIBC_HAVE_LONG_LONG


29 
__BEGIN_DECLS


31 
__exãnsi⁄__


32 
	$gnu_dev_maj‹
 (
__dev
)

33 
__THROW
 
__©åibuã_c⁄°__
;

34 
__exãnsi⁄__


35 
	$gnu_dev_mö‹
 (
__dev
)

36 
__THROW
 
__©åibuã_c⁄°__
;

37 
__exãnsi⁄__


38 
	$gnu_dev_makedev
 (
__maj‹
,

39 
__mö‹
)

40 
__THROW
 
__©åibuã_c⁄°__
;

42 #i‡
deföed
 
__GNUC__
 && __GNUC__ >2 && deföed 
__USE_EXTERN_INLINES


43 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

44 
	`__NTH
 (
	$gnu_dev_maj‹
 (
__dev
))

46  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

47 
	}
}

49 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

50 
__NTH
 (
	$gnu_dev_mö‹
 (
__dev
))

52  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

53 
	}
}

55 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

56 
__NTH
 (
	$gnu_dev_makedev
 (
__maj‹
, 
__mö‹
))

58  ((
__mö‹
 & 0xffË| ((
__maj‹
 & 0xfff) << 8)

59 | (((Ë(
__mö‹
 & ~0xff)) << 12)

60 | (((Ë(
__maj‹
 & ~0xfff)) << 32));

61 
	}
}

63 
	g__END_DECLS


66 
	#maj‹
(
dev
Ë
	`gnu_dev_maj‹
 (dev)

	)

67 
	#mö‹
(
dev
Ë
	`gnu_dev_mö‹
 (dev)

	)

68 
	#makedev
(
maj
, 
mö
Ë
	`gnu_dev_makedev
 (maj, mö)

	)

	@/usr/include/sys/ttydefaults.h

40 #i‚de‡
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
Ë(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifde‡
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifde‡
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifde‡
TTYDEFCHARS


94 
cc_t
 
	gâydefch¨s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #unde‡
TTYDEFCHARS


	@/usr/include/sys/ucontext.h

18 #i‚de‡
_SYS_UCONTEXT_H


19 
	#_SYS_UCONTEXT_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<sig«l.h
>

26 
	~<bôs/sigc⁄ãxt.h
>

28 #ifde‡
__x86_64__


31 
__exãnsi⁄__
 
	tgªg_t
;

34 
	#NGREG
 23

	)

37 
gªg_t
 
	tgªg£t_t
[
NGREG
];

39 #ifde‡
__USE_GNU


43 
	mREG_R8
 = 0,

44 
	#REG_R8
 
REG_R8


	)

45 
	mREG_R9
,

46 
	#REG_R9
 
REG_R9


	)

47 
	mREG_R10
,

48 
	#REG_R10
 
REG_R10


	)

49 
	mREG_R11
,

50 
	#REG_R11
 
REG_R11


	)

51 
	mREG_R12
,

52 
	#REG_R12
 
REG_R12


	)

53 
	mREG_R13
,

54 
	#REG_R13
 
REG_R13


	)

55 
	mREG_R14
,

56 
	#REG_R14
 
REG_R14


	)

57 
	mREG_R15
,

58 
	#REG_R15
 
REG_R15


	)

59 
	mREG_RDI
,

60 
	#REG_RDI
 
REG_RDI


	)

61 
	mREG_RSI
,

62 
	#REG_RSI
 
REG_RSI


	)

63 
	mREG_RBP
,

64 
	#REG_RBP
 
REG_RBP


	)

65 
	mREG_RBX
,

66 
	#REG_RBX
 
REG_RBX


	)

67 
	mREG_RDX
,

68 
	#REG_RDX
 
REG_RDX


	)

69 
	mREG_RAX
,

70 
	#REG_RAX
 
REG_RAX


	)

71 
	mREG_RCX
,

72 
	#REG_RCX
 
REG_RCX


	)

73 
	mREG_RSP
,

74 
	#REG_RSP
 
REG_RSP


	)

75 
	mREG_RIP
,

76 
	#REG_RIP
 
REG_RIP


	)

77 
	mREG_EFL
,

78 
	#REG_EFL
 
REG_EFL


	)

79 
	mREG_CSGSFS
,

80 
	#REG_CSGSFS
 
REG_CSGSFS


	)

81 
	mREG_ERR
,

82 
	#REG_ERR
 
REG_ERR


	)

83 
	mREG_TRAPNO
,

84 
	#REG_TRAPNO
 
REG_TRAPNO


	)

85 
	mREG_OLDMASK
,

86 
	#REG_OLDMASK
 
REG_OLDMASK


	)

87 
	mREG_CR2


88 
	#REG_CR2
 
REG_CR2


	)

92 
	s_libc_Âxªg


94 
	msignifiˇnd
[4];

95 
	mexp⁄ít
;

96 
	m∑ddög
[3];

99 
	s_libc_xmmªg


101 
__uöt32_t
 
	mñemít
[4];

104 
	s_libc_Â°©e


107 
__uöt16_t
 
	mcwd
;

108 
__uöt16_t
 
	mswd
;

109 
__uöt16_t
 
	m·w
;

110 
__uöt16_t
 
	mf›
;

111 
__uöt64_t
 
	mrù
;

112 
__uöt64_t
 
	mrdp
;

113 
__uöt32_t
 
	mmxc§
;

114 
__uöt32_t
 
	mmx¸_mask
;

115 
_libc_Âxªg
 
	m_°
[8];

116 
_libc_xmmªg
 
	m_xmm
[16];

117 
__uöt32_t
 
	m∑ddög
[24];

121 
_libc_Â°©e
 *
	tÂªg£t_t
;

126 
gªg£t_t
 
	mgªgs
;

128 
Âªg£t_t
 
	mÂªgs
;

129 
__exãnsi⁄__
 
	m__ª£rved1
 [8];

130 } 
	tmc⁄ãxt_t
;

133 
	suc⁄ãxt


135 
	muc_Êags
;

136 
uc⁄ãxt
 *
	muc_lök
;

137 
°ack_t
 
	muc_°ack
;

138 
mc⁄ãxt_t
 
	muc_mc⁄ãxt
;

139 
__sig£t_t
 
	muc_sigmask
;

140 
_libc_Â°©e
 
	m__Âªgs_mem
;

141 } 
	tuc⁄ãxt_t
;

146 
	tgªg_t
;

149 
	#NGREG
 19

	)

152 
gªg_t
 
	tgªg£t_t
[
NGREG
];

154 #ifde‡
__USE_GNU


158 
	mREG_GS
 = 0,

159 
	#REG_GS
 
REG_GS


	)

160 
	mREG_FS
,

161 
	#REG_FS
 
REG_FS


	)

162 
	mREG_ES
,

163 
	#REG_ES
 
REG_ES


	)

164 
	mREG_DS
,

165 
	#REG_DS
 
REG_DS


	)

166 
	mREG_EDI
,

167 
	#REG_EDI
 
REG_EDI


	)

168 
	mREG_ESI
,

169 
	#REG_ESI
 
REG_ESI


	)

170 
	mREG_EBP
,

171 
	#REG_EBP
 
REG_EBP


	)

172 
	mREG_ESP
,

173 
	#REG_ESP
 
REG_ESP


	)

174 
	mREG_EBX
,

175 
	#REG_EBX
 
REG_EBX


	)

176 
	mREG_EDX
,

177 
	#REG_EDX
 
REG_EDX


	)

178 
	mREG_ECX
,

179 
	#REG_ECX
 
REG_ECX


	)

180 
	mREG_EAX
,

181 
	#REG_EAX
 
REG_EAX


	)

182 
	mREG_TRAPNO
,

183 
	#REG_TRAPNO
 
REG_TRAPNO


	)

184 
	mREG_ERR
,

185 
	#REG_ERR
 
REG_ERR


	)

186 
	mREG_EIP
,

187 
	#REG_EIP
 
REG_EIP


	)

188 
	mREG_CS
,

189 
	#REG_CS
 
REG_CS


	)

190 
	mREG_EFL
,

191 
	#REG_EFL
 
REG_EFL


	)

192 
	mREG_UESP
,

193 
	#REG_UESP
 
REG_UESP


	)

194 
	mREG_SS


195 
	#REG_SS
 
REG_SS


	)

200 
	s_libc_Âªg


202 
	msignifiˇnd
[4];

203 
	mexp⁄ít
;

206 
	s_libc_Â°©e


208 
	mcw
;

209 
	msw
;

210 
	mèg
;

211 
	mùoff
;

212 
	mcs£l
;

213 
	md©aoff
;

214 
	md©a£l
;

215 
_libc_Âªg
 
	m_°
[8];

216 
	m°©us
;

220 
_libc_Â°©e
 *
	tÂªg£t_t
;

225 
gªg£t_t
 
	mgªgs
;

228 
Âªg£t_t
 
	mÂªgs
;

229 
	mﬁdmask
;

230 
	m¸2
;

231 } 
	tmc⁄ãxt_t
;

234 
	suc⁄ãxt


236 
	muc_Êags
;

237 
uc⁄ãxt
 *
	muc_lök
;

238 
°ack_t
 
	muc_°ack
;

239 
mc⁄ãxt_t
 
	muc_mc⁄ãxt
;

240 
__sig£t_t
 
	muc_sigmask
;

241 
_libc_Â°©e
 
	m__Âªgs_mem
;

242 } 
	tuc⁄ãxt_t
;

	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

23 
__off_t
 
	m__pos
;

24 
__mb°©e_t
 
	m__°©e
;

25 } 
	t_G_Âos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos64_t
;

31 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gc⁄v.h
>

35 
__gc⁄v_öfo
 
	m__cd
;

38 
__gc⁄v_öfo
 
	m__cd
;

39 
__gc⁄v_°ï_d©a
 
	m__d©a
;

40 } 
	m__comböed
;

41 } 
	t_G_ic⁄v_t
;

46 
	#_G_va_li°
 
__gnuc_va_li°


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/asm-generic/int-ll64.h

8 #i‚de‡
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/bô•îl⁄g.h
>

13 #i‚de‡
__ASSEMBLY__


19 
__sig√d__
 
	t__s8
;

20 
	t__u8
;

22 
__sig√d__
 
	t__s16
;

23 
	t__u16
;

25 
__sig√d__
 
	t__s32
;

26 
	t__u32
;

28 #ifde‡
__GNUC__


29 
__exãnsi⁄__
 
__sig√d__
 
	t__s64
;

30 
__exãnsi⁄__
 
	t__u64
;

32 
__sig√d__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm/ioctls.h

1 
	~<asm-gíîic/io˘ls.h
>

	@/usr/include/asm/posix_types.h

1 #ifde‡
__i386__


2 
	~<asm/posix_ty≥s_32.h
>

3 #ñi‡
deföed
(
__ILP32__
)

4 
	~<asm/posix_ty≥s_x32.h
>

6 
	~<asm/posix_ty≥s_64.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-gíîic/sockë.h
>

	@/usr/include/bits/byteswap-16.h

19 #i‚de‡
_BITS_BYTESWAP_H


23 #ifde‡
__GNUC__


24 #i‡
__GNUC__
 >= 2

25 
	#__bsw≠_16
(
x
) \

26 (
__exãnsi⁄__
 \

27 ({ 
__v
, 
__x
 = (Ë(
x
); \

28 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

29 
__v
 = 
	`__bsw≠_c⁄°™t_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "Ù" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw≠_16
(
x
) \

39 (
__exãnsi⁄__
 \

40 ({ 
__x
 = (Ë(
x
); \

41 
	`__bsw≠_c⁄°™t_16
 (
__x
); }))

	)

44 
__ölöe
 

45 
	$__bsw≠_16
 (
__bsx
)

47  
	`__bsw≠_c⁄°™t_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/endian.h

3 #i‚de‡
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/fcntl-linux.h

19 #i‚def 
_FCNTL_H


37 #ifde‡
__USE_GNU


38 
	~<bôs/uio.h
>

42 
	#O_ACCMODE
 0003

	)

43 
	#O_RDONLY
 00

	)

44 
	#O_WRONLY
 01

	)

45 
	#O_RDWR
 02

	)

46 #i‚de‡
O_CREAT


47 
	#O_CREAT
 0100

	)

49 #i‚de‡
O_EXCL


50 
	#O_EXCL
 0200

	)

52 #i‚de‡
O_NOCTTY


53 
	#O_NOCTTY
 0400

	)

55 #i‚de‡
O_TRUNC


56 
	#O_TRUNC
 01000

	)

58 #i‚de‡
O_APPEND


59 
	#O_APPEND
 02000

	)

61 #i‚de‡
O_NONBLOCK


62 
	#O_NONBLOCK
 04000

	)

64 #i‚de‡
O_NDELAY


65 
	#O_NDELAY
 
O_NONBLOCK


	)

67 #i‚de‡
O_SYNC


68 
	#O_SYNC
 04010000

	)

70 
	#O_FSYNC
 
O_SYNC


	)

71 #i‚de‡
O_ASYNC


72 
	#O_ASYNC
 020000

	)

74 #i‚de‡
__O_LARGEFILE


75 
	#__O_LARGEFILE
 0100000

	)

78 #i‚de‡
__O_DIRECTORY


79 
	#__O_DIRECTORY
 0200000

	)

81 #i‚de‡
__O_NOFOLLOW


82 
	#__O_NOFOLLOW
 0400000

	)

84 #i‚de‡
__O_CLOEXEC


85 
	#__O_CLOEXEC
 02000000

	)

87 #i‚de‡
__O_DIRECT


88 
	#__O_DIRECT
 040000

	)

90 #i‚de‡
__O_NOATIME


91 
	#__O_NOATIME
 01000000

	)

93 #i‚de‡
__O_PATH


94 
	#__O_PATH
 010000000

	)

96 #i‚de‡
__O_DSYNC


97 
	#__O_DSYNC
 010000

	)

99 #i‚de‡
__O_TMPFILE


100 
	#__O_TMPFILE
 (020000000 | 
__O_DIRECTORY
)

	)

103 #i‚de‡
F_GETLK


104 #i‚de‡
__USE_FILE_OFFSET64


105 
	#F_GETLK
 5

	)

106 
	#F_SETLK
 6

	)

107 
	#F_SETLKW
 7

	)

109 
	#F_GETLK
 
F_GETLK64


	)

110 
	#F_SETLK
 
F_SETLK64


	)

111 
	#F_SETLKW
 
F_SETLKW64


	)

114 #i‚de‡
F_GETLK64


115 
	#F_GETLK64
 12

	)

116 
	#F_SETLK64
 13

	)

117 
	#F_SETLKW64
 14

	)

120 #ifde‡
__USE_FILE_OFFSET64


132 #ifde‡
__USE_GNU


133 
	#F_OFD_GETLK
 36

	)

134 
	#F_OFD_SETLK
 37

	)

135 
	#F_OFD_SETLKW
 38

	)

139 #ifde‡
__USE_LARGEFILE64


140 
	#O_LARGEFILE
 
__O_LARGEFILE


	)

143 #ifde‡
__USE_XOPEN2K8


144 
	#O_DIRECTORY
 
__O_DIRECTORY


	)

145 
	#O_NOFOLLOW
 
__O_NOFOLLOW


	)

146 
	#O_CLOEXEC
 
__O_CLOEXEC


	)

149 #ifde‡
__USE_GNU


150 
	#O_DIRECT
 
__O_DIRECT


	)

151 
	#O_NOATIME
 
__O_NOATIME


	)

152 
	#O_PATH
 
__O_PATH


	)

153 
	#O_TMPFILE
 
__O_TMPFILE


	)

159 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


160 
	#O_DSYNC
 
__O_DSYNC


	)

161 #i‡
deföed
 
__O_RSYNC


162 
	#O_RSYNC
 
__O_RSYNC


	)

164 
	#O_RSYNC
 
O_SYNC


	)

169 
	#F_DUPFD
 0

	)

170 
	#F_GETFD
 1

	)

171 
	#F_SETFD
 2

	)

172 
	#F_GETFL
 3

	)

173 
	#F_SETFL
 4

	)

175 #i‚de‡
__F_SETOWN


176 
	#__F_SETOWN
 8

	)

177 
	#__F_GETOWN
 9

	)

180 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


181 
	#F_SETOWN
 
__F_SETOWN


	)

182 
	#F_GETOWN
 
__F_GETOWN


	)

185 #i‚de‡
__F_SETSIG


186 
	#__F_SETSIG
 10

	)

187 
	#__F_GETSIG
 11

	)

189 #i‚de‡
__F_SETOWN_EX


190 
	#__F_SETOWN_EX
 15

	)

191 
	#__F_GETOWN_EX
 16

	)

194 #ifde‡
__USE_GNU


195 
	#F_SETSIG
 
__F_SETSIG


	)

196 
	#F_GETSIG
 
__F_GETSIG


	)

197 
	#F_SETOWN_EX
 
__F_SETOWN_EX


	)

198 
	#F_GETOWN_EX
 
__F_GETOWN_EX


	)

201 #ifde‡
__USE_GNU


202 
	#F_SETLEASE
 1024

	)

203 
	#F_GETLEASE
 1025

	)

204 
	#F_NOTIFY
 1026

	)

205 
	#F_SETPIPE_SZ
 1031

	)

206 
	#F_GETPIPE_SZ
 1032

	)

208 #ifde‡
__USE_XOPEN2K8


209 
	#F_DUPFD_CLOEXEC
 1030

	)

214 
	#FD_CLOEXEC
 1

	)

216 #i‚de‡
F_RDLCK


218 
	#F_RDLCK
 0

	)

219 
	#F_WRLCK
 1

	)

220 
	#F_UNLCK
 2

	)

225 #i‚de‡
F_EXLCK


226 
	#F_EXLCK
 4

	)

227 
	#F_SHLCK
 8

	)

230 #ifde‡
__USE_BSD


232 
	#LOCK_SH
 1

	)

233 
	#LOCK_EX
 2

	)

234 
	#LOCK_NB
 4

	)

236 
	#LOCK_UN
 8

	)

239 #ifde‡
__USE_GNU


240 
	#LOCK_MAND
 32

	)

241 
	#LOCK_READ
 64

	)

242 
	#LOCK_WRITE
 128

	)

243 
	#LOCK_RW
 192

	)

246 #ifde‡
__USE_GNU


248 
	#DN_ACCESS
 0x00000001

	)

249 
	#DN_MODIFY
 0x00000002

	)

250 
	#DN_CREATE
 0x00000004

	)

251 
	#DN_DELETE
 0x00000008

	)

252 
	#DN_RENAME
 0x00000010

	)

253 
	#DN_ATTRIB
 0x00000020

	)

254 
	#DN_MULTISHOT
 0x80000000

	)

258 #ifde‡
__USE_GNU


260 
	e__pid_ty≥


262 
	mF_OWNER_TID
 = 0,

263 
	mF_OWNER_PID
,

264 
	mF_OWNER_PGRP
,

265 
	mF_OWNER_GID
 = 
F_OWNER_PGRP


269 
	sf_ow√r_ex


271 
__pid_ty≥
 
	mty≥
;

272 
__pid_t
 
	mpid
;

278 #ifdef 
__USE_BSD


279 
	#FAPPEND
 
O_APPEND


	)

280 
	#FFSYNC
 
O_FSYNC


	)

281 
	#FASYNC
 
O_ASYNC


	)

282 
	#FNONBLOCK
 
O_NONBLOCK


	)

283 
	#FNDELAY
 
O_NDELAY


	)

286 #i‚de‡
__POSIX_FADV_DONTNEED


287 
	#__POSIX_FADV_DONTNEED
 4

	)

288 
	#__POSIX_FADV_NOREUSE
 5

	)

291 #ifde‡
__USE_XOPEN2K


292 
	#POSIX_FADV_NORMAL
 0

	)

293 
	#POSIX_FADV_RANDOM
 1

	)

294 
	#POSIX_FADV_SEQUENTIAL
 2

	)

295 
	#POSIX_FADV_WILLNEED
 3

	)

296 
	#POSIX_FADV_DONTNEED
 
__POSIX_FADV_DONTNEED


	)

297 
	#POSIX_FADV_NOREUSE
 
__POSIX_FADV_NOREUSE


	)

301 #ifde‡
__USE_GNU


303 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

306 
	#SYNC_FILE_RANGE_WRITE
 2

	)

309 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

314 
	#SPLICE_F_MOVE
 1

	)

315 
	#SPLICE_F_NONBLOCK
 2

	)

318 
	#SPLICE_F_MORE
 4

	)

319 
	#SPLICE_F_GIFT
 8

	)

323 
	~<löux/ÁŒoc.h
>

327 
	sfûe_h™dÀ


329 
	mh™dÀ_byãs
;

330 
	mh™dÀ_ty≥
;

332 
	mf_h™dÀ
[0];

336 
	#MAX_HANDLE_SZ
 128

	)

339 
	g__BEGIN_DECLS


341 #ifde‡
__USE_GNU


344 
ssize_t
 
	$ªadahód
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__cou¡
)

345 
__THROW
;

352 
	`sync_fûe_ønge
 (
__fd
, 
__off64_t
 
__off£t
, __off64_à
__cou¡
,

353 
__Êags
);

360 
ssize_t
 
	`vm•li˚
 (
__fdout
, c⁄° 
iovec
 *
__iov
,

361 
size_t
 
__cou¡
, 
__Êags
);

367 
ssize_t
 
	`•li˚
 (
__fdö
, 
__off64_t
 *
__offö
, 
__fdout
,

368 
__off64_t
 *
__offout
, 
size_t
 
__Àn
,

369 
__Êags
);

375 
ssize_t
 
	`ãe
 (
__fdö
, 
__fdout
, 
size_t
 
__Àn
,

376 
__Êags
);

382 #i‚de‡
__USE_FILE_OFFSET64


383 
	`ÁŒoˇã
 (
__fd
, 
__mode
, 
__off_t
 
__off£t
, __off_à
__Àn
);

385 #ifde‡
__REDIRECT


386 
	`__REDIRECT
 (
ÁŒoˇã
, (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

387 
__off64_t
 
__Àn
),

388 
ÁŒoˇã64
);

390 
	#ÁŒoˇã
 
ÁŒoˇã64


	)

393 #ifde‡
__USE_LARGEFILE64


394 
	`ÁŒoˇã64
 (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

395 
__off64_t
 
__Àn
);

400 
	$«me_to_h™dÀ_©
 (
__dfd
, c⁄° *
__«me
,

401 
fûe_h™dÀ
 *
__h™dÀ
, *
__m¡_id
,

402 
__Êags
Ë
__THROW
;

408 
	`›í_by_h™dÀ_©
 (
__mou¡dúfd
, 
fûe_h™dÀ
 *
__h™dÀ
,

409 
__Êags
);

413 
__END_DECLS


	@/usr/include/bits/libio-ldbl.h

19 #i‚de‡
_IO_STDIO_H


23 
	$__LDBL_REDIR_DECL
 (
_IO_vfsˇnf
)

24 
	`__LDBL_REDIR_DECL
 (
_IO_vÂrötf
)

	@/usr/include/bits/local_lim.h

24 #i‚de‡
NR_OPEN


25 
	#__undef_NR_OPEN


	)

27 #i‚de‡
LINK_MAX


28 
	#__undef_LINK_MAX


	)

30 #i‚de‡
OPEN_MAX


31 
	#__undef_OPEN_MAX


	)

33 #i‚de‡
ARG_MAX


34 
	#__undef_ARG_MAX


	)

38 
	~<löux/limôs.h
>

41 #ifde‡
__undef_NR_OPEN


42 #unde‡
NR_OPEN


43 #unde‡
__undef_NR_OPEN


46 #ifde‡
__undef_LINK_MAX


47 #unde‡
LINK_MAX


48 #unde‡
__undef_LINK_MAX


51 #ifde‡
__undef_OPEN_MAX


52 #unde‡
OPEN_MAX


53 #unde‡
__undef_OPEN_MAX


56 #ifde‡
__undef_ARG_MAX


57 #unde‡
ARG_MAX


58 #unde‡
__undef_ARG_MAX


62 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

64 
	#PTHREAD_KEYS_MAX
 1024

	)

67 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

69 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

72 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

74 #unde‡
PTHREAD_THREADS_MAX


78 
	#AIO_PRIO_DELTA_MAX
 20

	)

81 
	#PTHREAD_STACK_MIN
 16384

	)

84 
	#DELAYTIMER_MAX
 2147483647

	)

87 
	#TTY_NAME_MAX
 32

	)

90 
	#LOGIN_NAME_MAX
 256

	)

93 
	#HOST_NAME_MAX
 64

	)

96 
	#MQ_PRIO_MAX
 32768

	)

99 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/locale.h

19 #i‡!
deföed
 
_LOCALE_H
 && !deföed 
_LANGINFO_H


23 #i‚de‡
_BITS_LOCALE_H


24 
	#_BITS_LOCALE_H
 1

	)

26 
	#__LC_CTYPE
 0

	)

27 
	#__LC_NUMERIC
 1

	)

28 
	#__LC_TIME
 2

	)

29 
	#__LC_COLLATE
 3

	)

30 
	#__LC_MONETARY
 4

	)

31 
	#__LC_MESSAGES
 5

	)

32 
	#__LC_ALL
 6

	)

33 
	#__LC_PAPER
 7

	)

34 
	#__LC_NAME
 8

	)

35 
	#__LC_ADDRESS
 9

	)

36 
	#__LC_TELEPHONE
 10

	)

37 
	#__LC_MEASUREMENT
 11

	)

38 
	#__LC_IDENTIFICATION
 12

	)

	@/usr/include/bits/socket_type.h

19 #i‚de‡
_SYS_SOCKET_H


24 
	e__sockë_ty≥


26 
	mSOCK_STREAM
 = 1,

28 
	#SOCK_STREAM
 
SOCK_STREAM


	)

29 
	mSOCK_DGRAM
 = 2,

31 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

32 
	mSOCK_RAW
 = 3,

33 
	#SOCK_RAW
 
SOCK_RAW


	)

34 
	mSOCK_RDM
 = 4,

35 
	#SOCK_RDM
 
SOCK_RDM


	)

36 
	mSOCK_SEQPACKET
 = 5,

38 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

39 
	mSOCK_DCCP
 = 6,

40 
	#SOCK_DCCP
 
SOCK_DCCP


	)

41 
	mSOCK_PACKET
 = 10,

44 
	#SOCK_PACKET
 
SOCK_PACKET


	)

49 
	mSOCK_CLOEXEC
 = 02000000,

51 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

52 
	mSOCK_NONBLOCK
 = 00004000

54 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

	@/usr/include/bits/stdio-lock.h

19 #i‚de‡
_BITS_STDIO_LOCK_H


20 
	#_BITS_STDIO_LOCK_H
 1

	)

22 
	~<bôs/libc-lock.h
>

24 
	$__libc_lock_deföe_ªcursive
 (, 
_IO_lock_t
)

27 #ifde‡
	t_LIBC_LOCK_RECURSIVE_INITIALIZER


28 
	t_IO_lock_öôülizî
 
	t_LIBC_LOCK_RECURSIVE_INITIALIZER


	)

29 #ñi‡
	t_IO_MTSAFE_IO


30 #îr‹ 
	tlibio
 
	t√eds
 
	tªcursive
 
	tmuãxes
 
	t_IO_MTSAFE_IO


33 
	t_IO_lock_öô
(
	t_«me
Ë
	t__libc_lock_öô_ªcursive
 (_«me)

	)

34 
	t_IO_lock_föi
(
	t_«me
Ë
	t__libc_lock_föi_ªcursive
 (_«me)

	)

35 
	t_IO_lock_lock
(
	t_«me
Ë
	t__libc_lock_lock_ªcursive
 (_«me)

	)

36 
	t_IO_lock_åylock
(
	t_«me
Ë
	t__libc_lock_åylock_ªcursive
 (_«me)

	)

37 
	t_IO_lock_u∆ock
(
	t_«me
Ë
	t__libc_lock_u∆ock_ªcursive
 (_«me)

	)

40 
	t_IO_˛ónup_ªgi⁄_°¨t
(
	t_f˘
, 
	t_Â
) \

41 
	t__libc_˛ónup_ªgi⁄_°¨t
 (((
	t_Â
)->
	t_Êags
 & 
	t_IO_USER_LOCK
Ë=0, 
	t_f˘
, _Â)

	)

42 
	t_IO_˛ónup_ªgi⁄_°¨t_nﬂrg
(
	t_f˘
) \

43 
	t__libc_˛ónup_ªgi⁄_°¨t
 (1, 
	t_f˘
, 
	tNULL
)

	)

44 
	t_IO_˛ónup_ªgi⁄_íd
(
	t_doô
) \

45 
	t__libc_˛ónup_ªgi⁄_íd
 (
	t_doô
)

	)

47 #i‡
	tdeföed
 
	t_LIBC
 && 
	tIS_IN
 (
	tlibc
)

48 
	t_IO_acquúe_lock
(
	t_Â
) \

49 
	t_IO_˛ónup_ªgi⁄_°¨t
 (((*Ë(*)Ë
	t_IO_fu∆ockfûe
, (
	t_Â
)); \

50 
	`_IO_Êockfûe
 (
_Â
)

	)

52 
	#_IO_ªÀa£_lock
(
_Â
) \

53 
	`_IO_fu∆ockfûe
 (
_Â
); \

54 
	`_IO_˛ónup_ªgi⁄_íd
 (0)

	)

	@/usr/include/bits/syslog-ldbl.h

19 #i‚de‡
_SYS_SYSLOG_H


23 
	$__LDBL_REDIR_DECL
 (
sy¶og
)

25 #ifde‡
__USE_BSD


26 
	$__LDBL_REDIR_DECL
 (
vsy¶og
)

29 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


30 
	$__LDBL_REDIR_DECL
 (
__sy¶og_chk
)

32 #ifde‡
__USE_BSD


33 
	$__LDBL_REDIR_DECL
 (
__vsy¶og_chk
)

	@/usr/include/bits/syslog-path.h

19 #i‚de‡
_SYS_SYSLOG_H


23 #i‚de‡
_BITS_SYSLOG_PATH_H


24 
	#_BITS_SYSLOG_PATH_H
 1

	)

26 
	#_PATH_LOG
 "/dev/log"

	)

	@/usr/include/bits/syslog.h

19 #i‚de‡
_SYS_SYSLOG_H


24 
	$__sy¶og_chk
 (
__¥i
, 
__Êag
, c⁄° *
__fmt
, ...)

25 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

27 #ifde‡
__va_¨g_∑ck


28 
__f‹tify_fun˘i⁄
 

29 
	$sy¶og
 (
__¥i
, c⁄° *
__fmt
, ...)

31 
	`__sy¶og_chk
 (
__¥i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¨g_∑ck
 ());

32 
	}
}

33 #ñi‡!
deföed
 
__˝lu•lus


34 
	#sy¶og
(
¥i
, ...) \

35 
	`__sy¶og_chk
 (
¥i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

39 #ifde‡
__USE_BSD


40 
	$__vsy¶og_chk
 (
__¥i
, 
__Êag
, c⁄° *
__fmt
,

41 
__gnuc_va_li°
 
__≠
)

42 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

44 
__f‹tify_fun˘i⁄
 

45 
	$vsy¶og
 (
__¥i
, c⁄° *
__fmt
, 
__gnuc_va_li°
 
__≠
)

47 
	`__vsy¶og_chk
 (
__¥i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

48 
	}
}

	@/usr/include/bits/timex.h

18 #i‚def 
_BITS_TIMEX_H


19 
	#_BITS_TIMEX_H
 1

	)

21 
	~<bôs/ty≥s.h
>

25 
	stimex


27 
	mmodes
;

28 
__sysˇŒ_¶⁄g_t
 
	moff£t
;

29 
__sysˇŒ_¶⁄g_t
 
	m‰eq
;

30 
__sysˇŒ_¶⁄g_t
 
	mmaxîr‹
;

31 
__sysˇŒ_¶⁄g_t
 
	me°îr‹
;

32 
	m°©us
;

33 
__sysˇŒ_¶⁄g_t
 
	mc⁄°™t
;

34 
__sysˇŒ_¶⁄g_t
 
	m¥ecisi⁄
;

35 
__sysˇŒ_¶⁄g_t
 
	mtﬁî™˚
;

36 
timevÆ
 
	mtime
;

37 
__sysˇŒ_¶⁄g_t
 
	mtick
;

38 
__sysˇŒ_¶⁄g_t
 
	mµs‰eq
;

39 
__sysˇŒ_¶⁄g_t
 
	mjôãr
;

40 
	mshi·
;

41 
__sysˇŒ_¶⁄g_t
 
	m°abû
;

42 
__sysˇŒ_¶⁄g_t
 
	mjô˙t
;

43 
__sysˇŒ_¶⁄g_t
 
	mˇl˙t
;

44 
__sysˇŒ_¶⁄g_t
 
	mîr˙t
;

45 
__sysˇŒ_¶⁄g_t
 
	m°b˙t
;

47 
	mèi
;

56 
	#ADJ_OFFSET
 0x0001

	)

57 
	#ADJ_FREQUENCY
 0x0002

	)

58 
	#ADJ_MAXERROR
 0x0004

	)

59 
	#ADJ_ESTERROR
 0x0008

	)

60 
	#ADJ_STATUS
 0x0010

	)

61 
	#ADJ_TIMECONST
 0x0020

	)

62 
	#ADJ_TAI
 0x0080

	)

63 
	#ADJ_MICRO
 0x1000

	)

64 
	#ADJ_NANO
 0x2000

	)

65 
	#ADJ_TICK
 0x4000

	)

66 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

67 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

70 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

71 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

72 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

73 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

74 
	#MOD_STATUS
 
ADJ_STATUS


	)

75 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

76 
	#MOD_CLKB
 
ADJ_TICK


	)

77 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

78 
	#MOD_TAI
 
ADJ_TAI


	)

79 
	#MOD_MICRO
 
ADJ_MICRO


	)

80 
	#MOD_NANO
 
ADJ_NANO


	)

84 
	#STA_PLL
 0x0001

	)

85 
	#STA_PPSFREQ
 0x0002

	)

86 
	#STA_PPSTIME
 0x0004

	)

87 
	#STA_FLL
 0x0008

	)

89 
	#STA_INS
 0x0010

	)

90 
	#STA_DEL
 0x0020

	)

91 
	#STA_UNSYNC
 0x0040

	)

92 
	#STA_FREQHOLD
 0x0080

	)

94 
	#STA_PPSSIGNAL
 0x0100

	)

95 
	#STA_PPSJITTER
 0x0200

	)

96 
	#STA_PPSWANDER
 0x0400

	)

97 
	#STA_PPSERROR
 0x0800

	)

99 
	#STA_CLOCKERR
 0x1000

	)

100 
	#STA_NANO
 0x2000

	)

101 
	#STA_MODE
 0x4000

	)

102 
	#STA_CLK
 0x8000

	)

105 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

106 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@/usr/include/bits/typesizes.h

19 #i‚de‡
_BITS_TYPES_H


23 #i‚def 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifde‡
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 såu˘ { 
__vÆ
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

75 #ifde‡
__x86_64__


79 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

82 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/gnu/stubs.h

6 #i‡!
deföed
 
__x86_64__


7 
	~<gnu/°ubs-32.h
>

9 #i‡
deföed
 
__x86_64__
 && deföed 
__LP64__


10 
	~<gnu/°ubs-64.h
>

12 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


13 
	~<gnu/°ubs-x32.h
>

	@/usr/include/linux/errno.h

1 
	~<asm/î∫o.h
>

	@/usr/include/linux/limits.h

1 #i‚de‡
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/param.h

1 #i‚de‡
_LINUX_PARAM_H


2 
	#_LINUX_PARAM_H


	)

4 
	~<asm/∑øm.h
>

	@/usr/include/linux/stddef.h

	@/usr/include/linux/sysinfo.h

1 #i‚de‡
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<löux/ty≥s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysöfo
 {

8 
__kî√l_l⁄g_t
 
	mu±ime
;

9 
__kî√l_ul⁄g_t
 
	mlﬂds
[3];

10 
__kî√l_ul⁄g_t
 
	mtŸÆøm
;

11 
__kî√l_ul⁄g_t
 
	m‰ìøm
;

12 
__kî√l_ul⁄g_t
 
	msh¨edøm
;

13 
__kî√l_ul⁄g_t
 
	mbuf„ºam
;

14 
__kî√l_ul⁄g_t
 
	mtŸÆsw≠
;

15 
__kî√l_ul⁄g_t
 
	m‰ìsw≠
;

16 
__u16
 
	m¥ocs
;

17 
__u16
 
	m∑d
;

18 
__kî√l_ul⁄g_t
 
	mtŸÆhigh
;

19 
__kî√l_ul⁄g_t
 
	m‰ìhigh
;

20 
__u32
 
	mmem_unô
;

21 
	m_f
[20-2*(
__kî√l_ul⁄g_t
)-(
__u32
)];

	@/usr/include/net-snmp/agent/baby_steps.h

4 #i‚de‡
BABY_STEPS_H


5 
	#BABY_STEPS_H


	)

7 #ifde‡
__˝lu•lus


11 
	~<√t-¢mp/agít/agít_h™dÀr.h
>

16 
	#BABY_STEP_NONE
 0

	)

17 
	#BABY_STEP_PRE_REQUEST
 (0x1 << 1)

	)

18 
	#BABY_STEP_OBJECT_LOOKUP
 (0x1 << 2)

	)

19 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


20 
	#BABY_STEP_CHECK_VALUE
 (0x1 << 3)

	)

21 
	#BABY_STEP_ROW_CREATE
 (0x1 << 4)

	)

22 
	#BABY_STEP_UNDO_SETUP
 (0x1 << 5)

	)

23 
	#BABY_STEP_SET_VALUE
 (0x1 << 6)

	)

24 
	#BABY_STEP_CHECK_CONSISTENCY
 (0x1 << 7)

	)

25 
	#BABY_STEP_UNDO_SET
 (0x1 << 8)

	)

26 
	#BABY_STEP_COMMIT
 (0x1 << 9)

	)

27 
	#BABY_STEP_UNDO_COMMIT
 (0x1 << 10)

	)

28 
	#BABY_STEP_IRREVERSIBLE_COMMIT
 (0x1 << 11)

	)

29 
	#BABY_STEP_UNDO_CLEANUP
 (0x1 << 12)

	)

31 
	#BABY_STEP_POST_REQUEST
 (0x1 << 13)

	)

33 
	#BABY_STEP_ALL
 (0xffffffff)

	)

36 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


37 
	#BABY_STEP_CHECK_OBJECT
 
BABY_STEP_CHECK_VALUE


	)

38 
	#BABY_STEP_SET_VALUES
 
BABY_STEP_SET_VALUE


	)

39 
	#BABY_STEP_UNDO_SETS
 
BABY_STEP_UNDO_SET


	)

49 
	s√t¢mp_baby_°ïs_modes_s
 {

51 
ªf˙t
;

52 
u_öt
 
ªgi°îed
;

53 
u_öt
 
com∂ëed
;

54 } 
	t√t¢mp_baby_°ïs_modes
;

56 
√t¢mp_baby_°ïs_öô
();

58 
√t¢mp_mib_h™dÀr
 *
√t¢mp_baby_°ïs_h™dÀr_gë
(
u_l⁄g
 
modes
);

75 
	s√t¢mp_baby_°ïs_ac˚ss_mëhods_s
 {

80 
Në¢mp_Node_H™dÀr
 *
¥e_ªque°
;

81 
Në¢mp_Node_H™dÀr
 *
obje˘_lookup
;

82 
Në¢mp_Node_H™dÀr
 *
gë_vÆues
;

83 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


84 
Në¢mp_Node_H™dÀr
 *
obje˘_sy¡ax_checks
;

85 
Në¢mp_Node_H™dÀr
 *
row_¸óti⁄
;

86 
Në¢mp_Node_H™dÀr
 *
undo_£tup
;

87 
Në¢mp_Node_H™dÀr
 *
£t_vÆues
;

88 
Në¢mp_Node_H™dÀr
 *
c⁄si°ícy_checks
;

89 
Në¢mp_Node_H™dÀr
 *
commô
;

90 
Në¢mp_Node_H™dÀr
 *
undo_£ts
;

91 
Në¢mp_Node_H™dÀr
 *
undo_˛ónup
;

92 
Në¢mp_Node_H™dÀr
 *
undo_commô
;

93 
Në¢mp_Node_H™dÀr
 *
úªvîsibÀ_commô
;

95 
Në¢mp_Node_H™dÀr
 *
po°_ªque°
;

97 *
my_ac˚ss_void
;

99 } 
	t√t¢mp_baby_°ïs_ac˚ss_mëhods
;

101 
√t¢mp_mib_h™dÀr
 * 
√t¢mp_baby_°ïs_ac˚ss_mu…ùÀxî_gë
(

102 
√t¢mp_baby_°ïs_ac˚ss_mëhods
 *);

104 
√t¢mp_baby_°ï_mode2Êag
–
u_öt
 
mode
 );

110 
	#√t¢mp_gë_baby_°ïs_h™dÀr
 
√t¢mp_baby_°ïs_h™dÀr_gë


	)

111 
	#√t¢mp_öô_baby_°ïs_hñ≥r
 
√t¢mp_baby_°ïs_h™dÀr_öô


	)

114 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/bulk_to_next.h

4 #i‚de‡
BULK_TO_NEXT_H


5 
	#BULK_TO_NEXT_H


	)

7 #ifde‡
__˝lu•lus


18 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_bulk_to_√xt_h™dÀr
();

19 
√t¢mp_öô_bulk_to_√xt_hñ≥r
();

20 
√t¢mp_bulk_to_√xt_fix_ªque°s
(
√t¢mp_ªque°_öfo


21 *
ªque°s
);

23 
Në¢mp_Node_H™dÀr
 
√t¢mp_bulk_to_√xt_hñ≥r
;

25 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/cache_handler.h

11 #i‚de‡
NETSNMP_CACHE_HANDLER_H


12 
	#NETSNMP_CACHE_HANDLER_H


	)

21 
	~<√t-¢mp/libøry/toﬁs.h
>

23 #ifde‡
__˝lu•lus


27 
	#CACHE_NAME
 "ˇche_öfo"

	)

29 
√t¢mp_ˇche_s
 
	t√t¢mp_ˇche
;

31 (
Në¢mpCacheLﬂd
)(
	t√t¢mp_ˇche
 *, *);

32 (
Në¢mpCacheFªe
)(
	t√t¢mp_ˇche
 *, *);

34 
	s√t¢mp_ˇche_s
 {

36 
ªf˙t
;

40 
Êags
;

41 
íabÀd
;

42 
vÆid
;

43 
expúed
;

44 
timeout
;

45 
m¨kî_t
 
time°ampM
;

46 
u_l⁄g
 
timî_id
;

48 
Në¢mpCacheLﬂd
 *
lﬂd_ˇche
;

49 
Në¢mpCacheFªe
 *
‰ì_ˇche
;

55 *
magic
;

61 
√t¢mp_h™dÀr_¨gs
 *
ˇche_höt
;

66 
√t¢mp_ˇche
 *
√xt
, *
¥ev
;

67 
oid
 *
roŸoid
;

68 
roŸoid_Àn
;

73 
√t¢mp_ˇche_ªqöfo_ö£π
(
√t¢mp_ˇche
* 
ˇche
,

74 
√t¢mp_agít_ªque°_öfo
 * 
ªqöfo
,

75 c⁄° *
«me
);

76 
√t¢mp_ˇche
 *

77 
√t¢mp_ˇche_ªqöfo_exåa˘
(
√t¢mp_agít_ªque°_öfo
 * 
ªqöfo
,

78 c⁄° *
«me
);

79 
√t¢mp_ˇche
* 
√t¢mp_exåa˘_ˇche_öfo
(
√t¢mp_agít_ªque°_öfo
 *);

81 
√t¢mp_ˇche_check_™d_ªlﬂd
(
√t¢mp_ˇche
 * 
ˇche
);

82 
√t¢mp_ˇche_check_expúed
(
√t¢mp_ˇche
 *
ˇche
);

83 
√t¢mp_ˇche_is_vÆid
–
√t¢mp_agít_ªque°_öfo
 *,

84 c⁄° *
«me
);

86 
√t¢mp_is_ˇche_vÆid
–
√t¢mp_agít_ªque°_öfo
 *);

87 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_ˇche_h™dÀr
(, 
Në¢mpCacheLﬂd
 *,

88 
Në¢mpCacheFªe
 *,

89 c⁄° 
oid
*, );

90 
√t¢mp_ªgi°î_ˇche_h™dÀr
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

91 , 
Në¢mpCacheLﬂd
 *,

92 
Në¢mpCacheFªe
 *);

94 
Në¢mp_Node_H™dÀr
 
√t¢mp_ˇche_hñ≥r_h™dÀr
;

96 
√t¢mp_ˇche
 *

97 
√t¢mp_ˇche_¸óã
(
timeout
, 
Në¢mpCacheLﬂd
 * 
lﬂd_hook
,

98 
Në¢mpCacheFªe
 * 
‰ì_hook
,

99 c⁄° 
oid
 * 
roŸoid
, 
roŸoid_Àn
);

100 
√t¢mp_ˇche_ªmove
(
√t¢mp_ˇche
 *
ˇche
);

101 
√t¢mp_ˇche_‰ì
(
√t¢mp_ˇche
 *
ˇche
);

103 
√t¢mp_mib_h™dÀr
 *

104 
√t¢mp_ˇche_h™dÀr_gë
(
√t¢mp_ˇche
* 
ˇche
);

105 
√t¢mp_ˇche_h™dÀr_owns_ˇche
(
√t¢mp_mib_h™dÀr
 *
h™dÀr
);

107 
√t¢mp_ˇche
 * 
√t¢mp_ˇche_föd_by_oid
(c⁄° 
oid
 * 
roŸoid
,

108 
roŸoid_Àn
);

110 
√t¢mp_ˇche_timî_°¨t
(
√t¢mp_ˇche
 *
ˇche
);

111 
√t¢mp_ˇche_timî_°›
(
√t¢mp_ˇche
 *
ˇche
);

116 
	#NETSNMP_CACHE_DONT_INVALIDATE_ON_SET
 0x0001

	)

117 
	#NETSNMP_CACHE_DONT_FREE_BEFORE_LOAD
 0x0002

	)

118 
	#NETSNMP_CACHE_DONT_FREE_EXPIRED
 0x0004

	)

119 
	#NETSNMP_CACHE_DONT_AUTO_RELEASE
 0x0008

	)

120 
	#NETSNMP_CACHE_PRELOAD
 0x0010

	)

121 
	#NETSNMP_CACHE_AUTO_RELOAD
 0x0020

	)

122 
	#NETSNMP_CACHE_RESET_TIMER_ON_USE
 0x0040

	)

124 
	#NETSNMP_CACHE_HINT_HANDLER_ARGS
 0x1000

	)

127 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/debug_handler.h

1 #i‚de‡
DEBUG_HANDLER_H


2 
	#DEBUG_HANDLER_H


	)

4 #ifde‡
__˝lu•lus


8 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_debug_h™dÀr
();

9 
√t¢mp_öô_debug_hñ≥r
();

11 
Në¢mp_Node_H™dÀr
 
√t¢mp_debug_hñ≥r
;

13 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/instance.h

4 #i‚de‡
NETSNMP_INSTANCE_H


5 
	#NETSNMP_INSTANCE_H


	)

7 #ifde‡
__˝lu•lus


24 
√t¢mp_ªgi°î_ö°™˚
(
√t¢mp_h™dÀr_ªgi°øti⁄
 * 
ªgöfo
);

27 
√t¢mp_ªgi°î_ªad_⁄ly_ö°™˚
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
);

29 
	#INSTANCE_HANDLER_NAME
 "ö°™˚"

	)

31 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_ö°™˚_h™dÀr
();

34 
√t¢mp_ªgi°î_ªad_⁄ly_ul⁄g_ö°™˚
(c⁄° * 
«me
,

35 c⁄° 
oid
 * 
ªg_oid
,

36 
size_t
 
ªg_oid_Àn
,

37 
u_l⁄g
 * 
ô
,

38 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

40 
√t¢mp_ªgi°î_ul⁄g_ö°™˚
(c⁄° * 
«me
,

41 c⁄° 
oid
 * 
ªg_oid
,

42 
size_t
 
ªg_oid_Àn
,

43 
u_l⁄g
 * 
ô
,

44 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

46 
√t¢mp_ªgi°î_ªad_⁄ly_cou¡î32_ö°™˚
(c⁄° *
«me
,

47 c⁄° 
oid
 * 
ªg_oid
,

48 
size_t
 
ªg_oid_Àn
,

49 
u_l⁄g
 * 
ô
,

50 
Në¢mp_Node_H™dÀr
 *
subh™dÀr
);

52 
√t¢mp_ªgi°î_ªad_⁄ly_l⁄g_ö°™˚
(c⁄° *
«me
,

53 c⁄° 
oid
 * 
ªg_oid
,

54 
size_t
 
ªg_oid_Àn
,

55 *
ô
,

56 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

58 
√t¢mp_ªgi°î_l⁄g_ö°™˚
(c⁄° *
«me
,

59 c⁄° 
oid
 * 
ªg_oid
,

60 
size_t
 
ªg_oid_Àn
,

61 *
ô
,

62 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

65 
√t¢mp_ªgi°î_ªad_⁄ly_öt_ö°™˚
(c⁄° *
«me
,

66 c⁄° 
oid
 * 
ªg_oid
,

67 
size_t
 
ªg_oid_Àn
, *
ô
,

68 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

71 
√t¢mp_ªgi°î_öt_ö°™˚
(c⁄° *
«me
,

72 c⁄° 
oid
 * 
ªg_oid
,

73 
size_t
 
ªg_oid_Àn
, *
ô
,

74 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

78 
√t¢mp_ªgi°î_ªad_⁄ly_ul⁄g_ö°™˚_c⁄ãxt
(c⁄° *
«me
,

79 c⁄° 
oid
 * 
ªg_oid
,

80 
size_t
 
ªg_oid_Àn
,

81 
u_l⁄g
 * 
ô
,

82 
Në¢mp_Node_H™dÀr


83 * 
subh™dÀr
,

84 c⁄° *
c⁄ãxtName
);

86 
√t¢mp_ªgi°î_ul⁄g_ö°™˚_c⁄ãxt
(c⁄° *
«me
,

87 c⁄° 
oid
 * 
ªg_oid
,

88 
size_t
 
ªg_oid_Àn
,

89 
u_l⁄g
 * 
ô
,

90 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
,

91 c⁄° *
c⁄ãxtName
);

93 
√t¢mp_ªgi°î_ªad_⁄ly_cou¡î32_ö°™˚_c⁄ãxt
(c⁄° *
«me
,

94 c⁄° 
oid
 * 
ªg_oid
,

95 
size_t
 
ªg_oid_Àn
,

96 
u_l⁄g
 * 
ô
,

97 
Në¢mp_Node_H™dÀr


98 * 
subh™dÀr
,

99 c⁄° *
c⁄ãxtName
);

101 
√t¢mp_ªgi°î_ªad_⁄ly_l⁄g_ö°™˚_c⁄ãxt
(c⁄° *
«me
,

102 c⁄° 
oid
 * 
ªg_oid
,

103 
size_t
 
ªg_oid_Àn
,

104 *
ô
,

105 
Në¢mp_Node_H™dÀr


106 * 
subh™dÀr
,

107 c⁄° *
c⁄ãxtName
);

109 
√t¢mp_ªgi°î_l⁄g_ö°™˚_c⁄ãxt
(c⁄° *
«me
,

110 c⁄° 
oid
 * 
ªg_oid
,

111 
size_t
 
ªg_oid_Àn
,

112 *
ô
,

113 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
,

114 c⁄° *
c⁄ãxtName
);

117 
√t¢mp_ªgi°î_ªad_⁄ly_öt_ö°™˚_c⁄ãxt
(c⁄° *
«me
,

118 c⁄° 
oid
 * 
ªg_oid
,

119 
size_t
 
ªg_oid_Àn
, *
ô
,

120 
Në¢mp_Node_H™dÀr
 *

121 
subh™dÀr
,

122 c⁄° *
c⁄ãxtName
);

125 
√t¢mp_ªgi°î_öt_ö°™˚_c⁄ãxt
(c⁄° *
«me
,

126 c⁄° 
oid
 * 
ªg_oid
,

127 
size_t
 
ªg_oid_Àn
, *
ô
,

128 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
,

129 c⁄° *
c⁄ãxtName
);

132 
√t¢mp_ªgi°î_num_fûe_ö°™˚
(c⁄° *
«me
,

133 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

134 c⁄° *
fûe_«me
, 
a¢_ty≥
, 
mode
,

135 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
,

136 c⁄° *
c⁄ãxtName
);

138 
Në¢mp_Node_H™dÀr
 
√t¢mp_ö°™˚_hñ≥r_h™dÀr
;

139 
Në¢mp_Node_H™dÀr
 
√t¢mp_ö°™˚_num_fûe_h™dÀr
;

141 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/mfd.h

6 #i‚de‡
NETSNMP_MFD_H


7 
	#NETSNMP_MFD_H


	)

18 
	#MFD_SUCCESS
 
SNMP_ERR_NOERROR


	)

19 
	#MFD_ERROR
 
SNMP_ERR_GENERR


	)

24 
	#MFD_SKIP
 
SNMP_NOSUCHINSTANCE


	)

29 
	#MFD_END_OF_DATA
 
SNMP_ENDOFMIBVIEW


	)

37 
	#MFD_CANNOT_CREATE_NOW
 
SNMP_ERR_INCONSISTENTNAME


	)

38 
	#MFD_CANNOT_CREATE_EVER
 
SNMP_ERR_NOCREATION


	)

43 
	#MFD_NOT_WRITABLE
 
SNMP_ERR_NOTWRITABLE


	)

44 
	#MFD_RESOURCE_UNAVAILABLE
 
SNMP_ERR_RESOURCEUNAVAILABLE


	)

49 
	#MFD_NOT_VALID_NOW
 
SNMP_ERR_INCONSISTENTVALUE


	)

50 
	#MFD_NOT_VALID_EVER
 
SNMP_ERR_WRONGVALUE


	)

62 
	#MFD_ROW_FLAG_USER_1
 0x00000001

	)

63 
	#MFD_ROW_FLAG_USER_2
 0x00000002

	)

64 
	#MFD_ROW_FLAG_USER_3
 0x00000004

	)

65 
	#MFD_ROW_FLAG_USER_4
 0x00000008

	)

66 
	#MFD_ROW_FLAG_USER_5
 0x00000010

	)

67 
	#MFD_ROW_FLAG_USER_6
 0x00000020

	)

68 
	#MFD_ROW_FLAG_USER_7
 0x00000040

	)

69 
	#MFD_ROW_FLAG_USER_8
 0x00000080

	)

70 
	#MFD_ROW_FLAG_USER_MASK
 0x000000f‡

	)

77 
	#MFD_ROW_MASK
 0xffffff00

	)

78 
	#MFD_ROW_CREATED
 0x80000000

	)

79 
	#MFD_ROW_DATA_FROM_USER
 0x40000000

	)

80 
	#MFD_ROW_DELETED
 0x20000000

	)

81 
	#MFD_ROW_DIRTY
 0x10000000

	)

	@/usr/include/net-snmp/agent/mode_end_call.h

4 #i‚de‡
MODE_END_CALL_H


5 
	#MODE_END_CALL_H


	)

7 #ifde‡
__˝lu•lus


11 
	#NETSNMP_MODE_END_ALL_MODES
 -999

	)

13 
	s√t¢mp_mode_h™dÀr_li°_s
 {

14 
√t¢mp_mode_h™dÀr_li°_s
 *
√xt
;

15 
mode
;

16 
√t¢mp_mib_h™dÀr
 *
ˇŒback_h™dÀr
;

17 } 
	t√t¢mp_mode_h™dÀr_li°
;

25 
√t¢mp_mib_h™dÀr
 *

26 
√t¢mp_gë_mode_íd_ˇŒ_h™dÀr
(
√t¢mp_mode_h™dÀr_li°
 *
ídli°
);

28 
√t¢mp_mode_h™dÀr_li°
 *

29 
√t¢mp_mode_íd_ˇŒ_add_mode_ˇŒback
(
√t¢mp_mode_h™dÀr_li°
 *
ídli°
,

30 
mode
,

31 
√t¢mp_mib_h™dÀr
 *
ˇŒbackh
);

34 
Në¢mp_Node_H™dÀr
 
√t¢mp_mode_íd_ˇŒ_hñ≥r
;

36 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/multiplexer.h

1 #i‚de‡
NETSNMP_MULTIPLEXER_H


2 
	#NETSNMP_MULTIPLEXER_H


	)

4 #ifde‡
__˝lu•lus


18 
	s√t¢mp_mib_h™dÀr_mëhods_s
 {

20 
√t¢mp_mib_h™dÀr
 *
gë_h™dÀr
;

22 
√t¢mp_mib_h™dÀr
 *
gë√xt_h™dÀr
;

24 
√t¢mp_mib_h™dÀr
 *
gëbulk_h™dÀr
;

26 
√t¢mp_mib_h™dÀr
 *
£t_h™dÀr
;

27 } 
	t√t¢mp_mib_h™dÀr_mëhods
;

31 
√t¢mp_mib_h™dÀr


32 *
√t¢mp_gë_mu…ùÀxî_h™dÀr
(
√t¢mp_mib_h™dÀr_mëhods
 *);

34 
Në¢mp_Node_H™dÀr
 
√t¢mp_mu…ùÀxî_hñ≥r_h™dÀr
;

36 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/null.h

1 #i‚de‡
AGENT_NULL_H


2 
	#AGENT_NULL_H


	)

4 #ifde‡
__˝lu•lus


18 
√t¢mp_ªgi°î_nuŒ
(
oid
 *, 
size_t
);

19 
√t¢mp_ªgi°î_nuŒ_c⁄ãxt
(
oid
 *, 
size_t
, c⁄° *
c⁄ãxtName
);

21 
Në¢mp_Node_H™dÀr
 
√t¢mp_nuŒ_h™dÀr
;

23 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/old_api.h

1 #i‚de‡
OLD_API_H


2 
	#OLD_API_H


	)

4 #ifde‡
__˝lu•lus


8 
	#OLD_API_NAME
 "ﬁd_≠i"

	)

10 
	s√t¢mp_ﬁd_≠i_öfo_s
 {

11 
v¨übÀ
 *
v¨
;

12 
size_t
 
v¨size
;

13 
size_t
 
numv¨s
;

18 
√t¢mp_£ssi⁄
 *
ss
;

19 
Êags
;

20 } 
	t√t¢mp_ﬁd_≠i_öfo
;

22 
	sﬁd_›i_ˇche_s
 {

23 
u_ch¨
 *
d©a
;

24 
WrôeMëhod
 *
wrôe_mëhod
;

25 } 
	t√t¢mp_ﬁd_≠i_ˇche
;

27 
√t¢mp_ªgi°î_ﬁd_≠i
(c⁄° *
moduÀName
,

28 
v¨übÀ
 *
v¨
,

29 
size_t
 
v¨size
,

30 
size_t
 
numv¨s
,

31 c⁄° 
oid
 * 
mibloc
,

32 
size_t
 
miblo˛í
,

33 
¥i‹ôy
,

34 
ønge_subid
,

35 
oid
 
ønge_ubound
,

36 
√t¢mp_£ssi⁄
 * 
ss
,

37 c⁄° *
c⁄ãxt
,

38 
timeout
, 
Êags
);

39 
Në¢mp_Node_H™dÀr
 
√t¢mp_ﬁd_≠i_hñ≥r
;

44 
√t¢mp_agít_£ssi⁄
 *
√t¢mp_gë_cuºít_agít_£ssi⁄
();

46 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/read_only.h

1 #i‚de‡
READ_ONLY_H


2 
	#READ_ONLY_H


	)

4 #ifde‡
__˝lu•lus


20 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_ªad_⁄ly_h™dÀr
();

21 
√t¢mp_öô_ªad_⁄ly_hñ≥r
();

23 
Në¢mp_Node_H™dÀr
 
√t¢mp_ªad_⁄ly_hñ≥r
;

26 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/row_merge.h

1 #i‚de‡
ROW_MERGE_H


2 
	#ROW_MERGE_H


	)

10 #ifde‡
__˝lu•lus


14 
	s√t¢mp_row_mîge_°©us_x
 {

15 
cou¡
;

16 
rows
;

17 
cuºít
;

18 
ª£rved
;

20 
√t¢mp_ªque°_öfo
 **
ßved_ªque°s
;

21 *
ßved_°©us
;

22 } 
	t√t¢mp_row_mîge_°©us
;

24 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_row_mîge_h™dÀr
();

25 
√t¢mp_ªgi°î_row_mîge
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
);

26 
√t¢mp_öô_row_mîge
();

28 
√t¢mp_row_mîge_°©us_fú°
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

29 
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
);

30 
√t¢mp_row_mîge_°©us_œ°
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

31 
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
);

33 
Në¢mp_Node_H™dÀr
 
√t¢mp_row_mîge_hñ≥r_h™dÀr
;

35 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/scalar.h

4 #i‚de‡
NETSNMP_SCALAR_H


5 
	#NETSNMP_SCALAR_H


	)

7 #ifde‡
__˝lu•lus


23 
√t¢mp_ªgi°î_sˇœr
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
);

24 
√t¢mp_ªgi°î_ªad_⁄ly_sˇœr
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
);

26 
	#SCALAR_HANDLER_NAME
 "sˇœr"

	)

28 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_sˇœr_h™dÀr
();

30 
Në¢mp_Node_H™dÀr
 
√t¢mp_sˇœr_hñ≥r_h™dÀr
;

32 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/scalar_group.h

4 #i‚de‡
NETSNMP_SCALAR_GROUP_H


5 
	#NETSNMP_SCALAR_GROUP_H


	)

7 #ifde‡
__˝lu•lus


22 
	s√t¢mp_sˇœr_group_s
 {

23 
oid
 
lbound
;

24 
oid
 
ubound
;

25 } 
	t√t¢mp_sˇœr_group
;

27 
√t¢mp_ªgi°î_sˇœr_group
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

28 
oid
 
fú°
, oid 
œ°
);

29 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_sˇœr_group_h™dÀr
(
oid
 
fú°
, oid 
œ°
);

30 
Në¢mp_Node_H™dÀr
 
√t¢mp_sˇœr_group_hñ≥r_h™dÀr
;

32 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/serialize.h

1 #i‚de‡
SERIALIZE_H


2 
	#SERIALIZE_H


	)

10 #ifde‡
__˝lu•lus


14 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_£rülize_h™dÀr
();

15 
√t¢mp_ªgi°î_£rülize
(
√t¢mp_h™dÀr_ªgi°øti⁄


16 *
ªgöfo
);

17 
√t¢mp_öô_£rülize
();

19 
Në¢mp_Node_H™dÀr
 
√t¢mp_£rülize_hñ≥r_h™dÀr
;

21 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/snmp_get_statistic.h

1 #i‚de‡
SNMP_GET_STATISTIC_H


2 
	#SNMP_GET_STATISTIC_H


	)

12 
√t¢mp_ªgi°î_°©i°ic_h™dÀr
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

13 
oid
 
°¨t
, 
begö
, 
íd
);

15 
	#NETSNMP_REGISTER_STATISTIC_HANDLER
(
ªgöfo
, 
°¨t
, 
°©
) \

16 
	`√t¢mp_ªgi°î_°©i°ic_h™dÀr
(
ªgöfo
, 
°¨t
, \

17 
STAT_
 ## 
°©
 ## 
_STATS_START
, \

18 
STAT_
 ## 
°©
 ## 
_STATS_END
)

	)

	@/usr/include/net-snmp/agent/table.h

24 #i‚de‡
_TABLE_HANDLER_H_


25 
	#_TABLE_HANDLER_H_


	)

27 #ifde‡
__˝lu•lus


49 
	#TABLE_HANDLER_NAME
 "èbÀ"

	)

58 
	s√t¢mp_cﬁumn_öfo_t
 {

59 
isR™ge
;

61 
li°_cou¡
;

64 
ønge
[2];

65 *
li°
;

66 } 
dëaûs
;

68 
√t¢mp_cﬁumn_öfo_t
 *
√xt
;

70 } 
	t√t¢mp_cﬁumn_öfo
;

80 
	s√t¢mp_èbÀ_ªgi°øti⁄_öfo_s
 {

82 
√t¢mp_v¨übÀ_li°
 *
ödexes
;

84 
numbî_ödexes
;

91 
mö_cﬁumn
;

93 
max_cﬁumn
;

96 
√t¢mp_cﬁumn_öfo
 *
vÆid_cﬁumns
;

98 } 
	t√t¢mp_èbÀ_ªgi°øti⁄_öfo
;

108 
	s√t¢mp_èbÀ_ªque°_öfo_s
 {

110 
cﬁnum
;

112 
numbî_ödexes
;

114 
√t¢mp_v¨übÀ_li°
 *
ödexes
;

116 
oid
 
ödex_oid
[
MAX_OID_LEN
];

117 
size_t
 
ödex_oid_Àn
;

118 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
ªg_öfo
;

119 } 
	t√t¢mp_èbÀ_ªque°_öfo
;

121 
√t¢mp_mib_h™dÀr


122 *
√t¢mp_gë_èbÀ_h™dÀr
(
√t¢mp_èbÀ_ªgi°øti⁄_öfo


123 *
èbªq
);

124 
√t¢mp_h™dÀr_owns_èbÀ_öfo
(
√t¢mp_mib_h™dÀr
 *
h™dÀr
);

125 
√t¢mp_ªgi°øti⁄_owns_èbÀ_öfo
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªg
);

126 
√t¢mp_ªgi°î_èbÀ
–
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

127 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbªq
);

128 
√t¢mp_uƒegi°î_èbÀ
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
);

129 
√t¢mp_èbÀ_buûd_oid
–
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

130 
√t¢mp_ªque°_öfo
 *
ªqöfo
,

131 
√t¢mp_èbÀ_ªque°_öfo
 *
èbÀ_öfo
);

133 
√t¢mp_èbÀ_buûd_oid_‰om_ödex
(
√t¢mp_h™dÀr_ªgi°øti⁄


134 *
ªgöfo
,

135 
√t¢mp_ªque°_öfo
 *
ªqöfo
,

136 
√t¢mp_èbÀ_ªque°_öfo


137 *
èbÀ_öfo
);

138 
√t¢mp_èbÀ_buûd_ªsu…
(
√t¢mp_h™dÀr_ªgi°øti⁄


139 *
ªgöfo
,

140 
√t¢mp_ªque°_öfo


141 *
ªqöfo
,

142 
√t¢mp_èbÀ_ªque°_öfo


143 *
èbÀ_öfo
, 
u_ch¨
 
ty≥
,

144 
u_ch¨
 * 
ªsu…
,

145 
size_t
 
ªsu…_Àn
);

147 
√t¢mp_upd©e_v¨übÀ_li°_‰om_ödex
(
√t¢mp_èbÀ_ªque°_öfo


150 
√t¢mp_upd©e_ödexes_‰om_v¨übÀ_li°


151 (
√t¢mp_èbÀ_ªque°_öfo
 *
åi
);

152 
√t¢mp_èbÀ_ªgi°øti⁄_öfo


153 *
√t¢mp_föd_èbÀ_ªgi°øti⁄_öfo
(
√t¢mp_h™dÀr_ªgi°øti⁄


154 *
ªgöfo
);

155 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *

156 
√t¢mp_èbÀ_ªgi°øti⁄_öfo_˛⁄e
(
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
åi
);

157 
√t¢mp_èbÀ_ªgi°øti⁄_öfo_‰ì
(
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *);

159 
√t¢mp_ödex
 * 
√t¢mp_èbÀ_ödex_föd_√xt_row
(
√t¢mp_c⁄èöî
 *
c
,

160 
√t¢mp_èbÀ_ªque°_öfo
 *
tbÃeq
);

162 
√t¢mp_˛o£°_cﬁumn
(
cuºít
,

163 
√t¢mp_cﬁumn_öfo


164 *
vÆid_cﬁumns
);

166 
Në¢mp_Node_H™dÀr
 
èbÀ_hñ≥r_h™dÀr
;

168 
	#√t¢mp_èbÀ_hñ≥r_add_ödex
(
töfo
, 
ty≥
Ë
	`¢mp_v¨li°_add_v¨übÀ
(&töfo->
ödexes
, 
NULL
, 0, (
u_ch¨
Èy≥, NULL, 0);

	)

171 
√t¢mp_èbÀ_hñ≥r_add_ödexes
(
√t¢mp_èbÀ_ªgi°øti⁄_öfo


172 *
töfo
, ...);

174 
√t¢mp_check_gë√xt_ª∂y
(
√t¢mp_ªque°_öfo
 *
ªque°
,

175 
oid
 * 
¥efix
, 
size_t
 
¥efix_Àn
,

176 
√t¢mp_v¨übÀ_li°
 * 
√wv¨
,

177 
√t¢mp_v¨übÀ_li°
 ** 
outv¨
);

179 
√t¢mp_èbÀ_ªque°_öfo


180 *
√t¢mp_exåa˘_èbÀ_öfo
(
√t¢mp_ªque°_öfo
 *);

181 
√t¢mp_oid_°ash_node


182 **
√t¢mp_èbÀ_gë_‹_¸óã_row_°ash
(
√t¢mp_agít_ªque°_öfo


183 *
ªqöfo
,

184 c⁄° 
u_ch¨
 *

185 
°‹age_«me
);

187 
√t¢mp_èbÀ_√xt_cﬁumn
(
√t¢mp_èbÀ_ªque°_öfo
 *
èbÀ_öfo
);

190 
√t¢mp_•¨£_èbÀ_ªgi°î
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

191 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbªq
);

193 
√t¢mp_mib_h™dÀr
 *
√t¢mp_•¨£_èbÀ_h™dÀr_gë
();

195 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/table_array.h

5 #i‚de‡
_TABLE_ARRAY_HANDLER_H_


6 
	#_TABLE_ARRAY_HANDLER_H_


	)

8 #ifde‡
__˝lu•lus


26 
	~<√t-¢mp/libøry/c⁄èöî.h
>

27 
	~<√t-¢mp/agít/èbÀ.h
>

29 
	#TABLE_ARRAY_NAME
 "èbÀ_¨øy"

	)

35 
	s√t¢mp_ªque°_group_ôem_s
 {

36 
√t¢mp_ªque°_öfo
 *
ri
;

37 
√t¢mp_èbÀ_ªque°_öfo
 *
åi
;

38 
√t¢mp_ªque°_group_ôem_s
 *
√xt
;

39 } 
	t√t¢mp_ªque°_group_ôem
;

44 
	s√t¢mp_ªque°_group_s
 {

49 
√t¢mp_ödex
 
ödex
;

54 
√t¢mp_c⁄èöî
 *
èbÀ
;

59 
√t¢mp_ödex
 *
exi°ög_row
;

60 
√t¢mp_ödex
 *
undo_öfo
;

65 
row_¸óãd
;

66 
row_dñëed
;

67 
fûl1
;

68 
fûl2
;

73 
√t¢mp_ªque°_group_ôem
 *
li°
;

75 
°©us
;

77 *
rg_void
;

79 } 
	t√t¢mp_ªque°_group
;

81 (
Në¢mp_U£r_Row_O≥øti⁄_c
Ë(c⁄° *
	tlhs
,

82 c⁄° *
	trhs
);

83 (
Në¢mp_U£r_Row_O≥øti⁄
Ë(*
	tlhs
, *
	trhs
);

84 (
Në¢mp_U£r_Gë_Pro˚ss‹
Ë(
	t√t¢mp_ªque°_öfo
 *,

85 
	t√t¢mp_ödex


87 
	t√t¢mp_èbÀ_ªque°_öfo


89 
√t¢mp_ödex


90 *(
	tU£rRowMëhod
Ë(
	t√t¢mp_ödex
 *);

91 (
Në¢mp_U£r_Row_A˘i⁄
Ë(
	t√t¢mp_ödex
 *,

92 
	t√t¢mp_ödex
 *,

93 
	t√t¢mp_ªque°_group
 *);

94 (
Në¢mp_U£r_Group_Mëhod
Ë(
	t√t¢mp_ªque°_group
 *);

99 
	s√t¢mp_èbÀ_¨øy_ˇŒbacks_s
 {

101 
Në¢mp_U£r_Row_O≥øti⁄
 *
row_c›y
;

102 
Në¢mp_U£r_Row_O≥øti⁄_c
 *
row_com∑ª
;

104 
Në¢mp_U£r_Gë_Pro˚ss‹
 *
gë_vÆue
;

107 
Në¢mp_U£r_Row_A˘i⁄
 *
ˇn_a˘iv©e
;

108 
Në¢mp_U£r_Row_A˘i⁄
 *
a˘iv©ed
;

109 
Në¢mp_U£r_Row_A˘i⁄
 *
ˇn_dó˘iv©e
;

110 
Në¢mp_U£r_Row_A˘i⁄
 *
dó˘iv©ed
;

111 
Në¢mp_U£r_Row_A˘i⁄
 *
ˇn_dñëe
;

113 
U£rRowMëhod
 *
¸óã_row
;

114 
U£rRowMëhod
 *
du∂iˇã_row
;

115 
U£rRowMëhod
 *
dñëe_row
;

117 
Në¢mp_U£r_Group_Mëhod
 *
£t_ª£rve1
;

118 
Në¢mp_U£r_Group_Mëhod
 *
£t_ª£rve2
;

119 
Në¢mp_U£r_Group_Mëhod
 *
£t_a˘i⁄
;

120 
Në¢mp_U£r_Group_Mëhod
 *
£t_commô
;

121 
Në¢mp_U£r_Group_Mëhod
 *
£t_‰ì
;

122 
Në¢mp_U£r_Group_Mëhod
 *
£t_undo
;

125 
√t¢mp_c⁄èöî
* 
c⁄èöî
;

126 
ˇn_£t
;

128 } 
	t√t¢mp_èbÀ_¨øy_ˇŒbacks
;

132 
√t¢mp_èbÀ_c⁄èöî_ªgi°î
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

133 
√t¢mp_èbÀ_ªgi°øti⁄_öfo


134 *
èbªq
,

135 
√t¢mp_èbÀ_¨øy_ˇŒbacks
 *
cb
,

136 
√t¢mp_c⁄èöî
 *
c⁄èöî
,

137 
group_rows
);

139 
√t¢mp_èbÀ_¨øy_ªgi°î
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

140 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbªq
,

141 
√t¢mp_èbÀ_¨øy_ˇŒbacks
 *
cb
,

142 
√t¢mp_c⁄èöî
 *
c⁄èöî
,

143 
group_rows
);

145 
√t¢mp_c⁄èöî
 * 
√t¢mp_exåa˘_¨øy_c⁄ãxt
(
√t¢mp_ªque°_öfo
 *);

147 
Në¢mp_Node_H™dÀr
 
√t¢mp_èbÀ_¨øy_hñ≥r_h™dÀr
;

150 
√t¢mp_èbÀ_¨øy_check_row_°©us
(
√t¢mp_èbÀ_¨øy_ˇŒbacks
 *
cb
,

151 
√t¢mp_ªque°_group
 *
ag
,

152 *
rs_√w
, *
rs_ﬁd
);

154 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/table_container.h

5 #i‚de‡
_TABLE_CONTAINER_HANDLER_H_


6 
	#_TABLE_CONTAINER_HANDLER_H_


	)

8 #ifde‡
__˝lu•lus


26 
	~<√t-¢mp/libøry/c⁄èöî.h
>

27 
	~<√t-¢mp/agít/èbÀ.h
>

29 
	#TABLE_CONTAINER_ROW
 "èbÀ_c⁄èöî:row"

	)

30 
	#TABLE_CONTAINER_CONTAINER
 "èbÀ_c⁄èöî:c⁄èöî"

	)

32 
	#TABLE_CONTAINER_KEY_NETSNMP_INDEX
 1

	)

33 
	#TABLE_CONTAINER_KEY_VARBIND_INDEX
 2

	)

34 
	#TABLE_CONTAINER_KEY_VARBIND_RAW
 3

	)

43 
√t¢mp_mib_h™dÀr
 *

44 
√t¢mp_c⁄èöî_èbÀ_h™dÀr_gë
(
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbªq
,

45 
√t¢mp_c⁄èöî
 *
c⁄èöî
,

46 
key_ty≥
);

51 
√t¢mp_c⁄èöî_èbÀ_ªgi°î
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

52 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbªq
,

53 
√t¢mp_c⁄èöî
 *
c⁄èöî
,

54 
key_ty≥
);

56 
√t¢mp_c⁄èöî_èbÀ_uƒegi°î
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
);

59 
√t¢mp_c⁄èöî
*

60 
√t¢mp_c⁄èöî_èbÀ_c⁄èöî_exåa˘
(
√t¢mp_ªque°_öfo
 *
ªque°
);

63 #ifde‡
NETSNMP_USE_INLINE


64 
NETSNMP_STATIC_INLINE
 *

65 
√t¢mp_c⁄èöî_èbÀ_row_exåa˘
(
√t¢mp_ªque°_öfo
 *
ªque°
)

71  
√t¢mp_ªque°_gë_li°_d©a
(
ªque°
, 
TABLE_CONTAINER_ROW
);

74 
NETSNMP_STATIC_INLINE
 *

75 
√t¢mp_c⁄èöî_èbÀ_exåa˘_c⁄ãxt
(
√t¢mp_ªque°_öfo
 *
ªque°
)

81  
√t¢mp_ªque°_gë_li°_d©a
(
ªque°
, 
TABLE_CONTAINER_ROW
);

85 
√t¢mp_c⁄èöî_èbÀ_row_exåa˘
(
√t¢mp_ªque°_öfo
 *
ªque°
);

87 
√t¢mp_c⁄èöî_èbÀ_exåa˘_c⁄ãxt
(
√t¢mp_ªque°_öfo
 *
ªque°
);

90 
√t¢mp_c⁄èöî_èbÀ_row_ö£π
(
√t¢mp_ªque°_öfo
 *
ªque°
,

91 
√t¢mp_ödex
 *
row
);

92 
√t¢mp_c⁄èöî_èbÀ_row_ªmove
(
√t¢mp_ªque°_öfo
 *
ªque°
,

93 
√t¢mp_ödex
 *
row
);

100 
√t¢mp_c⁄èöî_èbÀ_föd_√xt_row
(
√t¢mp_ªque°_öfo
 *
ªque°
,

101 
√t¢mp_èbÀ_ªque°_öfo
 *
tbÃeq
,

102 
√t¢mp_c⁄èöî
 *
c⁄èöî
,

103 
key_ty≥
 );

104 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/table_data.h

4 #i‚de‡
_TABLE_DATA_HANDLER_H_


5 
	#_TABLE_DATA_HANDLER_H_


	)

7 #ifde‡
__˝lu•lus


19 
	#TABLE_DATA_NAME
 "èbÀ_d©a"

	)

20 
	#TABLE_DATA_ROW
 "èbÀ_d©a"

	)

21 
	#TABLE_DATA_TABLE
 "èbÀ_d©a_èbÀ"

	)

23 
	s√t¢mp_èbÀ_row_s
 {

24 
√t¢mp_v¨übÀ_li°
 *
ödexes
;

25 
oid
 *
ödex_oid
;

26 
size_t
 
ödex_oid_Àn
;

27 *
d©a
;

29 
√t¢mp_èbÀ_row_s
 *
√xt
, *
¥ev
;

30 } 
	t√t¢mp_èbÀ_row
;

32 
	s√t¢mp_èbÀ_d©a_s
 {

33 
√t¢mp_v¨übÀ_li°
 *
ödexes_ãm∂©e
;

34 *
«me
;

35 
Êags
;

36 
°‹e_ödexes
;

37 
√t¢mp_èbÀ_row
 *
fú°_row
;

38 
√t¢mp_èbÀ_row
 *
œ°_row
;

39 } 
	t√t¢mp_èbÀ_d©a
;

45 
√t¢mp_èbÀ_d©a_gíî©e_ödex_oid
–
√t¢mp_èbÀ_row
 *
row
);

47 
√t¢mp_èbÀ_d©a
 *
√t¢mp_¸óã_èbÀ_d©a
(c⁄° *
«me
);

48 
√t¢mp_èbÀ_row
 *
√t¢mp_¸óã_èbÀ_d©a_row
();

49 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_˛⁄e_row
–√t¢mp_èbÀ_row *
row
);

50 *
√t¢mp_èbÀ_d©a_dñëe_row
(
√t¢mp_èbÀ_row
 *
row
);

51 
√t¢mp_èbÀ_d©a_add_row
–
√t¢mp_èbÀ_d©a
 *
èbÀ
,

52 
√t¢mp_èbÀ_row
 *
row
);

54 
√t¢mp_èbÀ_d©a_ª∂a˚_row
(
√t¢mp_èbÀ_d©a
 *
èbÀ
,

55 
√t¢mp_èbÀ_row
 *
‹igrow
,

56 
√t¢mp_èbÀ_row
 *
√wrow
);

57 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_ªmove_row
(
√t¢mp_èbÀ_d©a
 *
èbÀ
,

58 
√t¢mp_èbÀ_row
 *
row
);

59 *
√t¢mp_èbÀ_d©a_ªmove_™d_dñëe_row
(
√t¢mp_èbÀ_d©a
 *
èbÀ
,

60 
√t¢mp_èbÀ_row
 *
row
);

61 
√t¢mp_èbÀ_d©a_dñëe_èbÀ
–
√t¢mp_èbÀ_d©a
 *
èbÀ
 );

67 
√t¢mp_mib_h™dÀr
 *

68 
√t¢mp_gë_èbÀ_d©a_h™dÀr
(
√t¢mp_èbÀ_d©a
 *
èbÀ
);

70 
√t¢mp_ªgi°î_èbÀ_d©a
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

71 
√t¢mp_èbÀ_d©a
 *
èbÀ
,

72 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbÀ_öfo
);

73 
√t¢mp_ªgi°î_ªad_⁄ly_èbÀ_d©a
(

74 
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

75 
√t¢mp_èbÀ_d©a
 *
èbÀ
,

76 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbÀ_öfo
);

77 
Në¢mp_Node_H™dÀr
 
√t¢mp_èbÀ_d©a_hñ≥r_h™dÀr
;

79 
√t¢mp_èbÀ_d©a
 *
√t¢mp_exåa˘_èbÀ
–
√t¢mp_ªque°_öfo
 *);

80 
√t¢mp_èbÀ_row
 *
√t¢mp_exåa˘_èbÀ_row
(
√t¢mp_ªque°_öfo
 *);

81 *
√t¢mp_exåa˘_èbÀ_row_d©a
(
√t¢mp_ªque°_öfo
 *);

82 
√t¢mp_ö£π_èbÀ_row
(
√t¢mp_ªque°_öfo
 *, 
√t¢mp_èbÀ_row
 *);

84 
√t¢mp_èbÀ_d©a_buûd_ªsu…
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

85 
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
,

86 
√t¢mp_ªque°_öfo
 *
ªque°
,

87 
√t¢mp_èbÀ_row
 *
row
, 
cﬁumn
,

88 
u_ch¨
 
ty≥
, u_ch¨ * 
ªsu…_d©a
,

89 
size_t
 
ªsu…_d©a_Àn
);

95 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_gë_fú°_row
(

96 
√t¢mp_èbÀ_d©a
 *
èbÀ
);

97 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_gë_√xt_row
(

98 
√t¢mp_èbÀ_d©a
 *
èbÀ
,

99 
√t¢mp_èbÀ_row
 *
row
);

101 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_gë
(
√t¢mp_èbÀ_d©a
 *
èbÀ
,

102 
√t¢mp_v¨übÀ_li°
 *
ödexes
);

104 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_gë_‰om_oid
(

105 
√t¢mp_èbÀ_d©a
 *
èbÀ
,

106 
oid
 * 
£¨chf‹
,

107 
size_t
 
£¨chf‹_Àn
);

109 
√t¢mp_èbÀ_d©a_num_rows
(
√t¢mp_èbÀ_d©a
 *
èbÀ
);

116 
	#√t¢mp_èbÀ_d©a_add_ödex
(
thëabÀ
, 
ty≥
Ë
	`¢mp_v¨li°_add_v¨übÀ
(&thëabÀ->
ödexes_ãm∂©e
, 
NULL
, 0,Åy≥, NULL, 0)

	)

117 
	#√t¢mp_èbÀ_row_add_ödex
(
row
, 
ty≥
, 
vÆue
, 
vÆue_Àn
Ë
	`¢mp_v¨li°_add_v¨übÀ
(&row->
ödexes
, 
NULL
, 0,Åy≥, (c⁄° 
u_ch¨
 *ËvÆue, vÆue_Àn)

	)

120 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/table_dataset.h

4 #i‚de‡
_TABLE_DATA_SET_HANDLER_H_


5 
	#_TABLE_DATA_SET_HANDLER_H_


	)

7 #ifde‡
__˝lu•lus


19 
√t¢mp_öô_èbÀ_d©a£t
();

21 
	#TABLE_DATA_SET_NAME
 "√t¢mp_èbÀ_d©a_£t"

	)

26 (
Në¢mp_VÆue_Ch™ge_Ok
Ë(*
	tﬁd_vÆue
,

27 
	tsize_t
 
	tﬁd_vÆue_Àn
,

28 *
	t√w_vÆue
,

29 
	tsize_t
 
	t√w_vÆue_Àn
,

30 *
	tmyd©a
);

35 
	s√t¢mp_èbÀ_d©a_£t_°‹age_s
 {

36 
cﬁumn
;

41 
wrôabÀ
;

42 
Në¢mp_VÆue_Ch™ge_Ok
 *
ch™ge_ok_‚
;

43 *
my_ch™ge_d©a
;

48 
u_ch¨
 
ty≥
;

50 *
voidp
;

51 *
öãgî
;

52 
u_ch¨
 *
°rög
;

53 
oid
 *
objid
;

54 
u_ch¨
 *
bô°rög
;

55 
cou¡î64
 *counter64;

56 #ifde‡
NETSNMP_WITH_OPAQUE_SPECIAL_TYPES


57 *
ÊﬂtVÆ
;

58 *
doubÀVÆ
;

60 } 
d©a
;

61 
u_l⁄g
 
d©a_Àn
;

63 
√t¢mp_èbÀ_d©a_£t_°‹age_s
 *
√xt
;

64 } 
	t√t¢mp_èbÀ_d©a_£t_°‹age
;

66 
	s√t¢mp_èbÀ_d©a_£t_s
 {

67 
√t¢mp_èbÀ_d©a
 *
èbÀ
;

68 
√t¢mp_èbÀ_d©a_£t_°‹age
 *
deÁu…_row
;

69 
Ælow_¸óti⁄
;

70 
row°©us_cﬁumn
;

71 } 
	t√t¢mp_èbÀ_d©a_£t
;

78 
√t¢mp_èbÀ_d©a_£t
 *
√t¢mp_¸óã_èbÀ_d©a_£t
(const *);

79 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_£t_˛⁄e_row
–√t¢mp_èbÀ_row *
row
);

80 
√t¢mp_èbÀ_d©a£t_dñëe_Æl_d©a
(

81 
√t¢mp_èbÀ_d©a_£t_°‹age
 *
d©a
);

82 
√t¢mp_èbÀ_d©a£t_dñëe_row
(
√t¢mp_èbÀ_row
 *
row
);

84 
√t¢mp_èbÀ_d©a£t_add_row
(
√t¢mp_èbÀ_d©a_£t


85 *
èbÀ
,

86 
√t¢mp_èbÀ_row
 *
row
);

88 
√t¢mp_èbÀ_d©a£t_ª∂a˚_row
(
√t¢mp_èbÀ_d©a_£t
 *
èbÀ
,

89 
√t¢mp_èbÀ_row
 *
‹igrow
,

90 
√t¢mp_èbÀ_row
 *
√wrow
);

91 
√t¢mp_èbÀ_d©a£t_ªmove_row
(
√t¢mp_èbÀ_d©a_£t


92 *
èbÀ
,

93 
√t¢mp_èbÀ_row
 *
row
);

95 
√t¢mp_èbÀ_d©a£t_ªmove_™d_dñëe_row
(
√t¢mp_èbÀ_d©a_£t


96 *
èbÀ
,

97 
√t¢mp_èbÀ_row
 *
row
);

98 
√t¢mp_dñëe_èbÀ_d©a_£t
(
√t¢mp_èbÀ_d©a_£t
 *
èbÀ_£t
);

112 
√t¢mp_èbÀ_£t_add_deÁu…_row
(
√t¢mp_èbÀ_d©a_£t
 *,

114 *
deÁu…_vÆue
,

115 
size_t
 
deÁu…_vÆue_Àn
);

116 
√t¢mp_èbÀ_£t_mu…i_add_deÁu…_row
(
√t¢mp_èbÀ_d©a_£t
 *,

124 
√t¢mp_mib_h™dÀr


125 *
√t¢mp_gë_èbÀ_d©a_£t_h™dÀr
(
√t¢mp_èbÀ_d©a_£t
 *);

126 
Në¢mp_Node_H™dÀr
 
√t¢mp_èbÀ_d©a_£t_hñ≥r_h™dÀr
;

127 
√t¢mp_ªgi°î_èbÀ_d©a_£t
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *,

128 
√t¢mp_èbÀ_d©a_£t
 *,

129 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *);

130 
√t¢mp_èbÀ_d©a_£t


131 *
√t¢mp_exåa˘_èbÀ_d©a_£t
(
√t¢mp_ªque°_öfo
 *
ªque°
);

132 
√t¢mp_èbÀ_d©a_£t_°‹age


133 *
√t¢mp_exåa˘_èbÀ_d©a_£t_cﬁumn
(
√t¢mp_ªque°_öfo
 *,

135 
√t¢mp_oid_°ash_node
 **

136 
√t¢mp_èbÀ_d©a£t_gë_‹_¸óã_°ash
(
√t¢mp_agít_ªque°_öfo
 *
¨i
,

137 
√t¢mp_èbÀ_d©a_£t
 *
tds
,

138 
√t¢mp_èbÀ_ªque°_öfo
 *
åi
);

139 
√t¢mp_èbÀ_row
 *

140 
√t¢mp_èbÀ_d©a£t_gë_√wrow
(
√t¢mp_ªque°_öfo
 *
ªque°
,

141 
√t¢mp_agít_ªque°_öfo
 *
ªqöfo
,

142 
roŸoid_Àn
,

143 
√t¢mp_èbÀ_d©a_£t
 *
d©©abÀ
,

144 
√t¢mp_èbÀ_ªque°_öfo
 *
èbÀ_öfo
);

151 
√t¢mp_ªgi°î_auto_d©a_èbÀ
(
√t¢mp_èbÀ_d©a_£t
 *
èbÀ_£t
,

152 *
ªgi°øti⁄_«me
);

153 
√t¢mp_uƒegi°î_auto_d©a_èbÀ
(
√t¢mp_èbÀ_d©a_£t
 *
èbÀ_£t
,

154 *
ªgi°øti⁄_«me
);

155 
√t¢mp_c⁄fig_∑r£_èbÀ_£t
(c⁄° *
tokí
, *
löe
);

156 
√t¢mp_c⁄fig_∑r£_add_row
–c⁄° *
tokí
, *
löe
);

163 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_£t_gë_fú°_row
(
√t¢mp_èbÀ_d©a_£t
 *
èbÀ
);

164 
√t¢mp_èbÀ_row
 *
√t¢mp_èbÀ_d©a_£t_gë_√xt_row
–
√t¢mp_èbÀ_d©a_£t
 *
èbÀ
,

165 
√t¢mp_èbÀ_row
 *
row
);

166 
√t¢mp_èbÀ_£t_num_rows
(
√t¢mp_èbÀ_d©a_£t
 *
èbÀ
);

173 
√t¢mp_èbÀ_d©a_£t_°‹age


174 *
√t¢mp_èbÀ_d©a_£t_föd_cﬁumn
(
√t¢mp_èbÀ_d©a_£t_°‹age
 *,

176 
√t¢mp_m¨k_row_cﬁumn_wrôabÀ
–
√t¢mp_èbÀ_row
 *
row
,

177 
cﬁumn
, 
wrôabÀ
);

178 
√t¢mp_£t_row_cﬁumn
–
√t¢mp_èbÀ_row
 *,

180 
size_t
);

186 
√t¢mp_èbÀ_d©a£t_add_ödex
(
√t¢mp_èbÀ_d©a_£t


187 *
èbÀ
, 
u_ch¨
 
ty≥
);

188 
√t¢mp_èbÀ_£t_add_ödexes
(
√t¢mp_èbÀ_d©a_£t
 *
t£t
, ...);

190 #ifde‡
__˝lu•lus


194 
	#√t¢mp_èbÀ_row_add_cﬁumn
(
row
, 
ty≥
, 
vÆue
, 
vÆue_Àn
Ë
	`¢mp_v¨li°_add_v¨übÀ
(&row->
ödexes
, 
NULL
, 0,Åy≥, (
u_ch¨
 *ËvÆue, vÆue_Àn)

	)

	@/usr/include/net-snmp/agent/table_iterator.h

16 #i‚de‡
_TABLE_ITERATOR_HANDLER_H_


17 
	#_TABLE_ITERATOR_HANDLER_H_


	)

19 #ifde‡
__˝lu•lus


23 
√t¢mp_ôî©‹_öfo_s
;

25 
√t¢mp_v¨übÀ_li°
 *

26 (
	tNë¢mp_Fú°_D©a_Poöt
Ë(**
	tlo›_c⁄ãxt
,

27 **
	td©a_c⁄ãxt
,

28 
	t√t¢mp_v¨übÀ_li°
 *,

29 
	t√t¢mp_ôî©‹_öfo_s
 *);

30 
√t¢mp_v¨übÀ_li°
 *

31 (
	tNë¢mp_Next_D©a_Poöt
Ë(**
	tlo›_c⁄ãxt
,

32 **
	td©a_c⁄ãxt
,

33 
	t√t¢mp_v¨übÀ_li°
 *,

34 
	t√t¢mp_ôî©‹_öfo_s
 *);

35 *(
	tNë¢mp_Make_D©a_C⁄ãxt
Ë(*
	tlo›_c⁄ãxt
,

36 
	t√t¢mp_ôî©‹_öfo_s
 *);

37 (
Në¢mp_Fªe_Lo›_C⁄ãxt
) (*,

38 
	t√t¢mp_ôî©‹_öfo_s
 *);

39 (
Në¢mp_Fªe_D©a_C⁄ãxt
) (*,

40 
	t√t¢mp_ôî©‹_öfo_s
 *);

53 
	s√t¢mp_ôî©‹_öfo_s
 {

55 
ªf˙t
;

60 
Në¢mp_Fú°_D©a_Poöt
 *
gë_fú°_d©a_poöt
;

65 
Në¢mp_Next_D©a_Poöt
 *
gë_√xt_d©a_poöt
;

71 
Në¢mp_Make_D©a_C⁄ãxt
 *
make_d©a_c⁄ãxt
;

78 
Në¢mp_Fªe_Lo›_C⁄ãxt
 *
‰ì_lo›_c⁄ãxt
;

85 
Në¢mp_Fªe_D©a_C⁄ãxt
 *
‰ì_d©a_c⁄ãxt
;

93 
Në¢mp_Fªe_Lo›_C⁄ãxt
 *
‰ì_lo›_c⁄ãxt_©_íd
;

97 *
myvoid
;

98 
Êags
;

99 
	#NETSNMP_ITERATOR_FLAG_SORTED
 0x01

	)

100 
	#NETSNMP_HANDLER_OWNS_IINFO
 0x02

	)

104 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbÀ_ªgöfo
;

108 
Në¢mp_Fú°_D©a_Poöt
 *
gë_row_ödexes
;

109 
√t¢mp_v¨übÀ_li°
 *
ödexes
;

110 } 
	t√t¢mp_ôî©‹_öfo
;

112 
	#TABLE_ITERATOR_NAME
 "èbÀ_ôî©‹"

	)

123 
√t¢mp_h™dÀr_owns_ôî©‹_öfo
(
√t¢mp_mib_h™dÀr
 *
h
);

124 
√t¢mp_mib_h™dÀr


125 *
√t¢mp_gë_èbÀ_ôî©‹_h™dÀr
(
√t¢mp_ôî©‹_öfo
 *
iöfo
);

126 
√t¢mp_ªgi°î_èbÀ_ôî©‹
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

127 
√t¢mp_ôî©‹_öfo
 *
iöfo
);

128 
√t¢mp_ôî©‹_dñëe_èbÀ
(
√t¢mp_ôî©‹_öfo
 *
iöfo
);

130 *
√t¢mp_exåa˘_ôî©‹_c⁄ãxt
(
√t¢mp_ªque°_öfo
 *);

131 
√t¢mp_ö£π_ôî©‹_c⁄ãxt
(
√t¢mp_ªque°_öfo
 *, *);

133 
Në¢mp_Node_H™dÀr
 
√t¢mp_èbÀ_ôî©‹_hñ≥r_h™dÀr
;

135 
	#√t¢mp_ªgi°î_èbÀ_ôî©‹2
(
ªgöfo
, 
iöfo
) \

136 (((
iöfo
)->
Êags
 |
NETSNMP_HANDLER_OWNS_IINFO
), \

137 
	`√t¢mp_ªgi°î_èbÀ_ôî©‹
((
ªgöfo
), (
iöfo
)))

	)

144 *
√t¢mp_ôî©‹_row_fú°
–
√t¢mp_ôî©‹_öfo
 *);

145 *
√t¢mp_ôî©‹_row_gë
–
√t¢mp_ôî©‹_öfo
 *, *);

146 *
√t¢mp_ôî©‹_row_√xt
–
√t¢mp_ôî©‹_öfo
 *, *);

147 *
√t¢mp_ôî©‹_row_gë_byidx
–
√t¢mp_ôî©‹_öfo
 *,

148 
√t¢mp_v¨übÀ_li°
 *);

149 *
√t¢mp_ôî©‹_row_√xt_byidx
–
√t¢mp_ôî©‹_öfo
 *,

150 
√t¢mp_v¨übÀ_li°
 *);

151 *
√t¢mp_ôî©‹_row_gë_byoid
–
√t¢mp_ôî©‹_öfo
 *, 
oid
 *, 
size_t
);

152 *
√t¢mp_ôî©‹_row_√xt_byoid
–
√t¢mp_ôî©‹_öfo
 *, 
oid
 *, 
size_t
);

153 
√t¢mp_ôî©‹_row_cou¡
–
√t¢mp_ôî©‹_öfo
 *);

160 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/table_tdata.h

4 #i‚de‡
_TABLE_TDATA_HANDLER_H_


5 
	#_TABLE_TDATA_HANDLER_H_


	)

7 #ifde‡
__˝lu•lus


19 
	#TABLE_TDATA_NAME
 "èbÀ_td©a"

	)

20 
	#TABLE_TDATA_ROW
 "èbÀ_td©a"

	)

21 
	#TABLE_TDATA_TABLE
 "èbÀ_td©a_èbÀ"

	)

23 
	#TDATA_FLAG_NO_STORE_INDEXES
 0x01

	)

24 
	#TDATA_FLAG_NO_CONTAINER
 0x02

	)

34 
	s√t¢mp_td©a_row_s
 {

35 
√t¢mp_ödex
 
oid_ödex
;

36 
√t¢mp_v¨übÀ_li°
 *
ödexes
;

37 *
d©a
;

38 } 
	t√t¢mp_td©a_row
;

46 
	s√t¢mp_td©a_s
 {

47 
√t¢mp_v¨übÀ_li°
 *
ödexes_ãm∂©e
;

48 *
«me
;

49 
Êags
;

50 
√t¢mp_c⁄èöî
 *
c⁄èöî
;

51 } 
	t√t¢mp_td©a
;

54 
√t¢mp_td©a_row_s
 
	t√t¢mp_èbÀ_d©a2row
;

55 
√t¢mp_td©a_s
 
	t√t¢mp_èbÀ_d©a2
;

62 
√t¢mp_td©a
 *
√t¢mp_td©a_¸óã_èbÀ
(c⁄° *
«me
, 
Êags
);

63 
√t¢mp_td©a_dñëe_èbÀ
(
√t¢mp_td©a
 *
èbÀ
);

64 
√t¢mp_td©a_row
 *
√t¢mp_td©a_¸óã_row
();

65 
√t¢mp_td©a_row
 *
√t¢mp_td©a_˛⁄e_row
–√t¢mp_td©a_row *
row
);

66 
√t¢mp_td©a_c›y_row
–
√t¢mp_td©a_row
 *
d°_row
,

67 
√t¢mp_td©a_row
 *
§c_row
);

68 *
√t¢mp_td©a_dñëe_row
–
√t¢mp_td©a_row
 *
row
);

70 
√t¢mp_td©a_add_row
–
√t¢mp_td©a
 *
èbÀ
,

71 
√t¢mp_td©a_row
 *
row
);

72 
√t¢mp_td©a_ª∂a˚_row
–
√t¢mp_td©a
 *
èbÀ
,

73 
√t¢mp_td©a_row
 *
‹igrow
,

74 
√t¢mp_td©a_row
 *
√wrow
);

75 
√t¢mp_td©a_row
 *
√t¢mp_td©a_ªmove_row
(
√t¢mp_td©a
 *
èbÀ
,

76 
√t¢mp_td©a_row
 *
row
);

77 *
√t¢mp_td©a_ªmove_™d_dñëe_row
(
√t¢mp_td©a
 *
èbÀ
,

78 
√t¢mp_td©a_row
 *
row
);

85 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_td©a_h™dÀr
(
√t¢mp_td©a
 *
èbÀ
);

87 
√t¢mp_td©a_ªgi°î
–
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

88 
√t¢mp_td©a
 *
èbÀ
,

89 
√t¢mp_èbÀ_ªgi°øti⁄_öfo
 *
èbÀ_öfo
);

90 
√t¢mp_td©a_uƒegi°î
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
);

92 
√t¢mp_td©a
 *
√t¢mp_td©a_exåa˘_èbÀ
–
√t¢mp_ªque°_öfo
 *);

93 
√t¢mp_c⁄èöî
 *
√t¢mp_td©a_exåa˘_c⁄èöî
(
√t¢mp_ªque°_öfo
 *);

94 
√t¢mp_td©a_row
 *
√t¢mp_td©a_exåa˘_row
–
√t¢mp_ªque°_öfo
 *);

95 *
√t¢mp_td©a_exåa˘_íåy
–
√t¢mp_ªque°_öfo
 *);

97 
√t¢mp_ö£π_td©a_row
(
√t¢mp_ªque°_öfo
 *, 
√t¢mp_td©a_row
 *);

98 
√t¢mp_ªmove_td©a_row
(
√t¢mp_ªque°_öfo
 *, 
√t¢mp_td©a_row
 *);

105 * 
√t¢mp_td©a_row_íåy
–
√t¢mp_td©a_row
 *
row
 );

106 
√t¢mp_td©a_row
 *
√t¢mp_td©a_row_fú°
(
√t¢mp_td©a
 *
èbÀ
);

107 
√t¢mp_td©a_row
 *
√t¢mp_td©a_row_gë
–
√t¢mp_td©a
 *
èbÀ
,

108 
√t¢mp_td©a_row
 *
row
);

109 
√t¢mp_td©a_row
 *
√t¢mp_td©a_row_√xt
–
√t¢mp_td©a
 *
èbÀ
,

110 
√t¢mp_td©a_row
 *
row
);

112 
√t¢mp_td©a_row
 *
√t¢mp_td©a_row_gë_byidx
(
√t¢mp_td©a
 *
èbÀ
,

113 
√t¢mp_v¨übÀ_li°
 *
ödexes
);

114 
√t¢mp_td©a_row
 *
√t¢mp_td©a_row_gë_byoid
(
√t¢mp_td©a
 *
èbÀ
,

115 
oid
 *
£¨chf‹
,

116 
size_t
 
£¨chf‹_Àn
);

117 
√t¢mp_td©a_row
 *
√t¢mp_td©a_row_√xt_byidx
(
√t¢mp_td©a
 *
èbÀ
,

118 
√t¢mp_v¨übÀ_li°
 *
ödexes
);

119 
√t¢mp_td©a_row
 *
√t¢mp_td©a_row_√xt_byoid
(
√t¢mp_td©a
 *
èbÀ
,

120 
oid
 *
£¨chf‹
,

121 
size_t
 
£¨chf‹_Àn
);

123 
√t¢mp_td©a_row_cou¡
(
√t¢mp_td©a
 *
èbÀ
);

130 
	#√t¢mp_td©a_add_ödex
(
thëabÀ
, 
ty≥
Ë
	`¢mp_v¨li°_add_v¨übÀ
(&thëabÀ->
ödexes_ãm∂©e
, 
NULL
, 0,Åy≥, NULL, 0)

	)

131 
	#√t¢mp_td©a_row_add_ödex
(
row
, 
ty≥
, 
vÆue
, 
vÆue_Àn
Ë
	`¢mp_v¨li°_add_v¨übÀ
(&row->
ödexes
, 
NULL
, 0,Åy≥, (c⁄° 
u_ch¨
 *ËvÆue, vÆue_Àn)

	)

133 
√t¢mp_td©a_com∑ª_idx
–
√t¢mp_td©a_row
 *
row
,

134 
√t¢mp_v¨übÀ_li°
 *
ödexes
);

135 
√t¢mp_td©a_com∑ª_oid
–
√t¢mp_td©a_row
 *
row
,

136 
oid
 *
com∑ªto
, 
size_t
 
com∑ªto_Àn
);

137 
√t¢mp_td©a_com∑ª_subåì_idx
(
√t¢mp_td©a_row
 *
row
,

138 
√t¢mp_v¨übÀ_li°
 *
ödexes
);

139 
√t¢mp_td©a_com∑ª_subåì_oid
(
√t¢mp_td©a_row
 *
row
,

140 
oid
 *
com∑ªto
, 
size_t
 
com∑ªto_Àn
);

143 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/agent/watcher.h

4 #i‚de‡
NETSNMP_WATCHER_H


5 
	#NETSNMP_WATCHER_H


	)

7 #ifde‡
__˝lu•lus


21 
	#NETSNMP_WATCHER_DIRECT
 
MIB_HANDLER_CUSTOM1


	)

26 
	#WATCHER_FIXED_SIZE
 0x01

	)

32 
	#WATCHER_MAX_SIZE
 0x02

	)

38 
	#WATCHER_SIZE_IS_PTR
 0x04

	)

45 
	#WATCHER_SIZE_STRLEN
 0x08

	)

52 
	#WATCHER_SIZE_UNIT_OIDS
 0x10

	)

54 
	s√t¢mp_w©chî_öfo_s
 {

55 *
d©a
;

56 
size_t
 
d©a_size
;

57 
size_t
 
max_size
;

58 
u_ch¨
 
ty≥
;

59 
Êags
;

60 
size_t
 *
d©a_size_p
;

61 } 
	t√t¢mp_w©chî_öfo
;

65 
√t¢mp_ªgi°î_w©ched_ö°™˚
–
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

66 
√t¢mp_w©chî_öfo
 *
wöfo
);

67 
√t¢mp_ªgi°î_w©ched_ö°™˚2
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

68 
√t¢mp_w©chî_öfo
 *
wöfo
);

69 
√t¢mp_ªgi°î_w©ched_sˇœr
–
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

70 
√t¢mp_w©chî_öfo
 *
wöfo
);

71 
√t¢mp_ªgi°î_w©ched_sˇœr2
–
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

72 
√t¢mp_w©chî_öfo
 *
wöfo
);

73 
√t¢mp_ªgi°î_w©ched_time°amp
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

74 
m¨kî_t
 
time°amp
);

75 
√t¢mp_w©ched_time°amp_ªgi°î
(
√t¢mp_mib_h™dÀr
 *
wh™dÀr
,

76 
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

77 
m¨kî_t
 
time°amp
);

78 
√t¢mp_ªgi°î_w©ched_•ölock
(
√t¢mp_h™dÀr_ªgi°øti⁄
 *
ªgöfo
,

79 *
•ölock
);

85 
√t¢mp_ªgi°î_ul⁄g_sˇœr
(c⁄° *
«me
,

86 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

87 
u_l⁄g
 * 
ô
,

88 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

89 
√t¢mp_ªgi°î_ªad_⁄ly_ul⁄g_sˇœr
(c⁄° *
«me
,

90 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

91 
u_l⁄g
 * 
ô
,

92 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

93 
√t¢mp_ªgi°î_l⁄g_sˇœr
(c⁄° *
«me
,

94 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

95 * 
ô
,

96 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

97 
√t¢mp_ªgi°î_ªad_⁄ly_l⁄g_sˇœr
(c⁄° *
«me
,

98 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

99 * 
ô
,

100 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

101 
√t¢mp_ªgi°î_öt_sˇœr
(c⁄° *
«me
,

102 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

103 * 
ô
,

104 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

105 
√t¢mp_ªgi°î_ªad_⁄ly_öt_sˇœr
(c⁄° *
«me
,

106 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

107 * 
ô
,

108 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

109 
√t¢mp_ªgi°î_ªad_⁄ly_cou¡î32_sˇœr
(c⁄° *
«me
,

110 c⁄° 
oid
 * 
ªg_oid
, 
size_t
 
ªg_oid_Àn
,

111 
u_l⁄g
 * 
ô
,

112 
Në¢mp_Node_H™dÀr
 * 
subh™dÀr
);

114 
	#WATCHER_HANDLER_NAME
 "w©chî"

	)

116 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_w©chî_h™dÀr
();

118 
√t¢mp_w©chî_öfo
 *

119 
√t¢mp_öô_w©chî_öfo
(
√t¢mp_w©chî_öfo
 *, *, 
size_t
, 
u_ch¨
, );

121 
√t¢mp_w©chî_öfo
 *

122 
√t¢mp_öô_w©chî_öfo6
(
√t¢mp_w©chî_öfo
 *,

123 *, 
size_t
, 
u_ch¨
, , size_t, size_t*);

125 
√t¢mp_w©chî_öfo
 *

126 
√t¢mp_¸óã_w©chî_öfo
(*, 
size_t
, 
u_ch¨
, );

128 
√t¢mp_w©chî_öfo
 *

129 
√t¢mp_¸óã_w©chî_öfo6
(*, 
size_t
, 
u_ch¨
, , size_t, size_t*);

131 
√t¢mp_w©chî_öfo
 *

132 
√t¢mp_˛⁄e_w©chî_öfo
(
√t¢mp_w©chî_öfo
 *
wöfo
);

134 
√t¢mp_owns_w©chî_öfo
(
√t¢mp_mib_h™dÀr
 *
h™dÀr
);

136 
Në¢mp_Node_H™dÀr
 
√t¢mp_w©chî_hñ≥r_h™dÀr
;

138 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_w©ched_time°amp_h™dÀr
();

139 
Në¢mp_Node_H™dÀr
 
√t¢mp_w©ched_time°amp_h™dÀr
;

141 
√t¢mp_mib_h™dÀr
 *
√t¢mp_gë_w©ched_•ölock_h™dÀr
();

142 
Në¢mp_Node_H™dÀr
 
√t¢mp_w©ched_•ölock_h™dÀr
;

144 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/asn1.h

1 #i‚de‡
ASN1_H


2 
	#ASN1_H


	)

4 
	~<√t-¢mp/libøry/oid.h
>

6 #ifde‡
__˝lu•lus


10 
	#PARSE_PACKET
 0

	)

11 
	#DUMP_PACKET
 1

	)

42 
	#MIN_OID_LEN
 2

	)

43 
	#MAX_OID_LEN
 128

	)

44 #i‚de‡
MAX_NAME_LEN


45 
	#MAX_NAME_LEN
 
MAX_OID_LEN


	)

48 
	#OID_LENGTH
(
x
Ë((x)/(
oid
))

	)

51 
	#ASN_BOOLEAN
 ((
u_ch¨
)0x01)

	)

52 
	#ASN_INTEGER
 ((
u_ch¨
)0x02)

	)

53 
	#ASN_BIT_STR
 ((
u_ch¨
)0x03)

	)

54 
	#ASN_OCTET_STR
 ((
u_ch¨
)0x04)

	)

55 
	#ASN_NULL
 ((
u_ch¨
)0x05)

	)

56 
	#ASN_OBJECT_ID
 ((
u_ch¨
)0x06)

	)

57 
	#ASN_SEQUENCE
 ((
u_ch¨
)0x10)

	)

58 
	#ASN_SET
 ((
u_ch¨
)0x11)

	)

60 
	#ASN_UNIVERSAL
 ((
u_ch¨
)0x00)

	)

61 
	#ASN_APPLICATION
 ((
u_ch¨
)0x40)

	)

62 
	#ASN_CONTEXT
 ((
u_ch¨
)0x80)

	)

63 
	#ASN_PRIVATE
 ((
u_ch¨
)0xC0)

	)

65 
	#ASN_PRIMITIVE
 ((
u_ch¨
)0x00)

	)

66 
	#ASN_CONSTRUCTOR
 ((
u_ch¨
)0x20)

	)

68 
	#ASN_LONG_LEN
 (0x80)

	)

69 
	#ASN_EXTENSION_ID
 (0x1F)

	)

70 
	#ASN_BIT8
 (0x80)

	)

72 
	#IS_CONSTRUCTOR
(
byã
Ë((byãË& 
ASN_CONSTRUCTOR
)

	)

73 
	#IS_EXTENSION_ID
(
byã
Ë(((byãË& 
ASN_EXTENSION_ID
Ë=ASN_EXTENSION_ID)

	)

75 
	scou¡î64
 {

76 
u_l⁄g
 
high
;

77 
u_l⁄g
 
low
;

80 #ifde‡
NETSNMP_WITH_OPAQUE_SPECIAL_TYPES


81 
cou¡î64
 
	töãgî64
;

82 
cou¡î64
 
	tunsig√d64
;

101 
	#ASN_OPAQUE_TAG1
 (
ASN_CONTEXT
 | 
ASN_EXTENSION_ID
)

	)

106 
	#ASN_OPAQUE_TAG2
 ((
u_ch¨
)0x30)

	)

108 
	#ASN_OPAQUE_TAG2U
 ((
u_ch¨
)0x2fË

	)

115 
	#ASN_APP_OPAQUE
 (
ASN_APPLICATION
 | 4)

	)

116 
	#ASN_APP_COUNTER64
 (
ASN_APPLICATION
 | 6)

	)

117 
	#ASN_APP_FLOAT
 (
ASN_APPLICATION
 | 8)

	)

118 
	#ASN_APP_DOUBLE
 (
ASN_APPLICATION
 | 9)

	)

119 
	#ASN_APP_I64
 (
ASN_APPLICATION
 | 10)

	)

120 
	#ASN_APP_U64
 (
ASN_APPLICATION
 | 11)

	)

121 
	#ASN_APP_UNION
 (
ASN_PRIVATE
 | 1Ë

	)

126 
	#ASN_OPAQUE_COUNTER64
 (
ASN_OPAQUE_TAG2
 + 
ASN_APP_COUNTER64
)

	)

130 
	#ASN_OPAQUE_COUNTER64_MX_BER_LEN
 12

	)

135 
	#ASN_OPAQUE_FLOAT
 (
ASN_OPAQUE_TAG2
 + 
ASN_APP_FLOAT
)

	)

139 
	#ASN_OPAQUE_FLOAT_BER_LEN
 7

	)

144 
	#ASN_OPAQUE_DOUBLE
 (
ASN_OPAQUE_TAG2
 + 
ASN_APP_DOUBLE
)

	)

148 
	#ASN_OPAQUE_DOUBLE_BER_LEN
 11

	)

153 
	#ASN_OPAQUE_I64
 (
ASN_OPAQUE_TAG2
 + 
ASN_APP_I64
)

	)

157 
	#ASN_OPAQUE_I64_MX_BER_LEN
 11

	)

162 
	#ASN_OPAQUE_U64
 (
ASN_OPAQUE_TAG2
 + 
ASN_APP_U64
)

	)

166 
	#ASN_OPAQUE_U64_MX_BER_LEN
 12

	)

171 
	#ASN_PRIV_INCL_RANGE
 (
ASN_PRIVATE
 | 2)

	)

172 
	#ASN_PRIV_EXCL_RANGE
 (
ASN_PRIVATE
 | 3)

	)

173 
	#ASN_PRIV_DELEGATED
 (
ASN_PRIVATE
 | 5)

	)

174 
	#ASN_PRIV_IMPLIED_OCTET_STR
 (
ASN_PRIVATE
 | 
ASN_OCTET_STR
Ë

	)

175 
	#ASN_PRIV_IMPLIED_OBJECT_ID
 (
ASN_PRIVATE
 | 
ASN_OBJECT_ID
Ë

	)

176 
	#ASN_PRIV_RETRY
 (
ASN_PRIVATE
 | 7Ë

	)

177 
	#IS_DELEGATED
(
x
Ë((xË=
ASN_PRIV_DELEGATED
)

	)

180 
a¢_check_∑ckë
(
u_ch¨
 *, 
size_t
);

181 
NETSNMP_IMPORT


182 
u_ch¨
 *
a¢_∑r£_öt
(u_ch¨ *, 
size_t
 *, u_char *, *,

183 
size_t
);

184 
NETSNMP_IMPORT


185 
u_ch¨
 *
a¢_buûd_öt
(u_ch¨ *, 
size_t
 *, u_char, const *,

186 
size_t
);

187 
NETSNMP_IMPORT


188 
u_ch¨
 *
a¢_∑r£_unsig√d_öt
(u_ch¨ *, 
size_t
 *, u_char *,

189 
u_l⁄g
 *, 
size_t
);

190 
NETSNMP_IMPORT


191 
u_ch¨
 *
a¢_buûd_unsig√d_öt
(u_ch¨ *, 
size_t
 *, u_char,

192 c⁄° 
u_l⁄g
 *, 
size_t
);

193 
NETSNMP_IMPORT


194 
u_ch¨
 *
a¢_∑r£_°rög
(u_ch¨ *, 
size_t
 *, u_char *,

195 
u_ch¨
 *, 
size_t
 *);

196 
NETSNMP_IMPORT


197 
u_ch¨
 *
a¢_buûd_°rög
(u_ch¨ *, 
size_t
 *, u_char,

198 c⁄° 
u_ch¨
 *, 
size_t
);

199 
NETSNMP_IMPORT


200 
u_ch¨
 *
a¢_∑r£_hódî
(u_ch¨ *, 
size_t
 *, u_char *);

201 
u_ch¨
 *
a¢_∑r£_£quí˚
(u_ch¨ *, 
size_t
 *, u_ch¨ *, u_ch¨ 
ex≥˘ed_ty≥
,

202 c⁄° *
e°r
);

203 
NETSNMP_IMPORT


204 
u_ch¨
 *
a¢_buûd_hódî
(u_ch¨ *, 
size_t
 *, u_char, size_t);

205 
NETSNMP_IMPORT


206 
u_ch¨
 *
a¢_buûd_£quí˚
(u_ch¨ *, 
size_t
 *, u_char, size_t);

207 
NETSNMP_IMPORT


208 
u_ch¨
 *
a¢_∑r£_Àngth
(u_ch¨ *, 
u_l⁄g
 *);

209 
NETSNMP_IMPORT


210 
u_ch¨
 *
a¢_buûd_Àngth
(u_ch¨ *, 
size_t
 *, size_t);

211 
NETSNMP_IMPORT


212 
u_ch¨
 *
a¢_∑r£_objid
(u_ch¨ *, 
size_t
 *, u_ch¨ *, 
oid
 *,

213 
size_t
 *);

214 
NETSNMP_IMPORT


215 
u_ch¨
 *
a¢_buûd_objid
(u_ch¨ *, 
size_t
 *, u_ch¨, 
oid
 *,

216 
size_t
);

217 
NETSNMP_IMPORT


218 
u_ch¨
 *
a¢_∑r£_nuŒ
(u_ch¨ *, 
size_t
 *, u_char *);

219 
NETSNMP_IMPORT


220 
u_ch¨
 *
a¢_buûd_nuŒ
(u_ch¨ *, 
size_t
 *, u_char);

221 
NETSNMP_IMPORT


222 
u_ch¨
 *
a¢_∑r£_bô°rög
(u_ch¨ *, 
size_t
 *, u_char *,

223 
u_ch¨
 *, 
size_t
 *);

224 
NETSNMP_IMPORT


225 
u_ch¨
 *
a¢_buûd_bô°rög
(u_ch¨ *, 
size_t
 *, u_char,

226 c⁄° 
u_ch¨
 *, 
size_t
);

227 
NETSNMP_IMPORT


228 
u_ch¨
 *
a¢_∑r£_unsig√d_öt64
(u_ch¨ *, 
size_t
 *, u_char *,

229 
cou¡î64
 *, 
size_t
);

230 
NETSNMP_IMPORT


231 
u_ch¨
 *
a¢_buûd_unsig√d_öt64
(u_ch¨ *, 
size_t
 *, u_char,

232 c⁄° 
cou¡î64
 *, 
size_t
);

233 
u_ch¨
 *
a¢_∑r£_sig√d_öt64
(u_ch¨ *, 
size_t
 *, u_char *,

234 
cou¡î64
 *, 
size_t
);

235 
u_ch¨
 *
a¢_buûd_sig√d_öt64
(u_ch¨ *, 
size_t
 *, u_char,

236 c⁄° 
cou¡î64
 *, 
size_t
);

237 
u_ch¨
 *
a¢_buûd_Êﬂt
(u_ch¨ *, 
size_t
 *, u_char, const *,

238 
size_t
);

239 
u_ch¨
 *
a¢_∑r£_Êﬂt
(u_ch¨ *, 
size_t
 *, u_char *, *,

240 
size_t
);

241 
u_ch¨
 *
a¢_buûd_doubÀ
(u_ch¨ *, 
size_t
 *, u_char, const *,

242 
size_t
);

243 
u_ch¨
 *
a¢_∑r£_doubÀ
(u_ch¨ *, 
size_t
 *, u_char *,

244 *, 
size_t
);

246 #ifde‡
NETSNMP_USE_REVERSE_ASNENCODING


252 
a¢_ªÆloc
(
u_ch¨
 **, 
size_t
 *);

359 
a¢_ªÆloc_rbuûd_öt
(
u_ch¨
 ** 
pkt
, 
size_t
 * 
pkt_Àn
,

360 
size_t
 * 
off£t
,

361 
Ælow_ªÆloc
, 
u_ch¨
 
ty≥
,

362 c⁄° *
d©a
, 
size_t
 
d©a_size
);

364 
a¢_ªÆloc_rbuûd_°rög
(
u_ch¨
 ** 
pkt
,

365 
size_t
 * 
pkt_Àn
,

366 
size_t
 * 
off£t
,

367 
Ælow_ªÆloc
,

368 
u_ch¨
 
ty≥
,

369 c⁄° 
u_ch¨
 * 
d©a
,

370 
size_t
 
d©a_size
);

372 
a¢_ªÆloc_rbuûd_unsig√d_öt
(
u_ch¨
 ** 
pkt
,

373 
size_t
 * 
pkt_Àn
,

374 
size_t
 * 
off£t
,

375 
Ælow_ªÆloc
,

376 
u_ch¨
 
ty≥
,

377 c⁄° 
u_l⁄g
 * 
d©a
,

378 
size_t
 
d©a_size
);

380 
a¢_ªÆloc_rbuûd_hódî
(
u_ch¨
 ** 
pkt
,

381 
size_t
 * 
pkt_Àn
,

382 
size_t
 * 
off£t
,

383 
Ælow_ªÆloc
,

384 
u_ch¨
 
ty≥
,

385 
size_t
 
d©a_size
);

387 
a¢_ªÆloc_rbuûd_£quí˚
(
u_ch¨
 ** 
pkt
,

388 
size_t
 * 
pkt_Àn
,

389 
size_t
 * 
off£t
,

390 
Ælow_ªÆloc
,

391 
u_ch¨
 
ty≥
,

392 
size_t
 
d©a_size
);

394 
a¢_ªÆloc_rbuûd_Àngth
(
u_ch¨
 ** 
pkt
,

395 
size_t
 * 
pkt_Àn
,

396 
size_t
 * 
off£t
,

397 
Ælow_ªÆloc
,

398 
size_t
 
d©a_size
);

400 
a¢_ªÆloc_rbuûd_objid
(
u_ch¨
 ** 
pkt
,

401 
size_t
 * 
pkt_Àn
,

402 
size_t
 * 
off£t
,

403 
Ælow_ªÆloc
,

404 
u_ch¨
 
ty≥
, c⁄° 
oid
 *,

405 
size_t
);

407 
a¢_ªÆloc_rbuûd_nuŒ
(
u_ch¨
 ** 
pkt
,

408 
size_t
 * 
pkt_Àn
,

409 
size_t
 * 
off£t
,

410 
Ælow_ªÆloc
,

411 
u_ch¨
 
ty≥
);

413 
a¢_ªÆloc_rbuûd_bô°rög
(
u_ch¨
 ** 
pkt
,

414 
size_t
 * 
pkt_Àn
,

415 
size_t
 * 
off£t
,

416 
Ælow_ªÆloc
,

417 
u_ch¨
 
ty≥
,

418 c⁄° 
u_ch¨
 * 
d©a
,

419 
size_t
 
d©a_size
);

421 
a¢_ªÆloc_rbuûd_unsig√d_öt64
(
u_ch¨
 ** 
pkt
,

422 
size_t
 * 
pkt_Àn
,

423 
size_t
 * 
off£t
,

424 
Ælow_ªÆloc
,

425 
u_ch¨
 
ty≥
,

426 
cou¡î64


427 c⁄° *
d©a
, 
size_t
);

429 
a¢_ªÆloc_rbuûd_sig√d_öt64
(
u_ch¨
 ** 
pkt
,

430 
size_t
 * 
pkt_Àn
,

431 
size_t
 * 
off£t
,

432 
Ælow_ªÆloc
,

433 
u_ch¨
 
ty≥
,

434 c⁄° 
cou¡î64
 *
d©a
,

435 
size_t
);

437 
a¢_ªÆloc_rbuûd_Êﬂt
(
u_ch¨
 ** 
pkt
,

438 
size_t
 * 
pkt_Àn
,

439 
size_t
 * 
off£t
,

440 
Ælow_ªÆloc
,

441 
u_ch¨
 
ty≥
, c⁄° *
d©a
,

442 
size_t
 
d©a_size
);

444 
a¢_ªÆloc_rbuûd_doubÀ
(
u_ch¨
 ** 
pkt
,

445 
size_t
 * 
pkt_Àn
,

446 
size_t
 * 
off£t
,

447 
Ælow_ªÆloc
,

448 
u_ch¨
 
ty≥
, c⁄° *
d©a
,

449 
size_t
 
d©a_size
);

452 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/callback.h

5 #i‚de‡
CALLBACK_H


6 
	#CALLBACK_H


	)

8 #ifde‡
__˝lu•lus


12 
	#MAX_CALLBACK_IDS
 2

	)

13 
	#MAX_CALLBACK_SUBIDS
 16

	)

18 
	#SNMP_CALLBACK_LIBRARY
 0

	)

19 
	#SNMP_CALLBACK_APPLICATION
 1

	)

24 
	#SNMP_CALLBACK_POST_READ_CONFIG
 0

	)

25 
	#SNMP_CALLBACK_STORE_DATA
 1

	)

26 
	#SNMP_CALLBACK_SHUTDOWN
 2

	)

27 
	#SNMP_CALLBACK_POST_PREMIB_READ_CONFIG
 3

	)

28 
	#SNMP_CALLBACK_LOGGING
 4

	)

29 
	#SNMP_CALLBACK_SESSION_INIT
 5

	)

30 
	#SNMP_CALLBACK_PRE_READ_CONFIG
 7

	)

31 
	#SNMP_CALLBACK_PRE_PREMIB_READ_CONFIG
 8

	)

37 
	#NETSNMP_CALLBACK_HIGHEST_PRIORITY
 -1024

	)

38 
	#NETSNMP_CALLBACK_DEFAULT_PRIORITY
 0

	)

39 
	#NETSNMP_CALLBACK_LOWEST_PRIORITY
 1024

	)

41 (
SNMPCÆlback
Ë(
	tmaj‹ID
, 
	tmö‹ID
,

42 *
	t£rvî¨g
, *
	t˛õ¡¨g
);

44 
	s¢mp_gí_ˇŒback
 {

45 
SNMPCÆlback
 *
sc_ˇŒback
;

46 *
sc_˛õ¡_¨g
;

47 
¥i‹ôy
;

48 
¢mp_gí_ˇŒback
 *
√xt
;

54 
NETSNMP_IMPORT


55 
öô_ˇŒbacks
();

57 
NETSNMP_IMPORT


58 
√t¢mp_ªgi°î_ˇŒback
(
maj‹
, 
mö‹
,

59 
SNMPCÆlback
 * 
√w_ˇŒback
,

60 *
¨g
, 
¥i‹ôy
);

61 
NETSNMP_IMPORT


62 
¢mp_ªgi°î_ˇŒback
(
maj‹
, 
mö‹
,

63 
SNMPCÆlback
 * 
√w_ˇŒback
,

64 *
¨g
);

65 
NETSNMP_IMPORT


66 
¢mp_ˇŒ_ˇŒbacks
(
maj‹
, 
mö‹
,

67 *
ˇŒî_¨g
);

68 
NETSNMP_IMPORT


69 
¢mp_ˇŒback_avaûabÀ
(
maj‹
, 
mö‹
);

70 
NETSNMP_IMPORT


71 
¢mp_cou¡_ˇŒbacks
(
maj‹
, 
mö‹
);

72 
NETSNMP_IMPORT


73 
¢mp_uƒegi°î_ˇŒback
(
maj‹
, 
mö‹
,

74 
SNMPCÆlback
 * 
√w_ˇŒback
,

75 *
¨g
, 
m©ch¨gs
);

76 
NETSNMP_IMPORT


77 
˛ór_ˇŒback
 ();

78 
√t¢mp_ˇŒback_˛ór_˛õ¡_¨g
(*, 
i
, 
j
);

80 
¢mp_gí_ˇŒback
 *
¢mp_ˇŒback_li°
(
maj‹
, 
mö‹
);

82 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/check_varbind.h

1 #i‚de‡
SNMP_CHECK_VARBIND_H


2 
	#SNMP_CHECK_VARBIND_H


	)

4 #ifde‡
__˝lu•lus


13 
√t¢mp_check_vb_ty≥
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
, 
ty≥
);

14 
√t¢mp_check_vb_size
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
, 
size_t
 
size
 );

15 
√t¢mp_check_vb_max_size
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
, 
size_t
 
size
 );

16 
√t¢mp_check_vb_ønge
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
,

17 
size_t
 
low
, size_à
high
 );

18 
√t¢mp_check_vb_size_ønge
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
,

19 
size_t
 
low
, size_à
high
 );

21 
NETSNMP_IMPORT


22 
√t¢mp_check_vb_ty≥_™d_size
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
,

23 
ty≥
, 
size_t
 
size
);

24 
NETSNMP_IMPORT


25 
√t¢mp_check_vb_ty≥_™d_max_size
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
,

26 
ty≥
, 
size_t
 
size
);

28 
NETSNMP_IMPORT


29 
√t¢mp_check_vb_oid
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
);

30 
NETSNMP_IMPORT


31 
√t¢mp_check_vb_öt
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
);

32 
NETSNMP_IMPORT


33 
√t¢mp_check_vb_uöt
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
);

34 
NETSNMP_IMPORT


35 
√t¢mp_check_vb_öt_ønge
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
, 
low
,

36 
high
);

38 
NETSNMP_IMPORT


39 
√t¢mp_check_vb_åuthvÆue
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
);

41 
NETSNMP_IMPORT


42 
√t¢mp_check_vb_row°©us_vÆue
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
);

43 
NETSNMP_IMPORT


44 
√t¢mp_check_vb_row°©us
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
, 
ﬁd_vÆ
);

45 
√t¢mp_check_vb_row°©us_wôh_°‹agëy≥
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
, 
ﬁd_vÆ
, 
ﬁd_°‹age
);

47 
√t¢mp_check_vb_°‹agëy≥
(c⁄° 
√t¢mp_v¨übÀ_li°
 *
v¨
, 
ﬁd_vÆ
);

50 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/container.h

11 #i‚de‡
NETSNMP_CONTAINER_H


12 
	#NETSNMP_CONTAINER_H


	)

23 #i‚de‡
NET_SNMP_CONFIG_H


27 
	~<°dlib.h
>

28 
	~<√t-¢mp/ty≥s.h
>

29 
	~<√t-¢mp/libøry/Á˘‹y.h
>

30 
	~<√t-¢mp/libøry/¢mp_loggög.h
>

31 
	~<√t-¢mp/libøry/toﬁs.h
>

33 #ifde‡ 
__˝lu•lus


42 
√t¢mp_ôî©‹_s
;

43 
√t¢mp_c⁄èöî_s
;

49 
√t¢mp_c⁄èöî_s
* (
	t√t¢mp_c⁄èöî_mod_›
)

50 (
	t√t¢mp_c⁄èöî_s
 *, *
	tc⁄ãxt
, 
	tu_öt
 
	tÊags
);

55 (
√t¢mp_c⁄èöî_›ti⁄
)(
	t√t¢mp_c⁄èöî_s
 *,

56 
	t£t
, 
	tu_öt
 
	tÊags
);

61 (
√t¢mp_c⁄èöî_rc
)(
	t√t¢mp_c⁄èöî_s
 *);

66 
√t¢mp_ôî©‹_s
 * (
	t√t¢mp_c⁄èöî_ô
)

67 (
	t√t¢mp_c⁄èöî_s
 *);

72 
size_t
 (
	t√t¢mp_c⁄èöî_size
)(
	t√t¢mp_c⁄èöî_s
 *);

78 (
√t¢mp_c⁄èöî_›
)(
	t√t¢mp_c⁄èöî_s
 *,

79 c⁄° *
	td©a
);

85 * (
	t√t¢mp_c⁄èöî_πn
)(
	t√t¢mp_c⁄èöî_s
 *,

86 c⁄° *
	td©a
);

91 (
√t¢mp_c⁄èöî_obj_func
)(*
	td©a
, *
	tc⁄ãxt
);

96 (
√t¢mp_c⁄èöî_func
)(
	t√t¢mp_c⁄èöî_s
 *,

97 
	t√t¢mp_c⁄èöî_obj_func
 *,

98 *
	tc⁄ãxt
);

104 
√t¢mp_void_¨øy
 * (
	t√t¢mp_c⁄èöî_£t
)

105 (
	t√t¢mp_c⁄èöî_s
 *, *
	td©a
);

110 (
√t¢mp_c⁄èöî_com∑ª
)(c⁄° *
	tlhs
,

111 c⁄° *
	trhs
);

118 
	s√t¢mp_c⁄èöî_s
 {

123 * 
c⁄èöî_d©a
;

128 
√t¢mp_c⁄èöî_size
 *
gë_size
;

133 
√t¢mp_c⁄èöî_rc
 *
öô
;

142 
√t¢mp_c⁄èöî_rc
 *
c‰ì
;

147 
√t¢mp_c⁄èöî_›
 *
ö£π
;

152 
√t¢mp_c⁄èöî_›
 *
ªmove
;

157 
√t¢mp_c⁄èöî_›
 *
ªÀa£
;

158 
√t¢mp_c⁄èöî_obj_func
 *
‰ì_ôem
;

167 
√t¢mp_c⁄èöî_πn
 *
föd
;

174 
√t¢mp_c⁄èöî_πn
 *
föd_√xt
;

183 
√t¢mp_c⁄èöî_£t
 *
gë_sub£t
;

188 
√t¢mp_c⁄èöî_ô
 *
gë_ôî©‹
;

193 
√t¢mp_c⁄èöî_func
 *
f‹_óch
;

199 
√t¢mp_c⁄èöî_func
 *
˛ór
;

209 
√t¢mp_c⁄èöî_›
 *
ö£π_fûãr
;

216 
√t¢mp_c⁄èöî_mod_›
 *
du∂iˇã
;

228 
√t¢mp_c⁄èöî_com∑ª
 *
com∑ª
;

233 
√t¢mp_c⁄èöî_com∑ª
 *
ncom∑ª
;

238 
√t¢mp_c⁄èöî_›ti⁄
 *
›ti⁄s
;

243 *
c⁄èöî_«me
;

249 
u_l⁄g
 
sync
;

254 
u_öt
 
Êags
;

259 
√t¢mp_c⁄èöî_s
 *
√xt
, *
¥ev
;

261 } 
	t√t¢mp_c⁄èöî
;

267 
NETSNMP_IMPORT


268 
√t¢mp_c⁄èöî_öô_li°
();

269 
NETSNMP_IMPORT


270 
√t¢mp_c⁄èöî_‰ì_li°
();

275 
√t¢mp_c⁄èöî_ªgi°î_wôh_com∑ª
(c⁄° * 
«me
,

276 
√t¢mp_Á˘‹y
 *
f
,

277 
√t¢mp_c⁄èöî_com∑ª
 *
c
);

278 
√t¢mp_c⁄èöî_ªgi°î
(c⁄° * 
«me
, 
√t¢mp_Á˘‹y
 *
f
);

284 
NETSNMP_IMPORT


285 
√t¢mp_c⁄èöî
 * 
√t¢mp_c⁄èöî_föd
(c⁄° *
ty≥_li°
);

286 
√t¢mp_c⁄èöî
 * 
√t¢mp_c⁄èöî_gë
(c⁄° *
ty≥
);

291 
NETSNMP_IMPORT


292 
√t¢mp_c⁄èöî_add_ödex
(
√t¢mp_c⁄èöî
 *
¥im¨y
,

293 
√t¢mp_c⁄èöî
 *
√w_ödex
);

296 
√t¢mp_Á˘‹y
 *
√t¢mp_c⁄èöî_gë_Á˘‹y
(c⁄° *
ty≥
);

302 
NETSNMP_IMPORT


303 
√t¢mp_com∑ª_√t¢mp_ödex
(c⁄° *
lhs
, c⁄° *
rhs
);

304 
NETSNMP_IMPORT


305 
√t¢mp_ncom∑ª_√t¢mp_ödex
(c⁄° *
lhs
, c⁄° *
rhs
);

308 
√t¢mp_com∑ª_c°rög
(c⁄° * 
lhs
, c⁄° * 
rhs
);

309 
√t¢mp_ncom∑ª_c°rög
(c⁄° * 
lhs
, c⁄° * 
rhs
);

312 
√t¢mp_com∑ª_mem
(c⁄° * 
lhs
, 
size_t
 
lhs_Àn
,

313 c⁄° * 
rhs
, 
size_t
 
rhs_Àn
);

316 
√t¢mp_com∑ª_dúe˘_c°rög
(c⁄° * 
lhs
, c⁄° * 
rhs
);

318 
√t¢mp_com∑ª_l⁄g
(c⁄° * 
lhs
, c⁄° * 
rhs
);

319 
√t¢mp_com∑ª_ul⁄g
(c⁄° * 
lhs
, c⁄° * 
rhs
);

320 
√t¢mp_com∑ª_öt32
(c⁄° * 
lhs
, c⁄° * 
rhs
);

321 
√t¢mp_com∑ª_uöt32
(c⁄° * 
lhs
, c⁄° * 
rhs
);

324 
NETSNMP_IMPORT


325 
√t¢mp_c⁄èöî_sim∂e_‰ì
(*
d©a
, *
c⁄ãxt
);

330 
	#CONTAINER_KEY_ALLOW_DUPLICATES
 0x00000001

	)

331 
	#CONTAINER_KEY_UNSORTED
 0x00000002

	)

333 
	#CONTAINER_SET_OPTIONS
(
x
,
o
,
rc
) do { \

334 i‡(
NULL
==(
x
)->
›ti⁄s
) \

335 
rc
 = -1; \

337 
rc
 = (
x
)->
	`›ti⁄s
(x, 1, 
o
); \

338 i‡(
rc
 != -1 ) \

339 (
x
)->
Êags
 |
o
; \

341 } 0)

	)

343 
	#CONTAINER_CHECK_OPTION
(
x
,
o
,
rc
) do { \

344 
rc
 = 
x
->
Êags
 & 0; \

345 } 0)

	)

351 
	#CONTAINER_FIRST
(
x
Ë(x)->
	`föd_√xt
(x,
NULL
)

	)

352 
	#CONTAINER_FIND
(
x
,
k
Ë(x)->
	`föd
(x,k)

	)

353 
	#CONTAINER_NEXT
(
x
,
k
Ë(x)->
	`föd_√xt
(x,k)

	)

360 
	#CONTAINER_GET_SUBSET
(
x
,
k
Ë(x)->
	`gë_sub£t
(x,k)

	)

361 
	#CONTAINER_SIZE
(
x
Ë(x)->
	`gë_size
(x)

	)

362 
	#CONTAINER_ITERATOR
(
x
Ë(x)->
	`gë_ôî©‹
(x)

	)

363 
	#CONTAINER_COMPARE
(
x
,
l
,
r
Ë(x)->
	`com∑ª
÷,r)

	)

364 
	#CONTAINER_FOR_EACH
(
x
,
f
,
c
Ë(x)->
	`f‹_óch
(x,f,c)

	)

374 
NETSNMP_IMPORT


375 
CONTAINER_INSERT
(
√t¢mp_c⁄èöî
 *
x
, c⁄° *
k
);

380 
NETSNMP_IMPORT


381 
CONTAINER_REMOVE
(
√t¢mp_c⁄èöî
 *
x
, c⁄° *
k
);

386 
NETSNMP_IMPORT


387 
√t¢mp_c⁄èöî
 *
CONTAINER_DUP
“ë¢mp_c⁄èöî *
x
, *
˘x
,

388 
u_öt
 
Êags
);

395 
NETSNMP_IMPORT


396 
CONTAINER_CLEAR
(
√t¢mp_c⁄èöî
 *
x
, 
√t¢mp_c⁄èöî_obj_func
 *
f
,

397 *
c
);

404 
NETSNMP_IMPORT


405 
CONTAINER_FREE_ALL
(
√t¢mp_c⁄èöî
 *
x
, *
c
);

410 
NETSNMP_IMPORT


411 
CONTAINER_FREE
(
√t¢mp_c⁄èöî
 *
x
);

413 
NETSNMP_IMPORT


414 
√t¢mp_c⁄èöî
 *
SUBCONTAINER_FIND
“ë¢mp_c⁄èöî *
x
,

415 c⁄° * 
«me
);

420 
√t¢mp_öô_c⁄èöî
(
√t¢mp_c⁄èöî
 *
c
,

421 
√t¢mp_c⁄èöî_rc
 *
öô
,

422 
√t¢mp_c⁄èöî_rc
 *
c‰ì
,

423 
√t¢mp_c⁄èöî_size
 *
size
,

424 
√t¢mp_c⁄èöî_com∑ª
 *
cmp
,

425 
√t¢mp_c⁄èöî_›
 *
ös
,

426 
√t¢mp_c⁄èöî_›
 *
ªm
,

427 
√t¢mp_c⁄èöî_πn
 *
‚d
);

429 
√t¢mp_c⁄èöî_d©a_dup
(
√t¢mp_c⁄èöî
 *
dup
,

430 
√t¢mp_c⁄èöî
 *
c
);

441 (
√t¢mp_ôî©‹_rc
)(
	t√t¢mp_ôî©‹_s
 *);

446 * (
	t√t¢mp_ôî©‹_πn
)(
	t√t¢mp_ôî©‹_s
 *);

452 
	s√t¢mp_ôî©‹_s
 {

454 
√t¢mp_c⁄èöî
 *
c⁄èöî
;

460 
u_l⁄g
 
sync
;

465 
√t¢mp_ôî©‹_rc
 *
ª£t
;

470 
√t¢mp_ôî©‹_rc
 *
ªÀa£
;

475 
√t¢mp_ôî©‹_πn
 *
fú°
;

476 
√t¢mp_ôî©‹_πn
 *
cuº
;

477 
√t¢mp_ôî©‹_πn
 *
œ°
;

479 
√t¢mp_ôî©‹_πn
 *
√xt
;

486 
√t¢mp_ôî©‹_rc
 *
ªmove
;

488 } 
	t√t¢mp_ôî©‹
;

491 
	#ITERATOR_FIRST
(
x
Ëx->
	`fú°
(x)

	)

492 
	#ITERATOR_NEXT
(
x
Ëx->
	`√xt
(x)

	)

493 
	#ITERATOR_LAST
(
x
Ëx->
	`œ°
(x)

	)

494 
	#ITERATOR_REMOVE
(
x
Ëx->
	`ªmove
(x)

	)

495 
	#ITERATOR_RELEASE
(
x
Ëdÿ{ x->
	`ªÀa£
(x); x = 
NULL
; } 0)

	)

497 #ifde‡ 
__˝lu•lus


	@/usr/include/net-snmp/library/container_binary_array.h

6 #i‚de‡
BINARY_ARRAY_H


7 
	#BINARY_ARRAY_H


	)

9 #ifde‡
__˝lu•lus


13 
	~<√t-¢mp/libøry/a¢1.h
>

14 
	~<√t-¢mp/libøry/c⁄èöî.h
>

15 
	~<√t-¢mp/libøry/Á˘‹y.h
>

20 
√t¢mp_c⁄èöî_bö¨y_¨øy_öô
();

25 
√t¢mp_c⁄èöî
 * 
√t¢mp_c⁄èöî_gë_bö¨y_¨øy
();

30 
√t¢mp_Á˘‹y
 * 
√t¢mp_c⁄èöî_gë_bö¨y_¨øy_Á˘‹y
();

33 
√t¢mp_bö¨y_¨øy_ªmove
(
√t¢mp_c⁄èöî
 *
c
, c⁄° *
key
,

34 **
ßve
);

36 
√t¢mp_bö¨y_¨øy_ªÀa£
(
√t¢mp_c⁄èöî
 *
c
);

38 
√t¢mp_c⁄èöî_bö¨y_¨øy_öô
();

40 
√t¢mp_bö¨y_¨øy_›ti⁄s_£t
(
√t¢mp_c⁄èöî
 *
c
, 
£t
, 
u_öt
 
Êags
);

43 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/container_iterator.h

6 #i‚de‡
_CONTAINER_ITERATOR_HANDLER_H_


7 
	#_CONTAINER_ITERATOR_HANDLER_H_


	)

9 
	~"c⁄èöî.h
"

11 #ifde‡
__˝lu•lus


15 (
Në¢mp_Iãøt‹_Lo›_Key
Ë(*
	tôî©‹_˘x
,

16 
	t√t¢mp_ªf_void
* 
	tlo›_˘x
,

17 
	t√t¢mp_ªf_void
* 
	tkey
);

18 (
Në¢mp_Iãøt‹_Lo›_D©a
)(*
	tôî©‹_˘x
,

19 
	t√t¢mp_ªf_void
* 
	tlo›_˘x
,

20 
	t√t¢mp_ªf_void
* 
	td©a
);

21 (
Në¢mp_Iãøt‹_Ctx
Ë(*
	tôî©‹_˘x
,

22 
	t√t¢mp_ªf_void
* 
	tlo›_˘x
);

23 (
Në¢mp_Iãøt‹_Ctx_Dup
Ë(*
	tôî©‹_˘x
,

24 
	t√t¢mp_ªf_void
* 
	tlo›_˘x
,

25 
	t√t¢mp_ªf_void
* 
	tdup_˘x
,

26 
	tªu£
);

27 (
Në¢mp_Iãøt‹_Op
Ë(*
	tôî©‹_˘x
);

28 (
Në¢mp_Iãøt‹_D©a
Ë(*
	tôî©‹_˘x
,

29 c⁄° *
	td©a
);

31 
√t¢mp_c⁄èöî_ôî©‹_öô
();

33 
√t¢mp_c⁄èöî
* 
√t¢mp_c⁄èöî_ôî©‹_gë
(

34 *
ôî©‹_u£r_˘x
,

35 
√t¢mp_c⁄èöî_com∑ª
 * 
com∑ª
,

36 
Në¢mp_Iãøt‹_Lo›_Key
 * 
gë_fú°
,

37 
Në¢mp_Iãøt‹_Lo›_Key
 * 
gë_√xt
,

38 
Në¢mp_Iãøt‹_Lo›_D©a
 * 
gë_d©a
,

39 
Në¢mp_Iãøt‹_Ctx_Dup
 * 
ßve_pos
,

40 
Në¢mp_Iãøt‹_Ctx
 * 
öô_lo›_˘x
,

41 
Në¢mp_Iãøt‹_Ctx
 * 
˛ónup_lo›_˘x
,

42 
Në¢mp_Iãøt‹_D©a
 * 
‰ì_u£r_˘x
,

43 
s‹ãd
);

52 
√t¢mp_c⁄èöî_ôî©‹_£t_d©a_cb
(
√t¢mp_c⁄èöî
 *
c
,

53 
Në¢mp_Iãøt‹_D©a
 * 
ö£π_d©a
,

54 
Në¢mp_Iãøt‹_D©a
 * 
ªmove_d©a
,

55 
Në¢mp_Iãøt‹_Op
 * 
gë_size
);

57 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/container_list_ssll.h

6 #i‚de‡
NETSNMP_CONTAINER_SSLL_H


7 
	#NETSNMP_CONTAINER_SSLL_H


	)

10 
	~<√t-¢mp/libøry/c⁄èöî.h
>

12 #ifde‡ 
__˝lu•lus


16 
√t¢mp_c⁄èöî
 *
√t¢mp_c⁄èöî_gë_s‹ãd_sögly_löked_li°
();

17 
√t¢mp_c⁄èöî
 *
√t¢mp_c⁄èöî_gë_sögly_löked_li°
(
fifo
);

19 
NETSNMP_IMPORT


20 
√t¢mp_c⁄èöî_s¶l_öô
();

23 #ifde‡ 
__˝lu•lus


	@/usr/include/net-snmp/library/data_list.h

24 #i‚de‡
DATA_LIST_H


25 
	#DATA_LIST_H


	)

27 #ifde‡
__˝lu•lus


31 
	~<√t-¢mp/libøry/¢mp_im∂.h
>

32 
	~<√t-¢mp/libøry/toﬁs.h
>

34 (
Në¢mp_Fªe_Li°_D©a
) (*);

35 (
Në¢mp_Save_Li°_D©a
Ë(*
	tbuf
, 
	tsize_t
 
	tbuf_Àn
, *);

36 * (
	tNë¢mp_Ród_Li°_D©a
Ë(*
	tbuf
, 
	tsize_t
 
	tbuf_Àn
);

41 
	s√t¢mp_d©a_li°_s
 {

42 
√t¢mp_d©a_li°_s
 *
√xt
;

43 *
«me
;

45 *
d©a
;

47 
Në¢mp_Fªe_Li°_D©a
 *
‰ì_func
;

48 } 
	t√t¢mp_d©a_li°
;

50 
	s√t¢mp_d©a_li°_ßveöfo_s
 {

51 
√t¢mp_d©a_li°
 **
d©Æi°
;

52 c⁄° *
ty≥
;

53 c⁄° *
tokí
;

54 
Në¢mp_Save_Li°_D©a
 *
d©a_li°_ßve_±r
;

55 
Në¢mp_Ród_Li°_D©a
 *
d©a_li°_ªad_±r
;

56 
Në¢mp_Fªe_Li°_D©a
 *
d©a_li°_‰ì_±r
;

57 } 
	t√t¢mp_d©a_li°_ßveöfo
;

59 
NETSNMP_IMPORT


60 
√t¢mp_d©a_li°
 *

61 
√t¢mp_¸óã_d©a_li°
(c⁄° *, *, 
Në¢mp_Fªe_Li°_D©a
* );

62 
√t¢mp_d©a_li°_add_node
(
√t¢mp_d©a_li°
 **
hód
,

63 
√t¢mp_d©a_li°
 *
node
);

64 
√t¢mp_d©a_li°
 *

65 
√t¢mp_d©a_li°_add_d©a
(
√t¢mp_d©a_li°
 **
hód
,

66 c⁄° *
«me
, *
d©a
,

67 
Në¢mp_Fªe_Li°_D©a
 * 
bìr
);

68 
NETSNMP_IMPORT


69 *
√t¢mp_gë_li°_d©a
(
√t¢mp_d©a_li°
 *
hód
,

70 c⁄° *
node
);

71 
NETSNMP_IMPORT


72 
√t¢mp_‰ì_li°_d©a
(
√t¢mp_d©a_li°
 *
hód
);

73 
NETSNMP_IMPORT


74 
√t¢mp_‰ì_Æl_li°_d©a
(
√t¢mp_d©a_li°
 *
hód
);

75 
NETSNMP_IMPORT


76 
√t¢mp_ªmove_li°_node
(
√t¢mp_d©a_li°
 **
ªÆhód
,

77 c⁄° *
«me
);

78 
NETSNMP_IMPORT


79 
√t¢mp_d©a_li°
 *

80 
√t¢mp_gë_li°_node
(
√t¢mp_d©a_li°
 *
hód
,

81 c⁄° *
«me
);

84 
NETSNMP_IMPORT


85 
√t¢mp_add_li°_d©a
(
√t¢mp_d©a_li°
 **
hód
,

86 
√t¢mp_d©a_li°
 *
node
);

90 
√t¢mp_ªgi°î_ßve_li°
(
√t¢mp_d©a_li°
 **
d©Æi°
,

91 c⁄° *
ty≥
, c⁄° *
tokí
,

92 
Në¢mp_Save_Li°_D©a
 *
d©a_li°_ßve_±r
,

93 
Në¢mp_Ród_Li°_D©a
 *
d©a_li°_ªad_±r
,

94 
Në¢mp_Fªe_Li°_D©a
 *
d©a_li°_‰ì_±r
);

96 
√t¢mp_ßve_Æl_d©a
(
√t¢mp_d©a_li°
 *
hód
,

97 c⁄° *
ty≥
, c⁄° *
tokí
,

98 
Në¢mp_Save_Li°_D©a
 * 
d©a_li°_ßve_±r
);

99 
SNMPCÆlback
 
√t¢mp_ßve_Æl_d©a_ˇŒback
;

100 
√t¢mp_ªad_d©a_ˇŒback
(c⁄° *
tokí
, *
löe
);

101 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/default_store.h

24 #i‚de‡
DEFAULT_STORE_H


25 
	#DEFAULT_STORE_H


	)

27 
	~<√t-¢mp/√t-¢mp-c⁄fig.h
>

29 #ifde‡
__˝lu•lus


33 
	#NETSNMP_DS_MAX_IDS
 3

	)

34 
	#NETSNMP_DS_MAX_SUBIDS
 48

	)

43 
	#NETSNMP_DS_LIBRARY_ID
 0

	)

44 
	#NETSNMP_DS_APPLICATION_ID
 1

	)

45 
	#NETSNMP_DS_TOKEN_ID
 2

	)

54 
	#NETSNMP_DS_LIB_MIB_ERRORS
 0

	)

55 
	#NETSNMP_DS_LIB_SAVE_MIB_DESCRS
 1

	)

56 
	#NETSNMP_DS_LIB_MIB_COMMENT_TERM
 2

	)

57 
	#NETSNMP_DS_LIB_MIB_PARSE_LABEL
 3

	)

58 
	#NETSNMP_DS_LIB_DUMP_PACKET
 4

	)

59 
	#NETSNMP_DS_LIB_LOG_TIMESTAMP
 5

	)

60 
	#NETSNMP_DS_LIB_DONT_READ_CONFIGS
 6

	)

61 
	#NETSNMP_DS_LIB_DISABLE_CONFIG_LOAD
 
NETSNMP_DS_LIB_DONT_READ_CONFIGS


	)

62 
	#NETSNMP_DS_LIB_MIB_REPLACE
 7

	)

63 
	#NETSNMP_DS_LIB_PRINT_NUMERIC_ENUM
 8

	)

64 
	#NETSNMP_DS_LIB_PRINT_NUMERIC_OIDS
 9

	)

65 
	#NETSNMP_DS_LIB_DONT_BREAKDOWN_OIDS
 10

	)

66 
	#NETSNMP_DS_LIB_ALARM_DONT_USE_SIG
 11

	)

67 
	#NETSNMP_DS_LIB_PRINT_FULL_OID
 12

	)

68 
	#NETSNMP_DS_LIB_QUICK_PRINT
 13

	)

69 
	#NETSNMP_DS_LIB_RANDOM_ACCESS
 14

	)

70 
	#NETSNMP_DS_LIB_REGEX_ACCESS
 15

	)

71 
	#NETSNMP_DS_LIB_DONT_CHECK_RANGE
 16

	)

72 
	#NETSNMP_DS_LIB_NO_TOKEN_WARNINGS
 17

	)

73 
	#NETSNMP_DS_LIB_NUMERIC_TIMETICKS
 18

	)

74 
	#NETSNMP_DS_LIB_ESCAPE_QUOTES
 19

	)

75 
	#NETSNMP_DS_LIB_REVERSE_ENCODE
 20

	)

76 
	#NETSNMP_DS_LIB_PRINT_BARE_VALUE
 21

	)

77 
	#NETSNMP_DS_LIB_EXTENDED_INDEX
 22

	)

78 
	#NETSNMP_DS_LIB_PRINT_HEX_TEXT
 23

	)

79 
	#NETSNMP_DS_LIB_PRINT_UCD_STYLE_OID
 24

	)

80 
	#NETSNMP_DS_LIB_READ_UCD_STYLE_OID
 25

	)

81 
	#NETSNMP_DS_LIB_HAVE_READ_PREMIB_CONFIG
 26

	)

82 
	#NETSNMP_DS_LIB_HAVE_READ_CONFIG
 27

	)

83 
	#NETSNMP_DS_LIB_QUICKE_PRINT
 28

	)

84 
	#NETSNMP_DS_LIB_DONT_PRINT_UNITS
 29

	)

85 
	#NETSNMP_DS_LIB_NO_DISPLAY_HINT
 30

	)

86 
	#NETSNMP_DS_LIB_16BIT_IDS
 31

	)

87 
	#NETSNMP_DS_LIB_DONT_PERSIST_STATE
 32

	)

88 
	#NETSNMP_DS_LIB_2DIGIT_HEX_OUTPUT
 33

	)

89 
	#NETSNMP_DS_LIB_IGNORE_NO_COMMUNITY
 34

	)

90 
	#NETSNMP_DS_LIB_DISABLE_PERSISTENT_LOAD
 35

	)

91 
	#NETSNMP_DS_LIB_DISABLE_PERSISTENT_SAVE
 36

	)

92 
	#NETSNMP_DS_LIB_APPEND_LOGFILES
 37

	)

93 
	#NETSNMP_DS_LIB_NO_DISCOVERY
 38

	)

94 
	#NETSNMP_DS_LIB_TSM_USE_PREFIX
 39

	)

95 
	#NETSNMP_DS_LIB_DONT_LOAD_HOST_FILES
 40

	)

96 
	#NETSNMP_DS_LIB_DNSSEC_WARN_ONLY
 41

	)

97 
	#NETSNMP_DS_LIB_CLIENT_ADDR_USES_PORT
 42

	)

98 
	#NETSNMP_DS_LIB_MAX_BOOL_ID
 48

	)

103 
	#NETSNMP_DS_LIB_MIB_WARNINGS
 0

	)

104 
	#NETSNMP_DS_LIB_SECLEVEL
 1

	)

105 
	#NETSNMP_DS_LIB_SNMPVERSION
 2

	)

106 
	#NETSNMP_DS_LIB_DEFAULT_PORT
 3

	)

107 
	#NETSNMP_DS_LIB_OID_OUTPUT_FORMAT
 4

	)

108 
	#NETSNMP_DS_LIB_PRINT_SUFFIX_ONLY
 
NETSNMP_DS_LIB_OID_OUTPUT_FORMAT


	)

109 
	#NETSNMP_DS_LIB_STRING_OUTPUT_FORMAT
 5

	)

110 
	#NETSNMP_DS_LIB_HEX_OUTPUT_LENGTH
 6

	)

111 
	#NETSNMP_DS_LIB_SERVERSENDBUF
 7

	)

112 
	#NETSNMP_DS_LIB_SERVERRECVBUF
 8

	)

113 
	#NETSNMP_DS_LIB_CLIENTSENDBUF
 9

	)

114 
	#NETSNMP_DS_LIB_CLIENTRECVBUF
 10

	)

115 
	#NETSNMP_DS_SSHDOMAIN_SOCK_PERM
 11

	)

116 
	#NETSNMP_DS_SSHDOMAIN_DIR_PERM
 12

	)

117 
	#NETSNMP_DS_SSHDOMAIN_SOCK_USER
 12

	)

118 
	#NETSNMP_DS_SSHDOMAIN_SOCK_GROUP
 13

	)

119 
	#NETSNMP_DS_LIB_TIMEOUT
 14

	)

120 
	#NETSNMP_DS_LIB_RETRIES
 15

	)

121 
	#NETSNMP_DS_LIB_MAX_INT_ID
 48

	)

126 #i‚de‡
NETSNMP_DISABLE_SNMPV1


127 
	#NETSNMP_DS_SNMP_VERSION_1
 128

	)

129 #i‚de‡
NETSNMP_DISABLE_SNMPV2C


130 
	#NETSNMP_DS_SNMP_VERSION_2c
 1

	)

132 
	#NETSNMP_DS_SNMP_VERSION_3
 3

	)

138 
	#NETSNMP_DS_LIB_SECNAME
 0

	)

139 
	#NETSNMP_DS_LIB_CONTEXT
 1

	)

140 
	#NETSNMP_DS_LIB_PASSPHRASE
 2

	)

141 
	#NETSNMP_DS_LIB_AUTHPASSPHRASE
 3

	)

142 
	#NETSNMP_DS_LIB_PRIVPASSPHRASE
 4

	)

143 
	#NETSNMP_DS_LIB_OPTIONALCONFIG
 5

	)

144 
	#NETSNMP_DS_LIB_APPTYPE
 6

	)

145 
	#NETSNMP_DS_LIB_COMMUNITY
 7

	)

146 
	#NETSNMP_DS_LIB_PERSISTENT_DIR
 8

	)

147 
	#NETSNMP_DS_LIB_CONFIGURATION_DIR
 9

	)

148 
	#NETSNMP_DS_LIB_SECMODEL
 10

	)

149 
	#NETSNMP_DS_LIB_MIBDIRS
 11

	)

150 
	#NETSNMP_DS_LIB_OIDSUFFIX
 12

	)

151 
	#NETSNMP_DS_LIB_OIDPREFIX
 13

	)

152 
	#NETSNMP_DS_LIB_CLIENT_ADDR
 14

	)

153 
	#NETSNMP_DS_LIB_TEMP_FILE_PATTERN
 15

	)

154 
	#NETSNMP_DS_LIB_AUTHMASTERKEY
 16

	)

155 
	#NETSNMP_DS_LIB_PRIVMASTERKEY
 17

	)

156 
	#NETSNMP_DS_LIB_AUTHLOCALIZEDKEY
 18

	)

157 
	#NETSNMP_DS_LIB_PRIVLOCALIZEDKEY
 19

	)

158 
	#NETSNMP_DS_LIB_APPTYPES
 20

	)

159 
	#NETSNMP_DS_LIB_KSM_KEYTAB
 21

	)

160 
	#NETSNMP_DS_LIB_KSM_SERVICE_NAME
 22

	)

161 
	#NETSNMP_DS_LIB_X509_CLIENT_PUB
 23

	)

162 
	#NETSNMP_DS_LIB_X509_SERVER_PUB
 24

	)

163 
	#NETSNMP_DS_LIB_SSHTOSNMP_SOCKET
 25

	)

164 
	#NETSNMP_DS_LIB_CERT_EXTRA_SUBDIR
 26

	)

165 
	#NETSNMP_DS_LIB_HOSTNAME
 27

	)

166 
	#NETSNMP_DS_LIB_X509_CRL_FILE
 28

	)

167 
	#NETSNMP_DS_LIB_TLS_ALGORITMS
 29

	)

168 
	#NETSNMP_DS_LIB_TLS_LOCAL_CERT
 30

	)

169 
	#NETSNMP_DS_LIB_TLS_PEER_CERT
 31

	)

170 
	#NETSNMP_DS_LIB_SSH_USERNAME
 32

	)

171 
	#NETSNMP_DS_LIB_SSH_PUBKEY
 33

	)

172 
	#NETSNMP_DS_LIB_SSH_PRIVKEY
 34

	)

173 
	#NETSNMP_DS_LIB_MAX_STR_ID
 48

	)

179 
NETSNMP_IMPORT


180 
√t¢mp_ds_£t_boﬁón
(
°‹eid
, 
which
, 
vÆue
);

181 
NETSNMP_IMPORT


182 
√t¢mp_ds_gë_boﬁón
(
°‹eid
, 
which
);

183 
NETSNMP_IMPORT


184 
√t¢mp_ds_toggÀ_boﬁón
(
°‹eid
, 
which
);

185 
NETSNMP_IMPORT


186 
√t¢mp_ds_£t_öt
(
°‹eid
, 
which
, 
vÆue
);

187 
NETSNMP_IMPORT


188 
√t¢mp_ds_gë_öt
(
°‹eid
, 
which
);

189 
NETSNMP_IMPORT


190 
√t¢mp_ds_£t_°rög
(
°‹eid
, 
which
,

191 c⁄° *
vÆue
);

192 
NETSNMP_IMPORT


193 *
√t¢mp_ds_gë_°rög
(
°‹eid
, 
which
);

194 
NETSNMP_IMPORT


195 
√t¢mp_ds_£t_void
(
°‹eid
, 
which
, *
vÆue
);

196 
NETSNMP_IMPORT


197 *
√t¢mp_ds_gë_void
(
°‹eid
, 
which
);

198 
NETSNMP_IMPORT


199 
√t¢mp_ds_ªgi°î_c⁄fig
(
u_ch¨
 
ty≥
, c⁄° *
·y≥
,

200 c⁄° *
tokí
, 
°‹eid
,

201 
which
);

202 
NETSNMP_IMPORT


203 
√t¢mp_ds_ªgi°î_¥emib
(
u_ch¨
 
ty≥
, c⁄° *
·y≥
,

204 c⁄° *
tokí
, 
°‹eid
,

205 
which
);

206 
NETSNMP_IMPORT


207 
√t¢mp_ds_∑r£_boﬁón
(*
löe
);

208 
NETSNMP_IMPORT


209 
√t¢mp_ds_shutdown
();

211 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/fd_event_manager.h

17 #i‚de‡
FD_EVENT_MANAGER_H


18 
	#FD_EVENT_MANAGER_H


	)

20 #ifde‡
HAVE_SYS_SELECT_H


21 
	~<sys/£À˘.h
>

24 #ifde‡
__˝lu•lus


28 
	#NUM_EXTERNAL_FDS
 32

	)

29 
	#FD_REGISTERED_OK
 0

	)

30 
	#FD_REGISTRATION_FAILED
 -2

	)

31 
	#FD_UNREGISTERED_OK
 0

	)

32 
	#FD_NO_SUCH_REGISTRATION
 -1

	)

38 
exã∫Æ_ªadfd
[
NUM_EXTERNAL_FDS
], 
exã∫Æ_ªadfdÀn
;

39 
exã∫Æ_wrôefd
[
NUM_EXTERNAL_FDS
], 
exã∫Æ_wrôefdÀn
;

40 
exã∫Æ_ex˚±fd
[
NUM_EXTERNAL_FDS
], 
exã∫Æ_ex˚±fdÀn
;

42 (*
exã∫Æ_ªadfdfunc
[
NUM_EXTERNAL_FDS
]) (, *);

43 (*
exã∫Æ_wrôefdfunc
[
NUM_EXTERNAL_FDS
]) (, *);

44 (*
exã∫Æ_ex˚±fdfunc
[
NUM_EXTERNAL_FDS
]) (, *);

46 *
exã∫Æ_ªadfd_d©a
[
NUM_EXTERNAL_FDS
];

47 *
exã∫Æ_wrôefd_d©a
[
NUM_EXTERNAL_FDS
];

48 *
exã∫Æ_ex˚±fd_d©a
[
NUM_EXTERNAL_FDS
];

55 
ªgi°î_ªadfd
(, (*
func
)(, *), *);

56 
ªgi°î_wrôefd
(, (*
func
)(, *), *);

57 
ªgi°î_ex˚±fd
(, (*
func
)(, *), *);

60 
uƒegi°î_ªadfd
();

61 
uƒegi°î_wrôefd
();

62 
uƒegi°î_ex˚±fd
();

91 
NETSNMP_IMPORT


92 
√t¢mp_exã∫Æ_evít_öfo
(*
numfds
, 
fd_£t
 *
ªadfds
, fd_£à*
wrôefds
, fd_£à*
ex˚±fds
);

94 
NETSNMP_IMPORT


95 
√t¢mp_exã∫Æ_evít_öfo2
(*
numfds
,

96 
√t¢mp_œrge_fd_£t
 *
ªadfds
,

97 
√t¢mp_œrge_fd_£t
 *
wrôefds
,

98 
√t¢mp_œrge_fd_£t
 *
ex˚±fds
);

124 
NETSNMP_IMPORT


125 
√t¢mp_di•©ch_exã∫Æ_evíts
(*
cou¡
, 
fd_£t
 *
ªadfds
, fd_£à*
wrôefds
, fd_£à*
ex˚±fds
);

126 
NETSNMP_IMPORT


127 
√t¢mp_di•©ch_exã∫Æ_evíts2
(*
cou¡
,

128 
√t¢mp_œrge_fd_£t
 *
ªadfds
,

129 
√t¢mp_œrge_fd_£t
 *
wrôefds
,

130 
√t¢mp_œrge_fd_£t
 *
ex˚±fds
);

131 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/int64.h

1 #i‚de‡
INT64_INCLUDED


2 
	#INT64_INCLUDED


	)

4 #ifde‡
__˝lu•lus


8 
cou¡î64
 
	tU64
;

10 
	#I64CHARSZ
 21

	)

12 
divBy10
(
U64
, U64 *, *);

13 
mu…By10
(
U64
, U64 *);

14 
ö¸ByU16
(
U64
 *, );

15 
ö¸ByU32
(
U64
 *, );

16 
NETSNMP_IMPORT


17 
zîoU64
(
U64
 *);

18 
isZîoU64
(c⁄° 
U64
 *);

19 
NETSNMP_IMPORT


20 
¥ötU64
(*, c⁄° 
U64
 *);

21 
NETSNMP_IMPORT


22 
¥ötI64
(*, c⁄° 
U64
 *);

23 
ªad64
(
U64
 *, const *);

24 
NETSNMP_IMPORT


25 
u64Subåa˘
(c⁄° 
U64
 * 
pu64⁄e
, c⁄° U64 * 
pu64two
,

26 
U64
 * 
pu64out
);

27 
u64In¸
(
U64
 * 
pu64out
, c⁄° U64 * 
pu64⁄e
);

28 
u64Upd©eCou¡î
(
U64
 * 
pu64out
, c⁄° U64 * 
pu64⁄e
,

29 c⁄° 
U64
 * 
pu64two
);

30 
u64C›y
(
U64
 * 
pu64⁄e
, c⁄° U64 * 
pu64two
);

32 
√t¢mp_c64_check_f‹_32bô_wøp
(
U64
 *
ﬁd_vÆ
, U64 *
√w_vÆ
,

33 
adju°
);

34 
NETSNMP_IMPORT


35 
√t¢mp_c64_check32_™d_upd©e
(
cou¡î64
 *
¥ev_vÆ
,

36 
cou¡î64
 *
√w_vÆ
,

37 
cou¡î64
 *
ﬁd_¥ev_vÆ
,

38 *
√ed_wøp_check
);

40 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/keytools.h

5 #i‚de‡
_KEYTOOLS_H


6 
	#_KEYTOOLS_H


	)

8 #ifde‡
__˝lu•lus


13 
	#USM_LENGTH_EXPANDED_PASSPHRASE
 (1024 * 1024Ë

	)

15 
	#USM_LENGTH_KU_HASHBLOCK
 64

	)

17 
	#USM_LENGTH_P_MIN
 8

	)

27 
NETSNMP_IMPORT


28 
gíî©e_Ku
(c⁄° 
oid
 * 
hashty≥
, 
u_öt
 
hashty≥_Àn
,

29 c⁄° 
u_ch¨
 * 
P
, 
size_t
 
µÀn
,

30 
u_ch¨
 * 
Ku
, 
size_t
 * 
kuÀn
);

32 
NETSNMP_IMPORT


33 
gíî©e_kul
(c⁄° 
oid
 * 
hashty≥
, 
u_öt
 
hashty≥_Àn
,

34 c⁄° 
u_ch¨
 * 
ígöeID
, 
size_t
 
ígöeID_Àn
,

35 c⁄° 
u_ch¨
 * 
Ku
, 
size_t
 
ku_Àn
,

36 
u_ch¨
 * 
Kul
, 
size_t
 * 
kul_Àn
);

38 
NETSNMP_IMPORT


39 
ícode_keych™ge
(c⁄° 
oid
 * 
hashty≥
,

40 
u_öt
 
hashty≥_Àn
, 
u_ch¨
 * 
ﬁdkey
,

41 
size_t
 
ﬁdkey_Àn
, 
u_ch¨
 * 
√wkey
,

42 
size_t
 
√wkey_Àn
, 
u_ch¨
 * 
kc°rög
,

43 
size_t
 * 
kc°rög_Àn
);

45 
NETSNMP_IMPORT


46 
decode_keych™ge
(c⁄° 
oid
 * 
hashty≥
,

47 
u_öt
 
hashty≥_Àn
, 
u_ch¨
 * 
ﬁdkey
,

48 
size_t
 
ﬁdkey_Àn
, 
u_ch¨
 * 
kc°rög
,

49 
size_t
 
kc°rög_Àn
, 
u_ch¨
 * 
√wkey
,

50 
size_t
 * 
√wkey_Àn
);

56 
	#_KEYTOOLS_NOT_AVAILABLE
 \

58  
SNMPERR_KT_NOT_AVAILABLE
; \

59 }

	)

61 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/lcd_time.h

5 #i‚de‡
_LCD_TIME_H


6 
	#_LCD_TIME_H


	)

8 #ifde‡
__˝lu•lus


16 
	#LCD_TIME_SYNC_OPT
 1

	)

21 
	#ETIMELIST_SIZE
 23

	)

25 
	sígöëime_°ru˘
 {

26 
u_ch¨
 *
ígöeID
;

27 
u_öt
 
ígöeID_Àn
;

29 
u_öt
 
ígöeTime
;

30 
u_öt
 
ígöeBoŸ
;

36 
time_t
 
œ°Re˚ivedEngöeTime
;

42 #ifde‡
LCD_TIME_SYNC_OPT


43 
u_öt
 
authítiˇãdFœg
;

45 
ígöëime_°ru˘
 *
√xt
;

46 } 
	tígöëime
 , *
	tEngöëime
;

81 
	#ISENGINEKNOWN
(
e
, 
e_l
) \

82 –(
	`gë_ígöëime
(
e
, 
e_l
, \

83 &
dummy_eboŸ
, &
dummy_ëime
, 
TRUE
Ë=
SNMPERR_SUCCESS
) \

84 ? 
TRUE
 \

85 : 
FALSE
 )

	)

87 
	#ENSURE_ENGINE_RECORD
(
e
, 
e_l
) \

88 –(
	`£t_ígöëime
(
e
, 
e_l
, 0, 0, 
FALSE
Ë=
SNMPERR_SUCCESS
) \

89 ? 
SNMPERR_SUCCESS
 \

90 : 
SNMPERR_GENERR
 )

	)

92 
	#MAKENEW_ENGINE_RECORD
(
e
, 
e_l
) \

93 –(
	`ISENGINEKNOWN
(
e
, 
e_l
Ë=
TRUE
) \

94 ? 
SNMPERR_SUCCESS
 \

95 : (
	`ENSURE_ENGINE_RECORD
(
e
, 
e_l
), 
SNMPERR_GENERR
Ë)

	)

102 
gë_ígöëime
(c⁄° 
u_ch¨
 * 
ígöeID
, 
u_öt
 
ígöeID_Àn
,

103 
u_öt
 * 
ígöe_boŸ
,

104 
u_öt
 * 
ígöe_time
,

105 
u_öt
 
authítiˇãd
);

107 
gë_ígöëime_ex
(
u_ch¨
 * 
ígöeID
,

108 
u_öt
 
ígöeID_Àn
,

109 
u_öt
 * 
ígöe_boŸ
,

110 
u_öt
 * 
ígöe_time
,

111 
u_öt
 * 
œ°_ígöe_time
,

112 
u_öt
 
authítiˇãd
);

114 
£t_ígöëime
(c⁄° 
u_ch¨
 * 
ígöeID
, 
u_öt
 
ígöeID_Àn
,

115 
u_öt
 
ígöe_boŸ
, u_öà
ígöe_time
,

116 
u_öt
 
authítiˇãd
);

124 
Engöëime


125 
£¨ch_ígöëime_li°
(c⁄° 
u_ch¨
 * 
ígöeID
, 
u_öt
 
ígöeID_Àn
);

127 
hash_ígöeID
(c⁄° 
u_ch¨
 * 
ígöeID
, 
u_öt
 
ígöeID_Àn
);

129 
dump_ëimñi°_íåy
(
Engöëime
 
e
, 
cou¡
);

130 
dump_ëimñi°
();

131 
‰ì_ëimñi°
();

132 
‰ì_ígöëime
(*
ígöeID
, 
size_t
 
ígöeID_Àn
);

134 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/md5.h

9 #i‚de‡
MD5_H


10 
	#MD5_H


	)

12 #ifde‡
__˝lu•lus


21 
buf„r
[4];

22 
cou¡
[8];

23 
d⁄e
;

24 } 
	tMD°ru˘
 , *
	tMD±r
;

31 
NETSNMP_IMPORT
 
MDbegö
(
MD±r
);

46 
NETSNMP_IMPORT
 
MDupd©e
(
MD±r
, const *, );

55 
MD¥öt
(
MD±r
);

57 
MDchecksum
(c⁄° 
u_ch¨
 * 
d©a
, 
size_t
 
Àn
, u_ch¨ * 
mac
,

58 
size_t
 
ma˛í
);

59 
MDsign
(c⁄° 
u_ch¨
 * 
d©a
, 
size_t
 
Àn
, u_ch¨ * 
mac
,

60 
size_t
 
ma˛í
, c⁄° 
u_ch¨
 * 
£¸ë
,

61 
size_t
 
£¸ëÀn
);

62 
MDgë
(
MD°ru˘
 * 
MD
, 
u_ch¨
 * 
buf
, 
size_t
 
buÊí
);

68 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/mib.h

1 #i‚de‡
MIB_H


2 
	#MIB_H


	)

4 #ifde‡
__˝lu•lus


35 
	~<°dio.h
>

37 
	~<√t-¢mp/mib_≠i.h
>

39 
	#NETSNMP_MIB2_OID
 1, 3, 6, 1, 2, 1

	)

41 #i‚de‡
NETSNMP_NO_LEGACY_DEFINITIONS


42 
	#MIB
 
NETSNMP_MIB2_OID


	)

45 
	#MIB_IFTYPE_OTHER
 1

	)

46 
	#MIB_IFTYPE_REGULAR1822
 2

	)

47 
	#MIB_IFTYPE_HDH1822
 3

	)

48 
	#MIB_IFTYPE_DDNX25
 4

	)

49 
	#MIB_IFTYPE_RFC877X25
 5

	)

50 
	#MIB_IFTYPE_ETHERNETCSMACD
 6

	)

51 
	#MIB_IFTYPE_ISO88023CSMACD
 7

	)

52 
	#MIB_IFTYPE_ISO88024TOKENBUS
 8

	)

53 
	#MIB_IFTYPE_ISO88025TOKENRING
 9

	)

54 
	#MIB_IFTYPE_ISO88026MAN
 10

	)

55 
	#MIB_IFTYPE_STARLAN
 11

	)

56 
	#MIB_IFTYPE_PROTEON10MBIT
 12

	)

57 
	#MIB_IFTYPE_PROTEON80MBIT
 13

	)

58 
	#MIB_IFTYPE_HYPERCHANNEL
 14

	)

59 
	#MIB_IFTYPE_FDDI
 15

	)

60 
	#MIB_IFTYPE_LAPB
 16

	)

61 
	#MIB_IFTYPE_SDLC
 17

	)

62 
	#MIB_IFTYPE_T1CARRIER
 18

	)

63 
	#MIB_IFTYPE_CEPT
 19

	)

64 
	#MIB_IFTYPE_BASICISDN
 20

	)

65 
	#MIB_IFTYPE_PRIMARYISDN
 21

	)

66 
	#MIB_IFTYPE_PROPPOINTTOPOINTSERIAL
 22

	)

68 
	#MIB_IFSTATUS_UP
 1

	)

69 
	#MIB_IFSTATUS_DOWN
 2

	)

70 
	#MIB_IFSTATUS_TESTING
 3

	)

72 
	#MIB_FORWARD_GATEWAY
 1

	)

73 
	#MIB_FORWARD_HOST
 2

	)

75 
	#MIB_IPROUTETYPE_OTHER
 1

	)

76 
	#MIB_IPROUTETYPE_INVALID
 2

	)

77 
	#MIB_IPROUTETYPE_DIRECT
 3

	)

78 
	#MIB_IPROUTETYPE_REMOTE
 4

	)

80 
	#MIB_IPROUTEPROTO_OTHER
 1

	)

81 
	#MIB_IPROUTEPROTO_LOCAL
 2

	)

82 
	#MIB_IPROUTEPROTO_NETMGMT
 3

	)

83 
	#MIB_IPROUTEPROTO_ICMP
 4

	)

84 
	#MIB_IPROUTEPROTO_EGP
 5

	)

85 
	#MIB_IPROUTEPROTO_GGP
 6

	)

86 
	#MIB_IPROUTEPROTO_HELLO
 7

	)

87 
	#MIB_IPROUTEPROTO_RIP
 8

	)

88 
	#MIB_IPROUTEPROTO_ISIS
 9

	)

89 
	#MIB_IPROUTEPROTO_ESIS
 10

	)

90 
	#MIB_IPROUTEPROTO_CISCOIGRP
 11

	)

91 
	#MIB_IPROUTEPROTO_BBNSPFIGP
 12

	)

92 
	#MIB_IPROUTEPROTO_OIGP
 13

	)

94 
	#MIB_TCPRTOALG_OTHER
 1

	)

95 
	#MIB_TCPRTOALG_CONSTANT
 2

	)

96 
	#MIB_TCPRTOALG_RSRE
 3

	)

97 
	#MIB_TCPRTOALG_VANJ
 4

	)

99 
	#MIB_TCPCONNSTATE_CLOSED
 1

	)

100 
	#MIB_TCPCONNSTATE_LISTEN
 2

	)

101 
	#MIB_TCPCONNSTATE_SYNSENT
 3

	)

102 
	#MIB_TCPCONNSTATE_SYNRECEIVED
 4

	)

103 
	#MIB_TCPCONNSTATE_ESTABLISHED
 5

	)

104 
	#MIB_TCPCONNSTATE_FINWAIT1
 6

	)

105 
	#MIB_TCPCONNSTATE_FINWAIT2
 7

	)

106 
	#MIB_TCPCONNSTATE_CLOSEWAIT
 8

	)

107 
	#MIB_TCPCONNSTATE_LASTACK
 9

	)

108 
	#MIB_TCPCONNSTATE_CLOSING
 10

	)

109 
	#MIB_TCPCONNSTATE_TIMEWAIT
 11

	)

111 
	#MIB_EGPNEIGHSTATE_IDLE
 1

	)

112 
	#MIB_EGPNEIGHSTATE_AQUISITION
 2

	)

113 
	#MIB_EGPNEIGHSTATE_DOWN
 3

	)

114 
	#MIB_EGPNEIGHSTATE_UP
 4

	)

115 
	#MIB_EGPNEIGHSTATE_CEASE
 5

	)

117 
v¨übÀ_li°
;

118 
íum_li°
;

120 
NETSNMP_IMPORT


121 
¥öt_ascii_dump
(
FILE
 *);

122 
ªgi°î_mib_h™dÀrs
();

123 
√t¢mp_£t_mib_dúe˘‹y
(c⁄° *
dú
);

124 
NETSNMP_IMPORT


125 *
√t¢mp_gë_mib_dúe˘‹y
();

126 
√t¢mp_fixup_mib_dúe˘‹y
();

127 
√t¢mp_mibödex_lﬂd
( );

128 * 
√t¢mp_mibödex_lookup
( const * );

129 
FILE
 * 
√t¢mp_mibödex_√w
( const * );

130 
•röt_ªÆloc_des¸ùti⁄
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

131 
size_t
 * 
out_Àn
, 
Ælow_ªÆloc
,

132 
oid
 * 
objid
, 
size_t
 
objidÀn
, 
width
);

133 
NETSNMP_IMPORT


134 
gë_wûd_node
(c⁄° *, 
oid
 *, 
size_t
 *);

135 
NETSNMP_IMPORT


136 
gë_node
(c⁄° *, 
oid
 *, 
size_t
 *);

137 
NETSNMP_IMPORT


138 
åì
 *
gë_åì
(c⁄° 
oid
 *, 
size_t
, tree *);

139 
NETSNMP_IMPORT


140 
åì
 *
gë_åì_hód
();

141 
£t_fun˘i⁄
(
åì
 *);

143 
NETSNMP_IMPORT


144 
∑r£_⁄e_oid_ödex
(
oid
 ** 
oidSèπ
, 
size_t
 * 
oidLí
,

145 
√t¢mp_v¨übÀ_li°
 * 
d©a
,

146 
com∂ëe
);

147 
NETSNMP_IMPORT


148 
∑r£_oid_ödexes
(
oid
 * 
oidIndex
, 
size_t
 
oidLí
,

149 
√t¢mp_v¨übÀ_li°
 * 
d©a
);

150 
NETSNMP_IMPORT


151 
buûd_oid_nﬂŒoc
(
oid
 * 
ö
, 
size_t
 
ö_Àn
,

152 
size_t
 * 
out_Àn
, 
oid
 * 
¥efix
,

153 
size_t
 
¥efix_Àn
,

154 
√t¢mp_v¨übÀ_li°
 * 
ödexes
);

155 
NETSNMP_IMPORT


156 
buûd_oid
(
oid
 ** 
out
, 
size_t
 * 
out_Àn
, oid * 
¥efix
,

157 
size_t
 
¥efix_Àn
,

158 
√t¢mp_v¨übÀ_li°
 * 
ödexes
);

159 
buûd_oid_£gmít
(
√t¢mp_v¨übÀ_li°
 * 
v¨
);

161 
NETSNMP_IMPORT


162 
•röt_ªÆloc_v¨übÀ
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

163 
size_t
 * 
out_Àn
, 
Ælow_ªÆloc
,

164 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

165 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

167 
NETSNMP_IMPORT


168 #i‚de‡
NETSNMP_DISABLE_MIB_LOADING


169 
åì
 *

173 
√t¢mp_•röt_ªÆloc_objid_åì
(
u_ch¨
 ** 
buf
,

174 
size_t
 * 
buf_Àn
,

175 
size_t
 * 
out_Àn
,

176 
Ælow_ªÆloc
,

177 *
buf_ovîÊow
,

178 c⁄° 
oid
 * 
objid
,

179 
size_t
 
objidÀn
);

181 
NETSNMP_IMPORT


183 
√t¢mp_•röt_ªÆloc_objid
(
u_ch¨
 ** 
buf
,

184 
size_t
 * 
buf_Àn
,

185 
size_t
 * 
out_Àn
,

186 
Ælow_ªÆloc
,

187 *
buf_ovîÊow
,

188 c⁄° 
oid
 * 
objid
,

189 
size_t
 
objidÀn
);

191 
NETSNMP_IMPORT


192 
•röt_ªÆloc_vÆue
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

193 
size_t
 * 
out_Àn
, 
Ælow_ªÆloc
,

194 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
,

195 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨übÀ
);

197 
NETSNMP_IMPORT


198 
•röt_ªÆloc_objid
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

199 
size_t
 * 
out_Àn
, 
Ælow_ªÆloc
,

200 c⁄° 
oid
 * 
objid
, 
size_t
 
objidÀn
);

202 
NETSNMP_IMPORT


203 
•röt_ªÆloc_by_ty≥
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

204 
size_t
 * 
out_Àn
,

205 
Ælow_ªÆloc
,

206 c⁄° 
√t¢mp_v¨übÀ_li°
 * 
v¨
,

207 c⁄° 
íum_li°
 *
íums
,

208 c⁄° *
höt
,

209 c⁄° *
unôs
);

211 
NETSNMP_IMPORT


212 
•röt_ªÆloc_hex°rög
(
u_ch¨
 ** 
buf
,

213 
size_t
 * 
buf_Àn
,

214 
size_t
 * 
out_Àn
,

215 
Ælow_ªÆloc
,

216 c⁄° 
u_ch¨
 *, 
size_t
);

218 
NETSNMP_IMPORT


219 
•röt_ªÆloc_ascii°rög
(
u_ch¨
 ** 
buf
,

220 
size_t
 * 
buf_Àn
,

221 
size_t
 * 
out_Àn
,

222 
Ælow_ªÆloc
,

223 c⁄° 
u_ch¨
 * 
˝
,

224 
size_t
 
Àn
);

226 
•röt_ªÆloc_o˘ë_°rög
(
u_ch¨
 ** 
buf
,

227 
size_t
 * 
buf_Àn
,

228 
size_t
 * 
out_Àn
,

229 
Ælow_ªÆloc
,

230 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

231 c⁄° 
íum_li°
 *,

235 
•röt_ªÆloc_›aque
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

236 
size_t
 * 
out_Àn
,

237 
Ælow_ªÆloc
,

238 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

239 c⁄° 
íum_li°
 *, const *,

242 
•röt_ªÆloc_obje˘_idítifõr
(
u_ch¨
 ** 
buf
,

243 
size_t
 * 
buf_Àn
,

244 
size_t
 * 
out_Àn
,

245 
Ælow_ªÆloc
,

246 c⁄° 
√t¢mp_v¨übÀ_li°


247 *, c⁄° 
íum_li°
 *,

251 
•röt_ªÆloc_timëicks
(
u_ch¨
 ** 
buf
,

252 
size_t
 * 
buf_Àn
,

253 
size_t
 * 
out_Àn
,

254 
Ælow_ªÆloc
,

255 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

256 c⁄° 
íum_li°
 *,

259 
•röt_ªÆloc_höãd_öãgî
(
u_ch¨
 ** 
buf
,

260 
size_t
 * 
buf_Àn
,

261 
size_t
 * 
out_Àn
,

262 
Ælow_ªÆloc
, ,

266 
•röt_ªÆloc_öãgî
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

267 
size_t
 * 
out_Àn
,

268 
Ælow_ªÆloc
,

269 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

270 c⁄° 
íum_li°
 *,

273 
•röt_ªÆloc_uöãgî
(
u_ch¨
 ** 
buf
,

274 
size_t
 * 
buf_Àn
,

275 
size_t
 * 
out_Àn
,

276 
Ælow_ªÆloc
,

277 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

278 c⁄° 
íum_li°
 *,

281 
•röt_ªÆloc_gauge
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

282 
size_t
 * 
out_Àn
,

283 
Ælow_ªÆloc
,

284 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

285 c⁄° 
íum_li°
 *, const *,

288 
•röt_ªÆloc_cou¡î
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

289 
size_t
 * 
out_Àn
,

290 
Ælow_ªÆloc
,

291 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

292 c⁄° 
íum_li°
 *,

295 
•röt_ªÆloc_√tw‹kaddªss
(
u_ch¨
 ** 
buf
,

296 
size_t
 * 
buf_Àn
,

297 
size_t
 * 
out_Àn
,

298 
Ælow_ªÆloc
,

299 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

300 c⁄° 
íum_li°
 *,

304 
•röt_ªÆloc_ùaddªss
(
u_ch¨
 ** 
buf
,

305 
size_t
 * 
buf_Àn
,

306 
size_t
 * 
out_Àn
,

307 
Ælow_ªÆloc
,

308 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

309 c⁄° 
íum_li°
 *,

312 
•röt_ªÆloc_nuŒ
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

313 
size_t
 * 
out_Àn
,

314 
Ælow_ªÆloc
,

315 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

316 c⁄° 
íum_li°
 *, const *,

319 
•röt_ªÆloc_bô°rög
(
u_ch¨
 ** 
buf
,

320 
size_t
 * 
buf_Àn
,

321 
size_t
 * 
out_Àn
,

322 
Ælow_ªÆloc
,

323 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

324 c⁄° 
íum_li°
 *,

327 
•röt_ªÆloc_nß∑ddªss
(
u_ch¨
 ** 
buf
,

328 
size_t
 * 
buf_Àn
,

329 
size_t
 * 
out_Àn
,

330 
Ælow_ªÆloc
,

331 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

332 c⁄° 
íum_li°
 *,

335 
•röt_ªÆloc_cou¡î64
(
u_ch¨
 ** 
buf
,

336 
size_t
 * 
buf_Àn
,

337 
size_t
 * 
out_Àn
,

338 
Ælow_ªÆloc
,

339 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

340 c⁄° 
íum_li°
 *,

343 
•röt_ªÆloc_badty≥
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

344 
size_t
 * 
out_Àn
,

345 
Ælow_ªÆloc
,

346 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

347 c⁄° 
íum_li°
 *,

350 #ifde‡
NETSNMP_WITH_OPAQUE_SPECIAL_TYPES


351 
•röt_ªÆloc_Êﬂt
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

352 
size_t
 * 
out_Àn
,

353 
Ælow_ªÆloc
,

354 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

355 c⁄° 
íum_li°
 *, const *,

358 
•röt_ªÆloc_doubÀ
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

359 
size_t
 * 
out_Àn
,

360 
Ælow_ªÆloc
,

361 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

362 c⁄° 
íum_li°
 *, const *,

367 
¢¥öt_by_ty≥
(*
buf
, 
size_t
 
buf_Àn
,

368 
√t¢mp_v¨übÀ_li°
 * 
v¨
,

369 c⁄° 
íum_li°
 *
íums
,

370 c⁄° *
höt
, c⁄° *
unôs
);

372 
¢¥öt_hex°rög
(*
buf
, 
size_t
 
buf_Àn
,

373 c⁄° 
u_ch¨
 *, 
size_t
);

375 
¢¥öt_ascii°rög
(*
buf
, 
size_t
 
buf_Àn
,

376 c⁄° 
u_ch¨
 * 
˝
, 
size_t
 
Àn
);

378 
¢¥öt_o˘ë_°rög
(*
buf
, 
size_t
 
buf_Àn
,

379 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

380 c⁄° 
íum_li°
 *, const *,

383 
¢¥öt_›aque
(*
buf
, 
size_t
 
buf_Àn
,

384 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

385 c⁄° 
íum_li°
 *, const *,

388 
¢¥öt_obje˘_idítifõr
(*
buf
, 
size_t
 
buf_Àn
,

389 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

390 c⁄° 
íum_li°
 *,

393 
¢¥öt_timëicks
(*
buf
, 
size_t
 
buf_Àn
,

394 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

395 c⁄° 
íum_li°
 *, const *,

398 
¢¥öt_höãd_öãgî
(*
buf
, 
size_t
 
buf_Àn
,

402 
¢¥öt_öãgî
(*
buf
, 
size_t
 
buf_Àn
,

403 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

404 c⁄° 
íum_li°
 *, const *,

407 
¢¥öt_uöãgî
(*
buf
, 
size_t
 
buf_Àn
,

408 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

409 c⁄° 
íum_li°
 *, const *,

412 
¢¥öt_gauge
(*
buf
, 
size_t
 
buf_Àn
,

413 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

414 c⁄° 
íum_li°
 *, const *,

417 
¢¥öt_cou¡î
(*
buf
, 
size_t
 
buf_Àn
,

418 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

419 c⁄° 
íum_li°
 *, const *,

422 
¢¥öt_√tw‹kaddªss
(*
buf
, 
size_t
 
buf_Àn
,

423 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

424 c⁄° 
íum_li°
 *,

427 
¢¥öt_ùaddªss
(*
buf
, 
size_t
 
buf_Àn
,

428 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

429 c⁄° 
íum_li°
 *, const *,

432 
¢¥öt_nuŒ
(*
buf
, 
size_t
 
buf_Àn
,

433 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

434 c⁄° 
íum_li°
 *, const *,

437 
NETSNMP_IMPORT


438 
¢¥öt_bô°rög
(*
buf
, 
size_t
 
buf_Àn
,

439 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

440 c⁄° 
íum_li°
 *, const *,

443 
¢¥öt_nß∑ddªss
(*
buf
, 
size_t
 
buf_Àn
,

444 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

445 c⁄° 
íum_li°
 *, const *,

448 
¢¥öt_cou¡î64
(*
buf
, 
size_t
 
buf_Àn
,

449 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

450 c⁄° 
íum_li°
 *, const *,

453 
¢¥öt_badty≥
(*
buf
, 
size_t
 
buf_Àn
,

454 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

455 c⁄° 
íum_li°
 *, const *,

458 #ifde‡
NETSNMP_WITH_OPAQUE_SPECIAL_TYPES


459 
¢¥öt_Êﬂt
(*
buf
, 
size_t
 
buf_Àn
,

460 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

461 c⁄° 
íum_li°
 *, const *,

464 
¢¥öt_doubÀ
(*
buf
, 
size_t
 
buf_Àn
,

465 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

466 c⁄° 
íum_li°
 *, const *,

470 
NETSNMP_IMPORT


471 
¥öt_oid_ªp‹t
(
FILE
 *);

472 
NETSNMP_IMPORT


473 
¥öt_oid_ªp‹t_íabÀ_œbñedoid
();

474 
NETSNMP_IMPORT


475 
¥öt_oid_ªp‹t_íabÀ_oid
();

476 
NETSNMP_IMPORT


477 
¥öt_oid_ªp‹t_íabÀ_suffix
();

478 
NETSNMP_IMPORT


479 
¥öt_oid_ªp‹t_íabÀ_symbﬁic
();

480 
NETSNMP_IMPORT


481 
¥öt_oid_ªp‹t_íabÀ_mibchûdoid
();

483 c⁄° *
∑r£_o˘ë_höt
(c⁄° *
höt
, c⁄° *
vÆue
,

484 **
√w_vÆ
, *
√w_vÆ_Àn
);

486 
NETSNMP_IMPORT


487 
˛ór_åì_Êags
(
åì
 *
ç
);

489 
NETSNMP_IMPORT


490 *
¢mp_out_toggÀ_›ti⁄s
(*);

491 
NETSNMP_IMPORT


492 
¢mp_out_toggÀ_›ti⁄s_ußge
(c⁄° *, 
FILE
 *);

493 
NETSNMP_IMPORT


494 *
¢mp_ö_toggÀ_›ti⁄s
(*);

495 *
¢mp_ö_›ti⁄s
(*, , * const *);

496 
NETSNMP_IMPORT


497 
¢mp_ö_toggÀ_›ti⁄s_ußge
(c⁄° *, 
FILE
 *);

498 
NETSNMP_IMPORT


499 
u_ch¨
 
mib_to_a¢_ty≥
(
mib_ty≥
);

502 
√t¢mp_°r2oid
(c⁄° *
S
, 
oid
 * 
O
, 
L
);

505 
	#NETSNMP_STRING_OUTPUT_GUESS
 1

	)

506 
	#NETSNMP_STRING_OUTPUT_ASCII
 2

	)

507 
	#NETSNMP_STRING_OUTPUT_HEX
 3

	)

509 
	#NETSNMP_OID_OUTPUT_SUFFIX
 1

	)

510 
	#NETSNMP_OID_OUTPUT_MODULE
 2

	)

511 
	#NETSNMP_OID_OUTPUT_FULL
 3

	)

512 
	#NETSNMP_OID_OUTPUT_NUMERIC
 4

	)

513 
	#NETSNMP_OID_OUTPUT_UCD
 5

	)

514 
	#NETSNMP_OID_OUTPUT_NONE
 6

	)

515 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/mt_support.h

12 #i‚de‡
MT_SUPPORT_H


13 
	#MT_SUPPORT_H


	)

15 #ifde‡
__˝lu•lus


23 
	#MT_LIBRARY_ID
 0

	)

24 
	#MT_APPLICATION_ID
 1

	)

25 
	#MT_TOKEN_ID
 2

	)

27 
	#MT_MAX_IDS
 3

	)

28 
	#MT_MAX_SUBIDS
 10

	)

35 
	#MT_LIB_NONE
 0

	)

36 
	#MT_LIB_SESSION
 1

	)

37 
	#MT_LIB_REQUESTID
 2

	)

38 
	#MT_LIB_MESSAGEID
 3

	)

39 
	#MT_LIB_SESSIONID
 4

	)

40 
	#MT_LIB_TRANSID
 5

	)

42 
	#MT_LIB_MAXIMUM
 6

	)

45 #i‡
deföed
(
NETSNMP_REENTRANT
Ë|| deföed(
WIN32
)

47 #i‡
HAVE_PTHREAD_H


48 
	~<±hªad.h
>

49 
±hªad_muãx_t
 
	tmuãx_ty≥
;

50 #ifde‡
±hªad_muãx©å_deÁu…


51 
	#MT_MUTEX_INIT_DEFAULT
 
±hªad_muãx©å_deÁu…


	)

53 
	#MT_MUTEX_INIT_DEFAULT
 0

	)

56 #ñi‡
deföed
(
WIN32
Ë|| deföed(
cygwö
)

58 
	~<wödows.h
>

59 
CRITICAL_SECTION
 
	tmuãx_ty≥
;

62 
îr‹
 "There isÇoÑe-entrant supportás defined."

66 
NETSNMP_IMPORT


67 
¢mp_ªs_öô
();

68 
NETSNMP_IMPORT


69 
¢mp_ªs_lock
(
groupID
, 
ªsour˚ID
);

70 
NETSNMP_IMPORT


71 
¢mp_ªs_u∆ock
(
groupID
, 
ªsour˚ID
);

72 
NETSNMP_IMPORT


73 
¢mp_ªs_de°roy_muãx
(
groupID
, 
ªsour˚ID
);

77 #i‚de‡
WIN32


78 
	#¢mp_ªs_öô
(Ëdÿ{} 0)

	)

79 
	#¢mp_ªs_lock
(
x
,
y
Ëdÿ{} 0)

	)

80 
	#¢mp_ªs_u∆ock
(
x
,
y
Ëdÿ{} 0)

	)

81 
	#¢mp_ªs_de°roy_muãx
(
x
,
y
Ëdÿ{} 0)

	)

86 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/oid.h

1 #i‚de‡
NETSNMP_LIBRARY_OID_H


2 
	#NETSNMP_LIBRARY_OID_H


	)

4 #ifde‡
HAVE_INTTYPES_H


5 
	~<öây≥s.h
>

8 #i‚de‡
EIGHTBIT_SUBIDS


9 
u_l⁄g
 
	toid
;

10 
	#MAX_SUBID
 0xFFFFFFFFUL

	)

11 
	#NETSNMP_PRIo
 "l"

	)

13 
uöt8_t
 
	toid
;

14 
	#MAX_SUBID
 0xFF

	)

15 
	#NETSNMP_PRIo
 ""

	)

	@/usr/include/net-snmp/library/oid_stash.h

1 #i‚de‡
OID_STASH_H


2 
	#OID_STASH_H


	)

9 
	#OID_STASH_CHILDREN_SIZE
 31

	)

11 #ifde‡
__˝lu•lus


15 
√t¢mp_oid_°ash_node_s
;

18 (
NëSNMPSèshDump
Ë(*, 
	tsize_t
,

20 
	t√t¢mp_oid_°ash_node_s
 *);

22 (
NëSNMPSèshFªeNode
) (*);

24 
	s√t¢mp_oid_°ash_node_s
 {

25 
oid
 
vÆue
;

26 
√t¢mp_oid_°ash_node_s
 **
chûdªn
;

27 
size_t
 
chûdªn_size
;

28 
√t¢mp_oid_°ash_node_s
 *
√xt_siblög
;

29 
√t¢mp_oid_°ash_node_s
 *
¥ev_siblög
;

30 
√t¢mp_oid_°ash_node_s
 *
∑ª¡
;

32 *
thed©a
;

33 } 
	t√t¢mp_oid_°ash_node
;

35 
	s√t¢mp_oid_°ash_ßve_öfo_s
 {

36 c⁄° *
tokí
;

37 
√t¢mp_oid_°ash_node
 **
roŸ
;

38 
NëSNMPSèshDump
 *
dump‚
;

39 } 
	t√t¢mp_oid_°ash_ßve_öfo
;

41 
NETSNMP_IMPORT


42 
√t¢mp_oid_°ash_add_d©a
(
√t¢mp_oid_°ash_node
 **
roŸ
,

43 c⁄° 
oid
 * 
lookup
,

44 
size_t
 
lookup_Àn
,

45 *
myd©a
);

46 
SNMPCÆlback
 
√t¢mp_oid_°ash_°‹e_Æl
;

49 
√t¢mp_oid_°ash_node


50 *
√t¢mp_oid_°ash_gë_node
(
√t¢mp_oid_°ash_node
 *
roŸ
,

51 c⁄° 
oid
 * 
lookup
, 
size_t
 
lookup_Àn
);

52 
NETSNMP_IMPORT


53 *
√t¢mp_oid_°ash_gë_d©a
(
√t¢mp_oid_°ash_node
 *
roŸ
,

54 c⁄° 
oid
 * 
lookup
,

55 
size_t
 
lookup_Àn
);

56 
NETSNMP_IMPORT


57 
√t¢mp_oid_°ash_node
 *

58 
√t¢mp_oid_°ash_gë√xt_node
(
√t¢mp_oid_°ash_node
 *
roŸ
,

59 
oid
 * 
lookup
, 
size_t
 
lookup_Àn
);

61 
√t¢mp_oid_°ash_node
 *
√t¢mp_oid_°ash_¸óã_sized_node
(
size_t


62 
mysize
);

63 
√t¢mp_oid_°ash_node
 *
√t¢mp_oid_°ash_¸óã_node
();

65 
√t¢mp_oid_°ash_°‹e
(
√t¢mp_oid_°ash_node
 *
roŸ
,

66 c⁄° *
tokí«me
,

67 
NëSNMPSèshDump
 *
dump‚
,

68 
oid
 *
curoid
, 
size_t
 
curoid_Àn
);

71 
NETSNMP_IMPORT


72 
√t¢mp_oid_°ash_‰ì
(
√t¢mp_oid_°ash_node
 **
roŸ
,

73 
NëSNMPSèshFªeNode
 *
‰ì‚
);

78 
NëSNMPSèshFªeNode
 
√t¢mp_oid_°ash_no_‰ì
;

79 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/parse.h

1 #i‚de‡
PARSE_H


2 
	#PARSE_H


	)

4 #ifde‡
__˝lu•lus


8 
	~<√t-¢mp/mib_≠i.h
>

35 
	#NETSNMP_MAXLABEL
 64

	)

36 
	#MAXTOKEN
 128

	)

37 
	#MAXQUOTESTR
 4096

	)

44 #ifde‡
UCD_COMPATIBLE


45 
	#MAXLABEL
 
NETSNMP_MAXLABEL


	)

48 
v¨übÀ_li°
;

53 
	síum_li°
 {

54 
íum_li°
 *
√xt
;

55 
vÆue
;

56 *
œbñ
;

62 
	sønge_li°
 {

63 
ønge_li°
 *
√xt
;

64 
low
, 
high
;

70 
	södex_li°
 {

71 
ödex_li°
 *
√xt
;

72 *
ûabñ
;

73 
isim∂õd
;

79 
	sv¨böd_li°
 {

80 
v¨böd_li°
 *
√xt
;

81 *
vbœbñ
;

87 
	såì
 {

88 
åì
 *
chûd_li°
;

89 
åì
 *
√xt_≥î
;

90 
åì
 *
√xt
;

91 
åì
 *
∑ª¡
;

92 *
œbñ
;

93 
u_l⁄g
 
subid
;

94 
modid
;

95 
numbî_moduÀs
;

96 *
moduÀ_li°
;

97 
tc_ödex
;

98 
ty≥
;

99 
ac˚ss
;

100 
°©us
;

101 
íum_li°
 *
íums
;

102 
ønge_li°
 *
ønges
;

103 
ödex_li°
 *
ödexes
;

104 *
augmíts
;

105 
v¨böd_li°
 *
v¨böds
;

106 *
höt
;

107 *
unôs
;

108 (*
¥ötom©
Ë(
u_ch¨
 **, 
size_t
 *, size_t *, ,

109 c⁄° 
√t¢mp_v¨übÀ_li°
 *,

110 c⁄° 
íum_li°
 *, const *,

112 (*
¥öãr
Ë(*, c⁄° 
√t¢mp_v¨übÀ_li°
 *, c⁄° 
íum_li°
 *, const *, const *);

113 *
des¸ùti⁄
;

114 *
ª„ªn˚
;

115 
ªp‹ãd
;

116 *
deÁu…VÆue
;

117 *
∑r£Eº‹Såög
;

123 
	smoduÀ_imp‹t
 {

124 *
œbñ
;

125 
modid
;

128 
	smoduÀ
 {

129 *
«me
;

130 *
fûe
;

131 
moduÀ_imp‹t
 *
imp‹ts
;

132 
no_imp‹ts
;

136 
modid
;

137 
moduÀ
 *
√xt
;

140 
	smoduÀ_com∑èbûôy
 {

141 c⁄° *
ﬁd_moduÀ
;

142 c⁄° *
√w_moduÀ
;

143 c⁄° *
èg
;

145 
size_t
 
èg_Àn
;

146 
moduÀ_com∑èbûôy
 *
√xt
;

153 
	#TYPE_OTHER
 0

	)

154 
	#TYPE_OBJID
 1

	)

155 
	#TYPE_OCTETSTR
 2

	)

156 
	#TYPE_INTEGER
 3

	)

157 
	#TYPE_NETADDR
 4

	)

158 
	#TYPE_IPADDR
 5

	)

159 
	#TYPE_COUNTER
 6

	)

160 
	#TYPE_GAUGE
 7

	)

161 
	#TYPE_TIMETICKS
 8

	)

162 
	#TYPE_OPAQUE
 9

	)

163 
	#TYPE_NULL
 10

	)

164 
	#TYPE_COUNTER64
 11

	)

165 
	#TYPE_BITSTRING
 12

	)

166 
	#TYPE_NSAPADDRESS
 13

	)

167 
	#TYPE_UINTEGER
 14

	)

168 
	#TYPE_UNSIGNED32
 15

	)

169 
	#TYPE_INTEGER32
 16

	)

171 
	#TYPE_SIMPLE_LAST
 16

	)

173 
	#TYPE_TRAPTYPE
 20

	)

174 
	#TYPE_NOTIFTYPE
 21

	)

175 
	#TYPE_OBJGROUP
 22

	)

176 
	#TYPE_NOTIFGROUP
 23

	)

177 
	#TYPE_MODID
 24

	)

178 
	#TYPE_AGENTCAP
 25

	)

179 
	#TYPE_MODCOMP
 26

	)

180 
	#TYPE_OBJIDENTITY
 27

	)

182 
	#MIB_ACCESS_READONLY
 18

	)

183 
	#MIB_ACCESS_READWRITE
 19

	)

184 
	#MIB_ACCESS_WRITEONLY
 20

	)

185 
	#MIB_ACCESS_NOACCESS
 21

	)

186 
	#MIB_ACCESS_NOTIFY
 67

	)

187 
	#MIB_ACCESS_CREATE
 48

	)

189 
	#MIB_STATUS_MANDATORY
 23

	)

190 
	#MIB_STATUS_OPTIONAL
 24

	)

191 
	#MIB_STATUS_OBSOLETE
 25

	)

192 
	#MIB_STATUS_DEPRECATED
 39

	)

193 
	#MIB_STATUS_CURRENT
 57

	)

195 
	#ANON
 "™⁄ymous#"

	)

196 
	#ANON_LEN
 
	`°æí
(
ANON
)

	)

198 
√t¢mp_u∆ﬂd_moduÀ
(c⁄° *
«me
);

199 #i‚de‡
NETSNMP_NO_LEGACY_DEFINITIONS


200 
u∆ﬂd_moduÀ
(c⁄° *
«me
);

202 
√t¢mp_öô_mib_öã∫Æs
();

203 
u∆ﬂd_Æl_mibs
();

204 
add_mibfûe
(c⁄° *, c⁄° *, 
FILE
 *);

205 
which_moduÀ
(const *);

206 
NETSNMP_IMPORT


207 *
moduÀ_«me
(, *);

208 
NETSNMP_IMPORT


209 
¥öt_subåì
(
FILE
 *, 
åì
 *, );

210 
NETSNMP_IMPORT


211 
¥öt_ascii_dump_åì
(
FILE
 *, 
åì
 *, );

212 
NETSNMP_IMPORT


213 
åì
 *
föd_åì_node
(const *, );

214 
NETSNMP_IMPORT


215 c⁄° *
gë_tc_des¸ùt‹
();

216 
NETSNMP_IMPORT


217 c⁄° *
gë_tc_des¸ùti⁄
();

218 
NETSNMP_IMPORT


219 
åì
 *
föd_be°_åì_node
(const *, tree *,

220 
u_öt
 *);

224 
NETSNMP_IMPORT


225 
åì
 *
föd_node
(const *, tree *);

226 
åì
 *
föd_node2
(const *, const *);

227 
NETSNMP_IMPORT


228 
moduÀ
 *
föd_moduÀ
();

229 
ad›t_‹ph™s
();

230 
NETSNMP_IMPORT


231 *
¢mp_mib_toggÀ_›ti⁄s
(*
›ti⁄s
);

232 
NETSNMP_IMPORT


233 
¢mp_mib_toggÀ_›ti⁄s_ußge
(c⁄° *
Àad
,

234 
FILE
 * 
outf
);

235 
NETSNMP_IMPORT


236 
¥öt_mib
(
FILE
 *);

237 
NETSNMP_IMPORT


238 
¥öt_mib_åì
(
FILE
 *, 
åì
 *, );

239 
gë_mib_∑r£_îr‹_cou¡
();

240 
NETSNMP_IMPORT


241 
¢mp_gë_tokí
(
FILE
 * 
Â
, *
tokí
, 
maxéí
);

242 
NETSNMP_IMPORT


243 
åì
 *
föd_be°_åì_node
(c⁄° *
«me
,

244 
åì
 *
åì_t›
,

245 
u_öt
 * 
m©ch
);

247 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/read_config.h

5 #i‚de‡
READ_CONFIG_H


6 
	#READ_CONFIG_H


	)

8 #ifde‡
__˝lu•lus


12 
	#STRINGMAX
 1024

	)

14 
	#NORMAL_CONFIG
 0

	)

15 
	#PREMIB_CONFIG
 1

	)

16 
	#EITHER_CONFIG
 2

	)

22 
	#NETSNMP_APPLICATION_CONFIG_TYPE
 "¢m∑µ"

	)

24 
	~<√t-¢mp/c⁄fig_≠i.h
>

30 
	sc⁄fig_fûes
 {

31 *
fûeHódî
;

32 
c⁄fig_löe
 *
°¨t
;

33 
c⁄fig_fûes
 *
√xt
;

36 
	sc⁄fig_löe
 {

37 *
c⁄fig_tokí
;

39 (*
∑r£_löe
) (const *, *);

40 (*
‰ì_func
) ();

41 
c⁄fig_löe
 *
√xt
;

42 
c⁄fig_time
;

43 *
hñp
;

46 
	sªad_c⁄fig_mem‹y
 {

47 *
löe
;

48 
ªad_c⁄fig_mem‹y
 *
√xt
;

52 
NETSNMP_IMPORT


53 
√t¢mp_c⁄fig
(*);

54 
NETSNMP_IMPORT


55 
√t¢mp_c⁄fig_ªmembî
(*);

56 
√t¢mp_c⁄fig_¥o˚ss_mem‹õs
();

57 
ªad_c⁄fig
(c⁄° *, 
c⁄fig_löe
 *, );

58 
ªad_c⁄fig_fûes
();

59 
NETSNMP_IMPORT


60 
‰ì_c⁄fig
();

61 #i‡!
deföed
(
__GNUC__
Ë|| __GNUC__ < 2 || (__GNUC__ =2&& 
__GNUC_MINOR__
 < 8)

62 
NETSNMP_IMPORT


63 
√t¢mp_c⁄fig_îr‹
(const *, ...);

64 
√t¢mp_c⁄fig_w¨n
(const *, ...);

66 
NETSNMP_IMPORT


67 
√t¢mp_c⁄fig_îr‹
(const *, ...)

68 
__©åibuã__
((
__f‹m©__
(
__¥ötf__
, 1, 2)));

69 
√t¢mp_c⁄fig_w¨n
(const *, ...)

70 
__©åibuã__
((
__f‹m©__
(
__¥ötf__
, 1, 2)));

73 
NETSNMP_IMPORT


74 *
skù_whôe
(*);

75 c⁄° *
skù_whôe_c⁄°
(const *);

76 
NETSNMP_IMPORT


77 *
skù_nŸ_whôe
(*);

78 c⁄° *
skù_nŸ_whôe_c⁄°
(const *);

79 
NETSNMP_IMPORT


80 *
skù_tokí
(*);

81 
NETSNMP_IMPORT


82 c⁄° *
skù_tokí_c⁄°
(const *);

83 
NETSNMP_IMPORT


84 *
c›y_nw‹d
(*, *, );

85 
NETSNMP_IMPORT


86 c⁄° *
c›y_nw‹d_c⁄°
(const *, *, );

87 
NETSNMP_IMPORT


88 *
c›y_w‹d
(*, *);

89 
NETSNMP_IMPORT


90 
ªad_c⁄fig_wôh_ty≥
(const *, const *);

91 
NETSNMP_IMPORT


92 *
ªad_c⁄fig_ßve_o˘ë_°rög
(*
ßvëo
,

93 
u_ch¨
 * 
°r
,

94 
size_t
 
Àn
);

95 
NETSNMP_IMPORT


96 *
ªad_c⁄fig_ªad_o˘ë_°rög
(c⁄° *
ªad‰om
,

97 
u_ch¨
 ** 
°r
,

98 
size_t
 * 
Àn
);

99 c⁄° *
ªad_c⁄fig_ªad_o˘ë_°rög_c⁄°
(c⁄° *
ªad‰om
,

100 
u_ch¨
 ** 
°r
,

101 
size_t
 * 
Àn
);

102 
NETSNMP_IMPORT


103 *
ªad_c⁄fig_ªad_objid
(*
ªad‰om
, 
oid
 ** 
objid
,

104 
size_t
 * 
Àn
);

105 c⁄° *
ªad_c⁄fig_ªad_objid_c⁄°
(c⁄° *
ªad‰om
,

106 
oid
 ** 
objid
,

107 
size_t
 * 
Àn
);

108 
NETSNMP_IMPORT


109 *
ªad_c⁄fig_ßve_objid
(*
ßvëo
, 
oid
 * 
objid
,

110 
size_t
 
Àn
);

111 
NETSNMP_IMPORT


112 *
ªad_c⁄fig_ªad_d©a
(
ty≥
, *
ªad‰om
,

113 *
d©≠å
, 
size_t
 * 
Àn
);

114 
NETSNMP_IMPORT


115 *
ªad_c⁄fig_ªad_mem‹y
(
ty≥
, *
ªad‰om
,

116 *
d©≠å
, 
size_t
 * 
Àn
);

117 
NETSNMP_IMPORT


118 *
ªad_c⁄fig_°‹e_d©a
(
ty≥
, *
°‹ëo
,

119 *
d©≠å
, 
size_t
 * 
Àn
);

120 *
ªad_c⁄fig_°‹e_d©a_¥efix
(
¥efix
, 
ty≥
,

121 *
°‹ëo
,

122 *
d©≠å
, 
size_t
 
Àn
);

123 
ªad_c⁄fig_fûes_of_ty≥
(
whí
, 
c⁄fig_fûes
 *
˘mp
);

124 
NETSNMP_IMPORT


125 
ªad_c⁄fig_°‹e
(c⁄° *
ty≥
, c⁄° *
löe
);

126 
NETSNMP_IMPORT


127 
ªad_≠p_c⁄fig_°‹e
(c⁄° *
löe
);

128 
NETSNMP_IMPORT


129 
¢mp_ßve_≥rsi°ít
(c⁄° *
ty≥
);

130 
NETSNMP_IMPORT


131 
¢mp_˛ón_≥rsi°ít
(c⁄° *
ty≥
);

132 
c⁄fig_löe
 *
ªad_c⁄fig_gë_h™dÀrs
(c⁄° *
ty≥
);

137 
¢mp_c⁄fig_ªmembî_ö_li°
(*
löe
,

138 
ªad_c⁄fig_mem‹y


139 **
mem
);

140 
¢mp_c⁄fig_¥o˚ss_mem‹y_li°
(

141 
ªad_c⁄fig_mem‹y


142 **
mem
, , );

143 
¢mp_c⁄fig_ªmembî_‰ì_li°
(

144 
ªad_c⁄fig_mem‹y


145 **
mem
);

147 
£t_c⁄figuøti⁄_dúe˘‹y
(c⁄° *
dú
);

148 
NETSNMP_IMPORT


149 c⁄° *
gë_c⁄figuøti⁄_dúe˘‹y
();

150 
£t_≥rsi°ít_dúe˘‹y
(c⁄° *
dú
);

151 c⁄° *
gë_≥rsi°ít_dúe˘‹y
();

152 
£t_ãmp_fûe_∑âîn
(c⁄° *
∑âîn
);

153 
NETSNMP_IMPORT


154 c⁄° *
gë_ãmp_fûe_∑âîn
();

155 
NETSNMP_IMPORT


156 
h™dÀ_l⁄g_›t
(c⁄° *
my›èrg
);

159 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/scapi.h

5 #i‚de‡
_SCAPI_H


6 
	#_SCAPI_H


	)

8 #ifde‡
__˝lu•lus


15 
	#SNMP_TRANS_AUTHLEN_HMACMD5
 128

	)

16 
	#SNMP_TRANS_AUTHLEN_HMACSHA1
 160

	)

18 
	#SNMP_TRANS_AUTHLEN_HMAC96
 96

	)

20 
	#SNMP_TRANS_PRIVLEN_1DES
 64

	)

21 
	#SNMP_TRANS_PRIVLEN_1DES_IV
 64

	)

23 
	#SNMP_TRANS_PRIVLEN_AES
 128

	)

24 
	#SNMP_TRANS_PRIVLEN_AES_IV
 128

	)

25 
	#SNMP_TRANS_AES_PADSIZE
 128

	)

26 
	#SNMP_TRANS_PRIVLEN_AES128
 128

	)

27 
	#SNMP_TRANS_PRIVLEN_AES128_IV
 128

	)

28 
	#SNMP_TRANS_AES_AES128_PADSIZE
 128

	)

33 
sc_gë_¥›îÀngth
(c⁄° 
oid
 * 
hashty≥
,

34 
u_öt
 
hashty≥_Àn
);

35 
sc_gë_¥›î_¥iv_Àngth
(c⁄° 
oid
 * 
¥ivty≥
,

36 
u_öt
 
¥ivty≥_Àn
);

38 
NETSNMP_IMPORT


39 
sc_öô
();

40 
sc_shutdown
(
maj‹ID
, 
mö‹ID
, *
£rvî¨g
,

41 *
˛õ¡¨g
);

43 
sc_øndom
(
u_ch¨
 * 
buf
, 
size_t
 * 
buÊí
);

45 
sc_gíî©e_keyed_hash
(c⁄° 
oid
 * 
authty≥
,

46 
size_t
 
authty≥Àn
,

47 c⁄° 
u_ch¨
 * 
key
, 
u_öt
 
keyÀn
,

48 c⁄° 
u_ch¨
 * 
mesßge
, 
u_öt
 
msgÀn
,

49 
u_ch¨
 * 
MAC
, 
size_t
 * 
ma˛í
);

51 
sc_check_keyed_hash
(c⁄° 
oid
 * 
authty≥
,

52 
size_t
 
authty≥Àn
, c⁄° 
u_ch¨
 * 
key
,

53 
u_öt
 
keyÀn
, c⁄° 
u_ch¨
 * 
mesßge
,

54 
u_öt
 
msgÀn
, c⁄° 
u_ch¨
 * 
MAC
,

55 
u_öt
 
ma˛í
);

57 
sc_í¸y±
(c⁄° 
oid
 * 
¥ivty≥
, 
size_t
 
¥ivty≥Àn
,

58 
u_ch¨
 * 
key
, 
u_öt
 
keyÀn
,

59 
u_ch¨
 * 
iv
, 
u_öt
 
ivÀn
,

60 c⁄° 
u_ch¨
 * 
∂aöãxt
, 
u_öt
 
±Àn
,

61 
u_ch¨
 * 
cùhîãxt
, 
size_t
 * 
˘Àn
);

63 
sc_de¸y±
(c⁄° 
oid
 * 
¥ivty≥
, 
size_t
 
¥ivty≥Àn
,

64 
u_ch¨
 * 
key
, 
u_öt
 
keyÀn
,

65 
u_ch¨
 * 
iv
, 
u_öt
 
ivÀn
,

66 
u_ch¨
 * 
cùhîãxt
, 
u_öt
 
˘Àn
,

67 
u_ch¨
 * 
∂aöãxt
, 
size_t
 * 
±Àn
);

69 
sc_hash
(c⁄° 
oid
 * 
hashty≥
, 
size_t
 
hashty≥Àn
,

70 c⁄° 
u_ch¨
 * 
buf
, 
size_t
 
buf_Àn
,

71 
u_ch¨
 * 
MAC
, 
size_t
 * 
MAC_Àn
);

73 
sc_gë_å™sf‹m_ty≥
(
oid
 * 
hashty≥
,

74 
u_öt
 
hashty≥_Àn
,

75 (**
hash_‚
Ë(c⁄° 
mode
,

76 **
c⁄ãxt
,

77 c⁄° 
u_ch¨
 *

78 
d©a
,

80 
d©a_Àn
,

81 
u_ch¨
 **

82 
dige°
,

83 
size_t
 *

84 
dige°_Àn
));

90 
	#_SCAPI_NOT_CONFIGURED
 \

92 
	`¢mp_log
(
LOG_ERR
, "Encryption supportÇotÉnabled.\n"); \

93 
	`DEBUGMSGTL
(("scapi", "SCAPIÇot configured")); \

94  
SNMPERR_SC_NOT_CONFIGURED
; \

95 }

	)

100 #ifde‡
NETSNMP_USE_INTERNAL_MD5


101 
	#INTERNAL_MD5
 1

	)

104 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp-tc.h

1 #i‚de‡
SNMP_TC_H


2 
	#SNMP_TC_H


	)

4 #ifde‡
__˝lu•lus


13 
√t¢mp_d©óndtime_£t_buf_‰om_v¨s
(
u_ch¨
 *
buf
, 
size_t
 *
bufsize
,

14 
u_sh‹t
 
y
, 
u_ch¨
 
m⁄
, u_ch¨ 
d
,

15 
u_ch¨
 
h
, u_ch¨ 
mö
, u_ch¨ 
s
,

16 
u_ch¨
 
deci_£c⁄ds
,

17 
utc_off£t_dúe˘i⁄
,

18 
u_ch¨
 
utc_off£t_hours
,

19 
u_ch¨
 
utc_off£t_möuãs
);

21 
NETSNMP_IMPORT


22 
u_ch¨
 *
d©e_n_time
(c⁄° 
time_t
 *, 
size_t
 *);

23 
time_t
 
˘ime_to_timë
(const *);

28 
	#TV_TRUE
 1

	)

29 
	#TV_FALSE
 2

	)

34 
	#RS_NONEXISTENT
 0

	)

35 
	#RS_ACTIVE
 1

	)

36 
	#RS_NOTINSERVICE
 2

	)

37 
	#RS_NOTREADY
 3

	)

38 
	#RS_CREATEANDGO
 4

	)

39 
	#RS_CREATEANDWAIT
 5

	)

40 
	#RS_DESTROY
 6

	)

42 
	#RS_IS_GOING_ACTIVE
–
x
 ) ( x =
RS_CREATEANDGO
 || x =
RS_ACTIVE
 )

	)

43 
	#RS_IS_ACTIVE
–
x
 ) ( x =
RS_ACTIVE
 )

	)

44 
	#RS_IS_NOT_ACTIVE
–
x
 ) ( ! 
	`RS_IS_GOING_ACTIVE
(xË)

	)

49 
	#ST_NONE
 0

	)

50 
	#ST_OTHER
 1

	)

51 
	#ST_VOLATILE
 2

	)

52 
	#ST_NONVOLATILE
 3

	)

53 
	#ST_PERMANENT
 4

	)

54 
	#ST_READONLY
 5

	)

56 
NETSNMP_IMPORT


57 
check_row°©us_å™sôi⁄
(
ﬁd_vÆ
, 
√w_vÆ
);

58 
NETSNMP_IMPORT


59 
check_row°©us_wôh_°‹agëy≥_å™sôi⁄
(
ﬁd_vÆ
, 
√w_vÆ
, 
ﬁd_°‹age
);

60 
NETSNMP_IMPORT


61 
check_°‹age_å™sôi⁄
(
ﬁd_vÆ
, 
√w_vÆ
);

63 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp.h

1 #i‚de‡
SNMP_H


2 
	#SNMP_H


	)

4 #ifde‡
__˝lu•lus


35 
	#SNMP_PORT
 161

	)

37 
	#SNMP_TRAP_PORT
 162

	)

41 
	#SNMP_MAX_LEN
 1500

	)

42 
	#SNMP_MIN_MAX_LEN
 484

	)

99 #i‚de‡
NETSNMP_DISABLE_SNMPV1


100 
	#SNMP_VERSION_1
 0

	)

102 #i‚de‡
NETSNMP_DISABLE_SNMPV2C


103 
	#SNMP_VERSION_2c
 1

	)

105 
	#SNMP_VERSION_2u
 2

	)

106 
	#SNMP_VERSION_3
 3

	)

111 
	#SNMP_VERSION_£c
 128

	)

112 
	#SNMP_VERSION_2p
 129

	)

113 
	#SNMP_VERSION_2°¨
 130

	)

118 
	#SNMP_MSG_GET
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x0Ë

	)

119 
	#SNMP_MSG_GETNEXT
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x1Ë

	)

120 
	#SNMP_MSG_RESPONSE
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x2Ë

	)

121 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


122 
	#SNMP_MSG_SET
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x3Ë

	)

128 
	#SNMP_MSG_TRAP
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x4Ë

	)

133 
	#SNMP_MSG_GETBULK
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x5Ë

	)

134 
	#SNMP_MSG_INFORM
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x6Ë

	)

135 
	#SNMP_MSG_TRAP2
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x7Ë

	)

140 
	#SNMP_MSG_REPORT
 (
ASN_CONTEXT
 | 
ASN_CONSTRUCTOR
 | 0x8Ë

	)

142 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


149 
	#SNMP_MSG_INTERNAL_SET_BEGIN
 -1

	)

150 
	#SNMP_MSG_INTERNAL_SET_RESERVE1
 0

	)

151 
	#SNMP_MSG_INTERNAL_SET_RESERVE2
 1

	)

152 
	#SNMP_MSG_INTERNAL_SET_ACTION
 2

	)

153 
	#SNMP_MSG_INTERNAL_SET_COMMIT
 3

	)

154 
	#SNMP_MSG_INTERNAL_SET_FREE
 4

	)

155 
	#SNMP_MSG_INTERNAL_SET_UNDO
 5

	)

156 
	#SNMP_MSG_INTERNAL_SET_MAX
 6

	)

158 
	#SNMP_MSG_INTERNAL_CHECK_VALUE
 17

	)

159 
	#SNMP_MSG_INTERNAL_ROW_CREATE
 18

	)

160 
	#SNMP_MSG_INTERNAL_UNDO_SETUP
 19

	)

161 
	#SNMP_MSG_INTERNAL_SET_VALUE
 20

	)

162 
	#SNMP_MSG_INTERNAL_CHECK_CONSISTENCY
 21

	)

163 
	#SNMP_MSG_INTERNAL_UNDO_SET
 22

	)

164 
	#SNMP_MSG_INTERNAL_COMMIT
 23

	)

165 
	#SNMP_MSG_INTERNAL_UNDO_COMMIT
 24

	)

166 
	#SNMP_MSG_INTERNAL_IRREVERSIBLE_COMMIT
 25

	)

167 
	#SNMP_MSG_INTERNAL_UNDO_CLEANUP
 26

	)

174 
	#SNMP_MSG_INTERNAL_PRE_REQUEST
 128

	)

175 
	#SNMP_MSG_INTERNAL_OBJECT_LOOKUP
 129

	)

176 
	#SNMP_MSG_INTERNAL_POST_REQUEST
 130

	)

177 
	#SNMP_MSG_INTERNAL_GET_STASH
 131

	)

182 #ifde‡
NETSNMP_NO_WRITE_SUPPORT


183 
	#SNMP_CMD_CONFIRMED
(
c
Ë(¯=
SNMP_MSG_INFORM
 || c =
SNMP_MSG_GETBULK
 ||\

184 
c
 =
SNMP_MSG_GETNEXT
 || c =
SNMP_MSG_GET
 )

	)

186 
	#SNMP_CMD_CONFIRMED
(
c
Ë(¯=
SNMP_MSG_INFORM
 || c =
SNMP_MSG_GETBULK
 ||\

187 
c
 =
SNMP_MSG_GETNEXT
 || c =
SNMP_MSG_GET
 || \

188 
c
 =
SNMP_MSG_SET
 )

	)

194 
	#SNMP_NOSUCHOBJECT
 (
ASN_CONTEXT
 | 
ASN_PRIMITIVE
 | 0x0Ë

	)

195 
	#SNMP_NOSUCHINSTANCE
 (
ASN_CONTEXT
 | 
ASN_PRIMITIVE
 | 0x1Ë

	)

196 
	#SNMP_ENDOFMIBVIEW
 (
ASN_CONTEXT
 | 
ASN_PRIMITIVE
 | 0x2Ë

	)

205 
	#SNMP_ERR_NOERROR
 (0Ë

	)

206 
	#SNMP_ERR_TOOBIG
 (1)

	)

207 
	#SNMP_ERR_NOSUCHNAME
 (2)

	)

208 
	#SNMP_ERR_BADVALUE
 (3)

	)

209 
	#SNMP_ERR_READONLY
 (4)

	)

210 
	#SNMP_ERR_GENERR
 (5)

	)

215 
	#SNMP_ERR_NOACCESS
 (6)

	)

216 
	#SNMP_ERR_WRONGTYPE
 (7)

	)

217 
	#SNMP_ERR_WRONGLENGTH
 (8)

	)

218 
	#SNMP_ERR_WRONGENCODING
 (9)

	)

219 
	#SNMP_ERR_WRONGVALUE
 (10)

	)

220 
	#SNMP_ERR_NOCREATION
 (11)

	)

221 
	#SNMP_ERR_INCONSISTENTVALUE
 (12)

	)

222 
	#SNMP_ERR_RESOURCEUNAVAILABLE
 (13)

	)

223 
	#SNMP_ERR_COMMITFAILED
 (14)

	)

224 
	#SNMP_ERR_UNDOFAILED
 (15)

	)

225 
	#SNMP_ERR_AUTHORIZATIONERROR
 (16)

	)

226 
	#SNMP_ERR_NOTWRITABLE
 (17)

	)

231 
	#SNMP_ERR_INCONSISTENTNAME
 (18)

	)

233 
	#MAX_SNMP_ERR
 18

	)

235 
	#SNMP_VALIDATE_ERR
(
x
Ë–(x > 
MAX_SNMP_ERR
) ? \

236 
SNMP_ERR_GENERR
 : \

237 (
x
 < 
SNMP_ERR_NOERROR
) ? \

238 
SNMP_ERR_GENERR
 : \

239 
x
 )

	)

244 
	#SNMP_TRAP_COLDSTART
 (0)

	)

245 
	#SNMP_TRAP_WARMSTART
 (1)

	)

246 
	#SNMP_TRAP_LINKDOWN
 (2)

	)

247 
	#SNMP_TRAP_LINKUP
 (3)

	)

248 
	#SNMP_TRAP_AUTHFAIL
 (4)

	)

249 
	#SNMP_TRAP_EGPNEIGHBORLOSS
 (5)

	)

250 
	#SNMP_TRAP_ENTERPRISESPECIFIC
 (6)

	)

255 
	#SNMP_ROW_NONEXISTENT
 0

	)

256 
	#SNMP_ROW_ACTIVE
 1

	)

257 
	#SNMP_ROW_NOTINSERVICE
 2

	)

258 
	#SNMP_ROW_NOTREADY
 3

	)

259 
	#SNMP_ROW_CREATEANDGO
 4

	)

260 
	#SNMP_ROW_CREATEANDWAIT
 5

	)

261 
	#SNMP_ROW_DESTROY
 6

	)

266 
	#SNMP_STORAGE_NONE
 0

	)

267 
	#SNMP_STORAGE_OTHER
 1

	)

268 
	#SNMP_STORAGE_VOLATILE
 2

	)

269 
	#SNMP_STORAGE_NONVOLATILE
 3

	)

270 
	#SNMP_STORAGE_PERMANENT
 4

	)

271 
	#SNMP_STORAGE_READONLY
 5

	)

276 
	#SNMP_MP_MODEL_SNMPv1
 0

	)

277 
	#SNMP_MP_MODEL_SNMPv2c
 1

	)

278 
	#SNMP_MP_MODEL_SNMPv2u
 2

	)

279 
	#SNMP_MP_MODEL_SNMPv3
 3

	)

280 
	#SNMP_MP_MODEL_SNMPv2p
 256

	)

285 
	#SNMP_SEC_MODEL_ANY
 0

	)

286 
	#SNMP_SEC_MODEL_SNMPv1
 1

	)

287 
	#SNMP_SEC_MODEL_SNMPv2c
 2

	)

288 
	#SNMP_SEC_MODEL_USM
 3

	)

289 
	#SNMP_SEC_MODEL_TSM
 4

	)

290 
	#SNMP_SEC_MODEL_SNMPv2p
 256

	)

292 
	#SNMP_SEC_LEVEL_NOAUTH
 1

	)

293 
	#SNMP_SEC_LEVEL_AUTHNOPRIV
 2

	)

294 
	#SNMP_SEC_LEVEL_AUTHPRIV
 3

	)

296 
	#SNMP_MSG_FLAG_AUTH_BIT
 0x01

	)

297 
	#SNMP_MSG_FLAG_PRIV_BIT
 0x02

	)

298 
	#SNMP_MSG_FLAG_RPRT_BIT
 0x04

	)

303 
	#UCD_MSG_FLAG_RESPONSE_PDU
 0x100

	)

304 
	#UCD_MSG_FLAG_EXPECT_RESPONSE
 0x200

	)

305 
	#UCD_MSG_FLAG_FORCE_PDU_COPY
 0x400

	)

306 
	#UCD_MSG_FLAG_ALWAYS_IN_VIEW
 0x800

	)

307 
	#UCD_MSG_FLAG_PDU_TIMEOUT
 0x1000

	)

308 
	#UCD_MSG_FLAG_ONE_PASS_ONLY
 0x2000

	)

309 
	#UCD_MSG_FLAG_TUNNELED
 0x4000

	)

314 
	#SNMP_VIEW_INCLUDED
 1

	)

315 
	#SNMP_VIEW_EXCLUDED
 2

	)

320 
	#SNMP_OID_INTERNET
 1, 3, 6, 1

	)

321 
	#SNMP_OID_ENTERPRISES
 
SNMP_OID_INTERNET
, 4, 1

	)

322 
	#SNMP_OID_MIB2
 
SNMP_OID_INTERNET
, 2, 1

	)

323 
	#SNMP_OID_SNMPV2
 
SNMP_OID_INTERNET
, 6

	)

324 
	#SNMP_OID_SNMPMODULES
 
SNMP_OID_SNMPV2
, 3

	)

329 
	#SNMPADMINLENGTH
 255

	)

332 
NETSNMP_IMPORT


333 *
u±ime_°rög
(
u_l⁄g
, *);

334 *
u±ime_°rög_n
(
u_l⁄g
, *, 
size_t
);

335 
NETSNMP_IMPORT


336 
xdump
(c⁄° *, 
size_t
, const *);

337 
NETSNMP_IMPORT


338 
u_ch¨
 *
¢mp_∑r£_v¨_›
(u_ch¨ *, 
oid
 *, 
size_t
 *, u_char *,

339 
size_t
 *, 
u_ch¨
 **, size_t *);

340 
NETSNMP_IMPORT


341 
u_ch¨
 *
¢mp_buûd_v¨_›
(u_ch¨ *, 
oid
 *, 
size_t
 *, u_char,

342 
size_t
, 
u_ch¨
 *, size_t *);

345 #ifde‡
NETSNMP_USE_REVERSE_ASNENCODING


346 
¢mp_ªÆloc_rbuûd_v¨_›
(
u_ch¨
 ** 
pkt
,

347 
size_t
 * 
pkt_Àn
,

348 
size_t
 * 
off£t
,

349 
Ælow_ªÆloc
,

350 c⁄° 
oid
 * 
«me
,

351 
size_t
 * 
«me_Àn
,

352 
u_ch¨
 
vÆue_ty≥
,

353 
u_ch¨
 * 
vÆue
,

354 
size_t
 
vÆue_Àngth
);

357 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpCallbackDomain.h

1 #i‚de‡
_SNMPCALLBACKDOMAIN_H


2 
	#_SNMPCALLBACKDOMAIN_H


	)

4 #i‚de‡
NET_SNMP_CONFIG_H


8 #ifde‡
__˝lu•lus


12 #ifde‡
NETSNMP_TRANSPORT_CALLBACK_DOMAIN


14 
	~<√t-¢mp/ty≥s.h
>

15 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

17 
	s√t¢mp_ˇŒback_∑ss_s
 {

18 
ªtu∫_å™•‹t_num
;

19 
√t¢mp_pdu
 *
pdu
;

20 
√t¢mp_ˇŒback_∑ss_s
 *
√xt
;

21 } 
	t√t¢mp_ˇŒback_∑ss
;

23 
	s√t¢mp_ˇŒback_öfo_s
 {

24 
	mlökedto
;

25 *
	m∑ª¡_d©a
;

26 
√t¢mp_ˇŒback_∑ss
 *
	md©a
;

27 
	mˇŒback_num
;

28 
	mpùefds
[2];

29 } 
	t√t¢mp_ˇŒback_öfo
;

31 
√t¢mp_å™•‹t
 *
√t¢mp_ˇŒback_å™•‹t
();

32 
√t¢mp_ˇŒback_hook_∑r£
(
√t¢mp_£ssi⁄
 * 
•
,

33 
√t¢mp_pdu
 *
pdu
,

34 
u_ch¨
 * 
∑ckë±r
,

35 
size_t
 
Àn
);

36 
√t¢mp_ˇŒback_hook_buûd
(
√t¢mp_£ssi⁄
 * 
•
,

37 
√t¢mp_pdu
 *
pdu
,

38 
u_ch¨
 * 
±k
, 
size_t
 * 
Àn
);

39 
√t¢mp_ˇŒback_check_∑ckë
(
u_ch¨
 * 
pkt
, 
size_t
 
Àn
);

40 
√t¢mp_pdu
 *
√t¢mp_ˇŒback_¸óã_pdu
(
√t¢mp_å™•‹t
 *
å™•‹t
,

41 *
›aque
, 
size_t
 
ﬁígth
);

42 
NETSNMP_IMPORT


43 
√t¢mp_£ssi⁄
 *
√t¢mp_ˇŒback_›í
(
©èch_to
,

44 (*
ªtu∫_func
Ë(
›
,

45 
√t¢mp_£ssi⁄


46 * 
£ssi⁄
,

47 
ªqid
,

48 
√t¢mp_pdu


49 *
pdu
,

50 *
magic
),

51 (*
Âª_∑r£
Ë(
√t¢mp_£ssi⁄


54 
√t¢mp_å™•‹t_s


56 (*
Âo°_∑r£
Ë(
√t¢mp_£ssi⁄


58 
√t¢mp_pdu
 *,

60 
NETSNMP_IMPORT


61 
	`√t¢mp_˛ór_ˇŒback_li°
();

65 
	#√t¢mp_˛ór_ˇŒback_li°
()

	)

70 #ifde‡
__˝lu•lus


71 
	}
}

	@/usr/include/net-snmp/library/snmpTCPDomain.h

1 #i‚de‡
_SNMPTCPDOMAIN_H


2 
	#_SNMPTCPDOMAIN_H


	)

4 #i‡
HAVE_NETINET_IN_H


5 
	~<√töë/ö.h
>

8 
	$c⁄fig_ªquúe
(
IPv4Ba£
)

9 
	$c⁄fig_ªquúe
(
SockëBa£
)

10 
	$c⁄fig_ªquúe
(
TCPBa£
)

12 #ifde‡
NETSNMP_TRANSPORT_TCP_DOMAIN


14 
	~<√t-¢mp/libøry/¢mpIPv4Ba£Domaö.h
>

16 #ifde‡
__˝lu•lus


25 
	#TRANSPORT_DOMAIN_TCP_IP
 1,3,6,1,2,1,100,1,5

	)

26 
NETSNMP_IMPORT
 
oid
 
√t¢mp_¢mpTCPDomaö
[];

28 
√t¢mp_å™•‹t
 *
	`√t¢mp_t˝_å™•‹t
(
sockaddr_ö
 *
addr
, 
loˇl
);

34 
	`√t¢mp_t˝_˘‹
();

36 #ifde‡
__˝lu•lus


37 
	}
}

	@/usr/include/net-snmp/library/snmpTCPIPv6Domain.h

1 #i‚de‡
_SNMPTCPIPV6DOMAIN_H


2 
	#_SNMPTCPIPV6DOMAIN_H


	)

4 #i‡
HAVE_NETINET_IN_H


5 
	~<√töë/ö.h
>

8 
	$c⁄fig_ªquúe
(
IPv6Ba£
)

9 
	$c⁄fig_ªquúe
(
SockëBa£
)

10 
	$c⁄fig_ªquúe
(
TCPBa£
)

12 
	~<√t-¢mp/libøry/¢mpIPv6Ba£Domaö.h
>

14 #ifde‡
__˝lu•lus


23 
	#TRANSPORT_DOMAIN_TCP_IPV6
 1,3,6,1,2,1,100,1,6

	)

24 
NETSNMP_IMPORT
 
oid
 
√t¢mp_TCPIPv6Domaö
[];

26 
√t¢mp_å™•‹t
 *
	`√t¢mp_t˝6_å™•‹t
(
sockaddr_ö6
 *
addr
,

27 
loˇl
);

33 
NETSNMP_IMPORT
 
	`√t¢mp_t˝ùv6_˘‹
();

35 #ifde‡
__˝lu•lus


36 
	}
}

	@/usr/include/net-snmp/library/snmpUDPDomain.h

1 #i‚de‡
_SNMPUDPDOMAIN_H


2 
	#_SNMPUDPDOMAIN_H


	)

4 #ifde‡
__˝lu•lus


8 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

9 
	~<√t-¢mp/libøry/a¢1.h
>

11 #i‡
HAVE_SYS_SOCKET_H


12 
	~<sys/sockë.h
>

14 #i‡
HAVE_NETINET_IN_H


15 
	~<√töë/ö.h
>

18 
c⁄fig_ªquúe
(
UDPIPv4Ba£
)

19 
	~<√t-¢mp/libøry/¢mpUDPIPv4Ba£Domaö.h
>

21 
√t¢mp_å™•‹t
 *
√t¢mp_udp_å™•‹t
(
sockaddr_ö
 *
addr
, 
loˇl
);

28 
NETSNMP_IMPORT


29 
√t¢mp_udp_agít_c⁄fig_tokís_ªgi°î
();

31 
NETSNMP_IMPORT


32 
√t¢mp_udp_∑r£_£curôy
(c⁄° *
tokí
, *
∑øm
);

34 
NETSNMP_IMPORT


35 
√t¢mp_udp_gëSecName
(*
›aque
, 
ﬁígth
,

36 c⁄° *
communôy
,

37 
size_t
 
communôy_Àn
,

38 c⁄° **
£˙ame
,

39 c⁄° **
c⁄ãxtName
);

45 
√t¢mp_udp_˘‹
();

50 *
√t¢mp_udp_fmèddr
(
√t¢mp_å™•‹t
 *
t
, *
d©a
, 
Àn
);

51 #i‡
deföed
(
löux
Ë&& deföed(
IP_PKTINFO
) || \

52 
deföed
(
IP_RECVDSTADDR
Ë&& !deföed(
_MSC_VER
)

53 
√t¢mp_udp_ªcv‰om
(
s
, *
buf
, 
Àn
, 
sockaddr
 *
‰om
,

54 
sockÀn_t
 *
‰omÀn
, 
sockaddr
 *
d°ù
,

55 
sockÀn_t
 *
d°Àn
, *
if_ödex
);

56 
√t¢mp_udp_£ndto
(
fd
, 
ö_addr
 *
§cù
, 
if_ödex
,

57 
sockaddr
 *
ªmŸe
, *
d©a
, 
Àn
);

60 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpUDPIPv6Domain.h

1 #i‚de‡
_SNMPUDPIPV6DOMAIN_H


2 
	#_SNMPUDPIPV6DOMAIN_H


	)

4 
	~<√t-¢mp/ty≥s.h
>

6 #ifde‡
__˝lu•lus


10 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

12 
c⁄fig_ªquúe
(
IPv6Ba£
)

13 
c⁄fig_ªquúe
(
UDPBa£
)

15 
	~<√t-¢mp/libøry/¢mpIPv6Ba£Domaö.h
>

22 
	#TRANSPORT_DOMAIN_UDP_IPV6
 1,3,6,1,2,1,100,1,2

	)

23 
NETSNMP_IMPORT
 
oid
 
√t¢mp_UDPIPv6Domaö
[];

25 
√t¢mp_å™•‹t
 *
√t¢mp_udp6_å™•‹t
(
sockaddr_ö6
 *
addr
,

26 
loˇl
);

35 
√t¢mp_sockaddr_ö6
(
sockaddr_ö6
 *
addr
,

36 c⁄° *
≥î«me
,

37 
ªmŸe_p‹t
);

39 
NETSNMP_IMPORT


40 
√t¢mp_udp6_agít_c⁄fig_tokís_ªgi°î
();

41 
NETSNMP_IMPORT


42 
√t¢mp_udp6_∑r£_£curôy
(c⁄° *
tokí
,

43 *
∑øm
);

45 
NETSNMP_IMPORT


46 
√t¢mp_udp6_gëSecName
(*
›aque
, 
ﬁígth
,

47 c⁄° *
communôy
,

48 
communôy_Àn
,

49 c⁄° **
£˙ame
,

50 c⁄° **
c⁄ãxtName
);

56 
NETSNMP_IMPORT
 
√t¢mp_udpùv6_˘‹
();

58 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpUnixDomain.h

1 #i‚de‡
_SNMPUNIXDOMAIN_H


2 
	#_SNMPUNIXDOMAIN_H


	)

4 #ifde‡
NETSNMP_TRANSPORT_UNIX_DOMAIN


6 #i‡
deföed
(
cygwö
Ë|| deföed(
mögw32
Ë|| deföed(
mögw32msvc
)

7 
	$c⁄fig_îr‹
(
Unix
 
domaö
 
¥Ÿocﬁ
 
suµ‹t
 
u«vaûabÀ
 
this
 
∂©f‹m
)

10 #i‡
HAVE_SYS_SOCKET_H


11 
	~<sys/sockë.h
>

13 #i‡
HAVE_SYS_UN_H


14 
	~<sys/un.h
>

17 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

19 
	$c⁄fig_ªquúe
(
SockëBa£
)

21 #ifde‡
__˝lu•lus


30 
	#TRANSPORT_DOMAIN_LOCAL
 1,3,6,1,2,1,100,1,13

	)

31 
NETSNMP_IMPORT
 
oid
 
√t¢mp_UnixDomaö
[];

33 
√t¢mp_å™•‹t
 *
	`√t¢mp_unix_å™•‹t
(
sockaddr_un
 *
addr
,

34 
loˇl
);

35 
	`√t¢mp_unix_agít_c⁄fig_tokís_ªgi°î
();

36 
	`√t¢mp_unix_∑r£_£curôy
(c⁄° *
tokí
, *
∑øm
);

37 
	`√t¢mp_unix_gëSecName
(*
›aque
, 
ﬁígth
,

38 c⁄° *
communôy
,

39 
size_t
 
communôy_Àn
, c⁄° **
£cName
,

40 c⁄° **
c⁄ãxtName
);

47 
	`√t¢mp_unix_˘‹
();

52 
	`√t¢mp_unix_¸óã_∑th_wôh_mode
(
mode
);

53 
	`√t¢mp_unix_d⁄t_¸óã_∑th
();

55 #ifde‡
__˝lu•lus


56 
	}
}

60 
	#√t¢mp_unix_¸óã_∑th_wôh_mode
(
x
)

	)

61 
	#√t¢mp_unix_d⁄t_¸óã_∑th
()

	)

	@/usr/include/net-snmp/library/snmp_alarm.h

1 #i‚de‡
SNMP_ALARM_H


2 
	#SNMP_ALARM_H


	)

4 #ifde‡
__˝lu•lus


8 (
SNMPAœrmCÆlback
Ë(
	t˛õ¡ªg
,

9 *
	t˛õ¡¨g
);

14 
	#SA_REPEAT
 0x01

	)

15 
	#SA_FIRED
 0x10

	)

17 
	s¢mp_Æ¨m
 {

19 
timevÆ
 
t
;

20 
Êags
;

21 
˛õ¡ªg
;

23 
timevÆ
 
t_œ°M
;

25 
timevÆ
 
t_√xtM
;

26 *
˛õ¡¨g
;

27 
SNMPAœrmCÆlback
 *
theˇŒback
;

28 
¢mp_Æ¨m
 *
√xt
;

34 
NETSNMP_IMPORT


35 
¢mp_Æ¨m_uƒegi°î
(
˛õ¡ªg
);

36 
¢mp_Æ¨m_uƒegi°î_Æl
();

37 
NETSNMP_IMPORT


38 
¢mp_Æ¨m_ªgi°î
(
whí
,

39 
Êags
,

40 
SNMPAœrmCÆlback
 * 
theˇŒback
,

41 *
˛õ¡¨g
);

43 
¢mp_Æ¨m_ªgi°î_hr
(
timevÆ
 
t
,

44 
Êags
,

45 
SNMPAœrmCÆlback
 * 
cb
,

46 *
cd
);

47 
NETSNMP_IMPORT


48 
¢mp_Æ¨m_ª£t
(
˛õ¡ªg
);

54 
NETSNMP_IMPORT
 
öô_¢mp_Æ¨m
();

55 
öô_Æ¨m_po°_c⁄fig
(
maj‹id
, 
mö‹id
,

56 *
£rvî¨g
,

57 *
˛õ¡¨g
);

58 
ß_upd©e_íåy
(
¢mp_Æ¨m
 *
Ærm
);

59 
¢mp_Æ¨m
 *
ß_föd_√xt
();

60 
NETSNMP_IMPORT
 
run_Æ¨ms
();

61 
RETSIGTYPE
 
Æ¨m_h™dÀr
(
a
);

62 
£t_™_Æ¨m
();

63 
√t¢mp_gë_√xt_Æ¨m_time
(
timevÆ
 *
Æ¨m_tm
,

64 c⁄° 
timevÆ
 *
now
);

65 
gë_√xt_Æ¨m_dñay_time
(
timevÆ
 *
dñè
);

68 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_api.h

11 #i‚de‡
SNMP_API_H


12 
	#SNMP_API_H


	)

27 
	~<√t-¢mp/ty≥s.h
>

28 
	~<√t-¢mp/v¨böd_≠i.h
>

29 
	~<√t-¢mp/ouçut_≠i.h
>

30 
	~<√t-¢mp/pdu_≠i.h
>

31 
	~<√t-¢mp/£ssi⁄_≠i.h
>

33 
	~<√t-¢mp/√t-¢mp-„©uªs.h
>

35 #i‚de‡
DONT_SHARE_ERROR_WITH_OTHER_THREADS


36 
	#SET_SNMP_ERROR
(
x
Ë
¢mp_î∫o
=(x)

	)

38 
	#SET_SNMP_ERROR
(
x
)

	)

42 #ifde‡
__˝lu•lus


68 
timevÆ
;

72 #ifde‡
SNMP_NEED_REQUEST_LIST


73 
	sªque°_li°
 {

74 
ªque°_li°
 *
√xt_ªque°
;

75 
ªque°_id
;

76 
mesßge_id
;

77 
√t¢mp_ˇŒback
 
ˇŒback
;

78 *
cb_d©a
;

79 
ªåõs
;

80 
u_l⁄g
 
timeout
;

81 
timevÆ
 
timeM
;

82 
timevÆ
 
expúeM
;

83 
¢mp_£ssi⁄
 *
£ssi⁄
;

84 
√t¢mp_pdu
 *
pdu
;

86 } 
	t√t¢mp_ªque°_li°
;

92 
	#SNMP_DEFAULT_COMMUNITY_LEN
 0

	)

93 
	#SNMP_DEFAULT_RETRIES
 -1

	)

94 
	#SNMP_DEFAULT_TIMEOUT
 -1

	)

95 
	#SNMP_DEFAULT_REMPORT
 0

	)

96 
	#SNMP_DEFAULT_REQID
 -1

	)

97 
	#SNMP_DEFAULT_MSGID
 -1

	)

98 
	#SNMP_DEFAULT_ERRSTAT
 -1

	)

99 
	#SNMP_DEFAULT_ERRINDEX
 -1

	)

100 
	#SNMP_DEFAULT_ADDRESS
 0

	)

101 
	#SNMP_DEFAULT_PEERNAME
 
NULL


	)

102 
	#SNMP_DEFAULT_ENTERPRISE_LENGTH
 0

	)

103 
	#SNMP_DEFAULT_TIME
 0

	)

104 
	#SNMP_DEFAULT_VERSION
 -1

	)

105 
	#SNMP_DEFAULT_SECMODEL
 -1

	)

106 
	#SNMP_DEFAULT_CONTEXT
 ""

	)

107 #i‚de‡
NETSNMP_DISABLE_MD5


108 
	#SNMP_DEFAULT_AUTH_PROTO
 
usmHMACMD5AuthPrŸocﬁ


	)

110 
	#SNMP_DEFAULT_AUTH_PROTO
 
usmHMACSHA1AuthPrŸocﬁ


	)

112 
	#SNMP_DEFAULT_AUTH_PROTOLEN
 
USM_LENGTH_OID_TRANSFORM


	)

113 #i‚de‡
NETSNMP_DISABLE_DES


114 
	#SNMP_DEFAULT_PRIV_PROTO
 
usmDESPrivPrŸocﬁ


	)

116 
	#SNMP_DEFAULT_PRIV_PROTO
 
usmAESPrivPrŸocﬁ


	)

118 
	#SNMP_DEFAULT_PRIV_PROTOLEN
 
USM_LENGTH_OID_TRANSFORM


	)

120 
NETSNMP_IMPORT
 
¢mp_£t_dëaû
(const *);

122 
	#SNMP_MAX_MSG_SIZE
 1472

	)

123 
	#SNMP_MAX_MSG_V3_HDRS
 (4+3+4+7+7+3+7+16Ë

	)

124 
	#SNMP_MAX_ENG_SIZE
 32

	)

125 
	#SNMP_MAX_SEC_NAME_SIZE
 256

	)

126 
	#SNMP_MAX_CONTEXT_SIZE
 256

	)

127 
	#SNMP_SEC_PARAM_BUF_SIZE
 256

	)

132 
	#SNMPV3_IGNORE_UNAUTH_REPORTS
 0

	)

137 
	#SNMP_SESS_NONAUTHORITATIVE
 0

	)

138 
	#SNMP_SESS_AUTHORITATIVE
 1

	)

139 
	#SNMP_SESS_UNKNOWNAUTH
 2

	)

144 
	#REPORT_STATS_LEN
 9

	)

145 
	#REPORT_STATS_LEN2
 8

	)

147 
	#REPORT_¢mpUnknownSecurôyModñs_NUM
 1

	)

148 
	#REPORT_¢mpInvÆidMsgs_NUM
 2

	)

149 
	#REPORT_¢mpUnknownPDUH™dÀrs_NUM
 3

	)

151 
	#REPORT_usmSètsUnsuµ‹ãdSecLevñs_NUM
 1

	)

152 
	#REPORT_usmSètsNŸInTimeWödows_NUM
 2

	)

153 
	#REPORT_usmSètsUnknownU£rNames_NUM
 3

	)

154 
	#REPORT_usmSètsUnknownEngöeIDs_NUM
 4

	)

155 
	#REPORT_usmSètsWr⁄gDige°s_NUM
 5

	)

156 
	#REPORT_usmSètsDe¸y±i⁄Eº‹s_NUM
 6

	)

158 
	#REPORT_¢mpU«vaûabÀC⁄ãxts_NUM
 4

	)

159 
	#REPORT_¢mpUnknownC⁄ãxts_NUM
 5

	)

161 
	#SNMP_DETAIL_SIZE
 512

	)

163 
	#SNMP_FLAGS_UDP_BROADCAST
 0x800

	)

164 
	#SNMP_FLAGS_RESP_CALLBACK
 0x400

	)

165 
	#SNMP_FLAGS_USER_CREATED
 0x200

	)

166 
	#SNMP_FLAGS_DONT_PROBE
 0x100

	)

167 
	#SNMP_FLAGS_STREAM_SOCKET
 0x80

	)

168 
	#SNMP_FLAGS_LISTENING
 0x40

	)

169 
	#SNMP_FLAGS_SUBSESSION
 0x20

	)

170 
	#SNMP_FLAGS_STRIKE2
 0x02

	)

171 
	#SNMP_FLAGS_STRIKE1
 0x01

	)

173 
	#CLEAR_SNMP_STRIKE_FLAGS
(
x
) \

174 
x
 &~(
SNMP_FLAGS_STRIKE2
|
SNMP_FLAGS_STRIKE1
)

	)

180 
	#SET_SNMP_STRIKE_FLAGS
(
x
) \

181 (–
x
 & 
SNMP_FLAGS_STRIKE2
 ) ? 1 : \

182 ((–
x
 & 
SNMP_FLAGS_STRIKE1
 ) ? ( x |
SNMP_FLAGS_STRIKE2
 ) : \

183 –
x
 |
SNMP_FLAGS_STRIKE1
 )), \

184 0))

	)

194 
	#SNMPERR_SUCCESS
 (0Ë

	)

195 
	#SNMPERR_GENERR
 (-1)

	)

196 
	#SNMPERR_BAD_LOCPORT
 (-2)

	)

197 
	#SNMPERR_BAD_ADDRESS
 (-3)

	)

198 
	#SNMPERR_BAD_SESSION
 (-4)

	)

199 
	#SNMPERR_TOO_LONG
 (-5)

	)

200 
	#SNMPERR_NO_SOCKET
 (-6)

	)

201 
	#SNMPERR_V2_IN_V1
 (-7)

	)

202 
	#SNMPERR_V1_IN_V2
 (-8)

	)

203 
	#SNMPERR_BAD_REPEATERS
 (-9)

	)

204 
	#SNMPERR_BAD_REPETITIONS
 (-10)

	)

205 
	#SNMPERR_BAD_ASN1_BUILD
 (-11)

	)

206 
	#SNMPERR_BAD_SENDTO
 (-12)

	)

207 
	#SNMPERR_BAD_PARSE
 (-13)

	)

208 
	#SNMPERR_BAD_VERSION
 (-14)

	)

209 
	#SNMPERR_BAD_SRC_PARTY
 (-15)

	)

210 
	#SNMPERR_BAD_DST_PARTY
 (-16)

	)

211 
	#SNMPERR_BAD_CONTEXT
 (-17)

	)

212 
	#SNMPERR_BAD_COMMUNITY
 (-18)

	)

213 
	#SNMPERR_NOAUTH_DESPRIV
 (-19)

	)

214 
	#SNMPERR_BAD_ACL
 (-20)

	)

215 
	#SNMPERR_BAD_PARTY
 (-21)

	)

216 
	#SNMPERR_ABORT
 (-22)

	)

217 
	#SNMPERR_UNKNOWN_PDU
 (-23)

	)

218 
	#SNMPERR_TIMEOUT
 (-24)

	)

219 
	#SNMPERR_BAD_RECVFROM
 (-25)

	)

220 
	#SNMPERR_BAD_ENG_ID
 (-26)

	)

221 
	#SNMPERR_BAD_SEC_NAME
 (-27)

	)

222 
	#SNMPERR_BAD_SEC_LEVEL
 (-28)

	)

223 
	#SNMPERR_ASN_PARSE_ERR
 (-29)

	)

224 
	#SNMPERR_UNKNOWN_SEC_MODEL
 (-30)

	)

225 
	#SNMPERR_INVALID_MSG
 (-31)

	)

226 
	#SNMPERR_UNKNOWN_ENG_ID
 (-32)

	)

227 
	#SNMPERR_UNKNOWN_USER_NAME
 (-33)

	)

228 
	#SNMPERR_UNSUPPORTED_SEC_LEVEL
 (-34)

	)

229 
	#SNMPERR_AUTHENTICATION_FAILURE
 (-35)

	)

230 
	#SNMPERR_NOT_IN_TIME_WINDOW
 (-36)

	)

231 
	#SNMPERR_DECRYPTION_ERR
 (-37)

	)

232 
	#SNMPERR_SC_GENERAL_FAILURE
 (-38)

	)

233 
	#SNMPERR_SC_NOT_CONFIGURED
 (-39)

	)

234 
	#SNMPERR_KT_NOT_AVAILABLE
 (-40)

	)

235 
	#SNMPERR_UNKNOWN_REPORT
 (-41)

	)

236 
	#SNMPERR_USM_GENERICERROR
 (-42)

	)

237 
	#SNMPERR_USM_UNKNOWNSECURITYNAME
 (-43)

	)

238 
	#SNMPERR_USM_UNSUPPORTEDSECURITYLEVEL
 (-44)

	)

239 
	#SNMPERR_USM_ENCRYPTIONERROR
 (-45)

	)

240 
	#SNMPERR_USM_AUTHENTICATIONFAILURE
 (-46)

	)

241 
	#SNMPERR_USM_PARSEERROR
 (-47)

	)

242 
	#SNMPERR_USM_UNKNOWNENGINEID
 (-48)

	)

243 
	#SNMPERR_USM_NOTINTIMEWINDOW
 (-49)

	)

244 
	#SNMPERR_USM_DECRYPTIONERROR
 (-50)

	)

245 
	#SNMPERR_NOMIB
 (-51)

	)

246 
	#SNMPERR_RANGE
 (-52)

	)

247 
	#SNMPERR_MAX_SUBID
 (-53)

	)

248 
	#SNMPERR_BAD_SUBID
 (-54)

	)

249 
	#SNMPERR_LONG_OID
 (-55)

	)

250 
	#SNMPERR_BAD_NAME
 (-56)

	)

251 
	#SNMPERR_VALUE
 (-57)

	)

252 
	#SNMPERR_UNKNOWN_OBJID
 (-58)

	)

253 
	#SNMPERR_NULL_PDU
 (-59)

	)

254 
	#SNMPERR_NO_VARS
 (-60)

	)

255 
	#SNMPERR_VAR_TYPE
 (-61)

	)

256 
	#SNMPERR_MALLOC
 (-62)

	)

257 
	#SNMPERR_KRB5
 (-63)

	)

258 
	#SNMPERR_PROTOCOL
 (-64)

	)

259 
	#SNMPERR_OID_NONINCREASING
 (-65)

	)

260 
	#SNMPERR_JUST_A_CONTEXT_PROBE
 (-66)

	)

261 
	#SNMPERR_TRANSPORT_NO_CONFIG
 (-67)

	)

262 
	#SNMPERR_TRANSPORT_CONFIG_ERROR
 (-68)

	)

263 
	#SNMPERR_TLS_NO_CERTIFICATE
 (-69)

	)

265 
	#SNMPERR_MAX
 (-69)

	)

278 
NETSNMP_IMPORT
 *
√t¢mp_mÆloc
(
size_t
 
size
);

279 
NETSNMP_IMPORT
 *
√t¢mp_ˇŒoc
(
size_t
 
√Àm
, size_à
ñsize
);

280 
NETSNMP_IMPORT
 *
√t¢mp_ªÆloc
(*
±r
, 
size_t
 
size
);

281 
NETSNMP_IMPORT
 
√t¢mp_‰ì
(*
±r
);

282 
NETSNMP_IMPORT
 *
√t¢mp_°rdup
(c⁄° *
s1
);

292 
NETSNMP_IMPORT
 
¢mp_‰ì_v¨_öã∫Æs
(
√t¢mp_v¨übÀ_li°
 *);

326 
	#NETSNMP_CALLBACK_OP_RECEIVED_MESSAGE
 1

	)

327 
	#NETSNMP_CALLBACK_OP_TIMED_OUT
 2

	)

328 
	#NETSNMP_CALLBACK_OP_SEND_FAILED
 3

	)

329 
	#NETSNMP_CALLBACK_OP_CONNECT
 4

	)

330 
	#NETSNMP_CALLBACK_OP_DISCONNECT
 5

	)

332 
¢mp_gë_√xt_msgid
();

333 
¢mp_gë_√xt_ªqid
();

334 
NETSNMP_IMPORT


335 
¢mp_gë_√xt_£ssid
();

336 
NETSNMP_IMPORT


337 
¢mp_gë_√xt_å™sid
();

339 
NETSNMP_IMPORT


340 
¢mp_oid_com∑ª
(c⁄° 
oid
 *, 
size_t
, const oid *,

341 
size_t
);

342 
¢mp_oid_ncom∑ª
(c⁄° 
oid
 *, 
size_t
, const oid *,

343 
size_t
, size_t);

344 
NETSNMP_IMPORT


345 
¢mp_oidåì_com∑ª
(c⁄° 
oid
 *, 
size_t
, const oid *,

346 
size_t
);

347 
NETSNMP_IMPORT


348 
¢mp_oidsubåì_com∑ª
(c⁄° 
oid
 *, 
size_t
, const oid *,

349 
size_t
);

350 
NETSNMP_IMPORT


351 
√t¢mp_oid_com∑ª_Œ
(c⁄° 
oid
 * 
ö_«me1
,

352 
size_t
 
Àn1
, c⁄° 
oid
 * 
ö_«me2
,

353 
size_t
 
Àn2
, size_à*
ofÂt
);

354 
NETSNMP_IMPORT


355 
√t¢mp_oid_equÆs
(c⁄° 
oid
 *, 
size_t
, const oid *,

356 
size_t
);

357 
√t¢mp_oid_åì_equÆs
(c⁄° 
oid
 *, 
size_t
, const oid *,

358 
size_t
);

359 
NETSNMP_IMPORT


360 
√t¢mp_oid_is_subåì
(c⁄° 
oid
 *, 
size_t
, const oid *,

361 
size_t
);

362 
NETSNMP_IMPORT


363 
√t¢mp_oid_föd_¥efix
(c⁄° 
oid
 * 
ö_«me1
, 
size_t
 
Àn1
,

364 c⁄° 
oid
 * 
ö_«me2
, 
size_t
 
Àn2
);

365 
NETSNMP_IMPORT


366 
öô_¢mp
(const *);

367 
u_ch¨
 *
¢mp_pdu_buûd
(
√t¢mp_pdu
 *, u_ch¨ *, 
size_t
 *);

368 #ifde‡
NETSNMP_USE_REVERSE_ASNENCODING


369 
u_ch¨
 *
¢mp_pdu_rbuûd
(
√t¢mp_pdu
 *, u_ch¨ *, 
size_t
 *);

371 
¢mpv3_∑r£
(
√t¢mp_pdu
 *, 
u_ch¨
 *, 
size_t
 *,

372 
u_ch¨
 **, 
√t¢mp_£ssi⁄
 *);

373 
¢mpv3_∑ckë_buûd
(
√t¢mp_£ssi⁄
 *,

374 
√t¢mp_pdu
 *
pdu
, 
u_ch¨
 * 
∑ckë
,

375 
size_t
 * 
out_Àngth
,

376 
u_ch¨
 * 
pdu_d©a
,

377 
size_t
 
pdu_d©a_Àn
);

378 
¢mpv3_∑ckë_rbuûd
(
√t¢mp_£ssi⁄
 *,

379 
√t¢mp_pdu
 *
pdu
, 
u_ch¨
 * 
∑ckë
,

380 
size_t
 * 
out_Àngth
,

381 
u_ch¨
 * 
pdu_d©a
,

382 
size_t
 
pdu_d©a_Àn
);

383 
¢mpv3_make_ªp‹t
(
√t¢mp_pdu
 *
pdu
, 
îr‹
);

384 
¢mpv3_gë_ªp‹t_ty≥
(
√t¢mp_pdu
 *
pdu
);

385 
¢mp_pdu_∑r£
(
√t¢mp_pdu
 *
pdu
, 
u_ch¨
 * 
d©a
,

386 
size_t
 * 
Àngth
);

387 
u_ch¨
 *
¢mpv3_sc›edPDU_∑r£
(
√t¢mp_pdu
 *
pdu
, u_ch¨ * 
˝
,

388 
size_t
 * 
Àngth
);

389 
NETSNMP_IMPORT


390 
¢mp_°‹e_√eded
(c⁄° *
ty≥
);

391 
NETSNMP_IMPORT


392 
¢mp_°‹e_if_√eded
();

393 
NETSNMP_IMPORT


394 
¢mp_°‹e
(c⁄° *
ty≥
);

395 
NETSNMP_IMPORT


396 
¢mp_shutdown
(c⁄° *
ty≥
);

397 
NETSNMP_IMPORT


398 
¢mp_add_v¨
(
√t¢mp_pdu
 *, c⁄° 
oid
 *, 
size_t
, ,

400 
NETSNMP_IMPORT


401 
oid
 *
¢mp_du∂iˇã_objid
(c⁄° oid * 
objToC›y
, 
size_t
);

402 
	gNETSNMP_IMPORT


404 #i‚de‡
NETSNMP_FEATURE_REMOVE_STATISTICS


405 
u_öt
 
¢mp_ö¸emít_°©i°ic
(
which
);

406 
NETSNMP_IMPORT


407 
u_öt
 
¢mp_ö¸emít_°©i°ic_by
(
which
, 
cou¡
);

408 
NETSNMP_IMPORT


409 
u_öt
 
¢mp_gë_°©i°ic
(
which
);

410 
¢mp_öô_°©i°ics
();

414 
	#¢mp_ö¸emít_°©i°ic
(
X
)

	)

415 
	#¢mp_ö¸emít_°©i°ic_by
(
X
,
Y
)

	)

416 
	#¢mp_öô_°©i°ics
()

	)

420 
¸óã_u£r_‰om_£ssi⁄
(
√t¢mp_£ssi⁄
 * 
£ssi⁄
);

421 
¢mpv3_¥obe_c⁄ãxtEngöeID_rfc5343
(*
¶p
,

422 
√t¢mp_£ssi⁄
 *
£ssi⁄
);

427 #ifde‡
NETSNMP_USE_REVERSE_ASNENCODING


429 
¢mpv3_∑ckë_ªÆloc_rbuûd
(
u_ch¨
 ** 
pkt
, 
size_t
 * 
pkt_Àn
,

430 
size_t
 * 
off£t
,

431 
√t¢mp_£ssi⁄
 * 
£ssi⁄
,

432 
√t¢mp_pdu
 *
pdu
, 
u_ch¨
 * 
pdu_d©a
,

433 
size_t
 
pdu_d©a_Àn
);

435 
¢mp_pdu_ªÆloc_rbuûd
(
u_ch¨
 ** 
pkt
, 
size_t
 * 
pkt_Àn
,

436 
size_t
 * 
off£t
, 
√t¢mp_pdu
 *
pdu
);

441 
	g√t¢mp_å™•‹t_s
;

447 
NETSNMP_IMPORT


448 
√t¢mp_£ssi⁄
 *
¢mp_›í_ex
(netsnmp_session *,

449 (*
Âª_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

451 
√t¢mp_å™•‹t_s
 *,

453 (*
Â¨£
Ë(
√t¢mp_£ssi⁄
 *,

454 
√t¢mp_pdu
 *, 
u_ch¨
 *,

455 
size_t
),

456 (*
Âo°_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

457 
√t¢mp_pdu
 *, ),

458 (*
fbuûd
Ë(
√t¢mp_£ssi⁄
 *,

459 
√t¢mp_pdu
 *, 
u_ch¨
 *,

460 
size_t
 *),

461 (*
‰buûd
Ë(
√t¢mp_£ssi⁄
 *,

462 
√t¢mp_pdu
 *, 
u_ch¨
 **,

463 
size_t
 *, size_t *),

464 (*
fcheck
Ë(
u_ch¨
 *, 
size_t
));

471 
NETSNMP_IMPORT


472 
¢mp_£t_do_debuggög
();

473 
NETSNMP_IMPORT


474 
¢mp_gë_do_debuggög
();

477 
NETSNMP_IMPORT


478 
√t¢mp_£ss_log_îr‹
(
¥i‹ôy
,

479 c⁄° *
¥og_°rög
,

480 
√t¢mp_£ssi⁄
 * 
ss
);

481 c⁄° * 
¢mp_pdu_ty≥
(
ty≥
);

488 
NETSNMP_IMPORT


489 
√t¢mp_å™•‹t_s
 *
¢mp_£ss_å™•‹t
(*);

490 
¢mp_£ss_å™•‹t_£t
(*,

491 
√t¢mp_å™•‹t_s
 *);

493 
NETSNMP_IMPORT
 

494 
√t¢mp_£ss_c⁄fig_å™•‹t
(
√t¢mp_c⁄èöî_s
 *
å™•‹t_c⁄figuøti⁄
,

495 
√t¢mp_å™•‹t_s
 *
å™•‹t
);

497 
NETSNMP_IMPORT
 

498 
√t¢mp_£ss_c⁄fig_™d_›í_å™•‹t
(
√t¢mp_£ssi⁄
 *
ö_£ssi⁄
,

499 
√t¢mp_å™•‹t_s
 *
å™•‹t
);

514 *
¢mp_£ss_add_ex
(
√t¢mp_£ssi⁄
 *,

515 
√t¢mp_å™•‹t_s
 *,

516 (*
Âª_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

518 
√t¢mp_å™•‹t_s


520 (*
Â¨£
Ë(
√t¢mp_£ssi⁄
 *,

521 
¢mp_pdu
 *,

522 
u_ch¨
 *, 
size_t
),

523 (*
Âo°_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

524 
¢mp_pdu
 *,

526 (*
fbuûd
Ë(
√t¢mp_£ssi⁄
 *,

527 
¢mp_pdu
 *,

528 
u_ch¨
 *, 
size_t
 *),

529 (*
‰buûd
Ë(
√t¢mp_£ssi⁄
 *,

530 
¢mp_pdu
 *,

531 
u_ch¨
 **, 
size_t
 *,

532 
size_t
 *),

533 (*
fcheck
Ë(
u_ch¨
 *, 
size_t
),

534 
√t¢mp_pdu
 *(*
f¸óã_pdu
) (

535 
√t¢mp_å™•‹t_s


538 
size_t
));

540 *
¢mp_£ss_add
(
√t¢mp_£ssi⁄
 *,

541 
√t¢mp_å™•‹t_s
 *,

542 (*
Âª_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

544 
√t¢mp_å™•‹t_s
 *,

546 (*
Âo°_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

547 
√t¢mp_pdu
 *, ));

549 
NETSNMP_IMPORT


550 
√t¢mp_£ssi⁄
 *
¢mp_add
(netsnmp_session *,

551 
√t¢mp_å™•‹t_s
 *,

552 (*
Âª_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

553 
√t¢mp_å™•‹t_s


555 (*
Âo°_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

556 
√t¢mp_pdu
 *, ));

557 
NETSNMP_IMPORT


558 
√t¢mp_£ssi⁄
 *
¢mp_add_fuŒ
“ë¢mp_£ssi⁄ * 
ö_£ssi⁄
,

559 
√t¢mp_å™•‹t_s
 *
å™•‹t
,

560 (*
Âª_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

562 
√t¢mp_å™•‹t_s


564 (*
Â¨£
Ë(
√t¢mp_£ssi⁄
 *,

565 
√t¢mp_pdu
 *, 
u_ch¨
 *,

566 
size_t
),

567 (*
Âo°_∑r£
Ë(
√t¢mp_£ssi⁄
 *,

568 
√t¢mp_pdu
 *, ),

569 (*
fbuûd
Ë(
√t¢mp_£ssi⁄
 *,

570 
√t¢mp_pdu
 *, 
u_ch¨
 *,

571 
size_t
 *),

572 (*
‰buûd
Ë(
√t¢mp_£ssi⁄
 *,

573 
√t¢mp_pdu
 *,

574 
u_ch¨
 **, 
size_t
 *,

575 
size_t
 *),

576 (*
fcheck
Ë(
u_ch¨
 *, 
size_t
),

577 
√t¢mp_pdu
 *(*
f¸óã_pdu
) (

578 
√t¢mp_å™•‹t_s


580 
size_t
)

597 
	#STAT_SNMPUNKNOWNSECURITYMODELS
 0

	)

598 
	#STAT_SNMPINVALIDMSGS
 1

	)

599 
	#STAT_SNMPUNKNOWNPDUHANDLERS
 2

	)

600 
	#STAT_MPD_STATS_START
 
STAT_SNMPUNKNOWNSECURITYMODELS


	)

601 
	#STAT_MPD_STATS_END
 
STAT_SNMPUNKNOWNPDUHANDLERS


	)

606 
	#STAT_USMSTATSUNSUPPORTEDSECLEVELS
 3

	)

607 
	#STAT_USMSTATSNOTINTIMEWINDOWS
 4

	)

608 
	#STAT_USMSTATSUNKNOWNUSERNAMES
 5

	)

609 
	#STAT_USMSTATSUNKNOWNENGINEIDS
 6

	)

610 
	#STAT_USMSTATSWRONGDIGESTS
 7

	)

611 
	#STAT_USMSTATSDECRYPTIONERRORS
 8

	)

612 
	#STAT_USM_STATS_START
 
STAT_USMSTATSUNSUPPORTEDSECLEVELS


	)

613 
	#STAT_USM_STATS_END
 
STAT_USMSTATSDECRYPTIONERRORS


	)

618 
	#STAT_SNMPINPKTS
 9

	)

619 
	#STAT_SNMPOUTPKTS
 10

	)

620 
	#STAT_SNMPINBADVERSIONS
 11

	)

621 
	#STAT_SNMPINBADCOMMUNITYNAMES
 12

	)

622 
	#STAT_SNMPINBADCOMMUNITYUSES
 13

	)

623 
	#STAT_SNMPINASNPARSEERRS
 14

	)

627 
	#STAT_SNMPINTOOBIGS
 16

	)

628 
	#STAT_SNMPINNOSUCHNAMES
 17

	)

629 
	#STAT_SNMPINBADVALUES
 18

	)

630 
	#STAT_SNMPINREADONLYS
 19

	)

631 
	#STAT_SNMPINGENERRS
 20

	)

632 
	#STAT_SNMPINTOTALREQVARS
 21

	)

633 
	#STAT_SNMPINTOTALSETVARS
 22

	)

634 
	#STAT_SNMPINGETREQUESTS
 23

	)

635 
	#STAT_SNMPINGETNEXTS
 24

	)

636 
	#STAT_SNMPINSETREQUESTS
 25

	)

637 
	#STAT_SNMPINGETRESPONSES
 26

	)

638 
	#STAT_SNMPINTRAPS
 27

	)

639 
	#STAT_SNMPOUTTOOBIGS
 28

	)

640 
	#STAT_SNMPOUTNOSUCHNAMES
 29

	)

641 
	#STAT_SNMPOUTBADVALUES
 30

	)

645 
	#STAT_SNMPOUTGENERRS
 32

	)

646 
	#STAT_SNMPOUTGETREQUESTS
 33

	)

647 
	#STAT_SNMPOUTGETNEXTS
 34

	)

648 
	#STAT_SNMPOUTSETREQUESTS
 35

	)

649 
	#STAT_SNMPOUTGETRESPONSES
 36

	)

650 
	#STAT_SNMPOUTTRAPS
 37

	)

654 
	#STAT_SNMPSILENTDROPS
 39

	)

655 
	#STAT_SNMPPROXYDROPS
 40

	)

656 
	#STAT_SNMP_STATS_START
 
STAT_SNMPINPKTS


	)

657 
	#STAT_SNMP_STATS_END
 
STAT_SNMPPROXYDROPS


	)

662 
	#STAT_SNMPUNAVAILABLECONTEXTS
 41

	)

663 
	#STAT_SNMPUNKNOWNCONTEXTS
 42

	)

664 
	#STAT_TARGET_STATS_START
 
STAT_SNMPUNAVAILABLECONTEXTS


	)

665 
	#STAT_TARGET_STATS_END
 
STAT_SNMPUNKNOWNCONTEXTS


	)

670 
	#STAT_TSM_SNMPTSMINVALIDCACHES
 43

	)

671 
	#STAT_TSM_SNMPTSMINADEQUATESECURITYLEVELS
 44

	)

672 
	#STAT_TSM_SNMPTSMUNKNOWNPREFIXES
 45

	)

673 
	#STAT_TSM_SNMPTSMINVALIDPREFIXES
 46

	)

674 
	#STAT_TSM_STATS_START
 
STAT_TSM_SNMPTSMINVALIDCACHES


	)

675 
	#STAT_TSM_STATS_END
 
STAT_TSM_SNMPTSMINVALIDPREFIXES


	)

680 
	#STAT_TLSTM_SNMPTLSTMSESSIONOPENS
 47

	)

681 
	#STAT_TLSTM_SNMPTLSTMSESSIONCLIENTCLOSES
 48

	)

682 
	#STAT_TLSTM_SNMPTLSTMSESSIONOPENERRORS
 49

	)

683 
	#STAT_TLSTM_SNMPTLSTMSESSIONACCEPTS
 50

	)

684 
	#STAT_TLSTM_SNMPTLSTMSESSIONSERVERCLOSES
 51

	)

685 
	#STAT_TLSTM_SNMPTLSTMSESSIONNOSESSIONS
 52

	)

686 
	#STAT_TLSTM_SNMPTLSTMSESSIONINVALIDCLIENTCERTIFICATES
 53

	)

687 
	#STAT_TLSTM_SNMPTLSTMSESSIONUNKNOWNSERVERCERTIFICATE
 54

	)

688 
	#STAT_TLSTM_SNMPTLSTMSESSIONINVALIDSERVERCERTIFICATES
 55

	)

689 
	#STAT_TLSTM_SNMPTLSTMSESSIONINVALIDCACHES
 56

	)

691 
	#STAT_TLSTM_STATS_START
 
STAT_TLSTM_SNMPTLSTMSESSIONOPENS


	)

692 
	#STAT_TLSTM_STATS_END
 
STAT_TLSTM_SNMPTLSTMSESSIONINVALIDCACHES


	)

696 
	#NETSNMP_STAT_MAX_STATS
 (
STAT_TLSTM_STATS_END
+1)

	)

698 
	#MAX_STATS
 
NETSNMP_STAT_MAX_STATS


	)

703 
	s£ssi⁄_li°
 {

704 
£ssi⁄_li°
 *
	g√xt
;

705 
√t¢mp_£ssi⁄
 *
	g£ssi⁄
;

706 
√t¢mp_å™•‹t
 *
	gå™•‹t
;

707 
¢mp_öã∫Æ_£ssi⁄
 *
	göã∫Æ
;

710 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_assert.h

1 #i‚de‡
SNMP_ASSERT_H


2 
	#SNMP_ASSERT_H


	)

4 #ifde‡
NETSNMP_USE_ASSERT


5 
	~<as£π.h
>

7 
	~<√t-¢mp/libøry/¢mp_loggög.h
>

18 #i‚de‡
__STRING


19 #i‡
deföed
(
__STDC__
Ë|| deföed(
_MSC_VER
)

20 
	#__STRING
(
x
Ë#x

	)

22 
	#__STRING
(
x
Ë"x"

	)

29 #ifde‡
NETSNMP_USE_ASSERT


31 
	#√t¢mp_as£π
(
x
Ë
	`as£π
–x )

	)

32 
	#√t¢mp_as£π_‹_ªtu∫
(
x
, 
y
Ë
	`as£π
–x )

	)

33 
	#√t¢mp_as£π_‹_msgªtu∫
(
x
, 
y
, 
z
Ë
	`as£π
–x )

	)

38 #i‚de‡
NETSNMP_NO_DEBUGGING


39 #ifde‡ 
NETSNMP_FUNCTION


40 
	#NETSNMP_FUNC_FMT
 " %s()\n"

	)

41 
	#NETSNMP_FUNC_PARAM
 
NETSNMP_FUNCTION


	)

43 
	#NETSNMP_FUNC_FMT
 "%c"

	)

44 
	#NETSNMP_FUNC_PARAM
 '\n'

	)

46 
#deföê
	#√t¢mp_as£π
(
x
) do { \

47 i‡–
x
 ) \

50 
	`¢mp_log
(
LOG_ERR
, \

51 "√t¢mp_as£π %†Áûed %s:%d" 
NETSNMP_FUNC_FMT
, \

52 
	`__STRING
(
x
),
__FILE__
,
__LINE__
, \

53 
NETSNMP_FUNC_PARAM
); \

54 }0)

	)

55 
	#√t¢mp_as£π_‹_ªtu∫
(
x
, 
y
) do { \

56 i‡–
x
 ) \

59 
	`¢mp_log
(
LOG_ERR
, \

60 "√t¢mp_as£π %†Áûed %s:%d" 
NETSNMP_FUNC_FMT
, \

61 
	`__STRING
(
x
),
__FILE__
,
__LINE__
, \

62 
NETSNMP_FUNC_PARAM
); \

63  
y
; \

65 }0)

	)

66 
	#√t¢mp_as£π_‹_msgªtu∫
(
x
, 
y
, 
z
) do { \

67 i‡–
x
 ) \

70 
	`¢mp_log
(
LOG_ERR
, \

71 "√t¢mp_as£π %†Áûed %s:%d" 
NETSNMP_FUNC_FMT
, \

72 
	`__STRING
(
x
),
__FILE__
,
__LINE__
, \

73 
NETSNMP_FUNC_PARAM
); \

74 
	`¢mp_log
(
LOG_ERR
, 
y
); \

75  
z
; \

77 }0)

	)

79 
	#√t¢mp_as£π
(
x
)

	)

80 
	#√t¢mp_as£π_‹_ªtu∫
(
x
, 
y
) do { \

81 i‡–
x
 ) \

84  
y
; \

86 }0)

	)

87 
	#√t¢mp_as£π_‹_msgªtu∫
(
x
, 
y
, 
z
) do { \

88 i‡–
x
 ) \

91  
z
; \

93 }0)

	)

98 
	#√t¢mp_°©ic_as£π
(
x
) \

99 dÿ{ 0Ë{ (
x
): 0: ; } } 0)

	)

115 
	#√t¢mp_mÆloc_check_LRN
(
±r
) \

116 
	`√t¢mp_as£π_‹_ªtu∫
–(
±r
Ë!
NULL
, NULL)

	)

117 
	#√t¢mp_mÆloc_check_LRE
(
±r
) \

118 
	`√t¢mp_as£π_‹_ªtu∫
–(
±r
Ë!
NULL
, 
SNMPERR_MALLOC
)

	)

119 
	#√t¢mp_mÆloc_check_LRV
(
±r
, 
vÆ
) \

120 
	`√t¢mp_as£π_‹_ªtu∫
–(
±r
Ë!
NULL
, 
vÆ
)

	)

122 
	#√t¢mp_ªquúe_±r_LRV
–
±r
, 
vÆ
 ) \

123 
	`√t¢mp_as£π_‹_ªtu∫
–(
±r
Ë!
NULL
, 
vÆ
)

	)

	@/usr/include/net-snmp/library/snmp_client.h

26 #i‚de‡
SNMP_CLIENT_H


27 
	#SNMP_CLIENT_H


	)

29 
	~<√t-¢mp/ty≥s.h
>

30 
	~<√t-¢mp/v¨böd_≠i.h
>

31 
	~<√t-¢mp/pdu_≠i.h
>

32 
	~<√t-¢mp/ouçut_≠i.h
>

33 
	~<√t-¢mp/£ssi⁄_≠i.h
>

35 #ifde‡
__˝lu•lus


40 
¢mp_pdu
;

41 
¢mp_£ssi⁄
;

42 
v¨übÀ_li°
;

44 
	ssynch_°©e
 {

45 
waôög
;

46 
°©us
;

50 
	#STAT_SUCCESS
 0

	)

51 
	#STAT_ERROR
 1

	)

52 
	#STAT_TIMEOUT
 2

	)

53 
ªqid
;

54 
√t¢mp_pdu
 *
pdu
;

57 
NETSNMP_IMPORT


58 
¢mp_ª∂a˚_v¨_ty≥s
(
√t¢mp_v¨übÀ_li°
 * 
vbl
,

59 
u_ch¨
 
ﬁd_ty≥
,

60 
u_ch¨
 
√w_ty≥
);

61 
NETSNMP_IMPORT


62 
¢mp_ª£t_v¨_buf„rs
(
√t¢mp_v¨übÀ_li°
 * 
v¨
);

63 
¢mp_ª£t_v¨_ty≥s
(
√t¢mp_v¨übÀ_li°
 * 
vbl
,

64 
u_ch¨
 
√w_ty≥
);

65 
NETSNMP_IMPORT


66 
cou¡_v¨böds
(
√t¢mp_v¨übÀ_li°
 * 
v¨_±r
);

67 
NETSNMP_IMPORT


68 
cou¡_v¨böds_of_ty≥
(
√t¢mp_v¨übÀ_li°
 * 
v¨_±r
,

69 
u_ch¨
 
ty≥
);

70 
√t¢mp_v¨übÀ_li°
 *
föd_v¨böd_of_ty≥
(netsnmp_variable_list *

71 
v¨_±r
, 
u_ch¨
 
ty≥
);

72 
NETSNMP_IMPORT


73 
√t¢mp_v¨übÀ_li°
 *
föd_v¨böd_ö_li°
“ë¢mp_v¨übÀ_li° *
vbli°
,

74 c⁄° 
oid
 *
«me
, 
size_t
 
Àn
);

76 
√t¢mp_pdu
 *
¢mp_•lô_pdu
“ë¢mp_pdu *, 
skùCou¡
,

77 
c›yCou¡
);

79 
¢mp_v¨böd_Àn
(
√t¢mp_pdu
 *
pdu
);

80 
NETSNMP_IMPORT


81 
¢mp_˛⁄e_v¨
(
√t¢mp_v¨übÀ_li°
 *,

82 
√t¢mp_v¨übÀ_li°
 *);

83 
NETSNMP_IMPORT


84 
¢mp_synch_ª•⁄£_cb
(
√t¢mp_£ssi⁄
 *,

85 
√t¢mp_pdu
 *,Çetsnmp_pdu **,

86 
¢mp_ˇŒback
);

87 
NETSNMP_IMPORT


88 
¢mp_˛⁄e_mem
(**, const *, );

91 
NETSNMP_IMPORT


92 
√t¢mp_quîy_£t_deÁu…_£ssi⁄
(
√t¢mp_£ssi⁄
 *);

93 
NETSNMP_IMPORT


94 
√t¢mp_£ssi⁄
 * 
√t¢mp_quîy_gë_deÁu…_£ssi⁄_unchecked
( );

95 
NETSNMP_IMPORT


96 
√t¢mp_£ssi⁄
 * 
√t¢mp_quîy_gë_deÁu…_£ssi⁄
( );

97 
NETSNMP_IMPORT


98 
√t¢mp_quîy_gë
–
√t¢mp_v¨übÀ_li°
 *, 
√t¢mp_£ssi⁄
 *);

99 
NETSNMP_IMPORT


100 
√t¢mp_quîy_gë√xt
–
√t¢mp_v¨übÀ_li°
 *, 
√t¢mp_£ssi⁄
 *);

101 
NETSNMP_IMPORT


102 
√t¢mp_quîy_wÆk
–
√t¢mp_v¨übÀ_li°
 *, 
√t¢mp_£ssi⁄
 *);

103 #i‚de‡
NETSNMP_NO_WRITE_SUPPORT


104 
NETSNMP_IMPORT


105 
√t¢mp_quîy_£t
–
√t¢mp_v¨übÀ_li°
 *, 
√t¢mp_£ssi⁄
 *);

114 
√t¢mp_°©e_machöe_°ï_s
;

115 
√t¢mp_°©e_machöe_öput_s
;

118 (
√t¢mp_°©e_machöe_func
)(
	t√t¢mp_°©e_machöe_öput_s
 *
	töput
,

119 
	t√t¢mp_°©e_machöe_°ï_s
 *
	t°ï
);

121 
	s√t¢mp_°©e_machöe_°ï_s
 {

123 c⁄° *
«me
;

124 
u_öt
 
sm_Êags
;

126 
√t¢mp_°©e_machöe_func
 *
run
;

127 
ªsu…
;

130 
√t¢mp_°©e_machöe_°ï_s
 *
⁄_suc˚ss
;

131 
√t¢mp_°©e_machöe_°ï_s
 *
⁄_îr‹
;

136 
u_öt
 
Êags
;

137 *
°ï_c⁄ãxt
;

139 } 
	t√t¢mp_°©e_machöe_°ï
;

141 
	s√t¢mp_°©e_machöe_öput_s
 {

142 c⁄° *
«me
;

143 
°ïs_so_Ár
;

144 
√t¢mp_°©e_machöe_°ï
 *
°ïs
;

145 
√t¢mp_°©e_machöe_°ï
 *
˛ónup
;

146 
√t¢mp_°©e_machöe_°ï
 *
œ°_run
;

151 *
öput_c⁄ãxt
;

153 } 
	t√t¢mp_°©e_machöe_öput
;

156 
NETSNMP_IMPORT
 

157 
√t¢mp_°©e_machöe_run
–
√t¢mp_°©e_machöe_öput
 *
öput
 );

159 
NETSNMP_IMPORT
 

160 
√t¢mp_row_¸óã
(
√t¢mp_£ssi⁄
 *
£ss
, 
√t¢mp_v¨übÀ_li°
 *
v¨s
,

161 
row_°©us_ödex
);

164 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_debug.h

1 #i‚de‡
SNMP_DEBUG_H


2 
	#SNMP_DEBUG_H


	)

4 #ifde‡
__˝lu•lus


18 #i‡!
deföed
(
__GNUC__
Ë|| __GNUC__ < 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 < 8)

19 
	#NETSNMP_ATTRIBUTE_FORMAT
(
ty≥
, 
f‹m©Arg
, 
fú°Arg
)

	)

21 
	#NETSNMP_ATTRIBUTE_FORMAT
(
ty≥
, 
f‹m©Arg
, 
fú°Arg
) \

22 
	`__©åibuã__
((
	`__f‹m©__
–
__
 ## 
ty≥
 ## __, 
f‹m©Arg
, 
fú°Arg
 )))

	)

29 
NETSNMP_IMPORT


30 
debugmsg
(c⁄° *
tokí
, c⁄° *
f‹m©
, ...)

31 
NETSNMP_ATTRIBUTE_FORMAT
(
¥ötf
, 2, 3);

32 
NETSNMP_IMPORT


33 
debugmsgtokí
(c⁄° *
tokí
, c⁄° *
f‹m©
,

35 
NETSNMP_ATTRIBUTE_FORMAT
(
¥ötf
, 2, 3);

36 
debug_combo_nc
(c⁄° *
tokí
, c⁄° *
f‹m©
,

38 
NETSNMP_ATTRIBUTE_FORMAT
(
¥ötf
, 2, 3);

40 #unde‡
NETSNMP_ATTRIBUTE_FORMAT


42 
NETSNMP_IMPORT


43 
debugmsg_oid
(c⁄° *
tokí
, c⁄° 
oid
 * 
theoid
,

44 
size_t
 
Àn
);

45 
NETSNMP_IMPORT


46 
debugmsg_suboid
(c⁄° *
tokí
, c⁄° 
oid
 * 
theoid
,

47 
size_t
 
Àn
);

48 
NETSNMP_IMPORT


49 
debugmsg_v¨
(c⁄° *
tokí
,

50 
√t¢mp_v¨übÀ_li°
 * 
v¨
);

51 
NETSNMP_IMPORT


52 
debugmsg_oidønge
(c⁄° *
tokí
,

53 c⁄° 
oid
 * 
theoid
, 
size_t
 
Àn
,

54 
size_t
 
v¨_subid
, 
oid
 
ønge_ubound
);

55 
NETSNMP_IMPORT


56 
debugmsg_hex
(c⁄° *
tokí
, c⁄° 
u_ch¨
 * 
thed©a
,

57 
size_t
 
Àn
);

58 
NETSNMP_IMPORT


59 
debugmsg_hexéi
(c⁄° *
tokí
, c⁄° 
u_ch¨
 * 
thed©a
,

60 
size_t
 
Àn
);

61 
NETSNMP_IMPORT


62 
debug_ödít_add
(
amou¡
);

63 
NETSNMP_IMPORT


64 
debug_ödít_gë
();

70 
NETSNMP_IMPORT


71 c⁄° *
debug_ödít
();

129 #i‚de‡
NETSNMP_NO_DEBUGGING


139 
	#_DBG_IF_
 
	`¢mp_gë_do_debuggög
()

	)

140 
	#DEBUGIF
(
x
Ëi‡(
_DBG_IF_
 && 
	`debug_is_tokí_ªgi°îed
(xË=
SNMPERR_SUCCESS
)

	)

142 
	#__DBGMSGT
(
x
Ë
debugmsgtokí
 x, 
debugmsg
 
	)
x

143 
	#__DBGMSG_NC
(
x
Ë
debugmsg
 
	)
x

144 
	#__DBGMSGT_NC
(
x
Ë
debug_combo_nc
 
	)
x

145 
	#__DBGMSGL_NC
(
x
Ë
__DBGTRACE
; 
debugmsg
 
	)
x

146 
	#__DBGMSGTL_NC
(
x
Ë
__DBGTRACE
; 
debug_combo_nc
 
	)
x

148 #ifde‡ 
NETSNMP_FUNCTION


149 
	#__DBGTRACE
 
	`__DBGMSGT
(("trace","%s(): %s, %d:\n",\

150 
NETSNMP_FUNCTION
,
__FILE__
,
__LINE__
))

	)

151 
	#__DBGTRACETOK
(
x
Ë
	`__DBGMSGT
((x,"%s(): %s, %d:\n", \

152 
NETSNMP_FUNCTION
,
__FILE__
,
__LINE__
))

	)

154 
	#__DBGTRACE
 
	`__DBGMSGT
(("åa˚"," %s, %d:\n", 
__FILE__
,
__LINE__
))

	)

155 
	#__DBGTRACETOK
(
x
Ë
	`__DBGMSGT
((x," %s, %d:\n", 
__FILE__
,
__LINE__
))

	)

158 
	#__DBGMSGL
(
x
Ë
__DBGTRACE
, 
debugmsg
 
	)
x

159 
	#__DBGMSGTL
(
x
Ë
__DBGTRACE
, 
debugmsgtokí
 x, 
debugmsg
 
	)
x

160 
	#__DBGMSGOID
(
x
Ë
debugmsg_oid
 
	)
x

161 
	#__DBGMSGSUBOID
(
x
Ë
debugmsg_suboid
 
	)
x

162 
	#__DBGMSGVAR
(
x
Ë
debugmsg_v¨
 
	)
x

163 
	#__DBGMSGOIDRANGE
(
x
Ë
debugmsg_oidønge
 
	)
x

164 
	#__DBGMSGHEX
(
x
Ë
debugmsg_hex
 
	)
x

165 
	#__DBGMSGHEXTLI
(
x
Ë
debugmsg_hexéi
 
	)
x

166 
	#__DBGINDENT
(Ë
	`debug_ödít_gë
()

	)

167 
	#__DBGINDENTADD
(
x
Ë
	`debug_ödít_add
(x)

	)

168 
	#__DBGINDENTMORE
(Ë
	`debug_ödít_add
(2)

	)

169 
	#__DBGINDENTLESS
(Ë
	`debug_ödít_add
(-2)

	)

170 
	#__DBGPRINTINDENT
(
tokí
Ë
	`__DBGMSGTL
(—okí, "%*s", 
	`__DBGINDENT
(), ""))

	)

172 
	#__DBGDUMPHEADER
(
tokí
,
x
) \

173 
	`__DBGPRINTINDENT
("dumph_" 
tokí
); \

174 
	`debugmsg
("dumph_" 
tokí
,
x
); \

175 i‡(
	`debug_is_tokí_ªgi°îed
("dumpx" 
tokí
Ë=
SNMPERR_SUCCESS
 || \

176 
	`debug_is_tokí_ªgi°îed
("dumpv" 
tokí
Ë=
SNMPERR_SUCCESS
 || \

177 (
	`debug_is_tokí_ªgi°îed
("dumpx_" 
tokí
Ë!
SNMPERR_SUCCESS
 && \

178 
	`debug_is_tokí_ªgi°îed
("dumpv_" 
tokí
Ë!
SNMPERR_SUCCESS
)) { \

179 
	`debugmsg
("dumph_" 
tokí
,"\n"); \

181 
	`debugmsg
("dumph_" 
tokí
," "); \

183 
	`__DBGINDENTMORE
()

	)

185 
	#__DBGDUMPSECTION
(
tokí
,
x
) \

186 
	`__DBGPRINTINDENT
("dumph_" 
tokí
); \

187 
	`debugmsg
("dumph_" 
tokí
,"%s\n",
x
);\

188 
	`__DBGINDENTMORE
()

	)

190 
	#__DBGDUMPSETUP
(
tokí
,
buf
,
Àn
) \

191 
	`debugmsg
("dumpx" 
tokí
, "dumpx_%s:%*s",Åokí, 
	`__DBGINDENT
(), ""); \

192 
	`__DBGMSGHEX
(("dumpx_" 
tokí
,
buf
,
Àn
)); \

193 i‡(
	`debug_is_tokí_ªgi°îed
("dumpv" 
tokí
Ë=
SNMPERR_SUCCESS
 || \

194 
	`debug_is_tokí_ªgi°îed
("dumpv_" 
tokí
Ë!
SNMPERR_SUCCESS
) { \

195 
	`debugmsg
("dumpx_" 
tokí
,"\n"); \

197 
	`debugmsg
("dumpx_" 
tokí
," "); \

199 
	`debugmsg
("dumpv" 
tokí
, "dumpv_%s:%*s",Åokí, 
	`__DBGINDENT
(), "");

	)

205 #ifde‡
__˝lu•lus


210 
	~<√t-¢mp/ouçut_≠i.h
>

212 #ifde‡
__˝lu•lus


216 
¢mp_debug_öô
();

218 
	#MAX_DEBUG_TOKENS
 256

	)

219 
	#MAX_DEBUG_TOKEN_LEN
 128

	)

220 
	#DEBUG_TOKEN_DELIMITER
 ","

	)

221 
	#DEBUG_ALWAYS_TOKEN
 "Æl"

	)

223 #i‚de‡
NETSNMP_NO_DEBUGGING


230 
	s√t¢mp_tokí_des¸_s
 {

231 *
tokí_«me
;

232 
íabÀd
;

233 } 
	t√t¢mp_tokí_des¸
;

235 
NETSNMP_IMPORT
 
debug_num_tokís
;

236 
NETSNMP_IMPORT
 
√t¢mp_tokí_des¸
 
dbg_tokís
[
MAX_DEBUG_TOKENS
];

240 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_enum.h

1 #i‚de‡
SNMP_ENUM_H


2 
	#SNMP_ENUM_H


	)

4 #ifde‡
__˝lu•lus


8 
	s¢mp_íum_li°
 {

9 
¢mp_íum_li°
 *
√xt
;

10 
vÆue
;

11 *
œbñ
;

14 
	#SE_MAX_IDS
 5

	)

15 
	#SE_MAX_SUBIDS
 32

	)

23 
	#SE_LIBRARY_ID
 0

	)

24 
	#SE_MIB_ID
 1

	)

25 
	#SE_APPLICATION_ID
 2

	)

26 
	#SE_ASSIGNED_ID
 3

	)

35 
	#SE_OK
 0

	)

36 
	#SE_NOMEM
 1

	)

37 
	#SE_ALREADY_THERE
 2

	)

38 
	#SE_DNE
 -2

	)

40 
öô_¢mp_íum
(c⁄° *
ty≥
);

41 
¢mp_íum_li°
 *
£_föd_li°
(
maj‹
,

42 
mö‹
);

43 
¢mp_íum_li°
 *
£_föd_¶i°
(c⁄° *
li°«me
);

44 
£_°‹e_ö_li°
(
¢mp_íum_li°
 *,

45 
maj‹
, 
mö‹
);

46 
£_föd_vÆue
(
maj‹
, 
mö‹
,

47 c⁄° *
œbñ
);

48 
£_föd_‰ì_vÆue
(
maj‹
, 
mö‹
);

49 *
£_föd_œbñ
(
maj‹
, 
mö‹
,

50 
vÆue
);

56 
£_add_∑ú
(
maj‹
, 
mö‹
,

57 *
œbñ
, 
vÆue
);

66 
NETSNMP_IMPORT


67 *
£_föd_œbñ_ö_¶i°
(c⁄° *
li°«me
,

68 
vÆue
);

69 
NETSNMP_IMPORT


70 
£_föd_vÆue_ö_¶i°
(c⁄° *
li°«me
,

71 c⁄° *
œbñ
);

72 
£_föd_‰ì_vÆue_ö_¶i°
(c⁄° *
li°«me
);

78 
NETSNMP_IMPORT


79 
£_add_∑ú_to_¶i°
(c⁄° *
li°«me
, *
œbñ
,

80 
vÆue
);

85 *
£_föd_œbñ_ö_li°
(
¢mp_íum_li°
 *
li°
,

86 
vÆue
);

87 
£_föd_vÆue_ö_li°
(
¢mp_íum_li°
 *
li°
,

88 c⁄° *
œbñ
);

89 
£_föd_‰ì_vÆue_ö_li°
(
¢mp_íum_li°
 *
li°
);

90 
£_add_∑ú_to_li°
(
¢mp_íum_li°
 **
li°
,

91 *
œbñ
, 
vÆue
);

96 
£_°‹e_íum_li°
(
¢mp_íum_li°
 *
√w_li°
,

97 c⁄° *
tokí
, c⁄° *
ty≥
);

98 
£_°‹e_li°
(
maj‹
, 
mö‹
,

99 c⁄° *
ty≥
);

100 
£_˛ór_¶i°
(c⁄° *
li°«me
);

101 
£_°‹e_¶i°
(c⁄° *
li°«me
, c⁄° *
ty≥
);

102 
£_°‹e_¶i°_ˇŒback
(
maj‹ID
, 
mö‹ID
,

103 *
£rvî¨gs
, *
˛õ¡¨gs
);

104 
£_ªad_c⁄f
(c⁄° *
w‹d
, *
˝å
);

109 
NETSNMP_IMPORT


110 
˛ór_¢mp_íum
();

112 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_impl.h

1 #i‚de‡
SNMP_IMPL_H


2 
	#SNMP_IMPL_H


	)

4 #ifde‡
__˝lu•lus


38 
	~<°dio.h
>

39 
	~<√t-¢mp/ty≥s.h
>

41 
	#COMMUNITY_MAX_LEN
 256

	)

46 
	#SPRINT_MAX_LEN
 2560

	)

49 #i‚de‡
NULL


50 
	#NULL
 0

	)

53 #i‚de‡
TRUE


54 
	#TRUE
 1

	)

56 #i‚de‡
FALSE


57 
	#FALSE
 0

	)

60 
	#READ
 1

	)

61 
	#WRITE
 0

	)

63 
	#RESERVE1
 0

	)

64 
	#RESERVE2
 1

	)

65 
	#ACTION
 2

	)

66 
	#COMMIT
 3

	)

67 
	#FREE
 4

	)

68 
	#UNDO
 5

	)

69 
	#FINISHED_SUCCESS
 9

	)

70 
	#FINISHED_FAILURE
 10

	)

75 
	#NETSNMP_OLDAPI_RONLY
 0x1

	)

76 
	#NETSNMP_OLDAPI_RWRITE
 0x2

	)

77 
	#NETSNMP_OLDAPI_NOACCESS
 0x0000

	)

79 #i‚de‡
NETSNMP_NO_LEGACY_DEFINITIONS


80 
	#RONLY
 
NETSNMP_OLDAPI_RONLY


	)

81 
	#RWRITE
 
NETSNMP_OLDAPI_RWRITE


	)

82 
	#NOACCESS
 
NETSNMP_OLDAPI_NOACCESS


	)

88 
	#ASN_IPADDRESS
 (
ASN_APPLICATION
 | 0)

	)

89 
	#ASN_COUNTER
 (
ASN_APPLICATION
 | 1)

	)

90 
	#ASN_GAUGE
 (
ASN_APPLICATION
 | 2)

	)

91 
	#ASN_UNSIGNED
 (
ASN_APPLICATION
 | 2Ë

	)

92 
	#ASN_TIMETICKS
 (
ASN_APPLICATION
 | 3)

	)

93 
	#ASN_OPAQUE
 (
ASN_APPLICATION
 | 4Ë

	)

98 
	#ASN_NSAP
 (
ASN_APPLICATION
 | 5Ë

	)

99 
	#ASN_COUNTER64
 (
ASN_APPLICATION
 | 6)

	)

100 
	#ASN_UINTEGER
 (
ASN_APPLICATION
 | 7Ë

	)

102 #ifde‡
NETSNMP_WITH_OPAQUE_SPECIAL_TYPES


106 
	#ASN_FLOAT
 (
ASN_APPLICATION
 | 8)

	)

107 
	#ASN_DOUBLE
 (
ASN_APPLICATION
 | 9)

	)

108 
	#ASN_INTEGER64
 (
ASN_APPLICATION
 | 10)

	)

109 
	#ASN_UNSIGNED64
 (
ASN_APPLICATION
 | 11)

	)

115 #i‚de‡
ERROR_MSG


116 
	#ERROR_MSG
(
°rög
Ë
	`¢mp_£t_dëaû
(°rög)

	)

122 
u_ch¨
 
sid
[];

123 
NETSNMP_IMPORT
 
	g¢mp_î∫o
;

135 
	#FIRST_PASS
 1

	)

136 
	#LAST_PASS
 2

	)

137 
u_ch¨
 *
¢mp_com°r_∑r£
(u_ch¨ *, 
size_t
 *, u_char *,

138 
size_t
 *, *);

139 
u_ch¨
 *
¢mp_com°r_buûd
(u_ch¨ *, 
size_t
 *, u_char *,

140 
size_t
 *, *, size_t);

142 
has_ac˚ss
(
u_ch¨
, , , );

143 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_logging.h

1 #i‚de‡
SNMP_LOGGING_H


2 
	#SNMP_LOGGING_H


	)

4 
	~<√t-¢mp/ty≥s.h
>

5 
	~<√t-¢mp/ouçut_≠i.h
>

7 #i‡
HAVE_SYSLOG_H


8 
	~<sy¶og.h
>

10 
	~<°dio.h
>

11 
	~<°d¨g.h
>

13 #ifde‡
__˝lu•lus


17 #i‚de‡
LOG_ERR


18 
	#LOG_EMERG
 0

	)

19 
	#LOG_ALERT
 1

	)

20 
	#LOG_CRIT
 2

	)

21 
	#LOG_ERR
 3

	)

22 
	#LOG_WARNING
 4

	)

23 
	#LOG_NOTICE
 5

	)

24 
	#LOG_INFO
 6

	)

25 
	#LOG_DEBUG
 7

	)

28 
	s¢mp_log_mesßge
 {

29 
¥i‹ôy
;

30 c⁄° *
msg
;

33 #i‚de‡
DEFAULT_LOG_ID


34 
	#DEFAULT_LOG_ID
 "√t-¢mp"

	)

37 
	#NETSNMP_LOGONCE
(
x
) do { \

38 
logged
 = 0; \

39 i‡(!
logged
) { \

40 
logged
 = 1; \

41 
¢mp_log
 
x
 ; \

43 } 0)

	)

45 
öô_¢mp_loggög
();

46 
NETSNMP_IMPORT


47 
¢mp_dißbÀ_sy¶og
();

48 
¢mp_dißbÀ_fûñog
();

49 
NETSNMP_IMPORT


50 
¢mp_dißbÀ_°dîæog
();

51 
¢mp_dißbÀ_ˇŒlog
();

52 
NETSNMP_IMPORT


53 
¢mp_íabÀ_sy¶og
();

54 
NETSNMP_IMPORT


55 
¢mp_íabÀ_sy¶og_idít
(c⁄° *
idít
,

56 c⁄° 
Ácûôy
);

57 
NETSNMP_IMPORT


58 
¢mp_íabÀ_fûñog
(c⁄° *
logfûíame
,

59 
d⁄t_zîo_log
);

60 
NETSNMP_IMPORT


61 
¢mp_íabÀ_°dîæog
();

62 
¢mp_íabÀ_ˇŒlog
();

64 
NETSNMP_IMPORT


65 
¢mp_°dîæog_°©us
();

68 
	#NETSNMP_LOGHANDLER_STDOUT
 1

	)

69 
	#NETSNMP_LOGHANDLER_STDERR
 2

	)

70 
	#NETSNMP_LOGHANDLER_FILE
 3

	)

71 
	#NETSNMP_LOGHANDLER_SYSLOG
 4

	)

72 
	#NETSNMP_LOGHANDLER_CALLBACK
 5

	)

73 
	#NETSNMP_LOGHANDLER_NONE
 6

	)

75 
NETSNMP_IMPORT


76 
√t¢mp_£t_löe_buf„rög
(
FILE
 *
°ªam
);

77 
NETSNMP_IMPORT


78 
¢mp_log_›ti⁄s
(*
›èrg
, 
¨gc
, *c⁄° *
¨gv
);

79 
NETSNMP_IMPORT


80 
¢mp_log_›ti⁄s_ußge
(c⁄° *
Àad
, 
FILE
 *
outf
);

81 
NETSNMP_IMPORT


82 *
¢mp_log_sy¶og«me
(c⁄° *
sy¶og«me
);

83 
√t¢mp_log_h™dÀr_s
 
	t√t¢mp_log_h™dÀr
;

84 (
Në¢mpLogH™dÀr
)(
	t√t¢mp_log_h™dÀr
*, , const *);

86 
Në¢mpLogH™dÀr
 
log_h™dÀr_°douãº
;

87 
Në¢mpLogH™dÀr
 
log_h™dÀr_fûe
;

88 
Në¢mpLogH™dÀr
 
log_h™dÀr_sy¶og
;

89 
Në¢mpLogH™dÀr
 
log_h™dÀr_ˇŒback
;

90 
Në¢mpLogH™dÀr
 
log_h™dÀr_nuŒ
;

92 
	s√t¢mp_log_h™dÀr_s
 {

93 
íabÀd
;

94 
¥i‹ôy
;

95 
¥i_max
;

96 
ty≥
;

97 c⁄° *
tokí
;

99 
Në¢mpLogH™dÀr
 *
h™dÀr
;

101 
imagic
;

102 *
magic
;

104 
√t¢mp_log_h™dÀr
 *
√xt
, *
¥ev
;

107 
NETSNMP_IMPORT


108 
√t¢mp_log_h™dÀr
 *
gë_logh_hód
( );

109 
NETSNMP_IMPORT


110 
√t¢mp_log_h™dÀr
 *
√t¢mp_ªgi°î_logh™dÀr
–
ty≥
, 
¥i
 );

111 
√t¢mp_log_h™dÀr
 *
√t¢mp_föd_logh™dÀr
–c⁄° *
tokí
 );

112 
√t¢mp_add_logh™dÀr
–
√t¢mp_log_h™dÀr
 *
logh
 );

113 
NETSNMP_IMPORT


114 
√t¢mp_ªmove_logh™dÀr
–
√t¢mp_log_h™dÀr
 *
logh
 );

115 
√t¢mp_íabÀ_logh™dÀr
–c⁄° *
tokí
 );

116 
√t¢mp_dißbÀ_logh™dÀr
–c⁄° *
tokí
 );

117 
NETSNMP_IMPORT


118 
√t¢mp_íabÀ_this_logh™dÀr
–
√t¢mp_log_h™dÀr
 *
logh
 );

119 
NETSNMP_IMPORT


120 
√t¢mp_dißbÀ_this_logh™dÀr
–
√t¢mp_log_h™dÀr
 *
logh
 );

121 
NETSNMP_IMPORT


122 
√t¢mp_loggög_ª°¨t
();

123 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_parse_args.h

1 #i‚de‡
SNMP_PARSE_ARGS_H


2 
	#SNMP_PARSE_ARGS_H


	)

11 #ifde‡
__˝lu•lus


16 
	#NETSNMP_PARSE_ARGS_NOLOGGING
 0x0001

	)

21 
	#NETSNMP_PARSE_ARGS_NOZERO
 0x0002

	)

27 
	#NETSNMP_PARSE_ARGS_SUCCESS
 0

	)

32 
	#NETSNMP_PARSE_ARGS_SUCCESS_EXIT
 -2

	)

37 
	#NETSNMP_PARSE_ARGS_ERROR_USAGE
 -1

	)

43 
	#NETSNMP_PARSE_ARGS_ERROR
 -3

	)

68 
NETSNMP_IMPORT
 

69 
√t¢mp_∑r£_¨gs
(
¨gc
, **
¨gv
, 
√t¢mp_£ssi⁄
 *
£ssi⁄
,

70 c⁄° *
loˇlO±s
, (*
¥oc
)(, *const *, ),

71 
Êags
);

77 
NETSNMP_IMPORT


79 
¢mp_∑r£_¨gs
(
¨gc
, **
¨gv
, 
√t¢mp_£ssi⁄
 *
£ssi⁄
,

80 c⁄° *
loˇlO±s
, (*
¥oc
)(, *const *, ));

82 
NETSNMP_IMPORT


84 
¢mp_∑r£_¨gs_des¸ùti⁄s
(
FILE
 *);

86 
NETSNMP_IMPORT


88 
¢mp_∑r£_¨gs_ußge
(
FILE
 *);

90 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_secmod.h

1 #i‚de‡
SNMPSECMOD_H


2 
	#SNMPSECMOD_H


	)

4 #ifde‡
__˝lu•lus


8 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

13 
	#NETSNMP_SEC_MODEL_KSM
 2066432

	)

14 
	#NETSNMP_KSM_SECURITY_MODEL
 
NETSNMP_SEC_MODEL_KSM


	)

15 
	#NETSNMP_TSM_SECURITY_MODEL
 
SNMP_SEC_MODEL_TSM


	)

17 
¢mp_£cmod_def
;

22 
	s¢mp_£cmod_outgoög_∑øms
 {

23 
msgProcModñ
;

24 
u_ch¨
 *
globÆD©a
;

25 
size_t
 
globÆD©aLí
;

26 
maxMsgSize
;

27 
£cModñ
;

28 
u_ch¨
 *
£cEngöeID
;

29 
size_t
 
£cEngöeIDLí
;

30 *
£cName
;

31 
size_t
 
£cNameLí
;

32 
£cLevñ
;

33 
u_ch¨
 *
sc›edPdu
;

34 
size_t
 
sc›edPduLí
;

35 *
£cSèãRef
;

36 
u_ch¨
 *
£cP¨ams
;

37 
size_t
 *
£cP¨amsLí
;

38 
u_ch¨
 **
whﬁeMsg
;

39 
size_t
 *
whﬁeMsgLí
;

40 
size_t
 *
whﬁeMsgOff£t
;

41 
√t¢mp_pdu
 *
pdu
;

42 
√t¢mp_£ssi⁄
 *
£ssi⁄
;

45 
	s¢mp_£cmod_öcomög_∑øms
 {

46 
msgProcModñ
;

47 
size_t
 
maxMsgSize
;

49 
u_ch¨
 *
£cP¨ams
;

50 
£cModñ
;

51 
£cLevñ
;

53 
u_ch¨
 *
whﬁeMsg
;

54 
size_t
 
whﬁeMsgLí
;

56 
u_ch¨
 *
£cEngöeID
;

57 
size_t
 *
£cEngöeIDLí
;

62 *
£cName
;

63 
size_t
 *
£cNameLí
;

65 
u_ch¨
 **
sc›edPdu
;

66 
size_t
 *
sc›edPduLí
;

68 
size_t
 *
maxSizeRe•⁄£
;

69 **
£cSèãRef
;

70 
√t¢mp_£ssi⁄
 *
£ss
;

71 
√t¢mp_pdu
 *
pdu
;

72 
u_ch¨
 
msg_Êags
;

83 (
SecmodSessi⁄CÆlback
Ë(
	t√t¢mp_£ssi⁄
 *);

84 (
SecmodPduCÆlback
Ë(
	t√t¢mp_pdu
 *);

85 (
Secmod2PduCÆlback
Ë(
	t√t¢mp_pdu
 *,Çetsnmp_pdu *);

86 (
SecmodOutMsg
Ë(
	t¢mp_£cmod_outgoög_∑øms
 *);

87 (
SecmodInMsg
Ë(
	t¢mp_£cmod_öcomög_∑øms
 *);

88 (
SecmodFªeSèã
) (*);

89 (
SecmodH™dÀRï‹t
Ë(*
	t£s•
,

90 
	t√t¢mp_å™•‹t
 *
	tå™•‹t
,

91 
	t√t¢mp_£ssi⁄
 *,

92 
	tªsu…
,

93 
	t√t¢mp_pdu
 *
	t‹igpdu
);

94 (
SecmodDiscovîyMëhod
Ë(*
	t¶p
, 
	t√t¢mp_£ssi⁄
 *
	t£ssi⁄
);

95 (
SecmodPo°Discovîy
Ë(*
	t¶p
, 
	t√t¢mp_£ssi⁄
 *
	t£ssi⁄
);

97 (
SecmodSessi⁄Sëup
Ë(
	t√t¢mp_£ssi⁄
 *
	tö_£ssi⁄
,

98 
	t√t¢mp_£ssi⁄
 *
	tout_£ssi⁄
);

107 
	s¢mp_£cmod_def
 {

111 
SecmodSessi⁄CÆlback
 *
£ssi⁄_›í
;

112 
SecmodSessi⁄CÆlback
 *
£ssi⁄_˛o£
;

113 
SecmodSessi⁄Sëup
 *
£ssi⁄_£tup
;

118 
SecmodPduCÆlback
 *
pdu_‰ì
;

119 
Secmod2PduCÆlback
 *
pdu_˛⁄e
;

120 
SecmodPduCÆlback
 *
pdu_timeout
;

121 
SecmodFªeSèã
 *
pdu_‰ì_°©e_ªf
;

126 
SecmodOutMsg
 *
ícode_ªvî£
;

127 
SecmodOutMsg
 *
ícode_f‹w¨d
;

128 
SecmodInMsg
 *
decode
;

133 
SecmodH™dÀRï‹t
 *
h™dÀ_ªp‹t
;

138 
SecmodDiscovîyMëhod
 *
¥obe_ígöeid
;

139 
SecmodPo°Discovîy
 *
po°_¥obe_ígöeid
;

146 
	s¢mp_£cmod_li°
 {

147 
£curôyModñ
;

148 
¢mp_£cmod_def
 *
£cDef
;

149 
¢mp_£cmod_li°
 *
√xt
;

156 
ªgi°î_£c_mod
(, const *,

157 
¢mp_£cmod_def
 *);

161 
NETSNMP_IMPORT


162 
¢mp_£cmod_def
 *
föd_£c_mod
();

166 
uƒegi°î_£c_mod
();

167 
öô_£cmod
();

168 
NETSNMP_IMPORT


169 
shutdown_£cmod
();

174 
NETSNMP_IMPORT


175 
˛ór_£c_mod
();

177 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_service.h

1 #i‚de‡
_SNMP_SERVICE_H


2 
	#_SNMP_SERVICE_H


	)

4 #ifde‡
__˝lu•lus


10 
NETSNMP_IMPORT
 

11 
√t¢mp_ªgi°î_deÁu…_domaö
(c⁄° * 
≠∂iˇti⁄
, c⁄° * 
domaö
);

14 
√t¢mp_lookup_deÁu…_domaö
(c⁄° * 
≠∂iˇti⁄
);

17 
√t¢mp_lookup_deÁu…_domaös
(c⁄° * 
≠∂iˇti⁄
);

20 
√t¢mp_˛ór_deÁu…_domaö
();

22 
NETSNMP_IMPORT
 

23 
√t¢mp_ªgi°î_deÁu…_èrgë
(c⁄° * 
≠∂iˇti⁄
, c⁄° * 
domaö
,

24 c⁄° * 
èrgë
);

27 
√t¢mp_lookup_deÁu…_èrgë
(c⁄° * 
≠∂iˇti⁄
, c⁄° * 
domaö
);

30 
√t¢mp_˛ór_deÁu…_èrgë
();

32 
NETSNMP_IMPORT
 

33 
√t¢mp_ªgi°î_£rvi˚_h™dÀrs
();

35 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmp_transport.h

1 #i‚de‡
_SNMP_TRANSPORT_H


2 
	#_SNMP_TRANSPORT_H


	)

4 
	~<sys/ty≥s.h
>

6 #i‡
HAVE_SYS_SOCKET_H


7 #ifde‡
sﬁ¨is2


8 
	#_XPG4_2


	)

11 #i‡
deföed
(
aix4
Ë|| deföed(
aix5
Ë|| deföed(
aix6
Ë|| deföed(
aix7
)

12 
	#_LINUX_SOURCE_COMPAT


	)

15 
	~<sys/sockë.h
>

17 #ifde‡
sﬁ¨is2


18 #i‚de‡
CMSG_SPACE


19 
	#CMSG_SPACE
(
l
) \

20 (()
	`_CMSG_HDR_ALIGN
( (
cmsghdr
Ë+ (
l
)))

	)

21 
	#CMSG_LEN
(
l
Ë(
	`_CMSG_HDR_ALIGN
((
cmsghdr
)Ë+ (l))

	)

26 #ifde‡
HAVE_NETINET_IN_H


27 
	~<√töë/ö.h
>

30 
	~<√t-¢mp/libøry/a¢1.h
>

32 #ifde‡
__˝lu•lus


38 #i‚de‡
NETSNMP_STREAM_QUEUE_LEN


39 
	#NETSNMP_STREAM_QUEUE_LEN
 5

	)

44 
	#NETSNMP_TRANSPORT_FLAG_STREAM
 0x01

	)

45 
	#NETSNMP_TRANSPORT_FLAG_LISTEN
 0x02

	)

46 
	#NETSNMP_TRANSPORT_FLAG_TUNNELED
 0x04

	)

47 
	#NETSNMP_TRANSPORT_FLAG_TMSTATE
 0x08

	)

49 
	#NETSNMP_TRANSPORT_FLAG_EMPTY_PKT
 0x10

	)

50 
	#NETSNMP_TRANSPORT_FLAG_OPENED
 0x20

	)

51 
	#NETSNMP_TRANSPORT_FLAG_HOSTNAME
 0x80

	)

55 
NETSNMP_IMPORT
 
oid
 
√t¢mpUDPDomaö
[];

56 
NETSNMP_IMPORT
 
oid
 
√t¢mpCLNSDomaö
[];

57 
NETSNMP_IMPORT
 
oid
 
√t¢mpCONSDomaö
[];

58 
NETSNMP_IMPORT
 
oid
 
√t¢mpDDPDomaö
[];

59 
NETSNMP_IMPORT
 
oid
 
√t¢mpIPXDomaö
[];

60 
NETSNMP_IMPORT
 
size_t
 
√t¢mpUDPDomaö_Àn
;

61 
NETSNMP_IMPORT
 
size_t
 
√t¢mpCLNSDomaö_Àn
;

62 
NETSNMP_IMPORT
 
size_t
 
√t¢mpCONSDomaö_Àn
;

63 
NETSNMP_IMPORT
 
size_t
 
√t¢mpDDPDomaö_Àn
;

64 
NETSNMP_IMPORT
 
size_t
 
√t¢mpIPXDomaö_Àn
;

72 
	#NETSNMP_TM_MAX_SECNAME
 256

	)

74 
	u√t¢mp_sockaddr_°‹age_u
 {

75 
sockaddr
 
ß
;

76 
sockaddr_ö
 
sö
;

77 #ifde‡
NETSNMP_ENABLE_IPV6


78 
sockaddr_ö6
 
sö6
;

80 } 
	t√t¢mp_sockaddr_°‹age
;

82 
	s√t¢mp_addr_∑ú_s
 {

83 
√t¢mp_sockaddr_°‹age
 
ªmŸe_addr
;

84 
√t¢mp_sockaddr_°‹age
 
loˇl_addr
;

85 } 
	t√t¢mp_addr_∑ú
;

87 
	s√t¢mp_ödexed_addr_∑ú_s
 {

88 
√t¢mp_sockaddr_°‹age
 
ªmŸe_addr
;

89 
√t¢mp_sockaddr_°‹age
 
loˇl_addr
;

90 
if_ödex
;

91 } 
	t√t¢mp_ödexed_addr_∑ú
;

93 
	s√t¢mp_tmSèãRe„ªn˚_s
 {

94 
oid
 
å™•‹tDomaö
[
MAX_OID_LEN
];

95 
size_t
 
å™•‹tDomaöLí
;

96 
£curôyName
[
NETSNMP_TM_MAX_SECNAME
];

97 
size_t
 
£curôyNameLí
;

98 
ªque°edSecurôyLevñ
;

99 
å™•‹tSecurôyLevñ
;

100 
ßmeSecurôy
;

101 
£ssi⁄ID
[8];

103 
have_addªs£s
;

104 
√t¢mp_ödexed_addr_∑ú
 
addªs£s
;

106 *
ŸhîTøn•‹tO∑que
;

107 } 
	t√t¢mp_tmSèãRe„ªn˚
;

111 
¢mp_£ssi⁄
;

113 
	s√t¢mp_å™•‹t_s
 {

116 c⁄° 
oid
 *
domaö
;

117 
domaö_Àngth
;

121 *
loˇl
;

122 
loˇl_Àngth
;

126 *
ªmŸe
;

127 
ªmŸe_Àngth
;

131 
sock
;

135 
Êags
;

139 *
d©a
;

140 
d©a_Àngth
;

144 
size_t
 
msgMaxSize
;

146 #ifde‡
FOR_STANDARDS_COMPLIANCE_OR_FUTURE_USE


148 
√t¢mp_tmSèãRe„ªn˚
 *
tmSèãRef
;

152 
√t¢mp_å™•‹t_s
 * 
ba£_å™•‹t
;

159 (*
f_ªcv
Ë(
√t¢mp_å™•‹t_s
 *, *,

161 (*
f_£nd
Ë(
√t¢mp_å™•‹t_s
 *, *,

163 (*
f_˛o£
Ë(
√t¢mp_å™•‹t_s
 *);

166 
√t¢mp_å™•‹t_s
 * (*
f_›í
) (netsnmp_transport_s *);

170 (*
f_ac˚±
Ë(
√t¢mp_å™•‹t_s
 *);

174 *(*
f_fmèddr
)(
√t¢mp_å™•‹t_s
 *, *, );

178 (*
f_c⁄fig
)(
√t¢mp_å™•‹t_s
 *, const *,

183 (*
f_c›y
)(
√t¢mp_å™•‹t_s
 *,

184 
√t¢mp_å™•‹t_s
 *);

187 (*
f_£tup_£ssi⁄
)(
√t¢mp_å™•‹t_s
 *,

188 
¢mp_£ssi⁄
 *);

192 
u_ch¨
 *
idítifõr
;

193 } 
	t√t¢mp_å™•‹t
;

195 
	s√t¢mp_å™•‹t_li°_s
 {

196 
√t¢mp_å™•‹t
 *
å™•‹t
;

197 
√t¢mp_å™•‹t_li°_s
 *
√xt
;

198 } 
	t√t¢mp_å™•‹t_li°
;

200 
	s√t¢mp_tdomaö_s
 {

201 c⁄° 
oid
 *
«me
;

202 
size_t
 
«me_Àngth
;

203 c⁄° **
¥efix
;

209 
√t¢mp_å™•‹t
 *(*
f_¸óã_‰om_t°rög
) (const *, );

211 
√t¢mp_å™•‹t
 *(*
f_¸óã_‰om_o°rög
Ë(c⁄° 
u_ch¨
 *, 
size_t
, );

213 
√t¢mp_tdomaö_s
 *
√xt
;

215 
√t¢mp_å™•‹t
 *(*
f_¸óã_‰om_t°rög_√w
) (const *, ,

218 } 
	t√t¢mp_tdomaö
;

220 
öô_¢mp_å™•‹t
();

224 *
√t¢mp_å™•‹t_≥î_°rög
(
√t¢mp_å™•‹t
 *
t
, *
d©a
, 
Àn
);

226 
√t¢mp_å™•‹t_£nd
(
√t¢mp_å™•‹t
 *
t
, *
d©a
, 
Àn
,

227 **
›aque
, *
ﬁígth
);

228 
√t¢mp_å™•‹t_ªcv
(
√t¢mp_å™•‹t
 *
t
, *
d©a
, 
Àn
,

229 **
›aque
, *
ﬁígth
);

231 
√t¢mp_å™•‹t_add_to_li°
(
√t¢mp_å™•‹t_li°
 **
å™•‹t_li°
,

232 
√t¢mp_å™•‹t
 *
å™•‹t
);

233 
√t¢mp_å™•‹t_ªmove_‰om_li°
(
√t¢mp_å™•‹t_li°
 **
å™•‹t_li°
,

234 
√t¢mp_å™•‹t
 *
å™•‹t
);

235 
√t¢mp_sockaddr_size
(
sockaddr
 *
ß
);

243 
√t¢mp_å™•‹t
 *
√t¢mp_å™•‹t_c›y
“ë¢mp_å™•‹à*
t
);

248 
NETSNMP_IMPORT


249 
√t¢mp_å™•‹t_‰ì
(
√t¢mp_å™•‹t
 *
t
);

260 
NETSNMP_IMPORT


261 
√t¢mp_tdomaö_suµ‹t
(c⁄° 
oid
 *
ö_oid
, 
size_t
 
ö_Àn
,

262 c⁄° 
oid
 **
out_oid
, 
size_t
 *
out_Àn
);

264 
√t¢mp_tdomaö_ªgi°î
(
√t¢mp_tdomaö
 *
domaö
);

266 
√t¢mp_tdomaö_uƒegi°î
(
√t¢mp_tdomaö
 *
domaö
);

268 
NETSNMP_IMPORT


269 
√t¢mp_˛ór_tdomaö_li°
();

271 
√t¢mp_tdomaö_öô
();

273 
NETSNMP_IMPORT


274 
√t¢mp_å™•‹t
 *
√t¢mp_tdomaö_å™•‹t
(c⁄° *
°r
,

275 
loˇl
,

276 c⁄° *
deÁu…_domaö
);

278 
NETSNMP_IMPORT


279 
√t¢mp_å™•‹t
 *
√t¢mp_tdomaö_å™•‹t_fuŒ
(c⁄° *
≠∂iˇti⁄
,

280 c⁄° *
°r
,

281 
loˇl
,

282 c⁄° *
deÁu…_domaö
,

283 c⁄° *
deÁu…_èrgë
);

285 
NETSNMP_IMPORT


286 
√t¢mp_å™•‹t
 *
√t¢mp_tdomaö_å™•‹t_oid
(c⁄° 
oid
 * 
dom
,

287 
size_t
 
dom_Àn
,

288 c⁄° 
u_ch¨
 * 
o
,

289 
size_t
 
o_Àn
,

290 
loˇl
);

292 
NETSNMP_IMPORT


293 
√t¢mp_å™•‹t
*

294 
√t¢mp_å™•‹t_›í_˛õ¡
(c⁄° * 
≠∂iˇti⁄
, c⁄° * 
°r
);

296 
NETSNMP_IMPORT


297 
√t¢mp_å™•‹t
*

298 
√t¢mp_å™•‹t_›í_£rvî
(c⁄° * 
≠∂iˇti⁄
, c⁄° * 
°r
);

300 
√t¢mp_å™•‹t
*

301 
√t¢mp_å™•‹t_›í
(c⁄° * 
≠∂iˇti⁄
, c⁄° * 
°r
, 
loˇl
);

303 
	s√t¢mp_å™•‹t_c⁄fig_s
 {

304 *
key
;

305 *
vÆue
;

306 } 
	t√t¢mp_å™•‹t_c⁄fig
;

308 
NETSNMP_IMPORT


309 
√t¢mp_å™•‹t_c⁄fig_com∑ª
(
√t¢mp_å™•‹t_c⁄fig
 *
À·
,

310 
√t¢mp_å™•‹t_c⁄fig
 *
right
);

311 
NETSNMP_IMPORT


312 
√t¢mp_å™•‹t_c⁄fig
 *
√t¢mp_å™•‹t_¸óã_c⁄fig
(*
key
,

313 *
vÆue
);

314 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpv3-security-includes.h

2 
	~<√t-¢mp/libøry/¢m±sm.h
>

3 
	~<√t-¢mp/libøry/¢mpusm.h
>

	@/usr/include/net-snmp/library/snmpv3.h

5 #i‚de‡
SNMPV3_H


6 
	#SNMPV3_H


	)

8 #ifde‡
__˝lu•lus


12 
	#MAX_ENGINEID_LENGTH
 32

	)

14 
	#ENGINEID_TYPE_IPV4
 1

	)

15 
	#ENGINEID_TYPE_IPV6
 2

	)

16 
	#ENGINEID_TYPE_MACADDR
 3

	)

17 
	#ENGINEID_TYPE_TEXT
 4

	)

18 
	#ENGINEID_TYPE_EXACT
 5

	)

19 
	#ENGINEID_TYPE_NETSNMP_RND
 128

	)

21 
	#DEFAULT_NIC
 "ëh0"

	)

23 
NETSNMP_IMPORT


24 
£tup_ígöeID
(
u_ch¨
 ** 
eidp
, c⁄° *
ãxt
);

25 
ígöeID_c⁄f
(c⁄° *
w‹d
, *
˝å
);

26 
ígöeBoŸs_c⁄f
(const *, *);

27 
ígöeIDTy≥_c⁄f
(const *, *);

28 
ígöeIDNic_c⁄f
(const *, *);

29 
NETSNMP_IMPORT


30 
öô_¢mpv3
(const *);

31 
öô_¢mpv3_po°_c⁄fig
(
maj‹id
, 
mö‹id
,

32 *
£rvî¨g
,

33 *
˛õ¡¨g
);

34 
öô_¢mpv3_po°_¥emib_c⁄fig
(
maj‹id
,

35 
mö‹id
,

36 *
£rvî¨g
,

37 *
˛õ¡¨g
);

38 
shutdown_¢mpv3
(c⁄° *
ty≥
);

39 
¢mpv3_°‹e
(
maj‹ID
, 
mö‹ID
, *
£rvî¨g
,

40 *
˛õ¡¨g
);

41 
NETSNMP_IMPORT


42 
u_l⁄g
 
¢mpv3_loˇl_¢mpEngöeBoŸs
();

43 
¢mpv3_˛⁄e_ígöeID
(
u_ch¨
 **, 
size_t
 *, u_char *,

44 
size_t
);

45 
NETSNMP_IMPORT


46 
size_t
 
¢mpv3_gë_ígöeID
(
u_ch¨
 * 
buf
, size_à
buÊí
);

47 
NETSNMP_IMPORT


48 
u_ch¨
 *
¢mpv3_gíî©e_ígöeID
(
size_t
 *);

49 
NETSNMP_IMPORT


50 
u_l⁄g
 
¢mpv3_loˇl_¢mpEngöeTime
();

51 
gë_deÁu…_£cLevñ
();

52 
¢mpv3_£t_ígöeBoŸsAndTime
(
boŸs
, 
âime
);

53 
‰ì_ígöeID
(
maj‹id
, 
mö‹id
, *
£rvî¨g
,

54 *
˛õ¡¨g
);

55 
NETSNMP_IMPORT


56 
∑r£_£cLevñ_c⁄f
(c⁄° * 
w‹d
, *
˝å
);

58 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/system.h

1 #i‚de‡
SNMP_SYSTEM_H


2 
	#SNMP_SYSTEM_H


	)

4 #i‚de‡
NET_SNMP_CONFIG_H


8 #ifde‡
__˝lu•lus


50 
NETSNMP_IMPORT


51 
√t¢mp_d´m⁄ize
(
quô_immedüãly
, 
°dîr_log
);

60 #i‚de‡
MSVC_PERL


62 #i‚de‡
HAVE_READDIR


66 
	sdúe˘
 {

67 
d_öo
;

68 
d_«mÀn
;

69 
d_«me
[257];

70 } 
	t_DIRECT
;

75 
	s_dú_°ruc
 {

76 *
°¨t
;

77 *
cuº
;

78 
size
;

79 
nfûes
;

80 
dúe˘
 
dú°r
;

81 } 
	tDIR
;

83 
NETSNMP_IMPORT


84 
DIR
 *
›ídú
(c⁄° *
fûíame
);

85 
NETSNMP_IMPORT


86 
dúe˘
 *
ªaddú
(
DIR
 * 
dúp
);

87 
NETSNMP_IMPORT


88 
˛o£dú
(
DIR
 * 
dúp
);

91 #i‚de‡
HAVE_GETTIMEOFDAY


92 
NETSNMP_IMPORT


93 
gëtimeofday
(
timevÆ
 *, 
timez⁄e
 *
tz
);

105 #i‡!
deföed
(
HAVE_STRNCASECMP
Ë&& !deföed(
°rˇ£cmp
)

106 
NETSNMP_IMPORT


107 
°rˇ£cmp
(c⁄° *
s1
, c⁄° *
s2
);

109 #i‡!
deföed
(
HAVE_STRNCASECMP
Ë&& !deföed(
°∫ˇ£cmp
)

110 
NETSNMP_IMPORT


111 
°∫ˇ£cmp
(c⁄° *
s1
, c⁄° *
s2
, 
size_t
 
n
);

114 #ifde‡
WIN32


115 
NETSNMP_IMPORT


116 *
wösock_°¨tup
();

117 
NETSNMP_IMPORT


118 
wösock_˛ónup
();

119 
	#SOCK_STARTUP
 
	`wösock_°¨tup
()

	)

120 
	#SOCK_CLEANUP
 
	`wösock_˛ónup
()

	)

122 
	#SOCK_STARTUP


	)

123 
	#SOCK_CLEANUP


	)

126 
	~<√t-¢mp/ty≥s.h
>

130 
NETSNMP_IMPORT


131 
√t¢mp_gëho°by«me_v4
(c⁄° * 
«me
,

132 
ö_addr_t
 *
addr_out
);

135 
addröfo
;

136 
NETSNMP_IMPORT


137 
ho°ít
 *
√t¢mp_gëho°by«me
(c⁄° *
«me
);

139 
NETSNMP_IMPORT


140 
ho°ít
 *
√t¢mp_gëho°byaddr
(c⁄° *
addr
, 
sockÀn_t
 
Àn
,

141 
ty≥
);

143 
NETSNMP_IMPORT


144 
√t¢mp_gëaddröfo
(c⁄° *
«me
, c⁄° *
£rvi˚
,

145 c⁄° 
addröfo
 *
höts
,

146 
addröfo
 **
ªs
);

148 
NETSNMP_IMPORT


149 
ö_addr_t
 
gë_myaddr
();

150 
NETSNMP_IMPORT


151 
gë_u±ime
();

153 #i‚de‡
HAVE_STRDUP


154 *
°rdup
(const *);

156 #i‚de‡
HAVE_SETENV


157 
NETSNMP_IMPORT


158 
£ãnv
(const *, const *, );

161 
NETSNMP_IMPORT


162 
ˇlcuœã_time_diff
(c⁄° 
timevÆ
 *,

163 c⁄° 
timevÆ
 *);

164 
NETSNMP_IMPORT


165 
u_öt
 
ˇlcuœã_£˘ime_diff
(c⁄° 
timevÆ
 *
now
,

166 c⁄° 
timevÆ
 *
thí
);

168 #i‚de‡
HAVE_STRCASESTR


169 *
°rˇ£°r
(const *, const *);

171 #i‚de‡
HAVE_STRTOL


172 
°πﬁ
(const *, **, );

174 #i‚de‡
HAVE_STRTOUL


175 
°πoul
(const *, **, );

177 #i‚de‡
HAVE_STRTOULL


178 
NETSNMP_IMPORT
 
uöt64_t
 
°πouŒ
(const *, **, );

180 #i‚de‡
HAVE_STRTOK_R


181 
NETSNMP_IMPORT


182 *
°πok_r
(*, const *, **);

184 #i‚de‡
HAVE_SNPRINTF


185 
¢¥ötf
(*, 
size_t
, const *, ...);

188 
NETSNMP_IMPORT


189 
mkdúhõr
(c⁄° *
∑th«me
, 
mode_t
 
mode
,

190 
skùœ°
);

191 
NETSNMP_IMPORT


192 c⁄° *
√t¢mp_mkãmp
();

193 #i‚de‡
HAVE_STRLCPY


194 
NETSNMP_IMPORT


195 
size_t
 
°æ˝y
(*, const *, size_t);

197 #i‚de‡
HAVE_STRLCAT


198 
NETSNMP_IMPORT


199 
size_t
 
°æˇt
(* 
__ª°ri˘
, const * __restrict,

200 
size_t
);

203 
√t¢mp_os_¥em©ch
(c⁄° *
o•m«me
,

204 c⁄° *
o•mªÕªfix
);

205 
√t¢mp_os_kî√l_width
();

207 
NETSNMP_IMPORT


208 
√t¢mp_°r_to_uid
(c⁄° *
u£r‹uid
);

209 
NETSNMP_IMPORT


210 
√t¢mp_°r_to_gid
(c⁄° *
group‹gid
);

212 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/tools.h

8 #i‚de‡
_TOOLS_H


9 
	#_TOOLS_H


	)

11 #ifde‡
HAVE_INTTYPES_H


12 
	~<öây≥s.h
>

15 #ifde‡
__˝lu•lus


24 #ifde‡
WIN32


25 
	#SNMP_MAXPATH
 
MAX_PATH


	)

27 #ifde‡
PATH_MAX


28 
	#SNMP_MAXPATH
 
PATH_MAX


	)

30 #ifde‡
MAXPATHLEN


31 
	#SNMP_MAXPATH
 
MAXPATHLEN


	)

33 
	#SNMP_MAXPATH
 1024

	)

38 
	#SNMP_MAXBUF
 (1024 * 4)

	)

39 
	#SNMP_MAXBUF_MEDIUM
 1024

	)

40 
	#SNMP_MAXBUF_SMALL
 512

	)

42 
	#SNMP_MAXBUF_MESSAGE
 1500

	)

44 
	#SNMP_MAXOID
 64

	)

45 
	#SNMP_MAX_CMDLINE_OIDS
 128

	)

47 
	#SNMP_FILEMODE_CLOSED
 0600

	)

48 
	#SNMP_FILEMODE_OPEN
 0644

	)

50 
	#BYTESIZE
(
bôsize
Ë((bôsizê+ 7Ë>> 3)

	)

51 
	#ROUNDUP8
(
x
Ë––(x+7Ë>> 3 ) * 8 )

	)

53 
	#SNMP_STRORNULL
(
x
Ë–x ? x : "“uŒ)")

	)

57 
	#SNMP_FREE
(
s
Ëdÿ{ i‡(sË{ 
	`‰ì
((*)s); s=
NULL
; } } 0)

	)

61 
	#SNMP_SWIPE_MEM
(
n
,
s
Ëdÿ{ i‡“Ë
	`‰ì
((*Í);Ç = s; s=
NULL
; } 0)

	)

68 
	#SNMP_MALLOC_STRUCT
(
s
Ë(†*Ë
	`ˇŒoc
(1, (s))

	)

72 
	#SNMP_MALLOC_TYPEDEF
(
td
Ë—d *Ë
	`ˇŒoc
(1, —d))

	)

76 
	#SNMP_ZERO
(
s
,
l
Ëdÿ{ i‡(sË
	`mem£t
(s, 0,Ü); } 0)

	)

88 #i‡
deföed
(
__GNUC__
)

89 
	#NETSNMP_REMOVE_CONST
(
t
, 
e
) \

90 (
	`__exãnsi⁄__
 ({ c⁄° 
t
 
tmp
 = (
e
); (t)(
uöçå_t
Èmp; }))

	)

92 
	#NETSNMP_REMOVE_CONST
(
t
, 
e
Ë(—)(
uöçå_t
)”))

	)

96 
	#TOUPPER
(
c
Ë(¯>'a' && c <'z' ? c - ('a' - 'A'Ë: c)

	)

97 
	#TOLOWER
(
c
Ë(¯>'A' && c <'Z' ? c + ('a' - 'A'Ë: c)

	)

99 
	#HEX2VAL
(
s
) \

100 ((
	`ißÕha
(
s
Ë? (
	`TOLOWER
(s)-'a'+10Ë: (TOLOWER(s)-'0')Ë& 0xf)

	)

101 
	#VAL2HEX
(
s
Ë–(sË+ (((sË>10Ë? ('a'-10Ë: '0'Ë)

	)

106 
	#SNMP_MAX
(
a
,
b
Ë(◊Ë> (bË? (aË: (b))

	)

110 
	#SNMP_MIN
(
a
,
b
Ë(◊Ë> (bË? (bË: (a))

	)

120 
	#SNMP_MACRO_VAL_TO_STR
(
s
Ë
	`SNMP_MACRO_VAL_TO_STR_PRIV
(s)

	)

121 
	#SNMP_MACRO_VAL_TO_STR_PRIV
(
s
Ë#s

	)

123 #i‚de‡
FALSE


124 
	#FALSE
 0

	)

126 #i‚de‡
TRUE


127 
	#TRUE
 1

	)

139 
	#QUITFUN
(
e
, 
l
) \

140 i‡–(
e
Ë!
SNMPERR_SUCCESS
) { \

141 
rvÆ
 = 
SNMPERR_GENERR
; \

142 
l
 ; \

143 }

	)

152 
	#DIFFTIMEVAL
(
now
, 
thí
, 
diff
) \

154 
now
.
tv_£c
--; \

155 
now
.
tv_u£c
 += 1000000L; \

156 
diff
.
tv_£c
 = 
now
.tv_£¯- 
thí
.tv_sec; \

157 
diff
.
tv_u£c
 = 
now
.tv_u£¯- 
thí
.tv_usec; \

158 i‡(
diff
.
tv_u£c
 > 1000000L){ \

159 
diff
.
tv_u£c
 -= 1000000L; \

160 
diff
.
tv_£c
++; \

162 }

	)

172 
	#NETSNMP_TIMERADD
(
a
, 
b
, 
ªs
) \

174 (
ªs
)->
tv_£c
 = (
a
)->tv_£¯+ (
b
)->tv_sec; \

175 (
ªs
)->
tv_u£c
 = (
a
)->tv_u£¯+ (
b
)->tv_usec; \

176 i‡((
ªs
)->
tv_u£c
 >= 1000000L) { \

177 (
ªs
)->
tv_u£c
 -= 1000000L; \

178 (
ªs
)->
tv_£c
++; \

180 }

	)

190 
	#NETSNMP_TIMERSUB
(
a
, 
b
, 
ªs
) \

192 (
ªs
)->
tv_£c
 = (
a
)->tv_£¯- (
b
)->tv_sec - 1; \

193 (
ªs
)->
tv_u£c
 = (
a
)->tv_u£¯- (
b
)->tv_usec + 1000000L; \

194 i‡((
ªs
)->
tv_u£c
 >= 1000000L) { \

195 (
ªs
)->
tv_u£c
 -= 1000000L; \

196 (
ªs
)->
tv_£c
++; \

198 }

	)

205 
	#USM_LENGTH_OID_TRANSFORM
 10

	)

207 
	#ISTRANSFORM
(
ây≥
, 
toid
) \

208 !
	`¢mp_oid_com∑ª
(
ây≥
, 
USM_LENGTH_OID_TRANSFORM
, \

209 
usm
 ## 
toid
 ## 
PrŸocﬁ
, 
USM_LENGTH_OID_TRANSFORM
)

	)

211 
	#ENGINETIME_MAX
 2147483647

	)

212 
	#ENGINEBOOT_MAX
 2147483647

	)

221 
NETSNMP_IMPORT


222 
¢mp_ªÆloc
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
);

224 
‰ì_zîo
(*
buf
, 
size_t
 
size
);

226 
u_ch¨
 *
mÆloc_øndom
(
size_t
 * 
size
);

227 
u_ch¨
 *
mÆloc_zîo
(
size_t
 
size
);

228 
NETSNMP_IMPORT


229 
memdup
(
u_ch¨
 ** 
to
, c⁄° * 
‰om
, 
size_t
 
size
);

231 
√t¢mp_check_deföed√ss
(c⁄° *
∑ckë
,

232 
size_t
 
Àngth
);

234 
NETSNMP_IMPORT


235 
u_öt
 
√t¢mp_bö¨y_to_hex
(
u_ch¨
 ** 
de°
, 
size_t
 *
de°_Àn
,

236 
Ælow_ªÆloc
,

237 c⁄° 
u_ch¨
 * 
öput
, 
size_t
 
Àn
);

239 
NETSNMP_IMPORT


240 
u_öt
 
bö¨y_to_hex
(c⁄° 
u_ch¨
 * 
öput
, 
size_t
 
Àn
,

241 **
ouçut
);

243 
√t¢mp_hex_to_bö¨y
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

244 
size_t
 * 
off£t
, 
Ælow_ªÆloc
,

245 c⁄° *
hex
, c⁄° *
dñim
);

247 
NETSNMP_IMPORT


248 
¢mp_hex_to_bö¨y
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

249 
size_t
 * 
off£t
, 
Ælow_ªÆloc
,

250 c⁄° *
hex
);

252 
NETSNMP_IMPORT


253 
hex_to_bö¨y2
(c⁄° 
u_ch¨
 * 
öput
, 
size_t
 
Àn
,

254 **
ouçut
);

256 
NETSNMP_IMPORT


257 
¢mp_decimÆ_to_bö¨y
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

258 
size_t
 * 
out_Àn
,

259 
Ælow_ªÆloc
,

260 c⁄° *
decimÆ
);

261 
	#¢mp_c°rˇt
(
b
,
l
,
o
,
a
,
s
Ë
	`¢mp_°rˇt
(b,l,o,a,(c⁄° 
u_ch¨
 *)s)

	)

262 
NETSNMP_IMPORT


263 
¢mp_°rˇt
(
u_ch¨
 ** 
buf
, 
size_t
 * 
buf_Àn
,

264 
size_t
 * 
out_Àn
, 
Ælow_ªÆloc
,

265 c⁄° 
u_ch¨
 * 
s
);

266 
NETSNMP_IMPORT


267 *
√t¢mp_°rdup_™d_nuŒ
(c⁄° 
u_ch¨
 * 
‰om
,

268 
size_t
 
‰om_Àn
);

270 
NETSNMP_IMPORT


271 
dump_chunk
(c⁄° *
debugtokí
, c⁄° *
tôÀ
,

272 c⁄° 
u_ch¨
 * 
buf
, 
size
);

273 *
dump_¢mpEngöeID
(c⁄° 
u_ch¨
 * 
buf
, 
size_t
 * 
buÊí
);

276 *
	tm¨kî_t
;

277 c⁄° * 
	tc⁄°_m¨kî_t
;

279 
NETSNMP_IMPORT


280 
m¨kî_t
 
©ime_√wM¨kî
();

281 
NETSNMP_IMPORT


282 
©ime_£tM¨kî
(
m¨kî_t
 
pm
);

283 
NETSNMP_IMPORT


284 
√t¢mp_gë_m⁄Ÿ⁄ic_˛ock
(
timevÆ
* 
tv
);

285 
NETSNMP_IMPORT


286 
√t¢mp_£t_m⁄Ÿ⁄ic_m¨kî
(
m¨kî_t
 *
pm
);

287 
NETSNMP_IMPORT


288 
©ime_diff
(
c⁄°_m¨kî_t
 
fú°
, c⁄°_m¨kî_à
£c⁄d
);

289 
u_l⁄g
 
u©ime_diff
(
c⁄°_m¨kî_t
 
fú°
, c⁄°_m¨kî_à
£c⁄d
);

290 
NETSNMP_IMPORT


291 
u_l⁄g
 
u©ime_hdiff
(
c⁄°_m¨kî_t
 
fú°
, c⁄°_m¨kî_à
£c⁄d
);

292 
NETSNMP_IMPORT


293 
©ime_ªady
(
c⁄°_m¨kî_t
 
pm
, 
dñè_ms
);

294 
NETSNMP_IMPORT


295 
√t¢mp_ªady_m⁄Ÿ⁄ic
(
c⁄°_m¨kî_t
 
pm
, 
dñè_ms
);

296 
u©ime_ªady
(
c⁄°_m¨kî_t
 
pm
, 
dñè_ms
);

298 
m¨kî_âicks
(
c⁄°_m¨kî_t
 
pm
);

299 
timevÆ_âicks
(c⁄° 
timevÆ
 *
tv
);

300 
NETSNMP_IMPORT


301 *
√t¢mp_gëív
(c⁄° *
«me
);

302 
NETSNMP_IMPORT


303 
√t¢mp_£ãnv
(c⁄° *
ív«me
, c⁄° *
ívvÆ
,

304 
ovîwrôe
);

306 
√t¢mp_addr°r_ht⁄
(*
±r
, 
size_t
 
Àn
);

308 
NETSNMP_IMPORT


309 
√t¢mp_°rög_time_to_£cs
(c⁄° *
time_°rög
);

311 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/transform_oids.h

1 #i‚de‡
_√t_¢mp_å™sf‹m_oids_h


2 
	#_√t_¢mp_å™sf‹m_oids_h


	)

4 #ifde‡
__˝lu•lus


13 
NETSNMP_IMPORT
 
oid
 
usmNoAuthPrŸocﬁ
[10];

14 #i‚de‡
NETSNMP_DISABLE_MD5


15 
NETSNMP_IMPORT
 
oid
 
usmHMACMD5AuthPrŸocﬁ
[10];

17 
NETSNMP_IMPORT
 
oid
 
usmHMACSHA1AuthPrŸocﬁ
[10];

18 
NETSNMP_IMPORT
 
oid
 
usmNoPrivPrŸocﬁ
[10];

19 #i‚de‡
NETSNMP_DISABLE_DES


20 
NETSNMP_IMPORT
 
oid
 
usmDESPrivPrŸocﬁ
[10];

24 
NETSNMP_IMPORT
 
oid
 
usmAESPrivPrŸocﬁ
[10];

25 
NETSNMP_IMPORT
 
oid
 *
usmAES128PrivPrŸocﬁ
;

27 
	#USM_AUTH_PROTO_NOAUTH_LEN
 10

	)

28 
	#USM_AUTH_PROTO_MD5_LEN
 10

	)

29 
	#USM_AUTH_PROTO_SHA_LEN
 10

	)

30 
	#USM_PRIV_PROTO_NOPRIV_LEN
 10

	)

31 
	#USM_PRIV_PROTO_DES_LEN
 10

	)

33 
	#USM_PRIV_PROTO_AES_LEN
 10

	)

34 
	#USM_PRIV_PROTO_AES128_LEN
 10

	)

36 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/types.h

1 #i‚de‡
NET_SNMP_LIBRARY_TYPES_H


2 
	#NET_SNMP_LIBRARY_TYPES_H


	)

4 #i‚de‡
NET_SNMP_CONFIG_H


9 
	~<√t-¢mp/ty≥s.h
>

12 
	s√t¢mp_ödex_s
 {

13 
size_t
 
	mÀn
;

14 
oid
 *
	moids
;

15 } 
	t√t¢mp_ödex
;

17 
	s√t¢mp_void_¨øy_s
 {

18 
size_t
 
	msize
;

19 **
	m¨øy
;

20 } 
	t√t¢mp_void_¨øy
;

25 
	s√t¢mp_ªf_void
 {

26 *
	mvÆ
;

27 } 
	t√t¢mp_ªf_void
;

30 
u_l⁄g
 
	mul
;

31 
u_öt
 
	mui
;

32 
u_sh‹t
 
	mus
;

33 
u_ch¨
 
	muc
;

34 
	m¶
;

35 
	msi
;

36 
	mss
;

37 
	msc
;

38 *
	m˝
;

39 *
	mvp
;

40 } 
	t√t¢mp_cvÆue
;

42 
	s√t¢mp_ªf_size_t_s
 {

43 
size_t
 
	mvÆ
;

44 } *
	t√t¢mp_ªf_size_t
;

65 
	s√t¢mp_œrge_fd_£t_s
 {

66 
	mlfs_£tsize
;

67 
fd_£t
 *
	mlfs_£çå
;

68 
fd_£t
 
	mlfs_£t
;

69 } 
	t√t¢mp_œrge_fd_£t
;

	@/usr/include/net-snmp/library/ucd_compat.h

6 #i‚de‡
NET_SNMP_UCD_COMPAT_H


7 
	#NET_SNMP_UCD_COMPAT_H


	)

9 #ifde‡
__˝lu•lus


16 
NETSNMP_IMPORT


17 
¢mp_£t_dump_∑ckë
();

18 
NETSNMP_IMPORT


19 
¢mp_gë_dump_∑ckë
();

20 
NETSNMP_IMPORT


21 
¢mp_£t_quick_¥öt
();

22 
NETSNMP_IMPORT


23 
¢mp_gë_quick_¥öt
();

24 
NETSNMP_IMPORT


25 
¢mp_£t_suffix_⁄ly
();

26 
NETSNMP_IMPORT


27 
¢mp_gë_suffix_⁄ly
();

28 
NETSNMP_IMPORT


29 
¢mp_£t_fuŒ_objid
();

30 
¢mp_gë_fuŒ_objid
();

31 
NETSNMP_IMPORT


32 
¢mp_£t_øndom_ac˚ss
();

33 
NETSNMP_IMPORT


34 
¢mp_gë_øndom_ac˚ss
();

39 
NETSNMP_IMPORT


40 
¢mp_£t_mib_w¨nögs
();

41 
NETSNMP_IMPORT


42 
¢mp_£t_mib_îr‹s
();

43 
NETSNMP_IMPORT


44 
¢mp_£t_ßve_des¸ùti⁄s
();

45 
¢mp_£t_mib_commít_ãrm
();

46 
¢mp_£t_mib_∑r£_œbñ
();

48 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/vacm.h

7 #i‚de‡
VACM_H


8 
	#VACM_H


	)

10 #ifde‡
__˝lu•lus


14 
	#VACM_SUCCESS
 0

	)

15 
	#VACM_NOSECNAME
 1

	)

16 
	#VACM_NOGROUP
 2

	)

17 
	#VACM_NOACCESS
 3

	)

18 
	#VACM_NOVIEW
 4

	)

19 
	#VACM_NOTINVIEW
 5

	)

20 
	#VACM_NOSUCHCONTEXT
 6

	)

21 
	#VACM_SUBTREE_UNKNOWN
 7

	)

23 
	#SECURITYMODEL
 1

	)

24 
	#SECURITYNAME
 2

	)

25 
	#SECURITYGROUP
 3

	)

26 
	#SECURITYSTORAGE
 4

	)

27 
	#SECURITYSTATUS
 5

	)

29 
	#ACCESSPREFIX
 1

	)

30 
	#ACCESSMODEL
 2

	)

31 
	#ACCESSLEVEL
 3

	)

32 
	#ACCESSMATCH
 4

	)

33 
	#ACCESSREAD
 5

	)

34 
	#ACCESSWRITE
 6

	)

35 
	#ACCESSNOTIFY
 7

	)

36 
	#ACCESSSTORAGE
 8

	)

37 
	#ACCESSSTATUS
 9

	)

39 
	#VACMVIEWSPINLOCK
 1

	)

40 
	#VIEWNAME
 2

	)

41 
	#VIEWSUBTREE
 3

	)

42 
	#VIEWMASK
 4

	)

43 
	#VIEWTYPE
 5

	)

44 
	#VIEWSTORAGE
 6

	)

45 
	#VIEWSTATUS
 7

	)

47 
	#VACM_MAX_STRING
 32

	)

48 
	#VACMSTRINGLEN
 34

	)

50 
	svacm_groupE¡ry
 {

51 
£curôyModñ
;

52 
£curôyName
[
VACMSTRINGLEN
];

53 
groupName
[
VACMSTRINGLEN
];

54 
°‹ageTy≥
;

55 
°©us
;

57 
u_l⁄g
 
bôMask
;

58 
vacm_groupE¡ry
 *
ª£rved
;

59 
vacm_groupE¡ry
 *
√xt
;

62 
	#CONTEXT_MATCH_EXACT
 1

	)

63 
	#CONTEXT_MATCH_PREFIX
 2

	)

68 
	#VACM_VIEW_READ
 0

	)

69 
	#VACM_VIEW_WRITE
 1

	)

70 
	#VACM_VIEW_NOTIFY
 2

	)

73 
	#VACM_VIEW_LOG
 3

	)

74 
	#VACM_VIEW_EXECUTE
 4

	)

75 
	#VACM_VIEW_NET
 5

	)

80 
	#VACM_VIEW_READ_BIT
 (1 << 
VACM_VIEW_READ
)

	)

81 
	#VACM_VIEW_WRITE_BIT
 (1 << 
VACM_VIEW_WRITE
)

	)

82 
	#VACM_VIEW_NOTIFY_BIT
 (1 << 
VACM_VIEW_NOTIFY
)

	)

85 
	#VACM_VIEW_LOG_BIT
 (1 << 
VACM_VIEW_LOG
)

	)

86 
	#VACM_VIEW_EXECUTE_BIT
 (1 << 
VACM_VIEW_EXECUTE
)

	)

87 
	#VACM_VIEW_NET_BIT
 (1 << 
VACM_VIEW_NET
)

	)

89 
	#VACM_VIEW_NO_BITS
 0

	)

92 
	#VACM_MAX_VIEWS
 8

	)

94 
	#VACM_VIEW_ENUM_NAME
 "vacmvõws"

	)

96 
öô_vacm
();

98 
	svacm_ac˚ssE¡ry
 {

99 
groupName
[
VACMSTRINGLEN
];

100 
c⁄ãxtPªfix
[
VACMSTRINGLEN
];

101 
£curôyModñ
;

102 
£curôyLevñ
;

103 
c⁄ãxtM©ch
;

104 
võws
[
VACM_MAX_VIEWS
][
VACMSTRINGLEN
];

105 
°‹ageTy≥
;

106 
°©us
;

108 
u_l⁄g
 
bôMask
;

109 
vacm_ac˚ssE¡ry
 *
ª£rved
;

110 
vacm_ac˚ssE¡ry
 *
√xt
;

113 
	svacm_võwE¡ry
 {

114 
võwName
[
VACMSTRINGLEN
];

115 
oid
 
võwSubåì
[
MAX_OID_LEN
];

116 
size_t
 
võwSubåìLí
;

117 
u_ch¨
 
võwMask
[
VACMSTRINGLEN
];

118 
size_t
 
võwMaskLí
;

119 
võwTy≥
;

120 
võwSt‹ageTy≥
;

121 
võwSètus
;

123 
u_l⁄g
 
bôMask
;

125 
vacm_võwE¡ry
 *
ª£rved
;

126 
vacm_võwE¡ry
 *
√xt
;

129 
NETSNMP_IMPORT


130 
vacm_de°royVõwE¡ry
(c⁄° *, 
oid
 *, 
size_t
);

131 
NETSNMP_IMPORT


132 
vacm_de°royAŒVõwE¡rõs
();

134 
	#VACM_MODE_FIND
 0

	)

135 
	#VACM_MODE_IGNORE_MASK
 1

	)

136 
	#VACM_MODE_CHECK_SUBTREE
 2

	)

137 
NETSNMP_IMPORT


138 
vacm_võwE¡ry
 *
vacm_gëVõwE¡ry
(c⁄° *, 
oid
 *, 
size_t
,

146 
NETSNMP_IMPORT


147 
vacm_checkSubåì
(c⁄° *, 
oid
 *, 
size_t
);

162 
NETSNMP_IMPORT


164 
vacm_sˇnVõwInô
();

172 
NETSNMP_IMPORT


173 
vacm_võwE¡ry
 *
vacm_sˇnVõwNext
();

183 
NETSNMP_IMPORT


184 
vacm_võwE¡ry
 *
vacm_¸óãVõwE¡ry
(c⁄° *, 
oid
 *,

185 
size_t
);

192 
NETSNMP_IMPORT


193 
vacm_de°royGroupE¡ry
(, const *);

194 
NETSNMP_IMPORT


195 
vacm_de°royAŒGroupE¡rõs
();

196 
NETSNMP_IMPORT


197 
vacm_groupE¡ry
 *
vacm_¸óãGroupE¡ry
(, const *);

198 
NETSNMP_IMPORT


199 
vacm_groupE¡ry
 *
vacm_gëGroupE¡ry
(, const *);

200 
NETSNMP_IMPORT


201 
vacm_sˇnGroupInô
();

202 
NETSNMP_IMPORT


203 
vacm_groupE¡ry
 *
vacm_sˇnGroupNext
();

205 
NETSNMP_IMPORT


206 
vacm_de°royAc˚ssE¡ry
(const *, const *,

208 
NETSNMP_IMPORT


209 
vacm_de°royAŒAc˚ssE¡rõs
();

210 
NETSNMP_IMPORT


211 
vacm_ac˚ssE¡ry
 *
vacm_¸óãAc˚ssE¡ry
(const *,

214 
NETSNMP_IMPORT


215 
vacm_ac˚ssE¡ry
 *
vacm_gëAc˚ssE¡ry
(const *,

217 
NETSNMP_IMPORT


218 
vacm_sˇnAc˚ssInô
();

219 
NETSNMP_IMPORT


220 
vacm_ac˚ssE¡ry
 *
vacm_sˇnAc˚ssNext
();

222 
vacm_de°roySecurôyE¡ry
(const *);

223 
vacm_£curôyE¡ry
 *
vacm_¸óãSecurôyE¡ry
(const *);

224 
vacm_£curôyE¡ry
 *
vacm_gëSecurôyE¡ry
(const *);

225 
vacm_sˇnSecurôyInô
();

226 
vacm_£curôyE¡ry
 *
vacm_sˇnSecurôyE¡ry
();

227 
NETSNMP_IMPORT


228 
vacm_is_c⁄figuªd
();

230 
vacm_ßve
(c⁄° *
tokí
, c⁄° *
ty≥
);

231 
vacm_ßve_võw
(
vacm_võwE¡ry
 *
võw
,

232 c⁄° *
tokí
, c⁄° *
ty≥
);

233 
vacm_ßve_ac˚ss
(
vacm_ac˚ssE¡ry
 *
ac˚ss_íåy
,

234 c⁄° *
tokí
, c⁄° *
ty≥
);

235 
vacm_ßve_auth_ac˚ss
(
vacm_ac˚ssE¡ry
 *
ac˚ss_íåy
,

236 c⁄° *
tokí
, c⁄° *
ty≥
, 
authty≥
);

237 
vacm_ßve_group
(
vacm_groupE¡ry
 *
group_íåy
,

238 c⁄° *
tokí
, c⁄° *
ty≥
);

240 
NETSNMP_IMPORT


241 
vacm_∑r£_c⁄fig_võw
(c⁄° *
tokí
, c⁄° *
löe
);

242 
NETSNMP_IMPORT


243 
vacm_∑r£_c⁄fig_group
(c⁄° *
tokí
,

244 c⁄° *
löe
);

245 
NETSNMP_IMPORT


246 
vacm_∑r£_c⁄fig_ac˚ss
(c⁄° *
tokí
,

247 c⁄° *
löe
);

248 
NETSNMP_IMPORT


249 
vacm_∑r£_c⁄fig_auth_ac˚ss
(c⁄° *
tokí
,

250 c⁄° *
löe
);

252 
NETSNMP_IMPORT


253 
°‹e_vacm
(
maj‹ID
, 
mö‹ID
, *
£rvî¨g
,

254 *
˛õ¡¨g
);

256 
NETSNMP_IMPORT


257 
vacm_võwE¡ry
 *
√t¢mp_võw_gë
(vacm_võwE¡ry *
hód
,

258 c⁄° *
võwName
,

259 
oid
 * 
võwSubåì
,

260 
size_t
 
võwSubåìLí
, 
mode
);

263 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/version.h

1 #i‚de‡
NET_SNMP_VERSION_H


2 
	#NET_SNMP_VERSION_H


	)

4 #ifde‡
__˝lu•lus


8 #ifde‡
UCD_COMPATIBLE


9 c⁄° *
NëSnmpVîsi⁄Info
;

12 
NETSNMP_IMPORT


13 c⁄° *
√t¢mp_gë_vîsi⁄
();

15 #ifde‡
__˝lu•lus


	@/usr/include/readline/chardefs.h

22 #i‚de‡
_CHARDEFS_H_


23 
	#_CHARDEFS_H_


	)

25 
	~<˘y≥.h
>

27 #i‡
deföed
 (
HAVE_CONFIG_H
)

28 #i‡
deföed
 (
HAVE_STRING_H
)

29 #i‡! 
deföed
 (
STDC_HEADERS
Ë&& deföed (
HAVE_MEMORY_H
)

30 
	~<mem‹y.h
>

32 
	~<°rög.h
>

34 #i‡
deföed
 (
HAVE_STRINGS_H
)

35 
	~<°rögs.h
>

38 
	~<°rög.h
>

41 #i‚de‡
whôe•a˚


42 
	#whôe•a˚
(
c
Ë(((cË=' 'Ë|| ((cË='\t'))

	)

45 #ifde‡
CTRL


46 #unde‡
CTRL


48 #ifde‡
UNCTRL


49 #unde‡
UNCTRL


53 
	#c⁄åﬁ_ch¨a˘î_thªshﬁd
 0x020

	)

54 
	#c⁄åﬁ_ch¨a˘î_mask
 0x1‡

	)

55 
	#mëa_ch¨a˘î_thªshﬁd
 0x07‡

	)

56 
	#c⁄åﬁ_ch¨a˘î_bô
 0x40

	)

57 
	#mëa_ch¨a˘î_bô
 0x080

	)

58 
	#œrge°_ch¨
 255

	)

60 
	#CTRL_CHAR
(
c
Ë((cË< 
c⁄åﬁ_ch¨a˘î_thªshﬁd
 && (((cË& 0x80Ë=0))

	)

61 
	#META_CHAR
(
c
Ë((cË> 
mëa_ch¨a˘î_thªshﬁd
 && (cË<
œrge°_ch¨
)

	)

63 
	#CTRL
(
c
Ë((cË& 
c⁄åﬁ_ch¨a˘î_mask
)

	)

64 
	#META
(
c
Ë((cË| 
mëa_ch¨a˘î_bô
)

	)

66 
	#UNMETA
(
c
Ë((cË& (~
mëa_ch¨a˘î_bô
))

	)

67 
	#UNCTRL
(
c
Ë
	`_æ_to_uµî
(((c)|
c⁄åﬁ_ch¨a˘î_bô
))

	)

69 #i‡
deföed
 
STDC_HEADERS
 || (!deföed (
ißscii
Ë&& !deföed (
HAVE_ISASCII
))

70 
	#IN_CTYPE_DOMAIN
(
c
Ë1

	)

72 
	#IN_CTYPE_DOMAIN
(
c
Ë
	`ißscii
(c)

	)

75 #i‡!
deföed
 (
isxdigô
Ë&& !deföed (
HAVE_ISXDIGIT
Ë&& !deföed (
__˝lu•lus
)

76 
	#isxdigô
(
c
Ë(
	`isdigô
((c)Ë|| ((cË>'a' && (cË<'f'Ë|| ((cË>'A' && (cË<'F'))

	)

79 #i‡
deföed
 (
CTYPE_NON_ASCII
)

80 
	#NON_NEGATIVE
(
c
Ë1

	)

82 
	#NON_NEGATIVE
(
c
Ë(()(cË=(c))

	)

86 #unde‡
ISPRINT


90 
	#ISALNUM
(
c
Ë(
	`IN_CTYPE_DOMAIN
 (cË&& 
	`iß um
 (c))

	)

91 
	#ISALPHA
(
c
Ë(
	`IN_CTYPE_DOMAIN
 (cË&& 
	`ißÕha
 (c))

	)

92 
	#ISDIGIT
(
c
Ë(
	`IN_CTYPE_DOMAIN
 (cË&& 
	`isdigô
 (c))

	)

93 
	#ISLOWER
(
c
Ë(
	`IN_CTYPE_DOMAIN
 (cË&& 
	`i¶owî
 (c))

	)

94 
	#ISPRINT
(
c
Ë(
	`IN_CTYPE_DOMAIN
 (cË&& 
	`i•röt
 (c))

	)

95 
	#ISUPPER
(
c
Ë(
	`IN_CTYPE_DOMAIN
 (cË&& 
	`isuµî
 (c))

	)

96 
	#ISXDIGIT
(
c
Ë(
	`IN_CTYPE_DOMAIN
 (cË&& 
	`isxdigô
 (c))

	)

98 
	#_æ_lowîˇ£_p
(
c
Ë(
	`NON_NEGATIVE
(cË&& 
	`ISLOWER
(c))

	)

99 
	#_æ_uµîˇ£_p
(
c
Ë(
	`NON_NEGATIVE
(cË&& 
	`ISUPPER
(c))

	)

100 
	#_æ_digô_p
(
c
Ë((cË>'0' && (cË<'9')

	)

102 
	#_æ_puª_Æphabëic
(
c
Ë(
	`NON_NEGATIVE
(cË&& 
	`ISALPHA
(c))

	)

103 
	#ALPHABETIC
(
c
Ë(
	`NON_NEGATIVE
(cË&& 
	`ISALNUM
(c))

	)

105 #i‚de‡
_æ_to_uµî


106 
	#_æ_to_uµî
(
c
Ë(
	`_æ_lowîˇ£_p
(cË? 
	`touµî
(()cË: (c))

	)

107 
	#_æ_to_lowî
(
c
Ë(
	`_æ_uµîˇ£_p
(cË? 
	`tﬁowî
(()cË: (c))

	)

110 #i‚de‡
_æ_digô_vÆue


111 
	#_æ_digô_vÆue
(
x
Ë((xË- '0')

	)

114 #i‚de‡
_æ_isidít


115 
	#_æ_isidít
(
c
Ë(
	`ISALNUM
(cË|| (cË='_')

	)

118 #i‚de‡
ISOCTAL


119 
	#ISOCTAL
(
c
Ë((cË>'0' && (cË<'7')

	)

121 
	#OCTVALUE
(
c
Ë((cË- '0')

	)

123 
	#HEXVALUE
(
c
) \

124 (((
c
) >= 'a' && (c) <= 'f') \

125 ? (
c
)-'a'+10 \

126 : (
c
Ë>'A' && (cË<'F' ? (c)-'A'+10 : (c)-'0')

	)

128 #i‚de‡
NEWLINE


129 
	#NEWLINE
 '\n'

	)

132 #i‚de‡
RETURN


133 
	#RETURN
 
	`CTRL
('M')

	)

136 #i‚de‡
RUBOUT


137 
	#RUBOUT
 0x7f

	)

140 #i‚de‡
TAB


141 
	#TAB
 '\t'

	)

144 #ifde‡
ABORT_CHAR


145 #unde‡
ABORT_CHAR


147 
	#ABORT_CHAR
 
	`CTRL
('G')

	)

149 #ifde‡
PAGE


150 #unde‡
PAGE


152 
	#PAGE
 
	`CTRL
('L')

	)

154 #ifde‡
SPACE


155 #unde‡
SPACE


157 
	#SPACE
 ' '

	)

159 #ifde‡
ESC


160 #unde‡
ESC


162 
	#ESC
 
	`CTRL
('[')

	)

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

30 
	#__STDC_IEC_559__
 1

	)

31 
	#__STDC_IEC_559_COMPLEX__
 1

	)

35 
	#__STDC_ISO_10646__
 201103L

	)

38 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/asm-generic/ioctls.h

1 #i‚de‡
__ASM_GENERIC_IOCTLS_H


2 
	#__ASM_GENERIC_IOCTLS_H


	)

4 
	~<löux/io˘l.h
>

19 
	#TCGETS
 0x5401

	)

20 
	#TCSETS
 0x5402

	)

21 
	#TCSETSW
 0x5403

	)

22 
	#TCSETSF
 0x5404

	)

23 
	#TCGETA
 0x5405

	)

24 
	#TCSETA
 0x5406

	)

25 
	#TCSETAW
 0x5407

	)

26 
	#TCSETAF
 0x5408

	)

27 
	#TCSBRK
 0x5409

	)

28 
	#TCXONC
 0x540A

	)

29 
	#TCFLSH
 0x540B

	)

30 
	#TIOCEXCL
 0x540C

	)

31 
	#TIOCNXCL
 0x540D

	)

32 
	#TIOCSCTTY
 0x540E

	)

33 
	#TIOCGPGRP
 0x540F

	)

34 
	#TIOCSPGRP
 0x5410

	)

35 
	#TIOCOUTQ
 0x5411

	)

36 
	#TIOCSTI
 0x5412

	)

37 
	#TIOCGWINSZ
 0x5413

	)

38 
	#TIOCSWINSZ
 0x5414

	)

39 
	#TIOCMGET
 0x5415

	)

40 
	#TIOCMBIS
 0x5416

	)

41 
	#TIOCMBIC
 0x5417

	)

42 
	#TIOCMSET
 0x5418

	)

43 
	#TIOCGSOFTCAR
 0x5419

	)

44 
	#TIOCSSOFTCAR
 0x541A

	)

45 
	#FIONREAD
 0x541B

	)

46 
	#TIOCINQ
 
FIONREAD


	)

47 
	#TIOCLINUX
 0x541C

	)

48 
	#TIOCCONS
 0x541D

	)

49 
	#TIOCGSERIAL
 0x541E

	)

50 
	#TIOCSSERIAL
 0x541F

	)

51 
	#TIOCPKT
 0x5420

	)

52 
	#FIONBIO
 0x5421

	)

53 
	#TIOCNOTTY
 0x5422

	)

54 
	#TIOCSETD
 0x5423

	)

55 
	#TIOCGETD
 0x5424

	)

56 
	#TCSBRKP
 0x5425

	)

57 
	#TIOCSBRK
 0x5427

	)

58 
	#TIOCCBRK
 0x5428

	)

59 
	#TIOCGSID
 0x5429

	)

60 
	#TCGETS2
 
	`_IOR
('T', 0x2A, 
ãrmios2
)

	)

61 
	#TCSETS2
 
	`_IOW
('T', 0x2B, 
ãrmios2
)

	)

62 
	#TCSETSW2
 
	`_IOW
('T', 0x2C, 
ãrmios2
)

	)

63 
	#TCSETSF2
 
	`_IOW
('T', 0x2D, 
ãrmios2
)

	)

64 
	#TIOCGRS485
 0x542E

	)

65 #i‚de‡
TIOCSRS485


66 
	#TIOCSRS485
 0x542F

	)

68 
	#TIOCGPTN
 
	`_IOR
('T', 0x30, Ë

	)

69 
	#TIOCSPTLCK
 
	`_IOW
('T', 0x31, Ë

	)

70 
	#TIOCGDEV
 
	`_IOR
('T', 0x32, Ë

	)

71 
	#TCGETX
 0x5432

	)

72 
	#TCSETX
 0x5433

	)

73 
	#TCSETXF
 0x5434

	)

74 
	#TCSETXW
 0x5435

	)

75 
	#TIOCSIG
 
	`_IOW
('T', 0x36, Ë

	)

76 
	#TIOCVHANGUP
 0x5437

	)

77 
	#TIOCGPKT
 
	`_IOR
('T', 0x38, Ë

	)

78 
	#TIOCGPTLCK
 
	`_IOR
('T', 0x39, Ë

	)

79 
	#TIOCGEXCL
 
	`_IOR
('T', 0x40, Ë

	)

81 
	#FIONCLEX
 0x5450

	)

82 
	#FIOCLEX
 0x5451

	)

83 
	#FIOASYNC
 0x5452

	)

84 
	#TIOCSERCONFIG
 0x5453

	)

85 
	#TIOCSERGWILD
 0x5454

	)

86 
	#TIOCSERSWILD
 0x5455

	)

87 
	#TIOCGLCKTRMIOS
 0x5456

	)

88 
	#TIOCSLCKTRMIOS
 0x5457

	)

89 
	#TIOCSERGSTRUCT
 0x5458

	)

90 
	#TIOCSERGETLSR
 0x5459

	)

91 
	#TIOCSERGETMULTI
 0x545A

	)

92 
	#TIOCSERSETMULTI
 0x545B

	)

94 
	#TIOCMIWAIT
 0x545C

	)

95 
	#TIOCGICOUNT
 0x545D

	)

101 #i‚de‡
FIOQSIZE


102 
	#FIOQSIZE
 0x5460

	)

106 
	#TIOCPKT_DATA
 0

	)

107 
	#TIOCPKT_FLUSHREAD
 1

	)

108 
	#TIOCPKT_FLUSHWRITE
 2

	)

109 
	#TIOCPKT_STOP
 4

	)

110 
	#TIOCPKT_START
 8

	)

111 
	#TIOCPKT_NOSTOP
 16

	)

112 
	#TIOCPKT_DOSTOP
 32

	)

113 
	#TIOCPKT_IOCTL
 64

	)

115 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm-generic/socket.h

1 #i‚de‡
__ASM_GENERIC_SOCKET_H


2 
	#__ASM_GENERIC_SOCKET_H


	)

4 
	~<asm/sockios.h
>

7 
	#SOL_SOCKET
 1

	)

9 
	#SO_DEBUG
 1

	)

10 
	#SO_REUSEADDR
 2

	)

11 
	#SO_TYPE
 3

	)

12 
	#SO_ERROR
 4

	)

13 
	#SO_DONTROUTE
 5

	)

14 
	#SO_BROADCAST
 6

	)

15 
	#SO_SNDBUF
 7

	)

16 
	#SO_RCVBUF
 8

	)

17 
	#SO_SNDBUFFORCE
 32

	)

18 
	#SO_RCVBUFFORCE
 33

	)

19 
	#SO_KEEPALIVE
 9

	)

20 
	#SO_OOBINLINE
 10

	)

21 
	#SO_NO_CHECK
 11

	)

22 
	#SO_PRIORITY
 12

	)

23 
	#SO_LINGER
 13

	)

24 
	#SO_BSDCOMPAT
 14

	)

25 
	#SO_REUSEPORT
 15

	)

26 #i‚de‡
SO_PASSCRED


27 
	#SO_PASSCRED
 16

	)

28 
	#SO_PEERCRED
 17

	)

29 
	#SO_RCVLOWAT
 18

	)

30 
	#SO_SNDLOWAT
 19

	)

31 
	#SO_RCVTIMEO
 20

	)

32 
	#SO_SNDTIMEO
 21

	)

36 
	#SO_SECURITY_AUTHENTICATION
 22

	)

37 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

38 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

40 
	#SO_BINDTODEVICE
 25

	)

43 
	#SO_ATTACH_FILTER
 26

	)

44 
	#SO_DETACH_FILTER
 27

	)

45 
	#SO_GET_FILTER
 
SO_ATTACH_FILTER


	)

47 
	#SO_PEERNAME
 28

	)

48 
	#SO_TIMESTAMP
 29

	)

49 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

51 
	#SO_ACCEPTCONN
 30

	)

53 
	#SO_PEERSEC
 31

	)

54 
	#SO_PASSSEC
 34

	)

55 
	#SO_TIMESTAMPNS
 35

	)

56 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

58 
	#SO_MARK
 36

	)

60 
	#SO_TIMESTAMPING
 37

	)

61 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

63 
	#SO_PROTOCOL
 38

	)

64 
	#SO_DOMAIN
 39

	)

66 
	#SO_RXQ_OVFL
 40

	)

68 
	#SO_WIFI_STATUS
 41

	)

69 
	#SCM_WIFI_STATUS
 
SO_WIFI_STATUS


	)

70 
	#SO_PEEK_OFF
 42

	)

73 
	#SO_NOFCS
 43

	)

75 
	#SO_LOCK_FILTER
 44

	)

77 
	#SO_SELECT_ERR_QUEUE
 45

	)

79 
	#SO_BUSY_POLL
 46

	)

81 
	#SO_MAX_PACING_RATE
 47

	)

83 
	#SO_BPF_EXTENSIONS
 48

	)

85 
	#SCM_TIMESTAMPING_PKTINFO
 58

	)

	@/usr/include/asm/bitsperlong.h

1 #i‚de‡
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifde‡
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-gíîic/bô•îl⁄g.h
>

	@/usr/include/asm/errno.h

1 
	~<asm-gíîic/î∫o.h
>

	@/usr/include/asm/param.h

1 
	~<asm-gíîic/∑øm.h
>

	@/usr/include/asm/posix_types_32.h

1 #i‚de‡
_ASM_X86_POSIX_TYPES_32_H


2 
	#_ASM_X86_POSIX_TYPES_32_H


	)

10 
	t__kî√l_mode_t
;

11 
	#__kî√l_mode_t
 
__kî√l_mode_t


	)

13 
	t__kî√l_ùc_pid_t
;

14 
	#__kî√l_ùc_pid_t
 
__kî√l_ùc_pid_t


	)

16 
	t__kî√l_uid_t
;

17 
	t__kî√l_gid_t
;

18 
	#__kî√l_uid_t
 
__kî√l_uid_t


	)

20 
	t__kî√l_ﬁd_dev_t
;

21 
	#__kî√l_ﬁd_dev_t
 
__kî√l_ﬁd_dev_t


	)

23 
	~<asm-gíîic/posix_ty≥s.h
>

	@/usr/include/asm/posix_types_64.h

1 #i‚de‡
_ASM_X86_POSIX_TYPES_64_H


2 
	#_ASM_X86_POSIX_TYPES_64_H


	)

10 
	t__kî√l_ﬁd_uid_t
;

11 
	t__kî√l_ﬁd_gid_t
;

12 
	#__kî√l_ﬁd_uid_t
 
__kî√l_ﬁd_uid_t


	)

14 
	t__kî√l_ﬁd_dev_t
;

15 
	#__kî√l_ﬁd_dev_t
 
__kî√l_ﬁd_dev_t


	)

17 
	~<asm-gíîic/posix_ty≥s.h
>

	@/usr/include/asm/posix_types_x32.h

1 #i‚de‡
_ASM_X86_POSIX_TYPES_X32_H


2 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

13 
	t__kî√l_l⁄g_t
;

14 
	t__kî√l_ul⁄g_t
;

15 
	#__kî√l_l⁄g_t
 
__kî√l_l⁄g_t


	)

17 
	~<asm/posix_ty≥s_64.h
>

	@/usr/include/assert.h

23 #ifdef 
_ASSERT_H


25 #unde‡
_ASSERT_H


26 #unde‡
as£π


27 #unde‡
__ASSERT_VOID_CAST


29 #ifdef 
__USE_GNU


30 #unde‡
as£π_≥º‹


35 
	#_ASSERT_H
 1

	)

36 
	~<„©uªs.h
>

38 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

39 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

41 
	#__ASSERT_VOID_CAST
 ()

	)

49 #ifdef 
NDEBUG


51 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

59 #ifdef 
__USE_GNU


60 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

65 
__BEGIN_DECLS


68 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

69 
__löe
, c⁄° *
__fun˘i⁄
)

70 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

73 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

74 
__löe
, c⁄° *
__fun˘i⁄
)

75 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

80 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

81 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

84 
__END_DECLS


86 
	#as£π
(
ex¥
) \

87 ((
ex¥
) \

88 ? 
	`__ASSERT_VOID_CAST
 (0) \

89 : 
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

91 #ifdef 
__USE_GNU


92 
	#as£π_≥º‹
(
î∫um
) \

93 (!(
î∫um
) \

94 ? 
	`__ASSERT_VOID_CAST
 (0) \

95 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

103 #i‡
deföed
 
__˝lu•lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

104 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

106 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

107 
	#__ASSERT_FUNCTION
 
__func__


	)

109 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

116 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


118 #unde‡
°©ic_as£π


119 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/bits/libc-lock.h

21 #i‚de‡
_BITS_LIBC_LOCK_H


22 
	#_BITS_LIBC_LOCK_H
 1

	)

24 
	~<±hªad.h
>

27 #ifde‡
_IO_MTSAFE_IO


28 
±hªad_muãx_t
 
	t__libc_lock_t
;

29 °ru˘ { 
±hªad_muãx_t
 
	mmuãx
; } 
	t__libc_lock_ªcursive_t
;

30 #ifde‡
__USE_UNIX98


31 
±hªad_rwlock_t
 
	t__libc_rwlock_t
;

33 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

35 
__libc_lock_ªcursive_t
 
	t__πld_lock_ªcursive_t
;

37 
__libc_lock_›aque__
 
	t__libc_lock_t
;

38 
__libc_lock_ªcursive_›aque__
 
	t__libc_lock_ªcursive_t
;

39 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

43 
±hªad_key_t
 
	t__libc_key_t
;

52 
	#__libc_lock_deföe
(
CLASS
,
NAME
) \

53 
CLASS
 
__libc_lock_t
 
NAME
;

	)

54 
	#__libc_rwlock_deföe
(
CLASS
,
NAME
) \

55 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

56 
	#__libc_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

57 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
;

	)

58 
	#__πld_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

59 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
;

	)

70 #i‡
__LT_SPINLOCK_INIT
 == 0

71 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

72 
CLASS
 
__libc_lock_t
 
NAME
;

	)

74 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

75 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

78 
	#__libc_rwlock_deföe_öôülized
(
CLASS
,
NAME
) \

79 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

83 
	#__libc_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

84 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

85 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

86 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

88 
	#__πld_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

89 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

90 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

91 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

93 #i‡
deföed
 
__PIC__


94 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

95 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of
 (
FUNC
Ë*
_‚
 = (FUNC); \

96 
_‚
 !
NULL
 ? (*_‚Ë
ARGS
 : 
ELSE
; }))

	)

98 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

99 (
FUNC
 !
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

101 
	#__libc_maybe_ˇŒ2
(
FUNC
, 
ARGS
, 
ELSE
Ë
	`__libc_maybe_ˇŒ
 (
__
##FUNC, ARGS, ELSE)

	)

105 
	#__libc_lock_öô
(
NAME
) \

106 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_öô
, (&(
NAME
), 
NULL
), 0))

	)

107 
	#__libc_rwlock_öô
(
NAME
) \

108 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_öô
, (&(
NAME
), 
NULL
), 0));

	)

111 
	#__libc_lock_öô_ªcursive
(
NAME
) \

113 i‡(
__±hªad_muãx_öô
 !
NULL
) \

115 
±hªad_muãx©å_t
 
__©å
; \

116 
	`__±hªad_muãx©å_öô
 (&
__©å
); \

117 
	`__±hªad_muãx©å_£ây≥
 (&
__©å
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

118 
	`__±hªad_muãx_öô
 (&(
NAME
).
muãx
, &
__©å
); \

119 
	`__±hªad_muãx©å_de°roy
 (&
__©å
); \

121 } 0);

	)

122 
	#__πld_lock_öô_ªcursive
(
NAME
) \

123 
	`__libc_lock_öô_ªcursive
 (
NAME
)

	)

128 
	#__libc_lock_föi
(
NAME
) \

129 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_de°roy
, (&(
NAME
)), 0));

	)

130 
	#__libc_rwlock_föi
(
NAME
) \

131 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_de°roy
, (&(
NAME
)), 0));

	)

134 
	#__libc_lock_föi_ªcursive
(
NAME
Ë
	`__libc_lock_föi
 ((NAME).
muãx
)

	)

135 
	#__πld_lock_föi_ªcursive
(
NAME
Ë
	`__libc_lock_föi_ªcursive
 (NAME)

	)

138 
	#__libc_lock_lock
(
NAME
) \

139 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_lock
, (&(
NAME
)), 0));

	)

140 
	#__libc_rwlock_rdlock
(
NAME
) \

141 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_rdlock
, (&(
NAME
)), 0));

	)

142 
	#__libc_rwlock_wæock
(
NAME
) \

143 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_wæock
, (&(
NAME
)), 0));

	)

146 
	#__libc_lock_lock_ªcursive
(
NAME
Ë
	`__libc_lock_lock
 ((NAME).
muãx
)

	)

149 
	#__libc_lock_åylock
(
NAME
) \

150 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_åylock
, (&(
NAME
)), 0))

	)

151 
	#__libc_rwlock_åyrdlock
(
NAME
) \

152 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åyrdlock
, (&(
NAME
)), 0))

	)

153 
	#__libc_rwlock_åywæock
(
NAME
) \

154 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åywæock
, (&(
NAME
)), 0))

	)

157 
	#__libc_lock_åylock_ªcursive
(
NAME
Ë
	`__libc_lock_åylock
 ((NAME).
muãx
)

	)

158 
	#__πld_lock_åylock_ªcursive
(
NAME
) \

159 
	`__libc_lock_åylock_ªcursive
 (
NAME
)

	)

162 
	#__libc_lock_u∆ock
(
NAME
) \

163 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_u∆ock
, (&(
NAME
)), 0));

	)

164 
	#__libc_rwlock_u∆ock
(
NAME
) \

165 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_u∆ock
, (&(
NAME
)), 0));

	)

168 
	#__libc_lock_u∆ock_ªcursive
(
NAME
Ë
	`__libc_lock_u∆ock
 ((NAME).
muãx
)

	)

170 
	#__πld_lock_lock_ªcursive
(
NAME
Ë
	`__libc_lock_lock_ªcursive
 (NAME)

	)

171 
	#__πld_lock_u∆ock_ªcursive
(
NAME
Ë
	`__libc_lock_u∆ock_ªcursive
 (NAME)

	)

174 #i‡
PTHREAD_ONCE_INIT
 == 0

177 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

178 
CLASS
 
±hªad_⁄˚_t
 
NAME


	)

180 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

181 
CLASS
 
±hªad_⁄˚_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

185 
	#__libc_⁄˚
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

187 i‡(
__±hªad_⁄˚
 !
NULL
) \

188 
	`__±hªad_⁄˚
 (&(
ONCE_CONTROL
), (
INIT_FUNCTION
)); \

189 i‡((
ONCE_CONTROL
Ë=
PTHREAD_ONCE_INIT
) { \

190 
	`INIT_FUNCTION
 (); \

191 (
ONCE_CONTROL
) = 2; \

193 } 0)

	)

197 
	#__libc_˛ónup_ªgi⁄_°¨t
(
DOIT
, 
FCT
, 
ARG
) \

198 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

199 
_avaû
 = (
DOIT
Ë&& 
_±hªad_˛ónup_push_de„r
 !
NULL
; \

200 i‡(
_avaû
) { \

201 
	`_±hªad_˛ónup_push_de„r
 (&
_buf„r
, (
FCT
), (
ARG
)); \

202 }

	)

205 
	#__libc_˛ónup_ªgi⁄_íd
(
DOIT
) \

206 i‡(
_avaû
) { \

207 
	`_±hªad_˛ónup_p›_ª°‹e
 (&
_buf„r
, (
DOIT
)); \

209 }

	)

212 
	#__libc_˛ónup_íd
(
DOIT
) \

213 i‡(
_avaû
) { \

214 
	`_±hªad_˛ónup_p›_ª°‹e
 (&
_buf„r
, (
DOIT
)); \

215 }

	)

217 
	#__libc_˛ónup_push
(
f˘
, 
¨g
) \

218 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

219 
	`__libc_maybe_ˇŒ
 (
_±hªad_˛ónup_push
, (&
_buf„r
, (
f˘
), (
¨g
)), 0)

	)

221 
	#__libc_˛ónup_p›
(
execuã
) \

222 
	`__libc_maybe_ˇŒ
 (
_±hªad_˛ónup_p›
, (&
_buf„r
, 
execuã
), 0); \

223 }

	)

226 
	#__libc_key_¸óã
(
KEY
, 
DESTRUCTOR
) \

227 (
	`__libc_maybe_ˇŒ
 (
__±hªad_key_¸óã
, (
KEY
, 
DESTRUCTOR
), 1))

	)

230 
	#__libc_gë•ecific
(
KEY
) \

231 (
	`__libc_maybe_ˇŒ
 (
__±hªad_gë•ecific
, (
KEY
), 
NULL
))

	)

234 
	#__libc_£t•ecific
(
KEY
, 
VALUE
) \

235 (
	`__libc_maybe_ˇŒ
 (
__±hªad_£t•ecific
, (
KEY
, 
VALUE
), 0))

	)

239 
	#__libc_©f‹k
(
PREPARE
, 
PARENT
, 
CHILD
) \

240 (
	`__libc_maybe_ˇŒ
 (
__±hªad_©f‹k
, (
PREPARE
, 
PARENT
, 
CHILD
), 0))

	)

242 
__BEGIN_DECLS


244 
_±hªad_˛ónup_push_de„r
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

245 (*
__routöe
) (*),

246 *
__¨g
Ë
__THROW
;

248 
	$_±hªad_˛ónup_p›_ª°‹e
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

249 
__execuã
Ë
__THROW
;

255 
	`__±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

256 
__c⁄°
 
±hªad_muãx©å_t
 *
__muãx_©å
);

258 
	`__±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
);

260 
	`__±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
);

262 
	`__±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
);

264 
	`__±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
);

266 
	`__±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
);

268 
	`__±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
);

270 
	`__±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
,

271 
__köd
);

273 #ifde‡
__USE_UNIX98


274 
	`__±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__rwlock
,

275 
__c⁄°
 
±hªad_rwlock©å_t
 *
__©å
);

277 
	`__±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
);

279 
	`__±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

281 
	`__±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

283 
	`__±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
);

285 
	`__±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
);

287 
	`__±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
);

290 
	`__±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

291 (*
__de°r_fun˘i⁄
) (*));

293 
	`__±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

294 
__c⁄°
 *
__poöãr
);

296 *
	`__±hªad_gë•ecific
 (
±hªad_key_t
 
__key
);

298 
	`__±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

299 (*
__öô_routöe
) ());

301 
	`__±hªad_©f‹k
 ((*
__¥ï¨e
) (),

302 (*
__∑ª¡
) (),

303 (*
__chûd
) ());

305 
__END_DECLS


309 #i‚de‡
__NO_WEAK_PTHREAD_ALIASES


310 #¥agm®
wók
 
__±hªad_muãx_öô


311 #¥agm®
wók
 
__±hªad_muãx_de°roy


312 #¥agm®
wók
 
__±hªad_muãx_lock


313 #¥agm®
wók
 
__±hªad_muãx_åylock


314 #¥agm®
wók
 
__±hªad_muãx_u∆ock


315 #¥agm®
wók
 
__±hªad_muãx©å_öô


316 #¥agm®
wók
 
__±hªad_muãx©å_de°roy


317 #¥agm®
wók
 
__±hªad_muãx©å_£ây≥


318 #¥agm®
wók
 
__±hªad_rwlock_de°roy


319 #¥agm®
wók
 
__±hªad_rwlock_rdlock


320 #¥agm®
wók
 
__±hªad_rwlock_åyrdlock


321 #¥agm®
wók
 
__±hªad_rwlock_wæock


322 #¥agm®
wók
 
__±hªad_rwlock_åywæock


323 #¥agm®
wók
 
__±hªad_rwlock_u∆ock


324 #¥agm®
wók
 
__±hªad_key_¸óã


325 #¥agm®
wók
 
__±hªad_£t•ecific


326 #¥agm®
wók
 
__±hªad_gë•ecific


327 #¥agm®
wók
 
__±hªad_⁄˚


328 #¥agm®
wók
 
__±hªad_öôülize


329 #¥agm®
wók
 
__±hªad_©f‹k


330 #¥agm®
wók
 
_±hªad_˛ónup_push_de„r


331 #¥agm®
wók
 
_±hªad_˛ónup_p›_ª°‹e


332 #¥agm®
wók
 
_±hªad_˛ónup_push


333 #¥agm®
wók
 
_±hªad_˛ónup_p›


338 
	#__libc_muãx_u∆ock
 
__±hªad_muãx_u∆ock


	)

	@/usr/include/gconv.h

22 #i‚de‡
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<„©uªs.h
>

26 
	#__√ed_mb°©e_t


	)

27 
	#__√ed_wöt_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
) (*, const *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 c⁄° *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/gnu/stubs-64.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_bdÊush


	)

11 
	#__°ub_chÊags


	)

12 
	#__°ub_Áâach


	)

13 
	#__°ub_fchÊags


	)

14 
	#__°ub_fdëach


	)

15 
	#__°ub_gëmsg


	)

16 
	#__°ub_gây


	)

17 
	#__°ub_lchmod


	)

18 
	#__°ub_putmsg


	)

19 
	#__°ub_ªvoke


	)

20 
	#__°ub_£éogö


	)

21 
	#__°ub_sigªtu∫


	)

22 
	#__°ub_s°k


	)

23 
	#__°ub_°ty


	)

	@/usr/include/linux/falloc.h

1 #i‚de‡
_FALLOC_H_


2 
	#_FALLOC_H_


	)

4 
	#FALLOC_FL_KEEP_SIZE
 0x01

	)

5 
	#FALLOC_FL_PUNCH_HOLE
 0x02

	)

6 
	#FALLOC_FL_NO_HIDE_STALE
 0x04

	)

28 
	#FALLOC_FL_COLLAPSE_RANGE
 0x08

	)

42 
	#FALLOC_FL_ZERO_RANGE
 0x10

	)

	@/usr/include/net-snmp/library/factory.h

1 #i‚de‡
NETSNMP_FACTORY_H


2 
	#NETSNMP_FACTORY_H


	)

5 #ifde‡
__˝lu•lus


9 * (
	t√t¢mp_Á˘‹y_¥odu˚_f
)();

10 (
√t¢mp_Á˘‹y_¥odu˚_nﬂŒoc_f
)(*);

12 
	s√t¢mp_Á˘‹y_s
 {

16 c⁄° *
¥odu˘
;

21 
√t¢mp_Á˘‹y_¥odu˚_f
 *
¥odu˚
;

26 
√t¢mp_Á˘‹y_¥odu˚_nﬂŒoc_f
 *
¥odu˚_nﬂŒoc
;

28 } 
	t√t¢mp_Á˘‹y
;

33 
√t¢mp_Á˘‹y_öô
();

38 
√t¢mp_Á˘‹y_ªgi°î
(
√t¢mp_Á˘‹y
 *
f
);

43 
√t¢mp_Á˘‹y
* 
√t¢mp_Á˘‹y_gë
(c⁄° * 
¥odu˘
);

48 * 
√t¢mp_Á˘‹y_¥odu˚
(c⁄° * 
¥odu˘
);

53 
√t¢mp_Á˘‹y_¥odu˚_nﬂŒoc
(c⁄° *
¥odu˘
, *
mem‹y
);

59 
FACTORY_NOERROR
 = 0,

60 
FACTORY_EXISTS
,

61 
FACTORY_NOTFOUND
,

62 
FACTORY_NOMEMORY
,

63 
FACTORY_GENERR
,

64 
FACTORY_MAXIMUM_ERROR


67 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpIPv4BaseDomain.h

3 #i‚de‡
SNMPIPV4BASE_H


4 
	#SNMPIPV4BASE_H


	)

6 #i‡
HAVE_NETINET_IN_H


7 
	~<√töë/ö.h
>

10 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

12 #ifde‡
__˝lu•lus


20 *
√t¢mp_ùv4_fmèddr
(c⁄° *
¥efix
, 
√t¢mp_å™•‹t
 *
t
,

21 *
d©a
, 
Àn
);

29 
√t¢mp_sockaddr_ö
(
sockaddr_ö
 *
addr
, c⁄° *
≥î«me
,

30 
ªmŸe_p‹t
);

31 
√t¢mp_sockaddr_ö2
(
sockaddr_ö
 *
addr
, c⁄° *
ö≥î«me
,

32 c⁄° *
deÁu…_èrgë
);

34 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpIPv6BaseDomain.h

3 #i‚de‡
SNMPIPV6BASE_H


4 
	#SNMPIPV6BASE_H


	)

6 #i‡
HAVE_NETINET_IN_H


7 
	~<√töë/ö.h
>

10 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

12 #ifde‡
__˝lu•lus


20 
NETSNMP_IMPORT


21 *
√t¢mp_ùv6_fmèddr
(c⁄° *
¥efix
, 
√t¢mp_å™•‹t
 *
t
,

22 *
d©a
, 
Àn
);

23 
NETSNMP_IMPORT


24 
√t¢mp_sockaddr_ö6_2
(
sockaddr_ö6
 *
addr
,

25 c⁄° *
ö≥î«me
,

26 c⁄° *
deÁu…_èrgë
);

27 
√t¢mp_sockaddr_ö6
(
sockaddr_ö6
 *
addr
,

28 c⁄° *
ö≥î«me
, 
ªmŸe_p‹t
);

30 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpUDPIPv4BaseDomain.h

3 #i‚de‡
SNMPUDPIPV4BASE_H


4 
	#SNMPUDPIPV4BASE_H


	)

6 #i‡
HAVE_SYS_SOCKET_H


7 
	~<sys/sockë.h
>

9 #i‡
HAVE_NETINET_IN_H


10 
	~<√töë/ö.h
>

13 
	$c⁄fig_ªquúe
(
UDPBa£
)

14 
	$c⁄fig_ªquúe
(
IPv4Ba£
)

16 
	~<√t-¢mp/libøry/¢mpIPv4Ba£Domaö.h
>

17 
	~<√t-¢mp/libøry/¢mpUDPBa£Domaö.h
>

19 #ifde‡
__˝lu•lus


27 
√t¢mp_å™•‹t
 *
	`√t¢mp_udpùv4ba£_å™•‹t
(
sockaddr_ö
 *
addr
,

28 
loˇl
);

30 #i‡
	`deföed
(
löux
Ë&& deföed(
IP_PKTINFO
) \

31 || 
	`deföed
(
IP_RECVDSTADDR
Ë&& !deföed(
_MSC_VER
)

32 
	`√t¢mp_udpùv4_ªcv‰om
(
s
, *
buf
, 
Àn
,

33 
sockaddr
 *
‰om
, 
sockÀn_t
 *
‰omÀn
,

34 
sockaddr
 *
d°ù
, 
sockÀn_t
 *
d°Àn
,

35 *
if_ödex
);

36 
	`√t¢mp_udpùv4_£ndto
(
fd
, 
ö_addr
 *
§cù
, 
if_ödex
,

37 
sockaddr
 *
ªmŸe
, *
d©a
, 
Àn
);

41 #ifde‡
__˝lu•lus


42 
	}
}

	@/usr/include/net-snmp/library/snmptsm.h

5 #i‚de‡
SNMPTSM_H


6 
	#SNMPTSM_H


	)

8 
	#TSM_SEC_MODEL_NUMBER
 
SNMP_SEC_MODEL_TSM


	)

10 #ifde‡
__˝lu•lus


14 
tsm_rgíî©e_out_msg
(

15 
¢mp_£cmod_outgoög_∑øms
 *);

16 
tsm_¥o˚ss_ö_msg
(
¢mp_£cmod_öcomög_∑øms


18 
öô_tsm
();

20 
shutdown_tsm
();

22 
	#NETSNMP_TM_SAME_SECURITY_NOT_REQUIRED
 0

	)

23 
	#NETSNMP_TM_USE_SAME_SECURITY
 1

	)

26 
	s√t¢mp_tsmSecurôyRe„ªn˚_s
 {

27 
√t¢mp_tmSèãRe„ªn˚
 *
tmSèãRef
;

28 } 
	t√t¢mp_tsmSecurôyRe„ªn˚
;

30 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/library/snmpusm.h

7 #i‚de‡
SNMPUSM_H


8 
	#SNMPUSM_H


	)

10 
	~<√t-¢mp/libøry/ˇŒback.h
>

12 #ifde‡
__˝lu•lus


16 
	#WILDCARDSTRING
 "*"

	)

21 
	#USM_MAX_ID_LENGTH
 1024

	)

22 
	#USM_MAX_SALT_LENGTH
 128

	)

23 
	#USM_DES_SALT_LENGTH
 64

	)

24 
	#USM_AES_SALT_LENGTH
 128

	)

25 
	#USM_MAX_KEYEDHASH_LENGTH
 128

	)

27 
	#USM_TIME_WINDOW
 150

	)

28 
	#USM_MD5_AND_SHA_AUTH_LEN
 12

	)

29 
	#USM_MAX_AUTHSIZE
 
USM_MD5_AND_SHA_AUTH_LEN


	)

31 
	#USM_SEC_MODEL_NUMBER
 
SNMP_SEC_MODEL_USM


	)

36 
	susmSèãRe„ªn˚
 {

37 *
u§_«me
;

38 
size_t
 
u§_«me_Àngth
;

39 
u_ch¨
 *
u§_ígöe_id
;

40 
size_t
 
u§_ígöe_id_Àngth
;

41 
oid
 *
u§_auth_¥Ÿocﬁ
;

42 
size_t
 
u§_auth_¥Ÿocﬁ_Àngth
;

43 
u_ch¨
 *
u§_auth_key
;

44 
size_t
 
u§_auth_key_Àngth
;

45 
oid
 *
u§_¥iv_¥Ÿocﬁ
;

46 
size_t
 
u§_¥iv_¥Ÿocﬁ_Àngth
;

47 
u_ch¨
 *
u§_¥iv_key
;

48 
size_t
 
u§_¥iv_key_Àngth
;

49 
u_öt
 
u§_£c_Àvñ
;

61 
usmU£r
;

62 
	susmU£r
 {

63 
u_ch¨
 *
ígöeID
;

64 
size_t
 
ígöeIDLí
;

65 *
«me
;

66 *
£cName
;

67 
oid
 *
˛⁄eFrom
;

68 
size_t
 
˛⁄eFromLí
;

69 
oid
 *
authPrŸocﬁ
;

70 
size_t
 
authPrŸocﬁLí
;

71 
u_ch¨
 *
authKey
;

72 
size_t
 
authKeyLí
;

73 
oid
 *
¥ivPrŸocﬁ
;

74 
size_t
 
¥ivPrŸocﬁLí
;

75 
u_ch¨
 *
¥ivKey
;

76 
size_t
 
¥ivKeyLí
;

77 
u_ch¨
 *
u£rPublicSåög
;

78 
size_t
 
u£rPublicSåögLí
;

79 
u£rSètus
;

80 
u£rSt‹ageTy≥
;

82 *
usmDHU£rAuthKeyCh™ge
;

83 *
usmDHU£rPrivKeyCh™ge
;

84 
usmU£r
 *
√xt
;

85 
usmU£r
 *
¥ev
;

93 
usmSèãRe„ªn˚
 *
usm_mÆloc_usmSèãRe„ªn˚
();

95 
usm_‰ì_usmSèãRe„ªn˚
(*
ﬁd
);

97 
usm_£t_usmSèãRe„ªn˚_«me
(
usmSèãRe„ªn˚


98 *
ªf
, *
«me
,

99 
size_t
 
«me_Àn
);

101 
usm_£t_usmSèãRe„ªn˚_ígöe_id
(

102 
usmSèãRe„ªn˚


103 *
ªf
,

104 
u_ch¨
 * 
ígöe_id
,

105 
size_t


106 
ígöe_id_Àn
);

108 
usm_£t_usmSèãRe„ªn˚_auth_¥Ÿocﬁ
(

109 
usmSèãRe„ªn˚


110 *
ªf
,

111 
oid
 *

112 
auth_¥Ÿocﬁ
,

113 
size_t


114 
auth_¥Ÿocﬁ_Àn
);

116 
usm_£t_usmSèãRe„ªn˚_auth_key
(

117 
usmSèãRe„ªn˚


118 *
ªf
,

119 
u_ch¨
 * 
auth_key
,

120 
size_t


121 
auth_key_Àn
);

123 
usm_£t_usmSèãRe„ªn˚_¥iv_¥Ÿocﬁ
(

124 
usmSèãRe„ªn˚


125 *
ªf
,

126 
oid
 *

127 
¥iv_¥Ÿocﬁ
,

128 
size_t


129 
¥iv_¥Ÿocﬁ_Àn
);

131 
usm_£t_usmSèãRe„ªn˚_¥iv_key
(

132 
usmSèãRe„ªn˚


133 *
ªf
,

134 
u_ch¨
 * 
¥iv_key
,

135 
size_t


136 
¥iv_key_Àn
);

138 
usm_£t_usmSèãRe„ªn˚_£c_Àvñ
(

139 
usmSèãRe„ªn˚


140 *
ªf
,

141 
£c_Àvñ
);

142 
usm_˛⁄e_usmSèãRe„ªn˚
(
usmSèãRe„ªn˚
 *
‰om
,

143 
usmSèãRe„ªn˚
 **
to
);

146 #ifde‡
NETSNMP_ENABLE_TESTING_CODE


147 
emîgícy_¥öt
(
u_ch¨
 * 
fõld
, 
u_öt
 
Àngth
);

150 
a¢_¥edi˘_öt_Àngth
(
ty≥
, 
numbî
,

151 
size_t
 
Àn
);

153 
a¢_¥edi˘_Àngth
(
ty≥
, 
u_ch¨
 * 
±r
,

154 
size_t
 
u_ch¨_Àn
);

156 
usm_£t_ß…
(
u_ch¨
 * 
iv
,

157 
size_t
 * 
iv_Àngth
,

158 
u_ch¨
 * 
¥iv_ß…
,

159 
size_t
 
¥iv_ß…_Àngth
,

160 
u_ch¨
 * 
msgSÆt
);

162 
usm_∑r£_£curôy_∑ømëîs
(
u_ch¨
 * 
£cP¨ams
,

163 
size_t
 
ªmaöög
,

164 
u_ch¨
 * 
£cEngöeID
,

165 
size_t
 * 
£cEngöeIDLí
,

166 
u_öt
 * 
boŸs_uöt
,

167 
u_öt
 * 
time_uöt
,

168 *
£cName
,

169 
size_t
 * 
£cNameLí
,

170 
u_ch¨
 * 
sig«tuª
,

171 
size_t
 *

172 
sig«tuª_Àngth
,

173 
u_ch¨
 * 
ß…
,

174 
size_t
 * 
ß…_Àngth
,

175 
u_ch¨
 ** 
d©a_±r
);

177 
usm_check_™d_upd©e_timñöess
(
u_ch¨
 * 
£cEngöeID
,

178 
size_t
 
£cEngöeIDLí
,

179 
u_öt
 
boŸs_uöt
,

180 
u_öt
 
time_uöt
,

181 *
îr‹
);

183 
SecmodSessi⁄CÆlback
 
usm_›í_£ssi⁄
;

184 
SecmodOutMsg
 
usm_£cmod_gíî©e_out_msg
;

185 
SecmodOutMsg
 
usm_£cmod_gíî©e_out_msg
;

186 
SecmodInMsg
 
usm_£cmod_¥o˚ss_ö_msg
;

187 
usm_gíî©e_out_msg
(, 
u_ch¨
 *, 
size_t
, , ,

188 
u_ch¨
 *, 
size_t
, *, size_t,

189 , 
u_ch¨
 *, 
size_t
, *,

190 
u_ch¨
 *, 
size_t
 *, u_char **,

191 
size_t
 *);

192 
usm_rgíî©e_out_msg
(, 
u_ch¨
 *, 
size_t
, , ,

193 
u_ch¨
 *, 
size_t
, *, size_t,

194 , 
u_ch¨
 *, 
size_t
, *,

195 
u_ch¨
 **, 
size_t
 *, size_t *);

197 
usm_¥o˚ss_ö_msg
(, 
size_t
, 
u_ch¨
 *, , ,

198 
u_ch¨
 *, 
size_t
, u_char *,

199 
size_t
 *, *, size_t *,

200 
u_ch¨
 **, 
size_t
 *, size_t *,

201 **, 
√t¢mp_£ssi⁄
 *, 
u_ch¨
);

203 
usm_check_£cLevñ
(
Àvñ
, 
usmU£r
 *
u£r
);

204 
NETSNMP_IMPORT


205 
usmU£r
 *
usm_gë_u£rLi°
();

206 
NETSNMP_IMPORT


207 
usmU£r
 *
usm_gë_u£r
(
u_ch¨
 * 
ígöeID
, 
size_t
 
ígöeIDLí
,

208 *
«me
);

209 
usmU£r
 *
usm_gë_u£r_‰om_li°
(
u_ch¨
 * 
ígöeID
,

210 
size_t
 
ígöeIDLí
, *
«me
,

211 
usmU£r
 *
u£rLi°
,

212 
u£_deÁu…
);

213 
NETSNMP_IMPORT


214 
usmU£r
 *
usm_add_u£r
(usmU£∏*
u£r
);

215 
usmU£r
 *
usm_add_u£r_to_li°
(usmU£∏*
u£r
,

216 
usmU£r
 *
u£rLi°
);

217 
NETSNMP_IMPORT


218 
usmU£r
 *
usm_‰ì_u£r
(usmU£∏*
u£r
);

219 
NETSNMP_IMPORT


220 
usmU£r
 *
usm_¸óã_u£r
();

221 
NETSNMP_IMPORT


222 
usmU£r
 *
usm_¸óã_öôül_u£r
(c⁄° *
«me
,

223 c⁄° 
oid
 * 
authPrŸocﬁ
,

224 
size_t
 
authPrŸocﬁLí
,

225 c⁄° 
oid
 * 
¥ivPrŸocﬁ
,

226 
size_t
 
¥ivPrŸocﬁLí
);

227 
NETSNMP_IMPORT


228 
usmU£r
 *
usm_˛⁄eFrom_u£r
(usmU£∏*
‰om
,

229 
usmU£r
 *
to
);

230 
NETSNMP_IMPORT


231 
usmU£r
 *
usm_ªmove_u£r
(usmU£∏*
u£r
);

232 
usmU£r
 *
usm_ªmove_u£r_‰om_li°
(usmU£∏*
u£r
,

233 
usmU£r
 **
u£rLi°
);

234 *
gë_objid
(*
löe
, 
oid
 ** 
›å
, 
size_t
 * 
Àn
);

235 
NETSNMP_IMPORT


236 
usm_ßve_u£rs
(c⁄° *
tokí
, c⁄° *
ty≥
);

237 
usm_ßve_u£rs_‰om_li°
(
usmU£r
 *
u£r
,

238 c⁄° *
tokí
,

239 c⁄° *
ty≥
);

240 
usm_ßve_u£r
(
usmU£r
 *
u£r
, c⁄° *
tokí
,

241 c⁄° *
ty≥
);

242 
NETSNMP_IMPORT


243 
SNMPCÆlback
 
usm_°‹e_u£rs
;

244 
usmU£r
 *
usm_ªad_u£r
(c⁄° *
löe
);

245 
NETSNMP_IMPORT


246 
usm_∑r£_c⁄fig_usmU£r
(c⁄° *
tokí
,

247 *
löe
);

249 
usm_£t_∑ssw‹d
(c⁄° *
tokí
, *
löe
);

250 
NETSNMP_IMPORT


251 
usm_£t_u£r_∑ssw‹d
(
usmU£r
 *
u£r
,

252 c⁄° *
tokí
, *
löe
);

253 
öô_usm
();

254 
NETSNMP_IMPORT


255 
öô_usm_c⁄f
(c⁄° *
≠p
);

256 
öô_usm_po°_c⁄fig
(
maj‹id
, 
mö‹id
,

257 *
£rvî¨g
, *
˛õ¡¨g
);

258 
deöô_usm_po°_c⁄fig
(
maj‹id
, 
mö‹id
, *
£rvî¨g
,

259 *
˛õ¡¨g
);

260 
NETSNMP_IMPORT


261 
˛ór_u£r_li°
();

262 
NETSNMP_IMPORT


263 
shutdown_usm
();

265 
NETSNMP_IMPORT


266 
usm_¸óã_u£r_‰om_£ssi⁄
(
√t¢mp_£ssi⁄
 * 
£ssi⁄
);

267 
SecmodPo°Discovîy
 
usm_¸óã_u£r_‰om_£ssi⁄_hook
;

268 
NETSNMP_IMPORT


269 
usm_∑r£_¸óã_usmU£r
(c⁄° *
tokí
,

270 *
löe
);

271 
NETSNMP_IMPORT


272 c⁄° 
oid
 *
gë_deÁu…_authty≥
(
size_t
 *);

273 
NETSNMP_IMPORT


274 c⁄° 
oid
 *
gë_deÁu…_¥ivty≥
(
size_t
 *);

275 
¢mpv3_authty≥_c⁄f
(c⁄° *
w‹d
, *
˝å
);

276 
¢mpv3_¥ivty≥_c⁄f
(c⁄° *
w‹d
, *
˝å
);

278 #ifde‡
__˝lu•lus


	@/usr/include/net-snmp/net-snmp-features.h

1 #i‚de‡
NETSNMP_FEATURES_H


2 
	#NETSNMP_FEATURES_H


	)

5 #ifde‡
NETSNMP_MINIMAL_CODE


6 #ifde‡
NETSNMP_FEATURE_CHECKING


7 
	~<√t-¢mp/„©uª-dëaûs.h
>

9 
	~<√t-¢mp/libøry/„©uªs.h
>

10 #i‚de‡
NETSNMP_DISABLE_AGENT


11 
	~<√t-¢mp/agít/„©uªs.h
>

12 
	~<√t-¢mp/agít/„©uªs-mibgroups.h
>

14 #i‚de‡
NETSNMP_DISABLE_APPS


15 
	~<√t-¢mp/„©uªs-¢m≤ë°©.h
>

16 
	~<√t-¢mp/„©uªs-≠ps.h
>

23 #i‚de‡
NETSNMP_FEATURE_CHECKING


24 
	#√t¢mp_„©uª_¥ovide
(
X
)

	)

25 
	#√t¢mp_„©uª_ªquúe
(
X
)

	)

26 
	#√t¢mp_„©uª_w™t
(
X
)

	)

27 
	#√t¢mp_„©uª_chûd_of
(
X
, 
Y
)

	)

30 
	#√t¢mp_„©uª_unu£d
(
X
Ë
√t¢mp_„©uª_unu£d_
 ## 
	)
X

	@/usr/include/pthread.h

18 #i‚de‡
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<ídün.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<bôs/±hªadty≥s.h
>

27 
	~<bôs/£tjmp.h
>

28 
	~<bôs/w‹dsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifde‡
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifde‡
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


85 #ifde‡
__PTHREAD_MUTEX_HAVE_PREV


86 
	#PTHREAD_MUTEX_INITIALIZER
 \

87 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

88 #ifde‡
__USE_GNU


89 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

90 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

91 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

92 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

93 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

94 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

95 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

96 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_MUTEX_INITIALIZER
 \

101 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

102 #ifde‡
__USE_GNU


103 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

105 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

107 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

115 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


118 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

120 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

121 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


127 #i‚de‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


128 #i‡
__WORDSIZE
 == 64

129 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

134 
	#PTHREAD_RWLOCK_INITIALIZER
 \

135 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

136 #ifde‡
__USE_GNU


137 #ifde‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


138 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

140 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

142 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


143 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

144 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

145 0, 0, 0, 0 } }

	)

147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

148 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

149 0 } }

	)

159 
	mPTHREAD_INHERIT_SCHED
,

160 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

161 
	mPTHREAD_EXPLICIT_SCHED


162 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

169 
	mPTHREAD_SCOPE_SYSTEM
,

170 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

171 
	mPTHREAD_SCOPE_PROCESS


172 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

179 
	mPTHREAD_PROCESS_PRIVATE
,

180 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

181 
	mPTHREAD_PROCESS_SHARED


182 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

188 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*Ë0, 0, 0 } }

	)

192 
	s_±hªad_˛ónup_buf„r


194 (*
	m__routöe
) (*);

195 *
	m__¨g
;

196 
	m__ˇn˚…y≥
;

197 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

203 
	mPTHREAD_CANCEL_ENABLE
,

204 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

205 
	mPTHREAD_CANCEL_DISABLE


206 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

210 
	mPTHREAD_CANCEL_DEFERRED
,

211 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

212 
	mPTHREAD_CANCEL_ASYNCHRONOUS


213 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

215 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

219 
	#PTHREAD_ONCE_INIT
 0

	)

222 #ifde‡
__USE_XOPEN2K


226 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

230 
__BEGIN_DECLS


235 
±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__√wthªad
,

236 c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

237 *(*
__°¨t_routöe
) (*),

238 *
__ª°ri˘
 
__¨g
Ë
__THROWNL
 
__n⁄nuŒ
 ((1, 3));

244 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

252 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

254 #ifde‡
__USE_GNU


257 
	$±hªad_åyjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
Ë
__THROW
;

265 
	`±hªad_timedjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
,

266 c⁄° 
time•ec
 *
__ab°ime
);

273 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

277 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

280 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
)

281 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

289 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

292 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$±hªad_©å_gëdëach°©e
 (c⁄° 
±hªad_©å_t
 *
__©å
,

297 *
__dëach°©e
)

298 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

301 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

302 
__dëach°©e
)

303 
__THROW
 
	`__n⁄nuŒ
 ((1));

307 
	$±hªad_©å_gëgu¨dsize
 (c⁄° 
±hªad_©å_t
 *
__©å
,

308 
size_t
 *
__gu¨dsize
)

309 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

312 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

313 
size_t
 
__gu¨dsize
)

314 
__THROW
 
	`__n⁄nuŒ
 ((1));

318 
	$±hªad_©å_gësched∑øm
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

319 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

320 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

323 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

324 c⁄° 
sched_∑øm
 *
__ª°ri˘


325 
__∑øm
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

328 
	$±hªad_©å_gëschedpﬁicy
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


329 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

330 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

333 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

334 
__THROW
 
	`__n⁄nuŒ
 ((1));

337 
	$±hªad_©å_gëöhîôsched
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


338 
__©å
, *
__ª°ri˘
 
__öhîô
)

339 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

342 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

343 
__öhîô
)

344 
__THROW
 
	`__n⁄nuŒ
 ((1));

348 
	$±hªad_©å_gësc›e
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

349 *
__ª°ri˘
 
__sc›e
)

350 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

353 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

354 
__THROW
 
	`__n⁄nuŒ
 ((1));

357 
	$±hªad_©å_gë°ackaddr
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


358 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

359 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__©åibuã_dïªˇãd__
;

365 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

366 *
__°ackaddr
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
;

370 
	$±hªad_©å_gë°acksize
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


371 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

372 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

377 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

378 
size_t
 
__°acksize
)

379 
__THROW
 
	`__n⁄nuŒ
 ((1));

381 #ifde‡
__USE_XOPEN2K


383 
	$±hªad_©å_gë°ack
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

384 **
__ª°ri˘
 
__°ackaddr
,

385 
size_t
 *
__ª°ri˘
 
__°acksize
)

386 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

391 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

392 
size_t
 
__°acksize
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

395 #ifde‡
__USE_GNU


398 
	$±hªad_©å_£èfföôy_≈
 (
±hªad_©å_t
 *
__©å
,

399 
size_t
 
__˝u£tsize
,

400 c⁄° 
˝u_£t_t
 *
__˝u£t
)

401 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

405 
	$±hªad_©å_gëafföôy_≈
 (c⁄° 
±hªad_©å_t
 *
__©å
,

406 
size_t
 
__˝u£tsize
,

407 
˝u_£t_t
 *
__˝u£t
)

408 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

414 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
)

415 
__THROW
 
	`__n⁄nuŒ
 ((2));

423 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

424 c⁄° 
sched_∑øm
 *
__∑øm
)

425 
__THROW
 
	`__n⁄nuŒ
 ((3));

428 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

429 *
__ª°ri˘
 
__pﬁicy
,

430 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

431 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

434 
	$±hªad_£tsched¥io
 (
±hªad_t
 
__èrgë_thªad
, 
__¥io
)

435 
__THROW
;

438 #ifde‡
__USE_GNU


440 
	$±hªad_gë«me_≈
 (
±hªad_t
 
__èrgë_thªad
, *
__buf
,

441 
size_t
 
__buÊí
)

442 
__THROW
 
	`__n⁄nuŒ
 ((2));

445 
	$±hªad_£äame_≈
 (
±hªad_t
 
__èrgë_thªad
, c⁄° *
__«me
)

446 
__THROW
 
	`__n⁄nuŒ
 ((2));

450 #ifde‡
__USE_UNIX98


452 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

455 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

458 #ifde‡
__USE_GNU


463 
	$±hªad_yõld
 (Ë
__THROW
;

468 
	$±hªad_£èfföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

469 c⁄° 
˝u_£t_t
 *
__˝u£t
)

470 
__THROW
 
	`__n⁄nuŒ
 ((3));

473 
	$±hªad_gëafföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

474 
˝u_£t_t
 *
__˝u£t
)

475 
__THROW
 
	`__n⁄nuŒ
 ((3));

488 
	`±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

489 (*
__öô_routöe
Ë()Ë
	`__n⁄nuŒ
 ((1, 2));

500 
	`±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
);

504 
	`±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
);

507 
	`±hªad_ˇn˚l
 (
±hªad_t
 
__th
);

512 
	`±hªad_ã°ˇn˚l
 ();

521 
__jmp_buf
 
__ˇn˚l_jmp_buf
;

522 
__mask_was_ßved
;

523 } 
__ˇn˚l_jmp_buf
[1];

524 *
__∑d
[4];

525 } 
	t__±hªad_unwöd_buf_t
 
	t__©åibuã__
 ((
	t__Æig√d__
));

528 #i‚de‡
__˛ónup_f˘_©åibuã


529 
	#__˛ónup_f˘_©åibuã


	)

534 
	s__±hªad_˛ónup_‰ame


536 (*
__ˇn˚l_routöe
) (*);

537 *
__ˇn˚l_¨g
;

538 
__do_ô
;

539 
__ˇn˚l_ty≥
;

542 #i‡
deföed
 
__GNUC__
 && deföed 
__EXCEPTIONS


543 #ifde‡
__˝lu•lus


545 ˛as†
	c__±hªad_˛ónup_˛ass


547 (*
__ˇn˚l_routöe
) (*);

548 *
__ˇn˚l_¨g
;

549 
__do_ô
;

550 
__ˇn˚l_ty≥
;

552 
public
:

553 
	`__±hªad_˛ónup_˛ass
 ((*
__f˘
Ë(*), *
__¨g
)

554 : 
	`__ˇn˚l_routöe
 (
__f˘
), 
	`__ˇn˚l_¨g
 (
__¨g
), 
	$__do_ô
 (1) { }

555 ~
	$__±hªad_˛ónup_˛ass
 (Ë{ i‡(
__do_ô
Ë
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); 
	}
}

556 
	$__£tdoô
 (
__√wvÆ
Ë{ 
__do_ô
 = __√wvÆ; 
	}
}

557 
	$__de„r
 (Ë{ 
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
,

558 &
__ˇn˚l_ty≥
); 
	}
}

559 
	$__ª°‹e
 (Ëc⁄° { 
	`±hªad_£tˇn˚…y≥
 (
__ˇn˚l_ty≥
, 0); 
	}
}

569 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

571 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
)

	)

575 
	#±hªad_˛ónup_p›
(
execuã
) \

576 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

577 } 0)

	)

579 #ifde‡
__USE_GNU


583 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

585 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
); \

586 
__˛‰ame
.
	`__de„r
 ()

	)

591 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

592 
__˛‰ame
.
	`__ª°‹e
 (); \

593 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

594 } 0)

	)

601 
__exã∫_ölöe
 

602 
	$__±hªad_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
__‰ame
)

604 i‡(
__‰ame
->
__do_ô
)

605 
__‰ame
->
	`__ˇn˚l_routöe
 (__‰ame->
__ˇn˚l_¨g
);

606 
	}
}

615 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

617 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

618 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

619 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

620 .
__do_ô
 = 1 };

	)

624 
	#±hªad_˛ónup_p›
(
execuã
) \

625 
__˛‰ame
.
__do_ô
 = (
execuã
); \

626 } 0)

	)

628 #ifde‡
__USE_GNU


632 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

634 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

635 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

636 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

637 .
__do_ô
 = 1 }; \

638 (Ë
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
, \

639 &
__˛‰ame
.
__ˇn˚l_ty≥
)

	)

644 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

645 (Ë
	`±hªad_£tˇn˚…y≥
 (
__˛‰ame
.
__ˇn˚l_ty≥
, 
NULL
); \

646 
__˛‰ame
.
__do_ô
 = (
execuã
); \

647 } 0)

	)

658 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

660 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

661 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

662 *
__ˇn˚l_¨g
 = (
¨g
); \

663 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

664 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

665 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

667 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

668 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

672 
	`__±hªad_ªgi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

673 dÿ{

	)

674 
__±hªad_ªgi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

675 
__˛ónup_f˘_©åibuã
;

679 
	#±hªad_˛ónup_p›
(
execuã
) \

682 
	`__±hªad_uƒegi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

683 i‡(
execuã
) \

684 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

685 } 0)

	)

686 
	$__±hªad_uƒegi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

687 
__˛ónup_f˘_©åibuã
;

689 #ifde‡
__USE_GNU


693 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

695 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

696 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

697 *
__ˇn˚l_¨g
 = (
¨g
); \

698 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

699 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

700 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

702 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

703 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

707 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (&
__ˇn˚l_buf
); \

708 dÿ{

	)

709 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (
__±hªad_unwöd_buf_t
 *
__buf
)

710 
__˛ónup_f˘_©åibuã
;

715 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

718 
	`__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (&
__ˇn˚l_buf
); \

719 i‡(
execuã
) \

720 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

721 
	}
} 0)

	)

722 
	$__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (
__±hªad_unwöd_buf_t
 *
__buf
)

723 
__˛ónup_f˘_©åibuã
;

727 
	$__±hªad_unwöd_√xt
 (
__±hªad_unwöd_buf_t
 *
__buf
)

728 
__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

729 #i‚de‡
SHARED


730 
	`__©åibuã__
 ((
__wók__
))

736 
__jmp_buf_èg
;

737 
	$__sig£tjmp
 (
__jmp_buf_èg
 *
__ív
, 
__ßvemask
Ë
__THROWNL
;

743 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

744 c⁄° 
±hªad_muãx©å_t
 *
__muãx©å
)

745 
__THROW
 
	`__n⁄nuŒ
 ((1));

748 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
)

749 
__THROW
 
	`__n⁄nuŒ
 ((1));

752 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
)

753 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

756 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
)

757 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

759 #ifde‡
__USE_XOPEN2K


761 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

762 c⁄° 
time•ec
 *
__ª°ri˘


763 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

767 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
)

768 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

772 
	$±hªad_muãx_gë¥io˚ûög
 (c⁄° 
±hªad_muãx_t
 *

773 
__ª°ri˘
 
__muãx
,

774 *
__ª°ri˘
 
__¥io˚ûög
)

775 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

779 
	$±hªad_muãx_£çrio˚ûög
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

780 
__¥io˚ûög
,

781 *
__ª°ri˘
 
__ﬁd_˚ûög
)

782 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

785 #ifde‡
__USE_XOPEN2K8


787 
	$±hªad_muãx_c⁄si°ít
 (
±hªad_muãx_t
 *
__muãx
)

788 
__THROW
 
	`__n⁄nuŒ
 ((1));

789 #ifde‡
__USE_GNU


790 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

791 
__THROW
 
	`__n⁄nuŒ
 ((1));

800 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
)

801 
__THROW
 
	`__n⁄nuŒ
 ((1));

804 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
)

805 
__THROW
 
	`__n⁄nuŒ
 ((1));

808 
	$±hªad_muãx©å_gëpsh¨ed
 (c⁄° 
±hªad_muãx©å_t
 *

809 
__ª°ri˘
 
__©å
,

810 *
__ª°ri˘
 
__psh¨ed
)

811 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

814 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

815 
__psh¨ed
)

816 
__THROW
 
	`__n⁄nuŒ
 ((1));

818 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


820 
	$±hªad_muãx©å_gëty≥
 (c⁄° 
±hªad_muãx©å_t
 *
__ª°ri˘


821 
__©å
, *
__ª°ri˘
 
__köd
)

822 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

827 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

828 
__THROW
 
	`__n⁄nuŒ
 ((1));

832 
	$±hªad_muãx©å_gë¥Ÿocﬁ
 (c⁄° 
±hªad_muãx©å_t
 *

833 
__ª°ri˘
 
__©å
,

834 *
__ª°ri˘
 
__¥Ÿocﬁ
)

835 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

839 
	$±hªad_muãx©å_£çrŸocﬁ
 (
±hªad_muãx©å_t
 *
__©å
,

840 
__¥Ÿocﬁ
)

841 
__THROW
 
	`__n⁄nuŒ
 ((1));

844 
	$±hªad_muãx©å_gë¥io˚ûög
 (c⁄° 
±hªad_muãx©å_t
 *

845 
__ª°ri˘
 
__©å
,

846 *
__ª°ri˘
 
__¥io˚ûög
)

847 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

850 
	$±hªad_muãx©å_£çrio˚ûög
 (
±hªad_muãx©å_t
 *
__©å
,

851 
__¥io˚ûög
)

852 
__THROW
 
	`__n⁄nuŒ
 ((1));

854 #ifde‡
__USE_XOPEN2K


856 
	$±hªad_muãx©å_gërobu°
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

857 *
__robu°√ss
)

858 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

859 #ifde‡
__USE_GNU


860 
	$±hªad_muãx©å_gërobu°_≈
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

861 *
__robu°√ss
)

862 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

866 
	$±hªad_muãx©å_£åobu°
 (
±hªad_muãx©å_t
 *
__©å
,

867 
__robu°√ss
)

868 
__THROW
 
	`__n⁄nuŒ
 ((1));

869 #ifde‡
__USE_GNU


870 
	$±hªad_muãx©å_£åobu°_≈
 (
±hªad_muãx©å_t
 *
__©å
,

871 
__robu°√ss
)

872 
__THROW
 
	`__n⁄nuŒ
 ((1));

877 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


882 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

883 c⁄° 
±hªad_rwlock©å_t
 *
__ª°ri˘


884 
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

887 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
)

888 
__THROW
 
	`__n⁄nuŒ
 ((1));

891 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

892 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

895 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

896 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

898 #ifde‡
__USE_XOPEN2K


900 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

901 c⁄° 
time•ec
 *
__ª°ri˘


902 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

906 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
)

907 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

910 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
)

911 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

913 #ifde‡
__USE_XOPEN2K


915 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

916 c⁄° 
time•ec
 *
__ª°ri˘


917 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

921 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
)

922 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

928 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
)

929 
__THROW
 
	`__n⁄nuŒ
 ((1));

932 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
)

933 
__THROW
 
	`__n⁄nuŒ
 ((1));

936 
	$±hªad_rwlock©å_gëpsh¨ed
 (c⁄° 
±hªad_rwlock©å_t
 *

937 
__ª°ri˘
 
__©å
,

938 *
__ª°ri˘
 
__psh¨ed
)

939 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

942 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

943 
__psh¨ed
)

944 
__THROW
 
	`__n⁄nuŒ
 ((1));

947 
	$±hªad_rwlock©å_gëköd_≈
 (c⁄° 
±hªad_rwlock©å_t
 *

948 
__ª°ri˘
 
__©å
,

949 *
__ª°ri˘
 
__¥ef
)

950 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

953 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

954 
__¥ef
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

962 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

963 c⁄° 
±hªad_c⁄d©å_t
 *
__ª°ri˘
 
__c⁄d_©å
)

964 
__THROW
 
	`__n⁄nuŒ
 ((1));

967 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
)

968 
__THROW
 
	`__n⁄nuŒ
 ((1));

971 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
)

972 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

975 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
)

976 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

983 
	$±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

984 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
)

985 
	`__n⁄nuŒ
 ((1, 2));

994 
	$±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

995 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

996 c⁄° 
time•ec
 *
__ª°ri˘
 
__ab°ime
)

997 
	`__n⁄nuŒ
 ((1, 2, 3));

1002 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
)

1003 
__THROW
 
	`__n⁄nuŒ
 ((1));

1006 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
)

1007 
__THROW
 
	`__n⁄nuŒ
 ((1));

1010 
	$±hªad_c⁄d©å_gëpsh¨ed
 (c⁄° 
±hªad_c⁄d©å_t
 *

1011 
__ª°ri˘
 
__©å
,

1012 *
__ª°ri˘
 
__psh¨ed
)

1013 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1016 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

1017 
__psh¨ed
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1019 #ifde‡
__USE_XOPEN2K


1021 
	$±hªad_c⁄d©å_gë˛ock
 (c⁄° 
±hªad_c⁄d©å_t
 *

1022 
__ª°ri˘
 
__©å
,

1023 
__˛ockid_t
 *
__ª°ri˘
 
__˛ock_id
)

1024 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1027 
	$±hªad_c⁄d©å_£t˛ock
 (
±hªad_c⁄d©å_t
 *
__©å
,

1028 
__˛ockid_t
 
__˛ock_id
)

1029 
__THROW
 
	`__n⁄nuŒ
 ((1));

1033 #ifde‡
__USE_XOPEN2K


1038 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

1039 
__THROW
 
	`__n⁄nuŒ
 ((1));

1042 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
)

1043 
__THROW
 
	`__n⁄nuŒ
 ((1));

1046 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
)

1047 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1050 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
)

1051 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1054 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
)

1055 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1062 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

1063 c⁄° 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


1064 
__©å
, 
__cou¡
)

1065 
__THROW
 
	`__n⁄nuŒ
 ((1));

1068 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1069 
__THROW
 
	`__n⁄nuŒ
 ((1));

1072 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1073 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1077 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1078 
__THROW
 
	`__n⁄nuŒ
 ((1));

1081 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1082 
__THROW
 
	`__n⁄nuŒ
 ((1));

1085 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (c⁄° 
±hªad_b¨rõøâr_t
 *

1086 
__ª°ri˘
 
__©å
,

1087 *
__ª°ri˘
 
__psh¨ed
)

1088 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1091 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

1092 
__psh¨ed
)

1093 
__THROW
 
	`__n⁄nuŒ
 ((1));

1105 
	`±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

1106 (*
__de°r_fun˘i⁄
) (*))

1107 
__THROW
 
	`__n⁄nuŒ
 ((1));

1110 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1113 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1116 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

1117 c⁄° *
__poöãr
Ë
__THROW
 ;

1120 #ifde‡
__USE_XOPEN2K


1122 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

1123 
__˛ockid_t
 *
__˛ock_id
)

1124 
__THROW
 
	`__n⁄nuŒ
 ((2));

1139 
	`±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1140 (*
__∑ª¡
) (),

1141 (*
__chûd
Ë()Ë
__THROW
;

1144 #ifde‡
__USE_EXTERN_INLINES


1146 
__exã∫_ölöe
 

1147 
	`__NTH
 (
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
))

1149  
__thªad1
 =
__thªad2
;

1150 
	}
}

1153 
	g__END_DECLS


	@/usr/include/asm-generic/bitsperlong.h

1 #i‚de‡
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #i‚de‡
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/asm-generic/errno.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-gíîic/î∫o-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

109 
	#ERFKILL
 132

	)

111 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/param.h

1 #i‚de‡
__ASM_GENERIC_PARAM_H


2 
	#__ASM_GENERIC_PARAM_H


	)

4 #i‚de‡
HZ


5 
	#HZ
 100

	)

8 #i‚de‡
EXEC_PAGESIZE


9 
	#EXEC_PAGESIZE
 4096

	)

12 #i‚de‡
NOGROUP


13 
	#NOGROUP
 (-1)

	)

16 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/asm-generic/posix_types.h

1 #i‚de‡
__ASM_GENERIC_POSIX_TYPES_H


2 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

4 
	~<asm/bô•îl⁄g.h
>

13 #i‚de‡
__kî√l_l⁄g_t


14 
	t__kî√l_l⁄g_t
;

15 
	t__kî√l_ul⁄g_t
;

18 #i‚de‡
__kî√l_öo_t


19 
__kî√l_ul⁄g_t
 
	t__kî√l_öo_t
;

22 #i‚de‡
__kî√l_mode_t


23 
	t__kî√l_mode_t
;

26 #i‚de‡
__kî√l_pid_t


27 
	t__kî√l_pid_t
;

30 #i‚de‡
__kî√l_ùc_pid_t


31 
	t__kî√l_ùc_pid_t
;

34 #i‚de‡
__kî√l_uid_t


35 
	t__kî√l_uid_t
;

36 
	t__kî√l_gid_t
;

39 #i‚de‡
__kî√l_su£c⁄ds_t


40 
__kî√l_l⁄g_t
 
	t__kî√l_su£c⁄ds_t
;

43 #i‚de‡
__kî√l_daddr_t


44 
	t__kî√l_daddr_t
;

47 #i‚de‡
__kî√l_uid32_t


48 
	t__kî√l_uid32_t
;

49 
	t__kî√l_gid32_t
;

52 #i‚de‡
__kî√l_ﬁd_uid_t


53 
__kî√l_uid_t
 
	t__kî√l_ﬁd_uid_t
;

54 
__kî√l_gid_t
 
	t__kî√l_ﬁd_gid_t
;

57 #i‚de‡
__kî√l_ﬁd_dev_t


58 
	t__kî√l_ﬁd_dev_t
;

65 #i‚de‡
__kî√l_size_t


66 #i‡
__BITS_PER_LONG
 != 64

67 
	t__kî√l_size_t
;

68 
	t__kî√l_ssize_t
;

69 
	t__kî√l_±rdiff_t
;

71 
__kî√l_ul⁄g_t
 
	t__kî√l_size_t
;

72 
__kî√l_l⁄g_t
 
	t__kî√l_ssize_t
;

73 
__kî√l_l⁄g_t
 
	t__kî√l_±rdiff_t
;

77 #i‚de‡
__kî√l_fsid_t


79 
	mvÆ
[2];

80 } 
	t__kî√l_fsid_t
;

86 
__kî√l_l⁄g_t
 
	t__kî√l_off_t
;

87 
	t__kî√l_loff_t
;

88 
__kî√l_l⁄g_t
 
	t__kî√l_time_t
;

89 
__kî√l_l⁄g_t
 
	t__kî√l_˛ock_t
;

90 
	t__kî√l_timî_t
;

91 
	t__kî√l_˛ockid_t
;

92 * 
	t__kî√l_ˇddr_t
;

93 
	t__kî√l_uid16_t
;

94 
	t__kî√l_gid16_t
;

	@/usr/include/asm/sockios.h

1 
	~<asm-gíîic/sockios.h
>

	@/usr/include/linux/ioctl.h

1 #i‚de‡
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/io˘l.h
>

	@/usr/include/net-snmp/library/snmpUDPBaseDomain.h

1 #i‚de‡
SNMPUDPBASEDOMAIN_H


2 
	#SNMPUDPBASEDOMAIN_H


	)

4 
	$c⁄fig_ªquúe
(
SockëBa£
)

6 
	~<√t-¢mp/libøry/¢mp_å™•‹t.h
>

8 #ifde‡
__˝lu•lus


15 #ifde‡ 
MSG_DONTWAIT


16 
	#NETSNMP_DONTWAIT
 
MSG_DONTWAIT


	)

18 
	#NETSNMP_DONTWAIT
 0

	)

21 #ifde‡ 
MSG_NOSIGNAL


22 
	#NETSNMP_NOSIGNAL
 
MSG_NOSIGNAL


	)

24 
	#NETSNMP_NOSIGNAL
 0

	)

30 
	`_√t¢mp_udp_sock›t_£t
(
fd
, 
loˇl
);

31 
	`√t¢mp_udpba£_ªcv
(
√t¢mp_å™•‹t
 *
t
, *
buf
, 
size
,

32 **
›aque
, *
ﬁígth
);

33 
	`√t¢mp_udpba£_£nd
(
√t¢mp_å™•‹t
 *
t
, *
buf
, 
size
,

34 **
›aque
, *
ﬁígth
);

36 #i‡
	`deföed
(
löux
Ë&& deföed(
IP_PKTINFO
) \

37 || 
	`deföed
(
IP_RECVDSTADDR
Ë&& !deföed(
_MSC_VER
)

38 
	`√t¢mp_udpba£_ªcv‰om
(
s
, *
buf
, 
Àn
,

39 
sockaddr
 *
‰om
, 
sockÀn_t
 *
‰omÀn
,

40 
sockaddr
 *
d°ù
, 
sockÀn_t
 *
d°Àn
,

41 *
if_ödex
);

42 
	`√t¢mp_udpba£_£ndto
(
fd
, 
ö_addr
 *
§cù
, 
if_ödex
,

43 
sockaddr
 *
ªmŸe
, *
d©a
, 
Àn
);

46 #ifde‡
__˝lu•lus


47 
	}
}

	@/usr/include/sched.h

20 #i‚def 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

31 
	#__√ed_time_t


	)

32 
	#__√ed_time•ec


	)

33 
	~<time.h
>

35 #i‚de‡
__pid_t_deföed


36 
__pid_t
 
	tpid_t
;

37 
	#__pid_t_deföed


	)

42 
	~<bôs/sched.h
>

44 
	#sched_¥i‹ôy
 
__sched_¥i‹ôy


	)

47 
__BEGIN_DECLS


50 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, c⁄° 
sched_∑øm
 *
__∑øm
)

51 
__THROW
;

54 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

57 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

58 c⁄° 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

61 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

64 
	$sched_yõld
 (Ë
__THROW
;

67 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

70 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

73 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

76 #ifde‡
__USE_GNU


78 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

79 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

80 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

81 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (˝u,  (
˝u_£t_t
), \

82 
˝u£ç
)

	)

83 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO_S
 ( (
˝u_£t_t
), cpu£ç)

	)

84 
	#CPU_COUNT
(
˝u£ç
Ë
	`__CPU_COUNT_S
 ( (
˝u_£t_t
), cpu£ç)

	)

86 
	#CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u, sësize, cpu£ç)

	)

87 
	#CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u, sësize, cpu£ç)

	)

88 
	#CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (cpu, setsize, \

89 
˝u£ç
)

	)

90 
	#CPU_ZERO_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_ZERO_S
 (£tsize, cpu£ç)

	)

91 
	#CPU_COUNT_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_COUNT_S
 (£tsize, cpu£ç)

	)

93 
	#CPU_EQUAL
(
˝u£ç1
, 
˝u£ç2
) \

94 
	`__CPU_EQUAL_S
 ( (
˝u_£t_t
), 
˝u£ç1
, 
˝u£ç2
)

	)

95 
	#CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

96 
	`__CPU_EQUAL_S
 (
£tsize
, 
˝u£ç1
, 
˝u£ç2
)

	)

98 
	#CPU_AND
(
de°£t
, 
§c£t1
, 
§c£t2
) \

99 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

100 
	#CPU_OR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

101 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

102 
	#CPU_XOR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

103 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

104 
	#CPU_AND_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

105 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

106 
	#CPU_OR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

107 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

108 
	#CPU_XOR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

109 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

111 
	#CPU_ALLOC_SIZE
(
cou¡
Ë
	`__CPU_ALLOC_SIZE
 (cou¡)

	)

112 
	#CPU_ALLOC
(
cou¡
Ë
	`__CPU_ALLOC
 (cou¡)

	)

113 
	#CPU_FREE
(
˝u£t
Ë
	`__CPU_FREE
 (˝u£t)

	)

117 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

118 c⁄° 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

121 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

122 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

125 
__END_DECLS


	@/usr/include/asm-generic/errno-base.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/sockios.h

1 #i‚de‡
__ASM_GENERIC_SOCKIOS_H


2 
	#__ASM_GENERIC_SOCKIOS_H


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

11 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/asm/ioctl.h

1 
	~<asm-gíîic/io˘l.h
>

	@/usr/include/bits/sched.h

21 #i‚de‡
__√ed_sched∑øm


23 #i‚de‡
_SCHED_H


29 
	#SCHED_OTHER
 0

	)

30 
	#SCHED_FIFO
 1

	)

31 
	#SCHED_RR
 2

	)

32 #ifde‡
__USE_GNU


33 
	#SCHED_BATCH
 3

	)

34 
	#SCHED_IDLE
 5

	)

36 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

39 #ifde‡
__USE_GNU


41 
	#CSIGNAL
 0x000000f‡

	)

42 
	#CLONE_VM
 0x00000100

	)

43 
	#CLONE_FS
 0x00000200

	)

44 
	#CLONE_FILES
 0x00000400

	)

45 
	#CLONE_SIGHAND
 0x00000800

	)

46 
	#CLONE_PTRACE
 0x00002000

	)

47 
	#CLONE_VFORK
 0x00004000

	)

49 
	#CLONE_PARENT
 0x00008000

	)

51 
	#CLONE_THREAD
 0x00010000

	)

52 
	#CLONE_NEWNS
 0x00020000

	)

53 
	#CLONE_SYSVSEM
 0x00040000

	)

54 
	#CLONE_SETTLS
 0x00080000

	)

55 
	#CLONE_PARENT_SETTID
 0x00100000

	)

57 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

59 
	#CLONE_DETACHED
 0x00400000

	)

60 
	#CLONE_UNTRACED
 0x00800000

	)

62 
	#CLONE_CHILD_SETTID
 0x01000000

	)

64 
	#CLONE_NEWUTS
 0x04000000

	)

65 
	#CLONE_NEWIPC
 0x08000000

	)

66 
	#CLONE_NEWUSER
 0x10000000

	)

67 
	#CLONE_NEWPID
 0x20000000

	)

68 
	#CLONE_NEWNET
 0x40000000

	)

69 
	#CLONE_IO
 0x80000000

	)

73 
	ssched_∑øm


75 
	m__sched_¥i‹ôy
;

78 
	g__BEGIN_DECLS


80 #ifde‡
__USE_GNU


82 
˛⁄e
 ((*
__‚
Ë(*
__¨g
), *
__chûd_°ack
,

83 
__Êags
, *
__¨g
, ...Ë
__THROW
;

86 
	$unsh¨e
 (
__Êags
Ë
__THROW
;

89 
	$sched_gë˝u
 (Ë
__THROW
;

92 
	$£äs
 (
__fd
, 
__n°y≥
Ë
__THROW
;

96 
__END_DECLS


100 #i‡!
deföed
 
__deföed_sched∑øm
 \

101 && (
deföed
 
__√ed_sched∑øm
 || deföed 
_SCHED_H
)

102 
	#__deföed_sched∑øm
 1

	)

104 
	s__sched_∑øm


106 
__sched_¥i‹ôy
;

108 #unde‡
__√ed_sched∑øm


112 #i‡
deföed
 
_SCHED_H
 && !deföed 
__˝u_£t_t_deföed


113 
	#__˝u_£t_t_deföed


	)

115 
	#__CPU_SETSIZE
 1024

	)

116 
	#__NCPUBITS
 (8 *  (
__˝u_mask
))

	)

119 
	t__˝u_mask
;

122 
	#__CPUELT
(
˝u
Ë((˝uË/ 
__NCPUBITS
)

	)

123 
	#__CPUMASK
(
˝u
Ë((
__˝u_mask
Ë1 << ((˝uË% 
__NCPUBITS
))

	)

128 
__˝u_mask
 
__bôs
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

129 } 
	t˝u_£t_t
;

132 #i‡
	`__GNUC_PREREQ
 (2, 91)

133 
	#__CPU_ZERO_S
(
£tsize
, 
˝u£ç
) \

134 dÿ
	`__buûtö_mem£t
 (
˝u£ç
, '\0', 
£tsize
); 0)

	)

136 
	#__CPU_ZERO_S
(
£tsize
, 
˝u£ç
) \

138 
size_t
 
__i
; \

139 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

140 
__˝u_mask
 *
__bôs
 = (
˝u£ç
)->__bits; \

141 
__i
 = 0; __ò< 
__imax
; ++__i) \

142 
__bôs
[
__i
] = 0; \

143 
	}
} 0)

	)

145 
	#__CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

146 (
__exãnsi⁄__
 \

147 ({ 
size_t
 
__˝u
 = (
˝u
); \

148 
__˝u
 < 8 * (
£tsize
) \

149 ? (((
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

150 |
	`__CPUMASK
 (
__˝u
)) \

151 : 0; }))

	)

152 
	#__CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

153 (
__exãnsi⁄__
 \

154 ({ 
size_t
 
__˝u
 = (
˝u
); \

155 
__˝u
 < 8 * (
£tsize
) \

156 ? (((
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

157 &~
	`__CPUMASK
 (
__˝u
)) \

158 : 0; }))

	)

159 
	#__CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

160 (
__exãnsi⁄__
 \

161 ({ 
size_t
 
__˝u
 = (
˝u
); \

162 
__˝u
 < 8 * (
£tsize
) \

163 ? ((((c⁄° 
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

164 & 
	`__CPUMASK
 (
__˝u
))) != 0 \

165 : 0; }))

	)

167 
	#__CPU_COUNT_S
(
£tsize
, 
˝u£ç
) \

168 
	`__sched_˝ucou¡
 (
£tsize
, 
˝u£ç
)

	)

170 #i‡
__GNUC_PREREQ
 (2, 91)

171 
	#__CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

172 (
	`__buûtö_memcmp
 (
˝u£ç1
, 
˝u£ç2
, 
£tsize
Ë=0)

	)

174 
	#__CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

175 (
__exãnsi⁄__
 \

176 ({ c⁄° 
__˝u_mask
 *
__¨r1
 = (
˝u£ç1
)->
__bôs
; \

177 c⁄° 
__˝u_mask
 *
__¨r2
 = (
˝u£ç2
)->
__bôs
; \

178 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

179 
size_t
 
__i
; \

180 
__i
 = 0; __ò< 
__imax
; ++__i) \

181 i‡(
__¨r1
[
__i
] !
__¨r2
[__i]) \

183 
__i
 =
__imax
; }))

	)

186 
	#__CPU_OP_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, 
›
) \

187 (
__exãnsi⁄__
 \

188 ({ 
˝u_£t_t
 *
__de°
 = (
de°£t
); \

189 c⁄° 
__˝u_mask
 *
__¨r1
 = (
§c£t1
)->
__bôs
; \

190 c⁄° 
__˝u_mask
 *
__¨r2
 = (
§c£t2
)->
__bôs
; \

191 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

192 
size_t
 
__i
; \

193 
__i
 = 0; __ò< 
__imax
; ++__i) \

194 ((
__˝u_mask
 *Ë
__de°
->
__bôs
)[
__i
] = 
__¨r1
[__i] 
›
 
__¨r2
[__i]; \

195 
__de°
; }))

	)

197 
	#__CPU_ALLOC_SIZE
(
cou¡
) \

198 ((((
cou¡
Ë+ 
__NCPUBITS
 - 1Ë/ __NCPUBITSË*  (
__˝u_mask
))

	)

199 
	#__CPU_ALLOC
(
cou¡
Ë
	`__sched_˝uÆloc
 (cou¡)

	)

200 
	#__CPU_FREE
(
˝u£t
Ë
	`__sched_˝u‰ì
 (˝u£t)

	)

202 
__BEGIN_DECLS


204 
	$__sched_˝ucou¡
 (
size_t
 
__£tsize
, c⁄° 
˝u_£t_t
 *
__£ç
)

205 
__THROW
;

206 
˝u_£t_t
 *
	$__sched_˝uÆloc
 (
size_t
 
__cou¡
Ë
__THROW
 
__wur
;

207 
	$__sched_˝u‰ì
 (
˝u_£t_t
 *
__£t
Ë
__THROW
;

209 
__END_DECLS


	@/usr/include/asm-generic/ioctl.h

1 #i‚de‡
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #i‚de‡
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #i‚de‡
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

56 #i‚de‡
_IOC_NONE


57 
	#_IOC_NONE
 0U

	)

60 #i‚de‡
_IOC_WRITE


61 
	#_IOC_WRITE
 1U

	)

64 #i‚de‡
_IOC_READ


65 
	#_IOC_READ
 2U

	)

68 
	#_IOC
(
dú
,
ty≥
,
ƒ
,
size
) \

69 (((
dú
Ë<< 
_IOC_DIRSHIFT
) | \

70 ((
ty≥
Ë<< 
_IOC_TYPESHIFT
) | \

71 ((
ƒ
Ë<< 
_IOC_NRSHIFT
) | \

72 ((
size
Ë<< 
_IOC_SIZESHIFT
))

	)

74 
	#_IOC_TYPECHECK
(
t
Ë(—))

	)

82 
	#_IO
(
ty≥
,
ƒ
Ë
	`_IOC
(
_IOC_NONE
,—y≥),“r),0)

	)

83 
	#_IOR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

84 
	#_IOW
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

85 
	#_IOWR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

86 
	#_IOR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(size))

	)

87 
	#_IOW_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(size))

	)

88 
	#_IOWR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(size))

	)

91 
	#_IOC_DIR
(
ƒ
Ë((“rË>> 
_IOC_DIRSHIFT
Ë& 
_IOC_DIRMASK
)

	)

92 
	#_IOC_TYPE
(
ƒ
Ë((“rË>> 
_IOC_TYPESHIFT
Ë& 
_IOC_TYPEMASK
)

	)

93 
	#_IOC_NR
(
ƒ
Ë((“rË>> 
_IOC_NRSHIFT
Ë& 
_IOC_NRMASK
)

	)

94 
	#_IOC_SIZE
(
ƒ
Ë((“rË>> 
_IOC_SIZESHIFT
Ë& 
_IOC_SIZEMASK
)

	)

98 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

99 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

100 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
Ë<< 
_IOC_DIRSHIFT
)

	)

101 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

102 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@
1
.
1
/usr/include
566
24286
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_advertise.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_advertise.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_aspath.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_aspath.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_attr.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_attr.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_clist.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_clist.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_community.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_community.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_damp.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_damp.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_debug.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_debug.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_dump.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_dump.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_ecommunity.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_ecommunity.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_filter.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_filter.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_fsm.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_fsm.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_grpc.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_info_hash.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_info_hash.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_main.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mpath.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mpath.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mplsvpn.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_mplsvpn.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_network.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_network.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_nexthop.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_nexthop.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_open.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_open.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_packet.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_packet.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_regex.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_regex.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_route.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_route.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_routemap.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_snmp.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_snmp.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_table.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_table.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_validate.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_validate.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_vty.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_vty.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_zebra.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgp_zebra.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgpd.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/bgpd/bgpd.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/config.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/fpm/fpm.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/agentx.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/buffer.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/buffer.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/checksum.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/checksum.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/command.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/command.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/daemon.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/distribute.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/distribute.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/filter.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/filter.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/getopt.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/getopt.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/getopt1.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/hash.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/hash.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if_rmap.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/if_rmap.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/jhash.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/jhash.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/keychain.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/keychain.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/linklist.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/linklist.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/log.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/log.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/md5.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/md5.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memory.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memory.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memtypes.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/memtypes.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/network.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/network.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/pid_output.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/plist.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/plist.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/pqueue.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/pqueue.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/prefix.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/prefix.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/privs.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/privs.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/queue.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/regex-gnu.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/regex.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/route_types.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/routemap.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/routemap.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sigevent.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sigevent.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/smux.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/smux.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/snmp.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockopt.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockopt.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockunion.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/sockunion.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/str.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/str.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/stream.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/stream.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/table.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/table.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/thread.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/thread.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vector.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vector.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/version.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vty.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/vty.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/workqueue.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/workqueue.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zassert.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zclient.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zclient.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/lib/zebra.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_config.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_main.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_user.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/vtysh/vtysh_user.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/watchquagga/watchquagga.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/connected.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/connected.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/debug.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/debug.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_ioctl.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_ioctl_solaris.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_netlink.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_proc.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/if_sysctl.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/interface.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/interface.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl_null.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ioctl_solaris.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_aix.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_ews.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_proc.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_solaris.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/ipforward_sysctl.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp_interface.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp_main.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/irdp_packet.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_netlink.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_null.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_socket.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/kernel_socket.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/main.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/misc_null.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/mtu_kvm.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/redistribute.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/redistribute.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/redistribute_null.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rib.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/router-id.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/router-id.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_ioctl.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_netlink.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_netlink.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rt_socket.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtadv.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtadv.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_getmsg.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_netlink.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_proc.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/rtread_sysctl.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/test_main.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm_netlink.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_fpm_private.h
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_rib.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_routemap.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_snmp.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zebra_vty.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zserv.c
/opt/project/gobgp_test/gowork/src/srx_grpc/qsrx/zebra/zserv.h
/usr/include/alloca.h
/usr/include/arpa/inet.h
/usr/include/arpa/telnet.h
/usr/include/asm/types.h
/usr/include/ctype.h
/usr/include/errno.h
/usr/include/execinfo.h
/usr/include/fcntl.h
/usr/include/getopt.h
/usr/include/gnu-versions.h
/usr/include/grp.h
/usr/include/ifaddrs.h
/usr/include/inttypes.h
/usr/include/libintl.h
/usr/include/limits.h
/usr/include/linux/filter.h
/usr/include/linux/ipv6_route.h
/usr/include/linux/netlink.h
/usr/include/linux/rtnetlink.h
/usr/include/linux/types.h
/usr/include/linux/version.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/memory.h
/usr/include/net-snmp/agent/net-snmp-agent-includes.h
/usr/include/net-snmp/agent/snmp_vars.h
/usr/include/net-snmp/net-snmp-config.h
/usr/include/net-snmp/net-snmp-includes.h
/usr/include/net/if.h
/usr/include/net/route.h
/usr/include/netdb.h
/usr/include/netinet/icmp6.h
/usr/include/netinet/in.h
/usr/include/netinet/in_systm.h
/usr/include/netinet/ip.h
/usr/include/netinet/ip_icmp.h
/usr/include/netinet/tcp.h
/usr/include/pcreposix.h
/usr/include/pwd.h
/usr/include/readline/history.h
/usr/include/readline/readline.h
/usr/include/regex.h
/usr/include/setjmp.h
/usr/include/signal.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/sys/cdefs.h
/usr/include/sys/fcntl.h
/usr/include/sys/ioctl.h
/usr/include/sys/param.h
/usr/include/sys/prctl.h
/usr/include/sys/resource.h
/usr/include/sys/select.h
/usr/include/sys/socket.h
/usr/include/sys/stat.h
/usr/include/sys/sysctl.h
/usr/include/sys/time.h
/usr/include/sys/types.h
/usr/include/sys/uio.h
/usr/include/sys/un.h
/usr/include/sys/utsname.h
/usr/include/sys/wait.h
/usr/include/syslog.h
/usr/include/time.h
/usr/include/ucontext.h
/usr/include/unistd.h
/usr/include/uthash.h
/usr/include/wchar.h
/usr/include/wctype.h
bgpd/bgp_advertise.h
bgpd/bgp_aspath.h
bgpd/bgp_attr.h
bgpd/bgp_clist.h
bgpd/bgp_community.h
bgpd/bgp_damp.h
bgpd/bgp_debug.h
bgpd/bgp_dump.h
bgpd/bgp_ecommunity.h
bgpd/bgp_filter.h
bgpd/bgp_fsm.h
bgpd/bgp_info_hash.h
bgpd/bgp_mpath.h
bgpd/bgp_mplsvpn.h
bgpd/bgp_network.h
bgpd/bgp_nexthop.h
bgpd/bgp_open.h
bgpd/bgp_packet.h
bgpd/bgp_regex.h
bgpd/bgp_route.h
bgpd/bgp_snmp.h
bgpd/bgp_table.h
bgpd/bgp_validate.h
bgpd/bgp_vty.h
bgpd/bgp_zebra.h
bgpd/bgpd.h
config.h
fpm/fpm.h
lib/memtypes.h
lib/route_types.h
lib/vty.h
vtysh/vtysh.h
vtysh/vtysh_user.h
zebra/connected.h
zebra/debug.h
zebra/interface.h
zebra/ioctl.h
zebra/ipforward.h
zebra/irdp.h
zebra/kernel_socket.h
zebra/redistribute.h
zebra/rib.h
zebra/router-id.h
zebra/rt.h
zebra/rtadv.h
zebra/zebra_fpm.h
zebra/zserv.h
/usr/include/asm-generic/types.h
/usr/include/bits/byteswap.h
/usr/include/bits/confname.h
/usr/include/bits/environments.h
/usr/include/bits/errno.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/huge_val.h
/usr/include/bits/huge_valf.h
/usr/include/bits/huge_vall.h
/usr/include/bits/in.h
/usr/include/bits/inf.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/math-finite.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathdef.h
/usr/include/bits/mathinline.h
/usr/include/bits/nan.h
/usr/include/bits/netdb.h
/usr/include/bits/param.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/resource.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/setjmp.h
/usr/include/bits/setjmp2.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigset.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/stat.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-float.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/sysctl.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/uio.h
/usr/include/bits/unistd.h
/usr/include/bits/utsname.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar.h
/usr/include/bits/wchar2.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/libio.h
/usr/include/linux/bpf_common.h
/usr/include/linux/if_addr.h
/usr/include/linux/if_link.h
/usr/include/linux/kernel.h
/usr/include/linux/neighbour.h
/usr/include/linux/posix_types.h
/usr/include/linux/prctl.h
/usr/include/linux/socket.h
/usr/include/linux/sysctl.h
/usr/include/locale.h
/usr/include/net-snmp/agent/agent_handler.h
/usr/include/net-snmp/agent/agent_module_config.h
/usr/include/net-snmp/agent/agent_read_config.h
/usr/include/net-snmp/agent/agent_registry.h
/usr/include/net-snmp/agent/agent_trap.h
/usr/include/net-snmp/agent/all_helpers.h
/usr/include/net-snmp/agent/ds_agent.h
/usr/include/net-snmp/agent/mib_module_config.h
/usr/include/net-snmp/agent/snmp_agent.h
/usr/include/net-snmp/agent/var_struct.h
/usr/include/net-snmp/config_api.h
/usr/include/net-snmp/definitions.h
/usr/include/net-snmp/library/getopt.h
/usr/include/net-snmp/mib_api.h
/usr/include/net-snmp/output_api.h
/usr/include/net-snmp/pdu_api.h
/usr/include/net-snmp/session_api.h
/usr/include/net-snmp/snmpv3_api.h
/usr/include/net-snmp/types.h
/usr/include/net-snmp/utilities.h
/usr/include/net-snmp/varbind_api.h
/usr/include/readline/keymaps.h
/usr/include/readline/rlstdc.h
/usr/include/readline/rltypedefs.h
/usr/include/readline/tilde.h
/usr/include/rpc/netdb.h
/usr/include/stdint.h
/usr/include/sys/syslog.h
/usr/include/sys/sysmacros.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/ucontext.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm/ioctls.h
/usr/include/asm/posix_types.h
/usr/include/asm/socket.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/endian.h
/usr/include/bits/fcntl-linux.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/local_lim.h
/usr/include/bits/locale.h
/usr/include/bits/socket_type.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/syslog-ldbl.h
/usr/include/bits/syslog-path.h
/usr/include/bits/syslog.h
/usr/include/bits/timex.h
/usr/include/bits/typesizes.h
/usr/include/gnu/stubs.h
/usr/include/linux/errno.h
/usr/include/linux/limits.h
/usr/include/linux/param.h
/usr/include/linux/stddef.h
/usr/include/linux/sysinfo.h
/usr/include/net-snmp/agent/baby_steps.h
/usr/include/net-snmp/agent/bulk_to_next.h
/usr/include/net-snmp/agent/cache_handler.h
/usr/include/net-snmp/agent/debug_handler.h
/usr/include/net-snmp/agent/instance.h
/usr/include/net-snmp/agent/mfd.h
/usr/include/net-snmp/agent/mode_end_call.h
/usr/include/net-snmp/agent/multiplexer.h
/usr/include/net-snmp/agent/null.h
/usr/include/net-snmp/agent/old_api.h
/usr/include/net-snmp/agent/read_only.h
/usr/include/net-snmp/agent/row_merge.h
/usr/include/net-snmp/agent/scalar.h
/usr/include/net-snmp/agent/scalar_group.h
/usr/include/net-snmp/agent/serialize.h
/usr/include/net-snmp/agent/snmp_get_statistic.h
/usr/include/net-snmp/agent/table.h
/usr/include/net-snmp/agent/table_array.h
/usr/include/net-snmp/agent/table_container.h
/usr/include/net-snmp/agent/table_data.h
/usr/include/net-snmp/agent/table_dataset.h
/usr/include/net-snmp/agent/table_iterator.h
/usr/include/net-snmp/agent/table_tdata.h
/usr/include/net-snmp/agent/watcher.h
/usr/include/net-snmp/library/asn1.h
/usr/include/net-snmp/library/callback.h
/usr/include/net-snmp/library/check_varbind.h
/usr/include/net-snmp/library/container.h
/usr/include/net-snmp/library/container_binary_array.h
/usr/include/net-snmp/library/container_iterator.h
/usr/include/net-snmp/library/container_list_ssll.h
/usr/include/net-snmp/library/data_list.h
/usr/include/net-snmp/library/default_store.h
/usr/include/net-snmp/library/fd_event_manager.h
/usr/include/net-snmp/library/int64.h
/usr/include/net-snmp/library/keytools.h
/usr/include/net-snmp/library/lcd_time.h
/usr/include/net-snmp/library/md5.h
/usr/include/net-snmp/library/mib.h
/usr/include/net-snmp/library/mt_support.h
/usr/include/net-snmp/library/oid.h
/usr/include/net-snmp/library/oid_stash.h
/usr/include/net-snmp/library/parse.h
/usr/include/net-snmp/library/read_config.h
/usr/include/net-snmp/library/scapi.h
/usr/include/net-snmp/library/snmp-tc.h
/usr/include/net-snmp/library/snmp.h
/usr/include/net-snmp/library/snmpCallbackDomain.h
/usr/include/net-snmp/library/snmpTCPDomain.h
/usr/include/net-snmp/library/snmpTCPIPv6Domain.h
/usr/include/net-snmp/library/snmpUDPDomain.h
/usr/include/net-snmp/library/snmpUDPIPv6Domain.h
/usr/include/net-snmp/library/snmpUnixDomain.h
/usr/include/net-snmp/library/snmp_alarm.h
/usr/include/net-snmp/library/snmp_api.h
/usr/include/net-snmp/library/snmp_assert.h
/usr/include/net-snmp/library/snmp_client.h
/usr/include/net-snmp/library/snmp_debug.h
/usr/include/net-snmp/library/snmp_enum.h
/usr/include/net-snmp/library/snmp_impl.h
/usr/include/net-snmp/library/snmp_logging.h
/usr/include/net-snmp/library/snmp_parse_args.h
/usr/include/net-snmp/library/snmp_secmod.h
/usr/include/net-snmp/library/snmp_service.h
/usr/include/net-snmp/library/snmp_transport.h
/usr/include/net-snmp/library/snmpv3-security-includes.h
/usr/include/net-snmp/library/snmpv3.h
/usr/include/net-snmp/library/system.h
/usr/include/net-snmp/library/tools.h
/usr/include/net-snmp/library/transform_oids.h
/usr/include/net-snmp/library/types.h
/usr/include/net-snmp/library/ucd_compat.h
/usr/include/net-snmp/library/vacm.h
/usr/include/net-snmp/version.h
/usr/include/readline/chardefs.h
/usr/include/stdc-predef.h
/usr/include/asm-generic/ioctls.h
/usr/include/asm-generic/socket.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/errno.h
/usr/include/asm/param.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/assert.h
/usr/include/bits/libc-lock.h
/usr/include/gconv.h
/usr/include/gnu/stubs-64.h
/usr/include/linux/falloc.h
/usr/include/net-snmp/library/factory.h
/usr/include/net-snmp/library/snmpIPv4BaseDomain.h
/usr/include/net-snmp/library/snmpIPv6BaseDomain.h
/usr/include/net-snmp/library/snmpUDPIPv4BaseDomain.h
/usr/include/net-snmp/library/snmptsm.h
/usr/include/net-snmp/library/snmpusm.h
/usr/include/net-snmp/net-snmp-features.h
/usr/include/pthread.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/param.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm/sockios.h
/usr/include/linux/ioctl.h
/usr/include/net-snmp/library/snmpUDPBaseDomain.h
/usr/include/sched.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/sockios.h
/usr/include/asm/ioctl.h
/usr/include/bits/sched.h
/usr/include/asm-generic/ioctl.h
